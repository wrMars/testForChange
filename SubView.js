!function(t,i,s){s.un,s.uns;var e=s.static,l=s.class,o=s.getset,h=(s.__newvec,modules.activity.bargain.ActBargainVo,modules.activity.vo.ActBuyGoodsAlertVO),n=modules.activity.views.ActChargeItem,a=ui.modules.activity.ActChargeItemUI,r=ui.modules.activity.ActChargeViewUI,c=(modules.activity.vo.ActConstellationVo,modules.activity.consumeBack.ActConsumeBackItemVO,modules.activity.consumeBack.ActConsumeBackVO,modules.activity.vo.ActConsumeSubVO,modules.activity.vo.ActConsumeVO,ui.modules.activity.copyDropReward.ActCopyDropRewardUI),d=(modules.activity.vo.ActCopyDropRewardVO,modules.activity.vo.ActCountDownSubVO,modules.activity.vo.ActCountDownVO,modules.activity.dial.ActDialVO,modules.activity.discounts.vo.ActDiscountsItemVO,modules.activity.discounts.vo.ActDiscountsVO,ui.modules.activity.discounts.ActDiscountsViewUI),u=(modules.activity.vo.ActDisplayVO,ui.modules.activity.display.ActDisplayViewUI),p=(xml.ActEffsVO,modules.activity.exchange.view.ActExchangeItem1),m=modules.activity.exchange.view.ActExchangeItem2,f=(modules.activity.exchange.vo.ActExchangeItemVO,modules.activity.exchange.vo.ActExchangeVO,ui.modules.activity.familyBattle.ActFamilyBattleItemUI),g=ui.modules.activity.familyBattle.ActFamilyBattlePanelUI,_=(modules.activity.vo.ActFamilyBattleRewardVO,modules.activity.vo.ActFreeMallVO,modules.activity.vo.ActGroupPkVO,ui.modules.activity.groupPk.ActGroupPkViewUI),I=modules.activity.actInvest.ActInvestCase,v=modules.activity.actInvest.ActInvestMgr,b=modules.activity.levelGift.ActLevelGiftCase,y=ui.modules.activity.levelGift.ActLevelGiftItemUI,x=modules.activity.levelGift.ActLevelGiftManager,S=ui.modules.activity.levelGift.ActLevelGiftUI,w=ui.modules.activity.limit.ActLimitItemUI,k=(modules.activity.limit.vo.ActLimitItemVO,modules.activity.limit.vo.ActLimitVO,ui.modules.activity.limit.ActLimitViewUI),T=modules.actLoginFun.ActLoginFunItem,C=modules.actLoginFun.ActLoginFunMgr,A=modules.actLoginFun.ActLoginFunModule,O=ui.modules.activity.ActLoginFunViewUI,P=ui.modules.activity.online.ActOnlineItemUI,V=(modules.activity.online.vo.ActOnlineItemVO,modules.activity.online.vo.ActOnlineVO,ui.modules.activity.online.ActOnlineViewUI),R=(modules.activity.vo.ActRandomSubVO,modules.activity.vo.ActRandomVO,modules.activity.vo.ActRechargeRestoreSubVO,modules.activity.vo.ActRechargeRestoreVO,modules.activity.vo.ActRestoreSubVO,modules.activity.vo.ActRestoreVO,modules.activity.RPControl.ActRpChbView),D=modules.activity.RPControl.ActRpUtils,N=modules.activity.wish.ActWishMgr,E=ui.modules.activity.wish.ActWishRewardItemUI,B=ui.modules.activity.wish.ActWishViewUI,L=(modules.activity.yunyou.ActYunyouVo,modules.activity.ActivityCommonCase),M=modules.activity.ActivityCommonMediator,G=modules.activity.ActivityCommonMgr,F=modules.activity.ActivityConstant,U=modules.activity.ActivityRepeatAlertVO,H=modules.activity.ActivityRepeatGoodsAlert,W=ui.modules.welfare.addApp.AddAppTipViewUI,K=com.ui.Alert,q=com.ui.AlertVO,Y=(modules.activity.serverLimitBuy.AllWelfareVo,modules.athletics.AthleticsConst,ui.modules.athletics.AthleticsPanelUI),X=laya.ui.AutoBitmap,z=com.scene.unit.base.AvatarUtil,Q=ui.modules.activity.bagua.BaguaLogItemUI,j=modules.activity.bagua.BaguaMgr,J=ui.modules.activity.bagua.BaguaRewardViewUI,$=ui.modules.activity.bagua.BaguaViewUI,Z=(xml.BannerGiftVO,modules.activity.bannerQQ.BannerQQCase),tt=ui.modules.activity.bannerQQ.BannerQQItemUI,it=modules.activity.bannerQQ.BannerQQMgr,et=ui.modules.activity.bannerQQ.BannerQQViewUI,st=modules.activity.bargain.BargainCase,nt=ui.modules.activity.bargain.BargainFriendCutItemUI,ht=ui.modules.activity.bargain.BargainFriendCutViewUI,at=ui.modules.activity.bargain.BargainInviteViewUI,ot=ui.modules.activity.bargain.BargainItemViewUI,rt=(modules.activity.bargain.BargainSubVo,ui.modules.activity.bargain.BargainViewUI),lt=(modules.pack.vo.BaseItemVO,xml.BeastsAnimalVO,ui.modules.activity.beastsBuy.BeastsBuyViewUI),ct=modules.activity.billboard.Billboard1,dt=ui.modules.welfare.bindPhone.BindPhoneGiftViewUI,ut=com.scene.effect.BitmapClip,pt=modules.blueDiamond.blueVipShow.BlueVipOutShow,mt=modules.blueDiamond.blueVipShow.BlueVipOutShowBox,ft=modules.blueDiamond.blueVipShow.BlueVipOutShowVo,gt=modules.commonCopy.boss.BossManager,_t=(xml.BossVO,laya.ui.Box,laya.utils.Browser),It=ui.modules.role.BuildSoulViewUI,vt=ui.modules.role.BuildySoulItemUI,bt=(laya.ui.Button,ui.modules.activity.freeMall.BuyBackDialogUI),yt=modules.shop.view.BuyGoodsView,xt=ui.modules.welfare.cdKey.CDKeyViewUI,St=ui.modules.role.CategoryPanelUI,wt=(xml.ChargeBackVO,modules.chat.ChatConst,modules.chat.ChatModule),kt=(modules.CheckForMOC.CheckForMocConst,modules.CheckForMOC.CheckForMocModule),Tt=modules.pack.CheckHasUtil,Ct=com.utils.CheckPoint,At=(xml.CityCaveBlessVO,xml.CityCaveDragonVO,xml.CityCaveOpenVO,xml.CityCaveSacriItemVO,xml.CityCaveVO,xml.CmBossDamageVO,xml.CmBossHpVO,xml.CmRankAwardVO,laya.filters.ColorFilter),Ot=com.ui.CommonBar,Pt=modules.commonCopy.CommonCopyMgr,Vt=modules.commonCopy.CommonCopyModule,Rt=com.utils.CommonUtils,Dt=laya.ui.Component,Nt=com.net.Connection,Et=ui.modules.activity.constellation.ConstellationItemUI,Bt=ui.modules.activity.constellation.ConstellationViewUI,Lt=ui.modules.activity.consumeBack.ConsumeBackItemUI,Mt=modules.activity.consumeBack.ConsumeBackMgr,Gt=ui.modules.activity.consumeBack.ConsumeBackViewUI,Ft=modules.commonCopy.copy.CopyMgr,Ut=modules.mainInfo.view.CopyNameAlert,Ht=modules.crossServer.CrossServerMgr,Wt=modules.crossServer.CrossServerModule,Kt=modules.shop.cultivation.CultivationCase,qt=modules.commonCopy.custom.CustomManager,Yt=modules.activity.customStand.CustomRankVo,Xt=ui.modules.activity.customStand.CustomStandItemUI,zt=ui.modules.activity.customStand.CustomStandViewUI,Qt=com.utils.DateUtil,jt=ui.modules.activity.dayLimitBuy.DayLimitBuyItemUI,Jt=ui.modules.activity.dayLimitBuy.DayLimitBuyViewUI,$t=modules.activity.dial.DialCase,Zt=ui.modules.activity.dial.DialDisplayItemUI,ti=ui.modules.activity.dial.DialDisplayPanelUI,ii=modules.activity.dial.DialMgr,ei=ui.modules.activity.dial.DialPanelUI,si=laya.utils.Dictionary,ni=com.managers.Dispatcher,hi=(xml.DragonCaveInfoVO,modules.athletics.encounter.view.DropItem),ai=laya.utils.Ease,oi=com.ui.EffGoodsItem,ri=com.scene.effect.Effect,li=modules.athletics.encounter.EncounterCase,ci=ui.modules.athletics.encounter.EncounterItemUI,di=ui.modules.athletics.encounter.EncounterLogItemUI,pi=ui.modules.athletics.encounter.EncounterLogPanelUI,mi=ui.modules.athletics.encounter.EncounterMainViewUI,fi=modules.athletics.encounter.EncounterManager,gi=ui.modules.athletics.encounter.EncounterWaitItemUI,_i=modules.equip.EquipManager,Ii=(xml.EquipVO,com.broadcast.ErrorCode),vi=(laya.events.Event,modules.exercise.beasts.ExerBeastsMgr),bi=modules.exercise.biography.view.ExerBiographyIssueFriendItem,yi=modules.exercise.godEquip.ExerGodEquipMgr,xi=ui.modules.fashion.FashionBeautyViewUI,Si=ui.modules.fashion.FashionGetViewUI,wi=(xml.FashionItemLvVO,xml.FashionItemVO,modules.role.view.fashion.FashionTarItem),ki=ui.modules.fashionTar.FashionTarSecViewUI,Ti=(xml.FashionTarVO,ui.modules.fashionTar.FashionTarViewUI),Ci=(xml.FdChargeVO,com.globals.FilterConst,modules.firstCharge.FirstChargeManager),Ai=modules.firstCharge.FirstChargeModule,Oi=ui.modules.activity.firstDayCharge.FirstDayChargeViewUI,Pi=com.ui.FontLabel,Vi=ui.modules.footPrint.FootPrintBeautyViewUI,Ri=ui.modules.footPrint.FootPrintChangeViewUI,Di=(modules.footPrint.FootPrintConst,ui.modules.footPrint.FootPrintItemUI),Ni=modules.footPrint.FootPrintMgr,Ei=modules.footPrint.FootPrintModule,Bi=ui.modules.footPrint.FootPrintPanelUI,Li=ui.modules.footPrint.FootPrintPurifyViewUI,Mi=(xml.FootPrintVO,xml.ForeverBuyVO,modules.welfare.fortuneCat.FortuneCatCase),Gi=modules.welfare.fortuneCat.FortuneCatConst,Fi=modules.welfare.fortuneCat.FortuneCatManager,Ui=ui.modules.activity.freeMall.FreeMallItemUI,Hi=(modules.activity.vo.FreeMallItemVO,modules.activity.freeMall.FreeMallMgr),Wi=ui.modules.activity.freeMall.FreeMallPanelUI,Ki=modules.friend.flower.FriendFlowerMgr,qi=modules.friend.FriendManager,Yi=ui.modules.navigation.FunctionBarUI,Xi=com.utils.FunctionOpenUtil,zi=(modules.gm.view.GMDebugInfo,modules.gm.GMManager),Qi=com.globals.GameColor,ji=(com.globals.GameConfig,com.globals.GameParam),Ji=com.scene.GameScene,$i=modules.activity.views.GeneralRuleView,Zi=modules.warn.getWay.GetWayUtil,te=(modules.pack.vo.GifProductVO,xml.GiftVO,com.globals.GlobalAttr),ie=com.globals.GlobalData,ee=com.globals.GlobalEquip,se=laya.filters.GlowFilter,ne=ui.modules.godHood.GodHoodSkillResetAlertUI,he=ui.modules.refineSoulPalace.GodSoulMixViewUI,ae=modules.pack.packView.GoodsImage,oe=com.ui.GoodsItem,re=modules.goodsShow.GoodsShowConst,le=(xml.GoodsVO,modules.guide.GuideTip),ce=laya.html.dom.HTMLDivElement,de=(laya.html.dom.HTMLIframeElement,laya.html.utils.HTMLParse),ue=laya.utils.Handler,pe=com.utils.HtmlUtil,me=modules.activity.huxian.HuXianChargeView,fe=(com.globals.IconConst,modules.icon.view.IconItem,modules.icon.IconManager),ge=laya.ui.Image,_e=ui.modules.activity.invest.InvestItemUI,Ie=ui.modules.activity.invest.InvestViewUI,ve=(com.globals.ItemIdConstant,modules.pack.ItemLocator),be=modules.activity.jinliDFS.JinLiDFSCase,ye=ui.modules.activity.jinliDFS.JinLiDFSItemUI,xe=modules.activity.jinliDFS.JinLiDFSMgr,Se=ui.modules.activity.jinliDFS.JinLiDFSViewUI,we=(xml.JinliItemVO,modules.activity.jubao.JuBaoVo),ke=ui.modules.activity.jubao.JubaoViewUI,Te=com.layers.LayerManager,Ce=com.utils.LayoutUtil,Ae=(xml.LevelGiftVO,com.managers.LinkManager),Oe=laya.net.Loader,Pe=laya.net.LocalStorage,Ve=(modules.log.LogConst,modules.log.LogManager),Re=(xml.LogVO,com.utils.LongClickUtil),De=com.managers.LoopManager,Ne=(com.managers.MainCommand,com.globals.MainData),Ee=modules.scene.cases.MapCase,Be=modules.scene.others.MapIDConst,Le=modules.marry.MarryMgr,Me=(com.managers.ModuleCommand,ui.modules.commonCopy.copy.MonsterCopyAwardItemUI),Ge=ui.modules.commonCopy.copy.MonsterCopyAwardPanelUI,Fe=ui.modules.commonCopy.copy.MonsterCopyBloodUI,Ue=modules.commonCopy.monsterCopy.MonsterCopyCase,He=modules.commonCopy.monsterCopy.MonsterCopyMgr,We=ui.modules.commonCopy.copy.MonsterCopyRankItemUI,Ke=ui.modules.commonCopy.copy.MonsterCopyRankPanelUI,qe=ui.modules.commonCopy.copy.MonsterCopyTopViewUI,Ye=ui.modules.commonCopy.copy.MonsterCopyViewUI,Xe=com.loaders.MyLoader,ze=modules.noble.NobleMgr,Qe=(laya.display.Node,ui.modules.system.OfflinePanelUI),je=modules.otherPet.OtherPetMgr,Je=modules.otherPet.OtherPetModule,$e=modules.otherRole.OtherRoleMgr,Ze=modules.pack.PackManager,ts=modules.pack.PackModule,is=com.scene.unit.base.PanelRichAvatar,es=modules.pfSdk.PayUtil,ss=ui.modules.athletics.petSports.PerSportsRankViewUI,ns=modules.pet.embattle.PetEmbattleItem,hs=modules.pet.embattle.PetEmbattleMgr,as=modules.pet.embattle.PetEmbattleModule,os=modules.pet.embattle.PetFightItem,rs=modules.pet.PetMgr,ls=modules.pet.PetModule,cs=modules.athletics.petSports.PetSportsCase,ds=ui.modules.athletics.petSports.PetSportsChangeItemUI,us=ui.modules.athletics.petSports.PetSportsChangeViewUI,ps=ui.modules.athletics.petSports.PetSportsGlobalLogItemUI,ms=(xml.PetSportsInfoVO,ui.modules.athletics.petSports.PetSportsItemUI),fs=ui.modules.athletics.petSports.PetSportsLogItemUI,gs=ui.modules.athletics.petSports.PetSportsLogViewUI,_s=modules.athletics.petSports.PetSportsMgr,Is=(ui.modules.athletics.petSports.PetSportsRWViewUI,ui.modules.athletics.petSports.PetSportsRankItemUI),vs=ui.modules.athletics.petSports.PetSportsRuleItemUI,bs=ui.modules.athletics.petSports.PetSportsRuleViewUI,ys=ui.modules.athletics.petSports.PetSportsSetViewUI,xs=(xml.PetSportsShopVO,modules.athletics.petSports.PetSportsUtil),Ss=modules.pet.embattle.PetTowerSkillItem,ws=modules.pfSdk.PfSdkMgr,ks=modules.pfSdk.PfSdkModule,Ts=ui.modules.activity.freeMall.PlayerOrderItemUI,Cs=ui.modules.activity.freeMall.PlayerOrderViewUI,As=modules.plays.city.PlaysCityCase,Os=ui.modules.plays.city.PlaysCityCaveBlessViewUI,Ps=ui.modules.plays.city.PlaysCityCaveChooseItemUI,Vs=ui.modules.plays.city.PlaysCityCaveDragonChoosePanelUI,Rs=ui.modules.plays.city.PlaysCityCaveDragonItemUI,Ds=ui.modules.plays.city.PlaysCityCaveItemChoosePanelUI,Ns=ui.modules.plays.city.PlaysCityCaveOpenPanelUI,Es=ui.modules.plays.city.PlaysCityCavePanelUI,Bs=ui.modules.plays.city.PlaysCityCaveSacriBookPanelUI,Ls=ui.modules.plays.city.PlaysCityCaveSacrificeItemUI,Ms=ui.modules.plays.city.PlaysCityCaveSacrificeViewUI,Gs=modules.plays.city.PlaysCityConst,Fs=modules.plays.city.PlaysCityMgr,Us=modules.plays.PlaysModule,Hs=laya.maths.Point,Ws=laya.utils.Pool,Ks=(xml.PotentialLvVO,xml.PotentialVO,com.globals.PowerConst,modules.rpMask.RPMaskConst),qs=modules.rank.view.RankAwardDisplayItem,Ys=ui.modules.rank.RankAwardDisplayPanelUI,Xs=(xml.RankCfgVO,modules.rank.RankConst),zs=ui.modules.activity.customStand.RankDetailItemUI,Qs=ui.modules.activity.customStand.RankDetailsViewUI,js=ui.modules.rank.RankListItemUI,Js=modules.rank.RankMgr,$s=modules.rank.RankModule,Zs=ui.modules.rank.RankPanelUI,tn=ui.modules.rank.RankPetListItemUI,en=ui.modules.rank.RankPetViewUI,sn=ui.modules.rank.RankRoleViewUI,nn=modules.rank.RankUtil,hn=(modules.rank.RankVO,laya.maths.Rectangle),an=com.utils.RedPointUtil,on=modules.refine.RefineConfig,rn=modules.refine.RefineConst,ln=ui.modules.refine.RefineEngraveViewUI,cn=ui.modules.refine.RefineEquipItemUI,dn=ui.modules.refine.RefineImgLinkPanelUI,un=modules.refine.RefineManager,pn=modules.refine.RefineModule,mn=ui.modules.refine.RefineQualityViewUI,fn=ui.modules.refine.RefineReinfViewUI,gn=ui.modules.refineSoulPalace.RefineSoulBagPanelUI,_n=(xml.RefineSoulEquationVO,ui.modules.refine.RefineSoulEquipItemUI),In=modules.refineSoulPalace.view.RefineSoulGoodsItem,vn=ui.modules.refineSoulPalace.RefineSoulGoodsTipUI,bn=ui.modules.refineSoulPalace.RefineSoulGridUnlockPanelUI,yn=ui.modules.refine.RefineSoulHelpPanelUI,xn=ui.modules.refineSoulPalace.RefineSoulInlayPanelUI,Sn=(xml.RefineSoulLvVO,ui.modules.refine.RefineSoulMaterialItemUI),wn=ui.modules.refineSoulPalace.RefineSoulMissionItemUI,kn=(xml.RefineSoulMissionVO,ui.modules.refineSoulPalace.RefineSoulMissionViewUI),Tn=ui.modules.refineSoulPalace.RefineSoulNoticeViewUI,Cn=modules.refineSoulPalace.RefineSoulPalaceCase,An=modules.refineSoulPalace.RefineSoulPalaceConst,On=modules.refineSoulPalace.RefineSoulPalaceManager,Pn=ui.modules.refineSoulPalace.RefineSoulPalaceViewUI,Vn=ui.modules.refineSoulPalace.RefineSoulRankItemUI,Rn=ui.modules.refineSoulPalace.RefineSoulShopItemUI,Dn=(xml.RefineSoulShopVO,ui.modules.refineSoulPalace.RefineSoulShopViewUI),Nn=ui.modules.refineSoulPalace.RefineSoulStoneItemUI,En=ui.modules.refineSoulPalace.RefineSoulStoneMixPanelUI,Bn=(xml.RefineSoulStoneVO,ui.modules.refineSoulPalace.RefineSoulStoveViewUI),Ln=ui.modules.refineSoulPalace.RefineSoulTipUI,Mn=ui.modules.refineSoulPalace.RefineSoulUpgradeViewUI,Gn=ui.modules.refine.RefineSoulViewUI,Fn=modules.refine.RefineUtil,Un=(xml.RefineVO,xml.RegrowChangeVO,xml.RegrowGoodsItemVO,xml.RegrowLvVO,ui.modules.regrow.RegrowNeedItemUI),Hn=ui.modules.regrow.RegrowNeedViewUI,Wn=ui.modules.regrow.RegrowViewUI,Kn=ui.modules.result.ResultFailPanelUI,qn=(modules.result.ResultVO,ui.modules.result.ResultWinPanelUI),Yn=com.scene.unit.base.RichAvatar,Xn=ui.modules.role.RoleAttrElementViewUI,zn=ui.modules.role.RoleAttrViewUI,Qn=modules.role.view.RoleCategoryItem,jn=ui.modules.MainInfo.RoleChangeNameViewUI,Jn=ui.modules.roleSet.RoleChangeSexViewUI,$n=modules.role.RoleConst,Zn=ui.modules.wing.RoleEquipListItemUI,th=ui.modules.fashion.RoleFashionAttrViewUI,ih=modules.role.view.fashion.RoleFashionItem,eh=modules.role.view.fashion.RoleFashionNeedItem,sh=ui.modules.fashion.RoleFashionNeedViewUI,nh=ui.modules.fashion.RoleFashionPanelUI,hh=modules.role.view.RoleHeadsPart,ah=ui.modules.welfare.roleLevelOfTimeLimit.RoleLevelOfTimeLimitViewUI,oh=modules.role.RoleManager,rh=modules.role.RoleModule,lh=(xml.RoleOpenVO,modules.roleSet.RoleSetCase),ch=modules.roleSet.RoleSetCityItem,dh=ui.modules.role.RoleSetCityItem2UI,uh=ui.modules.roleSet.RoleSetCityViewUI,ph=(modules.roleSet.RoleSetConst,modules.roleSet.RoleSetHeadItem),mh=modules.roleSet.RoleSetMgr,fh=ui.modules.roleSet.RoleSetReorderViewUI,gh=modules.roleSet.RoleSetSelfBubbleItem,_h=ui.modules.roleSet.RoleSetSelfBubbleTipUI,Ih=(xml.RoleSetSelfBubbleVO,ui.modules.roleSet.RoleSetSelfBubbleViewUI),vh=modules.roleSet.RoleSetSelfFrameItem,bh=ui.modules.roleSet.RoleSetSelfFrameTipUI,yh=(xml.RoleSetSelfFrameVO,ui.modules.roleSet.RoleSetSelfFrameViewUI),xh=modules.roleSet.RoleSetSelfMgr,Sh=ui.modules.roleSet.RoleSetSelfPanelUI,wh=ui.modules.roleSet.RoleSetViewUI,kh=ui.modules.role.RoleSpecialEquipViewUI,Th=modules.role.view.wings.RoleWingEquipItem,Ch=ui.modules.wing.RoleWingEquipViewUI,Ah=modules.rpMask.RpMaskMgr,Oh=modules.rpMask.RpMaskModule,Ph=modules.rpMask.RpMaskSetBtn,Vh=com.sdk.SDKUtil,Rh=modules.scene.SceneManager,Dh=modules.scene.SceneModule,Nh=(com.globals.ScoreConst,com.sdk.SdkConst,ui.modules.activity.serverLimitBuy.ServerLimitBuyItemUI),Eh=(modules.activity.serverLimitBuy.ServerLimitBuyItemVo,modules.activity.serverLimitBuy.ServerLimitBuyVO,ui.modules.activity.serverLimitBuy.ServerLimitBuyViewUI),Bh=ui.modules.shop.ShopBattlefieldViewUI,Lh=modules.shop.ShopConst,Mh=ui.modules.shop.ShopCultivationItemUI,Gh=ui.modules.shop.ShopCultivationViewUI,Fh=ui.modules.shop.ShopEngraveViewUI,Uh=ui.modules.shop.ShopGoodsItemUI,Hh=ui.modules.shop.ShopGoodsViewUI,Wh=modules.shop.ShopManager,Kh=modules.shop.ShopModule,qh=ui.modules.shop.ShopMysteryItemUI,Yh=ui.modules.shop.ShopMysteryViewUI,Xh=ui.modules.shop.ShopPanelUI,zh=ui.modules.shop.ShopScoreItemUI,Qh=ui.modules.shop.ShopScoreViewUI,jh=(xml.ShopTypeItemVO,xml.ShopTypeVO,modules.skill.book.SkillBookCase),Jh=ui.modules.skill.book.SkillBookComposePanelUI,$h=modules.skill.book.SkillBookConst,Zh=modules.skill.book.view.SkillBookItem,ta=ui.modules.skill.book.SkillBookLearnItemUI,ia=ui.modules.skill.book.SkillBookLearnPanelUI,ea=ui.modules.skill.book.SkillBookListItemUI,sa=modules.skill.book.SkillBookMgr,na=ui.modules.skill.book.SkillBookReplacePanelUI,ha=(xml.SkillBookVO,ui.modules.skill.book.SkillBookViewUI),aa=ui.modules.skill.book.SkillHandBookPanelUI,oa=modules.skill.SkillManager,ra=(xml.SkillStepVO,ui.modules.skill.SkillStepViewUI),la=(xml.SkillVO,ui.modules.skill.SkillViewUI),ca=ui.SmoothBar,da=modules.athletics.snatch.SnatchCase,ua=modules.athletics.snatch.view.SnatchMainView,pa=modules.athletics.snatch.SnatchManager,ma=(com.net.SocketCommand,modules.athletics.soloRanking.SoloRankingCase),fa=modules.athletics.soloRanking.SoloRankingConst,ga=(modules.athletics.soloRanking.SoloRankingDetailVO,modules.athletics.soloRanking.SoloRankingManager),_a=ui.modules.athletics.soloRanking.SoloRankingMatchPanelUI,Ia=ui.modules.athletics.soloRanking.SoloRankingRankItemUI,va=ui.modules.athletics.soloRanking.SoloRankingRankPanelUI,ba=ui.modules.athletics.soloRanking.SoloRankingResultPanelUI,ya=ui.modules.athletics.soloRanking.SoloRankingSettlementPanelUI,xa=ui.modules.athletics.soloRanking.SoloRankingViewUI,Sa=ui.modules.refineSoulPalace.SoulGridItemUI,wa=(xml.SpEquipVO,modules.activity.vo.SpcActVO,modules.spcBuy.SpcBuyMgr,modules.activity.vo.SpcMainVO,modules.role.view.SpequipDataVO),ka=ui.modules.Equip.SpequipPotentialSubItemUI,Ta=(modules.exercise.spiriTreasure.SpiriTreMgr,laya.display.Sprite),Ca=ui.modules.rank.StandardRechargeRankItemUI,Aa=ui.modules.rank.StandardRechargeRankPanelUI,Oa=(modules.story.StoryConst,modules.story.StoryManager),Pa=modules.story.StoryModule,Va=(xml.StoryVO,ui.modules.story.StoryViewUI),Ra=ui.modules.activity.strBeastLimit.StrBeastLimitViewUI,Da=laya.utils.StringTool,Na=s.SubViewMgr,Ea=ui.modules.footPrint.SuitPanelUI,Ba=ui.modules.activity.suitShow.SuitShowViewUI,La=xml.SuitVO,Ma=modules.system.SystemManager,Ga=modules.system.SystemModule,Fa=modules.exercise.talisman.TalimanMgr,Ua=ui.modules.fashion.TarItemUI,Ha=(xml.TarVO,ui.modules.MainInfo.TendingViewUI),Wa=laya.display.Text,Ka=(laya.ui.TextInput,laya.resource.Texture,com.toolTip.TipType,ui.modules.Title.TitleAllAttrPanelUI),qa=ui.modules.Title.TitleAttrItemUI,Ya=modules.title.TitleConst,Xa=ui.modules.Title.TitleGetViewUI,za=ui.modules.Title.TitleInfoItemUI,Qa=modules.title.view.TitleItem,ja=modules.title.TitleMgr,Ja=modules.title.TitleModule,$a=ui.modules.Title.TitlePanelUI,Za=ui.modules.Title.TitleStateItemUI,to=(xml.TitleVO,com.toolTip.ToolTipManager),io=com.utils.TopTip,eo=(xml.TowerSkillVO,laya.utils.Tween),so=com.utils.UICreater,no=com.managers.UILoaderManager,ho=(modules.activity.userBack.UserBackView,laya.ui.View),ao=ui.modules.vip.Vip3PanelUI,oo=(modules.vip.VipConst,modules.vip.VipMgr),ro=modules.vip.VipModule,lo=ui.modules.vip.VipPanelUI,co=(xml.VipVO,xml.WanbaGiftVO,ui.modules.welfare.wanbaGift.WanbaGiftViewUI),uo=ui.modules.welfare.wanbaVipGift.WanbaVIpGiftListItemUI,po=(xml.WanbaVipGiftVO,modules.welfare.wanbaVipGift.WanbaVipHelpPanel),mo=ui.modules.welfare.wanbaVipGift.WanbaVipViewUI,fo=ui.modules.welfare.weekCard.WeekCardPanelUI,go=modules.welfare.gift.WelareGiftCase,_o=ui.modules.welfare.appLoad.WelfareAppLoadViewUI,Io=modules.welfare.weChat.WelfareBuluoGuideView,vo=(xml.WelfareDesVO,ui.modules.welfare.fortuneCat.WelfareFortuneCatConfirmPanelUI),bo=ui.modules.welfare.fortuneCat.WelfareFortuneCatViewUI,yo=ui.modules.welfare.WelfareGift.WelfareGiftItemUI,xo=modules.welfare.gift.WelfareGiftMgr,So=(xml.WelfareGiftVO,ui.modules.welfare.WelfareGift.WelfareGiftViewUI),wo=modules.welfare.honorVIP.WelfareHonorVIPFanTiView,ko=modules.welfare.honorVIP.WelfareHonorVIPView,To=modules.icon.view.WelfareIconItem,Co=modules.welfare.WelfareMgr,Ao=modules.welfare.WelfareModule,Oo=modules.welfare.montyCard.WelfareMonthCardMgr,Po=ui.modules.welfare.monthCard.WelfareMonthCardNewViewUI,Vo=modules.welfare.notice.WelfareNoticeCase,Ro=modules.welfare.notice.WelfareNoticeMgr,Do=ui.modules.WelfareNoticeUpViewUI,No=ui.modules.welfare.notice.WelfareNoticeViewUI,Eo=ui.modules.welfare.WelfarePanelUI,Bo=ui.modules.welfare.recover.WelfareRecoverItemUI,Lo=(xml.WelfareRecoverVO,ui.modules.welfare.recover.WelfareRecoverViewUI),Mo=ui.modules.welfare.setQzoonBG.WelfareSetQZoonBgViewUI,Go=modules.welfare.wanBa.WelfareWanbaTopicView,Fo=modules.welfare.weChat.WelfareWeChatGiftView,Uo=modules.welfare.weekCard.WelfareWeekCardMgr,Ho=com.managers.WindowManager,Wo=(xml.WingStarVO,xml.WingVO,ui.modules.activity.yunyou.YunyouAlertUI),Ko=modules.activity.yunyou.YunyouCase,qo=modules.activity.yunyou.YunyouMgr,Yo=ui.modules.activity.yunyou.YunyouRecordViewUI,Xo=(modules.activity.yunyou.YunyouSubVO,ui.modules.activity.yunyou.YunyouViewUI),zo=modules.commonCopy.zhuXianRoadCopy.ZhuXianRoadCopyCase,Qo=ui.modules.athletics.petSports.petSportsViewUI,jo=ui.modules.fashion.suitInfoItemUI,Jo=(function(){function t(){console.log("%cSubView==========================================","font-size:40px;color:#666666;")}l(t,"SubView")}(),function(t){function i(){this._data=null,this.item=null,this.info=null,this.imgBg=null,this.newImG=null,i.__super.call(this),this.imgBg=new ge,this.imgBg.skin="com/ui/innerBg2.png",this.imgBg.sizeGrid="12,21,17,26",this.addChild(this.imgBg),this.imgBg.size(730,130),this.imgBg.on("click",this,this.onClickBg),this.item=new Qa,this.item.on("TitleItem.EVENT",this,this.onClick),this.addChild(this.item),this.info=Na.getIns(57e3,"TitleInfoItem"),this.addChild(this.info),this.info.y=this.item.y+this.item.height,this.info.visible=!1,this.newImG=new ge,this.newImG.skin="modules/role/new.png",this.addChild(this.newImG)}l(i,"modules.title.TitleListItem",t);var e=i.prototype;e.onClick=function(t){this.infoVisible=t,this.imgBg.height=t?this.info.y+this.info.height:this.item.y+this.item.height,ni.dispatch("UPDATE_TITLE_PANEL")},e.onClickBg=function(){1==this.newImG.visible&&(ja.deleteNewTitle(this._data.id),this.newImG.visible=!1)},e.reset=function(){this.infoVisible=!1,this.item.resetBtn()},e.updateHeight=function(){this.imgBg.height=this.info.visible?this.info.y+this.info.height:this.item.y+this.item.height},o(0,e,"data",function(){return this._data},function(t){this._data=t,this.item.data=this._data,this.info.data=this._data,this.data&&!ja.isHas(this.data.id)&&ja.deleteNewTitle(this._data.id),null!=ja.newTitles&&0<ja.newTitles.length?this.newImG.visible=-1!=ja.newTitles.indexOf(t.id):this.newImG.visible=!1}),o(0,e,"infoVisible",null,function(t){this.info.visible=t,this.updateHeight()}),o(0,e,"height",function(){return this.info.visible?this.info.y+this.info.height:this.item.y+this.item.height},t.prototype._$set_height)}(Ta),function(t){function i(){this.txtName=null,i.__super.call(this),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.init()}l(i,"modules.refineSoulPalace.RefineSoulBagGoodsItem",ae);var e=i.prototype;e.init=function(){this.txtName=this.txtName||new Wa,this.txtName.pos(0,99),this.txtName.text="物品",this.txtName.fontSize=20,this.txtName.align="center",this.txtName.color="#5d3924",this.addChild(this.txtName)},e.onDisplay=function(){if(this._dataSource&&this._dataSource.typeid){var t=ve.getItem(this._dataSource.typeid);t&&1030==t.useType?an.register("PR_REFINE_SOUL_PALACE_BAG",this.imgContent):an.unRegister(this.imgContent)}else De.setTimeout(this,this.onDisplay,null,200)},e.update=function(){this.pData=this._dataSource,this.vo&&(this.vo.name?(this.txtName.visible=!0,this.isSoulStone(this.vo.id)?this.txtName.text=this.vo.name+"+"+this.quality:this.txtName.text=this.vo.name):this.txtName.visible=!1,this.vo.color&&(this.txtName.color=Qi.getColorDark(this.vo.color)),this._dataSource.current_num&&(this.showNum(!0),this.txtNum.text=this._dataSource.current_num))},e.onClick=function(t){if(t.target instanceof modules.pack.packView.GoodsImage&&this._dataSource&&this._dataSource.typeid)if(this.isSoulStone(this._dataSource.typeid))Cn.ins().showGoodsTip(this._dataSource);else{var i=ve.getItem(this._dataSource.typeid);i&&i.useType%1e3==24?lh.ins.openFrameTip(this._dataSource):i&&i.useType%1e3==25?lh.ins.openBubbleTip(this._dataSource):to.show(this._dataSource,Ze.getItemToolTipType(this._dataSource.typeid))}},e.isSoulStone=function(t){var i=On.refineSoulStone;if(i)for(var e in i)if(i[e].id==t)return!0;return!1},o(0,e,"dataSource",function(){return this._dataSource},function(t){for(var i in this._dataSource=t,this._dataSource)this.hasOwnProperty(i)&&(this[i]=this._dataSource[i]);this.update()}),o(0,e,"vo",function(){return this._dataSource?ve.getItem(this._dataSource.typeid):null}),o(0,e,"quality",function(){return this._dataSource?On.getSoulStoenQualityById(this._dataSource.id):0})}(),function(t){function n(){n.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.size(580,822),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay)}l(n,"modules.welfare.wechatShare.WeChatShareView",ho);var i=n.prototype;i.onClick=function(){},i.onUnDisplay=function(){n.wechatImage&&n.wechatImage.parentElement&&_t.container.removeChild(n.wechatImage),0==ws.getRewardTimes(4,0)&&ks.ins().checkSubscribed()},i.__init__=function(){null==n.wechatImage&&this._createInputElement()},i._createInputElement=function(){n.wechatImage=_t.document.createElement("img");var t={position:"absolute"};for(var i in t)n.wechatImage.style[i]=t[i];var e="modules/welfare/img/wechatShare.png";e=Xe.basePath+e+"?v="+ji.v,n.wechatImage.src=e,s.stage.on("resize",null,this.resetPos)},i.onDisplay=function(){this.__init__(),_t.container.appendChild(n.wechatImage),this.resetPos()},i.update=function(){},i.resetPos=function(){if(n.wechatImage&&n.wechatImage.parentElement){var t=580*Te.uiScale/_t.pixelRatio,i=822*Te.uiScale/_t.pixelRatio,e=(Te.stageWidth-580)/2*Te.uiScale/_t.pixelRatio,s=(Te.stageHeight-822)/2*Te.uiScale/_t.pixelRatio;n.wechatImage.style.top=s+"px",n.wechatImage.style.right=e+"px",n.wechatImage.style.width=t+"px",n.wechatImage.style.height=i+"px"}},n.wechatImage=null}(),function(t){function i(){this._data=null,this.imgArr=null,this.clipArr=null,i.__super.call(this),this.txtDesc.text="累计送花",this.imgGold.skin="modules/act/charge/actFlower.png",this.on("click",this,this.onClick)}l(i,"modules.activity.cumulativeFlower.ActCumulativeFlowerItem",a);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnGet:if(!this._data)return;switch(this._data.state){case 11:L.ins().toGain(this._data.actID,this._data.conID);break;case 22:break;default:var i=new q;i.msg=pe.span("您未达到奖励领取条件哦，是否前往送花？","#5d3924",26),i.yesFun=function(){Ae.linkTo(11505),Ve.send(10063,3,"累计送花-不可领按钮")},i.yesCaller=this,K.showVO(i)}break;default:if(t.target instanceof modules.athletics.encounter.view.DropItem){var e=t.target;e.data.tempNum=e.num,to.show(e.data,"BASE_GOODS_TIP")}}},o(0,e,"data",null,function(t){switch(this._data=t,this.txtNeed.text=this._data.need+"",this.txtNow.visible&&(this.txtNow.text=this._data.now+"/"+this._data.need),this._data.state){case 11:this.btnGet.visible=!0,this.btnGet.disabled=!1,this.btnGet.label="领取",this.imgRp.visible=!0;break;case 22:this.btnGet.visible=!0,this.btnGet.disabled=!0,this.btnGet.label="已领取",this.imgRp.visible=!1;break;default:this.btnGet.visible=!0,this.btnGet.disabled=!1,this.btnGet.label="不可领",this.imgRp.visible=!1}this.imgArr=this.imgArr||[];for(var i=0;i<this.imgArr.length;i++)this.imgArr[i]&&this.imgArr[i].parent&&this.imgArr[i].removeSelf();var e,s=this._data.awards.length;for(var n in this.clipArr=this.clipArr||[],this.clipArr)(e=this.clipArr[n]).removeSelf();var h=0;for(i=0;i<s;i++){this.imgArr[i]=this.imgArr[i]||new hi("");var a=this.imgArr[i];a.txtName.fontSize=24,a.mouseEnabled=!0;var o=new Object;o.className="p_tkv",o.type=5,o.id=this._data.awards[i].type_id,o.val=this._data.awards[i].num,a.setDrop(o),a.x=22+113*i,a.y=22,this.addChild(a),1==this._data.awards[i].reserve&&(this.clipArr[h]=this.clipArr[h]||ut.getOne(),(e=this.clipArr[h]).mouseEnabled=!1,e.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),e.pos(a.x+47,a.y+93),this.addChild(e),h++)}}),o(0,e,"uiClass",function(){return"ActChargeItem"})}(),function(t){function e(){this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this._itemArr=null,this._spcMainVO=null,e.__super.call(this),this.btnGet1.label="前往消费",this.pan.vScrollBarSkin="",this.on("click",this,this.onClick),this.on("display",this,this.onDisplay)}l(e,"modules.activity.cumulationConsume.ActCumulativeConsume",r);var i=e.prototype;s.imps(i,{"modules.activity.IActivityView":!0}),i.onClick=function(t){switch(t.target){case this.imgTip:$i.ins.showMessage(this._spcMainVO.rule);break;case this.btnGet1:Ae.linkTo(10103)}},i.onDisplay=function(){De.addToSecond(this,this.timeLoop),this.on("undisplay",this,this.onUnDisplay)},i.onUnDisplay=function(){De.removeFromSceond(this,this.timeLoop),this.off("undisplay",this,this.onUnDisplay)},i.update=function(){if(this.titleBg.skin="modules/act/cumulativeConsume/titleBg.png",this._spcMainVO=G.getActDetailByActID(this.actID[0]),this._spcMainVO){this.txtDesc.innerHTML=this._spcMainVO.desc,this._itemArr=this._itemArr||[],this._spcMainVO.items.sort(e.memSortFun);for(var t=this._spcMainVO.items.length,i=0;i<t;i++)this._itemArr[i]=this._itemArr[i]||new n(this.typeID[0]),this._itemArr[i].x=0,this._itemArr[i].y=165*i,this._itemArr[i].data=this._spcMainVO.items[i],this.pan.addChild(this._itemArr[i]);this.parent&&De.addToSecond(this,this.timeLoop)}},i.timeLoop=function(){this._spcMainVO&&this._spcMainVO.endTime>Ma.serverTime?this.txtLeftTime.text=Qt.formatDHMS(this._spcMainVO.endTime-Ma.serverTime):(De.removeFromSceond(this,this.timeLoop),this.txtLeftTime.text="活动已结束")},i.callBackUpdate=function(){this.update()},o(0,i,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,i,"iconID",function(){return this._iconID},function(t){this._iconID=t}),o(0,i,"uiClass",function(){return"ActChargeView"}),o(0,i,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,i,"actID",function(){return this._actIDs},function(t){this._actIDs=t}),e.memSortFun=function(t,i){var e=F.STATE_SORT_ARR.indexOf(t.state),s=F.STATE_SORT_ARR.indexOf(i.state);return e<s?-1:s<e?1:t.need<i.need?-1:t.need>i.need?1:0}}(),function(t){function i(){this.itemArr=null,this.curVO=null,this._typeID=null,this._actID=null,this._iconID=NaN,this._skinID=NaN,i.__super.call(this),this.pan.vScrollBarSkin="",this.btnGet1.label="前往送花",this.on("display",this,this.onDisplay),this.on("click",this,this.onClick),this.txtDesc.style.fontSize=24,this.txtDesc.style.color="#621e09"}l(i,"modules.activity.cumulativeFlower.ActCumulativeFlowerView",r);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onClick=function(t){switch(t.target){case this.imgTip:$i.ins.showMessage(this.curVO.rule);break;case this.btnGet1:Ae.linkTo(11505),Ve.send(10063,2,"累计送花-购买鲜花")}},e.onDisplay=function(){De.addToSecond(this,this.timeLoop),this.on("undisplay",this,this.onUNDisplay)},e.onUNDisplay=function(){De.removeFromSceond(this,this.timeLoop),this.off("undisplay",this,this.onUNDisplay)},e.timeLoop=function(){this.curVO&&this.curVO.endTime>Ma.serverTime?this.txtLeftTime.text=Qt.formatDHMS(this.curVO.endTime-Ma.serverTime):(De.removeFromSceond(this,this.timeLoop),this.txtLeftTime.text="活动已结束")},e.update=function(){if(this.curVO=G.getActDetailByActID(this.actID[0]),this.curVO){this.titleBg.skin="modules/act/cumulativeFlower/actBg.png",this.txtDesc.innerHTML=this.curVO.desc,this.itemArr=this.itemArr||[],this.curVO.items.sort(this.memSortFun);for(var t=this.curVO.items.length,i=0;i<t;i++)this.itemArr[i]=this.itemArr[i]||Na.getIns(1e3,"cumulativeFlower.ActCumulativeFlowerItem"),this.itemArr[i].x=0,this.itemArr[i].y=165*i,this.itemArr[i].data=this.curVO.items[i],this.pan.addChild(this.itemArr[i]);this.parent&&De.addToSecond(this,this.timeLoop)}},e.memSortFun=function(t,i){var e=F.STATE_SORT_ARR.indexOf(t.state),s=F.STATE_SORT_ARR.indexOf(i.state);return e<s?-1:s<e?1:0},e.callBackUpdate=function(){this.update()},o(0,e,"skinID",function(){return this._skinID},function(t){this._skinID=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t}),o(0,e,"uiClass",function(){return"ActChargeView"}),o(0,e,"typeID",function(){return this._typeID},function(t){this._typeID=t}),o(0,e,"actID",function(){return this._actID},function(t){this._actID=t})}(),function(t){function s(){this.items=null,s.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick),this.pan.vScrollBarSkin="";var t,i=_s.shopVOs;if(this.items=this.items||[],i)for(var e=0;e<i.length;e++)this.items[e]=this.items[e]||Na.getIns(3e3,"petSports.PetSportsChangeItem"),(t=this.items[e]).data=i[e],t.pos(0,150*e),this.pan.addChild(t)}l(s,"modules.athletics.petSports.PetSportsChangeView",us);var i=s.prototype;i.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose1:this.closeWindow()}},i.update=function(){for(var t=0;t<this.pan.numChildren;t++)this.pan.getChildAt(t).update();this.txt1.text=ie.getScore(20)+"",this.txt2.text=ie.getScore(21)+""}}(),function(t){function i(){this.items=null,i.__super.call(this),this.pan.vScrollBarSkin=""}l(i,"modules.athletics.petSports.PetSportsRWView",us);var e=i.prototype;e.update=function(){var t=_s.getPetArenaShopInfo();if(t){this.items=this.items||[];for(var i=Math.max(t.shop_rows.length,this.items.length),e=0;e<i;e++)e<t.shop_rows.length&&(this.items[e]=this.items[e]||Na.getIns(3e3,"petSports.PetSportsChangeItem"),this.items[e].data=t.shop_rows[e])}else cs.ins.toPetAreanShop()},o(0,e,"uiClass",function(){return"PetSportsChangeView"})}(),function(t){function n(){this.completeHanlder=null,this.items=null,this.myItems=null,this.othItems=null,this.repeatX=5,this.posArr=[[27,60],[122,60],[217,60],[27,156],[122,156],[217,156]],this.timeOutKey=NaN,this.itemCopy=null,this.itemEmbattleCopy=null,this._selectPet=null,this.towerSkillArr=null,this._petData=null,this._roleData=null,n.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.completeHanlder=ue.create(this,this.checkBtnVisible),this.list.itemRender=os,this.list.mouseHandler=new ue(this,this.onClickPet),this.list.repeatX=this.repeatX,this.fTab1.selectedIndex=0,this.fTab1.setItemSize(90,50),this.fTab.setItemSize(90,50),this.fTab.selectedIndex=0,this.items=[];for(var t=0;t<this.posArr.length;t++){var i=new ns;i.pos(this.posArr[t][0],this.posArr[t][1]),this.imgLeft.addChild(i),this.items.push(i)}for(this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.on("mousedown",this,this.onMouseDown),this.list.renderHandler=new ue(this,this.onRenderHandler),this.myItems=[],t=0;t<6;t++)(i=new ns).mouseEnabled=!1,i.pos(this.posArr[t][0]+28,this.posArr[t][1]+316),this.sp.addChild(i),this.myItems.push(i);for(this.othItems=[],t=0;t<6;t++){var e=new ns,s=t<3?t+3:t-3;e.pos(this.posArr[s][0]+28,this.posArr[s][1]+23),e.dataSource=t+1,this.sp.addChild(e),this.othItems.push(e)}this.fTab1.on("change",this,this.fTab1Change),this.fTab.on("change",this,this.fTabChange),this.tab.on("change",this,this.checkOpen),this.tab.selectedIndex=0}l(n,"modules.athletics.petSports.PetSportsSetView",ys);var i=n.prototype;i.showFinger=function(){rs.pets&&0<rs.pets.length?(this.imgFinger.visible=!0,this.imgFinger.pos(83,46),eo.to(this.imgFinger,{x:61,y:216},1200,null,ue.create(this,this.timeOutToShow,null,!0),300,!0)):this.hideFinger()},i.timeOutToShow=function(){this.timeOutKey=De.setTimeout(this,this.showFinger,null,300)},i.hideFinger=function(){this.imgFinger.visible=!1,eo.clearAll(this.imgFinger),De.clearTimeout(this.timeOutKey)},i.fTab1Change=function(){cs.ins.toPetArenaSetEmbattleIndex(this.fTab1.selectedIndex+5),this.updatePetEmbattle()},i.fTabChange=function(){cs.ins.toPetArenaSetEmbattleIndex(this.fTab.selectedIndex+5),this.updatePetFightDesc()},i.updatePetFightDesc=function(){if(this.sp.parent){for(var t=rs.getEmbattleByIndex(this.fTab.selectedIndex+5),i=1;i<7;i++){var e=this.myItems[i-1];e.index=this.fTab.selectedIndex+5,t[i]?e.dataSource=t[i]:e.dataSource=null}as.ins().toPetEmbattlePower(ie.roleID,this.fTab.selectedIndex+5)}},i.onMouseDown=function(t){t.target instanceof modules.pet.embattle.PetEmbattleItem&&null!=t.target.data&&this.spEff.visible&&(null==this.itemEmbattleCopy&&(this.itemEmbattleCopy=new ns,this.itemEmbattleCopy.mouseEnabled=!1),this.itemEmbattleCopy.index=this.fTab1.selectedIndex+5,this.itemEmbattleCopy.dataSource=t.target.data,this.itemEmbattleCopy.pos(t.target.x,t.target.y),this.imgLeft.addChild(this.itemEmbattleCopy),this.itemEmbattleCopy.startDrag(null,!1,0),this.imgKuang.visible=!0,this.stage.on("mouseup",this,this.onItemEmbattleCopyUp))},i.onItemEmbattleCopyUp=function(t){if(this.itemEmbattleCopy.removeSelf(),this.imgKuang.visible=!1,this.stage.off("mouseup",this,this.onItemEmbattleCopyUp),t.target instanceof modules.pet.embattle.PetEmbattleItem){if(t.target.data!=this.itemEmbattleCopy.data){var i,e,s=t.target;for(e in this.items)if((i=this.items[e]).index=this.fTab1.selectedIndex+5,i.data&&i.data.pet_id==this.itemEmbattleCopy.data.pet_id){i.dataSource=s.data;break}s.dataSource=this.itemEmbattleCopy.data;var n=this.items.indexOf(s);as.ins().toPetEmbattleChangePos(this.itemEmbattleCopy.data.pet_id,this.fTab1.selectedIndex+5,n+1)}}else for(e in this.items)if((i=this.items[e]).index=this.fTab1.selectedIndex+5,i.data&&i.data.pet_id==this.itemEmbattleCopy.data.pet_id){i.dataSource=null,as.ins().toPetEmbattleChangePos(this.itemEmbattleCopy.data.pet_id,this.fTab1.selectedIndex+5,0);break}this.selectPet=this.itemEmbattleCopy.data,this.updatePetDesc()},i.onClickPet=function(t,i){if("mousedown"==t.type){var e=this.list.getCell(i);this.itemCopy=this.itemCopy||new os,this.itemCopy.dataSource=e.data,this.itemCopy.pivotX=this.itemCopy.pivotY=0,this.itemCopy.pos(e.x+this.list.x,e.y+this.list.y),this.spEff.addChild(this.itemCopy),this.itemCopy.startDrag(null,!1,0),this.imgKuang.visible=!0,this.stage.on("mouseup",this,this.onItemCopyUp)}},i.onItemCopyUp=function(t){var i;this.itemCopy.removeSelf(),this.imgKuang.visible=!0,this.stage.off("mouseup",this,this.onItemCopyUp);var e=0;for(s in this.items)null!=(i=this.items[s]).data&&++e;if(e<5||t.target.data){if(t.target instanceof modules.pet.embattle.PetEmbattleItem&&t.target.data!=this.itemCopy.data){var s,n=t.target;for(s in this.items)if((i=this.items[s]).index=this.fTab1.selectedIndex+5,i.data&&i.data.pet_id==this.itemCopy.data.pet_id){i.dataSource=n.data;break}n.dataSource=this.itemCopy.data;var h=this.items.indexOf(n);as.ins().toPetEmbattleChangePos(this.itemCopy.data.pet_id,this.fTab1.selectedIndex+5,h+1)}}else io.addTip("阵法中最多只能上阵5只仙宠哦！");this.selectPet=this.itemCopy.data,this.updatePetDesc()},i.checkOpen=function(){switch(this.tab.selectedIndex){case 0:this.spEff.visible=!1,this.sp.visible=!0,this.hideFinger();break;case 1:this.spEff.visible=!0,this.sp.visible=!1}this.update()},i.update=function(t){void 0===t&&(t=0),this.sp.visible&&this.updateSp(),this.spEff.visible&&this.updatePetEmbattle()},i.updateSp=function(){this.txtName2.text=ie.roleName;var t=_s.getPetArenaInfo();t&&(this.txtRank2.text=t.ranking+"",as.ins().toPetEmbattlePower(ie.roleID,this.fTab.selectedIndex+5),this.txtTime.text=t.remaining_challenge_times+"次",this.txtS.x=(666-(this.txtS.textWidth+this.txtTime.textWidth))/2,this.txtTime.x=this.txtS.x+this.txtS.textWidth),this.updatePetFightDesc()},i.updatePower=function(t){_s.getPetArenaInfo();t==ie.roleID&&(this.txtPow2.text=te.getShortenPowerStr(hs.getPetEmbattlePower(t,this.fTab.selectedIndex+5)))},i.onRenderHandler=function(t,i){var e=t;if(e.data){var s;for(var n in e.select=this._selectPet&&e.data&&e.data.pet_id==this._selectPet.pet_id,this.items)if((s=this.items[n]).data&&s.data.pet_id==e.data.pet_id)return void(e.isFight=!0);e.isFight=!1}},i.updatePetDesc=function(){if(this._selectPet){var t,i,e,s=Math.floor(this._selectPet.type_id%1e5/1e4);if(this.selPetBg.skin="com/ui/goodsBg"+s+".png",this.selPetImg.skin="com/petHead/"+this._selectPet.skin_id+".png",this.txtLv.text="LV."+this._selectPet.level,this.txtName.text=this._selectPet.pet_name,this.txtName.color=Qi.getColorDark(s),this._selectPet.embattle_info&&this.selectPet.embattle_info.embattles&&0<this.selectPet.embattle_info.embattles.length)for(var n in this.selectPet.embattle_info.embattles)if((i=this.selectPet.embattle_info.embattles[n]).index==this.fTab1.selectedIndex+5){t=hs.getTowerSkill(i.embattle_skill);break}for(var h in this.txtSkill.text=t?"特技："+t.name:"",this.towerSkillArr)(e=this.towerSkillArr[h]).select=t&&e&&e.data&&e.data.id==t.id}else this.selPetBg.skin=null,this.selPetImg.skin=null,this.txtLv.text="",this.txtName.text="",this.txtSkill.text=""},i.updatePetEmbattle=function(){if(this.spEff.parent){var t,i,e;if(this.updateList(),this.updateLeftEmbattle(),null==this.selectPet){for(var s in this.items)if(null!=(t=this.items[s]).data){this.selectPet=t.data;break}}else for(e in this.items)(i=this.items[e]).select=this.selectPet==i.data;null==this.selectPet&&rs.pets&&0<rs.pets.length&&(this.selectPet=rs.pets[0]);var n=hs.getTowerSkills(),h=0,a=0;this.towerSkillArr=this.towerSkillArr||[];for(var o,r=Math.max(this.towerSkillArr.length,n.length),l=0;l<r;l++)l<n.length?(o=n[l],null==this.towerSkillArr[l]&&(this.towerSkillArr[l]=new Ss,this.imgRight.addChild(this.towerSkillArr[l])),1<(this.towerSkillArr[l].data=o).getFightPos().length?(this.towerSkillArr[l].pos(a%3*102+17,60*Math.floor(a/3)+527),++a):(this.towerSkillArr[l].pos(h%3*102+17,60*Math.floor(h/3)+244),++h)):this.towerSkillArr[l]&&this.towerSkillArr[l].parent&&this.towerSkillArr[l].removeSelf();this.updatePetDesc()}},i.updateLeftEmbattle=function(){for(var t=rs.getEmbattleByIndex(this.fTab1.selectedIndex+5),i=!1,e=1;e<7;e++){var s=this.items[e-1];s.index=this.fTab1.selectedIndex+5,t[e]?(s.dataSource=t[e],i=!0):s.dataSource=null}i?this.hideFinger():this.showFinger()},i.updateList=function(){rs.pets?(this.list.dataSource=rs.pets,this.checkBtnVisible()):ls.ins().toPetInfo();for(var t=0;t<this.list.content._childs.length;t++)this.list.content._childs[t].y=(this.list.height-this.list.content._childs[t].height)/2},i.onDisplay=function(){ni.register("PET_INFO_INIT",this,this.updateList),ni.register("SELECT_TOWERSKILL",this,this.selectTowerSkill),ni.register("PET_TOWER_UPDATE",this,this.update),ni.register("UPDATE_PETEMBATTLE_POWER",this,this.updatePower),ni.register("CHANGE_PETSPORTS_EMBATTLE",this,this.changeIndex),this.on("undisplay",this,this.onUndisplay);var t=_s.getPetArenaInfo();t&&this.changeIndex(t.using_embattle_index)},i.changeIndex=function(t){5<=t&&(this.sp&&(this.fTab.selectedIndex=t-5),this.spEff&&(this.fTab1.selectedIndex=t-5))},i.onUndisplay=function(){ni.remove("PET_INFO_INIT",this,this.updateList),ni.remove("SELECT_TOWERSKILL",this,this.selectTowerSkill),ni.remove("PET_TOWER_UPDATE",this,this.update),ni.remove("UPDATE_PETEMBATTLE_POWER",this,this.updatePower),ni.remove("CHANGE_PETSPORTS_EMBATTLE",this,this.changeIndex),this.off("undisplay",this,this.onUndisplay)},i.selectTowerSkill=function(t){this.selectPet&&as.ins().toPetEmbattleChangeSkill(this.selectPet.pet_id,this.fTab1.selectedIndex+5,t.id)},i.updatePets=function(t){if(this._petData=t,this._petData){console.log("更新他人的宠物");for(var i=1;i<7;i++){var e,s,n=this.othItems[i-1],h=null;for(var a in t.pets)if((s=t.pets[a])&&s.embattle_info&&s.embattle_info.embattles&&s.embattle_info.embattles[0]&&s.embattle_info.embattles[0].embattle_pos==i){(h=(e=s).embattle_info.embattles[0]).index;break}h?(n.dataSource=e,n.embattleSkill=h.embattle_skill):(n.dataSource=null,n.embattleSkill=0)}}},i.updateRoles=function(t){this._roleData=t,this._roleData&&(this.txtName1.text=t.role_name,this.txtPow1.text=te.getShortenPowerStr(t.embattle_power),this.txtRank1.text=t.ranking+"")},i.onClick=function(t){switch(t.target){case this.btnClose2:case this.btnClose:this.closeWindow();break;case this.btnJoin:if(this._roleData){var i,e=rs.getEmbattleByIndex(this.fTab.selectedIndex+5);for(var s in e)if((i=e[s])&&"p_pet"==i.className)return void cs.ins.toPetArenaChallenge(this._roleData.role_id);var n=new q;n.msg="当前布阵为空，是否前往布置仙宠阵型？<br>（最多可上阵五只仙宠）",n.yesLabel="点击前往",n.yesCaller=this,n.yesFun=this.toPutFort,K.showVO(n)}else io.addTip("对手数据未初始化");break;case this.btnLeft:this.turnLeft();break;case this.btnRight:this.turnRight();break;default:t.target instanceof modules.pet.embattle.PetTowerSkillItem&&to.show(t.target.data,"PET_TOWERSKILL_TIP")}},i.turnRight=function(){var t=this.list.startIndex+this.repeatX;t=t>this.endFirstIndex?this.endFirstIndex:t,this.list.tweenTo(t,200,this.completeHanlder)},i.turnLeft=function(){var t=this.list.startIndex-this.list.repeatX;t=t<0?0:t,this.list.tweenTo(t,200,this.completeHanlder)},i.toPutFort=function(){this.tab.selectedIndex=1},i.showByType=function(t){0==t?(this.tab.visible=!0,this.tab.selectedIndex=0):(this.tab.visible=!1,this.tab.selectedIndex=1,this.updateEff())},i.updateEff=function(){},i.checkBtnVisible=function(){this.btnLeft.visible=0<this.list.startIndex,this.btnRight.visible=this.list.startIndex<this.endFirstIndex},o(0,i,"selectPet",function(){return this._selectPet},function(t){var i,e,s,n;for(e in this._selectPet=t,this.items)(i=this.items[e]).select=t==i.data;for(n in this.list.cells)(s=this.list.cells[n]).select=s.data&&t&&s.data.pet_id==t.pet_id}),o(0,i,"endFirstIndex",function(){return rs.pets?(Math.ceil(rs.pets.length/this.list.repeatX)-1)*this.list.repeatX:0})}(),function(t){function h(){var t;this.items=null,this._gainedImgs=[],this._info=null,this.posArr=[90,191,295,396,501],h.__super.call(this),this.on("display",this,this.onDisplay),this.on("click",this,this.onClick),ni.register("ATHLETICS_UPDATE_PANEL",this,this.onGetWinRewardSuccess),this.items=[];for(var i=0;i<3;i++)(t=Na.getIns(3e3,"petSports.PetSportsItem")).pos(2+227*i,289),this.addChild(t),this.items.push(t);this.initWinTimes()}l(h,"modules.athletics.petSports.PetSportsView",Qo);var i=h.prototype;i.checkRe=function(){10<=ie.gold?cs.ins.toPetArenaRefreshOpponents():es.showAlert()},i.checkBuy=function(){50<=ie.gold?cs.ins.toPetArenaBuyChallengeTimes():es.showAlert()},i.onClick=function(t){switch(t.target){case this.btnAdd:this._info&&0<this._info.remaining_buy_times?((i=new q).msg="是否消耗"+pe.font("50元宝","#fbd815")+"购买一次仙宠竞技挑战次数?<br>今日已购买："+(12-this._info.remaining_buy_times)+"/12次",i.yesCaller=this,i.yesFun=this.checkBuy,i.key="petSportsBuy",K.showVO(i)):io.addTip("购买次数达到上限");break;case this.imgRank:ni.dispatch("OPEN_PETSPORTS_RANK_VIEW");break;case this.imgRec:ni.dispatch("OPEN_PETSPORTS_LOG_VIEW");break;case this.btnRule:ni.dispatch("OPEN_PETSPORTS_RULE_VIEW");break;case this.btnChange:ni.dispatch("OPEN_PETSPORTS_SET_VIEW",1);break;case this.imgRw:ni.dispatch("OPEN_PETSPORTS_RW_VIEW");break;case this.btnAno:var i=new q;i.msg="是否消耗"+pe.font("10元宝","#fbd815")+"刷新挑战对象?",i.yesCaller=this,i.yesFun=this.checkRe,i.key="petSportsRe",K.showVO(i);break;default:if(t.target instanceof modules.pack.packView.GoodsImage){var e=t.target.name.split("_");if(this._info&&2==e.length){var s=parseInt(e[1]);if(this._info.win_rewards.indexOf(s)<0&&this._info.win_times>=s)return void cs.ins.toPetArenaWinReward(s)}var n=t.target.data;if(n){n.tempNum=1;var h="";h=ve.isEquip(n.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(n,h)}}}},i.onDisplay=function(){this.on("undisplay",this,this.onUndisplay),ni.register("CHANGE_PETSPORTS_EMBATTLE",this,this.changeIndex),ni.register("UPDATE_PETEMBATTLE_POWER",this,this.updatePower)},i.changeIndex=function(t){as.ins().toPetEmbattlePower(ie.roleID,this._info.using_embattle_index)},i.onUndisplay=function(){this.off("undisplay",this,this.onUndisplay),ni.remove("CHANGE_PETSPORTS_EMBATTLE",this,this.changeIndex),ni.remove("UPDATE_PETEMBATTLE_POWER",this,this.updatePower),De.removeFromSceond(this,this.onSec)},i.update=function(){if(this._info=_s.getPetArenaInfo(),this._info){if(this._info.next_refresh_opponents_ts>Ma.serverTime||this._info.challenge_times_recover_ts>Ma.serverTime?(this.onSec(),De.addToSecond(this,this.onSec)):De.removeFromSceond(this,this.onSec),this.txtSub.x=this.txtTime.x+this.txtTime.textWidth,this.txtLeft.text=this._info.remaining_challenge_times+"/6",this.btnAdd.x=this.txtLeft.x+this.txtLeft.textWidth+10,this.txtRank.text=this._info.ranking+"",as.ins().toPetEmbattlePower(ie.roleID,this._info.using_embattle_index),this._info.opponents)for(var t=Math.max(this.items.length,this._info.opponents.length),i=0;i<t;i++)i<this.items.length&&i<this._info.opponents.length?this.items[i].data=this._info.opponents[i]:i<this.items.length&&(this.items[i].data=null);this.updateWinTimes()}else cs.ins.toPetArenaInfo()},i.initWinTimes=function(){for(var t,i=_s.getXMLInfo().getAwards(),e=0;e<i.length;e++)0<i[e]&&((t=new ae(null,!1,!1)).data=ve.getItem(i[e]),t.pos(this.posArr[e],10),t.mouseEnabled=!0,t.name="win_"+(e+1),this.addChild(t))},i.updateWinTimes=function(){var t=_s.getPetArenaInfo();if(t){var i=6<t.win_times?6:t.win_times;0<i?(this.imgBar.visible=!0,this.imgBar.width=100*i-20):this.imgBar.visible=!1;for(var e=1;e<6;e++)this["img"+e].skin=e<=i?"modules/petSports/cir2.png":"modules/petSports/cir1.png";var s=this.getChildByName("win_3");xs.checkWinTimeShow(i,t.win_rewards,3)?this.rp(s,!0):this.rp(s,!1),s=this.getChildByName("win_5"),xs.checkWinTimeShow(i,t.win_rewards,5)?this.rp(s,!0):this.rp(s,!1)}this.updateWinRewardState()},i.rp=function(t,i){if(t){var e=t.getChildByName("rp");i?e?e.visible=!0:((e=an.createSprite("com/ui/redPoint.png")).name="rp",e.x=t.width-19,e.y=-10,t.addChild(e)):e&&(e.visible=!1)}},i.updatePower=function(t){this._info&&t==ie.roleID&&(this.txtPower.text=te.getShortenPowerStr(hs.getPetEmbattlePower(t,this._info.using_embattle_index)))},i.onSec=function(){var t=this;function i(){De.setTimeout(t,function(){cs.ins.toPetArenaInfo()},null,500)}this._info.next_refresh_opponents_ts>Ma.serverTime?(this.txtSub.visible=this.txtTime.visible=!0,this.txtTime.text=Qt.formatMS2(this._info.next_refresh_opponents_ts,Ma.serverTime),this.txtSub.x=this.txtTime.x+this.txtTime.textWidth):(this.txtSub.visible=this.txtTime.visible=!1,this.callLater(i)),this._info.challenge_times_recover_ts>Ma.serverTime?(this.txtRecoverTitle.visible=!0,this.txtReTime.text=Qt.formatTime(this._info.challenge_times_recover_ts-Ma.serverTime)):(this.txtRecoverTitle.visible=!1,this.txtReTime.text="",this._info.remaining_challenge_times<6&&this.callLater(i))},i.onGetWinRewardSuccess=function(){this.updateWinRewardState()},i.updateWinRewardState=function(){for(var t,i,e=0,s=!1,n=0;n<h.WIN_REWARD_TIME_LIST.length;n++)e=h.WIN_REWARD_TIME_LIST[n],(t=this.getChildByName("win_"+e))&&(s=!!this._info&&0<=this._info.win_rewards.indexOf(e),t.mouseEnabled=!s,s?(this._gainedImgs[n]||(i=new ge("modules/pet/gained.png"),this.addChildAt(i,this.getChildIndex(t)+1),this._gainedImgs[n]=i),(i=this._gainedImgs[n]).visible=!0,i.x=t.x-11,i.y=t.y+15):n<this._gainedImgs.length&&this._gainedImgs[n]&&(this._gainedImgs[n].visible=!1))},o(0,i,"uiClass",function(){return"petSportsView"}),e(h,["WIN_REWARD_TIME_LIST",function(){return this.WIN_REWARD_TIME_LIST=[3,5]}])}(),function(t){function i(){i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.txtHad.style.align="center",this.html.visible=!1,this.on("click",this,this.onClick),this.btnSave.y=this.btnClose2.y=196}l(i,"modules.roleSet.RoleSetChangeNameView",jn);var e=i.prototype;e.getGoodNum=function(){var t,i=Ze.getGoodsNumByTypeID(10201308),e=Ze.getGoodsArrByTypeID(10201394);for(var s in e){var n;for(var h in(t=e[s]).data_list)if(3==(n=t.data_list[h]).id&&n.val>Ma.serverTime){++i;break}}return i},e.update=function(){var t=this.getGoodNum(),i=0<t?"#5d3924":"#b60202";this.txtHad.innerHTML=pe.font("改名卡数量：","#5d3924")+pe.font(""+t,i)},e.onClick=function(t){switch(t.target){case this.btnClose2:if(this.closeWindow(),"kanshu"==this.input.text)return this.input.text="",void ni.dispatch("OPEN_GM_PANEL");case this.btnClose:this.closeWindow();break;case this.btnSave:if(!de.checkHtmlStrRule(this.input.text))return void io.addTip("含非法字符");if(""==this.input.text||this.input.text==ie.roleName)io.addTip("请先修改角色名称");else if(0<this.getGoodNum())this.secChangeName();else{var i="是否消耗"+pe.span("320元宝","#fbd815")+"购买并使用改名卡，同时将角色名称更改为"+pe.span(this.input.text,"#ffffff");es.showSecAlert(i,rh.ins(),rh.ins().toExchange,[1,10201308,1,null,this.toChangeName,this])}}},e.secChangeName=function(){var t=new q;t.msg=pe.span("是否将角色名称更改为","#5d3924")+pe.span(this.input.text,"#ffffff"),t.yesCaller=this,t.yesFun=this.toChangeName,K.showVO(t)},e.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this,null,!1),this.parent&&(this.input.focus=!0,this.input.text=ie.lastName)},e.toChangeName=function(){this.closeWindow();var t,i=Ze.getGoodsArrByTypeID(10201394);for(var e in i){var s;for(var n in(t=i[e]).data_list)if(3==(s=t.data_list[n]).id&&s.val>Ma.serverTime){rh.ins().toChangeRoleName(this.input.text,t.id);break}}(t=Ze.getGoodsByTypeID(10201308))?rh.ins().toChangeRoleName(this.input.text,t.id):io.addTip("没有改名卡哦")},o(0,e,"uiClass",function(){return"RoleChangeNameView"})}(),function(t){function i(){this._data=null,i.__super.call(this)}l(i,"modules.activity.bagua.BaguaLogItem",t),o(0,i.prototype,"dataSource",t.prototype._$get_dataSource,function(t){if(this._data=t,this._data){var i=ve.getItem(this._data.type_id),e=pe.span(this._data.name,"#cca281")+pe.span(Rt.getHtmlEmpty(1)+"发现了"+Rt.getHtmlEmpty(1),"#ffffff"),s="",n=0;6==i.color?(n=(i.level-100)/10,s=i.name+"（"+n+"转)"):5==i.color&&3==ve.getItemType(this._data.type_id)?100<i.level?(n=(i.level-100)/10,s=i.name+"（"+n+"转 "+_i.getVOCAName(i.category)+")"):s=i.name+"（"+i.level+"级 "+_i.getVOCAName(i.category)+")":s=i.name,this.txtInfo.innerHTML=e+pe.span(s,Qi.getColorDark(i.color))}})}(Q),function(t){function i(){this.packItemArr=null,this._column=5,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.list.vScrollBar.autoHide=!0,this.on("click",this,this.onClick),this.box.selected=j.canNotShowEffect}l(i,"modules.activity.bagua.BaguaRewardView",J);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnOne:this.btnOpenBox(1),this.closeWindow();break;case this.btnTen:this.btnOpenBox(2),this.closeWindow();break;case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.box:this.unShowEffectByNextTime();break;default:if(t.target instanceof modules.athletics.encounter.view.DropItem){var i=t.target;i.data.tempNum=i.num,to.show(i.data,"BASE_GOODS_TIP")}}},e.unShowEffectByNextTime=function(){var t=this.box.selected;j.canNotShowEffect=t},e.btnOpenBox=function(t){void 0===t&&(t=1),ni.dispatch("ACT_BAGUA_OPEN_AGAIN",t),j.clickType=t},e.update=function(t){this.textInfo.text="卜卦"+j.divinationTimes[j.clickType-1]+"次，获得以下奖励（已发放到背包）：",this.updateGoods(t)},e.updateGoods=function(t){this.clearAllItem(),t&&0<t.length&&(this.packItemArr=this.packItemArr||[]);for(var i=0,e=t.length-1;0<=e;e--)this.createItem(t[e],i),i++},e.createItem=function(t,i){this.packItemArr[i]=this.packItemArr[i]||new hi,this.packItemArr[i].setDrop(t),this.packItemArr[i].txtName.fontSize=24,this.packItemArr[i].txtName.color="#5d3924",this.packItemArr[i].mouseEnabled=!0;var e=i%this._column,s=Math.floor(i/this._column);this.packItemArr[i].x=e*(this.packItemArr[i].width+15)+10,this.packItemArr[i].y=s*(this.packItemArr[i].height+15),this.list.addChild(this.packItemArr[i])},e.clearAllItem=function(){if(this.packItemArr)for(var t=0;t<this.packItemArr.length;t++)this.packItemArr[t].removeSelf()}}(),function(t){function i(){this.items=null,this.itemArr=null,this.posArr=[[301,0],[460,43],[532,191],[451,345],[301,382],[151,345],[66,191],[138,43]],this.awardArr=null,this.restoreArr=[],this.isRocking=!1,this.randomVO=null,this.exchangeVO=null,this.conVO=null,this.restoreVO=null,this.countDownVO=null,this.barMax=566,this.barLenArr=[134,320,520],this.pointNum=0,this.pointCount=0,this.needNumArr=[],this.scaleArr=[.7,.8,1],this.clipArr=null,this.clipIndex=0,this.posYArr=[57.5,65,75],this.hadArr=null,this.rollNum=2,this.totalStayTime=300,this.nextTime=100,this.arr=[0,0,0,0,0,0,0,0],this._index=0,this.lastShowTime=0,this.count=0,this.end=NaN,this._typeID=null,this._actID=null,this._iconID=NaN,this._skinID=NaN,i.__super.call(this)}l(i,"modules.activity.bagua.BaguaView",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.tab.on("change",this,this.onTabClick),this.tab.selectedIndex=0,this.initBuguaItems(),this.list.vScrollBarSkin="",this.panlis.itemRender=Na.getClass(1e3,"bagua.BaguaLogItem"),this.panlis.vScrollBarSkin="",this.btnSuit.mouseEnabled=!0},e.onClick=function(t){switch(t.target){case this.imgTip:$i.ins.showMessage(this.randomVO.help);break;case this.btnOne:this.btnOpenBox(1);break;case this.btnTen:this.btnOpenBox(2);break;case this.imgShare:0<ws.getRewardTimes(1,1)?io.addTip("今天已经领取过分享奖励了哦"):ni.dispatch("ACT_BAGUA_OPEN_SHARE",0);break;case this.btnGet:var i=this.countDownVO.items[0];i.nextTime>=Ma.serverTime?this.countDownVO.openBanner&&0<this.countDownVO.getBannerNum&&0==this.countDownVO.finishBanner?Vh.sdk.showBannerVideo(5):this.countDownVO.openBanner&&0<this.countDownVO.getBannerNum&&1==this.countDownVO.finishBanner?L.ins().toGain(this.countDownVO.actID,i.conditionID):io.addTip("请在倒计时结束后领取卦盘"):L.ins().toGain(this.countDownVO.actID,i.conditionID);break;case this.btnSuit:Ae.linkTo(11415);break;case this.redTip:ni.dispatch("ACT_RP_CONTROLLL_VIEW",4,this.itemArr);break;default:if(t.target instanceof modules.athletics.encounter.view.DropItem){if(this.spPro.contains(t.target)){this.getRestoreReward(t);break}var e=t.target;e.data.tempNum=e.num,to.show(e.data,"BASE_GOODS_TIP")}}},e.btnOpenBox=function(t){var i;if(void 0===t&&(t=1),null!=this.conVO){var e=this.conVO.items[t-1];if(0<e.boxComsumeType){var s=Ze.getGoodsNumByType(Ze.GOODS_ID,e.boxItem);s>=e.OpenTimes?(i=pe.span("是否花费","#5d3924")+pe.span("卦盘*1(剩余"+s+"个)","#F7EF5F")+pe.span("进行"+j.divinationTimes[t-1]+"次卜卦？","#5d3924"),es.showSecAlert(i,this,this.openDivination,[e.conditionId],"divination"+t)):ie.gold>=e.price?(i=pe.span("您的卦盘不足，是否花费","#5d3924")+pe.span(e.price+"元宝","#F7EF5F")+pe.span("进行"+j.divinationTimes[t-1]+"次卜卦？","#5d3924"),es.showSecAlert(i,this,this.openDivination,[e.conditionId],"divination"+t)):es.showAlert()}else ie.gold>=e.price?(i=pe.span("是否花费","#5d3924")+pe.span(e.price+"元宝","#F7EF5F")+pe.span("进行"+j.divinationTimes[t-1]+"次卜卦？","#5d3924"),es.showSecAlert(i,this,this.openDivination,[e.conditionId],"divination"+t)):es.showAlert()}j.clickType=t},e.openDivination=function(t){L.ins().toGain(this.conVO.actID,t)},e.getRestoreReward=function(t){if(t.target.gray){var i=t.target;return i.data.tempNum=i.num,void to.show(i.data,"BASE_GOODS_TIP")}var e,s=t.target.name,n=this.restoreVO,h=n.items;switch(s){case"resGood0":e=h[0];break;case"resGood1":e=h[1];break;case"resGood2":e=h[2]}null!=e&&L.ins().toGain(n.actID,e.conID)},e.initBuguaItems=function(){var t,i;for(var e in this.items=[],this.posArr)i=this.posArr[e],(t=new hi).pos(i[0],i[1]),this.spBagua.addChild(t),this.items.push(t)},e.onDisplay=function(){De.addToSecond(this,this.timeLoop),De.addToSecond(this,this.rewardCDLoop),ni.register("ACT_BOX_OPEN",this,this.openBox),ni.register("ACT_BAGUA_OPEN_AGAIN",this,this.btnOpenBox),ni.register("ACT_BAGUA_LOG_UPDATE",this,this.updatePanlis),ni.register("UPDATE_ACT_BOX_LOG_INFO",this,this.showBoxLogInfoImgs),ni.register("SHARE_SUCC",this,this.onShareSucc),ni.register("BANNER_VIDEO_FINISH",this,this.updateBanner),this.on("undisplay",this,this.onUNDisplay),Ma.isOpenShare(1,1)?this.imgShare.visible=!0:this.imgShare.visible=!1},e.onShareSucc=function(){var t=ws.getRewardTimes(1,1);this.imgShare.skin=0<t?"modules/act/bagua/shareTip2.png":"modules/act/bagua/shareTip1.png"},e.onUNDisplay=function(){De.removeFromSceond(this,this.timeLoop),De.removeFromSceond(this,this.rewardCDLoop),De.removeFromFrame(this,this.loopRoll),ni.remove("ACT_BOX_OPEN",this,this.openBox),ni.remove("ACT_BAGUA_OPEN_AGAIN",this,this.btnOpenBox),ni.remove("ACT_BAGUA_LOG_UPDATE",this,this.updatePanlis),ni.remove("UPDATE_ACT_BOX_LOG_INFO",this,this.showBoxLogInfoImgs),ni.remove("SHARE_SUCC",this,this.onShareSucc),ni.remove("BANNER_VIDEO_FINISH",this,this.updateBanner),this.reset(),this.displayCanOpenRewardPanel()},e.onTabClick=function(){switch(this.tab.selectedIndex){case 0:this.spBagua.visible=!0,this.spChange.visible=!1;break;case 1:this.spBagua.visible=!1,this.spChange.visible=!0}this.update()},e.openBox=function(t){var i=t[0],e=i.length;this.awardArr=i;var s=-1;if(1<=e)for(var n=i[e-1].id,h=0;h<this.randomVO.items.length;h++){var a=this.randomVO.items[h];if(a.rewards&&a.rewards[0].type_id==n){s=h;break}}0<=s&&(this.isRocking=!0,this.setOpenBtnState(),j.canNotShowEffect?this.displayCanOpenRewardPanel():this.rockInRoll(s))},e.setOpenBtnState=function(){this.btnTen.disabled=this.isRocking,this.btnOne.disabled=this.isRocking},e.initData=function(){if(null!=this.typeID){for(var t=0;t<this.typeID.length;t++)switch(this.typeID[t]){case 1401:this.exchangeVO=G.getActDetailByActID(this.actID[t]);break;case 2501:this.conVO=G.getActDetailByActID(this.actID[t]);break;case 2401:this.restoreVO=G.getActDetailByActID(this.actID[t]);break;case 1501:this.randomVO=G.getActDetailByActID(this.actID[t]);break;case 1211:this.countDownVO=G.getActDetailByActID(this.actID[t])}this.conVO&&this.conVO.actID&&L.ins().toRoleActBoxLog(this.conVO.actID)}},e.updateBagua=function(){if(this.initData(),this.pointNum=0,this.pointCount=0,this.randomVO){var t;for(var i in this.clipArr=this.clipArr||[],this.clipArr)(t=this.clipArr[i]).removeSelf();this.clipIndex=0;for(var e=this.randomVO.items.length,s=0;s<e;s++){var n=this.randomVO.items[s].rewards[0],h=this.items[s];if(h){h.txtName.visible=!1,h.mouseEnabled=!0;var a=new Object;a.className="p_tkv",a.type=5,a.id=n.type_id,a.val=n.num,h.setDrop(a)}1==n.reserve&&(this.clipArr[this.clipIndex]=this.clipArr[this.clipIndex]||ut.getOne(),(t=this.clipArr[this.clipIndex]).mouseEnabled=!1,t.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),t.pos(h.x+47,h.y+80),this.addChild(t),this.clipIndex++)}}if(this.countDownVO&&this.parent&&(this.countDownVO.items&&this.countDownVO.items[0]&&this.countDownVO.items[0].nextTime>Ma.serverTime&&j.checkBaguaActRedPoint(this.countDownVO.items[0].nextTime),De.addToSecond(this,this.rewardCDLoop)),this.restoreVO){for(var o=0;o<this.restoreArr.length;o++)this.restoreArr[o]&&this.restoreArr[o].removeSelf();this.restoreArr=[],this.hadArr=this.hadArr||[];for(var r=0;r<this.hadArr.length;r++)this.hadArr[r]&&this.hadArr[r].removeSelf();this.needNumArr=[];for(var l=this.restoreVO.items,c=0;c<3;c++){var d=l[c].items[0],u=l[c].needNum,p=l[c].state;this.pointNum=l[c].num,this.needNumArr.push(u);var m=new hi;m.txtName.visible=!1,m.mouseEnabled=!0,m.name="resGood"+c;var f=new Object;switch(f.className="p_tkv",f.type=5,f.id=d.type_id,f.val=d.num,m.setDrop(f),m.scale(this.scaleArr[c],this.scaleArr[c]),m.pos(this["resSp"+c].x,this["resSp"+c].y),this.spPro.addChild(m),p){case 11:m.gray=!1,this.clipArr[this.clipIndex]=this.clipArr[this.clipIndex]||ut.getOne(),(t=this.clipArr[this.clipIndex]).mouseEnabled=!1,t.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),t.scale(m.scaleX,m.scaleY),t.pos(m.x+m.width*m.scaleX/2,this.posYArr[c]),this.spPro.addChild(t),this.clipIndex++;break;case 22:m.gray=!0;var g=new ge;g.skin="modules/act/sign/had.png",g.pos(m.x,m.y),g.scale(m.scaleX,m.scaleY),this.spPro.addChild(g),this.hadArr.push(g);break;default:m.gray=!0}this.restoreArr.push(m),this["resTimes"+c].text=u+"次",this.pointCount+=u}}this.updateRestoreBar(),this.updateExChangeRP(),this.conVO&&kt.ins().toRoleActBoxSelfLog(this.conVO.actID)},e.updateRestoreBar=function(){if(this.imgBar.width=0,this.pointNum>=this.needNumArr[2])this.imgBar.width=this.barLenArr[2];else{for(var t=-1,i=0,e=0,s=this.imgBar.width,n=0,h=0;h<this.needNumArr.length;h++)if(this.pointNum<=this.needNumArr[h]){t=h,i=this.barLenArr[h],e=this.needNumArr[h];break}if(0<=t){0<t&&(s=(this.barLenArr[t-1],this.barLenArr[t-1])),n=i-s;var a=this.pointNum/e;this.imgBar.width=s+n*a}}},e.updatePanlis=function(){this.conVO&&this.conVO.actID&&(this.panlis.dataSource=G.getLogByActID(this.conVO.actID))},e.updateChange=function(){for(var t in this.initData(),this.clipArr=this.clipArr||[],this.clipArr)this.clipArr[t].removeSelf();if(this.exchangeVO){this.itemArr=this.itemArr||[],this.exchangeVO.items.sort(this.memSortFun);for(var i,e=this.exchangeVO.items.length,s=0,n=0;n<e;n++)12!=(i=this.exchangeVO.items[n]).state&&(1401==this.typeID[0]?this.itemArr[n]=this.itemArr[n]||new p:this.itemArr[n]=this.itemArr[n]||new m,this.itemArr[n].x=0,this.itemArr[n].y=155*s,this.itemArr[n].isBagua=!0,this.itemArr[n].data=i,this.itemArr[n].mouseEnabled=!0,this.list.addChild(this.itemArr[n]),s++);this.updateExChangeRP(),this.parent&&De.addToSecond(this,this.timeLoop)}},e.memSortFun=function(t,i){return t.getTime<t.maxTime&&i.getTime>=i.maxTime?-1:t.getTime>=t.maxTime&&i.getTime<i.maxTime?1:t.state<i.state?1:t.state>i.state?-1:t.conID<i.conID?-1:t.conID>i.conID?1:0},e.updateExChangeRP=function(){var t;if(this.exchangeVO&&this.exchangeVO.items)for(var i in this.exchangeVO.items){var e=(t=this.exchangeVO.items[i]).state,s=t.getTime,n=t.maxTime,h=t.materials[0],a=Ze.getGoodsNumByTypeID(h.type_id);if(12!=e){if(s==n)this.exchangeRP.visible=!1;else{if(!(h.num>a)){this.exchangeRP.visible=!0,this.checkExchangeRpMask(),this.checkActIconRp();break}this.exchangeRP.visible=!1}this.checkActIconRp()}}},e.checkExchangeRpMask=function(){if(this.itemArr&&this.itemArr.length){for(var t=[],i=!0,e=0;e<this.itemArr.length;e++){var s=this.itemArr[e].data,n=s.products[0].type_id;if(!(0<=t.indexOf(n)||11!=s.state)&&(t.push(n),!D.getIsMask(4,n))){i=!1;break}}i&&(this.exchangeRP.visible=!1)}},e.checkActIconRp=function(){this.openRP.visible||this.exchangeRP.visible?j.hasRp=!0:j.hasRp=!1},e.timeLoop=function(){this.exchangeVO&&this.exchangeVO.endTime>Ma.serverTime?this.txtLeftTime.text=Qt.formatDHMS(this.exchangeVO.endTime-Ma.serverTime):(De.removeFromSceond(this,this.timeLoop),this.txtLeftTime.text="活动已结束"),this.imgTip.x=this.txtLeftTime.x+this.txtLeftTime.textWidth+15},e.rewardCDLoop=function(){if(this.countDownVO&&this.countDownVO.items&&this.countDownVO.items[0])if(this.countDownVO.items[0].nextTime>Ma.serverTime)if(this.countDownVO.openBanner&&0<this.countDownVO.getBannerNum&&0==this.countDownVO.finishBanner)De.removeFromSceond(this,this.rewardCDLoop),this.rewardCDTxt.text="",this.btnGet.label="观看领取",this.getRP.visible=!0,this.openRP.visible=!0,j.unShowRedPoint();else if(1==this.countDownVO.openBanner&&0<this.countDownVO.getBannerNum&&1==this.countDownVO.finishBanner)De.removeFromSceond(this,this.rewardCDLoop),this.rewardCDTxt.text="",this.btnGet.label="领取奖励",this.getRP.visible=!0,this.openRP.visible=!0,j.unShowRedPoint();else{var t=this.countDownVO.items[0].nextTime-Ma.serverTime;this.btnGet.label=Qt.formatTime(t),this.getRP.visible=!1,this.openRP.visible=!1}else De.removeFromSceond(this,this.rewardCDLoop),this.rewardCDTxt.text="",this.btnGet.label="领取奖励",this.getRP.visible=!0,this.openRP.visible=!0,j.unShowRedPoint()},e.rockInRoll=function(t){this.reset(),this.end=8*this.rollNum+t,De.addToFrame(this,this.loopRoll)},e.reset=function(){for(var t=0;t<8;t++)this.arr[t]=0,this["img"+t].visible=!1;this.lastShowTime=0,this.count=0,this._index=0},e.loopRoll=function(){var t=_t.now(),i=!1,e=-1;if(this.count<=this.end){var s=this.count<6?this.nextTime-20*this.count:40;t-this.lastShowTime>=s&&(this["img"+this._index].visible=!0,this["img"+this._index].alpha=1,this.arr[this._index]=t,this._index=(this._index+1)%8,this.lastShowTime=t,++this.count)}else e=this.end%8;for(var n=0;n<8;n++)if(n!=e){if(0<this.arr[n]){i=!0;var h=t-this.arr[n];h>=this.totalStayTime?(this["img"+n].visible=!1,this.arr[n]=0):this["img"+n].alpha=(this.totalStayTime-h)/this.totalStayTime}}else this.arr[n]=0,this["img"+n].alpha=1,this["img"+n].visible=!0;0==i&&(De.setTimeout(this,this.showRewardOnPanel,[],500),De.removeFromFrame(this,this.loopRoll))},e.showRewardOnPanel=function(){this.isRocking=!1,this.setOpenBtnState(),M.getInstance().openBaguaRewardPanel(this.awardArr)},e.displayCanOpenRewardPanel=function(){1==this.isRocking&&De.setTimeout(this,this.showRewardOnPanel,[],500)},e.showViewByIndex=function(t){void 0===t&&(t=0),this.tab.selectedIndex=t},e.update=function(){this.spBagua.visible&&this.updateBagua(),this.spChange.visible&&this.updateChange()},e.callBackUpdate=function(){this.update()},e.updateBanner=function(t){if(5==t){var i=this.countDownVO.items[0];L.ins().toFinishBanner(this.countDownVO.actID,i.conditionID)}},e.showBoxLogInfoImgs=function(){this.conVO&&(kt.ins().createCheckShowIcon(1,10002,this.spBagua,23,85,this.conVO.actID),kt.ins().createCheckShowIcon(2,10002,this.spBagua,603,85,this.conVO.actID))},o(0,e,"typeID",function(){return this._typeID},function(t){this._typeID=t}),o(0,e,"actID",function(){return this._actID},function(t){this._actID=t}),o(0,e,"skinID",function(){return this._skinID},function(t){this.imgBg.skin="modules/act/bagua/skin"+t+"/BG.png",this.imgTurn.skin="modules/act/bagua/skin"+t+"/bgBottom.png",this.img0.skin=this.img1.skin=this.img2.skin=this.img3.skin=this.img4.skin=this.img5.skin=this.img6.skin=this.img7.skin="modules/act/bagua/skin"+t+"/sel.png",this.imgSub1.skin=this.imgSub2.skin=this.imgSub3.skin="modules/act/bagua/skin"+t+"/goodsBg.png",this.imgTxt.skin="modules/act/bagua/skin"+t+"/txtBg.png",this.imgPost.skin="modules/act/bagua/skin"+t+"/poster.png",this._skinID=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}($),function(t){function i(){this._data=null,this._vo=null,this.goodsItems=null,i.__super.call(this),this.btnget.on("click",this,this.onClick)}l(i,"modules.activity.bannerQQ.BannerQQItem",t);var e=i.prototype;e.onClick=function(t){if(this._data&&Ne.isQQ){it.videoID=this._data.id;var i=this._data.id%100;0==this._data.val?Vh.sdk.showBannerVideo(i):1==this._data.val&&Z.getInstance().toGetReward(this._data.id)}},e.update=function(){if(this._vo=it.getConfigVOById(this._data.id),0==this._data.val?(this.btnget.label="立刻前往",this.btnget.disabled=!1):1==this._data.val?(this.btnget.label="领取奖励",this.btnget.disabled=!1):2==this._data.val&&(this.btnget.label="已领取",this.btnget.disabled=!0),this._vo){var t,i,e;this.goodsItems=this.goodsItems||[];for(var s=0;s<this._vo.rewardGoodsArr.length;s++)i=this._vo.rewardGoodsArr[s],null==(t=this.goodsItems[s])&&((t=new hi("")).txtName.visible=!1,this.goodsItems.push(t)),t.pos(120*s,0),this.spreward.addChild(t),(e=new Object).className="p_tkv",e.type=5,e.id=i.typeId,e.val=i.num,t.setDrop(e),t.on("click",this,this.onItemClick);this.txtNum.text=this._vo.nowTimes+"/"+this._vo.times}},e.onItemClick=function(t){var i=t.target.val,e=ve.getItem(i.id);e.tempNum=i.val;var s="";s=ve.isEquip(e.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(e,s)},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._data=t,this._data&&this.update()})}(tt),function(t){function i(){i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!1),this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(1e3,"bannerQQ.BannerQQItem"),this.btnClose.on("click",this,this.onClick)}l(i,"modules.activity.bannerQQ.BannerQQView",et);var e=i.prototype;e.update=function(){var t=it.getListArr();this.list.dataSource=t,this.list.refresh()},e.onClick=function(t){switch(t.target){case this.btnClose:this.closeWindow()}},o(0,e,"uiClass",function(){return"BannerView"})}(),function(t){function i(){this.FriendVo=null,this.FreeTimes=0,i.__super.call(this),this.on("click",this,this.onClick)}l(i,"modules.activity.bargain.BargainFriendCutItem",nt);var e=i.prototype;e.update=function(t){this.FriendVo=this.dataSource;var i=ve.getItem(this.FriendVo.type_id);this.txtName.text=this.FriendVo.role_name,this.txtGoodsName.text=i.name,this.imgHead.skin="com/head/small"+this.FriendVo.head_id+".png",this.FreeTimes=t},e.onClick=function(t){switch(t.target){case this.btnCut:var i=new q;i.msg=pe.span("确认花费10元宝为好友助力砍价？","#621e09"),0<this.FreeTimes&&(i.msg=pe.span("确认使用免费助力次数为好友助力砍价？","#621e09")),i.yesCaller=this,i.yesLabel="确定",i.noLabel="取消",i.yesFun=this.toCut,i.key=null,K.showVO(i)}},e.toCut=function(){st.getInstance().toCut(this.FriendVo.act_id,this.FriendVo.role_id,this.FriendVo.type_id)}}(),function(t){function i(){i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.list.vScrollBar.autoHide=!0}l(i,"modules.activity.bargain.BargainFriendCutView",ht);var e=i.prototype;e.onDisplay=function(){this.on("undisplay",this,this.unDisplay)},e.unDisplay=function(){this.off("undisplay",this,this.unDisplay)},e.update=function(t,i){if(void 0===t&&(t=[]),void 0===i&&(i=0),0<t.length){this.list.removeChildren();for(var e=0;e<t.length;e++){var s=t[e],n=new Na.getIns(1e3,"bargain.BargainFriendCutItem");n.dataSource=s,n.update(i),n.y=130*e,this.list.addChild(n)}this.list.refresh(),this.txtFree.text="免费次数:"+i+"/1"}},e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow()}}}(),function(t){function i(){this.curItem=null,this.friendItems=null,this.ItemID=0,this.ActID=0,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_7"),this.on("click",this,this.onClick),this.list.vScrollBarSkin="",this.list.vScrollBar.autoHide=!0,this.imgTitle.visible=!1,this.txtTitle.visible=!0}l(i,"modules.activity.bargain.BargainInviteView",at);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow();break;case this.btn:this.clickHandler();break;case this.btnGo:this.spFriend.visible=!0,this.spShow.visible=!1}},e.clickHandler=function(){this.curItem?(st.getInstance().toShareFriend(this.curItem.data.role_id,this.ItemID),this.closeWindow()):io.addTip("请选择要邀请的好友！")},e.openSet=function(t,i){this.spFriend.visible=!1,this.spShow.visible=!0,this.ItemID=t,this.ActID=i},e.update=function(){var t;this.txtTitle.text="砍价助力",this.list.removeChildren(),this.friendItems=this.friendItems||[];for(var i=0,e=0,s=qi.getOnlineFriends(),n=0;n<s.length;n++)i=Math.floor(n/2),e=n%2,(t=(t=this.friendItems[n])||new bi).pos(10+350*e,115*i+10),this.list.addChild(t),t.dataSource=qi.friends[n],t.on("click",this,this.onClickItem),t.isSelected(!1),0==n&&(t.isSelected(!0),this.curItem=t)},e.onClickItem=function(t){if(this.curItem=t.target,this.curItem&&this.curItem.data){for(var i=0;i<this.list.numChildren;i++)this.list.getChildAt(i).isSelected(!1);this.curItem.isSelected(!0)}}}(),function(t){function i(){this.item=null,this.itemVo=null,this.bmClip=null,this.bargainItemVo=null,this.chargeView=null,i.__super.call(this),this.txtFinish.visible=!1,this.btnCut.visible=!0,this.on("click",this,this.onClick),this.txtLink.on("click",this,this.onShareFriend)}l(i,"modules.activity.bargain.BargainItem",ot);var e=i.prototype;return e.update=function(){},e.onClick=function(t){switch(t.target){case this.btnCut:this.cutGoodsPrice();break;case this.btnBuy:this.buyGoods()}},e.setData=function(t){this.txtFinish.visible=!1,this.btnCut.visible=!0,(this.bargainItemVo=t)&&(this.item=this.item||new oe(105,105,!1,!0,!0,!1,105),this.itemVo=ve.getItem(t.ItemID),this.item.dataSource=[t.ItemID,t.ItemNum],this.item.pos(30,0),this.item.hideGoodsName(),this.sp1.addChild(this.item),this.txtGoods.text=this.itemVo.name,this.txtGoods.color=Qi.COLORS_LIGHT[this.itemVo.color],this.txtOrginal.text="原价："+t.MaxPrice,this.txtNow.text="现价："+(this.bargainItemVo.MaxPrice-this.bargainItemVo.CutPrice),this.txtFinal.text="血亏价："+t.MinPrice,t.MaxPrice-t.CutPrice<=t.MinPrice&&(this.btnCut.visible=!1,this.txtFinish.visible=!0,this.txtNow.text="现价："+t.MinPrice),this.txtLimit.text="购买次数"+t.HasTimes+"/"+t.LimitTimes,t.HasTimes==t.LimitTimes?(this.btnCut.visible=!1,this.btnBuy.disabled=!0,this.btnBuy.label="已购买"):(this.btnBuy.disabled=!1,this.btnBuy.label="购买"),this.ownBg.visible=this.checkHas(this.itemVo.id))},e.onShareFriend=function(t){this.bargainItemVo&&(this.bargainItemVo.HasTimes>=this.bargainItemVo.LimitTimes?io.addTip("已达到购买次数上限"):ni.dispatch("BARGAIN_OPEN_INVITE_PANEL",this.bargainItemVo.ItemID))},e.cutGoodsPrice=function(){if(this.bargainItemVo){var t=Ze.getGoodsNumByType(Ze.GOODS_ID,10201883);if(this.bargainItemVo.MaxPrice-this.bargainItemVo.CutPrice<=this.bargainItemVo.MinPrice)console.log(this.bargainItemVo.MaxPrice,this.bargainItemVo.CutPrice,this.bargainItemVo.MinPrice),io.addTip("已经血亏了，赶快购买啊！");else if(0<t){var i=pe.span("你确定使用1个菜刀进行砍价吗？","#5d3924");es.showSecAlert(i,this,this.toCut,null,"BargainCut")}else yt.ins.show(10201883,2,0,10001,null,null,1,this.updateMoney,this)}},e.buyGoods=function(){if(this.bargainItemVo){var t="";t=this.bargainItemVo.MaxPrice-this.bargainItemVo.CutPrice<=this.bargainItemVo.MinPrice?pe.span("当前已是最低价，确定花费"+this.bargainItemVo.MinPrice+"个狐仙馈赠购买"+this.itemVo.name+"吗？","#5d3924"):pe.span("当前并非最低价，确定花费"+(this.bargainItemVo.MaxPrice-this.bargainItemVo.CutPrice)+"个狐仙馈赠购买"+this.itemVo.name+"吗？","#5d3924"),es.showSecAlert(t,this,this.toBuy,null,"BargainBuy")}},e.updateMoney=function(){ni.dispatch("ACT_BARGAIN_UPDATE")},e.toBuy=function(){var t=Ze.getGoodsNumByType(Ze.GOODS_ID,10201590),i=this.bargainItemVo.MaxPrice-this.bargainItemVo.CutPrice;if(i<this.bargainItemVo.MinPrice&&(i=this.bargainItemVo.MinPrice),i<=t){var e=M.getInstance().bargainID,s=new U;s.goodsTypeID=this.itemVo.id,s.defaultCaller=L.ins(),s.defaultFun=L.ins().toGain,s.defaultArgs=[e,this.bargainItemVo.Index],s.yesCaller=L.ins(),s.yesFun=L.ins().toGain,s.yesArgs=[e,this.bargainItemVo.Index],H.ins().checkRepeatAlert(s)}else this.chargeView=this.chargeView||new me,this.chargeView.openWindow()},e.toCut=function(){st.getInstance().toCut(M.getInstance().bargainID,ie.roleID,this.itemVo.id)},e.checkHas=function(t){var i=ve.getItem(t),e=i.useType%1e3,s=Ze.getGoodsNumByTypeID(t),n=0;switch(e){case 19:var h,a,o,r=ie.pals,l=parseInt(i.img),c=0;for(var d in r)(o=r[d])&&(h=oh.getFashionListDicByActID(o.pal_id))&&h.hasOwnProperty(l+"")&&c++;if(a=oh.getFashionTimesByTypeID(i.id),4<=s+c&&a<0)return!0;break;case 32:var u=parseInt(i.img);if(vi.getAnimalVO(u).isLoaded&&(n=1),1<=s+n)return!0;break;case 31:if(Fa.getTalimanIsActiveByID(i.id)&&(n=1),1<=s+n)return!0;break;case 37:var p=Ni.getFootCfg(i.id),m=Ni.getFootPrintVO(p.id);if(m&&3<=m.purify_level)return!0;if(m){for(var f=m.purify_level;f<3;f++)n+=Ni.getFootChangeCost(p.id,f+1);if(n<=s)return!0}}return!1},i}()),$o=(function(t){function i(){this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this.bargainItem1=null,this.bargainItem2=null,this.curVO=null,this.nowStartIndex=0,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!1),this.bargainItem1=this.bargainItem1||new Jo,this.bargainItem2=this.bargainItem2||new Jo,this.boxCenter.addChild(this.bargainItem1),this.boxCenter.addChild(this.bargainItem2),this.on("display",this,this.onDisplay),this.on("click",this,this.onClick)}l(i,"modules.activity.bargain.BargainView",rt);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onDisplay=function(){L.ins().toActDetail(this.actID[0]),De.addToSecond(this,this.updateTime),this.nowStartIndex=0,this.bargainItem1.pos(150,495),this.bargainItem2.pos(390,495),this.on("undisplay",this,this.unDisplay),ni.register("ACT_BARGAIN_UPDATE",this,this.update)},e.unDisplay=function(){De.removeFromSceond(this,this.updateTime),G.removeActCBFunc(this.actID[0]),ni.remove("ACT_BARGAIN_UPDATE",this,this.update),this.off("undisplay",this,this.unDisplay)},e.update=function(){this.curVO=G.getActDetailByActID(this.actID[0]),ni.dispatch("ACT_ACTIVITY_ACTID",6,this.actID[0]),this.curVO&&(this.txtDes.innerHTML=this.curVO.desc,this.txtFriend.text="好友助力次数："+this.curVO.NowHelpTimes+"/"+this.curVO.MaxHelpTimes,this.btnLeft.visible=0<this.nowStartIndex,this.btnRight.visible=this.nowStartIndex+2<this.curVO.goodsItem.length,this.nowStartIndex+1>=this.curVO.goodsItem.length?(this.bargainItem1.setData(this.curVO.goodsItem[this.nowStartIndex-1]),this.bargainItem2.setData(this.curVO.goodsItem[this.nowStartIndex])):(this.bargainItem1.setData(this.curVO.goodsItem[this.nowStartIndex]),this.bargainItem2.setData(this.curVO.goodsItem[this.nowStartIndex+1]))),this.updateMoney()},e.onClick=function(t){switch(t.target){case this.closeBtn:this.closeWindow();break;case this.btnRight:this.curVO&&this.nowStartIndex+2<this.curVO.goodsItem.length&&(this.nowStartIndex+=2,this.update());break;case this.btnLeft:this.nowStartIndex-=2,this.nowStartIndex<=0&&(this.nowStartIndex=0),this.update();break;case this.btnBuy:yt.ins.show(10201883,2,0,10001,null,null,1,this.updateMoney,this)}},e.updateMoney=function(){var t=Ze.getGoodsNumByType(Ze.GOODS_ID,10201883);this.txtOwn.text="拥有个数："+t+"把"},e.updateTime=function(){var t=86400-(Ma.serverTime%86400+28800);this.curVO&&(t=this.curVO.endTime-Ma.serverTime),0<t?this.limitTime.text=Qt.formatDHMS(t,!0,!0):t<0&&(this.limitTime.text=Qt.formatDHMS(86400+t,!1,!0))},e.callBackUpdate=function(){this.update()},o(0,e,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t}),o(0,e,"uiClass",function(){return"BargainView"}),o(0,e,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,e,"actID",function(){return this._actIDs},function(t){this._actIDs=t,G.registerActCBFunc(this.actID[0],this,this.callBackUpdate)})}(),function(t){function i(){this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this.iconId=0,this._data=null,this.beastEff=null,this.endTime=NaN,this.curVO=null,this.curImgs=[],this.numImgPool=[],i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.beastEff=ut.getOne(),this.beastEff.pos(360,476),this.beastEff.scaleX=this.beastEff.scaleY=1.8,this.box.addChild(this.beastEff),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay)}l(i,"modules.activity.beastsBuy.BeastsBuyView",lt);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onDisplay=function(){this.on("undisplay",this,this.onUNDisplay)},e.onUNDisplay=function(){De.removeFromSceond(this,this.updateTime)},e.setID=function(t){this.actID=[t],G.registerActCBFunc(this.actID[0],this,this.callBackUpdate)},e.updateTime=function(){var t=this.endTime-Ma.serverTime;0<t?this.txtTimeTip.text="倒计时："+Qt.formatDHMS(t):De.removeFromSceond(this,this.updateTime)},e.onClick=function(t){switch(t.target){case this.btnClose1:case this.btnClose:this.closeWindow();break;case this.btnBuy:if(this._data){var i=new U;if(i.goodsTypeID=this._data.beastsId,Vh.isFanTi?(i.defaultCaller=Ai.ins(),i.defaultFun=Ai.ins().toExchange,i.defaultArgs=[this._data.buyId],i.yesCaller=Ai.ins(),i.yesFun=Ai.ins().toExchange,i.yesArgs=[this._data.buyId],H.ins().checkRepeatAlert(i),Ai.ins().toExchange(this._data.buyId)):(i.defaultCaller=Ai.ins(),i.defaultFun=Ai.ins().toPay,i.defaultArgs=[this._data.buyId],i.yesCaller=Ai.ins(),i.yesFun=Ai.ins().toPay,i.yesArgs=[this._data.buyId],H.ins().checkRepeatAlert(i)),Ne.isWX){var e=Ci.getChargeBackVO(this._data.buyId);Ve.send(10035,3,"直购-"+e.name)}}break;case this.imgGoto:Ae.linkTo(10811)}},e.update=function(){if(this.clearImgs(),this.iconId=118,this._data=this.getInfoData(),this._data){this.endTime=this._data.ts,0<this.endTime&&0<this.endTime-Ma.serverTime&&De.addToSecond(this,this.updateTime),this.txtPriceCur.text=Vh.isFanTi?"現價："+this._data.price+"仙尊幣":"现价："+this._data.price+"元",this.txtPriceOriginal.text=Vh.isFanTi?"原價："+this._data.originPrice+"仙尊幣":"原价："+this._data.originPrice+"元",this.imgName.skin="modules/act/beastsBuy/name"+this._data.beastsId+".png";var t=ve.getPetIdByImg(parseInt(this._data.beastsId));this.beastEff.loadAndPlay("unit/monster/"+t+"_3","stand",3,!0),this.spPower.removeChildren();for(var i=this.getImgs(this._data.power),e=0;e<i.length;e++)i[e].x=25*e,this.spPower.addChild(i[e]);this.spHeart.removeChildren();for(var s=this.getImgs(this._data.rebound),n=0;n<s.length;n++)s[n].x=25*n,this.spHeart.addChild(s[n])}},e.getInfoData=function(){this.curVO=G.getActDetailByActID(this.actID[0]);var t,i=this.curVO.items[0];if(i)switch(this.imgLabel.skin="modules/act/beastsBuy/imgLabel"+i.label+".png",i.color){case 1:t={buyId:"1146",beastsId:i.goods[0].type_id+"",power:"40542",rebound:"4000",price:i.realPrice+"",originPrice:i.origPrice+"",ts:this.curVO.endTime+""};break;case 2:t={buyId:"1146",beastsId:i.goods[0].type_id+"",power:"121825",rebound:"13500",price:i.realPrice+"",originPrice:i.origPrice+"",ts:this.curVO.endTime+""};break;case 3:t={buyId:"1203",beastsId:i.goods[0].type_id+"",power:"309331",rebound:"42000",price:i.realPrice+"",originPrice:i.origPrice+"",ts:this.curVO.endTime+""}}return t},e.getImgs=function(t){for(var i=[],e=t.toString().split(""),s=e.length,n=0;n<s;n++){var h;(h=0<this.numImgPool.length?this.numImgPool.pop():new ge).skin="modules/act/StrBeastLimit/font/power"+e[n]+".png",this.curImgs.push(h),i.push(h)}return i},e.clearImgs=function(){for(;0<this.curImgs.length;)this.numImgPool.push(this.curImgs.shift())},e.callBackUpdate=function(){this.update()},o(0,e,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,e,"actID",function(){return this._actIDs},function(t){this._actIDs=t}),o(0,e,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(),function(t){function i(){this._data=null,this.imgBG=null,this.imgContent=null,this.imgPath=null,this.isComing=!1,this.freeTimes=0,this.itemId=0,this.txt=null,i.__super.call(this),this.on("click",this,this.onClick),this.txtTip.visible=!1,this.maskImg.visible=!1}l(i,"modules.activity.constellation.ConstellationItem",t);var e=i.prototype;e.onClick=function(){},e.update=function(){if(this.imgBG=this.imgBG||new ge,this.imgBG.sizeGrid="5,5,5,5",this.imgBG.skin="com/ui/goodsBg1.png",this.imgBG.width=90,this.imgBG.height=90,this.imgBg.addChild(this.imgBG),this.imgContent=this.imgContent||new ge,this.imgContent.sizeGrid="0,0,0,0",this.imgContent.skin="modules/goods/maxico/"+this.imgPath+".png",this.imgContent.width=90,this.imgContent.height=90,this.imgIcon.addChild(this.imgContent),this.isComing)this.setComingFlag(!0),this.setShowRp(!1);else{this.setComingFlag(!1);var t=Tt.getCheckId(this.itemId),i=Tt.chackGiftHave(t);0==this.freeTimes||4<=i?this.setShowRp(!1):this.setShowRp(!0)}},e.setComingFlag=function(t){t?(this.txtTip.visible=!0,this.maskImg.visible=!0):(this.txtTip.visible=!1,this.maskImg.visible=!1)},e.setShowRp=function(t){this.rpImg.visible=t},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){t&&(this._data=t,this.imgPath=this._data[0]+"",0<this._data[1]?this.isComing=!1:this.isComing=!0,this.freeTimes=this._data[2],this.itemId=this._data[3].id,this.update())})}(Et),function(t){function i(){this.repeatX=5,this.clickFirst=!0,this.glowFilter=null,this.itemSelecteStates=[],this.itemPaths=[],this.itemVos=[],this.wishValues=[],this.perProgress=[],this.returnProgress=[],this.minProgress=[],this.maxProgress=[],this.prices=[],this.prizes=[],this.freeTimes=[],this.openBanners=[],this.hasBanners=[],this.boolBanners=[],this.completeHanlder=null,this.wishPrice=NaN,this.constellationVo=null,this.roleSp=null,this.roleSex=NaN,this.curIndex=0,this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this.checkIds=null,this._guideIndex=0,this.checkId=NaN,this.avo=null,this.sp=null,this.wishTimes=NaN,this.failOrNot=!1,this.num,i.__super.call(this)}l(i,"modules.activity.constellation.ConstellationView",t);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.createChildren=function(){t.prototype.createChildren.call(this),this.role.mouseEnabled=!0,this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.init()},e.onSelected=function(t){this.curIndex=t,this.list.refresh(),this.chooseFashsion(this.curIndex),this.updateBtn(),this.changeRoleSex(),this.updateName(),this.updateBtnVisible(),this.showWishBar(),this.updateRp(),this.updateGuideTip(this.curIndex)},e.init=function(){this.list.itemRender=Na.getClass(1e3,"constellation.ConstellationItem"),this.list.spaceX=18,this.list.repeatY=1,this.list.selectEnable=!0,this.list.repeatX=this.repeatX,this.list.selectHandler=new ue(this,this.onSelected),this.list.renderHandler=new ue(this,this.onRenderHandler),this.completeHanlder=ue.create(this,this.updateBtnVisible),this.list.on("change",this,this.updateBtnVisible),this.roleSex=0,this.nameImg.visible=!1,this.txtLink.underline=!0,this.glowFilter=new se("#ffff00",10,0,0),this.txtTip.visible=!1,this.tipMask.visible=!1,this.wishBtn.mouseEnabled=!1,this.wishBtn.gray=!0,this.callBtn.mouseEnabled=!1,this.callBtn.gray=!0},e.chooseFashsion=function(t){this.roleSp=this.roleSp||ut.getOne();var i=this.itemPaths[this.curIndex].toString();this.roleSp.loadAndPlay(z.getRoleUnitSubFileStr(i)+i+"_sit_4","sit",4,!0),this.roleSp.scale(1.5,1.5),this.roleSp.x=162,this.roleSp.y=290,this.role.addChild(this.roleSp)},e.turnLeft=function(){var t=this.list.startIndex-this.repeatX;t=t<0?0:t,this.list.tweenTo(t,200,this.completeHanlder)},e.turnRight=function(){if(this.itemPaths){var t=this.list.startIndex+this.repeatX;t=t>this.endFirstIndex?this.endFirstIndex:t,this.list.tweenTo(t,200,this.completeHanlder)}},e.updateBtnVisible=function(){this.leftBtn.visible=0<this.list.startIndex,this.rightBtn.visible=this.list.startIndex<this.endFirstIndex},e.onRenderHandler=function(t,i){t&&(i==this.curIndex?t.imgBg.filters=[this.glowFilter]:t.imgBg.filters=[])},e.setData=function(){if(this.constellationVo=G.getActDetailByActID(this.actID[0]),ni.dispatch("ACT_ACTIVITY_ACTID",1,this.actID[0]),this.constellationVo&&this.constellationVo.items)for(var t=0;t<this.constellationVo.items.length;t++)this.itemPaths[t]=ve.getGoodsPathByGoodsId(this.constellationVo.items[t][0].type_id),this.itemVos[t]=ve.getItem(this.constellationVo.items[t][0].type_id),this.prices[t]=parseInt(this.constellationVo.allPrice[t]),this.wishValues[t]=parseInt(this.constellationVo.allCurProgress[t]),this.perProgress[t]=parseInt(this.constellationVo.allProgreess[t]),this.returnProgress[t]=parseInt(this.constellationVo.allReturnPro[t]),this.minProgress[t]=parseInt(this.constellationVo.allMinProgress[t]),this.maxProgress[t]=parseInt(this.constellationVo.allMaxProgress[t]),this.wishValues[t]>=this.maxProgress[t]&&(this.wishValues[t]=this.maxProgress[t]),this.freeTimes[t]=parseInt(this.constellationVo.allFreeTimes[t]),this.prizes[t]=this.constellationVo.allPrizeId[t],this.itemSelecteStates[t]=!1,this.openBanners[t]=this.constellationVo.openBanner[t],this.hasBanners[t]=0<parseInt(this.constellationVo.getBannerNum[t]),this.boolBanners[t]=1==parseInt(this.constellationVo.finishBanner[t]);for(var i=[],e=0;e<this.constellationVo.items.length;e++)i[e]=[],i[e][0]=this.itemPaths[e],i[e][1]=this.minProgress[e],i[e][2]=this.freeTimes[e],i[e][3]=this.itemVos[e];this.list.dataSource=i,this.list.selectedIndex=this.curIndex},e.checkItemIsItemVOs=function(t){for(var i=!1,e=0,s=this.itemVos.length;e<s;e++){var n=this.itemVos[e];if(n&&n.id==t){i=!0;break}}return i},e.updateBtn=function(){if(0==this.minProgress[this.curIndex])return this.wishBtn.mouseEnabled=!1,this.wishBtn.gray=!0,this.wishBtn.label="即将上线",this.callBtn.mouseEnabled=!1,this.callBtn.gray=!0,void(this.callBtn.label="即将上线");this.checkId=Tt.getCheckId(this.itemVos[this.curIndex].id),this.num=Tt.chackGiftHave(this.checkId),4<=this.num?(this.wishBtn.mouseEnabled=!1,this.wishBtn.gray=!0,this.callBtn.mouseEnabled=!1,this.callBtn.gray=!0,this.callBtn.label="已领取"):(this.wishBtn.mouseEnabled=!0,this.wishBtn.gray=!1,this.wishBtn.label="星座许愿",0<this.freeTimes[this.curIndex]?this.txtCost.text="首次免费":this.openBanners[this.curIndex]&&this.hasBanners[this.curIndex]&&0==this.boolBanners[this.curIndex]?(this.txtCost.text="观看免费",this.wishBtn.label="观看免费"):this.openBanners[this.curIndex]&&this.hasBanners[this.curIndex]&&this.boolBanners[this.curIndex]?(this.wishBtn.label="免费许愿",this.txtCost.text="观看免费"):this.txtCost.text=this.prices[this.curIndex]+"元宝/次",this.txtRate.text="成功率："+Math.round(100*this.wishValues[this.curIndex]/this.maxProgress[this.curIndex]).toString()+"%",this.wishValues[this.curIndex]>=this.minProgress[this.curIndex]?(this.callBtn.mouseEnabled=!0,this.callBtn.gray=!1):(this.callBtn.mouseEnabled=!1,this.callBtn.gray=!0))},e.onDisplay=function(){this.update(),this.changeRoleSex(),De.addToSecond(this,this.updateTime),ni.register("ACT_CONSTELLATION_UPDATE",this,this.updateWishBar),ni.register("FASHION_DICINIT",this,this.updateBtn),ni.register("ACT_CONSTELLATION_CALL_FAIL",this,this.wishFail),ni.register("ACT_CONSTELLATION_CALL_SUCC",this,this.wishSucc),ni.register("ACT_CONSTELLATION_WISH_TIMES",this,this.setWishTimes),ni.register("BANNER_VIDEO_FINISH",this,this.updateBanner),this.on("undisplay",this,this.onUNDisplay),an.register("RP_ICON_CONSTELLATION_CALL",this.callBtn,new Hs(19,-10)),an.register("RP_ICON_CONSTELLATION_WISH",this.wishBtn,new Hs(19,-10))},e.onUNDisplay=function(){De.removeFromSceond(this,this.updateTime),ni.remove("ACT_CONSTELLATION_UPDATE",this,this.updateWishBar),ni.remove("ACT_CONSTELLATION_CALL_FAIL",this,this.wishFail),ni.remove("ACT_CONSTELLATION_WISH_TIMES",this,this.setWishTimes),ni.remove("FASHION_DICINIT",this,this.updateBtn),ni.remove("ACT_CONSTELLATION_CALL_SUCC",this,this.wishSucc),ni.remove("BANNER_VIDEO_FINISH",this,this.updateBanner)},e.wishSucc=function(t){var i,e=t.rewards;for(var s in e)if(i=e[s],this.checkItemIsItemVOs(i.id))return void(this.failOrNot=!0)},e.changeRoleSex=function(){var t;0==this.roleSex?(this.maleBtn.skin="modules/act/constellation/male_bright.png",this.femaleBtn.skin="modules/act/constellation/female_gray.png",this.role&&(t=this.itemPaths[this.curIndex].toString(),this.roleSp.loadAndPlay(z.getRoleUnitSubFileStr(t)+t+"_sit_4","sit",4,!0))):(this.maleBtn.skin="modules/act/constellation/male_gray.png",this.femaleBtn.skin="modules/act/constellation/female_bright.png",this.role&&(t=(this.itemPaths[this.curIndex]+1).toString(),this.roleSp.loadAndPlay(z.getRoleUnitSubFileStr(t)+t+"_sit_4","sit",4,!0)))},e.onClick=function(t){switch(t.target){case this.leftBtn:this.turnLeft();break;case this.rightBtn:this.turnRight();break;case this.maleBtn:1==this.roleSex&&(this.roleSex=0),this.changeRoleSex();break;case this.role:if(this.itemVos[this.list.selectedIndex]){var i="";i=ve.isEquip(this.itemVos[this.curIndex].id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(this.itemVos[this.curIndex],i)}break;case this.femaleBtn:0==this.roleSex&&(this.roleSex=1),this.changeRoleSex();break;case this.wishBtn:if(this.wishValues[this.curIndex]>=this.maxProgress[this.curIndex])return void io.addTip("星愿值已满，请召唤时装");if(console.log("输出状态",this.openBanners[this.curIndex]&&this.hasBanners[this.curIndex]&&this.boolBanners[this.curIndex]),0<this.freeTimes[this.curIndex]||this.openBanners[this.curIndex]&&this.hasBanners[this.curIndex]&&this.boolBanners[this.curIndex]){var e=new q;return e.msg=pe.font("您是否免费进行一次许愿？","#5d3924",24),e.yesFun=this.freeWish,e.yesCaller=this,e.yesArgs=[this.actID[0],this.prizes[this.curIndex]],void K.showVO(e)}if(this.openBanners[this.curIndex]&&this.hasBanners[this.curIndex]&&0==this.boolBanners[this.curIndex])return void Vh.sdk.showBannerVideo(4);var s=new h;s.price=this.prices[this.curIndex],s.goodsName="星座许愿",s.yesFunc=this.wish,s.yesFuncCaller=this,s.yesArgs=[this.actID[0],this.prizes[this.curIndex]],s.timeForArgsIndex=2,s.maxCanBuyNum=Math.ceil((this.maxProgress[this.curIndex]-this.wishValues[this.curIndex])/this.perProgress[this.curIndex]),s.unitName="次",s.args[0]=this.perProgress[this.curIndex],s.remaskStr="注：本次许愿可得s星愿值",M.getInstance().showActBuyGoodsAlert(s);break;case this.callBtn:this.avo=this.avo||new ne,this.avo.gold.visible=!1,this.avo.txtMsg.style.fontSize=28,this.avo.txtMsg.style.valign="top",this.avo.txtMsg.style.leading=8,this.avo.txtMsg.style.color="#5D3924",this.avo.txtMsg.height=500,this.avo.txtMsg.innerHTML="<br><br><br>&nbsp;&nbsp;&nbsp;当前召唤成功概率为"+pe.font(Math.round(100*this.wishValues[this.curIndex]/this.maxProgress[this.curIndex]).toString()+"%","#ffff00",30)+",若召唤成功，则星愿值清0，若召唤失败，则返还"+pe.font(this.returnProgress[this.curIndex]/100+"%","#ffff00",30)+"星愿值<br><br><br>&nbsp;&nbsp;&nbsp;请问是否继续？",this.avo.on("click",this,this.onAlertClick),this.avo.popup();break;case this.txtLink:Ae.linkTo(11415);break;case this.help:$i.ins.showMessage(this.constellationVo.rule)}},e.updateRp=function(){if(0==this.minProgress[this.curIndex])return an.hide("RP_ICON_CONSTELLATION_WISH"),void an.hide("RP_ICON_CONSTELLATION_CALL");this.num<4?(this.wishValues[this.curIndex]>=this.maxProgress[this.curIndex]?an.show("RP_ICON_CONSTELLATION_CALL"):an.hide("RP_ICON_CONSTELLATION_CALL"),0<this.freeTimes[this.curIndex]?an.show("RP_ICON_CONSTELLATION_WISH"):an.hide("RP_ICON_CONSTELLATION_WISH")):(an.hide("RP_ICON_CONSTELLATION_WISH"),an.hide("RP_ICON_CONSTELLATION_CALL"))},e.updateGuideTip=function(t){this.imgBg.skin="modules/act/constellation/bg"+(t+1)+".png"},e.onAlertClick=function(t){switch(t.target){case this.avo.btnYes:L.ins().toGain(this.actID[0],this.prizes[this.curIndex],1),this.avo.close();break;case this.avo.btnNo:case this.avo.btnClose:this.avo.close()}},e.wish=function(t,i,e){L.ins().toWish(this.constellationVo.act_id,this.prizes[this.curIndex],e)},e.showWishEff=function(t){this.sp=this.sp||ut.getOne(),this.sp.visible=!0,this.sp.loadAndPlay("moduleEffect/star","default",0,!0),this.sp.scale(1,1),this.sp.x=350,this.sp.y=470,this.addChild(this.sp),this.tipMask.visible=!0,this.txtTip.visible=!0,this.txtTip.text="许愿值+"+(t*this.perProgress[this.curIndex]).toString(),De.setTimeout(this,this.clearTip,null,800)},e.setWishTimes=function(t){this.wishTimes=t},e.clearTip=function(){this.txtTip.visible=!1,this.sp.visible=!1,this.tipMask.visible=!1},e.freeWish=function(){L.ins().toWish(this.constellationVo.act_id,this.prizes[this.curIndex],1),ni.dispatch("ACT_CONSTELLATION_WISH_TIMES",1)},e.wishFail=function(){if(0==this.failOrNot){var t=new q;t.isShowTitle=!0,t.title="召唤失败",t.showRight=!1,t.msg=pe.font("深表惋惜，召唤时装失败，返还您","#5d3924",24)+pe.font(this.wishValues[this.curIndex]+"","#F7EF5F",24)+pe.font("星愿值","#5d3924",24),K.showVO(t)}this.failOrNot=!1},e.update=function(){this.list.refresh(),this.setData(),this.chooseFashsion(this.curIndex),this.updateBtn(),this.updateName(),this.updateBtnVisible(),this.showWishBar(),this.updateRp()},e.updateName=function(){this.nameTxt.text=this.itemVos[this.curIndex].name},e.updateWishBar=function(t){L.ins().toActDetail(this.actID[0]);for(var i=0;i<this.wishValues.length;i++)this.prizes[i]==t.prize_id&&(this.wishValues[i]=this.wishValues[i]+t.add_times*this.perProgress[i],this.returnProgress[i]=t.fail_return_rate);this.showWishBar(),this.setData(),this.updateRp(),this.wishTimes&&this.showWishEff(this.wishTimes)},e.showWishBar=function(){for(var t=0;t<this.wishValues.length;t++)t==this.curIndex&&(this.wishValue.text=this.wishValues[t].toString()+"/"+this.maxProgress[t].toString(),this.proBar.width=this.wishValues[t]/this.maxProgress[t]*482)},e.updateTime=function(){if(this.constellationVo){var t=this.constellationVo.endTime;t<=Ma.serverTime?(this.limitTime.text="活动已结束",De.removeFromSceond(this,this.updateTime)):this.limitTime.text="星座将在"+Qt.formatDHMS(t-Ma.serverTime)+"后离开",this.limitTime.color="#00ff00",this.limitTime.fontSize=24}},e.updateBanner=function(t){4==t&&L.ins().toFinishBanner(this.actID[0],this.prizes[this.curIndex])},e.callBackUpdate=function(){this.update()},o(0,e,"endFirstIndex",function(){return this.itemPaths?this.itemPaths.length-this.repeatX:0}),o(0,e,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,e,"actID",function(){return this._actIDs},function(t){this._actIDs=t}),o(0,e,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(Bt),function(t){function a(){this._data=null,this.goods=null,this.numItems=null,this.nums=null,this.clip=null,this._get=0,a.__super.call(this),this.btnGet.on("click",this,this.onClick)}l(a,"modules.activity.consumeBack.ConsumeBackItem",t);var i=a.prototype;i.onClick=function(){"领取"==this.btnGet.label&&L.ins().toGain(this._data.actID,this._data.conID)},i.update=function(){this.updateNums(),this.htmlCharge.innerHTML=pe.span("累计消费","#e1c6bc")+pe.span(this._data.itemPayGold+"","#fde69a")+pe.span("元宝","#e1c6bc"),this.htmlDes.innerHTML=pe.span("分","#e1c6bc")+pe.span(this._data.gainDay+"","#fde69a")+pe.span("天领取，每日可领取","#e1c6bc")+pe.span(this._data.num+"","#fde69a")+pe.span("元宝","#e1c6bc"),this.goods=this.goods||new oe(91,100,!1,!0,!0,!0,100),this.goods.dataSource=[this._data.itemID,this._data.num],this.goods.setGoodsNameColor("#c29d88"),this.goods.pos(405,10),this.addChild(this.goods),1==this._data.flashEff?(this.clip=this.clip||ut.getOne(),this.clip.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),this.clip.pos(50,95),this.goods.addChild(this.clip)):this.clip&&(this.clip.stop(),this.goods.removeChild(this.clip)),this.setCanGet()},i.updateNums=function(){if(this.numItems&&0<this.numItems.length)for(var t in this.numItems)i=this.numItems[t],this.imgBack.removeChild(i);this.numItems=[],this.nums=[];for(var i,e=this._data.backPer+"",s=0;s<e.length;s++)this.nums.push(e.substr(s,1));3==this.nums.length?(this.imgBack.width=115,this.imgBack.x=42):(this.imgBack.width=100,this.imgBack.x=50);for(var n=3==this.nums.length?a.numsPosX2:a.numsPosX1,h=0;h<this.nums.length;h++)(i=new ge("modules/act/actConsumeBack/"+this.nums[h]+".png")).pos(n[h],2),this.imgBack.addChild(i),this.numItems.push(i)},i.setCanGet=function(){switch(this._get=Mt.getCanGain(this._data),this._get){case 0:this.btnGet.label="不可领",this.btnGet.gray=!0,this.btnGet.mouseEnabled=!1,this.imgRP.visible=!1;break;case 1:this.btnGet.label="领取",this.btnGet.gray=!1,this.btnGet.mouseEnabled=!0,this.imgRP.visible=!0;break;case 2:this.btnGet.label="已领取",this.btnGet.gray=!0,this.btnGet.mouseEnabled=!1,this.imgRP.visible=!1}},o(0,i,"dataSource",t.prototype._$get_dataSource,function(t){this._data=t,this._data&&this.update()}),e(a,["numsPosX1",function(){return this.numsPosX1=[52,65]},"numsPosX2",function(){return this.numsPosX2=[50,64,78]}])}(Lt),function(t){function i(){this.vo=null,this._getTime=!1,this._time=0,this._typeID=null,this._actID=null,this._iconID=NaN,this._skinID=NaN,i.__super.call(this),this.list.vScrollBarSkin="",this.list.itemRender=Na.getClass(1e3,"consumeBack.ConsumeBackItem"),this.htmlDes1.style.align=this.htmlDes2.style.align=this.htmlTime.style.align="center",this.htmlDes1.style.fontSize=this.htmlDes2.style.fontSize=this.htmlTime.style.fontSize=24,this.imgTip.on("click",this,this.onClick),this.on("display",this,this.onDisplay)}l(i,"modules.activity.consumeBack.ConsumeBackView",Gt);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onDisplay=function(){this.on("undisplay",this,this.unDisplay),ni.register("CROSS_DAY",this,this.onCrossDay),ni.register("ACT_CONSTELLATION_CALL_SUCC",this,this.toNewDetail)},e.unDisplay=function(){De.removeFromSceond(this,this.timeLoop),ni.remove("CROSS_DAY",this,this.onCrossDay),ni.remove("ACT_CONSTELLATION_CALL_SUCC",this,this.toNewDetail)},e.onCrossDay=function(){L.ins().toActDetail(this.actID[0])},e.toNewDetail=function(){L.ins().toActDetail(this.actID[0])},e.update=function(){this.imgBg.skin="modules/act/charge/1003/actBg.png",this.vo=G.getActDetailByActID(this.actID[0]),this.vo&&(Mt.consumeBackVO=this.vo,this._getTime=this.vo.joinTime<=0,this._time=this._getTime?this.vo.gainTime:this.vo.joinTime,Mt.setPayLv(this.vo.items),this.initItems(),this.updateDes())},e.initItems=function(){Mt.sortByGain(this.vo.items,this._getTime),this.list.dataSource=this.vo.items},e.updateDes=function(){if(this.vo){var t=Mt.minPayLv,i=Mt.getNextPayGold(this.vo.payLv),e=Mt.getPayLv(this.vo.payLv);this.vo.payGold<=0?this._getTime?(this.htmlDes1.innerHTML=pe.span("活动参与期间未消费","#c29d88"),this.htmlDes2.innerHTML=pe.span("无法享受返利","#c29d88")):(this.htmlDes1.innerHTML=pe.span("当前未消费，无法享受返利","#c29d88"),this.htmlDes2.innerHTML=pe.span("距离下一档返利还差","#c29d88")+pe.span(t+"","#1e9e09")+pe.span("元宝","#c29d88")):this.vo.payLv<=0?this._getTime?(this.htmlDes1.innerHTML=pe.span("活动参与期间累计消费","#c29d88")+pe.span(this.vo.payGold+"","#1e9e09")+pe.span("元宝","#c29d88"),this.htmlDes2.innerHTML=pe.span("无法享受返利","#c29d88")):(this.htmlDes1.innerHTML=pe.span("当前累计消费","#c29d88")+pe.span(this.vo.payGold+"","#1e9e09")+pe.span("元宝，无法享受返利","#c29d88"),this.htmlDes2.innerHTML=pe.span("距离下一档返利还差","#c29d88")+pe.span(t-this.vo.payGold+"","#1e9e09")+pe.span("元宝","#c29d88")):this._getTime?(this.htmlDes1.innerHTML=pe.span("活动参与期间累计消费","#c29d88")+pe.span(this.vo.payGold+"","#1e9e09")+pe.span("元宝","#c29d88"),this.htmlDes2.innerHTML=pe.span("享受","#c29d88")+pe.span(e+"%","#1e9e09")+pe.span("返利档位","#c29d88")):(this.htmlDes1.innerHTML=pe.span("当前累计消费","#c29d88")+pe.span(this.vo.payGold+"","#1e9e09")+pe.span("元宝，可享受","#c29d88")+pe.span(e+"%","#1e9e09")+pe.span("返利档位","#c29d88"),this.htmlDes2.innerHTML=0<i?pe.span("距离下一档返利还差","#c29d88")+pe.span(i-this.vo.payGold+"","#1e9e09")+pe.span("元宝","#c29d88"):pe.span("已达最大返利档位","#c29d88")),0<this._time?De.addToSecond(this,this.timeLoop):(this.htmlTime.innerHTML=pe.span("活动已结束","#1e9e09"),De.removeFromSceond(this,this.timeLoop),this._getTime||L.ins().toActDetail(this.actID[0]))}},e.timeLoop=function(){var t=Qt.formatDHMSArrInt(this._time);0<t[0]&&(t[1]+=24*t[0]);var i=0<t[1]?t[1]+"小时":"",e=0<t[2]?t[2]+"分钟":"";this._getTime?this.htmlTime.innerHTML=pe.span("奖励领取倒计时："+i+e+t[3]+"秒","#1e9e09"):this.htmlTime.innerHTML=pe.span("活动参与倒计时："+i+e+t[3]+"秒","#1e9e09"),this._time--,this._time<0&&this.updateDes()},e.onClick=function(){this.vo&&$i.ins.showMessage(this.vo.rule)},e.callBackUpdate=function(){this.update()},o(0,e,"typeID",function(){return this._typeID},function(t){this._typeID=t}),o(0,e,"actID",function(){return this._actID},function(t){this._actID=t}),o(0,e,"skinID",function(){return this._skinID},function(t){this._skinID=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(),function(t){function i(){this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this._dropRewardVO=null,this._displayVO=null,this._showGoodsArr=[],this._clipArr=[],i.__super.call(this),this.on("display",this,this.onDisplay),this.on("click",this,this.onClick)}l(i,"modules.activity.copyDropReward.ActCopyDropRewardView",c);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onDisplay=function(){this.on("undisplay",this,this.onUnDisplay)},e.onUnDisplay=function(){De.removeFromSceond(this,this.timeLoop)},e.onClick=function(t){switch(t.target){case this.imgHelp:this._displayVO&&$i.ins.showMessage(this._displayVO.help);break;default:if(t.target instanceof modules.athletics.encounter.view.DropItem){var i=t.target;i.data.tempNum=i.num,to.show(i.data,"BASE_GOODS_TIP")}}},e.update=function(){for(var t=0,i=this._typeIDs.length;t<i;t++)switch(this._typeIDs[t]){case 2001:this._dropRewardVO=G.getActDetailByActID(this.actID[t]);break;case 1301:this._displayVO=G.getActDetailByActID(this.actID[t])}this.updateDropRewardShow(),this.parent&&De.addToSecond(this,this.timeLoop)},e.updateDropRewardShow=function(){if(this._displayVO){this.txtDesc.innerHTML=this._displayVO.desc;var t=this._displayVO.items;if(!(t.length<=0)){for(var i in this._showGoodsArr=this._showGoodsArr||[],this._showGoodsArr)this._showGoodsArr[i].removeSelf();this._showGoodsArr=[],this._clipArr=this._clipArr||[];var e=0;for(var s in this._clipArr)this._clipArr[s].removeSelf();for(var n=0,h=t.length;n<h&&!(4<=n);n++){var a=t[n],o=new hi("");o.txtName.fontSize=24,o.mouseEnabled=!0;var r=new Object;r.className="p_tkv",r.type=5,r.id=a.type_id,r.val=a.num,o.setDrop(r),o.y=650,o.x=85+140*n,this.addChild(o),this._showGoodsArr.push(o),1==a.reserve&&(this._clipArr[e]=this._clipArr[e]||ut.getOne(),this._clipArr[e].mouseEnabled=!1,this._clipArr[e].loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),this._clipArr[e].pos(o.x+47,o.y+93),this.addChild(this._clipArr[e]),e++)}}}},e.timeLoop=function(){this._dropRewardVO&&this._dropRewardVO.endTime>Ma.serverTime?this.txtLeftTime.text=Qt.formatDHMS(this._dropRewardVO.endTime-Ma.serverTime):(this.txtLeftTime.text="活动已结束",De.removeFromSceond(this,this.timeLoop))},e.callBackUpdate=function(){this.update()},o(0,e,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t}),o(0,e,"uiClass",function(){return"ActCopyDropReward"}),o(0,e,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,e,"actID",function(){return this._actIDs},function(t){this._actIDs=t})}(),function(t){function i(){this.goodItem=null,this._data=null,i.__super.call(this),this.on("click",this,this.onClick),this.goodItem=new ae(null,!1,!0,91,!0),this.goodItem.pos(24,9),this.goodItem.data=ve.getItem(10201147),this.goodItem.mouseEnabled=!0,this.addChild(this.goodItem)}l(i,"modules.activity.actInvest.InvestItem",_e);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnGet:var i=v.getInvestByEventID(this._data.id);if(1==i.is_buy)I.ins.toRoleInvestGet(this._data.id);else{var e="";switch(i.type){case 1:e="起步";break;case 2:e="成长";break;case 3:e="土豪"}var s=new q;s.msg="抱歉，您当前未购买"+pe.font(e+"投资","#F7EF5F",26)+"，无法获得元宝奖励。请问是否前往购买投资计划（最高返利"+pe.font(i.give_gold+"元宝","#F7EF5F",26)+"）?",s.yesCaller=Ai.ins(),s.yesFun=Ai.ins().toPay,s.yesArgs=[i.buy_id],K.showVO(s)}break;case this.goodItem:I.ins.toRoleInvestGet(this._data.id);var n=ve.getItem(10201147);n.tempNum=this._data.gold,to.show(n,"BASE_GOODS_TIP")}},e.buyInvest=function(t,i){Ai.ins().toPay(t),Ve.send(10047,2,i+"投资")},o(0,e,"data",null,function(t){this._data=t;var i,e=!1,s=v.getInvestByEventID(this._data.id);0==t.need_level?(this.txt.text="存入当天可领取",e=0==t.state&&1==s.is_buy):(i=t.need_level<=100?t.need_level+"级":(t.need_level-100)/10+"转",this.txt.text="达到"+i+"，领取",e=0==t.state&&ie.myEquipLevel>=t.need_level&&1==s.is_buy);this.imgRp.visible=e;var n,h=t.gold,a=Rt.numToTexture(h,"modules/act/invest/num");this.num.graphics.clear();for(var o=0;o<a.length;o++)n=a[o],this.num.graphics.drawTexture(n,n.width*o);n=Oe.getRes("modules/act/invest/gold.png"),this.num.graphics.drawTexture(n,22*a.length,-4),this.num.x=this.txt.textWidth+this.txt.x,1==s.is_buy?0==t.state?(this.btnGet.label="领取",ie.myEquipLevel>=t.need_level?this.btnGet.disabled=!1:this.btnGet.disabled=!0):(this.btnGet.label="已领取",this.btnGet.disabled=!0):(this.btnGet.label="领取",this.btnGet.disabled=!1),this.goodItem.num=this._data.gold})}(),function(t){function i(){this._data=null,this._desc=0,i.__super.call(this),this.txtLink.visible=!1,this.txtLink.on("click",this,this.onClick)}l(i,"modules.activity.customStand.CustomStandItem",t);var e=i.prototype;e.onClick=function(){ni.dispatch("ACT_CUSTOM_STAND_DETAILS")},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(this._data=t,this._data)if(0==this._data.row.row_id)this.imgRank.skin="modules/act/customStand/itemImg4.png",this.txtLink.visible=!0,this.txtLink.underline=!0,this.txtName.visible=this.txtCustom.visible=this.needNum.visible=this.txtRank.visible=this.star.visible=!1;else if(0<this._data.row.row_id&&this._data.row.row_id<=3?this.imgRank.skin="modules/act/customStand/itemImg"+this._data.row.row_id+".png":this._data.row.role_id==Ne.roleID&&3<this._data.row.row_id?this.imgRank.skin="modules/act/customStand/itemImg5.png":this.imgRank.skin="modules/act/customStand/itemImg4.png",this.star.visible=!1,this._data.row.role_id==Ne.roleID&&(this.star.visible=!0),this.txtLink.visible=!1,this.txtName.visible=this.txtCustom.visible=this.needNum.visible=this.txtRank.visible=!0,this.txtRank.text=3<this._data.row.row_id?this._data.row.row_id+"":"",this._data.row.elements){this.txtName.text=this._data.row.elements[0],this.txtCustom.text=this._data.row.elements[1]+"关";var i=this._data.targetId-this._data.row.elements[1];0<i?this.needNum.text=i+"关":0==i&&this._data.row.row_id<=20?this.needNum.text="已发奖":this.needNum.text="0关"}})}(Xt),function(t){function i(){this.items=null,this._typeID=null,this._actID=null,this._iconID=NaN,this._skinID=NaN,i.__super.call(this),this.on("display",this,this.onDisplay),this.tab.on("change",this,this.update),this.on("click",this,this.onClick),this.pan.vScrollBarSkin=""}l(i,"modules.activity.actInvest.InvestView",Ie);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onClick=function(t){switch(t.target){case this.btnGet1:I.ins.toRoleInvestBenifit();break;case this.imgTip:$i.ins.showMessage(pe.font("1、每个玩家仅能购买其中一个投资计划；","#5d3924",26)+"<br>"+pe.font("2、每个玩家仅能获得一个投资福利礼包；","#5d3924",26));break;case this.btnInv:var i=v.getInvestInfo();if(i&&i.invest_infos){var e=i.invest_infos[this.tab.selectedIndex],s="";switch(e.type){case 1:s="起步";break;case 2:s="成长";break;case 3:s="土豪"}var n=new q;Ne.isWX?(n.msg=pe.font("是否花费","#5d3924",24)+pe.font(e.need_rmb+"元","#F7EF5F",24)+pe.font("购买","#5d3924",24)+pe.font(s+"投资","#F7EF5F",24)+pe.font("（返利","#5d3924",24)+pe.font(Math.floor(e.give_gold/e.need_rmb+.5)+"0%元宝","#F7EF5F",24)+pe.font("）?","#5d3924",24)+"<br>"+pe.font("（注：每个玩家只能购买其中一种投资计划）","#5d3924",24),n.yesCaller=this,n.yesFun=this.buyInvest,n.yesArgs=[e.buy_id,s]):(Vh.isFanTi?(n.msg=pe.font("是否花费","#5d3924",24)+pe.font(e.need_rmb+"仙尊幣","#F7EF5F",24)+pe.font("购买","#5d3924",24)+pe.font(s+"投资","#F7EF5F",24)+pe.font("（返利","#5d3924",24)+pe.font(Math.floor(e.give_gold/e.need_rmb+.5)+"0%元宝","#F7EF5F",24)+pe.font("）?","#5d3924",24)+"<br>"+pe.font("（注：每个玩家只能购买其中一种投资计划）","#5d3924",24),n.yesFun=Ai.ins().toExchange):(Vh.isXianLai?n.msg=pe.font("是否花费","#5d3924",24)+pe.font(10*e.need_rmb+"钻石","#F7EF5F",24)+pe.font("购买","#5d3924",24)+pe.font(s+"投资","#F7EF5F",24)+pe.font("（返利","#5d3924",24)+pe.font(Math.floor(e.give_gold/e.need_rmb+.5)+"0%元宝","#F7EF5F",24)+pe.font("）?","#5d3924",24)+"<br>"+pe.font("（注：每个玩家只能购买其中一种投资计划）","#5d3924",24):n.msg=pe.font("是否花费","#5d3924",24)+pe.font(e.need_rmb+"元","#F7EF5F",24)+pe.font("购买","#5d3924",24)+pe.font(s+"投资","#F7EF5F",24)+pe.font("（返利","#5d3924",24)+pe.font(Math.floor(e.give_gold/e.need_rmb+.5)+"0%元宝","#F7EF5F",24)+pe.font("）?","#5d3924",24)+"<br>"+pe.font("（注：每个玩家只能购买其中一种投资计划）","#5d3924",24),n.yesFun=Ai.ins().toPay),n.yesCaller=Ai.ins(),n.yesArgs=[e.buy_id]),K.showVO(n)}break;case this.imgGift:var h=ve.getItem(10201111);h.tempNum=5,to.show(h,"BASE_GOODS_TIP")}},e.buyInvest=function(t,i){Ai.ins().toPay(t),Ve.send(10047,2,i+"投资")},e.onDisplay=function(){ni.register("UPDATE_INVESTVIEW",this,this.update),this.on("undisplay",this,this.onUnDisplay),De.addToSecond(this,this.timeLoop);var t=v.getInvestInfo();0<t.invest_infos.length&&(this.tab.selectedIndex=t.invest_infos.length-1)},e.onUnDisplay=function(){ni.remove("UPDATE_INVESTVIEW",this,this.update),this.off("undisplay",this,this.onUnDisplay),De.removeFromSceond(this,this.timeLoop)},e.timeLoop=function(){var t=v.getInvestInfo();0<t.invest_infos.length&&1==t.invest_infos[0].is_buy?(this.txtLeftTime.text="所有奖励领取完毕后失效",De.removeFromSceond(this,this.timeLoop)):t&&t.attend_end_ts>Ma.serverTime?this.txtLeftTime.text=Qt.formatDHMS(t.attend_end_ts-Ma.serverTime):(this.txtLeftTime.text="活动已失效",De.removeFromSceond(this,this.timeLoop))},e.setLayout=function(){if(no.has("modules/act/invest")){var t,i=v.getInvestInfo(),e="";if(i&&i.invest_infos){for(var s=0;s<i.invest_infos.length;s++){switch(t="",i.invest_infos[s].type){case 1:t+="起步";break;case 2:t+="成长";break;case 3:t+="土豪"}e+=t+="投资",s!=i.invest_infos.length-1&&(e+=",")}this.tab.labels=e}}else no.add("modules/act/invest","正在加载投资计划",this,this.setLayout)},e.update=function(){if(no.has("modules/act/invest")){this.setLayout();var t,i=v.getInvestInfo();if(i&&i.invest_infos&&(i.invest_infos.length<this.tab.selectedIndex&&(this.tab.selectedIndex=0),(t=i.invest_infos[this.tab.selectedIndex])&&(this.btnInv.label="投资"+t.need_rmb,0==i.benifit?(this.btnGet1.disabled=!1,this.btnGet1.label="领取",this.imgRp.visible=!0):(this.btnGet1.disabled=!0,this.btnGet1.label="已领取",this.imgRp.visible=!1)),t&&t.rewards)){var e,s,n=t.need_rmb,h=Rt.numToTexture(n,"modules/act/invest/");this.num1.graphics.clear();for(var a=0;a<h.length;a++)e=h[a],this.num1.graphics.drawTexture(e,e.width*a);for(this.num1.x=102+(67-25*h.length)/2,n*=10,h=Rt.numToTexture(n,"modules/act/invest/"),this.num2.graphics.clear(),a=0;a<h.length;a++)e=h[a],this.num2.graphics.drawTexture(e,e.width*a);for(this.num2.x=287+(98-25*h.length)/2,n=Math.floor(t.give_gold/n+.5),h=Rt.numToTexture(n,"modules/act/invest/"),this.num3.graphics.clear(),a=0;a<h.length;a++)e=h[a],this.num3.graphics.drawTexture(e,e.width*a);for(this.num3.x=29+(41-25*h.length)/2,n=t.give_gold,h=Rt.numToTexture(n,"modules/act/invest/"),this.num4.graphics.clear(),a=0;a<h.length;a++)e=h[a],this.num4.graphics.drawTexture(e,e.width*a);104<25*h.length?(this.num4.scale(4.16/h.length,4.16/h.length),this.num4.x=322,this.num4.y=(29-4.16/h.length*29)/2+73):(this.num4.scale(1,1),this.num4.x=322+(104-25*h.length)/2,this.num4.y=73),this.items=this.items||[];var o=Math.max(this.items.length,t.rewards.length);for(a=0;a<o;a++)a<t.rewards.length?(this.items[a]=this.items[a]||Na.getIns(1e3,"actInvest.InvestItem"),(s=this.items[a]).data=t.rewards[a],s.pos(0,114*a),this.pan.addChild(s)):this.items[a]&&this.items[a].parent&&this.items[a].removeSelf();Ne.isWX?this.btnInv.label=0==t.is_buy?"投资"+t.need_rmb+"元":"已投资":Vh.isFanTi?this.btnInv.label=0==t.is_buy?"投资"+t.need_rmb+"仙尊幣":"已投资":Vh.isXianLai?this.btnInv.label=0==t.is_buy?"投资"+10*t.need_rmb+"钻石":"已投资":this.btnInv.label=0==t.is_buy?"投资"+t.need_rmb+"元":"已投资",this.btnInv.disabled=0!=t.is_buy}}else no.add("modules/act/invest","正在加载投资计划",this,this.update)},e.callBackUpdate=function(){},o(0,e,"typeID",function(){return this._typeID},function(t){this._typeID=t}),o(0,e,"actID",function(){return this._actID},function(t){this._actID=t}),o(0,e,"skinID",function(){return this.skinID},function(t){this._skinID=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(),function(t){function o(){this.helpStr=null,this.endTime=0,this.rewrads=null,this._rank_get=NaN,this.iconVo=null,this.rankVO=null,this.preRowId=0,this.myCustomRank=0,this.lastCustomRank=0,this.customRankVos=[],this.rewards=[],this.rewardNums=[],this.items=[],this.sp=null,this.showId=0,this.rewardArr=[],o.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.listRank.itemRender=Na.getClass(1e3,"customStand.CustomStandItem"),this.listRank.vScrollBarSkin="",this.listRank.scrollBar.autoHide=!0,this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.linkTxt.underline=this.linkTxt2.underline=!0,this.getBtn.visible=!1,this.getData(o.descArr[0]),this.getData(o.descArr[1]),this.getData(o.descArr[2]),this.redPoint.visible=!1}l(o,"modules.activity.customStand.CustomStandView",zt);var i=o.prototype;i.getData=function(t){switch(o.curDesc){case o.descArr[0]:$s.ins().toGetRank(6001);break;case o.descArr[1]:$s.ins().toGetRank(6002);break;case o.descArr[2]:$s.ins().toGetRank(6003)}},i.onDisplay=function(){this.toRankInfo(o.curDesc),this.rewardArr=G.getCustomRewardVO(),this.getData(o.curDesc),ni.register("RANK_GOT_DATA_UPDATE",this,this.setData),ni.register("ACT_CUSTOM_STAND_DETAILS",this,this.openDetails),De.addToSecond(this,this.updateTime),this.on("undisplay",this,this.onUNDisplay)},i.onUNDisplay=function(){De.removeFromSceond(this,this.updateTime),ni.remove("ACT_CUSTOM_STAND_DETAILS",this,this.openDetails),ni.remove("RANK_GOT_DATA_UPDATE",this,this.setData)},i.onClick=function(t){var i,e="";switch(t.target){case this.help:$i.ins.showMessage(this.helpStr);break;case this.closeBtn:case this.closeBtn2:this.closeWindow();break;case this.getBtn:this.getMyReward();break;case this.tab1:o.perDesc=o.curDesc,$s.ins().toGetRank(6001),o.curDesc=o.descArr[0],this.toRankInfo(o.curDesc),this.preRowId=0;break;case this.tab2:o.perDesc=o.curDesc,$s.ins().toGetRank(6002),o.curDesc=o.descArr[1],this.preRowId=0;break;case this.tab3:o.perDesc=o.curDesc,$s.ins().toGetRank(6003),o.curDesc=o.descArr[2],this.preRowId=0;break;case this.rewardSp2:this.sp&&(i=ve.getItem(this.showId)),i&&(i.tempNum=1,e=ve.isEquip(i.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(i,e));break;case this.linkImg:case this.linkTxt2:this.openReWardGetView(o.curDesc);break;case this.linkTxt:Ae.linkTo(10600)}},i.toRankInfo=function(t){for(var i=0,e=0;e<o.descArr.length;e++)o.descArr[e]==t&&(i=e+1);L.ins().toGainRankInfo(i)},i.changaText=function(t){for(var i=0,e=0;e<o.descArr.length;e++)o.descArr[e]==t&&(i=e+1);for(var s=1;s<4;s++)s==i?(this["descTxt"+s].color="#3e1e0c",this["tab"+s].skin="modules/act/customStand/tabImg2.png"):(this["descTxt"+s].color="#5d3924",this["tab"+s].skin="modules/act/customStand/tabImg1.png")},i.openReWardGetView=function(t){M.getInstance().openRankDetailsView(t,this.preRowId)},i.getMyReward=function(){if(this.endTime<Ma.serverTime)io.addTip("活动已经结束，奖励已经通过邮件发放");else for(var t=0;t<o.descArr.length;t++)o.descArr[t]==o.curDesc&&L.ins().toGainRankReward(t+1)},i.setData=function(t){6002==t?this.rankVO=Js.getRankVO(6002):6003==t?this.rankVO=Js.getRankVO(6003):6001==t&&(this.rankVO=Js.getRankVO(6001)),this.update(),this.iconVo=fe.getIconStateDicValus(126),this.endTime=this.iconVo.end_time},i.openDetails=function(){var t;for(var i in this.rankVO.rows)if(0==(t=this.rankVO.rows[i]).row_id){t.row_id=this.preRowId;break}for(var e=0;e<this.rankVO.rows.length;e++)this.customRankVos[e]=new Yt,this.customRankVos[e].row=this.rankVO.rows[e],this.customRankVos[e].targetId=o.curDesc;this.listRank.dataSource=this.customRankVos},i.setRank_get=function(t){this._rank_get=t,this.update()},i.update=function(){if($s.ins().checkCustomStandRp(),1==this._rank_get&&this.getBtn.visible?(this.redPoint.visible=!1,this.getBtn.gray=!0,this.getBtn.mouseEnabled=!1):0==this._rank_get&&this.getBtn.visible&&(this.redPoint.visible=!0,this.getBtn.gray=!1,this.getBtn.mouseEnabled=!0),this.rankVO&&0<this.rankVO.rows.length){this.toRankInfo(o.curDesc),this.myCustomRank=this.rankVO.pData.ranking,this.lastCustomRank=this.rankVO.rows[this.rankVO.rows.length-1].row_id,this.rankVO.pData&&0<this.rankVO.pData.ranking?this.myRank.text="我的排名："+this.rankVO.pData.ranking:this.myRank.text="我的排名：未上榜";var t=o.curDesc-this.rankVO.pData.rank_value;this.descNum.text=0<t?"距离目标："+t:"距离目标： 0";for(var i=[],e=0;e<this.rankVO.rows.length;e++)i[e]=this.rankVO.rows[e];5<i.length&&4!=this.myCustomRank&&(5<this.myCustomRank?i.splice(3,this.myCustomRank-5):i.splice(3,this.lastCustomRank-5),this.preRowId=0==this.preRowId?i[3].row_id:this.preRowId,i[3].row_id=0),this.customRankVos=[];for(var s=0;s<i.length;s++)this.customRankVos[s]=new Yt,this.customRankVos[s].row=i[s],this.customRankVos[s].targetId=o.curDesc;this.listRank.dataSource=this.customRankVos,this.rankVO.pData.rank_value>=o.curDesc&&0<this.rankVO.pData.ranking&&this.rankVO.pData.ranking<=20?(this.showMyReward(),1==this._rank_get&&this.getBtn.visible?this.redPoint.visible=!1:0==this._rank_get&&this.getBtn.visible&&(this.redPoint.visible=!0),this.getBtn.visible=!0,this.tipTxt.visible=!1):(this.hideMyReward(),this.redPoint.visible=!1,this.getBtn.visible=!1,this.tipTxt.visible=!0),this.changaText(o.curDesc)}else o.curDesc==o.descArr[0]?this.listRank.dataSource=[]:io.addTip("暂无玩家激活榜单"),o.curDesc=o.perDesc,this.changeVo(o.curDesc);this.showReward(),this.helpStr="1、三个榜单中，每个榜单的前20名（含第20名）达到通关目标的玩家可获得通关奖励；<br>2、榜单奖励需满足“通关榜单关卡目标”且“通关时间在排行榜前20名内”2个条件才可以进行奖励的领取；<br>3、红色称号为绝版奖励，不再进行产出。<br><br>注：活动最终解释权归运营团队所属。"},i.changeVo=function(t){switch(t){case o.descArr[0]:this.rankVO=Js.getRankVO(6001);break;case o.descArr[1]:this.rankVO=Js.getRankVO(6002);break;case o.descArr[2]:this.rankVO=Js.getRankVO(6003)}},i.updateBtn=function(t){$s.ins().checkCustomStandRp(),this.redPoint.visible=!1,this.getBtn.gray=!0,this.getBtn.mouseEnabled=!1},i.resetText=function(){this.myRank.text="我的排名：未上榜",this.descNum.text="距离目标："+o.curDesc},i.hideMyReward=function(){this.rewardSp.visible=!1},i.updateTime=function(){this.endTime>Ma.serverTime?this.limitTime.text=Qt.formatDHMS(this.endTime-Ma.serverTime):(De.removeFromSceond(this,this.updateTime),this.limitTime.text="活动已结束",this.getBtn.gray=!0)},i.showMyReward=function(){var t=0;this.rewards=[],this.rewardNums=[];for(var i=0;i<o.descArr.length;i++)o.curDesc==o.descArr[i]&&(t=i);if(o.curDesc==o.descArr[t])for(var e=0+20*t;e<20+20*t;e++)if(this.myCustomRank-1==e-20*t)for(var s=0;s<this.rewardArr[e].length;s++){var n=this.rewardArr[e][s].split("|");this.rewards[s]=n[0],this.rewardNums[s]=n[1]}var h=0;for(this.rewardSp.visible=!0;0<this.rewardSp.numChildren;)this.rewardSp.getChildAt(0).removeSelf();for(var a in this.rewards)this.rewards[a],this.items[h]=new oe(90,90,!1,!0,!0,!1),this.items[h].dataSource=[this.rewards[h],this.rewardNums[h]],this.items[h].x=100*h,this.items[h].hideGoodsName(),this.rewardSp.addChild(this.items[h]),h++},i.showReward=function(){var t=this.rewardArr[40][0].split("|");this.showId=t[0],this.sp=this.sp||ut.getOne(),this.sp.loadAndPlay("unit/title/"+this.showId,"default",0,!0),this.sp.pos(100,100),this.rewardSp2.addChild(this.sp)},e(o,["descArr",function(){return this.descArr=[2200,3600,5e3]},"curDesc",function(){return this.curDesc=o.descArr[0]},"perDesc",function(){return this.perDesc=o.descArr[0]}])}(),function(t){function i(){this._data=null,this.rewrads=[],i.__super.call(this)}l(i,"modules.activity.customStand.RankDetailItem",t),o(0,i.prototype,"dataSource",t.prototype._$get_dataSource,function(t){if(this._data=t,this._data&&this._data.row){for(;0<this.itemSp.numChildren;)this.itemSp.getChildAt(0).removeSelf();this.rankTxt.text=this._data.row.row_id+"",this._data.row.elements&&this._data.row.elements[1]>=this._data.targetId?this.nameTxt.text=this._data.row.elements[0]:this.nameTxt.text="无人达标";for(var i=0;i<this._data.rewards.length;i++){var e;(e=new oe(90,90,!1,!0,!0,!1)).dataSource=[this._data.rewards[i].id,this._data.rewards[i].num],e.x=95*i,e.hideGoodsName(),this.itemSp.addChild(e)}}})}(zs),function(t){function i(){this._data=null,this._desc=0,this.rewrads1=[],this.rewrads2=[],this.rewrads3=[],this.rankVO=null,this.customRankVos=[],i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.rankList.itemRender=Na.getClass(1e3,"customStand.RankDetailItem"),this.rankList.vScrollBarSkin="com/ui/vscroll.png",this.rankList.scrollBar.autoHide=!0,this.on("click",this,this.onClick),this.on("display",this,this.onDisplay)}l(i,"modules.activity.customStand.RankDetailsView",Qs);var e=i.prototype;e.onDisplay=function(){this.setRewardData()},e.setData=function(t){void 0===t&&(t=6001),this.rankVO=6002==t?Js.getRankVO(6002):6003==t?Js.getRankVO(6003):Js.getRankVO(6001)},e.onClick=function(t){switch(t.target){case this.closeBtn:this.closeWindow()}},e.setRewardData=function(){for(var t=G.getCustomRewardVO(),i=0;i<60;i++){i<20?this.rewrads1[i]=[]:20<=i&&i<40?this.rewrads2[i-20]=[]:this.rewrads3[i-40]=[];for(var e=0;e<t[i].length;e++){var s=t[i][e].split("|");i<20?(this.rewrads1[i][e]=new Object,this.rewrads1[i][e].id=s[0],this.rewrads1[i][e].num=s[1]):20<=i&&i<40?(this.rewrads2[i-20][e]=new Object,this.rewrads2[i-20][e].id=s[0],this.rewrads2[i-20][e].num=s[1]):(this.rewrads3[i-40][e]=new Object,this.rewrads3[i-40][e].id=s[0],this.rewrads3[i-40][e].num=s[1])}}},e.getdate=function(t){switch(this._desc=t){case 1e3:$s.ins().toGetRank(6001);case 2e3:$s.ins().toGetRank(6002);case 3e3:$s.ins().toGetRank(6003)}},e.update=function(t,i){switch(this.customRankVos=[],t){case 2200:if(this.rankVO=Js.getRankVO(6001),this.rankVO)for(var e=0;e<20;e++)this.customRankVos[e]=new Yt,e<this.rankVO.rows.length&&0<=this.rankVO.rows[e].row_id&&this.rankVO.rows[e].row_id<=20?(this.customRankVos[e].row=this.rankVO.rows[e],0==this.rankVO.rows[e].row_id&&(this.rankVO.rows[e].row_id=i)):(this.customRankVos[e].row=new Object,this.customRankVos[e].row.className="p_rank_row",this.customRankVos[e].row.row_id=e+1),this.customRankVos[e].rewards=this.rewrads1[e],this.customRankVos[e].targetId=t;break;case 3600:if(this.rankVO=Js.getRankVO(6002),this.rankVO)for(var s=0;s<20;s++)this.customRankVos[s]=new Yt,s<this.rankVO.rows.length&&0<=this.rankVO.rows[s].row_id&&this.rankVO.rows[s].row_id<=20?(this.customRankVos[s].row=this.rankVO.rows[s],0==this.rankVO.rows[s].row_id&&(this.rankVO.rows[s].row_id=i)):(this.customRankVos[s].row=new Object,this.customRankVos[s].row.className="p_rank_row",this.customRankVos[s].row.row_id=s+1),this.customRankVos[s].rewards=this.rewrads2[s],this.customRankVos[s].targetId=t;break;case 5e3:if(this.rankVO=Js.getRankVO(6003),this.rankVO)for(var n=0;n<20;n++)this.customRankVos[n]=new Yt,n<this.rankVO.rows.length&&0<=this.rankVO.rows[n].row_id&&this.rankVO.rows[n].row_id<=20?(this.customRankVos[n].row=this.rankVO.rows[n],0==this.rankVO.rows[n].row_id&&(this.rankVO.rows[n].row_id=i)):(this.customRankVos[n].row=new Object,this.customRankVos[n].row.className="p_rank_row",this.customRankVos[n].row.row_id=n+1),this.customRankVos[n].rewards=this.rewrads3[n],this.customRankVos[n].targetId=t}this.rankVO&&0<this.rankVO.rows.length?this.rankList.dataSource=this.customRankVos:this.rankList.dataSource=[]}}(),function(t){function i(){this._data=[],this.isSample=!1,this.index=0,this.BuyTimes=1,i.__super.call(this),this.setIsSample(),this.on("click",this,this.onClick)}l(i,"modules.activity.dayLimitBuy.DayLimitBuyItem",t);var e=i.prototype;e.setIsSample=function(){Vh.isFanTi?(this.isSample=!1,this.index=0):(this.isSample=!0,this.index=3)},e.onClick=function(t){switch(t.target){case this.btnBuy:this._data&&(1<=this._data.canBuyTimes?this.isSample?Ai.ins().toPay(this._data.buyId):Ai.ins().toExchange(this._data.buyId):io.addTip("购买次数超过限制！"))}},e.updateRp=function(){1<=this._data.canBuyTimes?this.rpImg.visible=!0:this.rpImg.visible=!1},e.changeView=function(){"6"==this._data.price?(this.titleImg.skin="modules/act/dayLimitBuy/item"+(1+this.index)+".png",this.isSample?this.btnBuy.label=Vh.isXianLai?"60钻石抢购":"6元抢购":this.btnBuy.label="6仙尊幣"):"18"==this._data.price?(this.titleImg.skin="modules/act/dayLimitBuy/item"+(2+this.index)+".png",this.isSample?this.btnBuy.label=Vh.isXianLai?"180钻石抢购":"18元抢购":this.btnBuy.label="18仙尊幣"):"40"==this._data.price&&(this.titleImg.skin="modules/act/dayLimitBuy/item"+(3+this.index)+".png",this.isSample?this.btnBuy.label=Vh.isXianLai?"400钻石抢购":"40元抢购":this.btnBuy.label="40仙尊幣"),this.isSample?this.txt1.text="已购：     次":this.txt1.text="已購：     次"},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(this._data=t,this._data){this.changeView(),this.hasBuy.text=this.BuyTimes-this._data.canBuyTimes+"/1";var i,e=0;for(var s in this._data.arrInfos){var n;i=this._data.arrInfos[s],(n=new oe(91,100,!1,!0,!0)).scale(.9,.9,!0),n.pos(0+90*e,0),n.dataSource=[i.id,i.val],n.setGoodsNameColor("#f4f1b2"),this.buyItem.addChild(n),e++}this.updateRp()}})}(jt),function(t){function i(){this.repeat=3,this.iconId=0,this.data=[],this.buyItmeVoArr=[],i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.itemList.itemRender=Na.getClass(1e3,"dayLimitBuy.DayLimitBuyItem"),this.itemList.dataSource=[],this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.updateTime()}l(i,"modules.activity.dayLimitBuy.DayLimitBuyView",Jt);var e=i.prototype;e.onDisplay=function(){ni.register("CROSS_DAY",this,this.onCrossDay),ni.dispatch("ROLE_ICON_INFO_BACK",this,this.updateView),this.on("undisplay",this,this.onUNDisplay),this.updateTime()},e.updateView=function(t){120==t&&this.update(this.iconId)},e.onUNDisplay=function(){ni.remove("CROSS_DAY",this,this.onCrossDay),ni.dispatch("ROLE_ICON_INFO_BACK",this,this.updateView)},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow()}},e.onCrossDay=function(){this.update(this.iconId),this.updateTime()},e.update=function(t){this.changeView(),this.iconId=t,this.data=this.getInfoData(),this.itemList.dataSource=this.data,this.explainTxt.text="活动期间，每个礼包仅能购买一次，点击购买即可获得礼包。（本活动不同时享受其他充值活动奖励）"},e.changeView=function(){Vh.isFanTi?(this.title.skin="modules/act/dayLimitBuy/title.png",this.tip1.skin="modules/act/dayLimitBuy/tip1.png",this.tip2.skin="modules/act/dayLimitBuy/tip2.png",this.txt1.text="活動時間：",this.txt2.text="活動說明："):(this.title.skin="modules/act/dayLimitBuy/title2.png",this.tip1.skin="modules/act/dayLimitBuy/tip3.png",this.tip2.skin="modules/act/dayLimitBuy/tip4.png",this.txt1.text="活动时间：",this.txt2.text="活动说明：")},e.getInfoData=function(){var t=fe.getIconInfo(this.iconId),i=[];if(!t||""==t)return null;var e=t.split("##");if(e.length<=0)return null;for(var s=0;s<e.length;s++){var n=e[s].split("#");i[s]={},i[s].buyId=n[0],i[s].price=n[1],i[s].canBuyTimes=n[2],i[s].arrInfos=[];for(var h=n.length-3,a=0,o=Math.floor(h/3);a<o;a++){var r=new Object;r.className="p_tkv",r.type=n[3*(a+1)+0],r.id=n[3*(a+1)+1],r.val=n[3*(a+1)+2],i[s].arrInfos[a]=r}}return i},e.updateTime=function(){var t=(Ma.serverTime+28800)%86400;this.timeTxt.text=Qt.format(Ma.serverTime-t,!0,!0)+"-"+Qt.format(Ma.serverTime-t+86400-1,!0,!0)}}(),function(t){function i(){this.pkv=null,i.__super.call(this)}return l(i,"modules.activity.dial.DialDisplayItem",t),o(0,i.prototype,"dataSource",t.prototype._$get_dataSource,function(t){if(this.pkv=t,null!=this.pkv){var i=ve.getItem(this.pkv.id),e=(this.pkv.val/100*100).toFixed(2)+"%";this.txtItem.text=i.name,this.txtPro.text=e}}),i}(Zt)),Zo=(function(t){function i(){this.logItems=null,this.curItemY=2,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.proList.vScrollBarSkin="",this.proList.itemRender=$o,this.recordList.vScrollBarSkin="",this.logItems=[],this.on("click",this,this.onClick)}l(i,"modules.activity.dial.DialDisplayPanel",ti);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow()}},e.updateType=function(t,i){if("TYPE_PROBABILITY"==t)this.titleText.text="抽奖概率",this.probText.visible=this.proList.visible=!0,this.recordBG.visible=this.recordList.visible=!1,this.proList.dataSource=i.rate_list;else if("TYPE_RECORD"==t){for(this.titleText.text="抽奖记录",this.probText.visible=this.proList.visible=!1,this.recordBG.visible=this.recordList.visible=!0;0<this.logItems.length;){var e=this.logItems.shift();e.visible=!0,e.removeSelf()}var s;for(var n in i.records)s=i.records[n],this.createHtmlItem(s);this.curItemY=2,this.updatePos()}},e.createHtmlItem=function(t){var i=new ce;i.style.fontSize=24,i.color="#efdcaf",i.style.lineHeight=30,i.width=590;var e=t.split("#"),s=e[1],n=e[2],h=ve.getItem(n),a=e[3],o=e[4];i.innerHTML=s+"幸运地获得了"+pe.span(o+"","#eee3b8")+"倍的"+pe.span("【"+h.name+"】x"+a,Qi.COLORS_LIGHT[h.color]),i.height=i.contextHeight,this.logItems.push(i)},e.updatePos=function(){for(var t=0;t<this.logItems.length;t++){var i=this.logItems[t];this.recordList.addChild(i),i.y=this.curItemY,this.curItemY+=i.height+2}}}(),function(t){function i(){this.ITEM_POS=[[375,222],[271,250],[195,328],[166,432],[194,537],[271,614],[375,641],[480,614],[557,537],[585,432],[557,328],[480,250]],this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this.mainVO=null,i.__super.call(this)}l(i,"modules.activity.dial.DialPanel",t);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.createChildren=function(){t.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_8",!0,"",!0),this.btnStart.on("click",this,this.onStart),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay)},e.onDisplay=function(t){L.ins().toActDetail(this.actID[0]),this.on("undisplay",this,this.unDisplay),ni.register("DIAL_ROTATE",this,this.rotateFunc),ni.register("CROSS_DAY",this,this.corssDay)},e.unDisplay=function(){this.off("undisplay",this,this.unDisplay),ni.remove("DIAL_ROTATE",this,this.rotateFunc),ni.remove("CROSS_DAY",this,this.corssDay)},e.onStart=function(t){if(this.mainVO)if(ii.rotating)io.addTip("抽奖中");else{if(this.mainVO.remainTime<=0){var i=new q;return i.msg="您未达到抽奖条件，是否前往充值？",i.yesCaller=Ae,i.yesFun=Ae.linkTo,i.yesArgs=[11454],void K.showVO(i)}ii.rotating=!0,L.ins().toGain(this.actID[0],0)}},e.onClick=function(t){switch(t.target){case this.btn:this.closeWindow();break;case this.imgPro:this.mainVO&&$t.ins().openProbabilityPanel(this.mainVO);break;case this.imgRec:this.mainVO&&$t.ins().openRecordPanel(this.mainVO)}},e.update=function(){if(this.mainVO=G.getActDetailByActID(this.actID[0]),this.mainVO&&(this.htmlTxt.innerHTML=this.mainVO.desc,this.txtTimes.text=this.mainVO.remainTime+"次",this.txtGold.text=this.mainVO.totalGold+"",!ii.rotating&&0==this.dial.numChildren))for(var t,i=0;i<this.mainVO.goods.length;i++)(t=new oe(80,80,!1,!1,!0,!0,80,!0)).dataSource=this.mainVO.goods[i].good,t.num=this.mainVO.goods[i].num,t.hideGoodsName(),t.anchorX=t.anchorY=.5,t.pos(this.ITEM_POS[i][0],this.ITEM_POS[i][1]),this.dial.addChild(t)},e.rotateFunc=function(){var t=1080+30*(ii.seq-1);eo.to(this.dial,{rotation:t,update:ue.create(this,this.onUpdate)},3e3,ai.quadOut,ue.create(this,this.onComplete))},e.onUpdate=function(){for(var t=0;t<this.dial.numChildren;t++){this.dial.getChildAt(t).rotation=-this.dial.rotation}},e.onComplete=function(){var t,i,e=ii.multiple,s=ii.rewardList;for(var n in s)i=s[n],(t=ve.getItem(i.type_id))&&io.addTip(t.name+"  ×"+i.num*e,Qi.getColorDark(t.color));this.dial.rotation=this.dial.rotation%360,ii.rotating=!1},e.corssDay=function(){L.ins().toActDetail(this.actID[0])},e.callBackUpdate=function(){this.update()},o(0,e,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,e,"actID",function(){return this._actIDs},function(t){this._actIDs=t,G.registerActCBFunc(this.actID[0],this,this.callBackUpdate)}),o(0,e,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(ei),function(t){function i(){this.board=null,this.curIndex=0,this.selectedEffectPosX=[29,197,366,534],this.bmClips=null,this.itemArr=null,this.curVO=null,this.curItemVo=null,this.selectGoodsVO=null,this._typeID=null,this._actID=null,this._iconID=NaN,this._skinID=NaN,i.__super.call(this),this.on("display",this,this.onDisplay),this.on("click",this,this.onClick),this.txtTip.style.align="center",this.txtTip.style.stroke=1,this.txtTip.style.strokeColor="#240000",this.specialTip.style.align="center",this.specialTip.style.stroke=1,this.specialTip.style.strokeColor="#240000",this.board=new ct,this.board.pos(0,5),this.addChild(this.board)}l(i,"modules.activity.discounts.ActDiscountsView",t);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onClick=function(t){switch(t.target){case this.btnBuy:this.buyTheGift();break;case this.sp1:this.curIndex=0,this.curItemVo=this.curVO.items[this.curIndex],this.updateBySelected();break;case this.sp2:this.curIndex=1,this.curItemVo=this.curVO.items[this.curIndex],this.updateBySelected();break;case this.sp3:this.curIndex=2,this.curItemVo=this.curVO.items[this.curIndex],this.updateBySelected();break;case this.sp4:this.curIndex=3,this.curItemVo=this.curVO.items[this.curIndex],this.updateBySelected();break;case this.redtip:ni.dispatch("ACT_RP_CONTROLLL_VIEW",1)}},e.buyTheGift=function(){if(this.curVO&&this.curVO.items&&this.curVO.items[this.curIndex])if(this.curItemVo=this.curVO.items[this.curIndex],ie.gold<this.curItemVo.realPrice)es.showAlert();else{var t=new U;t.goodsTypeID=this.selectGoodsVO.id,t.defaultCaller=this,t.defaultFun=this.showTheBuyTips,t.yesCaller=this,t.yesFun=this.showTheBuyTips,H.ins().checkRepeatAlert(t)}},e.showTheBuyTips=function(t,i){void 0===t&&(t=0),void 0===i&&(i="");var e="";e+="是否消耗"+pe.span(this.curItemVo.realPrice+"元宝","#fbd815")+"购买"+pe.span(this.selectGoodsVO.name,"#fbd815")+"？",es.showSecAlert(e,L.ins(),L.ins().toGain,[this.curItemVo.actID,this.curItemVo.conID],"ActDiscountsView.clickBuy")},e.onDisplay=function(){Ja.ins().toInfo()},e.update=function(){if(this.curVO=G.getActDetailByActID(this.actID[0]),this.curVO){if(this.curVO.items.sort(this.memSortFun),0<this.skinID)this.board.bgSkin="modules/act/discounts/skin"+this.skinID+"/discountsBg.png",this.imgIcon1.skin="modules/act/discounts/skin"+this.skinID+"/discountsIcon1.png",this.imgName1.skin="modules/act/discounts/skin"+this.skinID+"/discountsLiBao1.png",this.imgIcon2.skin="modules/act/discounts/skin"+this.skinID+"/discountsIcon2.png",this.imgName2.skin="modules/act/discounts/skin"+this.skinID+"/discountsLiBao2.png",this.imgIcon3.skin="modules/act/discounts/skin"+this.skinID+"/discountsIcon3.png",this.imgName3.skin="modules/act/discounts/skin"+this.skinID+"/discountsLiBao3.png",this.imgIcon4.skin="modules/act/discounts/skin"+this.skinID+"/discountsIcon4.png",this.imgName4.skin="modules/act/discounts/skin"+this.skinID+"/discountsLiBao4.png";else{this.board.bgSkin="modules/act/discounts/"+this.curVO.iconId+"/discountsBg.png";for(var t=0;t<4;t++)this.curItemVo=this.curVO.items[t],this.toGetItem(),this["imgIcon"+(t+1)].skin=this.selectGoodsVO.realMaxico,this["imgName"+(t+1)].skin=this.selectGoodsVO.type}this.imgKuang.skin="modules/act/awardBg.png",this.imgItemBg.skin="modules/act/itemBg.png",this.imgTipBg.skin="modules/act/subTitleBg.png",this.board.helpStr=this.curVO.help,this.board.desc=this.curVO.desc,this.board.endTime=this.curVO.endTime,this.curItemVo=this.curVO.items[this.curIndex],this.updateBySelected()}},e.toGetItem=function(){var t=this.curItemVo.rewardGoods[0];this.selectGoodsVO=ve.getItem(t.type_id)},e.updateBySelected=function(){if(this.toGetItem(),this.selectGoodsVO){this.txtTip.innerHTML=pe.span("花费","#fde69a")+pe.span(this.curItemVo.realPrice+"元宝","#fbd815")+pe.span("（原价"+this.curItemVo.origPrice+"）","#fde69a")+pe.span("即可获得","#fde69a")+pe.span(this.selectGoodsVO.name,"#fbd815"),this.specialTip.innerHTML=""!=this.selectGoodsVO.specialTip?pe.span(this.selectGoodsVO.specialTip,"#fde69a"):pe.span("","#fde69a"),this.spGoodsItem.removeChildren();var t,i,e,s=this.sliceProducts(this.selectGoodsVO.products);for(var n in this.bmClips=this.bmClips||[],this.bmClips)(t=this.bmClips[n]).removeSelf();for(var h,a=0,o=0;o<s.length;o++)(h=new ge).skin="com/ui/txtBg6.png",h.pos(18+129*o,104),this.spGoodsItem.addChild(h),(i=new oe(91,100,!1,!0,!0,!1)).pos(129*o-4,0),e=s[o],i.dataSource=[e.typeId,e.num],this.spGoodsItem.addChild(i),1==e.effect&&(this.bmClips[a]=this.bmClips[a]||ut.getOne(),(t=this.bmClips[a]).mouseEnabled=!1,t.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),t.pos(i.x+90,i.y+93),this.spGoodsItem.addChild(t),a++);if(this.imgSelectedEffect.x=this.selectedEffectPosX[this.curIndex],this.imgSelected.x=this.selectedEffectPosX[this.curIndex]-30,0<this.curItemVo.canBuyNum){this.btnBuy.disabled=!1,this.btnBuy.label="立即购买",this.imgRedPoint.visible=ie.gold>=this.curItemVo.realPrice,D.getIsMask(1,Ks.DISCOUNT_ALL[this.curItemVo.conID])&&(this.imgRedPoint.visible=!1);var r=M.getInstance().getHuanPiPanel();r&&r.updateRedPoint()}else this.btnBuy.disabled=!0,this.btnBuy.label="已购买",this.imgRedPoint.visible=!1}},e.memSortFun=function(t,i){return t.conID<i.conID?-1:t.conID>i.conID?1:0},e.callBackUpdate=function(){this.update()},e.createChildren=function(){t.prototype.createChildren.call(this)},e.sliceProducts=function(t){return 5<t.length?t.slice(0,5):t},o(0,e,"typeID",function(){return this._typeID},function(t){this._typeID=t}),o(0,e,"actID",function(){return this._actID},function(t){this._actID=t}),o(0,e,"skinID",function(){return this._skinID},function(t){this.imgTitle.skin="modules/act/discounts/skin"+t+"/discountsListTitle.png",this.imgBot.skin="modules/act/discounts/skin"+t+"/bottomd.png",this.imgSelected.skin="modules/act/discounts/skin"+t+"/discountsSelected.png",this._skinID=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(d),function(t){function i(){this._curSelItem=null,this.clipArr=null,this.itemArr=null,this.posArr=[[17,381],[187,381],[357,381],[527,381],[17,574],[187,574],[357,574],[527,574]],this.awardArr=null,this.curDate=null,this.vos=null,i.__super.call(this)}l(i,"modules.actLoginFun.ActLoginFunView",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.on("click",this,this.onClick)},e.resetSelItem=function(){if(this.itemArr&&0<this.itemArr.length){for(var t=0;t<this.itemArr.length;t++){var i=this.itemArr[t];if(22!=C.getLoginItemState(i.date))break}11==C.getLoginItemState(i.date)?this.curSelItem=i:this.curSelItem=0<t?this.itemArr[t-1]:i}},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.btnGet:A.ins().toLoginGiftGet(this._curSelItem.date.id);break;default:if(t.target instanceof modules.athletics.encounter.view.DropItem){var i=t.target;i.data.tempNum=i.num,to.show(i.data,"BASE_GOODS_TIP")}else t.target instanceof modules.actLoginFun.ActLoginFunItem&&(this.curSelItem=t.target,Ve.send(10025,2,"累计登录活动-第"+this._curSelItem.date.day+"天"))}},e.updateSel=function(){var t;for(var i in this.itemArr)(t=this.itemArr[i]).setSel(this._curSelItem==t)},e.updateReward=function(){this.awardArr=this.awardArr||[];for(var t=0;t<this.awardArr.length;t++)this.awardArr[t]&&this.awardArr[t].parent&&this.awardArr[t].removeSelf();this.curDate.awards.length;this.clipArr=this.clipArr||[];var i,e=0;for(var s in this.clipArr)(i=this.clipArr[s]).removeSelf();for(t=0;t<this.curDate.awards.length;t++){this.awardArr[t]=this.awardArr[t]||new hi;var n=this.awardArr[t];n.txtName.fontSize=24,n.mouseEnabled=!0;var h=new Object;h.className="p_tkv",h.type=5,h.id=this.curDate.awards[t].type_id,h.val=this.curDate.awards[t].num,n.setDrop(h),n.x=69+131*t,n.y=774,this.box.addChild(n),1==this.curDate.awards[t].reserve&&(this.clipArr[e]=this.clipArr[e]||ut.getOne(),(i=this.clipArr[e]).mouseEnabled=!1,i.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),i.pos(n.x+47,n.y+93),this.box.addChild(i),e++)}},e.updateButtonState=function(){switch(C.getLoginItemState(this.curDate)){case 11:this.btnGet.label="领取",this.btnGet.disabled=!1,this.imgRp.visible=!0;break;case 22:this.btnGet.label="已领取",this.btnGet.disabled=!0,this.imgRp.visible=!1;break;default:this.btnGet.label="不可领",this.btnGet.disabled=!0,this.imgRp.visible=!1}},e.update=function(){if(this.vos=C.getAllItem(),this.vos){this.itemArr=this.itemArr||[];for(var t=this.vos.length,i=0;i<t;i++)this.itemArr[i]=this.itemArr[i]||new T,this.posArr[i]&&(this.itemArr[i].x=this.posArr[i][0]+31,this.itemArr[i].y=this.posArr[i][1],this.itemArr[i].date=this.vos[i],this.itemArr[i].mouseEnabled=!0,this.box.addChild(this.itemArr[i]));this._curSelItem||this.resetSelItem(),this.curDate=this._curSelItem.date,this.updateReward(),this.updateButtonState(),this.txtNow.innerHTML=pe.font("已签","#c46444")+pe.font("  "+C.loginGiftToc.login_day+"  ","#96f254")+pe.font("天","#c46444")}},o(0,e,"curSelItem",null,function(t){this._curSelItem=t,this.curDate=t.date,this.updateSel(),this.updateReward(),this.updateButtonState()})}(O),function(t){function i(){this.curVO=null,this.items=null,this.clipArr=null,this.clipIndex=NaN,this._typeID=null,this._actID=null,this._iconID=NaN,this._skinID=NaN,i.__super.call(this),this.on("click",this,this.onClick)}l(i,"modules.activity.display.ActDisplayView",u);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onDisplay=function(){De.addToSecond(this,this.timeLoop),this.on("undisplay",this,this.onUNDisplay)},e.onClick=function(t){switch(t.target){case this.imgTip:$i.ins.showMessage(this.curVO.help);break;default:if(t.target instanceof modules.athletics.encounter.view.DropItem){var i=t.target;i.data.tempNum=i.num,to.show(i.data,"BASE_GOODS_TIP")}}},e.onUNDisplay=function(){De.removeFromSceond(this,this.timeLoop)},e.timeLoop=function(){this.curVO&&this.curVO.endTime>Ma.serverTime?this.txtLeftTime.text=Qt.formatDHMS(this.curVO.endTime-Ma.serverTime):(De.removeFromSceond(this,this.timeLoop),this.txtLeftTime.text="活动已结束")},e.update=function(){if(this.curVO=G.getActDetailByActID(this.actID[0]),this.curVO){this.txtDesc.innerHTML=this.curVO.desc,this.parent&&De.addToSecond(this,this.timeLoop),this.clipArr=this.clipArr||[];var t,i,e,s=0;for(var n in this.clipArr)(t=this.clipArr[n]).removeSelf();this.items=this.items||[];for(var h=(691-135*(this.curVO.items.length-1)-105)/2,a=Math.max(this.items.length,this.curVO.items.length),o=0;o<a;o++)o<this.curVO.items.length?(this.items[o]=this.items[o]||new oe(105,105,!0,!0,!0,!0,105),i=this.items[o],(e=new Object).className="p_kv",e.id=this.curVO.items[o].type_id,e.val=this.curVO.items[o].num,i.dataSource=e,i.pos(h+135*o,720),this.addChild(i),1==this.curVO.items[o].reserve&&(this.clipArr[s]=this.clipArr[s]||ut.getOne(),(t=this.clipArr[s]).mouseEnabled=!1,t.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),t.pos(i.x+52,i.y+109),t.scale(1.2,1.2),this.addChild(t),s++)):this.items[o]&&this.items[o].parent&&this.items[o].removeSelf()}},e.callBackUpdate=function(){this.update()},o(0,e,"typeID",function(){return this._typeID},function(t){this._typeID=t}),o(0,e,"actID",function(){return this._actID},function(t){this._actID=t}),o(0,e,"skinID",function(){return this.skinID},function(t){this._skinID=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(),function(t){function i(){this._data=null,this.dropArr=null,this.clipArr=null,i.__super.call(this),this.on("click",this,this.onClick),this.btnGet.visible=!1,this.imgRedPoint.visible=!1}l(i,"modules.activity.familyBattle.ActFamilyBattleItem",t);var e=i.prototype;e.onClick=function(t){if(t.target instanceof modules.athletics.encounter.view.DropItem){var i=t.target;i.data.tempNum=i.num,to.show(i.data,"BASE_GOODS_TIP")}},e.update=function(){if(this._data){var t=this._data.rewards,i=(this._data.state,this._data.rankIndex);this._data.actId,this._data.conId;for(var e in this.dropArr=this.dropArr||[],this.dropArr)this.dropArr[e].removeSelf();for(var s in this.clipArr=this.clipArr||[],this.clipArr)this.clipArr[s].removeSelf();this.dropArr=[],this.clipArr=[];for(var n=0,h=0,a=t.length;h<a;h++){var o=t[h],r=new hi("");r.txtName.fontSize=24,r.mouseEnabled=!0;var l=new Object;l.className="p_tkv",l.type=5,l.id=o.type_id,l.val=o.num,r.setDrop(l),r.x=this.spGoods.x+20+h*(r.width+50),r.y=this.spGoods.y,this.dropArr.push(r),this.addChild(r),1==o.reserve&&(this.clipArr[n]=this.clipArr[n]||ut.getOne(),this.clipArr[n].mouseEnabled=!1,this.clipArr[n].loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),this.clipArr[n].pos(r.x+47,r.y+93),this.addChild(this.clipArr[n]),n++)}this.imgTitle.skin=1==i?"modules/act/familyBattle/txt_1.png":2==i?"modules/act/familyBattle/txt_2.png":3==i?"modules/act/familyBattle/txt_3.png":"modules/act/familyBattle/txt_0.png"}},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._data=t,this._data&&this.update()})}(f),function(t){function i(){this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this._itemArr=[],this._actFamilyBattleVO=null,this.board=null,i.__super.call(this),this.pan.vScrollBarSkin="",this.on("display",this,this.onDisplay),this.on("click",this,this.onClick),this.board=new ct,this.board.pos(0,5),this.addChild(this.board)}l(i,"modules.activity.familyBattle.ActFamilyBattlePanel",g);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onDisplay=function(){this.on("undisplay",this,this.onUnDisplay)},e.onUnDisplay=function(){this.off("undisplay",this,this.onUnDisplay)},e.onClick=function(t){if(t.target instanceof modules.athletics.encounter.view.DropItem){var i=t.target;i.data.tempNum=i.num,to.show(i.data,"BASE_GOODS_TIP")}},e.update=function(){if(this._actFamilyBattleVO=G.getActDetailByActID(this.actID[0]),this._actFamilyBattleVO){0<this.skinID?this.board.bgSkin="modules/act/familyBattle/skin"+this.skinID+"/titleBg.png":this.board.bgSkin="modules/act/familyBattle/titleBg.png",this.board.desc=this._actFamilyBattleVO.desc,this.board.helpStr=this._actFamilyBattleVO.rule,this.board.endTime=this._actFamilyBattleVO.endTime,this._itemArr=this._itemArr||[];for(var t=0,i=0,e=this._actFamilyBattleVO.conditions.length;i<e;i++)3!=i&&(this._itemArr[i]=this._itemArr[i]||Na.getIns(1e3,"familyBattle.ActFamilyBattleItem"),this._itemArr[i].x=0,this._itemArr[i].y=195*t,this._itemArr[i].dataSource=this._actFamilyBattleVO.conditions[i],this.pan.addChild(this._itemArr[i]),t++)}},e.callBackUpdate=function(){this.update()},o(0,e,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,e,"actID",function(){return this._actIDs},function(t){this._actIDs=t}),o(0,e,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(),function(t){function i(){this.data=null,this.data1=null,this.vo1=null,this.vo2=null,this.curItem=2,this.tipType="",this.arr=[],this.type=0,this.canGet=!1,this.hasGet=!1,this.showItemID=NaN,this.showItemType=NaN,this.itemEff=null,this.effSuss=null,this.imgItem=null,this.creatRoleTime=NaN,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.changeBtn(this.curItem),this.redSp.visible=!1}l(i,"modules.activity.firstDayCharge.FirstDayChargeView",Oi);var e=i.prototype;e.onDisplay=function(){ni.register("ON_ACT_FDCHARGE_UPDATE",this,this.update),ni.register("ON_ACT_FDCHARGE_UPDATE",this,this.update),ni.register("m_role_time_limit_pay_fetch_gift_toc",this,this.onGetReward),De.addToSecond(this,this.updateTime),this.on("undisplay",this,this.onUNDisplay)},e.onUNDisplay=function(){De.removeFromSceond(this,this.updateTime)},e.onClick=function(t){switch(t.target){case this.getBtn:this.getReward();break;case this.closeBtn:this.closeWindow();break;case this.item1:case this.itemTxt1:this.curItem=1,this.changeBtn(this.curItem),this.changeChargeData();break;case this.item2:case this.itemTxt2:this.curItem=2,this.changeBtn(this.curItem),this.changeChargeData();break;case this.sp:this.showEffect()}},e.showEffect=function(){if(1==this.showItemType){var t=ve.getItem(this.showItemID);t&&(ve.isEquip(t.id)?this.tipType="BASE_EQUIP_TIP":this.tipType="BASE_GOODS_TIP",to.show(t,this.tipType))}},e.changeBtn=function(t){1==t?(this.itemTxt1.y=22,this.itemTxt2.y=10,this.item1.skin="modules/act/firstDayCharge/btn1.png",this.itemTxt1.skin="modules/act/firstDayCharge/txt2.png",this.item2.skin="modules/act/firstDayCharge/btn2.png",this.itemTxt2.skin="modules/act/firstDayCharge/txt3.png"):(this.itemTxt2.y=17,this.itemTxt1.y=15,this.item1.skin="modules/act/firstDayCharge/btn2.png",this.itemTxt1.skin="modules/act/firstDayCharge/txt4.png",this.item2.skin="modules/act/firstDayCharge/btn1.png",this.itemTxt2.skin="modules/act/firstDayCharge/txt1.png")},e.getReward=function(){if(this.canGet&&!this.getBtn.gray)this.toGetReward();else{var t="";t=1==this.curItem?Vh.isFanTi?pe.span("儲值1仙尊幣領取哦!","#5d3924"):pe.span("只要今日充值两次就可以领取哦!","#fbd815")+"是否进行充值？":Vh.isFanTi?pe.span("只要使用仙尊幣兌換壹次29980元寶就可以領取哦!","#5d3924"):pe.span("只要单笔充值2998元就可以领取哦!","#fbd815")+"是否进行充值？";var i=new q;i.msg=t,Vh.isFanTi?i.showClose=i.showRight=!1:(i.yesLabel="充值",i.yesCaller=this,i.yesFun=this.linkto,i.yesArgs=null),K.showVO(i)}},e.linkto=function(){ni.dispatch("OPEN_CHARGE")},e.toGetReward=function(){var t=new Object;t.className="m_role_time_limit_pay_fetch_gift_tos",t.reward_id=this.curItem,Nt.send(t)},e.onGetReward=function(t){0==t.err_code?ni.dispatch("ON_ACT_FDCHARGE_UPDATE"):Ii.addTip(t.err_code)},e.update=function(){this.setData(),this.changeChargeData(),this.updataView()},e.updataView=function(){for(;0<this.itemSp.numChildren;)this.itemSp.getChildAt(0).removeSelf();for(var t=0;t<this.arr.length;t++){var i=new oe(91,95,!1,!0,!0,!1),e=this.arr[t].split("|"),s=ve.getItem(e[0]);i.dataSource=s,i.num=e[1],i.hideGoodsName(),4==this.arr.length?i.pos(110*t-10,0):i.pos(110*t-70,0),this.itemSp.addChild(i),0==t&&(this.updataEffect(e[0],this.type),this.showItemID=e[0],this.showItemType=this.type,this.itemEff=ut.getOne(),this.itemEff.mouseEnabled=!1,this.itemEff.pos(i.x+90,i.y+93),this.itemEff.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),this.itemSp.addChild(this.itemEff))}this.getImg.skin=1==this.curItem?"modules/act/firstDayCharge/give.png":"modules/act/firstDayCharge/get.png",this.nameImg.skin=1==this.curItem?"modules/act/firstDayCharge/tip3.png":"modules/act/firstDayCharge/tip6.png",this.nameImg.x=1==this.curItem?291:254,this.nameImg2.skin=1==this.curItem?"modules/act/firstDayCharge/tip5.png":"modules/act/firstDayCharge/tip4.png",this.powerImg.skin=1==this.curItem?"modules/act/firstDayCharge/num3.png":"modules/act/firstDayCharge/num4.png",this.goidImg.skin=1==this.curItem?"modules/act/firstDayCharge/num1.png":"modules/act/firstDayCharge/num2.png",Vh.isXianLai?this.getDesc.text=1==this.curItem?"领取条件：今日累计充值2次":"领取条件：单笔充值29980钻石":Vh.isFanTi?this.getDesc.text=1==this.curItem?"領取條件：儲值1仙尊幣領取 ":"領取條件：單筆兌換29980元寶":this.getDesc.text=1==this.curItem?"领取条件：今日累计充值2次":"领取条件：单笔充值2998元",this.canGetImg.skin=this.canGet?"modules/act/firstDayCharge/has.png":"modules/act/firstDayCharge/no.png",this.getBtn.gray=!!this.hasGet,this.getBtn.mouseEnabled=!this.hasGet,this.canGet&&!this.hasGet?this.redSp.visible=!0:this.redSp.visible=!1},e.updataEffect=function(t,i){if(1==i){this.effSuss=this.effSuss||ut.getOne(),this.sp.addChild(this.effSuss);var e=ve.getGoodsPathByGoodsId(t);1==this.curItem?(this.effSuss.pos(240,210),this.effSuss.loadAndPlay(z.getWeaponUnitSubFile(e,"unit2")+e+"_4","stand",4,!0)):(this.effSuss.pos(130,260),this.effSuss.loadAndPlay("moduleEffect/defult","default",0,!0)),this.sp.removeChild(this.imgItem)}else{this.imgItem=this.imgItem||new oe(91,95,!1,!0,!1,!1);var s=ve.getItem(t);this.imgItem.dataSource=s,this.imgItem.pos(20,100),this.imgItem.hideGoodsName(),this.sp.addChild(this.imgItem),this.sp.removeChild(this.effSuss)}},e.changeChargeData=function(){1==this.curItem?(this.arr=this.vo1.rewrads.split(","),this.type=parseInt(this.vo1.type),this.data1&&(this.canGet=2==this.data1.reward1,this.hasGet="true"==this.data1.get1)):(this.arr=this.vo2.rewrads.split(","),this.type=parseInt(this.vo2.type),this.data1&&(this.canGet=1==this.data1.reward2,this.hasGet="true"==this.data1.get2)),this.updataView()},e.setData=function(){var t;if(this.data=G.getFdChargeVO(),this.data1=G.getFdChargeInfo(),this.data)for(var i in this.data)"1"==(t=this.data[i]).id?this.vo1=t:this.vo2=t},e.updateTime=function(){this.creatRoleTime=ie.user.attr.create_time;var t=this.creatRoleTime+86400-Ma.serverTime;0<t?this.timeTxt.text=Qt.formatDHMS(t,!1,!0):t<0&&io.addTip("活动未开启"),0==t&&(ni.dispatch("ON_ACT_FDCHARGE_CLOSE"),this.closeWindow())}}(),function(t){function i(){this.goods=null,this.goodsVO=null,this.p=null,this.sp=null,this.huxianChargeView=null,this._data=null,this._price=0,i.__super.call(this),this.createLine(),this.on("click",this,this.onClick)}l(i,"modules.activity.freeMall.FreeMallItem",Ui);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.toBuy:this.toGainBuy()}},e.toGainBuy=function(){0==this._data.boxConsumeType?ie.user.attr.gold>=this._price?(Ve.send(10123,2,0<"狐仙免单商店-"+this._data.discount?this._data.discount+"":"超福利专区-购买",{item_id:this._data.typeID,num:this._data.num,price:this._price}),L.ins().toGain(this._data.actID,this._data.conditionID)):es.showAlert():1==this._data.boxConsumeType&&(Ze.getGoodsNumByTypeID(i.huxianItem)>=this._price?(Ve.send(10123,2,0<"狐仙免单商店-"+this._data.discount?this._data.discount+"":"超福利专区-购买",{item_id:this._data.typeID,num:this._data.num,price:this._price}),L.ins().toGain(this._data.actID,this._data.conditionID)):(this.huxianChargeView=this.huxianChargeView||new me,this.huxianChargeView.openWindow()))},e.update=function(){this.goodsVO=ve.getItem(this._data.typeID),this.goods=this.goods||new oe(91,100,!1,!0,!0,!0,100),this.goods.dataSource=[this._data.typeID,this._data.num],this.goods.centerX=0,this.goods.y=85,this.goods.setGoodsName(""),this.addChild(this.goods),this.txtName.text=this.goodsVO.name,this.txtName.color=Qi.COLORS_DARK[this.goodsVO.color],this.txtOldPrice.text=this._data.oldPrice+"",10<oo.curLv?(this._price=this._data.sVipPrice,this.labelNew.text="svip价：",this.txtNewPrice.text=this._data.sVipPrice+""):0<oo.curLv?(this._price=this._data.vipPrice,this.labelNew.text="vip价：",this.txtNewPrice.text=this._data.vipPrice+""):(this._price=this._data.commonPrice,this.labelNew.text="现价：",this.txtNewPrice.text=this._data.commonPrice+""),1==this._data.discount||2==this._data.discount?this.tipBg.visible=!1:(this.tipBg.visible=!0,this.imgDiscount.skin="modules/act/freeMall/num_0"+this._data.discount+".png"),this.imgOld.skin=this.imgNew.skin=ve.getItem(0==this._data.boxConsumeType?i.yuanbao:i.huxianItem).realMaxico},e.createLine=function(){this.sp=this.sp||new Ta,this.sp.graphics.drawLine(0,33,70,33,"#ff0000",2),this.sp.pos(25,-22),this.txtOldPrice.addChild(this.sp)},o(0,e,"data",null,function(t){t&&(this._data=t)}),i.huxianItem=10201590,i.yuanbao=10201147}(),function(t){function i(){this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this.iconId=0,this._data=null,this._selectIndex=1,this.ITEM_NUM=3,this.huxianChargeView=null,this.curVO=null,this.logArr=null,this.dialog=null,this.huxianItem=10201590,this.goodsArr=null,this.voArr=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.goodList.hScrollBarSkin="",this.txtOrderDes2.style.fontSize=24,this.txtOrderDes2.style.align="left",this.on("display",this,this.onDisplay),this.on("click",this,this.onClick)}l(i,"modules.activity.freeMall.FreeMallView",Wi);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onClick=function(t){switch(t.target){case this.toClose:case this.toClose2:this.closeWindow();break;case this.tohelp:var i="";i=this.curVO.help?this.curVO.help:'<p style="font-size: 24px;"><span>1、每天玩家可抽取3个道具进行兑换，</span><span style="color:rgb(255, 0, 0);">月卡用户可以多抽取1个商品；</span><br/><span>2、通过消耗狐仙馈赠可以兑换指定商品；</span><br/><span>3、每个商品仅能兑换一次，狐仙馈赠道具不会过期不可销毁；</span><br/><br/></p>',$i.ins.showMessage(i);break;case this.tap1:Ve.send(10123,1,"狐仙免单商店-tap页切换-一折专区"),this._selectIndex=1,this.slideGuide(),this.update();break;case this.tap2:Ve.send(10123,1,"狐仙免单商店-tap页切换-二折专区"),this._selectIndex=2,this.slideGuide(),this.update();break;case this.tap3:Ve.send(10123,1,"狐仙免单商店-tap页切换-超福利专区"),this._selectIndex=3,this.slideGuide(),this.update();break;case this.toOrder:L.ins().toGetLuckyShopOrder(this.actID[0]),M.getInstance().openFreeMallMyOrderPanel();break;case this.btnGet:this.huxianChargeView=this.huxianChargeView||new me,this.huxianChargeView.openWindow()}},e.onDisplay=function(){i.time=0,this._selectIndex=1,this.update(),this.slideGuide(),this.getOrder(),De.addToSecond(this,this.loop),ni.register("UPDATE_FREE_MALL_ORDER",this,this.updateOrder),ni.register("OPEN_LUCKY_SHOP_BUY_BACK_DIALOG",this,this.openBuyBackDialog),this.on("undisplay",this,this.onUnDisplay)},e.onUnDisplay=function(){De.removeFromSceond(this,this.loop),ni.remove("UPDATE_FREE_MALL_ORDER",this,this.updateOrder),ni.remove("OPEN_LUCKY_SHOP_BUY_BACK_DIALOG",this,this.openBuyBackDialog)},e.loop=function(){3<=i.time&&(this.getOrder(),i.time=0),i.time++},e.getOrder=function(){L.ins().toGetLuckyShopOrder(this.actID[0])},e.updateOrder=function(t){var i,e;if(t[0]==this.actID[0]){Hi._logArr=this.logArr=t[1],M.getInstance().updateFreeMallMyOrderPanel();var s,n,h=[];for(var a in e=this.logArr[0],this.logArr)1==(s=this.logArr[a]).is_free&&h.push(s),s.buy_ts>e.buy_ts&&(e=s);for(var o in h)n=h[o],(!i||n.buy_ts>i.buy_ts)&&(i=n);if(i){this.txtOrderDes1.text=i.name+"欧气爆发!";var r=ve.getItem(i.type_id);this.txtOrderDes2.innerHTML=pe.span("购买","#f4f1b2")+pe.span(r.name,Qi.COLORS_DARK[r.color])+pe.span("时成功免单","#f4f1b2")}e&&(this.txtOrderID.text=e.buy_order+"")}},e.openBuyBackDialog=function(t){t.actID==M.getInstance().freeMallActId&&(this.dialog=this.dialog||Na.getIns(1e3,"freeMall.BuyBackDialog"),this.dialog.openWindow(),this.dialog.data=t)},e.timeLoop=function(){if(this.curVO){var t=this.curVO.startTime,i=this.curVO.endTime,e=Ma.serverTime;if(t<=e&&e<=i){var s=i-e;this.txtTime.text=Qt.formatDHMS(s)}else{var n=Qt.getTotalTime(t);this.txtTime.text="活动未开启，下一波活动开启时间："+n[1]+"月"+n[2]+"日"+n[3]+"分",De.removeFromSceond(this,this.timeLoop)}}},e.update=function(){this.curVO=G.getActDetailByActID(this.actID[0]),De.addToSecond(this,this.timeLoop),this.updateDes(),this.updateHuXianItem(),this.updateMainGoods()},e.updateDes=function(){this.curVO&&(this.txtTitle.innerHTML=this.curVO.desc)},e.updateHuXianItem=function(){this.txtNum.text=Ze.getGoodsNumByType(Ze.GOODS_ID,this.huxianItem)+""},e.updateMainGoods=function(){if(this.curVO){var t;this.devideGoods(),this.resetItem();for(var i=0,e=0;e<this.voArr[this._selectIndex].length;e++)(t=this.voArr[this._selectIndex][e])&&!this.getIsFull(t.typeID)&&(this.goodsArr[i]=Na.getIns(1e3,"freeMall.FreeMallItem"),this.goodsArr[i].data=this.voArr[this._selectIndex][e],this.goodsArr[i].update(),this.goodsArr[i].pos(220*i,0),this.goodList.addChild(this.goodsArr[i]),i++)}},e.getIsFull=function(t){var i=ve.getItem(t),e=i.useType%1e3,s=Ze.getGoodsNumByTypeID(t),n=0;switch(e){case 19:var h,a,o,r=ie.pals,l=parseInt(i.img),c=0;for(var d in r)(o=r[d])&&(h=oh.getFashionListDicByActID(o.pal_id))&&h.hasOwnProperty(l+"")&&c++;if(a=oh.getFashionTimesByTypeID(i.id),4<=c&&a<0&&(n=1),4<=s+n)return!0;break;case 8:var u=parseInt(i.img);if(ja.isHas(u)&&0==ja.getTitleLimit(u)&&(n=1),1<=s+n)return!0;break;case 32:var p=parseInt(i.img);if(vi.getAnimalVO(p).isLoaded&&(n=1),1<=s+n)return!0;break;case 9:if(5<=s+(n=rs.getSamePetNum(t)))return!0;break;case 31:if(Fa.getTalimanIsActiveByID(i.id)&&(n=1),1<=s+n)return!0;break;case 33:if(0!=yi.getStep(i.id)&&(n=1),1<=s+n)return!0}return!1},e.resetItem=function(){if(this.goodsArr&&0<this.goodsArr.length)for(var t=0;t<this.goodsArr.length;t++)this.goodList.removeChild(this.goodsArr[t]),this.goodsArr[t]=null;this.goodsArr=[]},e.devideGoods=function(){this.voArr=this.voArr||[];for(var t=[],i=[],e=[],s=0;s<this.curVO.items.length;s++)1==this.curVO.items[s].discount?t.push(this.curVO.items[s]):2==this.curVO.items[s].discount?i.push(this.curVO.items[s]):e.push(this.curVO.items[s]);this.voArr[1]=t,this.voArr[2]=i,this.voArr[3]=e},e.slideGuide=function(){for(var t=this.guideImg.x,i=1;i<=this.ITEM_NUM;i++)this["tap"+i].skin="modules/act/freeMall/btnSkin.png";switch(this["tap"+this._selectIndex].skin="modules/act/freeMall/02.png",this._selectIndex){case 1:t=this.tap1.x+(this.tap1.width-this.guideImg.width)/2;break;case 2:t=this.tap2.x+(this.tap2.width-this.guideImg.width)/2;break;case 3:t=this.tap3.x+(this.tap3.width-this.guideImg.width)/2}eo.to(this.guideImg,{x:t},500)},e.callBackUpdate=function(){this.update()},o(0,e,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t}),o(0,e,"uiClass",function(){return"FreeMallPanel"}),o(0,e,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,e,"actID",function(){return this._actIDs},function(t){this._actIDs=t,G.registerActCBFunc(t[0],this,this.callBackUpdate)}),i.time=0}(),function(t){function i(){this._p=null,i.__super.call(this),this.orderInfo2.style.fontSize=22,this.orderInfo2.style.valign="middle"}l(i,"modules.activity.freeMall.PlayerOrderItem",Ts),o(0,i.prototype,"data",null,function(t){this._p=t,this.tipFree.visible=1==t.is_free,this.orderCode.text="订单号："+t.buy_order;var i=Qt.getTotalTime(t.buy_ts),e=ve.getItem(t.type_id);this.orderInfo1.text=i[1]+"月"+i[2]+"日      "+i[3]+"时"+i[4]+"分购买了      ",this.orderInfo2.innerHTML=pe.span(e.name,Qi.COLORS_DARK[e.color])})}(),function(t){function i(){this._myLog=null,this.orderArr=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick),this.list.vScrollBarSkin=""}l(i,"modules.activity.freeMall.PlayerOrderView",Cs);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.toClose2:case this.toClose:this.closeWindow()}},e.update=function(){this._myLog=Hi.myOrderLog;var t=this._myLog.length;this.resetItem();for(var i=0;i<t;i++)this.orderArr[i]=Na.getIns(1e3,"freeMall.PlayerOrderItem"),this.orderArr[i].data=this._myLog[i],this.orderArr[i].pos(0,132*i),this.list.addChild(this.orderArr[i])},e.resetItem=function(){if(this.orderArr&&0<this.orderArr.length)for(var t=0;t<this.orderArr.length;t++)this.list.removeChild(this.orderArr[t]),this.orderArr[t]=null;this.orderArr=[]}}(),function(t){function i(){this._typeId=null,this._actID=null,this._iconID=NaN,this._skinID=NaN,this._actGroupPkVo=null,this.goodsNameArr=["甜粽子","咸粽子"],this.confirmArr=["甜粽","咸粽"],this.selfCampId=0,this.midBgImgArr=["modules/act/gruopPK/bgImgAir.png","modules/act/gruopPK/bgImg.png"],this.choiceDescArr=["粽子有甜有咸,今年甜党和咸党终有一战,而谁将最终胜出？","被选中的仙友，你是吃甜粽还是咸粽？"],this.goodsItemArr=null,this.fansImgArr=["modules/act/gruopPK/sweetFans.png","modules/act/gruopPK/saltyFans.png"],this.zongziImgArr=["modules/act/gruopPK/sweet.png","modules/act/gruopPK/salty.png"],this.sweetWinSkin="modules/act/gruopPK/sweetWin.png",this.sweetLoseSkin="modules/act/gruopPK/sweetLose.png",this.saltyWinSkin="modules/act/gruopPK/saltyWin.png",this.saltyLoseSkin="modules/act/gruopPK/saltyLost.png",this.sweetSayArr=["甜粽已上天","甜粽仍需努力"],this.saltySayArr=["咸粽已上天","咸粽仍需努力"],i.__super.call(this),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.on("click",this,this.onClick),this.skinID=1}l(i,"modules.activity.groupPK.ActGroupPkView",_);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onDisplay=function(){ni.register("ACT_CHOOSE_CAMP_UPDATE",this,this.updateChoose),De.addToSecond(this,this.timeLoop)},e.onUnDisplay=function(){ni.remove("ACT_CHOOSE_CAMP_UPDATE",this,this.updateChoose),De.removeFromSceond(this,this.timeLoop)},e.onClick=function(t){switch(t.target){case this.btnSweet:this.confirmChoose(1);break;case this.btnsalty:this.confirmChoose(2);break;case this.zongziImg:if(1==this.skinID||2==this.skinID){var i,e=0;e=1==this.skinID?1==this.selfCampId?10405012:10405013:2==this.skinID?1==this.selfCampId?10405014:10405015:1==this.selfCampId?10405010:10405011,i=ve.getItem(e),to.show(i,"BASE_GOODS_TIP")}break;case this.imgTip:$i.ins.showMessage(this._actGroupPkVo.rule);break;case this.getZhongzi:if(this._actGroupPkVo&&0<this.selfCampId){var s=this._actGroupPkVo.conditions[this.selfCampId-1];if(s.freCnt<s.maxFreeCnt)this.toGain(this._actGroupPkVo.actID,s.conditionId);else if(ie.gold>=s.needGoldNum){var n=new h;n.price=10,n.goodsName=1==this.selfCampId?this.goodsNameArr[0]:this.goodsNameArr[1],n.yesFunc=this.toGain,n.yesFuncCaller=this,n.yesArgs=[this._actGroupPkVo.actID,s.conditionId],n.timeForArgsIndex=2,M.getInstance().showActBuyGoodsAlert(n)}else es.showAlert()}}},e.confirmChoose=function(t){var i=new q;i.msg=pe.font("请问您是否选择"+(1==t?this.confirmArr[0]:this.confirmArr[1])+"支持者？","#5d3924",26)+"<br>"+pe.font("注：选择支持阵营后无法再进行修改","#5d3924",22),i.yesArgs=[this.actID[0],t],i.yesCaller=L.ins(),i.yesFun=L.ins().toActChooseCamp,K.showVO(i)},e.toGain=function(t,i,e){void 0===e&&(e=1),L.ins().toGain(t,i,e)},e.updateChoose=function(t,i){this._actID.indexOf(i)<=-1||t<=0||(this.selfCampId=t,L.ins().toActDetail(this.actID[0]))},e.update=function(){this.initData(),this.updateShow()},e.callBackUpdate=function(){this.update()},e.initData=function(){if(null!=this.typeID)for(var t=0;t<this.typeID.length;t++)switch(this.typeID[t]){case 2602:this._actGroupPkVo=G.getActDetailByActID(this.actID[t])}},e.updateShow=function(){if(this.midBgImg.skin=0<this.selfCampId?this.midBgImgArr[0]:this.midBgImgArr[1],null!=this._actGroupPkVo){var t=this._actGroupPkVo.conditions;this.selfCampId=parseInt(t[0].selfCampId),0<this.selfCampId?(this.chioceSp.visible=!1,this.rewardShowSp.visible=!0,this.rewardShowViewUpdate()):(this.chioceSp.visible=!0,this.rewardShowSp.visible=!1,this.winOrLoseSp.visible=!1,this.chioceDescTxt.style.valign="top",this.chioceDescTxt.style.leading=10,this.chioceDescTxt.innerHTML=pe.font(this.choiceDescArr[0],"#fcf476",26)+"<br>"+pe.font(this.choiceDescArr[1],"#fcf476",26)),this.parent&&De.addToSecond(this,this.timeLoop),this.actDesc.style.fontSize=24,this.actDesc.style.color="#621e09",this._actGroupPkVo&&(this.actDesc.innerHTML=this._actGroupPkVo.desc)}},e.rewardShowViewUpdate=function(){if(this.winOrLoseSp.visible=!0,this.fansImg.skin=1==this.selfCampId?this.fansImgArr[0]:this.fansImgArr[1],null!=this._actGroupPkVo){var t=this._actGroupPkVo.conditions[this.selfCampId-1];t.freCnt<t.maxFreeCnt?(this.getZongziTxt.visible=!0,this.buyZongziTxt.visible=!1,this.redPoint.visible=!0):(this.getZongziTxt.visible=!1,this.buyZongziTxt.visible=!0,this.goldTxt.text=t.needGoldNum,this.redPoint.visible=!1);var i=this.parse(t.CampIdAndNumOne);this.sweetHotTxt.text="热度:"+i[1];var e=this.parse(t.CampIdAndNumTwo);this.saltytHotTxt.text="热度:"+e[1];var s=Number(i[1])+Number(e[1]);if(this.sweetBar.height=Number(i[1])/s*213<=0?10:Number(i[1])/s*213,this.saltyBar.height=Number(e[1])/s*213<=0?10:Number(e[1])/s*213,Number(i[1])>Number(e[1])?(this.sweetWinImg.visible=!0,this.saltyWinImg.visible=!1,this.sweetSayTxt.text=this.sweetSayArr[0],this.saltySayTxt.text=this.saltySayArr[1],this.sweetImg.skin=this.sweetWinSkin,this.saltyImg.skin=this.saltyLoseSkin):(Number(i[1])<Number(e[1])?(this.sweetWinImg.visible=!1,this.saltyWinImg.visible=!0,this.sweetSayTxt.text=this.sweetSayArr[1],this.saltySayTxt.text=this.saltySayArr[0],this.sweetImg.skin=this.sweetLoseSkin):(this.sweetWinImg.visible=!0,this.saltyWinImg.visible=!0,this.sweetSayTxt.text="你我五五开",this.saltySayTxt.text="我们半斤八两",this.sweetImg.skin=this.sweetWinSkin),this.saltyImg.skin=this.saltyWinSkin),this.goodsItemArr=this.goodsItemArr||[],0<t.succItemId)this.goodsItemArr[0]=this.goodsItemArr[0]||new oe(91,100,!1,!0,!0,!1),this.goodsItemArr[0].dataSource=[t.succItemId,1],this.goodsItemArr[0].pos(353,583),this.goodsItemArr[0].text.color="#fcf476",this.goodsItemArr[0].text.text="获胜奖",this.addChild(this.goodsItemArr[0]);else{var n=this.goodsItemArr[0];n&&n.removeSelf()}if(t.failItemId)this.goodsItemArr[1]=this.goodsItemArr[1]||new oe(91,100,!1,!0,!0,!1),this.goodsItemArr[1].dataSource=[t.failItemId,1],this.goodsItemArr[1].pos(505,583),this.goodsItemArr[1].text.color="#fcf476",this.goodsItemArr[1].text.text="安慰奖",this.addChild(this.goodsItemArr[1]);else{var h=this.goodsItemArr[1];h&&h.removeSelf()}this.zongziImg.skin=1==this.selfCampId?this.zongziImgArr[0]:this.zongziImgArr[2]}},e.parse=function(t){var i={};if(t&&"{"==t[0]&&"}"==t[t.length-1])for(var e=t.substr(1,t.length-2).split(","),s=0,n=e.length;s<n;s++)i[s]=e[s];return i},e.timeLoop=function(){this._actGroupPkVo&&this._actGroupPkVo.endTime>Ma.serverTime?this.timeTxt.text=Qt.formatDHMS(this._actGroupPkVo.endTime-Ma.serverTime):(De.removeFromSceond(this,this.timeLoop),this.timeTxt.text="活动已结束")},o(0,e,"typeID",function(){return this._typeId},function(t){this._typeId=t}),o(0,e,"actID",function(){return this._actID},function(t){this._actID=t}),o(0,e,"skinID",function(){return this._skinID},function(t){if(t!=this._skinID&&(0!=t||0==this._skinID)){if(0!=t){this.fansImgArr=["modules/act/gruopPK/"+t+"/sweetFans.png","modules/act/gruopPK/"+t+"/saltyFans.png"];var i="modules/act/gruopPK/"+t+"/curWinImg.png";this.sweetWinImg.skin=i,this.saltyWinImg.skin=i,this.zongziImgArr=["modules/act/gruopPK/"+t+"/sweet.png","modules/act/gruopPK/"+t+"/salty.png","modules/act/gruopPK/"+t+"/salty.png"],this.zongziImg.skin="",this.midBgImgArr=["modules/act/gruopPK/"+t+"/bgImgAir.png","modules/act/gruopPK/"+t+"/bgImg.png"],this.sweetWinSkin="modules/act/gruopPK/"+t+"/sweetWin.png",this.sweetLoseSkin="modules/act/gruopPK/"+t+"/sweetLose.png",this.saltyWinSkin="modules/act/gruopPK/"+t+"/saltyWin.png",this.saltyLoseSkin="modules/act/gruopPK/"+t+"/saltyLost.png",this.vsImg.skin="modules/act/gruopPK/"+t+"/VS.png",this.titleBg.skin="modules/act/gruopPK/"+t+"/bg.png",this.titleImg.skin="modules/act/gruopPK/"+t+"/title.png",1!=t&&2!=t||(this.sweetImg.pos(40,73),this.sweetImg.scale(.8,.8),this.saltyImg.pos(475,75),this.saltyImg.scale(.7,.7),this.sweetWinImg.pos(50,185),this.saltyWinImg.pos(500,185),this.vsImg.pos(284,310),1==t?(this.choiceDescArr=["年年七夕秀恩爱，单身贵族看着心累！","今年七夕，是情侣的狂欢，还是单身贵族的逆袭？"],this.getZongziTxt.changeText("领取华灯"),this.goodsNameArr=["华灯","华灯"],this.buyZongziTxt.changeText("购买华灯")):(this.choiceDescArr=["年年520秀恩爱，单身贵族看着心累！","今年520，是情侣的狂欢，还是单身贵族的逆袭？"],this.getZongziTxt.changeText("购买礼盒"),this.goodsNameArr=["礼盒","礼盒"],this.buyZongziTxt.changeText("购买礼盒")),this.btnSweet.label="当然贵族",this.btnsalty.label="当然情侣",this.sweetSayArr=["贵族已上天","贵族仍需努力"],this.saltySayArr=["情侣已上天","情侣仍需努力"],this.confirmArr=["贵族","情侣"],this.sweetHotTxt.color="#ff3333",this.saltytHotTxt.color="#ff3333",this.buyZongziTxt.x+=10)}this.update(),this._skinID=t}}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(),function(t){function i(){this.vo=null,i.__super.call(this)}l(i,"modules.activity.jinliDFS.JinLiDFSItem",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.desc.style.fontSize=this.desc2.style.fontSize=26,this.desc.style.valign=this.desc2.style.valign="middle",this.btnGo.on("click",this,this.onClick)},e.update=function(){this.title.skin="modules/act/jinliDFS/"+this.vo.id+".png",this.desc.innerHTML=pe.span(this.vo.desc,"#fde69a");var t=xe.getTaskInfo(this.vo.id),i=null!=t?t.val:0;this.desc2.innerHTML=pe.span("可完成次数："+i+"/"+this.vo.totalTime,"#e1c6bc"),i>=this.vo.totalTime?(this.btnGo.label="已完成",this.btnGo.gray=!0,this.btnGo.mouseEnabled=!1):(this.btnGo.label="立即前往",this.btnGo.gray=!1,this.btnGo.mouseEnabled=!0),this.txt.text="+"+this.vo.point+"进度"},e.onClick=function(t){if(this.vo){var i=parseInt(this.vo.openLv.split(",")[0]),e=parseInt(this.vo.openLv.split(",")[1]);ie.myRegrow>i||ie.myRegrow==i&&ie.myLevel>=e?(ni.dispatch("JINLIDFS_CLOSE"),Ae.linkTo(this.vo.linkId)):io.addTip("未达到开启等级")}},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this.vo=t,this.vo&&this.update()})}(ye),function(s){function t(){this.rewardItems=null,this.flashArr=null,this.iconVo=null,t.__super.call(this)}l(t,"modules.activity.jinliDFS.JinLiDFSView",s);var i=t.prototype;i.createChildren=function(){for(var t in s.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(1e3,"jinliDFS.JinLiDFSItem"),this.tab.selectedIndex=0,this.tab.on("change",this,this.onTabChange),this.btnClose.on("click",this,this.onClick),this.btnClose2.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.rewardItems=[this.img_20,this.img_40,this.img_60,this.img_80,this.img_100],this.rewardItems)this.rewardItems[t].on("click",this,this.onClick);this.flashArr=[];for(var i=0;i<5;i++){var e=new ut;e.x=e.y=35,this.rewardItems[i].addChild(e),this.flashArr.push(e)}an.register("RP_JINLIDFS_COPY",this.tab.items[0],new Hs(25,-10)),an.register("RP_JINLIDFS_COST",this.tab.items[1],new Hs(25,-10)),an.register("RP_JINLIDFS_ACTIVE",this.tab.items[2],new Hs(25,-10))},i.onDisplay=function(){be.getInstance().toTaskInfo()},i.update=function(){this.iconVo=fe.getIconStateDicValus(4030),xe.showRedPoint();var t=xe.getTask(this.tab.selectedIndex+1);this.list.dataSource=t;var i=xe.getTotalProcess(this.tab.selectedIndex+1),e=xe.getTotalProcess(this.tab.selectedIndex+1);this.bar.width=e/100*580;for(var s,n=xe.getRewardInterval(this.tab.selectedIndex+1),h=xe.getRewardProcess(this.tab.selectedIndex+1),a=n.indexOf(h+""),o=0;o<this.rewardItems.length;o++)o<=a?(s="got",this.flashArr[o].visible=!1,this.flashArr[o].stop()):i>=parseInt(n[o])?(s="get",this.flashArr[o].visible=!0,this.flashArr[o].loadAndPlay("ICON_FLASH_EFF_URL","default",0,!0)):(s="no",this.flashArr[o].visible=!1,this.flashArr[o].stop()),this.rewardItems[o].skin="modules/act/jinliDFS/"+n[o]+"_"+s+".png"},i.onTabChange=function(){this.update()},i.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.img_20:case this.img_40:case this.img_60:case this.img_80:case this.img_100:be.getInstance().toGetReward(this.tab.selectedIndex+1)}}}(Se),function(t){function i(){this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this.helpStr=null,this.descStr=null,this.endTime=0,this.max=!1,this.curVO=null,this.curVOArr=[],this.nowKillNum=0,this.needKillNums=[],this.hasGet=!1,this.barLenArr=[150,350,560],this.goldNums=[0,28,58,108],this.rewards=[],this.actId=0,this.conIds=[],this.actIDS=null,this.showIndex=-1,this.prekillNum=0,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.nowKillNum=0,this.actIDS=G.getActIDByKey("3101106")}l(i,"modules.activity.jubao.JuBaoView",ke);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onDisplay=function(){L.ins().toActDetail(this.actIDS[0]),this.update(),De.addToSecond(this,this.updateTime),ni.register("ACT_JUBAO_UPDATE",this,this.update),ni.register("CROSS_DAY",this,this.corssDayupdate),ni.register("ON_ACT_JUBAOVO_UPDATE",this,this.update),ni.register("CHARGE_PAY_BACK",this,this.update),this.on("undisplay",this,this.onUNDisplay)},e.onUNDisplay=function(){De.removeFromSceond(this,this.updateTime),ni.remove("ACT_JUBAO_UPDATE",this,this.update),ni.remove("CROSS_DAY",this,this.corssDayupdate),ni.remove("ON_ACT_JUBAOVO_UPDATE",this,this.update)},e.onClick=function(t){switch(t.target){case this.help:$i.ins.showMessage(this.helpStr);break;case this.closeBtn:case this.closeBtn1:this.closeWindow();break;case this.buyBtn:this.creatAlert(0);break;case this.buyBtn1:this.creatAlert(1)}},e.creatAlert=function(t){var i=new q,e="";switch(t){case 0:e=this.max?"您将领取本日聚宝盆奖励108元宝，使用六倍领取可以直接领取六倍元宝哦!":"您将领取"+this.goldNums[this.showIndex]+"元宝，当前的进度还"+pe.span("未达到最高收益","#ff0000")+"，建议继续打怪提升哦！",i.yesCaller=this,i.yesFun=this.getReward,i.yesArgs=null,this.max&&(i.noCaller=this,i.noCaller=this.getSixReward,i.noCaller=null);break;case 1:e=this.max?"您将领取本日聚宝盆奖励648元宝（6倍加成），财源滚滚来！":"您将领取"+6*this.goldNums[this.showIndex]+"元宝（6倍加成)，当前的进度还"+pe.span("未达到最高收益","#ff0000")+"，建议继续打怪提升哦！",i.yesCaller=this,i.yesFun=this.getSixReward,i.yesArgs=null}i.msg=e,K.showVO(i)},e.getReward=function(){this.hasGet?io.addTip("奖励已领取"):ve.getItem(this.rewards[this.showIndex-1].type_id)&&L.ins().toGain(this.actId,this.conIds[this.showIndex-1],1)},e.getSixReward=function(){Ai.ins().toPay(1086+this.showIndex-1)},e.setData=function(){if(this.curVO=G.getActDetailByActID(this.actIDS[0]),ni.dispatch("ACT_ACTIVITY_ACTID",3,this.actIDS[0]),this.curVO&&this.curVO.items){for(var t=this.curVO.items.length,i=0;i<t;i++)this.curVOArr[i]=new we,this.curVOArr[i].actID=this.curVO.items[i].actID,this.curVOArr[i].conID=this.curVO.items[i].conID,this.curVOArr[i].canBuyNum=this.curVO.items[i].canBuyNum,this.curVOArr[i].needKillNum=this.curVO.items[i].needKillNum,this.needKillNums[i]=this.curVOArr[i].needKillNum,this.curVOArr[i].nowKillNum=this.curVO.items[i].nowKillNum,this.curVOArr[i].goods=this.curVO.items[i].goods,this.rewards[i]=new Object,this.rewards[i].className="p_act_goods",this.rewards[i]=this.curVOArr[i].goods[0],this.actId=this.curVOArr[i].actID,this.conIds[i]=this.curVOArr[i].conID;this.endTime=this.curVO.endTime,this.helpStr=this.curVO.rule,this.descStr=this.curVO.desc,this.descTxt.innerHTML=this.descStr,this.nowKillNum=this.curVOArr[0].nowKillNum,0<this.curVOArr[0].canBuyNum?this.hasGet=!1:this.hasGet=!0}},e.corssDayupdate=function(){L.ins().toActDetail(this.actIDS[0])},e.update=function(){this.setData(),this.updateView(),this.updateRp()},e.updateRp=function(){!this.hasGet&&1<=this.showIndex?this.rpImg.visible=this.rpImg1.visible=!0:this.rpImg.visible=this.rpImg1.visible=!1},e.updateView=function(){this.hasGet&&(this.buyBtn.gray=this.buyBtn1.gray=!0,this.buyBtn.mouseEnabled=this.buyBtn1.mouseEnabled=!1),this.nowKillNum<this.needKillNums[2]?this.killNum.text=this.nowKillNum+"":this.killNum.text=this.needKillNums[2]+"",this.updateRestoreBar()},e.updateRestoreBar=function(){if(this.bar.width=0,this.nowKillNum>=this.needKillNums[2])return this.showIndex=3,this.max=!0,this.tree.skin="modules/act/jubao/tree"+(this.showIndex+1)+".png",this.bar.width=this.barLenArr[2],this.goldNum.text=this.goldNums[this.showIndex]+"",void(this.hasGet||(this.buyBtn.gray=this.buyBtn1.gray=!1,this.buyBtn.mouseEnabled=this.buyBtn1.mouseEnabled=!0));for(var t,i=0,e=0,s=0,n=this.bar.width,h=0;h<this.needKillNums.length;h++){if(this.nowKillNum<this.needKillNums[h]){this.showIndex=h,i=this.barLenArr[h],e=this.needKillNums[h],0<h?(this.prekillNum=this.nowKillNum-this.needKillNums[this.showIndex-1],s=e-this.needKillNums[this.showIndex-1]):(this.prekillNum=this.nowKillNum,s=e);break}if(this.nowKillNum==this.needKillNums[h]){this.showIndex=h+1,i=this.barLenArr[h+1],e=this.needKillNums[h+1],this.prekillNum=0,s=e-this.needKillNums[this.showIndex-1];break}}0<this.showIndex&&!this.hasGet?(this.buyBtn.gray=this.buyBtn1.gray=!1,this.buyBtn.mouseEnabled=this.buyBtn1.mouseEnabled=!0,n=this.barLenArr[this.showIndex-1]):(this.buyBtn.gray=this.buyBtn1.gray=!0,this.buyBtn.mouseEnabled=this.buyBtn1.mouseEnabled=!1,n=0),this.tree.skin="modules/act/jubao/tree"+(this.showIndex+1)+".png",this.goldNum.text=this.goldNums[this.showIndex]+"",t=i-n;var a=this.prekillNum/s;this.bar.width=n+t*a},e.updateTime=function(){var t=86400-(Ma.serverTime%86400+28800);this.limitTime.text=0<=t?Qt.formatDHMS(t,!1):Qt.formatDHMS(86400+t,!1)},e.callBackUpdate=function(){this.update()},o(0,e,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t}),o(0,e,"uiClass",function(){return"JubaoView"}),o(0,e,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,e,"actID",function(){return this._actIDs},function(t){this._actIDs=t})}(),function(t){function i(){this._data=null,this._configVO=null,this.goodsItems=null,this.mcGoodsItem=null,i.__super.call(this),this.btnGet.on("click",this,this.onClick),this.txtNum.style.align="center"}l(i,"modules.activity.levelGift.ActLevelGiftItem",t);var e=i.prototype;e.onClick=function(t){if("领取"==this.btnGet.label)b.getInstance().toGet(this._data.id);else if("再领一次"==this.btnGet.label)if(Oo.isHasCard())b.getInstance().toGet(this._data.id);else{var i=new q;i.msg="是否前往超值月卡活动？",i.yesLabel="点击前往",i.yesCaller=this,i.yesFun=this.openMonthCard,K.showVO(i)}},e.openMonthCard=function(){Ae.linkTo(11431)},e.onItemClick=function(t){var i=t.target.val,e=ve.getItem(i.id);e.tempNum=i.val;var s="";s=ve.isEquip(e.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(e,s)},e.update=function(){if(this._configVO=x.getConfigVOById(this._data.id),this._configVO){var t,i,e;this.goodsItems=this.goodsItems||[];for(var s=0;s<this._configVO.lvGoods.length;s++)i=this._configVO.lvGoods[s],null==(t=this.goodsItems[s])&&((t=new hi("")).txtName.fontSize=24,this.goodsItems.push(t)),t.pos(120*s,0),this.spGoods.addChild(t),(e=new Object).className="p_tkv",e.type=5,e.id=i.typeId,e.val=i.num,t.setDrop(e),t.on("click",this,this.onItemClick);switch(this.mcGoodsItem=this.mcGoodsItem||new hi(""),this.mcGoodsItem.txtName.fontSize=24,this.mcGoodsItem.pos(0,0),this.spMonthCardGoods.addChild(this.mcGoodsItem),(e=new Object).className="p_tkv",e.type=5,e.id=this._configVO.mcLvGoods.typeId,e.val=this._configVO.mcLvGoods.num,this.mcGoodsItem.setDrop(e),this.mcGoodsItem.on("click",this,this.onItemClick),ie.myLevel>=this._configVO.level&&ie.myRegrow>=this._configVO.regrow?(0<this._configVO.regrow?this.txtNum.innerHTML=pe.span("进度(转)：","#f4f1b2")+pe.span(ie.myRegrow+"","#96f254")+pe.span("/"+this._configVO.regrow,"#f4f1b2"):this.txtNum.innerHTML=pe.span("进度(级)：","#f4f1b2")+pe.span(ie.myLevel+"","#96f254")+pe.span("/"+this._configVO.level,"#f4f1b2"),2==this._data.val?Oo.isHasCard()?this.imgRedPoint.visible=!0:this.imgRedPoint.visible=!1:3==this._data.val?this.imgRedPoint.visible=!1:this.imgRedPoint.visible=!0):(this.imgRedPoint.visible=!1,0<this._configVO.regrow?this.txtNum.innerHTML=pe.span("进度(转)：","#f4f1b2")+pe.span(ie.myRegrow+"","#fe2e2e")+pe.span("/"+this._configVO.regrow,"#f4f1b2"):this.txtNum.innerHTML=pe.span("进度(级)：","#f4f1b2")+pe.span(ie.myLevel+"","#fe2e2e")+pe.span("/"+this._configVO.level,"#f4f1b2")),0<this._configVO.regrow?this.imgTitle.skin="modules/act/levelGift/regrow"+this._configVO.regrow+".png":this.imgTitle.skin="modules/act/levelGift/LV"+this._configVO.level+".png",this._data.val){case 0:this.btnGet.mouseEnabled=!1,this.btnGet.label="等级不足",this.btnGet.labelColors="#f5e1cd,#f5e1cd,#f5e1cd",this.btnEnable=!1;break;case 1:this.btnGet.mouseEnabled=!0,this.btnGet.label="领取",this.btnGet.labelColors="#ffffff,#f8fdaa,#b8b9b8",this.btnEnable=!0;break;case 2:this.btnGet.mouseEnabled=!0,this.btnGet.label="再领一次",this.btnGet.labelColors="#ffffff,#f8fdaa,#b8b9b8",this.btnEnable=!0;break;case 3:this.btnGet.mouseEnabled=!1,this.btnGet.label="已领取",this.btnGet.labelColors="#f5e1cd,#f5e1cd,#f5e1cd",this.btnEnable=!1}}},o(0,e,"btnEnable",null,function(t){Ne.isWX||Ne.isQQ?this.btnGet.disabled=!t:(this.btnGet.state=t?0:2,this.btnGet.mouseEnabled=t)}),o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._data=t,this._data&&this.update()})}(y),function(t){function i(){this._typeID=null,this._actID=null,this._iconID=NaN,this._skinID=NaN,i.__super.call(this),this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(1e3,"levelGift.ActLevelGiftItem")}l(i,"modules.activity.levelGift.ActLevelGiftView",S);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.update=function(){var t=x.getCommonConditions();this.list.dataSource=t},e.callBackUpdate=function(){},o(0,e,"skinID",function(){return this.skinID},function(t){this._skinID=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t}),o(0,e,"uiClass",function(){return"ActLevelGift"}),o(0,e,"typeID",function(){return this._typeID},function(t){this._typeID=t}),o(0,e,"actID",function(){return this._actID},function(t){this._actID=t})}(),function(t){function i(){this._data=null,this.bmclip=null,this._goods=null,this.imgSale=null,this.imgSaleBg=null,this.goodsVO=null,this.goodsP=null,i.__super.call(this),this.btnBuy.on("click",this,this.onBuy)}l(i,"modules.activity.limit.ActLimitItem",t);var e=i.prototype;e.onClick=function(t){var i=this._data.goods[0],e=ve.getItem(i.type_id);e.tempNum=i.num;var s="";s=ve.isEquip(i.type_id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(e,s)},e.onBuy=function(t){if(0<this._data.vipNeed&&oo.curLv<this._data.vipNeed){var i=new q;return i.msg="需达VIP"+this._data.vipNeed+"才可购买哦，是否前往提升VIP等级？",i.yesCaller=Ae,i.yesFun=Ae.linkTo,i.yesArgs=[11454],void K.showVO(i)}if(1==this._data.consumeType&&ie.gold<this._data.realPrice)es.showAlert();else if(2==this._data.consumeType&&ie.silver<this._data.realPrice)Zi.show(10201113);else if(this.goodsP=this._data.goods[0],this.goodsVO=ve.getItem(this.goodsP.type_id),this.goodsVO){var e="是否消耗"+pe.span(this._data.realPrice+""+(1==this._data.consumeType?"元宝":"铜钱"),"#fbd815")+"购买"+pe.span(this.goodsP.num+"个"+this.goodsVO.name+"？","#fbd815");es.showSecAlert(e,L.ins(),L.ins().toGain,[this._data.actID,this._data.conID],"ActLimitItem.onBuy")}},e.update=function(){var t=this._data;this.imgBg.skin=311==this._data.iconId?"modules/act/onLine/"+this._data.iconId+"/itemBg.png":"modules/act/itemBg.png";var i=t.goods[0];this._goods=this._goods||new oe(90,90,!1,!0,!0,!1),this._goods.dataSource=[i.type_id,i.num],this._goods&&null==this._goods.parent&&(this.addChild(this._goods),this._goods.pos(25,85)),0<t.vipNeed?(this.imgDesc.visible=!1,this.imgVip.visible=this.imgVipNum.visible=!0,this.imgVipNum.skin="modules/act/limit/vipNum"+t.vipNeed+".png"):(this.imgDesc.visible=!0,this.imgVip.visible=this.imgVipNum.visible=!1);var e=parseInt(this._data.saleTag/100+""),s=this._data.saleTag%100;0<e&&(this.imgSaleBg=this.imgSaleBg||new ge,this.imgSaleBg.pos(45,80),this.imgSaleBg.skin="modules/act/limit/dbg.png",this.imgSaleBg&&null==this.imgSaleBg.parent&&this.addChild(this.imgSaleBg),this.imgSale=this.imgSale||new ge,this.imgSale.pos(48,83),this.imgSale.skin="modules/act/limit/d"+e+".png",this.imgSale&&null==this.imgSale.parent&&this.addChild(this.imgSale)),this.tag.skin=1<s?"modules/act/limit/tag"+s+".png":"",1==i.reserve&&(this.bmclip=this.bmclip||ut.getOne(),this.bmclip.mouseEnabled=!1,this.bmclip.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),this.bmclip.pos(this._goods.x+90,this._goods.y+93),this.bmclip&&null==this.bmclip.parent&&this.addChild(this.bmclip)),this.txtGold.text=t.realPrice+"",1==t.consumeType?this.imgConsumeType.skin="com/ui/gold.png":2==t.consumeType&&(this.imgConsumeType.skin="com/ui/copper.png"),1==t.consumeType&&ie.user.attr.gold>=t.realPrice&&0<t.canBuyNum?this.imgRedPoint.visible=!0:2==t.consumeType&&ie.silver>=t.realPrice&&0<t.canBuyNum?this.imgRedPoint.visible=!0:this.imgRedPoint.visible=!1;var n=t.goods[0].type_id;"true"==Pe.getItem(R.isSelectKey+"_2_"+n)&&(this.imgRedPoint.visible=!1),0<t.canBuyNum?(this.txtTimes.color="#f8e715",this.btnBuy.label="购买",this.btnBuy.labelColors="#ffffff,#f8fdaa,#b8b9b8",this.btnEnable=!0):(this.txtTimes.color="#fa291e",this.btnBuy.label="已购买",this.btnBuy.labelColors="#f5e1cd,#f5e1cd,#f5e1cd",this.btnEnable=!1),this.txtTimes.text="今日限购："+(t.totalBuyNum-t.canBuyNum)+"/"+t.totalBuyNum},o(0,e,"btnEnable",null,function(t){Ne.isWX||Ne.isQQ?this.btnBuy.disabled=!t:(this.btnBuy.state=t?0:2,this.btnBuy.mouseEnabled=t)}),o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){(this._data=t)&&this.update()}),o(0,e,"goods",function(){return this._goods})}(w),function(t){function i(){this.board=null,this.itemArr=null,this.curVO=null,this._typeID=null,this._actID=null,this._iconID=NaN,this._skinID=NaN,i.__super.call(this),this.pnl.vScrollBarSkin="",this.board=new ct,this.board.pos(0,5),this.addChild(this.board),this.on("click",this,this.onClick)}l(i,"modules.activity.limit.ActLimitView",t);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onClick=function(t){switch(t.target){case this.redTip:this.update(),ni.dispatch("ACT_RP_CONTROLLL_VIEW",2,this.itemArr)}},e.update=function(){if(this.curVO=G.getActDetailByActID(this.actID[0]),this.curVO){0<this.skinID?this.board.bgSkin="modules/act/limit/skin"+this.skinID+"/limitBg.png":this.board.bgSkin="modules/act/limit/"+this.curVO.iconId+"/limitBg.png",this.imgKuang.skin=311==this.curVO.iconId?"modules/act/"+this.curVO.iconId+"/awardBg.png":"modules/act/awardBg.png",this.board.desc=this.curVO.desc,this.board.helpStr=this.curVO.help,this.board.endTime=this.curVO.endTime,this.itemArr=this.itemArr||[],this.curVO.items.sort(this.memSortFun);for(var t,i=this.curVO.items.length,e=0,s=0,n=0;n<i;n++)12!=(t=this.curVO.items[n]).state?(this.itemArr[n]=this.itemArr[n]||Na.getIns(1e3,"limit.ActLimitItem"),this.itemArr[n].x=0,this.itemArr[n].y=211*e,this.itemArr[n].dataSource=t,this.itemArr[n].update(),this.pnl.addChild(this.itemArr[n]),e++):s++;for(var h=[],a=!0,o=0;o<this.itemArr.length-s;o++){var r=this.itemArr[o].goods.getItemVO().id;if(!(0<=h.indexOf(r))&&(h.push(r),!D.getIsMask(2,r))){a=!1;break}}D.IS_LIMIT_ALL_MASK=a;var l=M.getInstance().getHuanPiPanel();l&&l.updateRedPoint()}},e.memSortFun=function(t,i){var e=t.state,s=i.state,n=t.canBuyNum,h=i.canBuyNum;return 12!=e&&12==s?-1:12==e&&12!=s?1:0<n&&h<=0?-1:n<=0&&0<h?1:t.conID<i.conID?-1:t.conID>i.conID?1:0},e.callBackUpdate=function(){this.update()},e.createChildren=function(){t.prototype.createChildren.call(this)},o(0,e,"typeID",function(){return this._typeID},function(t){this._typeID=t}),o(0,e,"actID",function(){return this._actID},function(t){this._actID=t}),o(0,e,"skinID",function(){return this._skinID},function(t){this._skinID=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(k),function(t){function i(){this._vo=null,this._items=null,this._targetTime=NaN,i.__super.call(this),this.btn.on("click",this,this.onBtnClick),this.on("display",this,this.onAdd),this.on("undisplay",this,this.onRemove)}l(i,"modules.activity.online.ActOnlineItem",t);var e=i.prototype;e.onAdd=function(t){De.addToSecond(this,this.loop)},e.onRemove=function(t){De.removeFromSceond(this,this.loop)},e.loop=function(){this._vo&&0<this._targetTime&&(this._targetTime<=Ma.serverTime?(L.ins().toActDetail(this._vo.actID),this._targetTime=0):this.txtLastTime.text=Qt.formatTime(this._targetTime-Ma.serverTime))},e.onBtnClick=function(t){this._vo&&L.ins().toGain(this._vo.actID,this._vo.conID)},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(this.imgHas.visible=!1,this.btn.visible=!0,this._vo=t,this._vo){this._items=this._items||[],this._vo.needTime>=this._vo.onlineTime?this._targetTime=Ma.serverTime+this._vo.needTime-this._vo.onlineTime:this._targetTime=0,311==this._vo.iconId?this.imgBg.skin="modules/act/onLine/"+this._vo.iconId+"_itemBg.png":this.imgBg.skin="modules/act/itemBg.png",this.imgTxtBg.skin="modules/act/subTitleBg.png",this.imgMin.skin="modules/act/onLine/"+Math.floor(this._vo.needTime/60)+"min.png";for(var i=Math.max(this._vo.goods.length,this._items.length),e=0;e<i;e++)if(e<this._vo.goods.length){null==this._items[e]&&(this._items[e]=new oi(91,95,!1,!0,!0,!1));var s=this._vo.goods[e],n=this._items[e];n.dataSource=[s.type_id,s.num],n.pos(100*e,15),n.effVisible=1==s.reserve,this.spGoods.addChild(n)}else this._items[e]&&this._items.parent&&this._items[e].removeSelf();switch(this._vo.state){case 21:case 22:this.imgHas.visible=!0,this.btn.visible=!1,this.imgRp.visible=!1,this.txtLastTime.visible=!1;break;case 20:case 10:this.btn.label="未达成",this.btn.disabled=!0,this.imgRp.visible=!1,this.txtLastTime.visible=!0,this.txtLastTime.text=Qt.formatTime(this._vo.needTime-this._vo.onlineTime);break;case 3:case 11:this.btn.label="可领取",this.btn.disabled=!1,this.imgRp.visible=!0,this.txtLastTime.visible=!1}}}),i.goodsPool=null}(P),function(t){function i(){this.curVO=null,this.onlineTime=0,this._typeID=null,this._actID=null,this._iconID=NaN,this._skinID=NaN,i.__super.call(this),this.list.itemRender=Na.getClass(1e3,"online.ActOnlineItem"),this.list.vScrollBarSkin="",this.on("display",this,this.onAdd),this.imgTip.on("click",this,this.onClick),this.btnGo.on("click",this,this.onLink)}l(i,"modules.activity.online.ActOnlineView",V);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.onClick=function(){$i.ins.showMessage(this.curVO.help)},e.onLink=function(t){M.getInstance().closeActPanel(this.curVO.iconId),ni.dispatch("OPEN_BANNER_QQ")},e.update=function(){this.imgBannerTip.visible=ie.qqBannerOpen,this.curVO=G.getActDetailByActID(this.actID[0]),this.curVO&&(0<this._skinID?this.imgBg.skin="modules/act/onLine/skin"+this._skinID+"/poster.png":this.imgBg.skin="modules/act/onLine/"+this.curVO.iconId+"/poster.png",this.list.repeatY!=this.curVO.items.length&&(this.list.repeatY=this.curVO.items.length),this.onlineTime=this.curVO.items[0].onlineTime,this.txtLeftTime.text=Qt.formatTotalHMS(this.onlineTime),this.curVO.items.sort(this.sortItem),this.list.dataSource=this.curVO.items)},e.loop=function(){0<this.onlineTime?this.txtLeftTime.text=Qt.formatTotalHMS(this.onlineTime):this.txtLeftTime.text="",this.onlineTime++},e.onAdd=function(){De.addToSecond(this,this.loop),this.on("undisplay",this,this.onRemove),this.off("display",this,this.onAdd)},e.onRemove=function(){De.removeFromSceond(this,this.loop),this.off("undisplay",this,this.onRemove),this.on("display",this,this.onAdd)},e.sortItem=function(t,i){var e=F.STATE_SORT_ARR.indexOf(t.state),s=F.STATE_SORT_ARR.indexOf(i.state);return e<s?-1:s<e?1:t.needTime<i.needTime?-1:t.needTime>i.needTime?1:0},e.callBackUpdate=function(){this.update()},o(0,e,"typeID",function(){return this._typeID},function(t){this._typeID=t}),o(0,e,"actID",function(){return this._actID},function(t){this._actID=t}),o(0,e,"skinID",function(){return this._skinID},function(t){this._skinID=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(),function(t){function i(){this._data=null,this.bmclip=null,this.eff=null,this._goods=null,this.sp=null,this.goodsVO=null,this.goodsP=null,this.vo=null,i.__super.call(this),this.on("click",this,this.onClick),this.createLine(),this.eff=ut.getOne(),this.eff.pos(80,120),this.itemSp.addChild(this.eff),this.eff.visible=!1,this.eff.mouseEnabled=!0}l(i,"modules.activity.serverLimitBuy.ServerLimitBuyItem",t);var e=i.prototype;e.onClick=function(t){var i="";switch(t.target){case this.buyBtn:if(0==this.vo.canBuyNum)io.addTip("全服购买次数为0，无法进行购买");else if(0==this.vo.roleCanBuy)io.addTip("您的购买次数为0，无法进行购买");else if(0<Tt.chackGiftHave2(this.goodsP.type_id)){var e,s=0;s=13000102<=this.goodsP.type_id&&this.goodsP.type_id<=13000999?10903:Math.floor(this.goodsP.type_id/1e3);var n=Tt.chackGiftHave2(this.goodsP.type_id);if(10903!=s){this.buyItem();break}if(!(5<=n)){this.buyItem();break}e="已拥有"+n+"个"+pe.span(this.goodsVO.name+"(包含技能)","#fbd815")+"，达到该物品最大数量限制，请问是否继续购买？";var h=new q;h.msg=e,h.yesCaller=this,h.yesFun=this.buyItem,h.yesArgs=null,K.showVO(h)}else this.buyItem();break;case this.itemSp:this.goodsVO&&(this.goodsVO.tempNum=this.goodsP.num,i=ve.isEquip(this.goodsVO.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(this.goodsVO,i))}},e.buyItem=function(){if(ie.gold<this._data.realPrice)es.showAlert();else if(this.goodsVO){var t="是否消耗"+pe.span(this._data.realPrice+"元宝","#fbd815")+"购买"+pe.span(this.goodsP.num+"个"+this.goodsVO.name,"#fbd815")+"？",i=new U;i.goodsTypeID=this.goodsVO.id,i.defaultCaller=es,i.defaultFun=es.showSecAlert,i.defaultArgs=[t,L.ins(),L.ins().toGain,[this._data.actID,this._data.conID],"ServerLimitBuyItem.onBuy"],i.yesCaller=L.ins(),i.yesFun=L.ins().toGain,i.yesArgs=[this._data.actID,this._data.conID],H.ins().checkRepeatAlert(i)}},e.createLine=function(){this.sp=this.sp||new Ta,this.sp.graphics.drawLine(0,33,80,33,"#ff0000",2),this.sp.pos(10,-20),this.priPrice.addChild(this.sp)},e.update=function(){this.vo=this._data,this.goodsP=this._data.goods[0],this.goodsVO=ve.getItem(this.goodsP.type_id);var t=this.vo.goods[0];this._goods=this._goods||new oe(90,90,!1,!0,!0,!1),this._goods.dataSource=[t.type_id,t.num];var i=G.getActEffsVOByItemID(t.type_id);i?(this.eff.loadAndPlay(i.effPath,i.action,i.dir,0<i.isLoop),this.eff.visible=!0):(this._goods&&null==this._goods.parent&&(this.addChild(this._goods),this._goods.pos(60,140)),1==t.reserve&&(this.bmclip=this.bmclip||ut.getOne(),this.bmclip.mouseEnabled=!1,this.bmclip.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),this.bmclip.pos(this._goods.x+90,this._goods.y+93),this.bmclip&&null==this.bmclip.parent&&this.addChild(this.bmclip))),0<this._data.saleTag&&this._data.saleTag<10?(this.discount.visible=this.distxt.visible=!0,this.tipImg.skin="modules/act/serverLimitBuy/tip.png",this.discount.skin="modules/act/serverLimitBuy/num_0"+this._data.saleTag+".png"):11==this._data.saleTag?(this.discount.visible=this.distxt.visible=!1,this.tipImg.skin="modules/act/serverLimitBuy/tip2.png"):12==this._data.saleTag?(this.discount.visible=this.distxt.visible=!1,this.tipImg.skin="modules/act/serverLimitBuy/tip3.png"):this.discount.visible=this.distxt.visible=this.tipImg.visible=!1,this.prePrice.text=this.vo.realPrice+"",this.priPrice.text=this.vo.origPrice+"";var e=this.vo.goods[0].type_id;"true"==Pe.getItem(R.isSelectKey+"_2_"+e)&&(this.Rp.visible=!1),0==this.vo.canBuyNum||0==this.vo.roleCanBuy?this.buyBtn.gray=!0:(this.buyBtn.label="抢购",this.buyBtn.labelColors="#ffffff,#f8fdaa,#b8b9b8",this.buyBtn.state=0,this.buyBtn.mouseEnabled=!0),this.canbuyNum.text=this.vo.roleCanBuy+"",this.hasNum.text=this.vo.canBuyNum+"",this.nameTxt.text=this._goods.getItemVO().name,1==this.vo.consumeType&&ie.user.attr.gold>=this.vo.realPrice&&0<this.vo.roleCanBuy&&0<this.vo.canBuyNum?this.Rp.visible=!0:2==this.vo.consumeType&&ie.silver>=this.vo.realPrice&&0<this.vo.roleCanBuy&&0<this.vo.canBuyNum?this.Rp.visible=!0:this.Rp.visible=!1,0==this.vo.roleCanBuy&&(this.canbuyNum.color="#ff0000"),0==this.vo.canBuyNum&&(this.hasNum.color="#ff0000")},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){t&&(this._data=t,this.update())}),o(0,e,"goods",function(){return this._goods})}(Nh),function(t){function i(){this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this.checkIds=null,this.curVO=null,this.curVO2=null,this.itemArr=null,this.curIndex=0,this.helpStr=null,this.endTime=0,this.p=null,this.pdata2=null,this.bmclip=null,i.__super.call(this),this.pan.hScrollBarSkin="",this.rpSet.visible=!1}l(i,"modules.activity.serverLimitBuy.ServerLimitBuyView",t);var e=i.prototype;s.imps(e,{"modules.activity.IActivityView":!0}),e.createChildren=function(){t.prototype.createChildren.call(this),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay)},e.onClick=function(t){switch(t.target){case this.rpSet:ni.dispatch("ACT_RP_CONTROLLL_VIEW",2,this.itemArr);break;case this.helpBtn:$i.ins.showMessage(this.helpStr);break;case this.getReward:if(0<this.pdata2.hasGet)ve.getItem(this.p.type_id)&&L.ins().toGain(this.pdata2.actID,this.pdata2.conID,1);else io.addTip("奖励已领取");this.update()}},e.setData=function(){if(ni.dispatch("ACT_ACTIVITY_ACTID",2,this.actID[0]),null!=this.typeID){for(var t=0;t<this.typeID.length;t++)switch(this.typeID[t]){case 2603:this.curVO2=G.getActDetailByActID(this.actID[t]);break;case 1804:L.ins().toActDetail(this.actID[t]),this.curVO=G.getActDetailByActID(this.actID[t])}if(this.curVO){this.helpStr=this.curVO.help,this.endTime=this.curVO.endTime,this.itemArr=this.itemArr||[];for(var i,e=this.curVO.items.length,s=0,n=0;n<e;n++)12!=(i=this.curVO.items[n]).state&&(this.itemArr[n]=this.itemArr[n]||Na.getIns(1e3,"serverLimitBuy.ServerLimitBuyItem"),this.itemArr[n].x=290*s,this.itemArr[n].y=0,this.itemArr[n].dataSource=i,this.itemArr[n].update(),this.pan.addChild(this.itemArr[n]),s++)}if(this.curVO2){if(this.pdata2=this.curVO2.items[0],12==this.pdata2.state)return;var h;this.p=this.pdata2.awards[0],(h=h||new oe).x=0,h.y=0,h.dataSource=[this.p.type_id,this.p.num],this.rewardSp.addChild(h),1==this.p.reserve&&(this.bmclip=this.bmclip||ut.getOne(),this.bmclip.mouseEnabled=!1,this.bmclip.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),this.bmclip.pos(this.rewardSp.x+148,this.rewardSp.y+109),this.bmclip&&null==this.bmclip.parent&&this.addChild(this.bmclip))}}},e.onDisplay=function(){this.update(),De.addToSecond(this,this.updateTime),ni.register("ACT_SERVERLIMITBUY_UPDATE",this,this.update),this.on("undisplay",this,this.onUNDisplay)},e.onUNDisplay=function(){De.removeFromSceond(this,this.updateTime),ni.remove("ACT_SERVERLIMITBUY_UPDATE",this,this.update)},e.updateTime=function(){this.endTime>Ma.serverTime?this.limitTime.text=Qt.formatDHMS(this.endTime-Ma.serverTime):(De.removeFromSceond(this,this.updateTime),this.limitTime.text="活动已结束")},e.update=function(){this.setData(),this.updateBtn(),this.updateRp()},e.updateRp=function(){0<this.pdata2.hasGet?this.rewardRp.visible=!0:this.rewardRp.visible=!1},e.updateBtn=function(){1!=this.pdata2.hasGet&&(this.getReward.gray=!0)},e.callBackUpdate=function(){},o(0,e,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,e,"actID",function(){return this._actIDs},function(t){this._actIDs=t}),o(0,e,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,e,"iconID",function(){return this._iconID},function(t){this._iconID=t})}(Eh),function(t){function i(){this.numImgPool=[],this.showItems=null,this.eff=null,this.clipArr=null,this.isLowPrice=-1!=[1,8,3].indexOf(ji.agentId),this.money=0,this.curImgs=[],this.endTime=NaN,this.hasGodCoin=ie.getScore(30),i.__super.call(this)}l(i,"modules.activity.strBeast.StrBeastLimitView",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.initShowItems(),this.initShowEffs(),this.initPower(),this.initPrice(),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay)},e.initPrice=function(){var t=this.isLowPrice?1035:1036;this.money=Ci.getChargeBackVO(t).money,Vh.isFanTi?(this.lbNowPrice.text="现价："+this.money+"仙尊幣",this.lbOldPrice.text="原价："+10*this.money+"仙尊幣"):(this.lbNowPrice.text=Vh.isXianLai?"现价："+10*this.money+"钻石":"现价："+this.money+"元",this.lbOldPrice.text=Vh.isXianLai?"原价："+100*this.money+"钻石":"原价："+10*this.money+"元")},e.initPower=function(){this.spPowerUp.removeChildren();for(var t=this.getImgs(201920),i=t.length,e=0;e<i;e++)t[e].x=25*e,this.spPowerUp.addChild(t[e])},e.getImgs=function(t){for(;0<this.curImgs.length;)this.numImgPool.push(this.curImgs.shift());for(var i=t.toString().split(""),e=i.length,s=0;s<e;s++){var n;(n=0<this.numImgPool.length?this.numImgPool.pop():new ge).skin="modules/act/StrBeastLimit/font/power"+i[s]+".png",this.curImgs.push(n)}return this.curImgs},e.initShowItems=function(){this.showItems=this.showItems||[];for(var t=0;t<4;t++){switch(this.showItems[t]=this.showItems[t]||new oe(102,102,!1,!0,!0,!1),t){case 0:this.showItems[0].dataSource=[10407004,1];break;case 1:this.showItems[1].dataSource=[10407001,1];break;case 2:this.showItems[2].dataSource=[10407002,1];break;case 3:this.showItems[3].dataSource=[10407003,1]}var i=this["imgItem"+(t+1)];this.showItems[t].hideGoodsName(),this.showItems[t].pos(-40,-17),i.addChild(this.showItems[t])}},e.initShowEffs=function(){this.eff=ut.getOne(),this.eff.pos(140,170),this.eff.scaleX=this.eff.scaleY=1.5,this.spBeast.addChild(this.eff),this.clipArr=this.clipArr||[];for(var t=0;t<4;t++){this.clipArr[t]=ut.getOne(),this.clipArr[t].scaleX=1.13,this.clipArr[t].scaleX=1.13,this.clipArr[t].scaleY=1.1,this.clipArr[t].pos(50,88),this["imgItem"+(t+1)].addChild(this.clipArr[t])}},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.txtImg1:case this.btnBuy:var i=this.isLowPrice?1035:1036;Vh.isFanTi?Ai.ins().toExchange(i):Ai.ins().toPay(i);break;case this.txtImg2:case this.txtImg3:case this.txtImg4:Ae.linkTo(10600);break;case this.btnMing:Ae.linkTo(10810)}},e.onDisplay=function(){this.eff.loadAndPlay("unit/monster/70000014_3","stand",3,!0);for(var t=0;t<4;t++)this.clipArr[t].loadAndPlay("moduleEffect/goodsItemEff","default",0,!0);this.on("undisplay",this,this.onUNDisplay),this.initVoInfo()},e.onUNDisplay=function(){De.removeFromSceond(this,this.updateTime)},e.update=function(){},e.updateTime=function(){var t=this.endTime-Ma.serverTime;0<t?this.timeLimit.text="倒计时："+Qt.formatDHMS(t):De.removeFromSceond(this,this.updateTime)},e.initVoInfo=function(){var t=fe.getIconStateDicValus(115);t&&(this.endTime=t.end_time,0<this.endTime&&0<this.endTime-Ma.serverTime&&De.addToSecond(this,this.updateTime))}}(Ra),function(t){function i(){this.limitTime=0,this.curVO=null,this.showItems=null,this.type_ids=null,this.check_ids=null,this.bitClip1=null,this.bitClip2=null,this.bitClip3=null,i.__super.call(this)}l(i,"modules.activity.suitShow.SuitShowView",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.initTxtLinks(),this.initPower(),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.check_ids=[10201303,10101302,10101303]},e.initShowItems=function(){this.type_ids=[10904007,10905115,10905403],this.showItems=this.showItems||[];for(var t=0;t<3;t++){var i,e;this.showItems[t]=this.showItems[t]||new oe(102,102,!1,!0,!0,!1),this.showItems[t].dataSource=[this.type_ids[t],1],(i=ut.getOne()).loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),i.x=90,i.y=102,i.scaleX=1.13,i.scaleY=1.1,this["spImg"+(t+1)]&&(this["spImg"+(t+1)].addChild(this.showItems[t]),this["spImg"+(t+1)].addChild(i)),(e=ut.getOne()).loadAndPlay("moduleEffect/suitShow","default",0,!0),e.x=-10,e.y=150,e.scaleX=1,this["spSuit"+(t+(e.scaleY=1))]&&this["spSuit"+(t+1)].addChild(e)}},e.initPower=function(){var t,i=Rt.numToTexture(54128,"com/ui/powerNum");this.spPower.graphics.clear();for(var e=0;e<i.length;e++)t=i[e],this.spPower.graphics.drawTexture(t,t.width*e)},e.cheakHas=function(){for(var t=0;t<3;t++)0<Tt.chackGiftHave(this.check_ids[t])&&(this["hasItem"+(t+1)].skin="modules/act/suitShow/has.png")},e.initTxtLinks=function(){for(var t=1;t<4;t++)this["txtImg"+t].underline=!0,this["txtImg"+t].underlineColor="#00ff00"},e.getPaths=function(t,i,e){void 0===i&&(i="|"),void 0===e&&(e=",");for(var s=[],n=t.split(i),h=0;h<n.length;h++)for(var a=n[h].split(e),o=0;o<n.length;o++)s[h][o]=a[o];return s},e.initShowSp=function(){this.bitClip1=this.bitClip1||ut.getOne(),Vh.isFanTi?this.bitClip1.loadAndPlay("unit/title/10904007_ft","default",0,!0):this.bitClip1.loadAndPlay("unit/title/10904007","default",0,!0),this.bitClip1.scale(1.4,1.4),this.bitClip1.x=15,this.bitClip1.y=130,this.spSuit1.addChild(this.bitClip1),this.bitClip2=this.bitClip2||ut.getOne(),this.bitClip2.loadAndPlay(z.getRoleUnitSubFile(240000151)+"240000151_sit_4","sit",4,!0),this.bitClip2.scale(.9,.9),this.bitClip2.x=20,this.bitClip2.y=120,this.spSuit2.addChild(this.bitClip2),this.bitClip3=this.bitClip3||ut.getOne(),this.bitClip3.loadAndPlay(z.getWeaponUnitSubFile(1400000311)+"1400000311_0","stand",0,!0),this.bitClip3.scale(1.5,1.5),this.bitClip3.x=-40,this.bitClip3.y=150,this.spSuit3.addChild(this.bitClip3)},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.btnGoto:Ae.linkTo(11415);break;case this.txtImg1:Ae.linkTo(11409);break;case this.txtImg2:for(var i=310;i<399;i++)if(fe.getIconStateShow(i))return void ni.dispatch("OPEN_ACT_SPC_PANEL",i,1801);break;case this.txtImg3:Ae.linkTo(11447)}},e.onDisplay=function(){this.initShowItems(),this.initShowSp(),De.addToSecond(this,this.updateTime),ni.register("BAGDATA_CHANGE",this,this.cheakHas),ni.register("TITLE_UPDATE",this,this.cheakHas),ni.register("FASHION_UPDATE",this,this.cheakHas),Ja.ins().toInfo()},e.onUNDisplay=function(){De.removeFromSceond(this,this.updateTime)},e.update=function(){},e.updateTime=function(){var t=new Object;t.className="m_icon_notice_toc",(t=fe.getIconStateDicValus(117))&&(this.limitTime=t.end_time,this.limitTime<=Ma.serverTime?this.timeLimit.text="活动已结束":this.timeLimit.text="倒计时："+Qt.formatDHMS(this.limitTime-Ma.serverTime),this.timeLimit.color="#00ff00",this.timeLimit.fontSize=32)}}(Ba),function(t){function i(){this._typeId=0,this._num=0,this.eff=null,i.__super.call(this),this.on("click",this,this.onClick)}l(i,"modules.activity.wish.ActWishRewardItem",t);var e=i.prototype;e.showEff=function(){null==this.eff&&(this.eff=ut.getOne(),this.addChild(this.eff),this.eff.pos(45,45)),this.eff.loadAndPlay("moduleEffect/act_wish_bomb")},e.onClick=function(){if(this._typeId){var t=ve.getItem(this._typeId);if(t){t.tempNum=this._num;var i="";i=ve.isEquip(t.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(t,i)}}},e.update=function(){if(0<this._typeId){var t=ve.getItem(this._typeId);t&&(this.imgIcon.skin=t.realMaxico)}else this.imgIcon.skin=null},o(0,e,"typeId",function(){return this._typeId}),o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._typeId=t.typeID,this._num=t.num,this.update()})}(E),function(t){function c(){this.showPosArr=[[0,261],[95,294],[174,236],[246,288],[322,224],[398,282]],this.rewardPosArr=[[20,79],[117,79],[215,79],[312,79],[409,79],[20,189],[117,189],[215,189],[312,189],[409,189]],this.showItems=null,this.rewardItems=null,this.eff=null,this.itemArr=null,this.openBoxGoods=null,this.index=0,this.timeOutKey=0,this.showEffIng=!1,this.consumeVO=null,this.restoreVO=null,this.randomVO=null,this.rechargeRestoreVO=null,this.exchangeVO=null,this.ifShareHasRp=!1,this.spcGoodsTypeId=0,this._typeID=null,this._actID=null,this._iconID=NaN,this.scaleArr=[.7,.8,.8,.9,1],this.goodsImages=null,this.barMaxLen=568,this.maxSchedule=0,this.ifBarHasRp=!1,this._skinID=NaN,this.imgShowBgPos1=[[15,334],[109,365],[187,312],[263,363],[335,304],[412,361]],this.imgShowBgPos2=[[-13,232],[80,264],[160,202],[232,256],[310,190],[383,252]],c.__super.call(this),this.eff=ut.getOne(),this.eff.pos(140,170),this.effSp.addChild(this.eff),this.initShowItems(),this.tab.on("change",this,this.onTabClick),this.tab.selectedIndex=0,this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.list.vScrollBarSkin="",this.tab.visible=!1}l(c,"modules.activity.wish.ActWishView",B);var i=c.prototype;s.imps(i,{"modules.activity.IActivityView":!0}),i.onDisplay=function(){ni.register("SHARE_SUCC",this,this.updateShare),ni.register("CROSS_DAY",this,this.update),ni.register("ACT_BOX_OPEN",this,this.openBoxEff),ni.register("UPDATE_ACT_BOX_LOG_INFO",this,this.showBoxLogInfoImgs),this.on("undisplay",this,this.onUNDisplay),0==this.skinID&&Ma.isOpenShare(7,850)?this.imgShare.visible=!0:3==this.skinID&&Ma.isOpenShare(7,851)?this.imgShare.visible=!0:this.imgShare.visible=!1},i.onUNDisplay=function(){ni.remove("SHARE_SUCC",this,this.updateShare),ni.remove("CROSS_DAY",this,this.update),ni.remove("ACT_BOX_OPEN",this,this.openBoxEff),ni.remove("UPDATE_ACT_BOX_LOG_INFO",this,this.showBoxLogInfoImgs),De.removeFromSceond(this,this.timeLoop),De.removeFromTimer(this,this.loopShowEff),De.clearTimeout(this.timeOutKey),this.showEffIng=!1},i.onTabClick=function(){switch(this.tab.selectedIndex){case 0:this.spWish.visible=!0,this.imgTip.visible=!1,this.spChange.visible=!1;break;case 1:this.spWish.visible=!1,this.imgTip.visible=!1,this.spChange.visible=!0}this.update()},i.initShowItems=function(){if(null==this.showItems){var t;this.showItems=[];for(var i=0;i<6;i++)(t=Na.getIns(1e3,"wish.ActWishRewardItem")).pos(this.showPosArr[i][0],this.showPosArr[i][1]),this.spShow.addChild(t),this.showItems.push(t)}},i.initRewardItems=function(){if(null==this.rewardItems){var t;this.rewardItems=[];for(var i=0;i<10;i++)t=Na.getIns(1e3,"wish.ActWishRewardItem"),this.spReward.addChild(t),this.rewardItems.push(t)}},i.openBoxEff=function(t){this.openBoxGoods=t,this.index=0,this.showEffIng=!0,De.addToTimer(this,this.loopShowEff)},i.loopShowEff=function(){if(this.index<this.showItems.length){var t=this.showItems[this.index];t&&(t.imgEff.visible=!0),this.index++}else De.removeFromTimer(this,this.loopShowEff),this.resetShowItemsSelectedEff(),this.showBombEff()},i.resetShowItemsSelectedEff=function(){for(var t in this.showItems)this.showItems[t].imgEff.visible=!1},i.showBombEff=function(){for(var t in this.showItems)this.showItems[t].showEff();this.timeOutKey=De.setTimeout(this,this.openBox,null,1e3)},i.openBox=function(){this.spReward.visible=!0,this.spShow.visible=!1,this.eff&&(this.eff.visible=!1),this.resetRewardItems();var t,i,e=this.openBoxGoods[0];if(1==e.length)i=e[0],(t=this.rewardItems[0]).visible=!0,t.dataSource={typeID:i.id,num:i.val},t.pos(199,129,!0);else for(var s=0;s<e.length;s++)(t=this.rewardItems[s]).visible=!0,t.pos(this.rewardPosArr[s][0],this.rewardPosArr[s][1],!0),i=e[s],t.dataSource={typeID:i.id,num:i.val};this.updateLotusNum(),this.showEffIng=!1,this.consumeVO&&kt.ins().toRoleActBoxSelfLog(this.consumeVO.actID)},i.resetRewardItems=function(){var t;for(var i in this.rewardItems)(t=this.rewardItems[i]).dataSource=0,t.visible=!1},i.timeLoop=function(){this.rechargeRestoreVO&&this.rechargeRestoreVO.endTime>Ma.serverTime?this.txtLeftTime.text=Qt.formatDHMS(this.rechargeRestoreVO.endTime-Ma.serverTime):(De.removeFromSceond(this,this.timeLoop),this.txtLeftTime.text="活动已结束")},i.onClick=function(t){var i,e="";switch(t.target){case this.btnOne:this.showEffIng?io.addTip("许愿中，请稍等"):(Ve.send(10055,2,"许愿池-开始祈愿按钮"),this.checkWish(1));break;case this.btnTen:this.showEffIng?io.addTip("许愿中，请稍等"):(Ve.send(10055,3,"许愿池-祈愿十次按钮"),this.checkWish(2));break;case this.btnCharge:this.toCharge();break;case this.btnAdd:var s="";0==this.skinID?s="莲花":3==this.skinID&&(s="天灯");var n=Vh.isFanTi?pe.span("註：每儲值5仙尊幣，即可獲得","#5d3924"):pe.span("注：每充值50元宝，即可获得","#5d3924"),h=pe.span(s,"#F7EF5F")+pe.span("可通过充值获取，请问是否前往获得？","#5d3924")+"<br/>"+n+pe.span(s+"*1","#F7EF5F");es.showSecAlert(h,this,this.toCharge,null,"actWishViewAddGold");break;case this.btnKnow:this.spShow.visible=!0,this.eff&&(this.eff.visible=!0),this.spReward.visible=!1;break;case this.imgShare:Ve.send(10055,4,"许愿池-分享按钮"),0<ws.getRewardTimes(7,850)?io.addTip("今天已经领取过分享奖励了哦"):ni.dispatch("ACT_WISH_OPEN_SHARE",0,this.skinID);break;case this.imgReward1:if(Ve.send(10055,5,"许愿池-许愿次数-免费"),this.restoreVO){var a=this.restoreVO.items[0];a&&(11==a.state?(L.ins().toGain(this.restoreVO.actID,a.conID),this.reward1Had.visible=!0):(i=ve.getItem(a.items[0].type_id))&&(i.tempNum=a.items[0].num,e=ve.isEquip(i.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(i,e)))}break;case this.imgReward2:if(Ve.send(10055,6,"许愿池-许愿次数-10次"),this.restoreVO){var o=this.restoreVO.items[1];o&&11==o.state?(L.ins().toGain(this.restoreVO.actID,o.conID),this.reward2Had.visible=!0):(i=ve.getItem(o.items[0].type_id))&&(i.tempNum=o.items[0].num,e=ve.isEquip(i.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(i,e))}break;case this.imgReward3:if(Ve.send(10055,7,"许愿池-许愿次数-20次"),this.restoreVO){var r=this.restoreVO.items[2];r&&11==r.state?(L.ins().toGain(this.restoreVO.actID,r.conID),this.reward3Had.visible=!0):(i=ve.getItem(r.items[0].type_id))&&(i.tempNum=r.items[0].num,e=ve.isEquip(i.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(i,e))}break;case this.imgReward4:if(Ve.send(10055,8,"许愿池-许愿次数-30次"),this.restoreVO){var l=this.restoreVO.items[3];l&&11==l.state?(L.ins().toGain(this.restoreVO.actID,l.conID),this.reward4Had.visible=!0):(i=ve.getItem(l.items[0].type_id))&&(i.tempNum=l.items[0].num,e=ve.isEquip(i.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(i,e))}break;case this.imgHelp:$i.ins.showMessage(this.restoreVO.help);break;case this.effSp:(i=0==c.SHOW_EFF_TYPE?ve.getItem(this.randomVO.items[0].rewards[0].type_id):ve.getItem(this.exchangeVO.items[0].products[0].type_id))&&(i.tempNum=this.randomVO.items[0].rewards[0].num,e=ve.isEquip(i.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(i,e));break;case this.imgTip:this.itemArr&&0!=this.itemArr.length||(this.initData(),this.updateChange()),ni.dispatch("ACT_RP_CONTROLLL_VIEW",3,this.itemArr)}},i.toCharge=function(){Ae.linkTo(11454)},i.checkWish=function(t){if(this.spShow.visible=!0,this.eff&&(this.eff.visible=!0),this.spReward.visible=!1,this.consumeVO){var i=this.consumeVO.items[t-1];if(0<i.boxComsumeType){var e,s=Ze.getGoodsNumByType(Ze.GOODS_ID,i.boxItem),n="";if(0==this.skinID?n="莲花":3==this.skinID&&(n="天灯"),s>=i.itemNum)e=pe.span("是否花费","#5d3924")+pe.span(n+"×"+j.divinationTimes[t-1]+"(剩余"+s+"个)","#F7EF5F")+pe.span("进行"+j.divinationTimes[t-1]+"次许愿？","#5d3924"),es.showSecAlert(e,this,this.doWish,[i.conditionId],"actWishViewToWish"+t);else{var h=Vh.isFanTi?pe.span("註：每儲值5仙尊幣，即可獲得","#5d3924"):pe.span("注：每充值50元宝，即可获得","#5d3924");e=pe.span("您的","#5d3924")+pe.span(n+"数量不足","#F7EF5F")+pe.span("，请问是否前往获得？","#5d3924")+"<br/>"+h+pe.span(n+"×1","#F7EF5F"),es.showSecAlert(e,this,this.toCharge,null,"actWishViewAddGold")}}}},i.doWish=function(t){this.initRewardItems(),L.ins().toGain(this.consumeVO.actID,t)},i.initData=function(){if(null!=this.typeID){this.consumeVO=null,this.restoreVO=null,this.randomVO=null,this.rechargeRestoreVO=null,this.exchangeVO=null;for(var t=0;t<this.typeID.length;t++)switch(this.typeID[t]){case 1401:this.need.x=100,this.separator.x=330,this.reward.x=480,this.exchangeVO=G.getActDetailByActID(this.actID[t]);break;case 1402:this.need.x=130,this.separator.x=390,this.reward.x=520,this.exchangeVO=G.getActDetailByActID(this.actID[t]);break;case 2501:this.consumeVO=G.getActDetailByActID(this.actID[t]);break;case 2401:this.restoreVO=G.getActDetailByActID(this.actID[t]);break;case 1501:this.randomVO=G.getActDetailByActID(this.actID[t]);break;case 1009:this.rechargeRestoreVO=G.getActDetailByActID(this.actID[t])}this.exchangeVO?(this.tab.visible=!0,c.SHOW_EFF_TYPE=1):(this.tab.visible=!1,c.SHOW_EFF_TYPE=0)}},i.callBackUpdate=function(){this.initData(),0==this.skinID?this.updateRestoreInfo():this.updateRestoreBar(),this.updateRechargeRestoreInfo(),this.updateLotusNum(),this.updateShareImgSkin(),this.updateChange(),this.updateRp()},i.update=function(){this.initData(),this.updateRp(),this.spWish.visible&&this.updateWish(),this.spChange.visible&&this.updateChange()},i.updateWish=function(){if(this.resetShowItemsSelectedEff(),this.spReward.visible=!1,this.spShow.visible=!0,this.eff.visible=!0,this.updateRandomInfo(),0==this.skinID?this.updateRestoreInfo():this.updateRestoreBar(),this.updateRechargeRestoreInfo(),this.updateLotusNum(),this.imgShare.visible){var t=0;0==this.skinID?t=ws.getRewardTimes(7,850):3==this.skinID&&(t=ws.getRewardTimes(7,851)),0<t?(this.imgShareRP.visible=!1,this.ifShareHasRp=!1):(this.imgShareRP.visible=!0,this.ifShareHasRp=!0)}else this.imgShareRP.visible=!1,this.ifShareHasRp=!1;this.consumeVO&&kt.ins().toRoleActBoxSelfLog(this.consumeVO.actID)},i.updateChange=function(){if(this.exchangeVO){this.itemArr=this.itemArr||[],this.exchangeVO.items.sort(this.memSortFun);for(var t,i=this.exchangeVO.items.length,e=0,s=0;s<i;s++)12!=(t=this.exchangeVO.items[s]).state&&(this.typeID.indexOf(1401)<=-1?this.itemArr[s]=this.itemArr[s]||new m:this.itemArr[s]=this.itemArr[s]||new p,this.itemArr[s].x=0,this.itemArr[s].y=155*e,this.itemArr[s].isWish=!0,this.itemArr[s].data=t,this.itemArr[s].mouseEnabled=!0,this.list.addChild(this.itemArr[s]),e++)}for(var n=[],h=!0,a=0,o=this.itemArr.length;a<o;a++){var r=this.itemArr[a].data.products[0].type_id;if(!(0<=n.indexOf(r))){if(!D.getIsMask(3,r)){h=!1;break}n.push(r)}}D.IS_WISH_ALL_MASK=h,this.updateRp()},i.memSortFun=function(t,i){return t.getTime<t.maxTime&&i.getTime>=i.maxTime?-1:t.getTime>=t.maxTime&&i.getTime<i.maxTime?1:t.state<i.state?1:t.state>i.state?-1:t.conID<i.conID?-1:t.conID>i.conID?1:0},i.updateLotusNum=function(){var t=NaN;0==this.skinID?t=Ze.getGoodsNumByType(Ze.GOODS_ID,10201393):3==this.skinID&&(t=Ze.getGoodsNumByType(Ze.GOODS_ID,10201476)),this.txtNum.text=t+"个"},i.updateShare=function(){this.imgShare.skin="modules/act/wish/skin"+this.skinID+"/shared.png"},i.updateShareImgSkin=function(){var t=0;0==this.skinID?t=ws.getRewardTimes(7,850):3==this.skinID&&(t=ws.getRewardTimes(7,851)),this.imgShare.skin=0<t?"modules/act/wish/skin"+this.skinID+"/shared.png":"modules/act/wish/skin"+this.skinID+"/share.png"},i.updateRechargeRestoreInfo=function(){if(this.rechargeRestoreVO){var t=this.rechargeRestoreVO.items[0];if(t){var i=Vh.isFanTi?Rt.changeGodCoinPrice(t.goldScore):t.goldScore,e=Vh.isFanTi?Rt.changeGodCoinPrice(t.costScore):t.costScore;this.txtCost.text=i+"/"+e,0==this.skinID?this.txtTotal.innerHTML=pe.font("已累计获得","#621e09")+pe.font(t.exchangeTimes+"","#fcf476")+pe.font("个莲花","#621e09"):this.txtTotal.innerHTML=pe.font("已累计获得","#621e09")+pe.font(t.exchangeTimes+"","#fcf476")+pe.font("个天灯","#621e09")}this.txtDesc.innerHTML=pe.span(this.rechargeRestoreVO.desc,"#621e09",24),De.addToSecond(this,this.timeLoop)}},i.updateRandomInfo=function(){if(this.randomVO&&this.randomVO.items){var t;if(1==c.SHOW_EFF_TYPE){if(this.exchangeVO){var i=this.exchangeVO.items[0].products[0];(t=G.getActEffsVOByItemID(i.type_id))&&this.eff.loadAndPlay(t.effPath,t.action,t.dir,0<t.isLoop)}}else if(0==c.SHOW_EFF_TYPE){var e=this.randomVO.items[0].rewards[0];(t=G.getActEffsVOByItemID(e.type_id))&&this.eff.loadAndPlay(t.effPath,t.action,t.dir,0<t.isLoop)}for(var s,n=this.showItems.length,h=1,a=this.randomVO.items.length;h<a;h++)s=this.randomVO.items[h].rewards[0],h<=n&&(this.showItems[h-1].dataSource={typeID:s.type_id,num:s.num})}},i.updateRestoreInfo=function(){if(this.spScheduleCom.visible=!0,this.spScheduleSkin.visible=!1,this.restoreVO){for(var t,i=0;i<4;i++)if(t=this.restoreVO.items[i])switch(this["resTime"+i].text=0<t.needNum?t.needNum+"次":"赠送",t.state){case 11:this["imgReward"+(i+1)].skin="modules/act/wish/flowerLight.png",this["imgRP"+(i+1)].visible=!0,this["reward"+(i+1)+"Had"].visible=!1;break;case 22:this["imgReward"+(i+1)].skin="modules/act/wish/flower.png",this["imgRP"+(i+1)].visible=!1,this["reward"+(i+1)+"Had"].visible=!0;break;default:this["imgReward"+(i+1)].skin="modules/act/wish/flower.png",this["imgRP"+(i+1)].visible=!1,this["reward"+(i+1)+"Had"].visible=!1}for(var e=0;e<4;e++)if(1==this["imgRP"+(e+1)].visible)return void(this.ifBarHasRp=!0);this.ifBarHasRp=!1}},i.updateRp=function(){if(0==this.tab.visible)this.wishRp.visible=!1,this.changeRp.visible=!1,N.hasRp=!1;else{if(this.ifBarHasRp||this.ifShareHasRp?this.wishRp.visible=!0:this.wishRp.visible=!1,this.checkExchangeRP()){if(this.changeRp.visible=!0,D.IS_WISH_ALL_MASK)this.changeRp.visible=!1;else if(this.itemArr){for(var t=!0,i=0,e=this.itemArr.length;i<e;i++){var s=this.itemArr[i].data;if(11==s.state){var n=s.products[0].type_id;if(!D.getIsMask(3,n)){t=!1;break}}}t&&(this.changeRp.visible=!1)}}else this.changeRp.visible=!1;this.wishRp.visible||this.changeRp.visible?N.hasRp=!0:N.hasRp=!1}},i.checkExchangeRP=function(){var t;if(this.exchangeVO)for(var i in this.exchangeVO.items)if((t=this.exchangeVO.items[i]).getTime<t.maxTime){var e=t.materials[0];if(Ze.getGoodsNumByTypeID(e.type_id)>=e.num&&12!=t.state)return!0}return!1},i.updateRestoreBar=function(){if(this.spScheduleCom.visible=!1,this.spScheduleSkin.visible=!0,this.imgBar.width=0,this.restoreVO){var t;this.goodsImages=this.goodsImages||[],(t=this.restoreVO.items[this.restoreVO.items.length-1])&&(this.maxSchedule=t.needNum);var i=0;i=this.restoreVO.items?this.restoreVO.items.length:5;for(var e=this.barMaxLen/i,s=0;s<i;s++){var n,h=this.restoreVO.items[s];switch(this.goodsImages[s]=this.goodsImages[s]||new ae(null,!1,!0,90,!1),(n=this.goodsImages[s]).name="goodsImage"+s,n.pivot(45,45),n.y=60,n.scale(this.scaleArr[s],this.scaleArr[s]),this["imgHas"+s].pivot(26,25),h.state){case 11:this["imgRedPoint"+s].visible=!0,this["imgHas"+s].visible=!1;break;case 22:this["imgRedPoint"+s].visible=!1,this["imgHas"+s].visible=!0;break;default:this["imgRedPoint"+s].visible=!1,this["imgHas"+s].visible=!1}null==n.parent&&(this.spGoods.addChild(n),n.on("click",this,this.onClickGoodsImage));var a=h.items[0];n.data=ve.getItem(a.type_id),h&&(this["resTimes"+s].text=h.needNum+"次",n.x=(s+1)*e,this["resTimes"+s].x=(s+1)*e-this["resTimes"+s].width/2,this["imgHas"+s].x=n.x,this["imgRedPoint"+s].x=n.x+n.width*this.scaleArr[s]-45)}for(var o=0;o<i;o++)if(1==this["imgRedPoint"+o].visible)return void(this.ifBarHasRp=!0);this.ifBarHasRp=!1}},i.onClickGoodsImage=function(t){var i=t.target;if(i){var e=parseInt(i.name.substr(-1,1));if(this.restoreVO){var s=this.restoreVO.items[e];if(s)if(11==s.state)L.ins().toGain(this.restoreVO.actID,s.conID);else{var n,h=ve.getItem(s.items[0].type_id);h&&(h.tempNum=s.items[0].num,n=ve.isEquip(h.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(h,n))}}}},i.showBoxLogInfoImgs=function(){this.consumeVO&&(kt.ins().createCheckShowIcon(1,10001,this.spWish,580,192,this.consumeVO.actID),kt.ins().createCheckShowIcon(2,10001,this.spWish,580,236,this.consumeVO.actID))},i.showViewByIndex=function(t){void 0===t&&(t=0),this.tab.selectedIndex=t},o(0,i,"typeID",function(){return this._typeID},function(t){this._typeID=t}),o(0,i,"actID",function(){return this._actID},function(t){this._actID=t}),o(0,i,"skinID",function(){return this._skinID},function(t){this._skinID=t,this.imgBg.skin="modules/act/wish/skin"+t+"/bg.png",this.imgNum.skin="modules/act/wish/skin"+t+"/lotusSmall.png",this.imgShare.skin="modules/act/wish/skin"+t+"/share.png",this.imgBig.skin="modules/act/wish/skin"+t+"/lotusBig.png",this.imgShowBg1.skin="modules/act/wish/skin"+t+"/lotusLittle.png",this.imgShowBg2.skin="modules/act/wish/skin"+t+"/lotusLittle.png",this.imgShowBg3.skin="modules/act/wish/skin"+t+"/lotusLittle.png",this.imgShowBg4.skin="modules/act/wish/skin"+t+"/lotusLittle.png",this.imgShowBg5.skin="modules/act/wish/skin"+t+"/lotusLittle.png",this.imgShowBg6.skin="modules/act/wish/skin"+t+"/lotusLittle.png",this.imgCost1.skin="modules/act/wish/skin"+t+"/lotusSmall.png",this.imgCost2.skin="modules/act/wish/skin"+t+"/lotusSmall.png",0==t?(this.imgShowBg1.pos(this.imgShowBgPos1[0][0],this.imgShowBgPos1[0][1]),this.imgShowBg2.pos(this.imgShowBgPos1[1][0],this.imgShowBgPos1[1][1]),this.imgShowBg3.pos(this.imgShowBgPos1[2][0],this.imgShowBgPos1[2][1]),this.imgShowBg4.pos(this.imgShowBgPos1[3][0],this.imgShowBgPos1[3][1]),this.imgShowBg5.pos(this.imgShowBgPos1[4][0],this.imgShowBgPos1[4][1]),this.imgShowBg6.pos(this.imgShowBgPos1[5][0],this.imgShowBgPos1[5][1]),this.btnOne.label="开始许愿",this.btnTen.label="许愿十次"):(this.imgShowBg1.pos(this.imgShowBgPos2[0][0],this.imgShowBgPos2[0][1]),this.imgShowBg2.pos(this.imgShowBgPos2[1][0],this.imgShowBgPos2[1][1]),this.imgShowBg3.pos(this.imgShowBgPos2[2][0],this.imgShowBgPos2[2][1]),this.imgShowBg4.pos(this.imgShowBgPos2[3][0],this.imgShowBgPos2[3][1]),this.imgShowBg5.pos(this.imgShowBgPos2[4][0],this.imgShowBgPos2[4][1]),this.imgShowBg6.pos(this.imgShowBgPos2[5][0],this.imgShowBgPos2[5][1]),this.btnOne.label="开始祈福",this.btnTen.label="祈福十次")}),o(0,i,"iconID",function(){return this._iconID},function(t){this._iconID=t}),c.SHOW_EFF_TYPE=1}(),function(t){function i(){this.records=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.tab.selectedIndex=0,this.tab.on("change",this,this.onTabChange),this.list.vScrollBarSkin="",this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.records=[]}l(i,"modules.activity.yunyou.YunyouRecordView",Yo);var e=i.prototype;e.onDisplay=function(){this.tab.selectedIndex=0,Ko.getInstance().toGetRecordAll(M.getInstance().yunYouID)},e.update=function(){for(;0<this.records.length;)(i=this.records.shift()).parent.removeChild(i);var t=qo.getInfo(this.tab.selectedIndex);if(null!=t)for(var i,e=3,s=0;s<t.length;s++)(i=this.createRecord(t[s])).x=5,i.y=e,e+=i.contextHeight+5,this.list.addChild(i),this.records.push(i)},e.createRecord=function(t){var i,e=new ce;if(e.style.fontSize=26,e.color="#5D3924",e.style.lineHeight=30,e.width=590,"p_koi_log"==t.className)i=ve.getItem(t.type_id),1==t.type?e.innerHTML="玩家"+t.name+"购买获得"+pe.span("【"+i.name+"】",Qi.getColorLight(i.color))+"×"+t.num:2==t.type?e.innerHTML="第"+t.round+"轮活动最终大奖"+pe.span("【"+i.name+"】",Qi.getColorLight(i.color))+",由"+t.name+"获得":3==t.type&&(e.innerHTML="第"+t.round+"轮活动最终锦鲤大奖"+pe.span("【"+i.name+"】",Qi.getColorLight(i.color))+",由于参与人数不足，无法激活最终大奖");else if("p_ts_item"==t.className){var s=t.items[0];i=ve.getItem(s.id),e.innerHTML="购买获得"+pe.span("【"+i.name+"】",Qi.getColorLight(i.color))+"×"+s.val}return e.height=e.contextHeight,e},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow()}},e.onTabChange=function(){0==this.tab.selectedIndex?Ko.getInstance().toGetRecordAll(M.getInstance().yunYouID):Ko.getInstance().toGetRecordSelf(M.getInstance().yunYouID)}}(),function(t){function m(){this._typeIDs=[],this._actIDs=[],this._iconID=0,this._skinId=0,this.mainVO=null,m.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick),this.txtLink.underline=!0,this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),an.register("RP_YUNYOU",this.btnOne,new Hs(20,-10))}l(m,"modules.activity.yunyou.YunyouView",Xo);var i=m.prototype;s.imps(i,{"modules.activity.IActivityView":!0}),i.onDisplay=function(){0<this.actID[0]&&L.ins().toActDetail(this.actID[0])},i.onUnDisplay=function(){De.removeFromSceond(this,this.updateTime)},i.updateTime=function(){if(this.mainVO)if(this.mainVO.endTime>Ma.serverTime){var t=this.mainVO.startTime+this.mainVO.curRound*this.mainVO.timePerRound*60;if(t>Ma.serverTime){var i=Qt.formatDHMSArrInt(t-Ma.serverTime),e=0<24*i[0]+i[1]?24*i[0]+i[1]<10?"0"+(24*i[0]+i[1])+":":24*i[0]+i[1]+":":"",s=i[2]<10?"0"+i[2]+":":i[2]+":",n=i[3]<10?"0"+i[3]:i[3]+"";this.mainVO.totalBuyTimes<this.mainVO.maxRewardValue?this.limitTime.text="开奖倒计时："+e+s+n:this.mainVO.endTime>Ma.serverTime+60*this.mainVO.timePerRound?this.limitTime.text="下一轮倒计时："+e+s+n:(this.limitTime.text="活动已结束",De.removeFromSceond(this,this.updateTime))}else L.ins().toActDetail(this.actID[0])}else this.limitTime.text="活动已结束",De.removeFromSceond(this,this.updateTime)},i.onClick=function(t){switch(t.target){case this.help:this.mainVO&&$i.ins.showMessage(this.mainVO.rule);break;case this.close:this.closeWindow();break;case this.txtLink:Ko.getInstance().openRecordView();break;case this.btnOne:Ko.getInstance().openAlert([this.mainVO,this.actID]);break;case this.btnTen:this.toBuyTen()}},i.toBuyTen=function(){var i=this;if(this.mainVO){var e,s;for(var t in this.mainVO.info)if((s=this.mainVO.info[t]).costTypeID==m.gold&&1!=s.costTime){e=s;break}if(0==function(){var t=0;t=0<oo.curLv?i.mainVO.buyTimesVip-e.buyTimes:i.mainVO.buyTimesCommon-e.buyTimes;if(t>=s.costTime)return!0;i.mainVO.maxRewardValue-i.mainVO.totalBuyTimes<10?io.addTip("全服购买次数不足十次，请更换购买方式"):io.addTip("购买次数不足，请更换购买形式");return!1}());else if(ie.gold<e.cost)es.showAlert();else{var n="是否消耗"+pe.span(e.cost+"元宝","#fbd815")+"进行"+s.costTime+"连抽奖？";es.showSecAlert(n,L.ins(),L.ins().toGain,[this.actID[0],e.conID],"yunyou.gold")}}},i.update=function(){if(this.mainVO=G.getActDetailByActID(this.actID[0]),this.mainVO){var t,i,e,s=new oe(91,100,!1,!0,!0),n=ve.getItem(this.mainVO.luckyItem.id);s.dataSource=n,s.num=this.mainVO.luckyItem.val,s.hideGoodsName(),s.x=-40,this.bigReward.removeChildren(),this.bigReward.addChild(s),this.bigName.text=n.name,this.bigName.color=Qi.getColorLight(n.color),this.reward.removeChildren();var h=0;h=5==this.mainVO.randomItems.length?-90:-50;for(var a=0;a<this.mainVO.randomItems.length;a++)e=this.mainVO.randomItems[a],i=ve.getItem(e.id),(t=new oe(91,100,!1,!0,!0)).x=95*a+h,t.dataSource=i,t.num=e.val,t.hideGoodsName(),this.reward.addChild(t);this.numTxt.text=this.mainVO.totalBuyTimes+"/"+this.mainVO.maxRewardValue;var o=this.mainVO.totalBuyTimes/this.mainVO.maxRewardValue;this.bar.width=260*(1<o?1:o);var r=0<oo.curLv?this.mainVO.buyTimesVip:this.mainVO.buyTimesCommon,l=0;for(var c in this.mainVO.info)if((d=this.mainVO.info[c]).costTypeID==m.gold&&1!=d.costTime){l=d.buyTimes;break}if(this.txtLimitBuy.text=r>=this.mainVO.maxRewardValue?"":"限购"+l+"/"+r,De.addToSecond(this,this.updateTime),0<Ze.getGoodsNumByTypeID(m.jinLiFu)&&this.mainVO.totalBuyTimes<this.mainVO.maxRewardValue?an.show("RP_YUNYOU"):an.hide("RP_YUNYOU"),this.mainVO.totalBuyTimes>=this.mainVO.maxRewardValue)this.btnOne.mouseEnabled=!1,this.btnOne.gray=!0,this.btnTen.mouseEnabled=!1,this.btnTen.gray=!0;else{var d,u;for(var p in this.mainVO.info)if((u=this.mainVO.info[p]).costTypeID==m.gold&&1!=u.costTime){d=u;break}0<oo.curLv&&d.buyTimes>=this.mainVO.buyTimesVip||oo.curLv<=0&&d.buyTimes>=this.mainVO.buyTimesCommon?(this.btnTen.mouseEnabled=!1,this.btnTen.gray=!0,this.btnOne.mouseEnabled=!0,this.btnOne.gray=!1):(this.btnOne.mouseEnabled=!0,this.btnOne.gray=!1,this.btnTen.mouseEnabled=!0,this.btnTen.gray=!1)}}},i.callBackUpdate=function(){this.update()},o(0,i,"typeID",function(){return this._typeIDs},function(t){this._typeIDs=t}),o(0,i,"actID",function(){return this._actIDs},function(t){this._actIDs=t,G.registerActCBFunc(this.actID[0],this,this.callBackUpdate)}),o(0,i,"skinID",function(){return this._skinId},function(t){this._skinId=t}),o(0,i,"iconID",function(){return this._iconID},function(t){this._iconID=t}),m.jinLiFu=10201867,m.gold=10201425}(),function(t){function i(){this.snatchView=null,this.encounterView=null,this.soloRankingView=null,this.petSportView=null,i.__super.call(this)}l(i,"modules.athletics.AthleticsPanel",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL"),this.btnClose.on("click",this,this.closeWindow),this.btnBack.on("click",this,this.closeWindow),this.tab.selectHandler=new ue(this,this.onSelect),this.tab.itemClickFun=new ue(this,this.onItemClick),this.tab.labels="遭遇战,天梯赛,元婴修炼,仙宠竞技",an.register("RP_ATHLETICS_ENCOUNTER",this.tab.items[0],new Hs(19,-10)),an.register("RP_ATHLETICS_SOLORANKING",this.tab.items[1],new Hs(19,-10)),an.register("RP_ATHLETICS_SOLORANKING_REWARD",this.tab.items[1],new Hs(19,-10)),an.register("RP_ATHLETICS_SNATCH",this.tab.items[2],new Hs(19,-10)),an.register("RP_ATHLETICS_SNATCH_LOG",this.tab.items[2],new Hs(19,-10)),an.register("RP_PET_SPORTS_CAN_GET3",this.tab.items[3],new Hs(19,-10)),an.register("RP_PET_SPORTS_CAN_GET5",this.tab.items[3],new Hs(19,-10)),an.register("RP_PET_SPORTS_CAN_CHALLENGE",this.tab.items[3],new Hs(19,-10))},e.onItemClick=function(t){switch(t){case 0:this.tab.selectedIndex=t,Ve.send(109,1,"竞技-遭遇战");break;case 1:0==Xi.isOpenSoloRanking()?io.addTip("该功能80级开放"):this.tab.selectedIndex=t;break;case 2:Ve.send(111,1,"竞技-元婴修炼"),0==Xi.isOpenSnatch()?io.addTip("该功能"+pa.snatchOpenLevel+"级开放"):this.tab.selectedIndex=t;break;case 3:Xi.isOpenPetSports()?this.tab.selectedIndex=t:io.addTip("仙宠竞技功能2转开放")}},e.onSelect=function(t){switch(t){case 0:this.showEncounterView();break;case 1:this.showSoloRankingView();break;case 2:this.showSnatchView();break;case 3:this.showPetSportsView()}},e.showPetSportsView=function(){no.has("modules/petSports")?(this.encounterView&&this.encounterView.removeSelf(),this.snatchView&&this.snatchView.removeSelf(),this.soloRankingView&&this.soloRankingView.removeSelf(),this.petSportView=this.petSportView||Na.getIns(3e3,"petSports.PetSportsView"),null==this.petSportView.parent&&this.spFir.addChild(this.petSportView),cs.ins.toPetArenaInfo()):no.add("modules/petSports","正在加载仙宠竞技资源",this,this.showPetSportsView)},e.showSoloRankingView=function(){this.encounterView&&this.encounterView.removeSelf(),this.snatchView&&this.snatchView.removeSelf(),this.petSportView&&this.petSportView.removeSelf(),this.soloRankingView=this.soloRankingView||Na.getIns(3e3,"soloRanking.SoloRankingView"),null==this.soloRankingView.parent&&this.spFir.addChild(this.soloRankingView),ma.getInstance().toSoloDetail()},e.showEncounterView=function(){this.snatchView&&this.snatchView.removeSelf(),this.soloRankingView&&this.soloRankingView.removeSelf(),this.petSportView&&this.petSportView.removeSelf(),this.encounterView=this.encounterView||Na.getIns(3e3,"encounter.EncounterMainView"),null==this.encounterView.parent&&this.spFir.addChild(this.encounterView),this.encounterView.visible=!0,this.encounterView.update()},e.showSnatchView=function(){this.encounterView&&this.encounterView.removeSelf(),this.soloRankingView&&this.soloRankingView.removeSelf(),this.petSportView&&this.petSportView.removeSelf(),this.snatchView=this.snatchView||new ua,null==this.snatchView.parent&&this.spFir.addChild(this.snatchView),da.getInstance().toDetail()},e.showViewByIndex=function(t){switch(void 0===t&&(t=0),t){case 0:Ve.send(109,1,"竞技-遭遇战"),0==Xi.isOpenEncounter()?io.addTip("该功能80级开放"):this.tab.selectedIndex=t;break;case 1:0==Xi.isOpenSoloRanking()?io.addTip("该功能80级开放"):this.tab.selectedIndex=t;break;case 2:Ve.send(111,1,"竞技-元婴修炼"),0==Xi.isOpenSnatch()?io.addTip("该功能"+pa.snatchOpenLevel+"级开放"):this.tab.selectedIndex=t;break;case 3:0==Xi.isOpenPetSports()?io.addTip("仙宠竞技2转开启"):this.tab.selectedIndex=t}},e.getTabIndex=function(){return this.tab.selectedIndex},e.updateCurView=function(){this.encounterView&&this.encounterView.parent&&this.encounterView.update(),this.snatchView&&this.snatchView.parent&&this.snatchView.update(),this.soloRankingView&&this.soloRankingView.parent&&this.soloRankingView.update(),this.petSportView&&this.petSportView.parent&&this.petSportView.update()},e.onResize=function(){0==ie.isVertical?(this.bg.left=NaN,this.bg.right=NaN,this.bg.width=750,this.bg.centerX=0):(this.bg.width=NaN,this.bg.centerX=NaN,this.bg.left=0,this.bg.right=0)}}(Y),function(t){function i(){this._txtNameOriginX=NaN,this._data=null,this._blueVipBox=null,i.__super.call(this),this._txtNameOriginX=this.txtName.x}l(i,"modules.athletics.encounter.EncounterItem",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.btnEnc.on("click",this,this.onDown)},e.onDown=function(){Be.isMainMap()?0==fi.state||2!=fi.state&&fi.targetID==this._data.role_id?(fi.state=1,fi.targetID=this._data.role_id,li.getInstance().gotoFight(this._data),Ho.closeAllWindow()):io.addTip("正在挑战遭遇战事件"):(fi.state=0,io.addTip("副本中无法进行遭遇战"))},e.updateBlueVip=function(t){if(Vh.isQQyxdt()){this.txtName.x=this._txtNameOriginX,this._blueVipBox=this._blueVipBox||new mt,this.addChild(this._blueVipBox);var i=new ft;i.blueInfo=t,i.pos=new Hs(this.txtName.x,this.txtName.y),this._blueVipBox.updateShowing(i),this.txtName.x=this._txtNameOriginX+this._blueVipBox.width}},o(0,e,"date",null,function(t){this._data=t,this.imgHead.skin="com/head/big"+t.category+t.sex+".png",this.txtName.text=t.role_name;var i,e="";for(var s in 0<t.regrow&&(e+=t.regrow+"转"),e+=t.level+"级",this.txtLv.text=e,this.txtLv.x=316<=this.txtName.x+this.txtName.textWidth?this.txtName.x+this.txtName.textWidth+10:316,t.reward)switch((i=t.reward[s]).type){case 3:this.txtExp.text=""+i.val;break;case 2:this.txtCopper.text=""+i.val;break;case 4:this.txtRaiqi.text=""+i.val}this.updateBlueVip(t.blue_vip)})}(ci),function(t){function i(){this._date=null,this._rewardArr=null,i.__super.call(this)}l(i,"modules.athletics.encounter.EncounterLogItem",di);var e=i.prototype;e.filterFun=function(t){return 5!=t.type},o(0,e,"date",null,function(t){if(this._date=t){1==t.result?this.imgRes.skin="modules/athletics/win.png":this.imgRes.skin="modules/athletics/lost.png",this.txtName.text=t.role_name,this.txtTime.text=Qt.format(t.ts),t.reward=t.reward.filter(this.filterFun),this._rewardArr=this._rewardArr||[];for(var i,e,s,n=Math.max(t.reward.length,this._rewardArr.length),h=0;h<n;h++)h<t.reward.length?(i=t.reward[h],e=ve.getRewardByTkv(i),this._rewardArr[h]=this._rewardArr[h]||new ae(e,!1,!0,80,!0),this._rewardArr[h].num=i.val,(s=this._rewardArr[h]).x=93*h+140,s.y=48,this.addChild(s)):this._rewardArr[h]&&this._rewardArr[h].parent&&this.removeChild(this._rewardArr[h])}})}(),function(t){function i(){this.itemArr=null,i.__super.call(this)}l(i,"modules.athletics.encounter.EncounterLogPanel",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onDown),this.plitem.vScrollBar.autoHide=!0},e.onDown=function(t){switch(t.target){case this.btnClose2:case this.btnClose:this.closeWindow()}},e.updateView=function(){var t;this.itemArr=this.itemArr||[];var i=fi.getLogArr();if(i)for(var e=(i=i.slice(0,10)).length>this.itemArr.length?i.length:this.itemArr.length,s=0;s<e;s++)s<i.length?(this.itemArr[s]=this.itemArr[s]||Na.getIns(3e3,"encounter.EncounterLogItem"),(t=this.itemArr[s]).date=i[s],t.y=150*s,t.x=3,this.plitem.addChild(t)):this.itemArr[s]&&this.itemArr[s].parent&&this.itemArr[s].removeSelf()}}(pi),function(t){function i(){this.itemArr=null,this.waitItem=null,i.__super.call(this),this.txtLook.underline=!0,this.txtRec.underline=!0,this.on("click",this,this.onDown),this.on("display",this,this.onDisplay)}l(i,"modules.athletics.encounter.EncounterMainView",mi);var e=i.prototype;e.onDisplay=function(){ni.register("UPDATE_ENCOUNTER_RANKINFO",this,this.updateRankInfo),this.on("undisplay",this,this.onUNDisplay)},e.onUNDisplay=function(){ni.remove("UPDATE_ENCOUNTER_RANKINFO",this,this.updateRankInfo),this.off("undisplay",this,this.onUNDisplay)},e.updateRankInfo=function(){var t,i=fi.getEncounterRankInfo();if(i)for(var e in this.txtScore.text=""+i.pk_point,0<i.rank_num?this.txtRank.text="（"+i.rank_num+"名）":this.txtRank.text="（未上榜）",i.reward)switch((t=i.reward[e]).type){case 2:this.txtCopper.text=""+t.val;break;case 4:this.txtReiki.text=""+t.val}this.txtRank.x=this.txtScore.x+this.txtScore.textWidth},e.onDown=function(t){switch(t.target){case this.txtLook:Ve.send(109,2,"竞技-遭遇战-排行榜"),Ae.linkTo(10704);break;case this.txtRec:Ve.send(109,3,"竞技-遭遇战-查看记录"),ni.dispatch("OPEN_ENCOUNTLOG_PANEL")}},e.update=function(){this.itemArr=this.itemArr||[];var t,i=fi.getFightRoleArrs(),e=(fi.getColdDown(),0);for(e=0;e<4;e++)i&&i.length>e?(this.itemArr[e]=this.itemArr[e]||Na.getIns(3e3,"encounter.EncounterItem"),(t=this.itemArr[e]).date=i[e],t.x=6,t.y=140*e+10,this.spItem.addChild(t)):this.itemArr[e]&&this.itemArr[e].parent&&this.itemArr[e].removeSelf();var s=i?i.length:0;s<4?(this.waitItem=this.waitItem||Na.getIns(3e3,"encounter.EncounterWaitItem"),this.waitItem.y=140*s+10,this.waitItem.parent||(this.waitItem.x=6,this.spItem.addChild(this.waitItem))):this.waitItem&&this.waitItem.parent&&this.waitItem.removeSelf(),this.waitItem&&this.waitItem.parent&&(this.waitItem.btnSear.visible=fi.getSearchTimes()<100)}}(),function(t){function i(){i.__super.call(this)}l(i,"modules.athletics.encounter.EncounterWaitItem",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.on("display",this,this.onDisplay),this.btnSear.on("click",this,this.onDown)},e.onDown=function(){var t=new q;t.title="温馨提示",t.msg=pe.span("确认消费","#5d3924",26)+pe.span("10元宝","#fff959",26)+pe.span("立即寻找一名附近练级的玩家作为自己的遭遇战对手？","#5d3924",26)+"<br/>"+pe.span("今日已主动寻敌：","#5d3924",26)+pe.span(fi.getSearchTimes()+"/100","#139604",26)+pe.span("次","#5d3924",26),t.yesFun=li.getInstance().toEncounterSearch,t.yesCaller=li.getInstance(),K.showVO(t)},e.onDisplay=function(){this.updateTime(),De.addToSecond(this,this.updateTime),this.on("undisplay",this,this.unDisplay)},e.unDisplay=function(){De.removeFromSceond(this,this.updateTime),this.off("undisplay",this,this.unDisplay)},e.updateTime=function(){this.txtTime.text=Qt.formatMS2(fi.getColdDown(),Ma.serverTime)}}(gi),function(t){function i(){this.TYPE_NOTIP=1,this.TYPE_TIP=2,this.TYPE_MONEY=3,this.goods=null,this.curVO=null,i.__super.call(this),this.goods=this.goods||new ae(null,!0,!0,105,!0),this.goods.mouseEnabled=!0,this.goods.pos(24,20),this.addChild(this.goods),this.on("click",this,this.onClick)}l(i,"modules.athletics.petSports.PetSportsChangeItem",ds);var e=i.prototype;e.onClick=function(t){var i=this;switch(t.target){case this.btnChange:var e,s;if(this.curVO)if(this.curVO.type==this.TYPE_MONEY){var n=Ci.getChargeBackVO(this.curVO.exchangeID),h=n?n.money:this.curVO.pay1;(s=ve.getItem(this.curVO.goodsID))&&(e=new q,Vh.isFanTi?(e.msg="是否花费"+h+"仙尊幣购买"+pe.font(s.name+"×"+this.curVO.goodsNum,Qi.getColorLight(s.color)),e.yesFun=function(){Ai.ins().toExchange(i.curVO.exchangeID)}):(e.msg=Vh.isXianLai?"是否花费"+10*h+"钻石购买"+pe.font(s.name+"×"+this.curVO.goodsNum,Qi.getColorLight(s.color)):"是否花费"+h+"元购买"+pe.font(s.name+"×"+this.curVO.goodsNum,Qi.getColorLight(s.color)),e.yesFun=function(){Ai.ins().toPay(i.curVO.exchangeID),Ne.isWX&&Ve.send(10035,2,"直购-"+s.name)}),e.yesCaller=this,K.showVO(e))}else{var a=ie.getScore(20),o=ie.getScore(21);if(a<this.curVO.pay1)return void io.addTip("功勋币不足");if(o<this.curVO.pay2)return void io.addTip("竞技币不足");(e=new q).msg="是否花费",0<this.curVO.pay1&&(e.msg+=this.curVO.pay1+"功勋币"),0<this.curVO.pay2&&(0<this.curVO.pay1&&(e.msg+="和"),e.msg+=this.curVO.pay2+"竞技币"),(s=ve.getItem(this.curVO.goodsID))&&(e.msg+="购买"+this.curVO.goodsNum+"个"+pe.font(s.name,Qi.getColorLight(s.color)),e.yesFun=rh.ins().toExchange,e.yesCaller=rh.ins(),e.yesArgs=[20,this.curVO.exchangeID,1],e.key="PetSportsChangeItem.btnChange",K.showVO(e))}break;case this.goods:if(this.curVO){var r=ve.getItem(this.curVO.goodsID);r.tempNum=this.curVO.goodsNum;var l="";l=ve.isEquip(r.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(r,l)}}},e.update=function(){if(this.curVO){var t=ve.getItem(this.curVO.goodsID);this.goods.data=t,this.goods.num=this.curVO.goodsNum,this.txtName.text=t.name,this.txtName.color=Qi.getColorLight(t.color);var i=0;0<this.curVO.pay1?(this.sp1.visible=!0,this.sp1.x=150+135*i,this.txt1.text=this.curVO.pay1+"",++i):this.sp1.visible=!1,0<this.curVO.pay2?(this.sp2.visible=!0,this.sp2.x=150+135*i,this.txt2.text=this.curVO.pay2+""):this.sp2.visible=!1;var e=0,s=0,n=!1;switch(this.curVO.type){case this.TYPE_NOTIP:this.txtTip.visible=!1,this.txtMoney.visible=!1,n=!(this.imgGodCoin.visible=!1);break;case this.TYPE_TIP:this.txtTip.visible=!0,this.txtMoney.visible=!1,this.imgGodCoin.visible=!1;var h=oh.getExchangeVOById(this.curVO.exchangeID);h?(n=h.val<this.curVO.maxTime,e=h.val):n=!0,s=this.curVO.maxTime;break;case this.TYPE_MONEY:this.txtTip.visible=!0,this.txtMoney.visible=!0,this.imgGodCoin.visible=!0,_s.buyGiftInfo?(e=this.curVO.maxTime-_s.buyGiftInfo.remaining_num,n=0<_s.buyGiftInfo.remaining_num):(n=!1,e=this.curVO.maxTime),s=this.curVO.maxTime,this.sp1.visible=this.sp2.visible=!1}this.txtTip.text=this.curVO.tip+e+"/"+s,this.btnChange.label=this.curVO.btnLabel,this.btnChange.visible=n,this.imgNon.visible=!n;var a=Ci.getChargeBackVO(this.curVO.exchangeID),o=this.curVO.type==this.TYPE_MONEY&&a?a.money:this.curVO.pay1;Vh.isFanTi?this.txtMoney.text=o+"仙尊幣":this.txtMoney.text=o+"元",this.imgGodCoin.visible=!1}},o(0,e,"data",null,function(t){this.curVO=t,this.update()})}(),function(t){function i(){this._data=null,i.__super.call(this),this._checkBtn.on("click",this,this.onCheck)}l(i,"modules.athletics.petSports.PetSportsGlobalLogItem",ps);var e=i.prototype;e.onCheck=function(t){this._data&&(_s.deletePetArenaChangeRes(this._data.pet_fight_log_id),as.ins().toFightInfoREC(this._data.pet_fight_log_id))},o(0,e,"data",null,function(t){if(this._data=t,this._data){this._leftIconImg.skin="com/head/small"+t.role_category_1+t.role_sex_1+".png",this._rightIconImg.skin="com/head/small"+t.role_category_2+t.role_sex_2+".png",this._leftNameTxt.text=t.role_name_1,this._rightNameTxt.text=t.role_name_2;var i=t.role_name_1==t.win_role_name?this._leftIconImg:this._rightIconImg;this._winImg.x=i.x-13,this._winImg.y=i.y-5}})}(),function(t){function i(){this.blueVip=null,this.blueYear=null,this._data=null,i.__super.call(this),this.blueVip=this.blueVip||new ge,this.blueYear=this.blueYear||new ge,this.blueVip.visible=this.blueYear.visible=!1,this.addChild(this.blueVip),this.addChild(this.blueYear),this.hitArea=this.hitArea||new hn(10,5,203,242),this.on("click",this,this.onClick)}l(i,"modules.athletics.petSports.PetSportsItem",ms);var e=i.prototype;e.onClick=function(){if(this._data){var t=_s.getPetArenaInfo();if(t&&t.remaining_challenge_times<=0)return void io.addTip("挑战次数不足");ni.dispatch("OPEN_PETSPORTS_SET_VIEW",0),ni.dispatch("UPDATE_PETSPORTS_SET_VIEW",this._data),cs.ins.toPetArenaOppenentPets(this._data.role_id)}else io.addTip("对手数据没有初始化")},e.updateBlueVip=function(t){0!=pt.ins().showVipByString(t,this.blueVip,this.blueYear,51,this.txtName.y-5)&&(this.txtName.x=51)},o(0,e,"data",function(){return this._data},function(t){this._data=t,this._data&&(this.txtName.text=t.role_name,this.txtPow.text=te.getShortenPowerStr(t.embattle_power),this.txtRank.text=t.ranking+"",this.imgHead.skin="com/head/"+t.category+t.sex+".png",this.txtR.x=(223-this.txtR.textWidth-this.txtRank.textWidth)/2,this.txtRank.x=this.txtR.x+this.txtR.textWidth,this.txtP.x=(223-this.txtP.textWidth-this.txtPow.textWidth)/2,this.txtPow.x=this.txtP.x+this.txtP.textWidth,this.updateBlueVip(t.blue_vip))})}(),function(t){function i(){this.items=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.btnClose2.on("click",this,this.closeWindow),this.btnClose.on("click",this,this.closeWindow)}l(i,"modules.athletics.petSports.PetSportsRankView",ss);var e=i.prototype;e.update=function(){var t=_s.getPetArenaRanks();if(t){var i,e=t.ranks;e.sort(this.sortFun),this.items=this.items||[];for(var s=Math.max(this.items.length,e.length),n=0;n<s;n++)n<e.length?(this.items[n]=this.items[n]||Na.getIns(3e3,"petSports.PetSportsRankItem"),(i=this.items[n]).data=e[n],i.pos(0,115*n),this.pan.addChild(i)):this.items[n]&&this.items[n].parent&&this.items[n].removeSelf();0<t.my_ranking?this.txtRank.text=""+t.my_ranking:this.txtRank.text="暂无排名"}},e.sortFun=function(t,i){return t.ranking<i.ranking?-1:1},o(0,e,"uiClass",function(){return"PerSportsRankView"})}(),function(t){function i(){this._data=null,i.__super.call(this)}l(i,"modules.athletics.petSports.PetSportsLogItem",fs),o(0,i.prototype,"data",null,function(t){this._data=t,this._data&&(this._data.opponent&&(this.imgHead.skin="com/head/big"+this._data.opponent.category+this._data.opponent.sex+".png"),this.imgRank.visible=2!=t.ranking_type,this.imgRank.skin=1==t.ranking_type?"modules/petSports/imgUp.png":"modules/petSports/imgDown.png",this.imgState.skin=1==t.result?"modules/petSports/imgWin.png":"modules/petSports/imgFail.png",this.txtName.text=t.opponent.role_name,this.txtState.text=1==t.challenge_type?"主动挑战":"被动防守",this.txtRank.text=t.my_new_ranking+"",this.imgRank.x=this.txtRank.x+this.txtRank.textWidth+5,this.txtTime.text=Qt.getSpeedTime(t.timestamp,Ma.serverTime))})}(),function(t){function i(){this._myLogItemList=null,this._globalLogItemList=null,this._curLogType=1,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.pan.vScrollBarSkin="",this.on("click",this,this.onClick)}l(i,"modules.athletics.petSports.PetSportsLogView",gs);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.btnMyRecord:this.showLog(1);break;case this.btnGlobalReport:this.showLog(2)}},e.showLog=function(t,i){void 0===i&&(i=!1),(t!=this._curLogType||i)&&(this._curLogType=t,this.btnMyRecord.selected=2==t,this.btnGlobalReport.selected=1==t,this.pan.removeChildren(),1==this._curLogType?this.onShowMyRecord():2==this._curLogType&&cs.ins.toPetArenaChallengeGlobalLogs())},e.onShowMyRecord=function(){var t=_s.getPetArenaChallengeLogs();if(t){var i;this._myLogItemList=this._myLogItemList||[];for(var e=Math.max(t.length,this._myLogItemList.length),s=0;s<e;s++)s<t.length?(this._myLogItemList[s]=this._myLogItemList[s]||Na.getIns(3e3,"petSports.PetSportsLogItem"),(i=this._myLogItemList[s]).data=t[s],i.pos(0,148*s),this.pan.addChild(i)):this._myLogItemList[s]&&this._myLogItemList[s].parent&&this._myLogItemList[s].removeSelf()}else cs.ins.toPetArenaChallengeLogs()},e.onShowGlobalLog=function(){var t=_s.getPetArenaChallengeGlobalLogs();if(t&&0<t.length){var i;this._globalLogItemList=this._globalLogItemList||[];for(var e=Math.max(t.length,this._globalLogItemList.length),s=0;s<e;s++)s<t.length?(this._globalLogItemList[s]=this._globalLogItemList[s]||Na.getIns(3e3,"petSports.PetSportsGlobalLogItem"),(i=this._globalLogItemList[s]).data=t[s],i.pos(0,148*s),this.pan.addChild(i)):this._globalLogItemList[s]&&this._globalLogItemList[s].parent&&this._globalLogItemList[s].removeSelf()}},e.update=function(){this.showLog(this._curLogType,!0)},e.updateGlobalLog=function(){this.onShowGlobalLog()},i.LOG_TYPE_MYSELF=1,i.LOG_TYPE_GLOBAL=2}(),function(t){function i(){this.blueVip=null,this.blueYear=null,this._data=null,i.__super.call(this),this.blueVip=this.blueVip||new ge,this.blueYear=this.blueYear||new ge,this.blueVip.visible=this.blueYear.visible=!1,this.addChild(this.blueVip),this.addChild(this.blueYear)}l(i,"modules.athletics.petSports.PetSportsRankItem",Is);var e=i.prototype;e.updateBlueVip=function(t){pt.ins().showVipByString(t,this.blueVip,this.blueYear,this.txtName.x-30,this.txtName.y)},o(0,e,"data",null,function(t){if(this._data=t,this._data){var i;switch(t.ranking){case 3:i="#7223b5";break;case 2:i="#fdc06a";break;case 1:i="#FFFF00";break;default:i="#5d3924"}this.txtRank.text=t.ranking+"",this.txtPow.text=te.getShortenPowerStr(t.embattle_power),this.txtName.text=t.role_name,this.txtPow.color=this.txtName.color=this.txtRank.color=i,this.updateBlueVip(this._data.blue_vip)}})}(),function(t){function i(){this._data=null,i.__super.call(this)}l(i,"modules.athletics.petSports.PetSportsRuleItem",vs),o(0,i.prototype,"date",null,function(t){this._data=t,this._data&&(this.txtRank.text=t[0],this.txt1.text=t[1],this.txt2.text=t[2])})}(),function(t){function i(){i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.pan.vScrollBarSkin="",this.on("click",this,this.onClick),this.initRule()}l(i,"modules.athletics.petSports.PetSportsRuleView",bs);var e=i.prototype;e.initRule=function(){this.txtRule.style.fontSize=24,this.txtRule.style.align="left",this.txtRule.style.valign="top",this.txtRule.style.color="#5d3924",this.txtRule.style.leading=15;var t="";t+="1、仙宠竞技场采用",t+=pe.font("换位赛制","#fff000"),t+="。玩家挑战胜利，",t+=pe.font("且防守方的排名高于进攻方，则双方排名对调。挑战失败则排名不变","#fff000")+"。<br/>",t+="2、每天",t+=pe.font("21:14-21:15","#fff000"),t+="进行排名结算，及累计胜场奖励重置，结算期间不能进行挑战。结算后根据",t+=pe.font("当日排名发放奖励","#fff000")+"。",this.txtRule.innerHTML=t;for(var i,e=_s.getXMLInfo().getRules(),s=0;s<e.length;s++)(i=Na.getIns(3e3,"petSports.PetSportsRuleItem")).date=e[s],i.pos(0,87*s),this.pan.addChild(i)},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btn_Close2:this.closeWindow()}}}(),function(t){function i(){this.endTime=0,this.matchTime=0,this.searchTargets=null,this._targetOriginX=NaN,this.searchTargetLoopNum=0,this._selfBlueVipBox=null,this._targetBlueVipBox=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_7",!0,"",!1),this.on("undisplay",this,this.onUndisplay),this._targetOriginX=this.txtTargetName.x}l(i,"modules.athletics.soloRanking.SoloRankingMatchPanel",_a);var e=i.prototype;e.onUndisplay=function(){De.removeFromSceond(this,this.loopEndTime)},e.update=function(){this.spIng.visible=this.txtEndTime.visible=this.imgMatch.visible=!1,this.imgMyHead.visible=this.txtMyPower.visible=this.txtMyName.visible=this.txtMyServer.visible=this.imgMyDivision.visible=this.imgMyNum.visible=this.imgMyNumBg.visible=!1,this.imgTargetHead.visible=this.txtTargetPower.visible=this.txtTargetName.visible=this.txtTargetServer.visible=this.imgTargetDivision.visible=this.imgTargetNum.visible=this.imgTargetNumBg.visible=!1,this.imgVS.scale(3,3,!0),this.imgLeftBg.x=-305,this.imgRightBg.x=735,eo.to(this.imgVS,{scaleX:1,scaleY:1},100,ai.circInOut,ue.create(this,this.vsTweenComplete,null,!0)),eo.to(this.imgLeftBg,{x:15},100,ai.circInOut,ue.create(this,this.leftBgTweenComplete,null,!0)),eo.to(this.imgRightBg,{x:415},100,ai.circInOut,ue.create(this,this.rightBgTweenComplete,null,!0))},e.vsTweenComplete=function(){eo.clearAll(this.imgVS)},e.leftBgTweenComplete=function(){this.updateMyInfo(),this.imgMyHead.visible=this.txtMyPower.visible=this.txtMyName.visible=this.txtMyServer.visible=this.imgMyDivision.visible=this.imgMyNum.visible=this.imgMyNumBg.visible=!0,eo.clearAll(this.imgLeftBg)},e.rightBgTweenComplete=function(){eo.clearAll(this.imgRightBg),this.imgTargetHead.visible=this.txtTargetPower.visible=this.txtTargetName.visible=this.txtTargetServer.visible=this.imgTargetDivision.visible=this.imgTargetNum.visible=this.imgTargetNumBg.visible=!0,this.searchTargets=ga.searchList.concat().reverse();var t=this.searchTargets.pop();this.updateTargetInfo(t),De.addToTimer(this,this.searchTarget),this.spIng.visible=!0,this.imgDot1.visible=!1,this.imgDot2.visible=!1,this.imgDot3.visible=!1,this.matchTime=0,this.loopImgDotTime(),De.addToSecond(this,this.loopImgDotTime)},e.updateMyInfo=function(){var t=ga.getDdetailVO(),i=ie.getPalByIndex(0);this.imgMyHead.skin="com/head/"+i.ext.category+i.ext.sex+".png",this.imgMyDivision.source=Oe.getRes("modules/athletics/divisionS"+t.division+".png"),this.imgMyNum.source=Oe.getRes("modules/athletics/numBig"+t.stage+".png");var e=ie.roleName.split("区-");this.txtMyName.text=e[1],this.txtMyServer.text=e[0]+"区",this.txtMyPower.text="战力:"+te.getShortenPowerStr(ie.totalPower),this.updateBlueVip(!0,ie.getRoleBlueVipInfo())},e.searchTarget=function(){if(7==this.searchTargetLoopNum)if(0<this.searchTargets.length){var t=this.searchTargets.pop();this.updateTargetInfo(t)}else this.searchTargetLoopNum=0,De.removeFromTimer(this,this.searchTarget),this.spIng.visible=!1,this.imgDot1.visible=!1,this.imgDot2.visible=!1,this.imgDot3.visible=!1,this.endTime=0,this.loopEndTime(),this.txtEndTime.visible=!0,this.imgMatch.visible=!0,De.addToSecond(this,this.loopEndTime);else this.searchTargetLoopNum++},e.updateTargetInfo=function(t){this.imgTargetHead.skin="com/head/"+t.head_id+".png";var i=ga.getDivisionByStar(t.star);this.imgTargetDivision.source=Oe.getRes("modules/athletics/divisionS"+i+".png");var e=ga.getStageByStar(t.star);this.imgTargetNum.source=Oe.getRes("modules/athletics/numBig"+e+".png");var s=t.role_name.split("区-");this.txtTargetName.text=s[1],this.txtTargetServer.text=s[0]+"区",this.txtTargetPower.text="战力:"+te.getShortenPowerStr(t.power);Math.random(),fa.MATCH_PANEL_DIVISION_NAMES.length;this._targetBlueVipBox&&this._targetBlueVipBox.removeSelf(),t.blue_vip?this.updateBlueVip(!1,t.blue_vip):this.txtTargetName.x=this._targetOriginX},e.loopEndTime=function(){this.endTime<3?(this.txtEndTime.text="进入倒计时"+(3-this.endTime)+"秒",this.endTime+=1):(De.removeFromSceond(this,this.loopEndTime),this.imgMatch.visible=!1,this.closeWindow(),Ee.ins().toMapChange(30100),ni.dispatch("ATHLETICS_CLOSE_PANEL"))},e.loopImgDotTime=function(){this.matchTime<3?(this["imgDot"+(this.matchTime+1)].visible=!0,this.matchTime++):(this.matchTime=0,De.removeFromSceond(this,this.loopImgDotTime))},e.updateBlueVip=function(t,i){if(Vh.isQQyxdt()){var e=new ft;e.blueInfo=i,t?(e.nameText=this.txtMyName,this._selfBlueVipBox=this._selfBlueVipBox||new mt,this.addChild(this._selfBlueVipBox),this._selfBlueVipBox.updateShowing(e)):(e.pos=new Hs(this._targetOriginX,this.txtTargetName.y),this._targetBlueVipBox=this._targetBlueVipBox||new mt,this.addChild(this._targetBlueVipBox),this._targetBlueVipBox.updateShowing(e),this.txtTargetName.x=this._targetOriginX+this._targetBlueVipBox.width)}}}(),function(t){function i(){this._data=null,this._blueVipBox=null,i.__super.call(this)}l(i,"modules.athletics.soloRanking.SoloRankingRankItem",t);var e=i.prototype;e.update=function(){var t,i,e;this.txtNum.text=this._data.row_id+"",this.txtName.text=this._data.elements[0],t=ga.getDivisionByStar(parseInt(this._data.elements[1])),i=ga.getStageByStar(parseInt(this._data.elements[1])),e=ga.getStarLvByStar(parseInt(this._data.elements[1])),this.txtDivision.text=ga.getDivisionNameByIndex(t)+i+"阶"+e+"星",this.txtDivision.color=Qi.getColorDark(t+1),this.txtWin.text=this._data.elements[2]+"",this.updateBlueVip(nn.getRankBlueVip(ga.selectRankId,this._data.elements))},e.updateBlueVip=function(t){if(Vh.isQQyxdt()){this._blueVipBox=this._blueVipBox||new mt,this.addChild(this._blueVipBox);var i=new ft;i.nameText=this.txtName,i.blueInfo=t,this._blueVipBox.updateShowing(i)}},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._data=t,this._data&&this.update()})}(Ia),function(t){function i(){this._blueVipBox1=null,this._blueVipBox2=null,this._blueVipBox3=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.tab.selectedIndex=1,ga.selectRankId=2001,this.tab.selectHandler=ue.create(this,this.onTabChange),this.list.selectEnable=!1,this.list.itemRender=Na.getClass(3e3,"soloRanking.SoloRankingRankItem"),this.list.vScrollBarSkin="",this.on("click",this,this.onClick)}l(i,"modules.athletics.soloRanking.SoloRankingRankPanel",va);var e=i.prototype;e.onTabChange=function(t){var i=0==t?2002:2001;$s.ins().toGetRank(i)},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow()}},e.update=function(){var t,i;0==this.tab.selectedIndex?(t=Js.getRankVO(2002),ga.selectRankId=2002):1==this.tab.selectedIndex&&(t=Js.getRankVO(2001),ga.selectRankId=2001);var e,s,n=t?t.rows:null;for(var h in n)(e=n[h]).role_id==ie.roleID&&(i=e);if(this.resetTopThree(),n&&0<n.length){this.list.dataSource=n.splice(3,n.length-3),this.updateTopThree(n);var a=0;i?(a=ga.getDivisionByStar(parseInt(i.elements[1])),this.txtMyRank.innerHTML=pe.span(ga.getDivisionNameByIndex(a),Qi.getColorDark(a+1))+pe.span("（第"+i.row_id+"名）"),this.txtMyWin.text=i.elements[2]+"场"):0==this.tab.selectedIndex?ga.recentInfoToc?(a=ga.getDivisionByStar(ga.recentInfoToc.star),this.txtMyRank.innerHTML=pe.span(ga.getDivisionNameByIndex(a),Qi.getColorDark(a+1))+pe.span("（未上榜）"),this.txtMyWin.text=ga.recentInfoToc.real_win+"场"):(this.txtMyRank.innerHTML=pe.span("（未上榜）"),this.txtMyWin.text="0场"):1==this.tab.selectedIndex&&(s=ga.getDdetailVO(),this.txtMyRank.innerHTML=pe.span(ga.getDivisionNameByIndex(s.division),Qi.getColorDark(s.division+1))+pe.span("（未上榜）"),this.txtMyWin.text=s.realWin+"场")}else this.list.dataSource=[],this.xuwei1.visible=this.xuwei2.visible=this.xuwei3.visible=!0,this.txtMyRank.innerHTML=pe.span("（未上榜）"),this.txtMyWin.text="0场"},e.resetTopThree=function(){this.txtName1.text="",this.txtDivision1.text="",this.txtWin1.text="",this.imageHead1.skin="",this.txtName2.text="",this.txtDivision2.text="",this.txtWin2.text="",this.imageHead2.skin="",this.txtName3.text="",this.txtDivision3.text="",this.txtWin3.text="",this.imageHead3.skin=""},e.updateTopThree=function(t){var i=0,e=0,s=0,n=t[0];if(this.txtName1.text=n.elements[0],i=ga.getDivisionByStar(parseInt(n.elements[1])),e=ga.getStageByStar(parseInt(n.elements[1])),s=ga.getStarLvByStar(parseInt(n.elements[1])),this.txtDivision1.text=ga.getDivisionNameByIndex(i)+e+"阶"+s+"星",this.txtDivision1.color=Qi.getColorLight(i+1),this.txtWin1.text="净胜"+n.elements[2]+"场",this.imageHead1.skin="com/head/"+n.elements[3]+".png",this.xuwei1.visible=!1,this.updateBlueVip(n.elements,1),1<t.length){var h=t[1];h&&(this.txtName2.text=h.elements[0],i=ga.getDivisionByStar(parseInt(h.elements[1])),e=ga.getStageByStar(parseInt(h.elements[1])),s=ga.getStarLvByStar(parseInt(h.elements[1])),this.txtDivision2.text=ga.getDivisionNameByIndex(i)+e+"阶"+s+"星",this.txtDivision2.color=Qi.getColorLight(i+1),this.txtWin2.text="净胜"+h.elements[2]+"场",this.imageHead2.skin="com/head/"+h.elements[3]+".png",this.xuwei2.visible=!1,this.updateBlueVip(h.elements,2))}if(2<t.length){var a=t[2];a&&(this.txtName3.text=a.elements[0],i=ga.getDivisionByStar(parseInt(a.elements[1])),e=ga.getStageByStar(parseInt(a.elements[1])),s=ga.getStarLvByStar(parseInt(a.elements[1])),this.txtDivision3.text=ga.getDivisionNameByIndex(i)+e+"阶"+s+"星",this.txtDivision3.color=Qi.getColorLight(i+1),this.txtWin3.text="净胜"+a.elements[2]+"场",this.imageHead3.skin="com/head/"+a.elements[3]+".png",this.xuwei3.visible=!1,this.updateBlueVip(a.elements,3))}},e.updateBlueVip=function(t,i){if(0!=Vh.isQQyxdt()){var e;0==this.tab.selectedIndex?e=t[4]:1==this.tab.selectedIndex&&(e=t[5]);var s=new ft;switch(s.blueInfo=e,i){case 1:s.pos=new Hs(316,135),this._blueVipBox1=this._blueVipBox1||new mt,this.addChild(this._blueVipBox1),this._blueVipBox1.updateShowing(s);break;case 2:s.pos=new Hs(158,335),this._blueVipBox2=this._blueVipBox2||new mt,this.addChild(this._blueVipBox2),this._blueVipBox2.updateShowing(s);break;case 3:s.pos=new Hs(496,335),this._blueVipBox3=this._blueVipBox3||new mt,this.addChild(this._blueVipBox3),this._blueVipBox3.updateShowing(s)}}},e.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this,t,i),this.tab.selectedIndex=1}}(),function(t){function i(){this.Sp=null,this.dTimes=NaN,this.gTimes=NaN,this.hasGetReward=!1,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick),this.tab.on("change",this,this.onTabClick),this.tab.selectedIndex=0,this.creatStrBeast(),this.creatPower(),an.register("RP_ATHLETICS_SOLORANKING_REWARD",this.tab.items[0],new Hs(19,-10)),an.register("RP_BEASTS_REWARD",this.tab.items[1],new Hs(19,-10))}l(i,"modules.athletics.soloRanking.SoloRankingSettlementPanel",ya);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow();break;case this.btnGet:ma.getInstance().toSoloGetReward();break;case this.btnGetStr:(5<=this.gTimes||1<=this.dTimes)&&!this.hasGetReward?5<=this.gTimes?this.toInfo(2):1<=this.dTimes&&this.toInfo(3):io.addTip("周结算时达到钻石段位或累计5次周结算时达到黄金段位")}if(t.target instanceof laya.ui.Image&&""!=t.target.name){var i=parseInt(t.target.name);if(0<i){var e=ve.getItem(i);e.tempNum=1,to.show(e,"BASE_GOODS_TIP")}}},e.onTabClick=function(){switch(this.tab.selectedIndex){case 0:this.list.visible=!0,this.img.visible=!0,this.reward.visible=!1;break;case 1:this.list.visible=!1,this.img.visible=!1,this.reward.visible=!0,this.creatStrBeast()}this.update()},e.toInfo=function(t){var i=new Object;i.className="m_role_beasts_receive_tos",i.cond_type=2,i.cond_val=t,Nt.send(i)},e.creatStrBeast=function(){this.Sp=this.Sp||ut.getOne(),this.Sp.pos(300,400),this.Sp.scaleX=this.Sp.scaleY=1,this.reward.addChild(this.Sp),this.Sp.loadAndPlay("unit/monster/70000023_3","stand",3,!0)},e.creatPower=function(){var t,i=Rt.numToTexture(45677,"com/ui/powerNum");this.spPower.graphics.clear();for(var e=0;e<i.length;e++)t=i[e],this.spPower.graphics.drawTexture(t,t.width*e)},e.getData=function(){var t,i=vi.getBeastsGetInfo(2);if(this.gTimes=this.dTimes=0,i&&0<i.length)for(var e in i)(t=i[e])&&2==t.type?this.gTimes=t.id:t&&3==t.type&&(this.dTimes=t.id),t&&0<t.val&&(this.hasGetReward=!0);else this.hasGetReward=!1},e.update=function(){1==this.tab.selectedIndex&&this.creatStrBeast(),this.updateList(),this.updateReward()},e.updateList=function(){var t=ga.getDdetailVO();if(t){var i=ga.getDivisionByStar(t.star),e=0<ga.getDdetailVO().rank?pe.span("（第"+t.rank+"名）","#ffe8b8",26):pe.span("（未上榜）","#ffe8b8",26);this.txtDivision.innerHTML=pe.span(ga.getDivisionNameByIndex(i),"#b0eb5b",26)+e;var s=ga.recentInfoToc,n=new Date;n.setTime(Ma.serverTimeMs);var h=n.getDay(),a=n.getHours(),o=n.getMinutes();0==h&&22<a&&22==a&&30<=o?1==s.reward_type?(this.txtTimeDesc.visible=!0,this.btnGet.visible=!1,this.btnGet.gray=!1,this.btnGet.mouseEnabled=!1):2==s.reward_type?(this.txtTimeDesc.visible=!1,this.btnGet.visible=!0,this.btnGet.gray=!1,this.btnGet.mouseEnabled=!0):3==s.reward_type&&(this.txtTimeDesc.visible=!1,this.btnGet.visible=!0,this.btnGet.gray=!0,this.btnGet.mouseEnabled=!1):s&&(1==s.reward_type||3==s.reward_type?(this.txtTimeDesc.visible=!0,this.btnGet.visible=!1,this.btnGet.gray=!1,this.btnGet.mouseEnabled=!1):2==s.reward_type&&(this.txtTimeDesc.visible=!1,this.btnGet.visible=!0,this.btnGet.gray=!1,this.btnGet.mouseEnabled=!0))}},e.updateReward=function(){this.getData(),this.txt.style.fontSize=24,this.txt.style.valign="top",this.txt.style.leading=8,this.hasGetReward?(this.btnGetStr.label="已领取",this.btnGetStr.disabled=!0,this.btnGetStr.mouseEnabled=!1,this.txt.style.color="#00ff00",this.txt.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;周结算时达钻石段位("+this.dTimes.toString()+"/1)<br>&nbsp;&nbsp;&nbsp;或达到5次黄金段位("+this.gTimes.toString()+"/5)可领取"):(this.btnGetStr.label="领取",this.btnGetStr.disabled=!1,this.btnGetStr.mouseEnabled=!0,this.txt.style.color="#5D3924",this.txt.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;周结算时达到"+pe.font("钻石段位("+this.dTimes.toString()+"/1)","#fcf476",24)+"<br>&nbsp;&nbsp;&nbsp;或达到5次"+pe.font("黄金段位("+this.gTimes.toString()+"/5)","#fcf476",24)+"可领取")},o(0,e,"tabSelected",null,function(t){this.tab.selectedIndex=t})}(),function(t){function s(){this.coldTs=0,this.effectSelected=null,this.spBeast=null,this.eff=null,s.__super.call(this),this.on("click",this,this.onClick),this.effectSelected=ut.getOne(),this.effectSelected.pos(107,593),this.addChild(this.effectSelected),this.effectSelected.loadAndPlay("moduleEffect/solo_ranking_selected","default",0,!0),an.register("RP_ATHLETICS_SOLORANKING_REWARD",this.imgReward,new Hs(19,-10)),an.register("RP_BEASTS_REWARD",this.imgReward,new Hs(19,-10)),this.on("undisplay",this,this.onUndisplay)}l(s,"modules.athletics.soloRanking.SoloRankingView",xa);var i=s.prototype;i.onUndisplay=function(){De.removeFromSceond(this,this.loopColdTimes)},i.buyTimes=function(){var t=ga.getDdetailVO(),i=12,e=oo.getVipVO(oo.curLv);if(e&&(i+=e.soloRankingBuyTime),6==t.soloTimes)io.addTip("可匹配次数已达上限，无法购买");else if(i-t.buyTimes==0)io.addTip("购买次数已达上限，无法购买");else{var s=new q;s.msg=pe.span("确定消费","#5d3924")+pe.span("50元宝","#fff959")+pe.span("购买1次天梯挑战次数吗？","#5d3924")+"<br>"+pe.span("今日已购买：","#5d3924")+pe.span(i-t.buyTimes+"/"+i,"#139604")+pe.span("次","#5d3924"),s.yesCaller=ma.getInstance(),s.yesFun=ma.getInstance().toSoloBuy,K.showVO(s)}},i.onClick=function(t){var i=ga.getDdetailVO();switch(t.target){case this.btnMatch:if(i&&0==i.soloTimes)return void io.addTip("可匹配次数为0，请先购买");ma.getInstance().toSoloFight(1);break;case this.imgReward:ma.getInstance().openSettlementPanel();break;case this.imgRank:ma.getInstance().openRankPanel();break;case this.txtBuy:Ve.send(110,2,"竞技-天梯赛-购买次数"),this.buyTimes()}if(t.target instanceof laya.ui.Image&&""!=t.target.name){var e=parseInt(t.target.name);if(0<e){var s=ve.getItem(e);s.tempNum=1,to.show(s,"BASE_GOODS_TIP")}}},i.update=function(){var t=ga.getDdetailVO();if(t){this.imgIcon.source=Oe.getRes("modules/athletics/divisionB"+t.division+".png"),4==t.division?(this.imgStage.source=Oe.getRes("modules/athletics/numBig0.png"),this.txtRealWin.visible=!0,this.txtRealWin.text="净胜："+t.realWin+"场",this.spStar.removeChildren()):(this.imgStage.source=Oe.getRes("modules/athletics/numBig"+t.stage+".png"),this.txtRealWin.visible=!1,this.updateSpStar(t)),this.txtDivision.text=ga.getDivisionNameByIndex(t.division),this.txtWin.text=t.realWin+"场";var i=12,e=oo.getVipVO(oo.curLv);e&&(i+=e.soloRankingBuyTime),this.txtBuy.visible=0<i-t.buyTimes,this.btnMatch.mouseEnabled=0!=t.soloTimes,this.btnMatch.gray=0==t.soloTimes,0<t.soloTimes?this.txtResidue.color="#96f254":this.txtResidue.color="#9a0c00",this.txtResidue.text=t.soloTimes+"/6",this.coldTs=t.coldTs-Ma.serverTime,0<this.coldTs&&6!=t.soloTimes?(this.spTime.visible=!0,this.spResidue.y=640,De.addToSecond(this,this.loopColdTimes)):(this.spTime.visible=!1,this.spResidue.y=660),this.effectSelected.pos(s.selectedBgPos[t.division-1].x,s.selectedBgPos[t.division-1].y),ga.checkTimeIsCanFight()?(this.btnMatch.gray=!1,this.btnMatch.mouseEnabled=!0):(this.btnMatch.gray=!0,this.btnMatch.mouseEnabled=!1)}},i.loopColdTimes=function(){this.coldTs=ga.getDdetailVO().coldTs-Ma.serverTime,0<this.coldTs?(this.txtTime.visible=!0,this.txtTime.text=Qt.formatTime(this.coldTs)):(De.removeFromSceond(this,this.loopColdTimes),this.txtTime.visible=!1)},i.updateSpStar=function(t){for(;0<this.spStar.numChildren;)this.spStar.removeChildAt(0);var i,e=0;if(1==t.division?(e=3,i=fa.THREE_STAR_POS):2==t.division?(e=4,i=fa.FOUR_STAR_POS):3==t.division?(e=5,i=fa.FIVE_STAR_POS):e=(t.division,0),0<e)for(var s,n=0;n<e;n++)(s=new ge).x=i[n],n<t.starLv?s.source=Oe.getRes("modules/athletics/star1.png"):s.source=Oe.getRes("modules/athletics/star2.png"),this.spStar.addChild(s);else so.createHTMLDivElement("",60,0,150,30,this.spStar).innerHTML=pe.span("净胜场：","#e1c6bc")+pe.span(t.realWin+"","#b0eb5b")+pe.span("场","#e1c6bc")},e(s,["selectedBgPos",function(){return this.selectedBgPos=[{x:107,y:593},{x:263,y:593},{x:419,y:593},{x:576,y:593}]}])}(),function(t){function i(){this._data=null,i.__super.call(this)}l(i,"modules.monsterCopy.MonsterCopyAwardItem",t);var e=i.prototype;e.update=function(){this.txtRank.text=this._data.rank;for(var t=0;t<this._data.getAwards().length;t++){var i=new ae(null,!1,!0,91,!0);i.data=ve.getItem(this._data.getAwards()[t][0]),i.num=this._data.getAwards()[t][1],i.isShowTips=!0,i.pos(95*t+171,18),this.addChild(i)}},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._data=t,this._data&&this.update()})}(Me),function(t){function e(){e.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_7"),this.on("click",this,this.onClick),this.list.itemRender=Na.getClass(62e3,"MonsterCopyAwardItem"),this.list.vScrollBarSkin="",this.list.dataSource=He.rankAwardCfgs;var t=He.baseCfg.getFamilyAwards(),i=new ae(null,!1,!0,91,!0);i.data=ve.getItem(t[0][0]),i.num=t[0][1],i.isShowTips=!0,i.pos(195,716),this.addChild(i)}l(e,"modules.monsterCopy.MonsterCopyAwardPanel",Ge),e.prototype.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow()}}}(),function(t){function i(){this._bossVO=null,this._bossId=0,i.__super.call(this)}l(i,"modules.monsterCopy.MonsterCopyBlood",Fe);var e=i.prototype;e.updateBoss=function(t){this._bossId!=t&&(this._bossId=t,this._bossVO=gt.getBossVO(t),this._bossVO&&(this.txtName.text=this._bossVO.bossName,this.txtLv.text=this._bossVO.showBossLvStr2,this.bmpHead.skin=this._bossVO.headUrl))},e.updateHp=function(t){this.txtBest.text=ie.roleName+":"+te.getShortenPowerStr(t);var i=He.getHpByHurt(t);if(i){var e=i[0]/i[1],s=i[2]%5+1,n=s%6+1;this.bossBar1.width=596*e,this.bossBar1.skin="modules/beachBoss/bar"+s+".png",this.bossBar0.skin="modules/beachBoss/bar"+n+".png",this.numTxt.text="×"+i[2]}}}(),function(t){function i(){this._data=null,i.__super.call(this)}l(i,"modules.monsterCopy.MonsterCopyRankItem",t);var e=i.prototype;e.update=function(){this.txtNum.text=this._data.row_id+"",this.txtName.text=this._data.elements[0],this.txtDmg.text=te.getShortenPowerStr(this._data.elements[1])},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._data=t,this._data&&this.update()})}(We),function(t){function i(){this._blueVipBox1=null,this._blueVipBox2=null,this._blueVipBox3=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_7"),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.tab.selectHandler=ue.create(this,this.onTabChange),this.list.itemRender=Na.getClass(62e3,"MonsterCopyRankItem"),this.list.vScrollBarSkin="",this.list.selectEnable=!1}l(i,"modules.monsterCopy.MonsterCopyRankPanel",Ke);var e=i.prototype;e.onDisplay=function(){ni.register("RANK_GOT_DATA_UPDATE",this,this.updateRankInfo),this.on("undisplay",this,this.unDispaly);var t=0==this.tab.selectedIndex?5102:5101;$s.ins().toGetRank(t)},e.unDispaly=function(){ni.remove("RANK_GOT_DATA_UPDATE",this,this.updateRankInfo),this.off("undisplay",this,this.unDispaly)},e.onTabChange=function(t){var i=0==t?5102:5101;$s.ins().toGetRank(i)},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow()}},e.updateRankInfo=function(t){5101!=t&&5102!=t||this.update()},e.update=function(){var t,i;0==this.tab.selectedIndex?t=Js.getRankVO(5102):1==this.tab.selectedIndex&&(t=Js.getRankVO(5101));var e,s=t?t.rows:null;for(var n in s)(e=s[n]).role_id==ie.roleID&&(i=e);this.resetTopThree(),s&&0<s.length?(this.list.dataSource=s.splice(3,s.length-3),this.updateTopThree(s),this.txtMyRank.innerHTML=i?pe.span("（第"+i.row_id+"名）","#139604"):pe.span("（未上榜）")):(this.list.dataSource=[],this.xuwei1.visible=this.xuwei2.visible=this.xuwei3.visible=!0,this.txtMyRank.innerHTML=pe.span("（未上榜）")),this.txtTime.text=1==this.tab.selectedIndex?"实时更新":"每天24点"},e.resetTopThree=function(){this.txtName1.text="",this.txtDivision1.text="",this.txtWin1.text="",this.imageHead1.skin="",this.txtName2.text="",this.txtDivision2.text="",this.txtWin2.text="",this.imageHead2.skin="",this.txtName3.text="",this.txtDivision3.text="",this.txtWin3.text="",this.imageHead3.skin=""},e.updateTopThree=function(t){var i=t[0];if(this.txtName1.text=i.elements[0],this.txtDivision1.text=i.elements[3],this.txtWin1.text="伤害量："+te.getShortenPowerStr(i.elements[1]),this.imageHead1.skin="com/head/"+i.elements[2]+".png",this.xuwei1.visible=!1,1<t.length){var e=t[1];e&&(this.txtName2.text=e.elements[0],this.txtDivision2.text=e.elements[3],this.txtWin2.text="伤害量："+te.getShortenPowerStr(e.elements[1]),this.imageHead2.skin="com/head/"+e.elements[2]+".png",this.xuwei2.visible=!1)}if(2<t.length){var s=t[2];s&&(this.txtName3.text=s.elements[0],this.txtDivision3.text=s.elements[3],this.txtWin3.text="伤害量："+te.getShortenPowerStr(s.elements[1]),this.imageHead3.skin="com/head/"+s.elements[2]+".png",this.xuwei3.visible=!1)}},e.updateBlueVip=function(t,i){if(0!=Vh.isQQyxdt()){var e;0==this.tab.selectedIndex?e=t[4]:1==this.tab.selectedIndex&&(e=t[5]);var s=new ft;switch(s.blueInfo=e,i){case 1:s.pos=new Hs(316,135),this._blueVipBox1=this._blueVipBox1||new mt,this.addChild(this._blueVipBox1),this._blueVipBox1.updateShowing(s);break;case 2:s.pos=new Hs(158,335),this._blueVipBox2=this._blueVipBox2||new mt,this.addChild(this._blueVipBox2),this._blueVipBox2.updateShowing(s);break;case 3:s.pos=new Hs(496,335),this._blueVipBox3=this._blueVipBox3||new mt,this.addChild(this._blueVipBox3),this._blueVipBox3.updateShowing(s)}}},e.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this,t,i),this.tab.selectedIndex=1}}(),function(t){function i(){this._goodsImg=null,this._awardsVo=null,this.loopTime=0,i.__super.call(this),this.on("display",this,this.onDisplay)}l(i,"modules.monsterCopy.MonsterCopyTopView",qe);var e=i.prototype;e.onDisplay=function(){ni.register("COPY_SHUT_DOWN_UPDATE",this,this.update),this.on("undisplay",this,this.unDisplay),this.update()},e.update=function(){this.loopTime=Pt.shutDownTime-Ma.serverTime,De.addToSecond(this,this.loopUpdateTime)},e.unDisplay=function(){this.off("undisplay",this,this.unDisplay),ni.remove("COPY_SHUT_DOWN_UPDATE",this,this.update),De.removeFromSceond(this,this.loopUpdateTime)},e.updateByHurt=function(t){this._awardsVo=He.getRewardsByDam(t),this._awardsVo&&(this._goodsImg||(this._goodsImg=new ae(null,!1,!0,91,!0),this.sp.addChild(this._goodsImg)),this._goodsImg.isShowTips=!0,this._goodsImg.data=ve.getItem(this._awardsVo.getAwards()[0][0]),this._goodsImg.num=this._awardsVo.getAwards()[0][1])},e.loopUpdateTime=function(){0<this.loopTime?(this.txtTime.text=Qt.formatTotalHMS(this.loopTime),this.loopTime--):De.removeFromSceond(this,this.loopUpdateTime)}}(),function(t){function i(){this._monster=null,this._awards=null,i.__super.call(this),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.updateRewards(),this.txtGold.text=He.baseCfg.buyCost+""}l(i,"modules.monsterCopy.MonsterCopyView",Ye);var e=i.prototype;s.imps(e,{"com.ui.IViewUpdate":!0}),e.onDisplay=function(){ni.register("RANK_GOT_DATA_UPDATE",this,this.updateRankInfo),ni.register("COPY_TIME_UPDATE",this,this.updateTime),ni.register("BUY_AND_ENTER_COPY",this,this.onEnterCopy),this.on("undisplay",this,this.unDisplay)},e.unDisplay=function(){ni.remove("RANK_GOT_DATA_UPDATE",this,this.updateRankInfo),ni.remove("COPY_TIME_UPDATE",this,this.updateTime),ni.remove("BUY_AND_ENTER_COPY",this,this.onEnterCopy)},e.update=function(){this.updateMonster(),this.updateRank(),this.updateTime()},e.onClick=function(t){switch(t.target){case this.btnRank:Ue.ins().openRankPanel();break;case this.btnAward:Ue.ins().openAwardPanel();break;case this.btn:this.onEnterCopy()}},e.updateMonster=function(){this._monster||(this._monster=new ut,this._monster.pos(373,552)),this._monster.loadAndPlay(He.baseCfg.bossUrl,"default",0,!0),this.addChild(this._monster)},e.updateRewards=function(){this.awardSp.removeChildren(),this._awards=He.baseCfg.getPreviewAward();for(var t=0;t<this._awards.length;t++){var i=new ae(null,!1,!0,91,!0);i.data=ve.getItem(this._awards[t][0]),i.num=this._awards[t][1],i.isShowTips=!0,i.pos(95*t,0),this.awardSp.addChild(i)}},e.updateRank=function(){var t=Js.getRankVO(5101);t&&t.rows.length?(this.txtRole.text=t.rows[0].elements[0],this.txtDmg.text="伤害量："+te.getShortenPowerStr(t.rows[0].elements[1]),this.imgRole.skin="com/head/"+t.rows[0].elements[2]+".png",this.imgCrown.visible=!0):(this.txtRole.text="暂无",this.txtDmg.text="",this.imgRole.skin="",this.imgCrown.visible=!1)},e.updateRankInfo=function(t){5101==t&&this.updateRank()},e.onEnterCopy=function(){if(He.isBossTime())if(22100!=Rh.mapID){var t=Pt.getCopyTime(22100);if(t){var i=t.max_free_times-t.finished_times;if(i<=0&&0==t.can_buy_times)io.addTip("剩余挑战次数为0");else if(t.can_buy_times&&i<=0)if(ie.user.attr.gold>=He.baseCfg.buyCost){var e=pe.span("是否消耗","#5d3924",22)+pe.span(He.baseCfg.buyCost+"元宝","#F7EF5F",22)+pe.span("购买1次【异兽BOSS】挑战次数？","#5d3924",22)+"<br><br>"+pe.span("每天最多可购买2次","#5d3924",22),s=new q;s.msg=e,s.align="center",s.yesCaller=this,s.yesFun=this.buyCopy,s.key="copyMonster",K.showVO(s)}else es.showAlert();else Ee.ins().toMapChange(22100)}else io.addTip("获取不到副本次数信息")}else io.addTip("已经在副本中");else io.addTip("每日0点至23点55分才可挑战异兽BOSS")},e.updateTime=function(){var t=Pt.getCopyTime(22100);if(t){var i=0<=t.max_free_times-t.finished_times?t.max_free_times-t.finished_times:0;this.txtCost.text="当天剩余免费挑战次数："+i,this.imgGold.visible=0==i}},e.buyCopy=function(){Vt.ins().toBuyCopyTimes(22100)}}(),function(t){function i(){i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_NO",!0),this.on("click",this,this.onClick)}l(i,"modules.footPrint.FootPrintBeautyView",Vi),i.prototype.onClick=function(t){switch(t.target){case this.btnClose:case this.btnRe:this.closeWindow()}}}(),function(t){function i(){this._cfgData=null,this._ftData=null,this._role=null,this._footItem=null,this._costNum=0,this._ownNum=0,this.eff=null,this._searchList=null,this.FootEffTemp=0,i.__super.call(this),this.tab.labels=Ni.getColorArr().join(","),this.tab.on("change",this,this.onChange),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.unDisplay),this.list.itemRender=Na.getClass(61e3,"FootPrintItem"),this.list.hScrollBarSkin="",this.list.selectEnable=!0,this.list.selectHandler=ue.create(this,this.onItemSelected),this.attr1.leading=8,this.attr1.fontSize=24,this.attr2.style.leading=8,this.txtCost.style.align="center",this.txtCost.on("link",this,this.onLink);for(var t=0;t<this.tab.items.length;t++)an.register("RP_FOOT_PRINT_CHANGE_"+t,this.tab.items[t],new Hs(19,-10));this.inputSearch.prompt="请输入足迹名称",this.btnSearch.on("click",this,this.onClickSearch),this.inputSearch.on("input",this,this.onSearchChange)}l(i,"modules.footPrint.FootPrintChangeView",Ri);var e=i.prototype;s.imps(e,{"com.ui.IViewUpdate":!0}),e.onChange=function(){Ni.tabColorIdx=this.tab.selectedIndex,this.update()},e.onDisplay=function(){ni.register("FOOT_PRINT_UPDATE",this,this.update),ni.register("FOOT_PRINT_SELECT_ITEM",this,this.onSelectItem),ni.register("BAGDATA_CHANGE",this,this.onBagChange),ni.register("MONEY_CHANGE",this,this.onBagChange)},e.unDisplay=function(){ni.remove("FOOT_PRINT_UPDATE",this,this.update),ni.remove("FOOT_PRINT_SELECT_ITEM",this,this.onSelectItem),ni.remove("BAGDATA_CHANGE",this,this.onBagChange),ni.remove("MONEY_CHANGE",this,this.onBagChange),this.eff&&(this.eff.unload(),this.eff=null),this._searchList=null,De.removeFromFrame(this,this.loopFootEff)},e.onBagChange=function(){this._cfgData&&this.updateOthers()},e.onSelectItem=function(t){this.tab.selectedIndex=t.color-Ni.tabColorOffset;for(var i=0;i<this.list.dataSource.length;i++){var e=this.list.getItem(i);if(e&&e.itemId==t.itemId)return void(this.list.selectedIndex=i)}},e.onItemSelected=function(t){Ni.tabItemIdx=t,this._cfgData=this.list.getItem(t),this._cfgData&&(this._ftData=Ni.getFootPrintVO(this._cfgData.id),this.updateAttrs(),this.updateOthers(),this._footItem&&(this._footItem.dataSource=this._cfgData,this._footItem.setFilter(!1),this._footItem.hideRp()))},e.updateAttrs=function(){var t,i,e="",s="";this.imgFull.visible=!1,this._ftData&&this._ftData.purify_level?(this.curStage.text=Rt.getTenChNum(this._ftData.purify_level)+"阶",t=Ni.getFootChangeAttr(this._ftData.foot_id,this._ftData.purify_level),i=Ni.getFootChangeAttr(this._ftData.foot_id,this._ftData.purify_level+1),this._ftData.purify_level<3?this.nxtStage.text=Rt.getTenChNum(this._ftData.purify_level+1)+"阶":(this.nxtStage.text="",this.imgFull.visible=!0)):(this.curStage.text="未激活",this.nxtStage.text="一阶",t=null,i=Ni.getFootChangeAttr(this._cfgData.id,1));for(var n=t?t.length:i.length,h=0;h<n;h++)e+=t?te.getName(t[h][0])+"+"+t[h][1]:te.getName(i[h][0])+"+0",e+="\n",i&&(s+=pe.span(te.getName(i[h][0])+"+"+i[h][1],"#89511b",24)+pe.image("ui/modules/footPrint/arrow.png",14,19),s+="<br>");this.attr1.text=e,this.attr2.innerHTML=s},e.updateOthers=function(){var t=ve.getItem(this._cfgData.itemId);this._ownNum=Ze.getGoodsNumByTypeID(this._cfgData.itemId),this._ftData?(this._costNum=Ni.getFootChangeCost(this._ftData.foot_id,this._ftData.purify_level+1),this.btn.disabled=3==this._ftData.purify_level):(this._costNum=Ni.getFootChangeCost(this._cfgData.id,1),this.btn.disabled=!1);var i=this._ownNum>=this._costNum?Qi.getColorLight(2):Qi.getColorLight(6);this.txtCost.innerHTML=this._costNum?pe.font("消耗","#6e3201",26)+pe.linkcolor("【"+t.name+"】","",!0,Qi.getColorLight(t.color).substr(1),26)+pe.font("×"+this._costNum,i,26):""},e.getIdx=function(t){for(var i=0;i<this.list.dataSource.length;i++){var e=this.list.getItem(i);if(e&&e.id==t.id)return i}return 0},e.updateView=function(){if(this._cfgData){var t=this.getIdx(this._cfgData);Ni.tabItemIdx=t}this.list.selectedIndex=Ni.tabItemIdx,this._role||(this._role=new Yn,this._role.moveSpeed=100,this._role.scaleX=this._role.scaleY=1.2,this._role.pos(510,524));var i=new Object;i.className="p_skin",(i=ie.pals[0].ext.skin).mount=0,this._role.resetSkin(i,ie.sex,!0),this._role.resetState(0),this._role.play("walk",2),this.addChild(this._role),De.addToFrame(this,this.loopFootEff),this._footItem||(this._footItem=Na.getIns(61e3,"FootPrintItem"),this._footItem.x=74,this._footItem.y=621),this._footItem.dataSource=this._cfgData,this._footItem.setFilter(!1),this._footItem.hideRp(),this.addChild(this._footItem)},e.update=function(){this.tab.selectedIndex=Ni.tabColorIdx,Ni.searchTxt.length?(this.inputSearch.text=Ni.searchTxt,this.searchItem(this.inputSearch.text,!0)):(this.inputSearch.text="",this.updateFpItems(this._searchList)),this.updateView()},e.loopFootEff=function(){var t=this;if(this.FootEffTemp++,!(this.FootEffTemp<20)&&(this.FootEffTemp=0,this._cfgData&&!this.eff)){this.eff=ut.getOne(),this.eff.loadAndPlay(this._cfgData.effectUrl),this.eff.x=423,this.eff.y=511,this.eff.setEndHandler(ue.create(this,function(){t.eff.unload(),t.eff=null})),this.addChild(this.eff);eo.to(this.eff,{x:90,y:511},900,null,ue.create(this,function(){}))}},e.onClick=function(t){var i=this;switch(t.target){case this.btn:if(!Ni.getFootPrintVO(this._cfgData.id))return void io.addTip("无法进阶，请先激活对应足迹");if(this._ownNum>=this._costNum){var e=ve.getItem(this._cfgData.itemId),s=new q;s.msg=pe.span("是否消耗","#89511b")+pe.span(this._costNum+"个","#89511b")+pe.span("【"+e.name+"】",Qi.getColorLight(e.color))+pe.font("进阶足迹","#89511b"),s.yesCaller=this,s.yesFun=function(){Ei.ins().toFootPrintPurify(i._cfgData.id)},s.key="footPrintChange",K.showVO(s)}else io.addTip("道具不足")}},e.onLink=function(t){var i=new Object;i.className="p_goods",i.typeid=this._cfgData.itemId,i.current_num=1,to.show(i,"GOODS_TIP")},e.onClickSearch=function(){var t=this.inputSearch.text;t.length?this.searchItem(t):io.addTip("请输入搜索内容")},e.onSearchChange=function(){this.inputSearch.text.length||this.updateFpItems(),Ni.searchTxt=this.inputSearch.text},e.searchItem=function(t,i){void 0===i&&(i=!1);for(var e=[],s=Ni.getFootListByColor(this.tab.selectedIndex+Ni.tabColorOffset,0).sort(Ni.sortFp),n=0;n<s.length;n++){-1!=ve.getItem(s[n].itemId).name.indexOf(t)&&e.push(s[n])}e.length?this.updateFpItems(e):(io.addTip("搜索失败，没有该道具"),i&&(this.inputSearch.text="",Ni.searchTxt="",this.updateFpItems()))},e.updateFpItems=function(t){this.list.dataSource=t||Ni.getFootListByColor(this.tab.selectedIndex+Ni.tabColorOffset,0).sort(Ni.sortFp),this._searchList=t}}(),function(t){function i(){this._data=null,this.colorMatrix=[.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0],this.GrayFilter=new At(this.colorMatrix),i.__super.call(this),this.mouseEnabled=!0}l(i,"modules.footPrint.FootPrintItem",t);var e=i.prototype;e.update=function(){var t=ve.getItem(this._data.itemId);t&&(this.txtName.text=t.name,this.bg.skin="com/ui/goodsBg"+t.color+".png",this.icon.skin=t.realMaxico);var i=Ni.getFootPrintVO(this._data.id);i?(this.desc.text=i.refine_level+"星",this.desc.color="#2eb909"):(this.desc.text="未激活",this.desc.color="#89511b"),this.setFilter(!i),this.checkRp()},e.hideRp=function(){this.imgRp.visible=!1},e.checkRp=function(){var t=Ni.getFootPrintVO(this._data.id);if(0==this._data.type)if(t)if(t.refine_level<10){var i=Ni.getFootPurifyCost(t.foot_id,t.refine_level+1),e=ie.gold;this.imgRp.visible=i<=e}else this.imgRp.visible=!1;else i=Ni.getFootPurifyCost(this._data.id,0),e=Ze.getGoodsNumByTypeID(this._data.itemId),this.imgRp.visible=i<=e;else t&&t.purify_level<3?(i=Ni.getFootChangeCost(t.foot_id,t.purify_level+1),e=Ze.getGoodsNumByTypeID(this._data.itemId),this.imgRp.visible=i<=e):this.imgRp.visible=!1},e.setFilter=function(t){this.sp.filters=t?[this.GrayFilter]:null},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._data=t,this._data&&this.update()})}(Di),function(t){function i(){this.curView=null,this.purifyView=null,this.changeView=null,this._selectedIdx=0,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.tab.on("change",this,this.onChange),this.on("click",this,this.onClick),this.on("undisplay",this,this.unDisplay),an.register("RP_FOOT_PRINT_PURIFY",this.tab.items[0],new Hs(19,-10)),an.register("RP_FOOT_PRINT_CHANGE",this.tab.items[1],new Hs(19,-10))}l(i,"modules.footPrint.FootPrintPanel",Bi);var e=i.prototype;e.setIdx=function(t){this.tab.selectedIndex=t,this.onChange()},e.onChange=function(){switch(this.sp.removeChildren(),this.tab.selectedIndex){case 0:this.purifyView=this.purifyView||Na.getIns(61e3,"FootPrintPurifyView"),this.curView=this.purifyView,this.sp.addChild(this.purifyView);break;case 1:this.changeView=this.changeView||Na.getIns(61e3,"FootPrintChangeView"),this.curView=this.changeView,this.sp.addChild(this.changeView)}this.curView&&this.curView.update()},e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow()}},e.unDisplay=function(){Ni.tabColorIdx=0,Ni.tabItemIdx=0,Ni.searchTxt=""}}(),function(t){function i(){this._role=null,this._stars=null,this._ftData=null,this._cfgData=null,this._costNum=0,this._ownNum=0,this.eff=null,this._searchList=null,this.FootEffTemp=0,i.__super.call(this),this.tab.labels=Ni.getColorArr().join(","),this.tab.on("change",this,this.onChange),this.initStars(),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.unDisplay),this.list.itemRender=Na.getClass(61e3,"FootPrintItem"),this.list.hScrollBarSkin="",this.list.selectEnable=!0,this.list.selectHandler=ue.create(this,this.onItemSelected),this.txtAttr.leading=8,this.txtCost.style.align="center",this.txtLink.underline=!0,this.txtLink.mouseEnabled=!0,this.txtCost.on("link",this,this.onLink);for(var t=0;t<this.tab.items.length;t++)an.register("RP_FOOT_PRINT_PURIFY_"+t,this.tab.items[t],new Hs(19,-10));this.inputSearch.prompt="请输入足迹名称",this.btnSearch.on("click",this,this.onClickSearch),this.inputSearch.on("input",this,this.onSearchChange)}l(i,"modules.footPrint.FootPrintPurifyView",Li);var e=i.prototype;s.imps(e,{"com.ui.IViewUpdate":!0}),e.onDisplay=function(){ni.register("FOOT_PRINT_UPDATE",this,this.update),ni.register("FOOT_PRINT_SELECT_ITEM",this,this.onSelectItem),ni.register("BAGDATA_CHANGE",this,this.onBagChange),ni.register("MONEY_CHANGE",this,this.onBagChange)},e.unDisplay=function(){ni.remove("FOOT_PRINT_UPDATE",this,this.update),ni.remove("FOOT_PRINT_SELECT_ITEM",this,this.onSelectItem),ni.remove("BAGDATA_CHANGE",this,this.onBagChange),ni.remove("MONEY_CHANGE",this,this.onBagChange),this.eff&&(this.eff.unload(),this.eff=null),this._searchList=null,De.removeFromFrame(this,this.loopFootEff)},e.onBagChange=function(){this._cfgData&&this.updateOthers()},e.onSelectItem=function(t){this.tab.selectedIndex=t.color-Ni.tabColorOffset;for(var i=0;i<this.list.dataSource.length;i++){var e=this.list.getItem(i);if(e&&e.itemId==t.itemId)return void(this.list.selectedIndex=i)}},e.initStars=function(){this._stars=[];for(var t=0;t<10;t++){var i="star"+t;this._stars.push(this[i])}},e.onChange=function(){Ni.tabColorIdx=this.tab.selectedIndex,this.inputSearch.text="",this.update()},e.onItemSelected=function(t){Ni.tabItemIdx=t,this._cfgData=this.list.getItem(t),this._cfgData&&(this._ftData=Ni.getFootPrintVO(this._cfgData.id),this.updateStar(this._ftData?this._ftData.refine_level:0),this.updateAttrs(),this.updateOthers())},e.updateStar=function(t){for(var i=0;i<10;i++)this._stars[i].skin=i<t?"modules/footPrint/star.png":"modules/footPrint/star_bg.png"},e.updateAttrs=function(){for(var t=this._ftData&&this._ftData.refine_level?this._ftData.refine_level:0,i=Ni.getFootPurifyAttr(this._cfgData.id,t),e=Ni.getFootPurifyAttr(this._cfgData.id,t+1),s="",n=0;n<i.length;n++)s+=te.getName(i[n][0])+"+"+i[n][1],e?s+="  (下级"+e[n][1]+")":73==i[n][0]&&(s+="  (额外"+Math.ceil(.2*parseFloat(i[n][1]))+")"),s+="\n";this.txtAttr.text=s},e.updateOthers=function(){if(this._ftData){this.btnS.label=this._ftData.foot_id==Ni.curFootPrint?"脱下":"穿戴",this.btnP.label="淬炼",this._costNum=Ni.getFootPurifyCost(this._ftData.foot_id,this._ftData.refine_level+1),this._ownNum=ie.gold;var t=this._ownNum>=this._costNum?Qi.getColorLight(2):Qi.getColorLight(6);this.txtCost.innerHTML=pe.font("消耗元宝：","#6e3201",24)+pe.font(this._costNum+"",t,24),this.btnP.disabled=10==this._ftData.refine_level,10==this._ftData.refine_level&&(this.txtCost.innerHTML=pe.font("淬炼已满","#6e3201",24))}else{this.btnS.label="穿戴",this.btnP.label="激活",this.btnP.disabled=!1;var i=ve.getItem(this._cfgData.itemId);this._costNum=Ni.getFootPurifyCost(this._cfgData.id,0),this._ownNum=Ze.getGoodsNumByTypeID(this._cfgData.itemId),t=this._ownNum>=this._costNum?Qi.getColorLight(2):Qi.getColorLight(6),this.txtCost.innerHTML=pe.font("消耗","#6e3201",24)+pe.linkcolor("【"+i.name+"】","",!0,Qi.getColorLight(i.color).substr(1),24)+pe.font("×"+this._costNum,t,24)}this.txtDesc.text=this._cfgData.desc},e.getIdx=function(t){for(var i=0;i<this.list.dataSource.length;i++){var e=this.list.getItem(i);if(e&&e.id==t.id)return i}return 0},e.updateView=function(){if(this._cfgData){var t=this.getIdx(this._cfgData);Ni.tabItemIdx=t}this.list.selectedIndex=Ni.tabItemIdx,this._role||(this._role=new Yn,this._role.moveSpeed=100,this._role.scaleX=this._role.scaleY=1.2,this._role.pos(530,495));var i=new Object;i.className="p_skin",(i=ie.pals[0].ext.skin).mount=0,this._role.resetSkin(i,ie.sex,!0),this._role.resetState(0),this._role.play("walk",2),this.addChild(this._role),De.addToFrame(this,this.loopFootEff)},e.update=function(){this.tab.selectedIndex=Ni.tabColorIdx,Ni.searchTxt.length?(this.inputSearch.text=Ni.searchTxt,this.searchItem(this.inputSearch.text,!0)):(this.inputSearch.text="",this.updateFpItems(this._searchList)),this.updateView()},e.loopFootEff=function(){var t=this;if(this.FootEffTemp++,!(this.FootEffTemp<20)&&this._cfgData&&(this.FootEffTemp=0,!this.eff)){this.eff=ut.getOne(),this.eff.loadAndPlay(this._cfgData.effectUrl),this.eff.x=423,this.eff.y=481,this.eff.setEndHandler(ue.create(this,function(){t.eff.unload(),t.eff=null})),this.addChild(this.eff);eo.to(this.eff,{x:90,y:481},900,null,ue.create(this,function(){}))}},e.onClick=function(t){var i=this;switch(t.target){case this.btnS:if(this._ftData){var e=this._ftData.foot_id==Ni.curFootPrint?0:this._ftData.foot_id;Ei.ins().toFootPrintChange(e)}else io.addTip("无法穿戴，请先激活对应足迹");break;case this.btnP:if(this._ftData)if(this._ownNum>=this._costNum){var s=new q;s.msg=pe.span("是否消耗","#89511b")+pe.span(this._costNum+"元宝","#89511b")+pe.span("淬炼足迹?","#89511b"),s.yesCaller=this,s.yesFun=function(){Ei.ins().toFootPrintRefine(i._cfgData.id)},s.key="footPrintP",K.showVO(s)}else es.showAlert();else if(this._ownNum>=this._costNum){var n=ve.getItem(this._cfgData.itemId);(s=new q).msg=pe.span("是否消耗","#89511b")+pe.span(this._costNum+"个","#89511b")+pe.span("【"+n.name+"】",Qi.getColorLight(n.color))+pe.span("激活足迹?","#89511b"),s.yesCaller=this,s.yesFun=function(){var t=Ze.getGoodsByTypeID(i._cfgData.itemId);Ei.ins().toFootPrintActive(t.id)},s.key="footPrintAc",K.showVO(s)}else io.addTip("道具不足");break;case this.txtLink:Ei.ins().openBeautyView()}},e.onLink=function(t){if(!this._ftData){var i=new Object;i.className="p_goods",i.typeid=this._cfgData.itemId,i.current_num=1,to.show(i,"GOODS_TIP")}},e.onClickSearch=function(){var t=this.inputSearch.text;t.length?this.searchItem(t):io.addTip("请输入搜索内容")},e.onSearchChange=function(){this.inputSearch.text.length||this.updateFpItems(),Ni.searchTxt=this.inputSearch.text},e.searchItem=function(t,i){void 0===i&&(i=!1);for(var e=[],s=Ni.getFootListByColor(this.tab.selectedIndex+Ni.tabColorOffset,0).sort(Ni.sortFp),n=0;n<s.length;n++){-1!=ve.getItem(s[n].itemId).name.indexOf(t)&&e.push(s[n])}e.length?this.updateFpItems(e):(io.addTip("搜索失败，没有该道具"),i&&(this.inputSearch.text="",Ni.searchTxt="",this.updateFpItems()))},e.updateFpItems=function(t){this.list.dataSource=t||Ni.getFootListByColor(this.tab.selectedIndex+Ni.tabColorOffset,0).sort(Ni.sortFp),this._searchList=t}}(),function(t){function i(){i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!1,"TYPE_MAIN"),this.on("click",this,this.onClick),this.btn1.mouseEnabled=this.btn2.mouseEnabled=this.btn3.mouseEnabled=this.btn4.mouseEnabled=!0;for(var t=0;t<4;t++)an.register("RP_FASHION_NEW1_"+t,this.btn2,new Hs(19,-10)),an.register("RP_FASHION_NEW2_"+t,this.btn3,new Hs(19,-10)),an.register("RP_FASHION_NEW3_"+t,this.btn5,new Hs(19,-10));an.register("RP_FASHION4",this.btn1,new Hs(19,-10)),an.register("RP_FASHION1",this.btn2,new Hs(19,-10)),an.register("RP_FASHION2",this.btn3,new Hs(19,-10)),an.register("RP_FASHION3",this.btn5,new Hs(19,-10)),an.register("RP_FOOT_PRINT_PURIFY",this.btn4,new Hs(19,-10)),an.register("RP_FOOT_PRINT_CHANGE",this.btn4,new Hs(19,-10))}l(i,"modules.footPrint.SuitPanel",Ea),i.prototype.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow();break;case this.btn1:ni.dispatch("FASHION_OPEN",0);break;case this.btn2:ni.dispatch("FASHION_OPEN",1);break;case this.btn3:ni.dispatch("FASHION_OPEN",2);break;case this.btn4:Ae.linkTo(11527);break;case this.btn5:ni.dispatch("FASHION_OPEN",3)}}}(),function(t){var e;function i(){for(var t in this.reviewNotShowArr=null,this.speed=.8,this.bossTip=null,this.finish=!1,this.iconArr=null,this.iconCon=[701,251,301,102,1,551,13,9999991],this.dispCon=[9999991,9999991,9999991,9999991,9999992,9999991,13,9999991],this.nowIcons=null,this.initHie=!1,i.__super.call(this),this.iconArr=[this.imgFamily,this.imgCopy,this.imgAthletics,this.imgBoss,this.imgExercise,this.imgPlays,this.imgPal,this.imgCross],this.reviewNotShowArr=[this.imgFamily,this.imgExercise,this.imgPal,this.imgCross],this.preInitIconArr(),this.initView(),this.iconArr)this.iconArr[t].removeSelf();this.imgPal.on("display",this,this.onDisplay),(Ne.isWX||Ne.isQQ)&&(_t.isIphoneX?this.bottom=170:this.bottom=150)}l(i,"modules.navigation.FunctionBar",Yi);var s=i.prototype;return s.preInitIconArr=function(){for(var t=this.iconArr.length-1;0<=t;t--){var i=this.iconArr[t];i.visible=!1,ji.isReviewVersion&&0<=this.reviewNotShowArr.indexOf(i)&&this.iconArr.splice(t,1)}},s.onDisplay=function(t){Vh.isFanTi&&(this.imgCross.visible=!1),this.imgPal.on("undisplay",this,this.onUNDisplay),ni.register("ROLE_LEVEL_UP",this,this.checkLvCanTip),this.checkLvCanTip()},s.checkLvCanTip=function(){30<=ie.myLevel?(this.palTip.visible=!0,De.addToFrame(this,this.onEnterFrame),ni.remove("ROLE_LEVEL_UP",this,this.checkLvCanTip)):this.palTip.visible=!1},s.onUNDisplay=function(){this.hideTip()},s.hideTip=function(){ni.remove("ROLE_LEVEL_UP",this,this.checkLvCanTip),this.palTip.visible=!1,De.removeFromFrame(this,this.onEnterFrame),this.imgPal.off("undisplay",this,this.onUNDisplay)},s.onEnterFrame=function(){this.palTip.y+=this.speed,(this.palTip.y<=-120||-100<=this.palTip.y)&&(this.speed*=-1)},s.resetIconPos=function(t){void 0===t&&(t=!1),this.nowIcons=[];for(var i=0;i<this.iconArr.length;i++){var e=this.iconCon[i],s=this.dispCon[i],n=e%10;e=(e-n)/10,s=(s-n)/10;var h=NaN;switch(n){case 1:h=ie.myEquipLevel;break;case 2:h=qt.curBarrier;break;case 3:h=ie.pals.length}if((e-h)*(s-h)<=0)(this.iconArr[i]!=this.imgPal||10<=ie.myEquipLevel)&&this.nowIcons.push(this.iconArr[i]);else if(this.iconArr[i]==this.imgCross&&Ht.isCrossOpen)this.nowIcons.push(this.iconArr[i]);else{var a=this.nowIcons.indexOf(this.iconArr[i]);0<=a&&this.nowIcons.splice(a,1)}}var o;for(var r in this.iconArr)o=this.iconArr[r],this.nowIcons.indexOf(o)<0&&o.removeSelf();for(var l=0;l<this.nowIcons.length;l++){var c=683-87*l,d=this.nowIcons[l];t?(d.x=c,d.alpha=1,d.parent||(this.addChild(d),d.visible=!0)):d.parent?eo.to(d,{x:c},c,ai.quadOut,null,0,!0):(d.x=c,this.addChild(d),d.visible=!0,this.show(d))}this.nowIcons.length==this.iconArr.length&&(this.finish=!0)},s.show=function(t){var i=this,e=t.y,s=t.x,n=Te.stageWidth/2-this.x,h=Te.stageHeight/2-this.y,a=ri.show("unit/effect/func2",n,h,this);a.rotation=90+180*Math.atan2(h-e,n-s)/Math.PI,eo.to(a,{x:s,y:e},1200,ai.cubicOut,ue.create(this,function(){ri.show("unit/effect/func3",s,e,i),t.alpha=1},null,!0))},s.initView=function(){var t;for(var i in this.bossTip=new e,this.imgBoss.addChild(this.bossTip),this.bossTip.visible=!1,Vh.isFanTi||(an.register("PR_REFINE_SOUL_PALACE_SUPPLY",this.imgPlays),an.register("PR_REFINE_SOUL_PALACE_MISSION",this.imgPlays),an.register("PR_REFINE_SOUL_PALACE_BAG",this.imgPlays),an.register("PR_REFINE_SOUL_PALACE_INJECT",this.imgPlays),an.register("PR_REFINE_SOUL_PALACE_INLAY",this.imgPlays)),an.register("RP_STRANGEFIRE_MAGATAMA",this.imgExercise),an.register("RP_STRANGEFIRE_REFINE_UP",this.imgExercise),an.register("RP_STRANGEFIRE_REFINE_AIM_UP",this.imgExercise),an.register("RP_BIOGRAPHY_CARD_CAN_UPGRADE",this.imgExercise),an.register("RP_BIOGRAPHY_COPY_CAN_FIGHT",this.imgPlays),an.register("RP_BIOGRAPHY_CAN_BOUNTY",this.imgPlays),an.register("RP_BIOGRAPHY_BOUNTY_NOT_FINISH",this.imgPlays),an.register("RP_BIOGRAPHY_BOUNTY_NOT_GET",this.imgPlays),an.register("RP_MERIDIAN_REWARD",this.imgExercise),an.register("RP_MERIDIAN_UP",this.imgExercise),an.register("RP_RUNE_PACK",this.imgExercise),an.register("RP_RUNE_FREE_GET_SCORE",this.imgExercise),an.register("RP_RUNE_CAN_INLAY",this.imgExercise),an.register("RP_RUNE_INLAY_STONE",this.imgExercise),an.register("RP_RUNE_CAN_UP",this.imgExercise),an.register("RP_RUNE_CORE_CAN_UP",this.imgExercise),an.register("RP_FIGHT_SOUL_SPIRIT_TAB",this.imgExercise),an.register("RP_FIGHT_SOUL_TAB",this.imgExercise),an.register("RP_EXERCISE_KNIGHTHOOD",this.imgExercise),an.register("RP_EXERCISE_PEARL",this.imgExercise),an.register("RP_EXERCISE_GODEQUIP",this.imgExercise),an.register("RP_EXERCISE_GODEQUIP_STONE",this.imgExercise),an.register("RP_BEASTS_TEAM_ACTIVE",this.imgExercise),an.register("RP_BEASTS_ALONE_ACTIVE",this.imgExercise),an.register("RP_BEASTS_ALONE_LV",this.imgExercise),an.register("RP_BEASTS_TEAM_STEP",this.imgExercise),an.register("RP_BEASTS_ALONE_STEP",this.imgExercise),an.register("RP_BEASTS_RESONANCE",this.imgExercise),an.register("RP_BEASTS_STAR",this.imgExercise),an.register("RP_SPIRITRE",this.imgExercise),an.register("RP_SPIRITRE_AUTO_SUIT_",this.imgExercise),an.register("RP_BEATSTBOOK",this.imgExercise),an.register("RP_ATHLETICS_ENCOUNTER",this.imgAthletics),an.register("RP_ATHLETICS_SNATCH",this.imgAthletics),an.register("RP_ATHLETICS_SNATCH_LOG",this.imgAthletics),an.register("RP_ATHLETICS_SOLORANKING",this.imgAthletics),an.register("RP_ATHLETICS_SOLORANKING_REWARD",this.imgAthletics),an.register("RP_PET_SPORTS_CAN_CHALLENGE",this.imgAthletics),an.register("RP_PET_SPORTS_CAN_GET3",this.imgAthletics),an.register("RP_PET_SPORTS_CAN_GET5",this.imgAthletics),an.register("RP_BOSS_WORLD",this.imgBoss),an.register("RP_BOSS_ROLE",this.imgBoss),an.register("RP_REGROW_BOSS",this.imgBoss),an.register("RP_MONSTER_BOSS",this.imgBoss),an.register("RP_COPY_MATERIALS",this.imgCopy),an.register("RP_DREAM_BOX",this.imgCopy),an.register("RP_DREAM_SOUL",this.imgCopy),an.register("RP_ETERNAL_SKY",this.imgCopy),an.register("RP_TEAM_COPY",this.imgCopy),an.register("RP_COPY_STRANGE_FIRE",this.imgCopy),an.register("RP_COPY_TALIMAN",this.imgCopy),an.register("RP_LOVE_COPY",this.imgCopy),an.register("RP_FAMILY_BOSS",this.imgFamily),an.register("RP_FAMILY_COPY",this.imgFamily),an.register("PR_FAMILY_BATTLE_SIGN_UP",this.imgFamily),an.register("PR_FAMILY_BATTLE_SET_FIGHT_MEMBER",this.imgFamily),an.register("PR_FAMILY_BATTLE_SET_FIGHT_ING",this.imgFamily),an.register("RP_FAMILY_REQUEST",this.imgFamily),an.register("RP_CITY_BE_FIGHT",this.imgPlays),an.register("RP_CITY_FUN_CAN_DO",this.imgPlays),an.register("RP_PLAYS_BEACH_BOSS",this.imgPlays),an.register("RP_PLAYS_BEACH",this.imgPlays),an.register("RP_PLAYS_BAILINGYUAN",this.imgPlays),an.register("RP_PET_EXPLORE_GET",this.imgPlays),an.register("RP_PET_TOWER_BARRIER",this.imgPlays),an.register("RP_TREASURE_FREE",this.imgPlays),an.register("RP_TREASURE_USE",this.imgPlays),an.register("RP_BATTEL_FIELD",this.imgPlays),an.register("PR_FAMILY_BATTLE_SIGN",this.imgFamily),an.register("PR_FAMILY_BATTLE_FIGHT",this.imgFamily),an.register("RP_CROSS_SERVER_SHOP_CAN_GAIN",this.imgCross),an.register("RP_CROSS_SERVER_SHOP_CAN_REMOVE",this.imgCross),an.register("PR_TALISMAN",this.imgExercise),ni.register("BOSS_REVIVE",this,this.updateBossTip),this.mouseThrough=!0,this.on("click",this,this.onClick),this.on("mousedown",this,this.onMouseDown),this.on("mouseup",this,this.onMouseUp),this.iconArr)(t=this.iconArr[i]).on("mouseover",this,this._$7_onMouseOver),t.on("mouseout",this,this._$7_onMouseOut)},s.onMouseUp=function(){for(var t in this.nowIcons)this.nowIcons[t].scale(1,1)},s._$7_onMouseOver=function(t){t.target.y-=3},s._$7_onMouseOut=function(t){t.target.y+=3,t.target.scale(1,1)},s.onMouseDown=function(t){t.target instanceof laya.ui.Image&&t.target.scale(.9,.9)},s.updateBossTip=function(t){this.bossTip.text=t},s.onClick=function(t){switch(t.target){case this.imgBoss:Ae.linkTo(10301);break;case this.imgAthletics:Xi.isOpenEncounter()?Ae.linkTo(10501):io.addTip("该功能30级开启");break;case this.imgCopy:Ae.linkTo(10601);break;case this.imgExercise:Ae.linkTo(10800);break;case this.imgFamily:Ae.linkTo(11301);break;case this.imgPlays:Ae.linkTo(11701);break;case this.imgPal:this.hideTip(),3<ie.pals.length?io.addTip("您已经开启所有的伙伴了哦"):Ae.linkTo(10002),1<ie.pals.length&&this.resetIconPos();break;case this.imgCross:Wt.ins().openEnterPanel()}},i.IMG_SCALE=.9,i.__init$=function(){e=function(t){function i(){this.auto=null,this.t=null,i.__super.call(this),this.t=so.createText("",0,0,300,36,this),this.t.align="center",this.t.valign="middle",this.t.color="#ffff00",this.t.fontSize=22;var t=Oe.getRes("com/ui/panelSkin2.png");this.auto=new X,this.auto.sizeGrid=[13,7,13,9],this.auto.source=t,this.graphics=this.auto}return l(i,"",Ta),o(0,i.prototype,"text",null,function(t){var i=this;""==t?this.visible=!1:(this.visible=!0,this.t.text=t,this.t.width=this.t.textWidth+20,this.auto.width=this.t.width,this.auto.height=40,De.setTimeout(this,function(){i.visible=!1},null,5e3)),this.parent&&(this.x=this.parent.width-this.auto.width,this.y=-this.auto.height)}),i}()},i}()),tr=(function(t){function i(){this.clip=null,this._blessVO=null,this._blessInfo=null,this._infoArr=null,i.__super.call(this),this.txtNum.style.align="left",this.txtNum.style.valign="middle",this.txtNum.style.fontSize=24,this.btnUp.on("click",this,this.onClick),this.on("display",this,this.onDisplay),an.register("RP_CITY_DRAGON_CAVE_CAN_BLESS_UP",this.btnUp,new Hs(20,-13))}l(i,"modules.plays.city.PlaysCityCaveBlessView",Os);var e=i.prototype;s.imps(e,{"com.ui.IViewUpdate":!0}),e.onClick=function(){var t=ie.getScore(37);"已满级"==this.btnUp.label?io.addTip("古龙祝福已满级"):t>=this._blessVO.costPerLv?As.ins().toCaveGragonBless():io.addTip("龙灵结晶不足，请先进行献祭")},e.onDisplay=function(){this.init()},e.init=function(){var t=Fs.getCaveBlessVO();this._blessVO=t[0],this.clip=this.clip||new ut,this.clip.stop(),this.clip.loadAndPlay(this._blessVO.img,"default",0,!0),this.clip.pos(341,269),this.addChild(this.clip)},e.update=function(){this._blessInfo=Fs.getCaveInfo(),this.txtLv.text="祝福等级：Lv."+this._blessInfo.blessLevel,this._infoArr=this._blessInfo.blessProp;var t="",i="";0<this.handlerAttr("生命")&&(t+="生命 +"+this.handlerAttr("生命")+"\n",i+="生命 +"+(this.handlerAttr("生命")+parseInt(this._blessVO.perAttr[0]))+"\n"),0<this.handlerAttr("攻击")&&(t+="攻击 +"+this.handlerAttr("攻击")+"\n",i+="攻击 +"+(this.handlerAttr("攻击")+parseInt(this._blessVO.perAttr[1]))+"\n"),0<this.handlerAttr("物防")&&(t+="物防 +"+this.handlerAttr("物防")+"\n",i+="物防 +"+(this.handlerAttr("物防")+parseInt(this._blessVO.perAttr[2]))+"\n"),0<this.handlerAttr("法防")&&(t+="法防 +"+this.handlerAttr("法防")+"\n",i+="法防 +"+(this.handlerAttr("法防")+parseInt(this._blessVO.perAttr[3]))+"\n"),""==t?(this.attrCur.text="生命 +0\n攻击 +0\n物防 +0\n法防 +0",this.attrNext.text="生命 +"+this._blessVO.perAttr[0]+"\n攻击 +"+this._blessVO.perAttr[1]+"\n物防 +"+this._blessVO.perAttr[2]+"\n法防 +"+this._blessVO.perAttr[3]+"\n"):(this.attrCur.text=t,this.attrNext.text=i);var e=ie.getScore(37),s=this._blessVO.costPerLv,n=ie.getScore(37)>=this._blessVO.costPerLv?"#96f254":"#b60202";this.txtNum.innerHTML=pe.span(e+"",n)+pe.span("/"+s,"#ffe0cf"),this.imgGold.x=this.width/2-(this.imgGold.width+this.txtNum.contextWidth)/2-15,this._blessInfo.blessLevel>=this._blessVO.maxLv?(this.btnUp.label="已满级",this.btnUp.gray=!0,this.attrCur.x=200,this.imgArrow.visible=this.attrNext.visible=!1):(this.btnUp.label="提升等级",this.btnUp.gray=!1,this.attrCur.x=49,this.imgArrow.visible=this.attrNext.visible=!0)},e.handlerAttr=function(t){var i;for(var e in this._infoArr)if(i=this._infoArr[e],this.transAttr(i.prop_code)==t)return i.prop_value;return-1},e.transAttr=function(t){var i=te.getName(t);switch(i){case"物攻":case"法攻":i="攻击"}return i}}(),function(t){function i(){this._data=null,this.goods=null,this._type=0,i.__super.call(this),this.imgBg.visible=!1,this.on("click",this,this.onClick)}l(i,"modules.plays.city.PlaysCityCaveChooseItem",Ps);var e=i.prototype;e.onClick=function(t){},o(0,e,"type",null,function(t){0==(this._type=t)?(this.cBox.selected=!1,0<Ze.getGoodsNumByTypeID(this._data.id)&&Fs.checkSacrificeCondition(this._data.id)?(this.cBox.visible=!0,this.goods.gray=!1,this.txtDes.text="拥有数量："+(Ze.getGoodsNumByTypeID(this._data.id)-Fs.getSacrificeNum(this._data.id))):(this.cBox.visible=!1,this.goods.gray=!0,this.txtDes.text=this._data.condition)):1==t&&(this.cBox.visible=!1,this.txtDes.text=this._data.condition)}),o(0,e,"data",null,function(t){if(t){this._data=t;var i=ve.getItem(t.id);this.removeChild(this.goods),this.goods=new ae(i),this.goods.pos(25,22),this.addChild(this.goods),this.txtName.text=i.name}}),o(0,e,"typeID",function(){return this._data.id}),o(0,e,"choosed",function(){return this.cBox.selected})}(),function(t){function i(){this.dragonArr=null,this.itemArr=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.panel.vScrollBar.autoHide=!0,this.on("click",this,this.onClick),this.init()}l(i,"modules.plays.city.PlaysCityCaveDragonChoosePanel",Vs);var e=i.prototype;e.init=function(){this.dragonArr=Fs.getCaveDragons()},e.onClick=function(t){switch(t.target){case this.btnChoose:As.ins().toCaveSacrifice(1),Fs._sacrificeItemArr=[],this.closeWindow();break;case this.btnClose:case this.btnClose2:this.closeWindow()}},e.update=function(){if(this.itemArr&&0<this.itemArr.length)for(var t=0;t<this.itemArr.length;t++)this.panel.removeChild(this.itemArr[t]),this.itemArr[t]=null;var i;if(this.itemArr=[],this.dragonArr&&this.dragonArr.length)for(var e=0;e<this.dragonArr.length;e++)(i=Na.getIns(42e3,"city.PlaysCityCaveDragonItem")).data=this.dragonArr[e],i.pos(5,205*e),this.itemArr.push(i),this.panel.addChild(i)}}(),function(t){function i(){this._data=null,this._type=0,i.__super.call(this),this.on("click",this,this.onClick),ni.register("PLAYS_CITY_CAVE_SACRIFICE_DRAGON_SELECTED",this,this.updateSelected)}l(i,"modules.plays.city.PlaysCityCaveDragonItem",Rs);var e=i.prototype;e.onClick=function(t){Fs._sacrificeDragonType=this._type,ni.dispatch("PLAYS_CITY_CAVE_SACRIFICE_DRAGON_SELECTED",this._data.id)},e.updateSelected=function(t){t==this._data.id?this.imgSelected.visible=!0:this.imgSelected.visible=!1},o(0,e,"type",function(){return this._type}),o(0,e,"data",null,function(t){1==(this._data=t).id?(Fs._sacrificeDragonType=t.id,this.imgSelected.visible=!0):this.imgSelected.visible=!1,this.imgDragon.skin=t.img,this.txtName.text=t.name,this.txtDes.text=t.desc,this._type=t.id;var i=Qt.formatDHMSArrInt(Fs.getSacrificeTime(t.id));60<=Math.ceil(i[3])&&(i[3]-=60,i[2]++),60<=Math.ceil(i[2])&&(i[2]-=60,i[1]++),0<i[0]&&(i[1]+=24*i[0],i[0]=0);var e=0<i[1]?i[1]+"小时":"",s=0<i[2]?i[2]+"分钟":"",n=0<i[3]?Math.ceil(i[3])+"秒":"",h=0<i[1]+i[2]+i[3]?"献祭需要"+(0<i[1]?e+s:s+n):"立即完成献祭";this.txtTime.text=h+"，可获得"+100*this._data.rate+"%收益",this.txtReward.text="献祭完成可获得"+Math.ceil(Fs.sacrificeReward*this._data.rate)+"龙灵结晶"})}(),function(t){function i(){this.itemIDArr=null,this.itemArr=null,this.item=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.list.vScrollBar.hide=!0,this.on("click",this,this.onClick),this.on("display",this,this.onScroll)}l(i,"modules.plays.city.PlaysCityCaveItemChoosePanel",Ds);var e=i.prototype;e.init=function(){this.itemIDArr=Fs.getCaveSacriItemIDs(),this.itemIDArr.sort(Fs.sortOnCanSacrifice)},e.update=function(){if(this.itemArr&&0<this.itemArr.length)for(var t=0;t<this.itemArr.length;t++)this.list.removeChild(this.itemArr[t]),this.itemArr[t]=null;if(this.itemArr=[],this.itemIDArr&&this.itemIDArr.length)for(var i=0,e=0;e<this.itemIDArr.length;e++){var s=Fs.getCaveSacriItemVO(this.itemIDArr[e]);Fs.getIsSacrificeItem(this.itemIDArr[e])&&Ze.getGoodsNumByTypeID(this.itemIDArr[e])-Fs.getSacrificeNum(this.itemIDArr[e])<=0||(this.itemArr[i]=this.itemArr[i]||Na.getIns(42e3,"city.PlaysCityCaveChooseItem"),this.item=this.itemArr[i],this.item.y=137*i,this.item.data=s,this.item.type=0,this.list.addChild(this.item),i++)}},e.onScroll=function(){this.init(),this.list.scrollTo(0),this.list.refresh()},e.onClick=function(t){switch(t.target){case this.btnChoose:this.checkSacri();break;case this.btnClose:case this.btnClose2:this.closeWindow()}},e.checkSacri=function(){var t,i,e=0,s=[];if(Fs._sacrificeItemArr&&0<Fs._sacrificeItemArr.length)for(var n in Fs._sacrificeItemArr)0<(t=Fs._sacrificeItemArr[n]).type_id&&(e++,s.push(t.type_id));for(var h in this.itemArr)(i=this.itemArr[h])&&i.choosed&&e++;if(e>Fs.dragonCaveOpenedBlockNum)io.addTip("献祭格子不足，请重新选择");else{for(var a=0;a<this.itemArr.length;a++)this.itemArr[a]&&this.itemArr[a].choosed&&s.push(this.itemArr[a].typeID);if(s.length<Fs.dragonCaveOpenedBlockNum){var o=Fs.dragonCaveOpenedBlockNum-s.length;for(a=0;a<o;a++)s.push(0)}Fs.sacrificeItemArr=s,As.ins().updateCavePanel(),this.closeWindow()}}}(),function(t){function i(){this.openVO=null,this.canOpen=!1,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.des.style.leading=10,this.des.style.fontSize=24,this.des.style.color="#5d3924",this.on("click",this,this.onClick),this.init(),an.register("RP_CITY_DRAGON_CAVE",this.btnOpen,new Hs(20,-8))}l(i,"modules.plays.city.PlaysCityCaveOpenPanel",Ns);var e=i.prototype;e.init=function(){this.openVO=Fs.getCaveOpenVO()},e.update=function(){this.openVO&&(this.des.innerHTML=this.openVO.openDes,this.txtItem1.text="符炉等级达到Lv."+this.openVO.openLv),this.checkOpenCondition()},e.checkOpenCondition=function(){Fs.checkOpenReach()?(this.canOpen=!0,this.btnOpen.gray=!1,this.btnOpen.mouseEnabled=!0,this.txtDes.visible=!1,this.imgItem1.visible=!0):(this.canOpen=!1,this.btnOpen.gray=!0,this.btnOpen.mouseEnabled=!1,this.txtDes.visible=!0,this.imgItem1.visible=!1)},e.onClick=function(t){switch(t.target){case this.btnOpen:this.openVO&&1==this.canOpen&&(As.ins().toUnlockCave(),As.ins().openCavePanel(0));break;case this.btnClose:case this.btnClose2:this.closeWindow()}}}(),function(t){function i(){this.curView=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.tab.on("change",this,this.setTabIndex),this.tab.itemClickFun=new ue(this,this.onItemClick),an.register("RP_CITY_DRAGON_CAVE_CAN_BLESS_UP",this.tab.items[1],new Hs(19,-10))}l(i,"modules.plays.city.PlaysCityCavePanel",Es);var e=i.prototype;e.onDisplay=function(){As.ins().toGetAllInfo()},e.onItemClick=function(t){this.tab.selectedIndex=t},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:Fs._sacrificeItemArr=[],this.closeWindow()}},e.setTabIndex=function(){switch(this.spView.removeChildren(),this.tab.selectedIndex){case 0:this.curView=Na.getIns(42e3,"city.PlaysCityCaveSacrificeView");break;case 1:this.curView=Na.getIns(42e3,"city.PlaysCityCaveBlessView")}this.curView&&(this.spView.addChild(this.curView),this.curView.update())},e.chooseTab=function(t){this.tab.selectedIndex=t,this.setTabIndex()},e.update=function(){this.curView&&this.curView.update()}}(),function(t){function i(){this.itemIDArr=null,this.itemArr=null,this.bookItem=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.panel.vScrollBar.autoHide=!0,this.init(),this.on("click",this,this.onClick)}l(i,"modules.plays.city.PlaysCityCaveSacriBookPanel",Bs);var e=i.prototype;e.init=function(){this.itemIDArr=Fs.getCaveSacriItemIDs()},e.displayBook=function(){if(this.itemArr=this.itemArr||[],this.itemIDArr&&this.itemIDArr.length)for(var t=0;t<this.itemIDArr.length;t++)this.itemArr[t]=this.itemArr[t]||Na.getIns(42e3,"city.PlaysCityCaveChooseItem"),this.bookItem=this.itemArr[t],this.bookItem.y=137*t,this.bookItem.data=Fs.getCaveSacriItemVO(this.itemIDArr[t]),this.bookItem.type=1,this.panel.addChild(this.bookItem)},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow()}},e.update=function(){this.displayBook()}}(),function(t){function i(){this._pos=0,this._num=0,this._type=NaN,this._goods=null,this.avo=null,this.info=null,i.__super.call(this),this.txtNum.style.align="center"}l(i,"modules.plays.city.PlaysCityCaveSacrificeItem",Ls);var e=i.prototype;e.onClick=function(t){switch(this.info=Fs.getCaveInfo(),this._type){case 0:if(this.info&&this.info.rewardInfo&&0<this.info.rewardInfo.length)return void(this.info.remainTime<=0?io.addTip("请先领取"):io.addTip("请等待献祭结束"));this.avo=new q,this.avo.msg=pe.span("是否花费","#5d3924")+Fs.getCaveSacriPosVO(Fs.dragonCaveOpenedBlockNum+1).cost+pe.span("紫晶币进行解锁？","#5d3924"),(this.avo.yesCaller=this).avo.yesFun=this.toUnlock,this.avo.key="unlockCaveBlock",K.showVO(this.avo);break;case 1:As.ins().openItemChoosePanel();break;case 2:break;default:var i={id:this._type,num:this._num};Fs.resetSacrificeItemAr(i)}},e.toUnlock=function(){ie.getScore(15)>=Fs.getCaveSacriPosVO(Fs.dragonCaveOpenedBlockNum+1).cost?As.ins().toUnlockCaveBlock():io.addTip("紫晶币不足，无法进行解锁")},o(0,e,"position",null,function(t){this._pos=t}),o(0,e,"num",null,function(t){this._num=t}),o(0,e,"type",null,function(t){switch(this._type=t,this.removeChild(this._goods),t){case 0:this.bmpDefault.visible=!0,this.txtName.text="尚未解锁",this.txtName.color="#b60202",this.txtNum.visible=!1,this.on("click",this,this.onClick);break;case 1:this.bmpDefault.visible=!0,this.txtName.text="点击添加物品",this.txtName.color="#5d3924",this.txtNum.visible=!1,this.on("click",this,this.onClick);break;case 2:this.bmpDefault.visible=!0,this.txtName.text="献祭中",this.txtName.color="#b60202",this.txtNum.innerHTML=pe.span("无法添加物品","#b60202"),this.txtNum.visible=!0,this.off("click",this,this.onClick);break;default:this.bmpDefault.visible=!1,this.txtName.text=ve.getItem(t).name,this.txtName.color="#5d3924",this.txtNum.innerHTML=pe.span("数量：","#5d3924")+pe.span(this._num+"","#ffe0cf"),this.txtNum.visible=!0,this._goods=new ae(ve.getItem(t),!1,!1),this._goods.pos(35,-2),this.addChild(this._goods),this.on("click",this,this.onClick)}})}(),function(t){function i(){this.avo=null,this.caveInfo=null,this.time=NaN,this.sacriItemArr=null,i.__super.call(this),this.txtNum.style.align="left",this.txtNum.style.valign="middle",this.txtNum.style.fontSize=24,this.txtCon.style.fontSize=24,this.txtCon.style.align="left",this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),an.register("RP_CITY_DRAGON_CAVE_LV_UP",this.btnUp,new Hs(20,-13)),an.register("RP_CITY_DRAGON_CAVE_CAN_GET_REWARD",this.btnSacri,new Hs(20,-11))}l(i,"modules.plays.city.PlaysCityCaveSacrificeView",Ms);var e=i.prototype;s.imps(e,{"com.ui.IViewUpdate":!0}),e.onDisplay=function(){As.ins().toCaveInfo(),this.on("undisplay",this,this.onUnDisplay)},e.onUnDisplay=function(){De.removeFromSceond(this,this.updateBar)},e.onClick=function(t){switch(t.target){case this.btnUp:this.toUp();break;case this.imgBook:As.ins().openSacriBookPanel();break;case this.btnSacri:Fs._readyToSacrifice?As.ins().openDragonChoosePanel():Fs._isSacrifice?0<this.time?(this.avo=new q,this.avo.msg=pe.span("放弃献祭将不返还已经献祭的物品，是否仍要放弃此次献祭？","#621e09"),this.avo.yesCaller=As.ins(),this.avo.yesFun=As.ins().toCaveSacrifice,this.avo.yesArgs=[2],this.avo.key="dragon_cave_break_sacrifice",K.showVO(this.avo)):As.ins().toGainCaveReward():io.addTip("请先放置献祭物品")}},e.toUp=function(){if(this.caveInfo){var t=Fs.getCaveVO(Fs._dragonCaveLevel);Fs.curCityLv<t.upLv?io.addTip("符炉等级不满足升级条件"):ie.getScore(15)<t.upNum?io.addTip("紫晶币数量不足以进行升级"):As.ins().toCaveUp()}},e.update=function(){this.resetItem(),this.updateInfo(),this.updateTop(),this.updateItem(),this.updateTime(),this.updateNum()},e.updateInfo=function(){this.caveInfo=Fs.getCaveInfo(),this.caveInfo&&(this.time=this.caveInfo.remainTime)},e.updateTop=function(){if(this.caveInfo){var t=Fs.getCaveVO(Fs._dragonCaveLevel),i=Fs.getCaveVO(Fs._dragonCaveLevel+1);this.txtLv.text=Fs._dragonCaveLevel+"",this.txtCurr.text="献祭所需时间减少"+t.effect+"%",i?(this.txtNext.text="献祭所需时间减少"+i.effect+"%",this.txtCon.innerHTML=pe.span("符炉等级Lv."+t.upLv,"#ffe0cf")+pe.span("、","#ffe0cf")+pe.span("紫晶币","#f299ff")+pe.span("x"+t.upNum,"#ffe0cf"),this.btnUp.label="升级",this.btnUp.gray=!1,this.btnUp.mouseEnabled=!0):(this.txtNext.text="已达最大等级",this.txtCon.innerHTML="",this.btnUp.label="已满级",this.btnUp.gray=!0,this.btnUp.mouseEnabled=!1)}},e.resetItem=function(){if(this.imgTitle.skin="",this.imgTitle.skin="modules/playsCity/builder3_2.png",this.sacriItemArr&&0<this.sacriItemArr.length)for(var t=0;t<this.sacriItemArr.length;t++)this.removeChild(this.sacriItemArr[t]),this.sacriItemArr[t];var i;this.sacriItemArr=[];for(var e=0;e<4;e++)(i=Na.getIns(42e3,"city.PlaysCityCaveSacrificeItem")).pos(Gs.SACRI_ITEM_POS[e][0],Gs.SACRI_ITEM_POS[e][1]),i.position=e+1,i.type=0,this.addChild(i),this.sacriItemArr.push(i)},e.updateItem=function(){var t,i=Fs.sacrificeItemArr;if(i&&0<i.length)Fs._readyToSacrifice=!0,Fs._isSacrifice=!1;else if(Fs._readyToSacrifice=!1,this.caveInfo)for(var e in i=this.caveInfo.blockInfo){if(0<i[e].type_id){Fs._isSacrifice=!0;break}Fs._isSacrifice=!1}for(var s=0;s<this.sacriItemArr.length;s++)i&&i[s]&&(0<(t=i[s]).type_id?(this.sacriItemArr[s].num=t.item_num,this.sacriItemArr[s].type=t.type_id):(this.sacriItemArr[s].num=0,this.sacriItemArr[s].type=Fs._isSacrifice?2:1))},e.updateTime=function(){Fs._isSacrifice&&this.time<=0?(De.removeFromSceond(this,this.updateBar),this.btnSacri.label="领取",this.imgClock.visible=!1):Fs._isSacrifice?(this.btnSacri.label="放弃献祭",De.addToSecond(this,this.updateBar)):(De.removeFromSceond(this,this.updateBar),this.btnSacri.label="开始献祭",this.imgClock.visible=!1)},e.updateNum=function(){switch(this.btnSacri.label){case"领取":case"放弃献祭":var t;this.caveInfo&&this.caveInfo.rewardInfo&&0<this.caveInfo.rewardInfo.length&&(t=this.caveInfo.rewardInfo[0],this.txtNum.innerHTML=pe.span(t.val+"","#ffe0cf"),this.imgGold.x=this.width/2-(this.imgGold.width+this.txtNum.contextWidth)/2-15,this.imgGold.visible=!0);break;case"开始献祭":this.imgGold.visible=!1}},e.updateBar=function(){this.time<=0&&(De.removeFromSceond(this,this.updateBar),this.update()),this.imgClock.visible=!0;var t=Qt.formatDHMSArrInt(this.time);0<t[0]&&(t[1]+=24*t[0],t[0]=0);var i=0<t[1]?t[1]+"小时":"",e=0<t[2]?t[2]+"分":"",s=0<t[3]?t[3]+"秒":"";this.txtTimeDes.text=i+e+s+"后完成献祭";this.imgBar.width=(this.totalTime-this.time)/this.totalTime*300,this.time--},o(0,e,"totalTime",function(){var t,i=0,e=Fs.getCaveVO(Fs._dragonCaveLevel);if(this.caveInfo&&this.caveInfo.blockInfo){var s;for(var n in this.caveInfo.blockInfo)0<(s=this.caveInfo.blockInfo[n]).type_id&&(t=Fs.getCaveSacriItemVO(s.type_id),i+=s.item_num*t.costTime);i*=Fs.getCaveDragonsByID(this.caveInfo.actionType).time}return i*e.time})}(),function(t){function i(){this._itemList=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.panel.vScrollBar.autoHide=!0,this._itemList=[],this.on("click",this,this.onClick)}l(i,"modules.rank.RankAwardDisplayPanel",Ys);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow()}},e.updateView=function(){for(var t,i,e,s=0,n=[],h=[],a=0;a<Xs.PANEL_RANKS.length;a++){var o,r=Xs.PANEL_RANKS[a];if((i=Js.getRankCfgVO(r))&&i.titleIds&&0<i.titleIds.length)for(var l in i.titleIds)o=i.titleIds[l],n.push(o),h.push(r)}var c;if((i=Js.getRankCfgVO(4101))&&i.titleIds&&0<i.titleIds.length)for(var d in i.titleIds)c=i.titleIds[d],n.push(c),h.push(4101);for(var u=Math.max(this._itemList.length,n.length),p=0;p<u;p++)if(p<n.length){var m=n[p];e=ja.getTitleVO(m),this._itemList[p]=this._itemList[p]||new qs,(t=this._itemList[p]).index=p,t.rankName=Xs.getRankName(h[p]),t.titleVo=e,t.y=s,t.on("RANK_CHANGE_TITLE_DISPLAY",this,this.onChangeDisplayState),this.panel.addChild(t),s+=t.height+15}else this._itemList[p].removeSelf()},e.onChangeDisplayState=function(t,i){for(var e="detail"==t?200:-200,s=i+1;s<this._itemList.length;s++){this._itemList[s].y+=e}},e.destroy=function(t){void 0===t&&(t=!0),laya.ui.View.prototype.destroy.call(this,t)}}(),function(t){function i(){i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick)}l(i,"modules.role.fashion.FashionBeautyView",xi);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnRe:case this.btnClose:this.closeWindow()}},e.update=function(t){var i=ie.getPalByIndex(t);this.txtNum.text=i.base.beauty+"",this.txtCa.text=_i.VOCA[i.ext.category];var e,s=Rt.numToTexture(5*i.base.beauty);this.spPower.graphics.clear();for(var n=0;n<s.length;n++)e=s[n],this.spPower.graphics.drawTexture(e,e.width*n)}}(),function(t){function i(){this._data=null,this.ftxtName=null,this._fTxtNameOriginX=NaN,this._blueVipBox=null,this._blueVipBoxMarry=null,i.__super.call(this),this.ftxtName=new Pi,this.ftxtName.pos(107,17),this.addChild(this.ftxtName),this._fTxtNameOriginX=this.ftxtName.x,this.on("click",this,this.onClick)}l(i,"modules.rank.RankListItem",t);var e=i.prototype;e.reset=function(){this.ftxtName.clear(),this.txtRanklv.text=this.txtExtra.text="",this._blueVipBox&&this._blueVipBox.removeSelf(),this._blueVipBoxMarry&&this._blueVipBoxMarry.removeSelf(),this.ftxtName.x=this._fTxtNameOriginX},e.onClick=function(t){console.log("点击")},e.updateBlueVip=function(t,i){if(Vh.isQQyxdt()){this.ftxtName.x=this._fTxtNameOriginX;var e=new ft;if(1008==i){e.blueInfo=e[0],e.nameText=this.ftxtName,this._blueVipBox=this._blueVipBox||new mt,this.addChild(this._blueVipBox),this._blueVipBox.updateShowing(e);var s=new ft;s.blueInfo=e[1],s.nameText=this.ftxtName,this._blueVipBoxMarry=this._blueVipBoxMarry||new mt,this.addChild(this._blueVipBoxMarry),this._blueVipBoxMarry.updateShowing(s),0<this._blueVipBoxMarry.width&&(this._blueVipBoxMarry.x=this._blueVipBox.x+this._blueVipBox.width),this.ftxtName.x=this._fTxtNameOriginX+this._blueVipBox.width+this._blueVipBoxMarry.width}else e.blueInfo=t,e.nameText=this.ftxtName,this._blueVipBox=this._blueVipBox||new mt,this.addChild(this._blueVipBox),this._blueVipBox.updateShowing(e),this.ftxtName.x=this._fTxtNameOriginX+this._blueVipBox.width}},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(this._data=t,this.reset(),this._data)if(this.txtRank.text=this._data.row_id+"",3<this._data.row_id?(this.txtRank.visible=!0,this.imgRank.visible=!1):(this.txtRank.visible=!1,this.imgRank.visible=!0,this.imgRank.skin="modules/rank/rank"+this._data.row_id+".png"),0<this._data.vip_level?(this.imgVip.visible=!0,this.imgVip.skin="modules/chat/VIP"+this._data.vip_level+".png",this.imgRank.y=21):(this.imgVip.visible=!1,this.imgRank.y=30),this._data.elements){var i=nn.getRankStr(Js.curRankID,this._data.elements);i&&(this.ftxtName.clear(),this.ftxtName.addLinkText(i[0]+i[3],"#5d3924",!1),this.txtRanklv.text=i[1],this.txtExtra.text=i[2],this.updateBlueVip(nn.getRankBlueVip(Js.curRankID,this._data.elements),Js.curRankID)),this.txtNull.visible=!1}else this.txtNull.visible=!0})}(js),function(t){function i(){this.bottomEff=null,this._data=null,this.curShowSkin=null,this.myRole=null,this._pal=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_8",!0,"",!0),this.bottomEff=ut.getOne(),this.bottomEff.pos(377,517),this.container.addChild(this.bottomEff),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.htmlName.style.align="center"}l(i,"modules.role.fashion.FashionGetView",Si);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnRight:var i;if(this._data)for(var e in this._data)i=this._data[e],rh.ins().toFashionChange(i.id,0,i.val);this.btnRight.label="已穿戴",this.btnRight.disabled=!0;break;case this.btnLeft:if(Ne.isWX){if(fe.getIconStateShow(4022))return void(_t.window.wx&&(console.log("Browser.window.wx.navigateToMiniProgram({appId: wx05c25393267d6d28})"),_t.window.wx.navigateToMiniProgram({appId:"wx05c25393267d6d28"})));Vh.resetShareParm("原来我单身这么久，是因为没有遇到它····","1",[1,0]),Vh.shareAppMessage()}else Vh.resetShareParm("原来我单身这么久，是因为没有遇到它····","1",[1,0]),Vh.shareMenu();break;default:this.closeWindow()}},e.onDisplay=function(){this.bottomEff.loadAndPlay("moduleEffect/bottom","default",0,!0),this.on("undisplay",this,this.unDisplay),Ma.isOpenShare(0,1)?this.btnLeft.visible=!0:Ne.isWX||(this.btnLeft.visible=!1,this.btnRight.centerX=0)},e.unDisplay=function(){this.bottomEff.stop(),this.off("undisplay",this,this.unDisplay)},e.updateRole=function(){this.myRole=this.myRole||new is,this.spRole.addChild(this.myRole),this.myRole.resetSkin(this.curShowSkin,this._pal.ext.sex,!0),this.myRole.resetState(0),this.myRole.play("stand",4)},e.onAllLoad=function(){var t=this;this.callLater(function(){Rt.initImgRole(t.spRole.drawToCanvas(500,520,0,0).getCanvas())})},o(0,e,"data",null,function(t){if(this._data=t,this._data){var i="";this.btnRight.label="穿戴",this.btnRight.disabled=!1;var e,s=0,n=0,h="",a="",o=0,r=[];this._pal=ie.getPal(t[0].id);var l=this._pal.ext.sex,c=this._pal.ext.category;null==this.curShowSkin&&(this.curShowSkin=new Object,this.curShowSkin.className="p_skin"),this.curShowSkin.body=this._pal.ext.skin.body,this.curShowSkin.weapon=this._pal.ext.skin.weapon,this.curShowSkin.wing=this._pal.ext.skin.wing;for(var d=0;d<t.length;d++){for(var u=t[d],p=1;p<4;p++){var m=oh.getFashionDic(p);if(m&&m.hasOwnProperty(u.val+"")&&m.hasOwnProperty(u.val+"")){e=m[u.val],n=p;break}}switch(n){case 1:this.curShowSkin.body=10*u.val+l,i+=pe.font("时装·"+e.name,Qi.getColorDark(e.color));break;case 2:this.curShowSkin.weapon=100*u.val+10*l+c,i+=pe.font("武饰·"+e.name,Qi.getColorDark(e.color));break;case 3:this.curShowSkin.wing=10*u.val+l,i+=pe.font("羽翼·"+e.name,Qi.getColorDark(e.color))}var f,g=e.FashionItemLvDic[0],_=te.parseAttrToArr(g.attr);for(var I in _){f=_[I];for(var v=!1,b=0;b<r.length;b++){var y=r[b];if(y[0]==f[0]){y[1]=parseInt(y[1])+parseInt(f[1]),v=!0;break}}v||r.push([f[0],f[1]])}s+=5*g.bea,o+=g.bea,d<t.length-1&&(i+=Rt.getHtmlEmpty(3))}this.htmlName.innerHTML=i;for(var x,S=r.length,w=0;w<S;w++)x=r[w],w%2==0?h+=te.getAttrStrByArr(x,"","：","\n"):a+=te.getAttrStrByArr(x,"","：","\n"),s+=te.getAttrPowerS(x[0],x[1]);this.txtBase.text=h,this.txtBase1.text=a,this.txtBea.text="华丽度："+o;var k,T=Rt.numToTexture(Math.floor(s),"com/ui/powerNum");for(this.spPow.graphics.clear(),p=0;p<T.length;p++)k=T[p],this.spPow.graphics.drawTexture(k,k.width*p);this.updateRole()}})}(),function(t){function i(){this.curView=null,this.roleView=null,this.petView=null,i.__super.call(this),this.setWindowType(),this.tab.on("change",this,this.onTabChange),this.on("click",this,this.onClick)}l(i,"modules.rank.RankPanel",Zs);var e=i.prototype;e.update=function(){this.curView&&this.curView.update()},e.updateAvatar=function(){this.curView&&this.curView.updateAvatar&&this.curView.updateAvatar()},e.updateTitle=function(t){try{this.curView.updateTitle()}catch(t){}},e.updateFirstPart=function(){this.curView&&this.curView.updateFirstPart()},e.updateMyPart=function(){this.curView&&this.curView.updateMyPart()},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow()}},e.onTabChange=function(t){switch(this.spView.removeChildren(),this.tab.selectedIndex){case 0:this.roleView=this.roleView||Na.getIns(43e3,"RankRoleView"),this.curView=this.roleView,this.spView.addChild(this.roleView);break;case 1:this.petView=this.petView||Na.getIns(43e3,"RankPetView"),this.curView=this.petView,this.spView.addChild(this.petView)}this.update()},e.setRankIndex=function(t){this.curView&&this.curView.setIndex(t)},e.onResize=function(){0==ie.isVertical?(this.bg.left=NaN,this.bg.right=NaN,this.bg.width=750,this.bg.centerX=0):(this.bg.width=NaN,this.bg.centerX=NaN,this.bg.left=0,this.bg.right=0)},o(0,e,"viewIndex",null,function(t){this.tab.selectedIndex==t?this.onTabChange(null):this.tab.selectedIndex=t})}(),function(t){function i(){this._pos=0,i.__super.call(this)}l(i,"modules.role.SpequipPotentialSubItem",ka),i.prototype.setData=function(t,i,e){this.height=116,this._pos=e;var s,n,h=!1,a=!1;!t&&i&&(t=i,h=!0),i&&(t!=i||h)?(i.getEffStrArr(),s=i.spcStrArr,n=i.normalStrArr):a=!0;var o=Rt.numToTexture(t.power,"com/ui/powerNum");this.imgNum.graphics.clear();for(var r=0;r<o.length;r++){var l=o[r];this.imgNum.graphics.drawTexture(l,l.width*r)}t.getEffStrArr();var c=t.normalStrArr,d=t.spcStrArr,u=57;if(0<d.length){for(var p=pe.font("特殊效果","#fcf476",26)+"<br>",m=0,f=d.length;m<f;m++){var g=d[m];p+=pe.font(g.name+":"+g.val,h?"#96f254":"#e1c6bc",26),a||h?p+="<br>":s&&0<s.length?p+=pe.font("（下级+"+s[m].val+"）","#96f254",26)+"<br>":p+="<br>"}this.spcEffTxt.style.valign="top",this.spcEffTxt.style.leading=15,this.spcEffTxt.innerHTML=p,this.spcEffTxt.height=this.spcEffTxt.contextHeight}else this.spcEffTxt.innerHTML="",this.spcEffTxt.height=0;if(this.spcEffTxt.y=u,u+=this.spcEffTxt.height+10,0<c.length){for(var _=pe.font("额外属性","#fcf476",26)+"<br>",I=0,v=c.length;I<v;I++){var b=c[I];_+=pe.font(b.name+":"+b.val,h?"#96f254":"#e1c6bc",26),h||a?_+="<br>":n&&0<n.length?_+=pe.font("（下级+"+n[I].val+"）","#96f254",26)+"<br>":_+="<br>"}this.effTxt.style.valign="top",this.effTxt.style.leading=15,this.effTxt.innerHTML=_,this.effTxt.height=this.effTxt.contextHeight}else this.effTxt.innerHTML="",this.effTxt.height=0;this.effTxt.y=u,u+=this.effTxt.height+10;var y="",x=0;if(14==this._pos)x=Math.floor(un.getAllLevelByCurView()/8),y+="强化等级达到";else if(15==this._pos)x=Math.floor(un.getAllLevelByCurView()/8),y+="铭刻等级达到";else if(16==this._pos)x=Math.floor(un.getAllLevelByCurView()/8),y+="注灵等级达到";else if(17==this._pos){var S=un.getRefineInfo(un.curChooseActor),w=0;if(S){var k;for(var T in S.equip_refining)k=S.equip_refining[T],t.lv<=k.val?w+=t.lv:w+=k.val;x=Math.floor(w/8)}y+="所有部位附魂达到"}else if(13==this._pos){y+="凤魂等级达到";var C=oh.getSpEquipP(rh.ins().spEquipActIndex,13);x=1e3<=C.lv?1e3:C.lv}else if(12==this._pos){y+="龙魂等级达到";var A=oh.getSpEquipP(rh.ins().spEquipActIndex,12);x=1e3<=A.lv?1e3:A.lv}var O=0;O=17==this._pos?i.lv:i.goal,this.upLevelTxt.style.valign="top",this.upLevelTxt.style.leading=15,17==this._pos?this.upLevelTxt.innerHTML=pe.font("升级条件","#fcf476",26)+"<br>"+pe.font(y+"（"+x+"/"+O+"阶）","#e1c6bc",26):this.upLevelTxt.innerHTML=pe.font("升级条件","#fcf476",26)+"<br>"+pe.font(y+"（"+x+"/"+O+"级）","#e1c6bc",26),this.upLevelTxt.height=this.upLevelTxt.contextHeight,this.upLevelTxt.y=u,this.height=this.effTxt.height+this.upLevelTxt.height+this.spcEffTxt.height}}(),function(t){function i(){this._data=null,this._originX=NaN,this._blueVipBox=null,i.__super.call(this),this._originX=this.txtName.x}l(i,"modules.rank.RankPetListItem",t);var e=i.prototype;e.reset=function(){this.txtName.text=this.txtRanklv.text=this.txtExtra.text="",this.txtName.x=this._originX,this._blueVipBox&&this._blueVipBox.removeSelf()},e.updateBlueVip=function(t){if(Vh.isQQyxdt()){this.txtName.x=this._originX,this._blueVipBox=this._blueVipBox||new mt,this.addChild(this._blueVipBox);var i=new ft;i.blueInfo=t,i.nameText=this.txtName,this._blueVipBox.updateShowing(i),this.txtName.x=this._originX+this._blueVipBox}},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(this._data=t,this.reset(),this._data)if(this.txtRank.text=this._data.row_id+"",3<this._data.row_id?(this.txtRank.visible=!0,this.imgRank.visible=!1):(this.txtRank.visible=!1,this.imgRank.visible=!0,this.imgRank.skin="modules/rank/rank"+this._data.row_id+".png"),this._data.elements){var i=nn.getRankStr(Js.curPetRankID,this._data.elements);i&&(this.txtName.text=i[0],this.txtRanklv.text=i[1],this.txtExtra.text=i[2]),this.txtNull.visible=!1,this.updateBlueVip(nn.getRankBlueVip(Js.curRankID,this._data.elements))}else this.txtNull.visible=!0})}(tn),function(t){function i(){this.titleArr=["常规属性","特殊属性"],this.vocaArr=["","狂战","飞羽","舞天","碧落"],this.infoNameArr=null,this.infoAttrArr=null,this.curVO=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.btnBack.on("click",this,this.closeWindow),this.tab.on("change",this,this.update),this.tab.selectedIndex=0,this.btnL.on("click",this,this.onChangeRoleL),this.btnR.on("click",this,this.onChangeRoleR)}l(i,"modules.role.fashion.RoleFashionAttrView",th);var e=i.prototype;e.onChangeRoleL=function(){if(this.curVO){var t=ie.pals.indexOf(this.curVO);for(--t<0&&(t=ie.pals.length-1);null==ie.pals[t];)--t;this.update(ie.pals[t])}},e.onChangeRoleR=function(){if(this.curVO){var t=ie.pals.indexOf(this.curVO);for(++t>=ie.pals.length&&(t=0);null==ie.pals[t];)++t;this.update(ie.pals[t])}},e.update=function(t){if(t&&(this.curVO=t),this.curVO){this.txtVoca.text=this.vocaArr[this.curVO.ext.category];var i,e,s=0;switch(this.tab.selectedIndex){case 0:i=["攻    击：","生    命：","物    防：","法    防：","暴    击：","韧    性："],e=[49,11,13,14,37,38];break;case 1:var n=oh.getSuitEffTotel(this.curVO.pal_id);i=n.name,e=n.attyArr;break;case 2:i=["火    攻：","火    抗：","冰    攻：","冰    抗：","毒    攻：","毒    抗：","雷    攻：","雷    抗："],e=[47,48,45,46,43,44,39,40];break;case 3:i=["华丽度"],e=[73]}var h=oh.getFashionInfoByActID(this.curVO.pal_id),a=oh.getFashionByActSuit(this.curVO.pal_id);if(h&&1!=this.tab.selectedIndex){var o,r=new si;for(var l in h.fashion_list){o=h.fashion_list[l];for(var c=1;c<4;c++){var d,u=oh.getFashionArr(c);for(var p in u)if(d=u[p],o.fashion_id==d.id){for(var m=d.FashionItemLvDic[o.reinf_level],f=m.attr.split("|"),g=0;g<f.length;g++){var _=f[g].split(",");r.get(_[0])?r.set(_[0],r.get(_[0])+parseInt(_[1])):r.set(_[0],parseInt(_[1]))}r.get(73)?r.set(73,r.get(73)+m.bea):r.set(73,m.bea+a)}}}s=i.length+1;var I=0;for(g=1;g<9;g++)g<s?(I=r.get(e[g-1])?r.get(e[g-1]):0,this["txt"+g].visible=!0,this["input"+g].visible=!0,this["txt"+g].text=i[g-1],this["input"+g].text=I+""):(this["txt"+g].visible=!1,this["input"+g].visible=!1)}else if(1==this.tab.selectedIndex)for(var v=0,b=i.length;v<b;v++)this["txt"+(v+1)].text=i[v],this["input"+(v+1)].text=e[v]+"",this["txt"+(v+1)].visible=!0,this["input"+(v+1)].visible=!0;var y,x=ie.getTypePowerByData(this.curVO,1502)+ie.getTypePowerByData(this.curVO,1501)+ie.getTypePowerByData(this.curVO,1503)+(oh.getSuitTotalPower(this.curVO.pal_id)+oh.getSuitFashionToPower(this.curVO.pal_id)),S=Rt.numToTexture(Math.floor(x),"com/ui/powerNum");for(this.spPow.graphics.clear(),g=0;g<S.length;g++)y=S[g],this.spPow.graphics.drawTexture(y,y.width*g)}}}(),function(t){function i(){this.curRankData=null,this.role=null,this.clip=null,this.title=null,this.firstRankData=null,this._originNameTxtX=NaN,this.tempArr=null,this.myRow=0,this._blueVipBox=null,i.__super.call(this),this.tab.on("change",this,this.onTabChange),this.role=this.role||new is,this.firstPart.addChildAt(this.role,0),this.clip=ut.getOne(),this.clip.pos(282,-50),this.firstPart.addChildAt(this.clip,0),this._originNameTxtX=this.txtName.x,this.list.itemRender=Na.getClass(43e3,"RankPetListItem"),this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.selectEnable=!0,this.list.selectHandler=ue.create(this,this.onSelect),this.on("display",this,this.onAdd),this.on("click",this,this.onClick)}l(i,"modules.rank.RankPetView",en);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.txtShare:if(Ne.isWX){if(fe.getIconStateShow(4022))return void(_t.window.wx&&(console.log("Browser.window.wx.navigateToMiniProgram({appId: wx05c25393267d6d28})"),_t.window.wx.navigateToMiniProgram({appId:"wx05c25393267d6d28"})));Vh.resetShareParm("我是"+Xs.getRankName(Js.curPetRankID)+"排名第"+this.myRow+"名，快来六界带你装逼带你飞！","5",[0,3]),Vh.shareAppMessage()}else Vh.resetShareParm("我是"+Xs.getRankName(Js.curPetRankID)+"排名第"+this.myRow+"名，快来六界带你装逼带你飞！","5",[0,3]),Vh.shareMenu();break;case this.spExtraClick:case this.firstPart:this.firstRankData&&this.firstRankData.elements&&(Je.ins().toObservePet(this.firstRankData.role_id),je.curInrankPetID=this.firstRankData.elements[4],je.curInrankPetName=this.firstRankData.elements[1]);break;case this.btnAdore:$s.ins().toAdore(Js.curPetRankID),this.setLog(2);break;case this.imgRankAward:$s.ins().openRankAwardDisplayPanel()}},e.onRemove=function(){this.off("undisplay",this,this.onRemove),this.on("display",this,this.onAdd),this.clip.stop()},e.onAdd=function(){this.on("undisplay",this,this.onRemove),this.off("display",this,this.onAdd),0==this.tab.selectedIndex?this.onTabChange(null):this.tab.selectedIndex=0},e.updatePet=function(t){this.clip.loadAndPlay("unit/monster/"+t+"_3","stand",3,!0),this.clip.scale(Ji.scale,Ji.scale),this.clip.pos(282,-50)},e.updateAvatar=function(){var t=Js.getExtraInfoToc(this.firstRankData.role_id);4101==Js.curPetRankID?t&&this.firstRankData&&t.role_id==this.firstRankData.role_id&&(this.role.resetSkin(t.skin,t.sex,!0),this.role.resetState(0),this.role.play("stand",4,4,!0),this.role.scale(.7,.7),this.role.visible=!0,this.role.pos(208,-32),this.updateTitle(!0),this.clip.pos(360,-45)):(this.role.visible=!1,this.updateTitle(!1))},e.updateTitle=function(t){var i=Js.getRankCfgVO(Js.curPetRankID);!t||i&&null==i.titleIds?this.title&&(this.title.visible=!1):i&&(null==this.title&&(this.title=new ut,this.firstPart.addChild(this.title)),this.title.visible=!0,this.title.loadAndPlay("unit/title/"+i.titleIds[0],"default",0,!0),this.title.pos(205,-220))},e.onSelect=function(t){var i=this.list.getItem(t);i&&i.elements&&0<i.elements.length&&(Je.ins().toObservePet(i.role_id),je.curInrankPetID=i.elements[4],je.curInrankPetName=i.elements[1])},e.onTabChange=function(t){Js.curPetRankID=Xs.PANEL_PET_RANKS[this.tab.selectedIndex],0<=this.tab.selectedIndex&&(this.list.scrollTo(0),$s.ins().toGetRank(Js.curPetRankID),this.setLog(1))},e.update=function(){this.reset(),this.curRankData=Js.getRankVO(Js.curPetRankID),this.curRankData&&this.curRankData.rows?this.curRankData.rows.length<5?this.tempArr=nn.buildShamData(this.curRankData.rows):this.tempArr=this.curRankData.rows.concat():this.tempArr=nn.buildShamData(null),this.firstRankData=this.tempArr.shift(),this.list.dataSource=this.tempArr,this.updateMyPart(),this.updateFirstPart(),this.updateBlueVip(nn.getRankBlueVip(Js.curRankID,this.firstRankData.elements))},e.reset=function(){this.firstRankData=null,this.list.dataSource=null,this.txtName.text=this.txtRankLv.text=this.txtExtra.text="",this.txtMy.text="我的排名：暂未上榜",this.txtTip.text="",this._blueVipBox&&this._blueVipBox.removeSelf(),this.txtName.x=this._originNameTxtX},e.updateFirstPart=function(){if(this.firstRankData&&this.firstRankData.elements){0<this.firstRankData.role_id&&$s.ins().toRoleExtraInfo(this.firstRankData.role_id,Js.curPetRankID);var t=nn.getRankStr(Js.curPetRankID,this.firstRankData.elements);t&&(this.txtName.text=t[0],this.txtRankLv.text=t[1],this.txtExtra.text=t[2]),this.updatePet(t[3]),this.clip.visible=!0,this.imgRoleBg.visible=this.txtNull.visible=!1,this.btnAdore.visible=!0}else this.clip.visible=!1,this.imgRoleBg.visible=this.txtNull.visible=!0,this.btnAdore.visible=!1,this.role.visible=!1,this.title&&(this.title.visible=!1)},e.updateMyPart=function(){if(this.myRow=0,this.curRankData){var t,i;for(var e in this.curRankData.rows)if(i=this.curRankData.rows[e],(t=nn.getRankStr(Js.curPetRankID,i.elements))&&t[0]==ie.roleName){this.myRow=i.row_id;break}this.txtMy.text=0<this.myRow?"我的排名："+this.myRow:"我的排名：暂未上榜";var s=Js.getMyRankData(Js.curPetRankID);s&&(this.btnAdoreEnable=!s.adored)}this.txtTip.text=Xs.getRankTip(Js.curPetRankID),this.txtShare.visible=Ma.isOpenShare(0,3)&&0<this.myRow},e.setIndex=function(t){this.tab.selectedIndex=t},e.setLog=function(t){var i=this.tab.labels.split(",")[this.tab.selectedIndex];1==t?Ve.send(41,this.tab.selectedIndex+1,"仙宠排行榜页签按钮-"+i):Ve.send(41,this.tab.selectedIndex+201,i+"-膜拜")},e.updateBlueVip=function(t){if(Vh.isQQyxdt()){this.txtName.x=this._originNameTxtX,this._blueVipBox=this._blueVipBox||new mt,this.firstPart.addChild(this._blueVipBox);var i=new ft;i.blueInfo=t,i.nameText=this.txtName,this.txtName.x=this._originNameTxtX+this._blueVipBox.width}},o(0,e,"btnAdoreEnable",null,function(t){this.btnAdore.mouseEnabled=t,this.btnAdore.gray=!t,this.btnAdore.label=t?"膜拜":"已膜拜"})}(),function(e){function t(){this.itemArr=null,this.palID=0,this.curSel=null,this.curXmlVO=null,this.curP=null,t.__super.call(this)}l(t,"modules.role.fashion.RoleFashionNeedView",e);var i=t.prototype;i.createChildren=function(){var t;e.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.itemArr=[];for(var i=0;i<3;i++)(t=new eh).x=207*i,t.on("click",this,this.onClick),this.spItem.addChild(t),this.itemArr.push(t);this.on("click",this,this.onClickBtn)},i.onClickBtn=function(t){switch(t.target){case this.btnY:this.curXmlVO.needsArr;var i=this.curSel.data,e=Ze.getGoodsNumByType(Ze.GOODS_ID,i),s=Ze.getGoodsByTypeID(i);0<e&&s?(rh.ins().toFashionActive(this.palID,s.id),this.closeWindow()):io.addTip("道具数目不足!");break;case this.btnN:case this.btnClose:this.closeWindow()}},i.onClick=function(t){if(t.target instanceof modules.role.view.fashion.RoleFashionNeedItem){var i=t.target;this.curSel=i,this.imgSel.x=50+207*this.itemArr.indexOf(i),this.update()}},i.open=function(t,i){this.parent||this.openWindow(),this.curXmlVO=t,this.curP=i,this.curSel=this.itemArr[0],this.imgSel.x=50+207*this.itemArr.indexOf(this.curSel),this.update()},i.update=function(){for(var t,i=this.curXmlVO.needsArr,e=this.curXmlVO.timeArr,s=0,n=0;n<i.length;n++){var h=i[n];0<Ze.getGoodsNumByType(Ze.GOODS_ID,h)&&((t=this.itemArr[s]).parent||this.addChild(t),t.data=i[n],t.time=e[n],++s)}for(n=s;n<3;n++)(t=this.itemArr[n]).removeSelf();var a=0,o=0,r=0;if(this.curP){var l=new Date;if(this.curP.expires>Ma.serverTime){var c=this.curP.expires-Ma.serverTime;l.setTime(1e3*c),a=Math.floor(c/86400),o=l.getHours(),r=l.getMinutes();0<a&&a+"天",(0<a||0<o)&&o+"小时",(0<a||0<o||0<r)&&r+"分"}else this.txtNowtime.text="已过期"}else this.txtNowtime.text="未拥有";"-1"!=this.curSel.time?this.txtNextTime.text=a+parseInt(this.curSel.time)+"天"+o+"小时"+r+"分":this.txtNextTime.text="永久"}}(sh),function(t){function i(){this._data=null,this._palID=NaN,this.myRole=null,this.curShowSkin=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick)}l(i,"modules.role.fashion.FashionTarSecView",ki);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnYes:rh.ins().toFashionGoalItemActive([this._data[0].id,this._data[1].id],this._palID),this.closeWindow();break;case this.btnNo:case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.img1:this._data&&this.showTip(this._data[0].val);break;case this.img2:this._data&&this.showTip(this._data[1].val)}},e.showTip=function(t){var i=ve.getItem(t);i&&(i.tempNum=1,to.show(i,"BASE_GOODS_TIP"))},e.update=function(t,i){this._data=t,this._palID=i,this._data&&this.updateRole()},e.updateRole=function(){var t=ie.getPal(this._palID);if(t){this.myRole=this.myRole||new is,null==this.curShowSkin&&(this.curShowSkin=new Object,this.curShowSkin.className="p_skin"),this.curShowSkin.body=t.ext.skin.body,this.curShowSkin.weapon=t.ext.skin.weapon,this.curShowSkin.wing=t.ext.skin.wing;for(var i=0,e=t.ext.sex,s=t.ext.category,n=0;n<2;n++){for(var h=this._data[n],a=1;a<4;a++){var o=oh.getFashionDic(a);if(o&&o.hasOwnProperty(h.id)){i=a;break}}switch(i){case 1:this.curShowSkin.body=10*h.id+e,this["img"+(n+1)].skin="modules/goods/maxico/"+h.id+e+".png";break;case 2:this.curShowSkin.weapon=100*h.id+10*e+s,this["img"+(n+1)].skin="modules/goods/maxico/"+h.id+"1"+s+".png";break;case 3:this.curShowSkin.wing=10*h.id+e,this["img"+(n+1)].skin="modules/goods/maxico/"+h.id+".png"}}this.myRole.resetSkin(this.curShowSkin,e,!0),this.myRole.resetState(0),this.myRole.play("stand",4),this.spRole.addChild(this.myRole);var r=ve.getItem(this._data[0].val);this.txt1.color=Qi.getColorDark(r.color),this.txt1.text=r.name,this.imgBg1.skin="com/ui/goodsBg"+r.color+".png",r=ve.getItem(this._data[1].val),this.txt2.color=Qi.getColorDark(r.color),this.txt2.text=r.name,this.imgBg2.skin="com/ui/goodsBg"+r.color+".png"}}}(),function(t){function i(){this.curRankData=null,this.firstRankData=null,this.myRole=null,this.ftxtName=null,this.title=null,this.otherRole=null,this.otherTxtName=null,this.otherTitle=null,this._fTxtNameOriginX=NaN,this.tempArr=null,this.myRow=0,this._blueVipBox=null,this._blueVipBoxMarry=null,i.__super.call(this),this.tab.on("change",this,this.onTabChange),this.ftxtName=new Pi,this.ftxtName.pos(109,3),this.firstPart.addChild(this.ftxtName),this.myRole=this.myRole||new is,this.myRole.pos(270,-30),this.spExtraClick.on("click",this,this.onClickFirst),this.firstPart.addChildAt(this.myRole,0),this.otherTxtName=new Pi,this.otherTxtName.pos(109,3),this.firstPart.addChild(this.otherTxtName),this.otherRole=this.otherRole||new is,this.otherRole.pos(270,-30),this.firstPart.addChildAt(this.otherRole,0),this._fTxtNameOriginX=this.ftxtName.x,this.list.itemRender=Na.getClass(43e3,"RankListItem"),this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.selectEnable=!0,this.list.selectHandler=ue.create(this,this.onSelect),this.on("click",this,this.onClick)}l(i,"modules.rank.RankRoleView",sn);var e=i.prototype;e.onSelect=function(t){var i=this.list.getItem(t);i&&i.elements&&0<i.elements.length&&(1008==Js.curRankID||ni.dispatch("OPEN_OTHER_ROLE_PANLE",i.role_id))},e.update=function(){this.reset(),this.curRankData=Js.getRankVO(Js.curRankID),1010==Js.curRankID?(this.resetText.visible=!0,this.resetText.text="送花榜每日重置",this.txtBg.visible=!0):(this.resetText.visible=!1,this.resetText.text="",this.txtBg.visible=!1),this.curRankData&&this.curRankData.rows?this.curRankData.rows.length<5?this.tempArr=nn.buildShamData(this.curRankData.rows):this.tempArr=this.curRankData.rows.concat():this.tempArr=nn.buildShamData(null),this.firstRankData=this.tempArr.shift(),this.list.dataSource=this.tempArr,this.updateMyPart(),this.updateFirstPart(),this.updateBlueVip(nn.getRankBlueVip(Js.curRankID,this.firstRankData.elements),Js.curRankID)},e.reset=function(){this.firstRankData=null,this.list.dataSource=null,this.ftxtName.clear(),this.ftxtName.pos(109,3),this.txtRankLv.text=this.txtExtra.text="",this.txtMy.text="我的排名：暂未上榜",this.txtTip.text="",this.updateTitle(!1),this._blueVipBox&&this._blueVipBox.removeSelf(),this._blueVipBoxMarry&&this._blueVipBoxMarry.removeSelf()},e.updateAvatar=function(){var t=Js.getExtraInfoToc(this.firstRankData.role_id);t&&this.firstRankData&&t.role_id==this.firstRankData.role_id?(this.myRole.resetSkin(t.skin,t.sex,!0),this.myRole.resetState(0),1008==Js.curRankID?this.myRole.play("sit",4,4,!0):this.myRole.play("stand",4,4,!0),this.myRole.visible=!0,this.updateTitle(!0)):(this.myRole.visible=!1,this.updateTitle(!1));var i=Js.getExtraInfoToc(this.firstRankData.ext_role_id);i&&this.firstRankData&&i.role_id==this.firstRankData.ext_role_id?(this.otherRole.resetSkin(i.skin,i.sex,!0),this.otherRole.resetState(0),1008==Js.curRankID?this.otherRole.play("sit",4,4,!0):this.otherRole.play("stand",4,4,!0),this.otherRole.visible=!0):this.otherRole.visible=!1,1008==Js.curRankID?(this.myRole.pos(160,-30),this.otherRole.pos(390,-30)):this.myRole.pos(270,30)},e.updateTitle=function(t){var i=Js.getRankCfgVO(Js.curRankID);!t||i&&null==i.titleIds?(this.title&&(this.title.visible=!1),this.otherTitle&&(this.otherTitle.visible=!1)):i&&(null==this.title&&(this.title=new ut,this.firstPart.addChild(this.title)),this.title.visible=!0,this.title.loadAndPlay("unit/title/"+i.titleIds[0],"default",0,!0),1008==Js.curRankID?(null==this.otherTitle&&(this.otherTitle=new ut,this.otherTitle.pos(265,-235),this.firstPart.addChild(this.otherTitle)),this.otherTitle.visible=!0,this.otherTitle.loadAndPlay("unit/title/"+i.titleIds[1],"default",0,!0),this.otherTitle.pos(385,-235),this.title.pos(155,-235)):1010==Js.curRankID?this.title.pos(265,-250):this.title.pos(265,-235))},e.updateFirstPart=function(){if(this.firstRankData&&this.firstRankData.elements){0<this.firstRankData.role_id&&$s.ins().toRoleExtraInfo(this.firstRankData.role_id),0<this.firstRankData.ext_role_id&&$s.ins().toRoleExtraInfo(this.firstRankData.ext_role_id);var t=nn.getRankStr(Js.curRankID,this.firstRankData.elements);t&&(this.ftxtName.clear(),this.ftxtName.addLinkText(t[0]+(1010==Js.curRankID?"":t[3]),"#f4f1b2",!1),this.txtRankLv.text=t[1],this.txtExtra.text=t[2]),0<this.firstRankData.vip_level?(this.imgVip.visible=!0,this.imgVip.skin="modules/chat/VIP"+this.firstRankData.vip_level+".png",this.imgRankLv.y=6):(this.imgVip.visible=!1,this.imgRankLv.y=16),this.imgRoleBg.visible=this.txtNull.visible=!1,this.btnAdore.visible=!0}else this.imgRankLv.y=16,this.btnAdore.visible=this.imgVip.visible=!1,this.imgRoleBg.visible=this.txtNull.visible=!0,this.myRole.visible=!1,this.otherRole.visible=!1},e.updateMyPart=function(){this.myRow=0;var t=Js.getMyRankData(Js.curRankID);t&&(this.myRow=t.ranking,this.txtMy.text=0<this.myRow?"我的排名："+this.myRow:"我的排名：暂未上榜",this.txtTip.text=Xs.getRankTip(Js.curRankID),this.btnAdoreEnable=!t.adored),this.txtShare.visible=Ma.isOpenShare(0,3)&&0<this.myRow},e.onClick=function(t){switch(t.target){case this.btnAdore:$s.ins().toAdore(Js.curRankID),this.setLog(2);break;case this.firstPart:this.onClickFirst(null);break;case this.txtShare:if(Ne.isWX){if(fe.getIconStateShow(4022))return void(_t.window.wx&&(console.log("Browser.window.wx.navigateToMiniProgram({appId: wx05c25393267d6d28})"),_t.window.wx.navigateToMiniProgram({appId:"wx05c25393267d6d28"})));Vh.resetShareParm("本尊乃"+Xs.getRankName(Js.curRankID)+"第"+this.myRow+"名，来六界有我罩着你！","4",[0,3]),Vh.shareAppMessage()}else Vh.resetShareParm("本尊乃"+Xs.getRankName(Js.curRankID)+"第"+this.myRow+"名，来六界有我罩着你！","4",[0,3]),Vh.shareMenu();break;case this.imgRankAward:$s.ins().openRankAwardDisplayPanel()}},e.onClickFirst=function(t){this.firstRankData&&this.firstRankData.elements&&(1008==Js.curRankID||ni.dispatch("OPEN_OTHER_ROLE_PANLE",this.firstRankData.role_id))},e.onTabChange=function(t){Js.curRankID=Xs.PANEL_RANKS[this.tab.selectedIndex],0<=this.tab.selectedIndex&&(this.list.scrollTo(0),$s.ins().toGetRank(Js.curRankID),this.setLog(1))},e.setLog=function(t){var i=this.tab.labels.split(",")[this.tab.selectedIndex],e=0;switch(i){case"战力榜":e=1;break;case"等级榜":e=2;break;case"天梯榜":e=3;break;case"遭遇榜":e=4;break;case"时装榜":e=5;break;case"狂战榜":e=6;break;case"飞羽榜":e=7;break;case"舞天榜":e=8;break;case"碧落榜":e=9;break;case"结缘榜":e=10;break;case"天境榜":e=11;break;case"送花榜":e=12}1==t?Ve.send(9,e,"排行榜页签按钮-"+i):Ve.send(9,e+200,i+"-膜拜")},e.setIndex=function(t){this.tab.selectedIndex!=t?this.tab.selectedIndex=t:this.onTabChange(null)},e.updateBlueVip=function(t,i){if(Vh.isQQyxdt()){this.ftxtName.x=this._fTxtNameOriginX;var e=new ft;if(1008==i){e.blueInfo=e[0],e.nameText=this.ftxtName,this._blueVipBox=this._blueVipBox||new mt,this.firstPart.addChild(this._blueVipBox),this._blueVipBox.updateShowing(e);var s=new ft;s.blueInfo=e[1],s.nameText=this.ftxtName,this._blueVipBoxMarry=this._blueVipBoxMarry||new mt,this.firstPart.addChild(this._blueVipBoxMarry),this._blueVipBoxMarry.updateShowing(s),0<this._blueVipBoxMarry.width&&(this._blueVipBoxMarry.x=this._blueVipBox.x+this._blueVipBox.width),this.ftxtName.x=this._fTxtNameOriginX+this._blueVipBox.width+this._blueVipBoxMarry.width,this._blueVipBox.y=this._blueVipBoxMarry.y=this.ftxtName.y-2}else e.blueInfo=t,e.nameText=this.ftxtName,this._blueVipBox=this._blueVipBox||new mt,this.firstPart.addChild(this._blueVipBox),this._blueVipBox.updateShowing(e),this._blueVipBox.y=this.ftxtName.y-2,this.ftxtName.x=this._fTxtNameOriginX+this._blueVipBox.width}},o(0,e,"btnAdoreEnable",null,function(t){this.btnAdore.mouseEnabled=t,this.btnAdore.gray=!t,this.btnAdore.label=t?"膜拜":"已膜拜"})}(),function(s){function y(){this.headPart=null,this.starArr=null,this.SUIT_BGS=[],this.recItem=null,this._selectData=null,this._selectList=null,this.timeOutKey=NaN,this.showAttrDialog=null,this.needView=null,this.curShowSkin=null,this.myRole=null,this._curSelItem=null,this.curType=1,this.itemArr=null,this._nowVO=null,this._nowP=null,this.isInitSelect=!1,this._selectSuitId=NaN,this._canShowSuitRp=!1,this.showIconList=[],y.__super.call(this)}l(y,"modules.role.fashion.RoleFashionPanel",s);var t=y.prototype;t.createChildren=function(){s.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!1),this.headPart=new hh,this.headPart.on("RoleHeadsPart.CHOOSE",this,this.onHeadItemClick),this.headPart.pos(106,82);for(var t=0;t<4;t++){an.register("RP_FASHION_NEW1_"+t,this.tab.items[1],new Hs(19,-10)),an.register("RP_FASHION_NEW2_"+t,this.tab.items[2],new Hs(19,-10)),an.register("RP_FASHION_NEW3_"+t,this.tab.items[3],new Hs(19,-10));for(var i=1;i<4;i++);}var e;for(this.starArr=[],t=0;t<5;t++)(e=new ge).x=40*t,this.spStar.addChild(e),this.starArr.push(e);this.box.addChild(this.headPart),this.btnClose.on("click",this,this.closeWindow),this.btnClose2.on("click",this,this.closeWindow),this.tab.on("change",this,this.onClick),this.btnDown.on("click",this,this.onClothDown),this.btnAct.on("click",this,this.onClothAct),this.btnTotal.on("click",this,this.onClothTotal),this.imgBea.on("click",this,this.onClickBea),an.register("RP_FASHION1",this.tab.items[1],new Hs(19,-10)),an.register("RP_FASHION2",this.tab.items[2],new Hs(19,-10)),an.register("RP_FASHION3",this.tab.items[3],new Hs(19,-10)),an.register("RP_SUIT_CAN_ACTIVI",this.tab.items[0],new Hs(19,-10)),this.panel.hScrollBarSkin="",this.SUIT_BGS=[this.suitTop,this.suitDown,this.suitLeft,this.suitRight],this.suitList.vScrollBarSkin="",this.suitList.itemRender=Na.getClass(47e3,"fashion.SuitInfoItem"),this.suitList.selectEnable=!0,this.suitList.selectHandler=ue.create(this,this.onSelect),this.suitEffTxt.underline=!0,this.actSuitBtn.on("click",this,this.onClickActSuitBtn),this.suitEffTxt.on("click",this,this.onClothTotal),this.on("display",this,this.onDisplay),this.btnSearch.on("click",this,this.onClickSearch),this.inputSearch.on("input",this,this.onSearchChange)},t.onDisplay=function(){this.on("undisplay",this,this.onUndisplay),oh.getNextTimeOut()<99999999&&(this.timeOutKey=De.setTimeout(this,this.updateFashionItems,null,1e3*(this.timeOutKey-Ma.serverTime)));var t=ie.getPalByIndex(this.headPart.index);rh.ins().toFashionInfo(t.pal_id),ni.register("ROLE_SUIT_ITEM_TOUCH",this,this.updateSuitInfoShow)},t.onUndisplay=function(){this.off("undisplay",this,this.onUndisplay),De.clearTimeout(this.timeOutKey),ni.remove("ROLE_SUIT_ITEM_TOUCH",this,this.updateSuitInfoShow),this.inputSearch.text=""},t.onClickBea=function(){ni.dispatch("OPEN_BEAUTY_VIEW",this.headPart.index)},t.onClothTotal=function(){var t=ie.getPalByIndex(this.headPart.index);this.showAttrDialog=this.showAttrDialog||Na.getIns(47e3,"fashion.RoleFashionAttrView"),this.showAttrDialog.update(t),this.showAttrDialog.openWindow()},t.onClothAct=function(){var t=ie.getPalByIndex(this.headPart.index);if(this.curSelItem)if("淬炼"==this.btnAct.label){if(t){var i=this.curSelItem.xmlVO.FashionItemLvDic[this.curSelItem.p.reinf_level].need;ie.user.attr.gold>=i?es.showSecAlert(pe.span("是否花费","#5d3924")+pe.span(i+"元宝","#F7EF5F")+pe.span("淬炼","#5d3924")+pe.span("【"+this.curSelItem.xmlVO.name+"】？",Qi.getColorLight(this.curSelItem.xmlVO.color)),rh.ins(),rh.ins().toFashionreinf,[t.pal_id,this.curSelItem.xmlVO.id],"roleFashion"):es.showAlert()}}else{var e,s=0,n=0;for(var h in this.curSelItem.xmlVO.needsArr){e=this.curSelItem.xmlVO.needsArr[h],0<Ze.getGoodsNumByType(Ze.GOODS_ID,e)&&(++s,n=e)}if(1<s)this.needView=this.needView||Na.getIns(47e3,"fashion.RoleFashionNeedView"),this.needView.palID=t.pal_id,this.needView.open(this.curSelItem.xmlVO,this.curSelItem.p);else if(1==s){var a=Ze.getGoodsByTypeID(n);rh.ins().toFashionActive(t.pal_id,a.id)}else"激活"==this.btnAct.label?io.addTip(this.curSelItem.xmlVO.getWay):io.addTip("续期所需道具不足")}},t.onClothDown=function(){var t=ie.getPalByIndex(this.headPart.index);if("脱下"==this.btnDown.label)this.curSelItem?rh.ins().toFashionChange(t.pal_id,this.curSelItem.p.fashion_id,0):io.addTip("当前没有穿时装");else if(this.curSelItem){var i,e=oh.getFashionInfoByActID(t.pal_id).fashion_id,s=oh.getFashionDic(this.curType-1);for(var n in e)if(s[i=e[n]]){var h=s[i];break}if(this.curSelItem.p&&(0==this.curSelItem.p.expires||this.curSelItem.p.expires>Ma.serverTime)){var a=h?h.id:0;rh.ins().toFashionChange(t.pal_id,a,this.curSelItem.xmlVO.id)}else io.addTip("时装已经过期")}else io.addTip("没有选择时装")},t.updateRole=function(){var t=ie.getPalByIndex(this.headPart.index).ext.sex;this.myRole=this.myRole||new is,this.myRole.resetSkin(this.curShowSkin,t,!0),this.myRole.resetState(0),this.myRole.play("stand",4),this.spRole.addChild(this.myRole)},t.onItemClick=function(t){var i;this.curType<=1||((i=t?t.target:this.itemArr[0]).xmlVO.isNew=!1,this.curSelItem=i,this.updateView())},t.onClick=function(t){if(this.curType=this.tab.selectedIndex+1,!(1<this.curType))return this.fashionShowBox.visible=!1,void(this.suitBox.visible=!0);this.fashionShowBox.visible=!0,this.suitBox.visible=!1,2==this.curType?this.inputSearch.prompt="请输入时装名称":3==this.curType?this.inputSearch.prompt="请输入武饰名称":4==this.curType&&(this.inputSearch.prompt="请输入羽翼名称"),this.curSelItem=null;for(var i=0;i<4;i++){var e=0==this.tab.selectedIndex?4:this.tab.selectedIndex;switch(an.unRegister(this.headPart.getItem(i)),e){case 1:an.register("RP_FASHION1_"+i,this.headPart.getItem(i),new Hs(39,10)),an.register("RP_FASHION_NEW1_"+i,this.headPart.getItem(i),new Hs(39,10)),an.register("RP_FASHION1_"+i,this.headPart.getItem(i),new Hs(39,10)),an.register("RP_FASHION_NEW1_"+i,this.headPart.getItem(i),new Hs(39,10));break;case 2:an.register("RP_FASHION2_"+i,this.headPart.getItem(i),new Hs(39,10)),an.register("RP_FASHION_NEW2_"+i,this.headPart.getItem(i),new Hs(39,10)),an.register("RP_FASHION2_"+i,this.headPart.getItem(i),new Hs(39,10)),an.register("RP_FASHION_NEW2_"+i,this.headPart.getItem(i),new Hs(39,10));break;case 3:an.register("RP_FASHION3_"+i,this.headPart.getItem(i),new Hs(39,10)),an.register("RP_FASHION_NEW3_"+i,this.headPart.getItem(i),new Hs(39,10)),an.register("RP_FASHION3_"+i,this.headPart.getItem(i),new Hs(39,10)),an.register("RP_FASHION_NEW3_"+i,this.headPart.getItem(i),new Hs(39,10));break;case 4:an.register("RP_SUIT_CAN_ACTIVI_ROLE_"+i,this.headPart.getItem(i),new Hs(39,10))}for(var s=1;s<4;s++)an.hide("RP_FASHION"+s+"_"+i)}if(1<this.curType&&an.hide("RP_FASHION_NEW"+this.tab.selectedIndex+"_"+this.headPart.index),1==this.curType){var n=ie.getPalByIndex(this.headPart.index);rh.ins().toSuitInfo(),0!=this._selectSuitId&&this.updateSuitInfoShow(this._selectSuitId,oh.geSuitIsActive(n.pal_id,this._selectSuitId),this._canShowSuitRp)}this.updateFashionItems(),this.onItemClick(null),this.checkRPHead()},t.checkRPHead=function(){var t;for(var i in ie.pals){t=ie.pals[i];var e=oh.getFashionInfoByActID(t.pal_id);if(e&&Ze.getGoodsData()){var s,n=Ze.getGoodsData().goods,h=this.tab.selectedIndex,a=!1,o=oh.getFashionArr(h),r=oh.getFashionListDicByActID(e.pal_id);for(var l in o){var c;if(s=o[l],!r.hasOwnProperty(s.id+""))for(var d in s.needsArr){for(var u in c=s.needsArr[d],n)if(n[u].typeid==parseInt(c)){a=!0;break}}}if(a)for(var p=0;p<ie.pals.length;p++)if(ie.pals[p].pal_id==e.pal_id){an.show("RP_FASHION"+h+"_"+p);break}}}},t.onHeadItemClick=function(t){var i=ie.getPalByIndex(t);this.curSelItem=null,this.curShowSkin=null,an.hide("RP_FASHION_NEW"+this.tab.selectedIndex+"_"+t),this.updateFashionItems(),this.onItemClick(null),this.updateSuitShow();var e=oh.getSuitActivi(i.pal_id,this._selectSuitId);this.updateSuitInfoShow(this._selectSuitId,oh.geSuitIsActive(i.pal_id,this._selectSuitId),e)},t.levelUp=function(t){var i=this,e=ie.getPalByIndex(this.headPart.index);try{var s=oh.getFashionListDicByActID(e.pal_id)[this.nowP.fashion_id].reinf_level}catch(t){zi.addDebugInfo("roleFashionPanel.levelUp_try_catch","ALL"),console.log("roleFashionPanel.levelUp_try_catch")}if(this.curSelItem&&this.curSelItem.xmlVO)var n=this.curSelItem.xmlVO.FashionItemLvDic[s];if(10==s?(this.txtNeed1.visible=this.txtNeed.visible=!1,this.txtAttrNext.text="",this.txtBeaNext.text="",this.btnAct.label="已满级",this.btnAct.mouseEnabled=!1,this.btnAct.gray=!0):(this.txtNeed1.visible=this.txtNeed.visible=!0,this.btnAct.label="淬炼",this.btnAct.mouseEnabled=!0,this.btnAct.gray=!1,n&&(this.txtNeed.color=ie.user.attr.gold>=n.need?"#96f254":"#ff5858",this.txtNeed.text=n.need+"元宝")),t){var h=5<t.reinf_level,a=5<t.reinf_level?t.reinf_level-5:t.reinf_level,o=307,r=1+40*a,l=ri.show("moduleEffect/fly",357,502,this.spTip);l.rotation=90+180*Math.atan2(502-o,357-r)/Math.PI;var c=t.fashion_id;eo.to(l,{x:r,y:o},800,ai.cubicOut,ue.create(this,function(){var t=h?"yellowstar":"bluestar";ri.show("moduleEffect/"+t,r,o,i.spTip),De.setTimeout(i,i.updateFashionItems,[i._selectList],100),De.setTimeout(i,i.updateView,[c],100)},null,!0))}},t.updateCurView=function(t){void 0===t&&(t=0),this.updateFashionItems(this._selectList),this.updateView(t)},t.updateFashionItems=function(t){if(!(this.curType<=1)){this.curSelItem=null;var i=ie.getPalByIndex(this.headPart.index);oh.fashionSex=i.ext.sex,oh.fashionCoa=i.ext.category;var e=oh.getFashionListDicByActID(i.pal_id),s=t||oh.getFashionArr(this.curType-1);this._selectList=s,this.itemArr=this.itemArr||[];var n,h=Math.max(s.length,this.itemArr.length);s.sort(this.listSortFun);for(var a=0;a<h;a++)if(a<s.length){if(this.itemArr[a]||(this.itemArr[a]=new ih,this.itemArr[a].on("click",this,this.onItemClick)),n=this.itemArr[a],e.hasOwnProperty(s[a].id+""))var o=e[s[a].id];else o=null;n.x=a*(n.width+21)+10,n.y=20,n.setData(s[a],o),this.nowVO&&this.nowVO.id==n.xmlVO.id?(n.spHas.visible=!0,this.recItem=n):n.spHas.visible=!1,this._selectData&&this._selectData.id==n.xmlVO.id&&(this.curSelItem=n),this.panel.addChild(n)}else this.itemArr[a]&&this.itemArr[a].removeSelf()}},t.updateView=function(t){void 0===t&&(t=0);var i=ie.getPalByIndex(this.headPart.index);if(!(this.curType<=1)){var e=oh.getFashionInfoByActID(i.pal_id);if(e){this.txtBea.text=i.base.beauty+"点";var s,n,h=e.fashion_id,a=oh.getFashionDic(this.curType-1);for(var o in this.nowVO=null,this.nowP=null,h)if(a[s=h[o]]){this.nowVO=a[s];break}if(0<t)for(var r in this.itemArr)if((n=this.itemArr[r]).xmlVO.id==t){this.curSelItem=n;break}this.btnDown.label=this.nowVO&&this.curSelItem.xmlVO.id==this.nowVO.id?"脱下":"穿上";var l,c,d=0,u="#ff5858";if(this.curSelItem){if(this.nowP=this.curSelItem.p,this.nowP)if(0==this.nowP.expires){this.btnDown.visible=!0,d=this.nowP.reinf_level;var p=this.curSelItem.xmlVO.FashionItemLvDic[d];10==this.nowP.reinf_level?(this.txtNeed1.visible=this.txtNeed.visible=!1,this.txtAttrNext.text="",this.txtBeaNext.text="",this.btnAct.label="已满级",this.btnAct.mouseEnabled=!1,this.btnAct.gray=!0):(this.txtNeed1.visible=this.txtNeed.visible=!0,this.btnAct.label="淬炼",this.btnAct.mouseEnabled=!0,this.btnAct.gray=!1,this.txtNeed.color=ie.user.attr.gold>=p.need?"#96f254":"#ff5858",this.txtNeed.text=p.need+"元宝")}else if(this.txtNeed1.visible=this.txtNeed.visible=!0,this.nowP.expires>Ma.serverTime){var m;for(var f in l=this.curSelItem.xmlVO.needsArr,c=ve.getItem(parseInt(l[0])),l){m=l[f];var g=Ze.getGoodsNumByType(Ze.PACKTYPE_GOODS,parseInt(m));if(0<g){u="#96f254";break}}this.txtNeed.text=c.name+"×1",this.txtNeed.color=u,this.btnAct.label="续期",this.btnAct.mouseEnabled=this.btnDown.visible=this.btnAct.mouseEnabled=!0,this.btnAct.gray=!1}else{for(f in l=this.curSelItem.xmlVO.needsArr,c=ve.getItem(parseInt(l[0])),l)if(m=l[f],0<(g=Ze.getGoodsNumByType(Ze.PACKTYPE_GOODS,parseInt(m)))){u="#96f254";break}this.txtNeed.text=c.name+"×1",this.txtNeed.color=u,this.btnAct.label="激活",this.btnAct.mouseEnabled=!0,this.btnAct.gray=this.btnDown.visible=!1}else{if(this.txtNeed1.visible=this.txtNeed.visible=!0,this.btnAct.label="激活",(l=this.curSelItem.xmlVO.needsArr)&&0<l.length)if(c=ve.getItem(parseInt(l[0]))){for(f in l)if(m=l[f],0<(g=Ze.getGoodsNumByType(Ze.PACKTYPE_GOODS,parseInt(m)))){u="#96f254";break}this.txtNeed.text=c.name+"×1",this.txtNeed.color=u}else this.txtNeed.text=this.curSelItem.xmlVO.getWay,this.txtNeed.color="#ff5858";this.btnAct.gray=this.btnDown.visible=!1,this.btnAct.mouseEnabled=!0}p=p||this.curSelItem.xmlVO.FashionItemLvDic[d];for(var _,I=te.parseAttrToArr(p.attr),v="",b=I.length,y=0,x=0;x<b;x++){var S=I[x];v+=te.getAttrStrByArr(S,"","：","\n"),y+=te.getAttrPowerS(S[0],S[1])}if(this.txtpow.text="战斗力："+(Math.floor(y)+5*p.bea),this.txtTipAttr.text=v,this.txtBeaAttr.text="华丽度："+p.bea,10!=d){var w;for(w=this.curSelItem.xmlVO.FashionItemLvDic[d+1],b=(_=te.parseAttrToArr(w.attr)).length,v="",x=0;x<b;x++){var k=_[x];v+="+"+(parseInt(k[1])-parseInt(I[x][1]))+"\n"}this.txtAttrNext.text=v,this.txtBeaNext.text="+"+(w.bea-p.bea)+"\n"}else this.txtAttrNext.text="",this.txtAttrNext.text="";var T=5<d,C=5<d?d-5:d;b=5;for(var A=0;A<b;A++)this.starArr[A].skin=A<C?T?"com/ui/star_3.png":"com/ui/star_6.png":T?"com/ui/star_6.png":"com/ui/star_2.png";var O,P=ie.getTypePowerByData(i,1502)+ie.getTypePowerByData(i,1501)+ie.getTypePowerByData(i,1503),V=Rt.numToTexture(Math.floor(P),"com/ui/powerNum");this.spPow.graphics.clear();for(var R=0;R<V.length;R++)O=V[R],this.spPow.graphics.drawTexture(O,O.width*R)}if(this.curSelItem&&this.curSelItem.xmlVO){this.check();var D=i.ext.sex,N=i.ext.category;switch(null==this.curShowSkin&&(this.curShowSkin=new Object,this.curShowSkin.className="p_skin",this.curShowSkin.body=i.ext.skin.body,this.curShowSkin.weapon=i.ext.skin.weapon,this.curShowSkin.wing=i.ext.skin.wing),this.tab.selectedIndex){case 1:this.curShowSkin.body=10*this.curSelItem.xmlVO.id+D;break;case 2:this.curShowSkin.weapon=100*this.curSelItem.xmlVO.id+10*D+N;break;case 3:this.curShowSkin.wing=10*this.curSelItem.xmlVO.id+D}this.updateRole()}}else rh.ins().toFashionInfo(i.pal_id)}},t.listSortFun=function(t,i){var e=ie.getPalByIndex(rh.ins().roleFashionPanel.headPart.index),s=oh.getFashionListDicByActID(e.pal_id),n=s[t.id],h=s[i.id],a=an.checkModulesShowing("RP_FASHION"+rh.ins().roleFashionPanel.tab.selectedIndex);if(n&&!h){var o;if(a)for(var r in i.needsArr)if(o=i.needsArr[r],0<Ze.getGoodsNumByType(Ze.GOODS_ID,parseInt(o)))return 1;return-1}if(!n&&h){if(a)for(r in t.needsArr)if(o=t.needsArr[r],0<Ze.getGoodsNumByType(Ze.GOODS_ID,parseInt(o)))return-1;return 1}if(!n&&!h){if(a){var l=!1,c=!1;for(r in t.needsArr)if(o=t.needsArr[r],0<Ze.getGoodsNumByType(Ze.GOODS_ID,parseInt(o))){l=!0;break}for(r in i.needsArr)if(o=i.needsArr[r],0<Ze.getGoodsNumByType(Ze.GOODS_ID,parseInt(o))){c=!0;break}}return l==c?t.color>i.color?-1:t.color<i.color?1:t.id<i.id?-1:t.id>i.id?1:0:l?-1:1}return t.isNew&&!i.isNew?-1:!t.isNew&&i.isNew?1:n.reinf_level<h.reinf_level?-1:n.reinf_level>h.reinf_level?1:t.color>i.color?-1:t.color<i.color?1:t.id<i.id?-1:t.id>i.id?1:0},t.check=function(){this.imgRp.visible=this.curSelItem.imgRP.visible},t.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this),this.parent&&(this.headPart.resetSelect(oh.curActorIndex),this.tab.selectedIndex=0,this.curSelItem=null,an.hide("RP_FASHION_NEW1_"+this.headPart.index))},t.updateSuitShow=function(){var t,i=ie.getPalByIndex(this.headPart.index),e=oh.palFashionSuit,s=[],n=[];for(var h in e){if((t=e[h]).pal_id==i.pal_id){n=t.suits;break}}if(!(n.length<=0)){var a;for(var o in n){var r=(a=n[o]).suit_id,l=oh.getSuitInfoBySuitId(r);if(l)if(l.isUnOpenSuitShow())for(var c=l.count,d=0;d<c;d++)s.push({name:l.suitName,haveNum:0,suitID:l.suitID,count:0,isActivated:!1});else{var u=l.getSuitPartArr();s.push({name:l.suitName,haveNum:this.checkSuitPartHaving(u),suitID:l.suitID,count:l.count,isActivated:a.is_activated})}}this.suitList.dataSource=s,0==this.isInitSelect&&De.setTimeout(this,this.onSelect,[0],9),oh.checkSuitRedPoint()?an.show("RP_SUIT_CAN_ACTIVI"):an.hide("RP_SUIT_CAN_ACTIVI")}},t.onSelect=function(t){if(0==this.isInitSelect){this.isInitSelect=!0;var i=this.suitList.getItem(t),e=!1;e=i.haveNum>=i.count&&0==i.isActivated,ni.dispatch("ROLE_SUIT_ITEM_TOUCH",i.suitID,i.isActivated,e)}},t.checkSuitPartHaving=function(t){var i=0,e=ie.getPalByIndex(this.headPart.index),s=oh.getFashionInfoByActID(e.pal_id);if(!s)return i;for(var n=s.fashion_list,h=0,a=t.length;h<a;h++){var o=t[h],r=o.id;if(o.val<4){if(!n)continue;for(var l in n)n[l].fashion_id==r&&i++}else ja.isHas(r)&&i++}return i},t.updateSuitInfoShow=function(t,i,e){var s=oh.getSuitInfoBySuitId(t);if(s){for(var n=s.getEffNums(),h=1;h<7;h++)n[h-1]?this["effText"+h].innerHTML=pe.font(La.EFF_CH_ZH[n[h-1].id]+":"+n[h-1].val,"#fef6d9"):this["effText"+h].innerHTML="";this.suitName.text=s.suitName,this._selectSuitId=t;ie.getPalByIndex(this.headPart.index);this._canShowSuitRp=e;var a=s.count,o=s.getSuitPartArr();this.actSuitBtn.visible=0==i;var r=(this.imgAct.visible=i)?"act_":"un_act_";r+=a<=2?"one":3==a?"two":"three",this.suitShowBg.skin="modules/role/image/"+r+".png",this.showSuitItem(a,o),this.redPoint.visible=e}},t.showSuitItem=function(t,i){var e=ie.getPalByIndex(this.headPart.index),s=oh.getFashionInfoByActID(e.pal_id),n=[];s&&(n=s.fashion_list);for(var h=0;h<this.showIconList.length;h++){var a=this.showIconList[h];a&&a.removeSelf()}this.showIconList=[];var o=[];1==t?this.suitTop.visible=this.suitDown.visible=this.suitList.visible=this.suitRight.visible=!1:2==t?(this.suitTop.visible=this.suitDown.visible=!1,this.suitList.visible=this.suitRight.visible=!0,this.suitShowBg.y=127,o=[2,3]):3==t?(this.suitDown.visible=!1,this.suitTop.visible=this.suitList.visible=this.suitRight.visible=!0,this.suitShowBg.y=127,o=[0,2,3]):(this.suitTop.visible=this.suitDown.visible=this.suitList.visible=this.suitRight.visible=!0,this.suitShowBg.y=96,o=[0,1,2,3]);for(var r=0,l=i.length;r<l;r++){var c,d=i[r],u=d.id,p=d.val,m=4<=i.length?y.FOUR_SUIT_BG_POS[o[r]]:y.ICON_POS[o[r]];if(4<=i.length?this.SUIT_BGS[r].pos(y.FOUR_SUIT_BG_POS[o[r]].x,y.FOUR_SUIT_BG_POS[o[r]].y):3==i.length&&0!=r?this.SUIT_BGS[o[r]].pos(y.SUIT_BG_POS[o[r]].x,y.SUIT_BG_POS[o[r]].y+51):this.SUIT_BGS[o[r]].pos(y.SUIT_BG_POS[o[r]].x,y.SUIT_BG_POS[o[r]].y),p<4){var f=!1;if(c=oh.getFashionItemByTypeAndId(p,u)){var g=new ih;for(var _ in g.setData(c,null,!1),g.txtName.color="#ffffff",g.txtName.fontSize=26,g.hasText.y=38,g.garyTxt.visible=!1,this.suitBox.addChild(g),this.showIconList.push(g),4<=i.length?(g.pos(m.x+22,m.y+22),g.txtName.y=0==r||2==r?-45:127):3==i.length?0!=r?(g.pos(m.x,m.y+51),g.txtName.y=140):(g.pos(m.x,m.y),g.txtName.y=-45):g.pos(m.x,m.y),n)if(n[_].fashion_id==c.id){f=!0;break}g.setHasTxt(!f),g.on("click",this,this.clickRoleFashionIcon)}this.SUIT_BGS[o[r]].skin=f?"modules/role/image/suitAct.png":"modules/role/image/suitUnAct.png"}else{var I=new oe(105,105,!0,!0,!0,!0,105);if((d=new Object).className="p_kv",d.id=u,d.val=1,I.dataSource=d,this.suitBox.addChild(I),this.showIconList.push(I),4<=i.length?(I.pos(m.x+22,m.y+22),I.text.y=0==r||2==r?-45:127):3==i.length?0!=r?(I.pos(m.x,m.y+51),I.text.y=140):(I.pos(m.x,m.y),I.text.y=-45):I.pos(m.x,m.y),I.text.fontSize=26,I.text.color="#ffffff",!ja.isHas(u)){var v=new ge;v.skin="modules/role/hasDown.png",v.size(99,102),I.addChild(v);var b=so.createText("未激活",0,76.5,I.width,24,I);b.align="center",b.color="#96f254",b.fontSize=24}this.SUIT_BGS[o[r]].skin=ja.isHas(u)?"modules/role/image/suitAct.png":"modules/role/image/suitUnAct.png"}}},t.clickRoleFashionIcon=function(t){var i=t.target.xmlVO,e=ve.getFashionGoodsByImg(i.id);e&&(e.tempNum=1,to.show(e,"BASE_GOODS_TIP"))},t.onClickActSuitBtn=function(){var t=ie.getPalByIndex(this.headPart.index);rh.ins().toSuitActivate(t.pal_id,this._selectSuitId)},t.updateSuitActivate=function(t,i){ie.getPalByIndex(this.headPart.index).pal_id==t&&(this.updateSuitShow(),i==this._selectSuitId&&this.updateSuitInfoShow(i,!0,!1))},t.updateSuitActivateAll=function(){if(!(this._selectSuitId<=0)){var t=ie.getPalByIndex(this.headPart.index),i=oh.getSuitActivi(t.pal_id,this._selectSuitId);this.updateSuitInfoShow(this._selectSuitId,oh.geSuitIsActive(t.pal_id,this._selectSuitId),i)}},t.onClickSearch=function(){var t=this.inputSearch.text;t.length?this.searchItem(t):io.addTip("请输入搜索内容")},t.onSearchChange=function(){this.inputSearch.text.length||this.updateFashionItems()},t.searchItem=function(t){for(var i=[],e=oh.getFashionArr(this.curType-1),s=0;s<e.length;s++){var n=e[s];-1!=n.name.indexOf(t)&&i.push(n)}i.length?this.updateFashionItems(i):io.addTip("搜索失败，没有该道具")},o(0,t,"nowVO",function(){return this._nowVO},function(t){this._nowVO=t}),o(0,t,"curSelItem",function(){return this._curSelItem},function(t){this._curSelItem&&(this._curSelItem.select=!1),(this._curSelItem=t)&&(this._curSelItem.select=!0,this._selectData=this._curSelItem.xmlVO,this.txtName.text=this._curSelItem.xmlVO.name)}),o(0,t,"nowP",function(){return this._nowP},function(t){this._nowP=t,this.txtStarNum.text=t?t.reinf_level+"星":"0星"}),e(y,["ICON_POS",function(){return this.ICON_POS=[{x:455,y:125},{x:455,y:345},{x:310,y:231},{x:590,y:231}]},"FOUR_SUIT_BG_POS",function(){return this.FOUR_SUIT_BG_POS=[{x:324,y:111},{x:324,y:303},{x:538,y:111},{x:538,y:303}]},"SUIT_BG_POS",function(){return this.SUIT_BG_POS=[{x:432,y:106},{x:439,y:323},{x:290,y:210},{x:567,y:210}]}])}(nh),function(t){function i(){this._data=null,this._dataObj=null,this._type=0,i.__super.call(this)}l(i,"modules.rank.StandardRechargeRankItem",t);var e=i.prototype;e.update=function(){this.txtNum.text=this._data.row_id+"",this.txtName.text=this._data.elements[0],1007==this._type&&Vh.isFanTi?this.txtPay.text=parseInt(this._data.elements[2])/10+"":this.txtPay.text=this._data.elements[2]},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._dataObj=t,this._dataObj&&(this._data=this._dataObj.data,this._type=this._dataObj.type%1e4,this.update())})}(Ca),function(s){var h;function t(){this.headPart=null,this.leftItems=null,this.rightItems=null,this.leftIndex=NaN,this.rightIndex=NaN,this.leftSel=-1,this.rightSel=-1,this.speed1=1,this.speed2=1,this.speed3=1,this.speed4=1,this.scaleN=.004,this.secView=null,this._curTarVO=null,this.myRole=null,this.curP=null,this.curShowSkin=null,this.tarItems=null,t.__super.call(this)}l(t,"modules.role.fashion.FashionTarView",s);var i=t.prototype;return i.createChildren=function(){s.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.headPart=new hh,this.headPart.on("RoleHeadsPart.CHOOSE",this,this.onHeadItemClick),this.headPart.pos(106,82),this.box.addChild(this.headPart),this.on("click",this,this.onClick);for(var t=0;t<4;t++)an.register("RP_FASHION_TAR_"+t,this.headPart.getItem(t),new Hs(39,10));var i;this.on("display",this,this.onDisplay),this.leftItems=[],this.rightItems=[];for(var e=0;e<4;e++)(i=new wi).pos(29,44+129*e),this.imgLeft.addChild(i),this.leftItems.push(i);for(e=0;e<4;e++)(i=new wi).pos(29,44+129*e),this.imgRight.addChild(i),this.rightItems.push(i);an.register("RP_FASHION_TAR",this.btnGet,new Hs(22,-8))},i.onDisplay=function(){ni.register("DREAM_BARRIER",this,this.updateBottom),ni.register("CUSTOM_BARRIER_UPDATE",this,this.updateBottom),ni.register("MONEY_CHANGE",this,this.updateBottom),ni.register("EQUIP_UPDATE",this,this.updateBottom),ni.register("ROLE_LEVEL_UP",this,this.updateBottom),ni.register("SKILLS_UPDATE",this,this.updateBottom),ni.register("ROLE_POWER_CHANGE",this,this.updateBottom),ni.register("BAGDATA_CHANGE",this,this.updateChangeP),ni.register("FASHION_NUM_CHANGE",this,this.updateItemHas),ni.register("FASHION_UPDATE",this,this.updateRole),this.on("undisplay",this,this.onUNDisplay),this.leftIndex=this.rightIndex=0,this.leftSel=this.rightSel=-1,this.btnLeft.label=this.btnRight.label="下一批",this.setItemPage(oh.fashionShowVO.getWeapons(),this.leftItems,this.leftIndex),this.setItemPage(oh.fashionShowVO.getCloths(),this.rightItems,this.rightIndex),oh.checkFunctionIsOpen(2)?this.spMask.removeSelf():(De.addToFrame(this,this.loop),this.showGuideStep1(),rh.ins().toRoleFunctionOpen(2))},i.loop=function(){this.spStep1.visible?(this.imgArr1.y+=this.speed1,this.imgArr1.x+=this.speed1,(this.imgArr1.y<=1050||1100<=this.imgArr1.y)&&(this.speed1*=-1),this.imgQuan1.scaleX-=this.scaleN,this.imgQuan1.scaleY-=this.scaleN,(this.imgQuan1.scaleX<=.8||1<=this.imgQuan1.scaleX)&&(this.scaleN*=-1)):this.spStep2.visible&&(this.imgArr2.y-=this.speed2,this.imgArr2.x-=this.speed2,(this.imgArr2.y<=470||520<=this.imgArr2.y)&&(this.speed2*=-1),this.imgArr3.y-=this.speed3,this.imgArr3.x+=this.speed3,(this.imgArr3.y<=470||520<=this.imgArr3.y)&&(this.speed3*=-1),this.imgArr4.y+=this.speed4,(this.imgArr4.y<=605||655<=this.imgArr4.y)&&(this.speed4*=-1),this.imgQuan2.scaleX-=this.scaleN,this.imgQuan2.scaleY-=this.scaleN,this.imgQuan3.scaleX-=this.scaleN,this.imgQuan3.scaleY-=this.scaleN,(this.imgQuan2.scaleX<=.8||1<=this.imgQuan2.scaleX)&&(this.scaleN*=-1))},i.showGuideStep1=function(){this.spStep1.visible=!0,this.spStep2.visible=!1,this.spTop.alpha=.5,this.spTop.graphics.clear(),this.spTop.graphics.drawRect(0,0,(Te.stageWidth-750)/2+369,Te.stageHeight,"#000000"),this.spTop.graphics.drawRect((Te.stageWidth-750)/2+369,0,224,1092,"#000000"),this.spTop.graphics.drawRect((Te.stageWidth-750)/2+369,1169,224,Te.stageHeight-1169,"#000000"),this.spTop.graphics.drawRect((Te.stageWidth-750)/2+593,0,Te.stageWidth/2-218,Te.stageHeight,"#000000")},i.showGuideStep2=function(){this.spStep1.visible=!1,this.spStep2.visible=!0,this.spTop.graphics.clear(),this.spTop.graphics.drawRect(0,0,this.box.x+34,Te.stageHeight,"#000000"),this.spTop.graphics.drawRect(this.box.x+34+141,0,93,Te.stageHeight,"#000000"),this.spTop.graphics.drawRect(this.box.x+268+224,0,81,Te.stageHeight,"#000000"),this.spTop.graphics.drawRect(this.box.x+573+141,0,Te.stageWidth-this.box.x-714,Te.stageHeight,"#000000"),this.spTop.graphics.drawRect(this.box.x+34,0,141,this.box.y+376,"#000000"),this.spTop.graphics.drawRect(this.box.x+268,0,224,this.box.y+698,"#000000"),this.spTop.graphics.drawRect(this.box.x+573,0,141,this.box.y+376,"#000000"),this.spTop.graphics.drawRect(this.box.x+268,this.box.y+698,224,77,"#000000"),this.spTop.graphics.drawRect(this.box.x+34,this.box.y+376+141,141,Te.stageHeight-(this.box.y+376+141),"#000000"),this.spTop.graphics.drawRect(this.box.x+268,this.box.y+698+77,224,Te.stageHeight-(this.box.y+698+77),"#000000"),this.spTop.graphics.drawRect(this.box.x+573,this.box.y+376+141,141,Te.stageHeight-(this.box.y+376+141),"#000000")},i.updateItemHas=function(){if(this.curP){for(var t in this.leftItems)this.leftItems[t].checkHas(this.curP.pal_id);for(t in this.rightItems)this.rightItems[t].checkHas(this.curP.pal_id)}},i.onUNDisplay=function(){ni.remove("DREAM_BARRIER",this,this.updateBottom),ni.remove("CUSTOM_BARRIER_UPDATE",this,this.updateBottom),ni.remove("MONEY_CHANGE",this,this.updateBottom),ni.remove("EQUIP_UPDATE",this,this.updateBottom),ni.remove("ROLE_LEVEL_UP",this,this.updateBottom),ni.remove("SKILLS_UPDATE",this,this.updateBottom),ni.remove("ROLE_POWER_CHANGE",this,this.updateBottom),ni.remove("BAGDATA_CHANGE",this,this.updateChangeP),ni.remove("FASHION_NUM_CHANGE",this,this.updateItemHas),ni.remove("FASHION_UPDATE",this,this.updateRole),this.off("undisplay",this,this.onUNDisplay),this.spMask.removeSelf(),De.removeFromFrame(this,this.loop)},i.updateChangeP=function(){var t=Ze.getGoodsNumByType(Ze.GOODS_ID,10201398);this.txtNum.text=t+"",this.imgGoods.x=this.txtNum.x+this.txtNum.textWidth,this.imgRp.visible=0<t&&oh.checkIsCanChange(this.headPart.index)},i.setItemPage=function(t,i,e){for(var s,n=0;n<4;n++)(s=i[n]).select=!1,n<t.length-4*e?(s.update(t[n+4*e]),s.visible=!0):(s=i[n]).visible=!1;this.updateItemHas()},i.onClick=function(t){var i;switch(t.target){case this.spMask:this.spStep1.visible?this.showGuideStep2():this.spStep2.visible&&(this.spMask.removeSelf(),De.removeFromFrame(this,this.loop));break;case this.btnClose2:case this.btnClose:this.closeWindow();break;case this.btnLeft:var e=oh.fashionShowVO.getWeapons();Math.ceil(e.length/4);this.leftIndex=1-this.leftIndex,this.btnLeft.label=0==this.leftIndex?"下一批":"上一批",this.setItemPage(oh.fashionShowVO.getWeapons(),this.leftItems,this.leftIndex),this.leftSel>=4*this.leftIndex&&this.leftSel<4*this.leftIndex+4&&(this.leftItems[this.leftSel-4*this.leftIndex].select=!0);break;case this.btnRight:e=oh.fashionShowVO.getWeapons(),Math.ceil(e.length/4),this.rightIndex=1-this.rightIndex,this.btnRight.label=0==this.rightIndex?"下一批":"上一批",this.setItemPage(oh.fashionShowVO.getCloths(),this.rightItems,this.rightIndex),this.rightSel>=4*this.rightIndex&&this.rightSel<4*this.rightIndex+4&&(this.rightItems[this.rightSel-4*this.rightIndex].select=!0);break;case this.btnAct:if(0<Ze.getGoodsNumByType(Ze.GOODS_ID,10201398))if(0<=this.leftSel&&0<=this.rightSel){var s,n;s=oh.fashionShowVO.getWeapons()[this.leftSel],n=oh.fashionShowVO.getCloths()[this.rightSel];var h,a=oh.getFashionInfoByActID(this.curP.pal_id);if(a&&a.fashion_list)for(var o in a.fashion_list)if((h=a.fashion_list[o]).fashion_id==s.id||h.fashion_id==n.id)return void io.addTip("只能兑换未拥有的武饰和时装哦");this.secView=this.secView||Na.getIns(47e3,"fashion.FashionTarSecView"),this.secView.update([s,n],this.curP.pal_id),null==this.secView.parent&&this.secView.openWindow()}else 0<this.leftSel*this.rightSel?io.addTip("请先选择两侧的时装和武饰"):io.addTip("可以同时选择1件时装和1件武饰哦");else io.addTip("套装领取券不足，请努力完成下方任务获取");break;case this.btnGet:if(this._curTarVO){var r,l=!0;if(this.tarItems)for(var c in this.tarItems)(r=this.tarItems[c]).parent&&(l=l&&r.can);l?ie.silver>=this._curTarVO.cop?rh.ins().toFashionGoalAct(ie.pals[0],this._curTarVO.goalId):Zi.show(10201113):io.addTip("领取条件未满足！")}break;default:if(t.target instanceof modules.role.view.fashion.FashionTarItem){var d;for(var u in 0<=this.leftItems.indexOf(t.target)?(i=this.leftItems,this.leftSel=this.leftItems.indexOf(t.target)+4*this.leftIndex):(i=this.rightItems,this.rightSel=this.rightItems.indexOf(t.target)+4*this.rightIndex),i)(d=i[u]).select=t.target==d;this.updateRole()}}},i.updateRole=function(){var t,i=oh.fashionTarSex=this.curP.ext.sex,e=oh.fashionTarCoa=this.curP.ext.category;for(var s in null==this.curShowSkin&&(this.curShowSkin=new Object,this.curShowSkin.className="p_skin"),this.curShowSkin.body=this.curP.ext.skin.body,this.curShowSkin.weapon=this.curP.ext.skin.weapon,this.curShowSkin.wing=this.curP.ext.skin.wing,this.leftItems)if((t=this.leftItems[s]).select){this.curShowSkin.weapon=100*t.data.id+10*i+e;break}for(s in this.rightItems)if((t=this.rightItems[s]).select){this.curShowSkin.body=10*t.data.id+i;break}for(var n in this.myRole=this.myRole||new is,this.myRole.resetSkin(this.curShowSkin,i,!0),this.myRole.resetState(0),this.myRole.play("stand",4),this.spRole.addChild(this.myRole),this.leftItems)this.leftItems[n].updateImage();for(n in this.rightItems)this.rightItems[n].updateImage()},i.updateBottom=function(){if(this._curTarVO){this.txtMax.visible=!1,this.spNotMax.visible=!0,this.tarItems=this.tarItems||[];oh.getFashionInfoByActID(this.curP.pal_id);for(var t,i,e=Math.max(this.tarItems.length,this._curTarVO.needs.length),s=0;s<e;s++)s<this._curTarVO.needs.length?(this.tarItems[s]=this.tarItems[s]||new h,i=this._curTarVO.needs[s],(t=this.tarItems[s]).x=85,t.y=905+46*s,this.box.addChild(t),t.setData(oh.tarDic[i.id],i.val,this.headPart.index)):this.tarItems[s]&&this.tarItems[s].parent&&this.tarItems[s].removeSelf();this.txtNeed.text=this._curTarVO.cop+"",this.txtNeed.color=ie.silver>=this._curTarVO.cop?"#96f254":"#b60202"}else{if(this.tarItems){for(var n in this.tarItems)this.tarItems[n].removeSelf();this.txtMax.visible=!0}this.spNotMax.visible=!1}},i.onHeadItemClick=function(t){this.curP=ie.getPalByIndex(t),this.updateView()},i.setCurSel=function(){var t=oh.fashionTarDic[1],i=oh.getGoal(this.curP.pal_id);if(0<i){for(var e=0;e<t.length;e++){if(t[e].goalId==i)break}++e<t.length?this.curSelVO=t[e]:this.curSelVO=null}else this.curSelVO=t[0]},i.updateView=function(){this.setCurSel(),this.updateRole(),this.updateBottom(),this.updateChangeP(),this.updateItemHas()},i.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this),this.parent&&this.headPart.resetSelect(0)},o(0,i,"curSelVO",function(){return this._curTarVO},function(t){this._curTarVO=t}),t.__init$=function(){h=function(t){function i(){this.curData=null,this.can=!1,i.__super.call(this),this.btnLink.on("click",this,this.onClick)}l(i,"",Ua);var e=i.prototype;return e.onClick=function(){this.curData&&0<this.curData.linkID&&Ae.linkTo(this.curData.linkID)},e.setData=function(t,i,e){switch(this.curData=t,this.can=!1,0,t.id){case 7:var s=te.getShortenPowerStr(i),n=ie.getPalByIndex(0).ext.power;this.can=i<=n,this.txtTar.text=t.desc.replace("~",s)+"（"+n+"/"+i+"）";break;case 2:var h,a,o=ie.myEquipLevel;this.can=i<=o,h=100<o?(o-100)/10+"转":o+"级",a=100<i?(i-100)/10+"转":i+"级",this.txtTar.text=t.desc.replace("~",a)+"（"+h+"/"+a+"）";break;case 3:var r,l=ie.getPalByIndex(0),c=1e4;if(l.equip.length<8)c=0;else for(var d in l.equip){r=l.equip[d];var u=ve.getItem(r.type_id);u&&u.color<6&&u.level<c&&(c=u.level)}this.can=i<=c,h=100<c?(c-100)/10+"转":c+"级",a=100<i?(i-100)/10+"转":i+"级",this.txtTar.text=t.desc.replace("~",a)+"（"+h+"/"+a+"）";break;case 4:c=1e4;var p,m=0;if(5<=(l=ie.getPalByIndex(0)).skills.length)for(var f in l.skills){p=l.skills[f],oa.getSkill(p.skill_id)&&(++m,p.skill_lv<c&&(c=p.skill_lv))}c=5<=m?c:0,this.can=i<=c,this.txtTar.text=t.desc.replace("~",i)+"（"+c+"/"+i+"）";break;case 5:this.can=Ft.curBarrier>=i,this.txtTar.text=t.desc.replace("~",i)+"（"+Ft.curBarrier+"/"+i+"）";break;case 6:this.can=qt.curBarrier>i,this.txtTar.text=t.desc.replace("~",i)+"（"+(qt.curBarrier-1)+"/"+i+"）";break;case 1:for(var g in n=0,ie.pals)n+=ie.pals[g].ext.power;this.can=i<=n,this.txtTar.text=t.desc.replace("~",i)+"（"+n+"/"+i+"）"}this.can?(this.txtTar.color="#96f254",this.imgGet.visible=!0,this.btnLink.visible=!1):(this.txtTar.color="#ffe0cf",this.btnLink.visible=0<this.curData.linkID,this.imgGet.visible=!1)},o(0,e,"uiClass",function(){return"TarItem"}),i}()},t}(Ti)),ir=(function(t){function i(){this.selectId=0,this._data=null,this._suitId=NaN,this._isActv=!1,this._canShowRedPoint=!1,i.__super.call(this),this.on("click",this,this.onClick),ni.register("ROLE_SUIT_ITEM_TOUCH",this,this.isShowSel)}l(i,"modules.role.fashion.SuitInfoItem",t);var e=i.prototype;e.isShowSel=function(t,i,e){this._suitId<=-1||(this.imgSel.visible=t==this._suitId,this.selectId=t,this.suitName.color=t==this._suitId?"#fff000":"#3e1e0c")},e.onClick=function(){this._suitId<=-1?io.addTip("更多套装即将开放，敬请期待哟！"):this.selectSelf()},e.selectSelf=function(){this._suitId&&(this.suitName.color="#fff000",ni.dispatch("ROLE_SUIT_ITEM_TOUCH",this._suitId,this._isActv,this._canShowRedPoint))},o(0,e,"uiClass",function(){return"suitInfoItem"}),o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(t){if(this._data=t,this._suitId=this._data.suitID,this._data.suitID<=-1)return this.suitName.text=this._data.name,this.suitName.color="#bd5713",this.gouImg.visible=!1,this.redPoint.visible=!1,void(this.imgSel.visible=!1);this.suitName.text=this._data.name+"("+this._data.haveNum+"/"+this._data.count+")",this._isActv=this._data.isActivated,this.gouImg.visible=this._data.isActivated,this._data.haveNum>=this._data.count&&0==this._data.isActivated?(this.redPoint.visible=!0,this._canShowRedPoint=!0):(this.redPoint.visible=!1,this._canShowRedPoint=!1),this.selectId==this._suitId?(this.imgSel.visible=!0,this.suitName.color="#fff000"):(this.imgSel.visible=!1,this.suitName.color="#3e1e0c")}})}(jo),function(t){function i(){this._rankType=0,this._uniqueRankId=0,i.__super.call(this),this.setWindowType()}l(i,"modules.rank.StandardRechargeRankPanel",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.list.itemRender=Na.getClass(43e3,"StandardRechargeRankItem"),this.list.vScrollBarSkin=""},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow()}},e.onDisplay=function(){},e.onUnDisplay=function(){},e.update=function(){var t,i=[],e=0;if(1007==this.rankType?(i=(t=Js.getRankVO(this._uniqueRankId)).rows,e=t.rankID):1009==this.rankType?(i=(t=Js.getRankVO(this._uniqueRankId)).rows,e=t.rankID):1102==this.rankType&&(i=(t=Js.getRankVO(this._uniqueRankId)).rows,e=t.rankID),this.resetTopThree(),i&&0<i.length){for(var s=i.splice(3,i.length-3),n=[],h=0;h<s.length;h++){var a=[];a.data=s[h],a.type=this._uniqueRankId,n[h]=a}this.list.dataSource=n;var o=1e4<e?e%1e4:e;this.updateTopThree(i,o)}else this.list.dataSource=[],this.xuwei1.visible=this.xuwei2.visible=this.xuwei3.visible=!0;this.updateMyPart()},e.resetTopThree=function(){this.txtName1.text="",this.txtPay1.text="",this.imageHead1.skin="",this.txtName2.text="",this.txtPay2.text="",this.imageHead2.skin="",this.txtName3.text="",this.txtPay3.text="",this.imageHead3.skin=""},e.updateTopThree=function(t,i){var e=t[0];if(this.txtName1.text=e.elements[0],this.imageHead1.skin="com/head/"+e.elements[1]+".png",Vh.isFanTi?this.txtPay1.text=1007==i?e.elements[2]/10+"仙尊幣":e.elements[2]+"元寶":1102==this.rankType?this.txtPay1.text=e.elements[2]+"个":this.txtPay1.text=e.elements[2]+"元宝",this.xuwei1.visible=!1,1<t.length){var s=t[1];s&&(this.txtName2.text=s.elements[0],this.imageHead2.skin="com/head/"+s.elements[1]+".png",Vh.isFanTi?this.txtPay2.text=1007==i?s.elements[2]/10+"仙尊幣":s.elements[2]+"元寶":1102==this.rankType?this.txtPay2.text=s.elements[2]+"个":this.txtPay2.text=s.elements[2]+"元宝",this.xuwei2.visible=!1)}if(2<t.length){var n=t[2];n&&(this.txtName3.text=n.elements[0],this.imageHead3.skin="com/head/"+n.elements[1]+".png",Vh.isFanTi?this.txtPay3.text=1007==i?n.elements[2]/10+"仙尊幣":n.elements[2]+"元寶":1102==this.rankType?this.txtPay3.text=n.elements[2]+"个":this.txtPay3.text=n.elements[2]+"元宝",this.xuwei3.visible=!1)}},e.updateMyPart=function(){var t;1007==this.rankType?t=Js.getMyRankData(this._uniqueRankId):1009==this.rankType?t=Js.getMyRankData(this._uniqueRankId):1102==this.rankType&&(t=Js.getMyRankData(this._uniqueRankId)),this.txtMyRank.text=t&&0<t.ranking?""+t.ranking:"暂未上榜"},o(0,e,"rankType",function(){return this._rankType},function(t){this._uniqueRankId=t,this._rankType=Xs.transformUniqueIdToRankId(t),1009==this._rankType?(this.titleText.skin="modules/athletics/titleSecond11.png",this.showText.text="消费总额"):1102==this._rankType?(this.titleText.skin="modules/athletics/titleSecond12.png",this.showText.text="消耗数量"):(this.titleText.skin="modules/athletics/titleSecond10.png",this.showText.text="今日充值总额")})}(Aa),function(t){function i(){this.cd=200,this.equipArr=null,this.curEquip=0,this.linkTxt=null,this.ftxtMaterials=null,this.imgLink=null,this.moveNum=0,this.hasNum=0,this.needNum=0,i.__super.call(this),this.linkTxt=new Wa,this.linkTxt.color="#96f254",this.linkTxt.fontSize=26,this.linkTxt.text="获取道具",this.linkTxt.underline=!0,this.linkTxt.height=30,this.linkTxt.pos(495,683),this.linkTxt.on("click",this,this.onLink),this.addChild(this.linkTxt),this.initItems(),this.initImgLink(),this.addChild(this.imgSelect),this.ftxtMaterials=new Pi(null,"center",285),this.ftxtMaterials.pos(306,599),this.addChild(this.ftxtMaterials),Ph.getOne(5,0,54,this),this.btnUp.on("click",this,this.onUp)}l(i,"modules.refine.RefineEngraveView",ln);var e=i.prototype;e.initImgLink=function(){null==this.imgLink&&(this.imgLink=this.imgLink||Na.getIns(44e3,"RefineImgLinkPanel"),this.imgLink.setRefineShowType(2),this.imgLink.on("click",this,this.onImgLink),this.imgLink.pos(603,54),this.addChild(this.imgLink))},e.onImgLink=function(){var t=new wa;t.type=15,t.step=Math.floor(un.getAllLv(un.curViewType,un.curChooseActor)/8),to.show(t,"SPEQUIP_POTENTIAL_TIP")},e.initItems=function(){var t;this.equipArr=this.equipArr||[];for(var i=0;i<rn.reinfItemPos.length;i++)(t=Na.getIns(44e3,"RefineEquipItem")).point=i,this.addChild(t),this.equipArr.push(t)},e.onLink=function(t){var i=un.getCurEquipVO();if(i){var e=i.getNeeds();e&&(Zi.show(e[0]),Ve.send(2,9,"轩辕鼎-铭刻-获取道具"))}},e.onUp=function(t){this.hasNum<this.needNum?this.onLink():pn.ins().isInCD||0<this.moveNum||(pn.ins().toRefineUp(),Ve.send(2,6,"轩辕鼎-铭刻按钮"))},e.showMove=function(){var t,i;for(var e in this.moveNum=0,this.equipArr)i=this.equipArr[e],this.moveNum++,t=Fn.getNextMovePoint(i.point),eo.to(i,{x:t.x,y:t.y,complete:ue.create(this,this.onComplete,[i])},this.cd,null)},e.onComplete=function(t){t.point=Fn.getNextPointIndex(t.point),this.moveNum--},e.updateByRefineUp=function(){this.showMove(),this.updateItems(),this.updateEquipInfo(),this.updateMaterial()},e.updateItems=function(){for(var t in this.equipArr)this.equipArr[t].update()},e.update=function(){this.setItemsPutwhere(),this.updateEquipInfo(),this.updateMaterial()},e.setItemsPutwhere=function(){this.curEquip=un.getCurEquip();var t,i=Fn.getNewEquipUpOrderArrByCur(this.curEquip);if(i)for(var e in this.equipArr)(t=this.equipArr[e]).equipPutwhere=i[t.point];this.updateRefineTagBarShow()},e.updateRefineTagBarShow=function(){if(this.imgLink){var t=un.getRefiningInfoByCurActor();if(t&&t.linear_refining&&0<t.linear_refining.length){var i,e=0;for(var s in t.linear_refining)if(1002==(i=t.linear_refining[s]).id){e=i.type;break}var n=_i.getPotentialVOByPos(15);if(e>=8*n.PotentialLvArr[n.PotentialLvArr.length-1].lv)return this.imgLink.updateProgressBar(1,1),void this.imgLink.unShowRedPoint();if(un.getAllLevelByCurView()>=un.getTotalStepLv(15,e))return this.imgLink.updateProgressBar(1,1),void this.imgLink.showRedPoint()}var h=un.getLastStepLvByViewType(15,un.getAllLv(un.curViewType,un.curChooseActor)),a=un.getStepLvByViewType(15,un.getAllLv(un.curViewType,un.curChooseActor));this.imgLink.updateProgressBar(h,a),this.imgLink.unShowRedPoint()}},e.updateEquipInfo=function(){this.txtLv.text="铭印"+un.getCurEquipRefineLv()+"级";var t,i=un.getCurEquipAttrs(),e=un.getCurEquipAttrs(!0);if(i&&0<i.length){var s;for(var n in t="",i)s=i[n],t+=te.getAttrStrByArr(s,""," +","\n");if(e&&i.length<e.length)for(var h=e.length-i.length;h<e.length;h++)s=e[h],t+=te.getAttrStrByNum(parseInt(s[0]),0," +","\n");this.txtAttrLeft.text=t.slice(0,t.length-1),this.btnUp.gray=!1,this.btnUp.mouseEnabled=!0,this.btnUp.label="铭刻"}if(un.isCurMaxLv())this.btnUp.gray=!0,this.btnUp.mouseEnabled=!1,this.btnUp.label="已满级",this.imgFull.visible=!0,this.txtAttrRight.visible=!1;else{for(n in this.imgFull.visible=!1,this.txtAttrRight.visible=!0,t="",e)t+=(s=e[n])[1]+"\n";this.txtAttrRight.text=t.slice(0,t.length-1)}this.updateTxtPos(),this.updatePower()},e.updateTxtPos=function(){this.txtAttrLeft.y=(this.txtAttrLeft.parent.height-this.txtAttrLeft.textHeight)/2+10,this.txtAttrRight.y=(this.txtAttrRight.parent.height-this.txtAttrRight.textHeight)/2+10},e.updatePower=function(){var t,i=Rt.numToTexture(un.getCurPower(),"com/ui/powerNum");this.spPow.graphics.clear();for(var e=0;e<i.length;e++)t=i[e],this.spPow.graphics.drawTexture(t,t.width*e)},e.updateMaterial=function(){if(un.isCurMaxLv())this.ftxtMaterials.setLinkText("已满级","#ffffff",!1);else{var t=un.getCurEquipVO();if(t){var i=t.getNeeds();i&&(this.hasNum=Ze.getGoodsNumByType(Ze.GOODS_ID,i[0]),this.needNum=i[1],this.ftxtMaterials.clear(),this.ftxtMaterials.addLinkText(this.hasNum+"",this.hasNum<this.needNum?Qi.COLORS_DARK[6]:"#ffffff",!1),this.ftxtMaterials.addLinkText(" / "+this.needNum,"#ffffff",!1))}}}}(),function(t){function i(){this._point=0,this._equipPutwhere=0,this.equipData=null,i.__super.call(this)}l(i,"modules.refine.RefineEquipItem",cn);var e=i.prototype;e.update=function(){this.equipData=un.getEquipInfo(this.equipPutwhere),this.equipData&&(this.txtNum.text="+"+this.equipData.curLv)},o(0,e,"point",function(){return this._point},function(t){this._point=t,this.pos(rn.reinfItemPos[t].x,rn.reinfItemPos[t].y)}),o(0,e,"equipPutwhere",function(){return this._equipPutwhere},function(t){this._equipPutwhere=t,this.img.skin="modules/refine/"+(20+t)+".png",this.update()})}(),function(t){function i(){i.__super.call(this),this.unShowRedPoint()}l(i,"modules.refine.RefineImgLinkPanel",dn);var e=i.prototype;e.setRefineShowType=function(t){switch(t){case 1:this.tagImg.skin="modules/refine/reinf.png";break;case 2:this.tagImg.skin="modules/refine/engrave.png";break;case 3:this.tagImg.skin="modules/refine/quality.png";break;case 4:this.tagImg.skin="modules/refine/goal.png";break;case 5:this.tagImg.skin="modules/role/po12.png";break;case 6:this.tagImg.skin="modules/role/po13.png"}},e.updateProgressBar=function(t,i){this.progressBar.width=t/i*100,this.progressNum.text=Math.floor(t/i*100)+"%"},e.showRedPoint=function(){this.redPoint.visible=!0},e.unShowRedPoint=function(){this.redPoint.visible=!1},i.BAR_WIDTH=100}(),function(t){function i(){this.cd=200,this.equipArr=null,this.curEquip=0,this.linkTxt=null,this.ftxtMaterials=null,this.imgLink=null,this.moveNum=0,this.hasNum=0,this.needNum=0,i.__super.call(this),this.linkTxt=new Wa,this.linkTxt.color="#96f254",this.linkTxt.fontSize=26,this.linkTxt.text="获取道具",this.linkTxt.underline=!0,this.linkTxt.height=30,this.linkTxt.pos(495,683),this.linkTxt.on("click",this,this.onLink),this.addChild(this.linkTxt),this.initItems(),this.initImgLink(),this.addChild(this.imgSelect),this.ftxtMaterials=new Pi(null,"center",285),this.ftxtMaterials.pos(306,599),this.addChild(this.ftxtMaterials),Ph.getOne(5,0,54,this),this.btnUp.on("click",this,this.onUp)}l(i,"modules.refine.RefineQualityView",mn);var e=i.prototype;e.initImgLink=function(){null==this.imgLink&&(this.imgLink=this.imgLink||Na.getIns(44e3,"RefineImgLinkPanel"),this.imgLink.setRefineShowType(3),this.imgLink.on("click",this,this.onImgLink),this.imgLink.pos(603,54),this.addChild(this.imgLink))},e.onImgLink=function(){var t=new wa;t.type=16,t.step=Math.floor(un.getAllLv(un.curViewType,un.curChooseActor)/8),to.show(t,"SPEQUIP_POTENTIAL_TIP")},e.initItems=function(){var t;this.equipArr=this.equipArr||[];for(var i=0;i<rn.reinfItemPos.length;i++)(t=Na.getIns(44e3,"RefineEquipItem")).point=i,this.addChild(t),this.equipArr.push(t)},e.onLink=function(t){var i=un.getCurEquipVO();if(i){var e=i.getNeeds();e&&(Zi.show(e[0]),Ve.send(2,9,"轩辕鼎-品质-获取道具"))}},e.onUp=function(t){this.hasNum<this.needNum?this.onLink():pn.ins().isInCD||0<this.moveNum||pn.ins().toRefineUp()},e.showMove=function(){var t,i;for(var e in this.moveNum=0,this.equipArr)i=this.equipArr[e],this.moveNum++,t=Fn.getNextMovePoint(i.point),eo.to(i,{x:t.x,y:t.y,complete:ue.create(this,this.onComplete,[i])},this.cd,null)},e.onComplete=function(t){t.point=Fn.getNextPointIndex(t.point),this.moveNum--},e.updateByRefineUp=function(){this.showMove(),this.updateItems(),this.updateEquipInfo(),this.updateMaterial(),this.updateRefineTagBarShow()},e.updateItems=function(){for(var t in this.equipArr)this.equipArr[t].update()},e.update=function(){this.setItemsPutwhere(),this.updateEquipInfo(),this.updateMaterial()},e.setItemsPutwhere=function(){this.curEquip=un.getCurEquip();var t,i=Fn.getNewEquipUpOrderArrByCur(this.curEquip);if(i)for(var e in this.equipArr)(t=this.equipArr[e]).equipPutwhere=i[t.point];this.updateRefineTagBarShow()},e.updateRefineTagBarShow=function(){if(this.imgLink){var t=un.getRefiningInfoByCurActor();if(t&&t.linear_refining&&0<t.linear_refining.length){var i,e=0;for(var s in t.linear_refining)if(1003==(i=t.linear_refining[s]).id){e=i.type;break}var n=_i.getPotentialVOByPos(16);if(e>=8*n.PotentialLvArr[n.PotentialLvArr.length-1].lv)return this.imgLink.updateProgressBar(1,1),void this.imgLink.unShowRedPoint();if(un.getAllLevelByCurView()>=un.getTotalStepLv(16,e))return this.imgLink.updateProgressBar(1,1),void this.imgLink.showRedPoint()}var h=un.getLastStepLvByViewType(16,un.getAllLv(un.curViewType,un.curChooseActor)),a=un.getStepLvByViewType(16,un.getAllLv(un.curViewType,un.curChooseActor));this.imgLink.updateProgressBar(h,a),this.imgLink.unShowRedPoint()}},e.updateEquipInfo=function(){var t,i=un.getCurEquipAttrs(),e=un.getCurEquipAttrs(!0);if(i&&0<i.length){var s;for(var n in t="",i)s=i[n],t+=te.getAttrStrByArr(s,""," +","\n");if(e&&i.length<e.length)for(var h=e.length-i.length;h<e.length;h++)s=e[h],t+=te.getAttrStrByNum(parseInt(s[0]),0," +","\n");this.txtAttrLeft.text=t.slice(0,t.length-1),this.btnUp.gray=!1,this.btnUp.mouseEnabled=!0,this.btnUp.label="提升"}if(un.isCurMaxLv())this.btnUp.gray=!0,this.btnUp.mouseEnabled=!1,this.btnUp.label="已满级",this.imgFull.visible=!0,this.txtAttrRight.visible=!1;else{for(n in this.imgFull.visible=!1,this.txtAttrRight.visible=!0,t="",e)t+=(s=e[n])[1]+"\n";this.txtAttrRight.text=t.slice(0,t.length-1)}this.updateTxtPos(),this.updatePower()},e.updateTxtPos=function(){this.txtAttrLeft.y=(this.txtAttrLeft.parent.height-this.txtAttrLeft.textHeight)/2+10,this.txtAttrRight.y=(this.txtAttrRight.parent.height-this.txtAttrRight.textHeight)/2+10},e.updatePower=function(){var t,i=Rt.numToTexture(un.getCurPower(),"com/ui/powerNum");this.spPow.graphics.clear();for(var e=0;e<i.length;e++)t=i[e],this.spPow.graphics.drawTexture(t,t.width*e)},e.updateMaterial=function(){if(un.isCurMaxLv())this.ftxtMaterials.setLinkText("已满级","#ffffff",!1);else{var t=un.getCurEquipVO();if(t){var i=t.getNeeds();i&&(this.hasNum=ie.getScore(1),this.needNum=i[1],this.ftxtMaterials.clear(),this.ftxtMaterials.addLinkText(this.hasNum+"",this.hasNum<this.needNum?Qi.COLORS_DARK[6]:"#ffffff",!1),this.ftxtMaterials.addLinkText(" / "+this.needNum,"#ffffff",!1))}}}}(),function(t){function i(){this.CD=200,this.equipArr=null,this.curEquip=0,this.ftxtMaterials=null,this.imgLink=null,this._isInOneKeyUp=!1,this.moveNum=0,this.hasNum=0,this.needNum=0,i.__super.call(this),this.linkTxt.on("click",this,this.onLink),this.initItems(),this.initImgLink(),this.addChild(this.imgSelect),this.ftxtMaterials=new Pi(null,"center",250),this.ftxtMaterials.pos(290,599),this.addChild(this.ftxtMaterials),Ph.getOne(5,0,54,this),this.btnUp.on("click",this,this.onClick),this.btnOne.on("click",this,this.onOneKey),this.on("undisplay",this,this.onRemove),this.on("display",this,this.onDisplay),ni.register("GUIDE_STEP",this,this.onGuideStep)}l(i,"modules.refine.RefineReinfView",fn);var e=i.prototype;e.initImgLink=function(){null==this.imgLink&&(this.imgLink=this.imgLink||Na.getIns(44e3,"RefineImgLinkPanel"),this.imgLink.setRefineShowType(1),this.imgLink.on("click",this,this.onImgLink),this.imgLink.pos(603,54),this.addChild(this.imgLink))},e.onGuideStep=function(t){t!=le.CLICK_INTENSIFY_BTN1&&t!=le.CLICK_INTENSIFY_BTN2&&t!=le.CLICK_INTENSIFY_BTN3&&t!=le.CLICK_INTENSIFY_BTN4&&t!=le.CLICK_INTENSIFY_BTN5||le.showStep(t,this.btnUp)},e.onDisplay=function(){ni.register("ROLE_UPDATE_REFINE",this,this.updateRefineTagBarShow),le.nextStep==le.CLICK_INTENSIFY_BTN1&&le.showStep(le.CLICK_INTENSIFY_BTN1,this.btnUp)},e.onImgLink=function(){var t=new wa;t.type=14,t.step=Math.floor(un.getAllLv(un.curViewType,un.curChooseActor)/8),to.show(t,"SPEQUIP_POTENTIAL_TIP")},e.initItems=function(){var t;this.equipArr=this.equipArr||[];for(var i=0;i<rn.reinfItemPos.length;i++)(t=Na.getIns(44e3,"RefineEquipItem")).point=i,this.addChild(t),this.equipArr.push(t)},e.onLink=function(t){var i=un.getCurEquipVO();if(i){var e=i.getNeeds();e&&Zi.show(e[0])}},e.onClick=function(t){this._isInOneKeyUp||(this.hasNum<this.needNum?this.onLink():0<this.moveNum||this.toUp())},e.toUp=function(){pn.ins().toRefineUp(),Ve.send(2,5,"轩辕鼎-强化按钮")},e.onOneKey=function(t){100<=ie.myLevel||2<=oo.curLv?this.isInOneKeyUp=!this.isInOneKeyUp:(io.addTip("VIP2或100级可开启一键强化功能"),Ae.linkTo(10201))},e.onRemove=function(){this.isInOneKeyUp=!1},e.updateByRefineUp=function(){this.showMove()},e.showMove=function(){var t,i;for(var e in this.moveNum=0,this.equipArr)i=this.equipArr[e],this.moveNum++,t=Fn.getNextMovePoint(i.point),eo.to(i,{x:t.x,y:t.y,complete:ue.create(this,this.onComplete,[i])},this.CD,null)},e.onComplete=function(t){var i=this;t.point=Fn.getNextPointIndex(t.point),this.moveNum--,this.moveNum<=0&&(this.updateByMoveEnd(),De.setTimeout(this,function(){i.isInOneKeyUp=i.isInOneKeyUp},null,50))},e.updateByMoveEnd=function(){this.updateItems(),this.updateEquipInfo(),this.updateMaterial()},e.updateItems=function(){for(var t in this.equipArr)this.equipArr[t].update()},e.update=function(){this.setItemsPutwhere(),this.updateEquipInfo(),this.updateMaterial(),this.txtTip.visible=ie.myLevel<100&&oo.curLv<2,ji.isReviewVersion&&(this.txtTip.visible=this.btnOne.visible=!1)},e.setItemsPutwhere=function(){this.curEquip=un.getCurEquip();var t,i=Fn.getNewEquipUpOrderArrByCur(this.curEquip);if(i)for(var e in this.equipArr)(t=this.equipArr[e]).equipPutwhere=i[t.point];this.updateRefineTagBarShow()},e.updateRefineTagBarShow=function(){if(this.imgLink){var t=un.getRefiningInfoByCurActor();if(t&&t.linear_refining&&0<t.linear_refining.length){var i,e=0;for(var s in t.linear_refining)if(1001==(i=t.linear_refining[s]).id){e=i.type;break}var n=_i.getPotentialVOByPos(14);if(e>=8*n.PotentialLvArr[n.PotentialLvArr.length-1].lv)return this.imgLink.updateProgressBar(1,1),void this.imgLink.unShowRedPoint();if(un.getAllLevelByCurView()>=un.getTotalStepLv(14,e))return this.imgLink.updateProgressBar(1,1),void this.imgLink.showRedPoint()}var h=un.getLastStepLvByViewType(14,un.getAllLv(un.curViewType,un.curChooseActor)),a=un.getStepLvByViewType(14,un.getAllLv(un.curViewType,un.curChooseActor));this.imgLink.updateProgressBar(h,a),this.imgLink.unShowRedPoint()}},e.updateEquipInfo=function(){var t,i=un.getCurEquipAttrs(),e=un.getCurEquipAttrs(!0);if(i&&0<i.length){var s;for(var n in t="",i)s=i[n],t+=te.getAttrStrByArr(s,""," +","\n");if(e&&i.length<e.length)for(var h=e.length-i.length;h<e.length;h++)s=e[h],t+=te.getAttrStrByNum(parseInt(s[0]),0," +","\n");this.txtAttrLeft.text=t.slice(0,t.length-1),this.btnUp.gray=!1,this.btnUp.mouseEnabled=!0,this.btnUp.label="强化"}if(un.isCurMaxLv())this.btnUp.gray=!0,this.btnUp.mouseEnabled=!1,this.btnUp.label="已满级",this.btnUp.x=275,this.btnOne.visible=!1,this.imgFull.visible=!0,this.txtAttrRight.visible=!1;else{for(n in this.btnUp.x=422,this.btnOne.visible=!0,this.imgFull.visible=!1,this.txtAttrRight.visible=!0,t="",e)t+=(s=e[n])[1]+"\n";this.txtAttrRight.text=t.slice(0,t.length-1)}this.updateTxtPos(),this.updatePower()},e.updateTxtPos=function(){this.txtAttrLeft.y=(this.txtAttrLeft.parent.height-this.txtAttrLeft.textHeight)/2+10,this.txtAttrRight.y=(this.txtAttrRight.parent.height-this.txtAttrRight.textHeight)/2+10},e.updatePower=function(){var t,i=Rt.numToTexture(un.getCurPower(),"com/ui/powerNum");this.spPow.graphics.clear();for(var e=0;e<i.length;e++)t=i[e],this.spPow.graphics.drawTexture(t,t.width*e)},e.updateMaterial=function(){if(un.isCurMaxLv())this.ftxtMaterials.setLinkText("已满级","#ffffff",!1);else{var t=un.getCurEquipVO();if(t){var i=t.getNeeds();i&&(this.hasNum=Ze.getGoodsNumByType(Ze.GOODS_ID,i[0]),this.needNum=i[1],this.ftxtMaterials.clear(),this.ftxtMaterials.addLinkText(this.hasNum+"",this.hasNum<this.needNum?Qi.COLORS_DARK[6]:"#ffffff",!1),this.ftxtMaterials.addLinkText(" / "+this.needNum,"#ffffff",!1))}}},o(0,e,"isInOneKeyUp",function(){return this._isInOneKeyUp},function(t){this._isInOneKeyUp=t,this._isInOneKeyUp?(this.btnOne.label="停止",this.hasNum>=this.needNum?this.toUp():(this.isInOneKeyUp=!1,this.onLink())):this.btnOne.label="一键强化"})}(),function(t){function i(){this._equipPos=0,this._step=0,this._select=!1,i.__super.call(this)}l(i,"modules.refine.RefineSoulEquipItem",_n);var e=i.prototype;o(0,e,"equipPos",function(){return this._equipPos},function(t){this._equipPos=t,this.imgGoods.skin="modules/refine/"+(20+t)+".png"}),o(0,e,"step",function(){return this._step},function(t){this._step=Math.max(t,0),0<this._step?this.txtInfo.text=this._step+"阶":this.txtInfo.text="",this.imgRp.visible=Fn.checkSoulOne(this._step)}),o(0,e,"select",null,function(t){this._select=t,this.imgSelect.visible=t})}(),function(t){function i(){i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.html.style.valign="top",this.html.style.fontSize=26,this.html.style.leading=10,this.html.innerHTML=this.getHtml()}l(i,"modules.refine.RefineSoulHelpPanel",yn),i.prototype.getHtml=function(){var t="";return t+=pe.span("1、 装备附魂可","#e1c6bc",26),t+=pe.span("百分比提升","#96f254",26),t+=pe.span("对应部位装备的基础属性和橙装洗练属性","#e1c6bc",26),t+="<br />"+pe.span("2、 附魂时可选择多种附魂材料，对应不同的","#e1c6bc",26)+"<br />"+pe.span("附魂成功率","#e1c6bc",26),t+="<br />"+pe.span("3、 附魂成功时提升对应部位的附魂等级，附","#e1c6bc",26)+"<br />"+pe.span("魂失败时，会导致","#e1c6bc",26)+pe.span("附魂等级下降","#96f254",26)}}(),function(t){function i(){this._select=!1,this._data=null,this._canUp=!1,i.__super.call(this),this.on("click",this,this.onClick)}l(i,"modules.refine.RefineSoulMaterialItem",Sn);var e=i.prototype;e.onClick=function(t){0==this.select&&(this.select=!0)},e.reset=function(){this._canUp=!1,this.selectNoEvent=!1,this.txtPercent.text=this.txtNeed.text=this.txtNow.text=this.imgGoods.skin=""},o(0,e,"select",function(){return this._select},function(t){this._select!=t&&(this.selectNoEvent=t,this.event("change",this))}),o(0,e,"data",function(){return this._data},function(t){if(this.reset(),this._data=t){var i=ve.getItem(t[0]);i&&(this.imgGoods.skin=i.realMaxico);var e=Ze.getGoodsNumByType(Ze.GOODS_ID,t[0]);e<t[1]?(this.txtNow.color=Qi.COLORS_DARK[6],this._canUp=!1):(this.txtNow.color="#ffffff",this._canUp=!0),this.txtNow.text=e+"",this.txtNeed.text="/"+t[1],this.txtPercent.text=t[2]/100+"%成功率"}}),o(0,e,"canUp",function(){return this._canUp}),o(0,e,"selectNoEvent",null,function(t){this._select=t,this.imgPoint.skin=this._select?"modules/refine/point1.png":"modules/refine/point0.png",this.imgSelect.visible=t})}(),function(t){function i(){this.equipItems=null,this.curPRefine=null,this.curPEquip=null,this._curEquipIndex=0,this._curMaterialIndex=0,this.imgLink=null,this.curLvVO=null,this.nextLvVO=null,this.curMaterialItem=null,this.materialPool=null,i.__super.call(this),this.initItems(),this.initImgLink(),this.html.color="#96f254",this.html.fontSize=26,this.html.text="获取道具",this.html.underline=!0,this.html.on("click",this,this.onLink),this.on("display",this,this.onAdd),this.btnUp.on("click",this,this.onClick),this.btnHelp.on("click",this,this.onClick),this.imgGoodsBg.on("click",this,this.onClick)}l(i,"modules.refine.RefineSoulView",Gn);var e=i.prototype;e.initItems=function(){this.equipItems=[];for(var t=0;t<rn.soulItemPos.length;t++){var i=Na.getIns(44e3,"RefineSoulEquipItem");i.pos(rn.soulItemPos[t][0],rn.soulItemPos[t][1]),i.equipPos=t+1,i.on("click",this,this.onEquipClick),this.addChild(i),this.equipItems.push(i)}},e.initImgLink=function(){null==this.imgLink&&(this.imgLink=this.imgLink||Na.getIns(44e3,"RefineImgLinkPanel"),this.imgLink.setRefineShowType(4),this.imgLink.on("click",this,this.onImgLink),this.imgLink.pos(481,53),this.addChild(this.imgLink))},e.onImgLink=function(){if(this.curPRefine=un.getRefineInfo(un.curChooseActor),this.curPRefine){_i.getPotentialBelongStepByPos(17,this.curPRefine.equip_active_lv);var t=new wa;t.type=17,t.step=this.curPRefine.equip_active_lv,t.nowCaller=this,t.nowLvFun=this.updateGoalLvFun,to.show(t,"SPEQUIP_POTENTIAL_TIP")}},e.update=function(){for(var t in this.equipItems)this.equipItems[t].step=0;this.updateEquipItems(),this.updateInfo(),this.updateRefineTagBarShow()},e.updateByRefineUp=function(){this.updateEquipItems(),this.updateInfo()},e.updateRefineTagBarShow=function(){if(this.curPRefine=un.getRefineInfo(un.curChooseActor),this.imgLink&&this.curPRefine&&0<=this.curPRefine.equip_active_lv){var t=this.curPRefine.equip_active_lv,i=un.getSoulNextStep(t);if(t<on.maxSoulStep){var e=_i.getPotentialBelongStepByPos(17,this.curPRefine.equip_active_lv);if(Math.floor(un.getRefineSoulAllStep(un.curChooseActor,e)/8)>=i)return this.imgLink.updateProgressBar(1,1),void this.imgLink.showRedPoint();var s=un.getLastStepLvByViewType(17,un.getRefineSoulAllStep(un.curChooseActor,e)),n=un.getStepLvByViewType(17,un.getRefineSoulAllStep(un.curChooseActor,e));this.imgLink.updateProgressBar(s,n),this.imgLink.unShowRedPoint()}else this.imgLink.updateProgressBar(1,1),this.imgLink.unShowRedPoint()}},e.updateEquipItems=function(){if(this.curPRefine=un.getRefineInfo(un.curChooseActor),this.curPRefine&&this.curPRefine.equip_refining)for(var t=0;t<this.curPRefine.equip_refining.length;t++){var i=this.curPRefine.equip_refining[t];i&&this.equipItems[i.id-1]&&(this.equipItems[i.id-1].step=i.val)}},e.updateInfo=function(){this.curPRefine=un.getRefineInfo(un.curChooseActor),this.curPRefine&&(this.updateBest(),this.updateStepInfo())},e.updateBest=function(){this.curPEquip=null;var t=ie.getPalByIndex(un.curActorIndex);if(t){var i;for(var e in t.equip)if(i=t.equip[e],this.equipItems[this.curEquipIndex].equipPos==i.pos){this.curPEquip=i;var s=ve.getItem(i.type_id);return void(this.imgGoods.skin=s.realMaxico)}this.imgGoods.skin="modules/refine/"+(20+this.equipItems[this.curEquipIndex].equipPos)+".png"}},e.updateStepInfo=function(){for(var t=this.equipItems[this.curEquipIndex].step,i=0;i<this.spFire.numChildren;i++)this.spFire.getChildAt(i).skin=i<t?"modules/refine/fire"+on.getSoulStepSource(i+1)+".png":"modules/refine/fire.png";this.curLvVO=on.getSoulLvVO(t),this.nextLvVO=on.getSoulLvVO(t+1),this.txtAttrLeft.text=0==t?"0%":this.curLvVO.add/100+"%",t<on.maxSoulStep?(this.txtAttrRight.text=this.nextLvVO.add/100+"%",this.imgFull.visible=!1,this.updateMaterial(this.nextLvVO.getNeed()),this.btnUp.label="附魂",this.btnUp.disabled=!1):(this.imgFull.visible=!0,this.txtAttrRight.text="",this.updateMaterial(null),this.btnUp.label="已满级",this.btnUp.disabled=!0)},e.updateMaterial=function(t){if(this.rePool(),this.curMaterialItem=null,t){for(var i,e=0;e<t.length;e++)(i=this.getMaterialItem()).data=t[e],this.spMaterial.addChild(i);Ce.layoutHorizontalInCenter(this.spMaterial,30,this.spMaterial.width,i.width),this.curMaterialIndex=this.getDefaultChoose(t)}},e.getDefaultChoose=function(t){if(t){var i=t[t.length-1];return Ze.getGoodsNumByType(Ze.GOODS_ID,i[0])<i[1]?this.curMaterialIndex:t.length-1}return 0},e.onEquipClick=function(t){t.currentTarget&&(this.curEquipIndex=t.currentTarget.equipPos-1)},e.onClick=function(t){switch(t.currentTarget){case this.btnHelp:pn.ins().openSoulHelpPanel();break;case this.btnUp:var i=this.curMaterialItem?this.curMaterialItem.data:null;if(this.curMaterialItem&&this.curMaterialItem.canUp&&i)if(this.curMaterialItem.data[2]/100<100){var e=ve.getItem(i[0]);if(e){var s=new q;s.msg="是否使用"+e.name+"进行附魂（成功率为"+this.curMaterialItem.data[2]/100+"%）？",s.key="refineSoulUp",s.yesCaller=pn.ins(),s.yesFun=pn.ins().toSoulUp,s.yesArgs=[un.curChooseActor,i[0],this.equipItems[this.curEquipIndex].equipPos],K.showVO(s)}}else pn.ins().toSoulUp(un.curChooseActor,i[0],this.equipItems[this.curEquipIndex].equipPos);else io.addTip("附魂材料不足");break;case this.imgGoodsBg:this.curPEquip?to.show(this.curPEquip,"REFINE_SOUL_BEST_EQUIP_TIP"):io.addTip("当前暂未穿上该装备")}},e.updateGoalLvFun=function(t){return un.getRefineSoulStepNum(un.curChooseActor,t)},e.onLink=function(t){if(this.nextLvVO){var i,e=[];for(var s in this.nextLvVO.getNeed())i=this.nextLvVO.getNeed()[s],e.push(i[0])}Zi.show2(e),Ve.send(2,11,"轩辕鼎-附魂-获取道具")},e.onChange=function(t){this.curMaterialIndex=this.spMaterial.getChildIndex(t)},e.onAdd=function(t){this.curEquipIndex=0},e.getMaterialItem=function(){if(this.materialPool=this.materialPool||[],0<this.materialPool.length)return this.materialPool.shift();var t=Na.getIns(44e3,"RefineSoulMaterialItem");return t.on("change",this,this.onChange),t},e.rePool=function(){for(var t;0<this.spMaterial.numChildren;)(t=this.spMaterial.removeChildAt(0)).reset(),this.materialPool.push(t)},o(0,e,"curMaterialIndex",function(){return this._curMaterialIndex},function(t){if(!(t<0)){this._curMaterialIndex=t;var i=this.spMaterial.getChildAt(this._curMaterialIndex);this.curMaterialItem?this.curMaterialItem!=i&&(this.curMaterialItem.selectNoEvent=!1,this.curMaterialItem=i):this.curMaterialItem=i,this.curMaterialItem&&(this.curMaterialItem.selectNoEvent=!0)}}),o(0,e,"curEquipIndex",function(){return this._curEquipIndex},function(t){for(var i in this._curEquipIndex=t,this.equipItems)this.equipItems[i].select=!1;this.equipItems[this.curEquipIndex].select=!0,this.update()})}(),function(t){function i(){this.refineSoulCoin1=0,this.refineSoulCoin2=0,this.refineSoulCoin3=0,this.refineSoulCoin4=0,this.refineSoulMixEquation=null,this.needCoin1=0,this.needCoin2=0,this.needCoin3=0,this.needCoin4=0,this.refineSoulMixEquationVO=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.inputNum.restrict="0-99",this.inputNum.maxChars=5,this.inputNum.text="1",this.on("click",this,this.onClick),this.tab.on("change",this,this.onTabChange),this.inputNum.on("change",this,this.onInputChange),this.inputNum.on("input",this,this.onInputChange),this.init()}l(i,"modules.refineSoulPalace.GodSoulMixView",he);var e=i.prototype;e.init=function(){this.tab.selectedIndex=0,this.btnMix.pos(241,670),this.btnRefresh.visible=!1,this.txtNum1.style.align="center",this.txtNum2.style.align="center",this.txtNum3.style.align="center",this.txtNum4.style.align="center"},e.update=function(){1==this.tab.selectedIndex?(this.btnMix.pos(373,670),this.btnRefresh.visible=!0,this.txtCoin.visible=!0,this.refineSoulMixEquation=On.getRefineSoulEquationById(On.mixSpEquationId),this.refineSoulMixEquationVO=On.getRefinSoulEquationVOById(On.mixSpEquationId)):0==this.tab.selectedIndex&&(this.btnMix.pos(260,670),this.btnRefresh.visible=!1,this.txtCoin.visible=!1,this.refineSoulMixEquation=On.getRefineSoulEquationById(0),this.refineSoulMixEquationVO=On.getRefinSoulEquationVOById(0)),this.updateTxt()},e.onClick=function(t){var i=0,e=0;switch(t.target){case this.btnUp:e=0==this.tab.selectedIndex?On.getRefineSoulMixMaxNum(0):On.getRefineSoulMixMaxNum(On.mixSpEquationId),i=parseInt(this.inputNum.text),this.inputNum.text=e<=i?e+"":i+1+"",this.updateTxt();break;case this.btnDown:1<(i=parseInt(this.inputNum.text))&&(i-=1,this.inputNum.text=i+""),this.updateTxt();break;case this.btnMax:0==this.tab.selectedIndex?this.inputNum.text=On.getRefineSoulMixMaxNum(0)+"":this.inputNum.text=On.getRefineSoulMixMaxNum(On.mixSpEquationId)+"",this.updateTxt();break;case this.btnClose:case this.btnBack:this.closeWindow();break;case this.btnMix:i=parseInt(this.inputNum.text),0==this.tab.selectedIndex?this.isEnoughMaterials()?Cn.ins().toGodSoulMix(1,i):io.addTip("仙魂材料不足"):this.isEnoughMaterials()?Cn.ins().toGodSoulMix(2,i):io.addTip("仙魂材料不足");break;case this.btnRefresh:ie.checkMoney(0,15e5)?Cn.ins().toGodSoulFormulaRefresh():Zi.show(10201113)}},e.onTabChange=function(){switch(this.tab.selectedIndex){case 0:this.inputNum.text="1",this.txtDesc.visible=!1,this.update();break;case 1:this.inputNum.text="1",this.txtDesc.visible=!0,this.update()}},e.onInputChange=function(){""==this.inputNum.text&&(this.inputNum.text="1");var t=parseInt(this.inputNum.text),i=0;(i=0==this.tab.selectedIndex?On.getRefineSoulMixMaxNum(0):On.getRefineSoulMixMaxNum(On.mixSpEquationId))<=t&&(this.inputNum.text=i+""),this.updateTxt()},e.updateTxt=function(){this.refineSoulCoin1=On.getRefineSoulCoinById(31),this.refineSoulCoin2=On.getRefineSoulCoinById(32),this.refineSoulCoin3=On.getRefineSoulCoinById(33),this.refineSoulCoin4=On.getRefineSoulCoinById(34),this.needCoin1=this.refineSoulMixEquation[0],this.needCoin2=this.refineSoulMixEquation[1],this.needCoin3=this.refineSoulMixEquation[2],this.needCoin4=this.refineSoulMixEquation[3],this.refineSoulCoin1<this.needCoin1*parseInt(this.inputNum.text)?this.txtNum1.innerHTML=pe.span(this.refineSoulCoin1+"","#ff5858")+pe.span("/"+this.needCoin1*parseInt(this.inputNum.text),"#ffffff"):this.txtNum1.innerHTML=pe.span(this.refineSoulCoin1+"","#ffffff")+pe.span("/"+this.needCoin1*parseInt(this.inputNum.text),"#ffffff"),this.refineSoulCoin2<this.needCoin2*parseInt(this.inputNum.text)?this.txtNum2.innerHTML=pe.span(this.refineSoulCoin2+"","#ff5858")+pe.span("/"+this.needCoin2*parseInt(this.inputNum.text),"#ffffff"):this.txtNum2.innerHTML=pe.span(this.refineSoulCoin2+"","#ffffff")+pe.span("/"+this.needCoin2*parseInt(this.inputNum.text),"#ffffff"),this.refineSoulCoin3<this.needCoin3*parseInt(this.inputNum.text)?this.txtNum3.innerHTML=pe.span(this.refineSoulCoin3+"","#ff5858")+pe.span("/"+this.needCoin3*parseInt(this.inputNum.text),"#ffffff"):this.txtNum3.innerHTML=pe.span(this.refineSoulCoin3+"","#ffffff")+pe.span("/"+this.needCoin3*parseInt(this.inputNum.text),"#ffffff"),this.refineSoulCoin4<this.needCoin4*parseInt(this.inputNum.text)?this.txtNum4.innerHTML=pe.span(this.refineSoulCoin4+"","#ff5858")+pe.span("/"+this.needCoin4*parseInt(this.inputNum.text),"#ffffff"):this.txtNum4.innerHTML=pe.span(this.refineSoulCoin4+"","#ffffff")+pe.span("/"+this.needCoin4*parseInt(this.inputNum.text),"#ffffff"),this.txtMix.text=this.refineSoulMixEquationVO.num*parseInt(this.inputNum.text)+""},e.isEnoughMaterials=function(){return this.refineSoulCoin1=On.getRefineSoulCoinById(31),this.refineSoulCoin2=On.getRefineSoulCoinById(32),this.refineSoulCoin3=On.getRefineSoulCoinById(33),this.refineSoulCoin4=On.getRefineSoulCoinById(34),this.needCoin1=this.refineSoulMixEquation[0],this.needCoin2=this.refineSoulMixEquation[1],this.needCoin3=this.refineSoulMixEquation[2],this.needCoin4=this.refineSoulMixEquation[3],!(this.refineSoulCoin1<this.needCoin1*parseInt(this.inputNum.text))&&(!(this.refineSoulCoin2<this.needCoin2*parseInt(this.inputNum.text))&&(!(this.refineSoulCoin3<this.needCoin3*parseInt(this.inputNum.text))&&!(this.refineSoulCoin4<this.needCoin4*parseInt(this.inputNum.text))))},e.resetInputText=function(){this.inputNum.text="1",this.update()},e.showSucceedEff=function(){ri.show("moduleEffect/skill_book_hecheng1",352,166,this)}}(),function(t){function i(){i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick),this.init()}l(i,"modules.refineSoulPalace.RefineSoulBagPanel",gn);var e=i.prototype;e.init=function(){this.listGoods.itemRender=Na.getClass(45e3,"RefineSoulBagGoodsItem"),this.listGoods.vScrollBarSkin="",this.listGoods.scrollBar.autoHide=!0},e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow()}},e.update=function(){var t;(t=On.getRefineSoulBagGoods())&&(this.listGoods.dataSource=t)}}(),function(t){function i(){this._data=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_8",!0)}l(i,"modules.refineSoulPalace.RefineSoulGoodsTip",vn);var e=i.prototype;e.update=function(){if(this._data&&this.vo){this.txtNum.text="1",this.txtLv.text=this.vo.level+"级",this.txtName.text=this.vo.name+" +"+this.quality,this.txtName.color=Qi.getColorDark(this.vo.color),this.goodImg.skin="modules/goods/maxico/"+this.vo.path+".png";var t=On.getInlayStoneAttrByTypeAndQuality(this._data.typeid,this.quality),i=On.getInlayStoneAttr2ByTypeAndQuality(this._data.typeid,this.quality);t&&i&&(this.txtAttr.text=t[0][0]+":"+t[0][1]+"\n"+t[1][0]+":"+t[1][1]+"\n对天魂炉"+i[0][0]+"加成:"+i[0][1]+"%\n对天魂炉"+i[1][0]+"加成:"+i[1][1]+"%\n"),this.txtDesc.text=this.vo.desc}},o(0,e,"data",function(){return this._data},function(t){this._data=t,this.update()}),o(0,e,"quality",function(){return this._data?On.getSoulStoenQualityById(this._data.id):0}),o(0,e,"vo",function(){return this._data?ve.getItem(this._data.typeid):null})}(),function(t){function i(){this.selectedId=0,this.curRoleId=0,this.moveHandler=null,this.tokenNum=null,this.typeId=0,this.hasColor=!1,this._data=null,this._type=0,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.imgMove.visible=!1,this.imgChoes2.visible=!1,this.moveHandler=ue.create(this,this.moveCallBack),this.imgType1.skin="modules/refineSoulPalace/img/token1.png",this.imgType2.skin="modules/refineSoulPalace/img/token2.png",this.imgType3.skin="modules/refineSoulPalace/img/token3.png",this.imgType4.skin="modules/refineSoulPalace/img/token4.png"}l(i,"modules.refineSoulPalace.RefineSoulGridUnlockPanel",bn);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow();break;case this.btnYes:switch(this.selectedId){case 1:this.typeId=10403002;break;case 2:this.typeId=10403003;break;case 3:this.typeId=10403004;break;case 4:this.typeId=10403005}0==this.typeId?io.addTip("请选择缚魂令"):Cn.ins().toUnlockGrid(this.curRoleId,this.data.pos,this.typeId);break;case this.imgType1:if(1==this.hasColor&&this.curRoleId==ie.user.role_id)break;this.curRoleId==ie.user.role_id&&(0<this.tokenNum[0]?(0<this.selectedId&&(this.tokenNum[this.selectedId-1]+=1),this.selectedId=1,this.movingImg(this.selectedId),this.tokenNum[this.selectedId-1]-=1,this.update()):io.addTip("所选解缚令不足，可通过补给或商场中的魂烬灵匣获得")),1==this.hasColor&&this.curRoleId!=ie.user.role_id&&(0<this.tokenNum[0]?(0<this.selectedId&&(this.tokenNum[this.selectedId-1]+=1),this.selectedId=1,this.movingImg(this.selectedId),this.tokenNum[this.selectedId-1]-=1,this.update()):io.addTip("所选解缚令不足，可通过补给或商场中的魂烬灵匣获得"));break;case this.imgType2:if(1==this.hasColor&&this.curRoleId==ie.user.role_id)break;this.curRoleId==ie.user.role_id&&(0<this.tokenNum[1]?(0<this.selectedId&&(this.tokenNum[this.selectedId-1]+=1),this.selectedId=2,this.movingImg(this.selectedId),this.tokenNum[this.selectedId-1]-=1,this.update()):io.addTip("所选解缚令不足，可通过补给或商场中的魂烬灵匣获得")),1==this.hasColor&&this.curRoleId!=ie.user.role_id&&(0<this.tokenNum[1]?(0<this.selectedId&&(this.tokenNum[this.selectedId-1]+=1),this.selectedId=2,this.movingImg(this.selectedId),this.tokenNum[this.selectedId-1]-=1,this.update()):io.addTip("所选解缚令不足，可通过补给或商场中的魂烬灵匣获得"));break;case this.imgType3:if(1==this.hasColor&&this.curRoleId==ie.user.role_id)break;this.curRoleId==ie.user.role_id&&(0<this.tokenNum[2]?(0<this.selectedId&&(this.tokenNum[this.selectedId-1]+=1),this.selectedId=3,this.movingImg(this.selectedId),this.tokenNum[this.selectedId-1]-=1,this.update()):io.addTip("所选解缚令不足，可通过补给或商场中的魂烬灵匣获得")),1==this.hasColor&&this.curRoleId!=ie.user.role_id&&(0<this.tokenNum[2]?(0<this.selectedId&&(this.tokenNum[this.selectedId-1]+=1),this.selectedId=3,this.movingImg(this.selectedId),this.tokenNum[this.selectedId-1]-=1,this.update()):io.addTip("所选解缚令不足，可通过补给或商场中的魂烬灵匣获得"));break;case this.imgType4:if(1==this.hasColor&&this.curRoleId==ie.user.role_id)break;this.curRoleId==ie.user.role_id&&(0<this.tokenNum[3]?(0<this.selectedId&&(this.tokenNum[this.selectedId-1]+=1),this.selectedId=4,this.movingImg(this.selectedId),this.tokenNum[this.selectedId-1]-=1,this.update()):io.addTip("所选解缚令不足，可通过补给或商场中的魂烬灵匣获得")),1==this.hasColor&&this.curRoleId!=ie.user.role_id&&(0<this.tokenNum[3]?(0<this.selectedId&&(this.tokenNum[this.selectedId-1]+=1),this.selectedId=4,this.movingImg(this.selectedId),this.tokenNum[this.selectedId-1]-=1,this.update()):io.addTip("所选解缚令不足，可通过补给或商场中的魂烬灵匣获得"))}},e.onDisplay=function(){this.typeId=0,this.tokenNum=On.getRefineSoulTokenNum(),this.btnYes.mouseEnabled=!0,this.btnYes.state=0,this.selectedId=0,this.imgChoes1.skin="",this.imgChoes2.skin=""},e.update=function(){1==this.type?this.curRoleId=ie.user.role_id:this.curRoleId=On.curRoleId,this.updateChose(),this.txtNum1.text=this.tokenNum[0]+"",this.txtNum2.text=this.tokenNum[1]+"",this.txtNum3.text=this.tokenNum[2]+"",this.txtNum4.text=this.tokenNum[3]+""},e.updateChose=function(){0==this.data.color?(this.imgChoes1.visible=!1,this.hasColor=!1):(this.imgChoes1.visible=!0,this.hasColor=!0,10403002==this.data.color?this.imgChoes1.skin="modules/refineSoulPalace/img/token1.png":10403003==this.data.color?this.imgChoes1.skin="modules/refineSoulPalace/img/token2.png":10403004==this.data.color?this.imgChoes1.skin="modules/refineSoulPalace/img/token3.png":10403005==this.data.color&&(this.imgChoes1.skin="modules/refineSoulPalace/img/token4.png"),this.curRoleId==ie.user.role_id&&(this.btnYes.mouseEnabled=!1,this.btnYes.state=2))},e.moveCallBack=function(){this["imgChoes"+this.type].skin=this["imgType"+this.selectedId].skin,this["imgChoes"+this.type].visible=!0,this.imgMove.visible=!1},e.movingImg=function(t){switch(t){case 1:this.imgMove.pos(this.imgType1.x,this.imgType1.y),this.imgMove.skin=this.imgType1.skin,this.imgMove.visible=!0,1==this.type?eo.to(this.imgMove,{x:this.imgChoes1.x,y:this.imgChoes1.y},500,null,this.moveHandler):eo.to(this.imgMove,{x:this.imgChoes2.x,y:this.imgChoes2.y},500,null,this.moveHandler);break;case 2:this.imgMove.pos(this.imgType2.x,this.imgType2.y),this.imgMove.skin=this.imgType2.skin,this.imgMove.visible=!0,1==this.type?eo.to(this.imgMove,{x:this.imgChoes1.x,y:this.imgChoes1.y},500,null,this.moveHandler):eo.to(this.imgMove,{x:this.imgChoes2.x,y:this.imgChoes2.y},500,null,this.moveHandler);break;case 3:this.imgMove.pos(this.imgType3.x,this.imgType3.y),this.imgMove.skin=this.imgType3.skin,this.imgMove.visible=!0,1==this.type?eo.to(this.imgMove,{x:this.imgChoes1.x,y:this.imgChoes1.y},500,null,this.moveHandler):eo.to(this.imgMove,{x:this.imgChoes2.x,y:this.imgChoes2.y},500,null,this.moveHandler);break;case 4:if(this.imgMove.pos(this.imgType4.x,this.imgType4.y),this.imgMove.skin=this.imgType4.skin,this.imgMove.visible=!0,1!=this.type){eo.to(this.imgMove,{x:this.imgChoes2.x,y:this.imgChoes2.y},500,null,this.moveHandler);break}eo.to(this.imgMove,{x:this.imgChoes1.x,y:this.imgChoes1.y},500,null,this.moveHandler)}},o(0,e,"type",function(){return this._type},function(t){this._type=t}),o(0,e,"data",function(){return this._data},function(t){this._data=t})}(),function(t){function i(){this.selectItemData=null,this.selectItemQuality=0,this.inlayGood1=null,this.inlayGood2=null,this._type=0,this.inlayArr=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.init()}l(i,"modules.refineSoulPalace.RefineSoulInlayPanel",xn);var e=i.prototype;e.init=function(){this.listGoods.itemRender=In,this.listGoods.vScrollBarSkin="",this.listGoods.scrollBar.autoHide=!0,this.inlayGood1=this.inlayGood1||new ae,this.inlayGood2=this.inlayGood2||new ae,this.spGood1.addChild(this.inlayGood1),this.spGood2.addChild(this.inlayGood2),this.inlayGood1.mouseEnabled=!0,this.inlayGood2.mouseEnabled=!0},e.onDisplay=function(){this.selectItemData=new Object,this.selectItemData.className="p_goods",this.selectItemQuality=0,this.txtScore1.visible=!1,this.txtScore2.visible=!1},e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow();break;case this.btnInlay:if(this.selectItemData&&0!=this.selectItemData.id){this.inlayArr=[];var i=new Object;i.className="p_kv",i.id=this.selectItemData.id,i.val=this._type,this.inlayArr.push(i),Cn.ins().toSoulStoneInlay(this.inlayArr)}else io.addTip("请选择魂石");break;default:if(t.target instanceof modules.refineSoulPalace.view.RefineSoulGoodsItem){var e=t.target;this.selectItemData=e.dataSource,this.selectItemQuality=e.quality,this.updateInlayGoods()}}},e.update=function(){var t=On.getStonePgByType(this._type);if(t){this.inlayGood1.pData=t;var i=On.getStonePtkvByType(this._type);if(i){var e=On.getInlayStoneAttrByTypeAndQuality(i.id,i.val),s=On.getInlayStoneAttr2ByTypeAndQuality(i.id,i.val);this.txtDesc1.text="天魂炉"+s[0][0]+"、"+s[1][0]+"提升"+s[0][1]+"%",this.txtDesc3.text=e[0][0]+"+"+e[0][1]+" "+e[1][0]+"+"+e[1][1],this.txtScore1.visible=!0,this.txtScore1.text="评分:"+On.getSoulStoneScoreByTypeId(i.id,i.val)}}else this.inlayGood1.pData=new Object,this.inlayGood1.pData.className="p_goods",this.txtScore1.visible=!1,this.txtDesc1.text="无",this.txtDesc3.text="无";this.listGoods.dataSource=On.getSoulStoneBagByType(this._type),this.updateInlayGoods()},e.updateInlayGoods=function(){if(this.selectItemData&&0!=this.selectItemQuality){this.inlayGood2.pData=this.selectItemData;var t=On.getInlayStoneAttrByTypeAndQuality(this.selectItemData.typeid,this.selectItemQuality),i=On.getInlayStoneAttr2ByTypeAndQuality(this.selectItemData.typeid,this.selectItemQuality);this.txtDesc2.text="天魂炉"+i[0][0]+"、"+i[1][0]+"提升"+i[0][1]+"%",this.txtDesc4.text=t[0][0]+"+"+t[0][1]+" "+t[1][0]+"+"+t[1][1],this.txtScore2.visible=!0,this.txtScore2.text="评分:"+On.getSoulStoneScoreByTypeId(this.selectItemData.typeid,this.selectItemQuality)}},e.clearGoods2=function(){this.inlayGood2.pData=new Object,this.inlayGood2.pData.className="p_goods",this.txtDesc2.text="无",this.txtDesc4.text="无",this.txtScore2.visible=!1,this.selectItemData=new Object,this.selectItemData.className="p_goods"},o(0,e,"type",function(){return this._type},function(t){this._type=t})}(),function(t){function i(){this._vo=null,this._data=null,i.__super.call(this),this.on("click",this,this.onClick)}l(i,"modules.refineSoulPalace.RefineSoulMissionItem",t);var e=i.prototype;e.updateData=function(t){this._data=t,this.initVO(this._data),this._vo&&this._data&&(this.txtMission.text="任务:"+this._vo.mission,this.txtReward.text="奖励:"+this._vo.reward,this.txtNum.text="("+this._data.process+"/"+this._vo.time+")",1==this._data.state?(this.btnGet.label="进行中",this.btnGet.state=0,this.btnGet.skin="com/ui/btn_yellow.png",this.btnGet.mouseEnabled=!0):2==this._data.state?(this.btnGet.label="可领取",this.btnGet.state=0,this.btnGet.skin="com/ui/btn_green.png",this.btnGet.mouseEnabled=!0):3==this._data.state&&(this.btnGet.label="已完成",this.btnGet.state=2,this.btnGet.skin="com/ui/btn_green.png",this.btnGet.mouseEnabled=!1))},e.onClick=function(t){switch(t.target){case this.btnGet:2==this._data.state&&Cn.ins().toMissionReward(this._data.id)}},e.initVO=function(t){var i;if(On.refineSoulMission)for(var e in On.refineSoulMission)(i=On.refineSoulMission[e]).id==t.id&&(this._vo=i);return null},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this.updateData(t)})}(wn),function(t){function i(){i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick),this.list.itemRender=Na.getClass(45e3,"RefineSoulMissionItem"),this.tab.on("change",this,this.onTabChange),this.on("display",this,this.onDisplay),an.register("PR_REFINE_SOUL_PALACE_MISSION",this.tab.items[0]),an.register("PR_REFINE_SOUL_PALACE_SUPPLY",this.tab.items[1]),this.init()}l(i,"modules.refineSoulPalace.RefineSoulMissionView",kn);var e=i.prototype;e.init=function(){this.tab.selectedIndex=0,this.spView.visible=!1},e.onDisplay=function(){Cn.ins().toSoulMissionInfo(),this.btnGet1.visible=!1,this.btnGet2.visible=!1,this.btnGet3.visible=!1,this.btnGet4.visible=!1},e.update=function(){On.missionList&&(this.list.dataSource=On.missionList),this.updateSupplyState()},e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow();break;case this.btnGet1:Cn.ins().toGetSoulSupply(1);break;case this.btnGet2:Cn.ins().toGetSoulSupply(2);break;case this.btnGet3:Cn.ins().toGetSoulSupply(3);break;case this.btnGet4:Cn.ins().toGetSoulSupply(4);break;case this.imgGood1:case this.imgGood2:case this.imgGood3:case this.imgGood4:var i=ve.getItem(10403001);i.tempNum=1,to.show(i,"BASE_GOODS_TIP")}},e.onTabChange=function(){switch(this.tab.selectedIndex){case 0:this.list.visible=!0,this.spView.visible=!1,this.update();break;case 1:this.list.visible=!1,this.spView.visible=!0,this.update()}},e.updateSupplyState=function(){var t,i=On.supplyState;for(var e in i)0<(t=i[e]).val?(this["txtGet"+t.id].visible=!0,this["btnGet"+t.id].visible=!1):(this["txtGet"+t.id].visible=!1,this["btnGet"+t.id].visible=!0)}}(),function(t){function i(){this._time=0,this._type=0,this._data=[],this._initiativeId=0,this._passiveId=0,this._role_name="",this._noticeItem=null,this.pg=null,this.goodImg=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("display",this,this.onDisplay),this.on("click",this,this.onClick),this.init()}l(i,"modules.refineSoulPalace.RefineSoulNoticeView",Tn);var e=i.prototype;e.init=function(){this.txtScore.visible=!1},e.onDisplay=function(){this._time=this.noticeItem.time,this._type=this.noticeItem.type,this._data=this.noticeItem.data,this._initiativeId=this.noticeItem.initiative_id,this._passiveId=this.noticeItem.passive_id,this._role_name=this.noticeItem.role_name,this.update()},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnConfirm:this.closeWindow(),Cn.ins().showNotice();break;case this.spGood:var i=new Object;if(i.className="p_goods",i.id=this.id,i.typeid=this.typeId,0!=i.id&&0!=i.typeid)if(this.isSoulStone(i.typeid))Cn.ins().showGoodsTip(i);else{var e=ve.getItem(i.typeid);e&&e.useType%1e3==24?lh.ins.openFrameTip(i):e&&e.useType%1e3==25?lh.ins.openBubbleTip(i):to.show(i,Ze.getItemToolTipType(i.typeid))}}},e.update=function(){if(null==this.pg&&(this.pg=new Object,this.pg.className="p_goods"),1==this._type||2==this._type?this.pg.typeid=10403006:this.pg.typeid=this.typeId,1==this._type)this._initiativeId==ie.user.role_id?this.txtDesc.text="你帮助"+this._role_name+"解除了炼魂殿魂格的【束缚】，双方均获得了【魂烬】× "+this.scoreNum:this.txtDesc.text=this._role_name+"帮助你解除了本炼魂殿魂格的【束缚】，双方均获得了【魂烬】× "+this.scoreNum,this.txtDesc.pos(51,208),this.spGood.pos(267,66),this.spGood.visible=!0,this.txtScore.visible=!1,this.imgScore.visible=!1,this.imgTxtBg.visible=!1;else if(2==this._type)this._initiativeId==ie.user.role_id?this.txtDesc.text="收集了"+this._role_name+"炼魂殿噬魂之灵掉落的【魂烬】，双方均获得了【魂烬】× "+this.scoreNum:this.txtDesc.text=this._role_name+"收集了本炼魂殿噬魂之灵掉落的【魂烬】，双方均获得了【魂烬】× "+this.scoreNum,this.txtDesc.pos(51,208),this.spGood.pos(267,66),this.spGood.visible=!0,this.txtScore.visible=!1,this.imgScore.visible=!1,this.imgTxtBg.visible=!1;else if(3==this._type)this.txtDesc.text="每日凌晨魂格束缚自动解除，返还解缚令",this.txtDesc.pos(51,208),this.spGood.pos(267,66),this.spGood.visible=!0,this.txtScore.visible=!1,this.imgScore.visible=!1,this.imgTxtBg.visible=!1;else if(5==this._type){0==this.typeId?(this.spGood.visible=!1,this.txtScore.visible=!1,this.imgScore.pos(257,209),this.imgTxtBg.pos(111,208)):(this.spGood.visible=!0,this.txtScore.visible=!0,this.txtScore.text="评分:"+this.getSoulStoneScore(),this.imgScore.pos(257,282),this.imgTxtBg.pos(111,282));var t=this.getItemName();this.txtDesc.text="吞噬了"+t+",获得以下奖励:",this.txtDesc.pos(51,65),this.spGood.pos(267,126),this.imgScore.visible=!0,this.imgScore.skin=this.getSkin(),this.imgTxtBg.visible=!0,this.txtScoreNum.text="+"+this.scoreNum}this.updateImg()},e.updateImg=function(){this.goodImg=this.goodImg||new ae,this.goodImg.pData=this.pg,this.spGood.addChild(this.goodImg)},e.getSoulStoneScore=function(){return On.getSoulStoneScoreByTypeId(this.typeId,this.quality)},e.getSkin=function(){var t="";switch(this.scoreId){case 31:t="modules/refineSoulPalace/red3.png";break;case 32:t="modules/refineSoulPalace/yellow3.png";break;case 33:t="modules/refineSoulPalace/blue3.png";break;case 34:t="modules/refineSoulPalace/green3.png"}return t},e.getItemName=function(){var t="";switch(this.itemType){case 4:t="真元魂晶·下阶";break;case 5:t="真元魂晶·中阶";break;case 6:t="真元魂晶·上阶"}return t},e.isSoulStone=function(t){var i=On.refineSoulStone;if(i)for(var e in i)if(i[e].id==t)return!0;return!1},o(0,e,"vo",function(){return ve.getItem(this.pg.typeid)}),o(0,e,"noticeItem",function(){return this._noticeItem},function(t){this._noticeItem=t}),o(0,e,"id",function(){return On.getBagGoodIdByTypeIdAndQuality(this.typeId,this.quality)}),o(0,e,"typeId",function(){var t;for(var i in this._data)if(3==(t=this._data[i]).id)return t.val;return 0}),o(0,e,"scoreId",function(){var t;for(var i in this._data)if(1==(t=this._data[i]).id)return t.val;return 0}),o(0,e,"scoreNum",function(){var t;for(var i in this._data)if(2==(t=this._data[i]).id)return t.val;return 0}),o(0,e,"itemType",function(){var t;for(var i in this._data)if(5==(t=this._data[i]).id)return t.val;return 0}),o(0,e,"quality",function(){var t;for(var i in this._data)if(4==(t=this._data[i]).id)return t.val;return 0})}(),function(t){function i(){this.gridInfo=null,this.ashesInfo=null,this.items=null,this.ashesItems=null,this.rankState=!1,this.changeBtnRankHanlder=null,this.bar=null,this.isSelectSoul=!1,this.selectSoulColor=0,this.selectGridIndex=null,this.moveOverHanlder=null,this.isMoving=!1,this.palaceType=0,this.guideEff=null,this.resetMovingKey=0,this.gridSide=85,this.gridSize=7,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.init(),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.tabRank.on("change",this,this.onTabRankChange),this.txtGoal.visible=!1,this.imgGoal.visible=!1,an.register("PR_REFINE_SOUL_PALACE_SUPPLY",this.imgMission),an.register("PR_REFINE_SOUL_PALACE_MISSION",this.imgMission),an.register("PR_REFINE_SOUL_PALACE_BAG",this.imgBag),an.register("PR_REFINE_SOUL_PALACE_INJECT",this.imgStove),an.register("PR_REFINE_SOUL_PALACE_INLAY",this.imgStove),an.register("PR_REFINE_SOUL_PALACE_REFINE",this.imgRefine)}l(i,"modules.refineSoulPalace.RefineSoulPalaceView",Pn);var e=i.prototype;e.onDisplay=function(){Cn.ins().toMyRefineSoulInfo(),Cn.ins().toExtraInfo(),Cn.ins().toSoulSupplyInfo(),Cn.ins().toNotice(),this.palaceType=1,On.curRoleId=ie.user.role_id,this.imgSelect.visible=!1,this.update(),this.spMask.visible=!1,this.spStep1.visible=!1,this.spStep2.visible=!1,this.spStep3.visible=!1,this.spStep4.visible=!1,this.spStep5.visible=!1,this.spStep6.visible=!1,this.spStep7.visible=!1,this.spStep8.visible=!1,this.spPoint.visible=!1,0!=On.isHadGuide&&1!=On.isHadGuide||Cn.ins().toRefineSoulGuide(0),On.checkRefineSoulRP()},e.init=function(){this.items=[];for(var t=0;t<this.gridSize;t++){this.items[t]=[];for(var i=0;i<this.gridSize;i++){var e=Na.getIns(45e3,"SoulGridItem");e.index=[i,t],e.pos(this.gridSide*i,this.gridSide*t),e.on("click",this,this.onSoulGrid),this.spView.addChild(e),this.items[t].push(e)}}this.initAshes(),this.spRefine.visible=!1,this.rankState=!1,this.spRank.pos(289,0),this.isSelectSoul=!1,this.bar=new ca("com/ui/roundBar.png","com/ui/roundBg.png",[0,19,0,19],[0,34,0,34]),this.bar.size(137,22),this.bar.posGrid=[1,16,4,16],this.spBar.addChild(this.bar),this.spInfo.visible=!1,this.panel.content.mouseThrough=!0,this.tabRank.selectedIndex=0,this.list.itemRender=Na.getClass(45e3,"RefineSoulRankItem"),this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.selectEnable=!0,this.list.selectHandler=ue.create(this,this.onSelectRank),this.changeBtnRankHanlder=ue.create(this,this.changeBtnRank)},e.initAshes=function(){this.ashesItems=[];for(var t=0;t<this.gridSize;t++){this.ashesItems[t]=[];for(var i=0;i<this.gridSize;i++){var e=Na.getIns(45e3,"SoulAshesItem");e.index=[i,t],e.pos(this.gridSide*i,this.gridSide*t),e.imgAshes.on("click",this,this.onAshes,[e]),this.spAshes.addChild(e),this.ashesItems[t].push(e)}}},e.update=function(t){void 0===t&&(t=!1),t?(this.updateSpView(),this.updateAshes(),this.updateCoin(),this.updateSpRank(),this.updateProgress(),this.updateBtn()):0==this.isMoving&&(this.updateSpView(),this.updateAshes(),this.updateCoin(),this.updateSpRank(),this.updateProgress(),this.updateBtn())},e.onClick=function(t){switch(t.target){case this.spMask:this.spStep1.visible?this.showStep2():this.spStep2.visible?this.showStep3():this.spStep3.visible?this.showStep4():this.spStep4.visible?this.showStep5():this.spStep5.visible?this.showStep6():this.spStep6.visible?this.showStep7():this.spStep7.visible?this.showStep8():this.spStep8.visible&&this.endGuide();break;case this.btnBack:1==this.palaceType?this.closeWindow():(this.palaceType=1,On.curRoleId=ie.user.role_id,this.closeRank(),this.update());break;case this.imgMix:Cn.ins().openGodSoulMixView();break;case this.imgMission:Cn.ins().openRefineSoulMissionView();break;case this.btnRank:0==this.rankState?($s.ins().toGetRank(1204),Cn.ins().toFriendList(),this.openRank()):this.closeRank();break;case this.btnClose2:this.closeSpRefine();break;case this.btnClear:Cn.ins().toRemoveRefineSoul(On.selectGridIndex),this.spInfo.visible=!1;break;case this.imgSoul1:0==this.isMoving&&(0<ie.getScore(35)?(1==On.isHadGuide&&(this.guideEff||(this.guideEff=ut.getOne()),this.guideEff.pos(80,-6),this.guideEff.loadAndPlay("moduleEffect/leadup","default",0,!0),this.spView.addChild(this.guideEff)),this.isSelectSoul=!0,this.imgSelect.visible=!0,this.imgSelect.pos(34,72),this.selectSoulColor=1):io.addTip("魂烬不足，可通过补给或商场中的魂晶灵匣获得"));break;case this.imgSoul2:0==this.isMoving&&(0<ie.getScore(35)?(1==On.isHadGuide&&(this.guideEff||(this.guideEff=ut.getOne()),this.guideEff.pos(-127,276),this.guideEff.loadAndPlay("moduleEffect/leadleft","default",0,!0),this.spView.addChild(this.guideEff)),this.isSelectSoul=!0,this.imgSelect.visible=!0,this.imgSelect.pos(162,72),this.selectSoulColor=2):io.addTip("魂烬不足，可通过补给或商场中的魂晶灵匣获得"));break;case this.imgSoul3:0==this.isMoving&&(0<ie.getScore(35)?(1==On.isHadGuide&&(this.guideEff||(this.guideEff=ut.getOne()),this.guideEff.pos(363,200),this.guideEff.loadAndPlay("moduleEffect/leadright","default",0,!0),this.spView.addChild(this.guideEff)),this.isSelectSoul=!0,this.imgSelect.visible=!0,this.imgSelect.pos(284,72),this.selectSoulColor=3):io.addTip("魂烬不足，可通过补给或商场中的魂晶灵匣获得"));break;case this.imgSoul4:0==this.isMoving&&(0<ie.getScore(35)?(1==On.isHadGuide&&(this.guideEff||(this.guideEff=ut.getOne()),this.guideEff.pos(157,484),this.guideEff.loadAndPlay("moduleEffect/leaddown","default",0,!0),this.spView.addChild(this.guideEff)),this.isSelectSoul=!0,this.imgSelect.visible=!0,this.imgSelect.pos(404,72),this.selectSoulColor=4):io.addTip("魂烬不足，可通过补给或商场中的魂晶灵匣获得"));break;case this.imgRefine:1==this.spRefine.visible?this.closeSpRefine():(this.spRefine.visible=!0,this.imgSelect.visible=!1,this.update());break;case this.imgBag:this.closeSpRefine(),Cn.ins().toGoodsList(),Cn.ins().openRefineSoulBagPanel();break;case this.imgShop:this.closeSpRefine(),Cn.ins().openRefineSoulShopView();break;case this.imgStove:this.closeSpRefine(),Cn.ins().openRefineSoulStoveView();break;case this.imgHelp:Cn.ins().openRefineSoulTip(2)}},e.onSoulGrid=function(t){var i=t.target;if(i&&0==this.isMoving)if(On.selectGridIndex=i.index,1==this.palaceType)if(0==i.type){if(1!=this.isSelectSoul)return;0<ie.getScore(35)?Cn.ins().toNewRefineSoul(this.selectSoulColor,On.selectGridIndex):io.addTip("魂烬不足，可通过补给或炼魂殿商城获取")}else 1==i.type?(this.spInfo.visible=!1,this.hasItemCanEat(i)?this.eatSoul(i):io.addTip("噬晶之灵四周没有可吞噬魂晶")):2==i.type?1==this.isSelectSoul?io.addTip("该魂格处于束缚状态，请点击魂格解除束缚"):(this.spInfo.visible=!1,Cn.ins().openRefineSoulGridUnlockPanel(this.palaceType,i.data)):4==i.type?(this.spInfo.visible=!1,Cn.ins().openRefineSoulUpgradeView()):5==i.type||6==i.type?(this.spInfo.visible=!1,Cn.ins().openRefineSoulUpgradeView()):1==this.isSelectSoul?io.addTip("当前魂格非空闲状态，无法炼魂"):(De.removeFromSceond(this,this.loopTimeUpdate),this.spInfo.visible=!0,this.spInfo.pos(80+i.x-24,287+i.y-16),this.loopTimeUpdate(),De.addToSecond(this,this.loopTimeUpdate));else 2==i.type&&(this.isYourFirend(On.curRoleId)?Cn.ins().openRefineSoulGridUnlockPanel(this.palaceType,i.data):io.addTip("只能帮助好友解除魂格束缚，添加对方为好友吧！"))},e.eatSoul=function(t){if(this.hasItemCanEat(t))return 1!=this.isMoving&&(this.isMoving=!0,this.resetMovingKey=De.setTimeout(this,this.resetIsMoving,null,5e3)),On.selectGridIndex=t.index,this.spInfo.visible=!1,Cn.ins().toEatRefineSoul(On.selectGridIndex),void(1==On.isHadGuide&&(Cn.ins().toRefineSoulGuide(2),this.guideEff.stop(),this.spView.removeChild(this.guideEff)))},e.resetIsMoving=function(){this.isMoving=!1},e.onAshes=function(t){1==t.data.type?On.curRoleId==ie.user.role_id?io.addTip("魂烬仅可由好友拾取哦"):Cn.ins().toAshes(On.curRoleId,t.data.pos):2==t.data.type&&(On.curRoleId!=ie.user.role_id?io.addTip("魂石仅可由炼魂殿主人拾取"):Cn.ins().toAshes(On.curRoleId,t.data.pos))},e.onTabRankChange=function(){switch(this.tabRank.selectedIndex){case 0:case 1:this.updateSpRank()}},e.onSelectRank=function(t){var i=this.list.getItem(t);i.role_id==ie.roleID?(this.palaceType=1,On.curRoleId=ie.user.role_id,this.closeRank(),this.update()):(this.palaceType=2,this.spInfo.visible=!1,Cn.ins().toRefineSoulInfo(i.role_id),this.closeRank())},e.closeSpRefine=function(){this.spRefine.visible=!1,this.isSelectSoul=!1,this.selectSoulColor=0},e.openRank=function(){this.rankState=!0,eo.to(this.spRank,{x:0,y:0},500,null,this.changeBtnRankHanlder)},e.closeRank=function(){this.rankState=!1,eo.to(this.spRank,{x:289,y:0},500,null,this.changeBtnRankHanlder)},e.changeBtnRank=function(){0==this.rankState?this.btnRank.skin="modules/refineSoulPalace/img/rank1.png":this.btnRank.skin="modules/refineSoulPalace/img/rank2.png"},e.loopTimeUpdate=function(){var t=On.selectItemData.end_time-Ma.serverTime;0<t?(this.spBar.visible=!0,this.txtBar.visible=!0,this.btnClear.x=144,this.txtBar.text=Qt.formatTime(t),this.bar.value=t/60):(this.spBar.visible=!1,this.txtBar.visible=!1,this.btnClear.x=30,De.removeFromSceond(this,this.loopTimeUpdate))},e.updateCoin=function(){this.txtCoinRed.text=On.getRefineSoulCoinById(31)+"",this.txtCoinYellow.text=On.getRefineSoulCoinById(32)+"",this.txtCoinBlue.text=On.getRefineSoulCoinById(33)+"",this.txtCoinGreen.text=On.getRefineSoulCoinById(34)+"",this.txtAshes.text="剩余魂烬："+On.getRefineSoulCoinById(35)},e.updateSpView=function(){if(1==this.palaceType?this.gridInfo=On.mySoulGridInfo:this.gridInfo=On.otherSoulGridInfo,this.gridInfo)for(var t=0;t<this.gridSize;t++)for(var i=0;i<this.gridSize;i++)this.items[t][i].data=this.gridInfo[t][i],this.items[t][i].update()},e.updateBtn=function(){1==this.palaceType?(this.imgRefine.gray=!1,this.imgBag.gray=!1,this.imgShop.gray=!1,this.imgStove.gray=!1,this.imgRefine.mouseEnabled=!0,this.imgBag.mouseEnabled=!0,this.imgShop.mouseEnabled=!0,this.imgStove.mouseEnabled=!0,this.btnBack.skin="modules/refineSoulPalace/img/out.png"):(this.imgRefine.gray=!0,this.imgBag.gray=!0,this.imgShop.gray=!0,this.imgStove.gray=!0,this.imgRefine.mouseEnabled=!1,this.imgBag.mouseEnabled=!1,this.imgShop.mouseEnabled=!1,this.imgStove.mouseEnabled=!1,this.btnBack.skin="modules/refineSoulPalace/img/back.png")},e.updateAshes=function(){if(1==this.palaceType?this.ashesInfo=On.mySoulAshes:this.ashesInfo=On.otherSoulAshes,this.ashesInfo)for(var t=0;t<this.gridSize;t++)for(var i=0;i<this.gridSize;i++)this.ashesInfo[t][i].type||0==this.ashesInfo[t][i].type||(this.ashesInfo[t][i].type=0,Cn.ins().toNotice()),this.ashesItems[t][i].data=this.ashesInfo[t][i],this.ashesItems[t][i].update()},e.updateSpRank=function(){if(On.rankList)if(0==this.tabRank.selectedIndex){if(On.rankList){var t=On.rankList.sort(On.sortList);this.list.dataSource=t}}else if(1==this.tabRank.selectedIndex)if(On.friendList){t=On.friendList.sort(On.sortList);this.list.dataSource=t}else Cn.ins().toFriendList()},e.updateProgress=function(){var t=0;if(On.missionList)for(var i in On.missionList)3==On.missionList[i].state&&t++;this.txtProgress.text=t+" / 5"},e.hasItemCanEat=function(t){var i=t.index,e=i[0],s=i[1];return!(0==e||this.items[s][e-1].color!=t.color||!this.items[s][e-1].isEndTime)||(!(6==e||this.items[s][e+1].color!=t.color||!this.items[s][e+1].isEndTime)||(!(0==s||this.items[s-1][e].color!=t.color||!this.items[s-1][e].isEndTime)||!(6==s||this.items[s+1][e].color!=t.color||!this.items[s+1][e].isEndTime)))},e.moveRefineSoul=function(t){this.selectGridIndex=On.selectGridIndex;var i=On.getSoulGridPosByItem(t),e=this.items[this.selectGridIndex[1]][this.selectGridIndex[0]];this.moveOverHanlder=ue.create(this,this.resetGridPos,[i,this.selectGridIndex]),eo.to(e,{x:this.gridSide*i[0],y:this.gridSide*i[1]},500,null,this.moveOverHanlder)},e.resetGridPos=function(t,i){var e=On.mySoulGridInfo[t[1]][t[0]];this.items[i[1]][i[0]]&&1==this.items[i[1]][i[0]].type&&On.intANullGrid(i,1),On.addGodSoulToGridInfo(On.tempSoulInfo);for(var s=0;s<this.gridSize;s++)for(var n=0;n<this.gridSize;n++)this.items[s][n].pos(this.gridSide*n,this.gridSide*s);this.isMoving=!1,De.clearTimeout(this.resetMovingKey),this.update(),this.eatSoul(this.items[t[1]][t[0]]),this.showGetPoint(this.gridSide*t[0],this.gridSide*t[1],e.type,e.color)},e.showGetPoint=function(t,i,e,s){this.spPoint.visible=!0,2<e&&(this.imgPoint.skin=On.getRefineSoulItemSkinByTypeColor(e,s),this.txtPoint.text="+"+On.getRefineSoulItemScoreByTypeColor(e,s)),this.spPoint.pos(t-33+78,i-35+263),this.spPoint.alpha=0;var n=ue.create(this,this.hideSpPoint),h=ue.create(this,this.toAlpha);eo.to(this.spPoint,{x:t-33+78,y:i-55+263},500,null,n),eo.to(this.spPoint,{alpha:1},250,null,h)},e.toAlpha=function(){eo.to(this.spPoint,{alpha:0},250)},e.hideSpPoint=function(){this.spPoint.visible=!1},e.newPis=function(t,i){var e=new Object;e.className="p_immortal_soul";var s=new Object;return s.className="p_kv",s.id=t,s.val=i,e.pos=s,e.type=0,e.end_time=0,e.color=0,e},e.showGuide=function(){this.spMask.visible=!0,this.spStep1.visible=!0,this.stepMask2(38,21,103,103),Cn.ins().toRefineSoulGuide(1)},e.stepMask=function(t,i,e,s){this.spTop.alpha=.5,this.spTop.graphics.clear(),this.spTop.graphics.drawRect(0,0,(Te.stageWidth-750)/2+t,Te.stageHeight,"#000000"),this.spTop.graphics.drawRect((Te.stageWidth-750)/2+t,0,Te.stageWidth-((Te.stageWidth-750)/2+t),i,"#000000"),this.spTop.graphics.drawRect((Te.stageWidth-750)/2+t+e,i,Te.stageWidth-((Te.stageWidth-750)/2+t)-e,Te.stageHeight-i,"#000000"),this.spTop.graphics.drawRect((Te.stageWidth-750)/2+t,i+s,e,Te.stageHeight-i-s,"#000000")},e.stepMask2=function(t,i,e,s){this.spTop.alpha=.5,this.spTop.graphics.clear(),this.spTop.graphics.drawRect(0,0,(Te.stageWidth-750)/2+t,Te.stageHeight,"#000000"),this.spTop.graphics.drawRect((Te.stageWidth-750)/2+t,0,Te.stageWidth-((Te.stageWidth-750)/2+t),Te.stageHeight-i-s,"#000000"),this.spTop.graphics.drawRect((Te.stageWidth-750)/2+t+e,Te.stageHeight-i-s,Te.stageWidth-((Te.stageWidth-750)/2+t)-e,i+s,"#000000"),this.spTop.graphics.drawRect((Te.stageWidth-750)/2+t,Te.stageHeight-i,e,i,"#000000")},e.showStep2=function(){this.spStep1.visible=!1,this.spStep2.visible=!0,this.stepMask2(66,198,100,100),this.spRefine.visible=!0,this.imgSelect.visible=!1},e.showStep3=function(){this.spStep2.visible=!1,this.spStep3.visible=!0,this.stepMask(158,259,85,85)},e.showStep4=function(){this.spStep3.visible=!1,this.spStep4.visible=!0,this.stepMask(244,259,85,85)},e.showStep5=function(){this.spStep4.visible=!1,this.spStep5.visible=!0,this.stepMask(71,259,85,85)},e.showStep6=function(){this.spStep5.visible=!1,this.spStep6.visible=!0,this.stepMask(244,429,260,260)},e.showStep7=function(){this.spStep6.visible=!1,this.spStep7.visible=!0,this.stepMask(244,431,85,85)},e.showStep8=function(){this.spStep7.visible=!1,this.spStep8.visible=!0,this.stepMask(602,31,134,51)},e.endGuide=function(){this.spMask.visible=!1,this.spStep8.visible=!1},e.isYourFirend=function(t){return!!qi.getFriendByRoleId(t)}}(),function(t){function i(){this.blueVip=null,this.blueYear=null,this._data=null,this._type=0,i.__super.call(this),this.blueVip=this.blueVip||new ge,this.blueYear=this.blueYear||new ge,this.blueVip.visible=this.blueYear.visible=!1,this.addChild(this.blueVip),this.addChild(this.blueYear)}l(i,"modules.refineSoulPalace.RefineSoulRankItem",t);var e=i.prototype;e.updateBlueVip=function(t){0!=pt.ins().showVipByString(t,this.blueVip,this.blueYear,102,this.txtName.y-5)&&(this.txtName.x=132)},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._data=t,this._data&&(this.txtRank.text=this._data.rank+"",this.txtName.text=this._data.role_name+"",this.txtDesc.text="炼魂值:"+this._data.refine_val,this._data.role_id==ie.user.role_id?(this.imgBg.skin="modules/refineSoulPalace/img/rankList.png",this.txtRank.color="#ffe0cf",this.txtName.color="#7fd6fe",this.txtDesc.color="#fcf476",this.txtRank.text="我"):(this.imgBg.skin="modules/refineSoulPalace/img/rankList.png",this.txtRank.color="#ffe0cf",this.txtName.color="#7fd6fe",this.txtDesc.color="#fcf476"),this.updateBlueVip(this._data.blue_vip))}),o(0,e,"type",function(){return this._type},function(t){this._type=t})}(Vn),function(t){function i(){this.goods=null,this.curVO=null,i.__super.call(this),this.goods=this.goods||new ae(null,!0,!0,105,!0),this.goods.mouseEnabled=!0,this.goods.pos(24,20),this.addChild(this.goods),this.on("click",this,this.onClick)}l(i,"modules.refineSoulPalace.RefineSoulShopItem",Rn);var e=i.prototype;e.onClick=function(t){var i;switch(t.target){case this.btnChange:if(1==this.curVO.type)if(ie.gold<this.curVO.scoreNum)es.showAlert();else{var e=ve.getItem(this.curVO.goodsID);i=pe.span("是否花费","#5d3924")+pe.span(this.curVO.scoreNum+"元宝","#F7EF5F")+pe.span("购买","#5d3924")+pe.span(e.name+"？",Qi.getColorLight(e.color)),es.showSecAlert(i,this,this.toExchange,[this.curVO.type,this.curVO.exchangeID,1],"refineSoulShopPay")}else 2==this.curVO.type&&Cn.ins().toExchange(this.curVO.type,this.curVO.exchangeID,1);break;case this.goods:if(this.curVO){var s=ve.getItem(this.curVO.goodsID);s.tempNum=this.curVO.goodsNum;var n="";n=ve.isEquip(s.id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(s,n)}}},e.update=function(){if(this.curVO){var t=ve.getItem(this.curVO.goodsID);this.goods.data=t,this.goods.num=this.curVO.goodsNum,this.txtName.text=t.name,this.txtName.color=Qi.getColorLight(t.color),1==this.curVO.type?(this.img1.visible=!0,this.img2.visible=!1):(this.img1.visible=!1,this.img2.visible=!0),this.txt1.text=this.curVO.scoreNum+"",this.img1.skin=this.curVO.scoreImg,this.img2.skin=this.curVO.scoreImg;var i=0,e=!1;this.curVO.tip?this.txtTip.visible=!0:this.txtTip.visible=!1,e=!this.curVO.maxTime||(i=On.getShopExchangeNumById(this.curVO.exchangeID))<this.curVO.maxTime,this.txtTip.text=this.curVO.tip+i+"/"+this.curVO.maxTime,this.btnChange.label=this.curVO.btnLabel,this.btnChange.visible=e,this.imgNon.visible=!e}},e.toExchange=function(t,i,e){Cn.ins().toExchange(t,i,e)},o(0,e,"data",null,function(t){this.curVO=t,this.update()})}(),function(t){function s(){this.items=null,this.tokenList=null,s.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.pan.vScrollBarSkin="";var t,i=On.refineSoulShop;if(this.items=this.items||[],i)for(var e=0;e<i.length;e++)this.items[e]=this.items[e]||Na.getIns(45e3,"RefineSoulShopItem"),(t=this.items[e]).data=i[e],t.pos(0,150*e),this.pan.addChild(t)}l(s,"modules.refineSoulPalace.RefineSoulShopView",Dn);var i=s.prototype;i.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow()}},i.onDisplay=function(){Cn.ins().toExchange(0,0,0),this.update()},i.update=function(){this.tokenList=On.getRefineSoulTokenNum();for(var t=0;t<this.pan.numChildren;t++)this.pan.getChildAt(t).update();this.txtCoinRed.text=this.tokenList[0]+"",this.txtCoinYellow.text=this.tokenList[1]+"",this.txtCoinBlue.text=this.tokenList[2]+"",this.txtCoinGreen.text=this.tokenList[3]+""}}(),function(t){function i(){this._type=0,this._data=null,i.__super.call(this),this.on("display",this,this.onDisplay),this.imgStone.visible=!1,this.imgRP.visible=!1;var t=new Object;t.className="p_tkv",t.id=0,t.type=this._type,t.val=0,this._data=t}l(i,"modules.refineSoulPalace.RefineSoulStoneItem",Nn);var e=i.prototype;e.onDisplay=function(){this.checkRP()},e.update=function(){this._data&&0!=this._data.id?(this.imgBg.skin="modules/refineSoulPalace/img/goodBg.png",this.imgStone.visible=!0,this.imgStone.skin="modules/refineSoulPalace/img/hunshi"+this._data.type+".png"):(this.imgBg.skin="modules/refineSoulPalace/img/stoneBgAdd.png",this.imgStone.visible=!1),this.checkRP()},e.checkRP=function(){var t,i,e=!1;if(this._data&&0!=this._data.id){for(var s in On.getTheHighestStoneList(),On.soulStoneHeighestList)if((t=On.soulStoneHeighestList[s]).type==this._data.type){var n=On.getSoulStoneVOById(this._data.id);n&&t.color>n.color?e=!0:n&&t.color==n.color&&t.quality>this._data.val&&(e=!0)}}else for(var h in On.soulStoneHeighestList)(i=On.soulStoneHeighestList[h]).type==this.type&&0!=i.color&&(e=!0);this.imgRP.visible=1==e},o(0,e,"data",function(){return this._data},function(t){t&&this._data&&(t.id!=this._data.id?ri.show("moduleEffect/changeover",52,52,this):t.val!=this._data.val&&ri.show("moduleEffect/changeover",52,52,this)),this._data=t,this.update()}),o(0,e,"type",function(){return this._type},function(t){this._type=t})}(),function(t){function i(){this.mixGoodPGArr=null,this.mixGood1=null,this.mixGood2=null,this.mixGood3=null,this.mixGood4=null,this.mixGood5=null,this.mixGoodsShowArr=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUndisplay),this.init()}l(i,"modules.refineSoulPalace.RefineSoulStoneMixPanel",En);var e=i.prototype;e.init=function(){this.listGoods.itemRender=In,this.listGoods.vScrollBarSkin="",this.listGoods.scrollBar.autoHide=!0,this.mixGoodsShowArr=[],this.mixGood1=this.mixGood1||new ae,this.mixGood2=this.mixGood2||new ae,this.mixGood3=this.mixGood3||new ae,this.mixGood4=this.mixGood4||new ae,this.spGood1.addChild(this.mixGood1),this.spGood2.addChild(this.mixGood2),this.spGood3.addChild(this.mixGood3),this.spGood4.addChild(this.mixGood4),this.mixGoodsShowArr.push(this.mixGood1,this.mixGood2,this.mixGood3,this.mixGood4),this.mixGood5=this.mixGood5||new ae(null,!1,!0,105),this.spMix.addChild(this.mixGood5),this.imgSelect1.visible=!1,this.imgSelect2.visible=!1,this.imgSelect3.visible=!1,this.imgSelect4.visible=!1,this.spGood1.visible=!1,this.spGood2.visible=!1,this.spGood3.visible=!1,this.spGood4.visible=!1},e.onDisplay=function(){this.mixGoodPGArr=[],this.spMix.visible=!1,this.txtStoneScore.visible=!1},e.onUndisplay=function(){On.newSoulStone=new Object,On.newSoulStone.className="p_kv",this.resetBagSelect()},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow();break;case this.spGood1:this.mixGoodPGArr[0]&&Cn.ins().showGoodsTip(this.mixGoodPGArr[0]);break;case this.spGood2:this.mixGoodPGArr[1]&&Cn.ins().showGoodsTip(this.mixGoodPGArr[1]);break;case this.spGood3:this.mixGoodPGArr[2]&&Cn.ins().showGoodsTip(this.mixGoodPGArr[2]);break;case this.spGood4:this.mixGoodPGArr[3]&&Cn.ins().showGoodsTip(this.mixGoodPGArr[3]);break;case this.spMix:break;case this.btnMix:this.mixGoodPGArr&&4==this.mixGoodPGArr.length?Cn.ins().toMixSoulStone(this.getMixList()):io.addTip("合成需要选择4个魂石");break;case this.imgHelp:Cn.ins().openRefineSoulTip(3);break;default:if(t.target instanceof modules.refineSoulPalace.view.RefineSoulGoodsItem){this.spMix.visible=!1;var i=t.target;this.selectItem(i),this.update()}}},e.update=function(){this.updateBag(),this.updateMixGoods(),this.updateMixSocre()},e.updateBag=function(){this.listGoods.dataSource=On.getSoulStoneBag()},e.selectItem=function(t){if(t.dataSource){if(this.isStoneSelect(t.dataSource.id)){for(var i=0,e=0;e<this.mixGoodPGArr.length;e++){this.mixGoodPGArr[e].id==t.dataSource.id&&(i=e)}return t.imgSelect.visible=!1,void this.mixGoodPGArr.splice(i,1)}if(this.mixGoodPGArr.length<4){this.mixGoodPGArr.push(t.dataSource);var s=new Object;return s.className="p_kv",s.id=this.x,s.val=this.y,void(t.imgSelect.visible=!0)}io.addTip("待合成魂石区已满，请先合成")}else;},e.updateMixGoods=function(){if(this.mixGoodPGArr)for(var t=0;t<4;t++)this.mixGoodPGArr[t]?(this.mixGoodsShowArr[t].pData=this.mixGoodPGArr[t],this["spGood"+(t+1)].visible=!0):this["spGood"+(t+1)].visible=!1},e.updateMixSocre=function(){if(this.mixGoodPGArr){var t,i=0;for(var e in this.mixGoodPGArr)t=this.mixGoodPGArr[e],i+=On.getSoulStoenScoreById(t.id);var s=On.getSoulStoneMixPreview(i);this.txtMix.text="合成预览:"+s}},e.isStoneSelect=function(t){for(var i in this.mixGoodPGArr)if(this.mixGoodPGArr[i].id==t)return!0;return!1},e.getMixList=function(){var t,i=[];for(var e in this.mixGoodPGArr)t=this.mixGoodPGArr[e],i.push(t.id);return i},e.mixSucceedCallback=function(){if(On.newSoulStone&&0!=On.newSoulStone.id){if(this.mixGoodPGArr)for(var t in this.mixGoodPGArr)this.mixGoodPGArr[t],(new Object).className="p_goods";var i=new Object;i.className="p_goods",i.typeid=On.newSoulStone.id,this.mixGood5.pData=i,this.txtStoneScore.visible=!0,this.txtStoneScore.text="评分:"+On.getSoulStoneScoreByTypeId(On.newSoulStone.id,On.newSoulStone.val)}this.mixGoodPGArr=[],this.spMix.visible=!0,this.resetBagSelect(),this.updateBag(),this.updateMixGoods()},e.resetBagSelect=function(){for(var t in this.listGoods.cells)this.listGoods.cells[t].imgSelect.visible=!1}}(),function(t){function i(){this.items=null,this.posArr=[{x:390,y:76},{x:455,y:188},{x:390,y:304},{x:220,y:304},{x:155,y:188},{x:220,y:76}],this.bar=null,this.needExp=0,this.onceExp=2e3,this.index=1,this.oneKeyEff=null,this.injectEff=null,this.injectEff2=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick),this.tab.on("change",this,this.onTabChange),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.btnUp.on("mousedown",this,this.onMouseDown),this.btnUp.on("mouseup",this,this.onMouseUp),this.init(),an.register("PR_REFINE_SOUL_PALACE_INJECT",this.tab.items[0]),an.register("PR_REFINE_SOUL_PALACE_INLAY",this.tab.items[1])}l(i,"modules.refineSoulPalace.RefineSoulStoveView",Bn);var e=i.prototype;e.init=function(){this.tab.selectedIndex=0,this.items=[];for(var t=0;t<this.posArr.length;t++){var i=Na.getIns(45e3,"RefineSoulStoneItem");i.type=t+1,i.pos(this.posArr[t].x,this.posArr[t].y),i.on("click",this,this.onItem,[i.type]),this.spInlay.addChild(i),this.items.push(i)}this.txtGet.underline=!0,this.txtGetSoul.underline=!0,this.bar=new Ot(0,0,568,32,"modules/refineSoulPalace/bar.png","modules/refineSoulPalace/barBg.png",[5,5,5,5],[0,7,0,12],[5,0,10,0],"#ffffff",16),this.spBar.addChild(this.bar)},e.onDisplay=function(){this.tab.selectedIndex=0,Cn.ins().toInjectInfo(),Cn.ins().toSoulStoneInlayInfo(),this.update()},e.onUnDisplay=function(){De.removeFromTimer(this,this.onInject)},e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow();break;case this.btnUp:"一键镶嵌"==this.btnUp.label&&(On.hasHigherStone()?this.oneKeyToInlay():io.addTip("背包中没有更好魂石"));break;case this.imgOther:0==this.tab.selectedIndex||1==this.tab.selectedIndex&&Cn.ins().openRefineSoulStoneMixPanel();break;case this.txtGet:Cn.ins().openRefineSoulTip(1);break;case this.txtGetSoul:Zi.show(10403008)}},e.onMouseDown=function(t){switch(t.target){case this.btnUp:"注入天魂"==this.btnUp.label&&(0<ie.getScore(36)?(this.onInject(),De.addToTimer(this,this.onInject),this.showInjectEff(!0)):io.addTip("剩余天魂为0，请通过炼魂殿合成获得"))}},e.onTabChange=function(){0==this.tab.selectedIndex?(this.spStove.visible=!0,this.spInlay.visible=!1,this.btnUp.label="注入天魂",this.btnUp.pos(260,697),On.checkStoneInlayRP()):1==this.tab.selectedIndex&&(this.spStove.visible=!1,this.spInlay.visible=!0,this.btnUp.label="一键镶嵌",this.btnUp.pos(260,408),On.checkStoneInlayRP())},e.onItem=function(t){Cn.ins().openRefineSoulInlayPanel(t)},e.update=function(){this.needExp=On.getStoveNeedExp(On.soulStoveLv),this.bar.setValue(On.soulStoveExp,this.needExp),this.txtSoul.text=ie.getScore(36)+"",this.updateAttr(),this.updateInlay(),this.updateAttr1(),this.updateAttr2()},e.updateAttr=function(){for(var t=On.getStoveAttr(On.soulStoveLv),i="",e=0;e<t.length;e++)i+=(e+1)%2==0?t[e][0]+": +"+t[e][1]+"\n":Da.inputEmpty(t[e][0]+": +"+t[e][1],15);this.txtArrt1.text=i,this.txtStoveLv.text="天魂炉属性 Lv."+On.soulStoveLv},e.updateAttr1=function(){for(var t=On.getInlayTotalAttr(1),i="",e=0;e<t.length;e++)i+=(e+1)%2==0?t[e][0]+": +"+t[e][1]+"\n":Da.inputEmpty(t[e][0]+": +"+t[e][1],15);this.txtArrt2.text=i},e.updateAttr2=function(){for(var t=On.getInlayTotalAttr(2),i="",e=0;e<t.length;e++)i+=Da.inputEmpty(t[e][0]+":+"+t[e][1]+"%",10);this.textArrt3.text=i},e.updateInlay=function(){var t;for(var i in On.soulStoneInlayPtkvList){var e;for(var s in t=On.soulStoneInlayPtkvList[i],this.items)(e=this.items[s]).type==t.type&&(e.data=t)}},e.onInject=function(){"注入天魂"==this.btnUp.label&&(this.index%6==0?0<ie.getScore(36)?ie.getScore(36)>this.onceExp?Cn.ins().toInject(2,this.onceExp):Cn.ins().toInject(2,ie.getScore(36)):(io.addTip("剩余天魂为0，请通过炼魂殿合成获得"),De.removeFromTimer(this,this.onInject),this.showInjectEff(!1)):this.index++)},e.onMouseUp=function(){De.removeFromTimer(this,this.onInject),this.showInjectEff(!1)},e.oneKeyToInlay=function(){var t,i=[];for(var e in On.soulStoneHeighestList){var s;for(var n in t=On.soulStoneHeighestList[e],On.soulStoneInlayList)if(s=On.soulStoneInlayList[n],t.type==s.type){if(0==t.typeId)break;if(t.typeId==s.typeId&&(t.quality<s.quality||t.quality==s.quality))break;if(t.color<s.color)break;var h=new Object;h.className="p_kv",h.id=t.id,h.val=t.type,i.push(h)}}Cn.ins().toSoulStoneInlay(i)},e.showBtnEffect=function(t){this.oneKeyEff||(this.oneKeyEff=ut.getOne(),this.oneKeyEff.pos(85,36)),0==this.tab.selectedIndex?(this.oneKeyEff.stop(),this.btnUp.removeChild(this.oneKeyEff)):1==this.tab.selectedIndex&&(t?(this.oneKeyEff.loadAndPlay("moduleEffect/change","default",0,!0),this.btnUp.addChild(this.oneKeyEff)):(this.oneKeyEff.stop(),this.btnUp.removeChild(this.oneKeyEff)))},e.showInjectEff=function(t){this.injectEff||(this.injectEff=ut.getOne(),this.injectEff.pos(341,367)),this.injectEff2||(this.injectEff2=ut.getOne(),this.injectEff2.pos(341,600)),1==this.tab.selectedIndex?(this.injectEff.stop(),this.spStove.removeChild(this.injectEff),this.injectEff2.stop(),this.spStove.removeChild(this.injectEff2)):0==this.tab.selectedIndex&&(t?(this.injectEff.loadAndPlay("moduleEffect/refine_flame","default",0,!0),this.spStove.addChild(this.injectEff),this.injectEff2.loadAndPlay("moduleEffect/refine_fly","default",0,!0),this.spStove.addChild(this.injectEff2)):(this.injectEff.stop(),this.spStove.removeChild(this.injectEff),this.injectEff2.stop(),this.spStove.removeChild(this.injectEff2)))},e.updateItem=function(){for(var t in this.items)this.items[t].update()}}(),function(t){function i(){this._type=0,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick),this.txtTip.style.valign="center",this.txtTip.style.lineHeight=28}l(i,"modules.refineSoulPalace.RefineSoulTip",Ln);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow()}},e.update=function(){1==this._type?this.txtTip.innerHTML=pe.span("1、噬晶之灵在吞噬位于炼魂殿中央的五个","#ffffff",24)+pe.span("真元魂晶","#f4f1b2",24)+pe.span("时，有概率会将晶魂凝聚成","#ffffff",24)+pe.span("魂石<br/>","#fff21a",24)+pe.span("2、所吞噬真元魂晶","#ffffff",24)+pe.span("等级越高","#fff21a",24)+pe.span("，可凝聚成的魂石","#ffffff",24)+pe.span("品质越高","#fff21a",24)+pe.span("点击","#f4f1b2",24)+pe.span("真元魂晶可提升","#ffffff",24)+pe.span("提升真元魂晶等级<br/>","#f4f1b2",24)+pe.span("3、凝聚成的魂石将","#ffffff",24)+pe.span("掉落在魂格","#f4f1b2",24)+pe.span("上，需手动拾取","#ffffff",24):2==this.type?(this.txtTip.innerHTML=pe.span("炼魂值","#f4f1b2",24)+pe.span("=当日吞噬魂晶所获得","#ffffff",24)+pe.span("四种积分之和","#f4f1b2",24)+pe.span("，炼魂殿排行榜将按照炼魂值高低进行排行，排行榜10分钟更新一次<br/>","#ffffff",24)+pe.span("2、炼魂殿排行第一玩家，可获得“","#ffffff",24)+pe.span("炼魂宗师","#fff21a",24)+pe.span("”橙色称号，有效期","#ffffff",24)+pe.span("一天","#f4f1b2",24)+pe.span("，排行榜将于","#ffffff",24)+pe.span("每日零点结算并发放奖励<br/>","#f4f1b2",24)+pe.span("3、点击排行榜上的玩家名称，可前往其炼魂殿查看其炼魂殿情况","#ffffff",24),this.txtTitle.text="排行榜說明"):3==this.type&&(this.txtTip.innerHTML=pe.span("1、魂石合成将按照","#ffffff",24)+pe.span("合成总评分","#f4f1b2  ",24)+pe.span("得出魂石，评分越高，合成所得的魂石越好<br/>","#ffffff",24)+pe.span("2、当评分","#ffffff",24)+pe.span("超出本品质","#f4f1b2",24)+pe.span("最高评分，但","#ffffff",24)+pe.span("未达到下一品质","#f4f1b2",24)+pe.span("时，将获得本品质的","#ffffff",24)+pe.span("，达到下一品质评分即可获得该品质的魂石<br/>","#ffffff",24)+pe.span("3、品质及评分对应关系：<br/>","#f4f1b2",24)+pe.span("蓝色魂石评分:100 - 1000<br/>","#4cf0ff",24)+pe.span("紫色魂石评分:2000 - 5600<br/>","#fd70ff",24)+pe.span("橙色魂石评分:14400 - 28800<br/>","#f5aa3f",24)+pe.span("红色魂石评分:83200 - 140800<br/>","#ff5858",24),this.txtTitle.text="魂石获得")},o(0,e,"type",function(){return this._type},function(t){this._type=t})}(),function(t){function i(){this.SOUL_UPGRADE=1,this.SOUL_CHANGE_COLOR=2,this.selectItemData=null,this.selectColor=0,this.msg=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick),this.tab.on("change",this,this.onTabChange),this.on("display",this,this.onDisplay),this.init()}l(i,"modules.refineSoulPalace.RefineSoulUpgradeView",Mn);var e=i.prototype;e.init=function(){this.selectItemData=On.selectItemData,this.spSelect.pos(14,53)},e.onDisplay=function(){this.imgSelect.visible=!1,this.selectColor=0,this.tab.selectedIndex=0,this.btnUp.label="升级",this.btnUp.state=0,this.btnUp.mouseEnabled=!0,this.update()},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow();break;case this.btnUp:"升级"==this.btnUp.label?(this.selectItemData=On.selectItemData,4==this.selectItemData.type?240<=ie.gold?(this.msg=pe.span("是否花费","#5d3924")+pe.span("240元宝","#F7EF5F")+pe.span("升级","#5d3924")+pe.span("真元魂晶？","#f5aa3f"),es.showSecAlert(this.msg,this,this.toUpgrade,[this.SOUL_UPGRADE,this.selectItemData.pos],"refineSoulUpgrade")):es.showAlert():5==this.selectItemData.type&&(480<=ie.gold?(this.msg=pe.span("是否花费","#5d3924")+pe.span("480元宝","#F7EF5F")+pe.span("升级","#5d3924")+pe.span("真元魂晶？","#f5aa3f"),es.showSecAlert(this.msg,this,this.toUpgrade,[this.SOUL_UPGRADE,this.selectItemData.pos],"refineSoulUpgrade")):es.showAlert())):"类型转换"==this.btnUp.label&&(0==this.selectColor?io.addTip("请选择颜色"):100<=ie.gold?(this.msg=pe.span("是否花费","#5d3924")+pe.span("100元宝","#F7EF5F")+pe.span("改变","#5d3924")+pe.span("真元魂晶颜色？","#f5aa3f"),es.showSecAlert(this.msg,this,this.toUpgrade,[this.SOUL_CHANGE_COLOR,this.selectItemData.pos,this.selectColor],"refineSoulChange")):es.showAlert());break;case this.img1:this.imgSelect.visible=!0,this.imgSelect.pos(105,131),this.selectColor=this.getColorIndex(1);break;case this.img2:this.imgSelect.visible=!0,this.imgSelect.pos(248,56),this.selectColor=this.getColorIndex(2);break;case this.img3:this.imgSelect.visible=!0,this.imgSelect.pos(385,131),this.selectColor=this.getColorIndex(3)}},e.onTabChange=function(){0==this.tab.selectedIndex?(this.spLvUp.visible=!0,this.spChange.visible=!1,this.btnUp.label="升级",this.update()):1==this.tab.selectedIndex&&(this.spLvUp.visible=!1,this.spChange.visible=!0,this.btnUp.label="类型转换",this.btnUp.state=0,this.btnUp.mouseEnabled=!0,this.imgGold.visible=!0,this.txtGold.visible=!0,this.txtGold.text="100")},e.update=function(){On.selectItemData&&(this.selectItemData=On.selectItemData,5==this.selectItemData.type?(this.spSelect.y=262,this.txtGold.visible=!0,this.txtGold.text="480",this.imgGold.visible=!0):6==this.selectItemData.type?0==this.tab.selectedIndex?(this.spSelect.y=464,this.btnUp.label="已满级",this.btnUp.state=2,this.btnUp.mouseEnabled=!1,this.txtGold.visible=!1,this.imgGold.visible=!1):1==this.tab.selectedIndex&&(this.spLvUp.visible=!1,this.spChange.visible=!0,this.btnUp.label="类型转换",this.btnUp.state=0,this.btnUp.mouseEnabled=!0,this.imgGold.visible=!0,this.txtGold.visible=!0,this.txtGold.text="100"):(this.spSelect.y=53,this.txtGold.visible=!0,this.imgGold.visible=!0,this.txtGold.text="240"),1==this.selectItemData.color?(this.imgGood1.skin="modules/refineSoulPalace/red2.png",this.imgGood2.skin="modules/refineSoulPalace/red3.png",this.imgGood3.skin="modules/refineSoulPalace/red4.png"):2==this.selectItemData.color?(this.imgGood1.skin="modules/refineSoulPalace/yellow2.png",this.imgGood2.skin="modules/refineSoulPalace/yellow3.png",this.imgGood3.skin="modules/refineSoulPalace/yellow4.png"):3==this.selectItemData.color?(this.imgGood1.skin="modules/refineSoulPalace/blue2.png",this.imgGood2.skin="modules/refineSoulPalace/blue3.png",this.imgGood3.skin="modules/refineSoulPalace/blue4.png"):4==this.selectItemData.color&&(this.imgGood1.skin="modules/refineSoulPalace/green2.png",this.imgGood2.skin="modules/refineSoulPalace/green3.png",this.imgGood3.skin="modules/refineSoulPalace/green4.png"),this.img4.skin="modules/refineSoulPalace/"+this.getColor(4)+"4.png",this.img1.skin="modules/refineSoulPalace/"+this.getColor(1)+"4.png",this.img2.skin="modules/refineSoulPalace/"+this.getColor(2)+"4.png",this.img3.skin="modules/refineSoulPalace/"+this.getColor(3)+"4.png"),this.selectColor=0,this.imgSelect.visible=!1},e.getColorIndex=function(t){var i=0;return 0==(i=(this.selectItemData.color+t)%4)&&(i=4),i},e.getColor=function(t){var i=0,e=An.COLOR_ARRAY;return 0==(i=(this.selectItemData.color+t)%4)&&(i=4),e[i-1]},e.toUpgrade=function(t,i,e){void 0===e&&(e=0),Cn.ins().toUpgradeSystemSoul(t,i,e)}}(),function(t){function i(){this._index=null,this._data=null,i.__super.call(this),this.imgItem.visible=!1,this.imgAshes.visible=!1,this.imgCanUp.visible=!1,this.imgGrid.visible=!1,this.mouseThrough=!0,this.mouseEnabled=!0}l(i,"modules.refineSoulPalace.SoulAshesItem",Sa);var e=i.prototype;e.update=function(){this.updateState()},e.updateState=function(){var t=Ma.serverTime;if(0==this._data.type)this.imgAshes.visible=!1,this.imgAshes.skin="";else if(1==this.data.type)t<this.data.end_time?this.imgAshes.visible=!0:this.imgAshes.visible=!1,this.imgAshes.skin="modules/refineSoulPalace/img/ashseDrop.png";else if(2==this.data.type)switch(this.imgAshes.visible=!0,this.vo.type){case 1:this.imgAshes.skin="modules/refineSoulPalace/img/hunshi1.png";break;case 2:this.imgAshes.skin="modules/refineSoulPalace/img/hunshi2.png";break;case 3:this.imgAshes.skin="modules/refineSoulPalace/img/hunshi3.png";break;case 4:this.imgAshes.skin="modules/refineSoulPalace/img/hunshi4.png";break;case 5:this.imgAshes.skin="modules/refineSoulPalace/img/hunshi5.png";break;case 6:this.imgAshes.skin="modules/refineSoulPalace/img/hunshi6.png"}},o(0,e,"data",function(){return this._data},function(t){this._data=t}),o(0,e,"uiClass",function(){return"SoulGridItem"}),o(0,e,"index",function(){return this._index},function(t){this._index=t}),o(0,e,"vo",function(){return On.getSoulStoneVOById(this._data.color)})}(),function(t){function i(){this.eff=null,this.isRefineSoul=!1,this._index=null,this._data=null,this.timeoutkey=0,i.__super.call(this),this.imgAshes.visible=!1,this.imgCanUp.visible=!1,this.imgGrid.visible=!1}l(i,"modules.refineSoulPalace.SoulGridItem",Sa);var e=i.prototype;e.update=function(){this.updateState()},e.updateState=function(){if(0==this._data.type)this.eff&&this.eff.unload(),this.imgCanUp.visible=!1,this.imgItem.visible=!1,this.imgItem.skin="",this.imgGrid.visible=!1;else if(2==this._data.type)this.eff&&this.eff.unload(),this.imgCanUp.visible=!1,this.imgItem.visible=!0,this.imgItem.skin="modules/refineSoulPalace/img/lockGrid.png",this.imgGrid.visible=!1;else if(3==this._data.type)this.eff&&this.eff.unload(),1==this.isRefineSoul?this.timeoutkey=De.setTimeout(this,this.refineSoul,[this._data.type,this._data.color],500):this.refineSoul(this._data.type,this._data.color);else{De.clearTimeout(this.timeoutkey),null==this.eff&&(this.eff=ut.getOne(),this.eff.pos(42,81)),null==this.eff.parent&&this.spEff.addChild(this.eff);var t=On.getRefineSoulItemEffByTypeColor(this._data.type,this._data.color);this.eff.loadAndPlay(t,"default",0,!0),this.imgItem.visible=!1,this.imgItem.skin="",4==this._data.type||5==this._data.type?this.imgCanUp.visible=!0:this.imgCanUp.visible=!1,1==this._data.type?this.imgGrid.visible=!1:this.imgGrid.visible=!0}},e.refineSoul=function(t,i){this.imgCanUp.visible=!1,this.imgItem.visible=!0,this.imgItem.skin=On.getRefineSoulItemSkinByTypeColor(t,i),this.imgGrid.visible=!1,this.isRefineSoul=!1},o(0,e,"isEndTime",function(){return!(this.data.end_time>Ma.serverTime)}),o(0,e,"index",function(){return this._index},function(t){this._index=t}),o(0,e,"type",function(){return this._data.type}),o(0,e,"data",function(){return this._data},function(t){this._data&&t&&(0==this._data.type&&3==t.type?(ri.show("moduleEffect/refine",40,40,this),this.isRefineSoul=!0):1!=this._data.type&&1==t.type&&ri.show("moduleEffect/eat",40,40,this)),this._data=t,this.updateState()}),o(0,e,"color",function(){return this._data.color})}(),function(e){function t(){this.itemArr=null,this.selEff=null,this.headPart=null,this._actor=NaN,this.nowSelIndex=0,this.maxLv=1,t.__super.call(this)}l(t,"modules.role.BuildSoulView",e);var i=t.prototype;i.createChildren=function(){for(e.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!1),this.headPart=new hh,this.headPart.on("RoleHeadsPart.CHOOSE",this,this.onHeadItemClick),this.headPart.x=106,this.headPart.y=60,this.box.addChild(this.headPart),i=0;i<4;i++)an.register("RP_BUILDSOUL_"+i,this.headPart.getItem(i),new Hs(39,10));var t;this.itemArr=[],this.selEff=new ge,this.selEff.skin="modules/role/selectedEffect.png",this.selEff.x=-9,this.selEff.y=-10;for(var i=0;i<8;i++)(t=Na.getIns(47e3,"BuildySoulItem")).y=133*Math.floor(i/2)+210,t.x=i%2*598+24,t.imgSp.skin="modules/role/"+(21+i)+".png",this.itemArr.push(t),this.box.addChild(t);this.txtLink.underline=!0,this.itemArr[0].imgSel.addChild(this.selEff),this.nowSelIndex=0,this.on("click",this,this.onMouseDown),this.on("display",this,this.onDisplay)},i.onDisplay=function(){(ni.register("UPDATE_PAL_DATA",this,this.checkHeadRp),0==le.hadShow(le.ZHU_HUI_BTN))&&(0<Ze.getGoodsNumByTypeID(10201105)&&le.showStep(le.ZHU_HUI_BTN,this.btnUp));this.on("undisplay",this,this.unDisplay)},i.unDisplay=function(){ni.remove("UPDATE_PAL_DATA",this,this.checkHeadRp),this.off("undisplay",this,this.unDisplay)},i.onHeadItemClick=function(t){var i=ie.getPalByIndex(t);i&&(this.changeActor(i.pal_id),this.updateView())},i.onMouseDown=function(t){switch(t.target){case this.btnClose2:case this.btnClose:this.closeWindow();break;case this.txtLink:Zi.show(_i.getSpEquipVO(21+this.nowSelIndex).goodsID);break;case this.btnUp:"#ffe0cf"==this.txtHas.color?(rh.ins().ignorePowUp=!0,rh.ins().toRoleSpecialUpdate(this._actor,21+this.nowSelIndex)):io.addTip("材料不足");break;default:var i=this.itemArr.indexOf(t.target);0<=i&&(t.target.imgSel.addChild(this.selEff),this.nowSelIndex=i,this.updateView())}},i.changeActor=function(t){this._actor=t},i.updateView=function(){for(var t,i=0;i<8;i++){var e=oh.getSpEquipNowLv(this._actor,21+i);1<=e?(t=_i.getSpEquipVO(21+i),this.itemArr[i].imgBuild.visible=!0):this.itemArr[i].imgBuild.visible=!1}var s=ie.getTypePowerByData(ie.getPal(this._actor),2801);this.spPow.graphics.clear();var n,h=Rt.numToTexture(Math.floor(s),"com/ui/powerNum");for(i=0;i<h.length;i++)n=h[i],this.spPow.graphics.drawTexture(n,n.width*i);var a=Ze.getGoodsNumByType(Ze.GOODS_ID,_i.getSpEquipVO(21+this.nowSelIndex).goodsID);e=oh.getSpEquipNowLv(this._actor,21+this.nowSelIndex),t=_i.getSpEquipVO(21+this.nowSelIndex),1<=e?(this.btnUp.label="已铸魂",this.btnUp.gray=!0,this.btnUp.mouseEnabled=!1,this.spNotMax.visible=!1):(this.btnUp.label="铸魂",this.btnUp.gray=!1,this.btnUp.mouseEnabled=!0,this.spNotMax.visible=!0),this.txtHas.text=a+"",this.txtNeed1.text="/"+t.getNeedByLv(e),this.txtHas.color=a>=t.getNeedByLv(e)?"#ffe0cf":"#b60202",this.updateAttrTxt(),this.checkHeadRp()},i.checkHeadRp=function(){for(var t=!1,i=0;i<ie.pals.length;i++){t=!1;var e,s=ie.pals[i];for(var n in s.spec_equips)if(20<(e=s.spec_equips[n]).id)if(e.lv<1){var h=_i.getSpEquipVO(e.id).goodsID;0<Ze.getGoodsNumByType(Ze.GOODS_ID,h)?(t=t||!0,this._actor==s.pal_id&&(this.itemArr[e.id-21].imgRp.visible=!0)):this._actor==s.pal_id&&(this.itemArr[e.id-21].imgRp.visible=!1)}else this._actor==s.pal_id&&(this.itemArr[e.id-21].imgRp.visible=!1);t?an.show("RP_BUILDSOUL_"+i):an.hide("RP_BUILDSOUL_"+i)}},i.spEquipUpgradeBack=function(){var t=133*Math.floor(this.nowSelIndex/2)+260,i=this.nowSelIndex%2*598+77;ri.show("moduleEffect/zhuhun1",i,t,this.box),De.setTimeout(this,this.showSecEff,null,1e3)},i.showSecEff=function(){var t=133*Math.floor(this.nowSelIndex/2)+260,i=this.nowSelIndex%2*598+77;ri.show("moduleEffect/zhuhun2",i,t,this.box),De.setTimeout(this,this.showEnd,null,1500)},i.showEnd=function(){rh.ins().ignorePowUp=!1,this.updateView()},i.updateAttrTxt=function(){this.txtAttr.text=_i.getSpEquipVO(21+this.nowSelIndex).getAttrByLv(this.maxLv)},i.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this,t,i),this.headPart.resetSelect(oh.curActorIndex)}}(It),function(t){function i(){i.__super.call(this)}l(i,"modules.role.BuildySoulItem",vt)}(),function(t){function i(){this.items=null,this.curChoose=0,this._curSex=0,this.startX=NaN,this.k=300,this.curXMLVO=null,this.funcArr=[15,17,18],this.chArr=["二","三","四"],this.CD=300,this.incd=!1,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!1),this.initItems(),this.on("click",this,this.onClick),this.box.on("mousedown",this,this.onMouseDown),Vh.isXYX9992()&&(this.txtVip.visible=this.txtSub.visible=!1)}l(i,"modules.role.CategoryPanel",St);var e=i.prototype;e.onMouseDown=function(t){this.startX=this.mouseX,this.box.on("mousemove",this,this.onMouseMove),this.box.on("mouseup",this,this.onMouseUp),this.box.on("mouseout",this,this.onMouseUp)},e.onMouseMove=function(t){var i,e,s,n,h=(this.mouseX-this.startX)/this.k,a=h-Math.floor(h),o=0,r=0,l=NaN;for(n in this.items)i=this.items[n],o=this.getIndex(i.posIndex+Math.floor(h)+1),r=this.getIndex(i.posIndex+Math.floor(h)),i.posIndex=0<=i.posIndex?i.posIndex:i.posIndex+4,e=$n.categoryItemPos[r],s=$n.categoryItemPos[o],i.pos(e.x+(s.x-e.x)*a,e.y+(s.y-e.y)*a),i.zOrder=s.zor,l=e.scale+(s.scale-e.scale)*a,i.scale(l,l)},e.getIndex=function(t){for(;t<0;)t+=4;for(;3<t;)t-=4;return t},e.onMouseUp=function(t){this.box.off("mousemove",this,this.onMouseMove),this.box.off("mouseup",this,this.onMouseUp),this.box.off("mouseout",this,this.onMouseUp);var i,e,s,n=(this.mouseX-this.startX)/this.k,h=n-Math.floor(n),a=0,o=0;for(s in this.items)i=this.items[s],.4<=Math.abs(h)?(o=this.getIndex(i.posIndex+Math.floor(n)+1),a=(1-Math.abs(h))*this.CD):(o=this.getIndex(i.posIndex+Math.floor(n)),a=Math.abs(h)*this.CD),i.posIndex=o,e=$n.categoryItemPos[o],eo.to(i,{x:e.x,y:e.y,zOrder:e.zor,scaleX:e.scale,scaleY:e.scale},a,null,ue.create(this,this.checkHas,null,!0))},e.initItems=function(){var t;this.items=[];for(var i=0;i<$n.categoryItemPos.length;i++){t=new Qn(i+1);var e=$n.categoryItemPos[i];t.pos(e.x,e.y),t.posIndex=i,t.zOrder=e.zor,t.scale(e.scale,e.scale),t.on("click",this,this.onItemClick),this.spRole.addChild(t),this.items.push(t)}},e.onItemClick=function(t){if(!this.incd&&t.currentTarget instanceof modules.role.view.RoleCategoryItem){var i=t.currentTarget;if(0!=i.posIndex){var e=0;i.posIndex<=2?(e=i.posIndex-0,this.turn(!0,e)):(e=4-i.posIndex,this.turn(!1,e))}}},e.update=function(){if(this.curXMLVO=oh.getRoleOpenVO(ie.pals.length+1),this.curXMLVO){var t=0,i=0<this.curXMLVO.lv?this.curXMLVO.lv+"级":"";i=0<this.curXMLVO.regrow?this.curXMLVO.regrow+"转"+i:i,this.txtNeedLv.text=i;var e=this.txt.textWidth+this.txtNeedLv.textWidth;0<this.curXMLVO.vip?(this.txtVip.visible=this.txtSub.visible=!0,this.txtVip.text="VIP"+this.curXMLVO.vip,e+=this.txtVip.textWidth,e+=this.txtSub.textWidth):this.txtVip.visible=this.txtSub.visible=!1,this.txt.x=(750-e)/2,this.txtNeedLv.x=this.txt.x+this.txt.textWidth,this.txtSub.x=this.txtNeedLv.x+this.txtNeedLv.textWidth,this.txtVip.x=this.txtSub.x+this.txtSub.textWidth}0==this._curSex&&(this.curSex=3-ie.pals[0].ext.sex,this.btn_M.selected=1==this._curSex,this.btn_w.selected=2==this._curSex);for(var s=1;s<5;s++)if(!ie.getPalByCate(s)){t=s;break}var n,h;for(var a in this.items)(h=this.items[a]).cate==t?(n=h).imgHas.visible=!1:h.imgHas.visible=ie.checkHasOpenCa(h.cate);var o=n?n.posIndex-0:1;if(0<o)for(a in this.items){(h=this.items[a]).posIndex-=o,h.posIndex=0<=h.posIndex?h.posIndex:h.posIndex+4;var r=$n.categoryItemPos[h.posIndex];h.pos(r.x,r.y),h.zOrder=r.zor,h.scale(r.scale,r.scale)}this.checkHas(),(Vh.isShengTian()||Vh.isJiqiuAndH5yy()||Vh.isShouMeng())&&(this.txt.visible=this.txtNeedLv.visible=this.txtVip.visible=this.txtSub.visible=!1),Vh.isXYX9992()&&(this.txtVip.visible=this.txtSub.visible=!1)},e.onClick=function(t){switch(t.target){case this.btnTurnLeft:this.incd||this.turn(!1,1);break;case this.btnTurnRight:this.incd||this.turn(!0,1);break;case this.btnNew:var i;for(var e in this.items)if(0==(i=this.items[e]).posIndex){if(i.isHas)io.addTip("不能重复开启已拥有职业");else if(ie.checkLevel(this.curXMLVO.regrow,this.curXMLVO.lv)||oo.curLv>=this.curXMLVO.vip)rh.ins().toOpneNewPal(ie.pals.length+1,this._curSex,i.cate),rh.ins().toRoleAdvanceOpen(this.funcArr[ie.pals.length-1],!1);else{if(Vh.isShengTian()||Vh.isJiqiuAndH5yy()||Vh.isShouMeng())return;var s=0<this.curXMLVO.lv?this.curXMLVO.lv+"级":"";s=0<this.curXMLVO.regrow?this.curXMLVO.regrow+"转"+s:s;var n=new q;Vh.isXYX9992()?(n.msg=pe.font(s,"#ffe0cf")+"开启第"+this.chArr[ie.pals.length-1]+"角色",n.showClose=n.showRight=!1):(n.msg=pe.font("VIP"+this.curXMLVO.vip,"#fff959")+"或"+pe.font(s,"#ffe0cf")+"开启第"+this.chArr[ie.pals.length-1]+"角色",n.showClose=n.showRight=!0),n.yesLabel="查看VIP",n.noLabel="知道了",n.yesCaller=Ae,n.yesFun=Ae.linkTo,n.yesArgs=[10201],K.showVO(n)}return}break;case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.btn_M:this.btn_M.selected=!0,this.btn_w.selected=!1,this.curSex=1;break;case this.btn_w:this.btn_M.selected=!1,this.btn_w.selected=!0,this.curSex=2}},e.turn=function(t,i){0<i?(t?this.turnLeft():this.turnRight(),--i,this.incd=!0,De.setTimeout(this,this.turn,[t,i],this.CD/5*4)):De.setTimeout(this,this.clearCD,null,this.CD/5*4)},e.clearCD=function(){this.incd=!1},e.turnLeft=function(){var t,i;for(var e in this.items)(i=this.items[e]).posIndex-=1,i.posIndex=0<=i.posIndex?i.posIndex:i.posIndex+4,t=$n.categoryItemPos[i.posIndex],eo.to(i,{x:t.x,y:t.y,zOrder:t.zor,scaleX:t.scale,scaleY:t.scale},this.CD,null,ue.create(this,this.checkHas,null,!0))},e.checkHas=function(){var t;for(var i in this.items)if(0==(t=this.items[i]).posIndex)return void(t.isHas?(this.btnNew.label="已开启",this.btnNew.disabled=!0):(this.btnNew.label="开启",this.btnNew.disabled=!1))},e.turnRight=function(){var t,i;for(var e in this.items)(i=this.items[e]).posIndex=(i.posIndex+1)%4,t=$n.categoryItemPos[i.posIndex],eo.to(i,{x:t.x,y:t.y,zOrder:t.zor,scaleX:t.scale,scaleY:t.scale},this.CD,null,ue.create(this,this.checkHas,null,!0))},e.updateItem=function(){for(var t in this.items)this.items[t].update()},e.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this,t,i),this.update(),this.updateItem()},o(0,e,"curSex",null,function(t){var i;if(this._curSex!=t)for(var e in this._curSex=t,this.items){i=this.items[e];var s=ie.getPalByCate(i.cate);i.sex=s?s.ext.sex:this._curSex}})}(),function(t){function i(){this._data=null,this.goodVO=null,this.goods=null,i.__super.call(this),this.goods=so.createGoodsImage(0,0,null,this.spGoods,!0,!0,105,!1),this.btnBuy.on("click",this,this.onClick)}l(i,"modules.role.regrow.RegrowNeedItem",t);var e=i.prototype;e.updateChangeNum=function(t,i){if(null!=this._data&&10201116!=this._data.id){var e=0;if(10201116!=this._data.id){if(0<(e=Ze.getGoodsNumByType(Ze.GOODS_ID,this._data.id)))this.txtMoney.text="拥有"+e+"个",this.btnBuy.label="使用",this.imgMoney.visible=!1;else{var s=this.goodVO.price.split(",");this.btnBuy.label="购买",this.txtMoney.text=s[1],this.imgMoney.visible=!0}this.imgRed.visible=0<e&&0<this._data.num-t}else{var n=oh.getRegrowLvVO(i+1);this.imgRed.visible=!!n&&(0<this._data.num-t&&100<ie.myLevel)}this.txtLimit.text=0<=this._data.num-t?""+(this._data.num-t):"0",(n=oh.getRegrowLvVO(i+1))&&e<=0?(this.btnBuy.label="购买",this.btnBuy.disabled=!1):null==n&&(this.btnBuy.label="已满级",this.btnBuy.disabled=!0)}},e.updateFirstChangeNum=function(t,i){if(null!=this._data&&10201116==this._data.id){oh.getRegrowLvVO(i+1)?this.imgRed.visible=0<this._data.num-t&&100<ie.myLevel:this.imgRed.visible=!1;var e=oh.getRegrowChangeVO(ie.myLevel);this.btnBuy.disabled=!1,e?100<ie.myLevel?(this.txtName.text=e.changeExp+"仙元",this.txtMoney.color="#96f254",this.txtMoney.text="人物等级降1级"):(this.txtMoney.color="#b60202",this.txtMoney.text="人物101级可兑换"):(this.txtMoney.color="#b60202",this.txtMoney.text="等级超出配置"),this.txtLimit.text=0<=this._data.num-t?""+(this._data.num-t):"0",oh.getRegrowLvVO(i+1)?(this.btnBuy.label="兑换",this.btnBuy.disabled=!1):(this.btnBuy.label="已满级",this.btnBuy.disabled=!0)}},e.onClick=function(t){if(10201116==this._data.id)100<ie.myLevel?rh.ins().toRoleRegrowBuy(1):io.addTip("人物等级≥101级可兑换");else if("购买"==this.btnBuy.label)yt.ins.show(this._data.id);else{var i=Ze.getGoodsByTypeID(this._data.id);i&&ts.ins().useItem(i.id,1)}},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(this._data=t,this._data&&(this.goodVO=ve.getItem(this._data.id),this.goodVO)){var i=Qi.getColorLight(this.goodVO.color);this.txtName.color=i,this.txtLimit.text=this._data.num,this.goods.data=this.goodVO;var e=this.goodVO.price.split(",");if(10201116!=this._data.id)this.txtName.text=this.goodVO.title,this.txtMoney.text=e[1],this.txtMoney.color="#ffffff",this.btnBuy.label="购买",this.imgMoney.visible=!0;else{var s=oh.getRegrowChangeVO(ie.myLevel);this.txtName.text=s.changeExp+"仙元",this.txtMoney.text="人物等级下降1级",this.txtMoney.color="",this.btnBuy.label="兑换",this.txtMoney.color="#96f254",this.imgMoney.visible=!1}ie.myRegrow>=this._data.lv?(this.btnBuy.visible=!0,this.txtWarn.visible=!1):(this.btnBuy.visible=!1,this.txtWarn.text="需转生等级达到"+this._data.lv+"转",this.txtWarn.visible=!0)}})}(Un),function(t){function i(){this.listItems=[],this._curVO=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5")}l(i,"modules.role.regrow.RegrowNeedView",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.vScrollBar.autoHide=!0,this.on("click",this,this.onClick),this.on("display",this,this.onDisplay)},e.onDisplay=function(){ni.register("ROLE_LEVEL_UP",this,this.onRoleLevelUp),ni.register("BAGDATA_CHANGE",this,this.onBagdateChange),this.on("undisplay",this,this.onUNDisplay)},e.onUNDisplay=function(){ni.remove("ROLE_LEVEL_UP",this,this.onRoleLevelUp),ni.remove("BAGDATA_CHANGE",this,this.onBagdateChange),this.off("undisplay",this,this.onUNDisplay)},e.onBagdateChange=function(){if(this._curVO=oh.getRegrowTOCVO(),this._curVO)for(var t=0;t<this.listItems.length;t++){var i,e=this.listItems[t],s=0;for(var n in this._curVO.buy)if((i=this._curVO.buy[n]).id==t+1){s=i.val;break}e&&e.updateChangeNum(s,this._curVO.regrow_lv)}},e.onRoleLevelUp=function(){if(this._curVO=oh.getRegrowTOCVO(),this._curVO){var t,i=this.listItems[0],e=0;for(var s in this._curVO.buy)if(1==(t=this._curVO.buy[s]).id){e=t.val;break}i&&i.updateFirstChangeNum(e,this._curVO.regrow_lv)}},e.update=function(){var t;this.list.removeChildren();var i=oh.getRegrowGoodsArr();this.listItems.length=i.length;for(var e=0;e<i.length;e++){t=i[e];var s=Na.getIns(47e3,"regrow.RegrowNeedItem");(this.listItems[e]=s).dataSource=t,s.pos(0,155*e),this.list.addChild(s)}this.onRoleLevelUp(),this.onBagdateChange()},e.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this)},e.closeWindow=function(){laya.ui.View.prototype.closeWindow.call(this)},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow()}}}(Hn),function(t){function i(){this.bar=null,this.needView=null,this._curVO=null,this._curLvVO=null,this._curChangeVO=null,i.__super.call(this)}l(i,"modules.role.regrow.RegrowView",t);var e=i.prototype;s.imps(e,{"com.ui.IViewUpdate":!0}),e.createChildren=function(){t.prototype.createChildren.call(this),this.bar=new Ot(0,0,300,0,"com/ui/bar2.png","com/ui/barBg2.png",[5,5,5,5],[5,5,5,5],[1,1,1,1],"#ffffff",20),this.spPro.addChild(this.bar),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),an.register("RP_REGROW_SCORE",this.btnUp),an.register("RP_REGROW",this.txtLink,new Hs(20,-24)),this.txtLink.underline=!0},e.onDisplay=function(){ni.register("ROLE_SCORE_CHANGE",this,this.onScoreChange),ni.register("REGROWLV_UP",this,this.onRegrowLvUp),this.on("undisplay",this,this.onUNDisplay)},e.onUNDisplay=function(){ni.remove("ROLE_SCORE_CHANGE",this,this.onScoreChange),ni.remove("REGROWLV_UP",this,this.onRegrowLvUp),this.off("undisplay",this,this.onUNDisplay)},e.onRegrowLvUp=function(){ie.user.attr.regrow<2&&oo.curLv<4?this.imgDesc.skin="modules/role/regDesc1.png":ie.user.attr.regrow<5&&oo.curLv<5?this.imgDesc.skin="modules/role/regDesc2.png":this.imgDesc.skin=null},e.onScoreChange=function(t){if(this._curVO)if(oh.getRegrowLvVO(this._curVO.regrow_lv+1)){if(4==t.id){var i=ie.getScore(4);this.bar.setValue(i,this._curLvVO.needExp),i>=this._curLvVO.needExp?an.show("RP_REGROW_SCORE"):an.hide("RP_REGROW_SCORE")}}else an.hide("RP_REGROW_SCORE")},e.onClick=function(t){switch(t.target){case this.btnUp:ie.getScore(4)<this._curLvVO.needExp?io.addTip("仙元不足"):rh.ins().toRoleRegrowUp();break;case this.txtLink:Ve.send(20,2,"转生-获得仙源链接"),this.needView=this.needView||Na.getIns(47e3,"regrow.RegrowNeedView"),this.needView.openWindow(),this.needView.parent&&this.needView.update()}},e.update=function(){if(this._curVO=oh.getRegrowTOCVO(),this._curVO){this._curLvVO=oh.getRegrowLvVO(this._curVO.regrow_lv),this.nowLv.text="当前转生等级："+this._curVO.regrow_lv+"转";for(var t,i=te.parseAttrToArr(this._curLvVO.attr),e=i.length,s="",n=0,h=oh.getRegrowLvVO(this._curVO.regrow_lv+1),a=0;a<e;a++)t=i[a],s+=te.getAttrStrByArr(t,""," +","\n"),n+=te.getAttrPowerS(t[0],t[1]);var o,r=Rt.numToTexture(Math.floor(n),"com/ui/powerNum");this.spPower.graphics.clear();for(var l=0;l<r.length;l++)o=r[l],this.spPower.graphics.drawTexture(o,o.width*l);if(this._curChangeVO=oh.getRegrowChangeVO(ie.myLevel),h){for(this.bar.setValue(ie.getScore(4),this._curLvVO.needExp),this.bar.setTextvisible(!0),this.btnUp.label="提升",this.btnUp.gray=!1,this.btnUp.mouseEnabled=!0,this.txtNow.text=s,e=(i=te.parseAttrToArr(h.attr)).length,s="",a=n=0;a<e;a++)t=i[a],s+=te.getAttrStrByArr(t,""," +","\n");this.txtNext.text=s,this.imgMax.visible=!1}else this.bar.setValue(1,1),this.bar.setTextvisible(!1),this.btnUp.label="已满级",this.btnUp.gray=!0,this.btnUp.mouseEnabled=!1,this.txtNow.text=s,this.txtNext.text="",this.imgMax.visible=!0;this.onRegrowLvUp()}else rh.ins().toRoleRegrowInfo()}}(Wn),function(t){function o(){this._elementShowArr=null,this._curItemY=0,o.__super.call(this)}l(o,"modules.role.RoleAttrElementView",t);var i=o.prototype;i.createChildren=function(){t.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.on("click",this,this.onClick),this.list.vScrollBarSkin=""},i.onDisplay=function(){},i.onUnDisplay=function(){},i.onClick=function(t){switch(t.target){case this.btnClose:this.closeWindow()}},i.update=function(){for(this._elementShowArr=this._elementShowArr||[],this._curItemY=2;0<this._elementShowArr.length;){var t=this._elementShowArr.shift();t.visible=!0,t.removeSelf()}for(var i=0,e=o.ELEMENTS.length;i<e;i++){var s=o.ELEMENTS[i].title,n=o.ELEMENTS[i].desc,h=new ce;h.style.fontSize=24,h.innerHTML=pe.span(s+":","#ffe0cf",24),h.width=h.contextWidth,h.height=h.contextHeight;var a=new ce;a.width=450,a.style.fontSize=24,a.style.lineHeight=32,a.innerHTML=pe.span(n,"#3e1e0c",24),a.height=a.contextHeight,h.x=10,a.x=h.x+h.width+5,h.y=this._curItemY,a.y=this._curItemY-3,this._curItemY+=a.height+10,this.list.addChild(h),this.list.addChild(a),this._elementShowArr.push(h),this._elementShowArr.push(a)}},e(o,["ELEMENTS",function(){return this.ELEMENTS=[{title:"火攻",desc:"攻击时有一定概率召唤天火攻击目标，造成120%攻击伤害，该伤害拥有额外20%暴击率"},{title:"冰攻",desc:"攻击时有一定概率召唤冰刺攻击目标，造成50%伤害，并有15%概率使敌对玩家额外受到相当于16%已损失生命的伤害（当目标是怪物时，则改为使该次伤害提高4倍）"},{title:"毒攻",desc:"攻击时有一定概率召唤毒雾攻击目标，造成90%攻击伤害，该伤害有15%概率忽略目标防御"},{title:"雷攻",desc:"攻击时有一定概率召唤天雷攻击目标，造成45%攻击伤害，该伤害有40/20/10/5%概率额外攻击1/2/3/4次"},{title:"火抗",desc:"降低受到火攻的概率"},{title:"冰抗",desc:"降低受到冰攻的概率"},{title:"毒抗",desc:"降低受到毒攻的概率"},{title:"雷抗",desc:"降低受到雷攻的概率"}]}])}(Xn),function(t){function i(){this.titleArr=["常规属性","元素属性","其他属性"],this.vocaArr=["","狂战","飞羽","舞天","碧落"],this.otherPalsArr=null,this.roleId=NaN,this._other=!1,this.infoNameArr=null,this.infoAttrArr=null,this.curVO=null,this.elementView=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.btnBack.on("click",this,this.closeWindow),this.tab.on("change",this,this.update),this.tab.selectedIndex=0,this.btnL.on("click",this,this.onChangeRoleL),this.btnR.on("click",this,this.onChangeRoleR),this.txtViewAttr.underline=!0,this.txtViewAttr.on("click",this,this.onTxtAttrView),ni.register("UPDATE_ROLE_ATTR_VIEW",this,this.updateCur)}l(i,"modules.role.RoleAttrView",zn);var e=i.prototype;e.onChangeRoleL=function(){if(this.curVO){var t=0;if(this._other){for(this.roleId=$e.getRoleIDByPalID(this.curVO.pal_id),this.otherPalsArr=$e.getRankRolePartnerDataArray(this.roleId),t=this.otherPalsArr.indexOf(this.curVO),--t<0&&(t=this.otherPalsArr.length-1);null==this.otherPalsArr[t];)--t;this.update(this.otherPalsArr[t])}else{for(t=ie.pals.indexOf(this.curVO),--t<0&&(t=ie.pals.length-1);null==ie.pals[t];)--t;this.update(ie.pals[t])}}},e.onChangeRoleR=function(){if(this.curVO){var t=0;if(this._other){for(this.roleId=$e.getRoleIDByPalID(this.curVO.pal_id),this.otherPalsArr=$e.getRankRolePartnerDataArray(this.roleId),t=this.otherPalsArr.indexOf(this.curVO),++t>=this.otherPalsArr.length&&(t=0);null==this.otherPalsArr[t];)++t;this.update(this.otherPalsArr[t])}else{for(t=ie.pals.indexOf(this.curVO),++t>=ie.pals.length&&(t=0);null==ie.pals[t];)++t;this.update(ie.pals[t])}}},e.updateCur=function(){this.update(this.curVO)},e.update=function(t){if(t&&(this.curVO=t),this.curVO){this.infoNameArr=this.infoNameArr||[],this.infoAttrArr=this.infoAttrArr||[],this.txtTitle.text=this.titleArr[this.tab.selectedIndex];var i=this.curVO.ext.category;this.txtVoca.text=this.vocaArr[i];var e=NaN;0==this.tab.selectedIndex?(this.infoNameArr[1]="攻    击：",this.infoAttrArr[1]=""+(this.curVO.base.phy_attack+this.curVO.base.magic_attack),this.infoNameArr[2]="生    命：",this.infoAttrArr[2]=""+this.curVO.base.max_hp,this.infoNameArr[3]="物    防：",this.infoAttrArr[3]=""+this.curVO.base.phy_defence,this.infoNameArr[4]="法    防：",this.infoAttrArr[4]=""+this.curVO.base.magic_defence,this.infoNameArr[5]="暴    击：",this.infoAttrArr[5]=this.curVO.base.double_attack/100+"％",this.infoNameArr[6]="韧    性：",this.infoAttrArr[6]=this.curVO.base.double_attack_anti/100+"％",this.infoNameArr[7]="伤害加成：",this.infoAttrArr[7]=1==i||2==i?this.curVO.base.phy_hurt_rate/100+"％":this.curVO.base.magic_hurt_rate/100+"％",this.infoNameArr[8]="伤害减免：",this.infoAttrArr[8]=this.curVO.base.phy_hurt_anti/100+"％",e=9,this.txtViewAttr.visible=!1):1==this.tab.selectedIndex?(this.infoNameArr[1]="火    攻：",this.infoAttrArr[1]=""+this.curVO.base.burning,this.infoNameArr[2]="火    抗：",this.infoAttrArr[2]=""+this.curVO.base.burning_anti,this.infoNameArr[3]="冰    攻：",this.infoAttrArr[3]=""+this.curVO.base.freeze,this.infoNameArr[4]="冰    抗：",this.infoAttrArr[4]=""+this.curVO.base.freeze_anti,this.infoNameArr[5]="毒    攻：",this.infoAttrArr[5]=""+this.curVO.base.poison,this.infoNameArr[6]="毒    抗：",this.infoAttrArr[6]=""+this.curVO.base.poison_anti,this.infoNameArr[7]="雷    攻：",this.infoAttrArr[7]=""+this.curVO.base.dizzy,this.infoNameArr[8]="雷    抗：",this.infoAttrArr[8]=""+this.curVO.base.dizzy_anti,e=9,this.txtViewAttr.visible=!0):(this.infoNameArr[1]="华丽度：",this.infoAttrArr[1]=""+this.curVO.base.beauty,this.infoNameArr[2]="魅力值：",this.infoAttrArr[2]=""+Ki.charm,this.infoNameArr[3]="红名值：",this.infoAttrArr[3]=""+ie.getScore(27),this.infoNameArr[4]=this.infoAttrArr[4]=this.infoNameArr[5]=this.infoAttrArr[5]=this.infoNameArr[6]=this.infoAttrArr[6]=this.infoNameArr[7]=this.infoAttrArr[7]=this.infoNameArr[8]=this.infoAttrArr[8]="",e=4,this.txtViewAttr.visible=!1);for(var s=1;s<9;s++)s<e?(this["txt"+s].visible=!0,this["input"+s].visible=!0,this["txt"+s].text=this.infoNameArr[s],this["input"+s].text=this.infoAttrArr[s]):(this["txt"+s].visible=!1,this["input"+s].visible=!1)}},e.onTxtAttrView=function(){this.elementView=this.elementView||Na.getIns(47e3,"RoleAttrElementView"),this.elementView.openWindow(),this.elementView.update()},o(0,e,"other",null,function(t){this._other=t})}(),function(i){function t(){this.eff=null,this._actor=NaN,this._id=0,this.headPart=null,this.imgLink=null,t.__super.call(this)}l(t,"modules.role.RoleSpecialEquipView",i);var e=t.prototype;e.changeActorAndEquip=function(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this._actor=t,0!=i&&(this._id=i,this.img.skin="modules/role/sp"+this._id+".png",rh.ins().spEquipActIndex=this.headPart.index)},e.createChildren=function(){i.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_0"),this.headPart=new hh,this.headPart.on("RoleHeadsPart.CHOOSE",this,this.onHeadItemClick),this.headPart.x=73,this.headPart.y=53,this.addChild(this.headPart);for(var t=0;t<4;t++)an.register("RP_SPEQUIP_"+t,this.headPart.getItem(t),new Hs(39,10));this.on("click",this,this.onMouseDown),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay)},e.onDisplay=function(){ni.register("ROLE_UPDATE_REFINE",this,this.updateView),ni.register("RPMASK_INFO_UPDATE",this,this.updateByRPMaskDataChange),this.updateView()},e.onUnDisplay=function(){ni.remove("ROLE_UPDATE_REFINE",this,this.updateView),ni.remove("RPMASK_INFO_UPDATE",this,this.updateByRPMaskDataChange),this.checkChb()},e.onHeadItemClick=function(t){this.checkChb();var i=ie.getPalByIndex(t);i&&(this.changeActorAndEquip(i.pal_id),rh.ins().spEquipActID=i.pal_id,rh.ins().spEquipActIndex=t,this.updateView())},e.updateView=function(){var t=oh.getSpEquipP(this.headPart.index,this._id).lv,i=_i.getSpEquipVO(this._id);this.txtDesc.text=i.desc;var e=ve.getItem(i.goodsID);e&&(this.txtNeed.text="消耗"+e.name+"："),this.txtName.text=i.name+"Lv."+t;var s=i.getAttrByLv(t);this.txtNowAttr.text=s,s="";var n=Ze.getGoodsNumByType(Ze.GOODS_ID,i.goodsID);this.txtHas.color=n>=i.getNeedByLv(t)?"#ffe0cf":"#b60202",this.txtHas.text=n+"",this.txtNeed1.text="/"+i.getNeedByLv(t),t<i.level?(this.imgInput.visible=this.txtNeed.visible=!0,s=i.getAttrByLv(t+1),this.btnUp.gray=!1,this.btnUp.mouseEnabled=!0,this.btnUp.label=n>=i.getNeedByLv(t)?0<t?"升级":"激活":"获得材料"):(this.imgInput.visible=this.txtNeed.visible=!1,s="已满级\n",this.btnUp.label="已满级",this.btnUp.gray=!0,this.btnUp.mouseEnabled=!1),this.txtNextAttr.text=s,this.imgTitle.skin="modules/role/spTitle"+this._id+".png",11==this._id||14==this._id?(this.imgTitle.x=269,this.imgLink&&this.imgLink.parent&&(this.imgLink.visible=!1)):(this.imgTitle.x=304,this.createImgLink(),this.imgLink&&this.imgLink.parent&&(this.imgLink.visible=!0),this.updateImgLinkBar()),this.checkHeadRp(),this.updateChb()},e.updateByRPMaskDataChange=function(){this.checkHeadRp(),this.updateChb()},e.updateChb=function(){this.chb.selected=!Ah.checkIsPing2(Ks.getSpeEquipModID(this._id),this._actor,0)},e.checkChb=function(){var t=Ks.getSpeEquipModID(this._id),i=Ah.getMaskInfo(t,this._actor),e=this.chb.selected?0:1;e!=i&&Oh.ins().toRPSave(t,this._actor,[e])},e.createImgLink=function(){this.imgLink=this.imgLink||Na.getIns(44e3,"RefineImgLinkPanel"),12==this._id?this.imgLink.setRefineShowType(5):13==this._id&&this.imgLink.setRefineShowType(6),this.imgLink.pos(546,219),this.imgLink.on("click",this,this.onImgLink),this.addChild(this.imgLink)},e.onImgLink=function(){var t=new wa;t.type=this._id,t.step=oh.getSpEquipP(this.headPart.index,this._id).lv,to.show(t,"SPEQUIP_POTENTIAL_TIP")},e.updateImgLinkBar=function(){if(this.imgLink&&this.imgLink.parent&&(12==this._id||13==this._id)){for(var t=oh.getSpEquipP(this.headPart.index,this._id),i=(_i.getSpEquipVO(this._id),t.lv),e=_i.getPotentialVOByPos(this._id),s=0,n=0,h=0,a=e.PotentialLvArr.length;h<a;h++)if(e.PotentialLvArr[h].lv>t.stage_lv){n=s=e.PotentialLvArr[h].lv,0<h&&(n=e.PotentialLvArr[h].lv-e.PotentialLvArr[h-1].lv);break}if(i<1e3){if(s<=i&&t.stage_lv<s)return this.imgLink.updateProgressBar(1,1),void this.imgLink.showRedPoint();this.imgLink.updateProgressBar(n-(s-i),n),this.imgLink.unShowRedPoint()}else this.imgLink.updateProgressBar(1,1),t.stage_lv<1e3?this.imgLink.showRedPoint():this.imgLink.unShowRedPoint()}},e.checkHeadRp=function(){for(var t=!1,i=0;i<ie.pals.length;i++){t=!1;var e,s=ie.pals[i];for(var n in s.spec_equips)if((e=s.spec_equips[n]).id<20){var h=_i.getSpEquipVO(e.id);if(e.lv<h.level){var a=h.goodsID;if(Ze.getGoodsNumByType(Ze.GOODS_ID,a)>=h.getNeedByLv(e.lv)&&(t=!Ah.checkIsPing2(Ks.getSpeEquipModID(this._id),s.pal_id,0)))break}}t?an.show("RP_SPEQUIP_"+i):an.hide("RP_SPEQUIP_"+i)}},e.spEquipUpgradeBack=function(){this.updateView(),this.showSucc()},e.showSucc=function(){this.eff||(this.eff=this.eff||ut.getOne(),this.eff.pos(340,430),this.addChild(this.eff)),this.eff.loadAndPlay("moduleEffect/shengji_succ")},e.onMouseDown=function(t){switch(t.target){case this.btnClose2:case this.btnClose:this.closeWindow();break;case this.btnUp:"#ffe0cf"==this.txtHas.color?rh.ins().toRoleSpecialUpdate(this._actor,this._id):Zi.show(_i.getSpEquipVO(this._id).goodsID)}},e.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this,t,i),this.headPart.resetSelect(oh.curActorIndex)}}(kh),function(t){function e(){var t;this.headsItem=null,this._selectOrder=-1,e.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick),this.headsItem=[];for(var i=0;i<4;i++)(t=new ph).pos(137*i+68,89),t.mouseEnabled=!0,t.palOrder=i,this.addChild(t),this.headsItem.push(t);this.on("display",this,this.onDisplay)}l(e,"modules.roleSet.RoleChangeSexView",Jn);var i=e.prototype;i.onDisplay=function(){this.selectOrder=0,ni.register("ROLE_CHANGE_SEX",this,this.updateRole),this.on("undisplay",this,this.onUnDisplay)},i.onUnDisplay=function(){ni.remove("ROLE_CHANGE_SEX",this,this.updateRole),this.off("undisplay",this,this.onUnDisplay)},i.onClick=function(t){switch(t.target){case this.btnClose2:case this.btnClose:this.closeWindow();break;case this.btnChange:if(0<=this._selectOrder){var i=ie.pals[this._selectOrder];if(i)if(0==this._selectOrder)if(0<Le.marryState)switch(Le.marryState){case 1:this.checkGoldChangeSex(i,3-i.ext.sex,!0);break;case 2:io.addTip("当前正在请求结缘中，不能修改主角色性别");break;case 3:io.addTip("当前正在结缘中，不能修改主角色性别")}else io.addTip("查询结缘状态中，请稍候");else this.checkGoldChangeSex(i,3-i.ext.sex,!1);else io.addTip("角色信息错误")}else io.addTip("当前没有选中得角色哦");break;default:t.target instanceof modules.roleSet.RoleSetHeadItem&&(this.selectOrder=t.target.palOrder)}},i.checkGoldChangeSex=function(t,i,e){if(120<=ie.gold){var s=pe.span("是否花费","#5d3924")+pe.span("120元宝","#F7EF5F")+pe.span("修改"+_i.VOCA[t.ext.category]+"角色","#5d3924");e&&(s+=pe.span("（主角色）","#5d3924")),s+=pe.span("的性别为","#5d3924"),s+=1==i?pe.span("男性？","#5d3924"):pe.span("女性？","#5d3924"),es.showSecAlert(s,lh.ins,lh.ins.toPalChangeSex,[t.pal_id,i])}else es.showAlert()},i.updateRole=function(){for(var t in this.headsItem)this.headsItem[t].update();if(0<=this._selectOrder){var i=ie.pals[this._selectOrder];if(null!=i){this.imgHead.skin="com/head/big"+i.ext.category+i.ext.sex+".png";var e=_i.VOCA[i.ext.category];0==this._selectOrder&&(e+="(主角色)"),this.txtCate.text=e,this.txtSex.text=1==i.ext.sex?"男":"女"}else this.txtCate.text=this.txtSex.text=this.imgHead.skin=""}},o(0,i,"selectOrder",null,function(t){var i;for(var e in this._selectOrder=t,this.headsItem)(i=this.headsItem[e]).select=i.palOrder==t;this.updateRole()})}(),function(t){function i(){this.cityItms=null,this.items=null,this.posYDic=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick),this.initCity(),this.pan.vScrollBarSkin=this.pan2.vScrollBarSkin="",this.input.on("focus",this,this.onFocus),this.input.on("blur",this,this.onBlur),this.input.on("input",this,this.onInputChange),this.on("display",this,this.onDisplay),this.pan.vScrollBar.on("change",this,this.onScrollbarChange)}l(i,"modules.roleSet.RoleSetCityView",uh);var e=i.prototype;e.onScrollbarChange=function(){this.imgTop.visible=this.pan.visible&&500<=this.pan.vScrollBar.value},e.onDisplay=function(){this.on("undisplay",this,this.onUndisplay),this.btnSel.visible=!1,this.input.text="输入城市名或城市首字母查询",this.pan.visible=!0,this.pan2.visible=!1,this.toGetGPSPos()},e.toGetGPSPos=function(){if(""!=ji.ip_arr){var t=mh.getMyCity(ji.ip_arr);""!=t?this.showGps(t):this.showGps(null)}else this.showGps(null)},e.onUndisplay=function(){this.off("undisplay",this,this.onUndisplay)},e.onInputChange=function(){var t=this.input.text,i=mh.getCityVO(t);if(i){this.cityItms=this.cityItms||[];for(var e,s=Math.max(i.length,this.cityItms.length),n=0;n<s;n++)n<i.length?(this.cityItms[n]=this.cityItms[n]||new dh,(e=this.cityItms[n]).pos(0,65*n),e.txtCity.text=i[n],this.pan2.addChild(e)):this.cityItms[n]&&this.cityItms[n].parent&&this.cityItms[n].removeSelf()}this.imgTop.visible=this.pan.visible&&500<=this.pan.vScrollBar.value,this.pan.visible=i.length<=0,this.pan2.visible=0<i.length},e.onFocus=function(){"输入城市名或城市首字母查询"==this.input.text&&(this.input.text="")},e.onBlur=function(){""==this.input.text&&(this.input.text="输入城市名或城市首字母查询")},e.showGps=function(t){null!=t&&""!=t?(this.btnSel.label=t,this.btnSel.visible=!0,this.txtDesc.text="（GPS定位 ）",this.txtDesc.x=171):(this.btnSel.visible=!1,this.txtDesc.text="定位失败，请手动选择城市",this.txtDesc.x=61)},e.onClick=function(t){switch(t.target){case this.btnClose2:case this.btnClose:this.closeWindow();break;case this.btnSel:ni.dispatch("CHANGE_CITY",this.btnSel.label),this.closeWindow();break;case this.imgTop:this.pan.vScrollBar.value=0;break;default:if(t.target instanceof laya.ui.Button&&t.target.parent instanceof modules.roleSet.RoleSetCityItem){var i=t.target.label;this.posYDic.hasOwnProperty(i)?this.pan.vScrollBar.value=this.posYDic[i]:(ni.dispatch("CHANGE_CITY",i),this.closeWindow())}else t.target instanceof ui.modules.role.RoleSetCityItem2UI&&(ni.dispatch("CHANGE_CITY",t.target.txtCity.text),this.closeWindow())}},e.initCity=function(){var t=mh.cityDic,i=0;for(var e in this.items=[],this.posYDic=new Object,t){var s=new ch;s.data=t[e],s.pos(0,i),this.posYDic[e]=i,i+=s.height,this.pan.addChild(s),this.items.push(s)}},e.update=function(){}}(),function(t){function e(){var t;this.headsItem=null,this.s1=null,this.s2=null,this.copyHeadItem=null,this.dragType=1,this.putArr=null,e.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick),this.headsItem=[];for(var i=0;i<4;i++)(t=new ph).pos(137*i+68,99),t.mouseEnabled=!0,t.palOrder=i,this.addChild(t),this.headsItem.push(t);this.s1=pe.font("调整后的主角色需与当前玩家性别（","#3e1e0c",24)+pe.font("男","#f4f1b2",24)+pe.font("）一致","#3e1e0c",24),this.s2=pe.font("调整后的主角色需与当前玩家性别（","#3e1e0c",24)+pe.font("女","#f4f1b2",24)+pe.font("）一致","#3e1e0c",24),this.on("display",this,this.onDisplay)}l(e,"modules.roleSet.RoleSetReorderView",fh);var i=e.prototype;i.onDisplay=function(){this.putArr=[-1,-1,-1,-1]},i.onImgDown=function(t){var i=NaN;switch(t.target){case this.img1:i=this.putArr[0];break;case this.img2:i=this.putArr[1];break;case this.img3:i=this.putArr[2];break;case this.img4:i=this.putArr[3]}0<=i&&i<ie.pals.length&&(this.dragType=2,this.mouseDown(i,t.target.x,t.target.y))},i.onHeadDown=function(t){var i=t.target;0<=i.palOrder&&i.palOrder<ie.pals.length?(this.dragType=1,this.mouseDown(i.palOrder,t.target.x,t.target.y)):io.addTip("没有开启的角色无法拖动哦")},i.mouseDown=function(t,i,e){null==this.copyHeadItem&&(this.copyHeadItem=new ph,this.copyHeadItem.mouseEnabled=!1),this.copyHeadItem.palOrder=t,this.copyHeadItem.update(),this.copyHeadItem.pos(i,e),this.addChild(this.copyHeadItem),this.copyHeadItem.startDrag(null,!1,0),this.stage.on("mouseup",this,this.onCopyItemUp)},i.onCopyItemUp=function(t){if(this.stage.off("mouseup",this,this.onCopyItemUp),this.copyHeadItem.removeSelf(),t.target instanceof laya.ui.Image){var i=NaN;switch(t.target){case this.img1:i=0;break;case this.img2:i=1;break;case this.img3:i=2;break;case this.img4:i=3;break;default:i=-1}0<=i?i<ie.pals.length?(this["imgHead"+(i+1)].skin="com/head/big"+ie.getPalByIndex(i).ext.category+ie.getPalByIndex(i).ext.sex+".png",this.findOrdToChange(this.copyHeadItem.palOrder,this.putArr[i]),this.putArr[i]=this.copyHeadItem.palOrder):io.addTip("未开启第"+(i+1)+"个角色哦"):2==this.dragType&&this.findOrdToChange(this.copyHeadItem.palOrder,-1)}else 2==this.dragType&&this.findOrdToChange(this.copyHeadItem.palOrder,-1);this.update()},i.findOrdToChange=function(t,i){var e=this.putArr.indexOf(t);0<=e&&(this.putArr[e]=i)},i.onClick=function(t){switch(t.target){case this.btnClose2:case this.btnClose:this.closeWindow();break;case this.img1:this.putArr[0]=-1,this.update();break;case this.img2:this.putArr[1]=-1,this.update();break;case this.img3:this.putArr[2]=-1,this.update();break;case this.img4:this.putArr[3]=-1,this.update();break;case this.btnChange:var i=0;for(var e in this.putArr)0<=this.putArr[e]&&++i;if(i==ie.pals.length){var s=ie.getPalByIndex(this.putArr[0]);if(s&&s.ext.sex==ie.pals[0].ext.sex){for(var n=0;n<i;n++)if(this.putArr[n]!=n){for(var h,a=[],o=0;o<this.putArr.length;o++)0<=this.putArr[o]&&((h=new Object).className="p_kv",h.id=o+1,h.val=ie.pals[this.putArr[o]].pal_id,a.push(h));return void lh.ins.toPalReorder(a)}io.addTip("没有改变顺序哦")}else io.addTip("主角色需与当前玩家性别一致")}else io.addTip("没有操作完毕哦");break;default:if(t.target instanceof modules.roleSet.RoleSetHeadItem){var r=t.target;if(0<=r.palOrder&&r.palOrder<ie.pals.length){var l=this.putArr.indexOf(r.palOrder);if(0<=l&&l<ie.pals.length)this.putArr[l]=-1;else if(0<=(l=this.putArr.indexOf(-1))&&l<ie.pals.length)if(0==l)ie.pals[0].ext.sex==ie.pals[r.palOrder].ext.sex?this.putArr[l]=r.palOrder:io.addTip("主角色需与当前玩家性别一致");else this.putArr[l]=r.palOrder;this.update()}else io.addTip("没有开启的角色无法拖动哦")}}},i.update=function(){var t;for(var i in this.headsItem){(t=this.headsItem[i]).update();var e=t.palOrder;t.gray=0<=this.putArr.indexOf(e)}for(var s=0;s<4;s++)0<=this.putArr[s]?this["imgHead"+(s+1)].skin="com/head/big"+ie.getPalByIndex(this.putArr[s]).ext.category+ie.getPalByIndex(this.putArr[s]).ext.sex+".png":this["imgHead"+(s+1)].skin=null;this.txtSub.innerHTML=1==ie.getPalByIndex(0).ext.sex?this.s1:this.s2},i.callBackUpdate=function(){this.putArr=[-1,-1,-1,-1],this.update()}}(),function(t){function i(){this._data=null,this.goodsImage=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_7"),this.goodsImage=new ae(null,!0,!0,105),this.goodsImage.pos(55,400),this.addChild(this.goodsImage),this.btnOperate.on("click",this,this.onClick)}l(i,"modules.roleSet.RoleSetSelfBubbleTip",_h);var e=i.prototype;e.onClick=function(){this._data&&(ts.ins().useItem(this._data.id,1),this.closeWindow())},e.update=function(t){this._data=t;var i=ve.getItem(t.typeid);this.txtName.text=i.name,this.txtName.color=Qi.getColorDark(i.color);var e=0<i.tempNum?i.tempNum:1;this.txtNum.text=e+"",this.txtLv.text=i.level+"",this.txtDesc.text=i.desc,this.goodsImage.data=i,this.btnOperate.y=this.txtDesc.y+this.txtDesc.textHeight+15,this.height=this.btnOperate.y+this.btnOperate.height+20}}(),function(t){function i(){this.imgSelected=null,this.items=null,this.state=0,this.curItem=null,this.curIndex=0,this.COLUMN=4,i.__super.call(this),this.items=[],this.list.vScrollBar.autoHide=!0,this.imgSelected=new ge,this.imgSelected.skin="modules/roleSet/selfSelected.png",this.imgSelected.pos(0,0),this.list.addChild(this.imgSelected),this.btnOperate.on("click",this,this.onClick),this.on("display",this,this.onDisplay)}l(i,"modules.roleSet.RoleSetSelfBubbleView",Ih);var e=i.prototype;s.imps(e,{"com.ui.IViewUpdate":!0}),e.onDisplay=function(){this.curIndex=0},e.onClick=function(){this.curItem&&this.curItem.data&&(1==this.state||(2==this.state?Ae.linkTo(this.curItem.data.linkId):3==this.state&&lh.ins.toBubbleUse(this.curItem.data.id)))},e.update=function(){this.imgSelected&&this.imgSelected.removeSelf();for(var t=xh.getBubbles(),i=0;i<t.length;i++){this.items[i]=this.items[i]||new gh;var e=this.items[i],s=t[i];if(e){e.dataSource=s;var n=i%this.COLUMN,h=Math.floor(i/this.COLUMN);e.pos(10+170*n,10+160*h),this.curIndex==i&&(this.imgSelected.pos(-12,-12),e.addChild(this.imgSelected),this.selectedItemUpdate(e)),null==e.parent&&(this.list.addChild(e),e.on("click",this,this.onItemClick))}}},e.onItemClick=function(t){this.imgSelected&&this.imgSelected.removeSelf();var i=t.target;i&&i.data&&(this.imgSelected.pos(-12,-12),i.addChild(this.imgSelected),this.curIndex=this.getCurIndex(i),this.selectedItemUpdate(i),xh.removeBubbleNewById(i.data.id),i.updateRP()),xh.checkBubbleRedPoint()},e.getCurIndex=function(t){if(this.list&&0<this.list.numChildren)for(var i=0;i<this.list.numChildren;i++){var e=this.items[i];if(e&&e.data.id==t.data.id)return i}return 0},e.selectedItemUpdate=function(t){this.state=xh.getBubbleState(t.data),0<=(this.curItem=t).data.id?(this.imgBubble.visible=!0,this.imgBubble.skin="modules/bubble/bubbleR"+t.data.id+".png"):this.imgBubble.visible=!1,this.txt.color=t.data.txtColor,this.txtName.text=t.data.name,this.txtName.color=Qi.getColorLight(t.data.colour),3==this.state?(this.txtDesc.text="期限："+t.data.validityDesc,this.btnOperate.disabled=!1,this.btnOperate.label="使用"):2==this.state?(this.txtDesc.text="获得："+t.data.getWayDesc,this.btnOperate.disabled=!1,this.btnOperate.label="前往获得"):1==this.state&&(this.txtDesc.text="期限："+t.data.validityDesc,this.btnOperate.disabled=!0,this.btnOperate.label="使用中")}}(),function(t){function i(){this._data=null,this.goodsImage=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_7"),this.goodsImage=new ae(null,!0,!0,105),this.goodsImage.pos(55,400),this.addChild(this.goodsImage),this.btnOperate.on("click",this,this.onClick)}l(i,"modules.roleSet.RoleSetSelfFrameTip",bh);var e=i.prototype;e.onClick=function(){this._data&&(ts.ins().useItem(this._data.id,1),this.closeWindow())},e.update=function(t){this._data=t;var i=ve.getItem(t.typeid);this.imgFrame.skin=i.realMaxico,this.txtName.text=i.name,this.txtName.color=Qi.getColorDark(i.color);var e=0<i.tempNum?i.tempNum:1;this.txtNum.text=e+"",this.txtLv.text=i.level+"",this.txtDesc.text=i.desc,this.goodsImage.data=i,this.btnOperate.y=this.txtDesc.y+this.txtDesc.textHeight+15,this.height=this.btnOperate.y+this.btnOperate.height+20}}(),function(t){function i(){this.imgSelected=null,this.txtInUse=null,this.items=null,this.state=0,this.curItem=null,this.curIndex=0,this.bcFrame=null,this.COLUMN=4,i.__super.call(this),this.items=[],this.list.vScrollBar.autoHide=!0,this.imgSelected=new ge,this.imgSelected.skin="modules/roleSet/selfSelected.png",this.imgSelected.pos(0,0),this.list.addChild(this.imgSelected),this.txtInUse=new Wa,this.txtInUse.fontSize=26,this.txtInUse.size(144,30),this.txtInUse.align="center",this.txtInUse.color="#ffffff",this.txtInUse.pos(0,0),this.txtInUse.text="使用中",this.list.addChild(this.txtInUse),this.btnOperate.on("click",this,this.onClick),this.on("display",this,this.onDisplay)}l(i,"modules.roleSet.RoleSetSelfFrameView",yh);var e=i.prototype;s.imps(e,{"com.ui.IViewUpdate":!0}),e.onDisplay=function(){this.curIndex=0},e.onClick=function(){this.curItem&&this.curItem.data&&(1==this.state||(2==this.state?Ae.linkTo(this.curItem.data.linkId):3==this.state&&lh.ins.toAvatarFrameUse(this.curItem.data.id)))},e.update=function(){this.txtInUse&&this.txtInUse.removeSelf(),this.imgSelected&&this.imgSelected.removeSelf();for(var t=xh.getFrames(),i=0;i<t.length;i++){var e=t[i];this.items[i]=this.items[i]||new vh;var s=this.items[i];if(s){s.dataSource=e;var n=i%this.COLUMN,h=Math.floor(i/this.COLUMN);s.pos(10+170*n,10+160*h),this.curIndex==i&&(this.imgSelected.pos(-12,-12),s.addChild(this.imgSelected),this.selectedItemUpdate(s)),s.data.id==xh.getCurAvatarFrameId()&&(this.txtInUse.pos(0,60),s.addChild(this.txtInUse)),null==s.parent&&(this.list.addChild(s),s.on("click",this,this.onItemClick))}}},e.onItemClick=function(t){this.imgSelected&&this.imgSelected.removeSelf();var i=t.target;i&&i.data&&(this.imgSelected.pos(-12,-12),i.addChild(this.imgSelected),this.curIndex=this.getCurIndex(i),this.selectedItemUpdate(i),xh.removeFrameNewById(i.data.id),i.updateRP()),xh.checkFrameRedPoint()},e.getCurIndex=function(t){if(this.list&&0<this.list.numChildren)for(var i=0;i<this.list.numChildren;i++){var e=this.items[i];if(e&&e.data.id==t.data.id)return i}return 0},e.selectedItemUpdate=function(t){this.state=xh.getFrameState(t.data),0<(this.curItem=t).data.id?1==t.data.urlType?(this.imgFrame.visible=!1,null==this.bcFrame&&(this.bcFrame=ut.getOne(),this.bcFrame.pos(112,762)),null==this.bcFrame.parent&&this.addChild(this.bcFrame),this.bcFrame.loadAndPlay("moduleEffect/frameEff","default",0,!0)):(this.bcFrame&&this.bcFrame.removeSelf(),this.imgFrame.visible=!0,this.imgFrame.skin="modules/frame/"+t.data.id+".png"):(this.imgFrame.visible=!1,this.bcFrame&&this.bcFrame.removeSelf()),this.txtName.text=t.data.name,this.txtName.color=Qi.getColorLight(t.data.colour),3==this.state?(this.txtDesc.text="期限："+t.data.validityDesc,this.btnOperate.disabled=!1,this.btnOperate.label="使用"):2==this.state?(this.txtDesc.text="获得："+t.data.getWayDesc,this.btnOperate.disabled=!1,this.btnOperate.label="前往获得"):1==this.state&&(this.txtDesc.text="期限："+t.data.validityDesc,this.btnOperate.label="使用中",this.btnOperate.disabled=!0)}}(),function(t){function i(){this.curView=null,this.frameView=null,this.bubbleView=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_7",!1,"",!1),this.tab.selectHandler=new ue(this,this.onTabChange),this.tab.selectedIndex=0,this.on("click",this,this.onClick),an.register("RP_ROLE_SET_SELF_FRAME",this.tab.items[0],new Hs(19,-10)),an.register("RP_ROLE_SET_SELF_BUBBLE",this.tab.items[1],new Hs(19,-10)),this.on("display",this,this.onDisplay)}l(i,"modules.roleSet.RoleSetSelfPanel",Sh);var e=i.prototype;e.onDisplay=function(){this.tab&&(this.tab.selectedIndex=0)},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose1:this.closeWindow()}},e.onTabChange=function(t){switch(this.spView.removeChildren(),t){case 0:this.frameView=this.frameView||Na.getIns(48e3,"RoleSetSelfFrameView"),this.curView=this.frameView;break;case 1:this.bubbleView=this.bubbleView||Na.getIns(48e3,"RoleSetSelfBubbleView"),this.curView=this.bubbleView,lh.ins.toBubbleInfo()}this.spView.addChild(this.curView),this.curView.update()},e.update=function(){this.curView&&this.curView.update()}}(),function(t){function e(){var t;this.headsItem=null,this.bcFrame=null,this._originTxtNameX=NaN,this._blueVipBox=null,e.__super.call(this),this.setWindowType(),this.on("click",this,this.onClick),this.txtUser.underline=this.txtLink.underline=!0,this._originTxtNameX=this.txtName.x,this.headsItem=[];for(var i=0;i<4;i++)(t=new ph).pos(160*i+50,112),t.mouseEnabled=!0,t.palOrder=i,this.imgMid.addChild(t),this.headsItem.push(t);this.on("display",this,this.onDisplay),an.register("RP_ROLE_SET_SELF_FRAME",this.btnSp,new Hs(19,-10)),an.register("RP_ROLE_SET_SELF_BUBBLE",this.btnSp,new Hs(19,-10)),(Vh.isXiaoMi()||Vh.isJingDong()||Vh.isFanTi)&&(this.txtArea.visible=this.txtCity.visible=this.imgCCity.visible=!1),this.txtUser.mouseEnabled=!0,this.txtUser.on("click",this,this.onUserLink)}l(e,"modules.roleSet.RoleSetView",wh);var i=e.prototype;i.onDisplay=function(){ni.register("ON_SYS_CONFIG",this,this.updateToggle),ni.register("CHANGE_CITY",this,this.updateCity),ni.register("ROLE_CHANGE_NAME",this,this.updateName),ni.register("ROLE_CHANGE_SEX",this,this.updateSex),ni.register("ROLE_REORDER",this,this.updateRole),ni.register("ON_AVATARFRAMEINFO",this,this.updateHead),lh.ins.toAvatarFrameInfo(),this.on("undisplay",this,this.onUnDisplay)},i.updateHead=function(){var t=xh.getCurAvatarFrameId();if(0<t){var i=xh.getSelfFrameVOById(t);i&&1==i.urlType?(this.imgFrame.visible=!1,null==this.bcFrame&&(this.bcFrame=ut.getOne(),this.bcFrame.pos(112,142)),null==this.bcFrame.parent&&this.box.addChild(this.bcFrame),this.bcFrame.loadAndPlay("moduleEffect/frameEff","default",0,!0)):(this.bcFrame&&this.bcFrame.removeSelf(),this.imgFrame.visible=!0,this.imgFrame.skin="modules/frame/"+t+".png")}else this.imgFrame.visible=!1,this.bcFrame&&this.bcFrame.removeSelf()},i.updateSex=function(){var t=ie.pals[0];t?(this.imgHead.skin="com/head/big"+t.ext.category+t.ext.sex+".png",this.txtSex.text=1==t.ext.sex?"男":"女",this.imgCSex.x=this.txtSex.x+this.txtSex.textWidth+5):this.imgHead.skin=""},i.updateToggle=function(){this.tog1.selected=Ma.getFunOpen(0),this.tog2.selected=Ma.getFunOpen(1),this.tog3.selected=!Ma.getFunOpen(2)},i.onUnDisplay=function(){ni.remove("ON_SYS_CONFIG",this,this.updateToggle),ni.remove("CHANGE_CITY",this,this.updateCity),ni.remove("ROLE_CHANGE_NAME",this,this.updateName),ni.remove("ROLE_CHANGE_SEX",this,this.updateSex),ni.remove("ROLE_REORDER",this,this.updateRole),ni.remove("ON_AVATARFRAMEINFO",this,this.updateHead),this.off("undisplay",this,this.onUnDisplay)},i.updateCity=function(t){this.txtCity.text=t,this.imgCCity.x=this.txtCity.x+this.txtCity.textWidth+5,ie.getRoleCity()!=t&&lh.ins.toPalSetCity(t)},i.updateName=function(){this.txtName.text=ie.roleName,this.imgCName.x=this.txtName.x+this.txtName.textWidth+5},i.update=function(){this.updateName(),this.updateCity(ie.getRoleCity()),this.updateRole(),this.updateToggle(),this.updateBlueVip()},i.updateRole=function(){for(var t in this.headsItem)this.headsItem[t].update();this.updateSex()},i.onClick=function(t){switch(t.target){case this.imgCName:ni.dispatch("OPEN_ROLE_SETNAME_VIEW");break;case this.imgCSex:ni.dispatch("OPEN_CHANGESEX_VIEW");break;case this.imgCCity:if("未开启"==this.txtCity.text){var i=new q;i.msg="是否开启定位",i.yesCaller=this,i.yesFun=this.updatePos,K.showVO(i)}else ni.dispatch("OPEN_CHANGECITY_VIEW");break;case this.btnCopy:Ut.Ins.showRoleInfoCopy();break;case this.btnSp:lh.ins.openSelfPanel();break;case this.btnClose2:case this.btnClose:this.closeWindow();break;case this.tog1:var e=this.tog1.selected?1:0;Ga.ins().toRoleSysCon(0,e);break;case this.tog2:e=this.tog2.selected?1:0,Ga.ins().toRoleSysCon(1,e);break;case this.tog3:e=this.tog3.selected?0:1,Ga.ins().toRoleSysCon(2,e);break;case this.tog4:break;case this.txtLink:ni.dispatch("OPEN_REORDER_VIEW")}},i.updatePos=function(){if(""!=ji.ip_arr){var t=mh.getMyCity(ji.ip_arr);""!=t?(this.txtCity.text=t,lh.ins.toPalSetCity(t)):this.txtCity.text="定位失败"}else this.txtCity.text="定位失败";this.imgCCity.x=this.txtCity.textWidth+this.txtCity.x+5},i.updateBlueVip=function(){if(Vh.isQQyxdt()){this.txtName.x=this._originTxtNameX+28,this._blueVipBox=this._blueVipBox||new mt,this.spTop.addChild(this._blueVipBox);var t=new ft;t.nameText=this.txtName,t.blueInfo=ie.getRoleBlueVipInfo(),this._blueVipBox.updateShowing(t),28<this._blueVipBox.width?this._blueVipBox.x+=28:this._blueVipBox.x,this.txtName.x=0<this._blueVipBox.width?this._originTxtNameX+this._blueVipBox.width:this._originTxtNameX,this.updateName()}},i.onUserLink=function(t){ni.dispatch("OPEN_USER_AGREEMENT_SHOW")}}(),function(t){function i(){i.__super.call(this),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.list.selectEnable=!0,this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(51e3,"cultivation.ShopCultivationItem"),(Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian())&&(this.btnGold.visible=this.btnCopper.visible=!1),Vh.isXYX9992()&&(this.btnCopper.visible=this.btnGold.visible=!1)}l(i,"modules.shop.battlefield.ShopBattlefieldView",Bh);var e=i.prototype;e.onClick=function(t){if(!((t.target==this.btnCopper||t.target==this.btnGold)&&Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian()))switch(t.target){case this.btnCopper:Ae.linkTo(11430);break;case this.btnGold:Vh.isXYX9992()||Ae.linkTo(11454);break;case this.btnAdd:Zi.show(10201479)}},e.onDisplay=function(){},e.onUnDisplay=function(){},e.update=function(){this.updateGoldChange(),this.txtScore.text=ie.getScore(19)+"",this.updateShowList()},e.updateGoldChange=function(){this.txtMyGold.text=ie.user.attr.gold+"",this.txtMyCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver)},e.updateScoreChange=function(){this.txtScore.text=ie.getScore(6)+""},e.updateShowList=function(){var t=Wh.getShopListById(6);this.list.dataSource=t?t.ShopTypeItemArr:[]}}(),function(t){function i(){this._data=null,this.goodsImage=null,i.__super.call(this),this.txtName.width=373,this.txtName.x=132,this.goodsImage=so.createGoodsImage(0,0,null,this.spGoods,!0,!0,105,!1),this.goodsImage.on("click",this,this.onClick),this.btnBuy.on("click",this,this.onClick)}l(i,"modules.shop.cultivation.ShopCultivationItem",t);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnBuy:var i,e;if(Ve.send(7,10,"商城-修为商店-购买"),3==Wh.curTabIndex)ie.getScore(2)>=this._data.costArr[0].val?(i=ve.getItem(this._data.typeId),e=pe.span("是否花费","#5d3924")+pe.span(this._data.costArr[0].val+"修为","#F7EF5F")+pe.span("购买"+this._data.num+"个","#5d3924")+pe.span("【"+i.name+"】？",Qi.getColorLight(i.color)),es.showSecAlert(e,Kt.getInstance(),Kt.getInstance().toExchangeRequest,[this._data.id,1],"cultivationBuy")):Zi.show(10201114);else 5==Wh.curTabIndex&&(ie.getScore(19)>=this._data.costArr[0].val?(i=ve.getItem(this._data.typeId),e=pe.span("是否花费","#5d3924")+pe.span(this._data.costArr[0].val+"战场积分","#F7EF5F")+pe.span("兑换"+this._data.num+"个","#5d3924")+pe.span("【"+i.name+"】？",Qi.getColorLight(i.color)),es.showSecAlert(e,rh.ins(),rh.ins().toExchange,[18,this._data.id,1],"battlefieldExchange")):Zi.show(10201479));break;case this.goodsImage:this.goodsImage.data.tempNum=this.goodsImage.num,to.show(this.goodsImage.data,"BASE_GOODS_TIP")}},e.update=function(){if(this._data){var t=ve.getItem(this._data.typeId);this.goodsImage.data=t,this.goodsImage.num=this._data.num;var i=Qi.getColorLight(t.color),e=""==this._data.desc?"":"（"+this._data.desc+"）";this.txtName.innerHTML=pe.font(t.name,i,26)+" "+pe.font(e,"#5d3924",26),this.txtGold.text=this._data.costArr[0].val+"",this._data.costArr&&(19==this._data.costArr[0].id?this.img.skin="modules/shop/battlePoint.png":this.img.skin="modules/shop/xiuwei.png")}3!=Wh.curTabIndex&&5!=Wh.curTabIndex||this.updateExchange()},e.updateExchange=function(){var t,i=oh.getExchangeVOById(this._data.id);(t=19==this._data.costArr[0].id?Wh.getShopTypeItemVO(6,this._data.id):Wh.getShopTypeItemVO(4,this._data.id))&&0<t.showNum?(this.txtTimes.visible=this.txtTimesDesc.visible=!0,this.txtTimes.text=i?i.val+"/"+t.showNum:"0/"+t.showNum):this.txtTimes.visible=this.txtTimesDesc.visible=!1},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._data=t,this._data&&this.update()})}(Mh),function(t){function i(){i.__super.call(this),this.list.selectEnable=!0,this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(51e3,"cultivation.ShopCultivationItem"),this.list.selectHandler=ue.create(this,this.onSelected),this.on("click",this,this.onClick),(Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian())&&(this.btnGold.visible=this.btnCopper.visible=!1),Vh.isXYX9992()&&(this.btnCopper.visible=this.btnGold.visible=!1)}l(i,"modules.shop.cultivation.ShopCultivationView",Gh);var e=i.prototype;e.onSelected=function(t){},e.updateScoreChange=function(){this.txtScore.text=ie.getScore(2)+""},e.updateGoldChange=function(){this.txtMyGold.text=ie.user.attr.gold+"",this.txtMyCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver)},e.update=function(){var t=Wh.getShopListById(Wh.curTabIndex+1).ShopTypeItemArr;this.list.dataSource=t,this.txtMyGold.text=ie.user.attr.gold+"",this.txtMyCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver),this.txtScore.text=ie.getScore(2)+""},e.onClick=function(t){if(!((t.target==this.btnCopper||t.target==this.btnGold)&&Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian()))switch(t.target){case this.btnCopper:Ae.linkTo(11430);break;case this.btnGold:Vh.isXYX9992()||Ae.linkTo(11454);break;case this.btnAdd:Zi.show(10201114)}}}(),function(t){function i(){this.selectIndex=-1,i.__super.call(this),(Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian())&&(this.btnGold.visible=this.btnCopper.visible=!1)}l(i,"modules.shop.Engrave.ShopEngraveView",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.on("click",this,this.onClick),this.engraveTypeCombo.on("change",this,this.onChange),this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(51e3,"goods.ShopGoodsItem"),this.autoComboTxt.visible=!0,this.engraveTypeCombo.labels="全部,沉香石,丹泉石,金焰石,麒麟石,雷纹石,绛云石,凌霜石,空冥石",Vh.isXYX9992()&&(this.btnCopper.visible=this.btnGold.visible=!1)},e.onDisplay=function(){},e.onUnDisplay=function(){},e.resetComboShow=function(){this.engraveTypeCombo.selectedIndex=-1,this.engraveTypeCombo.button.label="",this.autoComboTxt.visible=!0},e.update=function(){this.updateGoldChange(),this.txtScore.text=ie.getScore(2)+"",this.updateShowList()},e.updateShowList=function(){var t=Wh.getShopListById(5);if(t){if(this.selectIndex!=this.engraveTypeCombo.selectedIndex&&(this.selectIndex=this.engraveTypeCombo.selectedIndex,this.list.scrollTo(0)),this.engraveTypeCombo.selectedIndex<=0)this.list.dataSource=t.ShopTypeItemArr;else{var i=this.getListItemInfoByType(t,this.engraveTypeCombo.selectedIndex);i&&(this.list.dataSource=i)}this.list.refresh()}else this.list.dataSource=[]},e.updateGoldChange=function(){this.txtMyGold.text=ie.user.attr.gold+"",this.txtMyCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver)},e.updateScoreChange=function(){this.txtScore.text=ie.getScore(6)+""},e.onChange=function(t){this.update(),this.autoComboTxt.visible=!1},e.onClick=function(t){if(!((t.target==this.btnCopper||t.target==this.btnGold)&&Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian()))switch(t.target){case this.btnCopper:Ae.linkTo(11430);break;case this.btnGold:Vh.isXYX9992()||Ae.linkTo(11454);break;case this.btnAdd:Zi.show(10201114)}},e.getListItemInfoByType=function(t,i){for(var e=[],s=t.ShopTypeItemArr,n=0,h=s.length;n<h;n++){var a=s[n];i==Math.floor(a.id/100)&&e.push(a)}return e}}(Fh),function(t){function i(){this._data=null,this.itemVO=null,this.goods=null,this.dis=NaN,this.canBuyTimes=0,this.hasBuyTimes=0,this.price=NaN,this.sp=null,this.isOpen=!1,this.alertView=null,this.alertView2=null,i.__super.call(this),this.txtName.width=379,this.txtName.x=132,this.goods=so.createGoodsImage(0,0,null,this.spGoods,!0,!0,105,!1),this.btnBuy.on("click",this,this.onClick),this.goods.on("click",this,this.onClick),this.help.on("click",this,this.onClick),this.createLine(),this.isOpen=!1,this.img2.visible=this.txtGold2.visible=this.buyTimes.visible=this.help.visible=this.isNew.visible=this.sp.visible=!1}l(i,"modules.shop.goods.ShopGoodsItem",t);var e=i.prototype;e.createLine=function(){this.sp=this.sp||new Ta,this.sp.graphics.drawLine(0,33,110,33,"#ffffff",3),this.img.addChild(this.sp)},e.getData=function(){return this._data},e.update=function(){this.price=this.dis/100*5e3,1<=this.dis/10&&this.dis/10<10?(this.sp.visible=!0,this.img2.visible=!0,this.txtGold2.text=this.price.toString()+" ("+(this.dis/10).toString()+"折)"):0==this.dis?(this.txtGold2.text="0 (免费)",this.sp.visible=!0,this.img2.visible=!0):(this.txtGold2.visible=!1,this.sp.visible=!1,this.img2.visible=this.txtGold2.visible=!1),this.buyTimes.text="已购买: ("+this.hasBuyTimes.toString()+"/"+this.canBuyTimes.toString()+")"},e.confirmBuy=function(){Wh.curMysteryItemBuyID=this._data.id,rh.ins().toExchange(2,4e4+this._data.id,1,null)},e.onClick=function(t){switch(t.currentTarget){case this.btnBuy:if(116==this._data.discount&&this.price==this._data.costArr[0].val)this.alertView2=this.alertView2||new ne,this.alertView2.gold.x=130,this.alertView2.goldNum.text=this.price.toString(),this.alertView2.btnYes.label="挑战上古异域",this.alertView2.btnYes.labelSize=24,this.alertView2.btnYes.labelColors="#ffffff",this.alertView2.btnNo.label="确定购买",this.alertView2.btnNo.labelSize=26,this.alertView2.btnNo.labelColors="#ffffff",this.alertView2.txtMsg.style.fontSize=26,this.alertView2.txtMsg.style.valign="top",this.alertView2.txtMsg.style.leading=8,this.alertView2.txtMsg.style.color="#5D3924",this.alertView2.txtMsg.innerHTML="活动期间内可不断重复挑战"+pe.font("上古异域","#FFFF00",26)+"，根据挑战异兽BOSS的"+pe.font("历史最低剩余血量","#FFFF00",26)+"会给予"+pe.font("【上古异兽】","#ffc203",26)+"对应的"+pe.font("折扣","#FFFF00",26)+"，当最低剩余血量降至0%时，将可免费购买商城出售的"+pe.font("【上古异兽】","#ffc203",26)+"<br><br><br><br><br><br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;确定以"+pe.font("原价","#FFFF00",26)+"购买"+pe.font("【上古异兽】","#ffc203",26)+"吗？",this.alertView2.on("click",this,this.onAlertClick2),this.alertView2.popup();else if(Ve.send(7,10,"商城-道具商店-购买"),-1==this._data.discount)1001==this._data.costArr[0].id?this._data&&ie.user.attr.gold>=this._data.costArr[0].val?yt.ins.show(this._data.typeId,2,this._data.costArr[0].val,Wh.curShopID):es.showAlert():19==this._data.costArr[0].id&&(this._data&&ie.getScore(19)>=this._data.costArr[0].val?yt.ins.show(this._data.typeId,3,this._data.costArr[0].val,Wh.curShopID):Zi.show(10201479));else if(1001==this._data.costArr[0].id)if(this._data&&ie.user.attr.gold>=this.price){var i=ve.getItem(this._data.typeId),e=pe.span("是否花费","#5d3924")+pe.span(this.price+"元宝","#F7EF5F")+pe.span("购买"+this._data.num+"个","#5d3924")+pe.font(i.name,"#ffc203",26)+"?";es.showSecAlert(e,this,this.buyConfirm,[1,this._data.typeId,1],null)}else es.showAlert();else 19==this._data.costArr[0].id&&(this._data&&ie.getScore(19)>=this.price?(this.price=this.price<=0?-1:this.price,yt.ins.show(this._data.typeId,3,this.price,Wh.curShopID)):Zi.show(10201479));break;case this.goods:this.goods.data&&(this.goods.data.tempNum=this.goods.num,to.show(this.itemVO,"BASE_GOODS_TIP"));break;case this.help:this.alertView=this.alertView||new ne,this.alertView.gold.visible=!1,this.alertView.title.text="商品说明",this.alertView.btnYes.width=this.alertView.btnNo.width=200,this.alertView.btnYes.height=this.alertView.btnNo.height=70,this.alertView.btnYes.label="挑战上古异域",this.alertView.btnYes.labelSize=24,this.alertView.btnYes.labelColors="#ffffff",this.alertView.btnNo.label="我知道了",this.alertView.btnNo.labelSize=26,this.alertView.btnNo.labelColors="#ffffff",this.alertView.txtMsg.style.fontSize=26,this.alertView.txtMsg.style.valign="top",this.alertView.txtMsg.style.leading=8,this.alertView.txtMsg.style.color="#5D3924",this.alertView.txtMsg.innerHTML="1、活动期间内"+pe.font("可不断重复挑战","#FFFF00",26)+"上古异域，根据挑战异兽BOSS的"+pe.font("历史最低剩余血量","#FFFF00",26)+"会给予"+pe.font("【上古异兽】","#ffc203",26)+"对应的"+pe.font("折扣","#FFFF00",26)+"，当最低剩余血量降至0%时，将可免费购买商城出售的"+pe.font("【上古异兽】","#ffc203",26)+"<br><br><br>2、"+pe.font("【上古异兽】","#ffc203",26)+"只能购买一次，购买后商品将消失",this.alertView.on("click",this,this.onAlertClick),this.alertView.popup()}},e.buyConfirm=function(t,i,e,s){rh.ins().toExchange(t,i,e,s)},e.setDiscount=function(t){this.dis=t},e.setCanBuyTimes=function(t){this.canBuyTimes=t},e.setHasBuyTimes=function(t){this.hasBuyTimes=t},e.onAlertClick=function(t){switch(t.target){case this.alertView.btnYes:this.alertView.close(),37<=ie.myLevel?this.isOpen?Ae.linkTo(10607):io.addTip("上古异域已经关闭，无法进入"):io.addTip("玩家等级不足，无法进入");break;case this.alertView.btnClose:case this.alertView.btnNo:this.alertView.close()}},e.onAlertClick2=function(t){switch(t.target){case this.alertView2.btnYes:this.alertView2.close(),37<=ie.myLevel?this.isOpen?Ae.linkTo(10607):io.addTip("上古异域已经关闭，无法进入"):io.addTip("玩家等级不足，无法进入");break;case this.alertView2.btnClose:this.alertView2.close();break;case this.alertView2.btnNo:if(this.alertView2.close(),Ve.send(7,10,"商城-道具商店-购买"),-1==this._data.discount)1001==this._data.costArr[0].id?this._data&&ie.user.attr.gold>=this._data.costArr[0].val?yt.ins.show(this._data.typeId,2,this._data.costArr[0].val,Wh.curShopID):es.showAlert():19==this._data.costArr[0].id&&(this._data&&ie.getScore(19)>=this._data.costArr[0].val?yt.ins.show(this._data.typeId,3,this._data.costArr[0].val,Wh.curShopID):Zi.show(10201479));else if(1001==this._data.costArr[0].id)if(this._data&&ie.user.attr.gold>=this.price){var i=ve.getItem(this._data.typeId),e=pe.span("是否花费","#5d3924")+pe.span(this.price+"元宝","#F7EF5F")+pe.span("购买"+this._data.num+"个","#5d3924")+pe.font(i.name,"#ffc203",26)+"?";es.showSecAlert(e,this,this.buyConfirm,[1,this._data.typeId,1],null)}else es.showAlert();else 19==this._data.costArr[0].id&&(this._data&&ie.getScore(19)>=this.price?(this.price=this.price<=0?-1:this.price,yt.ins.show(this._data.typeId,3,this.price,Wh.curShopID)):Zi.show(10201479))}},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(this._data=t,this._data){if(this.itemVO=ve.getItem(this._data.typeId),this.itemVO){var i=Qi.getColorLight(this.itemVO.color),e=""==this._data.desc?"":"（"+this._data.desc+"）";this.txtName.innerHTML=pe.font(this.itemVO.name,i,26)+" "+pe.font(e,"#5d3924",26),this.goods.data=this.itemVO,this.goods.num=this._data.num}this._data.costArr&&(this.txtGold.text=this._data.costArr[0].val,1001==this._data.costArr[0].id?this.img.skin="com/ui/gold.png":19==this._data.costArr[0].id&&(this.img.skin="modules/shop/battlePoint.png")),116==this._data.discount?(this.price==parseInt(this._data.costArr[0].val)?(this.sp.visible=!1,this.img2.visible=!1):(this.sp.visible=!0,this.img2.visible=!0),this.help.visible=this.isNew.visible=this.txtGold2.visible=this.buyTimes.visible=!0):(this.img2.visible=this.txtGold2.visible=this.buyTimes.visible=this.help.visible=this.isNew.visible=!1,this.sp.visible=!1)}var s=fe.getIconStateDicValus(116);s&&(3==s.state?this.isOpen=!1:this.isOpen=!0)})}(Uh),function(t){function i(){this.shopTypeVo=null,i.__super.call(this),this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(51e3,"goods.ShopGoodsItem"),this.on("click",this,this.onClick),(Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng())&&(this.btnGold.visible=this.btnCopper.visible=!1),ni.register("SHOP_GOODS_DISCOUNT",this,this.updateShopDiscount),Vh.isXYX9992()&&(this.btnCopper.visible=this.btnGold.visible=!1)}l(i,"modules.shop.goods.ShopGoodsView",Hh);var e=i.prototype;e.onClick=function(t){if(!((t.target==this.btnCopper||t.target==this.btnGold)&&Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian()||Vh.isShengTian()))switch(t.target){case this.btnCopper:Ae.linkTo(11430);break;case this.btnGold:Vh.isXYX9992()||Ae.linkTo(11454);break;case this.btnAdd:Zi.show(10201114)}},e.updateScoreChange=function(){this.txtScore.text=ie.getScore(2)+""},e.updateGoldChange=function(){this.txtMyGold.text=ie.user.attr.gold+"",this.txtMyCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver)},e.update=function(){if(this.txtMyGold.text=ie.user.attr.gold+"",this.txtMyCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver),this.txtScore.text=ie.getScore(2)+"",this.shopTypeVo=Wh.getShopListById(3),this.shopTypeVo){for(var t,i,e=[],s=0;s<this.shopTypeVo.ShopTypeItemArr.length;s++)e[s]=this.shopTypeVo.ShopTypeItemArr[s];for(var n in e)if(t=e[n],ie.myLevel<t.lv){e.splice(t.id,1);break}for(var h in this.list.dataSource=e)if(0<(i=e[h]).discount){Kh.ins().toShopDiscountInfo(i.typeId);break}}},e.updateShopDiscount=function(t){for(var i=0;i<this.list.cells.length;i++){var e,s=this.list.getCell(i);if(s&&s.getData()&&s.getData().typeId==t.scheme)if(t.has_buy_num==t.can_buy_num)for(var n in this.shopTypeVo.ShopTypeItemArr)(e=this.shopTypeVo.ShopTypeItemArr[n]).typeId==t.scheme&&this.shopTypeVo.ShopTypeItemArr.splice(e.id,1);else s.setDiscount(t.discount),s.setHasBuyTimes(t.has_buy_num),s.setCanBuyTimes(t.can_buy_num),s.update()}this.list.dataSource=this.shopTypeVo.ShopTypeItemArr}}(),function(t){function i(){this._data=null,this.itemVO=null,this.goods=null,this._pGoods=null,i.__super.call(this),this.txtName.style.fontSize=26,this.txtName.width=379,this.txtName.x=132,this.goods=so.createGoodsImage(0,0,null,this.spGoods,!0,!0,105,!0),this.btnBuy.on("click",this,this.onClick),this.goods.on("click",this,this.onClick)}l(i,"modules.shop.mystery.ShopMysteryItem",t);var e=i.prototype;e.confirmBuy=function(){Wh.curMysteryItemBuyID=this._data.id,rh.ins().toExchange(2,4e4+this._data.id,1,null)},e.onClick=function(t){if(this._data)switch(t.currentTarget){case this.btnBuy:if(Ve.send(7,7,"商城-神秘商店-购买"),this.checkCanBuy())if(1==this._data.price_type){var i=ve.getItem(this._data.type_id),e=pe.span("是否花费","#5d3924")+pe.span(this._data.price+"元宝","#F7EF5F")+pe.span("购买"+this._data.num+"个","#5d3924")+pe.span("【"+i.name+"】？",Qi.getColorLight(i.color));es.showSecAlert(e,this,this.confirmBuy,null,"MysteryItemBuy")}else ie.silver>=this._data.price?this.confirmBuy():Zi.show(10201113);break;case this.goods:var s=ve.getItem(this._data.type_id),n="";n=ve.isEquip(this._data.type_id)?"BASE_EQUIP_TIP":"BASE_GOODS_TIP",to.show(s,n)}},e.checkCanBuy=function(){if(this._data){var t=!1;1==this._data.price_type?0==(t=this._data.price<=ie.user.attr.gold)&&es.showAlert():2==this._data.price_type&&0==(t=this._data.price<=ie.user.attr.silver)&&Zi.show(10201113)}return t},e.updateData=function(t){this._data=t,this._data?(this.itemVO=ve.getItem(this._data.type_id),null==this._pGoods&&(this._pGoods=new Object,this._pGoods.className="p_goods"),this._pGoods.typeid=this._data.type_id,null==this._pGoods.equip_info&&(this._pGoods.equip_info=new Object,this._pGoods.equip_info.className="p_equip_info"),this._pGoods.equip_info.extra_attrs=this._data.extra_attr):this.itemVO=null},e.updateView=function(){if(this._data){this.img.skin=1==this._data.price_type?"com/ui/gold.png":"com/ui/copper.png",this.txtGold.text=1==this._data.price_type?this._data.price+"":Rt.getShortenSilverStr(this._data.price),this.offImg.visible=0!=this._data.discount;var t=(1e4-this._data.discount)/1e3;if(5==t?this.offImg.skin="modules/shop/off5.png":8==t&&(this.offImg.skin="modules/shop/off8.png"),this.itemVO){var i=Qi.getColorLight(this.itemVO.color);ve.isEquip(this.itemVO.id)?this.txtName.innerHTML=pe.font(this.itemVO.name+"（"+this.itemVO.title+"）",i,26):this.txtName.innerHTML=pe.font(this.itemVO.name,i,26),this.goods.num=this._data.num}this.goods.data=this.itemVO,this.updateTip()}},e.updateTip=function(){if(this.txtTip.visible=!1,this.arrow.visible=!1,this.itemVO&&this.itemVO instanceof xml.EquipVO){var t=this.itemVO,i=ee.TYPE2POSMAP[t.type],e=ie.getPalByCate(t.category);if(e&&i){var s,n,h=!1,a=0;for(var o in e.equip)n=e.equip[o],-1!=i.indexOf(n.pos)&&(h=!0,s=ve.getItem(n.type_id),a=Math.max(a,t.basePow+te.getAddExtraPower(this._data.extra_attr)-(s.basePow+te.getAddExtraPower(n.extra_attr))));(h&&0<a||!h)&&(this.txtTip.visible=!0,this.arrow.visible=!0),a=h?Math.floor(a):Math.floor(t.basePow+te.getAddExtraPower(this._data.extra_attr)),this.txtTip.text="评分    "+a}}},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this.updateData(t),this.updateView()})}(qh),function(t){function i(){this.nowTime=0,i.__super.call(this),this.list.itemRender=Na.getClass(51e3,"mystery.ShopMysteryItem"),this.on("click",this,this.onClick),this.on("display",this,this.onAdd),this.on("undisplay",this,this.onRemove),this.txtSVIP.style.align="right",Vh.isXYX9992()&&(this.btnCopper.visible=this.btnGold.visible=!1)}l(i,"modules.shop.mystery.ShopMysteryView",Yh);var e=i.prototype;e.update=function(){this.list.dataSource=Wh.mysteryGoods,this.nowTime=Math.max(Wh.reflashTime-Ma.serverTime,0),this.txtTime.text="刷新时间："+Qt.formatTime(this.nowTime),this.txtScore.text=ie.getScore(6)+"",this.txtMyGold.text=ie.user.attr.gold+"",this.txtMyCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver);var t=oo.isSVIP(),i=oo.getPrivilegeUse(2);t&&0<i?(this.imgGold.visible=this.txtCost.visible=!1,this.txtSVIP.visible=!0,this.txtSVIP.innerHTML=pe.span("SVIP","#fff959")+pe.span("免费次数："+i)):(this.imgGold.visible=this.txtCost.visible=!0,this.txtSVIP.visible=!1),(Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian())&&(this.btnGold.visible=this.btnCopper.visible=!1)},e.updateScoreChange=function(){this.txtScore.text=ie.getScore(6)+""},e.updateGoldChange=function(){this.txtMyGold.text=ie.user.attr.gold+"",this.txtMyCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver)},e.onClick=function(t){var i;if(!((t.target==this.btnCopper||t.target==this.btnGold)&&Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian()))switch(t.target){case this.btnCopper:Ae.linkTo(11430);break;case this.btnGold:Vh.isXYX9992()||(Vh.isFanTi?Ae.linkTo(11454,1):Ae.linkTo(11454));break;case this.btnScore:(i=new q).msg="礼券通过神秘商店刷新、购买商品获得",i.showRight=!1,K.showVO(i);break;case this.btnRefresh:if(Ve.send(7,8,"商城-神秘商店-刷新"),this.nowTime=Wh.reflashTime-Ma.serverTime,this.nowTime<=0)return;var e=oo.isSVIP(),s=oo.getPrivilegeUse(2);this.nowTime<=60?((i=new q).msg="还有"+this.nowTime+"秒就要自动刷新了，确定现在刷新吗？",i.showRight=!0,i.yesCaller=Kh.ins(),i.yesFun=Kh.ins().toMysteryReflash,K.showVO(i)):e&&0<s?Kh.ins().toMysteryReflash():20<=ie.gold?es.showSecAlert(pe.span("是否花费","#5d3924")+pe.span("20元宝","#F7EF5F")+pe.span("进行一次刷新？","#5d3924"),Kh.ins(),Kh.ins().toMysteryReflash,null,"mysterf"):es.showAlert()}},e.onAdd=function(t){Kh.ins().toMysteryInfo(),De.addToSecond(this,this.onLoop)},e.onRemove=function(t){De.removeFromSceond(this,this.onLoop)},e.onLoop=function(){this.nowTime=Math.max(Wh.reflashTime-Ma.serverTime,0),this.txtTime.text="刷新时间："+Qt.formatTime(this.nowTime)}}(),function(t){function i(){this._data=null,this.itemVO=null,this.goods=null,i.__super.call(this),this.txtName.width=379,this.txtName.x=132,this.goods=so.createGoodsImage(14,14,null,this,!0,!0,105,!0),this.btnBuy.on("click",this,this.onClick),this.goods.on("click",this,this.onClick)}l(i,"modules.shop.score.ShopScoreItem",t);var e=i.prototype;e.onClick=function(t){switch(t.currentTarget){case this.btnBuy:if(this._data){if(Ve.send(7,9,"商城-礼券商店-购买"),ie.gold<this._data.costArr[1].val)return void io.addTip("元宝不足");if(ie.getScore(6)<this._data.costArr[0].val)return void io.addTip("礼券不足");var i=ve.getItem(this._data.typeId),e=pe.span("是否花费","#5d3924")+pe.span(this._data.costArr[1].val+"元宝","#F7EF5F")+pe.span("和","#5d3924")+pe.span(this._data.costArr[0].val+"礼券","#F7EF5F")+pe.span("购买"+this._data.num+"个","#5d3924")+pe.span("【"+i.name+"】？",Qi.getColorLight(i.color));es.showSecAlert(e,rh.ins(),rh.ins().toExchange,[1,this._data.typeId,1],"ScoreBuy")}break;case this.goods:this.goods.data&&(this.goods.data.tempNum=this.goods.num,to.show(this.itemVO,"BASE_GOODS_TIP"))}},o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(this._data=t,this._data){if(this.itemVO=ve.getItem(this._data.typeId),this.itemVO){var i=Qi.getColorLight(this.itemVO.color),e=""==this._data.desc?"":"（"+this._data.desc+"）";this.txtName.innerHTML=pe.font(this.itemVO.name,i,26)+" "+pe.font(e,"#5d3924",26),this.goods.data=this.itemVO,this.goods.num=this._data.num}this._data.costArr&&(this.txtGold1.text=this._data.costArr[0].val,this.txtGold2.text=this._data.costArr[1].val)}})}(zh),function(t){function i(){this.mysteryView=null,this.scoreView=null,this.goodsView=null,this.cultivationView=null,this.shopEngraveView=null,this.shopBattlefield=null,i.__super.call(this),this.setWindowType("OPEN_CLOSE_OTHERS","MASK_FULL",!0,"TYPE_MAIN"),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.btnClose.on("click",this,this.closeWindow),this.btnBack.on("click",this,this.closeWindow),this.initShopTabs(),Vh.isZKPf9991Server()&&(this.title.skin="modules/shop/title2.png")}l(i,"modules.shop.ShopPanel",Xh);var e=i.prototype;e.initShopTabs=function(){var t=Lh.shopTabLabels;if(0==ji.isDev)for(var i=Lh.SHOP_NEET_HIDE_TAB.length-1;0<=i;i--)t[Lh.SHOP_NEET_HIDE_TAB[i]]&&t.splice(Lh.SHOP_NEET_HIDE_TAB[i],1);Vh.isFanTi;for(var e="",s="",n=0,h=t.length;n<h;n++)n<5?(e+=t[n],n<4&&(e+=",")):(s+=t[n],n<t.length-1&&(s+=","));this.tab.labels=e,this.tabBottom.labels=s,this.tab.selectHandler=new ue(this,this.onSelectTab),this.tabBottom.selectHandler=new ue(this,this.onSelectTabBot),this.onSelect(0)},e.onSelectTab=function(t){var i=this.tab.labels.split(",")[t];-1!=Lh.SHOP_TAB_ITEM_LABELS.indexOf(i)&&(this.onSelect(Lh.SHOP_TAB_ITEM_LABELS.indexOf(i)),this.tabBottom.selectedIndex=-1)},e.onSelectTabBot=function(t){var i=this.tabBottom.labels.split(",");if(5<=t)Lh.SHOP_TAB_ITEM_LABELS[t]&&-1!=i.indexOf(Lh.SHOP_TAB_ITEM_LABELS[t])&&(this.onSelect(t),this.tab.selectedIndex=-1,this.tabBottom.selectedIndex=i.indexOf(Lh.SHOP_TAB_ITEM_LABELS[t]));else{var e=i[t];-1!=Lh.SHOP_TAB_ITEM_LABELS.indexOf(e)&&(this.onSelect(Lh.SHOP_TAB_ITEM_LABELS.indexOf(e)),this.tab.selectedIndex=-1)}},e.onSelect=function(t){if(!(ji.isReview&&0<=Lh.REVIEW_NOT_SHOW_SHOP_TYPE.indexOf(t)||(this.spView.removeChildren(),t<=-1)))switch(Wh.curTabIndex=t){case 0:Ve.send(7,4,"商城-神秘商店"),this.mysteryView=this.mysteryView||Na.getIns(51e3,"mystery.ShopMysteryView"),this.spView.addChild(this.mysteryView),this.mysteryView.update();break;case 1:Ve.send(7,5,"商城-礼券商店"),this.scoreView=this.scoreView||Na.getIns(51e3,"score.ShopScoreView"),this.spView.addChild(this.scoreView),this.scoreView.update();break;case 2:Ve.send(7,6,"商城-道具商店"),this.goodsView=this.goodsView||Na.getIns(51e3,"goods.ShopGoodsView"),this.spView.addChild(this.goodsView),this.goodsView.update();break;case 3:Ve.send(7,7,"商城-修为商店"),this.cultivationView=this.cultivationView||Na.getIns(51e3,"cultivation.ShopCultivationView"),this.spView.addChild(this.cultivationView),this.cultivationView.update(),rh.ins().toRoleExchangeInfo();break;case 4:Ve.send(7,8,"商城-灵石商店"),this.shopEngraveView=this.shopEngraveView||Na.getIns(51e3,"Engrave.ShopEngraveView"),this.spView.addChild(this.shopEngraveView),this.shopEngraveView.update();break;case 5:Ve.send(7,9,"商城-战场商店"),this.shopBattlefield=this.shopBattlefield||Na.getIns(51e3,"battlefield.ShopBattlefieldView"),this.spView.addChild(this.shopBattlefield),this.shopBattlefield.update();break;default:ni.dispatch("SHOP_DEBUG_OPEN_PANEL")}},e.showViewByIndex=function(t){void 0===t&&(t=0),t<5?this.tab.selectedIndex=t:this.onSelectTabBot(t)},e.update=function(){switch(Wh.curTabIndex){case 0:this.mysteryView&&this.mysteryView.update();break;case 1:this.scoreView&&this.scoreView.update();break;case 2:this.goodsView&&this.goodsView.update();break;case 3:this.cultivationView&&this.cultivationView.update();break;case 4:this.shopEngraveView&&this.shopEngraveView.update();break;case 5:this.shopBattlefield&&this.shopBattlefield.update()}},e.updateMoney=function(){0==this.tab.selectedIndex&&this.mysteryView?this.mysteryView.updateGoldChange():1==this.tab.selectedIndex&&this.scoreView?this.scoreView.updateGoldChange():2==this.tab.selectedIndex&&this.goodsView?this.goodsView.updateGoldChange():3==this.tab.selectedIndex&&this.cultivationView?this.cultivationView.updateGoldChange():4==this.tab.selectedIndex&&this.shopEngraveView?this.shopEngraveView.updateGoldChange():5==this.tab.selectedIndex&&this.shopBattlefield&&this.shopBattlefield.updateGoldChange()},e.updateScore=function(){0==this.tab.selectedIndex&&this.mysteryView?this.mysteryView.updateScoreChange():1==this.tab.selectedIndex&&this.scoreView?this.scoreView.updateScoreChange():2==this.tab.selectedIndex&&this.goodsView?this.goodsView.updateScoreChange():3==this.tab.selectedIndex&&this.cultivationView?this.cultivationView.updateScoreChange():4==this.tab.selectedIndex&&this.shopEngraveView?this.shopEngraveView.updateScoreChange():5==this.tab.selectedIndex&&this.shopBattlefield&&this.shopBattlefield.updateScoreChange()},e.onResize=function(){0==ie.isVertical?(this.bg.left=NaN,this.bg.right=NaN,this.bg.width=750,this.bg.centerX=0):(this.bg.width=NaN,this.bg.centerX=NaN,this.bg.left=0,this.bg.right=0)},e.onDisplay=function(){rh.ins().toRoleExchangeInfo()},e.onUnDisplay=function(){this.shopEngraveView&&this.shopEngraveView.resetComboShow()}}(),function(t){function i(){i.__super.call(this),this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(51e3,"score.ShopScoreItem"),this.on("click",this,this.onClick),(Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian())&&(this.btnGold.visible=this.btnCopper.visible=!1),Vh.isXYX9992()&&(this.btnCopper.visible=this.btnGold.visible=!1)}l(i,"modules.shop.score.ShopScoreView",Qh);var e=i.prototype;e.onClick=function(t){if(!(Vh.isJiqiuAndH5yy()||Vh.isHuoWu()||Vh.isShouMeng()||Vh.isShengTian()))switch(t.target){case this.btnCopper:Ae.linkTo(11430);break;case this.btnGold:Vh.isXYX9992()||Ae.linkTo(11454)}},e.updateScoreChange=function(){this.txtScore.text=ie.getScore(6)+""},e.updateGoldChange=function(){this.txtMyGold.text=ie.user.attr.gold+"",this.txtMyCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver)},e.update=function(){this.txtMyGold.text=ie.user.attr.gold+"",this.txtMyCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver);var t=Wh.getShopListById(2);t&&(this.list.dataSource=t.ShopTypeItemArr,this.txtScore.text=ie.getScore(6)+"")}}(),function(t){function e(){var t;this.items=null,this.resultItem=null,this.goods=null,this.chooseGoods=null,this.putInNum=0,this.effArr=null,this.effSucc=null,this.startEffNum=0,e.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_0"),this.txtLink.innerHTML=pe.linkcolor("获得秘籍","",!0,"b0eb5b",26),this.txtLink.on("link",this,this.onLink),this.txtLink.height=50,this.chooseGoods=[],this.items=[];for(var i=0;i<$h.COMPOSE_ITEM_POS.length;i++)(t=new Zh).x=$h.COMPOSE_ITEM_POS[i][0],t.y=$h.COMPOSE_ITEM_POS[i][1],t.state=1,t.on("click",this,this.onItemClick),this.addChild(t),this.items.push(t);this.resultItem=new Zh,this.resultItem.pos(521,150),this.resultItem.state=5,this.addChild(this.resultItem),this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(52e3,"book.SkillBookListItem"),this.list.selectEnable=!0,this.list.selectHandler=ue.create(this,this.onSelected),this.on("click",this,this.onClick),this.on("undisplay",this,this.onRemove)}l(e,"modules.skill.book.SkillBookComposePanel",Jh);var i=e.prototype;i.onLink=function(t){Zi.show(sa.getSkillBookID())},i.showEffStart=function(){if(this.startEffNum=0,!this.effArr){var t;this.effArr=[];for(var i=0;i<$h.COMPOSE_ITEM_POS.length;i++)(t=ut.getOne()).setEndHandler(ue.create(this,this.StartEffEnd)),t.pos($h.COMPOSE_ITEM_POS[i][0]+55,$h.COMPOSE_ITEM_POS[i][1]+50),this.addChild(t),this.effArr.push(t)}for(i=0;i<$h.COMPOSE_ITEM_POS.length;i++)(t=this.effArr[i])&&(this.startEffNum++,t.loadAndPlay("moduleEffect/skill_book_hecheng1"))},i.StartEffEnd=function(){if(this.startEffNum--,0==this.startEffNum){var t,i=[];for(var e in this.chooseGoods)t=this.chooseGoods[e],i.push(t.typeid);jh.ins().toCompose(i)}},i.showEffSucc=function(){for(var t in this.items)this.items[t].data=null;this.effSucc||(this.effSucc=ut.getOne(),this.effSucc.pos(575,200),this.addChild(this.effSucc)),this.effSucc.loadAndPlay("moduleEffect/skill_book_hecheng2")},i.onSelected=function(t){this.resultItem.data=null;var i=this.goods[t];if(i){var e=sa.getBookVO(i.typeid);if(e&&6<=e.color)return void io.addTip("圣级秘籍不参与合成");for(var s=0;s<this.items.length;s++)if(null==this.items[s].data)return void this.putInItem(s,i);io.addTip("合成区秘籍已满")}},i.putInItem=function(t,i){if(this.chooseGoods[t]=i){var e;this.putInNum+=1;for(var s=0;s<this.goods.length;s++)if((e=this.goods[s]).typeid==i.typeid){1<e.current_num?e.current_num-=1:this.goods.splice(s,1);break}}this.updateInside()},i.putOutItem=function(t){var i=this.chooseGoods[t];if(i){var e;this.putInNum-=1;for(var s=0;s<this.goods.length;s++)if((e=this.goods[s]).typeid==i.typeid)return e.current_num+=1,this.chooseGoods[t]=null,void this.updateInside();i.current_num=1,this.goods.push(i),this.chooseGoods[t]=null,this.callLater(this.updateInside)}},i.updateInside=function(){for(var t=0;t<this.items.length;t++)this.chooseGoods[t]?this.items[t].data=sa.getBookVO(this.chooseGoods[t].typeid):this.items[t].data=null;this.txtNon.visible=!(0<this.goods.length),this.list.dataSource=this.goods,3==this.putInNum?this.txtMsg.text="（"+sa.getComposeTip(this.getKeyStr())+"）":this.txtMsg.text="消耗三本已有秘籍随机合成一本新秘籍"},i.getKeyStr=function(){var t,i=[];for(var e in this.chooseGoods)t=this.chooseGoods[e],i.push(ve.getItem(t.typeid).color);return i.sort(),i.join()},i.update=function(){this.reset(),this.updateInside()},i.updateByCompose=function(){sa.composeReward&&0<sa.composeReward.length&&(this.update(),this.resultItem.data=sa.getBookVO(sa.composeReward[0].id),this.showEffSucc())},i.reset=function(){for(var t in this.items)this.items[t].data=null;this.resultItem.data=null,this.putInNum=0,this.chooseGoods=[],this.goods=Ze.getGoodsByType(110),this.checkConfigure()},i.checkConfigure=function(){for(var t=0;t<this.goods.length;t++)sa.getBookVO(this.goods[t].typeid)||(this.goods.splice(t,1),t--)},i.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow();break;case this.btn:3==this.putInNum?this.showEffStart():io.addTip("需放入三本秘籍才可合成")}},i.onItemClick=function(t){var i=t.currentTarget;i&&i.data&&this.putOutItem(this.items.indexOf(i))},i.onRemove=function(){for(var t=0;t<this.items.length;t++)this.putOutItem(t)},i.openWindow=function(t,i){void 0===i&&(i=!1),sa.isCompose=!0,laya.ui.View.prototype.openWindow.call(this),this.update()}}(),function(t){function i(){this._vo=null,this._data=null,i.__super.call(this)}l(i,"modules.skill.book.SkillBookLearnItem",t);var e=i.prototype;o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._vo=null,this._data=t,this._data&&(this._vo=sa.getBookVO(this._data.typeid),this.txtNum.visible=!0,this.txtNum.text=this._data.current_num+""),this._vo?(this.txtName.text=this._vo.name,this.txtName.color=Qi.COLORS_LIGHT[this._vo.color],this.img.skin=this._vo.url):this.img.skin=""}),o(0,e,"vo",function(){return this._vo}),o(0,e,"select",null,function(t){this.imgSelect.visible=t})}(ta),function(t){function i(){this.goods=null,this.curIndex=0,this.curChooseVO=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_0"),this.txtLink.innerHTML=pe.linkcolor("获得秘籍","",!0,"b0eb5b",26),this.txtLink.on("link",this,this.onLink),this.txtLink.height=50,this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(52e3,"book.SkillBookLearnItem"),this.list.selectEnable=!0,this.list.selectHandler=ue.create(this,this.onSelected),this.list.renderHandler=ue.create(this,this.onRenderItem),this.on("click",this,this.onClick)}l(i,"modules.skill.book.SkillBookLearnPanel",ia);var e=i.prototype;e.onLink=function(t){Ae.linkTo(10502),this.closeWindow()},e.onSelected=function(t){this.curIndex=t,this.list.refresh(),this.resetItem();var i=this.list.getItem(t);i&&(this.curChooseVO=sa.getBookVO(i.typeid),this.curChooseVO&&(this.imgLeft.skin=this.curChooseVO.url,this.txtName.text=this.curChooseVO.name,this.txtName.color=Qi.COLORS_DARK[this.curChooseVO.color],this.txtMsg.text=this.curChooseVO.msg))},e.onRenderItem=function(t,i){void 0===i&&(i=0),t&&(i==this.curIndex?t.select=!0:t.select=!1)},e.resetItem=function(){this.curChooseVO=null,this.imgLeft.skin="",this.txtName.text="",this.txtMsg.text=""},e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow();break;case this.btn:this.curChooseVO?sa.isLearned(oa.curPalID,this.curChooseVO.id)?io.addTip("你已学习该类秘籍，可在秘籍界面点已学秘籍进行替换"):(this.closeWindow(),jh.ins().toLoad(oa.curPalID,sa.curItemPos,this.curChooseVO.id)):io.addTip("请选择秘籍")}},e.update=function(){this.goods=Ze.getGoodsByType(110);for(var t=0;t<this.goods.length;t++)sa.isLearned(oa.curPalID,this.goods[t].typeid)&&(this.goods.splice(t,1),t--);this.list.dataSource=this.goods},e.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this),this.update(),this.list.selectedIndex=0}}(),function(t){function i(){this._vo=null,this._data=null,i.__super.call(this)}l(i,"modules.skill.book.SkillBookListItem",t);var e=i.prototype;return o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(this._vo=null,this._data=t,this.gray=!1,this._data&&(this._data instanceof xml.SkillBookVO?this._vo=t:"p_goods"==this._data.className&&(this._vo=sa.getBookVO(this._data.typeid),this.txtNum.visible=!0,this.txtNum.text=this._data.current_num+"")),this._vo){this.txtName.text=this._vo.name,this.txtName.color=Qi.COLORS_LIGHT[this._vo.color],this.img.skin=this._vo.url;var i=sa.getCurPosBook();if(i)sa.getBookVO(i.type_id);6<=this._vo.color&&sa.isCompose&&(this.gray=!0)}else this.img.skin=""}),o(0,e,"vo",function(){return this._vo}),o(0,e,"select",null,function(t){this.imgSelect.visible=t}),i}(ea));(function(t){function i(){this.goods=null,this.curIndex=0,this.curChooseVO=null,this.nowVO=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_0"),this.txtLink.innerHTML=pe.linkcolor("获得秘籍","",!0,"b0eb5b",26),this.txtLink.on("link",this,this.onLink),this.txtLink.height=50,this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(52e3,"book.SkillBookReplaceItem"),this.list.selectEnable=!0,this.list.selectHandler=ue.create(this,this.onSelected),this.list.renderHandler=ue.create(this,this.onRenderItem),this.on("click",this,this.onClick)}l(i,"modules.skill.book.SkillBookReplacePanel",na);var e=i.prototype;e.onLink=function(t){Ae.linkTo(10502),this.closeWindow()},e.onSelected=function(t){this.curIndex=t,this.list.refresh(),this.resetItemRight();var i=this.list.getItem(t);i&&(this.curChooseVO=sa.getBookVO(i.typeid),this.curChooseVO&&(this.imgRight.skin=this.curChooseVO.url,this.txtName2.text=this.curChooseVO.name,this.txtName2.color=Qi.COLORS_DARK[this.curChooseVO.color],this.txtMsg2.text=this.curChooseVO.msg))},e.onRenderItem=function(t,i){void 0===i&&(i=0),t&&(i==this.curIndex?t.select=!0:t.select=!1)},e.resetItemRight=function(){this.curChooseVO=null,this.imgRight.skin="",this.txtName2.text="",this.txtMsg2.text=""},e.resetItemLeft=function(){this.nowVO=null,this.imgLeft.skin="",this.txtName1.text="",this.txtMsg1.text=""},e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow();break;case this.btn:this.curChooseVO?this.checkReplace():io.addTip("请选择秘籍")}},e.checkReplace=function(){if(this.nowVO&&this.curChooseVO){var t=new q;t.align="center";var i=pe.span("《"+this.curChooseVO.name+"》将替换已学秘籍《"+this.nowVO.name+"》","#5d3924",26)+"<br/>"+pe.span("是否继续？","#5d3924",26)+"<br/>"+pe.span("（被替换的已学秘籍将被遗忘）","#5d3924",26);t.msg=i,t.yesFun=this.checkColor,t.yesCaller=this,t.showRight=!0,K.showVO(t)}},e.checkColor=function(){if(this.nowVO&&this.curChooseVO&&this.nowVO.color>this.curChooseVO.color){var t=new q;t.align="center";var i=pe.span("已学秘籍《"+this.nowVO.name+"》品质较高","#5d3924",26)+"<br/>"+pe.span(Da.getHtmlSpaceStr(8)+"确定替换吗？","#5d3924",26)+"<br/>"+pe.span(Da.getHtmlSpaceStr(2)+"被替换的已学秘籍将被遗忘","#5d3924",26);t.msg=i,t.yesCaller=jh.ins(),t.yesFun=jh.ins().toLoad,t.yesArgs=[oa.curPalID,sa.curItemPos,this.curChooseVO.id],t.showRight=!0,K.showVO(t)}else this.curChooseVO&&jh.ins().toLoad(oa.curPalID,sa.curItemPos,this.curChooseVO.id)},e.update=function(){this.goods=Ze.getGoodsByType(110),this.resetItemLeft();var t=sa.getCurPosBook();if(t&&(this.nowVO=sa.getBookVO(t.type_id),this.nowVO)){if(this.imgLeft.skin=this.nowVO.url,this.txtName1.text=this.nowVO.name,this.txtName1.color=Qi.COLORS_DARK[this.nowVO.color],this.txtMsg1.text=this.nowVO.msg,0<this.goods.length)for(var i,e=!1,s=0;s<this.goods.length;s++)(i=sa.getBookVO(this.goods[s].typeid))&&(e=sa.checkBookFit(this.nowVO,i)),i&&e||(this.goods.splice(s,1),s--);0<this.goods.length?this.txtNon.visible=!1:this.txtNon.visible=!0}this.list.dataSource=this.goods},e.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this),this.update(),this.list.selectedIndex=0}})(),function(t){function i(){this.items=null,this.curItem=null,i.__super.call(this),this.initItems(),this.txtLink.color="#96f254",this.txtLink.fontSize=26,this.txtLink.text="秘籍合成",this.txtLink.underline=!0,this.txtLink.on("click",this,this.onLink),this.txtLink.height=50,this.on("click",this,this.onClick),this.on("display",this,this.onAdd)}l(i,"modules.skill.book.SkillBookView",ha);var e=i.prototype;e.initItems=function(){var t;this.items=[];for(var i=0;i<9;i++)(t=new Zh).x=$h.BOOK_ITEM_POS[i][0],t.y=$h.BOOK_ITEM_POS[i][1],t.itemPos=i+1,this.addChild(t),this.items.push(t),8!=i&&Re.ins().register(t,this,500,this.longClick,[i+1],this.onItemClick,[i])},e.longClick=function(t){var i=sa.getBookInfo(oa.curPalID,t);if(i){var e=new Object;e.className="p_goods",e.typeid=i.type_id,e.current_num=1,to.show(e,Ze.getItemToolTipType(e.typeid))}},e.update=function(){this.updateItems(),this.updateChoose(),this.txtTip.text=sa.getTip(sa.getOpenNum(oa.curPalID)),this.checkRedPoint()},e.checkRedPoint=function(){for(var t=0;t<ie.pals.length;t++){1==sa.checkSkillBookRP(t)?an.show("RP_SKILL_BOOK_"+t):an.hide("RP_SKILL_BOOK_"+t)}for(var i,e,s=oa.curPalID,n=Ze.getGoodsByType(110),h=0;h<this.items.length;h++)if(h!=this.items.length-1&&sa.getOpenNum(oa.curPalID)>h)if(an.register("RP_SKILL_BOOK_REPLACE"+h,this.items[h],new Hs(18,-12)),an.hide("RP_SKILL_BOOK_REPLACE"+h),i=sa.getBookInfo(s,h+1)){var a;for(var o in e=sa.getBookVO(i.type_id),n){a=n[o];var r=sa.getBookVO(a.typeid);if(r&&r.type==e.type){if(sa.checkBookFit(e,r)){an.show("RP_SKILL_BOOK_REPLACE"+h);break}an.hide("RP_SKILL_BOOK_REPLACE"+h)}}}else{var l;for(var c in n){if(l=n[c],sa.getBookVO(l.typeid)){if(!sa.isLearned(s,l.typeid)){an.show("RP_SKILL_BOOK_REPLACE"+h);break}an.hide("RP_SKILL_BOOK_REPLACE"+h)}}}},e.updateItems=function(){for(var t,i,e,s=oa.curPalID,n=0,h=0;h<this.items.length;h++)t=this.items[h],h!=this.items.length-1?sa.getOpenNum(oa.curPalID)>h?(t.state=1,(i=sa.getBookInfo(s,h+1))?(e=sa.getBookVO(i.type_id),n+=(t.data=e).power):t.data=null):t.state=2:t.state=3;this.updatePower(n)},e.updatePower=function(t){var i,e=Rt.numToTexture(t,"com/ui/powerNum");this.spPow.graphics.clear();for(var s=0;s<e.length;s++)i=e[s],this.spPow.graphics.drawTexture(i,i.width*s)},e.updateChoose=function(){this.curItem&&1==this.curItem.state?(this.btnEnable=!0,sa.getPosBook(oa.curPalID,this.curItem.itemPos)?this.btn.label="替换":this.btn.label="学习"):(this.btn.label="学习",this.btnEnable=!1)},e.onLink=function(t){Ve.send(6,3,"技能-秘籍-秘籍合成链接"),jh.ins().openComposePanel()},e.onItemClick=function(t){this.chooseItem(t)},e.chooseItem=function(t){this.curItem&&(this.curItem.select=!1),this.curItem=this.items[t],this.curItem&&(this.curItem.select=!0),sa.curItemPos=t+1,this.updateChoose()},e.onAdd=function(t){this.chooseItem(0),jh.ins().toInfo()},e.onClick=function(t){var i,e,s=!1;switch(t.target){case this.btn:if("替换"==this.btn.label)jh.ins().openReplacePanel();else if("学习"==this.btn.label){i=Ze.getGoodsByType(110);for(var n=0;n<i.length;n++)(e=sa.getBookVO(i[n].typeid))&&(s=sa.isLearned(oa.curPalID,i[n].typeid)),e&&!s||(i.splice(n,1),n--);0<i.length?jh.ins().openLearnPanel():Zi.show(sa.getSkillBookID())}break;case this.imgBook:Ve.send(6,2,"技能-秘籍-图鉴功能入口按钮"),jh.ins().openHandBookPanel()}},o(0,e,"btnEnable",null,function(t){this.btn.mouseEnabled=t,this.btn.gray=!t})}(),function(t){function i(){this.curIndex=0,this.curChooseVO=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_0"),this.txtLink.innerHTML=pe.linkcolor("获得秘籍","",!0,"b0eb5b",26),this.txtLink.on("link",this,this.onLink),this.txtLink.height=50,this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(52e3,"book.SkillBookListItem"),this.list.selectEnable=!0,this.list.selectHandler=ue.create(this,this.onSelected),this.list.renderHandler=ue.create(this,this.onRenderItem),this.on("click",this,this.onClick)}l(i,"modules.skill.book.SkillHandBookPanel",aa);var e=i.prototype;e.onLink=function(t){Ae.linkTo(10502),this.closeWindow()},e.onSelected=function(t){this.curIndex=t,this.list.getItem(t)&&(this.list.refresh(),this.curChooseVO=this.list.getItem(t),this.imgLeft.skin=this.curChooseVO.url,this.txtName.text=this.curChooseVO.name,this.txtName.color=Qi.COLORS_DARK[this.curChooseVO.color],this.txtMsg.text=this.curChooseVO.msg)},e.onRenderItem=function(t,i){void 0===i&&(i=0),t&&(i==this.curIndex?t.select=!0:t.select=!1)},e.onClick=function(t){switch(t.target){case this.btnBack:case this.btnClose:this.closeWindow()}},e.update=function(){this.list.dataSource=sa.getAllBookVOs()},e.openWindow=function(t,i){void 0===i&&(i=!1),sa.isCompose=!1,laya.ui.View.prototype.openWindow.call(this),this.update(),this.list.selectedIndex=0}}(),function(t){function i(){this.selectedVO=null,this.selectIndex=0,this.palSkill=null,this.num=null,this.imgs=null,i.__super.call(this),this.num=["零","一","二","三","四","五"],this.imgs=[this.img1,this.img2,this.img3,this.img4,this.img5],this.btn.on("click",this,this.onClickBtn);for(var t=0;t<this.imgs.length;t++)this.imgs[t].on("click",this,this.onClick);this.goodsNumTxt.style.fontSize=26,this.goodsNumTxt.style.color="#e3e3e3",this.goodsNumTxt.style.align="center",this.getGoods.on("click",this,this.onClickLink),this.compoundBtn.on("click",this,this.onClickCompound)}l(i,"modules.skill.SkillStepView",ra);var e=i.prototype;e.onClickCompound=function(){0<Math.floor(Ze.getGoodsNumByTypeID(12000001)/30)?rh.ins().toExchange(10,50001,1):io.addTip("道具数量不足")},e.onClickLink=function(){Ae.linkTo(10503)},e.update=function(){if(0<=oa.curHeadIndex){var t=ie.getPalByIndex(oa.curHeadIndex);if(null==t)return;var i=t.skills;if(null==i)return;var e,s=ie.getTypePowerByIndex(oa.curHeadIndex,1902),n=Rt.numToTexture(s,"com/ui/powerNum");this.spPow.graphics.clear();for(var h=0;h<n.length;h++)e=n[h],this.spPow.graphics.drawTexture(e,e.width*h);this.palSkill=this.filterSkill(i),this.palSkill.sort(this.sortSkillByID);for(var a=0;a<5;a++){var o=this.palSkill[a];this["icon"+a].skin="modules/skill/10"+t.ext.category+"0000"+(a+1)+".png";var r=oa.getSkill(parseInt("10"+t.ext.category+"0000"+(a+1)));this["skillname"+a].text=r.name,a<this.palSkill.length?(this["icon"+a].gray=!1,this["skillStep"+a].text=this.num[o.skill_step]+"阶",this["rp"+a].visible=oa.chekSkillStepRPBySkill(o)):(this["icon"+a].gray=!0,this["skillStep"+a].text=5*a+"级解锁",this["rp"+a].visible=!1)}this.onSelectSkill(this.selectIndex)}var l=Ze.getGoodsNumByTypeID(12000001);this.goodsNumTxt.innerHTML=pe.font(l.toString(),30<=l?"#e3e3e3":"#b60202",26)+"/30",this.rpCompound.visible=30<=l,this.checkRedPoint()},e.filterSkill=function(t){for(var i=[],e=0;e<t.length;e++){var s=t[e];null!=oa.getSkill(s.skill_id)&&i.push(s)}return i},e.checkRedPoint=function(){for(var t=0;t<ie.pals.length;t++){1==oa.checkSkillStepRP(t)?an.show("RP_SKILL_STEP_"+t):an.hide("RP_SKILL_STEP_"+t)}},e.onClick=function(t){var i=this.imgs.indexOf(t.target);null!=this.palSkill&&i<this.palSkill.length&&(this.selectedImg.y=t.target.y-12,this.onSelectSkill(i))},e.onSelectSkill=function(t){this.selectIndex=t;var i=this.palSkill[t];if(null!=i){this.curInfo.text="当前："+this.num[i.skill_step]+"阶";var e=oa.getStepVO(i.skill_id,i.skill_step+1);if(null!=e){var s=Ze.getGoodsNumByTypeID(e.book);this.cost.color=s>=e.bookNum?"#e3e3e3":"#b60202",this.cost.text=ve.getItem(e.book).name+"×"+e.bookNum}for(var n=oa.getSteps(i.skill_id),h=0;h<n.length;h++){var a=n[h];this["desc"+h].text=a.desc,this["select"+h].visible=i.skill_step>=a.step}}},e.onClickBtn=function(){var t=ie.getPalByIndex(oa.curHeadIndex);if(null!=t){var i=this.palSkill[this.selectIndex].skill_id,e=new Object;e.className="m_pal_skill_stepup_tos",e.pal_id=t.pal_id,e.skill_id=i,Nt.send(e)}},e.sortSkillByID=function(t,i){return t.skill_id<i.skill_id?-1:t.skill_id>i.skill_id?1:0}}(),function(t){function e(){this.palSkill=null,this.selectIndex=0,this.temlv=null,this.minCost=0,e.__super.call(this),this.btn.on("click",this,this.onClickBtn),this.btnAll.on("click",this,this.onClickAll);for(var t=0;t<5;t++){var i=this["icon"+t];i.mouseEnabled=!0,i.on("click",this,this.onClickItem)}this.on("display",this,this.onDisplay)}l(e,"modules.skill.SkillView",la);var i=e.prototype;i.onDisplay=function(){le.nextStep==le.CLICK_SKILL_UP&&le.showStep(le.CLICK_SKILL_UP,this.btnAll)},i.update=function(){if(0<=oa.curHeadIndex){var t=ie.getPalByIndex(oa.curHeadIndex);if(null==t)return;var i=t.skills;if(null==i)return;this.palSkill=this.filterSkill(i),this.palSkill.sort(this.sortSkillByID);for(var e=!0,s=!0,n=0;n<5;n++){var h=this.palSkill[n];if(this["icon"+n].skin="modules/skill/10"+t.ext.category+"0000"+(n+1)+".png",n<this.palSkill.length){this["icon"+n].gray=!1;var a=oa.getSkill(h.skill_id);this["skill"+n].text=a.name,this["lv"+n].text=h.skill_lv}else this["icon"+n].gray=!0,this["skill"+n].text=5*n+"级解锁",this["lv"+n].text="";1==e&&(null==h||h.skill_lv<120)?s=e=!1:1==s&&(null==h||h.skill_lv<200)&&(s=!1)}this.onSelectSkill(this.selectIndex),this.checkRedPoint(),this.resetGoalTxt(e,s)}},i.filterSkill=function(t){for(var i=[],e=0;e<t.length;e++){var s=t[e];null!=oa.getSkill(s.skill_id)&&i.push(s)}return i},i.checkRedPoint=function(){for(var t=0;t<ie.pals.length;t++){1==oa.checkSkillLevelRP(t)?an.show("RP_SKILL_LEVEL_"+t):an.hide("RP_SKILL_LEVEL_"+t)}},i.onClickItem=function(t){var i=t.target.name,e=Number(i.substr(4,1));e<this.palSkill.length&&this.onSelectSkill(e)},i.onSelectSkill=function(t){this.selectIndex=t;var i=this.palSkill[t];if(null!=i){this.selectedImg.x=this["icon"+t].x-10;var e=oa.getSkill(i.skill_id),s=Math.min(i.skill_lv+1,999);this.desc.text=e.desc.replace("{n}",e.change+(e.attr+e.attrStep*i.skill_lv)),this.curTxt.text="Lv."+i.skill_lv+"\n"+e.change+(e.attr+e.attrStep*i.skill_lv),this.nextTxt.text="Lv."+s+"\n"+e.change+(e.attr+e.attrStep*s);var n=ie.silver,h=e.moneyStep*s+e.money,a=this.getAllNeedMoney();this.txtCost.color=h<=n?"#e1c6bc":"#ff4949",this.txtCostAll.color=n>=this.minCost?"#e1c6bc":"#ff4949",this.txtCost.text=(e.moneyStep*s+e.money).toString(),this.txtCostAll.text=0==a?this.minCost.toString():a.toString()}},i.onClickAll=function(){if(Ct.send(29022),ie.silver>=parseFloat(this.txtCostAll.text)){var t=ie.getPalByIndex(oa.curHeadIndex);if(null!=t){var i=new Object;i.className="m_pal_skill_levelup_tos",i.pal_id=t.pal_id,i.skill_id=0,Nt.send(i)}}else Zi.show(10201113)},i.onClickBtn=function(){if(Ct.send(29022),ie.silver>=parseFloat(this.txtCost.text)){Ve.send(26,3,"技能-技能-升级按钮");var t=ie.getPalByIndex(oa.curHeadIndex);if(null!=t){var i=this.palSkill[this.selectIndex].skill_id,e=new Object;e.className="m_pal_skill_levelup_tos",e.pal_id=t.pal_id,e.skill_id=i,Nt.send(e)}}else Zi.show(10201113)},i.getAllNeedMoney=function(){var t=0;this.minCost=0;var i,e=ie.silver;this.temlv=new Object;for(var s=0;s<this.palSkill.length;s++)this.temlv[this.palSkill[s].skill_id]=this.palSkill[s].skill_lv;for(var n=0;null!=(i=this.getUpgradeSkill());){var h=oa.getSkill(i.skill_id);n=this.temlv[h.id]+1;var a=h.moneyStep*n+h.money;if(0==this.minCost&&(this.minCost=a),!(t+a<=e))break;t+=a,this.temlv[h.id]=n}return t},i.getUpgradeSkill=function(){if(0<this.palSkill.length){for(var t,i,e=ie.myLevel,s=ie.user.attr.regrow,n=0,h=0;h<this.palSkill.length;h++)i=this.palSkill[h],(n=this.temlv[i.skill_id])<100&&e<=n||100<=n&&10*s+100<=n||(null==t?t=i:n<this.temlv[t.skill_id]?t=i:i.skill_id<t.skill_id&&(t=i));return t}return null},i.sortSkillByID=function(t,i){return t.skill_id<i.skill_id?-1:t.skill_id>i.skill_id?1:0},i.resetGoalTxt=function(t,i){t?(this.goal1.color="#96f254",this.goal1.text="√职业技能全部达到120级后，所有技能附加伤害增加10000点"):(this.goal1.color="#e1c6bc",this.goal1.text="职业技能全部达到120级后，所有技能附加伤害增加10000点"),i?(this.goal2.color="#96f254",this.goal2.text="√职业技能全部达到200级后，所有技能伤害提高5%"):(this.goal2.color="#e1c6bc",this.goal2.text="职业技能全部达到200级后，所有技能伤害提高5%")}}(),function(t){function i(){this.curIndex=0,this.steps=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_8",!0),this.on("click",this,this.onClick),this.txtInfo.style.color="#f4f1b2",this.txtInfo.style.fontSize=24,this.txtInfo.style.lineHeight=28,this.on("undisplay",this,this.onUndisplay),this.on("display",this,this.onDisplay)}l(i,"modules.story.StoryView",Va);var e=i.prototype;e.onDisplay=function(){Dh.isAutoHit&&ni.dispatch("AUTO_HIT")},e.onUndisplay=function(){(this.curIndex=0)==Dh.isAutoHit&&ni.dispatch("AUTO_HIT"),2==Oa.curStoryType&&ni.dispatch("STORY_SHOW_CALL_BACK"),Oa.curStoryType=0},e.onClick=function(){this.showNext()},e.showNext=function(){if(this.steps&&this.curIndex<this.steps.length){var t=this.steps[this.curIndex];this.curIndex++;var i="";if(t){if(1==t.speakerType)this.imgNpc.visible=!0,this.imgMy.visible=!1,1==t.urlPathType&&(this.imgNpc.skin="modules/biographyCard/img/"+t.urlPath+".png"),i=pe.font(t.speakerName+"：","#7fd6fe");else if(2==t.speakerType){this.imgNpc.visible=!1,this.imgMy.visible=!0;var e=ie.roleName.split("区-");i=pe.font(e[1]+"：","#7fd6fe");var s=ie.getPal(ie.mainPalID);this.imgMy.skin=s?"modules/story/speaker/"+s.ext.category+s.ext.sex+".png":"modules/story/speaker/11.png"}this.txtInfo.innerHTML=i+t.info}}else Pa.ins().closeStoryView()},e.update=function(t){this.curIndex=0,t&&(this.steps=t,this.showNext())}}(),function(t){function i(){this._data=null,i.__super.call(this)}l(i,"modules.role.wings.RoleEquipListItem",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.imgGoods.on("click",this,this.onClick)},e.onClick=function(){this._data?to.show(this._data,Ze.getItemToolTipType(this._data.typeid)):io.addTip("该部位没有装备哦")},o(0,e,"data",null,function(t){if(this._data=t){var i=ve.getItem(t.typeid);this.imgGoods.skin=i.realMaxico,this.imgBg.skin="com/ui/goodsBgs"+i.color+".png",this.txtName.text=i.title,this.txtName.color=Qi.COLORS_LIGHT[i.color];var e=i.basePow,s=t.equip_info.extra_attrs;s&&(e+=te.getAddExtraPower(s)),this.txtNeed.text="需求：羽翼达到"+i.level+"阶",this.txtScore.text="评分："+Math.floor(e)}})}(Zn),function(s){function t(){this.equipItems=null,this.heads=null,this._curVO=null,this.curXMLVO=null,this.curStarXMLVO=null,this.itemArr=null,this._curLv=0,t.__super.call(this)}l(t,"modules.role.wings.RoleWingEquipView",s);var i=t.prototype;i.createChildren=function(){s.prototype.createChildren.call(this),this.heads=new hh,this.heads.on("RoleHeadsPart.CHOOSE",this,this.onHeadItemClick),this.heads.y=82,this.heads.x=106,this.box.addChild(this.heads),this.setWindowType("OPEN_COMMON","MASK_FULL");var t,i=ee.WINGSPUT2TYPEMAP.length;this.equipItems=[];for(var e=0;e<i;e++)(t=new Th).date=null,t.x=140*e,t.y=0,t.putWhere=e+1,t.type=ee.WINGSPUT2TYPEMAP[e],this.spEquips.addChild(t),this.equipItems.push(t);for(e=0;e<4;e++)an.register("RP_WING_EQUIP_"+e,this.heads.getItem(e),new Hs(39,10));this.on("click",this,this.onClick)},i.onHeadItemClick=function(t){0<=t&&this.updateView()},i.onClick=function(t){switch(t.target){case this.btnClose:case this.btnReturn:this.closeWindow();break;case this.btnChange:if(this._curVO){var i=Ze.getBetterWingEquipCanEquip(this._curVO);0<i.length?rh.ins().toRoleWingLoad(this._curVO.pal_id,i):io.addTip("没有可替换的装备！")}else io.addTip("羽翼数据错误");break;default:var e;t.target instanceof modules.role.view.wings.RoleWingEquipItem&&((e=t.target).date?to.show(e.date,Ze.getItemToolTipType(e.date.type_id)):io.addTip("该部位没有装备哦"))}},i.updateWingEff=function(t){this._curLv!=t&&(this.imgWing.skin=oh.getWingXMLVO(t).path,this.imgWing.x=oh.getWingXMLVO(t).x,this.imgWing.y=oh.getWingXMLVO(t).y,this._curLv=t)},i.updateView=function(){if(this.checkHeadRp(),this._curVO=oh.getWingTOCVO(this.heads.index),this._curVO){var t;this.curXMLVO=oh.getWingXMLVO(this._curVO.level),this.curStarXMLVO=this.curXMLVO.WingStarDic[this._curVO.star],this.txtWings.text=this.curXMLVO.name,this.updateWingEff(this._curVO.level);var i,e,s=!1,n=Ze.getEquipData()?Ze.getEquipData().goods:[],h=NaN,a=0;for(var o in this.equipItems){var r;for(var l in e=this.equipItems[o],this._curVO.equips)if(r=this._curVO.equips[l],t=ve.getItem(r.type_id),e.type==t.type){e.date=r,s=!0;break}s?(s=!1,h=t.basePow+te.getAddExtraPower(e.date.extra_attr)):(e.date=null,h=0);var c,d=!1;for(var u in n)if(c=n[u],(i=ve.getItem(c.typeid)).type==e.type&&i.level<=this._curVO.level&&h<i.basePow+te.getAddExtraPower(c.equip_info.extra_attrs)){d=!0,a++;break}e.imgRp.visible=d}this.changeRp.visible=0!=a;var p=Ze.getBetterWingEquipCantEquip(this._curVO);this.itemArr=this.itemArr||[];for(var m=Math.max(p.length,this.itemArr.length),f=0;f<m;f++)f<p.length?(this.itemArr[f]=this.itemArr[f]||Na.getIns(47e3,"wings.RoleEquipListItem"),this.itemArr[f].data=p[f],this.itemArr[f].y=120*f,this.panItems.addChild(this.itemArr[f])):this.itemArr[f]&&this.itemArr[f].removeSelf();this.panItems.visible=0!=p.length,this.btnChange.y=0==p.length?684:840}else rh.ins().toRoleWingInfo(this.heads.index+1)},i.checkHeadRp=function(){for(var t=0;t<4;t++)oh.getWingTOCVO(t)&&Ze.checkHasBetterWingEquipCanEquip(oh.getWingTOCVO(t))?an.show("RP_WING_EQUIP_"+t):an.hide("RP_WING_EQUIP_"+t)},i.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this,t,i),this._curLv=0,this.parent&&(this.heads.resetSelect(oh.curActorIndex),this.updateView())}}(Ch),function(t){function i(){this.items=null,this.curAttrKeys=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.initItem(),this.on("click",this,this.onClick)}l(i,"modules.title.TitleAllAttrPanel",Ka);var e=i.prototype;e.initItem=function(){var t;this.items=this.items||[];for(var i=190,e=0;e<8;e++)(t=Na.getIns(57e3,"TitleAttrItem")).x=155,t.y=i,i+=t.height+5,this.addChild(t),this.items.push(t)},e.onClick=function(t){switch(t.target){case this.btnBack:this.closeWindow();break;case this.btnChange:this.change()}},e.update=function(){this.txtPower.text=ja.getHasTitlePower()+"";for(var t=0;t<this.items.length;t++)this.items[t].data=ja.getHasAttrVal(this.curAttrKeys[t])},e.change=function(){switch(this.btnChange.label){case"特殊属性":this.curAttrKeys=Ya.TITLE_ALL_ATTR_KEYS[1],this.btnChange.label="基础属性";break;case"基础属性":this.curAttrKeys=Ya.TITLE_ALL_ATTR_KEYS[0],this.btnChange.label="特殊属性"}this.update()},e.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this),this.btnChange.label="特殊属性",this.curAttrKeys=Ya.TITLE_ALL_ATTR_KEYS[0],this.update()}}(),function(t){function i(){i.__super.call(this)}l(i,"modules.title.TitleAttrItem",qa),o(0,i.prototype,"data",null,function(t){t?(this.visible=!0,te.getName(t.id)&&(this.txt.text=te.getName(t.id)+"：",this.input.text=t.val+"")):this.visible=!1})}(),function(t){function i(){this._data=null,this.numW=34,i.__super.call(this)}l(i,"modules.title.TitleInfoItem",za);var e=i.prototype;e.updatePower=function(t){var i,e=Rt.numToTexture(t,"com/ui/powerNum");this.spPow.graphics.clear();for(var s=0;s<e.length;s++)i=e[s],this.spPow.graphics.drawTexture(i,i.width*s);this.box.x=580-this.numW*e.length},o(0,e,"data",null,function(t){if(this._data=t,this._data){this.txtWay.text="获得条件："+this._data.way;for(var i,e=ja.getAttrs(this._data.id),s="",n=0,h=0;h<e.length;h++)(i=e[h])&&(41==i.id||42==i.id||52==i.id||54==i.id||55==i.id?s+=Da.inputEmpty(te.getAttrStrByPKV(i,"","：","%"),30)+(h%2==0?"":"\n"):s+=Da.inputEmpty(te.getAttrStrByPKV(i,"","：",""),30)+(h%2==0?"":"\n"),n+=te.getAttrPower(i.id,i.val));n+=ja.getSpcPower(this._data.id),this.txtAttr.text=s,this.updatePower(Math.floor(n))}})}(),function(t){function i(){this.repeatY=5,this.headPart=null,this.hasState=null,this.noState=null,this.items=null,this.timeOutKey=NaN,i.__super.call(this),this.setWindowType(),this.headPart=new hh,this.headPart.y=85,this.headPart.centerX=0,this.headPart.on("RoleHeadsPart.CHOOSE",this,this.onHeadItemClick),this.container.addChild(this.headPart),this.items=[],this.hasState=Na.getIns(57e3,"TitleStateItem"),this.hasState.type=!0,this.hasState.x=4,this.hasState.y=this.repeatY,this.noState=Na.getIns(57e3,"TitleStateItem"),this.noState.type=!1,this.noState.x=4,this.initList(),this.reSortList(),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay)}l(i,"modules.title.TitlePanel",$a);var e=i.prototype;e.onDisplay=function(){this.on("undisplay",this,this.onUndisplay);var t=ja.getNextTimeOut();t<99999999&&(this.timeOutKey=De.setTimeout(this,this.reSortList,null,1e3*(t-Ma.serverTime)))},e.onUndisplay=function(){this.off("undisplay",this,this.onUndisplay),De.clearTimeout(this.timeOutKey)},e.onHeadItemClick=function(t){0<=t&&(ja.curPartner=ie.getPalByIndex(t).pal_id,this.update())},e.initList=function(){this.list.vScrollBarSkin="com/ui/vscroll.png",this.list.vScrollBar.autoHide=!0,this.list.addChild(this.hasState),this.list.addChild(this.noState);for(var t,i=ja.getAllTitleVOs(),e=0;e<i.length;e++)(t=Na.getIns(57e3,"TitleListItem")).x=5,this.list.addChild(t),this.items.push(t)},e.update=function(){this.hasState.update(),this.noState.update(),this.reSortList()},e.reSortList=function(){ja.getAllTitleVOs();for(var t,i=ja.getAllTitleVOs().concat(),e=i.length-1;0<=e;e--)i[e].showT>Ma.serverTime&&i.splice(e,1);i.sort(this.sortHas);for(var s=this.hasState.x+this.hasState.height,n=0;n<this.items.length;n++)t=this.items[n],n<i.length?(t.data=i[n],t.parent||this.list.addChild(t)):t.parent&&t.removeSelf();for(var h=!0,a=0;a<this.items.length;a++)(t=this.items[a]).data&&(h!=ja.isHas(t.data.id)&&(this.noState.y=s+2*this.repeatY,s=this.noState.height+this.noState.y,h=!1),s+=this.repeatY,t.y=s,s+=t.height);this.list.refresh()},e.sortHas=function(t,i){return t&&i?ja.isHas(t.id)&&!ja.isHas(i.id)?-1:!ja.isHas(t.id)&&ja.isHas(i.id)?1:t.id>i.id?1:t.id<i.id?-1:0:0},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow()}},e.openWindow=function(t,i){for(var e in void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this,t,i),this.headPart.resetSelect(oh.curActorIndex),this.items)this.items[e].reset()},e.onResize=function(){0==ie.isVertical?(this.bg.left=NaN,this.bg.right=NaN,this.bg.width=750,this.bg.centerX=0):(this.bg.width=NaN,this.bg.centerX=NaN,this.bg.left=0,this.bg.right=0)}}(),function(t){function i(){this._hasType=!1,i.__super.call(this),this.btn.on("click",this,this.onClick)}l(i,"modules.title.TitleStateItem",Za);var e=i.prototype;e.update=function(){this._hasType?this.txtNum.text=ja.getHasTitleNum()+"个":this.txtNum.text=ja.getNOHasTitleNum()+"个"},e.onClick=function(t){Ja.ins().openAttrPanel()},o(0,e,"type",null,function(t){this._hasType=t,this._hasType?this.txthas.text="已拥有称号：":this.txthas.text="未拥有称号：",this.btn.visible=t})}(),function(t){function s(){this.eff=null,this.handUp=null,this.handDown=null,s.__super.call(this),this.setWindowType(),this.initEff(),this.initGoods(),this.updateAttrs(),this.updatePower(),this.handUp=ue.create(this,this.moveDown),this.handDown=ue.create(this,this.moveUp),this.on("click",this,this.onClick),this.on("display",this,this.onAdd),this.on("undisplay",this,this.onRemove),an.register("RP_VIP3_CAN_GET",this.btn),Vh.isFanTi?this.imgTxt.skin="modules/vip/txt5FanTi.png":this.imgTxt.skin="modules/vip/txt5.png"}l(s,"modules.vip.Vip3Panel",ao);var i=s.prototype;i.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this),this.eff.loadAndPlay(oo.getGuideEffurl(),"default",0,!0),this.update()},i.update=function(){this.btn.label=oo.curLv<3?"充值":"领取",oo.curLv<3?this.btn.label="充值":this.btn.label="领取"},i.initEff=function(){this.eff=ut.getOne(),this.eff.pos(371,325),this.container.addChild(this.eff),this.eff.loadAndPlay(oo.getGuideEffurl(),"default",0,!0)},i.onAdd=function(t){this.eff.pos(371,325),this.moveUp()},i.moveUp=function(){eo.to(this.eff,{y:this.eff.y+10,complete:this.handUp},700)},i.moveDown=function(){eo.to(this.eff,{y:this.eff.y-10,complete:this.handDown},700)},i.onRemove=function(t){eo.clearAll(this.eff)},i.initGoods=function(){for(var t,i,e=0;e<4;e++)(t=new oe(91,95,!1,!0,!1,!1)).pos(s.goodsPosArr[e][0],s.goodsPosArr[e][1]),t.dataSource=oo.getGuideGood(e),this.container.addChild(t),(i=ut.getOne()).pos(s.goodsPosArr[e][0]+90,s.goodsPosArr[e][1]+95),i.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),this.container.addChild(i)},i.updateAttrs=function(){for(var t=oo.getGuideAttrs(),i=0;i<t.length;i++)this["txtAttr"+(i+1)+"a"].text=te.getAttrStrByArr(t[i][0],"","：",""),this["txtAttr"+(i+1)+"b"].text=te.getAttrStrByArr(t[i][1],"","：",""),this["txtPower"+(i+1)].text="战力："+t[i][2][0]},i.updatePower=function(){var t,i=Rt.numToTexture(oo.getGuideEquipPower());this.spPower.graphics.clear();for(var e=0;e<i.length;e++)t=i[e],this.spPower.graphics.drawTexture(t,t.width*e)},i.onClick=function(t){switch(t.target){case this.btn:"充值"==this.btn.label?Ae.linkTo(11454):"领取"==this.btn.label&&Ae.linkTo(10201,3),this.closeWindow();break;case this.btnClose:case this.btnClose2:this.closeWindow()}},i.onResize=function(){0==ie.isVertical?(this.bg.left=NaN,this.bg.right=NaN,this.bg.width=750,this.bg.centerX=0):(this.bg.width=NaN,this.bg.centerX=NaN,this.bg.left=0,this.bg.right=0)},e(s,["goodsPosArr",function(){return this.goodsPosArr=[[35,630],[200,630],[365,630],[533,630]]}])}(),function(t){function i(){this.curVO=null,this.nextVO=null,this._curChoseLv=0,this.bar=null,this.goodsPool=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.bar=new Ot(105,140,545,32,"modules/vip/bar.png","modules/vip/barBg.png",[10,40,10,40,0],[5,10,5,10,0],[4,0,8,0],"#ffffff",24),this.container.addChild(this.bar);var t=new Ta;t.graphics.drawTexture(Oe.getRes("modules/vip/maskL.png"),-25,-12),t.graphics.drawTexture(Oe.getRes("modules/vip/maskR.png"),520,-12),this.bar.addChild(t),this.txtTip1.style.align="center",this.htmlDesc.style.lineHeight=35,this.panel.hScrollBarSkin="",this.on("click",this,this.onClick)}l(i,"modules.vip.VipPanel",lo);var e=i.prototype;e.update=function(){this.curVO=oo.getVipVO(oo.curLv),this.nextVO=oo.getVipVO(oo.curLv+1),this.imgLvLeft.skin="modules/vip/VIP_"+oo.curLv+".png";var t="";if(oo.curLv>=oo.maxLv)this.imgLvRight.skin="modules/vip/max.png",this.txtTip1.innerHTML="",Vh.isFanTi?this.bar.setValue(Rt.changeGodCoinPrice(this.curVO.needMoney),Rt.changeGodCoinPrice(this.curVO.needMoney)):this.bar.setValue(this.curVO.needMoney,this.curVO.needMoney);else{this.imgLvRight.skin="modules/vip/VIP_"+(oo.curLv+1)+".png";var i=this.nextVO.needMoney;Vh.isFanTi?this.bar.setValue(Rt.changeGodCoinPrice(oo.curMoney),Rt.changeGodCoinPrice(i)):this.bar.setValue(oo.curMoney,i),t=oo.isSVIP(this.nextVO.lv)?"SVIP"+oo.getSVIPLv(this.nextVO.lv):"VIP"+this.nextVO.lv,Vh.isFanTi?this.txtTip1.innerHTML=pe.span("再充值","#ffffff",30)+pe.span(Rt.changeGodCoinPrice(i-oo.curMoney)+"仙尊幣","#fcf476",30)+pe.span("即可成为"+t,"#ffffff",30):this.txtTip1.innerHTML=pe.span("再充值","#ffffff",30)+pe.span(i-oo.curMoney+"元宝","#fcf476",30)+pe.span("即可成为"+t,"#ffffff",30)}this.makeHtml(this.curChoseLv),this.curVO=oo.getVipVO(this.curChoseLv),this.curVO?(this.imgTitle.skin="modules/vip/title"+this.curVO.lv+".png",oo.isSVIP(this.curVO.lv)?(this.imgBg.skin="modules/vip/img/svipBg.png",this.imgTitle2.skin="modules/vip/txtGift1.png",this.imgMoney.x=251,t="SVIP"+oo.getSVIPLv(this.curVO.lv)):(this.imgBg.skin="modules/vip/img/bg.png",this.imgTitle2.skin="modules/vip/txtGift.png",this.imgMoney.x=211,t="VIP"+this.curVO.lv),Vh.isFanTi?this.txtTip2.text="充值"+Rt.changeGodCoinPrice(this.curVO.needMoney)+"仙尊幣即可成为"+t:this.txtTip2.text="充值"+this.curVO.needMoney+"元宝即可成为"+t,this.imgMoney.skin="modules/vip/"+this.curVO.giftMoney+".png",this.vipBg.skin="modules/vip/img/vipBg"+this.curVO.lv+".png"):this.txtTip2.text="",this.updateGoodsItems(oo.getRewards(this.curChoseLv)),oo.reward&&(this.btnTakeEnable=-1==oo.reward.indexOf(this.curChoseLv)),this.btnTake.visible=oo.curLv>=this.curChoseLv,(Ne.isWX||Ne.isQQ)&&(this.btnMoney.visible=Ma.getChargeOpen())},e.makeHtml=function(t){var i,e="";for(var s in oo.getDescArr(t)){var n;for(var h in i=oo.getDescArr(t)[s])n=i[h],e+=pe.span(n[0],n[1],26);e+="<br/>"}this.htmlDesc.innerHTML=e},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.btnLeft:this.curChoseLv-=1;break;case this.btnRight:this.curChoseLv+=1;break;case this.btnTake:Ve.send(19,2,"VIP-领取礼包按钮"),ro.ins().toGetReward(this.curChoseLv);break;case this.btnMoney:Ae.linkTo(11454),Ve.send(19,3,"VIP-立即充值按钮")}},e.updateGoodsItems=function(t){if(this.rePool(),t)for(var i=0;i<t.length;i++){var e=this.getOneGoods();e.dataSource=parseInt(t[i][0]),e.num=parseInt(t[i][1]),e.effVisible=1==parseInt(t[i][2]),e.pos(130*i,0),e.showEff(),this.panel.addChild(e)}this.panel.hScrollBar.value=0},e.getOneGoods=function(){return this.goodsPool=this.goodsPool||[],0<this.goodsPool.length?this.goodsPool.shift():new oi(91,95,!1,!0,!0,!1)},e.rePool=function(){for(;0<this.panel.numChildren;)this.goodsPool.push(this.panel.removeChildAt(0))},e.onResize=function(){0==ie.isVertical?(this.bg.left=NaN,this.bg.right=NaN,this.bg.width=750,this.bg.centerX=0):(this.bg.width=NaN,this.bg.centerX=NaN,this.bg.left=0,this.bg.right=0)},o(0,e,"btnTakeEnable",null,function(t){this.imgRP.visible=t,this.btnTake.mouseEnabled=t,this.btnTake.gray=!t}),o(0,e,"curChoseLv",function(){return this._curChoseLv},function(t){this._curChoseLv=Math.max(1,t),this._curChoseLv=Math.min(this._curChoseLv,oo.maxLv),this.btnLeft.visible=1!=this._curChoseLv,this.btnRight.visible=this._curChoseLv!=oo.maxLv,this.update()})}(),function(t){function i(){this.rewardIds=[{typeId:10201380,num:1},{typeId:10201101,num:200},{typeId:10201111,num:10},{typeId:10201419,num:20}],this.items=null,i.__super.call(this),this.on("display",this,this.onDisplay),this.btnAdd.on("click",this,this.onClick);for(var t=0;t<this.rewardIds.length;t++);}l(i,"modules.welfare.addApp.AddAppTipView",W);var e=i.prototype;e.onClick=function(){this.imgTip.visible=!this.imgTip.visible,0==ws.getRewardTimes(13,1991)&&ni.dispatch("PF_REWARD_GET_TOS",[13,1991])},e.onDisplay=function(){this.imgTip.visible=!1,this.on("undisplay",this,this.onUnDiplay),this.items=this.items||[];for(var t=0;t<this.rewardIds.length;t++){this.items[t]=this.items[t]||new ae(null,!1,!0,90,!0);var i=this.items[t];null==i.parent&&this.spReward.addChild(i);var e=this.rewardIds[t],s=ve.getItem(e.typeId);s&&(s.tempNum=e.num,i.data=s,i.num=e.num),i.x=120*t}},e.onUnDiplay=function(){this.imgTip.visible=!1}}(),function(t){function s(){var t,i;this.rewardDatas=[[10201147,50],[10201111,50],[10201101,300],[10201248,5]],this.timeStick=0,s.__super.call(this);for(var e=0;e<this.rewardDatas.length;e++)(t=new oe(91,100,!1,!0,!0,!0)).pos(124*e+94,130),this.addChild(t),i=this.rewardDatas[e],t.dataSource=i;this.input1.restrict="0-9",this.input2.restrict="0-9",this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.input1.on("input",this,this.checkPhoneInput),this.input1.on("blur",this,this.checkPhoneInput),this.input1.on("focus",this,this.checkPhoneInput),this.input2.on("focus",this,this.onFocus),this.input2.on("blur",this,this.onBlur)}l(s,"modules.welfare.bindPhone.BindPhoneGiftView",dt);var i=s.prototype;i.onBlur=function(){this.inputSel2.visible=!1},i.onFocus=function(){this.inputSel2.visible=!0,this.txtErr2.visible=!1},i.showCodeErr=function(){this.txtErr2.visible=!0},i.checkPhoneInput=function(){this.input1.focus?(this.inputSel1.visible=!0,11==this.input1.text.length?"1"==this.input1.text[0]?(this.txtErr1.visible=!1,this.imgRight.visible=!0):(this.txtErr1.visible=!0,this.imgRight.visible=!1):(this.txtErr1.visible=!1,this.imgRight.visible=!1)):(this.inputSel1.visible=!1,this.imgRight.visible=11==this.input1.text.length&&"1"==this.input1.text[0],this.txtErr1.visible=!this.imgRight.visible)},i.onDisplay=function(){De.addToSecond(this,this.onSecond),this.on("undisplay",this,this.onUNDisplay),ni.register("BIND_PHONE_ERROR",this,this.showCodeErr)},i.onUNDisplay=function(){De.removeFromSceond(this,this.onSecond),this.off("undisplay",this,this.onUNDisplay),ni.remove("BIND_PHONE_ERROR",this,this.showCodeErr)},i.onSecond=function(){this.timeStick>Ma.serverTime?(this.btnGet.label=this.timeStick-Ma.serverTime+"s",this.btnGet.disabled=!0):(this.btnGet.label="获取",this.btnGet.disabled=!1)},i.onClick=function(t){switch(t.target){case this.btn:0<this.input2.text.length?Ao.ins().toBindVerify(parseInt(this.input2.text)):io.addTip("请输入正确的验证码");break;case this.btnGet:var i=Ma.serverTime;i>this.timeStick&&11==this.input1.text.length&&"1"==this.input1.text[0]?(Ao.ins().toGetCode(parseInt(this.input1.text)),this.timeStick=i+59,this.btnGet.disabled=!0,this.onSecond()):io.addTip("请输入正确的手机号码")}},i.update=function(){if(Co.HAD_BIND_PHONE){var t=this.input1.text.substr(0,4)+"****"+this.input1.text.substr(-3);this.txtHad.text="当前关联的手机号为："+t,this.btn.disabled=!0,this.btn.label="已绑定手机",this.spNotBind.visible=!1,this.spHadBind.visible=!0}else this.btn.label="绑定手机",this.btn.disabled=!1,this.spNotBind.visible=!0,this.spHadBind.visible=!1}}(),function(t){function i(){i.__super.call(this),this.txtKey.on("focus",this,this.onFocus),this.btnGet.on("click",this,this.onClick)}l(i,"modules.welfare.cdKey.CDKeyView",xt);var e=i.prototype;e.onClick=function(){""!=this.txtKey.text&&"请输入激活码"!=this.txtKey.text?Ao.ins().toCDKey(this.txtKey.text):io.addTip("请输入激活码")},e.onFocus=function(t){"请输入激活码"==this.txtKey.text&&(this.txtKey.text="")},e.update=function(){this.txtKey.text=""}}(),function(t){function i(){this.curType=0,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5",!0),this.on("click",this,this.onClick)}l(i,"modules.welfare.fortuneCat.WelfareFortuneCatConfirmPanel",vo);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnBack:this.closeWindow();break;case this.btnGet:Mi.getInstance().toFortuneCatReward(this.curType)}},e.update=function(t,i){var e,s;this.txtInfo.text="今日招财"+t+"次可额外获得：",this.spReward.removeChildren();for(var n=0;n<i.length;n++)s=i[n],(e=new oe(91,100,!1,!0,!0)).x=130*n,e.dataSource=s,this.spReward.addChild(e);5==t?this.curType=1:20==t?this.curType=2:50==t&&(this.curType=3);var h,a=!1;for(var o in Fi.infoVO.reward_info)(h=Fi.infoVO.reward_info[o]).id==this.curType&&(a=!0,1==h.val?(this.btnGet.gray=!1,this.btnGet.mouseEnabled=!0):(this.btnGet.gray=!0,this.btnGet.mouseEnabled=!1));0==a&&(this.btnGet.gray=!0,this.btnGet.mouseEnabled=!1)}}(),function(t){function i(){this.effect=null,i.__super.call(this),this.on("click",this,this.onClick),this.effect=ut.getOne(),this.effect.pos(380,250),this.addChild(this.effect),ji.isReviewVersion&&(this.txtVip.visible=this.imgVip.visible=!1)}l(i,"modules.welfare.fortuneCat.WelfareFortuneCatView",bo);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.imgVip:Ve.send(23,2,"福利大厅-招财猫-提升VIP链接"),Ae.linkTo(10201);break;case this.btnBuy:if(0<Gi.VIP_FORTUNE_TIMES[oo.curLv]-Fi.infoVO.times){var i=0,e=Fi.infoVO.times+1;i=e<=5?10:e<=20?20:30,0<Ze.getGoodsNumByType(Ze.GOODS_ID,10201243)&&e<=5?Mi.getInstance().toFortuneCatBuy():ie.gold>=i?es.showSecAlert(pe.span("是否花费","#5d3924")+pe.span(i+"元宝","#F7EF5F")+pe.span("进行1次招财进宝？","#5d3924"),Mi.getInstance(),Mi.getInstance().toFortuneCatBuy,null,"catBuy"):this.toOpenChargePanel()}else{var s=new q;s.title="招财次数不足",14==oo.curLv?(s.msg="招财次数已用完，请明天再来",s.showRight=!1):oo.curLv<14&&(oo.curLv<10?(s.msg="招财次数已用完，提升VIP等级可增加次数",s.yesFun=this.callBackToVip,s.yesCaller=this,s.noLabel="提升VIP"):s.msg="招财次数已用完，请明天再来",s.showRight=!1),K.showVO(s)}break;case this.btnAddGold:Ae.linkTo(11454);break;case this.imgReward1:Mi.getInstance().openConfirmPanel(5,Gi.EXT_REWARDS[0]);break;case this.imgReward2:Mi.getInstance().openConfirmPanel(20,Gi.EXT_REWARDS[1]);break;case this.imgReward3:Mi.getInstance().openConfirmPanel(50,Gi.EXT_REWARDS[2])}},e.toOpenChargePanel=function(){var t;(!Ne.isWX&&!Ne.isQQ||(Ne.isWX||Ne.isQQ)&&Ma.getChargeOpen())&&((t=new q).msg="你的元宝不足，是否前往充值？",t.yesLabel="充值",t.yesCaller=this,t.yesFun=this.openChargePanel,K.showVO(t))},e.openChargePanel=function(){Vh.isFanTi?Ae.linkTo(11454,1):Ae.linkTo(11454)},e.callBackToVip=function(){Ae.linkTo(10201)},e.getRewardTipStr=function(t){return t<5?pe.span("额外获得：","#ffffff")+pe.span("30万","#fff959")+pe.span("铜钱","#ffffff"):t<20?pe.span("额外获得：","#ffffff")+pe.span("300万","#fff959")+pe.span("铜钱","#ffffff"):pe.span("额外获得：","#ffffff")+pe.span("3000万","#fff959")+pe.span("铜钱","#ffffff")},e.update=function(){if(this.txtGold.text=ie.user.attr.gold+"",this.txtCopper.text=Rt.getShortenSilverStr(ie.user.attr.silver),Fi.infoVO){var t,i,e,s=Fi.infoVO.times,n=Fi.infoVO.star,h=Fi.infoVO.reward_info,a=Math.floor(n/5),o=n%5,r=0,l=0;if(496<=a)this.spInfo.visible=!1,this.imgMaxTip.visible=!0,r=100;else{var c;if(this.spInfo.visible=!0,this.imgMaxTip.visible=!1,this.txtPlus.text=0<a?4+a+"%":"0",0<a&&0==o)for(var d=0;d<this.spStar.numChildren;d++)(c=this.spStar.getChildAt(d))&&(c.source=Oe.getRes("com/ui/star_1.png"));else for(var u=0;u<this.spStar.numChildren;u++)(c=this.spStar.getChildAt(u))&&(c.source=u<o?Oe.getRes("com/ui/star_1.png"):Oe.getRes("com/ui/star_0.png"));0<a&&(r=4+a),l=4+(a+1),this.txtTip.text="再招财"+(5-o)+"次将提升"+(l-r)+"%招财加成"}for(var p in s<5?(this.spReward1.visible=!0,this.spReward2.visible=!1,this.spReward3.visible=!1,t=Gi.REWARD_TIP_POS[0]):s<20?(this.spReward1.visible=!0,this.spReward2.visible=!0,this.spReward3.visible=!1,t=Gi.REWARD_TIP_POS[1]):(this.spReward1.visible=!0,this.spReward2.visible=!0,this.spReward3.visible=!0,t=Gi.REWARD_TIP_POS[2]),this.spRewardTip.pos(t[0],t[1]),this.redPoint1.visible=!1,this.redPoint2.visible=!1,this.redPoint3.visible=!1,h)1==(i=h[p]).id?2==i.val?this.spReward1.visible=this.redPoint1.visible=!1:this.spReward1.visible=this.redPoint1.visible=!0:2==i.id?2==i.val?this.spReward2.visible=this.redPoint2.visible=!1:this.spReward2.visible=this.redPoint2.visible=!0:3==i.id&&(2==i.val?this.spReward3.visible=this.redPoint3.visible=!1:this.spReward3.visible=this.redPoint3.visible=!0);0==this.spReward1.visible&&0==this.spReward2.visible&&0==this.spReward3.visible?this.spRewardTip.visible=!1:(this.spRewardTip.visible=!0,this.txtRewardTip.innerHTML=this.getRewardTipStr(s)),1==this.spReward1.visible?(e=Gi.REWARD_TIP_ITEM_POS[0],this.spReward1.pos(e[0],e[1]),1==this.spReward2.visible?(e=Gi.REWARD_TIP_ITEM_POS[1],this.spReward2.pos(e[0],e[1]),1==this.spReward3.visible?(e=Gi.REWARD_TIP_ITEM_POS[2],this.spReward3.pos(e[0],e[1]),t=Gi.REWARD_TIP_POS[2]):t=Gi.REWARD_TIP_POS[1]):1==this.spReward3.visible?(e=Gi.REWARD_TIP_ITEM_POS[1],this.spReward3.pos(e[0],e[1]),t=Gi.REWARD_TIP_POS[1]):t=Gi.REWARD_TIP_POS[0],this.spRewardTip.pos(t[0],t[1])):1==this.spReward2.visible?(e=Gi.REWARD_TIP_ITEM_POS[0],this.spReward2.pos(e[0],e[1]),1==this.spReward3.visible?(e=Gi.REWARD_TIP_ITEM_POS[1],this.spReward3.pos(e[0],e[1]),t=Gi.REWARD_TIP_POS[1]):t=Gi.REWARD_TIP_POS[0],this.spRewardTip.pos(t[0],t[1])):1==this.spReward3.visible&&(e=Gi.REWARD_TIP_ITEM_POS[0],this.spReward3.pos(e[0],e[1]),t=Gi.REWARD_TIP_POS[0],this.spRewardTip.pos(t[0],t[1]));var m=s+1;if(m<=5){var f=Ze.getGoodsNumByType(Ze.GOODS_ID,10201243),g=ve.getItem(10201243);this.txtCostGold.text=0<f&&g?"拥有"+g.name+"×"+f:"10",this.txtCostCopper.text=Math.ceil(3e5*(1+r/100))+""}else m<=20?(this.txtCostGold.text="20",this.txtCostCopper.text=Math.ceil(45e4*(1+r/100))+""):(this.txtCostGold.text="30",this.txtCostCopper.text=Math.ceil(6e5*(1+r/100))+"");0<a?(this.txtCopperAdd.visible=!0,this.txtCopperAdd.text="（已加成"+this.txtPlus.text+"）"):this.txtCopperAdd.visible=!0;var _=Gi.VIP_FORTUNE_TIMES[oo.curLv];if(oo.curLv<14){var I=oo.curLv+1,v=Gi.VIP_FORTUNE_TIMES[I],b="";b=oo.isSVIP(I)?"SVIP"+I%10:"VIP"+(oo.curLv+1),Vh.isXYX9992()?this.txtTimes.innerHTML=pe.span("已招财：","#ffffff")+pe.span(s+"/"+_,"#96f254")+pe.span("次","#ffffff"):this.txtTimes.innerHTML=pe.span("已招财：","#ffffff")+pe.span(s+"/"+_,"#96f254")+pe.span("次（"+b+"可招财"+v+"次）","#ffffff"),this.txtTimes.x=175}else 14==oo.curLv&&(this.txtTimes.innerHTML=pe.span("已招财：","#ffffff")+pe.span(s+"/"+_,"#96f254")+pe.span("次","#ffffff"),this.txtTimes.x=285)}2==Fi.isMultiple&&(Fi.isMultiple=1,this.effect.loadAndPlay("moduleEffect/fortune_cat_baoji_reward","default",0,!1))}}(),function(t){function i(){this.BeastsId=71000019,this.imgIcon=null,this.eff=null,this.speed=.5,i.__super.call(this),this.html.style.align="center",this.html2.style.align="center",this.html3.style.align="center",this.on("display",this,this.onAdd),this.on("click",this,this.onClick),Ne.isWX?this.btnBuy.label="30元抢购":(this.btnBuy.label="28元抢购",Vh.isFanTi?this.btnBuy.label="28仙尊幣搶購":this.btnBuy.label=Vh.isXianLai?"280钻石抢购":"28元抢购")}l(i,"modules.welfare.montyCard.WelfareMonthCardNewView",Po);var e=i.prototype;e.onAdd=function(t){this.off("display",this,this.onAdd),this.on("undisplay",this,this.onRemove),De.addToFrame(this,this.tipFrame)},e.onRemove=function(t){De.removeFromSceond(this,this.loop),De.removeFromFrame(this,this.tipFrame),this.on("display",this,this.onAdd),this.off("undisplay",this,this.onRemove)},e.loop=function(){if(Oo.isHasCard()&&Oo.endTime<9999999999){var t=Qt.formatDHMSArrStr(Oo.lastTime);this.html.innerHTML=pe.span("剩余","#f4f1b2")+(null!=t[0]?pe.span(t[0],"#96f254"):"")+pe.span("天","#f4f1b2")+(null!=t[1]?pe.span(t[1],"#96f254"):"")+pe.span("小时","#f4f1b2")+(null!=t[2]?pe.span(t[2],"#96f254"):"")+pe.span("分过期","#f4f1b2")}else this.update()},e.loop2=function(){var t=Co.getForeverCondition(1199);if(9999999999<=Oo.endTime||Oo.endTime<9999999999&&t<=0)this.update();else{var i=Qt.formatDHMSArrStr(Co.getForeverCondition(1199));this.html2.innerHTML=pe.span("限时特惠：","#f4f1b2")+(null!=i[0]?pe.span(i[0],"#96f254"):"")+pe.span("天","#f4f1b2")+(null!=i[1]?pe.span(i[1],"#96f254"):"")+pe.span("小时","#f4f1b2")+(null!=i[2]?pe.span(i[2],"#96f254"):"")+pe.span("分","#f4f1b2")}},e.onClick=function(t){switch(t.target){case this.btnBuy:Ai.ins().toPay(1001),Ve.send(15,3,"月卡-抢购按钮");break;case this.btnBuy2:0<Co.getForeverCondition(1199)?(Ai.ins().toPay(1199),Ve.send(15,4,"月卡-永久月卡-优惠-抢购按钮")):(Ai.ins().toPay(1200),Ve.send(15,5,"月卡-永久月卡-原价-抢购按钮"))}},e.onClickBeasts=function(t){Ae.linkTo(10811)},e.update=function(){var t=vi.getAnimalVO(this.BeastsId);if(t&&0==t.isLoaded||Vh.isFanTi?(this.imgBg.skin="modules/welfare/img/monthCardBg1.png",this.imgIcon=this.imgIcon||new ge("unit/monster/"+this.BeastsId+".png"),this.imgIcon.visible=!0,null==this.imgIcon.parent&&(this.addChild(this.imgIcon),this.imgIcon.mouseEnabled=!0,this.imgIcon.on("click",this,this.onClickBeasts)),this.imgIcon.pos(125,45),this.eff=this.eff||ut.getOne(),null==this.eff.parent&&this.addChild(this.eff),this.eff.visible=!0,this.eff.pos(180,153),this.eff.loadAndPlay("moduleEffect/goodsItemEff105_5","default",0,!0)):(this.imgBg.skin="modules/welfare/img/monthCardBg2.png",this.imgIcon&&(this.imgIcon.visible=!1),this.eff&&(this.eff.stop(),this.eff.visible=!1)),Oo.isHasCard())if(this.btnBuy.label="已拥有",this.btnBuy.mouseEnabled=!1,9999999999<=Oo.endTime)this.btnBuy.centerX=0,this.btnBuy.gray=!0,this.html.pos(220,734),this.html.visible=!0,this.html.innerHTML=pe.span("永久月卡生效中","#f4f1b2"),this.html2.visible=this.html3.visible=!1,this.btnBuy2.visible=!1,this.btnBuy2.mouseEnabled=!1,this.tip.visible=!1;else{this.btnBuy.pos(62,760),this.btnBuy.gray=!0;var i=Qt.formatDHMSArrStr(Oo.lastTime);this.html.pos(23,734),this.html.innerHTML=pe.span("剩余","#f4f1b2")+(null!=i[0]?pe.span(i[0],"#96f254"):"")+pe.span("天","#f4f1b2")+(null!=i[1]?pe.span(i[1],"#96f254"):"")+pe.span("小时","#f4f1b2")+(null!=i[2]?pe.span(i[2],"#96f254"):"")+pe.span("分过期","#f4f1b2"),this.html.visible=!0,De.addToSecond(this,this.loop),this.updateForeverBuy()}else this.btnBuy.centerX=0,this.btnBuy.gray=!1,this.html.visible=!1,De.removeFromSceond(this,this.loop),this.btnBuy2.visible=this.html2.visible=this.html3.visible=this.tip.visible=!1},e.updateForeverBuy=function(){var t=Co.getForeverCondition(1199);this.btnBuy2.visible=this.btnBuy2.mouseEnabled=this.html2.visible=this.tip.visible=!0,0<t?(Vh.isFanTi?(this.btnBuy2.label="88仙尊幣搶購",this.html3.innerHTML=pe.span("永久权益原价：188仙尊幣","#f4f1b2")):(this.btnBuy2.label="88元抢购",this.html3.innerHTML=pe.span("永久权益原价：188元","#f4f1b2")),this.html3.visible=!0,this.tip.skin="modules/welfare/img/newTip2.png",De.addToSecond(this,this.loop2)):(Vh.isFanTi?this.btnBuy2.label="188仙尊幣搶購":this.btnBuy2.label="188元抢购",this.html2.innerHTML=pe.span("永久月卡","#f4f1b2"),this.html3.visible=!1,this.tip.visible=!1,De.removeFromSceond(this,this.loop2))},e.tipFrame=function(){this.tip.y+=this.speed,(675<this.tip.y||this.tip.y<664)&&(this.speed*=-1)}}(),function(t){function i(){this._clickStar=0,this._web=null,this._html=null,i.__super.call(this),this.panel.vScrollBarSkin="com/ui/vscroll.png",this.panel.vScrollBar.autoHide=!0,this._html=new ce,this._html.width=672,this._html.on("link",this,this.onLink),this._html.style.lineHeight=30,this.panel.addChild(this._html),Vh.isEyouios()?this.btn.visible=!1:this.btn.on("click",this,this.onBtnClick)}l(i,"modules.welfare.notice.WelfareNoticeView",No);var e=i.prototype;e.onLink=function(t){_t.window.open(t)},e.onBtnClick=function(t){Ao.ins().openNoticeUpView()},e.update=function(){""!=Ro.curNotice&&(this._html.innerHTML=Ro.curNotice,this._html.height=this._html.contextHeight,this.panel.refresh()),this.txtTitle.text=Ro.curTitle,this.imgBarrier.width=this.txtTitle.textField.textWidth+110,this.btn.disabled=20<=Ro.feedBackTimes,this.btn.label=20<=Ro.feedBackTimes?"已反馈":"评分反馈"}}(),function(t){function n(){var t;this.items=null,this.itemConstArr=[[10201380,1],[10201111,10],[10201101,400],[10201248,2]],n.__super.call(this),this.btn.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.items=this.items||[];for(var i=(740-135*(this.itemConstArr.length-1)-105)/2,e=Math.max(this.items.length,this.itemConstArr.length),s=0;s<e;s++)s<this.itemConstArr.length?(this.items[s]=this.items[s]||new oe(105,105,!0,!0,!0,!1,105),t=this.items[s],Vh.isEyouH5()&&0==s&&(this.itemConstArr[s]=[10201380,5]),t.dataSource=this.itemConstArr[s],t.pos(i+135*s,540),this.addChild(t)):this.items[s]&&this.items[s].parent&&this.items[s].removeSelf();Vh.isEyouH5()&&(_t.onPC?(this.imgBg.skin="modules/welfare/img/befLoadBg.png",this.imgCode.visible=!0,this.btn.visible=!1):_t.onMobile&&(this.imgBg.skin="modules/welfare/img/befLoadBg1.png",this.imgCode.visible=!1,this.btn.visible=!0,this.btn.label="下载APP"))}l(n,"modules.welfare.WelfareAppLoadView",_o);var i=n.prototype;i.onDisplay=function(){ks.ins().setAppLoadState(!0),this.on("undisplay",this,this.onUNDisplay)},i.onUNDisplay=function(){this.off("undisplay",this,this.onUNDisplay)},i.onClick=function(){if("领取奖励"==this.btn.label)ks.ins().toPfRewardGet([9,0]);else if("eyouh5"==ji.pf){_t.window.location.href="https://go.onelink.me/KDEg?pid=llxz-shoujiH5&af_web_dp=https%3A%2F%2Fwww.facebook.com%2Feyoullxz"}else Vh.openUrl("https://h5.qzone.qq.com/h5plus/download/1106331565?_wv=1025&via=H5.APP.YOUXINEI&autoDownload=1&hideDemo=1&newDownload=1")},i.update=function(){Vh.sdk.isAppInstalled()},i.checkAppLoad=function(t){this.imgBg.skin="modules/welfare/img/befLoadBg.png",this.btn.label="下载微端"}}(),function(t){function i(){this._recoverInfo=null,this._willUesReplevyNum=1,this.isRepeat=!1,this.repeatSpeed=500,this.repeatType="",this.clickTime=0,i.__super.call(this),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.on("mousedown",this,this.onMouseEvent),this.on("mouseup",this,this.onMouseEvent),this.on("mouseout",this,this.onMouseEvent),this.itemNameText.style.align="center",this.itemNameText.style.valign="middle"}l(i,"modules.welfare.recover.WelfareRecoverItem",Bo);var e=i.prototype;e.onDisplay=function(){this.nobleImg.zOrder=20,ni.register("NOBLE_INFO_UPDATE",this,this.updateNobleImgShow)},e.onUnDisplay=function(){ni.remove("NOBLE_INFO_UPDATE",this,this.updateNobleImgShow)},e.onClick=function(t){switch(t.target){case this.getBtn:this.toGet();break;default:if(t.target instanceof modules.athletics.encounter.view.DropItem){var i=t.target;i.data.tempNum=i.num,to.show(i.data,"BASE_GOODS_TIP")}}},e.onMouseEvent=function(t){switch(t.type){case"mousedown":t.target!=this.btnRight&&t.target!=this.btnLeft||(this.isRepeat=!0,this.clickTime=_t.now(),this.repeatType=t.target==this.btnLeft?"minus":"add",De.addToTimer(this,this.startRepeat));break;case"mouseup":t.target!=this.btnRight&&t.target!=this.btnLeft||(this.isRepeat=!1,De.removeFromTimer(this,this.startRepeat),_t.now()-this.clickTime<120&&this.changeRecoverTimes(this.repeatType),this.clickTime=0);break;case"mouseout":t.target!=this.btnRight&&t.target!=this.btnLeft||(this.isRepeat=!1,De.removeFromTimer(this,this.startRepeat),this.clickTime=0)}},e.startRepeat=function(){this.isRepeat&&(this.repeatSpeed-=150,this.repeatSpeed<=0&&(this.repeatSpeed=500,this.changeRecoverTimes(this.repeatType)))},e.initItemInfo=function(t){this._recoverInfo=t,this.updateInfo()},e.setItemInfo=function(t){this._recoverInfo.item_num=t.item_num,this._recoverInfo.replevy_price=t.replevy_price,this._recoverInfo.replevy_times=t.replevy_times,this._recoverInfo.price_type=t.price_type,this._willUesReplevyNum=this._recoverInfo.replevy_times,this.updateInfo()},e.toGet=function(){if(this._recoverInfo)if(this._recoverInfo.replevy_times<=0)io.addTip("已无追回次数");else{var t="",i=this._recoverInfo.replevy_price*this._willUesReplevyNum,e=Rt.getShortenSilverStr(this._willUesReplevyNum*this._recoverInfo.item_num),s=ve.getItem(this._recoverInfo.item_id),n=1==this._recoverInfo.price_type?"元宝":"铜钱";ie.gold>=i?(t=pe.span("是否花费","#5d3924")+pe.span(i+n,"#F7EF5F")+pe.span("追回"+e+"个","#5d3924")+pe.span("【"+s.name+"】",Qi.getColorDark(s.color)),es.showSecAlert(t,Ao.ins(),Ao.ins().toBenefitReplevy,[this._recoverInfo.map_id,this._willUesReplevyNum],"welfareRecover")):es.showAlert()}},e.updateInfo=function(){var t=this._recoverInfo.item_id,i=new hi;i.txtName.visible=!1,i.mouseEnabled=!0;var e=new Object;e.className="p_tkv",e.type=5,e.id=t,e.val=1,i.setDrop(e),i.pos(this.sp.x+24,this.sp.y+4),this.addChild(i),this.updateNobleImgShow();var s=this._recoverInfo.map_id,n=Co.getConfigVOMapId(s);this.copyNameTxt.text=null!=n?n.name:"",this.updateGoldNumShow(),0<this._recoverInfo.replevy_times?(this.goldImg.visible=!0,this.recoveTimeTxt.text="可追回次数："+this._recoverInfo.replevy_times,this.getBtn.disabled=!1,this.haveNotTimeText.text="",this.goldImg.visible=!0,this.goldNumTxt.visible=!0):(this.goldImg.visible=!1,this.recoveTimeTxt.text="",this.getBtn.disabled=!0,this.haveNotTimeText.text="无次数",this.goldImg.visible=!1,this.goldNumTxt.visible=!1),this.updateItemInfoName()},e.updateNobleImgShow=function(){var t=Co.getConfigVOMapId(this._recoverInfo.map_id);this.nobleImg.visible=ze.endTime>Ma.serverTime&&1==t.isShowNoble},e.changeRecoverTimes=function(t){if(!(this._recoverInfo.replevy_times<=0)){if("minus"==t){if(this._willUesReplevyNum<=1)return;this._willUesReplevyNum--}else if("add"==t){if(this._willUesReplevyNum>=this._recoverInfo.replevy_times)return;this._willUesReplevyNum++}this.updateGoldNumShow(),this.updateItemInfoName()}},e.updateGoldNumShow=function(){0<this._recoverInfo.replevy_times?this.goldNumTxt.text=Rt.getShortenSilverStr(this._recoverInfo.replevy_price*this._willUesReplevyNum)+"":this.goldNumTxt.text=""},e.updateItemInfoName=function(){var t=ve.getItem(this._recoverInfo.item_id);0<this._recoverInfo.replevy_times?this.itemNameText.innerHTML=pe.font(t.name,Qi.getColorDark(t.color),24)+pe.font("×"+Rt.getShortenSilverStr(this._willUesReplevyNum*this._recoverInfo.item_num),"#fef6d9",24):this.itemNameText.innerHTML=pe.font(t.name,Qi.getColorDark(t.color),24)},e.getInfoMapId=function(){return this._recoverInfo?this._recoverInfo.map_id:0},i.GOLD_TYPE_GOLD=1,i.GOLD_TYPE_MONEY=2}(),function(t){function r(){this.itemArr=null,r.__super.call(this),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.update(),this.itemList.vScrollBarSkin=""}l(r,"modules.welfare.recover.WelfareRecoverView",Lo);var i=r.prototype;i.onClick=function(t){},i.onDisplay=function(){this.createItems(),Ao.ins().toCopyBenefitReplevy(),Ve.send(10071,1,"福利追回-进入界面")},i.onUnDisplay=function(){},i.createItems=function(){var t=Co.getRecoverXmlAllInfo();this.itemArr=this.itemArr||[];var i,e,s=5,n=0,h=t.sort(r.sortInfo);for(var a in h){e=h[a];var o=new Object;o.className="p_replevy_times",o.map_id=e.mapID,o.replevy_times=0,o.price_type=0,o.replevy_price=0,o.item_num=0,o.item_id=e.itemID,this.itemArr[n]=this.itemArr[n]||Na.getIns(6e4,"recover.WelfareRecoverItem"),(i=this.itemArr[n]).y=s,s+=i.height+5,i.initItemInfo(o),this.itemList.addChild(this.itemArr[n]),n++}},i.update=function(){var t=Co.allRecoverInfo;if(t&&0<t.length){this.itemArr=this.itemArr||[];for(var i=0;i<t.length;i++){var e,s=t[i],n=s.map_id;for(var h in this.itemArr)if((e=this.itemArr[h]).getInfoMapId()==n){e.setItemInfo(s);break}}}},r.sortInfo=function(t,i){return t.id<i.id?-1:1}}(),function(t){function i(){this.s=0,this._date=null,this.imgArr=null,this.effArr=null,i.__super.call(this)}l(i,"modules.welfare.gift.WelfareGiftItem",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.txtTip.underline=!0,this.bg.skin="modules/welfare/itemBot.png",this.on("click",this,this.onClick)},e.onClick=function(t){switch(t.target){case this.btnGet:go.ins().toPay(this._date.id);break;case this.txtTip:1==this.s&&Ae.linkTo(11454);break;default:if(t.target instanceof modules.athletics.encounter.view.DropItem){var i=t.target;i.data.tempNum=i.num,to.show(i.data,"BASE_GOODS_TIP")}}},o(0,e,"date",null,function(t){this._date=t,this.imgArr=this.imgArr||[],this.effArr=this.effArr||[];for(var i=0;i<this.imgArr.length;i++)this.imgArr[i]&&this.imgArr[i].parent&&this.imgArr[i].removeSelf();for(i=0;i<this.effArr.length;i++)this.effArr[i]&&this.effArr[i].parent&&this.effArr[i].removeSelf();this._date.giftArr.length;for(i=0;i<this._date.giftArr.length;i++){this.imgArr[i]=this.imgArr[i]||new hi("");var e=this.imgArr[i];if(e.mouseEnabled=!0,e.setDrop(this._date.giftArr[i]),e.x=10+i%5*100,e.y=30,this.addChild(e),0!=this._date.giftEffArr[i]){this.effArr[i]=this.effArr[i]||ut.getOne();var s=this.effArr[i];s.pos(55+i%5*100,128),s.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),this.addChild(s)}}this.txtDesc.innerHTML=pe.font("累计充值第"+this._date.day+"天","#ffe0cf",20);var n=xo.getInfo();if(n){var h=xo.getPayDayInfo();this.txtDays.text="（"+h+"/"+this._date.day+"）",this.txtDays.color=h>=this._date.day?"#96f254":"#ffe0cf",this.txtDays.x=this.txtDesc.x+this.txtDesc.contextWidth-5,this._date.day>h?(this._date.day==h+1?(this.txtTip.text="前往充值",this.txtTip.underline=!0,this.txtTip.color="#96f254",this.txtTip.mouseEnabled=!0):(this.txtTip.text="完成上一档解锁",this.txtTip.underline=!1,this.txtTip.color="#fe2e2e",this.txtTip.mouseEnabled=!1),this.txtTip.visible=!0,this.btnGet.visible=!1,this.imgFinish.visible=!1,this.imgRp.visible=!1,this.s=1):0<=n.rewards.indexOf(this._date.id)?(this.btnGet.visible=!1,this.txtTip.visible=!1,this.imgFinish.visible=!0,this.imgRp.visible=!1,this.s=3):(this.btnGet.visible=!0,this.txtTip.visible=!1,this.imgFinish.visible=!1,this.imgRp.visible=!0,this.s=2)}this.txtDays.visible=!1})}(yo),function(t){function i(){this._buyId=NaN,this._endTime=NaN,this._bitmapClip=null,this._goodsItemArr=null,this._bmClips=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay)}l(i,"modules.welfare.roleLevelOfTimeLimitGift.RoleLevelOfTimeLimitGiftView",ah);var e=i.prototype;e.onDisplay=function(){Ao.ins().toRoleConditionGiftInfo(this._buyId),this._bitmapClip=this._bitmapClip||ut.getOne(),this._bitmapClip.loadAndPlay("moduleEffect/change","default",0,!0),this._bitmapClip.pos(112,40),this._bitmapClip.scale(1.3,1.2),this.buyBtn.addChild(this._bitmapClip)},e.onUnDisplay=function(){De.removeFromSceond(this,this.timeLoop)},e.onClick=function(t){switch(t.target){case this.closeBtn:this.closeWindow();break;case this.buyBtn:this.toBuyGift()}},e.timeLoop=function(){this._endTime>Ma.serverTime?this.txtLeftTime.text=Qt.formatTime(this._endTime-Ma.serverTime):(this.txtLeftTime.text="00:00",De.removeFromSceond(this,this.timeLoop))},e.update=function(){this.parent&&De.addToSecond(this,this.timeLoop);var t=ve.getItem(10201445);if(t){this._goodsItemArr=this._goodsItemArr||[];var i,e=0,s=this.sliceProducts(t.products);for(var n in this._bmClips=this._bmClips||[],this._bmClips)this._bmClips[n].removeSelf();for(var h=0;h<3;h++){var a=h+1;i=s[h],this._goodsItemArr[a]=this._goodsItemArr[a]||new oe(91,100,!1,!0,!0,!1),1==a?(this._goodsItemArr[a].scale(1.3,1.3),this._goodsItemArr[a].pos(-62,-26)):this._goodsItemArr[a].pos(129*h-4,0),this._goodsItemArr[a].dataSource=[i.typeId,i.num],this.showSp.addChild(this._goodsItemArr[a]),1==i.effect&&(this._bmClips[e]=this._bmClips[e]||ut.getOne(),this._bmClips[e].mouseEnabled=!1,this._bmClips[e].loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),1==a?(this._bmClips[e].scale(1.3,1.3),this._bmClips[e].pos(54,95)):this._bmClips[e].pos(this._goodsItemArr[a].x+90,this._goodsItemArr[a].y+93),this.showSp.addChild(this._bmClips[e]),e++)}}},e.updateByInfo=function(t){var i=t.extra_info;if(0<i.length){var e=i[0];1==e.id&&(this._endTime=e.val+1800)}this.update()},e.toBuyGift=function(){var t=new q;t.msg=pe.font("是否花费","#5d3924",26)+pe.font("6元","#F7EF5F",26)+pe.font("购买","#5d3924",26)+pe.font("冲级大礼包？","#F7EF5F",26),t.yesCaller=Ao.ins(),t.yesFun=Ao.ins().toRoleConditionGiftBuy,t.yesArgs=[this._buyId],K.showVO(t)},e.sliceProducts=function(t){return 5<t.length?t.slice(0,5):t},o(0,e,"uiClass",function(){return"RoleLevelOfTimeLimitView"}),o(0,e,"buyId",null,function(t){this._buyId=t})}(),function(i){function t(){this.items=null,this.awardArr=null,this.effArr=null,this._title=null,this.titleImg=null,this.rewardVO=null,this.speed=.8,t.__super.call(this)}l(t,"modules.welfare.gift.WelfareGiftView",i);var e=t.prototype;e.createChildren=function(){i.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_FULL",!0),this.on("click",this,this.onClick),this.pan.vScrollBarSkin="";var t=xo.getWelfareGiftTabName();this.giftTab.labels=t,this.giftTab.selectedIndex=0,xo.nowTabId=1,this.giftTab.on("change",this,this.onChange),this.txtGet.underline=!0,this.giftTab.setItemSize(160),an.register("RP_WELFARE_GIFT_BTN1",this.giftTab.items[0]),an.register("RP_WELFARE_GIFT_BTN2",this.giftTab.items[1]),an.register("RP_WELFARE_GIFT_BTN3",this.giftTab.items[2]),an.register("RP_WELFARE_GIFT_BTN4",this.giftTab.items[3]),this.on("display",this,this.onDisplay)},e.onDisplay=function(){this.titleImg=this.titleImg||new ge,De.addToFrame(this,this.onTipFrame),this.on("undisplay",this,this.unDisplay)},e.unDisplay=function(){De.removeFromFrame(this,this.onTipFrame)},e.onChange=function(t){xo.nowTabId=this.giftTab.selectedIndex+1,this.imgTitle.skin=1<=xo.nowTabId?"modules/act/welfareGift/imgtitle"+(xo.nowTabId-1)+".png":"modules/act/welfareGift/imgtitle0.png",this.boardtitle.skin="modules/act/welfareGift/boardtitle1.png",this.items=[],this.pan.removeChildren(),this.update()},e.update=function(){var t=xo.getInfo();if(t){var i,e=xo.getWelfareGiftArrByTabId(xo.nowTabId),s=e.length+1,n=xo.getPayDayInfo();this.updateReward(s-n,t.rewards),this.items=this.items||[],e.sort(this.sortItem);for(var h=0;h<e.length;h++)i=e[h],this.items[h]=this.items[h]||Na.getIns(6e4,"gift.WelfareGiftItem"),this.items[h].date=i,this.items[h].x=1,this.items[h].y=153*h,this.pan.addChild(this.items[h])}else go.ins().toInfo()},e.updateReward=function(t,i){this.awardArr=this.awardArr||[],this.effArr=this.effArr||[];for(var e=0;e<this.awardArr.length;e++)this.awardArr[e]&&this.awardArr[e].parent&&this.awardArr[e].removeSelf();for(e=0;e<this.effArr.length;e++)this.effArr[e]&&this.effArr[e].parent&&this.effArr[e].removeSelf();if(this.rewardVO=xo.getWelfareGiftRewardByTabId(xo.nowTabId),null!=this.rewardVO){var s=new Object;s.className="p_tkv",s.type=5,s.id=Number(this.rewardVO.animPath),s.val=1;var n=ve.getRewardByTkv(s),h="",a="default",o=0,r=1.5,l=1.5,c="0,0";switch(n?n.useType%1e3:-1){case 32:h="unit/monster/"+n.img+"_3",a="stand",l=r=.9,o=3;break;case 19:"2"==n.path[0]?(h=z.getRoleUnitSubFileStr(n.path)+n.path+"_sit_4",a="sit",o=4,l=r=.9,c="0,4"):"1"==n.path[0]?(h=z.getWeaponUnitSubFileStr(n.path,"unit2")+n.path+"_4",a="stand",o=4,l=r=.9,c="100,4"):"4"==n.path[0]&&(h="unit/wing/"+n.path+"2_4",a="stand",o=4,l=r=1.5,c="-9,57");break;case 9:h="unit/monster/"+n.img+"_attack_3",a="attack",o=3,l=r=1}var d=c.split(","),u=parseInt(d[0]),p=parseInt(d[1]);4!=xo.nowTabId&&(this._title=this._title||new ut,this._title.loadAndPlay(h,a,o,!0),this._title.pos(u,p),this._title.scale(r,l)),this.titleImg.skin="modules/act/welfareGift/libao05.png",this.titleImg.scale(1.5,1.5),this.titleImg.pos(-87,-94),this.titleImg.visible=4==xo.nowTabId,this._title.visible=4!=xo.nowTabId,this.spEff.addChild(this._title),this.spEff.addChild(this.titleImg);for(e=0;e<this.rewardVO.giftArr.length;e++){this.awardArr[e]=this.awardArr[e]||new hi("");var m=this.awardArr[e];m.txtName.fontSize=24,m.mouseEnabled=!0;var f=new Object;if(f.className="p_tkv",f=this.rewardVO.giftArr[e],m.setDrop(f),m.x=43+110*e,m.y=675,this.box.addChild(m),this.rewardVO.effArr[e]&&1==this.rewardVO.effArr[e]){this.effArr[e]=this.effArr[e]||ut.getOne();var g=this.effArr[e];g.pos(91+110*e,770),g.loadAndPlay("moduleEffect/goodsItemEff","default",0,!0),this.box.addChild(g)}}t=t<0?0:t;var _=(d=xo.getWelfareGiftArrByTabId(xo.nowTabId)).length+1,I=xo.getPayDayInfo();this.txtDes.text="领取"+n.name+"（"+I+"/"+_+"天）",0<=i.indexOf(this.rewardVO.id)?(this.imgRP.visible=this.btnGet.visible=this.txtGet.visible=!1,this.imgFinish.visible=!0):0==t?(this.imgFinish.visible=this.txtGet.visible=!1,this.imgRP.visible=this.btnGet.visible=!0):(this.txtGet.visible=!0,this.imgRP.visible=this.imgFinish.visible=this.btnGet.visible=!1)}},e.sortItem=function(t,i){var e=xo.getInfo(),s=0,n=0,h=xo.getPayDayInfo();return(s=t.day>h?2e3+t.day:0<=e.rewards.indexOf(t.id)?3e3+t.day:1e3+t.day)<(n=i.day>h?2e3+i.day:0<=e.rewards.indexOf(i.id)?3e3+i.day:1e3+i.day)?-1:n<s?1:0},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.btnGet:this.rewardVO&&go.ins().toPay(this.rewardVO.id);break;case this.txtGet:Ae.linkTo(11454);default:if(t.target instanceof modules.athletics.encounter.view.DropItem){var i=t.target;i.data.tempNum=i.num,to.show(i.data,"BASE_GOODS_TIP")}}},e.onTipFrame=function(){this.titleImg.visible&&(this.titleImg.y+=this.speed),(this.titleImg.y<=-135||-80<=this.titleImg.y)&&(this.speed*=-1)}}(So),function(t){function i(){this.kind1=null,this.kind2=null,this.kind3=null,i.__super.call(this),this.on("click",this,this.onClick)}l(i,"modules.welfare.wanBa.WanbaGiftView",co);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.imgGift1:this.kind1&&ni.dispatch("GOODS_SHOW_VIEW",this.kind1.awards,re.GOODS_SHOW_NOTICE_TYPE_GIFT1);break;case this.imgGift2:this.kind2&&ni.dispatch("GOODS_SHOW_VIEW",this.kind2.awards,re.GOODS_SHOW_NOTICE_TYPE_GIFT2);break;case this.imgGift3:this.kind3?ni.dispatch("GOODS_SHOW_VIEW",this.kind3.awards,re.GOODS_SHOW_NOTICE_TYPE_GIFT3):io.addTip("暂无节日礼包哦")}},e.update=function(){this.checkGoodsOK()},e.checkGoodsOK=function(){if(ws.getRewardInfos()){var t=(new Date).getDay();t=0==t?7:0;var i,e=Co.getWanbaGiftVOS();for(var s in this.kind1=null,this.kind2=null,this.kind3=null,e)switch((i=e[s]).king){case 1:i.id=900+t,this.kind1=i;break;case 2:this.kind2=i;break;case 3:if(""!=i.canTime){var n=i.canTime.split("|");n[0]=n[0].split(","),n[1]=n[1].split(",");var h=new Date;h.setFullYear(n[0][0]),h.setMonth(n[0][1]),h.setDate(n[0][2]);var a=h.getTime();h.setFullYear(n[1][0]),h.setMonth(n[1][1]),h.setDate(n[1][2]+1);var o=h.getTime();Ma.serverTimeMs>=a&&Ma.serverTimeMs<=o&&(this.kind3=i)}}if(this.kind1){var r=ws.getRewardTimes(this.kind1.type,this.kind1.id);this.imgSel1.visible=r<=0,this.imgSt1.skin=0<r?"modules/welfare/img/had.png":""}this.kind2?(r=ws.getRewardTimes(this.kind2.type,this.kind2.id),this.imgSel2.visible=r<=0,this.imgSt2.skin=0<r?"modules/welfare/img/had.png":""):(this.imgSel2.visible=!1,this.imgSt2.skin="modules/welfare/img/no.png"),this.kind3?(r=ws.getRewardTimes(this.kind3.type,this.kind3.id),this.imgSel3.visible=r<=0,this.imgSt3.skin=0<r?"modules/welfare/img/had.png":""):(this.imgSel3.visible=!1,this.imgSt3.skin="modules/welfare/img/no.png")}}}(),function(t){function s(){this.SETTING_NOW=0,this.CAN_GET_REWARD=1,this.REWARD_ED=2,this.REWARD_IDS=[{typeId:10201380,num:1},{typeId:10201101,num:200},{typeId:10201111,num:10},{typeId:10201419,num:20}],this._btnState=0,s.__super.call(this),this.btn.on("click",this,this.onClick);for(var t=0;t<this.REWARD_IDS.length;t++){var i=new oe(90,100,!1,!0,!0,!0,100,!0);i.pos(190+110*t,550);var e=this.REWARD_IDS[t];i.dataSource=[e.typeId,e.num],this.addChild(i)}}l(s,"modules.welfare.wanBa.WelfareSetQzoonBGView",Mo);var i=s.prototype;i.onClick=function(t){this._btnState==this.CAN_GET_REWARD?ks.ins().toPfRewardGet([8,0]):this._btnState==this.SETTING_NOW&&(Ao.ins().closePanel(),Vh.sdk.openUrl("https://h5.qzone.qq.com/bgstore/detail/130526?_wv=2098179&from=adv&page=1&router=detail&coverid=130526&_proxy=1"))},i.update=function(){switch(Co.setQzoonBGState){case 0:this.btn.label="马上设置",this.btn.disabled=!1,this.imgRP.visible=!0,this._btnState=this.SETTING_NOW;break;case 1:this.btn.label="领取",this.btn.disabled=!1,this.imgRP.visible=!0,this._btnState=this.CAN_GET_REWARD;break;case 2:this.btn.label="已领取",this.btn.disabled=!0,this.imgRP.visible=!1,this._btnState=this.REWARD_ED}},o(0,i,"uiClass",function(){return"WelfareSetQZoonBgView"})}(),function(t){function i(){this._clickStar=0,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5");for(var t=0;t<this.spStar.numChildren;t++)this.spStar.getChildAt(t).on("click",this,this.onClickStar,[t]);this.txtInput.vScrollBarSkin="com/ui/vscroll.png",this.txtInput.vScrollBar.autoHide=!0,this.txtInput.vScrollBar.mouseWheelEnable=!0,this.txtInput.on("input",this,this.onInputChange),this.btn.on("click",this,this.onBtnClick),this.btnClose.on("click",this,this.closeWindow),this.btnClose2.on("click",this,this.closeWindow)}l(i,"modules.welfare.notice.WelfareNoticeUpView",Do);var e=i.prototype;e.onBtnClick=function(t){""!=this.txtInput.text||0!=this._clickStar?(Vo.ins().toFeedback(this._clickStar,this.txtInput.text),this.reset()):io.addTip("请先评分或留言")},e.onClickStar=function(t){this.clickStar=t+1},e.onInputChange=function(t){var i=0;i=0<=(i=300-this.txtInput.text.length)?i:0,this.txtLast.text="（剩余输入："+i+"字）"},e.reset=function(t){this.clickStar=0,this.txtInput.text="",this.txtLast.text="（剩余输入：300字）"},e.updateGrade=function(){switch(this._clickStar){case 0:this.txtGrade.text="";break;case 1:this.txtGrade.text="1分，差评！";break;case 2:this.txtGrade.text="2分，一般般";break;case 3:this.txtGrade.text="3分，中规中矩";break;case 4:this.txtGrade.text="4分，还算不错";break;case 5:this.txtGrade.text="5分，非常满意"}},o(0,e,"clickStar",function(){return this._clickStar},function(t){var i;this._clickStar=t;for(var e=0;e<this.spStar.numChildren;e++)i=this.spStar.getChildAt(e),e<=this._clickStar-1?i.skin="com/ui/star_4.png":i.skin="com/ui/star_5.png";this.updateGrade()})}(),function(t){function i(){this.curVO=null,i.__super.call(this),this.btn.on("click",this,this.onClick)}l(i,"modules.welfare.wanbaVipGift.WanbaVipGiftListItem",t);var e=i.prototype;e.resetBtnState=function(){this.btn.disabled=!1,this.btn.label="前往充值"},e.onClick=function(t){switch(this.btn.label){case"领取礼包":this.curVO&&ks.ins().toPfRewardGet([6,this.curVO.rewardID]);break;case"前往充值":Ae.linkTo(11454)}},e.rePool=function(){for(var t;0<this.spGoods.numChildren;)(t=this.spGoods.removeChildAt(this.spGoods.numChildren-1))&&Ws.recover("GoodsItem",t)},o(0,e,"uiClass",function(){return"WanbaVIpGiftListItem"}),o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){if(this.curVO=t,this.rePool(),this.resetBtnState(),this.curVO){var i,e;for(var s in this.curVO.vip==ws.pfVip?0<ws.getRewardTimes(6,this.curVO.rewardID)?(this.btn.disabled=!0,this.btn.label="已领取"):(this.btn.disabled=!1,this.btn.label="领取礼包"):this.curVO.vip<ws.pfVip?(this.btn.disabled=!0,this.btn.label="不可领取"):(this.btn.disabled=!1,this.btn.label="前往充值"),this.bmpVip.skin="modules/welfare/"+this.curVO.vip+".png",this.curVO.rewards)e=this.curVO.rewards[s],(i=Ws.getItemByClass("GoodsItem",oe)).dataSource=e,i.showNum=!0,i.lightColor=!1,this.spGoods.addChild(i);Ce.layoutHorizontal(this.spGoods,-50)}})}(uo),function(t){function i(){this.data=null,i.__super.call(this),this.list.scrollBar.autoHide=!0,this.list.itemRender=Na.getClass(6e4,"wanbaVipGift.WanbaVipGiftListItem"),this.on("click",this,this.onClick)}l(i,"modules.welfare.wanbaVipGift.WanbaVipView",mo);var e=i.prototype;e.update=function(){this.spVip.gray=!ws.isPfVip,this.bmpVip.skin="modules/welfare/"+ws.pfVip+".png",this.data=Co.getWanbaVipGiftVOs(),this.list.dataSource=this.data.sort(this.sort)},e.onClick=function(t){switch(t.target){case this.btn:Ae.linkTo(11454);break;case this.btnHelp:po.openPanel()}},e.sort=function(t,i){return t&&i?t.vip==ws.pfVip&&i.vip!=ws.pfVip?-1:t.vip!=ws.pfVip&&i.vip==ws.pfVip?1:t.vip<i.vip?-1:t.vip<i.vip?1:0:0}}(),function(t){function i(){this.speed=.5,i.__super.call(this),this.des.style.align="center",this.btnBuy.on("click",this,this.onClick),this.on("display",this,this.onDisplay),Ne.isWX||Ne.isQQ?this.btnBuy.label="12元抢购":Vh.isFanTi?this.btnBuy.label="12仙尊幣搶購":this.btnBuy.label=Vh.isXianLai?"120钻石抢购":"12元抢购",an.register("RP_ICON_WEEKCARD",this.btnBuy)}l(i,"modules.welfare.weekCard.WeekCardPanel",fo);var e=i.prototype;e.onDisplay=function(){this.on("undisplay",this,this.onUnDisplay),De.addToFrame(this,this.tipFrame)},e.onUnDisplay=function(){De.removeFromSceond(this,this.loop),De.removeFromFrame(this,this.tipFrame)},e.onClick=function(t){Ai.ins().toPay(1198),Ve.send(56,1,"周卡-抢购按钮")},e.update=function(){Uo.isHasCard()?(this.tip.visible=!1,this.btnBuy.label="已拥有",this.btnBuy.gray=!0,this.btnBuy.mouseEnabled=!1,De.addToSecond(this,this.loop)):(Vh.isFanTi?this.btnBuy.label="12仙尊幣搶購":this.btnBuy.label="12元抢购",this.tip.visible=!0,this.btnBuy.gray=!1,this.btnBuy.mouseEnabled=!0,this.des.visible=!1,De.removeFromSceond(this,this.loop)),this.updateRP()},e.loop=function(){if(Uo.isHasCard()){var t=Qt.formatDHMSArrStr(Uo.lastTime);this.des.visible=!0,this.des.innerHTML=pe.span("剩余","#f4f1b2")+(null!=t[0]?pe.span(t[0],"#96f254"):"")+pe.span("天","#f4f1b2")+(null!=t[1]?pe.span(t[1],"#96f254"):"")+pe.span("小时","#f4f1b2")+(null!=t[2]?pe.span(t[2],"#96f254"):"")+pe.span("分过期","#f4f1b2")}else this.update()},e.updateRP=function(){fe.checkIconRedPoint(4029)?an.show("RP_ICON_WEEKCARD"):an.hide("RP_ICON_WEEKCARD")},e.tipFrame=function(){this.tip.y+=this.speed,(this.tip.y<=685||698<=this.tip.y)&&(this.speed*=-1)}}(),function(t){function i(){this._curIconID=0,this.completeHanlder=null,this.curView=null,this.fortuneCatView=null,this.monthCardNewView=null,this.noticeView=null,this.giftView=null,this.cdKeyView=null,this.buluoGuideView=null,this.bindPhoneView=null,this.wanbaGiftView=null,this.wechatGiftView=null,this.wanbaVipGiftView=null,this.wanbaTopicView=null,this.setQzoonView=null,this.appLoadView=null,this.welfareRecoverView=null,this.honnorVIPView=null,this.honnorVIPViewFanTi=null,this.userBackView=null,this.addAppTipView=null,this.weekCardView=null,this.glowFilter=null,this.itemSelecteStates=null,this.recoverIconWasClick=!1,this.bitmapClip=null,this.clickFirst=!0,i.__super.call(this),this.setWindowType(),this.completeHanlder=ue.create(this,this.checkBtnVisible),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.list.itemRender=To,this.list.hScrollBarSkin="",this.list.mouseHandler=new ue(this,this.onClickIcon),this.list.renderHandler=new ue(this,this.onRenderHandler),this.list.selectHandler=new ue(this,this.onSelected),this.list.selectEnable=!0,this.list.on("change",this,this.checkBtnVisible),this.glowFilter=new se("#ffff00",Ne.isWX?3:10,0,0)}l(i,"modules.welfare.WelfarePanel",Eo);var e=i.prototype;e.onDisplay=function(){fe.updateIconFlash(4018,!1),ni.register("ON_SYS_UPDATE",this,this.updateIcon),ni.register("ON_SYS_CONFIG",this,this.updateIcon)},e.onUnDisplay=function(){this.recoverIconWasClick=!1,ni.remove("ON_SYS_UPDATE",this,this.updateIcon),ni.remove("ON_SYS_CONFIG",this,this.updateIcon)},e.onRenderHandler=function(t,i){this.itemSelecteStates[i]||(t.img.filters=[])},e.onSelected=function(t){for(var i,e=0;e<this.itemSelecteStates.length;e++)this.itemSelecteStates[e]=!1,(i=this.list.getCell(e))&&i.img&&(i.img.filters=[]);this.itemSelecteStates[t]=!0},e.showBtnEffect=function(t){t?(this.bitmapClip||(this.bitmapClip=ut.getOne(),this.bitmapClip.pos(13,75)),this.bitmapClip.loadAndPlay("moduleEffect/iconBtn","default",0,!0),this.btnRight.addChild(this.bitmapClip)):this.bitmapClip&&(this.btnRight.removeChild(this.bitmapClip),this.bitmapClip.unload(),this.bitmapClip=null)},e.onClick=function(t){switch(t.target){case this.btnClose:case this.btnClose2:this.closeWindow();break;case this.btnLeft:this.turnLeft();break;case this.btnRight:this.clickFirst=!1,this.turnRight()}},e.turnLeft=function(){var t=this.list.startIndex-this.list.repeatX;t=t<0?0:t,this.list.tweenTo(t,200,this.completeHanlder)},e.turnRight=function(){var t=this.list.startIndex+this.list.repeatX;t=t>this.endFirstIndex?this.endFirstIndex:t,this.list.tweenTo(t,200,this.completeHanlder)},e.checkBtnVisible=function(){this.btnLeft.visible=0<this.list.startIndex,this.btnRight.visible=this.list.startIndex<this.endFirstIndex,this.showBtnEffect(this.btnRight.visible&&this.clickFirst)},e.onClickIcon=function(t,i){if("mousedown"==t.type)if(Ne.isWX||Ne.isQQ){var e=this.list.getCell(i);e&&(this.chooseView(e.iconID),4018==e.iconID&&(this.recoverIconWasClick=!0))}else this.chooseView(Co.openIconIDs[i]),4018==Co.openIconIDs[i]&&(this.recoverIconWasClick=!0)},e.chooseView=function(t){var i=this;if(4019!=t)if(4025!=t)if(4027!=t){if(Ne.isWX||Ne.isQQ)var e=this.list.dataSource.indexOf(t);else e=Co.getListIndexByIcon(t);switch(e>this.list.startIndex+this.list.repeatX&&this.list.tweenTo(e,200,this.completeHanlder),this.list.selectedIndex=e,this.spView.removeChildren(),this._curIconID=t,this._curIconID){case 4001:this.fortuneCatView=this.fortuneCatView||Na.getIns(6e4,"fortuneCat.WelfareFortuneCatView"),this.curView=this.fortuneCatView,Mi.getInstance().toFortuneCatInfo();break;case 4002:this.monthCardNewView=this.monthCardNewView||Na.getIns(6e4,"montyCard.WelfareMonthCardNewView"),this.curView=this.monthCardNewView;break;case 4003:this.noticeView=this.noticeView||Na.getIns(6e4,"notice.WelfareNoticeView"),this.curView=this.noticeView,Vo.ins().toInfo();break;case 4006:this.cdKeyView=this.cdKeyView||Na.getIns(6e4,"cdKey.CDKeyView"),this.curView=this.cdKeyView;break;case 4007:this.buluoGuideView=this.buluoGuideView||new Io,this.curView=this.buluoGuideView;break;case 4008:this.bindPhoneView=this.bindPhoneView||Na.getIns(6e4,"bindPhone.BindPhoneGiftView"),this.curView=this.bindPhoneView;break;case 4009:this.wanbaGiftView=this.wanbaGiftView||Na.getIns(6e4,"wanBa.WanbaGiftView"),this.curView=this.wanbaGiftView;break;case 4011:this.wechatGiftView=this.wechatGiftView||new Fo,this.curView=this.wechatGiftView;break;case 5001:this.appLoadView=this.appLoadView||Na.getIns(6e4,"WelfareAppLoadView"),this.curView=this.appLoadView;break;case 4013:if(0==no.has("modules/pfDaliyGift"))return void no.add("modules/pfDaliyGift",null,this,this.chooseView,[this._curIconID]);this.wanbaVipGiftView=this.wanbaVipGiftView||Na.getIns(6e4,"wanbaVipGift.WanbaVipView"),this.curView=this.wanbaVipGiftView,ks.ins().toPfVip();break;case 4015:this.wanbaTopicView=this.wanbaTopicView||new Go,this.curView=this.wanbaTopicView;break;case 4016:this.setQzoonView=this.setQzoonView||Na.getIns(6e4,"wanBa.WelfareSetQzoonBGView"),this.curView=this.setQzoonView;break;case 4018:this.welfareRecoverView=this.welfareRecoverView||Na.getIns(6e4,"recover.WelfareRecoverView"),this.curView=this.welfareRecoverView;break;case 4020:if("eyouh5"==ji.pf||"eyouweiduan"==ji.pf||"eyouios"==ji.pf){this.honnorVIPViewFanTi=this.honnorVIPViewFanTi||wo.Ins,this.curView=this.honnorVIPViewFanTi;break}this.honnorVIPView=this.honnorVIPView||ko.Ins,this.curView=this.honnorVIPView,Ao.ins().toHonorVIPInfo();break;case 119:var s=new ue(this,function(t){i.curView=i.userBackView=t,i.spView.addChild(i.curView),i.update(119)});M.getInstance().openUserBackView(s);break;case 4028:this.addAppTipView=this.addAppTipView||Na.getIns(6e4,"addApp.AddAppTipView"),this.curView=this.addAppTipView;break;case 4029:this.weekCardView=this.weekCardView||Na.getIns(6e4,"weekCard.WeekCardPanel"),this.curView=this.weekCardView}this.spView.addChild(this.curView),this.update()}else Ae.linkTo(11510);else Ae.linkTo(11509);else Ae.linkTo(11455)},e.update=function(t){void 0===t&&(t=0);switch(0<t?t:this._curIconID){case 4001:this.fortuneCatView&&this.fortuneCatView.update();break;case 4002:this.monthCardNewView&&this.monthCardNewView.update();break;case 4003:this.noticeView&&this.noticeView.update();break;case 4006:this.cdKeyView&&this.cdKeyView.update();break;case 4007:this.buluoGuideView&&this.buluoGuideView.update();break;case 4008:this.bindPhoneView&&this.bindPhoneView.update();break;case 4009:this.wanbaGiftView&&this.wanbaGiftView.update();break;case 4013:this.wanbaVipGiftView&&this.wanbaVipGiftView.update();break;case 4015:this.wanbaTopicView&&this.wanbaTopicView.update();break;case 4016:this.setQzoonView&&this.setQzoonView.update();break;case 5001:this.appLoadView&&this.appLoadView.update();break;case 4018:this.welfareRecoverView&&this.welfareRecoverView.update();break;case 4020:this.honnorVIPView&&this.honnorVIPView.update();break;case 119:this.userBackView&&this.userBackView.update();break;case 4029:this.weekCardView&&this.weekCardView.update()}this.checkBtnVisible()},e.openWindow=function(t,i){void 0===i&&(i=!1),laya.ui.View.prototype.openWindow.call(this,t,i),console.log("添加程序");var e,s=[];if((Ne.isWX||Ne.isQQ)&&0==Ma.getChargeOpen())for(var n in s=[],Co.openIconIDs)e=Co.openIconIDs[n],fe.getIsCanShowByChargeIcon(e)||s.push(e);else s=Co.openIconIDs;this.itemSelecteStates=[];for(var h=0;h<Co.openIconIDs.length;h++)this.itemSelecteStates[h]=!1;this.list.dataSource=s},e.updateIcon=function(){this.itemSelecteStates=[];var t,i=[];if((Ne.isWX||Ne.isQQ)&&0==Ma.getChargeOpen())for(var e in i=[],Co.openIconIDs)t=Co.openIconIDs[e],fe.getIsCanShowByChargeIcon(t)||i.push(t);else i=Co.openIconIDs;for(var s=0;s<Co.openIconIDs.length;s++)this.itemSelecteStates[s]=!1;this.list.dataSource=i,this.update(0)},e.updateRedPoint=function(t){for(var i,e=this.list.startIndex;e<this.list.startIndex+this.list.repeatX;e++)(i=this.list.getCell(e))&&i.data&&t==i.data.id&&(i.redPoint=fe.checkIconRedPoint(t))},e.updateRecoverIconFlash=function(){for(var t,i=this.list.startIndex;i<this.list.startIndex+this.list.repeatX;i++)if((t=this.list.getCell(i))&&t.data&&4018==t.data.id){1==this.recoverIconWasClick?t.stopFlashEffPlayAndUnVis():t.setFlashVisAndPlayActByIconId(4018);break}},e.onResize=function(){0==ie.isVertical?(this.bg.left=NaN,this.bg.right=NaN,this.bg.width=750,this.bg.centerX=0):(this.bg.width=NaN,this.bg.centerX=NaN,this.bg.left=0,this.bg.right=0)},o(0,e,"endFirstIndex",function(){return Co.openIconIDs?Co.openIconIDs.length-this.list.repeatX:0})}(),function(t){function i(){i.__super.call(this)}l(i,"modules.athletics.petSports.PetSportsSubItem",t),o(0,i.prototype,"index",function(){return Us.ins().getPetTowerSelfrontIndex()},t.prototype._$set_index)}(ns),function(t){function i(){this.goods=null,this.goodsVO,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_5"),this.on("click",this,this.onClick)}l(i,"modules.activity.freeMall.BuyBackDialog",bt);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btn:this.closeWindow()}},o(0,e,"data",null,function(t){this.txtID.text=t.order,this.txtDes.text=t.isFree?"免单成功":"很遗憾本次没有免单，再来一单吧！";var i=t.items[0];this.goodsVO=ve.getItem(i.id),this.txtName.text=this.goodsVO.name,this.txtName.color=Qi.COLORS_DARK[this.goodsVO.color],this.goods&&this.removeChild(this.goods),this.goods=new ae(this.goodsVO),this.goods.centerX=this.goods.centerY=0,this.addChild(this.goods)})}(),function(t){function h(){this.mainVO=null,this.actID=null,h.__super.call(this),this.txtMsg.style.align="left",this.txtMsg.style.valign="top",this.txtMsg.style.color="#5d3924",this.txtMsg.style.fontSize=26,this.txtMsg.style.letterSpacing=2,this.txtMsg.style.leading=20,this.on("click",this,this.onClick),an.register("RP_YUNYOU",this.btnJinli,new Hs(18,-12))}l(h,"modules.activity.yunyou.YunyouAlert",Wo);var i=h.prototype;i.update=function(){if(null!=this.mainVO&&null!=this.actID){var t,i,e;for(var s in this.mainVO.info)(e=this.mainVO.info[s]).costTypeID==h.gold&&1==e.costTime&&(t=e),e.costTypeID==h.jinLiFu&&(i=e);this.txtMsg.innerHTML="请选择使用"+pe.span(t.cost+"元宝","#fbd815")+"/"+pe.span(i.cost+"个锦鲤符","#fbd815")+"购买",0<oo.curLv&&t.buyTimes>=this.mainVO.buyTimesVip||oo.curLv<=0&&t.buyTimes>=this.mainVO.buyTimesCommon?(this.btnGold.mouseEnabled=!1,this.btnGold.gray=!0):(this.btnGold.mouseEnabled=!0,this.btnGold.gray=!1),0<Ze.getGoodsNumByTypeID(h.jinLiFu)&&this.mainVO.totalBuyTimes<this.mainVO.maxRewardValue?an.show("RP_YUNYOU"):an.hide("RP_YUNYOU")}},i.onClick=function(t){switch(t.target){case this.btnClose:this.close();break;case this.btnGold:this.close(),this.toBuyGold();break;case this.btnJinli:this.close(),this.toBuyJinLi()}},i.toBuyGold=function(){if(this.mainVO){var t,i;for(var e in this.mainVO.info)if((i=this.mainVO.info[e]).costTypeID==h.gold&&1==i.costTime){t=i;break}if(0<oo.curLv&&t.buyTimes>=this.mainVO.buyTimesVip||oo.curLv<=0&&t.buyTimes>=this.mainVO.buyTimesCommon)io.addTip("当前没有购买次数");else if(ie.gold<t.cost)es.showAlert();else{var s="是否消耗"+pe.span(t.cost+"元宝","#fbd815")+"进行购买抽奖？";es.showSecAlert(s,L.ins(),L.ins().toGain,[this.actID[0],t.conID],"yunyou.gold")}}},i.toBuyJinLi=function(){if(this.mainVO){var t,i;for(var e in this.mainVO.info)if((i=this.mainVO.info[e]).costTypeID==h.jinLiFu){t=i;break}if(0<Ze.getGoodsNumByTypeID(h.jinLiFu)){var s="是否消耗"+pe.span(t.cost+"个锦鲤符","#fbd815")+"进行购买抽奖？",n=new q;n.msg=s,n.yesCaller=L.ins(),n.yesFun=L.ins().toGain,n.yesArgs=[this.actID[0],t.conID],n.key="yunyou.jinlifu",K.showVO(n)}else io.addTip("锦鲤符不足")}},o(0,i,"data",null,function(t){this.mainVO=t[0],this.actID=t[1],this.update()}),h.jinLiFu=10201867,h.gold=10201425}(),function(t){function i(){this.detailVO=null,this.resultType=0,this.fightName=null,this.loopTime=0,this.starChange=0,this.rewardsPos=[[205],[149,260],[94,205,316],[38,149,260,371]],this.items=null,i.__super.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_0"),this.btnGet.on("click",this,this.onGet),this.btnSend.on("click",this,this.onSend)}l(i,"modules.athletics.soloRanking.SoloRankingResultPanel",ba);var e=i.prototype;e.onSend=function(t){var i="<br/>天梯赛战报<br/>";1==this.resultType?i+="【"+ie.roleName+"】<br/>战胜了<br/>【"+this.fightName+"】":2==this.resultType&&(i+="【"+ie.roleName+"】<br/>惜败于<br/>【"+this.fightName+"】"),wt.ins().toSendMsg(1e4,i,6),Vt.ins().toExit(),this.closeWindow()},e.onGet=function(t){De.removeFromSceond(this,this.loopUpdateBtnGet),this.close(),Be.isSoloRankingMap()&&Vt.ins().toExit(),ni.dispatch("ATHLETICS_OPEN_PANEL",1)},e.unDisplay=function(){De.removeFromSceond(this,this.loopUpdateBtnGet)},e.update=function(t,i,e){this.detailVO=ga.getDdetailVO(),this.resultType=t,this.fightName=e,this.loopTime=3,2<=this.detailVO.division&&1==t?(this.btnGet.visible=this.btnSend.visible=!0,this.btnGet.x=410,this.btnGet.width=240):(this.btnGet.visible=!0,this.btnSend.visible=!1,this.btnGet.x=255,this.btnGet.width=260),De.addToSecond(this,this.loopUpdateBtnGet),this.updateTitle(t),this.updateRewards(i),this.starChange=this.detailVO.star-this.detailVO.oldStar,0==this.starChange?(this.updateInfo(this.detailVO.division,this.detailVO.stage,this.detailVO.starLv),this.imgStage.visible=!0):0<this.starChange?(this.updateInfo(this.detailVO.oldDivision,this.detailVO.oldStage,this.detailVO.oldStarLv),this.imgStage.visible=!0,this.showAddStar(this.detailVO.oldStar,this.detailVO.star)):(this.updateInfo(this.detailVO.oldDivision,this.detailVO.oldStage,this.detailVO.oldStarLv),this.imgStage.visible=!0,De.setTimeout(this,this.timeoutUpdateRemove,null,500)),this.on("undisplay",this,this.unDisplay)},e.timeoutUpdateRemove=function(){var t=ga.getDdetailVO(),i=0;i=0==t.oldStarLv?this.getStarItemNum(t.division):t.oldStarLv,this.imgDivision.source=Oe.getRes("modules/athletics/divisionB"+t.division+".png"),this.imgStage.source=Oe.getRes("modules/athletics/numBig"+t.stage+".png"),this.updateSpStar(t.division,i),this.showRemoveStar(t.division,i)},e.updateTitle=function(t){1==t?this.bcTitle.skin="com/win.png":2==t&&(this.bcTitle.skin="com/fail.png")},e.updateRewards=function(t){for(;0<this.list.numChildren;)this.list.removeChildAt(0);var i,e;this.items=this.items||[];Math.floor(this.list.width/t.length);for(var s,n=this.rewardsPos[t.length-1],h=0;h<t.length;h++)i=t[h],s=ve.getRewardByTkv(i),this.items[h]=this.items[h]||new oe(91,100,!1,!0,!0),(e=this.items[h]).dataSource=[s.id,i.val],e.pivot(45,0),e.pos(n[h],10),this.list.addChild(e)},e.updateInfo=function(t,i,e){this.imgDivision.source=Oe.getRes("modules/athletics/divisionB"+t+".png"),this.imgStage.source=Oe.getRes("modules/athletics/numBig"+i+".png"),this.updateSpStar(t,e)},e.loopUpdateBtnGet=function(){0<this.loopTime?(2<=this.detailVO.division?this.btnGet.label="离开副本（"+this.loopTime+"秒）":this.btnGet.label="领取奖励（"+this.loopTime+"秒）",this.loopTime-=1):(De.removeFromSceond(this,this.loopUpdateBtnGet),this.close(),Vt.ins().toExit(),ni.dispatch("ATHLETICS_OPEN_PANEL",1))},e.getStarItemPos=function(t){var i=[];return 1==t?i=fa.THREE_STAR_POS:2==t?i=fa.FOUR_STAR_POS:3==t&&(i=fa.FIVE_STAR_POS),i},e.getStarItemNum=function(t){return 1==t?3:2==t?4:3==t?5:0},e.updateSpStar=function(t,i){for(;0<this.spStar.numChildren;)this.spStar.removeChildAt(0);var e=this.getStarItemNum(t),s=this.getStarItemPos(t);if(0<e)for(var n,h=0;h<e;h++)(n=new ge).x=s[h],n.source=h<i?Oe.getRes("modules/athletics/star1.png"):Oe.getRes("modules/athletics/star2.png"),this.spStar.addChild(n)},e.showRemoveStar=function(t,i){var e=this.getStarItemPos(t),s=ut.getOne();s.pos(e[i-1]+23,72),this.spStar.addChild(s),s.loadAndPlay("moduleEffect/soloRanking_star_hide"),s.setEndHandler(ue.create(this,this.stageEffectEnd))},e.showAddStar=function(t,i){var e,s=ga.getDivisionByStar(t),n=ga.getStarLvByStar(t);this.updateSpStar(s,n);var h=this.getStarItemPos(s);(e=ut.getOne()).pos(h[n]+23,72),this.spStar.addChild(e),e.loadAndPlay("moduleEffect/soloRanking_star_show"),++t<i?De.setTimeout(this,this.showAddStar,[t,i],100):(s=ga.getDivisionByStar(i),n=ga.getStarLvByStar(i),e.setEndHandler(ue.create(this,this.showAddStarEffectEnd)))},e.showAddStarEffectEnd=function(){var t=ga.getDdetailVO();this.updateSpStar(t.division,t.starLv),(t.division>t.oldDivision||t.division==t.oldDivision&&t.stage<t.oldStage)&&this.stageEffect(t.stage)},e.stageEffect=function(t){this.imgStage.visible=!1;var i=ut.getOne();i.pos(this.imgStage.x+10,this.imgStage.y+60),i.setEndHandler(ue.create(this,this.stageEffectEnd,null,!0)),this.addChild(i),i.loadAndPlay("moduleEffect/soloRanking_stage_"+t)},e.stageEffectEnd=function(){var t=ga.getDdetailVO();this.updateInfo(t.division,t.stage,t.starLv),this.imgStage.visible=!0}}(),function(t){function i(){i.__super.call(this)}l(i,"modules.system.TendingView",Ha),i.prototype.close=function(t){laya.ui.Dialog.prototype.close.call(this),Ga.ins().onClickYes()}}(),function(t){function i(){this.linkDefaultArr=[11205,10901,11e3,11601,10002],this.imgArr=null,this._data=null,this.curTime=0,i.__super.call(this)}l(i,"modules.result.ResultFailPanel",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.on("display",this,this.onDisplay),this.on("click",this,this.onDown)},e.onDown=function(t){switch(t.target){case this.imageLink1:var i=this._data.failLinkArr?this._data.failLinkArr:this.linkDefaultArr;this.linkTo(i[0]);break;case this.imageLink2:i=this._data.failLinkArr?this._data.failLinkArr:this.linkDefaultArr,this.linkTo(i[1]);break;case this.imageLink3:i=this._data.failLinkArr?this._data.failLinkArr:this.linkDefaultArr,this.linkTo(i[2]);break;case this.imageLink4:i=this._data.failLinkArr?this._data.failLinkArr:this.linkDefaultArr,this.linkTo(i[3]);break;case this.newRoleBg:i=this._data.failLinkArr?this._data.failLinkArr:this.linkDefaultArr,this.linkTo(i[4]);break;case this.btnRet:this.linkTo()}},e.linkTo=function(t){void 0===t&&(t=0),0<t?(Ae.linkTo(t),this._data.leftBtnFun?this._data.leftBtnFun.apply(this._data.leftFunCaller?this._data.leftFunCaller:this,this._data.leftFunParm):Vt.ins().toExit()):(Rh.mapID==this._data.mapID||this._data.ignoreMap)&&(this._data.leftBtnFun?this._data.leftBtnFun.apply(this._data.leftFunCaller?this._data.leftFunCaller:this,this._data.leftFunParm):Vt.ins().toExit()),this.close()},e.onDisplay=function(){this.updateTime(),De.addToSecond(this,this.updateTime),this.on("undisplay",this,this.unDisplay)},e.unDisplay=function(){De.removeFromSceond(this,this.updateTime),this.off("undisplay",this,this.unDisplay)},e.updateBtn=function(){this._data&&(this.btnRet.label=""!=this._data.leftBtnLabel?this._data.leftBtnLabel:"离开")},e.updateGoods=function(){if(this._data&&this._data.goods){this.imgArr=this.imgArr||[];for(var t=0;t<this.imgArr.length;t++)this.imgArr[t]&&this.imgArr[t].parent&&this.imgArr[t].removeSelf();this._data.goods=this._data.goods.slice(0,3),this._data.goods.sort(this.sortFun);var i=(591-100*this._data.goods.length)/2;for(t=0;t<this._data.goods.length;t++){this.imgArr[t]=this.imgArr[t]||new hi;var e=this.imgArr[t];e.setDrop(this._data.goods[t]),e.x=i+t%5*100+10,e.y=120*Math.floor(t/5)+10,this.spWard.addChild(e)}}else{this.imgArr=this.imgArr||[];for(var s=0;s<this.imgArr.length;s++)this.imgArr[s]&&this.imgArr[s].parent&&this.imgArr[s].removeSelf()}Be.isCopyZhuXianRoad()?(this.spWard.visible=!1,this.specialBox.visible=!0,this.stageNum.text=zo.ins().curChallengeStage+"",this.difficulty.skin="modules/zhuXianRole/resultlv"+(zo.ins().curChallengeDifindex+1)+".png"):(this.spWard.visible=!0,this.specialBox.visible=!1)},e.updateRp=function(){if(an.unRegister(this.imageLink1),an.unRegister(this.imageLink2),an.unRegister(this.imageLink3),an.unRegister(this.imageLink4),this._data.failTxtArr&&"仙宠训练"==this._data.failTxtArr[0])an.register("RP_PET_LEVEL_UP",this.imageLink1),an.register("RP_PET_DEVOTE",this.imageLink1),an.register("RP_PET_EXP_BOX_IS_FULL",this.imageLink1),an.register("RP_PET_EXP_BOX_CAN_UP",this.imageLink1),an.register("RP_PET_SKILL_LEVEL_UP",this.imageLink2),an.register("RP_PET_SOUL_EQUIP",this.imageLink3),an.register("RP_SPRITE_BUY_FREE",this.imageLink3),an.register("RP_PET_SOUL_CHANGE",this.imageLink3),an.register("RP_PET_SOUL_LEVEL_UP",this.imageLink3),an.register("RP_TREASURE_USE",this.imageLink4),an.register("RP_TREASURE_FREE",this.imageLink4);else{an.register("RP_SKILL_LEVEL",this.imageLink3),an.register("RP_SKILL_BOOK",this.imageLink3),an.register("RP_SKILL_STEP",this.imageLink3);for(var t=0;t<4;t++)an.register("RP_FASHION_NEW1_"+t,this.imageLink1),an.register("RP_FASHION_NEW2_"+t,this.imageLink1),an.register("RP_FASHION_NEW3_"+t,this.imageLink1);an.register("RP_FASHION1",this.imageLink1),an.register("RP_FASHION2",this.imageLink1),an.register("RP_FASHION3",this.imageLink1),an.register("RP_BUILDSOUL",this.imageLink1),an.register("RP_ORANGE_UP",this.imageLink1),an.register("RP_LEGEND_UP",this.imageLink1),an.register("RP_ORANGE_DE_1",this.imageLink1),an.register("RP_ORANGE_DE_2",this.imageLink1),an.register("RP_LEGEND_DE",this.imageLink1),an.register("RP_SPEQUIP",this.imageLink1),an.register("RP_EQUIP_CHANGE",this.imageLink1),an.register("RP_OPEN_PAL",this.imageLink1),an.register("RP_REGROW",this.imageLink1),an.register("RP_REGROW_SCORE",this.imageLink1),an.register("RP_WING_EQUIP_OPEN",this.imageLink1),an.register("RP_SPLIT",this.imageLink1),an.register("RP_WING_EQUIP",this.imageLink1),an.register("RP_TITLE",this.imageLink1),an.register("WING_LEVEL_UP",this.imageLink1),an.register("RP_DOMINATE_CHANGE",this.imageLink1),an.register("RP_DOMINATE_DE",this.imageLink1),an.register("RP_DOMINATE_QU",this.imageLink1),an.register("RP_DOMINATE_UP",this.imageLink1),an.register("RP_REFINE_REINF",this.imageLink2),an.register("RP_REFINE_ENGRAVE",this.imageLink2),an.register("RP_REFINE_QUALITY",this.imageLink2),an.register("RP_REFINE_SOUL",this.imageLink2),an.register("RP_PET_SOUL_CHANGE",this.imageLink4),an.register("RP_PET_LEVEL_UP",this.imageLink4),an.register("RP_PET_SKILL_LEVEL_UP",this.imageLink4),an.register("RP_PET_SOUL_EQUIP",this.imageLink4),an.register("RP_PET_SOUL_LEVEL_UP",this.imageLink4),an.register("RP_PET_DEVOTE",this.imageLink4),an.register("RP_PET_EXP_BOX_IS_FULL",this.imageLink4),an.register("RP_PET_EXP_BOX_CAN_UP",this.imageLink4),an.register("RP_SPRITE_BUY_FREE",this.imageLink4)}},e.updateImage=function(){var t=ie.pals.length;this._data.failTxtArr&&"仙宠训练"==this._data.failTxtArr[0]?(this.newRoleBg.visible=!1,this.imageLink1.skin="modules/pet/image/petExe.png",this.imageLink2.skin="modules/pet/image/petSkill.png",this.imageLink3.skin="modules/pet/image/petSoul.png",this.imageLink4.skin="modules/pet/image/petTre.png"):(t<4?(this.newRoleBg.visible=!0,this.stronger.y=426):(this.newRoleBg.visible=!1,this.stronger.y=690),this.imageLink1.skin="com/ui/role.png",this.imageLink2.skin="com/ui/refine.png",this.imageLink3.skin="com/ui/skill.png",this.imageLink4.skin="com/ui/pet.png"),Be.isCopyZhuXianRoad()&&(this.newRoleBg.visible=!1,this.stronger.y=690)},e.sortFun=function(t,i){return t.type>i.type?1:t.type==i.type?0:-1},e.updateTime=function(){--this.curTime,0<this.curTime?this.btnRet.label="退出（"+this.curTime+"）":this._data&&(this._data.mapID==Rh.mapID||this._data.ignoreMap)&&this._data.timeOutFun?(this._data.timeOutFun.apply(this._data.timeOutCaller?this._data.timeOutCaller:this,this._data.timeOutParm),this.close()):(this.close(),this._data&&(this._data.mapID==Rh.mapID||this._data.ignoreMap)&&Vt.ins().toExit())},e.close=function(t){laya.ui.Dialog.prototype.close.call(this,t),this._data&&(Rh.mapID==this._data.mapID||this._data.ignoreMap)&&this._data.closeFun&&this._data.closeFun.apply(this._data.closeCaller?this._data.closeCaller:this,this._data.closeParm)},o(0,e,"data",null,function(t){this._data=t,this._data&&(this.curTime=this._data.countDown,this.updateBtn(),this.updateGoods(),this.updateRp(),this.updateImage())})}(Kn),function(t){function i(){this._data=null,this.bgSp=null,this.comtentSp=null,this.caSP=null,this.txtSP=null,this.itemW=120,this.itemOffset=10,this.curTime=4,i.__super.call(this)}l(i,"modules.result.ResultWinPanel",t);var e=i.prototype;e.createChildren=function(){t.prototype.createChildren.call(this),this.setWindowType("OPEN_COMMON","MASK_ALPHA_0"),this.spWard.vScrollBarSkin="com/ui/vscroll.png",this.spWard.vScrollBar.autoHide=!0,this.on("display",this,this.onDisplay),this.on("click",this,this.onClick),this.bgSp=new Dt,this.comtentSp=new Dt,this.comtentSp.mouseEnabled=!0,this.caSP=new Dt,this.txtSP=new Dt,this.spWard.addChild(this.bgSp),this.spWard.addChild(this.comtentSp),this.spWard.addChild(this.caSP),this.spWard.addChild(this.txtSP),this.txtTitle.style.align="center",this.txtTitle.style.leading=20,this.txtTitle.style.fontSize=26,this.txtTitle.style.color="#ffffff",this.txtTitle.style.letterSpacing=1,this.txtTitle.on("link",this,this.onLink),this.txtDesc.style.valign="top",this.txtDesc.style.leading=20,this.txtDesc.style.color="#ffffff",this.txtDesc.style.fontSize=26,this.txtDesc.style.letterSpacing=2,this.txtBottom.style.align="center",this.txtBottom.style.leading=20,this.txtBottom.style.fontSize=26,this.txtBottom.style.color="#ffffff",this.txtBottom.style.letterSpacing=1,this.goodsDesc.style.align="center",this.goodsDesc.style.leading=20,this.goodsDesc.style.color="#ffcc66",this.goodsDesc.style.fontSize=26,this.goodsDesc.style.letterSpacing=2},e.onClick=function(t){switch(t.target){case this.btnLeft:Ct.send(29012),(Rh.mapID==this._data.mapID||this._data.ignoreMap)&&this._data.leftBtnFun&&this._data.leftBtnFun.apply(this._data.leftFunCaller?this._data.leftFunCaller:this,this._data.leftFunParm),this.close();break;case this.btnRight:(Rh.mapID==this._data.mapID||this._data.ignoreMap)&&this._data.rightBtnFun&&this._data.rightBtnFun.apply(this._data.rightFunCaller?this._data.rightFunCaller:this,this._data.rightFunParm),this.close()}},e.close=function(t){laya.ui.Dialog.prototype.close.call(this,t),this._data&&(Rh.mapID==this._data.mapID||this._data.ignoreMap)&&this._data.closeFun&&this._data.closeFun.apply(this._data.closeCaller?this._data.closeCaller:this,this._data.closeParm)},e.onDisplay=function(){this.updateTime(),De.addToSecond(this,this.updateTime),ni.dispatch("WIN_PANEL_POPUP"),this.on("undisplay",this,this.unDisplay)},e.unDisplay=function(){De.removeFromSceond(this,this.updateTime),this.off("undisplay",this,this.unDisplay)},e.updateBtn=function(){this._data&&(this.btnLeft.label=""!=this._data.leftBtnLabel?this._data.leftBtnLabel:"离开",this.btnRight.visible=this._data.showRight,this.btnRight.label=""!=this._data.rightBtnLabel?this._data.rightBtnLabel:"离开副本",this.btnLeft.x=this._data.showRight?23:229)},e.updateGoods=function(){if(this._data&&this._data.goods){var t=this._data.goods;t.sort(this.sortFun),this.allRePool();for(var i=0;i<t.length;i++){var e=this.getOne();e.setDrop(t[i]),e.x=i%4*130+10,e.y=120*Math.floor(i/4)+10,e.imgBG.pos(e.x,e.y),e.imgCa.pos(e.x+54,e.y),e.txtName.pos(e.x-20,e.y+95),e.bigTxtNum.pos(e.x,e.y+63),this.txtSP.addChild(e.bigTxtNum),this.txtSP.addChild(e.txtName),this.caSP.addChild(e.imgCa),this.bgSp.addChild(e.imgBG),this.comtentSp.addChild(e)}this.caSP.height=this.bgSp.height=this.txtSP.height=this.comtentSp.height=130*Math.ceil(t.length/4)+10,this.centerGoods(t.length)}},e.centerGoods=function(t){if(t<4&&0<t){var i=t*this.itemW+(t-1)*this.itemOffset;this.spWard.x=(this.width-i)/2}else this.spWard.x=115},e.sortFun=function(t,i){return t.type>i.type?1:t.type==i.type?0:-1},e.updateTime=function(){--this.curTime,0<this.curTime?1==this._data.countDownPosType?this.btnLeft.label=this._data.leftBtnLabel+"（"+this.curTime+"S）":this.btnRight.label=this._data.rightBtnLabel+"（"+this.curTime+"S）":this._data&&(this._data.mapID==Rh.mapID||this._data.ignoreMap)&&this._data.timeOutFun?(this._data.timeOutFun.apply(this._data.timeOutCaller?this._data.timeOutCaller:this,this._data.timeOutParm),this.close()):(this.close(),this._data&&(this._data.mapID==Rh.mapID||this._data.ignoreMap)&&Vt.ins().toExit())},e.getOne=function(){var t=(i.pool=i.pool||[]).shift();return null!=t?t:new hi},e.allRePool=function(){var t;for(i.pool=i.pool||[],this.txtSP.removeChildren(0,this.txtSP.numChildren),this.caSP.removeChildren(0,this.caSP.numChildren),this.bgSp.removeChildren(0,this.bgSp.numChildren);0<this.comtentSp.numChildren;)(t=this.comtentSp.getChildAt(0)).removeSelf(),-1==i.pool.indexOf(t)&&i.pool.push(t)},e.onLink=function(t){switch(console.log("onClick"),t.split(":")[1]){case"monsterCopy":this.close(),Ue.ins().openRankPanel()}},o(0,e,"data",null,function(t){this._data=t,this._data?(this.curTime=this._data.countDown,this.txtTitle.innerHTML=this._data.msgTitle,this.txtTitle.y=this._data.titleY,this.txtDesc.innerHTML=this._data.msgCon,this.txtDesc.x=(this.width-this.txtDesc.contextWidth)/2,this.txtBottom.innerHTML=this._data.msgBottom,this.goodsDesc.innerHTML=this._data.goodsMsg,this._rankUpImg.x=380+this.txtTitle.contextWidth/2,this._rankUpImg.visible=1==this._data.rankChangeType,this.updateBtn(),this.updateGoods()):(this.txtTitle.innerHTML="",this.txtDesc.innerHTML="",this.goodsDesc.innerHTML="",this._rankUpImg.visible=!1)}),i.pool=null}(qn),function(t){function i(){i.__super.call(this),this.on("display",this,this.onDisplay),this.on("undisplay",this,this.onUnDisplay),this.txtMsg.style.valign="top",this.txtMsg.style.color="#5d3924",this.txtMsg.style.fontSize=26,this.txtMsg.style.letterSpacing=2,this.txtMsg.style.leading=20,this.txtMsg.innerHTML="您已经与服务器断开连接，正在重新连接...",this.btnYes.on("click",this,this.onClick)}l(i,"modules.system.OfflinePanel",Qe);var e=i.prototype;e.onUnDisplay=function(){this.timer.clear(this,this.toConnect)},e.onDisplay=function(){this.timer.loop(5e3,this,this.toConnect)},e.toConnect=function(){Nt.connect(ji.succServer)},e.onClick=function(){_t.window.location.reload()}}(),function(t){function i(){this.bottomEff=null,this._data=NaN,this.curShowSkin=null,this.title=null,this._pal=null,i.__super.call(this),this.bottomEff=ut.getOne(),this.bottomEff.pos(377,544),this.spBox.addChild(this.bottomEff),this.on("click",this,this.onClick),this.on("display",this,this.onDisplay)}l(i,"modules.title.TitleGetView",Xa);var e=i.prototype;e.onClick=function(t){switch(t.target){case this.btnRight:Ja.ins().toChange(this._data),this.btnRight.label="已穿戴",this.btnRight.disabled=!0;break;case this.btnLeft:if(Ne.isWX){if(fe.getIconStateShow(4022))return void(_t.window.wx&&(console.log("Browser.window.wx.navigateToMiniProgram({appId: wx05c25393267d6d28})"),_t.window.wx.navigateToMiniProgram({appId:"wx05c25393267d6d28"})));Vh.resetShareParm("原来我单身这么久，是因为没有遇到它····","6",[1,0]),Vh.shareAppMessage()}else Vh.resetShareParm("原来我单身这么久，是因为没有遇到它····","6",[1,0]),Vh.shareMenu();break;default:this.close()}},e.onDisplay=function(){this.bottomEff.loadAndPlay("moduleEffect/bottom","default",0,!0),this.on("undisplay",this,this.unDisplay),Ne.isWX?this.btnLeft.visible=!0:Ma.isOpenShare(0,1)?this.btnLeft.visible=!0:(this.btnLeft.visible=!1,this.btnRight.centerX=0)},e.unDisplay=function(){this.bottomEff.stop(),this.off("undisplay",this,this.unDisplay)},e.updateTitle=function(){null==this.title&&(this.title=new ut,this.title.pos(376,516),this.spBox.addChild(this.title)),this.title.loadAndPlay(ja.getTitleVO(this._data)._sceneUrl,"default",0,!0)},o(0,e,"data",null,function(t){if(this._data=t,this._data){this.btnRight.label="穿戴",this.btnRight.disabled=!1;var i=ja.getTitleVO(this._data);if(i){this.updateTitle();for(var e,s=ja.getAttrs(this._data),n=0,h="",a="",o=0;o<s.length;o++)(e=s[o])&&(41==e.id||42==e.id||52==e.id||54==e.id?o%2==0?h+=te.getAttrStrByPKV(e,"","：","%\n"):a+=te.getAttrStrByPKV(e,"","：","%\n"):o%2==0?h+=te.getAttrStrByPKV(e,"","：","\n"):a+=te.getAttrStrByPKV(e,"","：","\n"),n+=te.getAttrPower(e.id,e.val));n+=ja.getSpcPower(this._data),this.txtBase.text=h,this.txtBase1.text=a,this.txtName.text="称号·"+i.name,this.txtName.color=Qi.getColorDark(ve.getItem(this._data).color);var r,l=Rt.numToTexture(Math.floor(n),"com/ui/powerNum");for(this.spPow.graphics.clear(),o=0;o<l.length;o++)r=l[o],this.spPow.graphics.drawTexture(r,r.width*o)}}})}(),function(t){function i(){i.__super.call(this)}l(i,"modules.skill.book.SkillBookReplaceItem",t);var e=i.prototype;o(0,e,"uiClass",function(){return"SkillBookListItem"}),o(0,e,"dataSource",t.prototype._$get_dataSource,function(t){this._vo=null,this._data=t,this._data&&(this._data instanceof xml.SkillBookVO?this._vo=t:"p_goods"==this._data.className&&(this._vo=sa.getBookVO(this._data.typeid),this.txtNum.visible=!0,this.txtNum.text=this._data.current_num+"")),this._vo?(this.txtName.text=this._vo.name,this.txtName.color=Qi.COLORS_LIGHT[this._vo.color],this.img.skin=this._vo.url):this.img.skin=""})}(ir);s.__init([Zo,tr])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(t,i){"use strict";for(var e in Object.defineProperty(i,"__esModule",{value:!0}),Laya){var s=Laya[e];s&&s.__isclass&&(i[e]=s)}});