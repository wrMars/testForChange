window.__require=function t(e,i,n){function a(o,s){if(!i[o]){if(!e[o]){var l=o.split("/");if(l=l[l.length-1],!e[l]){var c="function"==typeof __require&&__require;if(!s&&c)return c(l,!0);if(r)return r(l,!0);throw new Error("Cannot find module '"+o+"'")}o=l}var u=i[o]={exports:{}};e[o][0].call(u.exports,function(t){return a(e[o][1][t]||t)},u,u.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof __require&&__require,o=0;o<n.length;o++)a(n[o]);return a}({AboreTipsTable:[function(t,e,i){"use strict";cc._RF.push(e,"3634f2vhmFLq7vAy/AhlpvI","AboreTipsTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"AboreTipsTable",properties:{_tblName:"aboretip_config",_data:null},init:function(){this._data={};this._data;for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e],a=n.type;this._data[a]||(this._data[a]=[]);var r=this._data[a];r[r.length]=n}},getRandomTips:function(t){if(!this._data[t]||0===this._data[t].length)return"";var e=this._data[t].length,i=Math.floor(100*Math.random()%e);return this._data[t][i].speak}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],AccumulatedRechargeController:[function(t,e,i){"use strict";cc._RF.push(e,"03dba59OEhHIozXfJDpv0aL","AccumulatedRechargeController");var n=t("ActivityBaseController"),a=t("AccumulatedRechargeModel"),r=cc.Class({extends:n,properties:{_modelList:null,_chargeDay:null,_chargeMoney:0},initData:function(t){this._super(t),this.clearData()},clearData:function(){this._modelList={},this._chargeDay={},this._chargeMoney=0},getDataListByConfigId:function(t){return this._modelList[t].sort(this.sortFunc)},getChargeDayByConfigId:function(t){return this._chargeDay[t]},getChargeMoney:function(){return this._chargeMoney},sortFunc:function(t,e){return t.getDay()-e.getDay()},activityParse:function(t){var e=this,i=t.record,n=i.day,r=i.chargeRecord;this._chargeMoney=r[n]?r[n]:0;var o=i.receiveMap,s=this.getActivityData();this._modelList={};var l=td.GetTableClass(td.TableEnum.AccumulatedRechargeTable).getDatasOfDataId(s);if(l)for(var c=function(t,i){var s=(h=l[t]).rewards,c=h.configId,u=h.charge,d=0;for(var _ in r)r[_]>=u&&d++;e._modelList[c]=[];for(var g=0;g<s.length;g++){var f={};p=new a,f.day=s[g][0],f.rewards=s[g][1],f.charge=u/10;var v=td.ActivityEnum.TreasureGiftEnum.NONE;f.status=v,p.initData(f),e._modelList[c].push(p)}e._chargeDay[c]=d,e.getDataListByConfigId(c).forEach(function(t){var i=t.getDay(),a=td.ActivityEnum.TreasureGiftEnum.NONE;n>=i&&d+1>=i&&(d>=i?a=o[c]&&-1!=o[c].indexOf(i)?td.ActivityEnum.TreasureGiftEnum.ALREADY_Receive:td.ActivityEnum.TreasureGiftEnum.CAN_Receive:e._chargeMoney<u&&(a=td.ActivityEnum.TreasureGiftEnum.CAN_NOT_Receive)),t.setStatus(a)})},u=0,d=l.length;u<d;u++){var h,p;c(u)}},hasRedPoint:function(){return!0},redPointTip:function(){for(var t in this._modelList)for(var e=this._modelList[t],i=0;i<e.length;i++)if(e[i].getStatus()===td.ActivityEnum.TreasureGiftEnum.CAN_Receive)return!0;return!1},redPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.Res_GET_ACTIVITY_INFO]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{AccumulatedRechargeModel:"AccumulatedRechargeModel",ActivityBaseController:"ActivityBaseController"}],AccumulatedRechargeItem:[function(t,e,i){"use strict";cc._RF.push(e,"13241DctgBIP5ucmej8CpHw","AccumulatedRechargeItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTitle=null,e.labTimes=null,e.rewardsPanel=null,e.btnOperation=null,e.btnCharge=null,e.imgReceived=null,e.imgUnopen=null,e}return n(e,t),e.prototype.updateItem=function(e,i){var n=this;t.prototype.updateItem.call(this,e,i),this._id=this._customData,this._day=i.getDay();var a=i.getStatus(),r=i.getCharge();this.imgUnopen.active=a===c.ActivityEnum.TreasureGiftEnum.NONE,this.imgReceived.active=a===c.ActivityEnum.TreasureGiftEnum.ALREADY_Receive,this.btnOperation.active=a===c.ActivityEnum.TreasureGiftEnum.CAN_Receive,this.btnCharge.active=a===c.ActivityEnum.TreasureGiftEnum.CAN_NOT_Receive,i.getRewards().forEach(function(t){var e=c.RewardManager.getRewardDetail(t),i=c.GlobalFunction.createCommonIconWidget(26,e);i.setScale(.9),n.rewardsPanel.addChild(i)}),this.labTitle.string=cc.js.formatStr("%s",c.Language.AccumulatedRechargeTips,this._day,r);var o=c.ActivityDataManager.getActivityControllerByType(c.ActivityEnum.ActivityType.AccumulatedRecharge),s=0;o&&(s=o.getChargeDayByConfigId(this._id)),this.labTimes.string="("+s+"/"+this._day+")",this.labTimes.node.color=s>=this._day?cc.color(14,176,1):cc.color(173,98,1)},e.prototype.onOperation=function(){var t=c.ActivityDataManager.getActivityControllerByType(c.ActivityEnum.ActivityType.AccumulatedRecharge);if(t){var e={};e.id=this._id,e.parmeterMap={3:this._day},t.operateActivity(e)}},e.prototype.onCharge=function(){var t=[c.ActivityEnum.Activity.ActivityVip,c.ActivityEnum.ActivityType.RechargePanel];c.PanelJumpManager.jumpToPanel(c.PanelEnum.Panel_Activity,t)},a([s(cc.Label)],e.prototype,"labTitle",void 0),a([s(cc.Label)],e.prototype,"labTimes",void 0),a([s(cc.Node)],e.prototype,"rewardsPanel",void 0),a([s(cc.Node)],e.prototype,"btnOperation",void 0),a([s(cc.Node)],e.prototype,"btnCharge",void 0),a([s(cc.Node)],e.prototype,"imgReceived",void 0),a([s(cc.Node)],e.prototype,"imgUnopen",void 0),e=a([o,l("module/Activity/AccumulatedRechargeItem")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],AccumulatedRechargeModel:[function(t,e,i){"use strict";cc._RF.push(e,"a2dfcvUP9xKcaCV+FLFKoFN","AccumulatedRechargeModel");var n=cc.Class({properties:{_day:null,_rewards:null,_status:null,_charge:null},initData:function(t){this._day=t.day,this._rewards=t.rewards,this._charge=t.charge,this._status=t.status},getDay:function(){return this._day},getRewards:function(){return this._rewards},getStatus:function(){return this._status},setStatus:function(t){this._status=t},getCharge:function(){return this._charge}});e.exports=n,cc._RF.pop()},{}],AccumulatedRechargePanel:[function(t,e,i){"use strict";cc._RF.push(e,"14ff2H3GMlEMqnvmhB8KPUw","AccumulatedRechargePanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img_title=null,e.item_node=null,e.btn1=null,e.btn2=null,e.btn3=null,e.labActivityTime=null,e.lab_money=null,e._showIndex=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Panel,this._panelEnum=r.PanelEnum.Panel_AccumulatedRecharge},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.AccumulatedRecharge),this._controller&&(this._activityId=this._controller.getActivityId(),r.EventUtil.dispatchEvent(r.EventNameEnum.HIDE_MAIN_LAYER_BOTTOM_LAYER))},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.Recharge_Success]=this._refreshListView,t[e.Res_GET_ACTIVITY_INFO]=this._resInfo,t[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.receiveRewardReturn,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._setActivityTime(),this.onBtn(null,"1")},e.prototype._resInfo=function(t){t===this._activityId&&this._refreshListView()},e.prototype._refreshListView=function(){if(this._controller){var t=this._controller.getDataListByConfigId(this._showIndex),e=this._controller.getChargeMoney()/10;this.lab_money.string=cc.js.formatStr("%s",r.Language.rechargeCount,e);var i=this._controller.getActivityData(),n=r.GetTableClass(r.TableEnum.AccumulatedRechargeTable).getDataByDataIdAndConfigId(i,this._showIndex);if(n){var a=n.rewards,o=a[a.length-1][1][0],s=r.RewardManager.getRewardDetail(o),l=this.item_node.getChildByName("icon");if(l)l.getComponent("CommonIconWidget").setData(s);else(l=r.GlobalFunction.createCommonIconWidget(33,s)).name="icon",l.setScale(.9),this.item_node.addChild(l);this.item_node.active=!0}else this.item_node.active=!1;r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Acitivty_17_lxcz,"HD_lxcz_wz0"+this._showIndex,this.img_title);var c=this.node.getComponent(d);c.setCustomData(this._showIndex),c.refreshListData(t),this.checkRedPoint()}},e.prototype._setActivityTime=function(){if(this._controller){var t=this._controller.getCurrentOpenStage();if(t&&this._controller.isInOpenStatus()){var e=t.openTime,i=new Date(e),n=t.closeTime,a=new Date(n),o=r.Language.timePattern2,s=i.pattern(o)+" - "+a.pattern(o);this.labActivityTime.string=r.Language.activityTime+s}}},e.prototype.onBtn=function(t,e){var i=parseInt(e);if(i!=this._showIndex){if(this._showIndex=i,this._curSelectedItem){var n=this._curSelectedItem.getChildByName("img_select");n&&(n.active=!1)}var a=this["btn"+e];a.getChildByName("img_select").active=!0,this._curSelectedItem=a,this._refreshListView()}},e.prototype.checkRedPoint=function(){if(this._controller)for(var t=1;t<=3;t++){var e=this._controller.getDataListByConfigId(t),i=this["btn"+t].getChildByName("redPoint");i.active=!1;for(var n=0;n<e.length;n++)if(e[n].getStatus()===r.ActivityEnum.TreasureGiftEnum.CAN_Receive){i.active=!0;break}}},e.prototype._onActivityClose=function(t){this._activityId===t&&this.closeCallFunc()},e.prototype.receiveRewardReturn=function(t){if(t.activityId===this._activityId){var e=t.rewardResult;this.showReward(e)}},e.prototype.showReward=function(t){var e=r.RewardManager.parseRewardResult(t,!0);r.GlobalFunction.showRewards(e)},a([l(cc.Node)],e.prototype,"img_title",void 0),a([l(cc.Node)],e.prototype,"item_node",void 0),a([l(cc.Node)],e.prototype,"btn1",void 0),a([l(cc.Node)],e.prototype,"btn2",void 0),a([l(cc.Node)],e.prototype,"btn3",void 0),a([l(cc.Label)],e.prototype,"labActivityTime",void 0),a([l(cc.Label)],e.prototype,"lab_money",void 0),e=a([s,c("module/Activity/AccumulatedRechargePanel")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],AccumulatedRechargeTable:[function(t,e,i){"use strict";cc._RF.push(e,"58321POuVBME5EMix58HIeo","AccumulatedRechargeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"AccumulatedRechargeTable",properties:{_tblName:"sequential_recharge_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e},getDataByDataIdAndConfigId:function(t,e){var i=this._datas[t];if(i)for(var n=0;n<i.length;n++)if(i[n].configId===e)return i[n];return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivateActivityTokenWindow:[function(t,e,i){"use strict";cc._RF.push(e,"f4ac5ZUOmxJV7A6g1aENzgC","ActivateActivityTokenWindow");var n=t("PanelBase");cc.Class({extends:n,properties:{btnActivate:cc.Button,labBtn:cc.Label,content:cc.Node},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_ActivateActivityToken},onEnable:function(){this._super()},setData:function(t){this._activityType=t||td.ActivityEnum.ActivityType.ActivityToken,this.initUI()},initUI:function(){var t=td.ActivityDataManager.getActivityControllerByType(this._activityType);td.GlobalFunction.setButtonGray(this.btnActivate,t.isActivityTokenAdvance());var e=t.getCanUpgradeLevel(td.GetConfig("ACTIVITY_TOKEN_ACTIVE_EXP"))+t.getCurActivityTokenLevel(),i=t.getRewardListByLv(e),n=t.getTokenRechargeData();n&&(this.labBtn.string=cc.js.formatStr(td.Language.rechargeCount,n.getShowValue()));var a=[];for(var r in i){var o=td.RewardManager.getRewardDetail(i[r]);a.push(o)}a.sort(this.sortFunc),this.content.removeAllChildren(!0);for(var s=0,l=0;l<a.length;l++){var c=td.GlobalFunction.createCommonIconWidget(26,a[l]);c.x=0+c.width/2+c.width*l,this.content.addChild(c),s+=c.width}this.content.width=s},sortFunc:function(t,e){return e.getQuality()-t.getQuality()},clickBgListener:function(){this.closeCallFunc()},clickActivate:function(){var t=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(t.isActivityTokenAdvance()){var e=new td.BroadcastContent(333);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e)}else{var i=t.getTokenRechargeData();td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,i),this.closeCallFunc()}}});cc._RF.pop()},{PanelBase:void 0}],ActivityBaoZhuPanel:[function(t,e,i){"use strict";cc._RF.push(e,"e3d56WQm8pKdq6XpmY3sXF4","ActivityBaoZhuPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("OptimizeVerticalListView"),d=t("OptimizeHorizontalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTime=null,e.labMyCount=null,e.labCost=null,e.btnTask=null,e.imgCostIcon1=null,e.imgCostIcon2=null,e.scroll=null,e.scrollRewards=null,e.labCostTxt=null,e.labRewardTxt=null,e.animation=null,e._isInit=!1,e._listGrid=null,e._rewardsList=null,e._activityController=null,e._isOpenTask=!1,e._rewardsInfo=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Panel,this._panelEnum=r.PanelEnum.Panel_ActivityBaoZhu},e.prototype.onEnable=function(){t.prototype.onEnable.call(this);var e=this.animation.getComponent("AnimationComponent");e||(e=this.animation.addComponent("AnimationComponent")),e.setFrameEventCallBack(this._showReward.bind(this)),this._activityController=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_26),this._addEventListener(),this._activityController&&(this._listGrid=this.scroll.getComponent(u),this._rewardsList=this.scrollRewards.getComponent(d),this.scroll.getComponent(cc.ScrollView).enabled=!1,this.labCostTxt.string=r.Language.Baozhu_Txt1||this.labCostTxt.string,this.labRewardTxt.string=r.Language.Baozhu_Txt2||this.labRewardTxt.string,this._refresUI(),this._isInit=!0,this._activityController.getIsJumpToCharge()&&(this._activityController.setIsJumpToCharge(!1),this.onBtnGetClick()),r.RedPointUtil.createRedPointOld(this.btnTask,cc.v2(-10,-10),this._activityController.isTaskRedTips.bind(this._activityController),this._activityController.redPointEvts()),this._activityController.onOpenPanel())},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this._activityController.setCurFirecrackerIndex(0)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.RES_BAOZHU_INFO]=this._refresUI,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.onReceiveOperation,t[e.BAOZHU_TASK_CLOSE]=this.onTaskWindowClose,r.EventUtil.registerEvents(t,this)},e.prototype._refresUI=function(){this.labTime.string=this.getDurationStr(),this.labMyCount.string=this._activityController.getMyCount()+"";var t=this._activityController.getCostItemData(),e="";t.getCount()>0?e+=t.getCount():e="-",this.labCost.string=e,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,t.getLittleIconResPath(),this.imgCostIcon1),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,t.getLittleIconResPath(),this.imgCostIcon2),this._activityController.getCurFirecrackerIndex()>0||(this._refreshList(),this._refreshRewardList())},e.prototype._refreshList=function(){for(var t=[],e=1;e<13;e++)t.push(e);this._isInit?this._listGrid.refreshListData(t):this._listGrid.setData(t)},e.prototype._refreshRewardList=function(){var t=this._activityController.getRewardsList();this._isInit?this._rewardsList.refreshListData(t):this._rewardsList.setData(t)},e.prototype._showFirecrakerAni=function(){this.animation&&(r.EventUtil.dispatchEvent(r.EventNameEnum.PLAY_SOUND,r.SoundEnum.BaoZhu),this.animation.play())},e.prototype._showReward=function(){if(this._activityController.setCurFirecrackerIndex(0),this._refresUI(),this._rewardsInfo){var t=r.RewardManager.parseRewardResult(this._rewardsInfo,!0);r.GlobalFunction.showRewards(t)}},e.prototype.onBtnGetClick=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_BaoZhuGet),this._isOpenTask=!0},e.prototype.onReceiveOperation=function(t){t.activityId===this._activityId&&(this._rewardsInfo=t.rewardResult,this._activityController.getCurFirecrackerIndex()>0?this._showFirecrakerAni():this._showReward())},e.prototype.onTaskWindowClose=function(){this._isOpenTask=!1},a([l(cc.Label)],e.prototype,"labTime",void 0),a([l(cc.Label)],e.prototype,"labMyCount",void 0),a([l(cc.Label)],e.prototype,"labCost",void 0),a([l(cc.Node)],e.prototype,"btnTask",void 0),a([l(cc.Node)],e.prototype,"imgCostIcon1",void 0),a([l(cc.Node)],e.prototype,"imgCostIcon2",void 0),a([l(cc.Node)],e.prototype,"scroll",void 0),a([l(cc.Node)],e.prototype,"scrollRewards",void 0),a([l(cc.Label)],e.prototype,"labCostTxt",void 0),a([l(cc.Label)],e.prototype,"labRewardTxt",void 0),a([l(cc.Animation)],e.prototype,"animation",void 0),e=a([s,c("module/Activity/ActivityBaoZhuPanel")],e)}(t("ActivityBasePanel"));i.default=h,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeHorizontalListView:void 0,OptimizeVerticalListView:void 0}],ActivityBaseController:[function(t,e,i){"use strict";cc._RF.push(e,"3f930wMhJhGpKbbZUjCBuGK","ActivityBaseController");var n=t("CommonEnum"),a=t("GameAlarm"),r=t("ActivityShowModel"),o=t("ActivityOpenModel"),s=cc.Class({properties:{_activityId:null,_activityType:null,_activityData:null,_activityOpen:null,_activityShow:null,_showMinutes:null,_showTime:null,_status:null,_localStorekey:null,_receiveData:null,_infoOutOfDate:null},initData:function(t){if(this._activityOpen=null,this._receiveData=null,this._infoOutOfDate=!1,this._activityId=t.id,this._activityType=t.activityType,this._activityData=t.data,this._showMinutes=t.showMinute,this._showTime=t.show,this._localStorekey="AcitivityClicked_"+this._activityId,this._activityShow=new r,this._activityShow.initData(this._activityType,this._activityId),this._activityId>=td.ActivityEnum.MaxFixedActivitId){this._activityOpen=new o,this._activityOpen.initData(t);var e=this._activityOpen.getCurrentOpenStage();if(e){var i=e.closeTime-1e3,n=new Date(i);a.addAlarm(n.getHours(),n.getMinutes(),n.getSeconds()),a.refresh()}else{var s=this._activityOpen.getNextOpenStage();if(s){var l=s.openTime+2e3;n=new Date(l);a.addAlarm(n.getHours(),n.getMinutes(),n.getSeconds()),a.refresh()}}}this.addLocalEventListener(),this.refreshStatus()},destroyData:function(){this.clearData&&this.clearData(),this.removeAllListeners()},addLocalEventListener:function(){var t=td.EventNameEnum,e={};e[t.GAME_ALARM_EVENT]=this._onAlarm,e[t.USER_ATTR_LEVEL_CHANGE]=this.refreshStatus,e[t.USER_ATTR_VIP_LEVEL_CHANGE]=this.refreshStatus,td.EventUtil.registerEvents(e,this)},removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},getActivityId:function(){return this._activityId},getActivityType:function(){return this._activityType},getActivityData:function(){return this._activityData},getShowData:function(){return this._activityShow},getShowMinutes:function(){return this._showMinutes},getShowTime:function(){return this._showTime},_onAlarm:function(t){t===n.AlarmEvents.Time_00_00.name&&this.onTime0000(t),this.deployAlarms(),this.refreshStatus(),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_PANEL_DRAWER),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_PANEL)},refreshStatus:function(){var t=!0;this._activityType===td.ActivityEnum.ActivityType.FirstRecharge&&(t=td.Account.getUserData().getVip()<=0);this._activityId>=td.ActivityEnum.MaxFixedActivitId&&(t=this._activityOpen.isCanShow());var e=this._status;this._status=t?td.ActivityEnum.ActivityStatus.Open:td.ActivityEnum.ActivityStatus.Closed;var i=this._status;e===td.ActivityEnum.ActivityStatus.Open&&i===td.ActivityEnum.ActivityStatus.Closed?this.onActivityClose():e===td.ActivityEnum.ActivityStatus.Closed&&i===td.ActivityEnum.ActivityStatus.Open&&this.onActivityOpen()},haveChanceToOpen:function(){return this._activityId<td.ActivityEnum.MaxFixedActivitId||this.getCurrentOpenStage()},isInOpenStatus:function(){return this._status===td.ActivityEnum.ActivityStatus.Open},isInSleepStatus:function(){var t=td.TimeUtil.getTime(),e=this._activityOpen.getCurrentOpenStage();if(!e)return!1;var i=e.closeTime;return t>=e.showTime&&t<i},onActivityOpen:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.ON_ACTIVITY_OPEN,this._activityId)},onActivityClose:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.ON_ACTIVITY_CLOSED,this._activityId)},isNewTag:function(){if(this._activityId<td.ActivityEnum.MaxFixedActivitId)return!1;if(!this._activityOpen.isOpen())return td.LocalStorageUtil.removeItem(this._localStorekey),!1;var t=this._activityOpen.getIsCanRecycle(),e=this._activityOpen.getCycleDay();if(t&&e>0)return!1;var i=this._activityOpen.getStartTime(),n=td.TimeUtil.getTime(),a=new Date(i),r=new Date(n);if(a.getDate()!==r.getDate())return!1;var o=td.LocalStorageUtil.read(this._localStorekey);if(o&&new Date(parseInt(o)).getDate()===a.getDate())return!1;return!0},onClicked:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.ACTIVITY_CLICKED),this._activityId,td.ActivityEnum.MaxFixedActivitId},getCurrentOpenStage:function(){return this._activityId<td.ActivityEnum.MaxFixedActivitId?null:this._activityOpen.getCurrentOpenStage()},getNextOpenStage:function(){return this._activityId<td.ActivityEnum.MaxFixedActivitId?null:this._activityOpen.getNextOpenStage()},deployAlarms:function(){var t=this.getCurrentOpenStage(),e=this.getNextOpenStage();t&&a.addAlarmByTimestamp(t.closeTime),e&&a.addAlarmByTimestamp(e.openTime)},setInfoOutOfDate:function(t,e){this._infoOutOfDate=t,this.checkInfoIsOutOfDate(e)},checkInfoIsOutOfDate:function(t){this._infoOutOfDate&&this.isInOpenStatus()&&this.queryInfo(t)},queryInfo:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,t)},parseQueryInfo:function(t){},parseActivityDatas:function(t){if(t){this.refreshStatus();var e=t[this._activityId];e&&this.isInOpenStatus()&&this.activityParse(e)}},activityParse:function(t){},operateActivity:function(t){this.isInOpenStatus()&&(this._receiveData=t,t.activityId=this._activityId,td.ActivityDataManager.sendOperateInfo(t))},parseRewardReceived:function(t){},isLimitLevelOpen:function(){return this._activityShow.isShowPanel()},onTime0000:function(t){},isAllRecevied:function(){return!1},hasRedPoint:function(){return!1},isRedPointTip:function(){return!1},redPointEvts:function(){return[td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,td.EventNameEnum.Recharge_Success,td.EventNameEnum.ON_ACTIVITY_OPEN,td.EventNameEnum.ON_ACTIVITY_CLOSED,td.EventNameEnum.ACTIVITY_CLICKED,td.EventNameEnum.PUSH_ACTIVITY_INFO,td.EventNameEnum.Res_GET_ACTIVITY_INFO]}});e.exports=s,cc._RF.pop()},{ActivityOpenModel:"ActivityOpenModel",ActivityShowModel:"ActivityShowModel",CommonEnum:void 0,GameAlarm:void 0}],ActivityBasePanel:[function(t,e,i){"use strict";cc._RF.push(e,"c82a5sS3ARHgru86sGCKEVJ","ActivityBasePanel");var n=cc.Class({extends:cc.Component,properties:{_controller:null,_activityType:null,_activityId:null,bPanelAdapte:!1,bannerBg:cc.Sprite},initData:function(t){if(this._activityId=t,this._controller=td.ActivityDataManager.getActivityControllerById(t),this._activityType=this._controller.getActivityType(),this._setPanelBgAdaption(),this.bannerBg){var e=this._controller.getShowData(),i=e.getBannerBgPlist(),n=e.getBannerBg();n&&(i?td.GlobalFunction.createAltasSprite(i,n,this.bannerBg):td.GlobalFunction.createSprite(n,this.bannerBg))}},_setPanelBgAdaption:function(){},onEnable:function(){this._addBaseListeners()},onDisable:function(){this._removeBaseListeners()},onDestroy:function(){console.log("\u9500\u6bc1\u6d3b\u52a8\u754c\u9762, activityId: "+this._activityId+", activityType: "+this._activityType),gdk.rm.releaseResByPanel("activity_"+this._activityId)},loadRes:function(t,e,i){gdk.rm.loadRes("activity_"+this._activityId,t,e,i)},loadingResByModule:function(t,e,i,n,a){gdk.rm.loadResByModule(td.PanelEnum.Panel_Activity,t,n,a)},_addBaseListeners:function(){td.EventUtil.registerEvent(td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,this.onReceiveOperation,this)},_removeBaseListeners:function(){td.EventUtil.unregisterAllEvents(this)},getActivityId:function(){return this._activityId},setActivityController:function(t){this._controller=t},getActivityController:function(){return this._controller},getActivityShowData:function(){return this._controller.getShowData()},onReceiveQueryInfo:function(t){},onReceiveOperation:function(t){if(t.activityId===this._activityId){var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);td.GlobalFunction.showRewards(i),this._controller.parseRewardReceived(t)}},isActivityOver:function(){var t=this._controller.getCurrentOpenStage();return!!t&&t.showTime-td.TimeUtil.getTime()<=0},getDurationStr:function(t){var e=this._controller.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=new Date(e.openTime),n=new Date(e.closeTime),a=td.Language.timePattern5,r=td.Language.activityTimeTip;return t&&(r=td.Language.activityTimeTip1),r=cc.js.formatStr(r,i.pattern(a),n.pattern(a))}},getOpenStr:function(t){var e=this._controller.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=new Date(e.openTime),n=new Date(e.showTime),a=td.Language.timePattern5,r=td.Language.activityTimeTip;return t&&(r=td.Language.activityTimeTip1),r=cc.js.formatStr(r,i.pattern(a),n.pattern(a))}},getSleepTimeStr:function(t){var e=this._controller.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=new Date(e.showTime),n=new Date(e.closeTime),a=td.Language.timePattern5,r=td.Language.activityTimeTip2;return t&&(r=td.Language.activityTimeTip1),r=cc.js.formatStr(r,i.pattern(a),n.pattern(a))}},getDurationStr2:function(t){var e=this._controller.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=new Date(e.openTime),n=new Date(e.closeTime),a=td.Language.timePattern2,r=td.Language.activityTimeTip;return t&&(r=td.Language.activityTimeTip1),r=cc.js.formatStr(r,i.pattern(a),n.pattern(a))}},getOpenTimeStamp:function(){var t=this._controller.getCurrentOpenStage();return t&&this.checkIsOpen(!0)?t.openTime:0},getCloseTimeStamp:function(){var t=this._controller.getCurrentOpenStage();return t&&this.checkIsOpen(!0)?t.closeTime:0},getOpenTimeStr:function(){var t=this._controller.getCurrentOpenStage();if(t&&this.checkIsOpen(!0)){var e=t.openTime,i=new Date(e),n=td.Language.timePattern;return i.pattern(n)}},getEndTimeStr:function(){var t=this._controller.getCurrentOpenStage();if(t&&this.checkIsOpen(!0)){var e=t.closeTime,i=new Date(e),n=td.Language.timePattern;return i.pattern(n)}},getOpenEndTimeStr:function(){var t=this._controller.getCurrentOpenStage();if(t&&this.checkIsOpen(!0)){var e=t.openTime,i=new Date(e),n=t.closeTime,a=new Date(n),r=td.Language.timePattern2;return i.pattern(r)+" ~ "+a.pattern(r)}},getActivityLeftTimeStr:function(t){var e=this._controller.getCurrentOpenStage();if(!e||!this.checkIsOpen(!0))return"";var i=e.showTime-td.TimeUtil.getTime();return i<=0?"":td.GlobalFunction.getTimeSecondsStringByDeltaTime(i,t)},getActivityShowTimeStr:function(){var t=this._controller.getCurrentOpenStage();return t&&this.checkIsOpen(!0)?t.showTime:""},checkIsOpen:function(t){var e=this._controller.isInOpenStatus();return e||t||td.MessageBox.tip(148),e},showHelpWidget:function(){var t=td.PanelManager.getInstance().getCurShowPanel().getPanelEnum(),e={};e.panelName=td.PanelEnum.Window_Help,e.callback={func:function(t,e){e.setData(t)},param:[t,this._activityType]},td.GlobalFunction.showPanel(e)}});e.exports=n,cc._RF.pop()},{}],ActivityCollectWordConfig:[function(t,e,i){"use strict";cc._RF.push(e,"6c291vlayJOK5kVzcXo799e","ActivityCollectWordConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityCollectWordConfig",properties:{_tblName:"activity_collect_word_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityConvertConfig:[function(t,e,i){"use strict";cc._RF.push(e,"4eccaVLYt9P+L+9VKEWXOJB","ActivityConvertConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityConvertConfig",e._tblName="activity_convert_config",e._datas=null,e}return n(e,t),e.prototype.init=function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},e.prototype.getDatasOfDataId=function(t){var e=this._datas[t];return e||(e=[]),e},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityCoustomGiftPoolTable:[function(t,e,i){"use strict";cc._RF.push(e,"b6f5aJGNrJLEKSc5fsZUZSS","ActivityCoustomGiftPoolTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityOptionRewardConfig",properties:{_tblName:"activity_option_reward_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.poolId]=this._datas[n.poolId]||[];var a=this._datas[n.poolId];a[a.length]=n}},getRewardById:function(t){return this._datas[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityCoustomGiftTable:[function(t,e,i){"use strict";cc._RF.push(e,"55bd19Uh4VOu54Qh9RyYO7j","ActivityCoustomGiftTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityOptionBaseConfig",properties:{_tblName:"activity_option_base_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityDataManager:[function(t,e,i){"use strict";cc._RF.push(e,"3e7067hIjVBQZFhMrg09NV0","ActivityDataManager");var n=t("UFSdkManager");td.ActivityDataManager={_controllers:[],_openMap:null,_isJumpToRecharge:!1,_jumpRechargeBackData:null,init:function(){this._controllers=[],this._openMap={},this._jumpRechargeBackData=[],this._addNetListener(),this._addEventListener()},destroyData:function(){this._controllers=[],this._openMap={}},_addNetListener:function(){var t=td.MsgModuleName.ACTIVITY,e=td.MsgCmd.Activity,i=td.ServerDelegate;i.registerMessage(t,e.GET_ACTIVITY_CONFIG,this._onActivityConfig.bind(this)),i.registerMessage(t,e.GET_ACTIVITY_INFO,this._onActivityInfo.bind(this)),i.registerMessage(t,e.PUSH_ACTIVITY_INFO,this._onActivityInfo.bind(this)),i.registerMessage(t,e.ACTIVITY_OPERATE,this.onActivityOperate.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQUEST_ACTIVITY_CONFIG]=this._initActivityConfig,i[e.Req_GET_ACTIVITY_INFO]=this._reqActivityInfo,i[e.USER_ATTR_LEVEL_CHANGE]=this._addFixedShowActivity,t.registerEvents(i,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},_initActivityConfig:function(){this._addFixedShowActivity(),this._reqActivitConfig()},_requestActivityConfig:function(t){t.requestBaseInfo&&"function"==typeof t.requestBaseInfo?t.requestBaseInfo():cc.log("activity fixed controller don't have request info func for type = "+t.getActivityType())},_reqActivitConfig:function(){var t={};t.module=td.MsgModuleName.ACTIVITY,t.cmd=td.MsgCmd.Activity.GET_ACTIVITY_CONFIG,td.ServerDelegate.sendMessage(t)},_reqActivityInfo:function(t){t=t||0;var e={};e.module=td.MsgModuleName.ACTIVITY,e.cmd=td.MsgCmd.Activity.GET_ACTIVITY_INFO,e.activityId=t,td.ServerDelegate.sendMessage(e)},sendOperateInfo:function(t){var e={};e.module=td.MsgModuleName.ACTIVITY,e.cmd=td.MsgCmd.Activity.ACTIVITY_OPERATE,e.id=t.id,e.activityId=t.activityId,t.parmeterMap&&(e.parmeterMap=t.parmeterMap),td.ServerDelegate.sendMessage(e)},doRechargeAction:function(t){},getJumpBackData:function(){return this._jumpRechargeBackData},setJumpBackData:function(t){this._jumpRechargeBackData=t},_onActivityConfig:function(t,e){if(t===td.NetCode.SUCCESS){this._controllers=this._controllers||[];for(var i=e.configList,n=td.TimeUtil.getTime(),a=0;a<i.length;a++){var r=i[a],o=r.activityType,s=td.ActivityEnum.ActivityControllers[o];if(s){if(r.id>td.ActivityEnum.MaxFixedActivitId){var l=r.open,c=r.close;if(n<l&&l-n>864e5)continue;if(n>=c){if(!r.recycle)continue;var u=24*(r.cycle||0)*60*60*1e3,d=n-l,h=Math.floor(d/u);if(n>c+u*h&&l+u*(h+1)-n>864e5)continue}}var p=new s;p.initData(r),this._controllers.push(p)}else cc.log("this controller class of activity is null it's activityType is %d",o)}td.EventUtil.dispatchEvent(td.EventNameEnum.ACTIVITY_CONTROLLER_LOADED),setTimeout(this.doSomeSpecialActivityQuery,100),this._reqActivityInfo()}},doSomeSpecialActivityQuery:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_GET_INFO),td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_BB_MEETS_INFO)},_onActivityInfo:function(t,e){if(t===td.NetCode.SUCCESS){for(var i=0;i<this._controllers.length;i++)e.voMap&&this._controllers[i].parseActivityDatas(e.voMap);var n;for(var a in e.voMap)n=e.voMap[a].activityId;td.EventUtil.dispatchEvent(td.EventNameEnum.INIT_DATA_LOADED,td.LoadKey.Activity),td.EventUtil.dispatchEvent(td.EventNameEnum.Res_GET_ACTIVITY_INFO,n),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_PANEL_DRAWER),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL)}},onActivityOperate:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,e)},_addFixedShowActivity:function(){td.Account.getUserData().getLevel();var t=td.GetTableClass(td.TableEnum.ActivityShowFixedTable).getActivityShowData();for(var e in t){var i,n=t[e],a=((i={}).id=n.activityType-td.ActivityEnum.MaxFixedActivitId,i.activityType=n.activityType,i.order=n.order,i.data=n,i),r=td.ActivityEnum.ActivityControllers[a.activityType];if(r&&!this._openMap[a.activityType]){var o=new r;o.initData(a),o.haveChanceToOpen()?(this._controllers.push(o),this._openMap[a.activityType]=!0,this._requestActivityConfig(o)):o.destroyData()}else cc.log("class of activity is null, type is %d",a.activityType)}},refreshAllControllers:function(){for(var t=0;t<this._controllers.length;t++)this._controllers[t].refreshStatus()},getOpenActivities:function(){for(var t=[],e=0;e<this._controllers.length;e++){var i=this._controllers[e];i.isInOpenStatus()&&i.getShowData().isShowPanel()&&t.push(i)}return t},getActivityIconResList:function(){for(var t=this.getOpenActivities(),e=[],i=0,n=t.length;i<n;i++){var a=t[i].getShowData().getIconRes();e.push(a)}return e},getControllers:function(t){for(var e=this.getOpenActivities(),i=[],a=td.ActivityEnum.Activity,r=0;r<e.length;r++){var o=e[r].getActivityType(),s=e[r].getShowData().getBelongType(),l=o===td.ActivityEnum.ActivityType.RechargePanel;o===td.ActivityEnum.ActivityType.LevelGift&&e[r].isAllRecevied()||(o===td.ActivityEnum.ActivityType.GrowthPlan&&e[r].isAllRecevied()||(o===td.ActivityEnum.ActivityType.SpecialPackage&&console.log("============getControllers",n.getInstance().getPlatform()),(o!==td.ActivityEnum.ActivityType.SpecialPackage||DX_CHANNEL!=SdkType.BABAIWAN&&DX_CHANNEL!=SdkType.HOU_LANG_IOS||n.getInstance().getPlatform())&&(o!==td.ActivityEnum.ActivityType.GoldHeroBackBuy&&o!==td.ActivityEnum.ActivityType.GoldHeroBackBuy2||e[r].isInSpecialOpenStatus())&&(o!==td.ActivityEnum.ActivityType.CumulateGift||e[r].isAllRecevied())&&(t!==s||t==a.ActivityVip&&(t!==a.ActivityVip||!l&&td.IsCheckServer())||i.push(e[r]))))}return i},getActivityControllerById:function(t){for(var e=0;e<this._controllers.length;e++){var i=this._controllers[e];if(i.getActivityId()===t)return i}return null},getActivityControllerByType:function(t){for(var e=0;e<this._controllers.length;e++){var i=this._controllers[e];if(i.getActivityType()===t&&i.isInOpenStatus())return i}return null},getSortedActivityShows:function(t){for(var e=this.getControllers(t),i=[],n=0;n<e.length;n++){var a=e[n];a&&i.push(a.getShowData())}return i.sort(function(t,e){return t.getOrder()-e.getOrder()}),i},isRedTip:function(){for(var t=this.getOpenActivities(),e=0;e<t.length;e++){var i=t[e];if(i.hasRedPoint()&&i.isRedPointTip())return!0}return!1},redTipEvents:function(){for(var t=[],e=this.getOpenActivities(),i=0;i<e.length;i++){var n=e[i];n.hasRedPoint()&&(t=t.concat(n.redPointEvts()))}return t.push(td.EventNameEnum.ON_ACTIVITY_OPEN),t.push(td.EventNameEnum.ON_ACTIVITY_CLOSED),t=this.uniqEvents(t)},uniqEvents:function(t){for(var e,i=[],n={},a=0,r=t.length;a<r;a++)n[e=t[a]]||(n[e]=!0,i.push(e));return i},getActivityStartTime:function(t){var e=this.getActivityControllerById(t);return e?e.openTime:null},getActivityCloseTime:function(t){var e=this.getActivityControllerById(t);return e?e.closeTime:null}},cc._RF.pop()},{UFSdkManager:void 0}],ActivityDiamondRebateConfig:[function(t,e,i){"use strict";cc._RF.push(e,"c2e7cNuNNtLmZw1AWDekG9q","ActivityDiamondRebateConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityDiamondRebateConfig",e._tblName="diamond_rebate_config",e._datas=null,e}return n(e,t),e.prototype.init=function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.data]||(this._datas[e.data]=[]),this._datas[e.data].push(e)}},e.prototype.getDatasByDataId=function(t){return this._datas[t]?this._datas[t]:[]},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityEnum:[function(t,e,i){"use strict";cc._RF.push(e,"0c6181rW75DkbFpup5awKMt","ActivityEnum"),td.ActivityEnum={Activity:{ActivityConfig:1,ActivityFixed:2,ActivityVip:3,ActivityCross:4,ActivityFestival:5},RewardStatus:{FINISH:1,RECEIVED:2,NONE:0},SignInState:{Passed:1,Signing:2,NotSign:3,Signed:4,ReSign:5},SignInBoxState:{CAN_RECEIVE:1,UNFINISHED:2,RECEIVED:3},SuperGiftEnum:{CAN_Receive:1,ALREADY_Receive:2,CAN_NOT_Receive:3},OperateStatus:{NotOperateAble:1,OperateAble:2,Operated:3,Tempd:4},TreasureGiftEnum:{CAN_Receive:1,ALREADY_Receive:2,CAN_NOT_Receive:3,NONE:0},MonthCardPage:{WEEK:0,MONTH:1,LIFE:2},MonthCardType:{MONTH:1,LIFE:2,WEEK:3},MultipleFirstRechargePage:{Deluxe:0,Super:1,Supremacy:2},MultipleFirstRechargeType:{NONE:0,CAN_Receive:1,ALREADY_Receive:2,CAN_NOT_Receive:3},GroupPurchasePage:{Page0:0,Page1:1,Page2:2,Page3:3,Page4:4},StarDiamondEnum:{CAN_Exchange:1,CAN_NOT_Exchange:2,NONE:0},FundCardEnum:{CAN_Receive:1,ALREADY_Receive:2,CAN_NOT_Receive:3,NONE:0},FundCardType:{IS_Activated:1,NOT_Activated:2,NONE:0},ActivityParmeterKey:{ACTIVITY21:1,ACTIVITY27:2,ACTIVITY30:3,ACTIVITY41:4,ACTIVITY75:5},TreasureGiftKey:{OPEN_BOX:1,GET_REWARD:2,ONE_KEY_GET_REWARD:3},MaxFixedActivitId:100,CrossActivityStartType:1001,NewConfigActivityStartType:2e3,ActivityStatus:{Open:1,Closed:2,Sleep:4},ActivityPanelType:{ActivityPanel:1,WelfarePanel:2,VipPanel:3,CrossPanel:4},EatEnergyReceiveType:{NONE:0,CAN_RECEIVE:1,DELAY_RECEIVE:2,RECEIVED:3},EatEneryType:{LANCH:1,DINNER:2},VipGiftEnum:{CAN_BUY:1,ALREADY_BUY:2,CAN_NOT_BUY:3},GrowthPlanActiveEnum:{IS_ACTIVE:1,NOT_ACTIVE:2},GrowthPlanEnum:{CAN_Receive:1,ALREADY_Receive:2,CAN_NOT_Receive:3},GrowthPlanTableType:{LOGIN:1,LEVEL:2,CUSTOMS:3,WELFARE:4},GrowthPlanUIState:{Not_Buy:-1,NotReceiveItem:0,RedTip:1,ReceiveFull:2},GrowthPlanPage:{Login:0,Level:1,Customs:2,Welfare:3},GrowthPlanWordRes:{0:"HD_ccjj_dlgg",1:"HD_ccjj_djgg",2:"HD_ccjj_zlgg",3:"HD_ccjj_qmfl"},TurntableType:{Normal:1,Super:2},LuckySwitchType:{ScoreReward:1,PrimaryExchange:2,SeniorExchange:3},VipWelfareType:{NONE:0,FREE_REWARD:1,PAY_REWARD:2},VipWelfareBtnType:{Receive:1,Buy:2,Recharge:3},DailyDiscountType:{RECHARGE:1,BUY:2},GachaActivityShopType:{Score:1,Shop:2},ActivityTurntableShopType:{Super:1,Normal:2},RushRankType:{DUNGEON_RUSH_RANK:1,LEVEL_RUSH_RANK:2,ARENA_RUSH_RANK:3,POWER_RUSH_RANK:4,ENDLESS_RUSH_RANK:5},CostomGiftItemState:{NOT_SELECT_REWARD:1,CAN_CHARGE:2,CHARGED:3,TIMES_OUT:4},Double11IntegralState:{CAN_RECEIVE:1,UNFINISHED:2,RECEIVED:3},ActivityType:{SingleRecharge:1,AddUpRecharge:2,AccumulatedRecharge:3,ACTIVITY_TYPE_4:4,VipShop:5,DayDayRecharge:6,ACTIVITY_TYPE_7:7,ACTIVITY_TYPE_8:8,ActivityToken:9,ACTIVITY_TYPE_10:10,ACTIVITY_TYPE_11:11,ACTIVITY_TYPE_12:12,ACTIVITY_TYPE_13:13,ACTIVITY_TYPE_14:14,ACTIVITY_TYPE_15:15,ACTIVITY_TYPE_16:16,TowerMaster:17,ACTIVITY_TYPE_18:18,Activity_LuckyErnie:19,DailyPreferential:20,ACTIVITY_TYPE_21:21,AllPeopleHitNaZha2:22,AllPeopleHitNaZha3:23,AllPeopleHitNaZha4:24,ACTIVITY_TYPE_25:25,ACTIVITY_TYPE_84:84,ACTIVITY_TYPE_26:26,ACTIVITY_TYPE_27:27,ACTIVITY_TYPE_28:28,ACTIVITY_TYPE_29:29,DoubleDrop:30,RechargeRankJadeList_SingleServer:31,RechargeRankJadeList_AllServer:32,RechargeRankGoldList_SingleServer:33,RechargeRankGoldList_AllServer:34,RechargeRankSilverList_SingleServer:35,RechargeRankSilverList_AllServer:36,GodEquipGacha:37,FerroTurntable:38,TimeLimitGacha:39,Festival:40,TreasureGift:41,Monopoly:42,ACTIVITY_TYPE_43:43,ACTIVITY_TYPE_44:44,FundCardWeek:45,FundCardMonth:46,CollectWord:47,GoldHeroBackBuy:48,GoldHeroBackBuy2:2010,HeroRepay:49,GroupPurchase:50,AllPeopleHitNaZha5:51,AllPeopleHitNaZha6:52,AllPeopleHitNaZha7:53,AllPeopleHitNaZha8:54,MonthCardRenewal:55,PetExchange:56,MagpieBridgeParty:57,Activity_LuckyErnie2:60,ACTIVITY_TYPE_61:61,ContinuousRecharge:63,NewAreaPowerRank:70,GoldEquipShop:71,MagicShop:72,StepStepUp:73,HitGoldenEgg:75,HitSilverEgg:76,AddUpRecharge_2:80,AddUpRecharge_3:81,AddUpRecharge_4:82,AddUpRecharge_5:83,NewServerCarnival:90,NewServerCarnival2:91,NewServerCarnival3:92,NewServerCarnival4:93,NewServerCarnival5:94,NewServerCarnival6:95,NewServerCarnival7:96,NewServerCarnival8:97,DiamondRebate:98,RichmanPlan:99,GoldTreasure:102,LuckyTurntable:103,FirstRecharge:105,MonthCard:106,VipPackage:107,GrowthPlan:108,EatEnergy:110,VipDaily:111,StarDiamond:112,MultipleFirstRecharge:113,VipPrivilege:115,MoneyPenny:116,RechargePanel:118,SignInPanel:119,LevelGift:120,ExtensionLoginGift:121,CumulateGift:122,SpecialPackage:123,ACTIVITY_TYPE_1001:1001,ACTIVITY_TYPE_1002:1002,ACTIVITY_TYPE_1003:1003,ACTIVITY_TYPE_1004:1004,PreferentialGift:2e3,GodPetsFeedback:2001,Halloween:2002,Double11Fund:2005,Double11Rank:2006,Double11_Kill:2003,Double11_Shop:2004,Double11_Preview:2009,Double11Lotto:2007,Double11Exchange:2008},ActivityControllers:{1:t("SingleRechargeController"),2:t("AddUpRechargeController"),3:t("AccumulatedRechargeController"),4:t("LoginDayGiftController"),5:t("VipShopController"),6:t("DayDayRechargeController"),7:t("HavingTurntableController"),8:t("HeavenTurntableController"),9:t("ActivityTokenController"),10:t("RareTreasureController"),11:t("RushRankController"),12:t("ChallengeHeroController"),13:t("GachaActivityController"),14:t("TurntableController"),15:t("ActivityForecastController"),16:t("SuperGiftController"),17:t("TowerMasterController"),18:t("ConsumeActivityController"),19:t("LuckyErnieController"),20:t("DailyPreferentialController"),21:t("ActivityTokenController2"),22:t("ChallengeHeroController2"),23:t("ChallengeHeroController3"),24:t("ChallengeHeroController4"),25:t("ChallengeMonsterController"),84:t("ChallengeMonsterController2"),26:t("BaozhuController"),27:t("ResetRechargeController"),28:t("PopupWindowController"),29:t("CollectHerosController"),30:t("DoubleDropController"),31:t("RechargeRankListController1"),32:t("RechargeRankListController2"),33:t("RechargeRankListController3"),34:t("RechargeRankListController4"),35:t("RechargeRankListController5"),36:t("RechargeRankListController6"),37:t("GodEquipGachaController"),38:t("FerroTurntableController"),39:t("TimeLimitGachaController"),41:t("TreasureGiftController"),40:t("FestivalController"),42:t("MonopolyController"),43:t("CustomGiftController"),44:t("CustomGiftController"),45:t("FundCardController"),46:t("FundCardController1"),47:t("CollectWordController"),48:t("GoldHeroBackBuyController"),2010:t("GoldHeroBackBuyController2"),49:t("HeroRepayActivityController"),50:t("GroupPurchaseController"),51:t("ChallengeHeroController5"),52:t("ChallengeHeroController6"),53:t("ChallengeHeroController7"),54:t("ChallengeHeroController8"),55:t("MonthCardRenewalController"),56:t("PetExchangeController"),57:t("MagpieBridgePartyController"),60:t("LuckyErnieController2"),61:t("FortuneCatController"),63:t("ContinuousRechargeController"),70:t("NewAreaPowerRankController"),71:t("GoldEquipShopController"),72:t("MagicShopController2"),73:t("StepStepUpController"),75:t("HitGoldenEggController"),76:t("HitSilverEggController"),77:t("SingleRechargeController4"),78:t("SingleRechargeController5"),79:t("SingleRechargeController6"),80:t("AddUpRechargeController2"),81:t("AddUpRechargeController3"),82:t("AddUpRechargeController4"),83:t("AddUpRechargeController5"),90:t("NewServerCarnivalController1"),91:t("NewServerCarnivalController2"),92:t("NewServerCarnivalController3"),93:t("NewServerCarnivalController4"),94:t("NewServerCarnivalController5"),95:t("NewServerCarnivalController6"),96:t("NewServerCarnivalController7"),97:t("NewServerCarnivalController8"),98:t("DiamondRebateController"),99:t("RichmanPlanController"),102:t("GoldTreasureController"),103:t("LuckyTurntableController"),105:t("FirstRechargeController"),106:t("MonthCardController"),107:t("VipGiftController"),108:t("GrowthPlanController"),110:t("EatEnergyController"),111:t("VipDailyController"),112:t("StarDiamondController"),113:t("MultipleFirstRechargeController"),115:t("VipPrivilegeController"),118:t("RechargeController"),119:t("SignInController"),120:t("LevelGiftController"),121:t("ExtensionLoginGiftController"),122:t("CumulateGiftController"),123:t("SpecialPackageController"),1001:t("AddUpRechargeController1001"),1002:t("LoginDayGiftController1002"),1003:t("VipShopController1003"),1004:t("RushRankCrossController"),2000:t("PreferentialGiftController"),2001:t("HeroRepayActivityController"),2002:t("HalloweenController"),2005:t("Double11FundController"),2006:t("Double11RankController"),2003:t("Double11KillManager"),2004:t("Double11ShopManager"),2007:t("Double11LottoController"),2008:t("Double11ExchangeController"),2009:t("Double11PreviewManager")}},td.DragonTreasureReqType={ExchangeTicket:1,TicketPlay:2,DiamondPlay:3},cc._RF.pop()},{AccumulatedRechargeController:"AccumulatedRechargeController",ActivityForecastController:"ActivityForecastController",ActivityTokenController:"ActivityTokenController",ActivityTokenController2:"ActivityTokenController2",AddUpRechargeController:"AddUpRechargeController",AddUpRechargeController1001:"AddUpRechargeController1001",AddUpRechargeController2:"AddUpRechargeController2",AddUpRechargeController3:"AddUpRechargeController3",AddUpRechargeController4:"AddUpRechargeController4",AddUpRechargeController5:"AddUpRechargeController5",BaozhuController:"BaozhuController",ChallengeHeroController:"ChallengeHeroController",ChallengeHeroController2:"ChallengeHeroController2",ChallengeHeroController3:"ChallengeHeroController3",ChallengeHeroController4:"ChallengeHeroController4",ChallengeHeroController5:"ChallengeHeroController5",ChallengeHeroController6:"ChallengeHeroController6",ChallengeHeroController7:"ChallengeHeroController7",ChallengeHeroController8:"ChallengeHeroController8",ChallengeMonsterController:"ChallengeMonsterController",ChallengeMonsterController2:"ChallengeMonsterController2",CollectHerosController:"CollectHerosController",CollectWordController:"CollectWordController",ConsumeActivityController:"ConsumeActivityController",ContinuousRechargeController:"ContinuousRechargeController",CumulateGiftController:"CumulateGiftController",CustomGiftController:"CustomGiftController",DailyPreferentialController:"DailyPreferentialController",DayDayRechargeController:"DayDayRechargeController",DiamondRebateController:"DiamondRebateController",Double11ExchangeController:"Double11ExchangeController",Double11FundController:"Double11FundController",Double11KillManager:"Double11KillManager",Double11LottoController:"Double11LottoController",Double11PreviewManager:"Double11PreviewManager",Double11RankController:"Double11RankController",Double11ShopManager:"Double11ShopManager",DoubleDropController:"DoubleDropController",EatEnergyController:"EatEnergyController",ExtensionLoginGiftController:"ExtensionLoginGiftController",FerroTurntableController:"FerroTurntableController",FestivalController:"FestivalController",FirstRechargeController:"FirstRechargeController",FortuneCatController:"FortuneCatController",FundCardController:"FundCardController",FundCardController1:"FundCardController1",GachaActivityController:"GachaActivityController",GodEquipGachaController:"GodEquipGachaController",GoldEquipShopController:"GoldEquipShopController",GoldHeroBackBuyController:"GoldHeroBackBuyController",GoldHeroBackBuyController2:"GoldHeroBackBuyController2",GoldTreasureController:"GoldTreasureController",GroupPurchaseController:"GroupPurchaseController",GrowthPlanController:"GrowthPlanController",HalloweenController:"HalloweenController",HavingTurntableController:"HavingTurntableController",HeavenTurntableController:"HeavenTurntableController",HeroRepayActivityController:"HeroRepayActivityController",HitGoldenEggController:"HitGoldenEggController",HitSilverEggController:"HitSilverEggController",LevelGiftController:"LevelGiftController",LoginDayGiftController:"LoginDayGiftController",LoginDayGiftController1002:"LoginDayGiftController1002",LuckyErnieController:"LuckyErnieController",LuckyErnieController2:"LuckyErnieController2",LuckyTurntableController:"LuckyTurntableController",MagicShopController2:"MagicShopController2",MagpieBridgePartyController:"MagpieBridgePartyController",MonopolyController:"MonopolyController",MonthCardController:"MonthCardController",MonthCardRenewalController:"MonthCardRenewalController",MultipleFirstRechargeController:"MultipleFirstRechargeController",NewAreaPowerRankController:"NewAreaPowerRankController",NewServerCarnivalController1:"NewServerCarnivalController1",NewServerCarnivalController2:"NewServerCarnivalController2",NewServerCarnivalController3:"NewServerCarnivalController3",NewServerCarnivalController4:"NewServerCarnivalController4",NewServerCarnivalController5:"NewServerCarnivalController5",NewServerCarnivalController6:"NewServerCarnivalController6",NewServerCarnivalController7:"NewServerCarnivalController7",NewServerCarnivalController8:"NewServerCarnivalController8",PetExchangeController:"PetExchangeController",PopupWindowController:"PopupWindowController",PreferentialGiftController:"PreferentialGiftController",RareTreasureController:"RareTreasureController",RechargeController:"RechargeController",RechargeRankListController1:"RechargeRankListController1",RechargeRankListController2:"RechargeRankListController2",RechargeRankListController3:"RechargeRankListController3",RechargeRankListController4:"RechargeRankListController4",RechargeRankListController5:"RechargeRankListController5",RechargeRankListController6:"RechargeRankListController6",ResetRechargeController:"ResetRechargeController",RichmanPlanController:"RichmanPlanController",RushRankController:"RushRankController",RushRankCrossController:"RushRankCrossController",SignInController:"SignInController",SingleRechargeController:"SingleRechargeController",SingleRechargeController4:"SingleRechargeController4",SingleRechargeController5:"SingleRechargeController5",SingleRechargeController6:"SingleRechargeController6",SpecialPackageController:"SpecialPackageController",StarDiamondController:"StarDiamondController",StepStepUpController:"StepStepUpController",SuperGiftController:"SuperGiftController",TimeLimitGachaController:"TimeLimitGachaController",TowerMasterController:"TowerMasterController",TreasureGiftController:"TreasureGiftController",TurntableController:"TurntableController",VipDailyController:"VipDailyController",VipGiftController:"VipGiftController",VipPrivilegeController:"VipPrivilegeController",VipShopController:"VipShopController",VipShopController1003:"VipShopController1003"}],ActivityForecastController:[function(t,e,i){"use strict";cc._RF.push(e,"4119eHqAAxJ7asJfEvMvN7b","ActivityForecastController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_day:null,_state:null},initData:function(t){this._super(t),this._day=0,this._state=[]},getIsJumpToCharge:function(){return this._isJumpToCharge},setIsJumpToCharge:function(t){this._isJumpToCharge=t},getDay:function(){return this._day},getState:function(){return this._state},activityParse:function(t){var e=t.record;this._day=e.day,this._state=e.state},hasRedPoint:function(){return!0},redPointTip:function(){return this.isRedPointTip()},isRedPointTip:function(){return!this._state},redPointEvts:function(){return[td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],ActivityForecastPanel:[function(t,e,i){"use strict";cc._RF.push(e,"a2776kg2L1Lkqkf909xSJCJ","ActivityForecastPanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{imgBG:cc.Node,imgBG1:cc.Node,imgBG2:cc.Node,btn:cc.Node,rewards:cc.Node,img:cc.Node,timeLabel:cc.Label,tipsLabel:cc.Label,_activityData:null},onEnable:function(){this._super(),this._addLocalListeners(),this.setActivityTime(),this.initUI()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.initUI,i[e.Res_GET_ACTIVITY_INFO]=this._resInfo,t.registerEvents(i,this)},_resInfo:function(t){t===this.getActivityId()&&this.initUI()},initUI:function(){var t=this._controller.getDay(),e=this._controller.getState(),i=this._controller.getActivityData(),n=td.GetTableClass(td.TableEnum.ActivityForecastTable).getDatasByIdAndDay(i,t);if(n){td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_39_bbyr,n.bgRes1,this.imgBG1),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_39_bbyr,n.bgRes2,this.imgBG2),td.GlobalFunction.createSprite("Activity_bg/"+n.bgRes,this.imgBG),this.tipsLabel.string=n.des,this.rewards.removeAllChildren(!0);var a=this.rewards.getComponent("GridLayoutComponent");a.colCount=n.reward.length;for(var r=0;r<n.reward.length;r++){var o=td.RewardManager.getRewardDetail(n.reward[r]),s=td.GlobalFunction.createCommonIconWidget(26,o);s.setScale(.9),this.rewards.addChild(s)}a.updateLayout();for(var l=n.bigShow,c=0;c<3;c++){var u=this.node.getChildByName("item"+c);if(l[c]){u.active=!0,u.removeAllChildren(!0);var d=td.RewardManager.getRewardDetail(l[c]),h=td.GlobalFunction.createCommonIconWidget(26,d);h.setScale(.75),u.addChild(h)}else u.active=!1}this.btn.active=!e,this.img.active=e}else console.error("\u6ca1\u6570\u636e"+i+":"+t)},setActivityTime:function(){this.timeLabel.node.active=!1},_onActivityClose:function(t){this._activityId===t&&this.onDestroy()},onBtnGet:function(){this._controller.operateActivity({})}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],ActivityForecastTable:[function(t,e,i){"use strict";cc._RF.push(e,"13425II9wJO9pEFfA6N3AVG","ActivityForecastTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"Activity15Config",properties:{_tblName:"activity_15_config",_datas:null},init:function(){this._data={},this._chargeTimes=0;for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]||(t[a.data]={}),t[a.data][a.day]=a}},getDatasById:function(t){return this._data&&this._data[t]?this._data[t]:null},getDatasByIdAndDay:function(t,e){if(!this._data||!this._data[t])return null;var i=this._data[t];for(var n in i)if(parseInt(n)===e)return i[n];return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityGachaConfig:[function(t,e,i){"use strict";cc._RF.push(e,"6076aER6/pOOb60NIMwhl8d","ActivityGachaConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityGachaConfig",e._tblName="activity_gacha_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]=a}},e.prototype.getActivityGachaConfigById=function(t){return this._data&&this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityGachaTable:[function(t,e,i){"use strict";cc._RF.push(e,"8ec2cJq9VdD1KUb2N9bMYyy","ActivityGachaTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityGachaTable",properties:{_tblName:"activity_gacha_config",_datas:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.data]=a}},getSchedule:function(t){return this._data[t]?this._data[t].scheduleReward:null},getShowReward:function(t){return this._data[t]?this._data[t].showReward:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityLoginDayGiftConfig:[function(t,e,i){"use strict";cc._RF.push(e,"3a972r9h8RDm7wifbXhGS7+","ActivityLoginDayGiftConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityLoginDayGiftConfig",e._tblName="activity_login_day_gift_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getLoginDayGiftConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityMainPanel:[function(t,e,i){"use strict";cc._RF.push(e,"b700cL7XHdAlaSYxrzQoHOx","ActivityMainPanel");var n=t("PanelBase"),a=(t("CommonEnum"),t("TabController"),cc.Class({extends:n,properties:{_listView:null,_curPanelType:null,_curActivityPanel:null,_curActivityId:null,_curActivityScript:null,_curSelectedItem:null,_curActivityType:null,activityContentNode:cc.Node,item:cc.Node,_bInit:!0},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_Activity},onLoad:function(){this._super(),this._curPanelType=null,this._curActivityPanel=null,this._curActivityScript=null,this._curSelectedItem=null,this._curActivityType=null,this.item.active=!1;var t=this._root.getChildByName("switchScrollView");this._listView=t.getComponent("ListViewComponent"),this.setPanelSelfAdaption()},setPanelSelfAdaption:function(){if(td.GameResolutionPolicy.isDefaultRS()&&td.UIAdaptiveUtil.getWidthScale()!==td.UIAdaptiveUtil.getMinScale()){var t=this._root.getChildByName("imgTitleBG");td.UIAdaptiveUtil.adaptiveWinSizeWidth(t)}},onEnable:function(){this._super(),this._addEventListener(),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_MAIN_LAYER_BOTTOM_LAYER)},onDisable:function(){var t=[this._curPanelType,this._curActivityType];this._eventData=t,td.EventUtil.unregisterAllEvents(this),td.ActivityPanelManager.clearCache(),this._super()},_addEventListener:function(){var t={};t[td.EventNameEnum.REFRESH_ACTIVITY_INDEX_ITEM]=this.refreshActivityList,td.EventUtil.registerEvents(t,this)},getCurPanelParam:function(){return[this._curPanelType,this._curActivityType]},setData:function(t){t=t||[],this._super(t);var e=td.ActivityEnum;this._curPanelType=t[0]||e.Activity.ActivityConfig;var i=t[1];if(i)this._curActivityType=i;else{var n=td.ActivityDataManager.getSortedActivityShows(this._curPanelType);if(!n||0==n.length)return;this._curActivityType=n[0].getActivityType()}this._setBottomListView(),this._curActivityType?this._showPanelByActivityType(this._curActivityType):this.showFirstPanel()},_setBottomListView:function(){this._listView.removeAllItems(),this._curSelectedItem=null;for(var t=td.ActivityDataManager.getSortedActivityShows(this._curPanelType),e=0,i=t.length;e<i;e++){var n=t[e],a=cc.instantiate(this.item);a.active=!0,this._setSwitchItem(a,n,e===i-1),this._listView.pushItem(a)}this._listView.refreshListView(),td.ActivityPanelManager.setActivitiesChangeSynchronized(!0)},_setSwitchItem:function(t,e,i){var n=t.getComponent(cc.Button);n.clickEvents=[];var a=e.getBelongActivityId();t._tag=a;var r=t.getChildByName("imgActivityIcon"),o=e.getIconRes();td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_gy,o,r),t.getChildByName("imgHot").active=e.isShowHot(),t.getChildByName("line").active=!i;var s=td.ActivityDataManager.getActivityControllerById(a);this._addRedPointTips(t,s);var l=td.GlobalFunction.createClickEventHandler(this,"ActivityMainPanel","_selectActivityItem",e);n.clickEvents.push(l)},refreshActivityList:function(t){if(t&&t.activityId){var e=t.activityId;0!==td.ActivityDataManager.getSortedActivityShows(this._curPanelType).length?(t.isOpen&&e>td.ActivityEnum.MaxFixedActivitId&&td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,e),this._curActivityId===e?this.showFirstPanel():td.ActivityPanelManager.isActivitiesChangeSynchronized()||this.switchPanel(this._curActivityId,!1)):td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,td.PanelEnum.Panel_PVE_FIGHT_HOOK)}},showFirstPanel:function(){this.switchPanel(null,!1)},_showPanelByActivityType:function(t){for(var e=td.ActivityDataManager.getOpenActivities(),i=null,n=0;n<e.length;n++){var a=e[n],r=a.isInOpenStatus();if(a.getActivityType()===t&&r){i=a.getActivityId();break}}i&&this.switchPanel(i,!0)},switchPanel:function(t,e){td.ActivityPanelManager.isActivitiesChangeSynchronized()||this._setBottomListView();var i=!1;if(t)i=!!e;else{var n=this._listView.getItems();if(0===n.length)return;t=n[0]._tag,i=!0}this._doSwitchPanel(t,i)},_addRedPointTips:function(t,e){if(e.hasRedPoint()){var i=e.isRedPointTip.bind(e),n=e.redPointEvts(),a=t.getChildByName("imgActivityIcon"),r={tipEvents:n,checkFunc:i,offset:cc.v2(-15,-10)};td.RedPointUtil.createRedPoint(a,r)}},_findItem:function(t){for(var e=this._listView.getItems(),i=null,n=0;n<e.length;n++)if(e[n]._tag===t){i=e[n];break}return i},_selectActivityItem:function(t,e){var i=e.getBelongActivityId();this._curActivityId!==i&&this.switchPanel(i)},_settingSelectBtn:function(t){if(t){if(this._curSelectedItem){var e=this._curSelectedItem.getChildByName("imgSelect");e&&(e.active=!1)}var i=t.getChildByName("imgSelect");i&&(i.active=!0),this._curSelectedItem=t}},_doSwitchPanel:function(t,e){if(this._curActivityId!==t){var i=function(i){var n=td.ActivityDataManager.getActivityControllerById(t);n&&n.isInOpenStatus()?this._showPanel(i,e):this.showFirstPanel()}.bind(this);td.ActivityPanelManager.getPanel(t,i)}},_showPanel:function(t,e){this._curActivityPanel&&this._curActivityPanel.getParent()&&this._curActivityPanel.removeFromParent(!1);var i=t.panel,n=t.activityId;i.getParent()&&i.removeFromParent(!1),this._curActivityId=n,this._curActivityPanel=i;var a=td.ActivityDataManager.getActivityControllerById(n),r=a.getShowData().getPanelClassName();this._curActivityScript=this._curActivityPanel.getComponent(r),this._curActivityScript.initData(n),this._curActivityPanel.setPosition(cc.v2(0,0)),this.activityContentNode.addChild(this._curActivityPanel),this._curActivityType=a.getActivityType(),td.ActivityPanelManager.insertPanelToCache(n,this._curActivityPanel),this._settingSelectBtn(this._findItem(n)),this._curActivityScript.helpBtnCallFunc&&"function"==typeof this._curActivityScript.helpBtnCallFunc&&this._curActivityScript.helpBtnCallFunc(this),this._curActivityScript.onSelectFunc&&"function"==typeof this._curActivityScript.onSelectFunc&&this._curActivityScript.onSelectFunc(),e&&this._setListViewPosForPanelByActivityId(n),a&&a.onClicked()},_setListViewPosForPanelByActivityId:function(t){for(var e,i,n=this._listView.getItems(),a=0;a<n.length;a++)if(n[a]._tag===t){i=n[a],e=a;break}i&&this._listView.listViewJumpToRightIndex(i,e)},btnClose:function(){0!=td.ActivityDataManager.getJumpBackData().length?td.GlobalFunction.inActivityBack():this.closeCallFunc()}}));e.exports=a,cc._RF.pop()},{CommonEnum:void 0,PanelBase:void 0,TabController:void 0}],ActivityOpenModel:[function(t,e,i){"use strict";cc._RF.push(e,"cc62dn+oltLppaezdF1BMSe","ActivityOpenModel");var n=t("ActivityOpenStage"),a=cc.Class({properties:{_openConfig:null,_openStage:null},initData:function(t){this._openConfig=t;var e=t.open,i=t.close,a=t.show,r=t.cycle,o=t.recycle>0;this._openStage=new n,this._openStage.initData(e,i,a,r,o)},isCanShow:function(){return this.isOpen()&&this.isReached()},getIsCanRecycle:function(){return this._openStage.getCanRecycle()},getCycleDay:function(){return this._openStage.getCycleDay()},isOpen:function(){return!!this.getCurrentOpenStage()},getCurrentOpenStage:function(){return this._openStage.getCurrentOpenStage()},getNextOpenStage:function(){return this._openStage.getNextOpenStage()},getStartTime:function(){return this._openConfig.open},getCloseTime:function(){return this._openConfig.close},isReached:function(){var t=td.Account.getUserData();if(t){var e=t.getLevel(),i=this._openConfig.level,n="number"!=typeof i||e>=i,a=t.getVip(),r=this._openConfig.vipLevel;return n&&("number"!=typeof r||a>=r)}return!1},openTipStr:function(){var t=td.Account.getUserData();if(t){var e=t.getLevel(),i=this._openConfig.level;if(!("number"!=typeof i||e>=i))return cc.js.formatStr(td.LanguageTable.getInstance().getLanguage("levelLimiteStr1"),i);var n=t.getVip(),a=this._openConfig.vipLevel;if(!("number"!=typeof a||n>=a))return cc.js.formatStr(td.LanguageTable.getInstance().getLanguage("vipLimiteStr1"),n)}}});e.exports=a,cc._RF.pop()},{ActivityOpenStage:"ActivityOpenStage"}],ActivityOpenStage:[function(t,e,i){"use strict";cc._RF.push(e,"46522+u0UhC0YTEctGthTfD","ActivityOpenStage");var n=cc.Class({properties:{_openDay:null,_openTime:null,_closeDay:null,_closeTime:null,_showDay:null,_showTime:null,_isRecycle:null,_cycleDay:null},initData:function(t,e,i,n,a){t||(cc.assert(!e,"when open time is null, close time must be null too"),t=0,e=0),e-=1e3;var r=td.TimeUtil.getServerDate(t),o=1e3*(60*(60*r.getHours()+r.getMinutes())+r.getSeconds())+r.getMilliseconds();this._openDay=t-o,this._openTime=o,o=1e3*(60*(60*(r=td.TimeUtil.getServerDate(e)).getHours()+r.getMinutes())+r.getSeconds())+r.getMilliseconds(),this._closeDay=e-o,this._closeTime=o,o=1e3*(60*(60*(r=td.TimeUtil.getServerDate(i)).getHours()+r.getMinutes())+r.getSeconds())+r.getMilliseconds(),this._showDay=i-o,this._showTime=o,this._cycleDay=24*(n||0)*60*60*1e3,this._isRecycle=a},getCanRecycle:function(){return this._isRecycle},getCycleDay:function(){return this._cycleDay},getCurrentOpenStage:function(){var t=td.TimeUtil.getTime(),e=this._openDay+this._openTime,i=this._closeDay+this._closeTime,n=this._showDay+this._showTime;if(t<e)return null;if(!this._isRecycle&&t>=i)return null;var a={};if(this._isRecycle){var r=this._cycleDay,o=t-this._openDay,s=o%r,l=Math.floor(o/r);s>this._closeTime+(this._closeDay-this._openDay)||s<this._openTime?a=null:(a.openTime=r*l+e,a.closeTime=r*l+i,a.showTime=r*l+n)}else a.openTime=e,a.closeTime=i,a.showTime=n;return a},getNextOpenStage:function(){var t=td.TimeUtil.getTime(),e=this._openDay+this._openTime,i=this._closeDay+this._closeTime,n=this._showDay+this._showTime;if(!this._isRecycle&&t>=e)return null;var a={};if(this._isRecycle){var r=this._cycleDay,o=t-this._openDay,s=o%r,l=Math.floor(o/r)<=0?0:Math.floor(o/r);s<this._openTime?(a.openTime=r*l+e,a.closeTime=r*l+i,a.showTime=r*l+n):(a.openTime=r*(l+1)+e,a.closeTime=r*(l+1)+i,a.showTime=r*(l+1)+n)}else a.openTime=e,a.closeTime=i,a.showTime=n;return a}});e.exports=n,cc._RF.pop()},{}],ActivityPanelManager:[function(t,e,i){"use strict";cc._RF.push(e,"9a531gzSwlA2Kpo5XFDWTTf","ActivityPanelManager"),td.ActivityPanelManager={_cachedPanels:null,_activitiesChangeSynchronized:!0,init:function(){this.clearCache(),this.addEventListener()},destroyData:function(){this._activitiesChangeSynchronized=!1},addEventListener:function(){var t=td.EventNameEnum,e={};e[t.ON_ACTIVITY_OPEN]=this._onActivityOpen,e[t.ON_ACTIVITY_CLOSED]=this._onActivityClose,e[t.ACTIVITY_CONTROLLER_LOADED]=this._onActivityControllerLoaded,td.EventUtil.registerEvents(e,this)},_onActivityControllerLoaded:function(){if(this._cachedPanels&&0!==this._cachedPanels.myLen()){var t=this._cachedPanels;for(var e in t){var i=t[e];if(i){var n=i.getComponent("ActivityBasePanel");if(n){var a=n.getActivityId(),r=td.ActivityDataManager.getActivityControllerById(a);n.setActivityController(r)}}}}},_onActivityOpen:function(t){this.setActivitiesChangeSynchronized(!1);var e={activityId:t,isOpen:!0};td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_ACTIVITY_INDEX_ITEM,e)},_onActivityClose:function(t){this.setActivitiesChangeSynchronized(!1);var e={activityId:t,isOpen:!1};td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_ACTIVITY_INDEX_ITEM,e)},setActivitiesChangeSynchronized:function(t){this._activitiesChangeSynchronized=t},isActivitiesChangeSynchronized:function(){return this._activitiesChangeSynchronized},getPanel:function(t,e){var i,n=this._getPanelFromCache(t);if(n){e({panel:n,activityId:t})}else{var a=td.ActivityDataManager.getActivityControllerById(t).getShowData().getResModules(),r=(td.LoadingResType.Panel,(i={}).activityId=t,i.callback=e,i),o=this._onPanelModulesDownloaded.bind(this,null,r);gdk.rm.loadResByModule("Panel_Activity",a,null,o)}},_onPanelModulesDownloaded:function(e,i){if(e)this.getPanel(i.activityId,i.callback);else{var n=td.ActivityDataManager.getActivityControllerById(i.activityId).getShowData(),a=cc.instantiate(n.getPanelPrefab()),r=n.getPanelClassName(),o=a.getComponent(r);o||(o=a.addComponent(t(r)));var s=i.callback;if(s&&"function"==typeof s)s({panel:a,activityId:i.activityId})}},_getPanelFromCache:function(t){return this._cachedPanels[this._getCacheKey(t)]},insertPanelToCache:function(t,e){this._cachedPanels[this._getCacheKey(t)]=e},_getCacheKey:function(t){var e=td.ActivityDataManager.getActivityControllerById(t);return cc.isValid(e)?e.getActivityType()+"_"+t:"_"+t},clearCache:function(){for(var t in this._cachedPanels=this._cachedPanels||{},this._cachedPanels){var e=this._cachedPanels[t];e&&e.destroy(),delete this._cachedPanels[t]}}},cc._RF.pop()},{}],ActivityPopUpWindow:[function(t,e,i){"use strict";cc._RF.push(e,"9b7bb2FsENGhr7A6AVcuTms","ActivityPopUpWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_ActivityOpenUp},onLoad:function(){this._super(),this._activityType=td.ActivityEnum.ActivityType.ACTIVITY_TYPE_28,this._controller=td.ActivityDataManager.getActivityControllerByType(this._activityType),this._controller&&(this._activityId=this._controller.getActivityId(),this._leftTime=0,this._curDealData=null)},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.receiveRewardReturn,i[e.Res_GET_ACTIVITY_INFO]=this.refreshView,i[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,i[e.CLOSE_REWARD_DIALOG]=this.checkClose,t.registerEvents(i,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},onEnable:function(){this._super(),this._addEventListener(),this.refreshView()},onDisable:function(){this._super(),this._removeAllListeners(),this.unschedule(this._updateActivityOddTime)},_onActivityClose:function(t){this._activityId===t&&this.closeCallFunc()},refreshView:function(){for(var t=this._controller.getData(),e=1;e<=5;e++){var i=t[e-1],n=this._root.getChildByName("btn"+e),a=this._root.getChildByName("Effect_"+e);i||(n.active=!1,a.active=!1),this._controller.isReceiveById(i.id)&&(n.active=!1,a.active=!1)}},onChooseHideStatus:function(){this._bHide=!this.img.active,this.img.active=this._bHide,this._controller.setHideAutoShow(this._bHide)},onBtnCharge:function(){td.GlobalFunction.gotoRecharge()},onBtnOperateActivity:function(t,e){var i={id:parseInt(e)};this._controller.operateActivity(i)},receiveRewardReturn:function(t){if(t.activityId===this._activityId){var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);td.GlobalFunction.showRewards(i),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL)}},checkClose:function(){this._controller.isAllRecevied()&&this.closeCallFunc()},closeCallFunc:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.CLOSED_POP_WINDOW)}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],ActivityPopupWindowConfig:[function(t,e,i){"use strict";cc._RF.push(e,"9e6093bghJPc6e1LuP9fwg4","ActivityPopupWindowConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityPopupWindowConfig",e._tblName="activity_popup_window_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getActivityPopWindowConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityShowConfigTable:[function(t,e,i){"use strict";cc._RF.push(e,"cbee70nvJ9Byau2WHV+lNks","ActivityShowConfigTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityShowConfigTable",properties:{_tblName:"activity_show_config",_cfgShowData:null},init:function(){this._cfgShowData={};for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];n.uiPrefab="prefab/Activity/"+n.uiPrefab,n.bannerBgPlist&&""!==n.bannerBgPlist||n.bannerBg&&""!==n.bannerBg&&(n.bannerBg="Activity_bg/"+n.bannerBg),this._cfgShowData[n.activityType]=n}},getConfigShowDataByType:function(t){return this._cfgShowData[t]?this._cfgShowData[t]:(cc.log(cc.js.formatStr("the fixed activity is not exist with activityType = %s",t)),null)}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityShowFixedTable:[function(t,e,i){"use strict";cc._RF.push(e,"4efa2RhPhxNoK8zRFPz7Mom","ActivityShowFixedTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityShowFixedTable",properties:{_tblName:"activity_show_fixed",_fixedShowData:null},init:function(){this._fixedShowData={};for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];n.uiPrefab="prefab/Activity/"+n.uiPrefab,this._fixedShowData[n.activityType]=n}},getActivityShowData:function(){return this._fixedShowData},getFixedShowDataByType:function(t){return this._fixedShowData[t]?this._fixedShowData[t]:(cc.log(cc.js.formatStr("the fixed activity is not exist with activityType = %s",t)),null)}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityShowModel:[function(t,e,i){"use strict";cc._RF.push(e,"a09279lIKBCCY0b7iMH+t+h","ActivityShowModel");var n=cc.Class({_showData:null,_activityType:null,_belongActivityId:null,initData:function(t,e){var i;i=t>=td.ActivityEnum.MaxFixedActivitId&&t<td.ActivityEnum.CrossActivityStartType?td.GetTableClass(td.TableEnum.ActivityShowFixedTable).getFixedShowDataByType(t):td.GetTableClass(td.TableEnum.ActivityShowConfigTable).getConfigShowDataByType(t),this._showData=i||{},this._activityType=t,this._belongActivityId=e},getBelongType:function(){return this._showData.belongType||0},getBannerBgPlist:function(){return this._showData.bannerBgPlist},getBannerBg:function(){return this._showData.bannerBg},getPanelPrefab:function(){return gdk.rm.getResByUrl(this._showData.uiPrefab,cc.Prefab)},getIconRes:function(){return this._showData.icon},getIconDescRes:function(){return this._showData.iconDesc},getResModules:function(){return this._showData.modules},getPanelClassName:function(){return this._showData.activityName},getActivityType:function(){return this._activityType},getBelongActivityId:function(){return this._belongActivityId},getOrder:function(){return this._showData.order},isShowPanel:function(){var t=this._showData.openLimit;return!(t&&!td.UnlockManager.isTargetUnlock(t[0],t[1],!1))&&this._showData.isActivtyPanel},isShowHot:function(){return 1==this._showData.isHot}});e.exports=n,cc._RF.pop()},{}],ActivitySummonControllerEquip:[function(t,e,i){"use strict";cc._RF.push(e,"ad54eRRnpNO4rM6aA679nqs","ActivitySummonControllerEquip");var n=t("ActivitySummonController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{ActivitySummonController:"ActivitySummonController"}],ActivitySummonControllerGem:[function(t,e,i){"use strict";cc._RF.push(e,"34c48Zb6fhPFJUiItVeZQcO","ActivitySummonControllerGem");var n=t("ActivitySummonController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{ActivitySummonController:"ActivitySummonController"}],ActivitySummonController:[function(t,e,i){"use strict";var n;cc._RF.push(e,"42dec4C3NFI+KNBX53fPYPR","ActivitySummonController");var a=t("ActivityBaseController"),r=cc.Class({extends:a,properties:(n={_gachaSchedule:null,_rewardIdList:null,_linkedList:null,_nextFreeTime:null,_type:null,_activityBoxCfg:null},n._linkedList=null,n._showReward=null,n._maxMsgLength=null,n),initData:function(t){},getShowReward:function(){return this._showReward},activityParse:function(t){t&&this._parseReceiveQueryData(t)},_parseReceiveQueryData:function(t){var e=t.global.luckList;this._initRecord(e);var i=t.record,n=i.gachaSchedule,a=i.rewardIdList;this._rewardIdList=a,this._gachaSchedule=n,this._rewardIdList||(this._rewardIdList=[])},_initRecord:function(t){for(var e=[],i=td.UserPropertyEnum,n=td.RewardManager,a=td.Language.TopMsg38,r=td.Language.TopMsg38,o=0,s=t.length;o<s;o++){var l=t[o],c=l.attributes,u=(l.rewardObject,c[i.NickName]),d=n.getRewardDetail(l.rewardObject),h=(d.getName()||"")+"x"+(d.getCount?d.getCount():1),p=d.getQuality(),_=cc.js.formatStr(a,u,h);e=[{quality:p,msg:_=td.UFRichTextParser.parseXML(_)}].concat(e),o===s-1&&(_=cc.js.formatStr(r,u,h),this._showLuckyMsg={quality:p,msg:_})}this._luckyMsgList=e||[],this._maxMsgLength||(this._maxMsgLength=td.GetConfig("TURN_TABLE_LUCK_MESSAGE_LIMIT")),this._luckyMsgList.length>this._maxMsgLength&&(this._luckyMsgList=e.slice(0,this._maxMsgLength)),t.length>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.TURNTABLE_MSG_CHANGED,this._activityType)},getLuckyMsgList:function(){return this._luckyMsgList},getCurActiveValue:function(){return this._gachaSchedule},getActivityEntityByIndex:function(t){return this._activityBoxCfg[t-1]?this._activityBoxCfg[t-1]:null},getActiveBoxStatus:function(t){return t<=0||t>this._activityBoxCfg.length||!this._rewardIdList?td.TaskStatus.NONE:this._activityBoxCfg[t-1]?ArrayUtils.contains(this._rewardIdList,this._activityBoxCfg[t-1][0])?td.TaskStatus.Received:this._gachaSchedule>=this._activityBoxCfg[t-1][0]?td.TaskStatus.Finish:td.TaskStatus.Progress:td.TaskStatus.NONE},hasRedPoint:function(){return!0},isRedPointTip:function(){if(!this.isInOpenStatus())return!1;if(!this._rewardIdList)return!1;if(td.SummonManager.getSummonData()[this._getSummonId()].getNextFreeTime()-td.TimeUtil.getTime()<=0)return!0;for(var t=1;t<=4;t++){if(this.getActiveBoxStatus(t)===td.TaskStatus.Finish)return!0}return!1},_getSummonId:function(){var t=0;switch(this._activityType){case td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Hero:t=td.SummonEnum.SummonId.ActivityHero;break;case td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Equip:t=td.SummonEnum.SummonId.ActivityEquip;break;case td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Rune:t=td.SummonEnum.SummonId.ActivityRune}return t}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],ActivitySummonPanel:[function(t,e,i){"use strict";cc._RF.push(e,"09450j1QWhMapPPBuy39tqZ","ActivitySummonPanel");var n=t("PanelBase"),a=t("CommonIconWidget"),r=cc.Class({extends:n,properties:{_type:null,_goodsType:null,_ActivityId:null,_rewardConfig:null,_updateDt:null,_moveSpeed:null,_leftTotalLen:null,_rightTotalLen:null,textActiveProgress:cc.Label,progressBar:cc.ProgressBar,labelTimecount:cc.Label,freeTimeBg:cc.Node,labelFreeTimecount:cc.Label,imgCostBg1:cc.Node,labelCost_one:cc.Label,labelCost_ten:cc.Label,btnShopHero:cc.Node,btnShopEquip:cc.Node,leftRewardPanel:cc.Node,rightRewardPanel:cc.Node,btnSummonOne:cc.Node,lableName:cc.Label,superEquip:cc.Node,superGem:cc.Node,mecenarySprite:cc.Node,mecenaryAnima:cc.Node,labelDiscount:cc.Label,_isShowResultView:!1,_progressPos:null},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_SummonActivity,this._moveSpeed=45,this._progressPos=[0,90,230,390,560]},onEnable:function(){this._super(),this._addEventListener(),td.SummonManager.getSummonData()?this._initBtnSummonFreeTime():td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_SUMMON_INFO),this._refresActiveInfo(),this._updateDt=0,this.schedule(this.update,.1)},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this),this.unschedule(this.update),this._super()},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum;t.registerEvent(e.Res_GET_ACTIVITY_INFO,this._resInfo,this),t.registerEvent(e.REFRESH_SUMMON_INFO,this._initBtnSummonFreeTime,this),t.registerEvent(e.SHOW_SUMMON_RESULT,this._showSummonResult,this),t.registerEvent(e.ON_ACTIVITY_CLOSED,this._onActivityClose,this),t.registerEvent(e.ON_ACTIVITY_OPERATE_SUCCESS,this.onReceiveOperation,this)},_onActivityClose:function(t){this._ActivityId===t&&td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_HomePage)},setData:function(t){this._super(t);var e=td.ActivityDataManager.getActivityControllerByType(t);if(e){this._type=t,this._ActivityId=e.getActivityId();var i=e.getShowReward();this._leftTotalLen=165*i[1].length,this._rightTotalLen=165*i[2].length,this._rewardConfig=i,this.btnShopHero.active=this._type==td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Hero,this.btnShopEquip.active=this._type==td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Equip,this._refresh(),this._initSuperReward(i[0])}else this.hide()},update:function(t){if(this._updateDt+=t,this._rewardConfig){var e=this._updateDt*this._moveSpeed,i=this.leftRewardPanel;e%=this._leftTotalLen;for(var n=Math.floor(e/200),r=e%200-300,o=this._rewardConfig[1],s=o.length,l=0,c=s-n;l<=3;c++,l++){c>=s&&(c=0);var u=o[c],d=td.RewardManager.getRewardDetail(u);(p=i.getChildByName("icon"+l))?p.getComponent(a).setData(d):((p=td.GlobalFunction.createCommonIconWidget(23,d)).name="icon"+l,i.addChild(p)),p.setPosition(0,r+200*l),p.getComponent(a).setNum(u[2]),p.getComponent(a).setHeadClickShowInfo()}e=-this._updateDt*this._moveSpeed;i=this.rightRewardPanel,e%=this._rightTotalLen,n=Math.floor(e/200),r=e%200-200;var h=this._rewardConfig[2];l=0;for(c=(s=h.length)-1+n;l<=3;c--,l++){c<0&&(c=s-1);var p;u=h[c],d=td.RewardManager.getRewardDetail(u);(p=i.getChildByName("icon"+l))?p.getComponent(a).setData(d):((p=td.GlobalFunction.createCommonIconWidget(23,d)).name="icon"+l,i.addChild(p)),p.setPosition(0,r+200*l),p.getComponent(a).setNum(u[2]),p.getComponent(a).setHeadClickShowInfo()}}},_resInfo:function(t){t===this._ActivityId&&this._refresh()},_refresh:function(){this._initBtnSummonFreeTime(),this._refresActiveInfo(),this._setActivityTime()},helpDesc:function(){var t=td.ActivityDataManager.getActivityControllerByType(this._type);if(t){var e=t.getActivityType(),i={};i.panelName=td.PanelEnum.Window_Help,i.callback={func:function(t,e){e.showHelp(t)},param:[this._panelEnum,e]},td.GlobalFunction.showPanel(i)}},btnRank:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_Lucky_Rank,this._type)},_getShopType:function(){var t=td.ActivityDataManager.getActivityControllerByType(this._type);if(t){var e=0;switch(t.getActivityType()){case td.ActivityManager.ActivityType.SUMMON_ACTVITY_Hero:e=td.ShopType.ActivityHero;break;case td.ActivityManager.ActivityType.SUMMON_ACTVITY_Equip:e=td.ShopType.ActivityEquip}return e}},btnShop:function(t,e){},btnSummon:function(t){this._isShowResultView=!1,td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_SUMMON,{id:this._getSummonId(),times:1})},btnSummonTen:function(t){this._isShowResultView=!1,td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_SUMMON,{id:this._getSummonId(),times:10})},_getActivityShopType:function(){var t=td.ActivityDataManager.getActivityControllerByType(this._type);if(t){var e=0;switch(t.getActivityType()){case td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Hero:e=td.ActivityEnum.ActivityType.FamousGeneralShop;break;case td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Equip:e=td.ActivityEnum.ActivityType.GoldEquipShop}return e}},_getSummonId:function(){var t=td.ActivityDataManager.getActivityControllerByType(this._type);if(t){var e=0;switch(t.getActivityType()){case td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Hero:e=td.SummonEnum.SummonId.ActivityHero;break;case td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Equip:e=td.SummonEnum.SummonId.ActivityEquip;break;case td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Rune:e=td.SummonEnum.SummonId.ActivityRune}return e}},_initBtnSummonFreeTime:function(){if(td.ActivityDataManager.getActivityControllerByType(this._type)){var t=td.SummonManager.getSummonData()[this._getSummonId()],e=t.getNormalCost().getCount(),i=t.getNextFreeTime()-td.TimeUtil.getTime();this.freeTimeBg.active=i>0,this.imgCostBg1.active=i>0,this.labelCost_one.string=e,this.labelCost_ten.string=10*e*t.getDiscount(),this.labelDiscount.string=Math.floor(10*t.getDiscount()),td.RedPointUtil.createRedPointSimple(this.btnSummonOne,{x:-4,y:-4},i<=0);var n=this.btnSummonOne.getChildByName("Label");n.getComponent(cc.Label).string=i<=0?td.Language.freeTips:td.Language.playOnce,i>0&&td.GlobalFunction.addTimeLabel2(this.labelFreeTimecount,i,this._initBtnSummonFreeTime.bind(this),"hh:mm:ss")}},_setActivityTime:function(){var t=td.ActivityDataManager.getActivityControllerByType(this._type);if(t){var e=t.getCurrentOpenStage().closeTime-td.TimeUtil.getTime();td.GlobalFunction.addTimeLabel2(this.labelTimecount,e,this._timeout.bind(this),"dd:hh:mm:ss")}},_timeout:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_HomePage)},_refresActiveInfo:function(){var t=td.ActivityDataManager.getActivityControllerByType(this._type);if(t){var e=t.getCurActiveValue(),i=t.getActivityEntityByIndex(4),n=100;i&&(n=i[0]),e>n&&(e=n),this.textActiveProgress.string=td.Language.progress+": "+e;for(var a=gdk.rm.getResByUrl(td.resDef.pngPlist.itemIcon,cc.SpriteAtlas),r=-1,o=0;o<4;o++){var s=t.getActivityEntityByIndex(o+1);this._root.getChildByName("imgProgressBg_"+(o+1)).getChildByName("labelNum").getComponent(cc.Label).string=s[0];var l=this._root.getChildByName("btnBox_"+(o+1));l._tag=o+1;var c=td.GlobalFunction.createClickEventHandler(this,"ActivitySummonPanel","_imgActiveRewardClicked",s);l.getComponent(cc.Button).clickEvents=[],l.getComponent(cc.Button).clickEvents.push(c);var u=t.getActiveBoxStatus(o+1);td.RedPointUtil.createRedPointSimple(l,{x:-10,y:-10},u===td.TaskStatus.Finish),u===td.TaskStatus.Progress&&r<0&&(r=o);var d="";u===td.TaskStatus.Progress||u===td.TaskStatus.Finish?d=o<1?"icon_baoxiang_01":o<3?"icon_baoxiang_03":"icon_baoxiang_05":u===td.TaskStatus.Received&&(d=o<1?"icon_baoxiang_02":o<3?"icon_baoxiang_04":"icon_baoxiang_06"),l.getComponent(cc.Sprite).spriteFrame=a.getSpriteFrame(d)}r<0&&(r=3);var h=this.progressBar.node.getChildByName("bar"),p=this._progressPos[r],_=this._progressPos[r+1],g=t.getActivityEntityByIndex(r)||[0],f=t.getActivityEntityByIndex(r+1);h.width=p+(_-p)*(e-g[0])/(f[0]-g[0])}},_showSummonResult:function(t){this._isShowResultView||(this._isShowResultView=!0,td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_SummonResult,t))},_imgActiveRewardClicked:function(t,e){var i=e,n=t.target._tag,a=td.ActivityDataManager.getActivityControllerByType(this._type);a&&(a.getActiveBoxStatus(n)===td.TaskStatus.Finish?a.operateActivity({id:i[0],activityId:a.getActivityId()}):td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_RewardBoxPreview,td.RewardManager.getRewardListDetailArray(i[1])))},_initSuperReward:function(t){this.mecenarySprite.active=this._type===td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Hero,this.superEquip.active=this._type===td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Equip,this.superGem.active=this._type===td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Rune;var e=td.RewardManager.parseRewardListDetail([t])[0];if(this.lableName.string=e.getName()+"X"+e.getCount(),this._type===td.ActivityEnum.ActivityType.SUMMON_ACTVITY_Hero){td.GlobalFunction.showMercenaryFigureAnimation(this.mecenarySprite,e);var i=td.RelifeAnimRes[2],n=td.RelifeAnimName[2];td.GlobalFunction.downAndPlayAnim(this.mecenaryAnima,i,n,"reliftAnim")}var a=td.GlobalFunction.createClickEventHandler(this,"ActivitySummonPanel","onShowTip",t);this.superGem.getComponent(cc.Button).clickEvents.push(a),this.superEquip.getComponent(cc.Button).clickEvents.push(a),this.mecenarySprite.getComponent(cc.Button).clickEvents.push(a)},onShowTip:function(t,e){var i=td.RewardManager.parseRewardListDetail([e]);td.ItemUtil.showItemInfo(i[0])},onReceiveOperation:function(t){if(t.activityId===this._ActivityId){var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);td.GlobalFunction.showRewards(i)}}});e.exports=r,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",PanelBase:void 0}],ActivityTokenConfig:[function(t,e,i){"use strict";cc._RF.push(e,"db4e2B6Z+BJHJYZGErZEg6y","ActivityTokenConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityTokenConfig",properties:{_tblName:"activity_token_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e},getDataByDataIdAndLv:function(t,e){for(var i=this._datas[t],n=0;n<i.length;n++)if(i[n].level===e)return i[n];return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityTokenController2:[function(t,e,i){"use strict";cc._RF.push(e,"fc285atNjtD4ZCSUUTTu1re","ActivityTokenController2");var n=t("ActivityTokenController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{ActivityTokenController:"ActivityTokenController"}],ActivityTokenController:[function(t,e,i){"use strict";cc._RF.push(e,"adf14BecaBJI6ykcBNncmNH","ActivityTokenController");var n=t("../../../../SDK/SDKCommonEnum"),a=t("ActivityBaseController"),r=t("ActivityTokenModel"),o=t("ActivityTokenRankModel"),s=cc.Class({extends:a,properties:{_modelList:null,_rankConfig:null,_active:null,_curLevel:null,_curExp:null,_receiveMap:null,_rankList:null,_showRankNum:null},initData:function(t){this._super(t),this.clearData(),this._initActivityToken()},activityParse:function(t){t&&this._parseReceiveQueryData(t)},_parseReceiveQueryData:function(t){var e=t.global||{},i=t.record;(this._active=i.active,this._curLevel=i.level,this._curExp=i.exp,this._receiveMap=i.receiveMap||this._receiveMap||{},this._rankList=e.rankList||this._rankList||[],this._rankList.sort(function(t,e){return t.rank-e.rank}),!this._isInited&&(this._isInited=!0),this._curDataId!=this.getActivityData()&&this._initActivityToken(),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_ACTIVITYTOKEN_INFO,this._activityType),this._active)&&(td.LocalStorageUtil.readRealLocal(td.LocalRealKey.FIRST_BATTLE_TOKEN)||(td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_POINT_REPORT,n.CHECK_POINT_TYPE.FIRST_BATTLE_TOKEN),td.LocalStorageUtil.writeRealLocal(td.LocalRealKey.FIRST_BATTLE_TOKEN,!0)))},_initActivityToken:function(){this._modelList=[];for(var t=this.getActivityData(),e=td.GetTableClass(td.TableEnum.ActivityTokenConfig).getDatasOfDataId(t),i=0,n=e.length;i<n;i++){var a=e[i];(s=new r).setData(a),this._modelList[i]=s}this._modelList.sort(function(t,e){return t.getLevel()-e.getLevel()}),this._rankConfig={};for(i=0,n=(e=td.GetTableClass(td.TableEnum.ActivityTokenRankConfig).getDatasOfDataId(t)).length;i<n;i++){var s;a=e[i];(s=new o).setData(a);var l=s.getRank();this._rankConfig[l]=s,i==n-1&&(this._showRankNum=l)}},clearData:function(){this._modelList=[]},getDataList:function(){return this._modelList},getDataByLevel:function(t){for(var e,i=this._modelList,n=0,a=i.length;n<a;n++)t===i[n].getLevel()&&(e=i[n]);return e||cc.log("activity token level is error,level = ",t),e},isActivityTokenAdvance:function(){return this._active},getCurActivityTokenLevel:function(){return this._curLevel},getTotalExpToLevel:function(t){for(var e=0;t>0;){var i=this.getDataByLevel(t);if(!i){cc.log("cannot find activityToken data of level ",t),e=-1;break}e+=i.getExp(),t--}return e},getCurActivityTokenExp:function(){var t=this.getCurActivityTokenLevel(),e=this.getTotalExpToLevel(t);return this._curExp+e},getBaseRewardIsReceive:function(t){return ArrayUtils.contains(this._receiveMap.false,t)},getHigeRewardIsReceive:function(t){return ArrayUtils.contains(this._receiveMap.true,t)},getLevelToScroll:function(){for(var t=this.getCurActivityTokenLevel(),e=this.getDataList(),i=this.isActivityTokenAdvance(),n=1;n<=t;n++){var a=this.getBaseRewardIsReceive(n),r=this.getHigeRewardIsReceive(n);if(!a||!r&&i)return n}return t==e.length?t:t+1},getPointRank:function(){var t,e=this._showRankNum;if(this._rankList.length>e){t=[];for(var i=0,n=e;i<n;i++)t.push(this._rankList[i])}else t=this._rankList;var a=td.GlobalFunction.copyList(t);for(i=a.length;i<e;i++)a.push({rank:i+1});return a},getPointRewardsByRank:function(t){var e,i=this._rankConfig;for(var n in i)if(t<=n){e=i[n];break}return e.getRewards()},getMyRank:function(){for(var t=-1,e=this._rankList,i=td.UserPropertyEnum,n=td.Account.getUserData(),a=(n.getNickName(),n.getGamerId()),r=0,o=e.length;r<o;r++){var s=e[r];if(s.attributes[i.GamerId]===a){t=s.rank;break}}return t},getRankList:function(){return this._rankList||[]},getCanUpgradeLevel:function(t){var e,i=this.getCurActivityTokenExp(),n=this._curLevel,a=this._modelList,r=i+t,o=n;e=0==n?0:this.getTotalExpToLevel(n);for(var s=!1,l=0,c=a.length-1;l<c;l++){var u=a[l];if(s||0==n){if(!((e+=u.getExp())<=r))break;o++}else n==u.getLevel()&&(s=!0)}return o-n},getRewardListByLv:function(t){for(var e=[],i=this.getActivityData(),n=1;n<=t;n++){var a=td.GetTableClass(td.TableEnum.ActivityTokenConfig).getDataByDataIdAndLv(i,n);1===a.showUI&&(e=e.concat(a.advancedRewards))}var r={};for(n=0;n<e.length;n++)r[e[n][1]]?r[e[n][1]].count=r[e[n][1]].count+e[n][2]:r[e[n][1]]={type:e[n][0],id:e[n][1],count:e[n][2]};return r},setReceiveTask:function(t){this._taskInfo=t},getReceiveTask:function(){return this._taskInfo},getTokenRechargeData:function(){var t=this.getActivityData(),e=td.GetConfig("ACTIVITY_TOKEN_CHARGE_ID");this._activityType==td.ActivityEnum.ActivityType.ACTIVITY_TYPE_21&&(e=td.GetConfig("ACTIVITY_SINGLE_TOKEN_CHARGE_ID"));for(var i=null,n=0;n<e.length;n++){var a=e[n];a[0]==t&&(i=a[1])}return i?td.RechargeManager.getRechargeDataById(i):null},hasRedPoint:function(){return!0},hadRewardNotReceive:function(){for(var t=this._curLevel,e=this.isActivityTokenAdvance();t>0;){if(!ArrayUtils.contains(this._receiveMap.false,t))return!0;if(e&&!ArrayUtils.contains(this._receiveMap.true,t))return!0;t--}return!1},rewardRedPointTip:function(){return this.hadRewardNotReceive()},taskRedPointTip:function(){var t=[],e=td.TaskType.ACTIVITY_TOKEN;this.getActivityType()===td.ActivityEnum.ActivityType.ACTIVITY_TYPE_21&&(e=td.TaskType.ACTIVITY_21_TOKEN);var i=td.GetTableClass(td.TableEnum.TaskTable).getTaskByType(e);if(i)for(var n=0;n<i.length;n++){var a=td.TaskManager.getTaskById(i[n].taskId);if(a){for(var r=!1,o=0;o<t.length;o++)if(t[o].getGroupId()===a.getGroupId()){r=!0;break}if(!r&&a.getStatus()===td.TaskStatus.Finish)return!0}}return!1},redPointEvts:function(){return[td.EventNameEnum.REFRESH_ACTIVITYTOKEN_INFO,td.EventNameEnum.Res_GET_TASK_INFO,td.EventNameEnum.Res_TASK_RECEIVE]},isRedPointTip:function(){return this.rewardRedPointTip()||this.taskRedPointTip()}});e.exports=s,cc._RF.pop()},{"../../../../SDK/SDKCommonEnum":void 0,ActivityBaseController:"ActivityBaseController",ActivityTokenModel:"ActivityTokenModel",ActivityTokenRankModel:"ActivityTokenRankModel"}],ActivityTokenModel:[function(t,e,i){"use strict";cc._RF.push(e,"ad633+URIxOiL2+OnBqMrst","ActivityTokenModel");var n=cc.Class({properties:{_data:null,_level:null,_exp:null,_normalRewards:null,_advancedRewards:null},setData:function(t){this._data=t.data,this._level=t.level,this._exp=t.exp,this._normalRewards=td.RewardManager.parseRewardListDetail(t.normalRewards),this._advancedRewards=td.RewardManager.parseRewardListDetail(t.advancedRewards)},getData:function(){return this._data},getLevel:function(){return this._level},getExp:function(){return this._exp},getNormalRewards:function(){return this._normalRewards},getAdvancedRewards:function(){return this._advancedRewards}});e.exports=n,cc._RF.pop()},{}],ActivityTokenPanel:[function(t,e,i){"use strict";cc._RF.push(e,"cc26avvJhhCWbC9/eo1zK1C","ActivityTokenPanel");var n=t("ActivityBasePanel"),a=(t("OptimizeVerticalListView"),t("TabController")),r=cc.Class({extends:n,properties:{labelLeftTime:cc.Label,labelCurLevel:cc.Label,labelExpValue:cc.Label,labelActivityTokenName:cc.Label,btnAddExp:cc.Button,btnAdvanceActivityToken:cc.Button,btnQuickReceive:cc.Button,btnActivityTokenReward:cc.Node,btnActivityTokenTask:cc.Node,btnActivityTokenPointRank:cc.Node,msgInfoPanel:cc.Node,rewardPanel:cc.Node,taskPanel:cc.Node,pointRankPanel:cc.Node,contentLevelNode:cc.Node,scrollViewLevel:cc.ScrollView,scrollViewReward:cc.ScrollView,scrollViewTask:cc.ScrollView,scrollViewPointRank:cc.ScrollView,progress:cc.ProgressBar,labelMyRank:cc.Label,labelMyPoint:cc.Label},initData:function(t){this._super(t)},onEnable:function(){this._super(),this._firstEnter=!0,this._setActivityTime(),this._initSVBar(),this._addLocalListeners(),this.schedule(this.updateLeftTime,1),this._showTab=0,this._tableController||(this._tableController=new a,this.btnActivityTokenReward._tag=1,this.btnActivityTokenTask._tag=2,this.btnActivityTokenPointRank._tag=3,this._tableController.init([this.btnActivityTokenReward,this.btnActivityTokenTask,this.btnActivityTokenPointRank],this,1)),this.btnActivityTokenPointRank.active=this._controller.getActivityType()===td.ActivityEnum.ActivityType.ActivityToken,this._tableController._showTab(1)},onDisable:function(){this._curTag=-1,this.unschedule(this.updateLeftTime),this._removeAllListeners(),this._super()},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.Res_TASK_RECEIVE]=this._taskInfoUpdated,i[e.Res_GET_TASK_INFO]=this._onDataUpdated,i[e.REFRESH_ACTIVITYTOKEN_INFO]=this._onDataUpdated,t.registerEvents(i,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},updateLeftTime:function(t){this._setActivityTime()},_setActivityTime:function(){var t=this.getActivityLeftTimeStr(),e=cc.js.formatStr(td.Language.leftTime,t);this.labelLeftTime.string=e},_initSVBar:function(){var t=120*this._controller.getDataList().length,e=this.contentLevelNode.getContentSize();e.height=t,this.contentLevelNode.setContentSize(e);var i=this.contentLevelNode.getChildByName("progressBar");(e=i.getContentSize()).height=t,i.setContentSize(e),i.getComponent(cc.ProgressBar).totalLength=t},_taskInfoUpdated:function(){if(2==this._curTag){var t=this._controller.getReceiveTask();if(t){var e=new td.BroadcastContent(341),i=new td.BroadcastParam(t.getActive());e.setMainParam([i]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e),this._onDataUpdated()}}},_onDataUpdated:function(t){var e=this._controller;e&&(t&&t!=e.getActivityType()||this._refreshInfo())},showTab:function(t){this._curTag!=t&&(this.rewardPanel.active=1==t,this.taskPanel.active=2==t,this.pointRankPanel.active=3==t,this._curTag=t,this._refreshInfo())},_refreshInfo:function(){this._controller&&(this._curTag=this._curTag||1,this._refreshBaseMsg(),1==this._curTag?(this._refreshRewardPanel(),this._refreshLastItem()):2==this._curTag?this._refreshTaskPanel():this._refreshPointRankPanel(),this._firstEnter=!1)},_refreshBaseMsg:function(){var t=this._controller,e=t.getCurActivityTokenLevel();this.labelCurLevel.string=e;var i=t.getTotalExpToLevel(e+1),n=t.getCurActivityTokenExp();this.labelExpValue.string=-1==i?n:n+"/"+i;var a=td.Language.composeItemType.split("|"),r=t.isActivityTokenAdvance()?a[2]:a[0];this.labelActivityTokenName.string=r+td.Language.activityToken,this.msgInfoPanel.getChildByName("expProgressBar").getComponent(cc.ProgressBar).progress=-1==i?n:n/i,this.btnAdvanceActivityToken.node.active=!t.isActivityTokenAdvance(),td.RedPointUtil.createRedPointSimple(this.btnActivityTokenTask,{x:-15,y:-15},t.taskRedPointTip())},_refreshRewardPanel:function(){var t=this._controller;td.RedPointUtil.createRedPointSimple(this.btnQuickReceive.node,{x:-15,y:-15},t.rewardRedPointTip());var e=t.getDataList(),i=this.scrollViewReward.getComponent("OptimizeVerticalListView");i.setCustomData(this._controller.getActivityType());var n=t.getLevelToScroll(),a=t.getCurActivityTokenLevel();this._firstEnter?(i.setData(e),i.scrollToRow(n-1)):i.refreshCurList(e),this.progress.getComponent(cc.ProgressBar).progress=a/e.length;var r=this.scrollViewLevel.getContentPosition();r.y=this.scrollViewReward.getContentPosition().y,this.scrollViewLevel.setContentPosition(r)},_refreshLastItem:function(t){var e=this._controller,i=this._controller.getCurActivityTokenLevel();t||(t=i%10==0&&0!=i?i:i-i%10+10),this._curLastItemLevel=t;var n=e.getDataByLevel(t),a=this.rewardPanel.getChildByName("lastItem"),r=a.getChildByName("levelBg"),o=a.getChildByName("levelNum"),s=a.getChildByName("baseReward"),l=a.getChildByName("superRewardLayer"),c=n.getLevel(),u=e.getCurActivityTokenLevel()>=c?"HD_xl_djdi02":"HD_xl_djdi01";td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_35_xl,u,r),o.getComponent(cc.Label).string=c;var d=n.getNormalRewards()[0],h=s.getChildByName("normalReward");h?h.getComponent("CommonIconWidget").setData(d):((h=td.GlobalFunction.createCommonIconWidget(26,d)).setScale(.8),h.setPosition(cc.v2(80,45)),h.setName("normalReward"),s.addChild(h));var p=h.getChildByName("imgHadReceive"),_=(R=e.getBaseRewardIsReceive(c))||i>=c;p?p.active=_:_&&(p=new cc.Node,h.addChild(p,100),p.setName("imgHadReceive"),p.x=-20,p.y=32),_&&(R?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_yilingqu_03",p):td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY2_Common,"GY2_xl_kelingqu",p));for(var g=e.isActivityTokenAdvance(),f=n.getAdvancedRewards(),v=l.getChildrenCount(),m=0;m<f.length;m++){var y=f[m];if(A=l.getChildByName("icon_"+m))A.getComponent("CommonIconWidget").setData(y);else(A=td.GlobalFunction.createCommonIconWidget(26,y)).setName("icon_"+m),l.addChild(A),A.scale=.8,A.getComponent("CommonIconWidget").setHeadClickShowInfo();var E=A.getChildByName("imgLock"),T=A.getChildByName("imgMask");E?(E.active=!g,T.active=!g):g||(T=new cc.Node,A.addChild(T,100),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_mengceng",T),T.setName("imgMask"),T.scale=1,T.x=0,T.y=0,E=new cc.Node,A.addChild(E,100),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_35_xl,"HD_xl_suo",E),E.setName("imgLock"),E.scale=.8,E.x=-30,E.y=34);var C=A.getChildByName("imgReceived"),R=this._controller.getHigeRewardIsReceive(c),S=this._controller.isActivityTokenAdvance();_=R||S&&i>=c;if(C?C.active=_:_&&(C=new cc.Node,A.addChild(C,100),C.setName("imgReceived"),C.x=-20,C.y=32),_){var I=R?"GY0_wz_yilingqu_03":"GY2_xl_kelingqu";R?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,I,C):td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY2_Common,I,C)}}for(;m<v;m++){var A;(A=l.getChildByName("icon_"+m))&&A.removeFromParent()}l.setContentSize(cc.size(100*f.length,110)),l.getComponent(cc.Layout).cellSize=cc.size(100,100),l.getComponent(cc.Layout)._layoutSize=cc.size(100*f.length,110),l.getComponent(cc.Layout).updateLayout()},_refreshTaskPanel:function(){var t=[],e=td.TaskType.ACTIVITY_TOKEN;this._controller.getActivityType()===td.ActivityEnum.ActivityType.ACTIVITY_TYPE_21&&(e=td.TaskType.ACTIVITY_21_TOKEN);var i=td.GetTableClass(td.TableEnum.TaskTable).getTaskByType(e);if(i)for(var n=0;n<i.length;n++){var a=td.TaskManager.getTaskById(i[n].taskId);if(a){for(var r=!1,o=0;o<t.length;o++)if(t[o].getGroupId()===a.getGroupId()){r=!0;break}!r&&(a.getStatus()===td.TaskStatus.Progress||a.getStatus()===td.TaskStatus.Finish)&&(t[t.length]=a)}}t.sort(function(t,e){return t.getStatus()>e.getStatus()?-1:t.getStatus()<e.getStatus()?1:t.getSortRank()-e.getSortRank()});var s=this.scrollViewTask.getComponent("OptimizeVerticalListView");s.setCustomData(this._controller.getActivityType()),this._firstEnter?s.setData(t):s.refreshCurList(t)},_refreshPointRankPanel:function(){var t=this._controller,e=this.labelMyRank,i=this.labelMyPoint;this.pointRankPanel.getChildByName("tipLayer").getChildByName("pointNum").getComponent(cc.Label).string=td.GetConfig("ACTIVITY_TOKEN_RANK_LIMIT");var n=t.getMyRank();e.getComponent(cc.Label).string=-1==n?td.Language.notInRank:n,i.getComponent(cc.Label).string=t.getCurActivityTokenExp();var a=t.getPointRank(),r=this.scrollViewPointRank.getComponent("OptimizeVerticalListView"),o={dataList:a,controller:t};r.setCustomData(o),r.setData(a)},scrollRewardSV:function(t,e){for(var i=this.scrollViewLevel.getContentPosition(),n=10,a=this._controller.getDataList().length/10;a>1;a--)if(i.y>1200*(a-2)+1e3){n=10*a;break}this._curLastItemLevel!=n&&this._refreshLastItem(n),i.y=t.getContentPosition().y,this.scrollViewLevel.setContentPosition(i)},onClickAddExp:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_ActivityTokenPointBuy,this._controller.getActivityType())},onClickAdvance:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_ActivateActivityToken,this._controller.getActivityType())},onClickQuickReceive:function(){if(this._controller.hadRewardNotReceive()){this._controller.operateActivity({id:0,parmeterMap:{11:2}})}}});e.exports=r,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0,TabController:void 0}],ActivityTokenPointBuyListView:[function(t,e,i){"use strict";cc._RF.push(e,"13bcehTGm1PBqM2dyrHtmBu","ActivityTokenPointBuyListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{_controller:null},setData:function(t){var e=t.dataList;this._controller=t.controller,this._super(e)},setItemView:function(t,e){var i=t.getChildByName("imgDiscount"),n=(i.getChildByName("label"),t.getChildByName("expNum")),a=t.getChildByName("label2"),r=t.getChildByName("label4"),o=t.getChildByName("label5"),s=t.getChildByName("btnGet"),l=s.getChildByName("labelNum");i.active=!1,n.getComponent(cc.Label).string="X"+e[0],a.getComponent(cc.Label).string=e[0]+td.Language.score;var c=this._controller.getCanUpgradeLevel(e[0]);r.getComponent(cc.Label).string=c,r.getComponent(cc.Label)._forceUpdateRenderData(),o.x=r.x+r.width,l.getComponent(cc.Label).string=e[1].getCount();var u={data:e[0]},d=s.getComponent(cc.Button);d.clickEvents=[];var h=new cc.Component.EventHandler;return h.target=this.node,h.component="ActivityTokenPointBuyListView",h.handler="clickBuyExp",h.customEventData=u,d.clickEvents.push(h),t},clickBuyExp:function(t,e){var i={id:e.data,parmeterMap:{11:1}};this._controller.operateActivity(i)}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],ActivityTokenPointBuyWindow:[function(t,e,i){"use strict";cc._RF.push(e,"a8e07YqXrtL+KiLj3uXAE+k","ActivityTokenPointBuyWindow");var n=t("PanelBase");cc.Class({extends:n,properties:{scrollview:cc.ScrollView},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_ActivityTokenPointBuy},addListener:function(){var t=td.EventUtil,e=td.EventNameEnum;t.registerEvent(e.REFRESH_ACTIVITYTOKEN_INFO,this.refreshSV,this)},onLoad:function(){if(!this._buyExpCost){this._buyExpCost=[];for(var t=td.GetConfig("ACTIVITY_TOKEN_BUY_EXP_COST"),e=0,i=t.length;e<i;e++){var n=t[e],a=[];a.push(n[0]);var r=td.GlobalFunction.getShareConfigUpCostDetail("ACTIVITY_TOKEN_BUY_EXP_COST",n[0]);a.push(r),this._buyExpCost.push(a)}}},onEnable:function(){this._super(),this.addListener()},onDisable:function(){this._showExpChange=!1,td.EventUtil.unregisterAllEvents(this),this._super()},setData:function(t){this._activityType=t||td.ActivityEnum.ActivityType.ActivityToken,this.refreshSV();var e=td.ActivityDataManager.getActivityControllerByType(this._activityType);this._curExp=e.getCurActivityTokenExp(),this._curLevel=e.getCurActivityTokenLevel(),this._showExpChange=!0},refreshSV:function(){var t={dataList:this._buyExpCost,controller:td.ActivityDataManager.getActivityControllerByType(this._activityType)};this.scrollview.getComponent("ActivityTokenPointBuyListView").setData(t),this._showExpChange&&this._checkExpChange()},_checkExpChange:function(){var t=this._curExp,e=this._curLevel,i=td.ActivityDataManager.getActivityControllerByType(this._activityType);this._curExp=i.getCurActivityTokenExp(),this._curLevel=i.getCurActivityTokenLevel();var n=this._curExp-t,a=this._curLevel-e;if(n>0){var r=new td.BroadcastContent(334),o=new td.BroadcastParam(n);r.setMainParam([o]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,r)}if(a>0){r=new td.BroadcastContent(335),o=new td.BroadcastParam(this._curLevel);r.setMainParam([o]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,r)}}});cc._RF.pop()},{PanelBase:void 0}],ActivityTokenPointRankItem:[function(t,e,i){"use strict";cc._RF.push(e,"d01f4y5TqFBHoR3W/IVwO5i","ActivityTokenPointRankItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{_controller:null},updateItem:function(t,e){this._super(t,e),this._controller=this._customData.controller;var i=e.rank,n=this.node.getChildByName("topThreeImg"),a=this.node.getChildByName("rankLabel"),r=this.node.getChildByName("rewardLayer"),o=this.node.getChildByName("playerNameLabel"),s=this.node.getChildByName("serverNameLabel"),l=this.node.getChildByName("pointLabel"),c=i<=3;if(n.active=c,a.active=!c,c){var u=gdk.rm.getResByUrl(td.resDef.pngPlist.GY0_Common,cc.SpriteAtlas);n.getComponent(cc.Sprite).spriteFrame=u.getSpriteFrame("GY0_paiming_0"+i)}else a.getComponent(cc.Label).string=i;for(var d=this._controller.getPointRewardsByRank(i),h=r.getChildrenCount(),p=0;p<d.length;p++){var _=d[p];if(g=r.getChildByName("icon_"+p))g.getComponent("CommonIconWidget").setData(_);else(g=td.GlobalFunction.createCommonIconWidget(26,_)).setName("icon_"+p),r.addChild(g),g.scale=.7,g.getComponent("CommonIconWidget").setHeadClickShowInfo()}for(;p<h;p++){var g;(g=r.getChildByName("icon_"+p))&&g.removeFromParent()}e.attributes?(s.active=!0,o.active=!0,s.getComponent(cc.Label).string="["+e.attributes[td.UserPropertyEnum.ServerId]+td.Language.arena+"]",o.getComponent(cc.Label).string=e.attributes[td.UserPropertyEnum.NickName]):(s.active=!1,o.active=!1),l.getComponent(cc.Label).string=e.exp||"",r.setContentSize(cc.size(100*d.length,110)),r.getComponent(cc.Layout).cellSize=cc.size(100,100),r.getComponent(cc.Layout)._layoutSize=cc.size(100*d.length,110),r.getComponent(cc.Layout).updateLayout()}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],ActivityTokenRankConfig:[function(t,e,i){"use strict";cc._RF.push(e,"9d4c94bhOVLbLmrS2G+gtgV","ActivityTokenRankConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityTokenRankConfig",properties:{_tblName:"activity_token_rank_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityTokenRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"652b3UjQ91IJZGaZ+yQrwqy","ActivityTokenRankModel");var n=cc.Class({properties:{_data:null,_rank:null,_rewards:null},setData:function(t){this._data=t.data,this._rank=t.rank,this._rewards=td.RewardManager.parseRewardListDetail(t.rewards)},getData:function(){return this._data},getRank:function(){return this._rank},getRewards:function(){return this._rewards}});e.exports=n,cc._RF.pop()},{}],ActivityTokenRewardItem:[function(t,e,i){"use strict";cc._RF.push(e,"c895baes0hKQrxlyDhbEPPp","ActivityTokenRewardItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{_controller:null},updateItem:function(t,e){this._super(t,e);var i=td.ActivityDataManager.getActivityControllerByType(this._customData);if(i){var n=this.node.getChildByName("levelBg"),a=this.node.getChildByName("levelNum"),r=this.node.getChildByName("baseReward"),o=this.node.getChildByName("superRewardLayer"),s=e.getLevel(),l=i.getCurActivityTokenLevel()>=s?"HD_xl_djdi02":"HD_xl_djdi01";td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_35_xl,l,n),a.getComponent(cc.Label).string=s;var c=i.getCurActivityTokenLevel(),u=e.getNormalRewards()[0],d=r.getChildByName("normalReward");if(d)d.getComponent("CommonIconWidget").setData(u);else(d=td.GlobalFunction.createCommonIconWidget(26,u)).setScale(.8),d.setPosition(cc.v2(80,45)),d.setName("normalReward"),r.addChild(d);var h=d.getChildByName("imgHadReceive"),p=(C=i.getBaseRewardIsReceive(s))||c>=s;h?h.active=p:p&&(h=new cc.Node,d.addChild(h,100),h.setName("imgHadReceive"),h.x=-20,h.y=32),p&&(C?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_yilingqu_03",h):td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY2_Common,"GY2_xl_kelingqu",h));for(var _=i.isActivityTokenAdvance(),g=e.getAdvancedRewards(),f=o.getChildrenCount(),v=0;v<g.length;v++){var m=g[v];if(I=o.getChildByName("icon_"+v))I.getComponent("CommonIconWidget").setData(m);else(I=td.GlobalFunction.createCommonIconWidget(26,m)).setName("icon_"+v),o.addChild(I),I.scale=.8,I.getComponent("CommonIconWidget").setHeadClickShowInfo();var y=I.getChildByName("imgLock"),E=I.getChildByName("imgMask");y?(y.active=!_,E.active=!_):_||(E=new cc.Node,I.addChild(E,100),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_mengceng",E),E.setName("imgMask"),E.scale=1,E.x=0,E.y=0,y=new cc.Node,I.addChild(y,100),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_35_xl,"HD_xl_suo",y),y.setName("imgLock"),y.scale=.8,y.x=-30,y.y=34);var T=I.getChildByName("imgReceived"),C=i.getHigeRewardIsReceive(s),R=i.isActivityTokenAdvance();p=C||R&&c>=s;if(T?T.active=p:p&&(T=new cc.Node,I.addChild(T,100),T.setName("imgReceived"),T.x=-20,T.y=32),p){var S=C?"GY0_wz_yilingqu_03":"GY2_xl_kelingqu";C?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,S,T):td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY2_Common,S,T)}}for(;v<f;v++){var I;(I=o.getChildByName("icon_"+v))&&I.removeFromParent()}o.setContentSize(cc.size(100*g.length,110)),o.getComponent(cc.Layout).cellSize=cc.size(100,100),o.getComponent(cc.Layout)._layoutSize=cc.size(100*g.length,110),o.getComponent(cc.Layout).updateLayout()}}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],ActivityTokenTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"8a898zVBBBBZY5HnhsuoHVD","ActivityTokenTaskItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{},updateItem:function(t,e){this._super(t,e);var i=this.node.getChildByName("taskContent"),n=this.node.getChildByName("processValue"),a=this.node.getChildByName("rewardLayer"),r=this.node.getChildByName("btnReceive"),o=this.node.getChildByName("btnGoto"),s=this.node.getChildByName("btnExp"),l=s.getChildByName("tipNode"),c=this.node.getChildByName("expNum");s.getComponent(cc.Button).clickEvents[0].customEventData=e,l.active=!1,i.getComponent(cc.Label).string=e.getDes(),n.getComponent(cc.Label).string=td.Language.progress+":"+e.getValue()+"/"+e.getNeedValue(),c.getComponent(cc.Label).string="X"+e.getActive();for(var u=td.RewardManager.parseRewardListDetail(e.getRewards()),d=a.getChildrenCount(),h=0;h<u.length;h++){var p=u[h];if(_=a.getChildByName("icon_"+h))_.getComponent("CommonIconWidget").setData(p);else(_=td.GlobalFunction.createCommonIconWidget(33,p)).setPosition(cc.v2(100*h+50,45)),_.setName("icon_"+h),a.addChild(_),_.scale=.8,_.getComponent("CommonIconWidget").setHeadClickShowInfo()}for(;h<d;h++){var _;(_=a.getChildByName("icon_"+h))&&_.removeFromParent()}r.active=e.getStatus()===td.TaskStatus.Finish,o.active=e.getStatus()===td.TaskStatus.Progress,r.getComponent(cc.Button).clickEvents[0].customEventData=e,o.getComponent(cc.Button).clickEvents[0].customEventData=e,td.RedPointUtil.createRedPointSimple(r,null,e.getStatus()===td.TaskStatus.Finish)},expBtnClicked:function(t,e){var i=this.expBtnClicked._selectIndex,n=this.expBtnClicked._showTipNode;i&&i!=e.getId()&&n&&(n.active=!1);var a=t.target.getChildByName("tipNode");a.active=!a._active;var r=a.getChildByName("expLabel"),o=e.getActive();r.getComponent(cc.Label).string=o,this.expBtnClicked._selectIndex=e.getId(),this.expBtnClicked._showTipNode=a},itemGotoClicked:function(t,e){if(td.GlobalFunction.checkCanClicked(500)){var i=e;if(i.getStatus()==td.TaskStatus.Finish){td.ActivityDataManager.getActivityControllerByType(this._customData).setReceiveTask(i),td.EventUtil.dispatchEvent(td.EventNameEnum.Req_TASK_RECEIVE,i.getId())}else{var n=i.getGotoPanel(),a=null;n[1]&&(a=n[1]);var r=td.PanelManager.getInstance().getCurShowPanel();if(n[0]&&td.PanelEnum.Panel_Activity===n[0])r.getComponent("ActivityMainPanel").setData(a),td.ActivityDataManager.setJumpBackData([td.ActivityEnum.Activity.ActivityConfig,this._customData]);else td.PanelJumpManager.jumpToPanel(n[0],a)}}}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],ActivityTurnTableBuyConfig:[function(t,e,i){"use strict";cc._RF.push(e,"07d41Gdl9hKLpe979Dt6m5q","ActivityTurnTableBuyConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityTurnTableBuyConfig",e._tblName="activity_turn_table_buy_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getActivityTurnTableBuyConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityTurnTableConfig:[function(t,e,i){"use strict";cc._RF.push(e,"5e74cY+5yRJHJEUdrD1RcNM","ActivityTurnTableConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityTurnTableConfig",e._tblName="activity_turn_table_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getActivityTurnTableConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActivityTurnTableTimesRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"297f72ROG1HJaAY9hE6L+WI","ActivityTurnTableTimesRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityTurnTableTimesRewardConfig",e._tblName="activity_turn_table_times_reward_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getActivityTurnTableTimesRewardConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ActorPulseModel:[function(t,e,i){"use strict";cc._RF.push(e,"0185emfZmhA0LbROF0tTtGb","ActorPulseModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("../Manager/PulseManager"),r=function(){function t(){this._pulseId=0,this._occupyTimes=0,this._buyOccupyTimes=0,this._times=0,this._mineCount=0,this._effect=0,this._addationLevel=0,this._freeTimes=0,this._occupyTotalTimes=0}return t.prototype.setData=function(t){this._freeTimes||(this._freeTimes=n.GetConfig("PULSE_OCCUPY_TIMES_LIMIT")),void 0!==t.occupyTimes&&(this._occupyTimes=t.occupyTimes),void 0!==t.exploitTimes&&(this._times=t.exploitTimes),void 0!==t.guardRecords&&(this._guardRecord=t.guardRecords),void 0!==t.buyOccupyTimes&&(this._buyOccupyTimes=t.buyOccupyTimes),void 0!==t.mineCount&&(this._mineCount=t.mineCount),void 0!==t.occupyTotalTimes&&(this._occupyTotalTimes=t.occupyTotalTimes),this.initMyPulse()},t.prototype.initMyPulse=function(){var t=n.Account.getUserData().getGamerId(),e=a.default.getInstance().getPulseByActorId(t);if(e)if(this._pulseId=e.getPulseId(),this._lastOccupyPulseTime=e.getLastOccupyPulseTime(),this._lastReceiveTime=e.getLastReceiveTime(),this._pulseTimeOut=e.getPulseTimeOut(),this._nextOccupyPulseRewardTime=e.getNextOccupyPulseExtraRewardTime(),this._addationLevel=e.getAdditionId(),this._addationLevel>0){var i=n.GetTableClass(n.TableEnum.PurpleFairylandAdditionTable).getDataById(this._addationLevel);this._effect=i.effect}else this._effect=0;else this._pulseId=0},t.prototype.getPulseId=function(){return this._pulseId},t.prototype.getOccupyTimes=function(){return this._occupyTimes},t.prototype.getTimes=function(){return this._times},t.prototype.getLastOccupyPulseTime=function(){return this._lastOccupyPulseTime},t.prototype.getLastReceiveTime=function(){return this._lastReceiveTime},t.prototype.getPulseTimeOut=function(){return this._pulseTimeOut},t.prototype.getNextOccupyPulseRewardTime=function(){return this._nextOccupyPulseRewardTime},t.prototype.getOccupyTotalTimes=function(){return this._occupyTotalTimes},t.prototype.getGuardRecord=function(){return this._guardRecord},t.prototype.getMineCount=function(){return this._mineCount},t.prototype.getAdditionEffect=function(){return this._effect},t.prototype.getAdditionLevel=function(){return this._addationLevel},t.prototype.getBuyOccupyTimes=function(){return this._buyOccupyTimes},t.prototype.getLeftTimes=function(){return this._buyOccupyTimes+this._freeTimes-this._occupyTimes},t}();e.exports=r,cc._RF.pop()},{"../Manager/PulseManager":"PulseManager"}],ActorRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"576a6qngmpEU6UHAbSYZMWl","ActorRankModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=window.td,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._rank=0,e._chapterType=0,e._starNum=0,e._maxFloor=0,e._heroFightPower=0,e._round=0,e._endlessFloor=0,e._damage=0,e._bossScore=0,e._id=0,e._killTime=0,e._grade=1,e._floor=1,e}return n(e,t),e.prototype.init=function(e,i){if(void 0===i&&(i="ActorRankModel"),e){t.prototype.init.call(this,i,e.attributes),this._rank=e.rank||0,this._chapterType=e.chapterType||0,this._starNum=e.starNum||0,this._maxFloor=e.maxFloor||0,this._round=e.round||0,this._endlessFloor=e.floor||0;var n=e.id||0;0!==n&&(this._heroData=a.GlobalFunction.getGoodsData(a.GoodsType.Type_Mercenary,n),this._heroData.setLevel(e.level||1),this._heroData.setBreakoutLevel(e.breakoutLevel||0),this._heroData.setCultivateLevel(e.cultivateLevel||0)),this._heroFightPower=e.power||0,this._damage=e.damage||0,this._bossScore=e.score||0,this._id=e.id||0,this._killTime=e.time,this._grade=e.dan||1,this._floor=(e.floor||0)+1}},e.prototype.setRank=function(t){this._rank=t},e.prototype.getRank=function(){return this._rank},e.prototype.getChapterType=function(){return this._chapterType},e.prototype.getStarNum=function(){return this._starNum},e.prototype.getMaxFloor=function(){return this._maxFloor},e.prototype.getHeroId=function(){return this._heroData?this._heroData.getRoleType():0},e.prototype.getEndlessFloor=function(){return this._endlessFloor},e.prototype.getHeroData=function(){return this._heroData},e.prototype.getHeroLevel=function(){return this._heroLevel},e.prototype.getHeroFightPower=function(){return this._heroFightPower},e.prototype.getDamage=function(){return this._damage},e.prototype.getRound=function(){return this._round},e.prototype.getNationBossScore=function(){return this._bossScore},e.prototype.getId=function(){return this._id},e.prototype.getKillTime=function(){return this._killTime},e.prototype.getGrade=function(){return this._grade},e.prototype.getFloor=function(){return this._floor},e}(t("BaseUser"));e.exports=r,cc._RF.pop()},{BaseUser:"BaseUser"}],ActorUnlockEnum:[function(t,e,i){"use strict";cc._RF.push(e,"da86c/T1dlL/rOWIXFdmEJm","ActorUnlockEnum"),td.UnlockConditionType={LOBBY:1,ALTAR:2,TECHNOLOGY:3,SYNTHESISFURNACE:4,STORE:5,level:101,vipLevel:102,arenaRank:103,nationLevel:105,immortal:107,ENDLESS:108,STORY:109,STAR_UP_ROAD:110,DESTROY_TEMPLE_MAX_FLOOR:111,SERVER_OPEN_DAY:112,ANCIENT_CORRIDOR_MAX_ID:113,CROSS_ARENA_ZONE:114,CROSS_ARENA_BATTLEFIELD:115,CROSS_ARENA_ZONE_BATTLEFIELD:116,FINISH_TASK:117,CROSS_CUP_STATE:118,LEGEND_DAN:119,PET_STATION_LEVEL:120,VIP_CARD:121,CHEES_GRADE:122,EVIL_GOD_CHAPTER:123,NOT_OPEN:999},td.ActorUnlockType={NONE:0,FORMATION:1,REINFORCEMENT:2,ROAM:3,WHOLE_BOSS_DOUBLE:4,WHOLE_BOSS:5,WHOLE_BOSS_AUTO_COMBAT:6,Shop:7,ENDLESS:8,Gemstone:9,Copy:10,PAGODA:11,ENDLESS_QUICKLY_PLAY:12,Arena:13,WorldBoss:14,GACHA:15,STAR_UP_ROAD:16,DailySignIn:17,Siege:18,TurnTable:19,Chat:20,COMMUNICATE:21,NationDonate:22,Army:23,NATION_CREATE:24,Trail:27,Immortal:28,ImmortalInvite:29,ImmortalVisit:30,TITLE:31,MANOR:32,PlunderSkipBattle:33,RED_ENVELOPE:45,EVIL_GOD:37,NightmareCopy:38,DragonArtifact:39,HuntTreasure:43,copySweep:41,HellishCopy:42,EQUIPMENT_STAR_UP:46,NATION_BOSS:47,FRIEND:44,TREASURE:49,TREASURE_STAR_UP:50,TREASURE_QUICK_SNATCH:51,MAGIC_RECORD:52,DESTROY_TEMPLE:53,DESTROY_TEMPLE_SWEEP:54,QUICK_VOW:55,SAVE_DIAMOND:56,RED_ENVELOPE_DEFINE:57,TREASURE_EVOLVE:58,EQUIPMENT_FORGE:59,EQUIPMENT_EVOLVE:60,HERO_BREAKOUT:61,HERO_CULTIVATE:62,HERO_STAR_UP:63,HERO_EVOLVE:64,TECHNOLONGY:65,DAILYDISCOUNT:66,VIP_PREROGATIVE_STORE:67,PULSE:68,FLASH_GIFT:69,GOD_FURNACE:70,ONLINE_REWARD:71,DEMON_TREASURE:72,ANCIENT_CORRIDOR:73,DIPPER:74,WONDERLAND_ADVENTURE:75,CROSS_ARENA:76,GEMSTONE_AWAKE:77,HOLY_BEAST_AUTO_COMBAT:78,WORLD_BOSS_AUTO_COMBAT:79,HOLY_BEAST:80,HERO_ARTIFACT:81,HERO_ARTIFACT_ADVANCE:82,ONE_KEY_WONDERLAND:83,BABEL:84,BABEL_SWEEP:85,CROSS_CUP:86,SPIRIT:87,SPIRIT_STAR_UP:88,LEGEND:89,FAST_VOW:91,EIGHT_DIAGRAMS:92,RUNE_DECOMPOSE:93,SOUL_LINK:94,PET:95,PET_HATCH_STATUS:96,PET_BATTLE_POS:97,MAZE:98,CHESS:99,PVP_BattleTimes:100,ShowEndlessSelect:101,ShowRuneEntry:102,Rank:103,BattleTimes:104,Task:105,DestroyTempleSkilBattle:106,PveSkillLight:107,ACTIVITY_POPUP_WINDOW:108,DIVINE_POSITION:109,SCUFFLE_YAMA:110,AUCTION:500},td.PanelUnlockParam={10:[4,0],12:[5,0],167:[6,0],7:[13,0],49:[101,0],1241:[8,1],146:[47,0],1270:[[5,0],[14,0]],100:[9,1],160:[18,0],1090:[103,0],111:[23,0],92:[28,0],180:[39,1],1020:[49,0],1029:[49,0],1063:[53,0],1071:[52,0],1084:[3,1],1087:[11,0],1120:[44,0],1130:[45,0],1111:[16,0],1005:[10,0],1252:[66,0],1123:[28,0],105:[43,1],1007:[65,0],90:[105,0],1260:[68,0],1283:[70,0],1320:[73,0],1305:[72,0],1323:[74,0],1322:[75,0],1340:[76,0],1350:[80,0],1354:[81,0],1373:[81,0],1403:[84,0],1415:[31,0],1420:[86,0],1600:[87,0],1601:[87,0],1550:[89,0],1630:[92,0],1645:[94,0],1680:[98,0],1650:[95,0],1651:[95,0],1652:[95,0],1710:[99,0],1726:[500,0],1740:[110,0],1765:[37,0]},cc._RF.pop()},{}],ActorUnlockModel:[function(t,e,i){"use strict";cc._RF.push(e,"32dd7vrD+BDGZT9aH1AeJpi","ActorUnlockModel");var n=t("Model"),a=cc.Class({extends:n,properties:{_id:null,_type:null,_orderId:null,_isAnd:null,_condition:null,_showOpenSys:null,_iconRes:null,_nameRes:null,_guideId:null,_name:null,_des:null,_goPanel:null,_functionPreviewID:null},init:function(t){this._super("ActorUnlockModel"),this._id=t.id,this._type=t.type,this._orderId=t.orderId,this._isAnd=t.isAnd,this._condition=[];for(var e=t.condition,i=0,n=e.length;i<n;i++){var a=e[i],r={};r.type=a[0],r.value=a[1],this._condition[i]=r}this._showOpenSys=1===t.showOpenSys,this._iconRes=t.iconRes,this._nameRes=t.nameRes,this._guideId=t.guideId,this._name=t.name||"",this._des=t.des||""},getId:function(){return this._id},getType:function(){return this._type},getOrderId:function(){return this._orderId},getIsAnd:function(){return this._isAnd},getCondition:function(){return this._condition},isShowOpenSys:function(){return this._showOpenSys},getIconRes:function(){return this._iconRes},getNameRes:function(){return this._nameRes},getGuideId:function(){return this._guideId},getName:function(){return this._name},getDes:function(){return this._des},getGoPanel:function(){return this._goPanel},setGoPanel:function(t){this._goPanel=t},setFunctionPreviewID:function(t){this._functionPreviewID=t},getFunctionPreviewID:function(){return this._functionPreviewID},shift:function(){return this}});e.exports=a,cc._RF.pop()},{Model:"Model"}],ActorUnlockTable:[function(t,e,i){"use strict";cc._RF.push(e,"46934oj/otO6qFHxyHH4To2","ActorUnlockTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActorUnlockTable",properties:{_tblName:"actor_unlock_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];a.isAnd="true"===a.isAnd,t[t.length]=a}},getUnlockData:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],AddSubConfirmWindow:[function(t,e,i){"use strict";cc._RF.push(e,"b09d8acdNJA272l0LAopRiu","AddSubConfirmWindow");var n=t("CommonEnum"),a=t("PanelBase"),r=cc.Class({extends:a,properties:{_curOperateType:null,_sureCallFunc:null,_calcCallFunc:null,_curItemData:null,_maxLimitNum:null,_nCurCount:null,_useTipPanel:null,_exchangeTipPanel:null,_imgTitle:null,_labCount:null},init:function(){this._panelType=td.PanelType.None,this._panelEnum=td.PanelEnum.Window_AddSubConfirm},onLoad:function(){this._super();var t=this._root.getChildByName("operatePanel");this._useTipPanel=t.getChildByName("usePanel"),this._useTipPanel.active=!1,this._exchangeTipPanel=t.getChildByName("exchangePanel"),this._exchangeTipPanel.active=!1,this._labCount=t.getChildByName("labCount")},setData:function(t){this._curItemData=t.itemData,this._curOperateType=t.opType,this._sureCallFunc=t.sureFunc,this._calcCallFunc=t.calcFunc,this._maxLimitNum=t.maxLimitNum,this._nCurCount=1,this._useTipPanel.active=this._curOperateType===n.OperateItemType.UseType,this._exchangeTipPanel.active=this._curOperateType===n.OperateItemType.ExchangeType;this._curOperateType===n.OperateItemType.UseType?td.resDef.GY_Common.GY_wz_shiywp:(this._curOperateType,n.OperateItemType.ExchangeType,td.resDef.GY_Common.GY_wz_shiywp);this.setShowCount(),this.setItemInfo(),this._curOperateType===n.OperateItemType.ExchangeType?this.setExchangeTipPanel():this._curOperateType===n.OperateItemType.UseType&&this.setUseTipPanel()},onDisable:function(){this._curItemData=null,this._curOperateType=null,this._sureCallFunc=null,this._calcCallFunc=null},setShowCount:function(){var t=this._maxLimitNum;this._nCurCount=this._nCurCount<1?1:this._nCurCount,this._nCurCount=this._nCurCount>t?t:this._nCurCount,this._labCount.getComponent(cc.Label).string=this._nCurCount,this._curOperateType===n.OperateItemType.ExchangeType&&this.refreshNeedCurrencyNum(this._nCurCount)},setUseTipPanel:function(){if(this._useTipPanel.active&&this._curItemData){var t="";if(this._curItemData&&this._curItemData.getGoodsSubType&&this._curItemData.getGoodsSubType()===td.GoodsSubType.TIMES_BAG){var e=this._curItemData.getLeftSpecialUseTimes();t=cc.js.formatStr(td.Language[this._curItemData.getBoxUseTips()],e)}else{var i=this._maxLimitNum;t=cc.js.formatStr(td.Language.addAndUseTips,i)}this._useTipPanel.getChildByName("labTip").getComponent(cc.RichText).string=t}},setItemInfo:function(){var t=this._root.getChildByName("InfoPanel"),e=t.getChildByName("itemNode"),i=null;i=this._curOperateType===n.OperateItemType.ExchangeType?td.RewardManager.getRewardDetail(this._curItemData.getRewards()):this._curItemData;var a=e.getChildByName("iconItem");a?a.getComponent("CommonIconWidget").setData(i):((a=td.GlobalFunction.createCommonIconWidget(2,i)).setPosition(cc.v2(0,0)),e.addChild(a)),t.getChildByName("labItemName").getComponent(cc.Label).string=i.getName();var r=td.ItemManager.getItemNumById(i.getId());t.getChildByName("labOwnNum").getComponent(cc.Label).string=r},setExchangeTipPanel:function(){if(this._exchangeTipPanel.active){var t=this._curItemData.getMoneyId(),e=td.GlobalFunction.getGoodsData(td.GoodsType.Type_Item,t);this._exchangeTipPanel.getChildByName("imgCurrency").getComponent(cc.Sprite).spriteFrame=e.getLittleIconRes()}},refreshNeedCurrencyNum:function(t){var e=t||0,i=0,n=this._exchangeTipPanel.getChildByName("labNeedNum"),a=this._calcCallFunc;e>0&&a&&"function"==typeof a&&(i=a(e,this._curItemData)),n.getComponent(cc.Label).string=i},onSubOne:function(){this._nCurCount<=0||(this._nCurCount--,this.setShowCount())},onSubTen:function(){this._nCurCount<=0||(this._nCurCount-=10,this.setShowCount())},onAddOne:function(){var t=0;this._curOperateType===n.OperateItemType.ExchangeType?t=this._curItemData.maxNum:this._curOperateType===n.OperateItemType.UseType&&(t=this._curItemData.getCount()),this._nCurCount>=t||(this._nCurCount++,this.setShowCount())},onAddTen:function(){var t=0;this._curOperateType===n.OperateItemType.ExchangeType?t=this._curItemData.maxNum:this._curOperateType===n.OperateItemType.UseType&&(t=this._curItemData.getCount());var e=t-this._nCurCount;this._nCurCount+=Math.min(e<0?0:e,10),this.setShowCount()},onAddMax:function(){var t=0;this._curOperateType===n.OperateItemType.ExchangeType?t=this._curItemData.maxNum:this._curOperateType===n.OperateItemType.UseType&&(t=this._curItemData.getCount()),this._nCurCount=t,this.setShowCount()},onCancel:function(){this.closeCallFunc()},onSure:function(){var t={model:this._curItemData,num:this._nCurCount},e=this._sureCallFunc;e&&"function"==typeof e&&e(t),this.closeCallFunc()}});e.exports=r,cc._RF.pop()},{CommonEnum:void 0,PanelBase:void 0}],AddUpRechargeController1001:[function(t,e,i){"use strict";cc._RF.push(e,"2c57bfBdglPy78bg97qFIc6","AddUpRechargeController1001");var n=t("AddUpRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{AddUpRechargeController:"AddUpRechargeController"}],AddUpRechargeController2:[function(t,e,i){"use strict";cc._RF.push(e,"0415aaMkrZLE5T8bsDBclNa","AddUpRechargeController2");var n=t("AddUpRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{AddUpRechargeController:"AddUpRechargeController"}],AddUpRechargeController3:[function(t,e,i){"use strict";cc._RF.push(e,"645d0r0UiJOdrABJd/VlN4U","AddUpRechargeController3");var n=t("AddUpRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{AddUpRechargeController:"AddUpRechargeController"}],AddUpRechargeController4:[function(t,e,i){"use strict";cc._RF.push(e,"42507qMastCyLf3oZfm9l4W","AddUpRechargeController4");var n=t("AddUpRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{AddUpRechargeController:"AddUpRechargeController"}],AddUpRechargeController5:[function(t,e,i){"use strict";cc._RF.push(e,"60d1bz8jQVEz4xmqwtps216","AddUpRechargeController5");var n=t("AddUpRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{AddUpRechargeController:"AddUpRechargeController"}],AddUpRechargeController6:[function(t,e,i){"use strict";cc._RF.push(e,"46b51FVbq9Ce5cmVPe2eY96","AddUpRechargeController6");var n=t("AddUpRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{AddUpRechargeController:"AddUpRechargeController"}],AddUpRechargeController7:[function(t,e,i){"use strict";cc._RF.push(e,"e1f3e2AB6hBTaEqWBwvuTqv","AddUpRechargeController7");var n=t("AddUpRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{AddUpRechargeController:"AddUpRechargeController"}],AddUpRechargeController8:[function(t,e,i){"use strict";cc._RF.push(e,"ac0d0tBp1NJlaktPauKd2Ht","AddUpRechargeController8");var n=t("AddUpRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{AddUpRechargeController:"AddUpRechargeController"}],AddUpRechargeController9:[function(t,e,i){"use strict";cc._RF.push(e,"4e81a9iQgZBbq8DLh8koBn9","AddUpRechargeController9");var n=t("AddUpRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{AddUpRechargeController:"AddUpRechargeController"}],AddUpRechargeController:[function(t,e,i){"use strict";cc._RF.push(e,"c06dbOixYxI7L8EK98uAw3L","AddUpRechargeController");var n=t("RechargeBaseController"),a=t("AddUpRechargeItem");cc.Class({extends:n,properties:{_totalRechargeDuringActivity:null,_datas:null,_nTotalRecharge:null,_tableEnum:0},initData:function(t){this._tableEnum=td.TableEnum.AddUpRechargeTable,this._super(t),this._charges={},this._data=[],this._nTotalRecharge=0},getChargeTimes:function(t){return this._charges[t]},parseQueryInfo:function(t){if(this._charges={},this._receivedTimesIdMap={},this._nTotalRecharge=t.total,t.rewardList&&t.rewardList.length>0)for(var e=0;e<t.rewardList.length;e++)this.onIdReceived(t.rewardList[e]);this._datas=[];var i=this.getActivityData(),n=td.GetTableClass(this._tableEnum).getDatasOfDataId(i),r=this.getActivityId();for(e=0;e<n.length;e++){var o=new a;o.initData(n[e],r),this._datas.push(o)}},parseRewardReceived:function(t){var e=this._receiveData.id;this.onIdReceived(e)},getRecevieStatus:function(t,e){return this._receivedTimesIdMap[t]?td.ActivityEnum.OperateStatus.Operated:this._nTotalRecharge/10>=e?td.ActivityEnum.OperateStatus.OperateAble:td.ActivityEnum.OperateStatus.NotOperateAble},hasRedPoint:function(){return!0},redPointTip:function(){for(var t=this._datas,e=0;e<t.length;e++){if(t[e].getReceiveStatus()===td.ActivityEnum.OperateStatus.OperateAble)return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.Res_GET_ACTIVITY_INFO]},isRedPointTip:function(){return this.redPointTip()}});cc._RF.pop()},{AddUpRechargeItem:"AddUpRechargeItem",RechargeBaseController:"RechargeBaseController"}],AddUpRechargeHome:[function(t,e,i){"use strict";cc._RF.push(e,"0eb3b2HQQ5NV5zzqRT3/pIC","AddUpRechargeHome");var n=t("RechargeBasePanel");t("OptimizeVerticalListView"),cc.Class({extends:n,initData:function(t){this._super(t)},onLoad:function(){this._super();var t=this.node.getChildByName("scrollView");this._listView=t.getComponent("OptimizeVerticalListView")},onEnable:function(){this._super()},doReceiveAction:function(t){var e=this,i={id:t.getId()},n=t.getOptionalRewards?t.getOptionalRewards():[];if(n.length>0){var a={};a.itemList=n,a.callFunc=function(t){i.parmeterMap={10:t},e.getActivityController().operateActivity(i)},td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_SelectRechargeReward,a)}else i.parmeterMap={10:0},this.getActivityController().operateActivity(i)},onReceiveOperation:function(t){this._super(t)}});cc._RF.pop()},{OptimizeVerticalListView:void 0,RechargeBasePanel:"RechargeBasePanel"}],AddUpRechargeItemLVItem:[function(t,e,i){"use strict";cc._RF.push(e,"365a1v+sGRJQLhoygRn8KYN","AddUpRechargeItemLVItem");var n=t("RechargeBaseItem"),a=cc.Class({extends:n,properties:{},setData:function(t){this._super(t)},updateItem:function(t,e){this._super(t,e);var i=e.getMoney(),n=this.node.getChildByName("labTitle"),a=this._controller.getTotalRechargeMoney();a>=e.getMoney()?n.getComponent(cc.RichText).string=" <color=#a25b00>"+cc.js.formatStr(td.Language.addUpRecharge,i)+"</c><color=#0eb001>\uff08"+a+"/"+e.getMoney()+"\uff09</c>":n.getComponent(cc.RichText).string=" <color=#a25b00>"+cc.js.formatStr(td.Language.addUpRecharge,i)+"\uff08"+ +a+"/"+e.getMoney()+"\uff09</c>",this.setItemBtn(t,e)},setItemBtn:function(t,e){this._super(t,e);var i=this.node.getChildByName("btnOperation").getComponent(cc.Button);i.clickEvents=[];var n=new cc.Component.EventHandler;n.target=this.node,n.component="AddUpRechargeItemLVItem",n.handler="onOperateItem",n.customEventData=e,i.clickEvents.push(n)}});e.exports=a,cc._RF.pop()},{RechargeBaseItem:"RechargeBaseItem"}],AddUpRechargeItem:[function(t,e,i){"use strict";cc._RF.push(e,"05a33P7CgZCvpqDk8liwo3Y","AddUpRechargeItem");var n=t("RechargeBaseModel"),a=cc.Class({extends:n,initData:function(t,e){this._super(t,e)},getReceiveStatus:function(){var t=td.ActivityDataManager.getActivityControllerById(this._belongActivityId);if(!t)return td.ActivityEnum.OperateStatus.NotOperateAble;var e=this.getMoney();return t.getRecevieStatus(this.getId(),e)}});e.exports=a,cc._RF.pop()},{RechargeBaseModel:"RechargeBaseModel"}],AddUpRechargeTable:[function(t,e,i){"use strict";cc._RF.push(e,"87869TJvilC3rNisWgb/ZQc","AddUpRechargeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"AddUpRechargeTable",properties:{_tblName:"recharge_total_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e.sort(function(t,e){return t.charge-e.charge}),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],AncientCorridorManager:[function(t,e,i){"use strict";cc._RF.push(e,"877a7ZYVflPl6+HaxNjfea9","AncientCorridorManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("ActorRankModel"),r=function(){function t(){this._myRank=0,this._id=0,this._maxId=0,this._data=null,this._ranks=null,this._rewardState=!1,this._isInit=!1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._ranks=[],this._isInit=!1},t.prototype.isInit=function(){return this._isInit},t.prototype.getMyRank=function(){return this._myRank||999},t.prototype.getRanks=function(){return this._ranks},t.prototype.getId=function(){return this._id},t.prototype.getMaxId=function(){return this._maxId},t.prototype.getData=function(){return this._data},t.prototype.getRewardState=function(){return this._rewardState},t.prototype.getChallengeId=function(){return this._id+1},t.prototype.addListener=function(){var t=n.MsgModuleName.AncientCorridor,e=n.MsgCmd.AncientCorridor;n.ServerDelegate.registerMessage(t,e.ANCIENT_CORRIDOR_GET_INFO,this.parseInfo.bind(this)),n.ServerDelegate.registerMessage(t,e.ANCIENT_CORRIDOR_RANK,this.parseRankInfo.bind(this)),n.ServerDelegate.registerMessage(t,e.ANCIENT_CORRIDOR_PREPARE,this.parsePrepare.bind(this)),n.ServerDelegate.registerMessage(t,e.ANCIENT_CORRIDOR_CHALLENGE,this.parseChallenge.bind(this)),n.ServerDelegate.registerMessage(t,e.ANCIENT_CORRIDOR_REWARD,this.parseReward.bind(this)),n.ServerDelegate.registerMessage(t,e.PUSH_ANCIENT_CORRIDOR_INFO,this.parsePushInfo.bind(this)),n.ServerDelegate.registerMessage(t,e.ANCIENT_SKIP,this._onGetQuickChallenge.bind(this))},t.prototype.addEventListener=function(){var t=n.EventUtil,e=n.EventNameEnum,i={};i[e.REQ_GET_ANCIENT_INFO]=this.reqGetInfo,i[e.REQ_GET_ANCIENT_RANK_INFO]=this.reqGetRankInfo,i[e.REQ_ANCIENT_PREPARE]=this.reqPrepare,i[e.REQ_ANCIENT_CHALLENGE]=this.reqChallenge,i[e.REQ_ANCIENT_CORRIDOR_REWARD]=this.reqReward,i[e.REQ_ANCIENT_QUICK_CHALLENGE]=this._requestQuickChallenge,t.registerEvents(i,this)},t.prototype.reqGetInfo=function(){var t={};t.module=n.MsgModuleName.AncientCorridor,t.cmd=n.MsgCmd.AncientCorridor.ANCIENT_CORRIDOR_GET_INFO,n.ServerDelegate.sendMessage(t)},t.prototype.parseInfo=function(t,e){t===n.NetCode.SUCCESS&&(this._id=e.id,this._data=e.data,this._maxId=e.maxId,this._rewardState=e.rewardState,this._isInit=!0,n.EventUtil.dispatchEvent(n.EventNameEnum.RES_GET_ANCIENT_INFO))},t.prototype.parsePushInfo=function(t,e){t===n.NetCode.SUCCESS&&this.parseInfo(t,e)},t.prototype.reqGetRankInfo=function(){var t={};t.module=n.MsgModuleName.AncientCorridor,t.cmd=n.MsgCmd.AncientCorridor.ANCIENT_CORRIDOR_RANK,n.ServerDelegate.sendMessage(t)},t.prototype.parseRankInfo=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.ranks.slice();if(i.length>0)(l=new a).init(i.length-1),l.init(i.pop()),this._myRank=l.getRank(),l=null;for(var r=[],o=0,s=i.length;o<s;o++){var l;(l=new a).init(i[o]),r[r.length]=l}this._ranks=null,this._ranks=r,n.EventUtil.dispatchEvent(n.EventNameEnum.RES_GET_ANCIENT_RANK_INFO,[t,e])}},t.prototype.reqPrepare=function(){var t=n.TimeUtil.getServerDate();if(23===t.getHours()&&t.getMinutes()>=50){var e=new n.BroadcastContent(330);n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_BROADCAST,e)}else{var i={};i.module=n.MsgModuleName.AncientCorridor,i.cmd=n.MsgCmd.AncientCorridor.ANCIENT_CORRIDOR_PREPARE,i.id=this.getChallengeId(),n.ServerDelegate.sendMessage(i)}},t.prototype.parsePrepare=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_ANCIENT_PREPARE)},t.prototype.reqChallenge=function(t){var e={};e.module=n.MsgModuleName.AncientCorridor,e.cmd=n.MsgCmd.AncientCorridor.ANCIENT_CORRIDOR_CHALLENGE,e.id=t.id,e.data=t.data,e.check=t.check,n.ServerDelegate.sendMessage(e)},t.prototype.parseReward=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.rewardResult,a=n.RewardManager.parseRewardResult(i);n.EventUtil.dispatchEvent(n.EventNameEnum.RES_ANCIENT_CORRIDOR_REWARD,a)}},t.prototype.reqReward=function(){var t={};t.module=n.MsgModuleName.AncientCorridor,t.cmd=n.MsgCmd.AncientCorridor.ANCIENT_CORRIDOR_REWARD,n.ServerDelegate.sendMessage(t)},t.prototype.parseChallenge=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.rewardResult,a=n.RewardManager.parseRewardResult(i);n.EventUtil.dispatchEvent(n.EventNameEnum.RECEIVE_PVE_FIHGT_REAWRD,a)}else n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_PRE_PANEL)},t.prototype._requestQuickChallenge=function(){var t={};t.module=n.MsgModuleName.AncientCorridor,t.cmd=n.MsgCmd.AncientCorridor.ANCIENT_SKIP,n.ServerDelegate.sendMessage(t)},t.prototype._onGetQuickChallenge=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.rewardResult,a=n.RewardManager.parseRewardResult(i);n.GlobalFunction.showRewards(a),n.EventUtil.dispatchEvent(n.EventNameEnum.ON_GET_ANCIENT_QUICK_CHALLENGE),n.EventUtil.dispatchEvent(n.EventNameEnum.REQ_GET_ANCIENT_RANK_INFO)}},t.prototype.isRedPointTips=function(){return!!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.ANCIENT_CORRIDOR,0,!1)&&!n.GlobalFunction.getLocalSaveStatus("open_ancient_view")},t.prototype.redPointEvents=function(){return[n.EventNameEnum.OPEN_ANCIENT_VIEW]},t.prototype.hasNextWave=function(){return!!n.GetTableClass(n.TableEnum.AncientCorridorTable).getDataById(this._id+1)},t.prototype.getCanQuickChallengeData=function(){var t=n.Account.getUserData().getFightPower(),e=n.GetTableClass(n.TableEnum.AncientCorridorTable).getDataByFightPower(t);return e&&e.id>this._id?e:null},t}();i.default=r,cc._RF.pop()},{ActorRankModel:"ActorRankModel"}],AncientCorridorRankTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"7a8e9RepHNM4YL40do6A/gP","AncientCorridorRankTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="AncientCorridorRankConfig",e._tblName="ancient_corridor_rank_config",e._data=[],e}n(e,t);var i=e.prototype;return i.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=0,a=e.length;n<a;++n){var r=e[n];r.minRank=i+1,i=r.rank,t[t.length]=r}},i.getDatas=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],AncientCorridorTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"5d81dFcnpxFF4Boh4jdX4YO","AncientCorridorTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="AncientCorridorConfig",e._tblName="ancient_corridor_config",e._data=[],e}n(e,t);var i=e.prototype;return i.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},i.getDataById=function(t){return this._data[t]},i.getDataByFightPower=function(t){var e=null;for(var i in this._data)if(this._data.hasOwnProperty(i)){var n=this._data[i];n.skipPower&&t>n.skipPower&&(e=n)}return e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ArenaManager:[function(t,e,i){"use strict";cc._RF.push(e,"e6cb5o/RyxG45+xSUrURrOc","ArenaManager"),td.ArenaManager={_challengeTimes:null,_buyTimes:null,_curRank:null,_maxRank:null,_rankArray:null,_newRecord:null,_haveLowRank:null,_showingReportType:0,_beforBattleRank:null,_afterBattleRank:null,_newReportTime:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._challengeTimes=0,this._buyTimes=0,this._curRank=0,this._maxRank=0,this._rankArray=[],this._newRecord={},this._haveLowRank=!1,this._beforBattleRank=-1,this._afterBattleRank=-1,this._newReportTime=0},_addListener:function(){var t=td.MsgModuleName.ARENA,e=td.MsgCmd.ARENA;td.ServerDelegate.registerMessage(t,e.GET_ARENA_INFO,this._parseArenaInfo.bind(this)),td.ServerDelegate.registerMessage(t,e.PUSH_ARENA_INFO,this._parseArenaInfo.bind(this)),td.ServerDelegate.registerMessage(t,e.ARENA_WIPE_OUT,this._onArenaSweep.bind(this)),td.ServerDelegate.registerMessage(t,e.GET_ARENA_REPORT,this._parseArenaReport.bind(this)),td.ServerDelegate.registerMessage(t,e.ARENA_RESET_TIMES,this._onResetArenaTimes.bind(this)),td.ServerDelegate.registerMessage(t,e.PUSH_NEW_REPORT,this._onReceiveNewReport.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQUEST_ARENA_INFO]=this._requestGetArenaInfo,i[e.REQUEST_ARENA_FIGHT]=this._requestArenaFight,i[e.REQUEST_ARENA_SWEEP]=this._requestArenaSweep,i[e.REQUEST_ARENA_REPORT]=this._requestGetArenaReport,i[e.REQUEST_RESET_ARENA_TIMES]=this._requestResetArenaTimes,i[e.RESET_NEW_RECORD_STATUS]=this._resetNewRecordStatus,i[e.ON_OPEN_ARENA_REPORT]=this._onOpenReport,t.registerEvents(i,this)},isRedPointTips:function(){return!!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Arena)&&(this.isReportRedPoint()||this.getLeftChallengeTimes()>0)},redPointEvents:function(){var t=td.EventNameEnum;return[t.USER_ATTR_LEVEL_CHANGE,t.ARENA_CHANGE].concat(this.newReportRedPointEvts())},isReportRedPoint:function(){var t=parseInt(td.LocalStorageUtil.read(td.LocalDataKey.LAST_OPEN_ARENA_REPORT)||0);return this._newReportTime=parseInt(this._newReportTime||td.LocalStorageUtil.read(td.LocalDataKey.LAST_REC_ARENA_REPORT)||0),this._newReportTime>t},newReportRedPointEvts:function(){return[td.EventNameEnum.ON_RECEIVE_NEW_REPORT]},_onOpenReport:function(){var t=td.TimeUtil.getTime();td.LocalStorageUtil.write(td.LocalDataKey.LAST_OPEN_ARENA_REPORT,t),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_RECEIVE_NEW_REPORT)},setShowingReportType:function(t){this._showingReportType=t},getShowingReportType:function(){return this._showingReportType},getRankArray:function(){return this._rankArray},getChallengeTimes:function(){return this._challengeTimes},getBuyTimes:function(){return this._buyTimes},getLeftChallengeTimes:function(){return td.GetConfig("ARENA_PLAY_TIMES")-this._challengeTimes},getMyRank:function(){return this._curRank},getCurRankGap:function(t){for(var e=td.GetConfig("ARENA_MATCH"),i=1,n=0,a=e.length;n<a;n++){var r=e[n];if(t<=r[0]||n===a-1){i=r[1];break}}return i},getHighestRank:function(){return this._maxRank},setChallengeTimes:function(t){this._challengeTimes!==t&&(this._challengeTimes=t)},getShowMaxRank:function(){for(var t=this._haveLowRank?8:9,e=this._curRank,i=0;i<t;i++){e-=this.getCurRankGap(e)}return e},getNewRecord:function(){return this._newRecord},haveLowRank:function(){return this._haveLowRank},getBeforBattleRank:function(){return this._beforBattleRank},getAfterBattleRank:function(){return this._afterBattleRank},_parseArenaInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._rankArray=[],this._buyTimes=e.buyTimes,this._curRank=e.rank,this._afterBattleRank=this._curRank,this._maxRank&&this._maxRank>e.maxRank&&(this._newRecord={},this._newRecord.newRecord=!0,this._newRecord.lastRecord=this._maxRank,this._newRecord.curRecord=e.maxRank,this._newRecord.rankUp=this._maxRank-e.maxRank,this._newRecord.rewards=td.GetTableClass(td.TableEnum.ArenaRankUpgradeRewardConfig).getRankUpgradeRewards(this._maxRank,e.maxRank)),this._maxRank=e.maxRank;var i=e.ranks;this._haveLowRank=!1;for(var n=0;n<i.length;n++){var a=i[n],r=new td.ArenaModel;r.init(a),this._rankArray[this._rankArray.length]=r,r.getRank()>this._curRank&&(this._haveLowRank=!0)}this._rankArray.sort(function(t,e){return t.getRank()-e.getRank()}),this.setChallengeTimes(e.playTimes),td.EventUtil.dispatchEvent(td.EventNameEnum.ARENA_CHANGE)}},_resetNewRecordStatus:function(){this._newRecord={newRecord:!1}},_requestGetArenaInfo:function(){if(td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Arena)){var t={};t.module=td.MsgModuleName.ARENA,t.cmd=td.MsgCmd.ARENA.GET_ARENA_INFO,td.ServerDelegate.sendMessage(t)}},_requestGetArenaReport:function(t){var e={};e.module=td.MsgModuleName.ARENA,e.cmd=td.MsgCmd.ARENA.GET_ARENA_REPORT,e.type=t,td.ServerDelegate.sendMessage(e)},_parseArenaReport:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.reports;i.sort(function(t,e){return e.time-t.time}),e.reports=i,td.EventUtil.dispatchEvent(td.EventNameEnum.ARENA_REPORT_SUCCESS,e)}},_onReceiveNewReport:function(t,e){this._newReportTime=td.TimeUtil.getTime(),td.LocalStorageUtil.write(td.LocalDataKey.LAST_REC_ARENA_REPORT,this._newReportTime),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_RECEIVE_NEW_REPORT)},_requestArenaFight:function(t){var e={};e.module=td.MsgModuleName.ARENA,e.cmd=td.MsgCmd.ARENA.ARENA_CHALLENGE,e.opponent=t,td.ServerDelegate.sendMessage(e),this._beforBattleRank=this._curRank},_requestArenaSweep:function(t){var e={};e.module=td.MsgModuleName.ARENA,e.cmd=td.MsgCmd.ARENA.ARENA_WIPE_OUT,e.opponent=t,td.ServerDelegate.sendMessage(e)},_onArenaSweep:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult,!0);td.GlobalFunction.showRewards(i)}},_requestResetArenaTimes:function(t){var e={};e.module=td.MsgModuleName.ARENA,e.cmd=td.MsgCmd.ARENA.ARENA_RESET_TIMES,td.ServerDelegate.sendMessage(e)},_onResetArenaTimes:function(t,e){td.NetCode.SUCCESS}},cc._RF.pop()},{}],ArenaModel:[function(t,e,i){"use strict";cc._RF.push(e,"d8b2bO0l2NIj4IygAquUPqx","ArenaModel");var n=t("BaseUser"),a=t("HeroModel");td.ArenaModel=cc.Class({extends:n,properties:{_showMercenary:null,_rank:null,_titleId:null,_isMyself:null},init:function(t){this._super("ArenaModel",t.attributes),this._titleId=t.attributes[td.UserPropertyEnum.TITLE_ID],this._rank=t.rank;var e=td.GetTableClass(td.TableEnum.HeroTable);this._showMercenary=new a;var i=td.GetTableClass(td.TableEnum.LiveShowConfigTable).getRoleTypeByShowId(this.firstHeroId);this._showMercenary.init(e.getHeroById(i));var n=td.Account.getUserData();this._isMyself=n&&this.sid==n.sid},getRank:function(){return this._rank},getTitleId:function(){return this._titleId},getShowMercenary:function(){return this._showMercenary},isMyself:function(){return this._isMyself}}),cc._RF.pop()},{BaseUser:"BaseUser",HeroModel:"HeroModel"}],ArenaRankRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"0f224QoiBNOUZaRAnlBoSjp","ArenaRankRewardConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ArenaRankRewardConfig",properties:{_tblName:"arena_rank_reward_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i)t[t.length]=e[i];t=t.sort(function(t,e){return t.rank-e.rank});for(i=0;i<t.length;i++){var a=t[i];a.max=a.rank,a.min=t[i-1]?t[i-1].rank+1:a.rank}},getSortRankReward:function(){return this._data},getRankReward:function(t){for(var e=0;e<this._data.length;e++){var i=this._data[e];if(i.min<=t&&i.max>=t)return i.reward}}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ArenaRankUpgradeRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"b8528BGWaROVJz+XtJmv5kM","ArenaRankUpgradeRewardConfig");var n=t("BaseTable");cc.Class({extends:n,name:"ArenaRankUpgradeRewardConfig",properties:{_tblName:"arena_rank_upgrade_reward_config",_data:null,_deleteJson:{default:!1,override:!0}},_getRankBaseItem:function(t){for(var e=this._jsonData,i=e.length-1;i>=0;i--){var n=e[i];if(n.rank<=t)return n}},getRankUpgradeRewards:function(t,e){var i=this._getRankBaseItem(t),n=this._getRankBaseItem(e);return i.rank===n.rank?Math.floor((t-e)/i.upgrade)*i.reward:Math.floor((t-i.rank)/i.upgrade)*i.reward+Math.floor((i.rank-e)/n.upgrade)*n.reward}});cc._RF.pop()},{BaseTable:"BaseTable"}],AssistRelation:[function(t,e,i){"use strict";cc._RF.push(e,"5f53f6z59pDervE8mquhOSt","AssistRelation");var n=t("Model");cc.Class({extends:n,properties:{_id:null,_name:null,_icon:null,_effectPercent:null,_activeType:null,_activeValue:null,_description:null,_isActive:null},init:function(t){this._id=t.id,this._name=t.name,this._icon=t.icon,this._activeType=t.type,this._activeValue=t.value,this._effectValue=t.effectValue,this._effectPercent=t.effectTTPercent,this._description=t.des,this._super("AssistRelation")},getId:function(){return this._id},getName:function(){return this._name},getIconRes:function(){return this._icon},getAddValue:function(){return this._effectValue},getEffect:function(){return this._effectPercent},getDescription:function(){return this._description},getActiveType:function(){return this._activeType},getActiveValue:function(){return this._activeValue},setActive:function(t){this._isActive=t},isActive:function(){return this._isActive}});cc._RF.pop()},{Model:"Model"}],AuctionEnum:[function(t,e,i){"use strict";cc._RF.push(e,"23f5fzdTQhDaYqn7+KCXQaQ","AuctionEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.ITEM_TYPE=i.AUCTION_STATE=i.AUCTION_SALED_TYPE=i.AUCTION_TYPE=void 0,function(t){t[t.YAMA=1]="YAMA",t[t.PASS_BY=999]="PASS_BY"}(i.AUCTION_TYPE||(i.AUCTION_TYPE={})),function(t){t[t.COMPETE=1]="COMPETE",t[t.ONE_PRICE=2]="ONE_PRICE",t[t.NO_LIMIT=3]="NO_LIMIT"}(i.AUCTION_SALED_TYPE||(i.AUCTION_SALED_TYPE={})),function(t){t[t.SHOW=1]="SHOW",t[t.AUCTION_ING=2]="AUCTION_ING",t[t.AUCTION_END=3]="AUCTION_END",t[t.PASS_BY=4]="PASS_BY"}(i.AUCTION_STATE||(i.AUCTION_STATE={})),function(t){t[t.NORMAL=1]="NORMAL",t[t.NO_LIMIT=2]="NO_LIMIT"}(i.ITEM_TYPE||(i.ITEM_TYPE={})),cc._RF.pop()},{}],AuctionItemModel:[function(t,e,i){"use strict";cc._RF.push(e,"c55893MZ6lCHppcHdBakRog","AuctionItemModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Enum/AuctionEnum"),a=window.td,r=(t("ItemModel"),function(){function t(){this._id=0,this._uid=0,this._itemInfo=null,this._playShowTime=0,this._passByShowTime=0,this._basePrice=0,this._itemType=1,this._addPriceNum=0,this._maxPrice=null,this._curPrice=0,this._playerInfo={},this._playTypeId=null,this._beginTime=0,this._endTime=0,this._resetTimes=0,this._isShowedLog=!0,this._bidActorIds=[]}return t.prototype.init=function(t){var e=a.GetTableClass(a.TableEnum.AuctionItemTable).getDataById(t);this._id=e.id;var i=a.RewardManager.parseRewardListDetail(e.rewards)[0];this._itemInfo=i,this._playShowTime=0,this._passByShowTime=0,this._itemType=e.type,this._basePrice=e.price,this._addPriceNum=e.increasePrice,this._maxPrice=e.maxPrice,this._rank=e.rank},t.prototype.setServerData=function(t){this._curPrice=t.price,this._uid=t.uid,this._playerInfo=t.attributes,this._beginTime=t.beginTime,this._endTime=t.endTime,this._resetTimes=t.resetTimes,this._playTypeId=t.playTypeId,this._bidActorIds=t.bidActorIds},t.prototype.getId=function(){return this._id},t.prototype.getUId=function(){return this._uid},t.prototype.getItemInfo=function(){return this._itemInfo},t.prototype.getPlayShowTime=function(){return this._playShowTime},t.prototype.getPassBuShowTime=function(){return this._passByShowTime},t.prototype.getBasePrice=function(){return this._basePrice},t.prototype.getAddPriceNum=function(){return this._addPriceNum},t.prototype.getMaxPrice=function(){return this._maxPrice},t.prototype.getCurPrice=function(){return this._curPrice},t.prototype.getItemType=function(){return this._itemType},t.prototype.getPlayerInfo=function(){return this._playerInfo},t.prototype.getPlayTypeId=function(){return this._playTypeId},t.prototype.getBeginTime=function(){return this._beginTime},t.prototype.getEndTime=function(){return this._endTime},t.prototype.setShowedLog=function(t){this._isShowedLog=t},t.prototype.setPlayTypeId=function(t){this._playTypeId=t},t.prototype.getRank=function(){return this._rank},t.prototype.setCurRank=function(t){this._curRank=t},t.prototype.getCurRank=function(){return this._curRank},t.prototype.getLeftShowTime=function(){var t=a.TimeUtil.getTime(),e=this._beginTime-t;return a.TimeUtil.getHoursFromMilliSecond(e)},t.prototype.getLeftAuctionTime=function(){var t=a.TimeUtil.getTime(),e=this._endTime-t;return a.TimeUtil.getHoursFromMilliSecond(e)},t.prototype.isSelfAuctioned=function(){for(var t=a.Account.getUserData().getGamerId(),e=0;e<this._bidActorIds.length;e++){if(this._bidActorIds[e]==t)return!0}return!1},t.prototype.isPassby=function(){return this._playerInfo.myLen()<=0},t.prototype.isShowedLog=function(){return this._isShowedLog},t.prototype.isSelfMaxPrice=function(){var t=a.Account.getUserData().getGamerId();return this._playerInfo.myLen()>0&&t==this._playerInfo[a.UserPropertyEnum.GamerId]},t.prototype.isBiding=function(){return this._bidActorIds.length>0&&this.getAuctionState()==n.AUCTION_STATE.AUCTION_ING},t.prototype.getAuctionState=function(){var t=a.TimeUtil.getTime();return t<this._beginTime?n.AUCTION_STATE.SHOW:t>this._endTime?this._playerInfo.myLen()>0?n.AUCTION_STATE.AUCTION_END:n.AUCTION_STATE.PASS_BY:n.AUCTION_STATE.AUCTION_ING},t.prototype.getAuctionedType=function(){return this._itemType==n.ITEM_TYPE.NORMAL?this._curPrice<this._maxPrice?n.AUCTION_SALED_TYPE.COMPETE:n.AUCTION_SALED_TYPE.ONE_PRICE:n.AUCTION_SALED_TYPE.NO_LIMIT},t.prototype.isTodayItem=function(){var t=a.TimeUtil.getTheZeroPoint(),e=t+864e5;return this._endTime>=t&&this._endTime<e},t}());i.default=r,cc._RF.pop()},{"../Enum/AuctionEnum":"AuctionEnum",ItemModel:"ItemModel"}],AuctionItemTable:[function(t,e,i){"use strict";cc._RF.push(e,"c9575YpRYhId4crGmvXF2kw","AuctionItemTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="AuctionItemTable",e._tblName="auction_item_config",e._datas={},e}return n(e,t),e.prototype.init=function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.id]=e}},e.prototype.getDatas=function(){return this._datas},e.prototype.getDataById=function(t){for(var e in this._datas){var i=this._datas[e];if(parseInt(e)==t)return i}},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],AuctionManager:[function(t,e,i){"use strict";cc._RF.push(e,"d7006sS9+FOIYMH236kgLjh","AuctionManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,a=(n.ccclass,n.property,window.td),r=t("../Enum/AuctionEnum"),o=t("../Model/AuctionItemModel"),s=t("../Model/AuctionPlayTypeModel"),l=t("../../Nation/Enum/NationEnum"),c=t("../../Nation/Manager/ScuffleYamaManager"),u=function(){function t(){this._playTypes=[],this._isFail=!1,this._beginTimes={},this._endTimes={},this._failNotShow=[],this._failShowed=[],this._isClounding=!1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this._addServerListener(),this._addEventListener(),gdk.Timer.loop(1e3,this,this._updateTime)},t.prototype.destroyData=function(){this._playTypes=[],this._beginTimes={},this._endTimes={},this._isFail=!1},t.prototype._addServerListener=function(){var t=a.ServerDelegate,e=a.MsgModuleName.AUCTION,i=a.MsgCmd.AUCTION;t.registerMessage(e,i.GET_INFO,this._resAuctionInfo.bind(this)),t.registerMessage(e,i.AUCTION,this._resAuction.bind(this)),t.registerMessage(e,i.PUSH_INFO,this._dealPushInfo.bind(this)),t.registerMessage(e,i.PUSH_REFRESH,this._dealPushRefresh.bind(this))},t.prototype._addEventListener=function(){var t=a.EventUtil,e=a.EventNameEnum,i={};i[e.Res_Apply_Join_Nation]=this._reqAuctionInfo,i[e.USER_ATTR_LEVEL_CHANGE]=this._reqAuctionInfo,i[e.ON_GET_SERVER_START_DAYS]=this._reqAuctionInfo,i[e.REQ_AUCTION_INFO]=this._reqAuctionInfo,i[e.REQ_AUCTION]=this._reqAuction,i[e.Res_Nation_Exit]=this.onNationKickOff,i[e.SET_CLOUD_SHOW_STATUS]=this._refreshCloundState,t.registerEvents(i,this)},t.prototype._reqAuctionInfo=function(){if(this.isShowMoreEnter()){var t={};t.module=a.MsgModuleName.AUCTION,t.cmd=a.MsgCmd.AUCTION.GET_INFO,a.ServerDelegate.sendMessage(t)}},t.prototype._resAuctionInfo=function(t,e){t===a.NetCode.SUCCESS&&e.items&&(this.initPlayTypes(e.items),this.pauseYamaItems(e.items),a.EventUtil.dispatchEvent(a.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL),a.EventUtil.dispatchEvent(a.EventNameEnum.REFRESH_SHOW_MORE_LAYER),a.EventUtil.dispatchEvent(a.EventNameEnum.REFRESH_AUCTION_MAIN_PANEL))},t.prototype._reqAuction=function(t){var e={};e.module=a.MsgModuleName.AUCTION,e.cmd=a.MsgCmd.AUCTION.AUCTION,e.type=t.type,e.uid=t.uid,e.price=t.price,a.ServerDelegate.sendMessage(e)},t.prototype._resAuction=function(t,e){a.NetCode.SUCCESS},t.prototype._dealPushInfo=function(t,e){t===a.NetCode.SUCCESS&&e.items&&(this.refreshPlayList(e.items),a.EventUtil.dispatchEvent(a.EventNameEnum.REFRESH_AUCTION_MAIN_PANEL,!0))},t.prototype._dealPushRefresh=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.REQ_AUCTION_INFO)},t.prototype.onNationKickOff=function(){var e=t.getInstance();e.destroyData(),e.init(),a.EventUtil.dispatchEvent(a.EventNameEnum.REQ_AUCTION_INFO)},t.prototype._updateTime=function(){var t=a.TimeUtil.getTime(),e=this._beginTimes;for(var i in e){var n=e[i],r=parseInt(i);t>=n&&(delete this._beginTimes[r],a.EventUtil.dispatchEvent(a.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL),a.EventUtil.dispatchEvent(a.EventNameEnum.REFRESH_SHOW_MORE_LAYER),a.EventUtil.dispatchEvent(a.EventNameEnum.AUCTION_PLAYTYPE_BEGIN,r))}var o=this._endTimes;for(var i in o){var s=o[i];r=parseInt(i);t>=s&&(delete this._endTimes[r],a.EventUtil.dispatchEvent(a.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL),a.EventUtil.dispatchEvent(a.EventNameEnum.REFRESH_SHOW_MORE_LAYER),a.EventUtil.dispatchEvent(a.EventNameEnum.AUCTION_PLAYTYPE_END,r),this.clearFailByType(r))}},t.prototype.setPlayTypeBeginTime=function(t,e){var i=this.getPlayTypeById(t),n=i.getBeginTime();e.getBeginTime()>=n&&(i.setBeginTime(e.getBeginTime()),this._beginTimes[i.getPlayId()]=e.getBeginTime())},t.prototype.setPlayTypeEndTime=function(t,e){var i=this.getPlayTypeById(t),n=i.getEndTime();e.getEndTime()>=n&&(i.setEndTime(e.getEndTime()),this._endTimes[i.getPlayId()]=e.getEndTime())},t.prototype.checkFailItems=function(t){var e=t.getUId();if(this._failShowed=this.getFailShowed(),this._failNotShow=this.getFailItems(),t.isSelfAuctioned()&&!t.isSelfMaxPrice()&&-1==this._failNotShow.indexOf(e)&&-1==this._failShowed.indexOf(e)&&t.getAuctionState()==r.AUCTION_STATE.AUCTION_ING)if(this.isCurInAuction()){this._failShowed.push(e);var i=JSON.stringify(this._failShowed);a.GlobalFunction.setLocalSaveStatus("AuctionFailShowedItems",i)}else{this._failNotShow.push(e);var n=JSON.stringify(this._failNotShow);a.GlobalFunction.setLocalSaveStatus("AuctionFailItems",n)}},t.prototype.isCurInAuction=function(){var t=a.PanelManager.getInstance().getCurShowPanel();return!!t&&t.getPanelEnum()==a.PanelEnum.Panel_AuctionMain},t.prototype.clearFailItems=function(){for(var t=0;t<this._failNotShow.length;t++){var e=this._failNotShow[t];-1==this._failShowed.indexOf(e)&&this._failShowed.push(e)}this._failNotShow=[];var i=JSON.stringify(this._failNotShow);a.GlobalFunction.setLocalSaveStatus("AuctionFailItems",i);var n=JSON.stringify(this._failShowed);a.GlobalFunction.setLocalSaveStatus("AuctionFailShowedItems",n)},t.prototype.getFailItems=function(){if(this._failNotShow.length<=0){var t=a.GlobalFunction.getLocalSaveData("AuctionFailItems");this._failNotShow=t?JSON.parse(t):[]}return this._failNotShow},t.prototype.getFailShowed=function(){if(this._failShowed.length<=0){var t=a.GlobalFunction.getLocalSaveData("AuctionFailShowedItems");this._failShowed=t?JSON.parse(t):[]}return this._failShowed},t.prototype.refreshFail=function(t){var e=t.getUId(),i=this._failNotShow.indexOf(e);-1!=i&&this._failNotShow.splice(i,1);var n=this._failShowed.indexOf(e);-1!=n&&this._failShowed.splice(n,1);var r=JSON.stringify(this._failNotShow);a.GlobalFunction.setLocalSaveStatus("AuctionFailItems",r);var o=JSON.stringify(this._failShowed);a.GlobalFunction.setLocalSaveStatus("AuctionFailShowedItems",o)},t.prototype.clearFailByType=function(t){for(var e=this.getPlayTypeById(t),i=e?e.getItems():[],n=0;n<i.length;n++){var r=i[n].getUId(),o=this._failNotShow.indexOf(r);-1!=o&&this._failNotShow.splice(o,1);var s=this._failShowed.indexOf(r);-1!=s&&this._failShowed.splice(s,1)}var l=JSON.stringify(this._failNotShow);a.GlobalFunction.setLocalSaveStatus("AuctionFailItems",l);var c=JSON.stringify(this._failShowed);a.GlobalFunction.setLocalSaveStatus("AuctionFailShowedItems",c)},t.prototype._refreshCloundState=function(t){this._isClounding=t},t.prototype.isClonding=function(){return this._isClounding},t.prototype.isRedPointTip=function(){return this._isFail},t.prototype.setIsFail=function(t){this._isFail=t,a.EventUtil.dispatchEvent(a.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL),a.EventUtil.dispatchEvent(a.EventNameEnum.REFRESH_SHOW_MORE_LAYER),a.EventUtil.dispatchEvent(a.EventNameEnum.AUCTION_REFRESH_REDPOINT)},t.prototype.redPointEvts=function(){return[a.EventNameEnum.AUCTION_REFRESH_REDPOINT,a.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL,a.EventNameEnum.REFRESH_SHOW_MORE_LAYER]},t.prototype.getPlayTypeList=function(){for(var t=[],e=0;e<this._playTypes.length;e++){var i=this._playTypes[e];i.isShowItems()&&t.push(i)}return t},t.prototype.initPlayTypes=function(t){for(var e in this._playTypes=[],t){var i=parseInt(e),n=t[e],a=this.initePlayTypeModel(i);this._beginTimes[i]=a.getCfgBeginTime(i),this._endTimes[i]=a.getCfgEndTime(i),this._playTypes.push(a);var r=this.initItems(i,n);a.setItems(r)}this.sortPlayTypes()},t.prototype.initePlayTypeModel=function(t){var e=new s.default;return e.init(t),e},t.prototype.sortPlayTypes=function(){this._playTypes.sort(function(t,e){return t.getPlayId()==r.AUCTION_TYPE.PASS_BY?1:e.getPlayId()==r.AUCTION_TYPE.PASS_BY?-1:t.getOrder()-e.getOrder()})},t.prototype.getPlayTypeById=function(t){for(var e=0;e<this._playTypes.length;e++){var i=this._playTypes[e];if(i.getPlayId()==t)return i}return null},t.prototype.initItems=function(t,e){for(var i=[],n=0;n<e.length;n++){var a=e[n];a.playTypeId=t;var r=this.initItemModel(a);i.push(r),this.setPlayTypeBeginTime(t,r),this.setPlayTypeEndTime(t,r),this.checkFailItems(r)}return i=this.sortItems(i)},t.prototype.initItemModel=function(t){var e=new o.default;return e.init(t.id),e.setServerData(t),e},t.prototype.sortItems=function(t){t.sort(function(t,e){return t.getAuctionState()==r.AUCTION_STATE.AUCTION_END?1:e.getAuctionState()==r.AUCTION_STATE.AUCTION_END?-1:t.getRank()!=e.getRank()?t.getRank()-e.getRank():t.getUId()-e.getUId()});for(var e=0;e<t.length;e++){t[e].setCurRank(e)}return t},t.prototype.specialSortItems=function(t){return t.sort(function(t,e){return t.getCurRank()-e.getCurRank()}),t},t.prototype.refreshPlayList=function(t){for(var e in t){var i=parseInt(e),n=t[e],o=this.getPlayTypeById(i);if(!o){o=this.initePlayTypeModel(i),this._beginTimes[i]=o.getCfgBeginTime(i),this._endTimes[i]=o.getCfgEndTime(i),this._playTypes.push(o);var s=this.initItems(i,n);o.setItems(s),this.sortPlayTypes()}for(var l=0;l<n.length;l++){var c=n[l];c.playTypeId=i;s=o.getItems();var u=this.getItemModel(i,c.uid);u||(u=this.initItemModel(c),s.push(u),s=this.sortItems(s));var d=u.isSelfMaxPrice(),h=u.getAuctionState();u.setServerData(c);var p=u.isSelfMaxPrice(),_=u.getAuctionState();!d&&p&&this.refreshFail(u),p&&(_==r.AUCTION_STATE.AUCTION_END?a.EventUtil.dispatchEvent(a.EventNameEnum.SHOW_AUCTION_SUC_TIPS,!0):_==r.AUCTION_STATE.AUCTION_ING&&a.EventUtil.dispatchEvent(a.EventNameEnum.SHOW_AUCTION_SUC_TIPS,!1)),h==r.AUCTION_STATE.AUCTION_ING&&_==r.AUCTION_STATE.AUCTION_END&&u.setShowedLog(!1),this.setPlayTypeBeginTime(i,u),this.setPlayTypeEndTime(i,u),this.checkFailItems(u)}}},t.prototype.getItemModel=function(t,e){for(var i=this.getPlayTypeById(t).getItems(),n=0;n<i.length;n++){var a=i[n];if(a.getUId()==e)return a}return null},t.prototype.getAuctionList=function(t,e,i){void 0===t&&(t=!1);var n=[],a=this.getPlayTypeById(e),o=a?a.getItems():[];if(t)for(var s=0;s<o.length;s++)o[s].isTodayItem()&&o[s].isSelfAuctioned()&&o[s].getAuctionState()==r.AUCTION_STATE.AUCTION_ING&&n.push(o[s]);else for(s=0;s<o.length;s++)i?n.push(o[s]):o[s].isTodayItem()&&o[s].getAuctionState()!=r.AUCTION_STATE.PASS_BY&&n.push(o[s]);return n=this.sortItems(n)},t.prototype.getCurAuctionList=function(t,e){void 0===t&&(t=!1);var i=[],n=this.getPlayTypeById(e),a=n?n.getItems():[];if(t)for(var o=0;o<a.length;o++)a[o].isTodayItem()&&a[o].isSelfAuctioned()&&a[o].getAuctionState()==r.AUCTION_STATE.AUCTION_ING&&i.push(a[o]);else for(o=0;o<a.length;o++)a[o].isTodayItem()&&a[o].getAuctionState()!=r.AUCTION_STATE.PASS_BY&&i.push(a[o]);return i=this.specialSortItems(i)},t.prototype.isShowItem=function(t){var e=this.getPlayTypeById(t);return!!e&&e.isShowItems()},t.prototype.getShowLog=function(){for(var t=["","",""],e=[],i=0;i<this._playTypes.length;i++)for(var n=this._playTypes[i].getItems(),o=0;o<n.length;o++){(s=n[o]).getAuctionState()==r.AUCTION_STATE.AUCTION_END&&e.push(s)}e.sort(function(t,e){return t.isShowedLog()&&e.isShowedLog()?e.getEndTime()-t.getEndTime():t.isShowedLog()&&!e.isShowedLog()?1:!t.isShowedLog()&&e.isShowedLog()?-1:t.isShowedLog()||e.isShowedLog()?void 0:e.getEndTime()-t.getEndTime()});for(i=0;i<3;i++){var s;if(s=e[i]){var l=cc.js.formatStr(a.Language.auctionLog,cc.js.formatStr(a.Language["auctionPlayType"+s.getPlayTypeId()]),s.getItemInfo().getName(),a.Language["auctionSaledType"+s.getAuctionedType()],s.getCurPrice());t[i]=l,s.setShowedLog(!0)}}return t},t.prototype.isShowMainEnter=function(){if(!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.AUCTION,0))return!1;var t=a.TimeUtil.getTime(),e=a.GetTableClass(a.TableEnum.AuctionPlayTypeTable).getDatas();for(var i in e){var n=e[i],o=parseInt(i),l=new s.default;l.init(n.type);var c=l.getCfgBeginTime(o),u=Math.max(l.getEndTime(),l.getCfgEndTime(o));if(t>=c&&t<u&&o!=r.AUCTION_TYPE.PASS_BY&&a.UnlockManager.isTargetUnlock(a.ActorUnlockType.AUCTION,o))return!0}return!1},t.prototype.isShowMoreEnter=function(){return!!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.AUCTION,0)},t.prototype.pauseYamaItems=function(t){if(c.default.getInstance().getCurStage()==l.ScuffleYamaStage.Over){var e=t[r.AUCTION_TYPE.YAMA];if(e&&0!=e.length){var i=[];e.forEach(function(t){i.push(t.id)}),c.default.getInstance().setShowAuctionItemList(i)}}},t}();i.default=u,cc._RF.pop()},{"../../Nation/Enum/NationEnum":"NationEnum","../../Nation/Manager/ScuffleYamaManager":"ScuffleYamaManager","../Enum/AuctionEnum":"AuctionEnum","../Model/AuctionItemModel":"AuctionItemModel","../Model/AuctionPlayTypeModel":"AuctionPlayTypeModel"}],AuctionPlayTypeModel:[function(t,e,i){"use strict";cc._RF.push(e,"79324blAtVFeINqOlDNxk1s","AuctionPlayTypeModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Enum/AuctionEnum"),a=window.td,r=function(){function t(){this._playId=0,this._beginTime=0,this._endTime=0,this._items=[],this._order=0}return t.prototype.init=function(t){var e=a.GetTableClass(a.TableEnum.AuctionPlayTypeTable).getDataById(t);this._beginTime=a.TimeUtil.getTheZeroPoint()+60*parseInt(e.beginTime.split(":")[0])*60*1e3+60*parseInt(e.beginTime.split(":")[1])*1e3,this._order=e.rank,this._playId=t},t.prototype.setServerData=function(t){this._items=t.items},t.prototype.getPlayId=function(){return this._playId},t.prototype.setBeginTime=function(t){this._beginTime=t},t.prototype.getBeginTime=function(){return this._beginTime},t.prototype.setEndTime=function(t){this._endTime=t},t.prototype.getEndTime=function(){return this._endTime},t.prototype.setItems=function(t){this._items=t},t.prototype.getItems=function(){return this._items},t.prototype.getOrder=function(){return this._order},t.prototype.isShowItems=function(){return this._endTime>a.TimeUtil.getTime()},t.prototype.getAuctionState=function(){var t=a.TimeUtil.getTime();return t<this._beginTime?n.AUCTION_STATE.SHOW:t>this._endTime?n.AUCTION_STATE.PASS_BY:n.AUCTION_STATE.AUCTION_ING},t.prototype.getCfgBeginTime=function(t){var e=a.GetTableClass(a.TableEnum.AuctionPlayTypeTable).getDataById(t);return a.TimeUtil.getTheZeroPoint()+60*parseInt(e.beginTime.split(":")[0])*60*1e3+60*parseInt(e.beginTime.split(":")[1])*1e3},t.prototype.getCfgEndTime=function(t){var e=a.GetTableClass(a.TableEnum.AuctionPlayTypeTable).getDataById(t);return a.TimeUtil.getTheZeroPoint()+60*parseInt(e.endTime.split(":")[0])*60*1e3+60*parseInt(e.endTime.split(":")[1])*1e3},t}();i.default=r,cc._RF.pop()},{"../Enum/AuctionEnum":"AuctionEnum"}],AuctionPlayTypeTable:[function(t,e,i){"use strict";cc._RF.push(e,"c2de1HWwMZMoLyIRjLJHM5x","AuctionPlayTypeTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="AuctionPlayTypeTable",e._tblName="auction_time_config",e._datas={},e}return n(e,t),e.prototype.init=function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.type]=e}},e.prototype.getDatas=function(){return this._datas},e.prototype.getDataById=function(t){for(var e in this._datas){var i=this._datas[e];if(i.type==t)return i}},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],AutoTest:[function(t,e,i){"use strict";cc._RF.push(e,"f5dc0m/2zdA4q3OXf8C9RdB","AutoTest"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("PveNodePoolManager"),a=t("../../Configs/ids/SceneId"),r="hero/hero_5001/hero_5001",o="hero/hero_5001/pvp/hero_5001_skills_1_H",s="hero/hero_5001/pvp/hero_5001_skills_1_S",l="hero/hero_5001/pvp/hero_5001_skills_2_H",c="hero/hero_5001/pvp/hero_5001_skills_2_S",u="hero/hero_7003/hero_7003",d="hero/hero_7003/pvp/hero_7003_skills_1_H",h="hero/hero_7003/pvp/hero_7003_skills_2_H",p="hero/hero_7003/pvp/hero_7003_skills_2_S",_=function(){function t(){this._dumpInfo=null,this._index=0,this._assetLastRecord={}}return t.prototype.autoJump=function(){this._datas||(this._datas=td.GetTableClass(td.TableEnum.ObtainWay).getDatas(),gdk.Timer.loop(5e3,this,this._doTest))},t.prototype._doTest=function(){var t=Math.floor(Math.random()*this._datas.myLen()),e=this._datas[t].gotoParam,i=null;e[1]&&(i=e[1]),td.PanelJumpManager.jumpToPanel(e[0],i)},t.prototype.mainPanleJump=function(t,e){void 0===e&&(e=3e3),t&&(this._mainPanel=t),this._mainPanel||(this._mainPanel=[td.PanelEnum.Panel_BattleArray,td.PanelEnum.Panel_Mail,td.PanelEnum.Panel_Bag,td.PanelEnum.Panel_Arena,td.PanelEnum.Panel_Task,td.PanelEnum.Panel_Friend,td.PanelEnum.Panel_Manual,td.PanelEnum.Panel_AvatarShowSetting,td.PanelEnum.Panel_Treasure_Bag,td.PanelEnum.Panel_HeroBag,td.PanelEnum.Panel_DestroyTemple,td.PanelEnum.Panel_MagicRecord,td.PanelEnum.Panel_Gacha,td.PanelEnum.Panel_Roam,td.PanelEnum.Panel_Rank,td.PanelEnum.Panel_TopRank,td.PanelEnum.Window_MoneyPenny,td.PanelEnum.Panel_Immortal,td.PanelEnum.Panel_RedPacket,td.PanelEnum.Panel_Endless]),gdk.Timer.loop(e,this,this.doMainPanleJump)},t.prototype.doMainPanleJump=function(){var t=Math.floor(Math.random()*this._mainPanel.length),e=this._mainPanel[t];this._lastData!==e&&(td.PanelJumpManager.jumpToPanel(e),this._lastData=e)},t.prototype.stopAll=function(){gdk.Timer.clearAll(this)},t.prototype.printAllNodeCount=function(){var t=cc.director.getRunningScene();this._nodeCount=0,this.getNodeCount(t),console.log("*****  all node count = "+this._nodeCount)},t.prototype.getNodeCount=function(t){this._nodeCount+=t.childrenCount;for(var e=0;e<t.childrenCount;e++)this.getNodeCount(t.children[e])},t.prototype.printPveNodePool=function(){cc.log(n)},t.prototype.autoShowPvpSkill=function(t){if(!this._heroPvpSkillData||0===this._heroPvpSkillData.length){this._heroPvpSkillData=[];var e=td.GetTableClass(td.TableEnum.HeroPvpPreview).getDatas();for(var i in e)this._heroPvpSkillData.push(e[i].id)}gdk.Timer.loop(t||2e4,this,this._showPvpSkill)},t.prototype._showPvpSkill=function(){if("MainScene"===cc.director.getRunningScene().name){var t=Math.floor(Math.random()*this._heroPvpSkillData.length),e=this._heroPvpSkillData[t];td.GlobalFunction.showHeroSkillPreview(e,td.PanelType.Panel)}},t.prototype.recordDumpInfo=function(){this._dumpInfo={};var t=cc.loader._cache;for(var e in t)this._dumpInfo[e]=!0;cc.log(this._dumpInfo),cc.log("recordDumpInfo len = "+Object.keys(this._dumpInfo).length)},t.prototype.dumpAssetDiff=function(){this._dumpInfo=this._dumpInfo||{};var t=cc.loader._cache;cc.log("recordDumpInfo len = "+Object.keys(this._dumpInfo).length+" curInfo len "+Object.keys(t).length);var e={};for(var i in t)this._dumpInfo[i]||(e[i]=t[i]);return cc.log(e),cc.log("len = "+Object.keys(e).length),e},t.prototype.gdkAddHero5001=function(){gdk.rm.loadRes("hero5001",r,cc.Prefab,function(){cc.log("loadCompelet "+r)}),gdk.rm.loadRes("hero5001",o,cc.Prefab,function(){cc.log("loadCompelet "+o)}),gdk.rm.loadRes("hero5001",s,cc.Prefab,function(){cc.log("loadCompelet "+s)}),gdk.rm.loadRes("hero5001",l,cc.Prefab,function(){cc.log("loadCompelet "+l)}),gdk.rm.loadRes("hero5001",c,cc.Prefab,function(){cc.log("loadCompelet "+c)})},t.prototype.addHero5001=function(){cc.loader.loadRes(r,cc.Prefab,function(){cc.log("loadCompelet "+r)}),cc.loader.loadRes(o,cc.Prefab,function(){cc.log("loadCompelet "+o)}),cc.loader.loadRes(s,cc.Prefab,function(){cc.log("loadCompelet "+s)}),cc.loader.loadRes(l,cc.Prefab,function(){cc.log("loadCompelet "+l)}),cc.loader.loadRes(c,cc.Prefab,function(){cc.log("loadCompelet "+c)})},t.prototype.gdkRelease5001=function(){gdk.rm.releaseResByPanel("hero5001")},t.prototype.releaseHero5001=function(){this.releaseRes(r,cc.Prefab),this.releaseRes(o,cc.Prefab),this.releaseRes(s,cc.Prefab),this.releaseRes(l,cc.Prefab),this.releaseRes(c,cc.Prefab)},t.prototype.gdkAddHero7001=function(){gdk.rm.loadRes("hero7001",u,cc.Prefab,function(){cc.log("loadCompelet "+u)}),gdk.rm.loadRes("hero7001",d,cc.Prefab,function(){cc.log("loadCompelet "+d)}),gdk.rm.loadRes("hero7001",h,cc.Prefab,function(){cc.log("loadCompelet "+h)}),gdk.rm.loadRes("hero7001",p,cc.Prefab,function(){cc.log("loadCompelet "+p)})},t.prototype.addHero7001=function(){cc.loader.loadRes(u,cc.Prefab,function(){cc.log("loadCompelet "+r)}),cc.loader.loadRes(d,cc.Prefab,function(){cc.log("loadCompelet "+d)}),cc.loader.loadRes(h,cc.Prefab,function(){cc.log("loadCompelet "+h)}),cc.loader.loadRes(p,cc.Prefab,function(){cc.log("loadCompelet "+p)})},t.prototype.gdkRelease7001=function(){gdk.rm.releaseResByPanel("hero7001")},t.prototype.releaseHero7001=function(){this.releaseRes(u,cc.Prefab),this.releaseRes(d,cc.Prefab),this.releaseRes(h,cc.Prefab),this.releaseRes(p,cc.Prefab)},t.prototype.releaseRes=function(t,e){for(var i=cc.loader._getResUuid(t,e),n=cc.loader._getReferenceKey(i),a=cc.loader.getDependsRecursively(n),r=0,o=a.length;r<o;r++)cc.loader.release(a[r])},t.prototype.releaseDiff=function(){if(this._dumpInfo){var t=this.dumpAssetDiff();for(var e in t){var i=t[e];cc.loader.release(i.id)}}},t.prototype.loopClearPckData=function(){gdk.Timer.loop(12e4,this,function(){window._Test.PackDownloader.reset()})},t.prototype.loopLoadPvpFightPanelResAndRelease=function(){gdk.Timer.loop(4e3,this,this._addOrDelPvpFightPanelRes)},t.prototype._addOrDelPvpFightPanelRes=function(){if(this._index%2==0){var t=a.default.PvPFightScene.resArr.concat(td.ModuleManager.getSelfMercenaryModules());gdk.rm.loadResByModule("Scene#"+a.default.PvPFightScene.name,t,null,function(t){},function(t){t||cc.log("\u8d44\u6e90\u52a0\u8f7d\u5b8c\u6bd5")})}else gdk.rm.releaseResByPanel("Scene#"+a.default.PvPFightScene.name);this._index++},t.prototype._recordInfo=function(t){var e=cc.assetManager.assets._map,i=[cc.resources,cc.assetManager.getBundle("hero"),cc.assetManager.getBundle("fightRes")];for(var n in e)for(var a=e[n],r=0;r<i.length;r++){var o=i[r].getAssetInfo(a._uuid);o&&(t[a._uuid]=o)}},t.prototype.assetRecord=function(){this._assetLastRecord={},this._recordInfo(this._assetLastRecord)},t.prototype.diffRecord=function(t){var e=cc.assetManager.assets._map,i={};this._recordInfo(i),cc.log(" **************** diff begin ***********");var n=0;for(var a in i)this._assetLastRecord[a]||t&&e[a].constructor!=t||(cc.log(i[a]),cc.log(e[a]),n++);cc.log("count : "+n),cc.log(" **************** diff end ***********")},t}();td.autoTest=new _,cc._RF.pop()},{"../../Configs/ids/SceneId":void 0,PveNodePoolManager:"PveNodePoolManager"}],AvatarConfig:[function(t,e,i){"use strict";cc._RF.push(e,"00e3aL3eGNNmJUvbCj/7gbl","AvatarConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"AvatarConfig",properties:{_tblName:"avatar_config",_data:null,_typeData:null},init:function(){this._data={},this._typeData={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a;var r=a.type;this._typeData[r]=this._typeData[r]||[],this._typeData[r].push(a)}},getAvartarDataByType:function(t){return this._typeData[t]||[]},getAvatarDataById:function(t){return this._data[t]},getAvatarIconByAvatarId:function(t){return(this._data[t]||{}).avatarIcon}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],AvatarModel:[function(t,e,i){"use strict";cc._RF.push(e,"0fefdHc8XNJIJ69gNjY2qHD","AvatarModel"),td.AvatarModel=cc.Class({properties:{avatar:null,avatarIcon:null,_type:null,_unlockDesc:null,_isUnlock:null,_rank:null},init:function(t){this.avatar=t.id,this.avatarIcon=t.avatarIcon,this._type=t.type,this._unlockDesc=t.unlockDesc,this._rank=t.rank||0},setIsUnlock:function(t){this._isUnlock=t},getIsUnlock:function(){return this._isUnlock},getRank:function(){return this._rank},getAvatar:function(){return this.avatar},getAvatarIcon:function(){return this.avatarIcon},getType:function(){return this._type},getUnlockDesc:function(){return this._unlockDesc}}),cc._RF.pop()},{}],AvatarShowSettingManager:[function(t,e,i){"use strict";cc._RF.push(e,"ac8a8dYB6RKs5WENalURygP","AvatarShowSettingManager"),td.AvatarShowSettingManager={_bInit:null,_newAvatarList:null,_newShowList:null,init:function(){this._bInit=!1,this._newAvatarList={},this._newShowList={},this._addNetListeners(),this._addLocalListeners()},destroyData:function(){this._bInit=null},_addNetListeners:function(){var t=td.ServerDelegate,e=td.MsgModuleName.USER,i=td.MsgCmd.User;t.registerMessage(e,i.UPDATE_AVATAR,this._updateAvatarReturn.bind(this)),t.registerMessage(e,i.UPDATE_LINE_UP_SHOW,this._updateShowReturn.bind(this))},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQUEST_UPDATE_AVATAR]=this._requestUpdateAvatar,i[e.REQUEST_UPDATE_SHOW]=this._requestUpdateShow,i[e.USER_AVATAR_CHANGE]=this._newAvatarUnlock,i[e.USER_SHOW_CHANGE]=this._newShowUnlock,i[e.ON_AVATAR_CLICKED]=this._deleteAvatarUnlock,i[e.ON_SHOW_CLICKED]=this._deleteShowUnlock,t.registerEvents(i,this)},isAvatarSettingRedPoint:function(){return this.isAvatarRedPoint()||this.isShowRedPoint()},isAvatarRedPoint:function(){return this._newAvatarList.myLen()>0},isAvatarRedPointById:function(t){return this._newAvatarList[t]},isShowRedPoint:function(){return this._newShowList.myLen()>0},isShowRedPointById:function(t){return this._newShowList[t]},avatarSettingRedPointEvts:function(){return[td.EventNameEnum.CHECK_AVATAR_RED_POINT]},isAvatarUnlock:function(t){for(var e=td.Account.getUserData().getAvatarList()||[],i=0;i<e.length;i++)if(t==e[i])return!0;return!1},isLiveShowUnlock:function(t){for(var e=td.Account.getUserData().getShowList()||[],i=0;i<e.length;i++)if(t==e[i])return!0;return!1},getAvatarModulesByType:function(t){for(var e=[],i=td.GetTableClass(td.TableEnum.AvatarConfig).getAvartarDataByType(t),n=i.length,a=0;a<n;a++){var r=i[a],o=new td.AvatarModel,s=r.id;o.init(r),o.setIsUnlock(this.isAvatarUnlock(s)),e.push(o)}return e.length>0&&e.sort(function(t,e){return t.getIsUnlock()&&!e.getIsUnlock()?-1:!t.getIsUnlock()&&e.getIsUnlock()?1:t.getRank()-e.getRank()}),e},getLiveShowModules:function(){var t=[],e=td.GetTableClass(td.TableEnum.LiveShowConfigTable).getLiveShowData();for(var i in e){var n=e[i],a=new td.LiveShowModel;a.init(n);var r=a.getId();a.setIsUnlock(this.isLiveShowUnlock(r)),t.push(a)}return t.length>0&&t.sort(function(t,e){return t.getIsUnlock()===e.getIsUnlock()?0:t.getIsUnlock()?-1:1}),t},getAvatarIconByShowId:function(t){var e=td.GetTableClass(td.TableEnum.LiveShowConfigTable).getAvatarIdByShowId(t);return td.GetTableClass(td.TableEnum.AvatarConfig).getAvatarIconByAvatarId(e)},_requestUpdateAvatar:function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.UPDATE_AVATAR,e.avatarId=t,td.ServerDelegate.sendMessage(e)},_requestUpdateShow:function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.UPDATE_LINE_UP_SHOW,e.showId=t,td.ServerDelegate.sendMessage(e)},_updateAvatarReturn:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.UPDATE_AVATAR_SUCCESS)},_updateShowReturn:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.UPDATE_SHOW_SUCCESS)},_newAvatarUnlock:function(t){for(var e=0,i=t.length;e<i;e++)this._newAvatarList[t[e]]=!0;td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_AVATAR_RED_POINT)},_newShowUnlock:function(t){for(var e=0,i=t.length;e<i;e++)this._newShowList[t[e]]=!0;td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_AVATAR_RED_POINT)},_deleteAvatarUnlock:function(t){this._newAvatarList[t]&&(delete this._newAvatarList[t],td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_AVATAR_RED_POINT))},_deleteShowUnlock:function(t){this._newShowList[t]&&(delete this._newShowList[t],td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_AVATAR_RED_POINT))}},cc._RF.pop()},{}],AvatarTypeEnum:[function(t,e,i){"use strict";cc._RF.push(e,"2b009daYWtOgLSpeemzWoGc","AvatarTypeEnum"),td.AvatarType={VIP:1,SPECIAL:2,HERO:3,Monster:100,NONE:0},cc._RF.pop()},{}],AwakeBase:[function(t,e,i){"use strict";cc._RF.push(e,"0403dNDtNdJ4LGhNfSixRn1","AwakeBase");var n=t("Model"),a=cc.Class({extends:n,properties:{_level:null,_maxLevel:null,_isFull:null,_curData:null,_nextData:null,_maxData:null},init:function(t){this._super(t||"AwakeBase"),this._level=0,this._maxLevel=0,this._isFull=!1,this._curData=null,this._nextData=null,this._maxData=null},getLevel:function(){return this._level},getMaxLevel:function(){return this._maxLevel},isFull:function(){return this._isFull},getCurData:function(){return this._curData},getNextData:function(){return this._nextData},getMaxData:function(){return this._maxData},getAwakeValueAddByType:function(t){var e=0;if(0===this._level)return e;if(!this._curData)return cc.log("getAwakeValueAddByType error!!!"),e;var i=this._curData.getBaseTotalAttr();for(var n in i)parseInt(n)===t&&(e+=i[n]);return e},getAwakePercentAdd:function(){var t={};if(0===this._level)return t;if(!this._curData)return cc.log("getAwakePercentAdd error!!!"),t;var e=this._curData.getBaseTotalAttrPercent();for(var i in e)parseInt(i)&&(t[i]?t[i].setOperateValue(e[i].getOperateValue()):t[i]=cc.instantiate(e[i]));return t}});e.exports=a,cc._RF.pop()},{Model:"Model"}],AwakenBaseModel:[function(t,e,i){"use strict";cc._RF.push(e,"d1a892k17lHwIlloM4IsKYV","AwakenBaseModel");var n=t("Model"),a=cc.Class({extends:n,properties:{_cost:null,devour:null,_restoreItem:null,_baseAttr:null,_baseAttrPercent:null,_baseTotalAttr:null,_baseTotalAttrPercent:null},init:function(t,e){this._super(t||"AwakenBaseModel");var i=td.RewardManager,n=td.GlobalFunction;this._cost=i.parseRewardListDetail(e.cost),this.devour=e.devour,this._restoreItem=e.restoreRewards,this._baseAttr=n.parseAttrArray(e.baseAttr),this._baseAttrPercent=n.parseEffectArray(e.baseTTPercentAttr),this._baseTotalAttr=n.parseAttrArray(e.baseAttr),this._baseTotalAttrPercent=n.parseEffectArray(e.baseTTPercentAttr)},getCost:function(){return this._cost},getDevour:function(){return this.devour},getRestoreItem:function(){return this._restoreItem},getBaseAttr:function(){return this._baseAttr},getBaseAttrPercent:function(){return this._baseAttrPercent},getBaseTotalAttr:function(){return this._baseTotalAttr},getBaseTotalAttrPercent:function(){return this._baseTotalAttrPercent},setBaseAttr:function(t){var e=t.getBaseTotalAttr(),i=this.getBaseTotalAttr();for(var n in e)i[n]||(i[n]=0),i[n]+=e[n];var a=t.getBaseTotalAttrPercent(),r=this.getBaseTotalAttrPercent();for(var n in a)r[n]?r[n].setOperateValue(r[n].getOperateValue()+a[n].getOperateValue()):r[n]=cc.instantiate(a[n])}});e.exports=a,cc._RF.pop()},{Model:"Model"}],BBCharmRankItem:[function(t,e,i){"use strict";cc._RF.push(e,"36db9myqrhFTZOWiB2+TKfZ","BBCharmRankItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{imgRank:cc.Sprite,labRank:cc.Label,rewardPanel:cc.Node,labAreaName:cc.Label,labCharmCount:cc.Label,labCharmT:cc.Node,labNoPlayerTip:cc.Node},updateItem:function(t,e){this._super(t,e),this.setRank(e),this.setRewardPanel(e),this.setPlayerInfo(e)},setRank:function(t){var e=t.newRank;this.imgRank.node.active=e>=1&&e<=3,this.labRank.node.active=e>3,e>=1&&e<=3?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_paiming_0"+e,this.imgRank.node):e>3&&(this.labRank.string=e)},setRewardPanel:function(t){var e=t.cfgData.rewards;this.rewardPanel.removeAllChildren();for(var i=td.RewardManager.parseRewardListDetail(e),n=0,a=i.length;n<a;n++){var r=i[n],o=td.GlobalFunction.createCommonIconWidget(56,r);o.x=50+85*n,o.y=0,o.scale=.7,this.rewardPanel.addChild(o)}},setPlayerInfo:function(t){var e=t.serverRankData;if(this.labNoPlayerTip.active=!e,this.labCharmT.active=!!e,this.labAreaName.node.active=!!e,this.labCharmCount.node.active=!!e,e){var i=e.getPlayerInfo().getNickNameAndServer(),n=e.getScore();this.labAreaName.string=i,this.labCharmCount.string=n,this.node.getChildByName("labCharmT").getComponent(cc.Label).string=td.Language.BirdBridgeFlowerNum}}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],BBFateRankItem:[function(t,e,i){"use strict";cc._RF.push(e,"631c5xNjf9N1ab4x3v/CM18","BBFateRankItem");var n=t("ListItem"),a=t("AvatarHeadWidget"),r=cc.Class({extends:n,properties:{imgRank:cc.Sprite,labRank:cc.Label,labLevelName:cc.Label,labFateCount:cc.Label},updateItem:function(t,e){this._super(t,e),this.setRank(e),this.setPlayerAvatar(e),this.setPlayerInfo(e)},setRank:function(t){var e=t.getRank();this.imgRank.node.active=e>=1&&e<=3,this.labRank.node.active=e>3,e>=1&&e<=3?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_paiming_0"+e,this.imgRank.node):e>3&&(this.labRank.string=e)},setPlayerAvatar:function(t){var e=t.getPlayerInfo(),i=this.node.getChildByName("playerAvatarNode");i?i.getComponent(a).setData(e):(i=td.GlobalFunction.createAvatarHeadWidget(3,e,!1),this.node.addChild(i),i.x=-120,i.y=0)},setPlayerInfo:function(t){var e=t.getPlayerInfo(),i=e.getLevel(),n=e.getNickName(),a=t.getScore();this.labLevelName.string="Lv."+i+"  "+n,this.labFateCount.string=a,this.node.getChildByName("labFateScoreT").getComponent(cc.Label).string=td.Language.BirdBridgeFateNum}});e.exports=r,cc._RF.pop()},{AvatarHeadWidget:void 0,ListItem:void 0}],BBMatchmakerBlessPanel:[function(t,e,i){"use strict";cc._RF.push(e,"760f2OK8NJI6bckhTKR1BCX","BBMatchmakerBlessPanel");var n=t("HeroModel"),a=t("PanelBase"),r=cc.Class({extends:a,properties:{labTimeT:cc.Label,labTimeDown:cc.Label,imgRoseIcon:cc.Node,labOwnRose:cc.Label,labBlessScore:cc.Label,myInfoNode:cc.Node,progressBar:cc.ProgressBar,boxItem:cc.Node,btnSendOne:cc.Button,btnSendTen:cc.Button,imgOverTip:cc.Node,_curChoosePlayer:null,_boxClosedRes:null,_boxOpenRes:null},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_MatchMakerBless},onLoad:function(){this._super(),this.boxItem.active=!1,this._boxClosedRes=["GY0_baoxiang01","GY0_baoxiang03","GY0_baoxiang05"],this._boxOpenRes=["GY0_baoxiang02","GY0_baoxiang04","GY0_baoxiang06"],this.initBoxes(),this.initTopThreePlayers()},initTopThreePlayers:function(){for(var t=1;t<=3;t++){var e=this.node.getChildByName("item_"+t);e.getChildByName("heroAniNode").active=!1,e.getChildByName("imgNullHero").active=!0,e.getChildByName("infoPanel").active=!1,e.getChildByName("imgTip").active=!0;var i=e.getChildByName("imgLight");i.getComponent(cc.Animation).pause(),i.active=!1,e.getComponent(cc.Button).interactable=!1}},initBoxes:function(){var t=td.GetTableClass(td.TableEnum.BirdBridgeBlessProgressTable),e=t.getMaxDot(),i=this.getActivityController().getActivityData(),n=t.getDataByDataId(i);if(n&&0!=n.length)for(var a=this.progressBar.node.x,r=this.progressBar.node.width,o=0,s=n.length;o<s;o++){var l=n[o].blessingDot,c=a+Math.floor(l/e*r),u=this.node.getChildByName("boxNode"+l);u||((u=cc.instantiate(this.boxItem)).active=!0,u.name="boxNode"+l,u.x=c,u.y=-310,u.$tag=l,this.node.addChild(u)),u.getComponent(cc.Button).clickEvents[0].customEventData=l;var d=Math.ceil((o+1)/2),h=u.getChildByName("imgBox"),p=u.getChildByName("labNum");td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,this._boxClosedRes[d-1],h),p.getComponent(cc.Label).string=l}},getActivityController:function(){var t=td.ActivityEnum.ActivityType.MagpieBridgeParty;return td.ActivityDataManager.getActivityControllerByType(t)},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REFRESH_BB_MATCHMAKER_PANEL]=this.refreshView,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.onReceiveOperation,t[e.BIRD_BRIDGE_ACTIVITY_END]=this.onActivityOver,td.EventUtil.registerEvents(t,this)},onEnable:function(){this._super(),this._addEventListener(),this.queryBlessInfo(),this.setActivityTimeDown(),this.setActivityStatus(),this.setMyInfo(),this.initLabel(),this.schedule(this.updateActivityTime,1),td.GlobalFunction.setLocalSaveStatus("matchmakerBlessLoginTip","1")},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this.unschedule(this.updateActivityTime);for(var t=1;t<=3;t++){this.node.getChildByName("item_"+t).playerData=null}this._super()},initLabel:function(){this.node.getChildByName("labTip").getComponent(cc.Label).string=td.Language.BirdBridgeBlessTip,this.node.getChildByName("myInfoView").getChildByName("labOwnFlowerT").getComponent(cc.Label).string=td.Language.BirdBridgeBlessOwn,this.node.getChildByName("myInfoView").getChildByName("labBlessT").getComponent(cc.Label).string=td.Language.BirdBridgeBless},onActivityOver:function(){this.closeCallFunc()},setActivityStatus:function(){var t=this.getActivityController();if(t){var e=t.checkOpenStatusByStage(td.QiXiStageEnum.MatchmakerBless);this.btnSendOne.node.active=!0,this.btnSendTen.node.active=!0,this.imgOverTip.active=!1;var i=t.getStageTimeWithType(td.QiXiStageEnum.MatchmakerBless);if(i){var n=i.endTime-td.TimeUtil.getTime();e&&(this.btnSendOne.node.active=n>0,this.btnSendTen.node.active=n>0,this.imgOverTip.active=n<=0)}}},queryBlessInfo:function(){this.progressBar.progress=0;var t=this.getActivityController();if(t.checkOpenStatusByStage(td.QiXiStageEnum.MatchmakerBless)){t.operateActivity({parmeterMap:{57:2}})}},refreshView:function(){if(this.setMyInfo(),this.setTopThreePlayerInfo(),this._curChoosePlayer){var t=this._curChoosePlayer.getChildByName("imgLight");t.getComponent(cc.Animation).resume(),t.active=!0}},updateActivityTime:function(t){this.setActivityTimeDown()},setActivityTimeDown:function(){var t=this.getActivityController();if(t){var e=t.getStageTimeWithType(td.QiXiStageEnum.MatchmakerBless);if(e){var i=e.beginTime,n=e.endTime,a=td.TimeUtil.getTime(),r=0;a<i?(r=i-a,this.labTimeT.string=td.Language.openTimecount+":"):(r=n-a,this.labTimeT.string=td.Language.battleEndTime),r>0?this.labTimeDown.string=td.GlobalFunction.getConvertTimeStr(Math.floor(r/1e3),!0):(this.labTimeDown.string=td.Language.end,this.unschedule(this.updateActivityTime),this.setActivityOver())}}},setActivityOver:function(){this.btnSendOne.node.active=!1,this.btnSendTen.node.active=!1,this.imgOverTip.active=!0,this.myInfoNode.active=!1,this.progressBar.node.active=!1;for(var t=td.GetTableClass(td.TableEnum.BirdBridgeBlessProgressTable),e=this.getActivityController().getActivityData(),i=t.getDataByDataId(e),n=0,a=i.length;n<a;n++){var r=i[n].blessingDot,o=this.node.getChildByName("boxNode"+r);o&&(o.active=!1)}},setMyInfo:function(){var t=this.getActivityController().getMyBlessDot();this.labBlessScore.string=t;var e=td.GetTableClass(td.TableEnum.Config).getConfig("BLESSINGS_COST"),i=td.RewardManager.getRewardDetail(e[0]),n=i.getLittleIconRes(),a=i.getId();td.GlobalFunction.createSpriteNode(this.imgRoseIcon,n);var r=td.ItemManager.getItemNumById(a);this.labOwnRose.string=r,this.setProgressBarAndRewardBox(t)},setProgressBarAndRewardBox:function(t){var e=td.GetTableClass(td.TableEnum.BirdBridgeBlessProgressTable).getMaxDot();this.progressBar.progress=t/e;for(var i=this.getActivityController().getBlessRewardList(),n=i.length,a=0;a<n;a++){var r=i[a],o=r.getNeedBlessDot(),s=this.node.getChildByName("boxNode"+o),l=s.getChildByName("imgBox"),c=Math.ceil((a+1)/2),u=s.getComponent(cc.Button),d=r.getReceiveStatus();d===td.ActivityEnum.RewardStatus.RECEIVED?(this.hideAni(s),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,this._boxOpenRes[c-1],l),u.interactable=!1):(d===td.ActivityEnum.RewardStatus.FINISH?(this.addAni(s),u.interactable=!0):(this.hideAni(s),u.interactable=!0),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,this._boxClosedRes[c-1],l))}},setTopThreePlayerInfo:function(){for(var t=this.getActivityController(),e=t.getTopThreePlayers(),i=1;i<=3;i++){var n=this.node.getChildByName("item_"+i),a=n.playerData,r=null;if(a){var o=a.getPlayerInfo().getGamerId();r=t.getBlessPlayerDataById(o)}else n.playerData=e[i-1],r=e[i-1];n.getComponent(cc.Button).interactable=!!r,this.setTopItemInfo(n,r),!this._curChoosePlayer&&1==i&&r&&this.setPlayerItemChooseStatus(n)}},setTopItemInfo:function(t,e){t.getComponent(cc.Button).interactable=!!e;var i=t.getChildByName("heroAniNode"),n=t.getChildByName("imgNullHero"),a=t.getChildByName("imgLight"),r=t.getChildByName("infoPanel"),o=t.getChildByName("imgTip");i.active=!!e,n.active=!e,a.getComponent(cc.Animation).pause(),a.active=!1,r.active=!!e,o.active=!e,e&&(t.$userData=e,this._setHeroShow(i,e),this._setPlayerInfo(r,e))},_setHeroShow:function(t,e){var i=e.getPlayerInfo().getShowHeroId(),a=td.GetTableClass(td.TableEnum.HeroTable),r=new n,o=td.GetTableClass(td.TableEnum.LiveShowConfigTable).getRoleTypeByShowId(i);r.init(a.getHeroById(o)),td.GlobalFunction.showMercenaryFigureAnimation(t,r,!0,null,900)},_setPlayerInfo:function(t,e){var i=e.getPlayerInfo().getNickNameAndServer(),n=e.getCharmScore(),a=t.getChildByName("labAreaName"),r=t.getChildByName("labScore"),o=t.getChildByName("labScoreT");a.getComponent(cc.Label).string=i,r.getComponent(cc.Label).string=n,o.getComponent(cc.Label).string=td.Language.BirdBridgeFlowerNum},setPlayerItemChooseStatus:function(t){if(this._curChoosePlayer){var e=this._curChoosePlayer.getChildByName("imgLight");e.getComponent(cc.Animation).pause(),e.active=!1,this._curChoosePlayer=null}var i=t.getChildByName("imgLight");i.getComponent(cc.Animation).resume(),i.active=!0,this._curChoosePlayer=t},onChoosePlayerItem:function(t,e){var i=e,n=this.node.getChildByName("item_"+i);this.setPlayerItemChooseStatus(n)},onTryToGetBoxReward:function(t,e){var i=this.getActivityController(),n=i.getBlessRewardByBlessDot(e),a=n.getReceiveStatus();e=n.getNeedBlessDot();if(a!==td.ActivityEnum.RewardStatus.RECEIVED)if(a===td.ActivityEnum.RewardStatus.FINISH){var r={parmeterMap:{57:6,58:e}};i.operateActivity(r)}else{var o=n.getRewards();r={rewards:td.RewardManager.parseRewardListDetail(o),isShowBtn:!0};td.GlobalFunction.showRewardPreviewWindow(r)}},onSendOneFlower:function(){this.doSendFlowers(1)},onSendTenFlowers:function(){this.doSendFlowers(10)},doSendFlowers:function(t){if(u=this.getActivityController())if(u.checkOpenStatusByStage(td.QiXiStageEnum.MatchmakerBless)){for(var e=td.GetTableClass(td.TableEnum.Config).getConfig("BLESSINGS_COST"),i=0,n=td.RewardManager.parseRewardListDetail(e),a=0,r=n.length;a<r;a++){var o=n[a],s=o.getId();if((i=td.ItemManager.getItemNumById(s))<=0){var l=o.getName();g=td.Language.sthNoEnough;return void td.MessageBox.showMessage(cc.js.formatStr(g,l))}}var c=1;if(10==t&&(c=i>10?10:i),this._curChoosePlayer&&this._curChoosePlayer.$userData){var u,d={parmeterMap:{57:4,58:this._curChoosePlayer.$userData.getPlayerInfo().getGamerId(),59:c}};(u=this.getActivityController()).operateActivity(d)}}else{var h=u.getStageTimeWithType(td.QiXiStageEnum.MatchmakerBless);if(!h)return;var p=h.beginTime-td.TimeUtil.getTime(),_=td.GlobalFunction.getConvertTimeStr(Math.floor(p/1e3),!0),g=cc.js.formatStr(td.Language.matchMakerOpenTip,_);td.MessageBox.showMessage(g)}},onShowCharmRankWindow:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,td.PanelEnum.Window_BBCharmRank)},onReceiveOperation:function(t){var e=this.getActivityController();if(t.activityId===e.getActivityId()){var i=t.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n)}},addAni:function(t){var e=t.getChildByName("BoxEffect");if(e){e.active=!0,e.getComponent(cc.Animation).play()}else{var i=td.GlobalFunction.getResIdByNode(t);gdk.rm.loadRes(i,"uiAnima/BaoXiang_guangxiao/BaoXiang_guangxiao",cc.Prefab,this.playAni.bind(this,t))}},hideAni:function(t){var e=t.getChildByName("BoxEffect");e&&(e.active=!1)},playAni:function(t){if(cc.isValid(t)){var e=t.getChildByName("BoxEffect");if(!e){var i=gdk.rm.getResByUrl("uiAnima/BaoXiang_guangxiao/BaoXiang_guangxiao",cc.Prefab);(e=cc.instantiate(i)).setScale(.7),e.y=0,e.name="BoxEffect",t.addChild(e,-1)}}}});e.exports=r,cc._RF.pop()},{HeroModel:"HeroModel",PanelBase:void 0}],BBNewMeetPushWindow:[function(t,e,i){"use strict";cc._RF.push(e,"d4a148ErslGlqGXu7Blyg8P","BBNewMeetPushWindow");var n=cc.Class({extends:cc.Component,properties:{labMeetName:cc.Label,imgBG:cc.Node,imgMask:cc.Node,labTip:cc.Label,_totalTime:null,_curMeetData:null},_addEventListener:function(){var t={};t[td.EventNameEnum.BB_MEET_ACTIVITY_END]=this.clearNode,td.EventUtil.registerEvents(t,this)},onEnable:function(){this._addEventListener(),this.labTip.node.active=!1,this._totalTime=5,this.playAction()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this.imgBG.stopAllActions(),this.imgMask.stopAllActions(),this.unschedule(this.setTimeDown)},playAction:function(){this.imgBG.scale=.5,this.imgBG.active=!0,this.imgBG.opacity=255,this.imgMask.opacity=0;var t=cc.repeat(cc.sequence(cc.skewTo(.04,12,-12),cc.skewTo(.04,0,0),cc.skewTo(.04,-6,6),cc.skewTo(.04,0,0),cc.skewTo(.04,-3,3),cc.skewTo(.04,0,0)),5),e=cc.scaleTo(.1,1.3),i=cc.scaleTo(.08,1),n=cc.callFunc(this.imgMaskFadeIn,this),a=cc.spawn(i,n),r=cc.callFunc(this.openEnd,this),o=cc.sequence(t,e,a,r);this.imgBG.stopAllActions(),this.imgBG.runAction(o)},imgMaskFadeIn:function(){var t=cc.fadeTo(.08,170);this.imgMask.stopAllActions(),this.imgMask.runAction(t)},openEnd:function(){this.labTip.node.active=!0,this.labTip.string=cc.js.formatStr(td.Language.continueTips,this._totalTime),this.schedule(this.setTimeDown,1)},setTimeDown:function(){this._totalTime--,this._totalTime<=0?this.doClose():this.labTip.string=cc.js.formatStr(td.Language.continueTips,this._totalTime)},setData:function(t){this._curMeetData=t;var e=t.getMeetId(),i=this.getActivityController();i.addPushedMeetId(e),i.resetPushStatus(),this.setMeetInfo()},setMeetInfo:function(){var t=this._curMeetData.getBuilder().getNickName(),e=td.Language.strWhoseBirdBridge;this.labMeetName.string=cc.js.formatStr(e,t)},getActivityController:function(){var t=td.ActivityEnum.ActivityType.MagpieBridgeParty;return td.ActivityDataManager.getActivityControllerByType(t)},gotoHelpBirdBridge:function(){var t=this._curMeetData.getJoinersList(),e=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_LIMIT");if(t.length>=e){var i=td.Language.tooMuchHelpPeople;td.MessageBox.showMessage(i)}else{for(var n=!1,a=td.Account.getUserData().getUserId(),r=0,o=t.length;r<o;r++){if(a===t[r].getUserId()){n=!0;break}}if(n){i=td.Language.theBirdBridgeHelped;td.MessageBox.showMessage(i)}else{var s={};s.panelName=td.PanelEnum.Panel_BirdBridgeHelp,s.callback={func:function(t,e){e.setData(t)},param:this._curMeetData},td.GlobalFunction.showPanel(s),this.closeCallFunc()}}},doClose:function(){var t=cc.callFunc(this.closeCallFunc,this),e=cc.sequence(cc.fadeOut(.2),t);this.imgBG.stopAllActions(),this.imgBG.runAction(e)},closeCallFunc:function(){this.node.active=!1},clearNode:function(){this.node.active=!1,this.node.removeFromParent()}});e.exports=n,cc._RF.pop()},{}],BabelConfig:[function(t,e,i){"use strict";cc._RF.push(e,"58956uzrgZDdZAqXGhX9yKb","BabelConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="BabelConfig",e._tblName="babel_config",e}return n(e,t),e.prototype.init=function(){this._data=this._jsonData},e.prototype.getData=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],BabelEnum:[function(t,e,i){"use strict";cc._RF.push(e,"9c3e9U49fBKVqobHIwv9onE","BabelEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.BabelBattleInfoEnum=void 0,function(t){t[t.STAGE=1]="STAGE",t[t.FLOOR=2]="FLOOR",t[t.DIFFICULTY=3]="DIFFICULTY",t[t.SPECIALEFFECTS=4]="SPECIALEFFECTS",t[t.OPTIONAL=5]="OPTIONAL"}(i.BabelBattleInfoEnum||(i.BabelBattleInfoEnum={})),cc._RF.pop()},{}],BabelHeroConfig:[function(t,e,i){"use strict";cc._RF.push(e,"329f42ffFZF0rcT2p+bqrGY","BabelHeroConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="BabelHeroConfig",e._tblName="babel_hero_config",e}return n(e,t),e.prototype.init=function(){this._data=this._jsonData},e.prototype.getData=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],BabelHeroModel:[function(t,e,i){"use strict";cc._RF.push(e,"89f5311tPpCB4uR5ZDKpYil","BabelHeroModel");window.td;var n=t("Model"),a=cc.Class({extends:n,properties:{_heroId:null,_floor:null,_level:null,_specialEffects:null},init:function(t){this._super("BabelHeroModel"),this._heroId=t.heroId,this._floor=t.floor,this._level=t.level,this._showSkillIDs=t.showSkillIDs},getHeroId:function(){return this._heroId},getFloor:function(){return this._floor},getLevel:function(){return this._level},getSpecialEffects:function(){return this._showSkillIDs||[]}});e.exports=a,cc._RF.pop()},{Model:"Model"}],BabelManager:[function(t,e,i){"use strict";cc._RF.push(e,"46714yqkhNOCZn1vXwZc35P","BabelManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("BabelModel"),r=t("BabelHeroModel"),o=t("../Enum/BabelEnum"),s=function(){function t(){this._curHeroId=0,this._curJoinTimes=0,this._nextRecoverTime=0,this._curFloor=0,this._curDifficulty=0,this._hadOverStage=!1,this._canResetFloorAndDirriculty=!0,this._sweepRewards=null}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._curHeroId=0,this._curJoinTimes=0,this._nextRecoverTime=0,this._curFloor=0,this._curDifficulty=0,this._hadOverStage=!1,this._babelFloors=[],this.initData.hasInit=!1},t.prototype.addListener=function(){var t=n.ServerDelegate,e=n.MsgModuleName.BABEL,i=n.MsgCmd.BABEL;t.registerMessage(e,i.GET_BABEL_INFO,this._parseBabelInfo.bind(this)),t.registerMessage(e,i.GET_BABEL_BATTLE,this._parseBabelBattleInfo.bind(this)),t.registerMessage(e,i.BABEL_CHOOSE_HERO,this._parseChooseBabelHero.bind(this)),t.registerMessage(e,i.BABEL_STAGE_CHOOSE,this._parseBabelChooseRewardReturn.bind(this)),t.registerMessage(e,i.BABEL_STAGE_SWEEP,this._parseBabelSweepRewardReturn.bind(this)),t.registerMessage(e,i.BABEL_OVER_STAGE_FIGHT,this._parseBabelOverStageFightReturn.bind(this)),t.registerMessage(e,i.BABEL_RANK,this._parseBabelRankReturn.bind(this)),t.registerMessage(e,i.PUSH_BABEL_INFO,this._pushBabelInfo.bind(this)),t.registerMessage(e,i.PUSH_BABEL_BATTLE,this._parseBabelBattleInfo.bind(this))},t.prototype.addEventListener=function(){var t=n.EventUtil,e=n.EventNameEnum,i={};i[e.REQ_GET_BABEL_INFO]=this.requestGetBabelInfo,i[e.REQ_GET_BABEL_BATTLE_INFO]=this.requestGetBabelBattleInfo,i[e.REQ_BABEL_CHOOSE_HERO]=this.requestChooseHero,i[e.REQ_BABEL_STAGE_START]=this.requestStageStart,i[e.REQ_BABEL_STAGE_CHOOSE]=this.requestStageChoose,i[e.REQ_BABEL_STAGE_SWEEP]=this.requestStageSweep,i[e.REQ_BABEL_OVER_STAGE_FIGHT]=this.requestOverStageFight,i[e.REQ_BABEL_RANK_DATA]=this.requestBabelRank,t.registerEvents(i,this)},t.prototype.initData=function(){if(!this.initData.hasInit){var t=n.GetTableClass(n.TableEnum.BabelConfig).getData();this._babelModels={};for(var e=this._babelModels,i=0,o=t.length;i<o;++i){var s=t[i];(p=new a).init(s);var l=p.getFloor(),c=p.getDifficulty();e[l]||(e[l]={});var u=e[l];u.hasOwnProperty(c)||(u[c]=[]),u[c][u[c].length]=p}var d=n.GetTableClass(n.TableEnum.BabelHeroConfig).getData();this._babelHeroModels={};var h=this._babelHeroModels;for(i=0,o=d.length;i<o;++i){var p;s=d[i];(p=new r).init(s),h[l=p.getFloor()]||(h[l]=[]),h[l][h[l].length]=p}this.initData.hasInit=!0}},t.prototype._parseBabelInfo=function(t,e){t===n.NetCode.SUCCESS&&(this.initData(),this._curHeroId=e.heroId,this._curJoinTimes=e.times,this._nextRecoverTime=e.nextRecoverTime,this._babelFloors=e.floors||[],this._babelFloors.sort(this.sortBabelFloors),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_BABEL_INFO))},t.prototype._parseChooseBabelHero=function(t,e){n.NetCode.SUCCESS},t.prototype._pushBabelInfo=function(t,e){if(t===n.NetCode.SUCCESS){this.initData(),this._curHeroId=e.heroId,this._curJoinTimes=e.times,this._nextRecoverTime=e.nextRecoverTime;for(var i=e.floors||[],a=this,r=0,o=i.length;r<o;r++){var s=i[r];this._babelFloors.some(function(t,e){if(s.floor==t.floor&&s.difficulty==t.difficulty)return a._babelFloors[e]=i[r],!0})||(this._babelFloors=this._babelFloors.concat(i[r]))}this._babelFloors.sort(this.sortBabelFloors),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_BABEL_INFO)}},t.prototype._parseBabelBattleInfo=function(t,e){if(t===n.NetCode.SUCCESS){!e&&this._babelBattleInfo&&this._babelBattleInfo.stage?this._babelBattleInfo.stage=this._babelBattleInfo.stage-0+1:this._babelBattleInfo=e||{},e&&e.floor&&e.difficulty&&(this.setCurFloor(e.floor),this.setCurDifficulty(e.difficulty));var i=this.getCurFloor(),a=this.getCurDifficulty(),r=this.getBabelDataByfloorAndDifficulty(i,a);this._babelBattleInfo.stage==r.length&&this.setOverStageState(!0),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_BABEL_INFO)}},t.prototype._parseBabelChooseRewardReturn=function(t,e){t===n.NetCode.SUCCESS&&(e.reward?(n.PvpFightManager.setFightPause(!0),n.EventUtil.dispatchEvent(n.EventNameEnum.BABEL_TURN_REWARD,e)):n.PvpFightManager.setFightPause(!1))},t.prototype._parseBabelSweepRewardReturn=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.reward,a=e.randReward;if(this.setSweepRewards(i),a)n.EventUtil.dispatchEvent(n.EventNameEnum.BABEL_SWEEP_TURN_REWARD,{reward:a});else{var r=n.RewardManager.parseRewardResult(i,!0);n.GlobalFunction.showRewards(r)}}},t.prototype._parseBabelOverStageFightReturn=function(t,e){if(t===n.NetCode.SUCCESS){n.PvpFightManager.setFightPause(!1);var i=e.reward,a=n.RewardManager.parseRewardResult(i,!0);n.GlobalFunction.showRewards(a),this.checkClearBattleInfo()}},t.prototype._parseBabelRankReturn=function(t,e){t===n.NetCode.SUCCESS&&(this._babelRanks=e.ranks.slice(0,-1),this._babelRanks.sort(function(t,e){return t.rank-e.rank}),this._myRank=e.ranks.slice(-1),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_BABEL_RANK_INFO))},t.prototype.getBabelBattleInfo=function(t){switch(t){case o.BabelBattleInfoEnum.STAGE:return this._babelBattleInfo.stage;case o.BabelBattleInfoEnum.FLOOR:return this._babelBattleInfo.floor||1;case o.BabelBattleInfoEnum.DIFFICULTY:return this._babelBattleInfo.difficulty||1;case o.BabelBattleInfoEnum.SPECIALEFFECTS:return this._babelBattleInfo.specialEffects||[];case o.BabelBattleInfoEnum.OPTIONAL:return this._babelBattleInfo.optional||[]}},t.prototype.sortBabelFloors=function(t,e){return t.floor===e.floor?t.difficulty<e.difficulty:t.floor<e.floor},t.prototype.requestGetBabelInfo=function(){var t={};t.module=n.MsgModuleName.BABEL,t.cmd=n.MsgCmd.BABEL.GET_BABEL_INFO,n.ServerDelegate.sendMessage(t)},t.prototype.requestGetBabelBattleInfo=function(){var t={};t.module=n.MsgModuleName.BABEL,t.cmd=n.MsgCmd.BABEL.GET_BABEL_BATTLE,n.ServerDelegate.sendMessage(t)},t.prototype.requestChooseHero=function(t){var e={};e.module=n.MsgModuleName.BABEL,e.cmd=n.MsgCmd.BABEL.BABEL_CHOOSE_HERO,e.id=t.id,n.ServerDelegate.sendMessage(e)},t.prototype.requestStageStart=function(t){var e={};e.module=n.MsgModuleName.BABEL,e.cmd=n.MsgCmd.BABEL.BABEL_STAGE_START,e.floor=t.floor,e.difficulty=t.difficulty,n.ServerDelegate.sendMessage(e)},t.prototype.requestStageChoose=function(t){var e={};e.module=n.MsgModuleName.BABEL,e.cmd=n.MsgCmd.BABEL.BABEL_STAGE_CHOOSE,e.id=t.id,n.ServerDelegate.sendMessage(e)},t.prototype.requestStageSweep=function(t){var e={};e.module=n.MsgModuleName.BABEL,e.cmd=n.MsgCmd.BABEL.BABEL_STAGE_SWEEP,e.floor=t.floor,e.difficulty=t.difficulty,n.ServerDelegate.sendMessage(e)},t.prototype.requestOverStageFight=function(t){var e={};e.module=n.MsgModuleName.BABEL,e.cmd=n.MsgCmd.BABEL.BABEL_OVER_STAGE_FIGHT,n.ServerDelegate.sendMessage(e)},t.prototype.requestBabelRank=function(){var t={};t.module=n.MsgModuleName.BABEL,t.cmd=n.MsgCmd.BABEL.BABEL_RANK,n.ServerDelegate.sendMessage(t)},t.prototype.getCurHeroId=function(){return this._curHeroId},t.prototype.getNextRecoverTime=function(){return this._nextRecoverTime},t.prototype.getLeftJoinTimes=function(){return this._curJoinTimes},t.prototype.setCurFloor=function(t){this._curFloor=t},t.prototype.getCurFloor=function(){return this._curFloor||1},t.prototype.setCurDifficulty=function(t){this._curDifficulty=t},t.prototype.getCurDifficulty=function(){return this._curDifficulty||1},t.prototype.resetCurFloorAndDifficulty=function(){if(this._canResetFloorAndDirriculty){var t=this.getBabelDataModels(),e=n.Account.getUserData().getLevel(),i=1;for(var a in t){if(t[a][1][0].getLevelLimit()>e)break;i=parseInt(a)}var r=this.getMaxDifficultyInFloor(i)||1;this.setCurFloor(i),this.setCurDifficulty(r)}},t.prototype.setCanReset=function(t){this._canResetFloorAndDirriculty=t},t.prototype.checkClearBattleInfo=function(){this._babelBattleInfo={}},t.prototype.getStageProgress=function(t,e){for(var i=this._babelFloors,n=0,a=i.length;n<a;n++){var r=i[n];if(r.floor==t&&r.difficulty==e)return r.stage}return 0},t.prototype.getFloorHistory=function(t){for(var e=this._babelFloors,i=[],n=0,a=e.length;n<a;n++){var r=e[n];r.floor==t&&(i[i.length]=r)}return null},t.prototype.getMaxDifficultyInFloor=function(t){for(var e=this._babelFloors,i=1,a=this.getBabelDataByFloor(t).myLen(),r=n.Account.getUserData().getLevel(),o=0,s=e.length;o<s;o++){var l=e[o];if(l.floor==t&&i<=l.difficulty){i=l.difficulty;var c=this.getBabelDataByfloorAndDifficulty(t,i);if(l.stage==c.length)this.getBabelData(l.floor,l.difficulty,l.stage).getLevelLimit()<=r&&i<a&&i++}}return i},t.prototype.getHistoryMaxFloor=function(){for(var t=this._babelFloors,e=1,i=0,n=t.length;i<n;i++){var a=t[i];a.floor>e&&(e=a.floor)}return e},t.prototype.getMaxStageNumByFloorAndDifficulty=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),t||(t=this._curFloor),e||(e=this._curDifficulty);var i=this.getBabelDataByfloorAndDifficulty(t,e);return i?i.length:1},t.prototype.getBabelDataModels=function(){return this._babelModels},t.prototype.getBabelDataByFloor=function(t){return this._babelModels[t]?this._babelModels[t]:null},t.prototype.getBabelDataByfloorAndDifficulty=function(t,e){var i=this.getBabelDataByFloor(t);return i?i[e]:null},t.prototype.getBabelData=function(t,e,i){var n=this.getBabelDataByfloorAndDifficulty(t,e);if(!n)return null;for(var a=0,r=n.length;a<r;a++)if(n[a].getStage()==i)return n[a];return null},t.prototype.getRandomRewardBabelData=function(t,e){var i=this.getBabelDataByfloorAndDifficulty(t,e);if(!i)return null;for(var n=0,a=i.length;n<a;n++){var r=i[n].getRandomRewards();if(r&&r.length>0)return i[n]}return null},t.prototype.getRewardsByfloorAndDifficulty=function(t,e){var i=this.getBabelDataByfloorAndDifficulty(t,e);if(!i)return[];for(var a=[],r=0,o=i.length;r<o;r++)a=a.concat(n.GlobalFunction.copyData(i[r].getRewards()));for(r=0,o=a.length;r<o&&a[r];r++)for(var s=0;s<r;s++)if(a[r].getGoodsType()===a[s].getGoodsType()&&a[r].getId()===a[s].getId()){var l=a[r].getCount();a[s].setCount(a[s].getCount()+l),ArrayUtils.removeIndex(a,r),r--;break}return a},t.prototype.getBabelHeroDataByFloor=function(t){return this._babelHeroModels[t]},t.prototype.getBabelHeroDataByFloorAndHeroId=function(t,e){for(var i=this.getBabelHeroDataByFloor(t),n=0,a=i.length;n<a;n++)if(i[n].getHeroId()==e)return i[n];return null},t.prototype.checkShowSkillType=function(){var t=this.getBabelBattleInfo(o.BabelBattleInfoEnum.FLOOR),e=this.getBabelBattleInfo(o.BabelBattleInfoEnum.STAGE),i=this.getBabelBattleInfo(o.BabelBattleInfoEnum.DIFFICULTY),a=this.getBabelBattleInfo(o.BabelBattleInfoEnum.OPTIONAL),r=this.getBabelData(t,i,e);if(!r)return-1;var s=r.getRandomCount(),l=r.getSpecialEffect(),c=r.getRandomRewards(),u=n.PvpFightManager.isBabelFightFail();return e==this.getBabelDataByfloorAndDifficulty(t,i).length||u?-1:0==s&&0==a.length&&0==c.length?0:1==s&&1==a.length&&0==l.length?3:2==s&&2==a.length?2:3==s&&3==a.length?1:1==s&&1==a.length&&1==l.length?4:0==s&&0==a.length&&8==c.length?5:0},t.prototype.checkPopChangeDifficulty=function(){this._popChangeDifficulty=this._popChangeDifficulty||{};var t=this.getCurFloor(),e=this.getCurDifficulty(),i=this.getBabelDataByfloorAndDifficulty(t,e);if(this._popChangeDifficulty[t+"-"+e])return!1;var a=this.getBabelDataByfloorAndDifficulty(t,e-0+1);if(!a)return!1;var r=this.getBabelBattleInfo(o.BabelBattleInfoEnum.STAGE),s=n.PvpFightManager.isBabelFightFail(),l=this.getStageProgress(t,e-0+1),c=n.Account.getUserData().getLevel(),u=a[0].getLevelLimit();return this._hadOverStage&&u<=c&&r==i.length&&0==l&&!s},t.prototype.setPopDifficultyWin=function(t,e){this._popChangeDifficulty[t+"-"+e]=!0},t.prototype.getOverStageState=function(){return this._hadOverStage},t.prototype.setOverStageState=function(t){this._hadOverStage=t},t.prototype.turnToNextDifficulty=function(){this._curDifficulty=this._curDifficulty-0+1},t.prototype.checkHasNotCompleteFight=function(){var t=this.getBabelBattleInfo(o.BabelBattleInfoEnum.FLOOR),e=this.getBabelBattleInfo(o.BabelBattleInfoEnum.DIFFICULTY),i=this.getBabelBattleInfo(o.BabelBattleInfoEnum.STAGE),n=this.getBabelDataByfloorAndDifficulty(t,e);return i>0&&i<n.length},t.prototype.getBabelRankData=function(){return this._babelRanks},t.prototype.getMyRankData=function(){return this._myRank[0]},t.prototype.getSweepRewards=function(){return this._sweepRewards},t.prototype.setSweepRewards=function(t){this._sweepRewards=t},t.prototype.isRedPointTips=function(){return n.UnlockManager.isTargetUnlock(n.ActorUnlockType.BABEL,0)&&this.getLeftJoinTimes()==n.GetConfig("BABEL_MAX_TIMES")},t.prototype.redPointEvents=function(){return[n.EventNameEnum.REFRESH_BABEL_INFO]},t}();i.default=s,cc._RF.pop()},{"../Enum/BabelEnum":"BabelEnum",BabelHeroModel:"BabelHeroModel",BabelModel:"BabelModel"}],BabelModel:[function(t,e,i){"use strict";cc._RF.push(e,"0ff5bwZhGxLhJTaevgoWvji","BabelModel");var n=window.td,a=t("Model"),r=cc.Class({extends:a,properties:{_floor:null,_difficulty:null,_stage:null,_levelLimit:null,_monsterTypes:null,_monsterCapabilities:null,_randomCount:null,_specialEffectPoolId:null,_specialEffects:null,_randomRewards:null,_rewards:null},init:function(t){this._super("BabelModel"),this._floor=t.floor,this._difficulty=t.difficulty,this._stage=t.stage,this._levelLimit=t.levelLimit,this._monsterTypes=t.monsterTypes,this._monsterCapabilities=t.monsterCapabilities,this._randomCount=t.randomCount,this._specialEffectPoolId=t.specialEffectPoolId,this._specialEffects=t.specialEffects,this._randomRewards=t.randomRewards||[];for(var e=[],i=0,a=this._randomRewards.length;i<a;i++)e=e.concat(this._randomRewards[i][0]);this._randomRewards=n.RewardManager.parseRewardListDetail(e),this._rewards=n.RewardManager.parseRewardListDetail(t.rewards)},getFloor:function(){return this._floor},getDifficulty:function(){return this._difficulty},getStage:function(){return this._stage},getLevelLimit:function(){return this._levelLimit},getMonsterTypes:function(){return this._monsterTypes},isMonsterCapabilities:function(){return this._monsterCapabilities},getRandomCount:function(){return this._randomCount},getSpecialEffectPoolId:function(){return this._specialEffectPoolId},getSpecialEffect:function(){return this._specialEffects||[]},getRandomRewards:function(){return this._randomRewards},getRewards:function(){return this._rewards},getRewardIndex:function(){return 0}});e.exports=r,cc._RF.pop()},{Model:"Model"}],BabelSkillTipItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"73a5aCWLAFDLJ88VnoFAbv2","BabelSkillTipItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgIcon=null,e.labName=null,e.labDesc=null,e}return n(e,t),e.prototype.updateItem=function(e,i){i?(this.node.active=!0,t.prototype.updateItem.call(this,e,i),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_skill,i.getIconRes(),this.imgIcon),this.labName.string=i.getName(),this.labDesc.string=i.getDescription()):this.node.active=!1},a([l(cc.Node)],e.prototype,"imgIcon",void 0),a([l(cc.Label)],e.prototype,"labName",void 0),a([l(cc.Label)],e.prototype,"labDesc",void 0),e=a([s,c("module/Babel/BabelSkillTipItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],BabelSkillsTipUI:[function(t,e,i){"use strict";cc._RF.push(e,"b57bdvxYotMoYdGb++cDtxP","BabelSkillsTipUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("OptimizeVerticalListView"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scroll=null,e._skills=[],e}var i;return n(e,t),i=e,e.showSkillsTipUI=function(t,e){if(gdk.rm.getResByUrl("prefab/Babel/BabelSkillsTipUI",cc.Prefab))i.createUI(t,e);else{var n=r.GlobalFunction.getResIdByNode(t);gdk.rm.loadRes(n,"prefab/Babel/BabelSkillsTipUI",cc.Prefab,i.createUI.bind(this,t,e))}},e.createUI=function(t,e){var n=gdk.rm.getResByUrl("prefab/Babel/BabelSkillsTipUI",cc.Prefab),a=(n=cc.instantiate(n)).getComponent(i);return a||n.addComponent(i),a.setData(e),t.addChild(n,100),a},e.prototype.onEnable=function(){for(var t=this.scroll.getComponent(u),e=[],i=0;i<this._skills.length;i++){var n=this._skills[i],a=r.GetTableClass(r.TableEnum.Skill).getSkillById(n);if(a&&1==a.showInSkillBag){var o=new r.SkillModel;o.init(a),e.push(o)}}t.setData(e)},e.prototype.onDisable=function(){},e.prototype.onDestroy=function(){},e.prototype.setData=function(t){this._skills=t},e.prototype.onBtnNodeClick=function(){this.node.active=!1,this.node.destroy()},a([l(cc.Node)],e.prototype,"scroll",void 0),e=i=a([s,c("module/Babel/BabelSkillsTipUI")],e)}(cc.Component);i.default=d,cc._RF.pop()},{OptimizeVerticalListView:void 0}],BaoLieJianYu:[function(t,e,i){"use strict";cc._RF.push(e,"daf09k5hIRDIb3MA54iyHZ0","BaoLieJianYu");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="BaoLieJianYu"}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],BaoZhuItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"5e449SF9lhN6pOqXnCK+krc","BaoZhuItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeBaozhu=null,e.nodeItem=null,e.nodeBtn=null,e._iconIndex=0,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i;this._iconIndex=i,this.node.name="item"+this._iconIndex;var a=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_26);if(!a)return this.nodeItem.active=!1,void(this.nodeBaozhu.active=!1);var o=a.getBaozhuRewardId(n);if(this.nodeBaozhu.active=!o,this.nodeItem.active=!!o,this.nodeBtn.active=!o,null!=o){var s=r.GetTableClass(r.TableEnum.FirecrackerTable);if(null==s)return[];var l=s.getRewardByDataAndId(a.getActivityData(),o),c=r.RewardManager.getRewardDetail(l),u=r.GlobalFunction.createCommonIconWidget(37,c);this.nodeItem.addChild(u),u.active=!0}},e.prototype.onItemClick=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_26);if(t){if(!(t.getCurFirecrackerIndex()>0)){if(!t.isCostEnough()){var e=t.getCostItemData(),i=new r.BroadcastContent(77);return i.setMainParam([new r.BroadcastParam(e.getName())]),r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,i),void t.setCurFirecrackerIndex(0)}var n={};n.id=this._iconIndex,n.parmeterMap={20:2},t.operateActivity(n),t.setCurFirecrackerIndex(this._iconIndex)}}else t.setCurFirecrackerIndex(0)},a([l(cc.Node)],e.prototype,"nodeBaozhu",void 0),a([l(cc.Node)],e.prototype,"nodeItem",void 0),a([l(cc.Node)],e.prototype,"nodeBtn",void 0),e=a([s,c("module/Activity/BaoZhuItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],BaoZhuTaskItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"c9bc8AUXJRGBab/E2ONXRZR","BaoZhuTaskItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Activity_07_HavingTurntable/HavingTurntableTaskItem"),o=window.td,s=(t("ListItem"),cc._decorator),l=s.ccclass,c=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.updateItem=function(t,e){this.labDesc.string=cc.js.formatStr("%s",o.Language.addUpRecharge,e.charge/10),this._charge=e.charge;var i=o.RewardManager.getRewardDetail(e.rewards[0]).getCount();this.labNum.string="x"+i,this.numBg.active=i>0,this.labNum.node.active=i>0,this.labProTitle.string=o.Language.progress+":";var n=o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.ACTIVITY_TYPE_26).getCharge();this.labProgress.string=n/10+"/"+e.charge/10,this.btnGoto.active=2===e.status,this.btnGet.active=3===e.status,this.imgGot.active=4===e.status},e.prototype.onJump=function(){var t=o.PanelManager.getInstance().getCurShowWindow();if(t){var e=t.getComponent("PanelBase");e&&e.closeCallFunc()}o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.ACTIVITY_TYPE_26).setIsJumpToCharge(!0),o.GlobalFunction.gotoRecharge()},e.prototype.onReward=function(){var t=o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.ACTIVITY_TYPE_26);if(t){var e={};e.id=this._charge,e.parmeterMap={20:1},t.operateActivity(e)}},e=a([l],e)}(r.default));i.default=c,cc._RF.pop()},{"../Activity_07_HavingTurntable/HavingTurntableTaskItem":"HavingTurntableTaskItem",ListItem:void 0}],BaoZhuTaskWindow:[function(t,e,i){"use strict";cc._RF.push(e,"8c8db4xK25Ev7lIZ25Rwbu0","BaoZhuTaskWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Activity_07_HavingTurntable/HavingTurntableTaskWindow"),o=window.td,s=cc._decorator,l=s.ccclass,c=s.property,u=(t("PanelBase"),t("OptimizeVerticalListView")),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTitle=null,e}return n(e,t),e.prototype.init=function(){this._panelType=o.PanelType.Window,this._panelEnum=o.PanelEnum.Window_BaoZhuGet},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.labTitle.string=o.Language.Baozhu_Txt3||this.labTitle.string},e.prototype._addEventListener=function(){var t={};t[o.EventNameEnum.RES_BAOZHU_INFO]=this._refreshList,o.EventUtil.registerEvents(t,this)},e.prototype._refreshList=function(){var t=this,e=o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.ACTIVITY_TYPE_26);if(e){var i=e.getActivityData(),n=o.GetTableClass(o.TableEnum.FirecrackerRechargeTable).getConfigById(i);this._value=e.getCharge(),this._rewards=e.getChargeRewards(),n.forEach(function(e){t.setStatus(e)}),n.sort(this.sortFunc),this.node.getComponent(u).refreshListData(n)}},e.prototype.closeCallFunc=function(){t.prototype.closeCallFunc.call(this),o.EventUtil.dispatchEvent(o.EventNameEnum.BAOZHU_TASK_CLOSE)},a([c(cc.Label)],e.prototype,"labTitle",void 0),e=a([l],e)}(r.default);i.default=d,cc._RF.pop()},{"../Activity_07_HavingTurntable/HavingTurntableTaskWindow":"HavingTurntableTaskWindow",OptimizeVerticalListView:void 0,PanelBase:void 0}],BaozhuController:[function(t,e,i){"use strict";cc._RF.push(e,"f9ae9/uGv1LNJDzoqNtmkB7","BaozhuController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataID=1001,e._myCount=0,e._recharge=0,e._converted=0,e._rewardsMap={},e._chargeRewards=null,e._totalTimes=0,e._receivedList=[],e._isJumpToCharge=!1,e._isOpened=!1,e._curFirecrackerIndex=0,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this._dataID=this.getActivityData()},e.prototype.activityParse=function(t){var e=t.record;e.key,this._myCount;for(var i in this._myCount=e.key||0,this._rewardsMap=e.rewardRecordMap||{},this._chargeRewards=e.chargeRewards||[],this._recharge=e.recharge||0,this._totalTimes=e.totalTimes||0,this._rewardsMap)if(this._rewardsMap.hasOwnProperty(i)){var n=this._rewardsMap[i];-1==this._receivedList.indexOf(n)&&this._receivedList.push(n)}td.EventUtil.dispatchEvent(td.EventNameEnum.RES_BAOZHU_INFO)},e.prototype.onOpenPanel=function(){this._isOpened=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.BAOZHU_PANEL_OPEN)},e.prototype.getRewardsList=function(){var t=td.GetTableClass(td.TableEnum.FirecrackerTable);return null==t?[]:t.getRewardsList(this._dataID)},e.prototype.isBaozhuFired=function(t){return!!(this._rewardsMap[t]||null)},e.prototype.getBaozhuRewardId=function(t){return this._rewardsMap[t]||null},e.prototype.isRewardReceived=function(t){return-1!=this._receivedList.indexOf(t)},e.prototype.getCharge=function(){return this._recharge},e.prototype.getChargeRewards=function(){return this._chargeRewards},e.prototype.getMyCount=function(){return td.ItemManager.getItemNumById(td.ItemEnum.BaoZhuFirecracker)},e.prototype.getCostItemData=function(){var t=td.GetTableClass(td.TableEnum.FirecrackerCostTable).getCostByIdAndTimes(this.getActivityData(),this._totalTimes+1);return t||((t=[])[0]=[11,td.ItemEnum.BaoZhuFirecracker,0]),td.RewardManager.getRewardDetail(t[0])},e.prototype.getCostNum=function(){return td.GetTableClass(td.TableEnum.FirecrackerCostTable).getCostByIdAndTimes(this.getActivityData(),this._totalTimes+1)},e.prototype.isCostEnough=function(){var t=this.getCostItemData().getCount();return td.ItemManager.getItemNumById(td.ItemEnum.BaoZhuFirecracker)>=t},e.prototype.getIsJumpToCharge=function(){return this._isJumpToCharge},e.prototype.setIsJumpToCharge=function(t){this._isJumpToCharge=t},e.prototype.getCurFirecrackerIndex=function(){return this._curFirecrackerIndex},e.prototype.setCurFirecrackerIndex=function(t){this._curFirecrackerIndex=t},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){return!(this._totalTimes>=12)&&(!!this.isCostEnough()||(!!this.isTaskRedTips()||!this._isOpened&&!td.LoginManager.isFirstLoginToday2()))},e.prototype.isTaskRedTips=function(){for(var t=td.GetTableClass(td.TableEnum.FirecrackerRechargeTable).getConfigById(this._activityData),e=0;e<t.length;e++){var i=t[e];if(i.charge<=this.getCharge()&&-1===this.getChargeRewards().indexOf(i.charge))return!0}return!1},e.prototype.redPointEvts=function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.RES_BAOZHU_INFO,td.EventNameEnum.BAOZHU_PANEL_OPEN]},e}(t("ActivityBaseController"));i.default=a,e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],BaseBossSkill:[function(t,e,i){"use strict";cc._RF.push(e,"4dd54nRq4pNw78xkr7KCoxn","BaseBossSkill");var n=t("CommonSkill"),a=(t("BossSkillEffect"),cc.Class({extends:n,properties:{_targetEnemy:null,_owner:null,_finishCallBack:null},initData:function(t){this._super(t),this._bRefreshScale=!1},setSkillTarget:function(t){this._targetEnemy=t},setOwner:function(t){this._owner=t},setFinishCallBack:function(t){this._finishCallBack=t},onEnable:function(){this._lastExeTime=Date.now();var t=this.node.getComponent(cc.Animation);(t.on("finished",this.finishedEventCallBack.bind(this)),t.currentClip||t.defaultClip)&&(t.play(t.defaultClip.name).wrapMode=cc.WrapMode.Normal)},finishedEventCallBack:function(){this._finishCallBack&&this._finishCallBack()},refreshSkillAnimationSpeed:function(t){this._super(t)},effect:function(){},updateContinueTime:function(){},frameEventCallBack:function(){}}));e.exports=a,cc._RF.pop()},{BossSkillEffect:"BossSkillEffect",CommonSkill:"CommonSkill"}],BaseBullet:[function(t,e,i){"use strict";cc._RF.push(e,"bf82c56Dn9M1qf9KLWjwKKe","BaseBullet");var n=t("PveFightObject"),a=t("BulletAnimateComponent"),r=t("PveFightManager"),o=cc.Class({extends:n,properties:{_bulletId:null,_commonAtlas:null,_selfAtlas:null,_moveType:null,_effectTypeArray:[],_effectResArray:[],_curStatus:null,_curTargetEnemy:null,_curBornPos:null,_targetPos:null,_speedX:0,_speedY:0,_moveSpeed:0,_movePrefabNode:null,_attackPrefabNode:null,_curHeroAttackPower:null,_heroAttackEffect:null,_cutHurtType:null,_bAttackStatus:null,_baseAttackPower:null,_upSpeedTimes:1,_lastEnermyPos:null,_bEnermyDie:!1,_towerPos:null,_attackerVocation:null,_heroSid:null,_attackNodePool:null},initData:function(t){this._dataModel=t.bulletDataModel,this._bulletId=this._dataModel.getId(),this._commonAtlas=t.commonAtlas,this._selfAtlas=this._dataModel.getAtlas(),this._moveType=this._dataModel.getMoveType(),this._curTargetEnemy=t.targetEnemy,this._curHeroAttackPower=t.heroAttackPower,this._cutHurtType=t.hurtType,this._heroAttackEffect=t.attackEffect||[],this._curBornPos=t.bornPos,this._towerPos=t.towerPos,this._baseAttackPower=t.heroAttackPower||1,this._attackerVocation=t.vocation||0,this._heroSid=t.heroSid,this._targetPos=t.targetPos,this._bAttackStatus=!1,this._effectTypeArray=this._dataModel.getEffectArray(),this._effectResArray=[this._dataModel.getMoveRes(),this._dataModel.getAttackRes()],this._curSpeedMult=t.speed,this._moveSpeed=this._dataModel.getFlySpeed(),this._curStatus=null,this._bRefreshScale=!0,this._bEnermyDie=!1,this._lastEnermyPos=null,this._attackNodePool||(this._attackNodePool=new cc.NodePool),this._bFightPause=!1},getBulletId:function(){return this._bulletId},onEnable:function(){var t=this._dataModel.getSoundArray();t[0]>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,t[0])},setUpSpeedTimes:function(t){this._upSpeedTimes=t},onLoad:function(){this._super()},onDestroy:function(){this._super(),this._attackNodePool&&this._attackNodePool.clear()},pause:function(){this.node.pauseAllActions(),this._movePrefabNode&&this._movePrefabNode.getComponent(cc.Animation).pause(),this._attackPrefabNode&&this._attackPrefabNode.getComponent(cc.Animation).pause()},resume:function(){this.node.resumeAllActions(),this._movePrefabNode&&this._movePrefabNode.getComponent(cc.Animation).resume(),this._attackPrefabNode&&this._attackPrefabNode.getComponent(cc.Animation).resume()},update:function(t){if(!this._bFightPause)if(this._super(t),r.getFightStatus()!==td.PveEnum.PVE_FIGHT_STATUS.OVER&&cc.isValid(this._curTargetEnemy)){var e=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._curTargetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]);if((i.getTransferStatus()||i.bDeath())&&(this._bEnermyDie=!0),this._bEnermyDie&&this._curStatus!==td.PveEnum.PVE_BUTTET_STATUS.Bomb)this.toDie();else{if(this._moveType===td.PveEnum.PVE_BULLET_MOVE_TYPE.Straight&&this._curStatus===td.PveEnum.PVE_BUTTET_STATUS.Fly){this._calcStraightLineTrackingSpeed();var n=t*this._moveSpeed*this._curSpeedMult,a=this._speedX*n,o=this._speedY*n;this.node.x+=a,this.node.y+=o;var s=this._calcRotationDegree();this.node.angle=-s}if(this._curStatus===td.PveEnum.PVE_BUTTET_STATUS.Bomb&&this._effectTypeArray[1]===td.PveEnum.RenderType.AnimationClip){var l=!1;if(this._attackPrefabNode){var c=this._attackPrefabNode.getComponent(cc.Animation),u=c.getAnimationState(c.defaultClip.name);u&&(l=u.isPlaying)}this._curStatus=l?td.PveEnum.PVE_BUTTET_STATUS.Bomb:td.PveEnum.PVE_BUTTET_STATUS.Die}}}else this.toDie()},onChangeSpeedMult:function(t){if(this._super(t),this._attackPrefabNode){for(var e=0,i=(a=(n=this._attackPrefabNode.getComponent(cc.Animation)).getClips()).length;e<i;e++){if(a[e])(r=n.getAnimationState(a[e].name))&&(r.speed=t)}if(this._movePrefabNode){var n,a;for(e=0,i=(a=(n=this._movePrefabNode.getComponent(cc.Animation)).getClips()).length;e<i;e++){var r;if(a[e])(r=n.getAnimationState(a[e].name))&&(r.speed=t)}}}},onRestartFight:function(){this.stopAttackAima(),this.putToNodePool()},setRenderWithStatus:function(t){if(this._curStatus!==t)if(this._curStatus=t,t===td.PveEnum.PVE_BUTTET_STATUS.Fly){if(this._movePrefabNode)this._movePrefabNode.active=!0;else{var e=this._dataModel.getBulletMovePrefab();this._movePrefabNode=cc.instantiate(e),this._movePrefabNode.name="moveAnimation",this._movePrefabNode.x=0,this._movePrefabNode.y=0,this.node.addChild(this._movePrefabNode,99)}var i=this._movePrefabNode.getComponent(cc.Animation),n=i.getAnimationState(i.defaultClip.name);if(!n)return void cc.error("BaseBullet setRenderWithStatus  state is error  Fly");n.speed=this._curSpeedMult,this._attackPrefabNode&&(this._attackPrefabNode.active=!1)}else if(t===td.PveEnum.PVE_BUTTET_STATUS.Bomb){if(this._movePrefabNode&&(this._movePrefabNode.active=!1),!this._attackPrefabNode){var o=this._dataModel.getBulletAttackPrefab();this._attackPrefabNode=cc.instantiate(o),this._attackPrefabNode.name="attackAnimation",this._attackPrefabNode.addComponent(a),this.node.addChild(this._attackPrefabNode,99)}if(this._attackPrefabNode.active=!0,this._dataModel.isNeedScaleX()){var s=this._curTargetEnemy.x<this._towerPos.x?-1:1;this._attackPrefabNode.scaleX=s}var l=this._attackPrefabNode.getComponent(a),c=this._attackPrefabNode.getComponent(cc.Animation);c.stop();var u=c.play(c.defaultClip.name);if(!u)return void cc.error("BaseBullet setRenderWithStatus  state is error Bomb");if(u.wrapModel=cc.WrapMode.Normal,c.getAnimationState(c.defaultClip.name).speed=this._curSpeedMult,l.setFrameEventCallBack(this.calcHurt.bind(this)),l.setFinishedCallBack(this.toDie.bind(this,this._attackPrefabNode)),this._attackPrefabNode.x=0,this._attackPrefabNode.y=0,this._dataModel.getSkillType()===td.PveEnum.PVE_BULLET_SKILL_TYPE.WithoutBallistic&&(this._attackPrefabNode.y=-25),this._dataModel.getAttackNeedRotation()||(this.node.angle=0),this._dataModel.getUnderEffectType()===td.PveEnum.PVE_ATTACK_TYPE.Group)for(var d=this._dataModel.getDamageRange(),h=r.getEnemyArray(),p=this._curTargetEnemy.getPosition(),_=0,g=h.length;_<g;_++){var f=h[_];if(f&&this._curTargetEnemy!==f){var v=Math.floor(f._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),m=f.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[v]).bDeath(),y=f.getPosition();if(td.GlobalFunction.getDistance(p,y)<=d&&!m){var E=this._attackNodePool.get();cc.isValid(E)||(E=cc.instantiate(this._attackPrefabNode)),E.active=!0,(l=E.getComponent(a)).setFrameEventCallBack(null),l.setFinishedCallBack(this.removeAnima.bind(this,E)),f.addChild(E,99);var T=E.getComponent(cc.Animation);T.play(T.defaultClip.name);T.getAnimationState(T.defaultClip.name).speed=this._curSpeedMult}}}}},removeAnima:function(t){this._attackNodePool&&this._attackNodePool.put(t)},toDie:function(){this._bAttackStatus=!1,this.stopAttackAima(),this.putToNodePool()},stopAttackAima:function(){this._attackPrefabNode&&this._attackPrefabNode.getComponent(a).stopAnimation()},calcHurt:function(){if(this._curStatus===td.PveEnum.PVE_BUTTET_STATUS.Bomb&&(this._bAttackStatus||this._moveType===td.PveEnum.PVE_BULLET_MOVE_TYPE.None)){var t=this._curHeroAttackPower,e=this._cutHurtType,i=this._dataModel.getAttackType();if(i===td.PveEnum.PVE_ATTACK_TYPE.Monomer){var n=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio);this._curTargetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[n]).setHurt(this._heroSid,t,e,this._attackerVocation),this.setAttackEffectToEnemy(this._curTargetEnemy)}else if(i===td.PveEnum.PVE_ATTACK_TYPE.Group)for(var a=this._dataModel.getDamageRange(),o=r.getEnemyArray(),s=o.length-1;s>=0;s--){var l=o[s];if(cc.isValid(l)){n=Math.floor(l._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio);var c=l.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[n]),u=c.bDeath(),d=l.getPosition();if(td.GlobalFunction.getDistance(this._targetPos,d)<=a&&!u){if(this._heroAttackEffect[0]===td.PveEnum.PVE_EFFECT_TYPE.PureHurt1)t+=this._heroAttackEffect[1];c.setHurt(this._heroSid,t,e,this._attackerVocation),this.setAttackEffectToEnemy(l)}}}var h=this._dataModel.getSoundArray();h[1]>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,h[1])}},setAttackEffectToEnemy:function(t){if(0!==this._heroAttackEffect.length){var e=this._heroAttackEffect[0];if(e!==td.PveEnum.PVE_EFFECT_TYPE.PureHurt1){var i=t.getComponent("EnemyBuffCtrlComponent"),n={buffType:e,buffData:this._heroAttackEffect[1]/1e4,buffTime:this._heroAttackEffect[2]/1e3,showBuff:!0,hurtType:this._cutHurtType,vocation:this._attackerVocation,baseAttackPower:this._baseAttackPower},a=e,r="Bullet_"+this._bulletId;i.addBuffToList(a,r,n)}}},onCollisionEnter:function(t){if(this._bAttackStatus=!0,this._moveType!==td.PveEnum.PVE_BULLET_MOVE_TYPE.Parabolic){var e=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._curTargetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=i.getTransferStatus();if(i.bDeath()||n)this.toDie();else if(t.node._tag===this._curTargetEnemy._tag&&this._moveType===td.PveEnum.PVE_BULLET_MOVE_TYPE.Straight){var a=this._curTargetEnemy.getPosition(),r=this._moveType===td.PveEnum.PVE_BULLET_MOVE_TYPE.None?0:30;this.node.x=a.x,this.node.y=a.y+r,this.setRenderWithStatus(td.PveEnum.PVE_BUTTET_STATUS.Bomb)}}},_calcStraightLineTrackingSpeed:function(){var t=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),e=this._curTargetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[t]);e.getTransferStatus();if(!this._bEnermyDie){var i=e.getColliderPos(),n=this.getCurPos();this._lastEnermyPos=i;var a=td.GlobalFunction.getDistance(n,i),r=i.x-n.x,o=i.y-n.y;this._speedX=r/a,this._speedY=o/a}},_calcRotationDegree:function(){var t=180*Math.atan2(this._speedY,this._speedX)/Math.PI;return t<=0?-t:360-t},_moveByParabolicTracking:function(){if(cc.isValid(this._curTargetEnemy)){var t=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),e=this._curTargetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[t]),i=e.getTransferStatus();(e.bDeath()||i)&&this.toDie();var n=this._curTargetEnemy.getPosition(),a=this.getCurPos(),r=n.x-a.x,o=n.y-a.y,s=Math.sqrt(r*r+o*o)/(this._moveSpeed*this._curSpeedMult),l=e.getTargetPosByInterval(s);r=l.x-a.x,o=l.y-a.y;var c=r>=0?a.x+.5*r:a.x-.5*r,u=a.y+250,d=Math.atan2(u-a.y,c-a.x),h=180*d/Math.PI,p=h<=0?-h:360-h;this.node.rotation=p,p=(h=180*(d=Math.atan2(l.y-u,l.x-c))/Math.PI)<=0?-h:360-h;var _=cc.rotateTo(s,p),g=cc.bezierTo(s,[a,cc.v2(c,u),l]),f=cc.callFunc(function(){this.setRenderWithStatus(td.PveEnum.PVE_BUTTET_STATUS.Bomb)},this);this.node.runAction(cc.sequence(cc.spawn(g,_),f))}else this.toDie()}});e.exports=o,cc._RF.pop()},{BulletAnimateComponent:"BulletAnimateComponent",PveFightManager:"PveFightManager",PveFightObject:"PveFightObject"}],BaseEnemy:[function(t,e,i){"use strict";cc._RF.push(e,"37a32eboNNBCrxCBKWfaz6e","BaseEnemy");var n,a=function(t){return t&&t.__esModule?t:{default:t}}(t("../../manager/PveDataHelper"));var r=t("EnemyBuffCtrlComponent"),o=t("PveUiManager"),s=t("PveCopyEnum"),l=t("PveFightObject"),c=t("PveFightManager"),u=t("PveMapManager"),d=(t("AnimationComponent"),t("SpriteAnimation")),h=t("PveNodePoolManager"),p=t("PveEnemySoul"),_=cc.Class(((n={extends:l,properties:{_curSpeed:0,_curHp:0,_curMagicDefence:0,_curPhysicsDefence:0,_enemyId:null,_enemyResPrefix:"",_road:null,_roadId:null,_curTargetPos:null,_speedX:null,_speedY:null,_curDir:null,_collisionGroup:null,_spriteEnemy:null,_spriteEnemyScript:null,_curStatus:0,_hpProgressBar:null,_bTransferring:null,_speakNode:null,_isIgnorDistance:!1,_skillDeadEffectInfo:null,_underAttackNode:null,_pveSpeakData:null,_time:0,_hpTimes:100,_waveId:0,_lastPos:null,_hpPos:null,_shadowPos:null},initData:function(t){this._curStatus=td.PveEnum.PVE_ENEMY_STATUS.READY,this._bTransferring=!1,this._hpTimes=t.hpTimes||100,this._dataModel=t.enemyDataModel,this._waveId=t.waveId,this._curSpeed=this._dataModel.getMoveSpeed(),this._curHp=Math.floor(this._dataModel.getHp()*this._hpTimes/100),this._curMagicDefence=this._dataModel.getMagicDefence(),this._curPhysicsDefence=this._dataModel.getPhysicsDefence(),this._roadId=t.roadId;var e=u.getLines();if(this._road=e[t.roadId],this._resPath=this._dataModel.getResPath(),this._collisionGroup=this.node.group,this._enemyId=this._dataModel.getId(),this._curSpeedMult=c.getCurFightSpeedMult(),this._bRefreshScale=!0,this._shadow=this.node.getChildByName("shadow"),this._shadowPos=this._shadow.position,this._shadow.scale=this._dataModel.getShadowScale()*this.node.scale,this._shadow.active=!c.debugParams[6],this._hpProgressBar=this.node.getChildByName("hpProgressBar"),this._spriteEnemy&&this._spriteEnemyScript){if(!this._spriteEnemyScript.isLoadedAnima()){var i=h.getEnemyAnimationNode(this._dataModel.getRoleType());this._spriteEnemyScript.init(this._dataModel,7,!1,null,0,!1,i,this._setInitAni.bind(this))}}else{this._spriteEnemy=this.node.getChildByName("enemy"),this._spriteEnemyScript=this._spriteEnemy.addComponent(d);var n=h.getEnemyAnimationNode(this._dataModel.getRoleType());this._spriteEnemyScript.init(this._dataModel,7,!1,null,0,!1,n,this._setInitAni.bind(this))}this._spriteEnemyScript.onChangeAnimationSpeed(this._curSpeedMult),this._spriteEnemyScript.resumeAnimation(),this.node.getComponent(r)||this.node.addComponent(r);var a=this._road.shift();this.node.setPosition(a),this._curDir=null,this.refreshHpProgressBar(),this._calcXYSpeed();var o=td.GetTableClass(td.TableEnum.ModelShowTable).getDataByTypeAndId(2,this._dataModel.getRoleType());o&&o.height>0&&(this._hpProgressBar.y=o.height),this._hpPos=this._hpProgressBar.position;var s=this._hpProgressBar.getChildByName("bar"),l=this._hpProgressBar.getComponent(cc.ProgressBar);this.isBoss()?(td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"blood_bar_bg02",this._hpProgressBar),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"blood_bar_fg02",s),this._hpProgressBar.height=16,this._hpProgressBar.width=84,s.height=16,s.width=82,s.x=-s.width/2,l.totalLength=s.width):(td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"blood_bar_bg",this._hpProgressBar),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"blood_bar_fg",s),this._hpProgressBar.height=8,this._hpProgressBar.width=60,s.height=8,s.width=58,s.x=-s.width/2,l.totalLength=s.width),this._isIgnorDistance=!1,this._skillDeadEffectInfo=null,this._bFightPause=c.isFightPause();var p=t.waveId,_=t.nIndex;this._time=0,this._pveSpeakData=td.GetTableClass(td.TableEnum.PveMonsterSpeakTable).getSpeakData(p,_),this._speakNode&&(this._speakNode.active=!1),this.unBatch()},_setInitAni:function(){var t=this;gdk.Timer.frameOnce(2,this,function(){t._bFightPause&&t.pause()})},onBatch:function(){if(this._shadow.parent!==this.node){this.node.on(cc.Node.EventType.POSITION_CHANGED,this.onPositionChange,this),this._lastPos=this.node.position;var t=o.getEffectLayer(),e=o.getMapLayer(),i=e.convertToNodeSpaceAR(this._shadow.parent.convertToWorldSpaceAR(this._shadowPos)),n=t.convertToNodeSpaceAR(this._hpProgressBar.parent.convertToWorldSpaceAR(this._hpPos));this._shadow.parent=e,this._hpProgressBar.parent=t,this._shadow.zIndex=2e3,this._hpProgressBar.zIndex=2e3,this._shadow.position=i,this._hpProgressBar.position=n}},unBatch:function(){this._shadow.parent!==this.node&&null!==this._shadow.parent&&(this._shadow.parent=this.node,this._hpProgressBar.parent=this.node,this._shadow.position=this._shadowPos,this._hpProgressBar.position=this._hpPos,this._shadow.zIndex=1,this._hpProgressBar.zIndex=10,this._shadow.active=!0,this._hpProgressBar.active=!0)},hideBatch:function(){cc.isValid(this._shadow)&&(this._shadow.active=!1),cc.isValid(this._hpProgressBar)&&(this._hpProgressBar.active=!1)},destroyBatch:function(){cc.isValid(this._shadow)&&this._shadow.removeFromParent(),cc.isValid(this._hpProgressBar)&&this._hpProgressBar.removeFromParent()},onPositionChange:function(){var t=this.node.x-this._lastPos.x,e=this.node.y-this._lastPos.y;this._lastPos=this.node.position,this._shadow.x+=t,this._shadow.y+=e,this._hpProgressBar.x+=t,this._hpProgressBar.y+=e,this._shadow.zIndex=0,this._hpProgressBar.zIndex=10},getWaveId:function(){return this._waveId},getCurInfo:function(){var t={};return t.waveId=this._waveId,t.curPos={},t.curPos.x=this.node.x,t.curPos.y=this.node.y,t.curTargetPos=this._curTargetPos,t.enemyId=this._enemyId,t.hp=this._curHp,t.hpTimes=this._hpTimes,t},isBoss:function(){var t=this._dataModel.getGrade();return t===td.PveEnum.PVE_ENERMY_GRADE.BOSS||t===td.PveEnum.PVE_ENERMY_GRADE.SMALLBOSS},setCurInfo:function(t){this.node.x=parseFloat(t.curPos.x),this.node.y=parseFloat(t.curPos.y),this._curTargetPos=t.curTargetPos,this._curHp=t.hp,this._hpTimes=t.hpTimes||100;for(var e=0,i=0,n=this._road.length;i<n;i++){var a=this._road[i];if(a.x===this._curTargetPos.x&&a.y===this._curTargetPos.y){e=i;break}}this._road.splice(0,e),this._calcXYSpeed(),this._hpProgressBar&&this.refreshHpProgressBar()},_monsterSpeak:function(t,e){var i=this;void 0===e&&(e=!1);var n=t.tag;if(this.node._tag===n||e){var a=td.PveCopyManager.isHook()?td.Language[t.tips]:t.tips;if(td.PveCopyManager.getCopyType()!=s.PVEFightType.CHESS||(a=t.chessTips)){this._speakNode||(this._speakNode=td.GlobalFunction.createPrefabInstance("prefab/Pve/MonsterSpeaker"),this.node.addChild(this._speakNode),this._speakNode.name="speakNode",this._speakNode.anchorX=0,this._speakNode.anchorY=.5,this._speakNode.y=this._hpPos.y);var r=this._speakNode.getChildByName("labTip"),o=r.getComponent(cc.Label),l=this._speakNode.getComponent(cc.Layout);this.node.x>360?(this._speakNode.x=-20,this._speakNode.scaleX=-1,r.scaleX=-1):(this._speakNode.x=20,this._speakNode.scaleX=1,r.scaleX=1),o.string=a,o.overflow=cc.Label.Overflow.NONE,o._forceUpdateRenderData(),r.width>180&&(r.width=180,o.overflow=cc.Label.Overflow.RESIZE_HEIGHT,o._forceUpdateRenderData()),l.updateLayout(),this._speakNode.active=!0,this._speakNode.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(td.PveCopyManager.isHook()?3.4:8),cc.fadeOut(.2),cc.callFunc(function(){i._speakNode.active=!1})))}}},onDestroy:function(){this._super()},onEnable:function(){this.playSpawnAction(),td.EventUtil.registerEvent(td.EventNameEnum.PVE_HOOK_HERO_MONSTER,this._monsterSpeak,this),this.onBatch(),this.refreshHpProgressBar()},onDisable:function(){this.node.stopAllActions(),gdk.Timer.clearAll(this),this.hideBatch()},playSpawnAction:function(){this.node.scale=.6;var t=cc.scaleTo(.5,.8);this.node.runAction(t)},pause:function(){this.node.pauseAllActions(),this._spriteEnemyScript.pauseAnimation()},resume:function(){this.node.resumeAllActions(),this._spriteEnemyScript.resumeAnimation()},update:function(t){if(this._bFightPause||this._bTransferring||!this._curTargetPos||this._curStatus===td.PveEnum.PVE_ENEMY_STATUS.Die)this._hpProgressBar.active=this._bFightPause;else{this._hpProgressBar.active=!c.debugParams[7],this._super(t),this._time+=t*this._curSpeedMult,this._pveSpeakData&&this._pveSpeakData.time<=this._time&&(this._monsterSpeak(this._pveSpeakData,!0),this._pveSpeakData=null);var e=this._curSpeed*this._curSpeedMult;if(!(e<=0)){var i=t*e,n=this._speedX*i,a=this._speedY*i,r=Math.abs,o=Math.ceil;if(r(this._curTargetPos.x-this.node.x)>o(r(n))||r(this._curTargetPos.y-this.node.y)>o(r(a))){var s=td.GlobalFunction.getRotation(cc.v2(this.node.x,this.node.y),cc.v2(this.node.x+n,this.node.y+a)),l=this._getDir(s);this._turnDir(l),this.node.x+=n,this.node.y+=a}else this.node.x=this._curTargetPos.x,this.node.y=this._curTargetPos.y,this._calcXYSpeed()}}},onChangeSpeedMult:function(t){this._super(t),this._spriteEnemyScript.onChangeAnimationSpeed(t)},onRestartFight:function(){this.removeSelf()},onFightOver:function(){this.node.activeInHierarchy&&this.removeSelf()},getDataModel:function(){return this._dataModel},setCurSpeedChange:function(t){this._curSpeed+=t},setCurMDChange:function(t){this._curMagicDefence+=t},setCurPDChange:function(t){this._curPhysicsDefence+=t},getCurSpeed:function(){return this._curSpeed},getCurHp:function(){return this._curHp},setHp:function(t){this._curHp=t,this.refreshHpProgressBar()},getTotalHp:function(){return Math.floor(this._dataModel.getHp()*this._hpTimes/100)},getId:function(){return this._enemyId},stop:function(){this.node.stopAllActions(),this._spriteEnemyScript.stopAnimation()}}).pause=function(){this.node.pauseAllActions(),this._spriteEnemyScript.pauseAnimation()},n.resume=function(){this.node.resumeAllActions(),this._spriteEnemyScript.resumeAnimation()},n._calcXYSpeed=function(){if(0!==this._road.length){var t=this.node.getPosition(),e=this._road.shift(),i=e.x-t.x,n=e.y-t.y,a=td.GlobalFunction.getDistance(t,e);this._speedX=i/a,this._speedY=n/a,this._curTargetPos=e}},n._getDir=function(t){var e=Math.floor(t/45),i=t%45>22.5?45*(e+1):45*e;return td.PveEnum.DIR_DEGREE[i]},n._turnDir=function(t){if(this._curDir!==t){this._curDir=t;var e=td.PveEnum.DIR_DEGREE_TYPE[t];this._spriteEnemyScript.changeDir(e)}},n.getColliderPos=function(){return cc.v2(this.node.x,this.node.y+25)},n.getTargetPosByInterval=function(t){var e=this.getCurPos(),i=Math.ceil(this._curSpeed*this._curSpeedMult*t),n=null,a=this._curTargetPos,r=u.getLines()[this._roadId];a?n=Math.ceil(td.GlobalFunction.getDistance(e,a)):(a=r[r.length-1],n=Math.ceil(td.GlobalFunction.getDistance(e,a)));var o=0,s=0,l=null;if(i<=n)o=this._speedX*i,s=this._speedY*i,l=cc.v2(e.x+o,e.y+s+25);else{var c=i-n;if(this._road.length>0)for(var d=0,h=(r=this._road).length;d<h;d++){var p=r[d],_=Math.ceil(td.GlobalFunction.getDistance(a,p));if(!(c>_)){var g=p.x-a.x;p.y,a.y;o=g/_*c,s=g/_*c,l=cc.v2(a.x+o,a.y+s+25);break}if(d===h-1){l=p;break}a=p,c-=_}else l=r[r.length-1]}return l},n.enemyFrameEventFunc=function(t){t=JSON.parse(t)},n.setHurt=function(t,e,i,n,r){if(void 0===n&&(n=0),void 0===r&&(r=null),this._skillDeadEffectInfo=r,0!==e&&0!==this._curHp){var o=td.PveCopyManager.isHook(),l=a.default.getSkillAdditions(n),c=!o&&l&&l[td.PveEnum.TecEffectType.ABSOLUTE_HURT]?l[td.PveEnum.TecEffectType.ABSOLUTE_HURT]:0,u=Math.floor(.05*e),d=this.getTotalHurtByHurtType(e,i,n),h=d.hurt,p=d.isCritical,_=Math.max(u,h+c),g=0,f=this._dataModel.getGrade();if(!o&&l&&l[td.PveEnum.TecEffectType.HURT_ADD]){var v=l[td.PveEnum.TecEffectType.HURT_ADD];switch(v[0]){case 0:g=v[1]/1e4;break;case 1:f!==td.PveEnum.PVE_ENERMY_GRADE.NORMAL&&f!==td.PveEnum.PVE_ENERMY_GRADE.ELIET||(g=v[1]/1e4);break;case 2:f!==td.PveEnum.PVE_ENERMY_GRADE.BOSS&&f!==td.PveEnum.PVE_ENERMY_GRADE.DEMON_BOSS&&f!==td.PveEnum.PVE_ENERMY_GRADE.SMALLBOSS||(g=v[1]/1e4)}}var m=0;if(!o&&l&&l[td.PveEnum.TecEffectType.HURT_ADD_ALL])m=l[td.PveEnum.TecEffectType.HURT_ADD_ALL]/1e4;if(_=Math.floor(_*(1+g+m)),td.PveCopyManager.getCopyType()===s.PVEFightType.DemonTreasureCopy){var y=td.PveCopyManager.getBossAtkMult();_=Math.floor(_*(1+y/1e4))}this.setCurHp(t,_,i,p)}},n.setCurHp=function(t,e,i,n){Math.min(this._curHp,e);this._curHp-=e,this._curHp=this._curHp<1?0:this._curHp;var a=this.getTotalHp();this._curHp>=a&&(this._curHp=a),this.refreshHpProgressBar(),td.PveCopyManager.isHook()||(this.playHurtAction(e,i,n),td.PveCopyManager.staticSingleHurt(t,e,n),td.PveCopyManager.statisticsTotalDamage(t,e)),i===td.PveEnum.PVE_HURT_TYPE.Real&&td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SKILL_HURT_STATICS,e),0===this._curHp&&this.toDeath()},n.playHurtAction=function(t,e,i){if(!c.debugParams[3]){var n=h.getLabHurtInPool(e);if(!cc.isValid(n)){(n=new cc.Node).name="labHurt_"+e;var a=n.addComponent(cc.Label);a.fontSize=20,n.active=!0;var r="Fonts/Fonts_pvp_pugong";switch(e){case td.PveEnum.PVE_HURT_TYPE.Physical:r="Fonts/Fonts_pvp_pugong";break;case td.PveEnum.PVE_HURT_TYPE.Magical:r="Fonts/Fonts_pvp_fagong";break;case td.PveEnum.PVE_HURT_TYPE.Real:r="Fonts/Fonts_pvp_baoji";break;case td.PveEnum.PVE_HURT_TYPE.HpRecover:r="Fonts/Fonts_pvp_zhiliao"}var s=gdk.rm.getResByUrl(r,cc.Font);s&&(a.font=s)}o.getEffectLayer().addChild(n,1e3+e),n.getComponent(cc.Label).string="/"+t;var l=this.node.getChildByName("newBuffLayer");if(l){n.setPosition(cc.v2(this.node.x,this.node.y+.8*l.getContentSize().height)),n.opacity=255;var u=null;i&&(u=new cc.Node,n.addChild(u),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,e===td.DamageType.PHYSICAL?"ZD_GY_baoji":"ZD_GY_baoji02",u),n.setAnchorPoint(0,.5),u.setAnchorPoint(1,.5));var d=cc.moveBy(.15,cc.v2(0,20)),p=cc.fadeOut(.5),_=cc.callFunc(function(){h.putLabHurtInPool(e,n),u&&u.removeFromParent()}),g=cc.sequence(d,p,_);n.runAction(g)}}},n.refreshHpProgressBar=function(){if(this._dataModel){var t=Math.floor(this._dataModel.getHp()*this._hpTimes/100),e=this._curHp/t;this._hpProgressBar.getComponent(cc.ProgressBar).progress=e}},n.toDeath=function(){this._curStatus=td.PveEnum.PVE_ENEMY_STATUS.Die,!this._skillDeadEffectInfo||this._dataModel.getGrade()>=td.PveEnum.PVE_ENERMY_GRADE.BOSS?this.deadEvent():this.deadEffect(),this._spriteEnemyScript.pauseAnimation()},n.deadEvent=function(){this._dataModel.getDeadMusicId()>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,towerAttackSound);var t=new cc.Node;if(!td.PveCopyManager.isHook()){var e=t.addComponent(p),i={soulNum:this._dataModel.getEnergyReward(),startPos:this.node.getPosition()};o.getEffectLayer().addChild(t),e.initData(i)}var n=this.node.getPosition();td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_ENERMY_DIE,{pos:n,grade:this._dataModel.getGrade()}),this.removeSelf()},n.deadEffect=function(){for(var t=this,e=this._skillDeadEffectInfo.effects,i=this._skillDeadEffectInfo.totalHurtCount,n=this._skillDeadEffectInfo.curHurtCount,a=[],r=function(r){var o=null,s=e[r];switch(s[0]){case td.PveEnum.SKILL_DEAD_TYPE.MOVE_X:o=cc.sequence(cc.delayTime(s[2]),cc.moveBy(s[3],s[1],0).easing(cc.easeCubicActionOut()));break;case td.PveEnum.SKILL_DEAD_TYPE.MOVE_Y:o=cc.sequence(cc.delayTime(s[2]),cc.moveBy(s[3],0,s[1]).easing(cc.easeCubicActionOut()));break;case td.PveEnum.SKILL_DEAD_TYPE.MOVE_RELATIVE:var l=s[1],c=t._skillDeadEffectInfo.skillPos,u=t.node.getPosition(),d=cc.v2(0,0),h=Math.abs(u.y-c.y)/Math.sqrt((u.x-c.x)*(u.x-c.x)+(u.y-c.y)*(u.y-c.y)),p=Math.abs(u.x-c.x)/Math.sqrt((u.x-c.x)*(u.x-c.x)+(u.y-c.y)*(u.y-c.y)),_=u.x>c.x,g=u.y>c.y;d.x=u.x+l*p*(_?1:-1),d.y=u.y+l*h*(g?1:-1),o=cc.sequence(cc.delayTime(s[2]),cc.moveTo(s[3],d).easing(cc.easeCubicActionOut()));break;case td.PveEnum.SKILL_DEAD_TYPE.STAY:o=cc.sequence(cc.delayTime(s[2]),cc.sequence(cc.moveBy(s[3],0,s[1]),cc.moveBy(s[3],0,-s[1])).repeat(i-n+1));break;case td.PveEnum.SKILL_DEAD_TYPE.ROTATION:t._spriteEnemyScript.getAnimaitonNode().runAction(cc.sequence(cc.delayTime(s[2]),cc.callFunc(function(t){cc.isValid(t)&&t.runAction(cc.rotate3DBy(s[3],cc.v3(0,s[1],0)).repeatForever())})));break;case td.PveEnum.SKILL_DEAD_TYPE.SCALEY:o=cc.sequence(cc.delayTime(s[2]),cc.scaleTo(s[3],1,s[1]/100));break;case td.PveEnum.SKILL_DEAD_TYPE.DISAPPEARE:o=cc.sequence(cc.delayTime(s[2]+s[3]),cc.callFunc(t.deadEvent,t))}o&&a.push(o)},o=e.length-1;o>=0;o--)r(o);0===a.length?this.deadEvent():1==a.length?this.node.runAction(a[0]):a.length>1&&this.node.runAction(cc.spawn(a))},n.removeSelf=function(){this._hpProgressBar.getComponent(cc.ProgressBar).progress=1,this._curStatus=td.PveEnum.PVE_ENEMY_STATUS.Die,this.unBatch(),c.removeDeadEnemyFromArray(this.node._tag),this.putToNodePool(),this._spriteEnemy.x=0,this._spriteEnemy.y=0,this.node.stopAllActions(),this.node.scale=1;var t=this._spriteEnemyScript.getAnimaitonNode();if(cc.isValid(t)&&t.stopAllActions(),this._spriteEnemyScript.resumeAnimation(),this._underAttackNode)for(var e=this._underAttackNode.children||[],i=e.length-1;i>=0;i--){var n=e[i];h.putUnderAttack(n.name,n)}},n.setEnemyStatus=function(t){this._curStatus=t},n.bDeath=function(){return this._curStatus===td.PveEnum.PVE_ENEMY_STATUS.Die},n.onCollisionEnter=function(t){t.node.group===td.PveEnum.COLLISION_GROUP.ProtegeGroup&&(this._curStatus=td.PveEnum.PVE_ENEMY_STATUS.Die,this.removeSelf())},n.getTotalHurtByHurtType=function(t,e,i){var n=t,r=!1,o=td.PveCopyManager.isHook(),s=a.default.getSkillAdditions(i,!0),l=!1,c=1;if(!o&&s&&s[td.PveEnum.TecEffectType.IGNOR_GUARD_AND_TIMS]){var u=s[td.PveEnum.TecEffectType.IGNOR_GUARD_AND_TIMS];l=1e4*Math.random()<=u[0],c=u[1]/1e4}if(this._curPhysicsDefence>0||this._curMagicDefence,l)n=Math.floor(n*(1+c)),r=!0;else if(e===td.PveEnum.PVE_HURT_TYPE.Physical)n=t*(1-this._curPhysicsDefence/1e4);else if(e===td.PveEnum.PVE_HURT_TYPE.Magical){n=t*(1-this._curMagicDefence/1e4)}return{hurt:Math.floor(n),isCritical:r}},n.setTransferStatus=function(t){this._bTransferring=t},n.getTransferStatus=function(){return this._bTransferring},n.transferToSpawnPoint=function(){var t=u.getLines();this._road=t[this._roadId];var e=this._road.shift();this.node.setPosition(e),this._calcXYSpeed()},n.update3DModelZ=function(t){var e=this.node.getChildByName("enemy").getChildByName("spriteAnima");e&&(e.z=t)},n.isIgnorDistance=function(){return this._isIgnorDistance},n.addUnderAttackEffect=function(t){},n._onUnderAttackFinished=function(t){cc.isValid(t)&&h.putUnderAttack(t.name,t)},n));e.exports=_,cc._RF.pop()},{"../../manager/PveDataHelper":"PveDataHelper",AnimationComponent:void 0,EnemyBuffCtrlComponent:"EnemyBuffCtrlComponent",PveCopyEnum:void 0,PveEnemySoul:"PveEnemySoul",PveFightManager:"PveFightManager",PveFightObject:"PveFightObject",PveMapManager:"PveMapManager",PveNodePoolManager:"PveNodePoolManager",PveUiManager:"PveUiManager",SpriteAnimation:"SpriteAnimation"}],BaseSkillEffect:[function(t,e,i){"use strict";cc._RF.push(e,"a37f26dxkBPqZkjXDuaCOo0","BaseSkillEffect");var n=cc.Class({properties:{_name:"",_attrType:null,_attributeName:"",_effectType:null,_operateValue:null,_coefficient:null,_extraIncrease:null,_showPrecision:null},init:function(t,e,i,n,a){this._name=t,this._attrType=e,this._attributeName=td.AttrStr[e],this._effectType=i,this._operateValue=n,this._coefficient=a||0,this._showPrecision=1},getAttrType:function(){return this._attrType},setShowPrecision:function(t){"number"!=typeof t||t<0||(this._showPrecision=t)},setOperateValue:function(t){this._operateValue=t},getOperateValue:function(){return this._operateValue},getEffectType:function(){return this._effectType},setExtraIncrease:function(t){this._extraIncrease=t},getExtraIncrease:function(t){return this._extraIncrease},getName:function(){return this._name},getAttributeName:function(){return this._attributeName},getAttributeNameText:function(){return""==this._attributeName?"":td.Language[this._attributeName]},getAttributeValue:function(t){return t=t||0,this._effectType===td.EffectAddType.Prime?t+td.PercentNumberUtil.getPercentValue(t,this._operateValue):t+this._operateValue},getEffectValueStr:function(t){"number"!=typeof t?t=this._showPrecision:t<0&&(t=0);return this._effectType==td.EffectAddType.Value?this._operateValue+"":td.GlobalFunction.getNumberStrWithPrecision(t,this._operateValue/100)+"%"},getEffectValue:function(){return this._effectType==td.EffectAddType.Prime?this._operateValue/1e4:this._operateValue}});e.exports=n,cc._RF.pop()},{}],BaseTable:[function(t,e,i){"use strict";cc._RF.push(e,"11498YP3ZJMlI2cvI39vDry","BaseTable");var n=cc.Class({properties:{_jsonData:[],_deleteJson:!0},getTableName:function(){return this._tblName},loadJsonFromSingleFile:function(){var t="res/data/"+this._tblName+".json";cc.loader.loadJson(t,function(e,i){e?(this.__proto__.constructor.destroyInstance(),cc.error("can not load json: "+t)):(this._jsonData=i,this.init&&this.init(),this._deleteJson&&delete this._jsonData)}.bind(this))},loadJson:function(t){this._jsonData=t[this._tblName],this._jsonData&&(cc.assert(this._jsonData,"json data of "+this._tblName+" is null!!!"),this._checkLanguage(),this.init&&this.init(),this._deleteJson&&(this._jsonData=null,delete this._jsonData))},_checkLanguage:function(){for(var t=this._jsonData,e=0;e<t.length;e++){var i=t[e];for(var n in i)if(-1!==n.indexOf("C10_")){var a=td.Language[i[n]]||"";if(void 0!==a)i[n.substring(4)]=a,delete i[n]}}},fillObjById:function(t){for(var e=0,i=this._jsonData.length;e<i;e++){var n=this._jsonData[e];this.parseSourceData&&this.parseSourceData(n),t[n.id]=n}},parseRewardsTemplate:function(t){for(var e=[],i=0;i<t.length;i++){var n={productId:t[i][0],num:t[i][1]};e.push(n)}return e}});e.exports=n,cc._RF.pop()},{}],BaseTreasureController:[function(t,e,i){"use strict";cc._RF.push(e,"a1479Fma+RIsY8bekfFCF4V","BaseTreasureController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_isInit:null,_lastPos:null,_myTicketNum:null,_items:null,_specialItem:null,_rewards:null,_diamondPlayTimes:null,_ticketPlayTimes:null,_totalRechargeNum:null,_playReward:null,_isPlayReturn:null,_events:null,_configKeys:null,_models:null,_isShown:null},initData:function(t){this._super(t),this._isInit=!1,this._lastPos=0,this._myTicketNum=0,this._diamondPlayTimes=0,this._ticketPlayTimes=0,this._totalRechargeNum=0,this._items=[],this._specialItem=null,this._rewards=[],this._playReward=null,this._isPlayReturn=!1,this._events={},this._configKeys={},this._models={},this._isShown=!1},activityParse:function(t){t&&this._parseReceiveQueryData(t)},getItems:function(){return this._items},getExchangeTicketData:function(){return this._rewards},getLastPlayPos:function(){return this._lastPos},getMyTicketNum:function(){return this._myTicketNum},getTotalRechargeNum:function(){return this._totalRechargeNum},getPlayReward:function(){return this._playReward},clearPlayReward:function(){this._playReward=null},isPlayReturn:function(){return this._isPlayReturn},resetPlayReturn:function(){this._isPlayReturn=!1},getSpecialRewardItem:function(){return this._specialItem},getPlayCostByType:function(t){var e,i,n,a=this._configKeys;if(t===td.DragonTreasureReqType.DiamondPlay?(e=a.diamondCost,n=a.diamondMaxTimes,i=this._diamondPlayTimes):t===td.DragonTreasureReqType.TicketPlay&&(e=a.ticketCost,n=a.ticketMaxTimes,i=this._ticketPlayTimes),i>=td.GetConfig(n))return 0;var r=td.GlobalFunction.getShareConfigUpCost(e,i+1);return r instanceof Array?r[2]:"number"==typeof r?r:void 0},isLastPlay:function(){return td.GetConfig(this._configKeys.diamondMaxTimes)+td.GetConfig(this._configKeys.ticketMaxTimes)-(this._diamondPlayTimes+this._ticketPlayTimes)<=0},haveRewardCanReceive:function(){var t=this._rewards;if(!t||0===t.length)return!1;for(var e=td.RewardStatus.CAN_RECEIVE,i=0,n=t.length;i<n;i++){if(t[i].getRewardStatus()===e)return!0}return!1},parseRewardReceived:function(t){if(t.activityId===this.getActivityId()){var e=t.rewardResult;if((e=td.RewardManager.parseRewardResult(e)).length>1&&this._specialItem){for(var i=!1,n=this._specialItem.getReward(),a=0;a<e.length;a++){var r=e[a];if(r.type===td.GoodsType.Type_Item&&parseInt(r.id)===n.getId()&&parseInt(r.count)===n.getCount()){r.isSpecial=!0,i=!0;break}}i&&e.sort(function(t,e){return t.isSpecial&&!e.isSpecial?-1:!t.isSpecial&&e.isSpecial?1:void 0})}this._playReward=e,this._playReward&&this._playReward.length>0&&this._events.getReward&&td.EventUtil.dispatchEvent(this._events.getReward)}},_parseReceiveQueryData:function(t){var e=t.record,i=e.lastPoint||0;this._isPlayReturn=this._isInit&&this._lastPos!==i,this._lastPos=i;var n=e.voucherNum||0;this._myTicketNum!==n&&this._events.getTicket&&td.EventUtil.dispatchEvent(this._events.getTicket,n-this._myTicketNum),this._myTicketNum=n,this._diamondPlayTimes=e.diamondTime||0,this._ticketPlayTimes=e.voucherTime||0,this._totalRechargeNum=e.charge||0,this._items&&0!==this._items.length||this._updateShowItems();for(var a=e.getRewards,r=this._items,o=r.length,s=0,l=0;l<o;l++){var c=r[l];c.setReceived(!1);for(var u=0,d=a.length;u<d;u++){var h=a[u];if(c.getPos()===h){c.setReceived(!0),s++;break}}}s===o&&this._specialItem&&this._specialItem.setReceived(!0),this._rewards&&0!==this._rewards.length||this._updateRechargeRewards();for(l=0;l<this._rewards.length;l++)this._rewards[l].setCurChargeNum(this._totalRechargeNum);var p=td.RewardStatus,_=this._rewards,g=this._totalRechargeNum,f=_.length,v=e.chargeRewards;for(l=0;l<f;l++){var m=_[l],y=m.getNeedChargeNum(),E=p.CANNOT_RECEIVE;g>=y&&(E=p.CAN_RECEIVE);for(u=0,d=v.length;u<d;u++){var T=v[u];if(m.getNeedChargeNum()===T){E=p.RECEIVED;break}}m.setRewardStatus(E)}_.sort(function(t,e){var i=t.getRewardStatus()-e.getRewardStatus();return 0!==i?i:t.getNeedChargeNum()-e.getNeedChargeNum()}),this._isInit=!0,this._events.update&&td.EventUtil.dispatchEvent(this._events.update)},_updateShowItems:function(){var t=this.getActivityData();this._items=[],this._specialItem=null;var e=td.GetTableClass(this._configKeys.pointConfig);if(e){var i=e.getDataByDataId(t);if(i){var n=this._models.item;if(n){var a=i[0];this._specialItem=new n,this._specialItem.initData(a);for(var r=this._items,o=1,s=i.length;o<s;o++){a=i[o];var l=new n;l.initData(a),r[r.length]=l}r.sort(function(t,e){return t.getPos()-e.getPos()})}else cc.log("get treasure itemModel error")}}else cc.log("get treasure config error , key = "+this._configKeys.pointConfig)},_updateRechargeRewards:function(){var t=this.getActivityData();this._rewards=[];var e=td.GetTableClass(this._configKeys.rechargeConfig);if(e){var i=e.getDataByDataId(t);if(i){var n=this._models.recharge;if(n)for(var a=this._rewards,r=0,o=i.length;r<o;r++){var s=i[r],l=new n;l.initData(s,this._totalRechargeNum,this._activityType),a[a.length]=l}else cc.log("get treasure recharge model error ")}}else cc.log("get treasure recharge config error, key = "+this._configKeys.rechargeConfig)},setActivityShown:function(){this._isShown=!0;var t=setTimeout(function(){clearTimeout(t),td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_DRAGON_TREASURE)},10)},redPointTip:function(){return this.haveRewardCanReceive()},hasRedPoint:function(){return!0},redPointEvts:function(){return[td.EventNameEnum.OPEN_DRAGON_TREASURE,td.EventNameEnum.Recharge_Success,this._events.update]},isRedPointTip:function(){return this.haveRewardCanReceive()}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],BaseUser:[function(t,e,i){"use strict";cc._RF.push(e,"56323bDjBVMQ75Kf8BUKPHu","BaseUser");var n=t("Model"),a=cc.Class({extends:n,properties:{sid:null,userId:null,trueName:null,nickName:null,avatar:null,sex:null,exp:null,level:null,vip:null,fightPower:null,firstHeroId:null,nationName:null,onLineState:null,lastOnLineTime:null,serverId:null,curServerId:null,historyHighestPower:null,isShowVip:!0,_divinePos:null,_maxDivinePos:null},init:function(t,e){if(e){this._super(t||"baseUser");var i=td.UserPropertyEnum;if(this.sid=e[i.GamerId]||0,this.userId=e[i.UserId]||0,this.nickName=e[i.NickName]||"",this.trueName=e[i.NickName]||"",this.avatar=e[i.Avatar]||0,this.sex=1==e[i.Sex]?td.ActorSex.Man:td.ActorSex.Woman,this.exp=e[i.Exp]||0,this.level=e[i.Level]||0,this.vip=e[i.Vip]||0,this.fightPower=e[i.FightPower]||0,this.firstHeroId=e[i.LINE_UP_SHOW_ID]||0,this.nationName=e[i.NATION_NAME]||"",this.onLineState=e[i.ONLINE_STATE],this.lastOnLineTime=e[i.LAST_LOGOUT_TIME]||0,this.serverId=e[i.ServerId]||0,this.curServerId=e[i.CURRENT_SERVER_ID]||0,0!==this.curServerId){var n="[%s"+td.Language.arena+"]%s";this.nickName=cc.js.formatStr(n,this.serverId,this.nickName)}this.historyHighestPower=e[i.HISTORY_HIGHEST_FIGHTPOWER]||0,this._divinePos=e[i.DIVINE_POSITION]||0,this._maxDivinePos=e[i.MAX_DIVINE_POSITION]||0}},updateAttr:function(t){var e=td.UserPropertyEnum;if(void 0!==t[e.GamerId]&&(this.sid=t[e.GamerId]),void 0!==t[e.UserId]&&(this.userId=t[e.UserId]),void 0!==t[e.NickName]&&(this.nickName=t[e.NickName]),void 0!==t[e.NickName]&&(this.trueName=t[e.NickName]),void 0!==t[e.Avatar]&&(this.avatar=t[e.Avatar]),void 0!==t[e.Exp]&&(this.exp=t[e.Exp]),void 0!==t[e.Vip]&&(this.vip=t[e.Vip]),void 0!==t[e.FightPower]&&(this.fightPower=t[e.FightPower]),void 0!==t[e.LINE_UP_SHOW_ID]&&(this.firstHeroId=t[e.LINE_UP_SHOW_ID]),void 0!==t[e.NATION_NAME]&&(this.nationName=t[e.NATION_NAME]),void 0!==t[e.ONLINE_STATE]&&(this.onLineState=t[e.ONLINE_STATE]),void 0!==t[e.LAST_LOGOUT_TIME]&&(this.lastOnLineTime=t[e.LAST_LOGOUT_TIME]),void 0!==t[e.ServerId]&&(this.serverId=t[e.ServerId]),void 0!==t[e.CURRENT_SERVER_ID]&&(this.curServerId=t[e.CURRENT_SERVER_ID],0!==this.curServerId)){var i="[%s"+td.Language.arena+"]%s";this.nickName=cc.js.formatStr(i,this.serverId,this.nickName)}if(void 0!==t[e.Level]){var n=t[e.Level];this.refreshUserLevel(n)}if(void 0!==t[e.IS_SHOW_VIP]){var a=t[e.IS_SHOW_VIP];this.isShowVip=a}void 0!==t[e.DIVINE_POSITION]&&(this._divinePos=t[e.DIVINE_POSITION]),void 0!==t[e.MAX_DIVINE_POSITION]&&(this._maxDivinePos=t[e.MAX_DIVINE_POSITION])},getIsShowVip:function(){return this.isShowVip},getUserId:function(){return this.userId},getGamerId:function(){return this.sid},getFightPower:function(){return this.fightPower},getNickName:function(){return this.nickName},getTrueName:function(){return this.trueName},getNickNameAndServer:function(){if(0!==this.curServerId)return this.nickName;var t="[%s"+td.Language.arena+"]%s";return cc.js.formatStr(t,this.serverId,this.nickName)},getServerNickName:function(t){void 0===t&&(t=!1);var e=td.Account.getUserData().curServerId;if(t||0!==e){var i="[%s"+td.Language.arena+"]%s";return cc.js.formatStr(i,this.serverId,this.trueName)}return this.trueName},getNationName:function(){return this.nationName},getLevel:function(){return this.level},getVipLevel:function(){return this.vip},getServerId:function(){return this.serverId},getCurServerId:function(){return this.curServerId},refreshUserLevel:function(t){this.level;this.level=t},getHistoryHighestPower:function(){return this.historyHighestPower},getShowHeroId:function(){return this.firstHeroId},getDivinePos:function(){return this._divinePos},getMaxDivinePos:function(){return this._maxDivinePos},getAttribute:function(){var t={},e=td.UserPropertyEnum;return this.sid&&(t[e.GamerId]=this.sid),this.trueName&&(t[e.NickName]=this.trueName),this.avatar&&(t[e.Avatar]=this.avatar),this.level&&(t[e.Level]=this.level),this.vip&&(t[e.Vip]=this.vip),this.nationName&&(t[e.NATION_NAME]=this.nationName),this.fightPower&&(t[e.FightPower]=this.fightPower),this.serverId&&(t[e.ServerId]=this.serverId),this.curServerId&&(t[e.CURRENT_SERVER_ID]=this.curServerId),this._divinePos&&(t[e.DIVINE_POSITION]=this._divinePos),this._maxDivinePos&&(t[e.MAX_DIVINE_POSITION]=this._maxDivinePos),t}});e.exports=a,cc._RF.pop()},{Model:"Model"}],BattleArrayEntity:[function(t,e,i){"use strict";cc._RF.push(e,"56b05hZVZtCpYze2RMY1YRs","BattleArrayEntity");var n=s(t("../../Hero/Manager/HeroManager")),a=s(t("../../Equip/Manager/EquiptManager")),r=s(t("../../Gem/Manager/GemstoneManager")),o=s(t("./SoulLinkModel"));function s(t){return t&&t.__esModule?t:{default:t}}var l=t("Model"),c=t("BattleAssistant"),u=cc.Class({extends:l,properties:{_orderId:null,_positionId:null,_mercenarySId:null,_assistantData:null,_equipList:null,_suitData:null,_suitAttrList:null,_equipGrowAddTTPercent:null,_equipMasterLevel:null,_equipTotalAttrs:null,_gemstoneList:null,_gemstoneTotalAttrPer:null,_gemstoneTotalAttrs:null,_artifactList:null,_artifactTotalAttrValue:null,_artifactTotalAttrPer:null,_power:null,_treasureList:null,_spiritId:null,_soulLink:null,_battleHeroId:null,_soulLinkModel:null},ctor:function(){this.init("BattleArrayEntity"),this._mercenarySId=0,this._orderId=0,this._positionId=0,this._power=0,this._assistantData=new c,this._equipList={},this._suitData={},this._suitAttrList={},this._equipGrowAddTTPercent={},this._equipMasterLevel={},this._equipTotalAttrs={},this._gemstoneList={},this._gemstoneTotalAttrPer={},this._gemstoneTotalAttrs={},this._artifactList={},this._artifactTotalAttrValue={},this._artifactTotalAttrPer={},this._treasureList={},this._spiritId=0,this._soulLink=[],this._battleHeroId=0},setOrderId:function(t){this._orderId=t},getOrderId:function(){return this._orderId},setPositionId:function(t){this._positionId=t},getPositionId:function(){return this._positionId},setMercenarySId:function(t){this._mercenarySId=t,this.updateArtifactTotalAttrs()},getMercenarySId:function(){return this._mercenarySId},setPower:function(t){this._power=t},getPower:function(){return this._power},setEquipList:function(t){this._equipList=t},getEquipList:function(){return this._equipList},getEquipAddByIndex:function(t){return 0},addSuitEquip:function(t){var e=t.getGroupId();e&&0!=e&&(this._suitData[e]||(this._suitData[e]={}),this._suitData[e][t.getType()]=t.getSId())},removeSuitEquip:function(t){var e=t.getGroupId();e&&0!=e&&(this._suitData[e]&&this._suitData[e][t.getType()]==t.getSId()?delete this._suitData[e][t.getType()]:cc.log("removeSuitEquip error for "+t.getSId()))},getEquipGroupData:function(){return this._suitData},equipInsideGroup:function(t){for(var e in this._suitData){var i=this._suitData[e];for(var n in i){var r=i[n];if(a.default.getInstance().getEquiptById(r).getId()===t)return!0}}return!1},isGroupActive:function(t){if(!this._suitData||!this._suitData[t])return!1;var e=this._suitData[t],i=td.GetTableClass(td.TableEnum.EquipmentGroupTable).getDataById(t);if(!i)return!1;for(var n=i.attributes,a=0;a<n.length;a++){var r=n[0];if(e.myLen()>=r)return!0}return e.myLen()>=n[0][0]},getGroupAddAttrs:function(){return this._suitAttrList},getGroupAddAttrByType:function(t){return this._suitAttrList[t]?this._suitAttrList[t]:0},getEquipAttr:function(t){return 0},setGemstoneList:function(t){var e=!1;if(this._gemstoneList.myLen()!==t.myLen())e=!0;else for(var i in t)if(this._gemstoneList[i]&&this._gemstoneList[i]!==t[i]){e=!0;break}this._gemstoneList=t,e&&(this.updateGemstoneTotalAttrs(),td.EventUtil.dispatchEvent(td.EventNameEnum.EQUIPPED_GEM_CHANGED))},getGemstoneList:function(){return this._gemstoneList},updateGemstoneTotalAttrs:function(){this._gemstoneTotalAttrPer={},this._gemstoneTotalAttrs={};var t=this._gemstoneList;if(t&&0!=t.myLen()){var e=this._gemstoneTotalAttrPer,i=this._gemstoneTotalAttrs;for(var n in t){var a=t[n],o=r.default.getInstance().getGemstoneDataBySId(a),s=o.getAttrAddition(),l=o.getAttrAddition(!0);for(var c in l){var u=l[c];e[c]||(e[c]=0),e[c]+=u.getOperateValue()}for(var c in s){u=s[c];i[c]||(i[c]=0),i[c]+=u.getOperateValue()}}}},getGemstoneAddPer:function(t){return this._gemstoneTotalAttrPer[t]||0},getGemstoneAttr:function(t){return this._gemstoneTotalAttrs[t]||0},setDragonArtifactList:function(t){this._artifactList=t,this.updateArtifactTotalAttrs()},getDragonArtifactList:function(){return this._artifactList},setTreasureList:function(t){this._treasureList=t,this.updateTreasureTotalAttrs()},getTreasureList:function(){return this._treasureList},setSpiritId:function(t){this._spiritId=t},getSpiritId:function(){return this._spiritId},setSoulLink:function(t){null==this._soulLinkModel&&(this._soulLinkModel=new o.default),this._soulLinkModel.setMainHeroId(this._mercenarySId),this._soulLinkModel.setLinkList(t),this._soulLinkModel.setOrderId(this._orderId),this._soulLinkModel.setBattleHeroId(this._battleHeroId||this._mercenarySId),this._soulLink=t},getSoulLink:function(){return this._soulLink},isSoulLinked:function(){return!(!this._soulLink||this._soulLink.length<=0)},setSoulLinkModel:function(t){this._soulLinkModel=t},getSoulLinkModel:function(){return this._soulLinkModel},setBattleHeroId:function(t){this._battleHeroId=t},getBattleHeroId:function(){return this._battleHeroId},updateTreasureTotalAttrs:function(){},updateArtifactTotalAttrs:function(){this._artifactTotalAttrValue={},this._artifactTotalAttrPer={};var t=this._artifactList;if(t&&0!=t.myLen()){var e=this._artifactTotalAttrValue,i=this._artifactTotalAttrPer;for(var a in t){var r=t[a],o=td.DragonArtifactManager.getDragonArtifactDataBySId(r);if(o){var s=o.getAttributeValue();for(var l in s){var c=s[l];e[l]||(e[l]=0),e[l]+=c}for(var l in s=o.getAttributePer()){var u=s[l];i[l]||(i[l]=0),i[l]+=u}var d=n.default.getInstance().getHeroBySId(this.getMercenarySId()).getRoleType();for(var l in s=o.getWashbaseTTPercentAttrByRoleId(d)){u=s[l];i[l]||(i[l]=0),i[l]+=u}}}}},getArtifactAddValue:function(t){return t?this._artifactTotalAttrValue[t]||0:this._artifactTotalAttrValue},getArtifactAddPer:function(t){return t?this._artifactTotalAttrPer[t]||0:this._artifactTotalAttrPer}});e.exports=u,cc._RF.pop()},{"../../Equip/Manager/EquiptManager":"EquiptManager","../../Gem/Manager/GemstoneManager":"GemstoneManager","../../Hero/Manager/HeroManager":"HeroManager","./SoulLinkModel":"SoulLinkModel",BattleAssistant:"BattleAssistant",Model:"Model"}],BattleArrayItemModel:[function(t,e,i){"use strict";cc._RF.push(e,"c7449DZAORKT5dY0yEFL0I0","BattleArrayItemModel");var n=cc.Class({properties:{_lock:!1,_unLockStr:"",_mercenaryData:null,_battleOrderId:0,_positionId:0,_callbackPanel:0,_isFriendBtn:!1,_isPetBtn:!1},init:function(t,e,i,n,a){void 0===a&&(a=0),this._lock=t,this._unLockStr=e,this._battleOrderId=i,this._mercenaryData=n,this._positionId=a},isLock:function(){return this._lock},setFriend:function(t){this._isFriendBtn=t},isFriend:function(){return this._isFriendBtn},setPet:function(t){this._isPetBtn=t},isPet:function(){return this._isPetBtn},getUnLockStr:function(){return this._unLockStr},getMercenaryData:function(){return this._mercenaryData},setLock:function(t){this._lock=t},getBattleOrderId:function(){return this._battleOrderId},getPositionId:function(){return this._positionId},setCallBackPanel:function(t){this._callbackPanel=t},getCallBackPanel:function(){return this._callbackPanel}});e.exports=n,cc._RF.pop()},{}],BattleArrayManager:[function(t,e,i){"use strict";cc._RF.push(e,"9924eMwerFI5r5/XhIlwkAU","BattleArrayManager");var n=y(t("../../Treasure/Manager/TreasureManger")),a=y(t("../../Equip/Manager/EquiptManager")),r=y(t("../../Hero/Manager/HeroManager")),o=y(t("../../Gem/Manager/GemstoneManager")),s=y(t("../../Nation/Manager/NationMainManager")),l=y(t("../../Immortal/Manager/ImmortalManager")),c=y(t("../../Title/Manager/TitleManger")),u=(y(t("../../CrossCup/Manager/CrossCupManager")),y(t("../../Manual/Manager/ManualManager"))),d=y(t("../../Camp/Manager/CampManager")),h=y(t("../../HeroArtifact/Manager/HeroArtifactManager")),p=y(t("../../Spirit/Manager/SpiritManger")),_=y(t("../../Gacha/Manager/GachaManager")),g=t("../../Treasure/Model/SpecialAttributeEnum"),f=t("../../../TS/Common/ResonancesEnum"),v=y(t("../../Pet/Manager/PetManager")),m=y(t("../../DivinePosition/Manager/DivinePositionManager"));function y(t){return t&&t.__esModule?t:{default:t}}var E=t("BattleArray"),T=t("BattleArrayEntity"),C=t("BattleArrayItemModel"),R=t("EquipModel"),S=t("TreasureEnum"),I=t("PveLoader"),A=t("ResourceId");td.BattleArrayManager={_battleArray:null,_friendList:null,_unlockConfig:null,_unlockFriendConfig:null,_selectIndex:null,_reinforcementsAdd:null,_evolveLineupAddTTPercent:null,_assistantAdd:null,_isShowAutoStrength:null,_needShowPartnerShip:!1,_totalAllInLineAttr:null,_heroResModels:null,_petLineupMap:{},needDownLoad:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._battleArray=null,this._isShowAutoStrength=!1,this._friendList={},this._selectIndex=1,this._unlockConfig={},this._unlockFriendConfig={},this._reinforcementsAdd={},this._assistantAdd={},this._needShowPartnerShip=!1,this._evolveLineupAddValue={},this._evolveLineupAddTTPercent={},this._totalAllInLineAttr=null,this._heroResModels=null,this._petLineupMap={}},_addListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.LINEUP,i=td.MsgCmd.LINEUP;t.registerMessage(e,i.GET_LINEUP_LIST,this._parseBattleArray.bind(this)),t.registerMessage(e,i.JOIN_LINEUP,this._onBattleArrayChangeReturn.bind(this)),t.registerMessage(e,i.CHANGE_POSITION,this._onBattleArrayChangeReturn.bind(this)),t.registerMessage(e,i.CHANGE_REINFORCEMENT,this._onBattleFriendChangeReturn.bind(this)),t.registerMessage(e,i.CHANGE_ASSISTANT,this._onBattleAssistantChangeReturn.bind(this)),t.registerMessage(e,i.CHANGE_EQUIPMENT,this._onChangeEquipment.bind(this)),t.registerMessage(e,i.DISCHARGE_EQUIPMENT,this._onChangeEquipment.bind(this)),t.registerMessage(e,i.CHANGE_GEMSTONE,this._onBattleArrayChangeReturn.bind(this)),t.registerMessage(e,i.EQUIPMENT_QUICKLY_WEAR,this._onEquipChangeReturn.bind(this)),t.registerMessage(e,i.EQUIPMENT_QUICKLY_REMOVE,this._onEquipChangeReturn.bind(this)),t.registerMessage(e,i.EQUIPMENT_QUICKLY_REINFORCE,this._onAutoStrengthReturn.bind(this)),t.registerMessage(e,i.PUSH_LINEUP_LIST,this._parseBattleArray.bind(this)),t.registerMessage(e,i.CHANGE_GEM,this._onBattleArrayChangeReturn.bind(this)),t.registerMessage(e,i.CHANGE_ARTIFACT,this._onBattleArrayChangeReturn.bind(this)),t.registerMessage(e,i.CHANGE_TREASURE,this._resChangeTreasure.bind(this)),t.registerMessage(e,i.DISCHARGE_TREASURE,this._resDischargeTreasure.bind(this)),t.registerMessage(e,i.CHANGE_SPIRIT,this._resChargeSpirit.bind(this)),t.registerMessage(e,i.LINEUP_SOUL_LINK_COUNT,this._onGetSoulLinkBuyCount.bind(this)),t.registerMessage(e,i.LINEUP_SOUL_LINK,this._onGetSoulLink.bind(this)),t.registerMessage(e,i.LINEUP_SOUL_LINK_BATTLE,this._onGetSoulLinkBattle.bind(this)),t.registerMessage(e,i.PET_CHANGE,this._petLineupSuc.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQUEST_BATTLE_ARRAY]=this._requestGetBattleArray,i[e.JOIN_BATTLE_ARRAY]=this._requestJoinBattleArray,i[e.CHANGE_BATTLE_POS]=this._requestChangeBattleOrder,i[e.CHANGE_SELECT_HERO]=this._changeOperateIndex,i[e.CHANGE_BATTLE_FRIEND]=this._requestChangeFriend,i[e.CHANGE_BATTLE_ASSISTANT]=this._requestChangeAssistant,i[e.CHANGE_EQUIP]=this._requestChangeEquip,i[e.DEMOUNT_EQUIP]=this._requestDemountEquip,i[e.MERCENARY_EVOLVE_SUCCESS]=this._setLineupAdd,i[e.MERCENARY_RELIFE_SUCCESS]=this._setLineupAdd,i[e.REQUEST_AUTO_EQUIP]=this._requestAutoEquip,i[e.REQUEST_AUTO_DEMOUNT_EQUIP]=this._requestAutoDemountEquip,i[e.EQUIP_CHANGED]=this._onEquipChanged,i[e.ARTIFACT_CHANGED]=this._onArtifactChanged,i[e.CHANGE_GEMSTONE]=this._requestChangeGemstone,i[e.REQUEST_AUTO_ADD_GEMSTONE]=this._requestAutoAddGemstone,i[e.REQUEST_AUTO_DEL_GEMSTONE]=this._requestAutoDelGemstone,i[e.GEMSTONE_CHANGED]=this._onGemstoneChanged,i[e.REQUEST_AUTO_UPGRADE]=this._requestAutoUpgrade,i[e.SET_SHOW_AUTO_STRENGTH]=this._setIsShowAutoStrength,i[e.MERCENARY_CHANGE]=this._onMercenaryChanged,i[e.CHANGE_DRAGON_ARTIFACT]=this._requestChangeArtifact,i[e.REQ_CHANGE_TREASURE]=this._requestChangeTreasure,i[e.REQ_DISCHARGE_TREASURE]=this._requestDischargeTreasure,i[e.USER_ATTR_FIGHT_POWER_CHANGE]=this._onUserCombatChange,i[e.REQ_CHANGE_SPIRIT]=this._requestChangeSpirit,i[e.REQ_SOUL_LINK]=this._requestSoulLink,i[e.REQ_SOUL_LINK_BUY_COUNT]=this._requestSoulLinkBuyCount,i[e.REQ_SOUL_LINK_BATTLE]=this._requestSoulLinkBattle,i[e.PET_LINEUP_CHANGE]=this._lineupChange,i[e.MANUAL_INFO_CHANGED]=this.afterManualInit,t.registerEvents(i,this)},_onUserCombatChange:function(){this._totalAllInLineAttr=null},getBattleArrayData:function(){return this._battleArray?this._battleArray.getBattleArrayData():null},getBattleStateArrayData:function(t){for(var e=td.UnlockManager,i=td.ActorUnlockType.FORMATION,n=[],a=this.getBattleArrayData(),o=t===td.PanelEnum.Panel_BattleArray||t===td.PanelEnum.Panel_BattleFriend||t===td.PanelEnum.Panel_Gemstone,s=1;s<=td.MaxEnum.MaxBattleHeroCount;s++){var l=new C;l.setCallBackPanel(t);var c=e.isTargetUnlock(i,s),u=e.getTargetUnlockStr(i,s),d=null;if(o)d=a[s];else{d=this.getBattleArrayDataByPositionId(s);var h=s;c=e.isTargetUnlock(i,h),u=e.getTargetUnlockStr(i,h)}var p=null,_=0,g=s;if(d){_=d.getOrderId(),g=d.getPositionId();var f=d.getMercenarySId();p=(p=r.default.getInstance().getHeroBySId(f)).getBattleHeroModel()}l.init(c,u,_,p,g),n[n.length]=l}return n},getBattleArrayDataByPositionId:function(t){var e=this.getBattleArrayData();for(var i in e){var n=e[i];if(n.getPositionId()===t)return n}return null},getBattleArrayDataByConfigId:function(t){var e=this.getBattleArrayData();for(var i in e){var n=e[i],a=n.getMercenarySId(),o=r.default.getInstance().getHeroBySId(a);if(o.getId()===t)return n;if(o.isHaveSoulLinkHeros())for(var s=o.getSoulLinkHeroModels(),l=0;l<s.length;l++){if(s[l].getId()===t)return n}}return null},getBattleArrayLockStateByOrderId:function(t){var e=td.UnlockManager,i=td.ActorUnlockType.FORMATION;return e.isTargetUnlock(i,t)},getBattleEntityByIndex:function(t){return this._battleArray?this._battleArray.getBattleEntityByOrderId(t):null},getBattleMercenaryByIndex:function(t,e){if(void 0===e&&(e=!1),!this._battleArray)return null;var i=this._battleArray.getBattleEntityByOrderId(t);if(i){var n=r.default.getInstance().getHeroBySId(i.getMercenarySId());return e?n.getBattleHeroModel():n}},getBattleHeroModelBySid:function(t){var e=this.getBattleArrayData();for(var i in e){var n=e[i].getMercenarySId(),a=r.default.getInstance().getHeroBySId(n);if(n===t)return a;if(a.isHaveSoulLinkHeros())for(var o=a.getSoulLinkHeroModels(),s=0;s<o.length;s++){var l=o[s];if(l.getSId()===t)return l}}return null},getBattleEquipByIndex:function(t){if(!this._battleArray)return null;var e=this._battleArray.getBattleEntityByOrderId(t),i={};if(e){var n=e.getEquipList();for(var r in n){var o=n[r];i[r]=a.default.getInstance().getEquiptById(o)}}return i},getBattleTreasureByIndex:function(t){if(!this._battleArray)return null;var e=this._battleArray.getBattleEntityByOrderId(t),i={};if(e){var a=e.getTreasureList();for(var r in a){var o=a[r];i[r]=n.default.getInstance().getTreasureById(o)}}return i},getBattleSpiritByIndex:function(t){if(!this._battleArray)return null;var e=this._battleArray.getBattleEntityByOrderId(t);if(e){var i=e.getSpiritId();return p.default.getInstance().getSpiritById(i)}return null},getBattleArtifactByIndex:function(t){if(!this._battleArray)return null;var e=this._battleArray.getBattleEntityByOrderId(t),i={};if(e){var n=e.getDragonArtifactList();for(var a in n){var r=n[a];i[a]=td.DragonArtifactManager.getDragonArtifactDataBySId(r)}}return i},getCanSelectIndex:function(t,e){if(!this._battleArray)return 0;for(var i=this._battleArray.getBattleArrayData(),n=td.MaxEnum.MaxBattleHeroCount,a=t;a>0&&a<=n;)if(i[a+=e])return a;return t},getBattleEquipCountByIndex:function(t){if(!this._battleArray)return 0;var e=this._battleArray.getBattleEntityByOrderId(t);return e?e.getEquipList().myLen():0},getBattleGemstoneByIndex:function(t){if(!this._battleArray)return null;var e=this._battleArray.getBattleEntityByOrderId(t),i={};if(e){var n=e.getGemstoneList();for(var a in n){var r=n[a];i[a]=o.default.getInstance().getGemstoneDataBySId(r)}}return i},getGemstoneAddPerByIndex:function(t,e){return this._battleArray?this._battleArray.getGemstoneAddPerByIndex(t,e):0},getIndexByEquipSid:function(t){return this._battleArray?this._battleArray.getIndexByEquipSid(t):-1},getIndexByMercenarySid:function(t){return this._battleArray?this._battleArray.getIndexByMercenarySid(t):-1},getIndexByDragonArtifactSid:function(t){return this._battleArray?this._battleArray.getIndexByDragonArtifactSid(t):-1},getSelectBattleArrayIndex:function(){return this._selectIndex},getFriendList:function(){return this._friendList},getFriendHeroSIdByFriendIndex:function(t){return this._friendList[t]},getAllInLineAttr:function(){if(this._totalAllInLineAttr)return this._totalAllInLineAttr;var t={};if(!this._battleArray)return t;var e=this._battleArray.getBattleArrayData();for(var i in e){var n=this.getTotalAttrByOrderId(parseInt(i));for(var a in n)t[a]?t[a]+=n[a]:t[a]=n[a]}return this._totalAllInLineAttr=t,t},getAllInLineHighestAttrByType:function(t){if(!this._battleArray)return 0;var e=0,i=this._battleArray.getBattleArrayData();for(var n in i){var a=this.getTotalAttrByOrderId(parseInt(n));e=Math.max(e,a[t]||0)}return e},getLineAveHeroPower:function(){if(!this._battleArray)return 0;var t=0,e=this._battleArray.getBattleArrayData();for(var i in e){t+=this.getFightPowerByIndex(parseInt(i))}return Math.floor(t/e.myLen())},getMaxHeroPower:function(){if(!this._battleArray)return 0;var t=0,e=this._battleArray.getBattleArrayData();for(var i in e){var n=this.getFightPowerByIndex(parseInt(i));t=Math.max(t,n)}return t},getTotalAttrByOrderId:function(t){var e={},i={},n=this.getTotalEquipAttrByOrderId(t),a=this.getTotalTreasureAttrByOrderId(t),r=this.getTotalHeroAttrByOrderId(t),o=this.getCurrentArtifactAttr(t),s=this.getBattleArrayAttrByOrderId(t),l=this.getCampAttr(),d=this.getCampAttrTT(),h=n.attr,p=n.attrTT,_=a.attr,g=a.attrTT,f=r.attr,y=r.attrTT,E=s.attr,T=s.attrTT,C=this.getTotalGemAttrByOrderId(t),R=C.attr,S=C.attrTT,I=c.default.getInstance().getAllAttr(),A=c.default.getInstance().getAllAttrTT(),b=u.default.getInstance().getTotalAttr(),P=u.default.getInstance().getTotalAttrTT(),N=td.BattleArrayManager.getBattleSpiritByIndex(t),M={};N&&(M=N.getTotalAttr());var L=u.default.getInstance().getPetTotalAttr(),D=u.default.getInstance().getPetTotalAttrTT(),B=v.default.getInstance().getPetTotalAttr(),w=m.default.getInstance().getCurDivPosAttr();for(var O in f)e[O]?e[O]+=f[O]:e[O]=f[O];for(var O in h)e[O]?e[O]+=h[O]:e[O]=h[O];for(var O in _)e[O]?e[O]+=_[O]:e[O]=_[O];for(var O in R)e[O]?e[O]+=R[O]:e[O]=R[O];for(var O in I)e[O]?e[O]+=I[O]:e[O]=I[O];for(var F in o)e[F]?e[F]+=o[F]:e[F]=o[F];for(var O in b)e[O]?e[O]+=b[O]:e[O]=b[O];for(var O in M)e[O]?e[O]+=M[O]:e[O]=M[O];for(var O in L)e[O]?e[O]+=L[O]:e[O]=L[O];for(var O in B)e[O]?e[O]+=B[O]:e[O]=B[O];for(var O in w)e[O]?e[O]+=w[O]:e[O]=w[O];for(var O in l)e[O]?e[O]+=l[O]:e[O]=l[O];if(e[td.AttrType.Full]){for(var G=td.AttrType.Attack;G<=td.AttrType.SpellArmor;G++)e[G]?e[G]+=e[td.AttrType.Full]:e[G]=e[td.AttrType.Full];delete e[td.AttrType.Full]}for(var k in y)i[k]?i[k]+=y[k]:i[k]=y[k];for(var U in p)i[U]?i[U]+=p[U]:i[U]=p[U];for(var H in g)i[H]?i[H]+=g[H]:i[H]=g[H];for(var x in S)i[x]?i[x]+=S[x]:i[x]=S[x];for(var V in A)i[V]?i[V]+=A[V]:i[V]=A[V];for(var W in P)i[W]?i[W]+=P[W]:i[W]=P[W];for(var j in D)i[j]?i[j]+=D[j]:i[j]=D[j];if(i[td.AttrType.Full]){for(var Y=td.AttrType.Attack;Y<=td.AttrType.SpellArmor;Y++)i[Y]?i[Y]+=i[td.AttrType.Full]:i[Y]=i[td.AttrType.Full];delete i[td.AttrType.Full]}for(var O in td.GlobalFunction.getAttrMultipyAttrTT(e,i),td.GlobalFunction.getAttrMultipyAttrTT(e,d),td.GlobalFunction.getAttrMultipyAttrTT(e,T),E)e[O]?e[O]+=E[O]:e[O]=E[O];return e},getTotalHeroAttrByOrderId:function(t){var e=this._battleArray.getBattleEntityByOrderId(t).getMercenarySId(),i=r.default.getInstance().getHeroBySId(e),n=(i=i.getBattleHeroModel()).getTotalAttrAbsolute(),a=i.getTotalAttrTT(),o=i.getFeatures(),c=s.default.getInstance().getNationTechAttrByFeature(o);for(var u in c)n[u]?n[u]+=c[u]:n[u]=c[u];var d=s.default.getInstance().getNationTechAttrTTByFeature(o);for(var u in d)a[u]?a[u]+=d[u]:a[u]=d[u];var h=l.default.getInstance().getTotalAttr();for(var u in h)n[u]?n[u]+=h[u]:n[u]=h[u];return{attr:n,attrTT:a}},getCurrentArtifactAttr:function(t){var e=this._battleArray.getBattleEntityByOrderId(t).getMercenarySId(),i=r.default.getInstance().getHeroBySId(e).getArtifactSid();if(i&&0!==i){var n=h.default.getInstance().getArtifactModelByArtifactId(i);if(!n)return{};var a={};return(n=n.getRealArtifactModel()).getAttributes().forEach(function(t){a[t[0]]=t[1]}),a}return{}},getTotalEquipAttrByOrderId:function(t){var e=this._battleArray.getEquipListByIndex(t),i={},n={};if(!e||!e.myLen())return i;var r={},o=[],s=function(t){var s=a.default.getInstance().getEquiptById(e[t]);a.default.getInstance().getActivitedForgeSpecialEffectIdsByEquipId(e[t]).forEach(function(t){-1==o.indexOf(t)&&o.push(t)});var l=s.getTotalAttrAbsolute(),u=s.getTotalAttrTT();for(c in l)i[c]?i[c]+=l[c]:i[c]=l[c];for(c in u)n[c]?n[c]+=u[c]:n[c]=u[c];var d=0,h=s.getGroupId();if(0==h)return"continue";s.getAllThisGroup().forEach(function(t){var i=td.GetTableClass(td.TableEnum.EquipmentTable).getDataById(t),n=new R;for(var r in n.init(i),e){if(a.default.getInstance().getEquiptById(e[r]).getId()==n.getId()){d++;break}}}),r[h]=d};for(var l in e){var c;s(l)}for(var u in r){for(var d=td.GetTableClass(td.TableEnum.EquipmentGroupTable).getDataById(parseInt(u)),h=d.effectTTPercent,p=d.attributes,_=0;_<h.length;_++)r[u]>=h[_][0]&&h[_][1].forEach(function(t){n[t[0]]?n[t[0]]+=t[1]:n[t[0]]=t[1]});for(var v=0;v<p.length;v++)r[u]>=p[v][0]&&p[v][1].forEach(function(t){i[t[0]]?i[t[0]]+=t[1]:i[t[0]]=t[1]})}if(o.forEach(function(t){var e=td.GetTableClass(td.TableEnum.EquipmentForgeEffectTable).getDataById(t),a=td.GetTableClass(td.TableEnum.SpecialEffectTable).getDataById(e.specialEffectId);if(a&&a.type==g.SpecialEffectType.ATTRIBUTE){var r=td.GetTableClass(td.TableEnum.SpecialAttributeTable).getDataById(t),o=r.attributes,s=r.attributeTTPercent;o.forEach(function(t){i[t[0]]?i[t[0]]+=t[1]:i[t[0]]=t[1]}),s.forEach(function(t){n[t[0]]?n[t[0]]+=t[1]:n[t[0]]=t[1]})}}),e.myLen()>=4)for(var m=1;m<5;m++){var y=0;if((y=4==m?a.default.getInstance().getLevelResLvByIdAndResType(t,f.ResonancesViewType.EQUIPMENT_EVOLVE):a.default.getInstance().getLevelResLvByIdAndResType(t,m))>0){var E,T=void 0;if(T=4==m?this.getCofgs(f.ResonancesViewType.EQUIPMENT_EVOLVE):this.getCofgs(m),E=this.getCofg(T,y))E.effect.forEach(function(t){i[t[0]]?i[t[0]]+=t[1]:i[t[0]]=t[1]})}}return{attr:i,attrTT:n}},getTotalTreasureAttrByOrderId:function(t){var e=this._battleArray.getBattleEntityByOrderId(t).getTreasureList(),i={},a={};if(!e.myLen())return i;var r=[];for(var o in e){var s=n.default.getInstance().getTreasureById(e[o]);n.default.getInstance().getActivitedEvolveSpecialEffectIdsByEquipId(e[o]).forEach(function(t){-1==r.indexOf(t)&&r.push(t)});var l=s.getTotalAttrAbsolute(),c=s.getTotalAttrTT();for(var u in l)i[u]?i[u]+=l[u]:i[u]=l[u];for(var u in c)a[u]?a[u]+=c[u]:a[u]=c[u]}if(r.forEach(function(t){var e=td.GetTableClass(td.TableEnum.EquipmentForgeEffectTable).getDataById(t),n=td.GetTableClass(td.TableEnum.SpecialEffectTable).getDataById(e.specialEffectId);if(n&&n.type==g.SpecialEffectType.ATTRIBUTE){var r=td.GetTableClass(td.TableEnum.SpecialAttributeTable).getDataById(t),o=r.attributes,s=r.attributeTTPercent;o.forEach(function(t){i[t[0]]?i[t[0]]+=t[1]:i[t[0]]=t[1]}),s.forEach(function(t){a[t[0]]?a[t[0]]+=t[1]:a[t[0]]=t[1]})}}),e.myLen()>=2)for(var d=4;d<7;d++){var h;if((h=n.default.getInstance().getLevelResLvByIdAndResType(t,d))>0){var p,_;if(p=this.getCofgs(d),_=this.getCofg(p,h))_.effect.forEach(function(t){i[t[0]]?i[t[0]]+=t[1]:i[t[0]]=t[1]})}}return{attr:i,attrTT:a}},getTotalGemAttrByOrderId:function(t){var e={},i={},n=this.getBattleGemstoneByIndex(t);if(!n.myLen())return{attr:e,attrTT:i};for(var a in n){var r=n[a],o=r.getAttrAddition();for(var s in o)e[s]?e[s]+=o[s]._operateValue:e[s]=o[s]._operateValue;var l=r.getAttrAddition(!0);for(var c in l)i[c]?i[c]+=l[c]._operateValue:i[c]=l[c]._operateValue}return{attr:e,attrTT:i}},getBattleArrayAttrByOrderId:function(t){var e={},i={},n=this._battleArray.getBattleEntityByOrderId(t).getMercenarySId(),a=r.default.getInstance().getHeroBySId(n),o=0;(a=a.getBattleHeroModel())&&(o=a.getFeatures());var s=td.BattleArrayManager.getBattleArrayData();for(var l in s){var c=this._battleArray.getBattleEntityByOrderId(l).getMercenarySId(),u=r.default.getInstance().getHeroBySId(c),d=u.getArtifactSid(),p=(u=u.getBattleHeroModel()).getLevelSkillIds(),_=!1,f=void 0;if(d){var v=h.default.getInstance().getArtifactModelByArtifactId(d);if(v)f=(v=v.getRealArtifactModel()).getAdvanceLevel(),p=td.GetTableClass(td.TableEnum.HeroArtifactEvolveTable).getDataByIdAndLevel(v.getId(),f).showSkillIDs,_=!0}for(var m=0;m<p.length;m++){var y=void 0,E=void 0,T=void 0;if(_?(y=p[m],T=!0,E=f):(E=p[m][0],y=p[m][1][0],T=u.getLevel()>=E),T){var C=td.GetTableClass(td.TableEnum.SpecialEffectTable).getDataById(y);if(C&&C.type==g.SpecialEffectType.Final){var R=td.GetTableClass(td.TableEnum.SpecialAttributeTable).getDataById(y);if(R){var S=R.attributes,I=R.attributeTTPercent,A=R.type;parseInt(l)===t&&A==g.AttributeTargetType.SELF&&(S.forEach(function(t){e[t[0]]||(e[t[0]]=0),e[t[0]]+=t[1]}),I.forEach(function(t){i[t[0]]||(i[t[0]]=0),i[t[0]]+=t[1]}));var b=0;a&&(b=a.getCurCamp()+7),A!=o&&A!=g.AttributeTargetType.LINEUP&&A!=b||(S.forEach(function(t){e[t[0]]||(e[t[0]]=0),e[t[0]]+=t[1]}),I.forEach(function(t){i[t[0]]||(i[t[0]]=0),i[t[0]]+=t[1]}))}}}}}return{attr:e,attrTT:i}},getCofgs:function(t){var e=[],i=td.GetTableClass(td.TableEnum.ResonateTable).getDataByType(t);for(var n in i)e[i[n].level-1]=i[n];return e},getCofg:function(t,e){for(var i,n=0;n<t.length&&e>=t[n].targetLevel;n++)i=t[n];return i},calcFightPower:function(){var t=0;for(var e in this._battleArray)t+=this.getFightPowerByIndex(e);return t},getFightPowerByIndex:function(t){return this._battleArray?Math.ceil(this._battleArray.getFightPowerByIndex(t)):0},getAttackByIndex:function(t){return this._battleArray?this._battleArray.getAttackByIndex(t):0},getHPByIndex:function(t){return this._battleArray?this._battleArray.getHPByIndex(t):0},getBattleArrayAttrByType:function(t,e){return this._battleArray?this._battleArray.getBattleArrayAttrByType(t,e):0},getOtherAttrByIndex:function(t,e){return this._battleArray?this._battleArray.getOtherAttrByIndex(t,e):0},_setLineupAdd:function(){},_setEvloveLineupAdd:function(){this._setEvolveLineupAddValue(),this._setEvolveLineupAddTTpercent()},_setReinforcementsAdd:function(){this._reinforcementsAdd={};var t=this._friendList;for(var e in t){var i=t[e],n=r.default.getInstance().getHeroBySId(i);if(n){var a=td.AttrType;for(var e in a){var o=a[e];this._reinforcementsAdd[o]||(this._reinforcementsAdd[o]=0),this._reinforcementsAdd[o]+=n.getReinforcementsAdd(o)}}}},getReinforcementsAdd:function(t){return this._reinforcementsAdd[t]||0},_setEvolveLineupAddValue:function(){this._evolveLineupAddValue={};var t=this._battleArray.getBattleArrayData();for(var e in t){var i=t[e],n=r.default.getInstance().getHeroBySId(i.getMercenarySId());if(n){var a=td.AttrType;for(var e in a){var o=a[e];this._evolveLineupAddValue[o]||(this._evolveLineupAddValue[o]=0),this._evolveLineupAddValue[o]+=n.getEvolveLineupAddValue(o)}}}},getEvolveLineupAddValue:function(t){return this._evolveLineupAddValue[t]||0},_setEvolveLineupAddTTpercent:function(){this._evolveLineupAddTTPercent={};var t=this._battleArray.getBattleArrayData();for(var e in t){var i=t[e],n=r.default.getInstance().getHeroBySId(i.getMercenarySId());if(n){var a=td.AttrType;for(var e in a){var o=a[e];this._evolveLineupAddTTPercent[o]||(this._evolveLineupAddTTPercent[o]=0),this._evolveLineupAddTTPercent[o]+=n.getEvolveLineupAddTTPercent(o)}}}},getEvolveLineupAddTTPercent:function(t){return this._evolveLineupAddTTPercent[t]||0},getEquipGrowAddTTPercentByType:function(t,e){if(!this._battleArray)return 0;var i=this._battleArray.getBattleEntityByOrderId(t);return i?i.getEquipGrowAddTTPercentByType(e):0},getEquipGroupData:function(t){return this._battleArray?this._battleArray.getBattleEntityByOrderId(t).getEquipGroupData():null},getEquipGroupAdd:function(t,e){return this._battleArray?this._battleArray.getBattleEntityByOrderId(t).getGroupAddAttrByType(e):0},equipInsideGroup:function(t,e){if(!this._battleArray)return!1;var i=this._battleArray.getBattleEntityByOrderId(t);return!!i&&i.equipInsideGroup(e)},isGroupActive:function(t,e){if(!this._battleArray)return!1;var i=this._battleArray.getBattleEntityByOrderId(t);return!!i&&i.isGroupActive(e)},getEquipAttrByIndex:function(t,e){return this._battleArray?this._battleArray.getEquipAttrByIndex(t,e):0},getEquipAddByIndex:function(t,e){return this._battleArray?this._battleArray.getEquipAddByIndex(t,e):0},getIndexByGemstoneSid:function(t){return this._battleArray?this._battleArray.getIndexByGemstoneSid(t):-1},getCanReplaceMercenary:function(t,e){var i,n=[];if(!this._battleArray)return n;if(t===td.ReplaceMercenaryType.BattleArray||t===td.ReplaceMercenaryType.Friend){var a=this._battleArray.getBattleEntityByOrderId(e);a&&(i=a.getMercenarySId())}var o=r.default.getInstance().getHeroData(),s=0;for(var l in o){var c=o[l];i&&c.getSId()===i||c.isEquipped()&&t!==td.ReplaceMercenaryType.BattleArray||c.isReinforcementsed()||t===td.ReplaceMercenaryType.Friend&&this.isExistMercenaryWithRoleType(c.getRoleType(),null,e)||t===td.ReplaceMercenaryType.Assistant&&e-1!==c.getQuality()||(n[s++]=c)}return n.sort(td.SortUtil.mercenaryReplaceSort),n},haveCanReplaceMercenary:function(t,e){if(!this._battleArray)return!1;var i;if(t===td.ReplaceMercenaryType.BattleArray||t===td.ReplaceMercenaryType.Friend){var n=this._battleArray.getBattleEntityByOrderId(e);n&&(i=n.getMercenarySId())}var a=r.default.getInstance().getHeroData();for(var o in a){var s=a[o];if(!(i&&s.getSId()===i||s.isEquipped()&&t!==td.ReplaceMercenaryType.BattleArray||s.isReinforcementsed()||t===td.ReplaceMercenaryType.Friend&&this.isExistMercenaryWithRoleType(s.getRoleType(),null,e)||t===td.ReplaceMercenaryType.Assistant&&e-1!==s.getQuality()))return!0}return!1},getCanReplaceEquipByType:function(t){var e=[];if(!this._battleArray||!this._selectIndex)return e;var i=this._selectIndex,n=this._battleArray.getBattleEntityByOrderId(i);if(!n)return e;var r=n.getEquipList()[t],o=a.default.getInstance().getAllEquipt(!1,!1),s=0;for(var l in o){var c=o[l];c.getSId()!==r&&c.getEquipType()===t&&(e[s++]=c)}return e.sort(td.SortUtil.equipReplaceSort),e},haveCanReplaceEquipByType:function(t){if(!this._battleArray||!this._selectIndex)return!1;var e=this._selectIndex,i=this._battleArray.getBattleEntityByOrderId(e);if(!i)return!1;var n=i.getEquipList()[t],r=a.default.getInstance().getAllEquipt(!1,!1);for(var o in r){var s=r[o];if(s.getSId()!==n&&!s.isEquipped()&&s.getEquipType()===t)return!0}return!1},getCanReplaceGemstone:function(){var t=[];if(!this._battleArray||!this._selectIndex)return t;var e=this._selectIndex,i=this._battleArray.getBattleEntityByOrderId(e);if(!i)return t;var n=o.default.getInstance().getGemstoneData(),a=i.getGemstoneList(),r={},s=o.default.getInstance().getOperateIndex();for(var l in a){var c=a[l=parseInt(l)];if(s!==l){if(n[c]){var u=n[c].getType(),d=n[c].getRuneType();r[d]=r[d]||{},r[d][u]=r[d][u]||0,r[d][u]++}}else c}var h=0;for(var p in n){var _=n[p];if(0!==_.getType()){var g=_.getRuneType(),f=_.getType(),v=_.getGemstoneMaxCount();r[g]&&r[g][f]&&r[g][f]>=v||(t[h++]=_)}}return t.sort(td.SortUtil.gemstoneGenSort),t},haveCanReplaceGemstone:function(t){if(!this._battleArray)return!1;var e=this._battleArray.getBattleEntityByOrderId(t);if(!e)return!1;var i=e.getGemstoneList(),n=o.default.getInstance().getGemstoneData();for(var a in n){var r=n[a];if(!r.isEquipped()){var s=r.getType(),l=r.getGemstoneMaxCount(),c=0;for(var u in i){var d=n[i[u]];d&&d.getType()===s&&c++}if(!(c>=l))return!0}}return!1},haveCanReplaceArtifact:function(t,e){if(!this._battleArray)return!1;var i=this._battleArray.getBattleEntityByOrderId(t);if(!i)return!1;var n=i.getDragonArtifactList(),a=td.DragonArtifactManager.getDragonArtifactData(),r=td.DragonArtifactManager.isBetterArtifact;for(var o in a){var s=a[o];if(!s.isEquipped()){var l=s.getBaseAttrType(),c=!1;for(var u in n){var d=n[u];if(!e||d!==e.getSId()){var h=a[d];if(h&&h.getBaseAttrType()===l){c=!0;break}}}if(!(c||e&&!r(s,e)))return!0}}return!1},_changeOperateIndex:function(t){this._selectIndex=t},_requestGetBattleArray:function(){var t={};t.module=td.MsgModuleName.LINEUP,t.cmd=td.MsgCmd.LINEUP.GET_LINEUP_LIST,td.ServerDelegate.sendMessage(t)},_parseBattleArray:function(t,e){if(t===td.NetCode.SUCCESS){var i;td.PartnershipManager.setOldPartnershipActivity(),this._updataArray=!0,this._battleArray||(this._battleArray=new E,i=!0,this.needDownLoad=!0,this._updataArray=!1),this._battleArray.setSoulLinkCount(e.soulLinkCount||this._battleArray.getSoulLinkCount());var n=e.lineupList,a={};if(n)for(var o=0;o<n.length;o++){var s=n[o],l=this._battleArray.getBattleEntityByOrderId(s.orderId),c=this._battleArray.getBattleEntityBySid(s.heroId);if((!l&&c||l&&c&&l.getOrderId()!=c.getOrderId())&&(this._battleArray.delBattleEntity(c.getOrderId()),a[c.getOrderId()]=!0),null!==l){l.setOrderId(s.orderId),l.setPower(s.power),l.setBattleHeroId(s.battleId||s.heroId);var d=l.getMercenarySId();this._replaceMercenary(l,s.heroId),td.PartnershipManager.resetPartnershipActivity(d),l.setPositionId(s.positionId),this._updateEquipment(l,s.equipmentMap),this._updateGemstone(l,s.runeMap),this._updateTreasure(l,s.treasureMap),this._updateSpirit(l,s.spiritId),this._updateSoulLink(l,s)}else l=this._createBattleEntity(s),this._battleArray.updateBattleEntity(l),l.setEquipList(l.getEquipList()),!i&&!a[s.orderId]&&(this._selectIndex=s.orderId),this._heroResModels=null}var h=e.petList;h&&this._updatePet(h);var p=e.reinforcementMap;if(p){for(var _ in this._friendList){var g=this._friendList[_],f=r.default.getInstance().getHeroBySId(g);if(p[_]){if(p[_]!=g){f.setReinforcementsed(!1);var v=p[_];(m=r.default.getInstance().getHeroBySId(v)).setReinforcementsed(!0),m.setOrderId(_),this._friendList[_]=p[_],delete p[_]}}else f.setReinforcementsed(!1),delete this._friendList[_],td.PartnershipManager.resetPartnershipActivity(g)}for(var _ in p){var m;(m=r.default.getInstance().getHeroBySId(p[_])).setReinforcementsed(!0),m.setOrderId(_),this._friendList[_]=p[_]}}this._setLineupAdd(),u.default.getInstance().getActiveList().length>0&&this.afterManualInit()}},afterManualInit:function(){if(td.PartnershipManager.setRelationShip(),td.PartnershipManager.setPartnershipActivity(),this.needDownLoad&&!td.GuideManager.isFirstBattle()){var t=this._battleArray.getBattleArrayData(),e=[];for(var i in t){var n=t[i].getMercenarySId(),a=r.default.getInstance().getHeroBySId(n);e.push(a.getShowModelResKey())}setTimeout(function(){gdk.rm.addLoadResInBackground(e,td.PanelEnum.PanelMain)},1e3)}td.ModuleManager.setSelfMercenaryModules(),td.EventUtil.dispatchEvent(td.EventNameEnum.CALC_BATTLE_ARRAY),td.EventUtil.dispatchEvent(td.EventNameEnum.INIT_DATA_LOADED,td.LoadKey.BattleArray),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MERCENARY),this._needShowPartnerShip=!0,_.default.getInstance().getCallingStatus()||td.PartnershipManager.checkShowPartnerShip()},preLoadBattleHeroRes:function(){var t=this._battleArray.getBattleArrayData(),e=[];for(var i in t){var n=t[i].getMercenarySId(),a=r.default.getInstance().getHeroBySId(n);e.push(a.getShowModelResKey())}gdk.rm.addLoadResInBackground(e,td.PanelEnum.PanelMain)},getNeedShowPartnerShip:function(){return this._needShowPartnerShip},_createBattleEntity:function(t){var e=new T;e.setOrderId(t.orderId),e.setPositionId(t.positionId),e.setMercenarySId(t.heroId),e.setPower(t.power),e.setBattleHeroId(t.battleId||t.heroId),this._updateEquipment(e,t.equipmentMap),this._updateGemstone(e,t.runeMap),this._updateTreasure(e,t.treasureMap),this._updateSpirit(e,t.spiritId);var i=r.default.getInstance().getHeroBySId(t.heroId);return i&&i.setEquipped(!0),i&&i.setOrderId(e.getOrderId()),this._updateSoulLink(e,t),td.PartnershipManager.addPartner(i),e},_replaceMercenary:function(t,e){var i=t.getMercenarySId(),n=r.default.getInstance().getHeroBySId(i);n&&n.setEquipped(!1),n&&n.setOrderId(0),n&&n.refreshSoulLinkHero([]),td.PartnershipManager.removePartner(n);var a=r.default.getInstance().getHeroBySId(e);a&&a.setEquipped(!0),a&&a.setOrderId(t.getOrderId()),td.PartnershipManager.addPartner(a),t.setMercenarySId(e),n&&a&&(n.getRoleType(),a.getRoleType()),td.ModuleManager.setSelfMercenaryModules()},_onMercenaryChanged:function(t){if(t){for(var e=0,i=t.length;e<i;e++){var n=parseInt(t[e].heroId),a=r.default.getInstance().getHeroBySId(n);if(a&&a.isEquipped()){var o=this.getIndexByMercenarySid(n);-1!==o&&td.PartnershipManager.updatePartnershipActivity(n,o)}}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MERCENARY)}},_updateSpirit:function(t,e){var i=t.getSpiritId(),n=p.default.getInstance().getSpiritById(i);n&&n.setEquipped(!1),n&&n.setBattleArrayEntityOrderId(999);var a=p.default.getInstance().getSpiritById(e);a&&a.setEquipped(!0),a&&a.setBattleArrayEntityOrderId(t.getOrderId()),t.setSpiritId(e),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_CHANGE_SPIRIT)},_updatePet:function(t){for(var e in t){var i=t[e],n=this.getPetByOrderId(i.orderId);n&&n.setEquipped(!1)}for(var a in t){var r=t[a],o=v.default.getInstance().getPetBySId(r.petId);o&&o.setEquipped(!0),o&&o.setOrderId(r.orderId),this._petLineupMap[r.orderId]=o}},getPetLineupMap:function(){return this._petLineupMap},getPetByOrderId:function(t){return this._petLineupMap[t]},_petLineupSuc:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PET_LINEUP_CHANGE_SUC)},getPetTotalPower:function(){var t=0;for(var e in this._petLineupMap){t+=this._petLineupMap[e].getBaseAttackPower()}return t},_updateEquipment:function(t,e){var i=t.getEquipList();for(var n in i){var r=i[n];if(!e[n]||e[n]!=r)(o=a.default.getInstance().getEquiptById(r))&&o.setEquipped(!1),o&&o.setBattleArrayEntityOrderId(0),t.removeSuitEquip(o)}for(var n in e){var o;r=e[n];(o=a.default.getInstance().getEquiptById(r))&&(o.setEquipped(!0),o.setBattleArrayEntityOrderId(t.getOrderId()),t.addSuitEquip(o))}t.setEquipList(e)},_updateSoulLink:function(t,e){var i=e.soulLinks;i||(i=[]);for(var n=t.getSoulLink(),a=0;a<n.length;a++){var o=n[a],s=r.default.getInstance().getHeroBySId(o);s&&s.setSoulLinked(!1),s&&s.setOrderId(0),td.PartnershipManager.removePartner(s)}for(var l=0;l<i.length;l++){var c=i[l],u=r.default.getInstance().getHeroBySId(c);u&&u.setSoulLinked(!0),td.PartnershipManager.addPartner(u)}t.setSoulLink(i);var d=r.default.getInstance().getHeroBySId(e.heroId);d&&d.setBattleHeroId(e.battleId),d&&d.refreshSoulLinkHero(e.soulLinks)},_onEquipChanged:function(t){if(t)for(var e=t,i=0,n=e.length;i<n;i++){var r=e[i],o=a.default.getInstance().getEquiptById(r.getSId());if(o&&o.isEquipped()){var s=this.getIndexByEquipSid(r.equipmentId);if(-1!=s){var l=this.getBattleEntityByIndex(s);l.updateMasterLevel(),l.updateEquipGrowAddTTPercent(),l.updateEquipTotalAttrs()}}}},_onArtifactChanged:function(t){if(t)for(var e=t,i=0,n=e.length;i<n;i++){var a=e[i],r=td.DragonArtifactManager.getDragonArtifactDataBySId(a.artifactId);if(r&&r.isEquipped()){var o=this.getIndexByDragonArtifactSid(a.artifactId);if(-1!=o){var s=this.getBattleEntityByIndex(o);s.updateArtifactTotalAttrs(),s.updateEquipTotalAttrs()}}}},_updateGemstone:function(t,e){var i=t.getGemstoneList();for(var n in i){var a=i[n];if(!e[n]||e[n]!=a)(r=o.default.getInstance().getGemstoneDataBySId(a))&&r.setEquipped(null)}for(var n in e){var r;a=e[n];(r=o.default.getInstance().getGemstoneDataBySId(a))&&r.setEquipped(t.getOrderId())}t.setGemstoneList(e)},_onGemstoneChanged:function(t){if(t)for(var e=t,i=0,n=e.length;i<n;i++){var a=e[i],r=o.default.getInstance().getGemstoneDataBySId(a.runeId);if(r&&r.isEquipped()){var s=this.getIndexByGemstoneSid(a.runeId);if(-1!=s)this.getBattleEntityByIndex(s).updateGemstoneTotalAttrs()}}},_updateDragonArtifact:function(t,e){if(e){var i=t.getDragonArtifactList();for(var n in i){var a=i[n];if(!e[n]||e[n]!=a)(r=td.DragonArtifactManager.getDragonArtifactDataBySId(a))&&r.setEquipped(!1),r&&r.setBattleArrayEntityOrderId(0)}for(var n in e){var r;a=e[n];(r=td.DragonArtifactManager.getDragonArtifactDataBySId(a))&&r.setEquipped(!0),r&&r.setBattleArrayEntityOrderId(t.getOrderId())}t.setDragonArtifactList(e)}},_updateTreasure:function(t,e){if(e){var i=t.getTreasureList();for(var a in i){var r=i[a];if(!e[a]||e[a]!=r)(o=n.default.getInstance().getTreasureById(r))&&o.setEquipped(!1),o&&o.setBattleArrayEntityOrderId(0)}for(var a in e){var o;r=e[a];(o=n.default.getInstance().getTreasureById(r))&&o.setEquipped(!0),o&&o.setBattleArrayEntityOrderId(t.getOrderId())}t.setTreasureList(e)}},_requestJoinBattleArray:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.JOIN_LINEUP;var i=this._battleArray.getBattleEntityByOrderId(t.orderId);e.orderId=i?t.orderId:this._battleArray.getCanLineUpOrderId(),this._requestJoinBattleArray.needLineup=!0,e.heroId=t.heroId,td.ServerDelegate.sendMessage(e)},_requestChangeBattleOrder:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.CHANGE_POSITION,e.positionId=t.positionId,e.orderId=t.orderId,td.ServerDelegate.sendMessage(e)},_onBattleArrayChangeReturn:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_CHANGED,t),this._requestJoinBattleArray.needLineup&&(this._requestJoinBattleArray.needLineup=!1)},_requestChangeFriend:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.CHANGE_REINFORCEMENT,e.orderId=t.orderId,e.heroId=t.mercenaryId,td.ServerDelegate.sendMessage(e)},_onBattleFriendChangeReturn:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_FRIEND_CHANGED)},_requestChangeAssistant:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.CHANGE_ASSISTANT,e.orderId=t.orderId,e.assistantId=t.assistantId,e.heroId=t.heroId,td.ServerDelegate.sendMessage(e)},_onBattleAssistantChangeReturn:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ASSISTANT_CHANGED)},_requestChangeEquip:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.CHANGE_EQUIPMENT,e.orderId=this._selectIndex,e.equipmentId=t.getSId(),e.type=t.getType(),td.ServerDelegate.sendMessage(e)},_onChangeEquipment:function(t,e){td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_CHANGED,t),t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.PUT_ON_EQUIP_SUCCESS)},_requestDemountEquip:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.DISCHARGE_EQUIPMENT,e.orderId=t.getBttleArrayOrderId(),e.type=t.getType(),td.ServerDelegate.sendMessage(e)},_requestAutoDemountEquip:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.EQUIPMENT_QUICKLY_REMOVE,e.orderId=t.orderId,td.ServerDelegate.sendMessage(e)},_requestAutoEquip:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.EQUIPMENT_QUICKLY_WEAR,e.orderId=t.orderId,td.ServerDelegate.sendMessage(e)},_requestAutoUpgrade:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.EQUIPMENT_QUICKLY_REINFORCE,e.orderId=t.orderId,td.ServerDelegate.sendMessage(e)},_onAutoStrengthReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.list;td.EventUtil.dispatchEvent(td.EventNameEnum.AUTO_STRENGTH_RETURN,i)}},_onEquipChangeReturn:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.CHANGE_BATTLE_EQUIP)},_requestChangeGemstone:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.CHANGE_GEMSTONE,e.orderId=t.orderId,e.runeId=t.gemstoneId,e.type=t.type,td.ServerDelegate.sendMessage(e)},_requestChangeArtifact:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.CHANGE_ARTIFACT,e.orderId=t.orderId,e.artifactOrderId=t.artifactOrderId,e.artifactId=t.artifactId,td.ServerDelegate.sendMessage(e)},_requestAutoAddGemstone:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.REQUEST_AUTO_ADD_GEMSTONE,e.orderId=t.orderId,td.ServerDelegate.sendMessage(e)},_requestAutoDelGemstone:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.RUNE_QUICKLY_REMOVE,e.orderId=t.orderId,td.ServerDelegate.sendMessage(e)},_requestChangeTreasure:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.CHANGE_TREASURE,e.orderId=t.orderId,e.type=t.type,e.treasureId=t.treasureId,td.ServerDelegate.sendMessage(e)},_requestChangeSpirit:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.CHANGE_SPIRIT,e.orderId=t.orderId,e.spiritId=t.spiritId,td.ServerDelegate.sendMessage(e)},_resChangeTreasure:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_CHANGE_TREASURE)},_resChargeSpirit:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_CHANGE_SPIRIT)},_requestDischargeTreasure:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.DISCHARGE_TREASURE,e.orderId=t.orderId,e.type=t.type,td.ServerDelegate.sendMessage(e)},_resDischargeTreasure:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_DISCHARGE_TREASURE)},_requestSoulLinkBuyCount:function(){var t={};t.module=td.MsgModuleName.LINEUP,t.cmd=td.MsgCmd.LINEUP.LINEUP_SOUL_LINK_COUNT,td.ServerDelegate.sendMessage(t)},_onGetSoulLinkBuyCount:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_SOUL_LINK_BUY_COUNT)},_requestSoulLink:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.LINEUP_SOUL_LINK,e.orderId=t.orderId,e.heroId=t.heroId,td.ServerDelegate.sendMessage(e)},_onGetSoulLink:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_SOUL_LINK)},_requestSoulLinkBattle:function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.LINEUP_SOUL_LINK_BATTLE,e.orderId=t.orderId,e.heroId=t.heroId,td.ServerDelegate.sendMessage(e)},_onGetSoulLinkBattle:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_SOUL_LINK_BATTLE)},_lineupChange:function(t){td.ServerDelegate.sendMessage({module:td.MsgModuleName.LINEUP,cmd:td.MsgCmd.LINEUP.PET_CHANGE,pets:t})},isExistHeroWithId:function(t,e,i){var n=this._battleArray.getBattleArrayData(),a=this._friendList;for(var o in n){var s=n[o=parseInt(o)];if((h=r.default.getInstance().getHeroBySId(s.getMercenarySId()))&&h.getId()==t)return!(e&&o==e);if(h.isHaveSoulLinkHeros())for(var l=h.getSoulLinkHeroModels(),c=0;c<l.length;c++){var u=l[c];if(u&&u.getId()==t)return!(e&&o==e)}}for(var d in a){var h;if((h=r.default.getInstance().getHeroBySId(a[d]))&&h.getId()==t)return e||!i||i&&i!=d}return!1},isExistMercenaryWithRoleType:function(t,e,i,n,a){void 0===n&&(n=!0),void 0===a&&(a=!1);var o=this._battleArray.getBattleArrayData(),s=u.default.getInstance().getActiveList();for(var l in o){var c=o[l],d=!1;if(_=r.default.getInstance().getHeroBySId(c.getMercenarySId())){if(n){var h=_.getSoulLinkHeroModels();if(h&&h.length>0)for(var p=0;p<h.length;p++){if(h[p].getRoleType()==t){d=!0;break}}}_.getRoleType()==t&&(d=!0)}if(d)return!e||l!=e}if(a)for(var l in s){var _;if((_=s[l])&&_.getRoleType()==t&&(e||!i||i&&i!=l))return!0}return!1},isExistEquipWithEquipId:function(t,e){var i=this.getBattleEquipByIndex(t);for(var n in i){if(i[n].getId()===e)return!0}return!1},isTreasureWithTreasureId:function(t,e){var i=this._battleArray.getBattleEntityByOrderId(t).getTreasureList();for(var a in i){if(n.default.getInstance().getTreasureById(i[a]).getId()===e)return!0}return!1},isExistGemWithGemType:function(t,e,i,n){var a=this.getBattleGemByIndex(t);for(var r in a){var o=a[r=parseInt(r)];if(r!==e&&o.getType()===i&&o.getSId()!==n)return!0}return!1},isExistArtifactWithType:function(t,e,i,n){var a=this.getBattleArtifactByIndex(t);for(var r in a){var o=a[r=parseInt(r)];if(r!==e&&o.getBaseAttrType()===i&&o.getSId()!==n)return!0}return!1},_setIsShowAutoStrength:function(t){this._isShowAutoStrength=t},getIsShowAutoStrength:function(){return this._isShowAutoStrength},getSoulLinkCount:function(){var t=this.getBattleArrayData(),e=0;if(t)for(var i in t){if(t.hasOwnProperty(i))t[i].isSoulLinked()&&(e+=1)}return e},getSoulLinkTotalCount:function(){return this._battleArray.getSoulLinkCount()},getSoulLinkModelList:function(){var t=this.getBattleArrayData(),e=[];if(t)for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];e.push(n.getSoulLinkModel())}return e},getSoulLinkModelByIndex:function(t){return this._battleArray?this._battleArray.getSoulLinkModelByOrderId(t):null},getBattleHeroByIndex:function(t){if(!this._battleArray)return null;var e=this._battleArray.getBattleEntityByOrderId(t);return e?r.default.getInstance().getHeroBySId(e.getBattleHeroId()):void 0},onekeyUpRedPoint:function(t){var e=this.getBattleArrayData();if(e&&e[t]){var i=e[t].getEquipList();for(var n in i){var r=i[n];if(a.default.getInstance().canLevelUp(r))return!0;if(a.default.getInstance().canForge(r))return!0}}return!1},hasAllRedPoint:function(){return!!this.getBattleArrayData()&&this.hasRedPoint()},hasRedPoint:function(t,e){void 0===t&&(t=!1),void 0===e&&(e=0);var i=this.getBattleArrayData();for(var o in i)if(!(e>0&&parseInt(o)!==e)){var s=i[o],l=s.getMercenarySId(),c=r.default.getInstance().getHeroBySId(l).getBattleHeroModel();if(!t&&r.default.getInstance().canHeroUp(l))return!0;var u=s.getEquipList();for(var d in u){var _=u[d];if(!t&&a.default.getInstance().canUp(_))return!0}var g=s.getTreasureList();for(var f in g){var v=g[f];if(!t&&n.default.getInstance().canTreaureUp(v))return!0}var m=td.BattleArrayManager.getBattleMercenaryByIndex(o),y=td.GetConfig("HERO_ARTIFACT_UNLOCK_HERO_LEVEL");if(m.getLevel()>=y){var E=m?m.getArtifactSid():0,T=E?h.default.getInstance().getArtifactModelByArtifactId(E):null;if(T){if(!t&&h.default.getInstance().isRedPointBySId(T.getSId()))return!0;if(h.default.getInstance().canReplace(T.getSId(),!0))return!0}else if(h.default.getInstance().canReplace(m.getRoleType(),!1))return!0}var C=td.BattleArrayManager.getBattleSpiritByIndex(o);if(C){if(!t&&p.default.getInstance().canUp(C.getSId()))return!0;if(p.default.getInstance().canChange(C.getSId()))return!0}else{if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.SPIRIT,0))if(p.default.getInstance().getSpiritArray(!0).length>0)return!0}for(var R=1;R<=td.MaxEnum.MaxEquipCount;R++)if(u[R]){var I=c.getReinforcementIds();if(a.default.getInstance().hasBetterToReplace(u[R],u,I))return!0}else{if(a.default.getInstance().getEquiptByType(R,!0).length>0)return!0}for(var A=S.TreasureType.ATTACK;A<=S.TreasureType.DEFENSE;A++){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.TREASURE,0))if(g[A]){if(n.default.getInstance().hasBetterToReplace(g[A],c))return!0}else if(n.default.getInstance().getTreasureByType(A,!0,s.getOrderId()).length>0)return!0}}return!1},redPointEvents:function(){var t=td.EventNameEnum;return[t.ITEM_CHANGE,t.RES_HERO_LIST,t.RES_HERO_RUNE_INFO,t.RES_HERO_RUNE_EQUIPPED,t.PUSH_DELETE_HERO_LIST,t.PUSH_DELETE_HERO_RUNE_LIST,t.RES_GET_TREASURE_INFO,t.USER_ON_ATTR_CHANGE,t.PUSH_TREASURE_DELETE,t.REQUEST_EQUIP_LIST,t.EQUIP_CHANGED,t.BATTLE_ARRAY_CHANGED,td.EventNameEnum.RES_HERO_ARTIFACT_INFO]},getHeroResModels:function(){if(!this._heroResModels){var t=I.getModules(!0,!0),e=r.default.getInstance().getHeroData(),i=td.BattleArrayManager.getBattleArrayData(),n=[];for(var a in i){var o=i[a];n[n.length]=e[o.getMercenarySId()]}var s=td.ModuleManager.getHeroesModule(n),l=t.concat(s),c=gdk.rm.getResources(l);this._heroResModels=c;for(var u=c.length-1;u>=0;u--){var d=c[u],h=d.type,p=d.resArray;if(p&&!(p.length<1))for(var _=0,g=p.length;_<g;_++)for(var f=p[_],v=cc.loader._getResUuid(f,h),m=cc.loader._getReferenceKey(v),y=cc.loader.getDependsRecursively(m),E=0,T=y.length;E<T;E++)A.default.HeroUnReleaseResive[y[E]]=!0}}},getCampMax:function(){var t=this._battleArray.getBattleArrayData(),e=[0,0,0];for(var i in t){var n=t[i].getMercenarySId();e[r.default.getInstance().getHeroBySId(n).getCurCamp()-1]++}return e.sort(function(t,e){return t-e}),e[e.length-1]},getCampMaxByData:function(t){if(t){var e=[0,0,0];for(var i in t){e[t[i].getCurCamp()-1]++}return e.sort(function(t,e){return t-e}),e[e.length-1]}},getCampAttrTT:function(){var t=this.getCampMax();if(!(t<3))return d.default.getInstance().getCampAttrTT(t)},getCampAttr:function(){var t=this.getCampMax();if(!(t<3))return d.default.getInstance().getCampAttr(t)},getCampConvertCount:function(){var t=this._battleArray.getBattleArrayData(),e=0;for(var i in t){var n=t[i].getMercenarySId(),a=r.default.getInstance().getHeroBySId(n);if(a.isCampConverted()&&e++,a.isHaveSoulLinkHeros())for(var o=a.getSoulLinkHeroModels(),s=0;s<o.length;s++){o[s].isCampConverted()&&e++}}return e},canCampJoin:function(t,e,i){var n=r.default.getInstance().getHeroBySId(t).isCampConverted();if(e){var a=this._battleArray.getBattleArrayData();if(a[i]){var o=a[i].getMercenarySId();if(r.default.getInstance().getHeroBySId(o).isCampConverted())return!0;if(!n)return!0}}return!n||this.getCampConvertCount()<d.default.getInstance().getCampLimit()},canCampJoinSoulLink:function(t,e){var i=r.default.getInstance().getHeroBySId(t).isCampConverted(),n=this._battleArray.getBattleArrayData(),a=null;if(n[e]){var o=n[e].getSoulLink();o[0]&&(a=r.default.getInstance().getHeroBySId(o[0]))}if(a){if(a.isCampConverted())return!0;if(!i)return!0}return!i||this.getCampConvertCount()<d.default.getInstance().getCampLimit()}},cc._RF.pop()},{"../../../TS/Common/ResonancesEnum":"ResonancesEnum","../../Camp/Manager/CampManager":"CampManager","../../CrossCup/Manager/CrossCupManager":"CrossCupManager","../../DivinePosition/Manager/DivinePositionManager":"DivinePositionManager","../../Equip/Manager/EquiptManager":"EquiptManager","../../Gacha/Manager/GachaManager":"GachaManager","../../Gem/Manager/GemstoneManager":"GemstoneManager","../../Hero/Manager/HeroManager":"HeroManager","../../HeroArtifact/Manager/HeroArtifactManager":"HeroArtifactManager","../../Immortal/Manager/ImmortalManager":"ImmortalManager","../../Manual/Manager/ManualManager":"ManualManager","../../Nation/Manager/NationMainManager":"NationMainManager","../../Pet/Manager/PetManager":"PetManager","../../Spirit/Manager/SpiritManger":"SpiritManger","../../Title/Manager/TitleManger":"TitleManger","../../Treasure/Manager/TreasureManger":"TreasureManger","../../Treasure/Model/SpecialAttributeEnum":"SpecialAttributeEnum",BattleArray:"BattleArray",BattleArrayEntity:"BattleArrayEntity",BattleArrayItemModel:"BattleArrayItemModel",EquipModel:"EquipModel",PveLoader:"PveLoader",ResourceId:void 0,TreasureEnum:"TreasureEnum"}],BattleArrayRedPointManager:[function(t,e,i){"use strict";cc._RF.push(e,"1cf58yi2K9AyY+3cTCsZa00","BattleArrayRedPointManager");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../Hero/Manager/HeroManager"));td.BattleArrayRedPointManager={_battleRedPoint:null,init:function(){this.destroyData(),this._addEventListener()},destroyData:function(){this._battleRedPoint={}},_addEventListener:function(){},getBattleRedPoint:function(){return this._battleRedPoint},getBattleRedPointByIndex:function(t){return this._battleRedPoint[t]||{}},getHeroFriendRedPoint:function(){var t=this._battleRedPoint;return t&&t.friend?t.friend:{}},isBattleAddRedPoint:function(){var t=this._battleRedPoint;if(!t||0===t.myLen())return!1;if(this.isHeroFriendAddRedPoint())return!0;for(var e=td.MaxEnum.MaxBattleHeroCount,i=1;i<=e;i++)if(this.isHeroAddRedPoint(i))return!0;return!1},_loopCheck:function(t){if(!t)return!1;var e=!1;for(var i in t){if(e)break;var n=t[i];if("boolean"==typeof n&&!0===n){e=!0;break}"object"==typeof n&&n.myLen()>0&&(e=this._loopCheck(n))}return e},isHeroFriendAddRedPoint:function(){var t=this._battleRedPoint.friend;return!(!t||0===t.myLen())&&t.add},getHeroAssistantRedPoint:function(t){var e=this._battleRedPoint;return e&&e[t]&&e[t].hero&&e[t].hero.assistant?e[t].hero.assistant:{}},isHeroAddRedPoint:function(t,e){var i=!1,n=this._battleRedPoint;if(!n||!n[t])return i;var a=n[t].hero;return a?!(!a.haveHero&&!a.putOn)&&(e?a&&a[e]&&(!0===a[e]||a[e].myLen()>0)&&(i=!0):(i=a.add,(this.isAutoEquipAddRedPoint(t)||this.isEquipMasterAddRedPoint(t)||this.isGemstoneAddRedPoint(t)||this.isGemAddRedPoint(t)||this.isDragonArtifactAddRedPoint(t))&&(i=!0)),i):i},isAutoEquipAddRedPoint:function(t){var e=this._battleRedPoint;if(!e||!e[t])return!1;var i=e[t].equip;return!(!i||0===i.myLen())&&i.autoEquip},isEquipMasterAddRedPoint:function(t,e){var i=this._battleRedPoint;if(!i||!i[t])return!1;var n=i[t].equip;return!(!n||0===n.myLen())&&(e?n[e]:n.upgradeMaster||n.evolveMaster)},isEquipAddRedPoint:function(t,e){var i=this._battleRedPoint;if(!i||!i[t])return!1;var n=i[t].equip;if(!n||0===n.myLen())return!1;for(var a=td.MaxEnum.MaxEquipCount,r=1;r<=a;r++)if(n[r]&&n[r][e])return!0;return!1},getEquipRedPoint:function(t){var e=this._battleRedPoint;return e&&e[t]&&e[t].equip?e[t].equip:{}},isGemstoneAddRedPoint:function(t){var e=this._battleRedPoint;if(!e||!e[t])return!1;var i=e[t].gemstone;return!(!i||0===i.myLen())&&i.add},getGemstoneRedPoint:function(t){var e=this._battleRedPoint;return e&&e[t]&&e[t].gemstone?e[t].gemstone:{}},isGemAddRedPoint:function(t){if(td.GemManager.canGemCompose())return!0;var e=this._battleRedPoint;if(!e||!e[t])return!1;var i=e[t].gem;if(!i||0===i.myLen())return!1;for(var n in i)if(i[n])return!0;return!1},getGemRedPoint:function(t){var e=this._battleRedPoint;return e&&e[t]&&e[t].gem?e[t].gem:{}},isDragonArtifactAddRedPoint:function(t){var e=this._battleRedPoint;if(!e||!e[t])return!1;var i=e[t].artifact;if(!i||0===i.myLen())return!1;for(var n in i)if(i[n])return!0;return!1},getDragonArtifactRedPoint:function(t){var e=this._battleRedPoint;return e&&e[t]&&e[t].artifact?e[t].artifact:{}},_calcBattleArray:function(){td.BattleArrayManager.getBattleArrayData()&&(this._battleRedPoint={},this._calcBattleHero(),this._calcBattleEquip(),this._calcBattleGemstone(),this._calcBattleGem(),this._calcBattleArtifact(),td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE))},_calcBattleHero:function(){if(td.BattleArrayManager.getBattleArrayData()){for(var t=td.MaxEnum.MaxBattleHeroCount,e=1;e<=t;e++)this._calcHeroData(e);this._calcBattleFriend(),td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}},_calcBattleFriend:function(){if(td.BattleArrayManager.getBattleArrayData()){var t=this._battleRedPoint;t.friend={};var e=td.UnlockManager,i=td.ActorUnlockType.REINFORCEMENT;if(e.isTargetUnlock(i,1)){var n=td.BattleArrayManager.getFriendList(),a=td.MaxEnum,r=td.BattleArrayManager.haveCanReplaceMercenary(td.ReplaceMercenaryType.Friend);t.friend.add=!1;for(var o=a.MaxBattleFriendCount,s=1;s<=o;s++)e.isTargetUnlock(i,s)&&!n[s]&&r&&(t.friend.add=!0,t.friend[s]=!0);td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}}},_calcHeroData:function(t){var e=td.BattleArrayManager,i=(td.MaxEnum,td.UnlockManager),a=td.ActorUnlockType,r=e.getBattleArrayData();if(r){var o=this._battleRedPoint,s=r[t];if(o[t]||(o[t]={}),o[t].hero={},o[t].hero.add=!1,i.isTargetUnlock(a.FORMATION,t)){var l=s?s.getMercenarySId():null;if(o[t].hero.haveHero=!!l,!l&&e.haveCanReplaceMercenary(td.ReplaceMercenaryType.BattleArray))o[t].hero.add=!0,o[t].hero.putOn=!0;else if(l){var c=n.default.getInstance().getHeroBySId(l);this._canMercenaryUpgrade(c)&&(o[t].hero.add=!0,o[t].hero.upgrade=!0),this._canMercenaryEvolve(c)&&(o[t].hero.add=!0,o[t].hero.evolve=!0),this._canMercenaryAwake(c)&&(o[t].hero.add=!0,o[t].hero.awake=!0)}}}},_calcAllHeroCanUpgrade:function(){var t=td.BattleArrayManager,e=td.MaxEnum,i=t.getBattleArrayData();if(i){for(var a=this._battleRedPoint,r=e.MaxBattleHeroCount,o=1;o<=r;o++){var s=i[o];if(s){var l=s.getMercenarySId();if(l){var c=n.default.getInstance().getHeroBySId(l);this._canMercenaryUpgrade(c)?(a[o]||(a[o]={}),a[o].hero||(a[o].hero={}),a[o].hero.add=!0,a[o].hero.upgrade=!0):a[o]&&a[o].hero&&a[o].hero.upgrade&&(a[o].hero.upgrade=!1)}}}td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}},_calcAllHeroCanEvolve:function(){var t=td.BattleArrayManager,e=td.MaxEnum,i=t.getBattleArrayData();if(i){for(var a=this._battleRedPoint,r=e.MaxBattleHeroCount,o=1;o<=r;o++){var s=i[o];if(s){var l=s.getMercenarySId();if(l){var c=n.default.getInstance().getHeroBySId(l);this._canMercenaryEvolve(c)?(a[o]||(a[o]={}),a[o].hero||(a[o].hero={}),a[o].hero.add=!0,a[o].hero.evolve=!0):a[o]&&a[o].hero&&a[o].hero.evolve&&(a[o].hero.evolve=!1)}}}td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}},_calcAllHeroCanAwake:function(){var t=td.BattleArrayManager,e=td.MaxEnum,i=t.getBattleArrayData();if(i){for(var a=this._battleRedPoint,r=e.MaxBattleHeroCount,o=1;o<=r;o++){var s=i[o];if(s){var l=s.getMercenarySId();if(l){var c=n.default.getInstance().getHeroBySId(l);this._canMercenaryAwake(c)?(a[o]||(a[o]={}),a[o].hero||(a[o].hero={}),a[o].hero.add=!0,a[o].hero.awake=!0):a[o]&&a[o].hero&&a[o].hero.awake&&(a[o].hero.awake=!1)}}}td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}},_calcBattleEquip:function(){if(td.BattleArrayManager.getBattleArrayData()){for(var t=td.MaxEnum.MaxBattleHeroCount,e=1;e<=t;e++)this._calcEquipData(e);td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}},_calcEquipData:function(t){var e=td.BattleArrayManager,i=td.MaxEnum,n=e.getBattleArrayData();if(n){var a=this._battleRedPoint;a[t]||(a[t]={}),a[t].equip={},a[t].equip.autoEquip=!1,a[t].equip.upgradeMaster=!1,a[t].equip.evolveMaster=!1;var r=n[t];if(r){for(var o=r.getEquipList(),s=0,l=!1,c=!1,u=0,d=i.MaxEquipCount,h=1;h<=d;h++){var p=e.haveCanReplaceEquipByType(h),_=o[h];if(!_&&p)a[t].equip[h]=!0,a[t].equip.autoEquip=!0;else if(_){a[t].equip[h]={},s++;var g=td.EquipManager.getEquipBySId(_),f=this._canEquipUpgrade(g);(0===u||g.getLevel()<u)&&(u=g.getLevel(),l=f===td.EquipUpgradeStatus.CanUpgrade),a[t].equip[h].upgrade=f,this._canEquipEvolve(g)&&(a[t].equip[h].evolve=!0,c=!0)}}a[t].equip.upgradeMaster=l,a[t].equip.evolveMaster=s===i.MaxEquipCount&&c}}},_calcAllEquipCanUpgrade:function(){var t=td.BattleArrayManager,e=td.MaxEnum,i=t.getBattleArrayData();if(i){for(var n=this._battleRedPoint,a=e.MaxBattleHeroCount,r=1;r<=a;r++){var o=i[r];if(o){var s=o.getEquipList();if(s&&0!==s.myLen()){var l=!1,c=0;for(var u in s){var d=td.EquipManager.getEquipBySId(s[u]),h=this._canEquipUpgrade(d);(0===c||d.getLevel()<c)&&(c=d.getLevel(),l=h===td.EquipUpgradeStatus.CanUpgrade),n[r]||(n[r]={}),n[r].equip||(n[r].equip={}),n[r].equip[u]||(n[r].equip[u]={}),n[r].equip[u].upgrade=h}l&&(n[r].equip.upgradeMaster=!0)}}}td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}},_calcAllEquipCanEvolve:function(){var t=td.BattleArrayManager,e=td.MaxEnum,i=t.getBattleArrayData();if(i){for(var n=this._battleRedPoint,a=e.MaxBattleHeroCount,r=1;r<=a;r++){var o=i[r];if(o){var s=o.getEquipList();if(s&&0!==s.myLen()){var l=0,c=!1;for(var u in s){var d=td.EquipManager.getEquipBySId(s[u]);l++,this._canEquipEvolve(d)?(n[r]||(n[r]={}),n[r].equip||(n[r].equip={}),n[r].equip[u]||(n[r].equip[u]={}),n[r].equip[u].evolve=!0,c=!0):n[r]&&n[r].equip&&n[r].equip[u]&&n[r].equip[u].evolve&&(n[r].equip[u].evolve=!1)}l===e.MaxEquipCount&&c&&(n[r].equip.evolveMaster=!0)}}}td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}},_calcBattleGemstone:function(){if(td.BattleArrayManager.getBattleArrayData()){for(var t=td.MaxEnum.MaxBattleHeroCount,e=1;e<=t;e++)this._calcGemstoneData(e);td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}},_calcGemstoneData:function(t){var e=td.BattleArrayManager,i=td.MaxEnum,n=td.UnlockManager,a=td.ActorUnlockType.Gemstone,r=e.getBattleArrayData();if(r){var o=this._battleRedPoint;o[t]||(o[t]={});var s=r[t],l=s?s.getGemstoneList():{},c=e.haveCanReplaceGemstone(t);o[t].gemstone={},o[t].gemstone.add=!1;for(var u=i.MaxGemstoneCount,d=1;d<=u;d++)n.isTargetUnlock(a,d)&&!l[d]&&c&&(o[t].gemstone.add=!0,o[t].gemstone[d]=!0)}},_calcBattleGem:function(){if(td.BattleArrayManager.getBattleArrayData()){for(var t=td.MaxEnum.MaxBattleHeroCount,e=1;e<=t;e++)this._calcGemData(e);td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}},_calcGemData:function(t){var e=td.BattleArrayManager,i=td.MaxEnum,n=td.UnlockManager,a=td.ActorUnlockType.GEM,r=e.getBattleArrayData();if(r){var o=this._battleRedPoint;o[t]||(o[t]={});var s=r[t],l=s?s.getGemList():{};o[t].gem={};for(var c=i.MaxGemCount,u=td.GemType,d=1;d<=c;d++)if(n.isTargetUnlock(a,d)){var h=l[d],p=h?td.GemManager.getGemDataBySId(h):null;if(p){var _=p.getType(),g=p.getLevel();o[t].gem[d]=td.GemManager.haveHighLevelGem(_,g)}else for(var f in o[t].gem[d]=!1,u){var v=u[f];if(!e.isExistGemWithGemType(t,d,v)&&td.GemManager.haveHighLevelGem(v)){o[t].gem[d]=!0;break}}}}},_calcBattleArtifact:function(){if(td.BattleArrayManager.getBattleArrayData()){for(var t=td.MaxEnum.MaxBattleHeroCount,e=1;e<=t;e++)this._calcArtifactData(e);td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_ARRAY_RED_POINT_CHANGE)}},_calcArtifactData:function(t){var e=td.BattleArrayManager,i=td.MaxEnum,n=td.UnlockManager,a=td.ActorUnlockType.DragonArtifact,r=e.getBattleArrayData();if(r){var o=this._battleRedPoint;o[t]||(o[t]={});var s=r[t],l=s?s.getDragonArtifactList():{};o[t].artifact={};for(var c=i.MaxDragonArtifactCount,u=e.haveCanReplaceArtifact(t),d=1;d<=c;d++)if(n.isTargetUnlock(a,d)){var h=l[d],p=h?td.DragonArtifactManager.getDragonArtifactDataBySId(h):null;o[t].artifact[d]=p?e.haveCanReplaceArtifact(t,p):u}}},_calcCanUpgrade:function(){this._calcBattleHero(),this._calcBattleGemstone(),this._calcBattleGem(),this._calcBattleArtifact(),this._calcAllEquipCanUpgrade(),this._calcAllHeroCanUpgrade()},_itemChange:function(t){for(var e=td.ItemForCheckType,i=0;i<t.length;i++){var n=t[i];n===e.HeroUpgrade?this._calcAllHeroCanUpgrade():n===e.HeroEvolve||n===e.HeroRelife?this._calcAllHeroCanEvolve():n===e.EquipUpgrade?this._calcAllEquipCanUpgrade():n===e.EquipEvolve?this._calcAllEquipCanEvolve():n===e.HeroAwake&&this._calcAllHeroCanAwake()}},_canMercenaryUpgrade:function(t){var e=td.Account.getUserData(),i=e?e.level:0,n=t.getLevel();if(n>=i)return!1;for(var a=td.ItemEnum,r=td.ItemManager,o=td.MercenaryManager.getUpgradeLevelData(t.getId(),n),s=o?o.getNeedExp()-t.getLevelExp():0,l=0,c=a.HeroExpItem2;c<=a.HeroExpItem6;c++){for(var u=r.seekItemDataById(c),d=0;d<u.length;d++){var h=u[d],p=h.getCount();p>0&&(l+=p*h.getEffectValue())}if(l>0&&l>=s)return!0}return!1},_canMercenaryEvolve:function(t){var e=td.ItemManager,i=t.getEvolveLevel()+1,n=t.getRelifeType();if(2===n)return!1;if(i>td.GetConfig("HeroEvolveLevelLimit")){for(var a=td.GetTableClass(td.TableEnum.MercenaryRelifeConfig).getRelifeCost(t.getId()),r=0;r<a.length;r++){var o=a[r];if(e.getItemNumById(o[1])<o[2])return!1}return!0}for(var s=td.EvolveManager.getMercenaryEvolveConfig(t.getQuality(),n,i),l=s.getCost(),c=(r=0,l.length);r<c;r++){var u=l[r];if(e.getItemNumById(u.getId())<u.getCount())return!1}var d=td.GoodsSubType,h=s.getDevour(),p=h[0][0],_=h[0][1],g=!1,f=0,v=td.MercenaryManager.getMercenaryData(),m=e.getItemsData();for(var y in v){var E=v[y];if(!(E.getQuality()!==p||E.isEquipped()||E.isReinforcementsed()||E.isAssistanted()||E.isProtector()||E.getTotalEvolveLevel()>0||E.getTotalAwakeLevel()>0)&&++f>=_){g=!0;break}}if(!g)for(var y in m){var T=m[y];if(T.getGoodsSubType()===d.MERCENARY_EVOLVE_REPLACE&&T.getQuality()===p&&(f+=T.getCount())>=_){g=!0;break}}return g},_canMercenaryAwake:function(t){if(!t||!t.canAwake())return!1;var e=td.ItemManager,i=t.getAwakenData();if(!i)return!1;if(i.isFull())return!1;var n=i.getNextData();if(!n)return!1;for(var a=n.getCost(),r=0,o=a.length;r<o;r++){var s=a[r];if(e.getItemNumById(s.getId())<s.getCount())return!1}var l=n.getDevour();if(l&&l[0]){var c=l[0][0],u=l[0][1],d=td.MercenaryManager.getMercenaryData(),h=0;if(d&&d.myLen()>0)for(var p in d){var _=d[p];if(!(_.getId()!==c||_.isEquipped()||_.isReinforcementsed&&_.isReinforcementsed()||_.isAssistanted&&_.isAssistanted()||_.isProtector&&_.isProtector()||_.getEvolveLevel&&_.getEvolveLevel()>0||_.getTotalAwakeLevel()>0)&&(h+=1)>=u)return!0}return!1}return!0},_canEquipUpgrade:function(t){var e=td.EquipUpgradeStatus,i=td.Account.getUserData().level;if(t.getLevel()>=i)return e.FullLevel;var n=td.EquipManager.getUpgradeCost(t.getEquipType(),t.getQuality(),t.getLevel());return!n||td.ItemManager.getItemNumById(n.getId())<n.getCount()?e.GoldUnEnough:e.CanUpgrade},_canEquipEvolve:function(t){var e=t.getEvolveLevel();if(e>=td.EvolveManager.getMaxEvolveLevel(td.GoodsType.Type_Equip,t.getQuality()))return!1;e+=1;var i=td.ItemManager,n=td.EvolveManager.getEquipEvolveConfig(t.getQuality(),e);if(!n)return!1;for(var a=n.getCost(),r=0,o=a.length;r<o;r++){var s=a[r];if(i.getItemNumById(s.getId())<s.getCount())return!1}var l=td.GoodsSubType,c=n.getDevour(),u=c[0][0],d=c[0][1],h=!1,p=0,_=td.EquipManager.getEquipData(),g=i.getItemsData();for(var f in _){var v=_[f];if(!(v.getQuality()!==u||v.isEquipped()||v.getEvolveLevel()>0||v.getTotalAwakeLevel()>0)&&++p>=d){h=!0;break}}if(!h)for(var f in g){var m=g[f];if(m.getGoodsSubType()===l.EQUIPMENT_EVOLVE_REPLACE&&m.getQuality()===u&&(p+=m.getCount())>=d){h=!0;break}}return h}},cc._RF.pop()},{"../../Hero/Manager/HeroManager":"HeroManager"}],BattleArray:[function(t,e,i){"use strict";cc._RF.push(e,"837ecs/lghIea87bIR+HHtL","BattleArray");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../Hero/Manager/HeroManager"));var a=t("Model"),r=cc.Class({extends:a,properties:{_curArray:null,_soulLinkCount:null},ctor:function(){this._curArray={},this._soulLinkCount=0,this.init("BattleArray")},setSoulLinkCount:function(t){this._soulLinkCount=t},getSoulLinkCount:function(){return this._soulLinkCount},getCanLineUpOrderId:function(){for(var t=1;t<=td.MaxEnum.MaxBattleHeroCount;t++)if(!this._curArray[t])return t;return 0},getBattleEntityBySid:function(t){for(var e in this._curArray){var i=this._curArray[e];if(i.getMercenarySId()===t)return i}return null},getBattleEntityByOrderId:function(t){return this._curArray[t]?this._curArray[t]:null},getSoulLinkModelByOrderId:function(t){return this._curArray[t]?this._curArray[t].getSoulLinkModel():null},updateBattleEntity:function(t){var e=t.getOrderId();this._curArray[e]=t},delBattleEntity:function(t){delete this._curArray[t]},getBattleArrayData:function(){return this._curArray},getIndexByEquipSid:function(t){if(0==t)return-1;var e=this._curArray;for(var i in e){var a=e[i],r=a.getEquipList();for(var o in r){var s=r[o];if(t==s)return parseInt(i);var l=n.default.getInstance().getHeroBySId(a.getMercenarySId());if(l.isHaveSoulLinkHeros())for(var c=l.getSoulList(),u=0;u<c.length;u++){if(c[u]===s)return parseInt(i)}}}return-1},getIndexByMercenarySid:function(t){if(0==t)return-1;var e=this._curArray;for(var i in e){var a=e[i];if(a.getMercenarySId()===t)return parseInt(i);var r=n.default.getInstance().getHeroBySId(a.getMercenarySId());if(r.isHaveSoulLinkHeros())for(var o=r.getSoulList(),s=0;s<o.length;s++){if(o[s]===t)return parseInt(i)}}return-1},getIndexByGemSid:function(t){if(0==t)return-1;var e=this._curArray;for(var i in e){var n=e[i].getGemList();for(var a in n){if(t==n[a])return parseInt(i)}}return-1},getIndexByDragonArtifactSid:function(t){if(0==t)return-1;var e=this._curArray;for(var i in e){var n=e[i].getDragonArtifactList();for(var a in n){if(t==n[a])return parseInt(i)}}return-1},getEquipListByIndex:function(t){return this._curArray[t]&&this._curArray[t].getEquipList?this._curArray[t].getEquipList():null},getIndexByGemstoneSid:function(t){if(0==t)return-1;var e=this._curArray;for(var i in e){var n=e[i].getGemstoneList();for(var a in n){if(t==n[a])return i}}return-1},getFightPowerByIndex:function(t){var e=td.GetConfig("FIGHT_POWER_EXPRESSION"),i=td.BattleArrayManager.getTotalAttrByOrderId(t);return td.GlobalFunction.calculateExpression(e,i)},getBattleMercenaryAtkType:function(t){var e=this._curArray[t];if(null===e||void 0===e)return 0;var i=n.default.getInstance().getHeroBySId(e.getMercenarySId());return i?i.getAttackType():0},getBattleArrayAttrByType:function(t,e){var i=td.AttrType;return e<i.Attack||e>i.SkillHurtPrecent?(cc.log("getBattleArrayAttrByType error for type = "+e),0):e===i.Attack||e===i.HP||e===i.PhysicalDefence||e===i.MagicDefence?this.getMainAttrByType(t,e):this.getOtherAttrByIndex(t,e)},getAttackByIndex:function(t){var e=td.AttrType.Attack;return this.getMainAttrByType(t,e)},getHPByIndex:function(t){var e=td.AttrType.HP;return this.getMainAttrByType(t,e)},getMainAttrByType:function(t,e){var i=td.PercentNumberUtil.getPercentValue,n=this._getMercenaryAttr(t,e);return n+=this.getEquipAttrByIndex(t,e),n+=i(n,this.getGemstoneAddPerByIndex(t,e))},getOtherAttrByIndex:function(t,e){var i=this._getMercenaryAttr(t,e);return i+=this.getEquipAttrByIndex(t,e),i+=this.getArtifactAddValueByIndex(t,e),i+=this.getGemstoneAddPerByIndex(t,e),i+=this.getGemstoneAddAttrByIndex(t,e),i+=this.getEquipAddByIndex(t,e),i+=this._getReinforcementsAdd(e)},getEquipAttrByIndex:function(t,e){var i=this._curArray[t];return null===i||void 0===i?0:i.getEquipAttr(e)},getEquipAddByIndex:function(t,e){var i=this._curArray[t];return null===i||void 0===i?0:i.getEquipAddByIndex(e)},_getMercenaryAttr:function(t,e){var i=this._curArray[t];if(null===i||void 0===i)return 0;var a=n.default.getInstance().getHeroBySId(i.getMercenarySId());return a?a.getAttrByType(e):0},_getReinforcementsAdd:function(t){return td.BattleArrayManager.getReinforcementsAdd(t)},getGemstoneAddPerByIndex:function(t,e){var i=this._curArray[t];return null===i||void 0===i?0:i.getGemstoneAddPer(e)},getGemstoneAddAttrByIndex:function(t,e){var i=this._curArray[t];return null===i||void 0===i?0:i.getGemstoneAttr(e)},getTitleAddPer:function(t){return 0},getArtifactAddValueByIndex:function(t,e){var i=this._curArray[t];return null===i||void 0===i?0:i.getArtifactAddValue(e)},getArtifactAddPerByIndex:function(t,e){var i=this._curArray[t];return null===i||void 0===i?0:i.getArtifactAddPer(e)}});e.exports=r,cc._RF.pop()},{"../../Hero/Manager/HeroManager":"HeroManager",Model:"Model"}],BattleAssistant:[function(t,e,i){"use strict";cc._RF.push(e,"95613Oo6lpJjZPtHU17WYg0","BattleAssistant");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../Hero/Manager/HeroManager"));var a=t("Model"),r=t("AssistRelation"),o=cc.Class({extends:a,properties:{_mercenarySId:null,_assistRelation:null,_assistantList:null},ctor:function(){this._mercenarySId=0,this._assistRelation={},this._assistantList={},this.init("BattleAssistant")},getAssistMercenaryCount:function(){return this._assistantList.myLen()},getAssistMercenaryCountByFeature:function(t){var e=0;for(var i in this._assistantList){var a=this._assistantList[i],r=n.default.getInstance().getHeroBySId(a);r&&r.getFeatures()==t&&e++}return e},getAssistantList:function(){return this._assistantList},getAssistRelation:function(){return this._assistRelation},updateAssistRelation:function(t){this._assistRelation={},this._mercenarySId=t;var e=n.default.getInstance().getHeroBySId(t);if(e)for(var i=e.getAssistantIds(),a=0;a<i.length;a++){var o=i[a],s=new r;s.init(td.GetTableClass(td.TableEnum.MercenaryAssistantConfig).getAssistantDataById(o)),s&&(this._assistRelation[o]=s)}else cc.log("updateAssistRelation error for id : "+t)},updateAssistMercenary:function(t){this._assistantList=t,this.checkAllRelation()},_getTotalAddPer:function(t){var e=this._assistRelation,i=0;for(var n in e){var a=e[n];if(a.isActive())for(var r=a.getEffect(),o=0;o<r.length;o++){var s=r[o];if(s[0]==t)i+=td.SkillEffectManager.getSkillEffect(s[0],s[1]).getOperateValue()}}return i},_getTotalAddValue:function(t){var e=this._assistRelation,i=0;for(var n in e){var a=e[n];if(a.isActive())for(var r=a.getAddValue(),o=0;o<r.length;o++){var s=r[o];s[0]==t&&(i+=s[1])}}return i},checkAllRelation:function(){var t=this._assistRelation;for(var e in t){var i=t[e],n=i.getActiveType(),a=i.getActiveValue();i.setActive(this._checkRelationActive(n,a))}},_checkRelationActive:function(t,e){if(t==td.AssistRelationType.Count)return this.getAssistMercenaryCount()>=e;if(t==td.AssistRelationType.Feature){var i=e[0];return this.getAssistMercenaryCountByFeature(i)>=e[1]}if(t==td.AssistRelationType.Id){for(var a in this._assistantList){var r=this._assistantList[a],o=n.default.getInstance().getHeroBySId(r);if(o&&o.getId()==e)return!0}return!1}}});e.exports=o,cc._RF.pop()},{"../../Hero/Manager/HeroManager":"HeroManager",AssistRelation:"AssistRelation",Model:"Model"}],BingCi:[function(t,e,i){"use strict";cc._RF.push(e,"8e42cReigBKdKrOFnJ+m+qh","BingCi");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="BingCi";for(var e=this.node.getComponent(cc.Animation).getClips(),i=0,n=e.length;i<n;i++)e[i]&&(e[i].wrapMode=cc.WrapMode.Normal)}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],BingDongZhiLi:[function(t,e,i){"use strict";cc._RF.push(e,"16ed8KhzotK0rrs3Bm+M42U","BingDongZhiLi");var n=t("BaseBossSkill"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="BingDongZhiLi"},effect:function(){if(cc.isValid(this._owner))for(var t=Math.abs(this._dataModel.getDamageRange()),e=a.getTowerArrayWithoutPet(),i=td.GlobalFunction.getRandomArrayElements(e,t),n=0;n<i.length;n++){var r=i[n],o=Math.floor(r._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),s=r.getComponent(td.PveEnum.PVE_HERO_SCRIPT[o]);this.addBuffToTower(s)}else this.removeSelf()},addBuffToTower:function(t){var e=this._dataModel.getAttackEffect()[0],i={buffType:e[0],buffData:e[1]/1e4,buffTime:e[2]/1e3,buffKey:this._skillName};t.addTowerBuff(i)}});e.exports=r,cc._RF.pop()},{BaseBossSkill:"BaseBossSkill",PveFightManager:"PveFightManager"}],BingFengZhiLi:[function(t,e,i){"use strict";cc._RF.push(e,"c22c3Zxcu5LwIb/BfSln3Or","BingFengZhiLi");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="BingFengZhiLi";var e=this.node.getComponent(cc.Animation);e.on("finished",this.playLoop,this),e.play(e.defaultClip.name).wrapMode=cc.WrapMode.Normal},playLoop:function(){var t=this.node.getComponent(cc.Animation);t.off("finished",this.playLoop,this);var e=t.getClips();t.play(e[1].name).wrapMode=cc.WrapMode.Loop},playEnd:function(){var t=this.node.getComponent(cc.Animation);t.on("finished",this.onAnimaFinished,this);var e=t.getClips();t.play(e[2].name).wrapMode=cc.WrapMode.Normal},onAnimaFinished:function(){this.node.getComponent(cc.Animation).off("finished",this.onAnimaFinished,this),this.removeSelf()},updateContinueTime:function(t){this._animationContinueTime-=t*this._curSpeedMult,this._animationContinueTime<=0&&(this.unschedule(this.updateContinueTime),this.playEnd())},calcHurt:function(){if(this._curTargetEnemy&&cc.isValid(this._curTargetEnemy)){var t=this._dataModel.getSkillPower(),e=this._curHeroAttackPower*t,i=this._cutHurtType,n=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),a=this._curTargetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[n]);if(!a.bDeath()){for(var r=this._dataModel.getAttackEffect(),o=0,s=r.length;o<s;o++){var l=r[o];l[0]===td.PveEnum.PVE_EFFECT_TYPE.PureHurt1&&(e+=l[1])}a.setHurt(this._heroSid,e,i,this._attackerVocation),this.setAttackEffectToEnemy(this._curTargetEnemy)}}}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],BingShuangDaDi:[function(t,e,i){"use strict";cc._RF.push(e,"89f85bhO2VEtKyrkgjlObxy","BingShuangDaDi");var n=t("BaseBossSkill"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="BingShuangDaDi"},effect:function(){if(cc.isValid(this._owner)){var t=Math.abs(this._dataModel.getDamageRange()),e=a.getTowerArrayWithoutPet();t>=e.length?e:td.GlobalFunction.getRandomArrayElements(e,t);for(var i=0;i<e.length;i++){var n=e[i],r=Math.floor(n._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),o=n.getComponent(td.PveEnum.PVE_HERO_SCRIPT[r]);this.addBuffToTower(o)}}else this.removeSelf()},addBuffToTower:function(t){var e=this._dataModel.getAttackEffect()[0],i={buffType:e[0],buffData:e[1]/1e4,buffTime:e[2]/1e3,buffKey:this._skillName};t.addTowerBuff(i)}});e.exports=r,cc._RF.pop()},{BaseBossSkill:"BaseBossSkill",PveFightManager:"PveFightManager"}],BirdBridgeBlessProgressTable:[function(t,e,i){"use strict";cc._RF.push(e,"9888biw/GdCxru5SFmO4EJe","BirdBridgeBlessProgressTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"BirdBridgeBlessProgressTable",properties:{_tblName:"activity_bird_bridge_progress_config",_progressData:null,_maxDot:null},init:function(){this._progressData={},this._maxDot=0;for(var t=this._progressData,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;this._maxDot=Math.max(this._maxDot,a.blessingDot),t[r]=t[r]||[],t[r][t[r].length]=a}},getDataByDataId:function(t){return this._progressData[t]},getMaxDot:function(){return this._maxDot}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],BirdBridgeFateRankWindow:[function(t,e,i){"use strict";cc._RF.push(e,"a4e773NAO5PE4sw2o/R45Mu","BirdBridgeFateRankWindow");var n=t("OptimizeVerticalListView"),a=t("PanelBase"),r=cc.Class({extends:a,properties:{scrollView:cc.ScrollView,labMyRank:cc.Label,labMyFate:cc.Label,labTip:cc.Label,_listViewLogic:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_BBFateRank},onLoad:function(){this._super(),this._listViewLogic=this.scrollView.getComponent(n)},getActivityController:function(){var t=td.ActivityEnum.ActivityType.MagpieBridgeParty;return td.ActivityDataManager.getActivityControllerByType(t)},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REFRESH_BB_FATE_RANK_WINDOW]=this.setRankListView,t[e.BB_MEET_ACTIVITY_END]=this.closeCallFunc,td.EventUtil.registerEvents(t,this)},onEnable:function(){this._super(),this._addEventListener(),this.labMyRank.string=td.Language.notInRank,this.labMyFate.string=0,this.labTip.string=td.Language.BirdBridgeFateRankTitle,this.node.getChildByName("labMyFateScoreT").getComponent(cc.Label).string=td.Language.BirdBridgeMyFateScore,this.node.getChildByName("imgTitleBg").getChildByName("labTitle").getComponent(cc.Label).string=td.Language.BirdBridgeFateRankHead,this.queryRankInfo()},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this)},queryRankInfo:function(){this.getActivityController().operateActivity({parmeterMap:{57:5,58:1}})},setRankListView:function(){var t=this.getActivityController(),e=t.getMyFateRankInfo(),i=t.getFateRankData();this.setMyInfo(e),this._listViewLogic.setData(i)},setMyInfo:function(t){var e=t.getRank(),i=t.getScore();this.labMyRank.string=e>0?e:td.Language.notInRank,this.labMyFate.string=i>0?i:0}});e.exports=r,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],BirdBridgeFlowerRankWindow:[function(t,e,i){"use strict";cc._RF.push(e,"c41e3LssTpIlqai+Du3R7T9","BirdBridgeFlowerRankWindow");var n=t("OptimizeVerticalListView"),a=t("PanelBase"),r=cc.Class({extends:a,properties:{labMyRank:cc.Label,labMyCharm:cc.Label,scrollView:cc.ScrollView,_listViewLogic:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_BBCharmRank},onLoad:function(){this._super(),this._listViewLogic=this.scrollView.getComponent(n)},getActivityController:function(){var t=td.ActivityEnum.ActivityType.MagpieBridgeParty;return td.ActivityDataManager.getActivityControllerByType(t)},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REFRESH_BB_CHARM_RANK_WINDOW]=this.setRankListView,t[e.BIRD_BRIDGE_ACTIVITY_END]=this.onActivityOver,td.EventUtil.registerEvents(t,this)},onEnable:function(){this._super(),this._addEventListener(),this.labMyRank.string=td.Language.notInRank,this.labMyCharm.string=0,this.node.getChildByName("labTip").getComponent(cc.Label).string=td.Language.BirdBridgeFlowerRankTitle,this.node.getChildByName("labMyCharmT").getComponent(cc.Label).string=td.Language.BirdBridgeMyFlowerScore,this.node.getChildByName("imgTitleBg").getChildByName("labTitle").getComponent(cc.Label).string=td.Language.BirdBridgeFlowerRankHead,this.queryRankInfo()},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this)},onActivityOver:function(){this.closeCallFunc()},queryRankInfo:function(){this.getActivityController().operateActivity({parmeterMap:{57:5,58:2}})},setRankListView:function(){var t=this.getActivityController().getMyCharmRankInfo();this.setMyInfo(t);var e=this.getRankRewardList();this._listViewLogic.setData(e)},getRankRewardList:function(){for(var t=[],e=this.getActivityController(),i=e.getActivityData(),n=td.GetTableClass(td.TableEnum.BirdBridgeRankTable),a=n.getMaxRankByData(i),r=1;r<=a;r++){var o={newRank:r,cfgData:n.getDataByDataIdAndRank(i,r),serverRankData:e.getFlowerRankDataByRank(r)};t.push(o)}return t},setMyInfo:function(t){var e=t.getRank(),i=t.getScore();this.labMyRank.string=e>0?e:td.Language.notInRank,this.labMyCharm.string=i>0?i:0}});e.exports=r,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],BirdBridgeMeetHelpPanel:[function(t,e,i){"use strict";cc._RF.push(e,"26f958oiJVDJL5RveldFCb3","BirdBridgeMeetHelpPanel");var n=t("AvatarHeadWidget"),a=t("PanelBase"),r=cc.Class({extends:a,properties:{labMeetName:cc.Label,playerPanel:cc.Node,commonRewardPanel:cc.Node,probabilityRewardPanel:cc.Node,playerItem:cc.Node,btnBBHelp:cc.Node,labFixedRewardTip:cc.RichText,_meetData:null},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_BirdBridgeHelp},onLoad:function(){this._super(),this.playerItem.active=!1},getActivityController:function(){var t=td.ActivityEnum.ActivityType.MagpieBridgeParty;return td.ActivityDataManager.getActivityControllerByType(t)},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REFRESH_BB_MEET_HELP_PANEL]=this.refreshPanel,t[e.BB_MEET_ACTIVITY_END]=this.closeCallFunc,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.onReceiveOperation,td.EventUtil.registerEvents(t,this)},onEnable:function(){this._super(),this._addEventListener(),this.setJoinRewards()},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this)},setData:function(t){this._super(t),this._meetData=t,this.setMeetName(),this.setJoinersPanel(),this.setBtnBBHelpState(),this.setCommonRewards()},setMeetName:function(){var t=this._meetData.getJoinersList(),e=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_LIMIT"),i=this._meetData.getBuilder().getNickNameAndServer(),n=cc.js.formatStr(td.Language.strWhoseBirdBridge,i),a=cc.js.formatStr("(%s/%s)",t.length,e);this.labMeetName.string=n+a},refreshPanel:function(){var t=this.getActivityController(),e=this._meetData.getMeetId();t.getMeetDataById(e)&&(this.setMeetName(),this.setJoinersPanel(),this.setBtnBBHelpState(),this.setCommonRewards())},setBtnBBHelpState:function(){var t=this._meetData.getJoinersList(),e=td.Account.getUserData().getGamerId();t.some(function(t,i,n){if(t.getGamerId()==e)return!0})?(td.GlobalFunction.setButtonGray(this.btnBBHelp,!0),td.GlobalFunction.setButtonTitle(this.btnBBHelp,td.Language.strHelped)):(td.GlobalFunction.setButtonGray(this.btnBBHelp,!1),td.GlobalFunction.setButtonTitle(this.btnBBHelp,td.Language.helpBirdBridge))},setJoinersPanel:function(){for(var t=this._meetData.getJoinersList(),e=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_LIMIT"),i=Math.ceil(e/2),n=0,a=0;a<2;a++)for(var r=0==a?i:e-i,o=0;o<r;o++){var s=t[n],l=this.playerPanel.getChildByName("player"+n);l||((l=cc.instantiate(this.playerItem)).active=!0,l.name="player"+n,this.playerPanel.addChild(l)),this.setJoinerInfo(l,s),n++}},setJoinerInfo:function(t,e){var i=t.getChildByName("labTip"),a=(t.getChildByName("imgBg"),t.getChildByName("labName")),r=t.getChildByName("nodeIcon");i.active=!e,a.active=!!e;var o=r.getChildByName("avatarHeadNode");e?(o?o.getComponent(n).setData(e):((o=td.GlobalFunction.createAvatarHeadWidget(9,e,!1)).name="avatarHeadNode",o.x=0,o.y=0,r.addChild(o,100)),a.getComponent(cc.Label).string=e.getNickName()):o&&(o.active=!1)},setCommonRewards:function(){var t=this,e=this._meetData.isMineBirdBridgeMeet(),i=this._meetData.getJoinersChangeStatus(),n="";e?n=td.Language.strMyMeetFixedRewardTitle:(n=td.Language.strOtherMeetFixedRewardTitle,o=r),this.labFixedRewardTip.string=n;for(var a=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_LIMIT"),r=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_END_BASE_REWARD"),o=[],s=this._meetData.getJoinersList().length,l=e?s:a,c=0,u=r.length;c<u;c++){var d=r[c],h=[];h[0]=d[0],h[1]=d[1],h[2]=d[2]*(l+1),o.push(h)}for(var p=td.RewardManager.parseRewardListDetail(o),_=function(){v=p[g];var n=t.commonRewardPanel.getChildByName("rewardIcon_"+g);n?n.getComponent("CommonIconWidget").setData(v):((n=td.GlobalFunction.createCommonIconWidget(56,v)).scale=.7,n.y=0,n.x=110*(2*g+1-f)/2,n.name="rewardIcon_"+g,t.commonRewardPanel.addChild(n)),e&&((m=n.getChildByName("effectNode"))?(m.active=i,t.pauseChangeAnimation(m),i?t.playChangeAnimation(m):t.pauseChangeAnimation(m)):gdk.rm.loadRes(null,"uiAnima/QCUI_effect/QCUI_effect",cc.Prefab,function(t){(m=td.GlobalFunction.createPrefabInstance("uiAnima/QCUI_effect/QCUI_effect")).name="effectNode",m.scale=1.1,m.getComponent(cc.Animation).on("finished",this.finishCallBack,this),n.addChild(m,999),m.active=i,i?this.playChangeAnimation(m):this.pauseChangeAnimation(m)}.bind(t)))},g=0,f=p.length;g<f;g++){var v,m;_()}},finishCallBack:function(){this._meetData.resetJoinersChangeStatus()},playChangeAnimation:function(t){t.getComponent(cc.Animation).play("QCUI_effect")},pauseChangeAnimation:function(t){t.getComponent(cc.Animation).stop("QCUI_effect")},setJoinRewards:function(){if(!(this.probabilityRewardPanel.childrenCount>0)){for(var t=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_REWARD"),e=[],i=0,n=t.length;i<n;i++){t[i][0].forEach(function(t){e.some(function(e,i,n){if(e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2])return!0})||e.push(t)})}for(var a=td.RewardManager.parseRewardListDetail(e),r=0,o=a.length;r<o;r++){var s=a[r],l=td.GlobalFunction.createCommonIconWidget(56,s);l.scale=.7,this.probabilityRewardPanel.addChild(l),l.y=0,l.x=92*(2*r+1-o)/2}}},onTryToHelpBirdBridge:function(){var t=this._meetData.getJoinersList(),e=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_LIMIT");t.length<e?this.doHelpBirdBridge():td.MessageBox.showMessage(td.Language.tooMuchHelpPeople)},onReceiveOperation:function(t){var e=this.getActivityController();if(t.activityId===e.getActivityId()){var i=t.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n)}},doHelpBirdBridge:function(){var t=this.getActivityController(),e=td.TimeUtil.getTime();if(this._meetData.getEndTime()<=e)td.MessageBox.showMessage(td.Language.helpBirdBridgeOver);else{var i=this._meetData.getMeetId();t.requestHelpBirdBridge(i)}}});e.exports=r,cc._RF.pop()},{AvatarHeadWidget:void 0,PanelBase:void 0}],BirdBridgeMeetItem:[function(t,e,i){"use strict";cc._RF.push(e,"0d262CJQVZIaL1f06ByLyK8","BirdBridgeMeetItem");var n=cc.Class({extends:cc.Component,properties:{imgFlag:cc.Node,buildNeedPanel:cc.Node,imgCostIcon:cc.Sprite,labCostCount:cc.Label,otherMeetInfo:cc.Node,labMeetName:cc.Label,labTimeDown:cc.Label,btnOperate:cc.Button,labBtnTitle:cc.Label,_itemData:null,_handleTimeDown:null},setData:function(t){this._itemData=t,this.btnOperate.clickEvents[0].customEventData=t,this.setTimeDown(),"buildBirdBridge"==t?this.setBuildInfo():this.setOtherInfo()},getActivityController:function(){var t=td.ActivityEnum.ActivityType.MagpieBridgeParty;return td.ActivityDataManager.getActivityControllerByType(t)},onEnable:function(){this._handleTimeDown=setInterval(function(){this.setTimeDown()}.bind(this),100)},onDisable:function(){this._handleTimeDown||clearInterval(this._handleTimeDown)},setTimeDown:function(){if(this._itemData&&"buildBirdBridge"!=this._itemData){var t=td.TimeUtil.getTime(),e=this._itemData.getEndTime();if(e<=t)return this._handleTimeDown||(clearInterval(this._handleTimeDown),this._handleTimeDown=null),void(this.labTimeDown.string=td.Language.end);var i=e-t,n=Math.floor(i/6e4),a=Math.floor((i-6e4*n)/1e3),r=n<10?"0"+n:n,o=a<10?"0"+a:a;this.labTimeDown.string=r+":"+o}},setOtherInfo:function(){this.buildNeedPanel.active=!1,this.otherMeetInfo.active=!0;var t=this._itemData.getBuilder(),e=this._itemData.getJoinersList(),i=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_LIMIT"),n=e.length;this.labBtnTitle.string=td.Language.goto+"("+n+"/"+i+")";var a=t.getNickName();this.labMeetName.string=cc.js.formatStr(td.Language.strWhoseBirdBridge,a);var r=td.Account.getUserData().getGamerId(),o=e.some(function(t,e,i){var n=t.getGamerId();if(r==n)return!0});this.imgFlag.active=!!o},setBuildInfo:function(){this.buildNeedPanel.active=!0,this.otherMeetInfo.active=!1,this.imgFlag.active=!1;var t=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_COST"),e=td.RewardManager.getRewardDetail(t),i=e.getLittleIconRes(),n=e.getId();td.GlobalFunction.createSpriteNode(this.imgCostIcon.node,i);var a=td.ItemManager.getItemNumById(n);this.labCostCount.string=a+"/"+t[2];var r=cc.callFunc(this.setCostPosMiddle,this),o=cc.delayTime(.05),s=cc.sequence(o,r);this.node.runAction(s),this.labBtnTitle.string=td.Language.buildBirdBridge},setCostPosMiddle:function(){var t=this.imgCostIcon.node.width/2-this.labCostCount.node.width/2;this.imgCostIcon.node.x=t,this.labCostCount.node.x=t},onOperateBirdBridge:function(){"buildBirdBridge"==this._itemData?this.doBuildBirdBridge():this.gotoHelpBirdBridge()},doBuildBirdBridge:function(){var t=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_COST"),e=t[2],i=td.RewardManager.getRewardDetail(t),n=i.getId();if(e>td.ItemManager.getItemNumById(n)){var a=i.getName();td.MessageBox.showMessage(cc.js.formatStr(td.Language.sthNoEnough,a))}else{this.getActivityController().doBuildBirdBridge()}},gotoHelpBirdBridge:function(){var t=td.TimeUtil.getTime();if(this._itemData.getEndTime()<=t)td.MessageBox.showMessage(td.Language.helpBirdBridgeOver);else{var e=this._itemData.getJoinersList(),i=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_LIMIT");if(e.length>=i)td.MessageBox.showMessage(td.Language.tooMuchHelpPeople);else{for(var n=!1,a=td.Account.getUserData().getUserId(),r=0,o=e.length;r<o;r++){if(a===e[r].getUserId()){n=!0;break}}if(n)td.MessageBox.showMessage(td.Language.theBirdBridgeHelped);else{var s={};s.panelName=td.PanelEnum.Panel_BirdBridgeHelp,s.callback={func:function(t,e){e.setData(t)},param:this._itemData},td.GlobalFunction.showPanel(s)}}}}});e.exports=n,cc._RF.pop()},{}],BirdBridgeMeetPanel:[function(t,e,i){"use strict";cc._RF.push(e,"f0f07PYLxVJbZvv5ki3l/Xe","BirdBridgeMeetPanel");var n=t("PanelBase"),a=t("UFButton"),r=t("BirdBridgeMeetItem"),o=cc.Class({extends:n,properties:{labTimeDown:cc.Label,labLeftTimes:cc.Label,contentView:cc.Node,btnLeft:cc.Node,btnRight:cc.Node,labPage:cc.Label,labTips1:cc.Label,_curPage:null,_curAllMeets:null,_beginTouchPoint:null,_isNeedUpdatePage:null},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_BirdBridgeMeet},getActivityController:function(){var t=td.ActivityEnum.ActivityType.MagpieBridgeParty;return td.ActivityDataManager.getActivityControllerByType(t)},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REFRESH_BB_MEETS_PANEL]=this.refreshPanel,t[e.BB_MEET_ACTIVITY_END]=this.closeCallFunc,t[e.SWITCH_MEET_INFO_PAGE]=this.onSwitchMeetsInfoPage,td.EventUtil.registerEvents(t,this)},onEnable:function(){this._super(),this._addEventListener(),this._curPage=1,this._curAllMeets=["buildBirdBridge"],this._isNeedUpdatePage=!1,this.setTimeDown(),this.setView(),this.setContentEvents(),this.schedule(this.updateActivityTime,1),this.labTips1.string=td.Language.Bird_Bridge_Txt1},onDisable:function(){this._super(),this.unschedule(this.updateActivityTime),td.EventUtil.unregisterAllEvents(this)},updateCurPage:function(){var t=this.getActivityController(),e=t.getLastHelpMeetId();if(e){for(var i=0,n=0,a=this._curAllMeets.length;n<a;n++){var r=this._curAllMeets[n];if("buildBirdBridge"!=r)if(r.getMeetId()==e){i=n;break}}t.resetLastHelpMeetId(),0!=i&&(this._curPage=Math.ceil((i+1)/4))}else{var o=Math.ceil(this._curAllMeets.length/4);this._curPage=this._curPage>=o?o:this._curPage}},setView:function(){this.setLeftTimes(),this.refreshMeetsData(),this.updateCurPage(),this.setSwitchButtonStatus(),this.setMeetsContentView(),this.setCurPage()},refreshPanel:function(){this.setView()},updateActivityTime:function(t){this.setTimeDown()},setTimeDown:function(){var t=this.getActivityController();if(t){var e=t.getStageTimeWithType(td.QiXiStageEnum.MagpieBridgeParty);if(e){var i=e.endTime-td.TimeUtil.getTime();i>0?this.labTimeDown.string=td.GlobalFunction.getConvertTimeStr(Math.floor(i/1e3),!0):(this.labTimeDown.string=td.Language.end,this.unschedule(this.updateActivityTime),this.closeCallFunc())}}},refreshMeetsData:function(){var t=this.getActivityController().getShowBirdBridgeMeet();this._curAllMeets=["buildBirdBridge"].concat(t)},setSwitchButtonStatus:function(){this.btnLeft.active=1!=this._curPage,this.btnRight.active=this._curPage<Math.ceil(this._curAllMeets.length/4)},setCurPage:function(){var t=Math.ceil(this._curAllMeets.length/4);this.labPage.string=this._curPage+"/"+t},doSwitchMeetsInfoPage:function(t,e){e=parseInt(e),this.onSwitchMeetsInfoPage(e)},onSwitchMeetsInfoPage:function(t){var e=this._curPage+t;e<=0||e>Math.ceil(this._curAllMeets.length/4)||(this._curPage=e,this.setSwitchButtonStatus(),this.setMeetsContentView(),this.setCurPage())},setMeetsContentView:function(){for(var t=[],e=4*(this._curPage-1);e<4*this._curPage;e++){var i=this._curAllMeets[e];if(!i)break;t.push(i)}this.setMeetsData(t)},setMeetsData:function(t){for(var e=1;e<=4;e++){var i=this.contentView.getChildByName("item_"+e);t[e-1]?(i.active=!0,this.setItemInfo(i,t[e-1])):i.active=!1}},setItemInfo:function(t,e){var i=t.getComponent(r);i&&i.setData(e)},setLeftTimes:function(){var t=this.getActivityController().getLeftTimes();this.labLeftTimes.string=t},onShowFateRankWindow:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,td.PanelEnum.Window_BBFateRank)},setContentEvents:function(){var t=this.contentView.getComponent(a);t.setTouchBeginCallBack(this.onContentViewBeginEvent.bind(this)),t.setTouchCancelCallBack(this.onContentViewCancelEvent.bind(this)),t.setTouchEndedCallBack(this.onContentViewEndEvent.bind(this)),this.contentView.x=0},onContentViewBeginEvent:function(t){return this._beginTouchPoint=t.getLocation(),!0},onContentViewCancelEvent:function(){this._isNeedUpdatePage=!1},onContentViewEndEvent:function(t){var e=t.getLocation().x-this._beginTouchPoint.x;if(this._isNeedUpdatePage=Math.abs(e)>10,this._isNeedUpdatePage){var i=e>0?-1:1;this.onSwitchMeetsInfoPage(i)}}});e.exports=o,cc._RF.pop()},{BirdBridgeMeetItem:"BirdBridgeMeetItem",PanelBase:void 0,UFButton:void 0}],BirdBridgePartyModel:[function(t,e,i){"use strict";cc._RF.push(e,"61019ejA0hDfJeaXFK5kCm+","BirdBridgePartyModel");var n=t("BaseUser"),a=cc.Class({extends:cc.Component,properties:{_builder:null,_nMeetId:null,_endTime:null,_joiners:null,_joinersIsChange:null},initData:function(t){if(this._joinersIsChange=!1,t){this._nMeetId=t.meetId,this._endTime=t.endTime;var e=t.attributes;e&&(this._builder=new n,this._builder.updateAttr(e)),this._joiners=[];var i=t.memberMap;for(var a in i)if(i.hasOwnProperty(a)){var r=i[a],o=new n;o.updateAttr(r),this._joiners.push(o)}}},refreshData:function(t){this._joiners=[];var e=t.memberMap;for(var i in e)if(e.hasOwnProperty(i)){var a=e[i],r=new n;r.updateAttr(a),this._joiners.push(r)}this.isMineBirdBridgeMeet()&&(this._joinersIsChange=!0)},resetJoinersChangeStatus:function(){this._joinersIsChange&&(this._joinersIsChange=!1)},getMeetId:function(){return this._nMeetId},getBuilder:function(){return this._builder},isMineBirdBridgeMeet:function(){return td.Account.getUserData().getGamerId()==this._builder.getGamerId()},getEndTime:function(){return this._endTime},getJoinersList:function(){return this._joiners},getJoinersChangeStatus:function(){return this._joinersIsChange}});e.exports=a,cc._RF.pop()},{BaseUser:"BaseUser"}],BirdBridgeRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"5f6c5Q98uxIX5L+h9kgrCKn","BirdBridgeRankModel");var n=t("BaseUser"),a=cc.Class({extends:cc.Component,properties:{_nRank:null,_nScore:null,_playerInfo:null},initData:function(t){if(t){this._nScore=t.score,this._nRank=t.rank;var e=t.attributes;e&&(this._playerInfo=new n(e),this._playerInfo.updateAttr(e))}},getRank:function(){return this._nRank},getScore:function(){return this._nScore},getPlayerInfo:function(){return this._playerInfo}});e.exports=a,cc._RF.pop()},{BaseUser:"BaseUser"}],BirdBridgeRankTable:[function(t,e,i){"use strict";cc._RF.push(e,"f79a4rxJ0xAt51MlQsMyV3e","BirdBridgeRankTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"BirdBridgeRankTable",properties:{_tblName:"activity_bird_bridge_rank_config",_rankData:null,_maxRank:null},init:function(){this._rankData={},this._maxRank={};for(var t=this._rankData,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];i>0&&a.data===e[i-1].data?(a.fromRank=e[i-1].rank+1,a.toRank=e[i].rank):(a.fromRank=e[i].rank,a.toRank=e[i].rank);var r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a;var o=a.rank;this._maxRank[r]=this._maxRank[r]>0?this._maxRank[r]:0,this._maxRank[r]=this._maxRank[r]<o?o:this._maxRank[r]}},getMaxRankByData:function(t){return this._maxRank[t]?this._maxRank[t]:null},getDataByDataIdAndRank:function(t,e){if(!this._rankData[t])return null;for(var i=this._rankData[t],n=0,a=i.length;n<a;n++){var r=i[n],o=r.fromRank,s=r.toRank;if(e>=o&&e<=s)return r}return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],BlessProgressRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"09efeJRidZDQoeQ8KFYrubb","BlessProgressRewardModel");var n=cc.Class({extends:cc.Component,properties:{_blessDot:null,_rewards:null,_status:null},initData:function(t){this._blessDot=t.blessingDot,this._rewards=t.rewards,this._status=td.ActivityEnum.RewardStatus.NONE},getNeedBlessDot:function(){return this._blessDot},getRewards:function(){return this._rewards},setReceiveStatus:function(t){this._status=t},getReceiveStatus:function(){return this._status}});e.exports=n,cc._RF.pop()},{}],BlessTopPlayerModel:[function(t,e,i){"use strict";cc._RF.push(e,"1ed349BLttM0KasLqelMkoG","BlessTopPlayerModel");var n=t("BaseUser"),a=cc.Class({extends:cc.Component,properties:{_nFateScore:null,_nFateTime:null,_nCharmScore:null,_nCharmTime:null,_playerInfo:null},initData:function(t){if(t){this._nFateScore=t.fateScore,this._nFateTime=t.fateArriveTime,this._nCharmScore=t.flowerScore,this._nCharmTime=t.flowerArriveTime;var e=t.attributes;e&&(this._playerInfo=new n(e),this._playerInfo.updateAttr(e))}},getFateScore:function(){return this._nFateScore},getFateTime:function(){return this._nFateTime},getCharmScore:function(){return this._nCharmScore},getCharmTime:function(){return this._nCharmTime},getPlayerInfo:function(){return this._playerInfo}});e.exports=a,cc._RF.pop()},{BaseUser:"BaseUser"}],BombEnemy:[function(t,e,i){"use strict";cc._RF.push(e,"197fcAthTNMJIGQ1UaFX8rt","BombEnemy");var n=t("BaseEnemy"),a=t("PveNodePoolManager"),r=cc.Class({extends:n,properties:{_countIndex:null},initData:function(t){this._super(t),this._countIndex=t.countIndex,cc.log("\u5f53\u524d\u662f\u7b2c"+this._countIndex+"\u4e2a\u81ea\u7206\u5175")},putToNodePool:function(){a.putEnemyToPool(this.getId(),this.node)}});e.exports=r,cc._RF.pop()},{BaseEnemy:"BaseEnemy",PveNodePoolManager:"PveNodePoolManager"}],BossSkillEffect:[function(t,e,i){"use strict";cc._RF.push(e,"a158fiUSSBLCbL5ukYhgR/i","BossSkillEffect");var n=t("PveFightObject"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_animationContinueTime:null,_dataModel:null},initData:function(t){this._dataModel=t,this._animationContinueTime=this._dataModel.getContinueTime()},onLoad:function(){this._curSpeedMult=a.getCurFightSpeedMult(),this.refreshSkillAnimationSpeed(this._curSpeedMult);var t=this.node.getComponent(cc.Animation),e=t.getClips(),i=t.play(e[0].name);3===e.length?i.wrapMode=cc.WrapMode.Normal:i.wrapMode=cc.WrapMode.Loop},onChangeSpeedMult:function(t){this._super(t),this.refreshSkillAnimationSpeed(t)},refreshSkillAnimationSpeed:function(t){for(var e=this.node.getComponent(cc.Animation),i=e.getClips(),n=0,a=i.length;n<a;n++){if(i[n])e.getAnimationState(i[n].name).speed=t}},onEnable:function(){this._super();var t=this.node.getComponent(cc.Animation);this._animationContinueTime>0?this.schedule(this.updateContinueTime,1/60):t.on("finished",this.finishedEventCallBack.bind(this));var e=this._dataModel.getSoundId();e&&e>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,e)},pause:function(){this.node.pauseAllActions(),this.node.getComponent(cc.Animation).pause(),this._animationContinueTime>0&&this.unschedule(this.updateContinueTime)},resume:function(){this.node.resumeAllActions(),this.node.getComponent(cc.Animation).resume(),this._animationContinueTime>0&&this.schedule(this.updateContinueTime,1/60)},updateContinueTime:function(t){this._bFightPause||(this._animationContinueTime-=t*this._curSpeedMult,this._animationContinueTime<=0&&(this.unschedule(this.updateContinueTime),this.timeOver()))},timeOver:function(){var t=this.node.getComponent(cc.Animation),e=t.getClips();3===e.length?(t.play(e[2].name).wrapMode=cc.WrapMode.Normal,t.on("finished",this.finishedEventCallBack.bind(this))):this.removSelf()},removSelf:function(){this.node.removeFromParent()},finishedEventCallBack:function(){var t=this.node.getComponent(cc.Animation),e=t.getClips(),i=t.currentClip;3===e.length&&(i.name===e[0].name&&(t.play(e[1].name).WrapModel=cc.WrapMode.Loop,t.on("finished",this.finishedEventCallBack.bind(this))));i.name===e[e.length-1].name&&this.removSelf()},relieve:function(){var t=this.node.getComponent(cc.Animation),e=t.getClips();3===e.length?(t.play(e[2].name).wrapMode=cc.WrapMode.Normal,t.on("finished",this.finishedEventCallBack.bind(this))):this.finishedEventCallBack()}});e.exports=r,cc._RF.pop()},{PveFightManager:"PveFightManager",PveFightObject:"PveFightObject"}],BossSkillEnemy:[function(t,e,i){"use strict";cc._RF.push(e,"be0471g+9FA0ZU1xnnS7AOg","BossSkillEnemy");t("PveLoader");var n=t("BaseEnemy"),a=t("EnemyBuffCtrlComponent"),r=t("PveSkillModel"),o=t("PveFightManager"),s=t("SpriteAnimation"),l=t("PveNodePoolManager"),c=(t("AnimationComponent"),cc.Class({extends:n,properties:{_isBattle:null,_scale:null,hpProgress:cc.ProgressBar,hpProgressNum:cc.Label,_skillDataModel:null,_skillCdTime:null,_curBloodVesselList:null,_curBossDataModel:null,_usedTime:null,_totalHurt:0,_fightTime:0},initData:function(t){this._curStatus=td.PveEnum.PVE_ENEMY_STATUS.READY,this._bTransferring=!1,this._dataModel=t,this._curHp=this._dataModel.getHp(),this._curMagicDefence=this._dataModel.getMagicDefence(),this._curPhysicsDefence=this._dataModel.getPhysicsDefence(),this._hpProgressNum=this.node.getChildByName("hpProgressNum"),this._hpProgressBar=this.node.getChildByName("hpProgressBar"),this._collisionGroup=this.node.group,this._enemyId=this._dataModel.getId(),this._curSpeedMult=o.getCurFightSpeedMult(),this._spriteEnemy&&this._spriteEnemyScript||(this._spriteEnemy=this.node.getChildByName("enemy"),this._spriteEnemyScript=this._spriteEnemy.addComponent(s),this._spriteEnemyScript.init(this._dataModel,7)),this._spriteEnemyScript.onChangeAnimationSpeed(this._curSpeedMult),this.node.getComponent(a)||this.node.addComponent(a),this._hpProgressBar&&this.refreshHpProgressBar();var e=td.GetTableClass(td.TableEnum.PveHeroFihgtShowTable).getPveHeroCfgById(this._enemyId).pveSkillId,i=td.GetTableClass(td.TableEnum.PveSkillTable).getSkillCfgDataById(e);this._skillDataModel=new r,this._skillDataModel.init(i),this._curSkillTrigger=this._skillDataModel.getTriggerCfg(),this._skillCdTime=this._skillDataModel.getCDTime(),this._totalHurt=0,this._isIgnorDistance=!0,this._bRefreshScale=!1,this._bFightPause=!1,this._usedTime=0,this._fightTime=0},onBatch:function(){},unBatch:function(){},pause:function(){this._super(),this.node.pauseAllActions(),this._spriteEnemyScript.pauseAnimation(),this._attackNode&&this._attackNode.getComponent(cc.Animation).pause()},resume:function(){this._super(),this.node.resumeAllActions(),this._spriteEnemyScript.resumeAnimation(),this._attackNode&&this._attackNode.getComponent(cc.Animation).resume()},onEnable:function(){this._super(),this._labHurt=this.node.getChildByName("labHurt"),this._labHurt.scale=.8,this._labHurt.active=!1,this._lastExeTime=Date.now()},setAnimaSclae:function(t){this._scale=t,this._spriteEnemy.scale=t},playSpawnAction:function(){},update:function(t){this._bFightPause||(this._usedTime+=t*this._curSpeedMult,o.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.FIHGT&&(this._fightTime+=t*this._curSpeedMult,this._skillCdTime>0&&(this._skillCdTime-=t*this._curSpeedMult),this._skillCdTime<=0&&(this.startReleaseSkill(),this._skillCdTime=this._skillDataModel.getCDTime())))},_setSpeed:function(t){if(this._spriteEnemy&&(this._spriteEnemyScript.onChangeAnimationSpeed(t),this._attackNode)){var e=this._attackNode.getComponent(cc.Animation),i=e.getClips();if(i)for(var n=0,a=i.length;n<a;n++){if(i[n])e.getAnimationState(i[n].name).speed=t}}},onChangeSpeedMult:function(t){this._curSpeedMult=t>0?t:this._curSpeedMult,this._setSpeed(t)},getColliderPos:function(){return cc.v2(this.node.x,this.node.y+150)},setCurHp:function(t,e,i,n){this._super(t,e,i,n),e>0&&(this._totalHurt+=e,td.PveCopyManager.setBossTotalDamage(this._totalHurt)),t&&td.PveCopyManager.statisticsBossDamage(t,e),td.PveCopyManager.setBossLeftHp(this._curHp),this.bDeath()&&(td.PveCopyManager.setKillTime(this._fightTime),o.onFightOver())},toDeath:function(){this._super()},putToNodePool:function(){l.putEnemyToPool(this.getId(),this.node)},onFightOver:function(){},refreshHpProgressBar:function(){if(this._dataModel){this._super();var t=this._dataModel.getHp();this._hpProgressNum.getComponent(cc.Label).string=this._curHp+"/"+t}},startReleaseSkill:function(){this._spriteEnemy.active=!1;var t=this._skillDataModel.getType(),e=td.PveEnum.PVE_BOSS_SKILL_ENUM[t];if(!this._attackNode){var i=this._dataModel.getSkillPrefabe(),n=gdk.rm.getResByUrl(i,cc.Prefab);this._attackNode=cc.instantiate(n),this._attackNode.addComponent(e),this.node.addChild(this._attackNode),this._attackNode.x=this._spriteEnemy.x,this._attackNode.y=this._spriteEnemy.y}var a={skillDataModel:this._skillDataModel,attackPower:0,hurtType:0,towerData:null},r=this._attackNode.getComponent(e);r.initData(a),r.setOwner(this.node),r.setFinishCallBack(this.onAnimationFinished.bind(this)),this._attackNode.active=!0},onAnimationFinished:function(){this._spriteEnemy.active=!0,this._spriteEnemyScript.playIdle(),this._attackNode.active=!1}}));e.exports=c,cc._RF.pop()},{AnimationComponent:void 0,BaseEnemy:"BaseEnemy",EnemyBuffCtrlComponent:"EnemyBuffCtrlComponent",PveFightManager:"PveFightManager",PveLoader:"PveLoader",PveNodePoolManager:"PveNodePoolManager",PveSkillModel:"PveSkillModel",SpriteAnimation:"SpriteAnimation"}],BroadcastContent:[function(t,e,i){"use strict";cc._RF.push(e,"04719RKEOtPn5G0cWCWrPC3","BroadcastContent"),td.BroadcastContent=cc.Class({properties:{_id:null,_type:null,_titleText:null,_mainText:null,_subText:null,_okText:null,_cancelText:null,_mainTextParam:null,_subTextParam:null,_jumpTip:null,_okCallFunc:null,_cancelCallFunc:null,_doNotTipsCallFunc:null,_isAlert:null},ctor:function(){var t=arguments[0],e=td.GetTableClass(td.TableEnum.Broadcast).getBroadcastById(t);cc.assert(e,"broadcast id is error"),this._init(e)},_init:function(t){this._id=t.id,this._type=t.type,this._titleText=t.titleText||td.Language.tip,this._mainText=td.GlobalFunction.transCfgHoursToZoneHours(t.mainText)||"",this._subText=t.subText||"",this._okText=t.okText||td.Language.confirm,this._cancelText=t.cancelText||td.Language.cancel,this._isAlert=t.alert,this._mainTextParam=null,this._subTextParam=null,this._okCallFunc=null,this._cancelCallFunc=null,this._doNotTipsCallFunc=null},isAlert:function(){return this._isAlert},getType:function(){return this._type},setType:function(t){this._type=t},getTitleText:function(){return this._titleText},getMainText:function(){return this._mainText},setMainParam:function(t){this._mainTextParam=t},getMainParam:function(){return this._mainTextParam},getSubText:function(){return this._subText},setSubText:function(t){this._subText=t},clearSubText:function(){this._subText=""},setSubParam:function(t){this._subTextParam=t},getSubParam:function(){return this._subTextParam},setOkText:function(t){this._okText=t},getOkText:function(){return this._okText},setJumpTip:function(t){this._jumpTip=t},getJumpTip:function(){return this._jumpTip},setOkCallFunc:function(t){this._okCallFunc=t},getOkCallFunc:function(){return this._okCallFunc},setCancelText:function(t){this._cancelText=t},getCancelText:function(){return this._cancelText},setCancelCallFunc:function(t){this._cancelCallFunc=t},getCancelCallFunc:function(){return this._cancelCallFunc},setDoNotCallFunc:function(t){this._doNotTipsCallFunc=t},getDoNotCallFunc:function(){return this._doNotTipsCallFunc}}),td.BroadcastParam=cc.Class({properties:{_text:null,_textColor:null,_textSize:null},ctor:function(){var t=arguments[0];null!==t&&void 0!==t||(t=""),this._text=t},getText:function(){return this._text},getTextColor:function(){return this._textColor},getTextSize:function(){return this._textSize}}),cc._RF.pop()},{}],BroadcastTable:[function(t,e,i){"use strict";cc._RF.push(e,"5c5c59VzeZD+LrQOxe4pAqw","BroadcastTable");var n=t("BaseTable");td.BroadcastType={type1:1,type2:2,type3:3,type4:4,type5:5};var a=cc.Class({extends:n,name:"BroadcastTable",properties:{_tblName:"broadcast_data",_data:null},init:function(){this._data={};for(var t=0,e=this._jsonData.length;t<e;++t)this._data[this._jsonData[t].id]=this._jsonData[t]},getBroadcastById:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],BuildTowerAnimateComponent:[function(t,e,i){"use strict";cc._RF.push(e,"94512yql/dCYZhUcNsLyVHk","BuildTowerAnimateComponent");var n=cc.Class({extends:cc.Component,properties:{_frameEventCallFunc:null},setFrameEventCallBack:function(t){"function"==typeof t&&(this._frameEventCallFunc=t)},buildTower:function(t){"function"==typeof this._frameEventCallFunc&&this._frameEventCallFunc(t)}});e.exports=n,cc._RF.pop()},{}],BuildTowerFlag:[function(t,e,i){"use strict";cc._RF.push(e,"83e99kjpzREmJPvUpCXgAF9","BuildTowerFlag");var n=t("PveBuildTowerManager"),a=(t("PveUiManager"),t("PveFightManager")),r=cc.Class({extends:cc.Component,properties:{_imgFlag:null,_createTowerAniNode:null,_bBuilt:null,_curBuildData:null},onLoad:function(){this._bBuilt=!1,this._curBuildData=null,this._imgFlag=this.node.getChildByName("imgFlag");var t=gdk.rm.getResByUrl("fightRes/pve/otherAnimation/ZhaoHuanYingXiong/Zhaohuanyingxiong",cc.Prefab);(this._createTowerAniNode=this.node.getChildByName("createTowerAniNode"),this._createTowerAniNode)||(this._createTowerAniNode=cc.instantiate(t),this._createTowerAniNode.setPosition(cc.v2(0,0)),this._createTowerAniNode.name="createTowerAniNode",this._createTowerAniNode.active=!1,this._createTowerAniNode.getComponent("BuildTowerAnimateComponent").setFrameEventCallBack(this.buildTower.bind(this)),this.node.addChild(this._createTowerAniNode));this._addListener()},_addListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.ON_BUILD_TOWER,this.onBuildTower,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_BEGIN,this.removeSelf,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_UNBUILD_TOWER,this.show,this)},_removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},onDestroy:function(){this._bBuilt=null,this._imgFlag=null,this._createTowerAniNode=null,this._removeListeners()},update:function(t){this._bBuilt&&(this._createTowerAniNode.getComponent(cc.Animation).getAnimationState("Zhaohuanyingxiong").isPlaying||this.hide())},chooseTower:function(){var t=td.GuideManager.isFirstBattle(),e=a.getBuildTowerSwitchStatus();if(!t||e)if(a.canBuildMoreTower()){if(0!==n.getHerosCanBuild().length)this._bBuilt||td.EventUtil.dispatchEvent(td.EventNameEnum.CHOOSE_BUILD_TOWER,this.node._tag);else{var i=td.Language.noHeroToBuild;td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SHOW_TIP_MESSAGE,i)}}else{var r=td.Language.PVE_TXT_2;td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SHOW_TIP_MESSAGE,r)}},onBuildTower:function(t){t.tag===this.node._tag&&(this._curBuildData=t,td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHANGE_BUILD_DATA,t),t.bAction?(this._imgFlag.active=!1,this._createTowerAniNode.active=!0,this._createTowerAniNode.getComponent(cc.Animation).play("Zhaohuanyingxiong")):(this._imgFlag.active=!1,this.buildTower()),this._bBuilt=!0)},buildTower:function(){var t={tag:this._curBuildData.tag,heroDataModel:this._curBuildData.heroDataModel};td.EventUtil.dispatchEvent(td.EventNameEnum.BUILD_TOWER_IN_LAYER,t)},show:function(t){t.posTag===this.node._tag&&(this._bBuilt=!1,this.node.active=!0,this._imgFlag.active=!0,this._createTowerAniNode.active=!1)},hide:function(){this.node.active=!1},removeSelf:function(){td.GuideManager.isFirstBattle()||(this.node.removeFromParent(),this.node.destroy())}});e.exports=r,cc._RF.pop()},{PveBuildTowerManager:"PveBuildTowerManager",PveFightManager:"PveFightManager",PveUiManager:"PveUiManager"}],BuildingTypeEnum:[function(t,e,i){"use strict";cc._RF.push(e,"4fb32BRWMVIdJXDCLqYi4oI","BuildingTypeEnum"),td.BuildingType={LOBBY:1,ALTAR:2,TECHNOLOGY:3,SYNTHESISFURNACE:4,STORE:5,NONE:0},cc._RF.pop()},{}],BulletAnimateComponent:[function(t,e,i){"use strict";cc._RF.push(e,"05d95d3PDpNKLL+xMPUxKMI","BulletAnimateComponent");var n=cc.Class({extends:cc.Component,properties:{_frameEventCallFunc:null,_finishCallBack:null},setFrameEventCallBack:function(t){this._frameEventCallFunc=t},frameEventCallBack:function(t){this._frameEventCallFunc&&this._frameEventCallFunc(t)},setFinishedCallBack:function(t){var e=this.node.getComponent(cc.Animation);this._finishCallBack&&e.off("finished",this._finishCallBack),this._finishCallBack=t,e.on("finished",this._finishCallBack)},stopAnimation:function(){this.node.getComponent(cc.Animation).stop()},onDisable:function(){var t=this;cc.isValid(this.node)&&this.node.getParent()&&"BulletModel"!=this.node.getParent().name&&gdk.Timer.callLater(this,function(){cc.isValid(t.node)&&t.node.removeFromParent()})}});e.exports=n,cc._RF.pop()},{}],BulletModel:[function(t,e,i){"use strict";cc._RF.push(e,"c4b79DnGhJAJLkvqEC8tu4B","BulletModel");var n=cc.Class({_bulletId:null,_bulletName:null,_res:null,_moveRes:null,_attackRes:null,_moveType:null,_effectArray:null,_soundArray:null,_atlas:null,_skillType:null,_attackType:null,_damageRange:null,_moveAnimationClip:null,_movePrefab:null,_attackAnimationClip:null,_attackPrefab:null,_flySpeed:null,_attackNeedRotation:null,_underEffectType:null,_needScalex:!1,init:function(t){this._bulletId=t.id,this._bulletName=t.name,this._res=t.res,this._moveType=t.moveType,this._soundArray=t.soundArray||[0,0],this._atlas=gdk.rm.getResByUrl(t.atlas,cc.SpriteAtlas);var e=t.effectArray;this._effectArray=e,this._skillType=t.skillType,this._attackType=t.attackType,this._damageRange=t.damageRange,this._underEffectType=t.underEffectType,this._attackNeedRotation=1===t.attackNeedRotation,this._needScalex=1===t.needScalex,this._flySpeed=t.flySpeed,2===e[0]&&(this._movePrefab=t.movePrefab),2===e[1]&&(this._attackPrefab=t.attackPrefab)},getId:function(){return this._bulletId},getRes:function(){return this._res},getUnderEffectType:function(){return this._underEffectType},getAttackNeedRotation:function(){return this._attackNeedRotation},isNeedScaleX:function(){return this._needScalex},getFlySpeed:function(){return this._flySpeed},getMoveType:function(){return this._moveType},getAtlas:function(){return this._atlas},getSoundArray:function(){return this._soundArray},getEffectArray:function(){return this._effectArray},getSkillType:function(){return this._skillType},getAttackType:function(){return this._attackType},getDamageRange:function(){return this._damageRange},getMoveRes:function(){return this._moveRes},getAttackRes:function(){return this._attackRes},getBulletMovePrefab:function(){return gdk.rm.getResByUrl(this._movePrefab,cc.Prefab)},getBulletAttackPrefab:function(){return gdk.rm.getResByUrl(this._attackPrefab,cc.Prefab)}});e.exports=n,cc._RF.pop()},{}],BurnBuff:[function(t,e,i){"use strict";cc._RF.push(e,"02570xcKHJJN7JrSboH62y0","BurnBuff");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_clipName:null,_bShowBuff:null},initData:function(t){if(this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.PersistentInjury,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff){var e=this.node.getChildByName("buffNode");if(!e){var i=gdk.rm.getResByUrl("fightRes/pve/buff/buffPrefab",cc.Prefab);e=cc.instantiate(i),this.node.addChild(e),e.y=-20,e.name="buffNode"}this._buffAnimation=e.getComponent(cc.Animation),this._clipName="burnAnimation"}},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._super(),this._curSpeedMult=a.getCurFightSpeedMult(),this._bShowBuff&&(this.refreshSkillAnimationSpeed(this._curSpeedMult),this._buffAnimation.play(this._clipName)),this.schedule(this.onUpdateBurnBuff,1/this._curSpeedMult)):this.removeSelf()},onDisable:function(){this._super(),this.unschedule(this.onUpdateBurnBuff)},onChangeSpeedMult:function(t){this._super(t),this._bShowBuff&&this.refreshSkillAnimationSpeed(t),this.unschedule(this.onUpdateBurnBuff),this.schedule(this.onUpdateBurnBuff,1/this._curSpeedMult)},refreshSkillAnimationSpeed:function(t){for(var e=this._buffAnimation,i=e.getClips(),n=0,a=i.length;n<a;n++){if(i[n])e.getAnimationState(i[n].name).speed=t}},onUpdateBurnBuff:function(t){if(!this._bFightPause)if(this._curBuffData.buffTime<=0)this.endBuff();else if(this._curTarget.getParent()){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=(i.getDataModel(),this._curBuffData.buffData);this._curBuffData.buffTime-=t*this._curSpeedMult;var a=this._curBuffData.baseAttackPower*n;i.setHurt(this._heroSid,a,this._curBuffData.hurtType)}},endBuff:function(){(this.unschedule(this.onUpdateBurnBuff),this._super(),cc.isValid(this._curTarget))&&this._curTarget.getComponent("EnemyBuffCtrlComponent").removeBuffFromList(this._buffType,this._curBuffKey)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],BuyRecordsItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"ff699unP3xDCIJORJnIBppa","BuyRecordsItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labPhase=null,e.labInput=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this.labPhase.string=i.term+"",this.labInput.string=i.betInfo.length+""},a([s(cc.Label)],e.prototype,"labPhase",void 0),a([s(cc.Label)],e.prototype,"labInput",void 0),e=a([o,l("module/Activity/RareTreasure/BuyRecordsItemUI")],e)}(t("ListItem"));i.default=c,cc._RF.pop()},{ListItem:void 0}],BuyRecordsLayer:[function(t,e,i){"use strict";cc._RF.push(e,"ce559szEF5He6NEZWpQi3Ly","BuyRecordsLayer");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("OptimizeVerticalListView"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.recordScroll=null,e.phaseScroll=null,e._recordsListView=null,e._phaseListView=null,e._controller=null,e._selectIndex=0,e._ids=[],e}return n(e,t),e.prototype.init=function(t){this._controller=t},e.prototype.onEnable=function(){this._recordsListView||(this._recordsListView=this.recordScroll.getComponent(u)),this._phaseListView||(this._phaseListView=this.phaseScroll.getComponent(u)),this._addEventListners(),this._initWindow()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListners=function(){var t={};t[r.EventNameEnum.EARETREASURE_SELECT_PHASE_BOX2]=this._refreshWindow,r.EventUtil.registerEvents(t,this)},e.prototype._initWindow=function(){var t=[],e=this._controller.getActivityData(),i=r.GetTableClass(r.TableEnum.GoddessBoxTable).getAllBoxByData(e);for(var n in i)t.push(i[n]),this._ids.push(i[n].id);this._selectIndex=-1,this._controller.setBoxSelectIndex(this._selectIndex),this._phaseListView.setData(t),r.EventUtil.dispatchEvent(r.EventNameEnum.EARETREASURE_SELECT_PHASE_BOX2,0)},e.prototype._refreshWindow=function(t){this._selectIndex=t,this._controller.setBoxSelectIndex(this._selectIndex),r.EventUtil.dispatchEvent(r.EventNameEnum.RES_EARETREASURE_SELECT_PHASE_BOX2);var e=this._ids[this._selectIndex],i=this._controller.getRecordsBetTimes(),n=[];if(i){var a=i[e];if(a)for(var o in a)a[o].betInfo.length>0&&n.push(a[o])}this.recordScroll.active=n.length>0,n.length>0&&this._recordsListView.setData(n)},a([l(cc.Node)],e.prototype,"recordScroll",void 0),a([l(cc.Node)],e.prototype,"phaseScroll",void 0),e=a([s,c("module/Activity/RareTreasure/BuyRecordsLayer")],e)}(cc.Component);i.default=d,cc._RF.pop()},{OptimizeVerticalListView:void 0}],BuyTimesWindow:[function(t,e,i){"use strict";cc._RF.push(e,"11a94SOa6pMaLdy9WRBOz7N","BuyTimesWindow");t("CommonEnum");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{operateLayer:cc.Node,rechargeLayer:cc.Node,imgCurrency:cc.Node,labNeedNum:cc.Label,labCount:cc.Label,labLeftTimes:cc.Label,labLeftTimesT:cc.Label,_sureCallFunc:null,_calcCallFunc:null,_boughtTimes:null,_maxTimes:null,_nextVip:null,_nextMaxTimes:null,_nCurTimes:null,_resourceId:null,_cost:null},init:function(){this._panelType=td.PanelType.None,this._panelEnum=td.PanelEnum.Window_BuyTimes},onDisable:function(){this._boughtTimes=0,this._nCurTimes=0,this._sureCallFunc=null,this._calcCallFunc=null},setData:function(t){this._super(t),this._sureCallFunc=t.sureFunc,this._calcCallFunc=t.calcFunc,this._boughtTimes=t.boughtTimes,this._resourceId=t.resourceId||0,this._type=t.type;var e=t.vipPrerogative,i=td.Account.getUserData().vip,n=td.GetTableClass(td.TableEnum.VipPrivilegeTable).getPrerogativeByTypeAndOpenValue(e);this._maxTimes=0,this._nextVip=0,this._nextMaxTimes=0;var a=0,r=0;if(!n)return cc.log("buy times with error prerogative type = "+e),void this.closeCallFunc();for(var o in n){var s=n[o],l=s.privilegeOpenValue,c=0;if(c=s.value instanceof Array?this.getTypeValue(this._type,s.value):s.value,l>i&&c>r){this._nextVip=l;break}o==i&&(r=c),a=l}var u=n[a];u&&u.value&&(u.value instanceof Array?this._maxTimes=this.getTypeValue(this._type,u.value):this._maxTimes=u.value),(u=n[this._nextVip])&&u.value&&(u.value instanceof Array?this._nextMaxTimes=this.getTypeValue(this._type,u.value):this._nextMaxTimes=u.value);var d=this._boughtTimes<this._maxTimes&&this._sureCallFunc;this.operateLayer.active=d,this.rechargeLayer.active=!d,d?this._refreshOperateLayer():this._refreshRechargeLayer()},getTypeValue:function(t,e){for(var i=e.length-1;i>=0;i--)if(e[i][0]===t)return e[i][1];return 0},_refreshOperateLayer:function(){this._nCurTimes=1,this.setShowCount()},setShowCount:function(){this.labLeftTimes.string=this._maxTimes-this._boughtTimes,this.refreshNeedCurrencyNum()},refreshNeedCurrencyNum:function(){var t=this._maxTimes-this._boughtTimes;this._nCurTimes=this._nCurTimes<1?1:this._nCurTimes,this._nCurTimes=this._nCurTimes>t?t:this._nCurTimes,this.labCount.string=this._nCurTimes;var e=0,i=this._calcCallFunc;this._nCurTimes>0&&i&&"function"==typeof i&&(e=i(this._nCurTimes)),"number"==typeof e?this.labNeedNum.string=e:(td.GlobalFunction.createSpriteNode(this.imgCurrency,e.getLittleIconRes()),this.labNeedNum.string=e.getCount()),this._cost=e},onOpreateNum:function(t,e){e=parseInt(e),this._nCurTimes+=e,this.refreshNeedCurrencyNum()},onCancel:function(){this.closeCallFunc()},onSure:function(){if(this._nCurTimes<=0)this.closeCallFunc();else{var t,e;if("number"==typeof this._cost){if(0===this._resourceId)return void cc.log("can not buy times without cost type!!!!!!!");t=this._resourceId,e=this._cost}else t=this._cost.getGoodsType(),e=this._cost.getCount();if(td.GamerResourceUtil.checkResource(t,e,td.GamerResourceUtil.TipType.Tip)){var i=this._sureCallFunc;i&&"function"==typeof i&&i(this._nCurTimes),this.closeCallFunc()}}},_refreshRechargeLayer:function(){var t=this.rechargeLayer.getChildByName("title_purchased"),e=this.rechargeLayer.getChildByName("lab_purchased");e.getComponent(cc.Label).string=cc.js.formatStr("%s/%s",this._boughtTimes,this._maxTimes),t.active=this._sureCallFunc,e.active=this._sureCallFunc;var i=this.rechargeLayer.getChildByName("vipInfoNode"),n=this.rechargeLayer.getChildByName("tipsLabel"),a=this.rechargeLayer.getChildByName("rechargeBtn"),r="";if(this._nextVip&&window.isPayOpen){r=td.Language.recharge,n.active=!1,i.active=!0;var o=this._nextVip,s=i.getChildByName("labVip"),l=i.getChildByName("img_vip_icon");td.IsCheckServer()?(s.active=!1,l.active=!1):(s.active=!0,l.active=!0,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,"icon_VIP_"+o,l));var c=i.getChildByName("lab_times"),u=i.getChildByName("lab_next_times"),d=i.getChildByName("lab_times_up");c.getComponent(cc.Label).string=this._maxTimes.toString(),u.getComponent(cc.Label).string=this._nextMaxTimes.toString(),d.getComponent(cc.Label).string="+"+(this._nextMaxTimes-this._maxTimes);var h=i.getChildByName("lab_next_recharge"),p=td.Account.getUserData().getRechargeForShow(),_=td.VipManager.getVipCurrentLevelRechargeMoney(o);h.getComponent(cc.Label).string=cc.js.formatStr(td.Language.rechargeCount,(_-p).toString())}else r=td.Language.confirm,n.active=!0,i.active=!1;td.GlobalFunction.setButtonTitle(a,r)},onBtnRecharge:function(){this._nextVip?td.GlobalFunction.gotoRecharge():this.closeCallFunc()}});e.exports=a,cc._RF.pop()},{CommonEnum:void 0,PanelBase:void 0}],CampAttributeTable:[function(t,e,i){"use strict";cc._RF.push(e,"35d52ZuN5JNfpQUfUfX3vpj","CampAttributeTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="CampAttributeTable",e._tblName="hero_camp_attribute_config",e._datas={},e}return n(e,t),e.prototype.init=function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.count]=e}},e.prototype.getDatas=function(){return this._datas},e.prototype.getDataByCount=function(t){for(var e in this._datas){var i=this._datas[e];if(parseInt(e)==t)return i}return{}},e.prototype.getCampAttrTTByCount=function(t){var e={},i=[];t>2&&(i=this.getDataByCount(t).attributeTTPercent);for(var n=0;n<i.length;n++)for(var a=i[n],r=0;r<a.length;r++)e[a[0]]=a[1];return e},e.prototype.getCampAttrByCount=function(t){var e={},i=[];t>2&&(i=this.getDataByCount(t).attributes);for(var n=0;n<i.length;n++)for(var a=i[n],r=0;r<a.length;r++)e[a[0]]=a[1];return e},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CampConvertReqVO:[function(t,e,i){"use strict";cc._RF.push(e,"da834WRkV9GN7PHX8M0i1+A","CampConvertReqVO"),Object.defineProperty(i,"__esModule",{value:!0}),i.CampConvertReqVO=void 0;var n=function(){return function(t,e){this.module=td.MsgModuleName.HERO,this.cmd=td.MsgCmd.Hero.HERO_CONVERT_CAMP,this.heroId=t,this.camp=e}}();i.CampConvertReqVO=n,cc._RF.pop()},{}],CampEnum:[function(t,e,i){"use strict";cc._RF.push(e,"21566E7xcpHAK51cRLACs0i","CampEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.CAMP_TYPE=void 0,function(t){t[t.ANGEL=1]="ANGEL",t[t.DEVIL=2]="DEVIL",t[t.ELVES=3]="ELVES",t[t.NONE=0]="NONE"}(i.CAMP_TYPE||(i.CAMP_TYPE={})),cc._RF.pop()},{}],CampManager:[function(t,e,i){"use strict";cc._RF.push(e,"14a997IWmhN7Y95Trzn0JHq","CampManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../../Hero/Manager/HeroManager"),a=t("../Enum/CampEnum"),r=t("../Model/CampConvertReqVO"),o=cc._decorator,s=(o.ccclass,o.property,function(){function t(){this.manualIndex=0,this.heroSid=""}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this._addServerListener(),this._addEventListener()},t.prototype.showTab=function(t){t-1!=this.manualIndex&&(this.manualIndex=t-1,td.EventUtil.dispatchEvent(td.EventNameEnum.CAMP_MANUAL_REFRESH))},t.prototype.showTabDefault=function(){this.manualIndex=0},t.prototype.filterHeroType=function(t){if(0==this.manualIndex)return t;for(var e=[],i=0;i<t.length;i++){var n=t[i];n.getCurCamp()==this.manualIndex&&e.push(n)}return e},t.prototype.destroyData=function(){},t.prototype._addServerListener=function(){},t.prototype._addEventListener=function(){var t=td.EventUtil,e={};e[td.EventNameEnum.CAMP_CONVERT_SELECT]=this.onCampConverSelect,t.registerEvents(e,this)},t.prototype.getRestrainCamp=function(t){return t<a.CAMP_TYPE.ELVES?t+1:a.CAMP_TYPE.ANGEL},t.prototype.getCampAttrTT=function(t){return td.GetTableClass(td.TableEnum.CampAttributeTable).getCampAttrTTByCount(t)},t.prototype.getCampAttr=function(t){return td.GetTableClass(td.TableEnum.CampAttributeTable).getCampAttrByCount(t)},t.prototype.getCampConvertCostConfig=function(){if(""==this.heroSid)return 0;for(var t=td.GetConfig("HERO_CONVERT_CAMP_COST"),e=this.getCurHeroModel().getFlair(),i=0,n=t.length-1;n>-1;n--){if(e>=t[n][0]){i=n;break}}return t[i][1][0]},t.prototype.getCampConvertCost=function(){return this.getCampConvertCostConfig()[2]},t.prototype.onCampConverSelect=function(t){this.setCurHeroSelect(t.heroId)},t.prototype.setCurHeroSelect=function(t){this.heroSid=t,""==t&&this.setSuccessData(-1)},t.prototype.getCurHeroModel=function(){return""==this.heroSid?null:n.default.getInstance().getHeroBySId(this.heroSid)},t.prototype.getCurHeroSelect=function(){return this.heroSid},t.prototype.isSelected=function(){return""!=this.heroSid},t.prototype.getCanConvert=function(){var t=this.getCurHeroModel().getCurCamp(),e=[1,2,3],i=e.indexOf(t);return e.splice(i,1),e},t.prototype.getCampText=function(t){return[td.Language.CampType1,td.Language.CampType2,td.Language.CampType3][t-1]},t.prototype.reqCampConvert=function(t){var e=this.getCanConvert(),i=this.getCurHeroSelect(),n=e[t];this.setSuccessData(n);var a=new r.CampConvertReqVO(i,n);td.ServerDelegate.sendMessage(a)},t.prototype.setSuccessData=function(t){if(-1!=t){var e=this.getCurHeroModel(),i={heroModel:e,campFrom:e.getCurCamp(),campTo:t};this.successData=i}else this.successData=null},t.prototype.getSuccessData=function(){return this.successData},t.prototype.getCampLimit=function(){return td.GetConfig("LINEUP_CONVERT_CAMP_COUNT")},t}());i.default=s,cc._RF.pop()},{"../../Hero/Manager/HeroManager":"HeroManager","../Enum/CampEnum":"CampEnum","../Model/CampConvertReqVO":"CampConvertReqVO"}],CampaignNotifyConfig:[function(t,e,i){"use strict";cc._RF.push(e,"697ddTJzW9K/aOGUIkDX+Vy","CampaignNotifyConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"CampaignNotifyConfig",properties:{_tblName:"campaign_notify_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.type.toString()]=a}},getCampaignName:function(t){return this._data[t]?this._data[t].name:""}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CarnivalDiscountConfig:[function(t,e,i){"use strict";cc._RF.push(e,"53756+xIllEj4Z1ItKrh0Zj","CarnivalDiscountConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityCarnivalDiscountConfig",properties:{_tblName:"activity_carnival_discount_config",_data:null,_typeDatas:null},init:function(){this._data=[],this._typeDatas={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a,this._typeDatas[a.data]=this._typeDatas[a.data]||[],this._typeDatas[a.data].push(a)}},getData:function(){return this._data},getDatasByDataId:function(t){return this._typeDatas?this._typeDatas[t]:[]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CarnivalGiftConfig:[function(t,e,i){"use strict";cc._RF.push(e,"17371kLkPdDwqz7JCiDyl78","CarnivalGiftConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"CarnivalGiftConfig",properties:{_tblName:"carnival_gift_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}},getData:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CarnivalGiftModel:[function(t,e,i){"use strict";cc._RF.push(e,"8ffd9MYKqpO6rjYzNokl733","CarnivalGiftModel");var n=window.td,a=function(){function t(){this._id=0,this._day=0,this._canBuyTimes=0,this._canBuyVip=0,this._boughtTimes=0,this._des=""}return t.prototype.init=function(t){this._id=t.id,this._day=t.openDay,this._des=t.des||"",this._orginalCost=n.RewardManager.parseRewardListDetail(t.originalPrice),this._cost=n.RewardManager.parseRewardListDetail(t.price),this._reward=t.reward,this._canBuyTimes=t.times,this._canBuyVip=t.vipLevel},t.prototype.getDay=function(){return this._day},t.prototype.getDes=function(){return this._des},t.prototype.getCanBuyVip=function(){return this._canBuyVip},t.prototype.getCanBuyTimes=function(){return this._canBuyTimes},t.prototype.setBoughtTimes=function(t){this._boughtTimes=t},t.prototype.getBoughtTimes=function(){return this._boughtTimes},t.prototype.getId=function(){return this._id},t.prototype.getCost=function(){return this._cost&&this._cost.length>0?this._cost[0]:null},t.prototype.getOrginalCost=function(){return this._orginalCost&&this._orginalCost.length>0?this._orginalCost[0]:null},t.prototype.getRewards=function(){return this._reward},t}();e.exports=a,cc._RF.pop()},{}],CarnivalScoreConfig:[function(t,e,i){"use strict";cc._RF.push(e,"fd202utjxRPWLqlCKxWs3X5","CarnivalScoreConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityCarnivalScoreConfig",properties:{_tblName:"activity_carnival_score_config",_data:null,_typeDatas:null},init:function(){this._data=[],this._typeDatas={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a,this._typeDatas[a.data]=this._typeDatas[a.data]||[],this._typeDatas[a.data].push(a)}},getData:function(){return this._data},getDatasByDataId:function(t){return this._typeDatas?this._typeDatas[t]:[]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CarnivalTypeConfig:[function(t,e,i){"use strict";cc._RF.push(e,"450e69O6/FCf4Vyo1HLF5Un","CarnivalTypeConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"CarnivalTypeConfig",properties:{_tblName:"carnival_type_config",_data:null,_typeDatas:null,_days:[]},init:function(){this._data=[],this._typeDatas={},this._days=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a,this._typeDatas[a.data]=this._typeDatas[a.data]||[],this._typeDatas[a.data].push(a);for(var r=!1,o=0;o<this._days.length;o++)if(this._days[o]===a.day){r=!0;break}r||this._days.push(a.day)}this._days.sort(function(t,e){return t-e})},getData:function(){return this._data},getDatasByDataId:function(t){return this._typeDatas?this._typeDatas[t]:[]},getMaxDay:function(){return this._days&&this._days.length>0?this._days[this._days.length-1]:0}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CarnivalTypeModel:[function(t,e,i){"use strict";cc._RF.push(e,"136cdn+WUJO4KV1+RU6Wi/w","CarnivalTypeModel");window.td;var n=function(){function t(){this._day=0,this._subType=0,this._name="",this._des=""}return t.prototype.init=function(t){this._day=t.day,this._subType=t.subType,this._name=t.name||"",this._des=t.des||"",this._taskIds=t.taskIds||[]},t.prototype.getDay=function(){return this._day},t.prototype.getType=function(){return this._subType},t.prototype.getDes=function(){return this._des},t.prototype.getName=function(){return this._name},t.prototype.getTaskIds=function(){return this._taskIds},t}();e.exports=n,cc._RF.pop()},{}],CastleLevelModel:[function(t,e,i){"use strict";cc._RF.push(e,"aba301RJONA34EQbKU0CI6z","CastleLevelModel");var n=t("Model"),a=cc.Class({extends:n,properties:{_level:0,_baseAttr:null,_cost:null,_openList:null},init:function(t){this._super("CastleLevelModel"),this._baseAttr=td.GlobalFunction.parseAttrArray(t.baseAttr),this._level=t.level,this._cost=td.RewardManager.getRewardDetailArray(t.cost),this._openList=[];var e=0;this._openList[e++]={type:td.CastleEnum.hero,data:t.hero},this._openList[e++]={type:td.CastleEnum.artifact,data:t.artifact},this._openList[e++]={type:td.CastleEnum.reinforcements,data:t.reinforcements},this._openList[e++]={type:td.CastleEnum.gem,data:t.gem}},getCost:function(){return this._cost},getBaseAttr:function(){return this._baseAttr},getLevel:function(){return this._level},getOpenList:function(){return this._openList}});td.CastleEnum={hero:1,artifact:2,reinforcements:3,gem:4},td.CastleTab={total:1,tutong:2},e.exports=a,cc._RF.pop()},{Model:"Model"}],ChallengeHeroController2:[function(t,e,i){"use strict";cc._RF.push(e,"70f1bow1CNHH5UKuVJEhnbe","ChallengeHeroController2");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("ChallengeHeroController"));e.exports=a,cc._RF.pop()},{ChallengeHeroController:"ChallengeHeroController"}],ChallengeHeroController3:[function(t,e,i){"use strict";cc._RF.push(e,"894d2ddCL9Iwpx/a9GUlOx4","ChallengeHeroController3");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("ChallengeHeroController"));e.exports=a,cc._RF.pop()},{ChallengeHeroController:"ChallengeHeroController"}],ChallengeHeroController4:[function(t,e,i){"use strict";cc._RF.push(e,"2bd74V1xAVGT4HBMgjvpSxI","ChallengeHeroController4");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("ChallengeHeroController"));e.exports=a,cc._RF.pop()},{ChallengeHeroController:"ChallengeHeroController"}],ChallengeHeroController5:[function(t,e,i){"use strict";cc._RF.push(e,"81e69nDvUtB+7LnsJW+QhuA","ChallengeHeroController5");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("ChallengeHeroController"));e.exports=a,cc._RF.pop()},{ChallengeHeroController:"ChallengeHeroController"}],ChallengeHeroController6:[function(t,e,i){"use strict";cc._RF.push(e,"59d67iLbOxMapsqOkZyZrbR","ChallengeHeroController6");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("ChallengeHeroController"));e.exports=a,cc._RF.pop()},{ChallengeHeroController:"ChallengeHeroController"}],ChallengeHeroController7:[function(t,e,i){"use strict";cc._RF.push(e,"c52c3NAKblB2Z32Zmjv29s3","ChallengeHeroController7");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("ChallengeHeroController"));e.exports=a,cc._RF.pop()},{ChallengeHeroController:"ChallengeHeroController"}],ChallengeHeroController8:[function(t,e,i){"use strict";cc._RF.push(e,"7dd9fvM449Mc6UwEyw6mSeG","ChallengeHeroController8");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("ChallengeHeroController"));e.exports=a,cc._RF.pop()},{ChallengeHeroController:"ChallengeHeroController"}],ChallengeHeroController:[function(t,e,i){"use strict";cc._RF.push(e,"eda11VHWaJOerJn2IxzBhWu","ChallengeHeroController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=t("../Activity_40_Festival/FestivalExchangeModel"),o=t("ActivityBaseController"),s=t("ChallengeHeroModel"),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataId=0,e._storyId=0,e._bgRes="",e._titleRes="",e._vipTips="",e._roleRes="",e._maxStoryId=0,e._isShown=!1,e._btnTips="",e._isWordsWindowShowed=!1,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this.clearData(),this._initStoryList(),this.initStoreCfg()},e.prototype.clearData=function(){this._dataId=0,this._storyId=0,this._storyList={},this._bgRes="",this._titleRes="",this._vipTips="",this._roleRes="",this._maxStoryId=0,this._isShown=!1,this._allShowRewards=[],this._scaleChange=null,this._btnTips="",this._isWordsWindowShowed=!1,this._storeMap={}},e.prototype.getBgRes=function(){return this._bgRes},e.prototype.getTitleRes=function(){return this._titleRes},e.prototype.getVipTips=function(){return this._vipTips},e.prototype.getCurStoryId=function(){return this._storyId},e.prototype.getMaxStoryId=function(){return this._maxStoryId},e.prototype.getRoleRes=function(){return this._roleRes},e.prototype.getScaleChange=function(){return this._scaleChange},e.prototype.getBtnTip=function(){return this._btnTips},e.prototype.getShowStoryList=function(){var t=[];for(var e in this._storyList)t[t.length]=this._storyList[e];return t},e.prototype.getStoryDataById=function(t){return this._storyList&&this._storyList[t]?this._storyList[t]:null},e.prototype.getSkipBattleNeedVip=function(){for(var t=a.GetConfig("WHOLE_ATTEND_PASS_VIPLEVEL"),e=0,i=this.getActivityData(),n=0,r=t.length;n<r;n++){var o=t[n];o[0]===i&&(e=o[1])}return e},e.prototype.getAllShowRewards=function(){if(!this._allShowRewards||0===this._allShowRewards.length){if(this._allShowRewards=[],this._storyList&&this._storyList.myLen()>0)for(var t in this._storyList)for(var e=this._storyList[t].getRewards(),i=0,n=e.length;i<n;i++){for(var r=e[i],o=!1,s=0,l=this._allShowRewards.length;s<l;s++){if((c=this._allShowRewards[s]).getGoodsType()===r.getGoodsType()&&c.getId()===r.getId()){c.setCount(c.getCount()+r.getCount()),o=!0;break}}if(!o){var c=a.GlobalFunction.getGoodsData(r.getGoodsType(),r.getId(),r.getCount());this._allShowRewards[this._allShowRewards.length]=c}}this._allShowRewards.sort(function(t,e){return e.getQuality()-t.getQuality()})}return this._allShowRewards},e.prototype.setActivityShown=function(){this._isShown=!0,a.EventUtil.dispatchEvent(a.EventNameEnum.CHALLENGE_HERO_SHOWN)},e.prototype.activityParse=function(t){var e=t.record;this._storyId=e.storyId;var i=e.buyMap;for(var n in i)if(i.hasOwnProperty(n)){var r=i[n];this.refreshStoreCfgData(parseInt(n),r)}a.EventUtil.dispatchEvent(a.EventNameEnum.CHALLENGE_HERO_ID_UPDATED)},e.prototype.checkIsCurTaskFinish=function(t){var e=this.getStoryDataById(t);if(!e)return!1;var i=e.getTaskId(),n=a.TaskManager.getTaskById(i);return!!n&&(n.getStatus()===a.TaskStatus.Finish||n.getStatus()===a.TaskStatus.Received)},e.prototype._initStoryList=function(){var t=this.getActivityData();if(t!==this._dataId){this._dataId=t,this._storyList={},this._maxStoryId=0;for(var e=a.GetTableClass(a.TableEnum.WholeAttendConfig).getWholeAttendConfigById(t),i=0,n=e.length;i<n;i++){var r=e[i];""===this._bgRes&&""!==r.bg&&(this._bgRes=r.bg),""===this._titleRes&&""!==r.title&&(this._titleRes=r.title),""===this._vipTips&&""!==r.vipTip&&(this._vipTips=r.vipTip),""===this._roleRes&&""!==r.roleId&&(this._roleRes="hero/"+r.roleId+"/"+r.roleId),null===this._scaleChange&&""!==r.scale&&(this._scaleChange=r.scale),""===this._btnTips&&""!==r.vipBtnTitle&&(this._btnTips=r.vipBtnTitle);var o=new s;o.init(r);var l=o.getStoryId();this._storyList[l]=o,this._maxStoryId=Math.max(l,this._maxStoryId)}}},e.prototype.openWordsWindow=function(){this._isWordsWindowShowed=!0},e.prototype.isWordWindowRed=function(){for(var t=!1,e=this.getWordExchangeList(),i=0;i<e.length;i++){for(var n=e[i].getCost(),r=!0,o=0,s=n.length;o<s;o++){var l=n[o],c=a.ItemManager.getItemNumById(l.getId()),u=l.getCount();r&&c<u&&(r=!1)}if(r){t=!0;break}}return!(!t||this._isWordsWindowShowed)},e.prototype.initStoreCfg=function(){var t=this,e=this.getActivityData();a.GetTableClass(a.TableEnum.WholeAttendStoreConfig).getWholeAttendConfigById(e).forEach(function(e){var i=new r.default;i.initData(e),t._storeMap[e.id]=i})},e.prototype.getHomeBtnRes=function(){var t=this.getActivityData();return a.GetTableClass(a.TableEnum.WholeAttendConfig).getWholeAttendConfigById(t)[0].homeBtnres},e.prototype.getActivityBtnRes=function(){var t=this.getActivityData();return a.GetTableClass(a.TableEnum.WholeAttendConfig).getWholeAttendConfigById(t)[0].activityBtn},e.prototype.refreshStoreCfgData=function(t,e){var i=this._storeMap[t];i&&i.setBuyTimes(e)},e.prototype.getDurationStr=function(){var t=this.getCurrentOpenStage();if(!t)return"";var e=new Date(t.openTime),i=new Date(t.closeTime),n=a.Language.timePattern5,r=a.Language.activityTimeTip1;return r=cc.js.formatStr(r,e.pattern(n),i.pattern(n))},e.prototype.getWordExchangeList=function(){var t=[];for(var e in this._storeMap)t.push(this._storeMap[e]);return t.sort(this.sortFunc)},e.prototype.sortFunc=function(t,e){return e.getSortRank()-t.getSortRank()},e.prototype.hasRedPoint=function(){return!1},e.prototype.redPointTip=function(){return!1},e.prototype.redPointEvts=function(){return[a.EventNameEnum.CHALLENGE_HERO_SHOWN,a.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,a.EventNameEnum.USER_ATTR_VIP_LEVEL_CHANGE]},e.prototype.isRedPointTip=function(){return this.redPointTip()},e}(o);e.exports=l,cc._RF.pop()},{"../Activity_40_Festival/FestivalExchangeModel":"FestivalExchangeModel",ActivityBaseController:"ActivityBaseController",ChallengeHeroModel:"ChallengeHeroModel"}],ChallengeHeroHome:[function(t,e,i){"use strict";cc._RF.push(e,"71647MOSP9D7aquXbtfYmTD","ChallengeHeroHome");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("ActivityBasePanel"),o=t("OptimizeHorizontalListView"),s=t("CommonIconWidget"),l=cc._decorator,c=l.ccclass,u=l.property,d=l.menu,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgBg=null,e.imgTitle=null,e.labTime=null,e.figureNode=null,e.imgMsg=null,e.layerNumTitle=null,e.layerReward=null,e.imgPassed=null,e.btnChallenge=null,e.btnWords=null,e.labFightPower=null,e.rewardContent=null,e.challengeLayer=null,e.backdropNode=null,e.aniNode=null,e._isToChallenge=!1,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e)},e.prototype.onLoad=function(){this._listViewCtrl=this.node.getComponent(o),this._controller.setActivityShown()},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_UPDATE_MAIN_LAYER_GOLD),td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_UPDATE_MAIN_LAYER_DIAMOND),this._isToChallenge=!1,this._addEventListeners(),this._setDefaultSelect(),this._initUI(),this._refreshPassedReward(),td.RedPointUtil.createRedPointOld(this.btnWords,cc.v2(-30,-15),this._controller.isWordWindowRed.bind(this._controller),[td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,td.EventNameEnum.CHALLENGEHERO_WORD_BTN_RED]);var e=this._controller.getWordExchangeList();(!e||e.length<=0)&&(this.btnWords.active=!1)},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),td.EventUtil.unregisterAllEvents(this),this._listViewCtrl.resetContentPanelPos()},e.prototype._addEventListeners=function(){var t={},e=td.EventNameEnum;t[e.CHALLENGE_HERO_CHANGE_SELECT]=this._refreshShowContent,t[e.CHALLENGE_HERO_ID_UPDATED]=this._onChallengeIdChanged,t[e.CLOSE_REWARD_DIALOG]=this._resetChallengeFlag,t[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,td.EventUtil.registerEvents(t,this)},e.prototype._onActivityClose=function(t){this._activityId===t&&this.onDestroy()},e.prototype._resetChallengeFlag=function(){this._isToChallenge=!1,this._onChallengeIdChanged()},e.prototype._onChallengeIdChanged=function(){this._isToChallenge||(this._setDefaultSelect(),this._refreshScrollList(!1),this._refreshPassedReward())},e.prototype._refreshShowContent=function(t){if(!this._isToChallenge){var e=!1;void 0!==t.id&&(t=t.id,e=!0),this._selectId=t;var i=this._controller.getStoryDataById(this._selectId);if(i){var n=this._controller.getCurStoryId(),a=td.resDef.pngPlist.Acitivty_21_qmbnz,r=this.layerNumTitle.getChildByName("imgTen"),o=this.layerNumTitle.getChildByName("imgNum"),s=this._selectId;if(this._selectId<10?r.active=!1:(s%=10,r.active=!0),s>0?(o.active=!0,td.GlobalFunction.createAltasSprite(a,"HD_qmbnz_wz_"+s,o)):o.active=!1,!this._controller.getRoleRes()){var l=i.getRoleFx();this.addUIAni(l),this.addAni()}td.GlobalFunction.createAltasSprite(a,i.getRoundTextRes(),this.imgMsg),this.labFightPower.string=i.getRecommendFightPower();var c=this._controller.getMaxStoryId();this.btnChallenge.active=n<c&&this._selectId>=n+1;var u=this._selectId!==n+1;if(td.GlobalFunction.setButtonGray(this.btnChallenge,u),this.imgPassed.active=this._selectId<=n,this._refreshChallengeCondi(),this._refreshPassedReward(),!e){var d=this._controller.getShowStoryList().length,h=this._selectId-1+4;h>d-1&&(h=d-1),this._listViewCtrl.scrollToRow(h)}}}},e.prototype._refreshChallengeCondi=function(){var t=this._selectId,e=this._controller.getStoryDataById(t);if(e){var i=e.getTaskId(),n=td.TaskManager.getTaskById(i);if(n){var a=this.challengeLayer.getChildByName("conditionLayer"),r=a.getChildByName("conditionHead"),o=a.getChildByName("conditionDes"),s=this.challengeLayer.getChildByName("btnGoto"),l=this.challengeLayer.getChildByName("condiEnough"),c=n.getStatus()===td.TaskStatus.Finish||n.getStatus()===td.TaskStatus.Received,u=c?cc.color(19,255,1):cc.color(255,255,255);r.color=u,o.getComponent(cc.Label).string=n.getDes(),o.color=u,o.getComponent(cc.Label)._forceUpdateRenderData(),a.getComponent(cc.Layout).updateLayout(),l.active=c,l.x=a.x+a.getContentSize().width/2,s.active=!c,s.getComponent(cc.Button).clickEvents[0].customEventData=n}else cc.log("no taskData,task is = ",i)}},e.prototype._setDefaultSelect=function(){var t=this._controller.getMaxStoryId(),e=this._controller.getCurStoryId();this._selectId=t===e?t:e+1,td.EventUtil.dispatchEvent(td.EventNameEnum.CHALLENGE_HERO_CHANGE_SELECT,this._selectId)},e.prototype._refreshScrollList=function(t){var e=this._controller.getShowStoryList();this._listViewCtrl.setCustomData([this._controller.getActivityId(),this._selectId]),t?this._listViewCtrl.setData(e):this._listViewCtrl.refreshCurList(e)},e.prototype._initUI=function(){var t=this._controller.getBgRes();""!==t&&td.GlobalFunction.createSprite(t,this.imgBg);var e=this._controller.getTitleRes();""!==e&&td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_21_qmbnz,e,this.imgTitle),this.labTime.string=this.getDurationStr(),this._refreshScrollList(!0),this.figureNode.removeAllChildren();var i=this._controller.getRoleRes();if(i){this.figureNode.active=!0,this.aniNode.active=!1,this.backdropNode.active=!1;var n=td.GlobalFunction.getResIdByNode(this.node);gdk.rm.loadRes(n,i,cc.Prefab,this._setHeroFigure.bind(this,i))}else this.figureNode.active=!1,this.aniNode.active=!0,this.backdropNode.active=!0;gdk.Timer.callLater(this,this._showAllRewards)},e.prototype.addUIAni=function(t){this.aniNode.removeAllChildren(!0);var e=td.GlobalFunction.getResIdByNode(this.aniNode);gdk.rm.loadRes(e,t,cc.Prefab,this.playUIAni.bind(this,t))},e.prototype.playUIAni=function(t){if(cc.isValid(this.aniNode)){var e=gdk.rm.getResByUrl(t,cc.Prefab),i=cc.instantiate(e);this.aniNode.addChild(i)}},e.prototype.addAni=function(){var t=this.backdropNode.getChildByName("HuLuWa_guang");if(t){t.getComponent(cc.Animation).play()}else{var e=td.GlobalFunction.getResIdByNode(this.backdropNode);gdk.rm.loadRes(e,"uiAnima/HuLuWa/HuLuWa_guang",cc.Prefab,this.playAni.bind(this))}},e.prototype.playAni=function(){if(cc.isValid(this.backdropNode)){var t=gdk.rm.getResByUrl("uiAnima/HuLuWa/HuLuWa_guang",cc.Prefab),e=cc.instantiate(t);this.backdropNode.addChild(e)}},e.prototype._setHeroFigure=function(t){if(cc.isValid(this.node)){var e=gdk.rm.getResByUrl(t,cc.Prefab),i=cc.instantiate(e);i.scale,this._controller.getScaleChange();this.figureNode.addChild(i)}},e.prototype._refreshPassedReward=function(){var t=this._controller.getStoryDataById(this._selectId);if(t){for(var e=t.getRewards(),i=0,n=e.length;i<n;i++){(a=this.layerReward.getChildByName("icon_"+i))?a.getComponent(s).setData(e[i]):((a=td.GlobalFunction.createCommonIconWidget(53,e[i])).name="icon_"+i,a.parent=this.layerReward,a.scale=.8,a.getComponent(s).setNameBgVisible(!1))}for(;;i++){var a;if(!(a=this.layerReward.getChildByName("icon_"+i)))break;a.removeFromParent(!0)}this.layerReward.height=132*n+20}},e.prototype.onBtnCard=function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_ChallengeHerolWords,{activityType:this._activityType})},e.prototype._showAllRewards=function(){for(var t=this._controller.getAllShowRewards(),e=0,i=t.length,n=Math.ceil(i/2);e<i;e++){(a=this.rewardContent.getChildByName("icon_"+e))?a.getComponent(s).setData(t[e]):((a=td.GlobalFunction.createCommonIconWidget(56,t[e])).name="icon_"+e,a.parent=this.rewardContent,a.scale=.8,a.x=(a.width*a.scale+5)*Math.floor(e/2)+a.width/2*a.scale,a.y=e%2==0?a.height/2*a.scale-13:-a.height/2*a.scale+13),0===e&&(this.rewardContent.width=a.width*a.scale*n+5*(n-1))}for(;;e++){var a;if(!(a=this.rewardContent.getChildByName("icon_"+e)))break;a.removeFromParent(!0)}},e.prototype.onClickTurnPage=function(t,e){e=parseInt(e);var i=this._controller.getMaxStoryId(),n=this._selectId+e;n<1?n=1:n>i&&(n=i),td.EventUtil.dispatchEvent(td.EventNameEnum.CHALLENGE_HERO_CHANGE_SELECT,n)},e.prototype.onClickChallenge=function(){if(td.GlobalFunction.checkCanClicked())if(this._controller.checkIsCurTaskFinish(this._selectId)){var t=this._controller.getStoryDataById(this._selectId).getLevelLimit();if(t>td.Account.getUserData().getLevel()){n=new td.BroadcastContent(194);var e=new td.BroadcastParam(t);return n.setMainParam([e]),void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,n)}this._isToChallenge=!0;var i={};i.activityId=this.getActivityId(),i.id=this._selectId,i.parmeterMap={12:1},this._controller.operateActivity(i),td.PvpFightManager.setCurActivityType(this._controller.getActivityType()),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_POWER_CHANGE_LATER,!0)}else{var n=new td.BroadcastContent(393);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,n)}},e.prototype.gotoBtnClick=function(t,e){if(td.GlobalFunction.checkCanClicked(500)){var i=e;if(i.getStatus()==td.TaskStatus.Finish)td.EventUtil.dispatchEvent(td.EventNameEnum.Req_TASK_RECEIVE,i.getId());else{var n=i.getGotoPanel(),a=null;n[1]&&(a=n[1]),td.PanelJumpManager.jumpToPanel(n[0],a)}}},a([u(cc.Node)],e.prototype,"imgBg",void 0),a([u(cc.Node)],e.prototype,"imgTitle",void 0),a([u(cc.Label)],e.prototype,"labTime",void 0),a([u(cc.Node)],e.prototype,"figureNode",void 0),a([u(cc.Node)],e.prototype,"imgMsg",void 0),a([u(cc.Node)],e.prototype,"layerNumTitle",void 0),a([u(cc.Node)],e.prototype,"layerReward",void 0),a([u(cc.Node)],e.prototype,"imgPassed",void 0),a([u(cc.Node)],e.prototype,"btnChallenge",void 0),a([u(cc.Node)],e.prototype,"btnWords",void 0),a([u(cc.Label)],e.prototype,"labFightPower",void 0),a([u(cc.Node)],e.prototype,"rewardContent",void 0),a([u(cc.Node)],e.prototype,"challengeLayer",void 0),a([u(cc.Node)],e.prototype,"backdropNode",void 0),a([u(cc.Node)],e.prototype,"aniNode",void 0),e=a([c,d("module/Activity/ChallengeHeroHome")],e)}(r);i.default=h,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",CommonIconWidget:"CommonIconWidget",OptimizeHorizontalListView:void 0}],ChallengeHeroItem:[function(t,e,i){"use strict";cc._RF.push(e,"f7f6ek2QHhA1qcY16jQHZ6Z","ChallengeHeroItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("ListItem"),o=(t("CommonIconWidget"),cc._decorator),s=o.ccclass,l=o.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgTitle=null,e.imgBg=null,e._curSelectId=0,e}return n(e,t),e.prototype.onEnable=function(){this._addEventListners()},e.prototype.onDisable=function(){td.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListners=function(){var t={};t[td.EventNameEnum.CHALLENGE_HERO_CHANGE_SELECT]=this._updateSelect,td.EventUtil.registerEvents(t,this)},e.prototype.updateItem=function(e,i){if(t.prototype.updateItem.call(this,e,i),td.ActivityDataManager.getActivityControllerById(this._customData[0])){this._curSelectId=this._curSelectId||this._customData[1];var n=i.getStoryId(),a=this._curSelectId==n;this._setSelectStatus(a)}},e.prototype._updateSelect=function(t){void 0!==t.id&&(t=t.id),this._curSelectId=t,this._setSelectStatus(t==this._item.getStoryId())},e.prototype._setSelectStatus=function(t){var e=t?"HD_qmbnz_anniu_01":"HD_qmbnz_anniu_02";td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_21_qmbnz,e,this.imgBg);var i=this._item.getStoryId(),n="HD_qmbnz_wz_g";n+=i<10?"0"+i:i,t||(n+="_02"),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_21_qmbnz,n,this.imgTitle)},e.prototype.touchItem=function(){td.EventUtil.dispatchEvent(td.EventNameEnum.CHALLENGE_HERO_CHANGE_SELECT,{id:this._item.getStoryId()})},a([l(cc.Node)],e.prototype,"imgTitle",void 0),a([l(cc.Node)],e.prototype,"imgBg",void 0),e=a([s],e)}(r);i.default=c,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],ChallengeHeroModel:[function(t,e,i){"use strict";cc._RF.push(e,"955058GWUVPrY4fPL1ip+pf","ChallengeHeroModel");var n=window.td,a=(t("HeroModel"),function(){function t(){this._storyId=0,this._preStoryId=0,this._roundTextRes="",this._fightPower=0,this._levelLimit=0,this._taskId=0}return t.prototype.init=function(t){if(t){this._storyId=t.storyId,this._preStoryId=t.prevStoryId,this._roundTextRes=t.roundText;var e=t.monsterGroupId;this._levelLimit=t.levelLimit,this._taskId=t.taskId,this._roleFx=t.roleFx;var i=n.GetTableClass(n.TableEnum.MonsterGroup).getMonsterGroupById(e);i&&(this._fightPower=i.power),this._rewards=n.RewardManager.parseRewardListDetail(t.rewards)}},t.prototype.getStoryId=function(){return this._storyId},t.prototype.getRewards=function(){return this._rewards},t.prototype.getRoleFx=function(){return this._roleFx},t.prototype.getRoundTextRes=function(){return this._roundTextRes},t.prototype.getRecommendFightPower=function(){return this._fightPower},t.prototype.getLevelLimit=function(){return this._levelLimit},t.prototype.getTaskId=function(){return this._taskId},t}());e.exports=a,cc._RF.pop()},{HeroModel:"HeroModel"}],ChallengeHerolWordsItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"77236ytnDVOB4trCmmampI1","ChallengeHerolWordsItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labExchangeCount=null,e.nodeWordModel=null,e.nodeCost=null,e.nodeRewards=null,e.contentNode=null,e.btnGoto=null,e.img_ysw=null,e._controller=null,e._itemModelData=null,e._itemData=null,e._itemId=null,e._activityType=null,e._canBuyMaxCount=null,e}return n(e,t),e.prototype.onEnable=function(){this._customData&&(this._activityType=this._customData.activityType,this._controller=td.ActivityDataManager.getActivityControllerByType(this._activityType))},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._itemModelData=i,this._activityType=this._customData.activityType,this._controller=td.ActivityDataManager.getActivityControllerByType(this._activityType);var n=this._itemModelData.getId();this._itemId=n;var a=this._itemModelData.getTimes(),r=(this._itemModelData.getTimes(),this._itemModelData.getLeftBuyTimes());this.labExchangeCount.string=r+"/"+a,this.btnGoto.active=r>0,this.img_ysw.active=r<=0;var o=this._itemModelData.getCost(),s=this.nodeCost.childrenCount,l=!0;this._canBuyMaxCount=r;for(var c=0,u=o.length;c<u;c++){var d=o[c];if(m=this.nodeCost.getChildByName("cost"+(c+1))){m.getChildByName("icon").getComponent("CommonIconWidget").setData(d)}else{m=cc.instantiate(this.nodeWordModel);var h=td.GlobalFunction.createCommonIconWidget(1,d);m.name="cost"+(c+1),this.nodeCost.addChild(m),m.addChild(h),h.setName("icon"),m.setScale(.7)}m.active=!0,d.getName(),c!=u-1&&"\u3001";var p=m.getChildByName("icon"),_=td.ItemManager.getItemNumById(d.getId()),g=d.getCount();(y=m.getChildByName("richText")).active=!0,y.getComponent(cc.RichText).string=_>=g?cc.js.formatStr("<size=32><color=#03b10c>%s</c><color=#1f5588>/%s</color></size>",_,g):cc.js.formatStr("<size=32><color=#ff0c0c>%s</c><color=#1f5588>/%s</color></size>",_,g),this._canBuyMaxCount=Math.min(this._canBuyMaxCount,Math.floor(_/g)),td.GlobalFunction.graySprite(p,_<g),l&&_<g&&(l=!1)}for(;c<s;c++){var f=this.nodeCost.getChildByName("cost"+(c+1));f&&f.removeFromParent()}this.nodeCost.setContentSize(cc.size(u*this.nodeWordModel.width,this.nodeWordModel.height)),this.nodeCost.getComponent(cc.Layout).updateLayout();var v=this._itemModelData.getRewards();for(s=this.nodeRewards.childrenCount,c=0,u=v.length;c<u;c++){var m,y,E=v[c];if(m=this.nodeRewards.getChildByName("reward"+(c+1))){(p=m.getChildByName("icon")).getComponent("CommonIconWidget").setData(E)}else{m=cc.instantiate(this.nodeWordModel);h=td.GlobalFunction.createCommonIconWidget(26,E);m.name="reward"+(c+1),this.nodeRewards.addChild(m),m.addChild(h),h.setName("icon"),m.setScale(.8)}m.active=!0,(y=m.getChildByName("richText")).active=!1}for(;c<s;c++){var T=this.nodeCost.getChildByName("reward"+(c+1));T&&T.removeFromParent()}this.nodeRewards.setContentSize(cc.size(u*this.nodeWordModel.width,this.nodeWordModel.height)),this.nodeRewards.getComponent(cc.Layout).updateLayout(),this.contentNode.width=this.nodeCost.width+this.nodeRewards.width+60,td.GlobalFunction.setButtonGray(this.btnGoto,!l),this._itemData=v[0]},e.prototype.onClickBtnGoto=function(){var t=this._canBuyMaxCount,e={};e.item=this._itemData,e.max=t,e.id=this._itemId,e.activityType=this._activityType,td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_CollectWordExchange,e)},a([s(cc.Label)],e.prototype,"labExchangeCount",void 0),a([s(cc.Node)],e.prototype,"nodeWordModel",void 0),a([s(cc.Node)],e.prototype,"nodeCost",void 0),a([s(cc.Node)],e.prototype,"nodeRewards",void 0),a([s(cc.Node)],e.prototype,"contentNode",void 0),a([s(cc.Node)],e.prototype,"btnGoto",void 0),a([s(cc.Node)],e.prototype,"img_ysw",void 0),e=a([o,l("module/Activity/ChallengeHerolWordsItemUI")],e)}(t("ListItem"));i.default=c,cc._RF.pop()},{ListItem:void 0}],ChallengeHerolWordsWindow:[function(t,e,i){"use strict";cc._RF.push(e,"2cd1bPSb5VMuITto+CkqGCH","ChallengeHerolWordsWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTime=null,e._curActivityType=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_ChallengeHerolWords},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]=this._refreshList,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._curActivityType=e.activityType,this._refreshList()},e.prototype._refreshList=function(){var t=r.ActivityDataManager.getActivityControllerByType(this._curActivityType);if(null!=t){t.openWordsWindow(),r.EventUtil.dispatchEvent(r.EventNameEnum.CHALLENGEHERO_WORD_BTN_RED),this.labTime.string=t.getDurationStr();var e=t.getWordExchangeList(),i=this.node.getComponent(d);i.setCustomData({activityType:this._curActivityType}),i.refreshListData(e)}},a([l(cc.Label)],e.prototype,"labTime",void 0),e=a([s,c("module/Activity/ChallengeHerolWordsWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],ChallengeMonsterBuyWindow:[function(t,e,i){"use strict";cc._RF.push(e,"571745YbshGjqCXRyOj1s4D","ChallengeMonsterBuyWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progressBar=null,e.sliderBar=null,e.lab_vigor=null,e.operateCountLabel=null,e.labName=null,e.imgIcon=null,e._operateNum=0,e._limitNum=0,e._value=0,e._activityType=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_ChallengeMonsterBuy},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this.sliderBar.node.on("slide",this.onSliderChange,this)},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.RES_HERO_RUNE_DECOMPOSE]=this.closeCallFunc,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._limitNum=e.times,this._activityType=e.type,this._operateNum=1,this._updateProgress(),this.updateItem()},e.prototype.updateItem=function(){var t=new r.Item,e=r.ActivityDataManager.getActivityControllerByType(this._activityType);t.init(r.GetTableClass(r.TableEnum.Item).getItemById(e.getItemId())),this.labName.string=t.getName(),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,t.getIconRes(),this.imgIcon)},e.prototype._updateProgress=function(){this._value=this.getPriceByTimes(),this.operateCountLabel.string=cc.js.formatStr("%s/%s",this._operateNum,this._limitNum),this.lab_vigor.string=this._value+"",r.Account.getUserData().getDiamond()>=this._value?this.lab_vigor.node.color=cc.color(103,111,163):this.lab_vigor.node.color=cc.color(251,6,6);var t=this._operateNum/this._limitNum;this.progressBar.progress=t,this.sliderBar.progress=t},e.prototype.onSliderChange=function(t){var e=t.progress;this._operateNum=Math.floor(this._limitNum*e),this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onOperateNum=function(t,e){e=parseInt(e),this._operateNum+=e,this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onBtn=function(){if(r.Account.getUserData().getDiamond()>=this._value){var t=r.ActivityDataManager.getActivityControllerByType(this._activityType),e={};e.parmeterMap={6:this._operateNum,25:1},t.operateActivity(e),this.closeCallFunc()}else{var i=new r.BroadcastContent(186);r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,i)}},e.prototype.getPriceByTimes=function(){for(var t=r.ActivityDataManager.getActivityControllerByType(this._activityType).getBuyTimes(),e=0,i=1;i<=this._operateNum;i++)e+=this.getPrice(t+i);return e},e.prototype.getPrice=function(t){for(var e=r.GetConfig("ACTIVITY_NIAN_BOSS_GOODS_BUY_COST"),i=0,n=0;n<e.length;n++)if(e[n][0]==this._activityType){e=e[n][1];break}for(var a=e.length-1;a>=0;a--)if(t>=e[a][0]){i=e[a][1][2];break}return i},a([l(cc.ProgressBar)],e.prototype,"progressBar",void 0),a([l(cc.Slider)],e.prototype,"sliderBar",void 0),a([l(cc.Label)],e.prototype,"lab_vigor",void 0),a([l(cc.Label)],e.prototype,"operateCountLabel",void 0),a([l(cc.Label)],e.prototype,"labName",void 0),a([l(cc.Node)],e.prototype,"imgIcon",void 0),e=a([s],e)}(t("PanelBase"));i.default=c,cc._RF.pop()},{PanelBase:void 0}],ChallengeMonsterController2:[function(t,e,i){"use strict";cc._RF.push(e,"9bf93wLhs1CFK7CckEnJW1Z","ChallengeMonsterController2");var n=t("ChallengeMonsterController"),a=cc.Class({extends:n,getBroadcastId:function(){return 395},isRedPointTip:function(){return td.ItemManager.getItemNumById(td.ItemEnum.CrusadeToken)>10},getItemId:function(){return td.ItemEnum.CrusadeToken}});e.exports=a,cc._RF.pop()},{ChallengeMonsterController:"ChallengeMonsterController"}],ChallengeMonsterController:[function(t,e,i){"use strict";cc._RF.push(e,"dfd1e0Pb4xMdLV7smA8C4ju","ChallengeMonsterController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_buyTimes:null,_killCount:null,_bossId:null,_hp:null,_rankList:null,_isInit:null},addLocalEventListener:function(){this._super();var t={};t[td.EventNameEnum.USER_ATTR_LEVEL_CHANGE]=this.refreshStatus,t[td.EventNameEnum.ON_TIME_OVER_DAY]=this._onTimeDayOver,td.EventUtil.registerEvents(t,this)},initData:function(t){this._super(t),this._isInit=!1},getBossId:function(){return this._bossId},getHp:function(){return this._hp},getRankList:function(){return this._rankList},getBuyTimes:function(){return this._buyTimes},getKillCount:function(){return this._killCount},activityParse:function(t){var e=t.record;this._buyTimes=e.buyTimes,this._bossId=e.bossId,this._hp=e.hp;var i=t.global;this._rankList=i.rankList,this._isInit?e.killCount>this._killCount?(this._killCount=e.killCount,td.EventUtil.dispatchEvent(td.EventNameEnum.CHALLENGE_MONSTER_KILL)):(this._killCount=e.killCount,td.EventUtil.dispatchEvent(td.EventNameEnum.CHALLENGE_MONSTER_REFRESH)):(this._isInit=!0,this._killCount=e.killCount)},hasRedPoint:function(){return!0},redPointEvts:function(){return[td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.ITEM_CHANGE]},redPointTip:function(){return this.isRedPointTip()},isRedPointTip:function(){return td.ItemManager.getItemNumById(td.ItemEnum.Firecracker)>10},getBroadcastId:function(){return 509},getItemId:function(){return td.ItemEnum.Firecracker},_onTimeDayOver:function(){this.isInOpenStatus()&&(this._activityType!==td.ActivityEnum.ActivityType.ACTIVITY_TYPE_25&&this._activityType!==td.ActivityEnum.ActivityType.ACTIVITY_TYPE_84||(td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_ACTIVITY_NIAN),td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,this._activityId)))}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],ChallengeMonsterPanel:[function(t,e,i){"use strict";cc._RF.push(e,"037eeaZ7I9NG65YsuHccZZm","ChallengeMonsterPanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{lableTime:cc.Label,progressBar:cc.ProgressBar,labelNum:cc.Label,rankNode:cc.Node,damageTips:cc.Node,lab_num:cc.Label,lab_progress:cc.Label,monster:cc.Node,monster_node:cc.Node,_activityData:null,_totalHp:null,_num:null,_desIds:null,_retList:null,_showIndex:null,_res:null,_rotation:null,_isCanChallenge:!0,_crossDayFlag:!1},initData:function(t){this._super(t)},onEnable:function(){this._super(),this._setActivityTime(),this._addLocalListeners(),this._activityData=this._controller.getActivityData();var t=this._controller.getActivityId();td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,t),this._num=0,this._isCanChallenge=!0,this._initUI(),this.node.getChildByName("img_bubble").opacity=0},onDisable:function(){this._super(),gdk.Timer.clearAll(this),td.EventUtil.unregisterAllEvents(this),this.damageTips.stopAllActions(),this.damageTips.runAction(cc.fadeOut(.5)),this.node.getChildByName("img_bubble").stopAllActions()},_addLocalListeners:function(){var t={},e=td.EventNameEnum;t[e.CHALLENGE_MONSTER_KILL]=this._killBoss,t[e.CHALLENGE_MONSTER_REFRESH]=this._refreshData,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.receiveRewardReturn,t[e.REFRESH_ACTIVITY_NIAN]=this._refreshCrossDayFlag,td.EventUtil.registerEvents(t,this)},_setActivityTime:function(){var t=this.getDurationStr();this.lableTime.string=t},_initUI:function(){var t=this._controller.getBossId(),e=td.GetTableClass(td.TableEnum.ChallengeMonsterTable).getDataByDataIdAndBossId(this._activityData,t);this._totalHp=e.hp,this._desIds=e.des,this._refreshData();var i=this.monster.getChildByName("monsterModel");i&&i.removeFromParent(),this.showIdleAni()},showIdleAni:function(){this._num>=10?(this.showBubble(),this._num=0):this._num++,this._showIndex="idle",this.showAni()},showHitAni:function(){this.progressBar.progress>0&&(td.GlobalFunction.showRewards(this._retList),this._isCanChallenge=!0)},showDeadAni:function(){td.GlobalFunction.showRewards(this._retList),gdk.Timer.once(1e3,this,this.showEnterAni)},showEnterAni:function(){var t=this._controller.getBossId(),e=td.GetTableClass(td.TableEnum.ChallengeMonsterTable).getDataByDataIdAndBossId(this._activityData,t);this._totalHp=e.hp,this._res=e.res,this._rotation=e.rotation,this._showIndex="ruchang",this._refreshData();var i=this.monster.getChildByName("monsterModel");i&&i.removeFromParent(),this._isCanChallenge=!0,this.showAni()},showAni:function(){if(!this.monster.getChildByName("monsterModel")){var t=td.GlobalFunction.getResIdByNode(this.monster);gdk.rm.loadRes(t,this._res,cc.Prefab,this.addAni.bind(this))}},addAni:function(){if(cc.isValid(this.monster)){var t=gdk.rm.getResByUrl(this._res,cc.Prefab),e=cc.instantiate(t);e.name="monsterModel",this.monster.addChild(e);var i=e.getComponent(cc.Animation);i.on("finished",this.onAniFinish.bind(this),this);var n=i.play(this._showIndex);n&&(n.wrapMode=cc.WrapMode.Normal)}},onAniFinish:function(){"idle"===this._showIndex?this.showIdleAni():"hit"===this._showIndex?(td.GlobalFunction.showRewards(this._retList),this._isCanChallenge=!0,this.showIdleAni()):"dead"===this._showIndex?(td.GlobalFunction.showRewards(this._retList),gdk.Timer.once(1e3,this,this.showEnterAni)):"ruchang"===this._showIndex&&(this._isCanChallenge=!0,this.showIdleAni())},_refreshCrossDayFlag:function(){this._crossDayFlag=!0},_refreshCrossDay:function(){var t=this.monster.getChildByName("monsterModel");t&&t.removeFromParent(),this.showIdleAni()},_refreshData:function(){var t=this._controller.getBossId(),e=td.GetTableClass(td.TableEnum.ChallengeMonsterTable).getDataByDataIdAndBossId(this._activityData,t);this._res=e.res,this._totalHp=e.hp,this._desIds=e.des,this._rotation=e.rotation,this.monster.setScale(e.h5_scale),this._crossDayFlag&&(this._crossDayFlag=!1,this._refreshCrossDay());var i=td.ItemManager.getItemNumById(this._controller.getItemId());this.labelNum.string=i;var n=this._controller.getHp();this.progressBar.progress=n/this._totalHp,this.lab_progress.string=n+"/"+this._totalHp,this.lab_num.string=this._controller.getKillCount();for(var a=this._controller.getRankList().slice(0),r=1;r<4;r++){var o=this.rankNode.getChildByName("lab_name"+r);if(a[r-1]){var s=a[r-1].attributes;o.getComponent(cc.Label).string=r+"."+s[td.UserPropertyEnum.NickName]}else o.getComponent(cc.Label).string=r+"."+td.Language.setWaite}},_killBoss:function(){var t=td.ItemManager.getItemNumById(this._controller.getItemId());this.labelNum.string=t;this.progressBar.progress=0/this._totalHp,this.lab_progress.string="0/"+this._totalHp,this._isCanChallenge=!1,gdk.Timer.once(1400,this,this.showDeadAni)},onBtnChallenge:function(t,e){if(td.GlobalFunction.checkCanClicked()&&this._isCanChallenge){var i=parseInt(e);if(td.ItemManager.getItemNumById(this._controller.getItemId())<i){if(1===i)return void this.checkBuy();var n=new td.BroadcastContent(this._controller.getBroadcastId());td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,n)}else{var a={};a.id=this._productId,a.parmeterMap={6:i,25:2},this._controller.operateActivity(a)}}},checkBuy:function(){for(var t=td.Account.getUserData().getVip(),e=td.GetConfig("ACTIVITY_NIAN_BOSS_GOODS_BUY_LIMIT"),i=this._controller.getActivityType(),n=0;n<e.length;n++)if(e[n][0]==i){e=e[n][1];break}var a=this.getPrerogativeValueByTypeAdnValue(t,e),r=this._controller.getBuyTimes(),o=a-r;if(o>0)td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_ChallengeMonsterBuy,{times:o,type:i});else{for(var s,l=0,c=e.length;l<c;l++){if(t<e[l][0]){s=e[l];break}}if(s){if(!window.isPayOpen)return void td.GlobalFunction.showBroadcastTip(186);var u={},d=td.Account.getUserData().getRechargeForShow(),h=td.VipManager.getVipCurrentLevelRechargeMoney(s[0]);u.vip=s[0],u.cost=h-d,u.times=s[1]-r,td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_StarUpRoadVipTips,u)}else{var p=new td.BroadcastContent(394);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,p)}}},getPrerogativeValueByTypeAdnValue:function(t,e){for(var i=e.length-1;i>=0;i--)if(t>=e[i][0])return e[i][1];return 0},onReceiveOperation:function(t){t.activityId,this._activityId},onBtnRank:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_ChallengeMonsterRank,this._controller.getActivityType())},showBubble:function(){var t=this.node.getChildByName("img_bubble"),e=t.getChildByName("lab_tips"),i=Math.floor(Math.random()*this._desIds.length);i===this._desIds.length&&(i=this._desIds.length-1),e.getComponent(cc.Label).string=td.Language["nianshoudes"+this._desIds[i]],t.stopAllActions();var n=cc.sequence(cc.fadeIn(.5).easing(cc.easeCubicActionOut(3)),cc.delayTime(2),cc.fadeOut(.5));t.runAction(n)},showDamage:function(t){if(0!==t){this.damageTips.getChildByName("labDamage").getComponent(cc.Label).string="/"+t,this.damageTips.stopAllActions();var e=cc.sequence(cc.delayTime(.5),cc.fadeIn(.5).easing(cc.easeCubicActionOut(3)),cc.delayTime(1),cc.fadeOut(.5));this.damageTips.runAction(e),this.showBangerAni(),this._isCanChallenge=!1,gdk.Timer.once(1400,this,this.showHitAni)}else td.GlobalFunction.showRewards(this._retList)},receiveRewardReturn:function(t){if(t.activityId===this._activityId){var e=t.rewardResult;this._retList=td.RewardManager.parseRewardResult(e,!0);var i=t.parmeterMap;if(i&&i[25]){for(var n=i[25],a=0,r=0;r<n.length;r++)a+=n[r];this.showDamage(a)}}},showBangerAni:function(){var t=this.monster_node.getChildByName("banger");if(t){t.getComponent(cc.Animation).play().wrapMode=cc.WrapMode.Normal,td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.ChallengeMonster)}else{var e=td.GlobalFunction.getResIdByNode(this.monster_node),i="uiAnima/LiHua_Effect/LiHua_Effect";this._controller.getActivityType()===td.ActivityEnum.ActivityType.ACTIVITY_TYPE_84&&(i="uiAnima/CY_UI/CY_UI"),gdk.rm.loadRes(e,i,cc.Prefab,this.addBangerAni.bind(this))}},addBangerAni:function(){if(cc.isValid(this.monster_node)){var t="uiAnima/LiHua_Effect/LiHua_Effect";this._controller.getActivityType()===td.ActivityEnum.ActivityType.ACTIVITY_TYPE_84&&(t="uiAnima/CY_UI/CY_UI");var e=gdk.rm.getResByUrl(t,cc.Prefab),i=cc.instantiate(e);i.name="banger",i.y=150,this.monster_node.addChild(i),i.getComponent(cc.Animation).play().wrapMode=cc.WrapMode.Normal,td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.ChallengeMonster)}}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],ChallengeMonsterRankItem:[function(t,e,i){"use strict";cc._RF.push(e,"24af97kbfhFXIHpeG7R14SC","ChallengeMonsterRankItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardItem=null,e.labrank=null,e.labname=null,e.labnum=null,e.lab=null,e}return n(e,t),e.prototype.updateItem=function(e,i){var n=this;t.prototype.updateItem.call(this,e,i);var a=r.Language.ActivityNianItem;this._customData&&this._customData===r.ActivityEnum.ActivityType.ACTIVITY_TYPE_84&&(a=r.Language.ActivityWWFZItem),this.lab.string=a,i.rank>0?(this.labrank.string="No."+i.rank,this.labname.node.active=!0,this.labnum.node.active=!0,this.lab.node.active=!0,this.labname.string=i.name,this.labnum.string=i.killCount):0===i.rank&&(this.labrank.string=r.Language.ConsolationPrize,this.labname.node.active=!1,this.labnum.node.active=!1,this.lab.node.active=!1);var o=i.rewards;this.rewardItem.removeAllChildren(!0),o.forEach(function(t){var e=r.RewardManager.getRewardDetail(t),i=r.GlobalFunction.createCommonIconWidget(26,e);i.setScale(.7),n.rewardItem.addChild(i)})},a([c(cc.Node)],e.prototype,"rewardItem",void 0),a([c(cc.Label)],e.prototype,"labrank",void 0),a([c(cc.Label)],e.prototype,"labname",void 0),a([c(cc.Label)],e.prototype,"labnum",void 0),a([c(cc.Label)],e.prototype,"lab",void 0),e=a([l],e)}(o);i.default=u,cc._RF.pop()},{ListItem:void 0}],ChallengeMonsterRankTable:[function(t,e,i){"use strict";cc._RF.push(e,"9619btxMPlHBLcL1Pt+mlI7","ChallengeMonsterRankTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityNianRankConfig",e._tblName="activity_nian_rank_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getDataByDataId=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChallengeMonsterRankWindow:[function(t,e,i){"use strict";cc._RF.push(e,"e63f4298/RJf6RHQlzOIZ31","ChallengeMonsterRankWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("PanelBase"),s=t("OptimizeVerticalListView"),l=cc._decorator.ccclass,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._activityType=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_ChallengeMonsterRank},e.prototype.setData=function(e){t.prototype.setData.call(this),this._activityType=e;var i=r.ActivityDataManager.getActivityControllerByType(this._activityType).getActivityId();r.EventUtil.dispatchEvent(r.EventNameEnum.Req_GET_ACTIVITY_INFO,i),this.initUI()},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addLocalListeners()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this)},e.prototype._addLocalListeners=function(){var t={};t[r.EventNameEnum.CHALLENGE_MONSTER_REFRESH]=this.initUI,r.EventUtil.registerEvents(t,this)},e.prototype.initUI=function(){var t=r.ActivityDataManager.getActivityControllerByType(this._activityType),e=t.getRankList().slice(0),i=t.getActivityData(),n=r.GetTableClass(r.TableEnum.ChallengeMonsterRankTable).getDataByDataId(i).slice(0);n.sort(this.sortFunc);for(var a=n.shift(),o=n[n.length-1].rank,l=[],c=0;c<o;c++){var u={};e[c]?(u.rank=e[c].rank,u.killCount=e[c].killCount,u.name=e[c].attributes[r.UserPropertyEnum.NickName]):(u.rank=c+1,u.killCount=0,u.name=r.Language.setWaite),u.rewards=this.getRewardsByRankAndList(u.rank,n),l.push(u)}var d={rank:0};d.rewards=a.rewards,l.push(d);var h=this.node.getComponent(s);h.setCustomData(this._activityType),h.refreshListData(l)},e.prototype.sortFunc=function(t,e){return t.rank-e.rank},e.prototype.getRewardsByRankAndList=function(t,e){for(var i=0;i<e.length;i++)if(t<=e[i].rank)return e[i].rewards;return null},e=a([l],e)}(o);i.default=c,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],ChallengeMonsterTable:[function(t,e,i){"use strict";cc._RF.push(e,"ec6c2C2ofBP3Yf+FRdqMgHN","ChallengeMonsterTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityNianBossConfig",e._tblName="activity_nian_boss_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getDataByDataIdAndBossId=function(t,e){var i=this._data[t];if(i)for(var n=0;n<i.length;n++)if(i[n].bossId===e)return i[n];return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChannelInfoConfig:[function(t,e,i){"use strict";cc._RF.push(e,"47b36zWORxEvIfFrRxghNig","ChannelInfoConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ChannelInfoConfig",e._tblName="channel_info_config",e._data2=null,e}return n(e,t),e.prototype.init=function(){this._data={},this._data2={};for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e],a=n.channel,r=n.channelId;a&&(this._data[a]=n),r&&(this._data2[r]=n)}},e.prototype.getChannelCfgByChannel=function(t,e){if(!this._data)return null;var i=this._data[t];return i||(i=this._data2[e]),i},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChargeCommodityConfig:[function(t,e,i){"use strict";cc._RF.push(e,"bddefqDthBO6b9+b5QlhVyz","ChargeCommodityConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ChargeCommodityConfig",properties:{_tblName:"charge_commodity_config",_data:null,_firstChargeActivity:[]},init:function(){this._data={};var t=this._data,e=this._jsonData,i=DX_CHANNEL,n=DX_CHANNEL_ID;console.log("ChargeCommodityConfig sdkChannel: "+i+" sdkChannelId: "+n);for(var a=0,r=e.length;a<r;++a){var o=e[a],s=o["itemId_"+n];if(s||(s=o["itemId_"+i])||s){var l=o["icon_"+n];l&&(o.channelIcon=l),o.zoneId=2,o.itemId=s,t[o.chargeId]=o,console.log("ChargeCommodityConfig: "+o.itemId),o.firstChargeActivity&&(this._firstChargeActivity[this._firstChargeActivity.length]=o)}}this._firstChargeActivity.sort(function(t,e){return t.costValue-e.costValue})},getAllRechargeData:function(){return this._data},getDataByChargeId:function(t){return this._data[t]},getFirstActivityList:function(){return this._firstChargeActivity}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChatConfig:[function(t,e,i){"use strict";cc._RF.push(e,"25417hb3tVJrI7JowZt7vfy","ChatConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ChatConfig",properties:{_tblName:"system_msg_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];a.content=td.Language[a.content],a.content2=td.Language[a.content2],t[a.type.toString()]=a}},getMsgTemplete:function(t){return this._data[t.toString()].content},getChatMsgTemplete:function(t){return this._data[t.toString()].content2},getLocation:function(t){return this._data[t.toString()].location}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChatManager:[function(t,e,i){"use strict";cc._RF.push(e,"2d124a4E1xFyb5yoBEp1brQ","ChatManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("ChatModel"),r=t("BaseUser"),o=t("../../../Common/Chat/Enum/ChatEnum"),s=t("../../Nation/Enum/NationEnum"),l=function(){function t(){this._chatMaxNum=0,this._broadcastMaxNum=0,this._stopShowPushMessage=!1,this._curShowChatType=o.ChatShowType.ALL,this._curSecretChatPlayerSid=0,this._isFirstEnter=!0}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._chatMap={},this._ChatLocationMap={},this._ChatLocationMap[o.ChatLocation.TOP]=[],this._ChatLocationMap[o.ChatLocation.CENTER]=[],this._nextSendChatTime=0,this._broadcastMaxNum=0,this._chatMaxNum=0,this._reqChatInfoFlag=!1,this._bFirstLoadData=!0,this._hasNewData=!0,this._curSecretChatSidList=[],this._curSecretChatPlayerSid=0,this._curSecretChatPlayerData={},this._curShowChatType=o.ChatShowType.ALL,this._isFirstEnter=!0},t.prototype.addListener=function(){var t=n.ServerDelegate,e=n.MsgModuleName.CHAT,i=n.MsgCmd.CHAT;t.registerMessage(e,i.GET_CHAT_INFO,this._parseChatInfo_All.bind(this)),t.registerMessage(e,i.GET_CHAT_TIME,this._resChatSendTime.bind(this)),t.registerMessage(e,i.SEND_CHAT_MSG,this._parseSendChat.bind(this)),t.registerMessage(e,i.PUSH_CHAT_MSG,this._parseChatInfo_push.bind(this))},t.prototype.addEventListener=function(){var t=n.EventUtil,e=n.EventNameEnum,i={};i[e.Req_GET_CHAT_INFO]=this._getChatInfo,i[e.Req_SEND_CHAT_MSG]=this._sendChatInfo,i[e.Req_GET_CHAT_TIME]=this._reqChatSendTime,i[e.Req_DELETE_PERSONAL]=this._reqDeletePerson,i[e.Res_Nation_Exit]=this._resNationExit,i[e.SET_REFRESH_MESSAGE_STOP_STATE]=this._setStopShowPushMessage,i[e.REFRESH_CHAT_DELAY]=this._refreshChatDelay,t.registerEvents(i,this)},t.prototype.setCurChatType=function(t){this._curShowChatType=t},t.prototype.setDefaultShowChatType=function(){this.getCrossIsOpen()&&this._isFirstEnter&&(this._curShowChatType=o.ChatShowType.CROSS,this._isFirstEnter=!1)},t.prototype.getCurChatType=function(){return this._curShowChatType},t.prototype.getReqChatInfoFlag=function(){return this._reqChatInfoFlag},t.prototype.getBroadCastMaxNum=function(){return 0===this._broadcastMaxNum&&(this._broadcastMaxNum=n.GetConfig("BROADCAST_LIMIT")),this._broadcastMaxNum},t.prototype.getChatMaxNum=function(){return 0===this._chatMaxNum&&(this._chatMaxNum=n.GetConfig("CHAT_RECORD_LIMIT")),this._chatMaxNum},t.prototype.getNextSendChatTime=function(){return this._nextSendChatTime},t.prototype.hasNewData=function(){return this._hasNewData},t.prototype._refreshChatDelay=function(t){if(this._ChatLocationMap[t]&&this._ChatLocationMap[t].length>0)for(var e=this._ChatLocationMap[t],i=0,a=e.length;i<a;i++){var r=e[i];r.getNeedDelay()&&r.setNeedDelay(!1)}n.EventUtil.dispatchEvent(n.EventNameEnum.CHECK_SHOW_TOP_MSG)},t.prototype.getChatByLocation=function(t){var e=null;if(this._ChatLocationMap[t]&&this._ChatLocationMap[t].length>0){if((e=this._ChatLocationMap[t][0])&&e.getNeedDelay())return null;this._ChatLocationMap[t].splice(0,1)}return e},t.prototype.getTopShowMsg=function(){var t=[];return this._ChatLocationMap[o.ChatLocation.TOP]&&this._ChatLocationMap[o.ChatLocation.TOP].length>0&&(t=t.concat(this._ChatLocationMap[o.ChatLocation.TOP])),this._chatMap[o.ChatChannelType.ARMY]&&this._chatMap[o.ChatChannelType.ARMY].length>0&&(t=t.concat(this._chatMap[o.ChatChannelType.ARMY])),this._chatMap[o.ChatChannelType.WORLD]&&this._chatMap[o.ChatChannelType.WORLD].length>0&&(t=t.concat(this._chatMap[o.ChatChannelType.WORLD])),t.sort(function(t,e){return t.getTime()-e.getTime()}),t.length>0?t[t.length-1]:null},t.prototype.excludeBlackbyType=function(t){var e=[],i=this._chatMap[t];if(i)for(var a=0;a<i.length;a++){var r=i[a].getFromActorId();n.FriendManager.isInBlacckList(r)||e.push(i[a])}return e},t.prototype.getChatListByShowType=function(t){var e=[],i=this._chatMap;switch(t){case o.ChatShowType.NATION:i[o.ChatChannelType.ARMY]&&(e=e.concat(i[o.ChatChannelType.ARMY]));break;case o.ChatShowType.WORLD:if(i[o.ChatChannelType.WORLD]){var n=this.excludeBlackbyType(o.ChatChannelType.WORLD);e=e.concat(n)}break;case o.ChatShowType.CROSS:if(i[o.ChatChannelType.CROSS]){n=this.excludeBlackbyType(o.ChatChannelType.CROSS);e=e.concat(n)}break;case o.ChatShowType.SECRET:if(i[o.ChatChannelType.SECRET]){n=this.excludeBlackbyType(o.ChatChannelType.SECRET);e=e.concat(n)}break;case o.ChatShowType.ALL:if(i[o.ChatChannelType.ARMY]&&(e=e.concat(i[o.ChatChannelType.ARMY])),i[o.ChatChannelType.WORLD]){n=this.excludeBlackbyType(o.ChatChannelType.WORLD);e=e.concat(n)}if(i[o.ChatChannelType.SYSTEM]&&(e=e.concat(i[o.ChatChannelType.SYSTEM])),i[o.ChatChannelType.CROSS]){n=this.excludeBlackbyType(o.ChatChannelType.CROSS);e=e.concat(n)}}e.sort(function(t,e){return t.getTime()-e.getTime()});var a=this.getBroadCastMaxNum();return e.length>a&&e.splice(0,e.length-a),this._hasNewData=!1,e},t.prototype.getCrossIsOpen=function(){return n.UnlockManager.isTargetUnlock(n.ActorUnlockType.Chat,o.ChatChannelType.CROSS)},t.prototype._setStopShowPushMessage=function(t){this._stopShowPushMessage=t},t.prototype._resNationExit=function(){this._chatMap[o.ChatChannelType.ARMY]=[]},t.prototype._reqChatSendTime=function(){var t={};t.module=n.MsgModuleName.CHAT,t.cmd=n.MsgCmd.CHAT.GET_CHAT_TIME,n.ServerDelegate.sendMessage(t)},t.prototype._reqDeletePerson=function(t){var e={};e.module=n.MsgModuleName.CHAT,e.cmd=n.MsgCmd.CHAT.DELETE_PERSONAL,e.id=t,n.ServerDelegate.sendMessage(e)},t.prototype._resChatSendTime=function(t,e){t===n.NetCode.SUCCESS&&(this._nextSendChatTime=e.time)},t.prototype._getChatInfo=function(){var t={};t.module=n.MsgModuleName.CHAT,t.cmd=n.MsgCmd.CHAT.GET_CHAT_INFO,n.ServerDelegate.sendMessage(t),this._reqChatInfoFlag=!0},t.prototype._sendChatInfo=function(t){var e={};e.module=n.MsgModuleName.CHAT,e.cmd=n.MsgCmd.CHAT.SEND_CHAT_MSG,e.type=t.type,e.channelValue=t.channelValue||0,e.msg=t.msg,e.serverId=t.serverId||0,n.ServerDelegate.sendMessage(e)},t.prototype._parseSendChat=function(t,e){t===n.NetCode.SUCCESS&&(this._resChatSendTime(t,e),n.EventUtil.dispatchEvent(n.EventNameEnum.Res_SEND_CHAT_MSG))},t.prototype._parseChatInfo_push=function(t,e){this._parseChatInfo(t,e,!0)},t.prototype._parseChatInfo_All=function(t,e){this._parseChatInfo(t,e,!1)},t.prototype._parseChatInfo=function(t,e,i){if(t===n.NetCode.SUCCESS){var r=e.chatMap,s=this.getCurSecretChatPlayerSid();for(var l in r)for(var c=r[l],u=0;u<c.length;u++){var d=c[u],h=new a;h.init(d);var p=o.ChatInfoType,_=h.getChatType();if(!n.IsCheckServer()||_!==p.ACTOR_VIP_LEVEL_UP){if(h)switch(_){case p.HERO_GET:this._handleHeroGet(h,d);break;case p.HERO_BREAKOUT:this._hanleHeroBreakout(h,d);break;case p.HERO_CULTIVATE:this._hanleHeroCultivate(h,d);break;case p.HERO_STAR_UP:this._hanleHeroStarUp(h,d);break;case p.HERO_EVOLVE:this._hanleHeroEvolve(h,d);break;case p.EQUIPMENT_GET:this._handleEquipmentGet(h,d);break;case p.EQUIPMENT_EVOLVE:this._handleEquipmentEvolve(h,d);break;case p.EQUIPMENT_STAR_UP:this._handleEquipmentStarUp(h,d);break;case p.TREASURE_GET:this._handleTreasureGet(h,d);break;case p.TREASURE_EVOLVE:this._handleTreasureEvolve(h,d);break;case p.TREASURE_STAR_UP:this._handleTreasureStarUp(h,d);break;case p.ARENA_TOP_RANK_LOGIN:this._handleArenaTopRankLogin(h,d);break;case p.NATION_APPOINT:this._handleAppoint(h,d);break;case p.VIP_CARD_GET:this._handleVipCardGet(h,d);break;case p.ACTOR_VIP_LEVEL_UP:this._handleActorVipLevelUp(h,d);break;case p.PASSED_STORY:this._handlePassStory(h,d);break;case p.ACTOR_POWER_TASK:this._handleActorPowerTask(h,d);break;case p.GOODS_BAG_NOTICE:this._handleUseBagNotice(h,d);break;case p.CAMPAIGN_NOTIFY:this._handleCapaingNotify(h,d);break;case p.GOODS_GET:this._handleGetGoods(h,d);break;case p.WORLD_BOSS_KILL:this._handleWorldBossKill(h,d);break;case p.DESTROY_TEMPLE_FLOOR:this._handleDestoryTempletFloor(h,d);break;case p.NORMAL_TEXT:this._handleNormalText(h,d);break;case p.ADMIN_TEXT:this._handleAdminText(h,d);break;case p.ACTIVITY_MAMMON_SACRIFICE_REWARD:this._handleLuckyErnieText(h,d);break;case p.ACTOR_RANK_FLOWER:this._handleFlowerText(h,d);break;case p.ACTOR_RANK_ABORE:this._handleAboreText(h,d);break;case p.ACTIVITY_FORTUNR_CAT_REWARD:this._handFortunrCatText(h,d);break;case p.ACTIVITY_GODDESS_REWARD:this._handGoddessText(h,d);break;case p.HERO_ARTIFACT_GET:this._handHeroArtifactText(h,d);break;case p.RUNE_GET:this._handRuneText(h,d);break;case p.PET_GET:this._handPetGetText(h,d);break;case p.PET_REFINE:this._handPetRefineText(h,d)}if(this._chatMap[l]||(this._chatMap[l]=[]),this._addToArrList(this._chatMap[l],h),h.getChannelType()===o.ChatChannelType.SECRET){var g=n.PanelManager.getInstance().getCurShowWindow();if(g&&g.getPanelEnum()===n.PanelEnum.Window_Chat&&g.getPanelData()===o.ChatShowType.SECRET){var f=h.getFromActorId(),v=h.getTargetId();f==s&&f!=n.Account.getUserData().getGamerId()&&this.checkSecretMsg(f,h.getTime()),v==s&&v!=n.Account.getUserData().getGamerId()&&this.checkSecretMsg(v,h.getTime())}this.addSecretChat(h)}this._chatMap[l].length>this.getChatMaxNum()&&this._chatMap[l].splice(0,1);var m=h.getLocation();if(h,m>0){switch(m){case o.ChatLocation.TOP:this._addToArrList(this._ChatLocationMap[m],h);break;case o.ChatLocation.CENTER:i&&this._addToArrList(this._ChatLocationMap[m],h);break;case o.ChatLocation.ALL:i&&this._addToArrList(this._ChatLocationMap[o.ChatLocation.CENTER],h),this._addToArrList(this._ChatLocationMap[o.ChatLocation.TOP],h)}this._ChatLocationMap[o.ChatLocation.CENTER].length>this.getBroadCastMaxNum()&&this._ChatLocationMap[o.ChatLocation.CENTER].splice(0,1),this._ChatLocationMap[o.ChatLocation.TOP].length>this.getBroadCastMaxNum()&&this._ChatLocationMap[o.ChatLocation.TOP].splice(0,1)}}}n.EventUtil.dispatchEvent(n.EventNameEnum.PUSH_NEW_MSG),this._bFirstLoadData=!1,this._stopShowPushMessage||n.EventUtil.dispatchEvent(n.EventNameEnum.Res_GET_CHAT_INFO,this._bFirstLoadData),this._hasNewData=!0}},t.prototype._addToArrList=function(t,e){for(var i=0,n=t.length;i<n;i++){if(t[i].getMsgId()===e.getMsgId())return}t.push(e)},t.prototype._getNameFromPara=function(t,e){for(var i=t.actorAttributes,a=0;a<i.length;a++){var r=i[a];if(r[n.UserPropertyEnum.GamerId]===e)return r[n.UserPropertyEnum.NickName]}return""},t.prototype._getChatTemplete=function(t){return n.GetTableClass(n.TableEnum.ChatConfig).getMsgTemplete(t)},t.prototype._getChatTemplete2=function(t){return n.GetTableClass(n.TableEnum.ChatConfig).getChatMsgTemplete(t)},t.prototype._handleHeroGet=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.HERO_GET),a=this._getChatTemplete2(o.ChatInfoType.HERO_GET),r=t.getConfigId(),s=t.getOperationType(),l=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Mercenary,r),c=n.GetTableClass(n.TableEnum.OperationTypeTable).getOperationName(s),u=this._getNameFromPara(e,t.getActorId()),d=l.getAptitude(),h=l.getName();t.setQuality(l.getQuality());var p=n.Language.aptitudeNames.split("|"),_=cc.js.formatStr(i,u,c,p[d-1],h),g=cc.js.formatStr(a,u,c,p[d-1],h);t.setChatMsg(g),t.setMsg(_)},t.prototype._hanleHeroBreakout=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.HERO_BREAKOUT),a=this._getChatTemplete2(o.ChatInfoType.HERO_BREAKOUT),r=t.getConfigId(),s=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Mercenary,r),l=this._getNameFromPara(e,t.getActorId()),c=s.getQuality(),u=s.getName();t.setQuality(c);var d=cc.js.formatStr(i,l,u,"+"+t.getBreakoutLevel()),h=cc.js.formatStr(a,l,u,"+"+t.getBreakoutLevel());t.setChatMsg(h),t.setMsg(d)},t.prototype._hanleHeroCultivate=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.HERO_CULTIVATE),a=this._getChatTemplete2(o.ChatInfoType.HERO_CULTIVATE),r=t.getConfigId(),s=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Mercenary,r),l=this._getNameFromPara(e,t.getActorId()),c=s.getQuality(),u=s.getName();t.setQuality(c);var d=cc.js.formatStr(i,l,u,t.getCultivateLevel()),h=cc.js.formatStr(a,l,u,t.getCultivateLevel());t.setChatMsg(h),t.setMsg(d)},t.prototype._hanleHeroStarUp=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.HERO_STAR_UP),a=this._getChatTemplete2(o.ChatInfoType.HERO_STAR_UP),r=t.getConfigId(),s=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Mercenary,r),l=this._getNameFromPara(e,t.getActorId()),c=s.getQuality(),u=s.getName();t.setQuality(c);var d=t.getStarUpLevel(),h=Math.floor(d/n.GetConfig("HERO_STAR_UP_UNIT")),p=d%n.GetConfig("HERO_STAR_UP_UNIT"),_=cc.js.formatStr(n.Language.heroStarRank,h,p),g=cc.js.formatStr(i,l,u,_),f=cc.js.formatStr(a,l,u,_);t.setChatMsg(f),t.setMsg(g)},t.prototype._hanleHeroEvolve=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.HERO_EVOLVE),a=this._getChatTemplete2(o.ChatInfoType.HERO_EVOLVE),r=t.getConfigId(),s=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Mercenary,r),l=this._getNameFromPara(e,t.getActorId()),c=s.getQuality(),u=s.getName();t.setQuality(c);var d=t.getEvolveLevel(),h=n.GetTableClass(n.TableEnum.HeroEvolveTable).getDataByIdAndLevel(r,d),p=cc.js.formatStr(i,l,u,h.name),_=cc.js.formatStr(a,l,u,h.name);t.setChatMsg(_),t.setMsg(p)},t.prototype._handleEquipmentGet=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.EQUIPMENT_GET),a=this._getChatTemplete2(o.ChatInfoType.EQUIPMENT_GET),r=t.getConfigId(),s=t.getOperationType(),l=this._getNameFromPara(e,t.getActorId()),c=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Equip,r),u=n.GetTableClass(n.TableEnum.OperationTypeTable).getOperationName(s);t.setQuality(c.getQuality());var d=cc.js.formatStr(i,l,u,c.getName()),h=cc.js.formatStr(a,l,u,c.getName());t.setChatMsg(h),t.setMsg(d)},t.prototype._handHeroArtifactText=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.HERO_ARTIFACT_GET),a=this._getChatTemplete2(o.ChatInfoType.HERO_ARTIFACT_GET),r=t.getConfigId(),s=t.getOperationType(),l=this._getNameFromPara(e,t.getActorId()),c=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Artifact,r),u=n.GetTableClass(n.TableEnum.OperationTypeTable).getOperationName(s);t.setQuality(c.getQuality());var d=cc.js.formatStr(i,l,u,n.GlobalFunction.getQualityName(c.getQuality()),c.getName()),h=cc.js.formatStr(a,l,u,n.GlobalFunction.getQualityName(c.getQuality()),c.getName());t.setChatMsg(h),t.setMsg(d)},t.prototype._handRuneText=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.RUNE_GET),a=this._getChatTemplete2(o.ChatInfoType.RUNE_GET),r=t.getConfigId(),s=t.getOperationType(),l=this._getNameFromPara(e,t.getActorId()),c=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Gemstone,r),u=n.GetTableClass(n.TableEnum.OperationTypeTable).getOperationName(s);t.setQuality(c.getQuality());var d=cc.js.formatStr(i,l,u,n.GlobalFunction.getQualityName(c.getQuality()),c.getName()),h=cc.js.formatStr(a,l,u,n.GlobalFunction.getQualityName(c.getQuality()),c.getName());t.setChatMsg(h),t.setMsg(d)},t.prototype._handleEquipmentEvolve=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.EQUIPMENT_EVOLVE),a=this._getChatTemplete2(o.ChatInfoType.EQUIPMENT_EVOLVE),r=t.getConfigId(),s=t.getEvolveLevel(),l=this._getNameFromPara(e,t.getActorId()),c=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Equip,r),u=s?Math.ceil(s/5):1,d=s-5*u+5,h=n.Language.equipEvolveStateName.split("|"),p=cc.js.formatStr(i,l,c.getName(),d+h[u-1]),_=cc.js.formatStr(a,l,c.getName(),d+h[u-1]);t.setChatMsg(_),t.setMsg(p),t.setQuality(c.getQuality())},t.prototype._handleEquipmentStarUp=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.EQUIPMENT_STAR_UP),a=this._getChatTemplete2(o.ChatInfoType.EQUIPMENT_STAR_UP),r=t.getConfigId(),s=this._getNameFromPara(e,t.getActorId()),l=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Equip,r),c=t.getStarUpLevel(),u=Math.floor(c/n.GetConfig("EQUIP_STAR_UP_UNIT")),d=c%n.GetConfig("EQUIP_STAR_UP_UNIT"),h=cc.js.formatStr(n.Language.starRank,u,d),p=cc.js.formatStr(i,s,l.getName(),h),_=cc.js.formatStr(a,s,l.getName(),h);t.setChatMsg(_),t.setMsg(p),t.setQuality(l.getQuality())},t.prototype._handleTreasureGet=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.TREASURE_GET),a=this._getChatTemplete2(o.ChatInfoType.TREASURE_GET),r=t.getConfigId(),s=t.getOperationType(),l=this._getNameFromPara(e,t.getActorId()),c=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Treasure,r),u=n.GetTableClass(n.TableEnum.OperationTypeTable).getOperationName(s);t.setQuality(c.getQuality());var d=cc.js.formatStr(i,l,u,c.getName()),h=cc.js.formatStr(a,l,u,c.getName());t.setChatMsg(h),t.setMsg(d)},t.prototype._handleTreasureEvolve=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.TREASURE_EVOLVE),a=this._getChatTemplete2(o.ChatInfoType.TREASURE_EVOLVE),r=t.getConfigId(),s=this._getNameFromPara(e,t.getActorId()),l=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Treasure,r),c=t.getEvolveLevel(),u=cc.js.formatStr(i,s,l.getName(),c),d=cc.js.formatStr(a,s,l.getName(),c);t.setChatMsg(d),t.setMsg(u),t.setQuality(l.getQuality())},t.prototype._handleTreasureStarUp=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.TREASURE_STAR_UP),a=this._getChatTemplete2(o.ChatInfoType.TREASURE_STAR_UP),r=t.getConfigId(),s=this._getNameFromPara(e,t.getActorId()),l=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Treasure,r),c=t.getStarUpLevel(),u=Math.floor(c/n.GetConfig("TREASURE_STAR_UP_UNIT")),d=c%n.GetConfig("TREASURE_STAR_UP_UNIT"),h=cc.js.formatStr(n.Language.starRank,u,d),p=cc.js.formatStr(i,s,l.getName(),h),_=cc.js.formatStr(a,s,l.getName(),h);t.setChatMsg(_),t.setMsg(p),t.setQuality(l.getQuality())},t.prototype._handleArenaTopRankLogin=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.ARENA_TOP_RANK_LOGIN),n=this._getChatTemplete2(o.ChatInfoType.ARENA_TOP_RANK_LOGIN),a=(t.getRank(),this._getNameFromPara(e,t.getActorId())),r=cc.js.formatStr(i,a),s=cc.js.formatStr(n,a);t.setChatMsg(s),t.setMsg(r)},t.prototype._handleAppoint=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.NATION_APPOINT),a=this._getChatTemplete2(o.ChatInfoType.NATION_APPOINT),r="";if(0!==n.Account.getUserData().curServerId){var l="[%s"+n.Language.arena+"]%s";r+=cc.js.formatStr(l,e.chatInfo.target[n.UserPropertyEnum.ServerId],e.chatInfo.target[n.UserPropertyEnum.NickName])}else r+=e.chatInfo.target[n.UserPropertyEnum.NickName];var c=e.chatInfo.memberType,u="";c!==s.NationMemberType.NONE&&(u=n.Language.nationJobs.split("|")[c-1]);var d=cc.js.formatStr(i,r,u),h=cc.js.formatStr(a,r,u);t.setChatMsg(h),t.setMsg(d)},t.prototype._handleVipCardGet=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.VIP_CARD_GET),a=this._getChatTemplete2(o.ChatInfoType.VIP_CARD_GET),r=this._getNameFromPara(e,t.getActorId()),s=n.Language["vipCard_"+t.getVipCardType()],l=cc.js.formatStr(i,r,s),c=cc.js.formatStr(a,r,s);t.setChatMsg(c),t.setMsg(l)},t.prototype._handleActorVipLevelUp=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.ACTOR_VIP_LEVEL_UP),n=this._getChatTemplete2(o.ChatInfoType.ACTOR_VIP_LEVEL_UP),a=this._getNameFromPara(e,t.getActorId()),r=t.getVipLevel(),s=cc.js.formatStr(i,a,r),l=cc.js.formatStr(n,a,r);t.setChatMsg(l),t.setMsg(s)},t.prototype._handlePassStory=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.PASSED_STORY),a=this._getChatTemplete2(o.ChatInfoType.PASSED_STORY),r=this._getNameFromPara(e,t.getActorId()),s=t.getStoryId(),l=n.PveGeneralCopyManager.getGateModelByGateId(s),c="";if(e&&e.getChapterId){var u=n.PveGeneralCopyManager.getChapterDataByChapterId(l.getChapterId());u&&(c=cc.js.formatStr("%s-%s-%s",cc.js.formatStr(n.Language.chapterTitle,u.getChapterId()%1e3),u.getChapterName(),n.Language.perTitle+cc.js.formatStr(n.Language.missionLevel,e.getGateIndex())))}var d=cc.js.formatStr(i,r,c),h=cc.js.formatStr(a,r,c);t.setChatMsg(h),t.setMsg(d)},t.prototype._handleActorPowerTask=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.ACTOR_POWER_TASK),n=this._getChatTemplete2(o.ChatInfoType.ACTOR_POWER_TASK),a=this._getNameFromPara(e,t.getActorId()),r=t.getChatInfo().power,s=cc.js.formatStr(i,a,r),l=cc.js.formatStr(n,a,r);t.setChatMsg(l),t.setMsg(s)},t.prototype._handleUseBagNotice=function(t,e){for(var i=this._getChatTemplete(o.ChatInfoType.GOODS_BAG_NOTICE),a=this._getChatTemplete2(o.ChatInfoType.GOODS_BAG_NOTICE),r=this._getNameFromPara(e,t.getActorId()),s=t.getChatInfo(),l=s.goodsId,c=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Item,l),u=n.RewardManager.parseRewardListDetail(s.rewards),d="",h="",p=0,_=0,g=u.length;_<g;_++){var f=u[_],v=f.getName(),m=f.getCount(),y=f.getId();f.getQuality()>p&&(p=f.getQuality()),v=y===n.ItemEnum.Gold||y===n.ItemEnum.Diamond?m+v:v+"x"+m,0===_?(d+=v,h+=v):(d+="\u3001"+v,_<2&&(h+="\u3001"+v))}var E=cc.js.formatStr(i,r,c.getName(),d),T=cc.js.formatStr(a,r,c.getName(),h);t.setQuality(p),t.setChatMsg(T),t.setMsg(E)},t.prototype._handleCapaingNotify=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.CAMPAIGN_NOTIFY),a=this._getChatTemplete2(o.ChatInfoType.CAMPAIGN_NOTIFY),r=t.getChatInfo(),s=r.campaignType,l=r.invtervalMinute,c=n.GetTableClass(n.TableEnum.CampaignNotifyConfig).getCampaignName(s);if(0===l){var u=cc.js.formatStr(n.Language.alreadyOpen1,c),d=cc.js.formatStr(n.Language.alreadyOpen2,c);t.setChatMsg(d),t.setMsg(u)}else{u=cc.js.formatStr(i,c,l),d=cc.js.formatStr(a,c,l);t.setChatMsg(d),t.setMsg(u)}},t.prototype._handleGetGoods=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.GOODS_GET),a=this._getChatTemplete2(o.ChatInfoType.GOODS_GET),r=t.getConfigId(),s=t.getOperationType(),l=this._getNameFromPara(e,t.getActorId()),c=n.GlobalFunction.getGoodsData(n.GoodsType.Type_Item,r),u=n.GetTableClass(n.TableEnum.OperationTypeTable).getOperationName(s);t.setQuality(c.getQuality());var d=t.getChatInfo().count,h=cc.js.formatStr(i,l,u,c.getName()+"x"+d),p=cc.js.formatStr(a,l,u,c.getName()+"x"+d);t.setChatMsg(p),t.setMsg(h)},t.prototype._handleWorldBossKill=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.WORLD_BOSS_KILL),n=this._getChatTemplete2(o.ChatInfoType.WORLD_BOSS_KILL),a=this._getNameFromPara(e,t.getActorId()),r=cc.js.formatStr(i,a),s=cc.js.formatStr(n,a);t.setChatMsg(s),t.setMsg(r)},t.prototype._handleDestoryTempletFloor=function(t,e){var i=n.GetTableClass(n.TableEnum.ChatConfig).getMsgTemplete(o.ChatInfoType.DESTROY_TEMPLE_FLOOR),a=n.GetTableClass(n.TableEnum.ChatConfig).getChatMsgTemplete(o.ChatInfoType.DESTROY_TEMPLE_FLOOR),r=this._getNameFromPara(e,t.getActorId()),s=cc.js.formatStr(i,r,t.getFloor()),l=cc.js.formatStr(a,r,t.getFloor());t.setNeedDelay(!0),t.setChatMsg(l),t.setMsg(s)},t.prototype._handleNormalText=function(t,e){var i=n.GetTableClass(n.TableEnum.ChatConfig).getMsgTemplete(o.ChatInfoType.NORMAL_TEXT),a=n.GetTableClass(n.TableEnum.ChatConfig).getChatMsgTemplete(o.ChatInfoType.NORMAL_TEXT),r=t.getMsg();if(n.GlobalFunction.hasEmojiCharacter(r)){for(var s=n.GlobalFunction.splitStrWithEmoji(r),l="",c="",u=0,d=s.length;u<d;u++){var h=s[u];if(n.GlobalFunction.hasEmojiCharacter(h)){var p=h.match(/[0-9][0-9]/g);if("00"==p||parseInt(p)>23)l+=_=cc.js.formatStr(i,h),c+=cc.js.formatStr(a,h);else l+=_=cc.js.formatStr("<img>'emoji_%s'</img>",p[0]),c+=_}else{var _;l+=_=cc.js.formatStr(i,h),c+=cc.js.formatStr(a,h)}}return t.setChatMsg(c),void t.setMsg(l)}var g=cc.js.formatStr(i,t.getMsg()),f=cc.js.formatStr(a,t.getMsg());t.setChatMsg(f),t.setMsg(g)},t.prototype._handleAdminText=function(t,e){var i=n.GetTableClass(n.TableEnum.ChatConfig).getMsgTemplete(o.ChatInfoType.ADMIN_TEXT),a=n.GetTableClass(n.TableEnum.ChatConfig).getChatMsgTemplete(o.ChatInfoType.ADMIN_TEXT),r=cc.js.formatStr(i,t.getMsg()),s=cc.js.formatStr(a,t.getMsg());t.setChatMsg(s),t.setMsg(r)},t.prototype._handleLuckyErnieText=function(t,e){var i=n.GetTableClass(n.TableEnum.ChatConfig).getMsgTemplete(o.ChatInfoType.ACTIVITY_MAMMON_SACRIFICE_REWARD),a=n.GetTableClass(n.TableEnum.ChatConfig).getChatMsgTemplete(o.ChatInfoType.ACTIVITY_MAMMON_SACRIFICE_REWARD),r=this._getNameFromPara(e,t.getActorId()),s=t.getRewards(),l=s&&s[0]?s[0].getCount():0,c=cc.js.formatStr(i,r,l),u=cc.js.formatStr(a,r,l);t.setNeedDelay(!0),t.setChatMsg(u),t.setMsg(c)},t.prototype._handFortunrCatText=function(t,e){var i=n.GetTableClass(n.TableEnum.ChatConfig).getMsgTemplete(o.ChatInfoType.ACTIVITY_FORTUNR_CAT_REWARD),a=n.GetTableClass(n.TableEnum.ChatConfig).getChatMsgTemplete(o.ChatInfoType.ACTIVITY_FORTUNR_CAT_REWARD),r=this._getNameFromPara(e,t.getActorId()),s=t.getRewards(),l=s&&s[0]?s[0].getCount():0,c=cc.js.formatStr(i,r,l),u=cc.js.formatStr(a,r,l);t.setNeedDelay(!0),t.setChatMsg(u),t.setMsg(c)},t.prototype._handGoddessText=function(t,e){var i=n.GetTableClass(n.TableEnum.ChatConfig).getMsgTemplete(o.ChatInfoType.ACTIVITY_GODDESS_REWARD),a=n.GetTableClass(n.TableEnum.ChatConfig).getChatMsgTemplete(o.ChatInfoType.ACTIVITY_GODDESS_REWARD),r=this._getNameFromPara(e,t.getActorId()),s=t.getRewards(),l=e.chatInfo.term,c=cc.js.formatStr(i,r,l,s&&s[0]?s[0].getName():""),u=cc.js.formatStr(a,r,l,s&&s[0]?s[0].getName():"");t.setQuality(s&&s[0]?s[0].getQuality():1),t.setChatMsg(u),t.setMsg(c)},t.prototype._handleFlowerText=function(t,e){var i=n.GetTableClass(n.TableEnum.ChatConfig).getMsgTemplete(o.ChatInfoType.ACTOR_RANK_FLOWER),a=n.GetTableClass(n.TableEnum.ChatConfig).getChatMsgTemplete(o.ChatInfoType.ACTOR_RANK_FLOWER),r=this._getNameFromPara(e,t.getActorId()),s=t.getChatInfo(),l=this._getNameFromPara(e,s.floweredId),c=n.Language["aboreTitle_"+s.rankType]||"",u=s.message,d=cc.js.formatStr(i,r,c,l,u),h=cc.js.formatStr(a,r,c,l,u);t.setChatMsg(h),t.setMsg(d)},t.prototype._handleAboreText=function(t,e){var i=n.GetTableClass(n.TableEnum.ChatConfig).getMsgTemplete(o.ChatInfoType.ACTOR_RANK_ABORE),a=n.GetTableClass(n.TableEnum.ChatConfig).getChatMsgTemplete(o.ChatInfoType.ACTOR_RANK_ABORE),r=this._getNameFromPara(e,t.getActorId()),s=t.getChatInfo(),l=this._getNameFromPara(e,s.aboredId),c=s.message,u=cc.js.formatStr(i,r,l,c),d=cc.js.formatStr(a,r,l,c);t.setChatMsg(d),t.setMsg(u)},t.prototype._handPetGetText=function(t,e){var i=this._getChatTemplete(o.ChatInfoType.PET_GET),a=this._getChatTemplete2(o.ChatInfoType.PET_GET),r=this._getNameFromPara(e,t.getActorId()),s=n.GetTableClass(n.TableEnum.OperationTypeTable).getOperationName(t.getOperationType()),l=n.GetTableClass(n.TableEnum.PetTable).getPetById(t.getConfigId());t.setQuality(l.quality);var c=cc.js.formatStr(i,r,s,l.name),u=cc.js.formatStr(a,r,s,l.name);t.setChatMsg(u),t.setMsg(c)},t.prototype._handPetRefineText=function(t,e){var i=t.getChatInfo(),a=this._getChatTemplete(o.ChatInfoType.PET_REFINE),r=this._getChatTemplete2(o.ChatInfoType.PET_REFINE),s=this._getNameFromPara(e,t.getActorId()),l=n.GetTableClass(n.TableEnum.PetTable).getPetById(t.getConfigId());t.setQuality(l.quality);var c=n.Language["PetAptitude"+i.aptitude],u=cc.js.formatStr(a,s,l.name,c),d=cc.js.formatStr(r,s,l.name,c);t.setChatMsg(d),t.setMsg(u)},t.prototype.addSecretChat=function(t){var e,i=t.getFromActorId(),a=t.getTargetId();this._curSecretChatPlayerData.hasOwnProperty(i)||i==n.Account.getUserData().getGamerId()||((e=new r).init("baseUser",t.getActorAttributes(i)),this._curSecretChatPlayerData[i]=e);this._curSecretChatPlayerData.hasOwnProperty(a)||a==n.Account.getUserData().getGamerId()||((e=new r).init("baseUser",t.getActorAttributes(a)),this._curSecretChatPlayerData[a]=e);this.addPlayerSidIntoList(i),this.addPlayerSidIntoList(a)},t.prototype.addSecretChat2=function(t){var e=t[n.UserPropertyEnum.GamerId];if(!this._curSecretChatPlayerData.hasOwnProperty(e)&&e!=n.Account.getUserData().getGamerId()){var i=new r;i.init("baseUser",t),this._curSecretChatPlayerData[e]=i}this.addPlayerSidIntoList(e)},t.prototype.getSecretChatListBySid=function(t){var e=[];return this.getChatListByShowType(o.ChatShowType.SECRET).forEach(function(i){i.getFromActorId()!=t&&i.getTargetId()!=t||e.push(i)}),e},t.prototype.getSecretChatSidList=function(){return this._curSecretChatSidList||[]},t.prototype.getCurSecretChatPlayerSid=function(){return this._curSecretChatPlayerSid||(this._curSecretChatPlayerSid=this.getSecretChatSidList()[0]),this._curSecretChatPlayerSid},t.prototype.setCurSecretChatPlayerSid=function(t){this._curSecretChatPlayerSid=t},t.prototype.addPlayerSidIntoList=function(t){t!=n.Account.getUserData().getGamerId()&&(ArrayUtils.contains(this._curSecretChatSidList,t)||0==t||(this._curSecretChatSidList.length>10&&this._curSecretChatSidList.splice(9,1),this._curSecretChatSidList.push(t)))},t.prototype.getCurChatPlayerDataBySid=function(t){return this._curSecretChatPlayerData[t]},t.prototype.removePlayerSid=function(t){if(ArrayUtils.remove(this._curSecretChatSidList,t),this._curSecretChatPlayerData.hasOwnProperty(t)&&delete this._curSecretChatPlayerData[t],t==this.getCurSecretChatPlayerSid()&&(this._curSecretChatPlayerSid=this.getSecretChatSidList()[0]),this._chatMap[o.ChatChannelType.SECRET])for(var e=0;e<this._chatMap[o.ChatChannelType.SECRET].length;){var i=this._chatMap[o.ChatChannelType.SECRET][e],n=i.getFromActorId(),a=i.getTargetId();n==t||a==t?this._chatMap[o.ChatChannelType.SECRET].splice(e,1):e++}},t.prototype.checkSecretMsg=function(t,e){n.LocalStorageUtil.write("secretChat"+t,e)},t.prototype.getLastSecretTime=function(t){return n.LocalStorageUtil.read("secretChat"+t)||0},t.prototype.isSecretChatHadNews=function(t){var e=this.getSecretChatListBySid(t);return 0!=e.length&&e[e.length-1].getTime()>this.getLastSecretTime(t)},t.prototype.resortSecretChatSidList=function(){for(var t=this._curSecretChatSidList,e=0,i=t.length;e<i;e++)if(this.isSecretChatHadNews(t[e])){var n=this._curSecretChatSidList.splice(e,1);this._curSecretChatSidList.splice(0,0,n[0])}},t.prototype.entryRedPoint=function(){return this.secretChatRedPoint()},t.prototype.secretChatRedPoint=function(){if(!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.Chat,o.ChatChannelType.SECRET))return!1;for(var t=this._curSecretChatSidList,e=0,i=t.length;e<i;e++)if(this.isSecretChatHadNews(t[e]))return!0;return!1},t.prototype.redPointEvts=function(){return[n.EventNameEnum.Res_GET_CHAT_INFO,n.EventNameEnum.Refresh_CHAT_INFO,n.EventNameEnum.CHECK_SECRET_CHAT_INFO]},t}();i.default=l,cc._RF.pop()},{"../../../Common/Chat/Enum/ChatEnum":void 0,"../../Nation/Enum/NationEnum":"NationEnum",BaseUser:"BaseUser",ChatModel:"ChatModel"}],ChatModel:[function(t,e,i){"use strict";cc._RF.push(e,"cb21cjbfWZBv5UyITgTDoMG","ChatModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("../../../Common/Chat/Enum/ChatEnum"),r=function(){function t(){this._msgId=0,this._chatType=a.ChatChannelType.NONE,this._channelType=0,this._targetId=0,this._fromActorId="",this._fromNationType=0,this._breakoutStage=0,this._evolveLevel=0,this._cultivateLevel=0,this._starLevel=0,this._msg="",this._rank=0,this._location=0,this._awakenStage=0,this._vipLevel=0,this._storyId=0,this._floor=0,this._needDelay=!1,this._strengthenLevel=0}return t.prototype.init=function(t){if(t){this._msgId=t.msgId||0,this._channelType=parseInt(t.channelType)||0,this._fromActorId=t.fromActorId||0,this._actorAttributes=t.actorAttributes||0,this._time=t.time||0,this._targetId=t.targetId;var e=t.chatInfo;this._chatInfo=e,this._actorId=e.actorId||0,this._chatType=parseInt(e.type)||0,this._configId=e.configId||0,this._breakoutStage=e.breakoutLevel||0,this._evolveLevel=e.evolveLevel||0,this._cultivateLevel=e.cultivateLevel||0,this._starLevel=e.starLevel||0,this._rank=e.rank||0,this._msg=e.msg||"",this._operationType=parseInt(e.operationType)||0,this._vipCardType=e.vipCardType||0,this._awakenStage=e.awakenLevel||0,this._strengthenLevel=e.strengthenLevel||0,this._vipLevel=e.vipLevel||0,this._storyId=e.storyId||0,this._floor=e.floor||0,this._rewards=[],e.rewards&&e.rewards.length>0&&(this._rewards=n.RewardManager.parseRewardListDetail(e.rewards));var i=n.GetTableClass(n.TableEnum.ChatConfig).getLocation(this._chatType);this._location=i}},t.prototype.setNeedDelay=function(t){this._needDelay=t},t.prototype.getStrengthenLevel=function(){return this._strengthenLevel},t.prototype.getNeedDelay=function(){return this._needDelay},t.prototype.getChatInfo=function(){return this._chatInfo},t.prototype.getTargetId=function(){return this._targetId},t.prototype._getNameFromPara=function(t){for(var e=this._actorAttributes,i="[%s"+n.Language.arena+"]%s",a=0;a<e.length;a++){var r=e[a];if(r[n.UserPropertyEnum.GamerId]===t){var o=r[n.UserPropertyEnum.NickName];return r[n.UserPropertyEnum.CURRENT_SERVER_ID]&&0!==r[n.UserPropertyEnum.CURRENT_SERVER_ID]&&(o=cc.js.formatStr(i,r[n.UserPropertyEnum.ServerId],o)),o}}return""},t.prototype.getActorAttributes=function(t){for(var e=this._actorAttributes,i=0;i<e.length;i++){var a=e[i];if(a[n.UserPropertyEnum.GamerId]===t)return a}return null},t.prototype.getHeadImageId=function(){for(var t=this._actorAttributes,e=0;e<t.length;e++){var i=t[e];if(i[n.UserPropertyEnum.GamerId]===this._fromActorId)return i[n.UserPropertyEnum.Avatar]}return 0},t.prototype.getFormActorName=function(){return this._getNameFromPara(this._fromActorId)},t.prototype.getFormActorNationName=function(){return this.getActorAttributes(this._fromActorId)[n.UserPropertyEnum.NATION_NAME]||""},t.prototype.getFromActorTitleId=function(){return this.getActorAttributes(this._fromActorId)[n.UserPropertyEnum.TitleId]},t.prototype.getMsgId=function(){return this._msgId},t.prototype.getChannelType=function(){return this._channelType},t.prototype.getFromActorId=function(){return this._fromActorId},t.prototype.getTime=function(){return this._time},t.prototype.getChatType=function(){return this._chatType},t.prototype.getActorId=function(){return this._actorId},t.prototype.getConfigId=function(){return this._configId},t.prototype.getRelifeId=function(){return this._configId},t.prototype.getBreakoutLevel=function(){return this._breakoutStage},t.prototype.getEvolveLevel=function(){return this._evolveLevel},t.prototype.getStarUpLevel=function(){return this._starLevel},t.prototype.getCultivateLevel=function(){return this._cultivateLevel},t.prototype.getRank=function(){return this._rank},t.prototype.getMsg=function(){return this._msg},t.prototype.setMsg=function(t){this._msg=t},t.prototype.getChatMsg=function(){return this._chatMsg},t.prototype.setChatMsg=function(t){this._chatMsg=t},t.prototype.setLocation=function(t){this._location=t},t.prototype.getLocation=function(){return this._location},t.prototype.getOperationType=function(){return this._operationType},t.prototype.getVipCardType=function(){return this._vipCardType},t.prototype.getAwakenStage=function(){return this._awakenStage},t.prototype.getVipLevel=function(){return this._vipLevel},t.prototype.getStoryId=function(){return this._storyId},t.prototype.getFloor=function(){return this._floor},t.prototype.setQuality=function(t){this._quality=t},t.prototype.getQuality=function(){return this._quality},t.prototype.getRewards=function(){return this._rewards},t.prototype.isNationRecord=function(){return!1},t}();e.exports=r,cc._RF.pop()},{"../../../Common/Chat/Enum/ChatEnum":void 0}],ChessEnum:[function(t,e,i){"use strict";cc._RF.push(e,"e52b5OSCCBOaKNtQ8z5OcCT","ChessEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.TIP_WINDOW_TYPE=i.SKILL_TYPE=void 0,function(t){t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT"}(i.SKILL_TYPE||(i.SKILL_TYPE={})),function(t){t[t.SWEEP=1]="SWEEP",t[t.SETTLE=2]="SETTLE",t[t.SKIP=3]="SKIP",t[t.BATTLE=4]="BATTLE",t[t.GRADE=5]="GRADE",t[t.POWER=6]="POWER"}(i.TIP_WINDOW_TYPE||(i.TIP_WINDOW_TYPE={})),cc._RF.pop()},{}],ChessFloorTable:[function(t,e,i){"use strict";cc._RF.push(e,"f8b68iMe/BBmYODkkAnxbKq","ChessFloorTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ChessFloorTable",e._tblName="chess_floor_config",e._datas={},e}return n(e,t),e.prototype.init=function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.dan]||(this._datas[e.dan]={}),this._datas[e.dan][e.floor]=e}},e.prototype.getDatas=function(){return this._datas},e.prototype.getDataByGrade=function(t){for(var e in this._datas){var i=this._datas[e];if(parseInt(e)==t)return i}},e.prototype.getFloorData=function(t,e){var i=this.getDataByGrade(t);for(var n in i){var a=i[n];if(a.floor==e)return a}},e.prototype.getMaxFloor=function(t){var e=this.getDataByGrade(t),i=0;for(var n in e){var a=e[n];i=Math.max(i,a.floor)}return i},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChessGradeTable:[function(t,e,i){"use strict";cc._RF.push(e,"8b031IX4kBDRYKwf5sqE0gO","ChessGradeTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ChessGradeTable",e._tblName="chess_dan_config",e._data=[],e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._data.push(e)}this._data.sort(function(t,e){return t.dan-e.dan})},e.prototype.getDatas=function(){return this._data},e.prototype.getDataByGrade=function(t){for(var e=0;e<this._data.length;e++){var i=this._data[e];if(i.dan==t)return i}},e.prototype.getMaxGrade=function(){for(var t=0,e=0;e<this._data.length;e++){var i=this._data[e];t=Math.max(t,i.dan)}return t},e.prototype.getRewardDatas=function(){for(var t=[],e=0;e<this._data.length;e++){var i=this._data[e];i.danRewards.length>0&&t.push(i)}return t},e.prototype.getCfgByMatchPower=function(t){for(var e=null,i=0;i<this._data.length;i++){var n=this._data[i];t>=n.matchPower&&(e=n)}return e},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChessHeroTable:[function(t,e,i){"use strict";cc._RF.push(e,"94e9fHiyXlJCJsRFTfrW/Xa","ChessHeroTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ChessHeroTable",e._tblName="chess_hero_config",e._datas={},e}return n(e,t),e.prototype.init=function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.heroId]=e}},e.prototype.getDatas=function(){return this._datas},e.prototype.getDataById=function(t){for(var e in this._datas){var i=this._datas[e];if(parseInt(e)==t)return i}},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChessLevelTable:[function(t,e,i){"use strict";cc._RF.push(e,"31bc3beNG9Cfa/d9Ue/TKVU","ChessLevelTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ChessLevelTable",e._tblName="chess_level_config",e._datas={},e}return n(e,t),e.prototype.init=function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.level]=e}},e.prototype.getDatas=function(){return this._datas},e.prototype.getDataByLevel=function(t){for(var e in this._datas){var i=this._datas[e];if(parseInt(e)==t)return i}},e.prototype.getMaxLevel=function(){var t=0;for(var e in this._datas)t=Math.max(t,parseInt(e));return t},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChessManager:[function(t,e,i){"use strict";cc._RF.push(e,"41ad04EWZtGAo4sYVmbVvit","ChessManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("ActorRankModel"),a=t("../Enum/ChessEnum"),r=t("../Model/ChessModel"),o=t("../Model/ChessSkillModel"),s=t("PveCopyEnum"),l=function(){function t(){this._grade=0,this._floor=0,this._currency=0,this._rewardTimes=0,this._rewardState=!1,this._level=0,this._hp=0,this._tokens=0,this._lock=!1,this._skillList=[],this._saleMap={},this._chessList={},this._receiveList=[],this._streak=0,this._myActorRankInfo=null,this._actorRankList=[],this._skillModelsMap={},this._initSuc=!1,this._isNetBreak=!1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.destroyData(),this._addServerListener(),this._addEventListener(),this.initData()},t.prototype.initData=function(){},t.prototype.destroyData=function(){this._currency=0,this._rewardTimes=0,this._rewardState=!1,this._level=0,this._tokens=0,this._lock=!1,this._skillList=[],this._saleMap={},this._chessList={},this._receiveList=[],this._streak=0,this._myActorRankInfo=null,this._actorRankList=[],this._skillModelsMap={},this._initSuc=!1},t.prototype.getGrade=function(){return this._grade},t.prototype.getFloor=function(){return this._floor},t.prototype.getCurrency=function(){return this._currency},t.prototype.getLevel=function(){return this._level},t.prototype.getHp=function(){return this._hp},t.prototype.getTokens=function(){return this._tokens},t.prototype.getLock=function(){return this._lock},t.prototype.getSkillMap=function(){return this._skillList},t.prototype.getSaleMap=function(){return this._saleMap},t.prototype.getChessList=function(){return this._chessList},t.prototype.getStreak=function(){return this._streak},t.prototype.getRewardTimes=function(){return this._rewardTimes},t.prototype.getRewardState=function(){return this._rewardState},t.prototype.isInitSuc=function(){return this._initSuc},t.prototype._addServerListener=function(){var t=td.ServerDelegate,e=td.MsgModuleName.CHESS,i=td.MsgCmd.CHESS;t.registerMessage(e,i.GET_INFO,this._resChessInfo.bind(this)),t.registerMessage(e,i.GET_RANK,this._resRankInfo.bind(this)),t.registerMessage(e,i.REFRESH_SALE,this._resRefreshSale.bind(this)),t.registerMessage(e,i.LOCK_SALE,this._resLockSale.bind(this)),t.registerMessage(e,i.BUY,this._resBuy.bind(this)),t.registerMessage(e,i.SELL,this._resSell.bind(this)),t.registerMessage(e,i.LEVEL_UP,this._resLevelUp.bind(this)),t.registerMessage(e,i.PREPARE,this._resPrepare.bind(this)),t.registerMessage(e,i.BATTLE,this._resBattle.bind(this)),t.registerMessage(e,i.SETTLE,this._resSettle.bind(this)),t.registerMessage(e,i.SWEEP,this._resSweep.bind(this)),t.registerMessage(e,i.GRADE_REWARD,this._resGradeReward.bind(this)),t.registerMessage(e,i.GRADE_UP,this._resGradeUp.bind(this)),t.registerMessage(e,i.SWAP_ORDER,this._resSwapOrder.bind(this)),t.registerMessage(e,i.PUSH_CHESS_INFO,this._onPushChessInfo.bind(this))},t.prototype._addEventListener=function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQ_CHESS_INFO]=this._reqChessInfo,i[e.REQ_CHESS_RANK]=this._reqRankInfo,i[e.REQ_CHESS_REFRESH_SALE]=this._reqRefreshSale,i[e.REQ_CHESS_LOCK_SALE]=this._reqLockSale,i[e.REQ_CHESS_BUY]=this._reqBuy,i[e.REQ_CHESS_SELL]=this._reqSell,i[e.REQ_CHESS_LEVEL_UP]=this._reqLevelUp,i[e.REQ_CHESS_PREPARE]=this._reqPrepare,i[e.REQ_CHESS_BATTLE]=this._reqBattle,i[e.REQ_CHESS_SETTLE]=this._reqSettle,i[e.REQ_CHESSS_SWEEP]=this._reqSweep,i[e.REQ_CHESS_GRADE_REWARD]=this._reqGradeReward,i[e.REQ_CHESS_GRADE_UP]=this._reqGradeUp,i[e.REQ_CHESS_SWAP_ORDER]=this._reqSwapOrder,i[e.NOTICE_NET_BREAK]=this.setNetBreakStatus,t.registerEvents(i,this)},t.prototype.setNetBreakStatus=function(t){this._isNetBreak=t},t.prototype.getNetBreakStatus=function(){return this._isNetBreak},t.prototype._reqChessInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.CHESS,0)){var t={};t.module=td.MsgModuleName.CHESS,t.cmd=td.MsgCmd.CHESS.GET_INFO,td.ServerDelegate.sendMessage(t)}},t.prototype._resChessInfo=function(t,e){t===td.NetCode.SUCCESS&&(this._grade=e.dan,this._initSuc=!0,this._floor=e.floor+1,this._currency=e.currency,this._rewardTimes=e.rewardTimes,this._rewardState=e.rewardState,this._level=e.level,this._hp=e.hp,this._tokens=e.refreshToken,this._lock=e.lockState,this._skillList=e.skillList,this._saleMap=e.saleMap,this._chessList=e.chessHeroList,this._receiveList=e.receiveList,this._streak=e.winStreak,this._refreshSkillModels(),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_CHESS_MAIN_PANEL))},t.prototype._reqRankInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.CHESS,0)){var t={};t.module=td.MsgModuleName.CHESS,t.cmd=td.MsgCmd.CHESS.GET_RANK,td.ServerDelegate.sendMessage(t)}},t.prototype._resRankInfo=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.ranks;this._actorRankList=[];for(var a=0,r=i.length;a<r;a++){var o=new n;o.init(i[a]),a==i.length-1?this._myActorRankInfo=o:o.getRank()>0&&this._actorRankList.push(o)}td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_GET_RANK_SUC)}},t.prototype._reqRefreshSale=function(){var t={};t.module=td.MsgModuleName.CHESS,t.cmd=td.MsgCmd.CHESS.REFRESH_SALE,td.ServerDelegate.sendMessage(t)},t.prototype._resRefreshSale=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_REFRESH_SUC)},t.prototype._reqLockSale=function(t){var e={};e.module=td.MsgModuleName.CHESS,e.cmd=td.MsgCmd.CHESS.LOCK_SALE,e.id=t.id,td.ServerDelegate.sendMessage(e)},t.prototype._resLockSale=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_LOCK_SUC)},t.prototype._reqBuy=function(t){var e={};e.module=td.MsgModuleName.CHESS,e.cmd=td.MsgCmd.CHESS.BUY,e.id=t.id,td.ServerDelegate.sendMessage(e)},t.prototype._resBuy=function(t,e){t===td.NetCode.SUCCESS&&(this.getChessArray(),this.getSaleArray(),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_BUY_SUC))},t.prototype._reqSell=function(t){var e={};e.module=td.MsgModuleName.CHESS,e.cmd=td.MsgCmd.CHESS.SELL,e.id=t.id,td.ServerDelegate.sendMessage(e)},t.prototype._resSell=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_SELL_SUC)},t.prototype._reqLevelUp=function(){var t={};t.module=td.MsgModuleName.CHESS,t.cmd=td.MsgCmd.CHESS.LEVEL_UP,td.ServerDelegate.sendMessage(t)},t.prototype._resLevelUp=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_LEVEL_UP_SUC)},t.prototype._reqPrepare=function(t){var e={};e.module=td.MsgModuleName.CHESS,e.cmd=td.MsgCmd.CHESS.PREPARE,e.id=t.id,td.ServerDelegate.sendMessage(e)},t.prototype._resPrepare=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_PREPARE_SUC)},t.prototype._reqBattle=function(t){var e={};e.module=td.MsgModuleName.CHESS,e.cmd=td.MsgCmd.CHESS.BATTLE,e.id=t.id,e.hp=t.hp,e.check=t.check,td.ServerDelegate.sendMessage(e)},t.prototype._resBattle=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);e.refreshToken&&n.push({type:td.GoodsType.Type_Item,id:td.ItemEnum.ChessRefreshToken,count:e.refreshToken}),td.EventUtil.dispatchEvent(td.EventNameEnum.RECEIVE_PVE_FIHGT_REAWRD,n)}else td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PRE_PANEL)},t.prototype._reqSettle=function(){var t={};t.module=td.MsgModuleName.CHESS,t.cmd=td.MsgCmd.CHESS.SETTLE,td.ServerDelegate.sendMessage(t)},t.prototype._resSettle=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_SETTLE_SUC,e)},t.prototype._reqSweep=function(){var t={};t.module=td.MsgModuleName.CHESS,t.cmd=td.MsgCmd.CHESS.SWEEP,td.ServerDelegate.sendMessage(t)},t.prototype._resSweep=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_SWEEP_SUC,e)},t.prototype._reqGradeReward=function(t){var e={};e.module=td.MsgModuleName.CHESS,e.cmd=td.MsgCmd.CHESS.GRADE_REWARD,e.ids=t.ids,td.ServerDelegate.sendMessage(e)},t.prototype._resGradeReward=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_GRADE_REWARD_SUC,e.rewardResult)},t.prototype._reqGradeUp=function(t){var e={};e.module=td.MsgModuleName.CHESS,e.cmd=td.MsgCmd.CHESS.GRADE_UP,e.id=t.id,td.ServerDelegate.sendMessage(e)},t.prototype._resGradeUp=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_GRADE_UP_SUC,e)},t.prototype._reqSwapOrder=function(t){var e={};e.module=td.MsgModuleName.CHESS,e.cmd=td.MsgCmd.CHESS.SWAP_ORDER,e.from=t.from,e.to=t.to,td.ServerDelegate.sendMessage(e)},t.prototype._resSwapOrder=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHESS_SWAP_ORDER_SUC)},t.prototype._onPushChessInfo=function(t,e){if(t===td.NetCode.SUCCESS){this._initSuc=!0,this._grade=e.dan;var i=this._floor;i!=e.floor+1&&this._resetPveLineRecords(i),this._floor=e.floor+1,this._currency=e.currency,this._rewardTimes=e.rewardTimes,this._rewardState=e.rewardState,this._level=e.level,this._hp=e.hp,this._tokens=e.refreshToken,this._lock=e.lockState,this._skillList=e.skillList,this._saleMap=e.saleMap,this._chessList=e.chessHeroList,this._receiveList=e.receiveList,this._streak=e.winStreak,this._refreshSkillModels(),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_CHESS_MAIN_PANEL)}},t.prototype._refreshSkillModels=function(){for(var t=0;t<this._skillList.length;t++){var e=this._skillList[t],i=this._skillModelsMap[e.type];i||(i=new o.default);var n=td.GetTableClass(td.TableEnum.ChessSkillTable).getSkillById(e.skillId);i.init(n),i.refreshData(e),this._skillModelsMap[e.type]=i}},t.prototype.getGradeRewardsList=function(){var t=td.GetTableClass(td.TableEnum.ChessGradeTable);return null==t?[]:t.getRewardDatas()},t.prototype._resetPveLineRecords=function(t){var e=this.getFloorCfgByFloorAndGrade(this._grade,t);if(e){var i="road_"+e.roadIndex+"_"+s.PVEFightType.CHESS;td.LocalStorageUtil.removeItem(i)}},t.prototype.getGradeCfg=function(t){return void 0===t&&(t=this._grade),td.GetTableClass(td.TableEnum.ChessGradeTable).getDataByGrade(t)},t.prototype.isGradeRewardReceived=function(t){return-1!=this._receiveList.indexOf(t)},t.prototype.isGradeRewardReached=function(t){return this._grade>=t},t.prototype.getSelfRankData=function(){return this._myActorRankInfo},t.prototype.getActorRankList=function(){return this._actorRankList},t.prototype.getLeftTime=function(){var t=td.TimeUtil.getSunDayTime(),e=td.GetConfig("CHESS_SEASON_END_TIME");return t+60*parseInt(e.split(":")[0])*60*1e3+60*parseInt(e.split(":")[1])*1e3-td.TimeUtil.getTime()},t.prototype.getNewSeasonTime=function(){return td.TimeUtil.getSunDayTime()+864e5-td.TimeUtil.getTime()},t.prototype.isSeasonEnd=function(){var t=td.TimeUtil.getSunDayTime(),e=td.GetConfig("CHESS_SEASON_END_TIME"),i=t+60*parseInt(e.split(":")[0])*60*1e3+60*parseInt(e.split(":")[1])*1e3;return td.TimeUtil.getTime()>=i},t.prototype.getPowerTimes=function(){var t=td.Account.getUserData().getFightPower(),e=td.GetConfig("CHESS_LINEUP_POWER_CONVERT_EXPR");return td.GlobalFunction.calculateExpression(e,[t])},t.prototype.getSkillInfo=function(t){for(var e=0;e<this._skillList.length;e++){var i=this._skillList[e];if(i.type==t){var n=td.GetTableClass(td.TableEnum.ChessSkillTable).getSkillById(i.skillId);return n.chessList=i.chessList,n}}},t.prototype.getFloorRewards=function(){var t=td.GetTableClass(td.TableEnum.ChessFloorTable).getDataByGrade(this._grade),e=[],i={};for(var n in t)for(var a=t[n].rewards,r=0;r<a.length;r++){var o=a[r],s=o[0],l=o[1],c=o[2];i[s]||(i[s]={}),i[s][l]||(i[s][l]=0),i[s][l]=i[s][l]+c}for(var s in i)for(var l in i[s])e.push([parseInt(s),parseInt(l),i[s][l]]);return e},t.prototype.getCurSettleRewards=function(){var t=td.GetTableClass(td.TableEnum.ChessFloorTable).getDataByGrade(this._grade),e=[],i={},n=0;for(var a in t)if(!(parseInt(a)>=this._floor)){var r=t[a].rewards;n+=t[a].refreshToken;for(var o=0;o<r.length;o++){var s=r[o],l=s[0],c=s[1],u=s[2];i[l]||(i[l]={}),i[l][c]||(i[l][c]=0),i[l][c]=i[l][c]+u}}for(var l in i)for(var c in i[l])e.push([parseInt(l),parseInt(c),i[l][c]]);return n>0&&e.push([td.RewardType.Item,td.ItemEnum.ChessRefreshToken,n]),e},t.prototype.getCurSweepRewards=function(){return this.getGradeCfg().sweepRewards},t.prototype.needHeroNum=function(t){for(var e=this.getSkillInfo(a.SKILL_TYPE.RIGHT),i=0;i<e.length;i++){var n=e[i][0],r=e[i][1];if(t.getAptitude()==n)return r}},t.prototype.getMaxFloor=function(){return td.GetTableClass(td.TableEnum.ChessFloorTable).getMaxFloor(this._grade)},t.prototype.getMaxLevel=function(){return td.GetTableClass(td.TableEnum.ChessLevelTable).getMaxLevel()},t.prototype.getMaxGrade=function(){return td.GetTableClass(td.TableEnum.ChessGradeTable).getMaxGrade()},t.prototype.getCurrencyRewardNum=function(){var t=td.GetConfig("CHESS_CURRENCY_EXPR"),e=td.GlobalFunction.calculateExpression(t,[this._currency,this._streak]);return parseInt(e)-this._currency},t.prototype.getCurFloorCfg=function(){return td.GetTableClass(td.TableEnum.ChessFloorTable).getFloorData(this._grade,this._floor)},t.prototype.getFloorCfgByFloorAndGrade=function(t,e){return td.GetTableClass(td.TableEnum.ChessFloorTable).getFloorData(this._grade,this._floor)},t.prototype.getCurBattleHeroNum=function(){return this.getCurLevelCfg().count},t.prototype.getCurFloorStoryId=function(){return this._floor},t.prototype.getCurLevelCfg=function(){return td.GetTableClass(td.TableEnum.ChessLevelTable).getDataByLevel(this._level)},t.prototype.getLevelCfg=function(t){return void 0===t&&(t=this._level),td.GetTableClass(td.TableEnum.ChessLevelTable).getDataByLevel(t)},t.prototype.getChessCfg=function(t){return td.GetTableClass(td.TableEnum.ChessHeroTable).getDataById(t)},t.prototype.getSaleArray=function(){for(var t=[],e=0;e<td.GetConfig("CHESS_SALE_COUNT");e++){var i=this._saleMap[e+1];if(i){var n=new r.default;if(n.init(this.getChessCfg(i)),n.setSaleOrderId(e+1),this.isAlreadyChess(i)){var a=this.getChessById(i);n.setCount(a.getCount())}else n.setCount(1);t[e]=n}else t[e]={}}return t},t.prototype.getChessArray=function(){for(var t=[],e=0;e<this._chessList.length;e++){var i=this._chessList[e].orderId,n=this._chessList[e].heroId,a=this._chessList[e].count,o=new r.default;o.init(this.getChessCfg(n)),o.setOrderId(i),o.setCount(a),t.push(o)}return t.sort(function(t,e){return t.getOrderId()-e.getOrderId()}),t},t.prototype.getSalePosByChessId=function(t){for(var e=this.getSaleArray(),i=0;i<e.length;i++){var n=i+1,a=e[i];if(a.myLen()>0&&a.getId()==t)return n}},t.prototype.getCurrencyRelatedNum=function(){var t=[];return t[0]=this._currency,t[2]=parseInt(td.GetConfig("CHESS_FLOOR_CURRENCY")),t[3]=Math.floor(Math.min(10*t[0]/100,t[2])),t[4]=td.GlobalFunction.calculateExpression(td.GetConfig("CHESS_WIN_CURRENCY"),[this._streak]),t[5]=this._streak,t[1]=t[2]+t[3]+t[4],t},t.prototype.getHeroIdByOrder=function(t){return this.getChessByOrder(t).getId()},t.prototype.getChessByOrder=function(t){for(var e=this.getChessArray(),i=0;i<e.length;i++){var n=e[i];if(n.getOrderId()==t)return n}},t.prototype.getChessById=function(t){for(var e=this.getChessArray(),i=0;i<e.length;i++){var n=e[i];if(n.getId()==t)return n}return null},t.prototype.getHeroById=function(t){for(var e=0;e<this._chessList.length;e++){var i=this._chessList[e];if(t==i.heroId)return i}return null},t.prototype.getSkillEffect=function(t){var e={};for(var i in this._skillModelsMap){var n=this._skillModelsMap[i];if(n.isActive()&&n.isEffectToFeature(t))if(e[n.getEffectType()]){var a=n.getEffectValue();if("number"==typeof a)e[n.getEffectType()]+=n.getEffectValue();else if("object"==typeof a){var r=e[n.getEffectType()];r[1]+=a[1],e[n.getEffectType()]=r}}else e[n.getEffectType()]=n.getEffectValue()}return e},t.prototype.isAlreadyChess=function(t){return!!this.getHeroById(t)},t.prototype.isFriend=function(t){for(var e=this.getSkillInfo(a.SKILL_TYPE.RIGHT).chessList,i=0;i<e.length;i++)if(t==e[i])return!0;return!1},t.prototype.isAlreadySettle=function(){var t=td.LocalStorageUtil.read("CHESS_SEASON_SETTLE_TIME");if(!t)return!1;var e=td.TimeUtil.getMondayTime(),i=td.TimeUtil.getSunDayTime(),n=td.GetConfig("CHESS_SEASON_END_TIME"),a=i+60*parseInt(n.split(":")[0])*60*1e3+60*parseInt(n.split(":")[1])*1e3;return t>=e&&t<a},t.prototype.getCfgByPower=function(t){var e=td.GetTableClass(td.TableEnum.ChessGradeTable);return e?e.getCfgByMatchPower(t):null},t.prototype.isRedPointTips=function(){return td.UnlockManager.isTargetUnlock(td.ActorUnlockType.CHESS,0)&&this._rewardTimes>0},t.prototype.redPointEvents=function(){return[td.EventNameEnum.REQ_CHESS_INFO,td.EventNameEnum.ON_CHESS_PREPARE_SUC,td.EventNameEnum.ON_CHESS_GRADE_UP_SUC,td.EventNameEnum.ON_CHESS_SETTLE_SUC,td.EventNameEnum.ON_CHESS_SWEEP_SUC]},t.prototype.isShowGradeReardsRedPoint=function(){for(var e=this.getGradeRewardsList(),i=0;i<e.length;i++){var n=e[i],a=t.getInstance().isGradeRewardReceived(n.dan),r=t.getInstance().isGradeRewardReached(n.dan);if(!a&&r)return!0}return!1},t.prototype.isPowerEnough=function(){return td.Account.getUserData().getHistoryHighestPower()>=this.getGradeCfg().limitPower},t}();i.default=l,cc._RF.pop()},{"../Enum/ChessEnum":"ChessEnum","../Model/ChessModel":"ChessModel","../Model/ChessSkillModel":"ChessSkillModel",ActorRankModel:"ActorRankModel",PveCopyEnum:void 0}],ChessModel:[function(t,e,i){"use strict";cc._RF.push(e,"46902wBBT5JJq0oPhtPzfEB","ChessModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=t("HeroModel"),o=t("../Manager/ChessManager"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._starCount=[],e._starPower=[],e._currency=0,e._star=1,e._count=0,e._orderId=0,e._saleOrderId=0,e._maxStars=4,e._power=0,e._needCounts=[],e._nextCounts=[],e}return n(e,t),e.prototype.init=function(e){if(e){var i=a.GetTableClass(a.TableEnum.HeroTable).getHeroById(e.heroId);t.prototype.init.call(this,i),this._starCount=e.starCount,this._starPower=e.starPower,this._currency=e.currency,this._sId=i.roleId}},e.prototype.getCurrency=function(){return this._currency},e.prototype.getStar=function(){return this._star},e.prototype.getCount=function(){return this._count},e.prototype.setCount=function(t){this._count=t;for(var e=0;e<this._starCount.length;e++){var i=this._starCount[e];if(!(t>=i[1]))break;this._star=i[0]}for(e=0;e<this._starPower.length&&this._star>=this._starPower[e][0];e++)this._power=this._starPower[e][1]},e.prototype.setOrderId=function(t){this._orderId=t},e.prototype.getOrderId=function(){return this._orderId},e.prototype.setSaleOrderId=function(t){this._saleOrderId=t},e.prototype.getSaleOrderId=function(){return this._saleOrderId},e.prototype.getMaxStars=function(){return this._maxStars},e.prototype.getPower=function(){return this._power},e.prototype.getChessPower=function(){return Math.floor(this._power*o.default.getInstance().getPowerTimes())},e.prototype.getBaseAttackPower=function(){return this.getChessPower()},e.prototype.getNeedCount=function(t){void 0===t&&(t=this._star);for(var e=0;e<this._starCount.length;e++){var i=this._starCount[e];if(t==i[0])return i[1]}},e.prototype.getNextNeedCount=function(t){return void 0===t&&(t=this._star),t>=this._maxStars?0:this.getNeedCount(t+1)-this._count},e.prototype.isFullStar=function(){return this._star>=this._maxStars},e}(r);i.default=s,cc._RF.pop()},{"../Manager/ChessManager":"ChessManager",HeroModel:"HeroModel"}],ChessRankRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"be95baGLKNNUb/tR9E7NgSn","ChessRankRewardTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ChessRankRewardTable",e._tblName="chess_rank_reward_config",e._data=[],e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._data.push(e)}this._data.sort(function(t,e){return t.rank-e.rank})},e.prototype.getDatas=function(){return this._data},e.prototype.getRanks=function(){for(var t=[],e=0;e<this._data.length;e++){var i=this._data[e],n={min:0,max:0,rewards:[],rank:1};n.min=e>0?this._data[e-1].rank+1:i.rank,n.max=i.rank,n.rewards=i.rewards,t.push(n)}return t},e.prototype.getMyRankReward=function(t){for(var e=this.getRanks(),i=0;i<e.length;i++){var n=e[i];if(t>=n.min&&t<=n.max)return n.rewards}},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChessSkillModel:[function(t,e,i){"use strict";cc._RF.push(e,"45c40Fz1/BGlYuAL+8RLpIM","ChessSkillModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Manager/ChessManager"),a=function(){function t(){this._skillId=0,this._skillType=0,this._effectFeatures=[],this._effectType=0,this._effectValue=null,this._needHeros=[],this._iconRes="",this._name="",this._des="",this._isActive=!1,this._activeHeroIds=[]}return t.prototype.init=function(t){this._skillId=t.skillId,this._skillType=t.skillType,this._effectFeatures=t.features,this._effectType=t.effectType,this._effectValue=t.effectValue,this._needHeros=t.heroes,this._iconRes=t.iconRes,this._name=t.name,this._des=t.des},t.prototype.refreshData=function(t){if(this._activeHeroIds=t.chessList,this._needHeros&&this._needHeros.length<=0)this.setActive(!0);else{this.setActive(!0);for(var e=0;e<this._activeHeroIds.length;e++){var i=this._activeHeroIds[e];if(!n.default.getInstance().getHeroById(i)){this.setActive(!1);break}}}},t.prototype.getSkillId=function(){return this._skillId},t.prototype.getSkillType=function(){return this._skillType},t.prototype.getEffectFeatures=function(){return this._effectFeatures},t.prototype.getEffectType=function(){return this._effectType},t.prototype.getEffectValue=function(){return this._effectValue},t.prototype.getNeedHeros=function(){return this._needHeros},t.prototype.getIconRes=function(){return this._iconRes},t.prototype.getName=function(){return this._name},t.prototype.getDes=function(){return this._des},t.prototype.isActive=function(){return this._isActive},t.prototype.setActive=function(t){this._isActive=t},t.prototype.getActiveHeros=function(){return this._activeHeroIds},t.prototype.setActiveHeros=function(t){this._activeHeroIds=t},t.prototype.isEffectToFeature=function(t){return-1!=this._effectFeatures.indexOf(t)},t}();i.default=a,cc._RF.pop()},{"../Manager/ChessManager":"ChessManager"}],ChessSkillTable:[function(t,e,i){"use strict";cc._RF.push(e,"4a917uBrvZLSLYxAFG9SRPQ","ChessSkillTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ChessSkillTable",e._tblName="chess_skill_config",e._data=[],e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._data.push(e)}this._data.sort(function(t,e){return t.skillId-e.skillId})},e.prototype.getSkillById=function(t){for(var e=0;e<this._data.length;e++){var i=this._data[e];if(i.skillId==t)return i}},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ChooseHeroWindow:[function(t,e,i){"use strict";cc._RF.push(e,"7d813p+x6VIR6VZwJahfdJq","ChooseHeroWindow");var n=t("PveBuildTowerManager"),a=cc.Class({extends:cc.Component,properties:{_imgChooseBg:null,_curFlagTag:null,_startTime:0},onLoad:function(){this._curFlagTag=0,this.node.active=!1,this._imgChooseBg=this.node.getChildByName("imgWidgetBg"),this.heroItem=this.node.getChildByName("heroItem"),this.heroItem.active=!1,this._addEventListener()},_setPanelSelfAdaption:function(){td.UIAdaptiveUtil.adaptiveWinSizeWidth(this.node)},_addEventListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.CHOOSE_BUILD_TOWER,this.setChooseWindow,this)},_removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},onEnable:function(){this._startTime=(new Date).getTime()},onDestroy:function(){this._curFlagTag=null,this._removeListeners()},setChooseWindow:function(t){this._curFlagTag=t,this.node.active=!0;var e=n.getHerosCanBuild();this._imgChooseBg.removeAllChildren();for(var i=0,a=e.length;i<a;i++){var r=e[i],o=cc.instantiate(this.heroItem);this._imgChooseBg.addChild(o),o.active=!0,o.name=""+i;var s=o.addComponent(cc.Button);if(td.GuideManager.isFirstBattle()){if(t+1e3===r.getSid()){var l=td.GlobalFunction.createClickEventHandler(this,"ChooseHeroWindow","buildTower",r);s.clickEvents=[],s.clickEvents.push(l)}}else{var c=td.GlobalFunction.createClickEventHandler(this,"ChooseHeroWindow","buildTower",r);s.clickEvents=[],s.clickEvents.push(c)}var u=o.getChildByName("imgFrame"),d=o.getChildByName("imgFeature"),h=o.getChildByName("lablSkill"),p=o.getChildByName("lablSkillOrMagic"),_=o.getChildByName("imgSkill"),g=o.getChildByName("imgPhysicalOrMagic"),f=o.getChildByName("lanFightPower"),v=o.getChildByName("labHeroName"),m=o.getChildByName("imgHero"),y=o.getChildByName("imAptidude"),E=o.getChildByName("imgSelect"),T=o.getChildByName("imgFightWord");E.active=td.GuideManager.isFirstBattle()&&t+1e3===r.getSid();var C=r.getFeatures(),R=td.PveEnum.getVocationHurtType(C),S=r.getMercenaryDataModel();f.getComponent(cc.Label).string=r.getAttackPower(),v.getComponent(cc.Label).string=r.getName(),td.GlobalFunction.setNameColors(v,S.getQuality()),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_touxiang,S.getIconRes(),m),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_zhiye_0"+C,d),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_yxpj_0"+S.getAptitude(),y),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_zhanlitubiao",T),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_zhuangbeik_0"+S.getQuality(),u),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,R===td.PveEnum.PVE_HURT_TYPE.Physical?"PVE_attack_type_01":"PVE_attack_type_02",g),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"PVE_jineng_0"+C,_),p.getComponent(cc.Label).string=td.Language["vacation_attack_type_"+R],h.getComponent(cc.Label).string=td.Language["pve_vacation_skill_"+C]}},buildTower:function(t,e){if(!((new Date).getTime()-this._startTime<=400))if(td.PveFightManager.canBuildMoreTower())this.node.active=!1,td.EventUtil.dispatchEvent(td.EventNameEnum.ON_BUILD_TOWER,{heroDataModel:e,tag:this._curFlagTag,bAction:!0}),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.ON_LINE);else{var i=td.Language.PVE_TXT_2;td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SHOW_TIP_MESSAGE,i)}},hideChooseWindou:function(){td.GuideManager.isFirstBattle()||(this.node.active=!1)}});e.exports=a,cc._RF.pop()},{PveBuildTowerManager:"PveBuildTowerManager"}],ChuanSongMen:[function(t,e,i){"use strict";cc._RF.push(e,"0d887R7ip5A8qpmtCd2YKWB","ChuanSongMen");var n=t("CommonSkill"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_endDelayTime:null,_bEnd:null},initData:function(t){this._super(t),this._skillName="ChuanSongMen",this._endDelayTime=1.1,this._bEnd=!1},update:function(t){for(var e=this._dataModel.getDamageRange(),i=a.getEnemyArray(),n=this.node.getPosition(),r=0,o=i.length;r<o;r++){var s=i[r];if(s){var l=s._tag,c=Math.floor(l/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),u=s.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[c]),d=u.bDeath(),h=u.getDataModel(),p=u.getTransferStatus(),_=h.getGrade()===td.PveEnum.PVE_ENERMY_GRADE.BOSS||h.getGrade()===td.PveEnum.PVE_ENERMY_GRADE.DEMON_BOSS||h.getGrade()===td.PveEnum.PVE_ENERMY_GRADE.SMALLBOSS;if(!(d||_||p)){var g=s.getPosition();td.GlobalFunction.getDistance(n,g)<=e/2&&!this._bEnd&&this.tryToTransferEnemy(s)}}}},updateContinueTime:function(t){this._animationContinueTime-=t*this._curSpeedMult,this._animationContinueTime<=0&&(this._bEnd=!0,this.unschedule(this.updateContinueTime),this.schedule(this.updateEndDelayTime,1/60))},updateEndDelayTime:function(t){this._endDelayTime-=t*this._curSpeedMult,this._endDelayTime<=0&&(this.unschedule(this.updateEndDelayTime),this.removeSelf())},tryToTransferEnemy:function(t){var e=t._tag,i=Math.floor(e/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),n=t.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[i]);n.setTransferStatus(!0);var a=t.getPosition(),r=this.node.getPosition(),o=cc.v2(r.x+1,r.y+82),s=td.GlobalFunction.getDistance(a,o)/150/this._curSpeedMult,l=cc.moveTo(s,o),c=cc.scaleTo(s,0),u=cc.spawn(l,c),d=cc.callFunc(function(){n.transferToSpawnPoint()}),h=cc.scaleTo(.2,1),p=cc.callFunc(function(){n.setTransferStatus(!1)}),_=cc.sequence(u,d,h,p);t.runAction(_)},frameEventCallBack:function(){}});e.exports=r,cc._RF.pop()},{CommonSkill:"CommonSkill",PveFightManager:"PveFightManager"}],ChuangYunJian:[function(t,e,i){"use strict";cc._RF.push(e,"a9348Ar2MpN4b+ZtA/FtfBX","ChuangYunJian");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{_moveSpeed:600},initData:function(t){this._super(t),this._skillName="ChuangYunJian";for(var e=this.node.getComponent(cc.Animation).getClips(),i=0,n=e.length;i<n;i++)e[i]&&(e[i].wrapMode=cc.WrapMode.Loop);this.node.group=td.PveEnum.COLLISION_GROUP.SkillFlyGroup,this.node.addComponent(cc.BoxCollider).size=cc.size(500,200)},onEnable:function(){var t=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),e=this._curTargetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[t]).getColliderPos(),i=this.node.position,n=td.GlobalFunction.getDistance(e,i),a=e.x-i.x,r=e.y-i.y;this._speedX=a/n,this._speedY=r/n},finishedEventCallBack:function(){},onCollisionEnter:function(t){if(t.node.group===td.PveEnum.COLLISION_GROUP.EnemyGroup){cc.log("ChuangYunJian:onCollisionEnter "+t.node._id);var e=this._dataModel.getSkillPower(),i=this._curHeroAttackPower*e,n=this._cutHurtType,a=Math.floor(t.node._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),r=t.node.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[a]),o=r.getTransferStatus();if(!r.bDeath()&&!o){for(var s=this._dataModel.getAttackEffect(),l=0,c=s.length;l<c;l++){var u=s[l];u[0]===td.PveEnum.PVE_EFFECT_TYPE.PureHurt1&&(i+=u[1])}r.setHurt(this._heroSid,i,n,this._attackerVocation),this.setAttackEffectToEnemy(this._curTargetEnemy)}}},updateContinueTime:function(t){},update:function(t){if(!this._bFightPause){this._super(t);var e=t*this._moveSpeed*this._curSpeedMult,i=this._speedX*e,n=this._speedY*e;this.node.x+=i,this.node.y+=n;var a=this._calcRotationDegree();this.node.rotation=a,(this.node.x<-600||this.node.x>1300||this.node.y>1800||this.node.y<-600)&&this.removeSelf()}},_calcRotationDegree:function(){var t=180*Math.atan2(this._speedY,this._speedX)/Math.PI;return t<=0?-t:360-t}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],CityDefenderModel:[function(t,e,i){"use strict";cc._RF.push(e,"e8068fe2btP2YYmnNIv/i5S","CityDefenderModel");var n=window.td,a=t("CitySiegeMonster"),r=function(){function t(){this._monsterTotalHp=0}return t.prototype.init=function(t,e){var i=n.GetTableClass(n.TableEnum.MonsterGroup),r=n.GetTableClass(n.TableEnum.Monster),o=n.GetTableClass(n.TableEnum.MonsterCapabilityConfig),s=t.monsterGroups;this._defenderArray=[],this._monsterTotalHp=0;for(var l=0;l<s.length;l++){var c=s[l],u=i.getMonsterGroupById(c);if(!u||!u.group)return void cc.log("get CitySiegeDefenderModel boss group error for id = "+c);for(var d=u.group,h=0,p=0;p<d.length;p++){var _=d[p][0],g=r.getMonsterDataById(_),f=o.getMonsterNumberDataById(g.capabilityId).hp;if(e&&(f=n.PercentNumberUtil.getPercentValue(f,e)),h+=f,0===p){var v=new a;v.init(g),this._defenderArray[l]=v}}this._defenderArray[l].setFightPower(u.power),this._defenderArray[l].setTotalHp(h)}for(var m=0,y=t.monsterHps,E=0;E<y.length;E++){m+=f=y[E][1]}this._monsterTotalHp=m*n.SystemManager.getServerOpenDays()},t.prototype.getDefenderArray=function(){return this._defenderArray},t.prototype.getMonsterTotalHp=function(){return this._monsterTotalHp},t.prototype.updateMonsterLeftHp=function(t){for(var e=0;e<t.length;e++){var i=t[e],n=this._defenderArray[e];n&&n.setLeftHp(i)}},t}();e.exports=r,cc._RF.pop()},{CitySiegeMonster:"CitySiegeMonster"}],CitySiegeMonster:[function(t,e,i){"use strict";cc._RF.push(e,"7b07fq2QXREcavf9tpFb5bV","CitySiegeMonster");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._fightPower=0,e._leftHp=0,e._totalHp=0,e}return n(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e,"CitySiegeMonster")},e.prototype.setTotalHp=function(t){this._totalHp=t},e.prototype.getTotalHp=function(){return this._totalHp},e.prototype.setLeftHp=function(t){this._leftHp=t},e.prototype.getLeftHp=function(){return this._leftHp},e.prototype.getHpPercent=function(){var t=this._leftHp/this._totalHp;return t=(t=t<0?0:t)>1?1:t},e.prototype.getHpPercentText=function(){return(100*this.getHpPercent()).toFixed(2)+"%"},e.prototype.setFightPower=function(t){this._fightPower=t},e.prototype.getFightPower=function(){return this._fightPower},e}(t("MonsterModel")));e.exports=a,cc._RF.pop()},{MonsterModel:"MonsterModel"}],CitySiegePlayerModel:[function(t,e,i){"use strict";cc._RF.push(e,"ff6b29nYfZC9qiWnbV32zdt","CitySiegePlayerModel");window.td;var n=t("NationSimpleInfo"),a=function(){function t(){this._rank=0,this._damage=0,this._defend=0}return t.prototype.init=function(t){this._rank=t.rank||0,this._damage=t.damage||0,this._defend=t.nationDefend||0,this._nationSimpleInfo=new n,this._nationSimpleInfo.init(t.nation)},t.prototype.getRank=function(){return this._rank},t.prototype.getDefend=function(){return this._defend},t.prototype.getDamage=function(){return this._damage},t.prototype.getNationSimpleInfo=function(){return this._nationSimpleInfo},t}();e.exports=a,cc._RF.pop()},{NationSimpleInfo:"NationSimpleInfo"}],CollectHerosController:[function(t,e,i){"use strict";cc._RF.push(e,"383a8Rzo/lNg4boVzIfz9oy","CollectHerosController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataID=1001,e._heroCount=0,e._receiveList=[],e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this._dataID=this.getActivityData()},e.prototype.activityParse=function(t){var e=t.record;this._heroCount=e.count||0,this._receiveList=e.receiveList||[],this._receiveList.sort(function(t,e){return t-e}),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_COLLECTHERO_INFO)},e.prototype.getHerosCount=function(){return this._heroCount},e.prototype.getMyCurSectionData=function(){var t=td.GetTableClass(td.TableEnum.MobilizationTable),e=t.getDataByDataIdAndDay(this._dataID,td.SystemManager.getServerOpenDays()),i=0;this._receiveList&&this._receiveList.length>0&&(i=this._receiveList.length-1);t.getDataByDataIdAndId(this._dataID,i+1);var n=t.getDataByDataIdAndNum(this._dataID,this._heroCount);if(n.id>=e.id)return e;if(this._heroCount<n.count)return n;var a=t.getDataByDataIdAndId(this._dataID,n.id+1);return a.id<=e.id?a:e},e.prototype.getAllDatas=function(){var t=td.GetTableClass(td.TableEnum.MobilizationTable);return t?t.getDatasByDataId(this._dataID):[]},e.prototype.isSectionOpen=function(t){var e=td.GetTableClass(td.TableEnum.MobilizationTable);if(!e)return!1;var i=td.SystemManager.getServerOpenDays();return e.getDataByDataIdAndId(this._dataID,t).serverOpenDay<=i},e.prototype.isSectionReach=function(t){var e=td.GetTableClass(td.TableEnum.MobilizationTable);if(!e)return!1;var i=e.getDataByDataIdAndId(this._dataID,t);return this._heroCount>=i.count},e.prototype.isSectionReceived=function(t){return-1!=this._receiveList.indexOf(t)},e.prototype.getSectionOpenTime=function(t){var e=td.GetTableClass(td.TableEnum.MobilizationTable);if(!e)return"";var i=e.getDataByDataIdAndId(this._dataID,t),n=td.SystemManager.getServerOpenDays(),a=i.serverOpenDay-n,r=td.TimeUtil.getTime(),o=new Date(r),s=864e5-1e3*(60*(60*o.getHours()+o.getMinutes())+o.getSeconds()),l=td.TimeUtil.getHourFromMilliSecond(s);return a-1>0?a-1+td.Language.day+l:l},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){for(var t=this.getAllDatas(),e=0;e<t.length;e++){var i=t[e],n=this._heroCount>=i.count,a=this.isSectionReceived(i.id);if(this.isSectionOpen(i.id)&&n&&!a)return!0}return!1},e.prototype.redPointEvts=function(){return[td.EventNameEnum.RES_COLLECTHERO_INFO,td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]},e}(t("ActivityBaseController"));i.default=a,e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],CollectHerosItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"3d74fdJL5hNS7bfc+g+Pdqd","CollectHerosItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTargetDesc=null,e.labProgress=null,e.labNeed=null,e.nodeRewards=null,e.btnReceive=null,e.imgReceived=null,e.imgUnreach=null,e.imgRedPoint=null,e._activityController=null,e._curData=null,e}return n(e,t),e.prototype.onEnable=function(){this._activityController=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_29)},e.prototype.updateItem=function(t,e){this._curData=e;var i=this._activityController.getHerosCount();i>=this._curData.count?(i=this._curData.count,this.labProgress.node.color=cc.color(1,174,9)):this.labProgress.node.color=cc.color(233,0,0),this.labNeed.string="/"+this._curData.count,this.labProgress.string=i+"",this.labTargetDesc.string=cc.js.formatStr(r.Language.mobilirtext,this._curData.count);var n=this._activityController.isSectionOpen(this._curData.id),a=this._activityController.isSectionReach(this._curData.id),o=this._activityController.isSectionReceived(this._curData.id);this.btnReceive.active=!o&&a,this.imgReceived.active=o,this.imgUnreach.active=!a,this.imgRedPoint.active=this.btnReceive.active&&n;var s=this._curData.rewards;this.nodeRewards.removeAllChildren();for(var l=0;l<s.length;l++){var c=s[l],u=r.RewardManager.getRewardDetail(c),d=r.GlobalFunction.createCommonIconWidget(37,u);this.nodeRewards.addChild(d)}this.nodeRewards.scale=.8},e.prototype.onBtnReceiveClick=function(){if(!this._activityController.isSectionOpen(this._curData.id)){var t=new r.BroadcastContent(402),e=new r.BroadcastParam(this._activityController.getSectionOpenTime(this._curData.id)),i=new r.BroadcastParam(this._curData.id);return t.setMainParam([e,i]),void r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,t)}var n={};n.id=this._curData.id,this._activityController.operateActivity(n)},a([l(cc.Label)],e.prototype,"labTargetDesc",void 0),a([l(cc.Label)],e.prototype,"labProgress",void 0),a([l(cc.Label)],e.prototype,"labNeed",void 0),a([l(cc.Node)],e.prototype,"nodeRewards",void 0),a([l(cc.Node)],e.prototype,"btnReceive",void 0),a([l(cc.Node)],e.prototype,"imgReceived",void 0),a([l(cc.Node)],e.prototype,"imgUnreach",void 0),a([l(cc.Node)],e.prototype,"imgRedPoint",void 0),e=a([s,c("module/Activity/CollectHerosItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],CollectHerosPanel:[function(t,e,i){"use strict";cc._RF.push(e,"5e753zH+2pBGJQkSF9ijg+U","CollectHerosPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("OptimizeVerticalListView"),d=(t("OptimizeHorizontalListView"),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labActivityTime=null,e.labSection=null,e.imgSection=null,e.scroll=null,e.richTargetDesc=null,e._activityController=null,e._listView=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Panel,this._panelEnum=r.PanelEnum.Panel_CollectHeros},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._activityController=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_29),this._addEventListener(),this._activityController&&(this._listView=this.scroll.getComponent(u),this._refresUI(),this.schedule(this._updateLeftTime,1))},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),this.unschedule(this._updateLeftTime),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]=this._refresUI,r.EventUtil.registerEvents(t,this)},e.prototype._updateLeftTime=function(){var t=this.getActivityLeftTimeStr();this.labActivityTime.string=t},e.prototype._refresUI=function(){var t=this._activityController.getMyCurSectionData();r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Activity_yxjjh,"HD_jieduan_0"+t.id,this.imgSection);var e=cc.js.formatStr(r.Language.mobiliotext,t.count);this.richTargetDesc.string=e;var i=this._activityController.getAllDatas();this._listView.setData(i)},e.prototype.onBtnGotoClick=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_ObtainWay2,[2,45])},a([l(cc.Label)],e.prototype,"labActivityTime",void 0),a([l(cc.Label)],e.prototype,"labSection",void 0),a([l(cc.Node)],e.prototype,"imgSection",void 0),a([l(cc.Node)],e.prototype,"scroll",void 0),a([l(cc.RichText)],e.prototype,"richTargetDesc",void 0),e=a([s,c("module/Activity/CollectHerosPanel")],e)}(t("ActivityBasePanel")));i.default=d,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeHorizontalListView:void 0,OptimizeVerticalListView:void 0}],CollectWordController:[function(t,e,i){"use strict";cc._RF.push(e,"50923L6t4ZHW4FBDmXBfE+Y","CollectWordController");var n=t("ActivityBaseController"),a=t("CollectWordModel"),r=cc.Class({extends:n,properties:{_modelList:null,_receiveMap:null,_modelObj:null},initData:function(t){this._super(t),this.clearData()},clearData:function(){this._modelList=[],this._receiveMap={},this._modelObj={}},getModelList:function(){return this._modelList},getModelById:function(t){return this._modelObj[t]},getExchageTimesById:function(t){return this._receiveMap[t]||0},activityParse:function(t){var e=t.record;this._receiveMap=e.receiveMap||{},this._modelList=[],this._modelObj={};for(var i=td.GetTableClass(td.TableEnum.ActivityCollectWordConfig).getDatasOfDataId(this.getActivityData()),n=0,r=i.length;n<r;n++){var o=i[n],s=new a;s.initData(o);var l=s.getId();this._modelObj[l]=s,this._modelList.push(s)}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_COLLECT_WORD_INFO)},hasRedPoint:function(){return!1},redPointTip:function(){return!1},redPointEvts:function(){return[]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",CollectWordModel:"CollectWordModel"}],CollectWordExchangeWindow:[function(t,e,i){"use strict";cc._RF.push(e,"19f13zOXo1H17DM0MU/jAkM","CollectWordExchangeWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=(o.menu,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemName=null,e.progressBar=null,e.sliderBar=null,e.operateCountLabel=null,e.lab_title=null,e.lab=null,e._operateNum=0,e._limitNum=0,e._value=0,e._curActivityType=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.None,this._panelEnum=r.PanelEnum.Window_CollectWordExchange},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this.sliderBar.node.on("slide",this.onSliderChange,this)},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this._itemData=null},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.REFRESH_COLLECT_WORD_INFO]=this.closeCallFunc,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e,i){t.prototype.setData.call(this,e),this._curActivityType=e.activityType||r.ActivityEnum.ActivityType.CollectWord,this._itemData=e.item,this._limitNum=e.max,this._operateId=e.id,e.operateNum?this._operateNum=e.operateNum:this._operateNum=1,this._refreshBaseInfo(),this._updateProgress()},e.prototype._refreshBaseInfo=function(){var t=this._itemData;this.itemName.getComponent(cc.Label).string=t.getName(),r.GlobalFunction.setNameColors(this.itemName,t.getQuality());var e=this.node.getChildByName("itemIcon");e?e.getComponent("CommonIconWidget").setData(t):((e=r.GlobalFunction.createCommonIconWidget(26,t)).name="itemIcon",this.node.addChild(e),e.position=cc.v2(-205,205),e.getComponent("CommonIconWidget").disableHeadTouch())},e.prototype._updateProgress=function(){this.operateCountLabel.string=cc.js.formatStr("%s/%s",this._operateNum,this._limitNum),this._priceModel=this._itemData;var t=this._operateNum/this._limitNum;this.progressBar.progress=t,this.sliderBar.progress=t},e.prototype.onSliderChange=function(t){var e=t.progress;this._operateNum=Math.floor(this._limitNum*e),this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onOperateNum=function(t,e){e=parseInt(e),this._operateNum+=e,this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onBtn=function(){var t=r.ActivityDataManager.getActivityControllerByType(this._curActivityType),e={};this._curActivityType==r.ActivityEnum.ActivityType.CollectWord?(e.id=this._operateId,e.parmeterMap={18:this._operateNum}):this._curActivityType==r.ActivityEnum.ActivityType.Festival?(e.id=this._operateId,e.parmeterMap={6:this._operateNum,40:2},this.closeCallFunc()):this._curActivityType==r.ActivityEnum.ActivityType.ACTIVITY_TYPE_12?(e.id=this._operateId,e.parmeterMap={6:this._operateNum,12:2},this.closeCallFunc()):this._curActivityType==r.ActivityEnum.ActivityType.PetExchange&&(e.id=this._operateId,e.parmeterMap={6:this._operateNum},this.closeCallFunc()),t.operateActivity(e)},a([l(cc.Node)],e.prototype,"itemName",void 0),a([l(cc.ProgressBar)],e.prototype,"progressBar",void 0),a([l(cc.Slider)],e.prototype,"sliderBar",void 0),a([l(cc.Label)],e.prototype,"operateCountLabel",void 0),a([l(cc.Label)],e.prototype,"lab_title",void 0),a([l(cc.Label)],e.prototype,"lab",void 0),e=a([s],e)}(t("PanelBase")));i.default=c,cc._RF.pop()},{PanelBase:void 0}],CollectWordItem:[function(t,e,i){"use strict";cc._RF.push(e,"4e5b9qucDJGBI3mpyZgxd5r","CollectWordItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{_controller:null,_canBuyMaxCount:null,_itemData:null,_itemId:null},updateItem:function(t,e){this._super(t,e);var i=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.CollectWord),n=e.getId();this._itemId=n;var a=e.getTimes(),r=a-i.getExchageTimesById(n);this.node.getChildByName("exchangeCount").getComponent(cc.Label).string=r+"/"+a;var o=this.node.getChildByName("contentNode"),s=o.getChildByName("costNode"),l=e.getCost(),c=this.node.getChildByName("wordItem"),u=s.getChildrenCount(),d=!0;this._canBuyMaxCount=r;for(var h="",p=0,_=l.length;p<_;p++){var g=l[p];if(R=s.getChildByName("cost"+(p+1))){R.getChildByName("icon").getComponent("CommonIconWidget").setData(g)}else{R=cc.instantiate(c);var f=td.GlobalFunction.createCommonIconWidget(1,g);R.setName("cost"+(p+1)),s.addChild(R),R.addChild(f),f.setName("icon"),R.setScale(.6)}R.active=!0,h+=g.getName(),p!=_-1&&(h+="\u3001");var v=R.getChildByName("icon"),m=td.ItemManager.getItemNumById(g.getId()),y=g.getCount();(S=R.getChildByName("richText")).active=!0,S.getComponent(cc.RichText).string=m>=y?cc.js.formatStr("<size=32><color=#05BB09>%s</c><color=#AD6201>/%s</color></size>",m,y):cc.js.formatStr("<size=32><color=#FF0000>%s</c><color=#AD6201>/%s</color></size>",m,y),this._canBuyMaxCount=Math.min(this._canBuyMaxCount,Math.floor(m/y)),td.GlobalFunction.graySprite(v,m<y),d&&m<y&&(d=!1)}for(;p<u;p++){var E=s.getChildByName("cost"+(p+1));E&&E.removeFromParent()}s.setContentSize(cc.size(_*c.width,c.height)),s.getComponent(cc.Layout).updateLayout(),this.node.getChildByName("titleNode").getChildByName("label2").getComponent(cc.Label).string=cc.js.formatStr("\u3010%s\u3011",h);var T=o.getChildByName("rewardNode"),C=e.getRewards();for(u=T.getChildrenCount(),p=0,_=C.length;p<_;p++){var R,S,I=C[p];if(R=T.getChildByName("reward"+(p+1))){(v=R.getChildByName("icon")).getComponent("CommonIconWidget").setData(I)}else{R=cc.instantiate(c);f=td.GlobalFunction.createCommonIconWidget(26,I);R.setName("reward"+(p+1)),T.addChild(R),R.addChild(f),f.setName("icon"),R.setScale(.6)}R.active=!0,(S=R.getChildByName("richText")).active=!1}for(;p<u;p++){var A=s.getChildByName("reward"+(p+1));A&&A.removeFromParent()}T.setContentSize(cc.size(_*c.width,c.height)),T.getComponent(cc.Layout).updateLayout();var b=this.node.getChildByName("btnGoto");td.GlobalFunction.setButtonGray(b,!d),this._itemData=C[0]},onClickBtnGoto:function(){var t=this._canBuyMaxCount,e={};e.item=this._itemData,e.max=t,e.id=this._itemId,td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_CollectWordExchange,e)}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],CollectWordModel:[function(t,e,i){"use strict";cc._RF.push(e,"9b2afXdAWJCxaFer/gj5pRi","CollectWordModel");var n=cc.Class({properties:{_id:null,_reward:null},initData:function(t){this._data=t.data,this._id=t.id,this._times=t.times,this._cost=td.RewardManager.parseRewardListDetail(t.cost),this._reward=td.RewardManager.parseRewardListDetail(t.reward)},getId:function(){return this._id},getData:function(){return this._data},getCost:function(){return this._cost},getTimes:function(){return this._times},getRewards:function(){return this._reward}});e.exports=n,cc._RF.pop()},{}],CollectWordPanel:[function(t,e,i){"use strict";cc._RF.push(e,"51b6dVQ/ZNEBYLZPW9BqOB9","CollectWordPanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{activityTimeLabel:cc.Node,endTimeLabel:cc.Node,countDownTimeStamp:cc.Label,countDownTimeStamp2:cc.Label},initData:function(t){this._super(t)},onLoad:function(){var t=this.node.getChildByName("scrollView");this._listView=t.getComponent("OptimizeVerticalListView")},onEnable:function(){this._super(),this._addLocalListeners(),this._firstEnter=!0,gdk.Timer.once(50,this,this._refreshList)},onDisable:function(){gdk.Timer.clearAll(this),td.EventUtil.unregisterAllEvents(this),this._super()},_addLocalListeners:function(){var t=td.EventUtil,e={};e[td.EventNameEnum.REFRESH_COLLECT_WORD_INFO]=this._refreshList,t.registerEvents(e,this)},_refreshList:function(){var t=this.getActivityController();if(t){this.countDownTimeStamp.string=this.getOpenStr(!0),this.countDownTimeStamp2.string=this.getSleepTimeStr(!0);var e=t.getModelList();this._firstEnter?this._listView.setData(e):this._listView.refreshCurList(e),this._firstEnter=!1}},scrollSV:function(t,e){var i=t.node.getComponent("OptimizeVerticalListView").getItemSize().height,n=t.getScrollOffset();this.firstIndex=Math.floor(n.y/i)}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],CombineActivityShowConfig:[function(t,e,i){"use strict";cc._RF.push(e,"ee987fXnQVCBbZLKKa5thb5","CombineActivityShowConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"CombineActivityShowConfig",properties:{_tblName:"combine_activity_show_config",_cfgShowData:null},init:function(){this._cfgShowData={};for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];n.uiPrefab="prefab/Activity/"+n.uiPrefab,n.bannerBg&&""!==n.bannerBg&&(n.bannerBg="Activity_bg/"+n.bannerBg),this._cfgShowData[n.activityType]=n}},getCrossShowDataByType:function(t){return this._cfgShowData[t]?this._cfgShowData[t]:(cc.log(cc.js.formatStr("the cross activity is not exist with activityType = %s",t)),null)}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CommonIconWidget:[function(t,e,i){"use strict";cc._RF.push(e,"66645wz1yhN0L+O37x9QWGt","CommonIconWidget");var n=r(t("../Hero/Manager/HeroManager")),a=r(t("../Equip/Manager/EquiptManager"));function r(t){return t&&t.__esModule?t:{default:t}}t("NodePoolManager");var o=cc.Class({extends:cc.Component,properties:{_touchCallBack:null,_isObtainWay:!1,_isGray:!1,_isNameBgVisible:!0,_isLessShowObtainWay:!1,_isAddedToNode:!1},init:function(t,e,i){void 0===i&&(i=!1),this.node.setName("CommonIconWidget"),this._type=t,this._curData=e,this._isGray=i,this._isNameBgVisible=!0,this._curData&&this._initData()},setType:function(t){this._type!==t&&(this._type=t)},getType:function(){},setData:function(t){this._curData=t,this._curData&&this._initData()},getData:function(){return this._curData},_initData:function(){for(var t=this.node.getChildren(),e=0,i=t.length;e<i;e++)t[e]&&(t[e].active=!1);this._isAddedToNode&&this._initUI()},onEnable:function(){this._isAddedToNode=!0,this._initUI()},onDisable:function(){gdk.Timer.clearAll(this)},_initUI:function(){if(this._type)for(var t=td.IconShowType[this._type],e=0,i=t.length;e<i;e++)this._addChildWidget(t[e])},_addChildWidget:function(t){switch(t){case 1:break;case 2:this._setQualityBgImg();break;case 3:this._setHeadImg();break;case 4:this._setLevelBgAndText();break;case 5:this._addEvolveLevelText();break;case 6:if(this._curData.getCount)var e=this._curData.getCount();this.setNum(e);break;case 7:this._setEquippedImg();break;case 8:this._setNameLabel();break;case 9:this._setVocationImg();break;case 10:this._addRelationImg();break;case 11:this._addStarLevel();break;case 12:this._addCultivateLevel();break;case 13:this._addAnimation();case 14:this._addSoulLinkImg();break;case 15:this.showStars();break;case 16:this._setCampImg();break;case 17:this._setCampMark();break;case 18:this.hideAptitude();break;case 19:this.hideFragment()}},setDark:function(){for(var t=td.IconShowType[this._type],e=0,i=t.length;e<i;++e)this._setChildWidgetBrightType(t[e],!1)},showStars:function(){var t=this._curData,e=this.node.getChildByName("starsPanel");e.active=!0;var i=this._curData.getGoodsType();if(i!==td.GoodsType.Type_Item){var n,r=e.getChildByName("Star_0"),o=0;if(i===td.GoodsType.Type_Equip){if(t.getQuality()<a.default.getInstance().getEvolveQualityLimit())return void(e.active=!1);n=t.getEvolveIconRes(),o=5}else i===td.GoodsType.Type_Pet&&(n=t.getStarRes(),o=5);for(var s=0;s<o;s++){var l=e.getChildByName("Star_"+s);l||((l=cc.instantiate(r)).name="Star_"+s,l.active=!0,e.addChild(l)),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,n[s],l)}}else e.active=!1},setBright:function(){for(var t=td.IconShowType[this._type],e=0,i=t.length;e<i;++e)this._setChildWidgetBrightType(t[e],!0)},setNameScale:function(t){var e=this.node.getChildByName("nameLabel");e&&e.setScale(t)},setNameFontSize:function(t){var e=this.node.getChildByName("nameLabel");e&&e.setFontSize(t)},_setChildWidgetBrightType:function(t,e){var i;switch(t){case 1:break;case 2:i=this.node.getChildByName("qualityBgImg");break;case 3:i=this.node.getChildByName("headImg");break;case 4:i=this.node.getChildByName("starLevelFrameImg");break;case 5:case 6:break;case 7:i=this.node.getChildByName("equipedImg");break;case 8:break;case 9:i=this.node.getChildByName("vocationImg")}i&&(e?i.setColor(cc.color(255,255,255)):i.setColor(cc.color(160,160,160)))},disableHeadTouch:function(){this.setTouchEnabled(!1)},setTouchEnabled:function(t){var e=this.node.getChildByName("qualityBgImg");cc.isValid(e)?(e.off(cc.Node.EventType.TOUCH_END,this.touchIconHeader,this),t&&e.on(cc.Node.EventType.TOUCH_END,this.touchIconHeader,this)):cc.error("CommonIconWidget setTouchEnabled qualityBgImg is null")},setTouchCallBack:function(t){this.setTouchEnabled(!0),this._touchCallBack=t},touchIconHeader:function(t){t.stopPropagation(),this._touchCallBack?this._touchCallBack(this.node,this._curData):td.ItemUtil.showItemInfo(this._curData,this._isObtainWay||this._isLessShowObtainWay)},_addQualityBgImg:function(){if(!this.node.getChildByName("qualityBgImg")){var t=new cc.Node;t.setName("qualityBgImg"),this.addChild(t,2)}this._setQualityBgImg()},_setQualityBgImg:function(){var t=this.node.getChildByName("qualityBgImg");t.active=!0;var e=this._curData.getGoodsType(),i=this._curData.getQuality();e!==td.GoodsType.Type_Equip&&e!==td.GoodsType.Type_Treasure||(i=this._curData.getShowQuality());var n=td.QualityBgImg[i];td.GlobalFunction.createSpriteNode(t,td.resDef.pngPlist.GY_Common,cc.SpriteAtlas,n),td.GlobalFunction.graySprite(t,this._isGray)},removeQulityEffect:function(){var t=this.node.getChildByName("QulityEffect");t&&t.removeFromParent()},addQulityEffect:function(){if(cc.isValid(this.node)&&!this.node.getChildByName("QulityEffect")){var t=this.node.getChildByName("qualityBgImg"),e=gdk.rm.getResByUrl("uiAnima/ZhuangBei_pinzhi/ZhuangBei_pinzhi",cc.Prefab),i=cc.instantiate(e);i.name="QulityEffect",this.node.addChild(i,100),i.x=t.x+3,i.y=t.y+1}},_addVocationImg:function(){if(!this.node.getChildByName("vocationImg")){var t=new cc.Node;t.setName("vocationImg"),t.x=40,t.y=40,this.node.addChild(t,7)}this._setVocationImg()},_addCampImg:function(){if(!this.node.getChildByName("campImg")){var t=new cc.Node;t.setName("campImg"),t.x=45,t.y=41,this.node.addChild(t,7)}this._setCampImg()},_addCampMark:function(){if(!this.node.getChildByName("campImg").getChildByName("z")){var t=new cc.Node;t.setName("z"),t.x=18,t.y=27,this.node.getChildByName("campImg").addChild(t,7)}this._setCampMark()},_setVocationImg:function(){var t=this.node.getChildByName("vocationImg");if(t)if(this._curData.getGoodsType()===td.GoodsType.Type_Mercenary){t.setScale(.5),t.active=!0;var e=td.FeaturesImg[this._curData.getFeatures()];td.GlobalFunction.createSpriteNode(t,td.resDef.pngPlist.GY_Common,cc.SpriteAtlas,e)}else t.active=!1;else this._addVocationImg()},_setCampImg:function(){var t=this.node.getChildByName("campImg");if(t)if(this._curData.getGoodsType()===td.GoodsType.Type_Mercenary){t.setScale(.5),t.active=!0;var e="GY_zhenying_0"+this._curData.getCurCamp();td.GlobalFunction.createSpriteNode(t,td.resDef.pngPlist.GY_Common,cc.SpriteAtlas,e)}else t.active=!1;else this._addCampImg()},_setCampMark:function(){var t=this.node.getChildByName("campImg").getChildByName("z");if(t)if(this._curData.getGoodsType()===td.GoodsType.Type_Mercenary){var e=this._curData.isCampConverted();if(t.active=e,e){var i="GY_zhenying_z0"+this._curData.getCurCamp();td.GlobalFunction.createSpriteNode(t,td.resDef.pngPlist.GY_Common,cc.SpriteAtlas,i)}}else t.active=!1;else this._addCampMark()},setVocationImgScale:function(t){void 0===t&&(t=1),this.node.getChildByName("vocationImg").scale=t},setCampImgScale:function(t){var e=this;void 0===t&&(t=1),gdk.Timer.frameOnce(1,this,function(){var i=e.node.getChildByName("campImg");i&&(i.scale=t)})},_addStarLevel:function(){var t=this._curData.getGoodsType();if(t===td.GoodsType.Type_Equip||t===td.GoodsType.Type_Treasure){var e=this.node.getChildByName("starBg");if(this._curData.getStar&&this._curData.getStar()>0){e.active=!0;var i=e.getChildByName("imgstar"),n="GY_zhuangbeik_pj0"+this._curData.getStar();td.GlobalFunction.createSpriteNode(i,td.resDef.pngPlist.GY_Common,cc.SpriteAtlas,n)}else e.active=!1}},_addRelationImg:function(){if(!this.node.getChildByName("relationImg")){var t=new cc.Node;t.setName("relationImg"),this.node.addChild(t,7)}this._setRelationImg()},_setRelationImg:function(){var t=this.node.getChildByName("relationImg"),e=this._curData.getGoodsType();if(e===td.GoodsType.Type_Mercenary||e===td.GoodsType.Type_Equip){var i;i=e===td.GoodsType.Type_Mercenary?this._curData.getRoleType():this._curData.getId();var n=td.PartnershipManager.isInPartnership(i);t.active=!!n}else t.active=!1},_setHeadImg:function(){var t=this.node.getChildByName("headImg"),e=this.node.getChildByName("imgFragment"),i=this.node.getChildByName("imgAptitude");e.active=!1,i.active=!1,t.scale=1;var a=this._curData.getIconRes(),r=null,o=td.GoodsType.Type_None;switch(this._curData.getGoodsType&&(o=this._curData.getGoodsType()),o){case td.GoodsType.Type_Item:var s=this._curData.getGoodsSubType();switch(td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_zhuangbeik_s"+this._curData.getQuality(),e),e.x=-37,e.y=35,s){case td.GoodsSubType.HERO_FRAGMENT:case td.GoodsSubType.HERO_RAND_FRAMENT:if(r=td.resDef.pngPlist.icon_touxiang,e.active=!0,76==this._type)break;var l=n.default.getInstance().getFragmentComposeInfo(this._curData.getId());l&&(i.active=!0,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_yxpj_0"+l.aptitude,i));break;case td.GoodsSubType.EQUIPMENT_FRAMENT:r=td.resDef.pngPlist.icon_zhuangbei,e.active=!0;break;case td.GoodsSubType.SPIRIT_FRAGMENT:r=td.resDef.pngPlist.icon_ys_xiao,e.active=!0;break;case td.GoodsSubType.TREASURE_FRAGMENT:r=td.resDef.pngPlist.icon_baowu,t.scale=.45;var c=this._curData.getTreasureFlag();c&&(e.active=!0,i.active=!0,i.setScale(1),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_zhuangbeik_ss"+c,i));break;case td.GoodsSubType.GIFT_BAG:case td.GoodsSubType.TIMES_BAG:r=td.resDef.pngPlist.icon_item,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_bx_suiji",e),e.active=!0,e.x=-31,e.y=38;break;case td.GoodsSubType.CHOOSE_BAG:r=td.resDef.pngPlist.icon_item,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_bx_zixuan",e),e.active=!0,e.x=-31,e.y=38;break;case td.GoodsSubType.PET_FRAGMENT:r=td.resDef.pngPlist.icon_chongwu,e.active=!0;break;default:r=td.resDef.pngPlist.icon_item}break;case td.GoodsType.Type_Mercenary:r=td.resDef.pngPlist.icon_touxiang;break;case td.GoodsType.Type_Equip:r=td.resDef.pngPlist.icon_zhuangbei;break;case td.GoodsType.Type_Gemstone:1===this._curData.getRare()?(td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY2_Common,"GY2_wz_xi",e),e.x=31,e.y=38,e.active=!0):e.active=!1,r=td.resDef.pngPlist.icon_lingwen;break;case td.GoodsType.Type_Artifact:r=td.resDef.pngPlist.icon_shenqi,t.scale=.45;break;case td.GoodsType.Type_Treasure:r=td.resDef.pngPlist.icon_baowu,t.scale=.45;break;case td.GoodsType.Type_HeroRune:r=td.resDef.pngPlist.icon_herorune;break;case td.GoodsType.Type_Spirit:r=td.resDef.pngPlist.icon_ys_xiao;break;case td.GoodsType.Type_Pet:r=td.resDef.pngPlist.icon_chongwu}if(o==td.GoodsType.Type_Gemstone){var u=this.node.getChildByName("qualityBgImg");u&&(u.zIndex=-2),t.active=!1;var d=this.node.getChildByName("GemstoneEffect");if(d&&d.removeFromParent(),d=null){d.active=!0,d.zIndex=-1;var h=d.getComponent(cc.Animation),p=h.getClips()[this._curData.getQuality()-2].name;t=d.getChildByName("icon_lingwen"),h.play(p)}else{var _=this._curData.getRuneType()===td.GemstoneType.Normal?"LingWan":"MoWan";this._curData.getRare()&&this._curData.getRuneType()===td.GemstoneType.Special&&(_="XY_"+_);var g=td.GlobalFunction.getResIdByNode(this.node);gdk.rm.loadRes(g,"uiAnima/LingWanMoWang/"+_,cc.Prefab,this.addGemstoneEffect.bind(this,_))}}else this.removGemstoneEffect(),t.active=!0;r?(a=this._curData.getIconRes(),td.GlobalFunction.createAltasSprite(r,a,t)):(a=this._curData.getIconRes(),td.GlobalFunction.createSpriteNode(t,a)),t.active=!0,td.GlobalFunction.graySprite(t,this._isGray),td.GlobalFunction.graySprite(i,this._isGray),td.GlobalFunction.graySprite(e,this._isGray)},removGemstoneEffect:function(){var t=this.node.getChildByName("GemstoneEffect");t&&t.removeFromParent()},addGemstoneEffect:function(t){if(cc.isValid(this.node)&&!this.node.getChildByName("GemstoneEffect")){var e=this.node.getChildByName("GemstoneEffect");if(!e){var i=gdk.rm.getResByUrl("uiAnima/LingWanMoWang/"+t,cc.Prefab);(e=cc.instantiate(i)).name="GemstoneEffect",this.node.addChild(e);var n=this.node.getChildByName("headImg");n.active=!1,n=e.getChildByName("icon_lingwen");var a=this._curData.getIconRes();td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_lingwen,a,n);var r=this.node.getChildByName("qualityBgImg");r&&(r.zIndex=-2),e.zIndex=-1}var o=e.getComponent(cc.Animation),s=o.getClips();if(!(this._curData.getQuality()>=7)){var l=s[this._curData.getQuality()-2].name;o.play(l)}}},setHeadClickShowInfo:function(t){this.setTouchEnabled(!0),this._isObtainWay=t},_setLevelBgAndText:function(){var t=this.node.getChildByName("levelBg"),e=this.node.getChildByName("levelText");if(this._curData.getPropertyType()!==td.UserPropertyEnum.Item){var i=this._curData.getLevel();if(i<=0)e.active=!1;else{t.active=!0,e.active=!0;var n=this._curData.getQuality(),a=this._curData.getGoodsType();a!==td.GoodsType.Type_Equip&&a!==td.GoodsType.Type_Treasure||(n=this._curData.getShowQuality()),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_zhuangbeik_dj0"+n,t),e.getComponent(cc.Label).string=i}}},updateLevel:function(t){this.node.getChildByName("levelText")&&(abel.getComponent(cc.Label).string=t)},_setBottomLevelPosition:function(t,e){var i=this.node.getChildByName("qualityBgImg");cc.assert(i,"qualityBgImg must exist");var n=i.x,a=i.y-i.getContentSize().height/2+12;e&&e.setPosition(n-i.getContentSize().width/2+15,a+15),e&&t&&t.setPosition(e.x+e.width,e.y)},_addEvolveLevelText:function(){switch(this._curData.getGoodsType()){case td.GoodsType.Type_Mercenary:this._addHeroBreakoutLevelText();break;case td.GoodsType.Type_Equip:case td.GoodsType.Type_Artifact:case td.GoodsType.Type_Treasure:this._addTreasureEvolveLevelText();break;case td.GoodsType.Type_Spirit:this._addSpiritStarText();break;case td.GoodsType.Type_Gemstone:this._addGemstoneEvolveLevelText()}},_addSpiritStarText:function(){var t=this._curData,e=this.node.getChildByName("starsPanel");e.active=!0;for(var i=e.getChildByName("Star_0"),n=t.getStar(),a=0;a<5;a++){var r=e.getChildByName("Star_"+a);r||((r=cc.instantiate(i)).name="Star_"+a,r.active=!0,e.addChild(r)),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,n>a?"GY_xingxing":"GY_xingxing02",r)}},_addHeroBreakoutLevelText:function(){var t=this._curData,e=this.node.getChildByName("numBg"),i=this.node.getChildByName("numBgLabel"),n=t.getBreakoutLevel?t.getBreakoutLevel():0;if(n<=0)return e.active=!1,void(i.active=!1);i.getComponent(cc.Label).string="+"+n,e.active=!0,i.active=!0},_addTreasureEvolveLevelText:function(){var t=this._curData,e=this.node.getChildByName("rankBg"),i=this.node.getChildByName("rankLabel"),n=this.node.getChildByName("rankWord"),a=0,r=t.getGoodsType(),o=this._curData.getQuality();if(r===td.GoodsType.Type_Equip?(o=this._curData.getShowQuality(),a=t.getForgeLevel()):r===td.GoodsType.Type_Treasure?(o=this._curData.getShowQuality(),a=t.getEvolveLevel()):r===td.GoodsType.Type_Artifact&&(a=t.getAdvanceLevel()),a<=0)return e.active=!1,i.active=!1,void(n.active=!1);e.active=!0,i.active=!0,n.active=!0,n.getComponent(cc.Sprite)||td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_jie",n),i.getComponent(cc.Label).string=a,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_zhuangbeik_jj0"+o,e)},_addGemstoneEvolveLevelText:function(){var t=this._curData,e=this.node.getChildByName("gemAwakenPanel");if(t&&t.canAwaken()&&0!==t.getAwakenLv()){e.active=!0;var i=e.getChildByName("labLevel"),n=e.getChildByName("imgName"),a=td.GetTableClass(td.TableEnum.GemAwakenConfig).getGemAwakenConfig(t.getId(),t.getAwakenLv());if(a){i.getComponent(cc.Label).string=a.showLevel;var r=a.prefix;r>0?(n.active=!0,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.MG_mingge,"MG_wz_0"+r,n)):n.active=!1}}else e.active=!1},_setRelifeAnimate:function(){var t=this._curData.getPropertyType(),e=this.node.getChildByName("relifeSprite");if(t===td.UserPropertyEnum.Mercenary&&this._curData.getRelifeType&&this._curData.getRelifeType()>0){var i=this._curData.getRelifeType();e&&(e.stopAllActions(),e.removeFromParent());var n=td.resDef.UIAnim["RelifeAnimation_"+i],a=1===i?"YiZhuanTouXiang":"ErZhuanTouXiang";td.GlobalFunction.downAndPlayAnim(this.node,n,a,"relifeSprite",1.2)}},_setEquippedImg:function(){var t=this.node.getChildByName("equippedImg");if(this._curData.getPropertyType()!==td.UserPropertyEnum.Item&&this._curData.getPropertyType()!==td.UserPropertyEnum.HeroRune&&(this._curData.isEquipped()||this._curData.isReinforcementsed&&this._curData.isReinforcementsed()||this._curData.isAssistanted&&this._curData.isAssistanted())){t.active=!0;var e="GY0_wz_yizhuangbei";this._curData.getPropertyType()==td.UserPropertyEnum.Equipment||this._curData.getPropertyType()===td.UserPropertyEnum.Gemstone||this._curData.getPropertyType()===td.UserPropertyEnum.Artifact?e="GY0_wz_yizhuangbei":this._curData.getPropertyType()===td.UserPropertyEnum.SPIRIT?e="GY0_wz_zhuzhan":this._curData.isEquipped()?e="GY0_chuzhan_wz":this._curData.isReinforcementsed()&&(e="GY0_wz_yuanjun"),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,e,t)}else t.active=!1},_setNameLabel:function(){var t=this.node.getChildByName("nameLabelBg"),e=this.node.getChildByName("nameLabel");t.active=this._isNameBgVisible,e.active=!0,e.getComponent(cc.Label).string=this._curData.getName(),this.setNameColor(this._isGray)},setNameColor:function(t){var e=this.node.getChildByName("nameLabel");if(t)e.color=cc.color(255,255,255),e.getComponent(cc.LabelOutline).width=2,e.getComponent(cc.LabelOutline).color=cc.color(66,66,66);else{var i=this._curData.getGoodsType();i===td.GoodsType.Type_Equip||i===td.GoodsType.Type_Treasure?td.GlobalFunction.setNameColors(e,this._curData.getShowQuality(),1):td.GlobalFunction.setNameColors(e,this._curData.getQuality(),1)}},getNameLabel:function(){return this.node.getChildByName("nameLabel")},setNamePosY:function(t){var e=this.node.getChildByName("nameLabelBg");e&&(e.y=t,(e=this.node.getChildByName("nameLabel"))&&(e.y=t))},setNameBgVisible:function(t){this._isNameBgVisible=t;var e=this.node.getChildByName("nameLabelBg");e&&(e.active=t)},setNumLableScale:function(t){var e=this.node.getChildByName("numBg"),i=this.node.getChildByName("numBgLabel");e.setScale(t||1),i.setScale(t||1)},setNum:function(t,e){e=e||!1,this._curData.getGoodsType()==td.GoodsType.Type_Item&&17==this._curData.getId()&&(t=parseInt(t/10));var i=this.node.getChildByName("numBg"),n=this.node.getChildByName("numBgLabel");if(("number"!=typeof t||0===t)&&!e)return i.active=!1,void(n&&(n.active=!1));t>=1e6&&(t=Math.floor(t/1e4),t+=td.Language.tenThousand),n?n.getComponent(cc.Label).string="X"+t:((n=td.GlobalFunction.createLabel("X"+t,"",22)).setAnchorPoint(1,.5),n.setName("numLabel"),this.addChild(n,5)),i.active=!0,n.active=!0},_addCultivateLevel:function(){var t=this.node.getChildByName("cultivateBg"),e=this.node.getChildByName("wordFront"),i=this.node.getChildByName("wordLast"),n=this.node.getChildByName("cultivateNumLabel"),a=this._curData;if(a.getGoodsType()!==td.GoodsType.Type_Mercenary)return t.active=!1,e.active=!1,i.active=!1,void(n.active=!1);var r=a.getCultivateLevel?a.getCultivateLevel():0;if(r<=0)return t.active=!1,e.active=!1,i.active=!1,void(n.active=!1);e.getComponent(cc.Sprite)||td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_di",e),i.getComponent(cc.Sprite)||td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_chong",i),n.getComponent(cc.Label).string=r,t.active=!0,e.active=!0,i.active=!0,n.active=!0},_addAnimation:function(){var t=this._curData.getAnimationType(),e=this.node.getChildByName("animation");t?this.addAnimationByType(t):e.active=!1},_addSoulLinkImg:function(){var t=this.node.getChildByName("imgSoulLink");if(this._curData){var e=this._curData.isSoulLink&&this._curData.isSoulLink()||this._curData.isSoulLinked&&this._curData.isSoulLinked();t.active=e}else t.active=!1},addAnimationByType:function(t){var e=this.node.getChildByName("animation");e.active=!0;var i=e.getChildByName("IconAnimation");if(i){var n=i.getComponent(cc.Animation);n.play(n.defaultClip.name)}else{var a=td.GlobalFunction.getResIdByNode(e);gdk.rm.loadRes(a,"uiAnima/ShangYe_UI/ShangYe_UI",cc.Prefab,this.playAnimationByType.bind(this,t))}},playAnimationByType:function(t){if(cc.isValid(this.node)){var e=this.node.getChildByName("animation"),i=gdk.rm.getResByUrl("uiAnima/ShangYe_UI/ShangYe_UI",cc.Prefab),n=cc.instantiate(i);n.name="IconAnimation",e.addChild(n)}},_setBottomTextPosition:function(t,e){var i=this.node.getChildByName("qualityBgImg");cc.assert(i,"qualityBgImg must exist");var n=i.x,a=i.y-i.getContentSize().height/2+12;e.setPosition(n,a),t.setPosition(n+i.width/2-15,a+8)},setCostShow:function(t,e){var i=this.node.getChildByName("costNumBg");i.active=!0;var n=this.node.getChildByName("costText");n.active=!0;var a="<color=#00ff00>%s</c><color=#ffffff>/%s</color>";if(t<e?(a="<color=#ff0000>%s</c><color=#ffffff>/%s</color>",this._isLessShowObtainWay=!0):this._isLessShowObtainWay=!1,-1===td.IconShowType[this._type].indexOf(8)){var r=this.node.getChildByName("nameLabelBg");i.y=r.y,n.y=r.y}n.getComponent(cc.RichText).string=cc.js.formatStr(a,t,e)},setMaskShow:function(t){var e=this.node.getChildByName("mask");e.zIndex=100,e.active=t},setImgFragmentShow:function(t){var e=this.node.getChildByName("imgFragment");e&&(e.active=t)},clone:function(){var t=cc.instantiate(this.node);return t.getComponent(o).init(this._type,this._curData),t},setReceivedShow:function(t){var e=this.node.getChildByName("nodeReceived");e&&(e.active=t)},hideAptitude:function(){this.node.getChildByName("imgAptitude").active=!1},hideFragment:function(){this.node.getChildByName("imgFragment").active=!1}});e.exports=o,td.IconShowType={1:[1,2,3],2:[2,3],3:[1,2,3,4,6,9],4:[2,3,4,6,9],5:[1,2,3,4,5,6,9],6:[2,3,4,5,12],7:[1,2,3,4,5,6,7,9],8:[2,3,4,5,6,7,9],9:[1,2,3,4,5,6,7,8,9],10:[2,3,4,5,6,7,8,9],11:[2,3,7,9],12:[2,3,8,9],13:[1,2,3,4,7,9],14:[2,3,5,8,9],15:[1,2,3,8,9],16:[2,3,4,8,9],17:[2,3,4,7,8,9],18:[2,3,4,5,8,9],19:[1,2,3,4,8,9],20:[1,2,3,4,5,7,9],21:[1,2,3,4],22:[2,3,4,6,8,9],23:[2,3,6,8,9],24:[2,3,4],25:[1,2,3,4,5],26:[2,3,6],27:[2,3,6,8],28:[3],29:[1,2,3,4,8],30:[2,3,5,9],31:[1,2,3,7,9],32:[2,3,4,5,10],33:[2,3,6],34:[2,3,5,6,8],35:[2,3,8],36:[2,3,4,9],37:[2,3,5,6,9],38:[2,3,4,5,11],39:[2,3,4,5,7],40:[2,3,4,5,8,11],41:[2,3,6,11,12],42:[2,3,4,5,9],43:[3,4,5,9,12],44:[2,3,4,5,7,12],45:[1,2,3,4,5,9,12],46:[1,2,3,5,9,12],47:[2,3,4,5],48:[2,3,4,5,11],49:[2,3,4,7],52:[2,3,13],53:[2,3,6,8,9,13],56:[2,3,6,13],57:[2,3,6,8,13],58:[2,3,5,6,9,13],59:[2,3,4,5,8,9,14],60:[2,3,4,5,7,14],61:[2,3,4,5,12,14],62:[2,3,4,5,7,12,14],63:[2,3,4,5,11,14],64:[2,3,4,8,15],65:[2,3,4,15],66:[2,3,9],67:[2,3,4,5,8,16],68:[1,2,3,4,5,12,16],69:[2,3,4,8,16],70:[2,3,16],71:[2,3,5,16],72:[2,3,4,5,16],73:[2,3,4,5,11,16],74:[2,3,4,5,11,14,16],75:[2,3,4,5,7,14,16],76:[2,3],77:[2,3,4,5,16],78:[2,3,8,16],79:[2,3,4,5,7,14,16,17],80:[2,3,4,5,16,17],81:[2,3,7,16],82:[2,3,18],83:[2,3,16,18],84:[2,3,18,19]},cc._RF.pop()},{"../Equip/Manager/EquiptManager":"EquiptManager","../Hero/Manager/HeroManager":"HeroManager",NodePoolManager:void 0}],CommonSkill:[function(t,e,i){"use strict";cc._RF.push(e,"329678QUChEDZq0JXLyprUJ","CommonSkill");var n=t("PveFightObject"),a=t("PveFightManager"),r=t("PveUiManager"),o=t("PveNodePoolManager"),s=t("PveBuildTowerManager"),l=cc.Class({extends:n,properties:{_curHeroAttackPower:null,_cutHurtType:null,_animationContinueTime:null,_skillName:null,_extraEffectNode:null,_belongHeroId:null,_curTargetEnemy:null,_baseAttackPower:null,_isNeedShake:null,_attackerVocation:null,_heroSid:null,_petSid:null,_towerPos:null,_hurtCount:0,_endDestroy:!0},initData:function(t){this._extraEffectNode=null,this._dataModel=t.skillDataModel,this._petSid=t.petSid,this._curSpeedMult=a.getCurFightSpeedMult(),this.refreshSkillAnimationSpeed(this._curSpeedMult),this._curHeroAttackPower=t.attackPower||0,this._cutHurtType=t.hurtType,this._belongHeroId=t.heroId||null,this._curTargetEnemy=t.curTargetEnemy||null,this._baseAttackPower=t.baseAttackPower||1,this._attackerVocation=t.vocation||0,this._heroSid=t.heroSid,this._towerPos=t.towerPos||cc.v2(0,0),this._bRefreshScale=!1,this._isNeedShake=!1,this.checkNeedScaleX();var e=this.node.getComponent(cc.Animation);this._animationContinueTime=this._dataModel.getContinueTime();for(var i=this._animationContinueTime>0?cc.WrapMode.Loop:cc.WrapMode.Normal,n=e.getClips(),r=0,o=n.length;r<o;r++)n[r]&&(n[r].wrapMode=i);this.node.active=!0,this._hurtCount=0;var s=this._dataModel.getSoundId();s&&s>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,s);e=this.node.getComponent(cc.Animation);this._animationContinueTime>0?this.schedule(this.updateContinueTime,1/60):e.on("finished",this.finishedEventCallBack.bind(this)),e.play(e.defaultClip.name),this.playScreenShakeAction()},onEnable:function(){},onDisable:function(){this.unschedule(this.updateContinueTime)},checkNeedScaleX:function(){if(this._dataModel.needScaleX()){var t=this._curTargetEnemy.x<this._towerPos.x?-1:1;this.node.scaleX=Math.abs(this.node.scaleX)*t}else this.node.scaleX=Math.abs(this.node.scaleX)},onLoad:function(){this._super()},onDestroy:function(){this._super()},refreshSkillAnimationSpeed:function(t){for(var e=this.node.getComponent(cc.Animation),i=e.getClips(),n=0,a=i.length;n<a;n++)if(i[n]){var r=e.getAnimationState(i[n].name);r&&(r.speed=t)}},onChangeSpeedMult:function(t){this._super(t),this.refreshSkillAnimationSpeed(t)},onRestartFight:function(){this.removeSelf()},onFightOver:function(){this.removeSelf()},pause:function(){this.node.pauseAllActions(),this.node.getComponent(cc.Animation).pause(),this._animationContinueTime>0&&this.unschedule(this.updateContinueTime);var t=r.getShakeLayers();t.getActionByTag(666)&&(t.pauseAllActions(),t.setPosition(cc.v2(0,0)))},resume:function(){this.node.resumeAllActions(),this.node.getComponent(cc.Animation).resume(),this._animationContinueTime>0&&this.schedule(this.updateContinueTime,1/60);var t=r.getShakeLayers();t.getActionByTag(666)&&t.resumeAllActions()},updateContinueTime:function(t){this._animationContinueTime-=t*this._curSpeedMult,this._animationContinueTime<=0&&(this.unschedule(this.updateContinueTime),this.removeSelf())},setEndDestroy:function(t){this._endDestroy=t},removeSelf:function(){this._endDestroy?cc.isValid(this.node)&&this.node.parent&&this.node.destroy():cc.isValid(this.node)&&this.node.parent&&o.putTowerSkillNode(this.node.name,this.node);var t=r.getShakeLayers();t.stopAllActions(),t.setPosition(cc.v2(0,0))},frameEventCallBack:function(){this.calcHurt()},finishedEventCallBack:function(){this.removeSelf(),this._petSid&&this.createPetTower()},createPetTower:function(){if(this._petSid){var t=s.getPetBuildModelBySid(this._petSid);if(!t)return;var e={isPet:!0,posTag:t.getPosTag(),heroDataModel:t,pos:this.node.position};td.EventUtil.dispatchEvent(td.EventNameEnum.BUILD_PET_TOWER_IN_LAYER,e)}},calcHurt:function(){this._hurtCount++;for(var t=this._dataModel.getSkillPower(),e=this._baseAttackPower*t,i=this._cutHurtType,n=this._dataModel.getDamageRange()/2,r=a.getEnemyArray(),o=this.node.getPosition(),s=r.length-1;s>=0;s--){var l=r[s];if(l){var c=Math.floor(l._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),u=l.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[c]),d=u.bDeath(),h=l.getPosition();if(td.GlobalFunction.getDistance(o,h)<=n&&!d){for(var p=this._dataModel.getAttackEffect(),_=0,g=p.length;_<g;_++){var f=p[_];f[0]===td.PveEnum.PVE_EFFECT_TYPE.PureHurt1&&(e+=f[1])}var v={totalHurtCount:this._dataModel.getHurtCount(),curHurtCount:this._hurtCount,effects:this._dataModel.getMonsterDeadEffect(),skillPos:this.node.getPosition()};u.setHurt(this._heroSid||this._petSid,e,i,this._attackerVocation,v),u.addUnderAttackEffect(this._dataModel.getUnderAttackPrefab()),this.setAttackEffectToEnemy(l)}}}},setAttackEffectToEnemy:function(t){for(var e=t.getComponent("EnemyBuffCtrlComponent"),i=this._dataModel.getAttackEffect(),n=0,a=i.length;n<a;n++){var r=i[n],o=r[0];if(o!==td.PveEnum.PVE_EFFECT_TYPE.PureHurt1){var s=r[1]/1e4,l=r[2]/1e3;o===td.PveEnum.PVE_EFFECT_TYPE.PureHurt2&&(s=this._curHeroAttackPower*s);var c={buffType:o,buffData:s,buffTime:l,showBuff:!0,hurtType:this._cutHurtType,baseAttackPower:this._baseAttackPower,vocation:this._attackerVocation,heroSid:this._heroSid||this._petSid},u=o,d=this._skillName;e.addBuffToList(u,d,c)}}},_drawEffectRange:function(){var t=this.node.getContentSize();this.drawNode&&this.drawNode.removeFromParent();var e=-this._model.getOffsetX(),i=-this._model.getOffsetY();this.drawNode=new cc.DrawNode,this.drawNode.setLineWidth(3),this.drawNode.setDrawColor(new cc.Color(255,0,0,255)),this.drawNode.drawCircle(cc.v2(0,0),this._model._effectRange,360,50,!1),this.drawNode.setPosition(t.width/2+e,t.height/2+i),this.node.getParent()._sgNode.addChild(this.drawNode)},playScreenShakeAction:function(){if(this._isNeedShake){var t=cc.director.getScene().getChildByName("Canvas").getChildByName("shakeLayers");td.GlobalFunction.createShockEffect(t,.08,999,5)}}});e.exports=l,cc._RF.pop()},{PveBuildTowerManager:"PveBuildTowerManager",PveFightManager:"PveFightManager",PveFightObject:"PveFightObject",PveNodePoolManager:"PveNodePoolManager",PveUiManager:"PveUiManager"}],CommonTaskItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"c8b6e5v72ZOeqI1kO5CI/ZT","CommonTaskItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgIcon=null,e.labDesc=null,e.labProTitle=null,e.labProgress=null,e.labNum=null,e.btnGoto=null,e.btnGet=null,e.imgGot=null,e.numBg=null,e._curActivityType=0,e._isTaskCfg=!1,e._taskId=0,e._gotoPanel=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._curActivityType=i.activityType,this._isTaskCfg=i.isTaskCfg,this._charge=i.charge;var n=0,a=r.ActivityDataManager.getActivityControllerByType(this._curActivityType).getCurrencyId(),o=r.GetTableClass(r.TableEnum.Item).getItemById(a);if(o){var s=new r.Item;s.init(o),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,s.getIconRes(),this.imgIcon)}var l=0,c=0,u=r.TaskStatus.NONE,d=!1;if(this._isTaskCfg){var h=r.RewardManager.getRewardDetailArray(i.getRewards())[0];r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,h.getIconRes(),this.imgIcon),u=i.getStatus(),n=h.getCount(),l=i.getValue(),c=i.getNeedValue(),d=i.isChargeType(),this._taskId=i.getId(),this._gotoPanel=i.getGotoPanel(),this.labDesc.string=i.getDes()}else u=i.status,n=i.num,l=i.charge,c=i.totalNeed,d=i.isRecharge,this.labDesc.string=d?cc.js.formatStr("%s",r.Language.addUpRecharge,c/10):cc.js.formatStr("%s",r.Language.addUpRecharge,c);this.labNum.string="x"+n,this.numBg.active=n>0,this.labNum.node.active=n>0,this.labProTitle.string=r.Language.progress+":",l>c&&(l=c),this.labProgress.string=d?l/10+"/"+c/10:l+"/"+c,this.btnGoto.active=u===r.TaskStatus.Progress,this.btnGet.active=u===r.TaskStatus.Finish,this.imgGot.active=u===r.TaskStatus.Received},e.prototype.onBtnJumpClick=function(){var t=r.PanelManager.getInstance().getCurShowWindow(),e=r.PanelManager.getInstance().getCurShowPanel(),i=r.ActivityDataManager.getActivityControllerByType(this._curActivityType);if(i&&(i.setIsJumpToCharge&&i.setIsJumpToCharge(!0),i.setJumpToRecharge&&i.setJumpToRecharge()),this._isTaskCfg){var n=null;this._gotoPanel[1]&&(n=this._gotoPanel[1]);var a=e.getComponent("ActivityMainPanel");this._gotoPanel[0]&&r.PanelEnum.Panel_Activity===this._gotoPanel[0]?(a.setData(n),r.ActivityDataManager.setJumpBackData([r.ActivityEnum.Activity.ActivityConfig,this._curActivityType])):r.PanelJumpManager.jumpToPanel(this._gotoPanel[0],n)}else r.GlobalFunction.gotoRecharge();if(t){var o=t.getComponent("PanelBase");o&&o.closeCallFunc()}},e.prototype.onBtnReceiveClick=function(){var t=r.ActivityDataManager.getActivityControllerByType(this._curActivityType);if(t)if(this._isTaskCfg)r.EventUtil.dispatchEvent(r.EventNameEnum.Req_TASK_RECEIVE,this._taskId);else{var e={};this._curActivityType==r.ActivityEnum.ActivityType.ACTIVITY_TYPE_7?(e.id=this._charge,e.parmeterMap={2:1}):(e.id=this._charge,e.parmeterMap[""+this._curActivityType]=1),t.operateActivity(e)}},a([c(cc.Node)],e.prototype,"imgIcon",void 0),a([c(cc.Label)],e.prototype,"labDesc",void 0),a([c(cc.Label)],e.prototype,"labProTitle",void 0),a([c(cc.Label)],e.prototype,"labProgress",void 0),a([c(cc.Label)],e.prototype,"labNum",void 0),a([c(cc.Node)],e.prototype,"btnGoto",void 0),a([c(cc.Node)],e.prototype,"btnGet",void 0),a([c(cc.Node)],e.prototype,"imgGot",void 0),a([c(cc.Node)],e.prototype,"numBg",void 0),e=a([l,u("module/Activity/CommonTaskItemUI")],e)}(o);i.default=d,cc._RF.pop()},{ListItem:void 0}],CommonTaskWindow:[function(t,e,i){"use strict";cc._RF.push(e,"ee32e59cAxOF5Ky0Bbvuqu2","CommonTaskWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTitle=null,e._curActivityType=0,e._isTaskCfg=!1,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_CommonTask},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this._refreshList,t[e.Res_GET_TASK_INFO]=this._refreshList,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._curActivityType=e.activityType,this._isTaskCfg=e.isTaskCfg,this.labTitle.string=e.title||this.labTitle.string,this._refreshList()},e.prototype._refreshList=function(){var t=this,e=r.ActivityDataManager.getActivityControllerByType(this._curActivityType);if(null!=e){var i=e.getActivityData(),n=[];n=this._curActivityType==r.ActivityEnum.ActivityType.ACTIVITY_TYPE_7?r.GetTableClass(r.TableEnum.HeavenTurntableRechargeConfig).getConfigById(i):e.getTaskList(),this._isTaskCfg||(this._value=e.getCharge&&e.getCharge(),this._rechargedList=e.getChargedList&&e.getChargedList()),n.forEach(function(e){t.setStatus(e)}),this._isTaskCfg||n.sort(this.sortFunc),this.node.getComponent(d).refreshListData(n)}},e.prototype.setStatus=function(t){t.activityType=this._curActivityType,t.isTaskCfg=this._isTaskCfg,this._isTaskCfg||(t.charge>this._value?t.status=2:-1===this._rechargedList.indexOf(t.charge)?t.status=3:t.status=4)},e.prototype.sortFunc=function(t,e){if(t.status!=e.status){if(3===t.status)return-1;if(3===e.status)return 1;if(4===t.status)return 1;if(4===e.status)return-1}return t.charge-e.charge},e.prototype.closeCallFunc=function(){t.prototype.closeCallFunc.call(this),r.EventUtil.dispatchEvent(r.EventNameEnum.HavingTurntable_Task_Close)},a([l(cc.Label)],e.prototype,"labTitle",void 0),e=a([s,c("module/Activity/CommonTaskWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],ComposeEnum:[function(t,e,i){"use strict";cc._RF.push(e,"ae9e2wbZktNXLMg+CaoCc5z","ComposeEnum"),td.ComposeEnum={Equip:1,Hero:2,Gemstone:3,HeroExpItem:4,RuneExpItem:5,DragonArtifact:6},td.DecomposeType={Mercenary:1,Equip:2,Gemstone:3,DragonArtifact:6},td.SelectItemType={Compose:1,Decompose:2},cc._RF.pop()},{}],ComposeTable:[function(t,e,i){"use strict";cc._RF.push(e,"95ee0Kf06JKtbuJxnTrkFk8","ComposeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ComposeTable",properties:{_tblName:"synthesize_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.type]||(t[a.type]={}),t[a.type][a.quality]=a.cost}},getComposeCost:function(t,e){return this._data[t]&&this._data[t][e]?this._data[t][e][0]:[0,0,0]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ConfigTable:[function(t,e,i){"use strict";cc._RF.push(e,"a5e08TWidxK35SDRWR3DoFi","ConfigTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ConfigTable",properties:{_tblName:"global_config",_deleteJson:{default:!1,override:!0}},getConfig:function(t){return cc.assert(void 0!==this._jsonData[t],"config not exist:"+t),this._jsonData[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ConfirmBroadcastTipWindow:[function(t,e,i){"use strict";cc._RF.push(e,"5482bReThRPuJqytO8SXB9F","ConfirmBroadcastTipWindow");var n=cc.Class({extends:cc.Component,properties:{_strTipsArray:null,_eventData:null,_okCallFunc:null,_cancelCallFunc:null,_doNotCallFunc:null,suerBtn:cc.Node,suerBtnLabel:cc.Label,cancelBtn:cc.Node,cancelBtnLabel:cc.Label,okBtn:cc.Node,okBtnLabel:cc.Label,titleLabel:cc.Label,textBg:cc.Node,btnClose:cc.Node,_bg:null},init:function(){this._panelEnum=td.PanelEnum.Window_ConfirmBroadcastTip},onLoad:function(){this._initPanel()},_initPanel:function(){var t=gdk.PanelId.getValue(this._panelEnum),e=td.UIAdaptiveUtil.getWinSize(),i=new cc.Node;i.setAnchorPoint(cc.v2(.5,.5)),i.setPosition(cc.v2(0,0)),i.setContentSize(e),i.addComponent(cc.Mask),this.node.addChild(i,-99),this._bg=new cc.Node,this._bg.setAnchorPoint(cc.v2(.5,.5)),this._bg.setPosition(cc.v2(0,0)),this._bg.setName("panelBg"),this._bg.on(cc.Node.EventType.TOUCH_END,this.clickBgListener,this),this._bg.setContentSize(e),i.addChild(this._bg);var n=this._bg.addComponent(cc.Sprite);if(t.bg){var a=t.bgType;td.GlobalFunction.createSpriteNode(this._bg,t.bg),"scale9"===a&&(n.sizeMode=cc.Sprite.SizeMode.CUSTOM,n.type=cc.Sprite.Type.SLICED),"scale9"!==a&&td.GameResolutionPolicy.isDefaultRS()&&td.UIAdaptiveUtil.adaptivePanelMaxScale(this._bg)}else{var r=gdk.rm.getResByUrl(td.resDef.pngPlist.GY_Common,cc.SpriteAtlas).getSpriteFrame(td.resDef.GY_Common.GY_tongming_bg);n.sizeMode=cc.Sprite.SizeMode.CUSTOM,n.type=cc.Sprite.Type.SLICED,n.spriteFrame=r,this._bg.opacity=220}},setData:function(t){this._doNotCallFunc=t.getDoNotCallFunc(),this._okCallFunc=t.getOkCallFunc(),this._cancelCallFunc=t.getCancelCallFunc(),this._setTitle(t),this._addMainText(t),this._addSubText(t),this.btnClose.active=!0,t.getType()==td.BroadcastType.type3?this._setOkCancelBtn(t):t.getType()==td.BroadcastType.type4?(this._setOkBtn(t),this.btnClose.active=!1):t.getType()==td.BroadcastType.type5&&this._setOkCancelBtn(t)},_addMainText:function(t){var e=t.getMainText();if(""!=e){var i;e=(e=td.GlobalFunction.replaceAll(e,"%d","%s")).split("%s");for(var n=t.getMainParam(),a=e[0].match("<font"),r=a?"":[],o=0,s=e.length;o<s;++o)if(a)r+=e[o],o!=s-1&&(r+=n[o].getText());else{var l={type:"text"};l.content=e[o],l.style={},l.style.size=28,r.push(l),o!=s-1&&((l={}).type="text",l.content=n[o].getText(),l.style={},l.style.color=n[o].getTextColor(),l.style.size=n[o].getTextSize()||28,r.push(l))}var c={};!a&&(c.color=td.UI_Colors[0]),c.contentSize=cc.size(580,60),i=td.GlobalFunction.createRichText(r,c),t.getSubText(),i.y=25,i.x=0,i.setName("mainText"),this.textBg.addChild(i)}},_addSubText:function(t){var e=t.getSubText();if(""!=e){var i;e=(e=td.GlobalFunction.replaceAll(e,"%d","%s")).split("%s");var n=[],a=t.getSubParam();if(a){for(var r=0,o=e.length;r<o;++r){var s={type:"text"};s.content=e[r],s.style={},s.style.size=24,n.push(s),r!=o-1&&r<=a.length-1&&(cc.log(a[r].getText()),(s={}).type="text",s.content=a[r].getText(),s.style={},s.style.color=a[r].getTextColor(),s.style.size=a[r].getTextSize(),n.push(s))}var l={};l.color=td.UI_Colors[0],l.contentSize=cc.size(450,60),i=td.GlobalFunction.createRichText(n,l);this.textBg.getChildByName("mainText");i.y=-25,i.x=0,this.textBg.addChild(i)}}},clickBgListener:function(){},_setTitle:function(t){t&&t.getTitleText&&t.getTitleText()&&(this.titleLabel.string=t.getTitleText())},_setOkCancelBtn:function(t){this.cancelBtnLabel.string=t.getCancelText(),this.suerBtnLabel.string=t.getOkText(),this.cancelBtn.active=!0,this.suerBtn.active=!0,this.okBtn.active=!1},_setOkBtn:function(t){this.okBtnLabel.string=t.getOkText(),this.cancelBtn.active=!1,this.suerBtn.active=!1,this.okBtn.active=!0},onDisable:function(){var t=td.EventNameEnum.HIDE_BROADCAST;td.EventUtil.dispatchEvent(t)},okBtnFunc:function(t){this.node.removeFromParent(),this._okCallFunc&&this._okCallFunc(t),this.node.destroy()},cancelBtnFunc:function(t){this.node.removeFromParent(),this._cancelCallFunc&&this._cancelCallFunc(t),this.node.destroy()},_doNotTipsCBFunc:function(t,e){this._doNotCallFunc&&this._doNotCallFunc(e),this.node.destroy()}});e.exports=n,cc._RF.pop()},{}],ConfirmTipWindow:[function(t,e,i){"use strict";cc._RF.push(e,"d0569aTshlGm6HpA379cZx1","ConfirmTipWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{_strTipsArray:null,_sureCallFunc:null,_labTitle:null,_labTip_1:null,_labTip_2:null,_btnCancel:null,_btnSure:null,_btnClose:null},init:function(){this._panelType=td.PanelType.None,this._panelEnum=td.PanelEnum.Window_ConfirmTip},onLoad:function(){this._super();var t=this._root.getChildByName("imgTipBg");this._labTip_1=t.getChildByName("labTip_1"),this._labTip_2=t.getChildByName("labTip_2"),this._labTitle=this._root.getChildByName("imgTitleBg").getChildByName("labTitle"),this._btnCancel=this._root.getChildByName("btnCancel"),this._btnSure=this._root.getChildByName("btnSure"),this._btnClose=this._root.getChildByName("btnClose")},setData:function(t){this._strTipsArray=t.strArray,this._sureCallFunc=t.okCallFunc,this._cancelCallFunc=t.cancelCallFunc,this._eventData=t.data,this._showBtn=t.showBtn,this._showBtn&&(this._btnCancel.active=this._showBtn[0],this._btnSure.active=this._showBtn[1],this._btnClose.active=this._showBtn[2],this._btnCancel.active||(this._btnSure.x=0)),this._labTip_1.active=this._strTipsArray&&this._strTipsArray.length>=1,this._labTip_2.active=this._strTipsArray&&this._strTipsArray.length>=2,this.setTip(),this.setButtonTitle(t),this.setWidgetTitle(t)},setTip:function(){this._labTip_1.active&&(this._labTip_1.getComponent(cc.RichText).string=this._strTipsArray[0]),this._labTip_2.active&&(this._labTip_2.getComponent(cc.RichText).string=this._strTipsArray[1])},setWidgetTitle:function(t){var e=t.strTitle||td.Language.tip;this._labTitle.getComponent(cc.Label).string=e},setButtonTitle:function(t){var e=t.strBtnNo||td.Language.cancel;this._btnCancel.getChildByName("Label").getComponent(cc.Label).string=e;var i=t.strBtnYes||td.Language.confirm;this._btnSure.getChildByName("Label").getComponent(cc.Label).string=i},onDisable:function(){this._strTipsArray=null,this._sureCallFunc=null,this._cancelCallFunc=null,this._eventData=null,this._showBtn=null},onCancel:function(){var t=this._cancelCallFunc;t&&"function"==typeof t&&t(this._eventData),this.closeCallFunc()},onSure:function(){var t=this._sureCallFunc;t&&"function"==typeof t&&t(this._eventData),this.closeCallFunc()}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],ConsumeActivityController:[function(t,e,i){"use strict";cc._RF.push(e,"fd0dfGR4oxIboJ28rTuh04n","ConsumeActivityController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_recharge:null,_diamond:null,_receiveList:null},initData:function(t){this._super(t),this.clearData()},clearData:function(){this._recharge=0,this._diamond=0,this._receiveList=[]},getRecharge:function(){return this._recharge},getDiamond:function(){return this._diamond},getReceiveList:function(){return this._receiveList},activityParse:function(t){var e=t.record;this._recharge=e.recharge,this._diamond=e.diamond,this._receiveList=e.receiveList},openActivityPanel:function(){td.GlobalFunction.setLocalSaveStatus("ConsumeActivity",!0),td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_COMSUMEACTIVITY)},getActivityList:function(){for(var t=[],e=[],i=td.GetTableClass(td.TableEnum.ConsumeActivityTable).getDataById(this._activityData),n=0;n<i.length;n++){var a=i[n].id;-1===this._receiveList.indexOf(a)?t.push(i[n]):e.push(i[n])}return t.concat(e)},hasRedPoint:function(){return!0},redPointTip:function(){var t=td.GlobalFunction.getLocalSaveStatus("ConsumeActivity");if(!0!==t&&"true"!==t)return!0;for(var e=this.getActivityList(),i=0;i<e.length;i++)if(this._recharge>=e[i].recharge&&this._diamond>=e[i].diamond&&-1===this._receiveList.indexOf(e[i].id))return!0;return!1},redPointEvts:function(){return[td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.OPEN_COMSUMEACTIVITY]},isRedPointTip:function(){return this.redPointTip()}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],ConsumeActivityItem:[function(t,e,i){"use strict";cc._RF.push(e,"3c7f1maqoFCgKfEiBx7q+tu","ConsumeActivityItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTitle1=null,e.labTitle2=null,e.labNum1=null,e.labNum2=null,e.img1=null,e.img2=null,e.rewardsPanel=null,e.btnOperation=null,e.imgReceived=null,e.img_wdc=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._controller=c.ActivityDataManager.getActivityControllerByType(c.ActivityEnum.ActivityType.ACTIVITY_TYPE_18);var n=this._controller.getRecharge(),a=this._controller.getDiamond();this.labTitle1.string=cc.js.formatStr("%s",c.Language.ConsumeActivityItem1,i.recharge/10),this.labTitle2.string=cc.js.formatStr("%s",c.Language.ConsumeActivityItem2,i.diamond);var r=!0;if(this._id=i.id,this.labNum1.string=n/10+"/"+i.recharge/10,this.labNum2.string=a+"/"+i.diamond,n<i.recharge?(r=!1,this.img1.active=!1,this.labNum1.node.color=cc.color(173,98,1)):(this.labNum1.node.color=cc.color(1,173,38),this.img1.active=!0),a<i.diamond?(r=!1,this.img2.active=!1,this.labNum2.node.color=cc.color(173,98,1)):(this.labNum2.node.color=cc.color(1,173,38),this.img2.active=!0),r){var o=this._controller.getReceiveList();this.img_wdc.active=!1,this.btnOperation.active=-1===o.indexOf(this._id),this.imgReceived.active=-1!==o.indexOf(this._id)}else this.img_wdc.active=!0,this.btnOperation.active=!1,this.imgReceived.active=!1;this.rewardsPanel.removeAllChildren(!0);for(var s=c.RewardManager.parseRewardListDetail(i.rewards),l=0;l<s.length;l++){var u=c.GlobalFunction.createCommonIconWidget(26,s[l]);u.setScale(.7),this.rewardsPanel.addChild(u)}},e.prototype.onOperation=function(){var t={};t.id=this._id,this._controller.operateActivity(t)},a([s(cc.RichText)],e.prototype,"labTitle1",void 0),a([s(cc.RichText)],e.prototype,"labTitle2",void 0),a([s(cc.Label)],e.prototype,"labNum1",void 0),a([s(cc.Label)],e.prototype,"labNum2",void 0),a([s(cc.Node)],e.prototype,"img1",void 0),a([s(cc.Node)],e.prototype,"img2",void 0),a([s(cc.Node)],e.prototype,"rewardsPanel",void 0),a([s(cc.Node)],e.prototype,"btnOperation",void 0),a([s(cc.Node)],e.prototype,"imgReceived",void 0),a([s(cc.Node)],e.prototype,"img_wdc",void 0),e=a([o,l("module/Activity/ConsumeActivityItem")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],ConsumeActivityPanel:[function(t,e,i){"use strict";cc._RF.push(e,"15140wKn6JI4oi7y5J9R9Zt","ConsumeActivityPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o},r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=t("ActivityBasePanel"),u=t("OptimizeVerticalListView"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labActivityTime=null,e.labTip=null,e}return n(e,t),e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this._setActivityTime(),this._controller.openActivityPanel(),this._refreshListView(),this.labTip&&(this.labTip.string=r.Language.Activity_18_Tip)},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.Recharge_Success]=this._refreshListView,t[e.Res_GET_ACTIVITY_INFO]=this._resInfo,t[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,r.EventUtil.registerEvents(t,this)},e.prototype._resInfo=function(t){t===this.getActivityId()&&this._refreshListView()},e.prototype._refreshListView=function(){var t=this._controller.getActivityList();this.node.getComponent(u).refreshListData(t)},e.prototype._setActivityTime=function(){var t=this.getDurationStr();this.labActivityTime.string=t},e.prototype._onActivityClose=function(t){this._activityId===t&&this.onDestroy()},a([l(cc.Label)],e.prototype,"labActivityTime",void 0),a([l(cc.Label)],e.prototype,"labTip",void 0),e=a([s],e)}(c);e.exports=d,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0}],ConsumeActivityTable:[function(t,e,i){"use strict";cc._RF.push(e,"21315O3ydhGi5NkUPMXSD/9","ConsumeActivityTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Activity18Config",e._tblName="activity_18_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getDataById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ContinuousRechargeController:[function(t,e,i){"use strict";cc._RF.push(e,"08e4azvWyFHK4egcdoC92Ck","ContinuousRechargeController");var n=t("RechargeBaseController"),a=t("ContinuousRechargeModel"),r=cc.Class({extends:n,properties:{_modelList:null},initData:function(t){this._super(t),this.clearData()},clearData:function(){this._modelList=[]},getDatas:function(){return this._modelList},isSortStatus:function(){return!1},parseQueryInfo:function(t){var e=t.statusMap,i=this.getActivityData();this._modelList=[];var n=t.openDay,r=t.chargeDayList,o=ArrayUtils.contains(r,n),s=td.GetTableClass(td.TableEnum.ContinuousRechargeTable).getDatasOfDataId(i);if(s)for(var l=!1,c=0,u=s.length;c<u;c++){var d=s[c],h=new a;h.initData(d);var p=0,_=e[h.getDay()];_?p=1===_?td.ActivityEnum.OperateStatus.OperateAble:td.ActivityEnum.OperateStatus.Operated:o||l||(p=td.ActivityEnum.OperateStatus.NotOperateAble,l=!0),h.setStatus(p),this._modelList.push(h)}},receiveReward:function(t){if(this.isInOpenStatus()){var e={};e.activityId=this.getActivityId(),e.id=t,this.operateActivity(e)}},hasRedPoint:function(){return!0},setShowBuyGiftRed:function(){},redPointTip:function(){for(var t=0,e=this._modelList.length;t<e;t++){if(this._modelList[t].getReceiveStatus()===td.ActivityEnum.OperateStatus.OperateAble)return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.Res_GET_ACTIVITY_INFO]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ContinuousRechargeModel:"ContinuousRechargeModel",RechargeBaseController:"RechargeBaseController"}],ContinuousRechargeItem:[function(t,e,i){"use strict";cc._RF.push(e,"0b408ipnHpJtYLNeu00PhZS","ContinuousRechargeItem");var n=t("RechargeBaseItem"),a=cc.Class({extends:n,properties:{_controller:null,_receiveCallBack:null},setData:function(t){this._super(t)},updateItem:function(t,e){this._super(t,e),this.node.getChildByName("labDay").getComponent(cc.Label).string=cc.js.formatStr(td.Language.continuousRecharge,e.getDay()),this.setItemBtn(t,e)},setItemBtn:function(t,e){gdk.rm.getResByUrl(td.resDef.pngPlist.GY_Button,cc.SpriteAtlas);var i=this.node.getChildByName("btnOperation");i.active=!1,td.GlobalFunction.setButtonGray(i,!1);var n=i.getChildByName("Label"),a=this.node.getChildByName("imgReceived");a.active=!1;var r=this.node.getChildByName("imgUnfinished");switch(r.active=!1,e.getReceiveStatus()){case td.ActivityEnum.OperateStatus.NotOperateAble:i.active=!0,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_anniu_02",i),n.getComponent(cc.Label).string=td.Language.recharge,n.color=cc.color(176,79,0);break;case td.ActivityEnum.OperateStatus.OperateAble:i.active=!0,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_anniu_03",i),n.getComponent(cc.Label).string=td.Language.missionBtnTitle.split("|")[0],n.color=cc.color(16,98,161);break;case td.ActivityEnum.OperateStatus.Operated:return void(a.active=!0);default:return void(r.active=!0)}var o=i.getComponent(cc.Button);o.clickEvents=[];var s=new cc.Component.EventHandler;s.target=this.node,s.component="ContinuousRechargeItem",s.handler="onOperateItem",s.customEventData=e,o.clickEvents.push(s),td.RedPointUtil.createRedPointSimple(i,{x:-10,y:-10},e.getReceiveStatus()===td.ActivityEnum.OperateStatus.OperateAble)},onOperateItem:function(t,e){var i=e,n=i.getReceiveStatus();n===td.ActivityEnum.OperateStatus.NotOperateAble?this.doRechargeAction():n===td.ActivityEnum.OperateStatus.OperateAble&&this.doReceiveAction(i)},doRechargeAction:function(){td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityConfig,td.ActivityEnum.ActivityType.ContinuousRecharge])},doReceiveAction:function(t){this._receiveCallBack&&"function"==typeof this._receiveCallBack&&this._receiveCallBack(t)}});e.exports=a,cc._RF.pop()},{RechargeBaseItem:"RechargeBaseItem"}],ContinuousRechargeModel:[function(t,e,i){"use strict";cc._RF.push(e,"ce127R+KSZIUabKm22v2Ppn","ContinuousRechargeModel");var n=cc.Class({properties:{_day:null,_rewards:null,_optionalRewards:null,_status:null,_belongActivityId:null},initData:function(t,e){this._day=t.updateDay,this._rewards=t.rewards,this._optionalRewards=t.optionalRewards||[],this._belongActivityId=e,this._status=0},getId:function(){return this._day},getDay:function(){return this._day},getRewards:function(){return this._rewards},getOptionalRewards:function(){return this._optionalRewards},getReceiveStatus:function(){return this._status},setStatus:function(t){this._status=t}});e.exports=n,cc._RF.pop()},{}],ContinuousRechargePanel:[function(t,e,i){"use strict";cc._RF.push(e,"d5a0c6bANdHz5sUGWWasqar","ContinuousRechargePanel");var n=t("RechargeBasePanel"),a=(t("OptimizeVerticalListView"),cc.Class({extends:n,properties:{_listView:null},initData:function(t){this._super(t)},onLoad:function(){var t=this.node.getChildByName("scrollView");this._listView=t.getComponent("OptimizeVerticalListView")},onEnable:function(){this._super(),this._controller.setShowBuyGiftRed()},onDisable:function(){this._super()},doReceiveAction:function(t){var e=this,i={id:t.getId()},n=t.getOptionalRewards?t.getOptionalRewards():[];if(n.length>0){var a={};a.itemList=n,a.callFunc=function(t){i.parmeterMap={10:t},e.getActivityController().operateActivity(i)},td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_SelectRechargeReward,a)}else i.parmeterMap={10:0},this.getActivityController().operateActivity(i)},onReceiveOperation:function(t){this._super(t)}}));e.exports=a,cc._RF.pop()},{OptimizeVerticalListView:void 0,RechargeBasePanel:"RechargeBasePanel"}],ContinuousRechargeTable:[function(t,e,i){"use strict";cc._RF.push(e,"11e442dHlFBT49OTjz+jCbH","ContinuousRechargeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ContinuousRechargeTable",properties:{_tblName:"activity_63_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ContinuousTotalRechargeTable:[function(t,e,i){"use strict";cc._RF.push(e,"914c8SY0GRCNJ44gfTVMJbM","ContinuousTotalRechargeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ContinuousTotalRechargeConfig",properties:{_tblName:"continuous_total_recharge_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e},getDataByDataIdAndId:function(t,e){var i=this._datas[t];if(i)for(var n=0;n<i.length;n++)if(i[n].id===e)return i[n];return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CopyEntryModel:[function(t,e,i){"use strict";cc._RF.push(e,"77af4xlg/5CmorbXMdUAWrE","CopyEntryModel");var n=t("Model");td.CopyEntryModel=cc.Class({extends:n,properties:{_id:null,_title:null,_previewRewards:null,_sortRank:null,_imgTitle:null},init:function(t){this._super("CopyEntryModel"),this._id=t.id,this._title=t.title,this._sortRank=t.sort,this._imgTitle=t.imgTitle,this._previewRewards=td.RewardManager.parseRewardListDetail(t.previewRewards)},getId:function(){return this._id},getTitle:function(){return this._title},getPreviewRewards:function(){return this._previewRewards},getSortRank:function(){return this._sortRank},getImgTitle:function(){return this._imgTitle}}),cc._RF.pop()},{Model:"Model"}],CopyModel:[function(t,e,i){"use strict";cc._RF.push(e,"4315dA+k81LO4HF5jP09jJZ","CopyModel");var n=t("CommonEnum"),a=(t("EnemyModel"),t("Model"));td.CopyTypeModel=cc.Class({extends:a,properties:{_copyType:null,_dataList:null,_challengeTimes:0,_resetTimes:0,_initTimes:0},init:function(t){this._super("CopyTypeModel"),this._copyType=parseInt(t),this._dataList={};var e=td.GetTableClass(td.TableEnum.MaterialCopyConfig).getCopyConfigByType(t);for(var i in e){var n=new td.CopyModel;n.init(e[i]),this._dataList[i]=n}var a=td.GetTableClass(td.TableEnum.MaterialCopyTypeConfig).getInspireData(t);this._initTimes=a.challengeTimes,this._challengeTimes=0,this._resetTimes=0},getType:function(){return this._copyType},getDataList:function(){return this._dataList},getDataArray:function(){var t=[];for(var e in this._dataList)t.push(this._dataList[e]);return t.sort(function(t,e){return t.index-e.index})},getDataByShowIndex:function(t){},getMaxUnLockData:function(){},getDataById:function(t){return this._dataList&&this._dataList[t]?this._dataList[t]:null},setChallengeTimes:function(t){this._challengeTimes=t},setResetTimes:function(t){this._resetTimes=t},getResetTimes:function(){return this._resetTimes},getChallengeTimes:function(){return this._initTimes+this._resetTimes-this._challengeTimes},getInitTimes:function(){return this._initTimes},getMaxChallengeTimes:function(){var t=td.PrerogativeManager.getPrerogative(n.PrerogativeEnum.DUNGEON_CHALLENGE_TIMES);if(!t)return 0;var e=t.getValue();if(!e)return 0;for(var i=e.length-1;i>=0;i--){var a=e[i];if(a[0]===this._copyType)return a[1]}return 0},updataDataList:function(t){for(var e=0;e<t.length;e++){var i=t[e].dungeonId;if(this._dataList[i]){var n=t[e].star;this._dataList[i].setStar(n)}}},getLockById:function(t){var e=td.Account.getUserData().getLevel(),i=this.getDataById(t);if(i.getStar()>0)return!1;if(e<i.getLevelLimit())return!0;var n=i.getPreId();if(0!=n&&this.getDataById(n).getStar()<=0)return!0;return!1}}),td.CopyModel=cc.Class({extends:a,properties:{_id:null,_type:null,_icon:null,_index:null,_preId:null,_levelLimit:null,_rewardStr:null,_gateId:null,_mapIndex:null,_roadIndex:null,_rewardType:null,_rewardId:null,_rewardCountMin:null,_rewardCountMax:null,_hpTimes:null,_star:null},init:function(t){this._super("CopyModel"),this._id=t.id,this._type=t.type,this._icon=t.icon,this._index=t.index,this._preId=t.preId,this._levelLimit=t.levelLimit,this._rewardStr=t.reward,this._gateId=t.gateId,this._mapIndex=t.mapIndex,this._roadIndex=t.roadIndex,this._rewardType=t.rewardType,this._rewardId=t.rewardId,this._rewardCountMin=t.rewardCountMin,this._rewardCountMax=t.rewardCountMax,this._hpTimes=t.hpTimes,this._star=0},getId:function(){return this._id},getType:function(){return this._type},getIndex:function(){return this._index},getIcon:function(){return this._icon},getPreId:function(){return this._preId},getLevelLimit:function(){return this._levelLimit},getRewardStr:function(){return this._rewardStr},getGateId:function(){return this._gateId},getMapIndex:function(){return this._mapIndex},getRoadIndex:function(){return this._roadIndex},getRewardType:function(){return this._rewardType},getRewardId:function(){return this._rewardId},getRewardCountMin:function(){return this._rewardCountMin},getRewardCountMax:function(){return this._rewardCountMax},setStar:function(t){this._star=t},getStar:function(){return this._star},getHpTimes:function(){return this._hpTimes},getLockStr:function(){return td.Account.getUserData().getLevel()<this._levelLimit?cc.js.formatStr("%s",td.Language.lvUnlock1,this._levelLimit):td.Language.copyUnlockStr}}),cc._RF.pop()},{CommonEnum:void 0,EnemyModel:"EnemyModel",Model:"Model"}],CoustomGiftController:[function(t,e,i){"use strict";cc._RF.push(e,"9ff31IFOoVOWLzuCwLHeJgn","CoustomGiftController");var n=t("ActivityBaseController"),a=t("CoustomGiftModel"),r=cc.Class({extends:n,properties:{_modelList:null},initData:function(t){this._super(t),this.clearData(),this._initData()},clearData:function(){this._modelList=[],this._receiveMap={}},getModelList:function(){return this._modelList},_reqReqSelcetReward:function(t,e){var i={parmeterMap:{id:t,43:1,44:e}};this.operateActivity(i)},reqReqRecievReward:function(t){var e={parmeterMap:{id:t,43:2}};this.operateActivity(e)},activityParse:function(t){var e=t.record.map||{};for(var i in e){var n=e[i];this._updateModelInfo(i,n)}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_COUSTOM_GIFT_INFO)},_updateModelInfo:function(t,e){var i=this.getCustomModel(t);i&&i.updateInfo(e)},getCustomModel:function(t){for(var e=0,i=this._modelList.length;e<i;e++){var n=this._modelList[e];if(n.getChargeId()===t)return n}return null},_initData:function(){for(var t=td.GetTableClass(td.TableEnum.ActivityCoustomGiftTable).getDatasOfDataId(this.getActivityData()),e=0,i=t.length;e<i;e++){var n=t[e],r=new a;r.initData(n),this._modelList.push(r)}},hasRedPoint:function(){return!0},redPointTip:function(){for(var t=0,e=this._modelList.length;t<e;t++){if(this._modelList[t].hasRewardToReceive())return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.REFRESH_COUSTOM_GIFT_INFO]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",CoustomGiftModel:"CoustomGiftModel"}],CoustomGiftModel:[function(t,e,i){"use strict";cc._RF.push(e,"7399e8c1BRJy4ZqtIQ9aw8R","CoustomGiftModel");var n=t("CoustomGiftPoolModel"),a=cc.Class({properties:{_data:null,_chargeId:null,_rewards:null,_rewardPools:null,_times:null,_des:null,_oriPrice:null,_poolModelList:null,_buyTimes:null,_selectId:null},initData:function(t){this._data=t.data,this._chargeId=t.chargeId,this._rewards=td.RewardManager.parseRewardListDetail(t.rewards);var e=t.rewardPool;for(var i in this._poolModelList={},e){var a=e[i][1],r=e[i][0],o=td.GetTableClass(td.TableEnum.ActivityCoustomGiftPoolTable).getRewardById(a),s=new n;s.initData(o,r),this._poolModelList[r]=s}this._times=t.times,this._reward=td.RewardManager.parseRewardListDetail(t.reward)},getData:function(){return this._data},getChargeId:function(){return this._chargeId},getCost:function(){return this._cost},getTimes:function(){return this._times},getLeftTimes:function(){return this._times-this._buyTimes},getRewards:function(){return this._reward},getRewardPoolList:function(){return this._poolModelList},updateInfo:function(t){this._buyTimes=t.times,this._rewardMap=t.rewardMap,this._status=t.status},hasRewardToReceive:function(){return this._buyTimes<this._times&&this._status===td.ActivityEnum.RewardStatus.FINISH},getOptionIdSelectRewardId:function(t){return this._rewardMap[t]},getOptionIdSelectReward:function(t){for(var e=this.getOptionIdSelectRewardId(t),i=this._poolModelList[t],n=0,a=i.length;n<a;n++)if(i[n].getId()===e)return i[n];return null},getModelState:function(){}});e.exports=a,cc._RF.pop()},{CoustomGiftPoolModel:"CoustomGiftPoolModel"}],CoustomGiftPoolModel:[function(t,e,i){"use strict";cc._RF.push(e,"48050C3us5F4aDJdfnRy950","CoustomGiftPoolModel");var n=cc.Class({properties:{_id:null,_poolId:null,_rewards:null,_levelLimit:null,_option:null,_selectId:null},initData:function(t,e){this._id=t.id,this._poolId=t.poolId,this._levelLimit=t.levelLimit,this._reward=td.RewardManager.parseRewardListDetail(t.rewards),this._option=e},getId:function(){return this._id},getPoolId:function(){return this._poolId},getLevelLimit:function(){return this._levelLimit},getRewards:function(){return this._reward},setSlectId:function(t){this._selectId=t}});e.exports=n,cc._RF.pop()},{}],CreateRoleLayout:[function(t,e,i){"use strict";cc._RF.push(e,"e0e50HE3iRCqa3YJ5pAw0bL","CreateRoleLayout");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../fight/pvp/Model/PvpFsmEventId"),o=cc._decorator,s=o.ccclass,l=o.property,c=window,u=c.td;function d(t,e){return Math.floor(Math.random()*(e-t+1)+t)}var h=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.roleNameEdit=null,t.bg=null,t.imgHero=null,t._clickCreate=!1,t._sex=d(1,2),t._tag=d(1,3),t}return n(i,e),i.prototype.onLoad=function(){var t={},e=u.EventNameEnum;t[e.CREATE_ACTOR_FAIL]=this._createActorFail,t[e.REQUEST_CHANGE_USERNAME_SUCC]=this._onReNameSucc,t[e.RES_RANDOM_NAME]=this._randomNameSucc,u.EventUtil.registerEvents(t,this),this.node.zIndex=100,this._randomName();var i=u.GlobalFunction.createPrefabInstance("fightRes/pve/protege/MaliGongZhu");this.imgHero.removeAllChildren(),this.imgHero.addChild(i),i.getChildByName("hero").z=900,i.scale=2},i.prototype.onDestroy=function(){u.EventUtil.unregisterAllEvents(this)},i.prototype.onTouchEnterGame=function(){if(u.GlobalFunction.checkCanClicked(1e3)){var e=this.roleNameEdit.string;if(e&&""!==e&&(e=e.replace(/(^\s*)|(\s*$)/g,"")),e&&""!==e){if(e.length<2||e.length>6)return this._clickCreate=!1,void u.GlobalFunction.showBroadcastTip(491);var i=t("UFSdkManager");i.getInstance()._userManager.checkSensitiveWord?i.getInstance().checkSensitiveWord(e,function(){u.EventUtil.dispatchEvent(u.EventNameEnum.REQUEST_CHANGE_USERNAME,{name:e,free:!0})},function(){var t=new u.BroadcastContent(436);u.EventUtil.dispatchEvent(u.EventNameEnum.SHOW_BROADCAST,t)}):u.EventUtil.dispatchEvent(u.EventNameEnum.REQUEST_CHANGE_USERNAME,{name:e,free:!0})}else u.GlobalFunction.showBroadcastTip(497)}else u.GlobalFunction.showBroadcastTip(490)},i.prototype.onTouchRandomName=function(){this._randomName()},i.prototype.onTourchSelectRole=function(t){var e=t.currentTarget.name,i=parseInt(e.substr(e.length-1));this._tag!=i&&(this._tag=i)},i.prototype.onTouchSelectSex=function(t){var e=t.currentTarget.name,i=parseInt(e.substr(e.length-1));this._sex!=i&&(this._sex=i,this._randomName())},i.prototype._onReNameSucc=function(e){if(e===u.NetCode.SUCCESS){if(u.EventUtil.dispatchEvent(u.EventNameEnum.GUIDE_STEP_FINISH),u.EventUtil.dispatchEvent(u.EventNameEnum.FIRST_BATTLE_FINISH),this.node.removeFromParent(),u.PveCopyManager.prepareHookData(),gdk.fsm.Fsm.broadcastEvent(r.default.ENTER_PVE_HOOK_PANEL),c.DX_CHANNEL==c.SdkType.CX_GAME){var i=t("UFSdkManager"),n=u.Account.getUserData();u.GameRoleInfo.eventType="0",u.GameRoleInfo.roleLevel="1",u.GameRoleInfo.roleId=n.sid+"",u.GameRoleInfo.roleName=n.nick,u.GameRoleInfo.serverId=c.UFServerManager.getInstance().getSelectServerData().serverId+"",u.GameRoleInfo.serverName=c.UFServerManager.getInstance().getSelectServerData().serverName,u.GameRoleInfo.serverType=c.UFServerManager.getInstance().getSelectServerData().serverType,u.GameRoleInfo.vipLevel="0",u.GameRoleInfo.fightValue="0",u.GameRoleInfo.partyName="",i.getInstance().reportRoleInfo(u.GameRoleInfo)}}else this._clickCreate=!1},Object.defineProperty(i.prototype,"_selectRoleTag",{set:function(t){for(var e="selectRole"+t,i=1;i<=3;i++){var n=this.node.getChildByName("selectRole"+i),a=n.getChildByName("select");e===n.name?a.active=!0:a.active=!1}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"_selectedSex",{set:function(t){var e="selectSex"+t,i=this.node.getChildByName("selectSex1");i.active=!0;var n=i.getChildByName("select");e===i.name?n.active=!0:n.active=!1,(i=this.node.getChildByName("selectSex2")).active=!0,n=i.getChildByName("select"),e===i.name?n.active=!0:n.active=!1;for(var a=[{1:"DL_touxiakuang_01",2:"DL_touxiakuang_02",3:"DL_touxiakuang_03"},{1:"DL_touxiakuang_04",2:"DL_touxiakuang_05",3:"DL_touxiakuang_06"}],r=1;r<=3;r++){var o=this.node.getChildByName("selectRole"+r).getChildByName("header");this.createAltasSprite(u.resDef.pngPlist.DL_denglu,a[t-1][r],o)}},enumerable:!1,configurable:!0}),i.prototype._randomName=function(){u.EventUtil.dispatchEvent(u.EventNameEnum.REQ_RANDOM_NAME)},i.prototype._randomNameSucc=function(t){this.roleNameEdit.string=t},i.prototype._createActorFail=function(){this._clickCreate=!1},i.prototype.createAltasSprite=function(t,e,i){var n=i.getComponent(cc.Sprite);n||(n=i.addComponent(cc.Sprite)),gdk.rm.loadRes(null,t,cc.SpriteAtlas,function(){if(cc.isValid(n)){var i=gdk.rm.getResByUrl(t,cc.SpriteAtlas).getSpriteFrame(e);n.spriteFrame=i}})},a([l(cc.EditBox)],i.prototype,"roleNameEdit",void 0),a([l(cc.Node)],i.prototype,"bg",void 0),a([l(cc.Node)],i.prototype,"imgHero",void 0),a([gdk.binding("_tag")],i.prototype,"_selectRoleTag",null),a([gdk.binding("_sex")],i.prototype,"_selectedSex",null),i=a([s],i)}(gdk.BasePanel);i.default=h,cc._RF.pop()},{"../fight/pvp/Model/PvpFsmEventId":"PvpFsmEventId",UFSdkManager:void 0}],CrossArenaHallModel:[function(t,e,i){"use strict";cc._RF.push(e,"256a2+FPvhPR7P2KuD+cu13","CrossArenaHallModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o},a=cc._decorator.ccclass,r=function(){function t(){}return t.prototype.setGroupId=function(t){this._groupId=t},t.prototype.getGroupId=function(){return this._groupId},t.prototype.setList=function(t){this._list=[];for(var e=0;e<t.length;e++)this._list.push(t[e])},t.prototype.getList=function(){return this._list.sort(this.sortByRank)},t.prototype.sortByRank=function(t,e){return t.getRank()-e.getRank()},t=n([a],t)}();e.exports=r,cc._RF.pop()},{}],CrossArenaManager:[function(t,e,i){"use strict";cc._RF.push(e,"2443asEp6xB44bUBD+8hkwd","CrossArenaManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,window.td),s=t("CrossArenaPlayerModel"),l=t("CrossArenaHallModel"),c=function(){function t(){this._isOpen=!1,this._maxBattlefieldId=9999,this._maxRank=9999,this._maxZoneId=9999,this._isJumpFight=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this._groupList={},this._hallList=[],this._isOpen=!1,this.destroyData()},t.prototype.destroyData=function(){this._isJumpFight=!1},t.prototype.addListener=function(){var t=o.MsgModuleName.CROSS_ARENA,e=o.MsgCmd.CROSS_ARENA;o.ServerDelegate.registerMessage(t,e.GET_CROSS_ARENA_ACTOR,this.parseMyInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.GET_CROSS_ARENA_GROUP,this.parseMyGroupList.bind(this)),o.ServerDelegate.registerMessage(t,e.GET_CROSS_ARENA_HALL,this.parseHallInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.CROSS_ARENA_CHALLENGE,this.parseChallengeInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.GET_CROSS_ARENA_REPORT,this.parseReport.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_CROSS_ARENA_ACTOR,this.parseMyInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_CROSS_ARENA_GROUP,this.parseMyGroupList.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_CROSS_ARENA_REFRESH,this.parseRefresh.bind(this))},t.prototype.parseMyInfo=function(t,e){t===o.NetCode.SUCCESS&&e&&0!==e.myLen()&&(e.battlefieldId&&(this._maxBattlefieldId=e.battlefieldId),e.rank&&(this._maxRank=e.rank),e.zoneId&&(this._maxZoneId=e.zoneId),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GET_CROSS_ARENA_ACTOR))},t.prototype.parseMyGroupList=function(t,e){var i=this;if(t===o.NetCode.SUCCESS&&e&&0!==e.myLen()){var n=e.group;n.zoneId&&(this._zoneId=n.zoneId),n.battlefieldId&&(this._battlefieldId=n.battlefieldId),n.groupId&&(this._groupId=n.groupId);var a=n.ranks,r=o.Account.getUserData().getGamerId();this._groupList={},a.forEach(function(t){var e=t.attributes[o.UserPropertyEnum.GamerId];i._groupList[t.rank]||(i._groupList[t.rank]=new s),i._groupList[t.rank].update(t),e===r&&(i._lastRank=i._myRank,i._lastScore=i._myScore,i._myRank=t.rank,i._myScore=t.score,0===i._lastRank&&(i._lastRank=i._myRank,i._lastScore=i._myScore))}),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GET_CROSS_ARENA_GROUP)}},t.prototype.parseHallInfo=function(t,e){var i=this;if(t===o.NetCode.SUCCESS&&e&&0!==e.myLen()){var n=e.halls;this._hallList=[],n.forEach(function(t){var e=new l;e.setGroupId(t.groupId);for(var n=t.ranks,a=[],r=0;r<n.length;r++){var o=new s;o.update(n[r]),a.push(o)}e.setList(a),i._hallList.push(e)}),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GET_CROSS_ARENA_HALL)}},t.prototype.parseChallengeInfo=function(t,e){o.NetCode.SUCCESS},t.prototype.parseReport=function(t,e){t===o.NetCode.SUCCESS&&e&&0!==e.myLen()&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GET_CROSS_ARENA_REPORT,e.reports)},t.prototype.parseRefresh=function(){this.requestMyGroupList()},t.prototype.addEventListener=function(){var t=o.EventUtil,e=o.EventNameEnum,i={};i[e.REQ_GET_CROSS_ARENA_ACTOR]=this.requestMyInfo,i[e.REQ_GET_CROSS_ARENA_GROUP]=this.requestMyGroupList,i[e.REQ_GET_CROSS_ARENA_HALL]=this.requestHallInfo,i[e.REQ_CROSS_ARENA_CHALLENGE]=this.requestChallenge,i[e.REQ_GET_CROSS_ARENA_REPORT]=this.requestReport,i[e.ON_GET_SERVER_START_DAYS]=this.reqInfo,t.registerEvents(i,this)},t.prototype.reqInfo=function(){this.requestMyGroupList(),this.requestMyInfo()},t.prototype.requestMyInfo=function(){if(o.UnlockManager.isPanelUnlock(o.PanelEnum.Panel_CrossArenaHome)){var t={};t.module=o.MsgModuleName.CROSS_ARENA,t.cmd=o.MsgCmd.CROSS_ARENA.GET_CROSS_ARENA_ACTOR,o.ServerDelegate.sendMessage(t)}},t.prototype.requestMyGroupList=function(){if(o.UnlockManager.isPanelUnlock(o.PanelEnum.Panel_CrossArenaHome)){var t={};t.module=o.MsgModuleName.CROSS_ARENA,t.cmd=o.MsgCmd.CROSS_ARENA.GET_CROSS_ARENA_GROUP,o.ServerDelegate.sendMessage(t)}},t.prototype.requestHallInfo=function(){var t={};t.module=o.MsgModuleName.CROSS_ARENA,t.cmd=o.MsgCmd.CROSS_ARENA.GET_CROSS_ARENA_HALL,o.ServerDelegate.sendMessage(t)},t.prototype.requestChallenge=function(t){var e={};e.module=o.MsgModuleName.CROSS_ARENA,e.cmd=o.MsgCmd.CROSS_ARENA.CROSS_ARENA_CHALLENGE,e.actorId=t,o.ServerDelegate.sendMessage(e)},t.prototype.requestReport=function(){var t={};t.module=o.MsgModuleName.CROSS_ARENA,t.cmd=o.MsgCmd.CROSS_ARENA.GET_CROSS_ARENA_REPORT,o.ServerDelegate.sendMessage(t)},t.prototype.getZoneId=function(){return this._zoneId},t.prototype.getBattlefieldId=function(){return this._battlefieldId},t.prototype.getGroupId=function(){return this._groupId},t.prototype.getMyRank=function(){return this._myRank},t.prototype.getGroupList=function(){return this._groupList},t.prototype.getHallList=function(){return this._hallList},t.prototype.getMyScore=function(){return this._myScore},t.prototype.getUpRank=function(){return this._lastRank-this._myRank},t.prototype.getLastRank=function(){return this._lastRank},t.prototype.getScoreUp=function(){return this._myScore-this._lastScore},t.prototype.getLastScore=function(){return this._lastScore},t.prototype.getMaxBattlefieldId=function(){return this._maxBattlefieldId},t.prototype.getMaxRank=function(){return this._maxRank},t.prototype.getMaxZoneId=function(){return this._maxZoneId},t.prototype.getIsOpen=function(){var t=o.TimeUtil.getServerDate().getHours();return t>=o.GetConfig("CROSS_ARENA_AUTO_CHALLENGE_TIME")||t<o.GetConfig("CROSS_ARENA_CHALLENGE_TIME_LIMIT")[0]||this._isOpen},t.prototype.openPanel=function(){this._isOpen=!0},t.prototype.getRankStateByRank=function(t){var e=o.GetTableClass(o.TableEnum.CrossArenaTable).getDataByZoneIdAndBattlefieldId(this._zoneId,this._battlefieldId),i=e.relegateRank;return t<=e.promoteRank?1:t>=i?-1:0},t.prototype.getChallengeModelByActorId=function(t){for(var e in this._groupList)if(this._groupList[e].getGamerId()===t)return this._groupList[e];return null},t.prototype.getRankList=function(){var t=[];for(var e in this._groupList)t.push(this._groupList[e]);return t.sort(this.sortByRank)},t.prototype.sortByRank=function(t,e){return t.getRank()-e.getRank()},t.prototype.isRedPointTips=function(){if(!this.isOpen())return!1;if(o.TimeUtil.getServerDate().getHours()>=o.GetConfig("CROSS_ARENA_REFRESH_ATTRIBUTE_TIME"))return!1;var t=o.Account.getUserData().getGamerId();for(var e in this._groupList)if(this._groupList[e].getGamerId()!==t&&0!==this._groupList[e].getChallengeResult())return!1;return!0},t.prototype.redPointEvents=function(){return[o.EventNameEnum.RES_GET_CROSS_ARENA_GROUP]},t.prototype.getLeftChallengeFreeTimes=function(){var t=o.Account.getUserData().getGamerId(),e=0;for(var i in this._groupList)this._groupList[i].getGamerId()!==t&&0===this._groupList[i].getChallengeResult()&&e++;return e},t.prototype.getLeftChallengeTimes=function(){var t=o.Account.getUserData().getGamerId(),e=0;for(var i in this._groupList)this._groupList[i].getGamerId()!==t&&-1===this._groupList[i].getChallengeResult()&&e++;return e},t.prototype.isOpen=function(){return!!o.UnlockManager.isPanelUnlock(o.PanelEnum.Panel_CrossArenaHome)&&(0!==o.TimeUtil.getServerDate().getDay()&&!(!this._groupList||this._groupList==={}||0===this._groupList.myLen()))},t.prototype.isJumpFight=function(){return this._isJumpFight},t.prototype.setJumpFight=function(t){this._isJumpFight=t},t=e=n([r],t)}();i.default=c,cc._RF.pop()},{CrossArenaHallModel:"CrossArenaHallModel",CrossArenaPlayerModel:"CrossArenaPlayerModel"}],CrossArenaPlayerModel:[function(t,e,i){"use strict";cc._RF.push(e,"e90e5n6hBNPlKGvfoOw+fbU","CrossArenaPlayerModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=window,r=cc._decorator.ccclass,o=t("../Manager/CrossArenaManager"),s=t("BaseUser"),l=function(){function e(){this._rank=0,this._score=0,this._challengeResult=-1,this.serverId=0}return e.prototype.update=function(t){this._attributes=t.attributes,this._rank=t.rank,this._score=t.score,this._challengeResult=t.state,this.serverId=this._attributes[td.UserPropertyEnum.ServerId]},e.prototype.getAttributes=function(){return this._attributes},e.prototype.getRank=function(){return this._rank},e.prototype.getScore=function(){return this._score},e.prototype.getChallengeResult=function(){return this._challengeResult},e.prototype.getNickName=function(){return this._attributes[td.UserPropertyEnum.NickName]},e.prototype.getServerName=function(){for(var t=a.UFServerManager.getInstance().getServerList(),e="",i=0;i<t.length;i++)if(t[i].serverId===this._attributes[td.UserPropertyEnum.ServerId]){e=t[i].serverName;break}var n="[%s"+td.Language.arena+"]%s";return cc.js.formatStr(n,this._attributes[td.UserPropertyEnum.ServerId],e)},e.prototype.getVipLv=function(){return this._attributes[td.UserPropertyEnum.Vip]},e.prototype.getPower=function(){return this._attributes[td.UserPropertyEnum.FightPower]},e.prototype.getGamerId=function(){return this._attributes[td.UserPropertyEnum.GamerId]},e.prototype.getDivinePos=function(){return this._attributes[td.UserPropertyEnum.DIVINE_POSITION]||0},e.prototype.getServerId=function(){return this.serverId},e.prototype.getAvatar=function(){var t=new s;return t.init("",this._attributes),td.GlobalFunction.createAvatarHeadWidget(3,t,!1)},e.prototype.getShowMercenary=function(){var e=td.GetTableClass(td.TableEnum.LiveShowConfigTable).getRoleTypeByShowId(this._attributes[td.UserPropertyEnum.LINE_UP_SHOW_ID]),i=td.GetTableClass(td.TableEnum.HeroTable).getHeroById(e);if(!i)return cc.log("HeroManger._getNewMercenary() parse configId is error!!%s",e),null;var n=new(t("HeroModel"));return n.init(i),n},e.prototype.getRewards=function(){for(var t=o.default.getInstance().getBattlefieldId(),e=o.default.getInstance().getZoneId(),i=td.GetTableClass(td.TableEnum.CrossArenaTable).getDataByZoneIdAndBattlefieldId(e,t).rewards,n=0;n<i.length;n++)if(this._rank<=i[n][0])return td.RewardManager.parseRewardListDetail(i[n][1]);return td.RewardManager.parseRewardListDetail(i[i.length-1][1])},e.prototype.isMyself=function(){return this._attributes[td.UserPropertyEnum.GamerId]===td.Account.getUserData().getGamerId()},e.prototype.getLevel=function(){return this._attributes[td.UserPropertyEnum.Level]},e.prototype.getFightPower=function(){return this._attributes[td.UserPropertyEnum.FightPower]},e=n([r],e)}();e.exports=l,cc._RF.pop()},{"../Manager/CrossArenaManager":"CrossArenaManager",BaseUser:"BaseUser",HeroModel:"HeroModel"}],CrossArenaTable:[function(t,e,i){"use strict";cc._RF.push(e,"0f0812l4wxOUrIGQODOZVc0","CrossArenaTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="CrossArenaConfig",e._tblName="cross_arena_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.zoneId]||(t[a.zoneId]={}),t[a.zoneId][a.battlefieldId]=a}},e.prototype.getDatasByZoneId=function(t){return this._data[t]},e.prototype.getDataByZoneIdAndBattlefieldId=function(t,e){var i=this._data[t];if(i)for(var n in i)if(i[n].battlefieldId===e)return i[n];return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CrossCupBetConfig:[function(t,e,i){"use strict";cc._RF.push(e,"7e1baK3ZtpGfqRHa9+OiFAJ","CrossCupBetConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="CrossCupBetConfig",e._tblName="cross_cup_bet_config",e._data=[],e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];this._data[n.level]||(this._data[n.level]=[]),this._data[n.level].push(n)}},e.prototype.getBetCfgByLvAndState=function(t,e){var i=[];for(var n in this._data){var a=this._data[n];t>=Number(n)&&(i=a)}this._data[t];for(var r={},o=0;o<i.length;o++){var s=i[o];e>=s.state&&(r=s)}return r},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CrossCupEnum:[function(t,e,i){"use strict";cc._RF.push(e,"6bfe2qOBepMoovzHogARAFV","CrossCupEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.CrossCupSubState=i.CrossCupState=i.CrossCupBattleType=void 0,function(t){t[t.V1=1]="V1",t[t.V2=2]="V2",t[t.V4=3]="V4",t[t.NONE=0]="NONE"}(i.CrossCupBattleType||(i.CrossCupBattleType={})),function(t){t[t.ENTER=1]="ENTER",t[t.GROUP_PROMOTION=2]="GROUP_PROMOTION",t[t.GROUP_QUARTER=3]="GROUP_QUARTER",t[t.GROUP_SEMI=4]="GROUP_SEMI",t[t.GROUP_FINAL=5]="GROUP_FINAL",t[t.QUARTER=6]="QUARTER",t[t.SEMI=7]="SEMI",t[t.FINAL=8]="FINAL",t[t.SLEEP=9]="SLEEP",t[t.NONE=0]="NONE"}(i.CrossCupState||(i.CrossCupState={})),function(t){t[t.LINEUP=1]="LINEUP",t[t.BET=2]="BET",t[t.BATTLE=3]="BATTLE",t[t.SLEEP=4]="SLEEP",t[t.NONE=0]="NONE"}(i.CrossCupSubState||(i.CrossCupSubState={})),cc._RF.pop()},{}],CrossCupGroupModel:[function(t,e,i){"use strict";cc._RF.push(e,"bbc9fAaP4VEdKR1umoTIqOC","CrossCupGroupModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("Model"),a=t("../Enum/CrossCupEnum"),r=t("../Manager/CrossCupManager"),o=t("CrossCupPlayerModel"),s=cc.Class({extends:n,properties:{groupId:null,playerMap:null,winner:null,oppositeGroupId:null,eliminatedState:null,playersArray:null},init:function(t){this.groupId=t.groupId,this.playerMap&&delete this.playerMap,this.playerMap=t.playerMap,this.parsePlayerMap(),this.winner=t.winner,this.oppositeGroupId=t.oppositeGroupId,this.eliminatedState=t.eliminatedState},parsePlayerMap:function(){var t=this,e=this.playerMap;Object.keys(e).forEach(function(e){var i=t.playerMap[e];t.playerMap[i.orderId]=i,delete t.playerMap[e]});var i=1;for(var n in e){var a=e[n];(r=new o).init(a),this.playerMap[n]=r}for(var n in this.playersArray=[],e){var r;(r=e[n]).setPos(i),this.playersArray[this.playersArray.length]=r,i++}},getActorIdByOppositeId:function(t){for(var e in this.playerMap)if(this.playerMap[e].getOppositeId()==t)return this.playerMap[e].getActorId()},getNum2Player:function(){var t=this.playerMap;for(var e in t)if(t[e].getEliminatedState()==a.CrossCupState.GROUP_FINAL)return t[e];return null},getPlayersMap:function(){return this.playerMap},getPlayersData:function(){return this.playersArray},getPlayerByPos:function(){},getGroupId:function(){return this.groupId},getWinner:function(){return this.winner},getOppositeGroupId:function(){return this.oppositeGroupId},getEliminatedState:function(){return this.eliminatedState},getTop2:function(){var t=[],e=r.default.getInstance().getCurZoneInfo(),i=e.getState(),n=e.getSubState();if(!(i>=a.CrossCupState.GROUP_FINAL||i==a.CrossCupState.GROUP_SEMI&&n==a.CrossCupSubState.SLEEP))return t;for(var o in this.playerMap){var s=this.playerMap[o],l=s.getEliminatedState();(l===a.CrossCupState.NONE||l>=a.CrossCupState.GROUP_FINAL)&&(t[t.length]=s)}return t},getNum3And4:function(){var t=[];for(var e in this.playerMap){var i=this.playerMap[e];i.getEliminatedState()===a.CrossCupState.GROUP_SEMI&&(t[t.length]=i)}return t},getTopest:function(){var t=r.default.getInstance().getCurZoneInfo(),e=t.getState(),i=t.getSubState();if(!(e>=a.CrossCupState.QUARTER||e==a.CrossCupState.GROUP_FINAL&&i==a.CrossCupSubState.SLEEP))return null;for(var n in this.playerMap){var o=this.playerMap[n],s=o.getEliminatedState();if(s>=a.CrossCupState.QUARTER||s===a.CrossCupState.NONE)return o}return null},getPlayerByActorId:function(t){var e=this.playerMap;for(var i in e)if(t==e[i].getActorId())return e[i]}});e.exports=s,cc._RF.pop()},{"../Enum/CrossCupEnum":"CrossCupEnum","../Manager/CrossCupManager":"CrossCupManager",CrossCupPlayerModel:"CrossCupPlayerModel",Model:"Model"}],CrossCupManager:[function(t,e,i){"use strict";cc._RF.push(e,"96380HI46lF74G0utgh9M3w","CrossCupManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("CrossCupZoneModel"),r=t("CrossCupPlayerModel"),o=t("CrossCupRankModel"),s=t("CrossCupRankRewardModel"),l=t("../Enum/CrossCupEnum"),c=t("../../Hero/Manager/HeroManager"),u=function(){function t(){this._myZoneId=0,this._betTimes=0,this._checkRankZoneId=0,this._hadShowLineupTip=!1,this._checkState=0,this._isCheckFight=!1,this._isEnterBtnAniShowed=!1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this.initData.hasInit=!1,this._myZoneId=0,this.zoneList=[],this._betTimes=0,this._checkRankZoneId=0,this._zoneModel=null,this._rankInfo=[],this._myEnterInfo=null,this._rankRewardModels=[],this._hadShowLineupTip=!1,this._checkState=0,this._highestState=0,this._myRankData,this._isCheckFight=!1,this._checkData={},this._isEnterBtnAniShowed=!1},t.prototype.addListener=function(){var t=n.ServerDelegate,e=n.MsgModuleName.CROSS_CUP,i=n.MsgCmd.CROSS_CUP;t.registerMessage(e,i.CROSS_CUP_SERVER_ZONE,this._parseServerZoneRes.bind(this)),t.registerMessage(e,i.CROSS_CUP_ACTOR_INFO,this._parseActorRes.bind(this)),t.registerMessage(e,i.CROSS_CUP_ZONE_INFO,this._parseZoneRes.bind(this)),t.registerMessage(e,i.CROSS_CUP_ZONE_RANK,this._parseZoneRankRes.bind(this)),t.registerMessage(e,i.CROSS_CUP_ENTER,this._parseZoneEnterRes.bind(this)),t.registerMessage(e,i.CROSS_CUP_BET,this._parseZoneBetRes.bind(this)),t.registerMessage(e,i.CROSS_CUP_BATTLE,this._parseBattleInfo.bind(this)),t.registerMessage(e,i.CROSS_CUP_LINEUP,this._parseLineupRes.bind(this)),t.registerMessage(e,i.PUSH_CROSS_CUP_ACTOR_INFO,this._parseActorRes.bind(this))},t.prototype.addEventListener=function(){var t=n.EventUtil,e=n.EventNameEnum,i={};i[e.REQ_CROSS_CUP_SERVER_ZONE]=this.requestServerZoneInfo,i[e.REQ_CROSS_CUP_ACTOR_INFO]=this.requestActorInfo,i[e.REQ_CROSS_CUP_ZONE_INFO]=this.requestZoneInfo,i[e.REQ_CROSS_CUP_ZONE_RANK]=this.requestZoneRankInfo,i[e.REQ_CROSS_CUP_ENTER]=this.requestZoneEnter,i[e.REQ_CROSS_CUP_BET]=this.requestZoneBet,i[e.REQ_CROSS_CUP_BATTLE]=this.requestZoneBattle,i[e.REQ_CROSS_CUP_LINEUP]=this.requestLineup,t.registerEvents(i,this)},t.prototype.initData=function(){if(!this.initData.hasInit){n.GetConfig("CROSS_CUP_BET_TIMES"),n.GetConfig("CROSS_CUP_ARENA_RANK_LIMIT");var t=n.GetTableClass(n.TableEnum.CrossCupRewardConfig).getDatas();this._rankRewardModels=[];for(var e=0,i=t.length;e<i;++e){var a=t[e],r=new s;r.init(a),this._rankRewardModels[this._rankRewardModels.length]=r}this.initData.hasInit=!0}},t.prototype.getRankRewardsConfig=function(){return this._rankRewardModels||this.initData(),this._rankRewardModels},t.prototype.requestServerZoneInfo=function(){var t={};t.module=n.MsgModuleName.CROSS_CUP,t.cmd=n.MsgCmd.CROSS_CUP.CROSS_CUP_SERVER_ZONE,n.ServerDelegate.sendMessage(t)},t.prototype.requestActorInfo=function(){if(n.UnlockManager.isPanelUnlock(n.PanelEnum.Panel_CrossCup,!1)){var t={};t.module=n.MsgModuleName.CROSS_CUP,t.cmd=n.MsgCmd.CROSS_CUP.CROSS_CUP_ACTOR_INFO,n.ServerDelegate.sendMessage(t)}},t.prototype.requestZoneInfo=function(t){var e={};e.module=n.MsgModuleName.CROSS_CUP,e.cmd=n.MsgCmd.CROSS_CUP.CROSS_CUP_ZONE_INFO,e.id=t.id,n.ServerDelegate.sendMessage(e)},t.prototype.requestZoneRankInfo=function(t){var e={};e.module=n.MsgModuleName.CROSS_CUP,e.cmd=n.MsgCmd.CROSS_CUP.CROSS_CUP_ZONE_RANK,e.id=t.id,n.ServerDelegate.sendMessage(e)},t.prototype.requestZoneEnter=function(t){var e={};e.module=n.MsgModuleName.CROSS_CUP,e.cmd=n.MsgCmd.CROSS_CUP.CROSS_CUP_ENTER,n.ServerDelegate.sendMessage(e)},t.prototype.requestZoneBet=function(t){var e={};e.module=n.MsgModuleName.CROSS_CUP,e.cmd=n.MsgCmd.CROSS_CUP.CROSS_CUP_BET,e.zoneId=t.zoneId,e.actorId=t.actorId,e.times=t.times,n.ServerDelegate.sendMessage(e)},t.prototype.requestZoneBattle=function(t){var e={};e.module=n.MsgModuleName.CROSS_CUP,e.cmd=n.MsgCmd.CROSS_CUP.CROSS_CUP_BATTLE,e.battleId=t.battleId,n.ServerDelegate.sendMessage(e)},t.prototype.requestLineup=function(t){var e={};e.module=n.MsgModuleName.CROSS_CUP,e.cmd=n.MsgCmd.CROSS_CUP.CROSS_CUP_LINEUP,e.lineupMap=t.lineupMap,n.ServerDelegate.sendMessage(e)},t.prototype._parseServerZoneRes=function(t,e){if(t===n.NetCode.SUCCESS){this.initData(),this._myZoneId=e.zoneId,this.zoneList=e.zoneList||[],this.zoneList.sort(function(t,e){return t-e});var i=-1;0!=this._myZoneId?i=this._myZoneId:this.zoneList.length>0&&(i=this.zoneList[0]),-1!=i&&n.EventUtil.dispatchEvent(n.EventNameEnum.REQ_CROSS_CUP_ZONE_INFO,{id:i}),-1!=i&&n.EventUtil.dispatchEvent(n.EventNameEnum.REQ_CROSS_CUP_ZONE_RANK,{id:i}),-1!=i&&n.EventUtil.dispatchEvent(n.EventNameEnum.REQ_CROSS_CUP_ACTOR_INFO)}},t.prototype._parseActorRes=function(t,e){t===n.NetCode.SUCCESS&&(this._betTimes=e.betTimes,this._highestState=e.state,n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_CROSS_CUP_ACTOR_INFO))},t.prototype._parseZoneRes=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.zone;this._zoneModel||(this._zoneModel=new a),this._zoneModel.init(i);var o=this._zoneModel.getMyEnterInfo();this._myEnterInfo||(this._myEnterInfo=new r),o&&(this._myEnterInfo=o),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_CROSS_CUP_ZONE_INFO)}},t.prototype._parseZoneRankRes=function(t,e){if(t===n.NetCode.SUCCESS){this._checkRankZoneId=e.zoneId,this._rankInfo&&delete this._rankInfo,this._rankInfo=[];for(var i=e.ranks||[],a=0,r=i.length;a<r;a++){var s=new o;s.init(i[a]),this._rankInfo[this._rankInfo.length]=s}this._myRankData=this._rankInfo.slice(-1),this._myRankData=this._myRankData[0],this._rankInfo=this._rankInfo.slice(0,this._rankInfo.length-1),this._rankInfo.sort(function(t,e){return t.getRank()-e.getRank()}),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_CROSS_CUP_RANK_INFO)}},t.prototype.getMyRankData=function(){return this._myRankData},t.prototype._parseZoneEnterRes=function(t,e){if(t===n.NetCode.SUCCESS){this._myEnterInfo||(this._myEnterInfo=new r),this._myEnterInfo.init(e.player);var i=new n.BroadcastContent(409);n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_BROADCAST,i),n.EventUtil.dispatchEvent(n.EventNameEnum.REQ_CROSS_CUP_ZONE_INFO,{id:this._myZoneId})}},t.prototype._parseZoneBetRes=function(t,e){if(t===n.NetCode.SUCCESS){e.zoneId,e.targetId,e.count,this._zoneModel.getPlayerByActorId(e.targetId).refreshMyBetCount(e.count);var i=new n.BroadcastContent(407);n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_BROADCAST,i),n.EventUtil.dispatchEvent(n.EventNameEnum.CROSS_CUP_BET_INFO_SUCC)}},t.prototype._parseBattleInfo=function(t,e){t===n.NetCode.SUCCESS&&(e.battleId,e.battleMap,e.playerHeroMap,n.EventUtil.dispatchEvent(n.EventNameEnum.CHECK_CROSS_CUP_BATTLE_INFO,e))},t.prototype._parseLineupRes=function(t,e){t===n.NetCode.SUCCESS&&e&&(this._myEnterInfo||(this._myEnterInfo=new r),this._myEnterInfo.init(e.player),n.EventUtil.dispatchEvent(n.EventNameEnum.CROSS_CUP_LINEUP_SUCC))},t.prototype.getMyEnterInfo=function(){return this._myEnterInfo?this._myEnterInfo:this._zoneModel.getMyEnterInfo()},t.prototype.getLineupDataByPosId=function(t){var e=this.getMyEnterInfo().getLineupMap();for(var i in e){var n=e[i];for(var a in n)if(t==n[a].positionId)return n[a]}return null},t.prototype.getLeftBetTimes=function(){return n.GetConfig("CROSS_CUP_BET_TIMES")-this._betTimes},t.prototype.getCurZoneInfo=function(){return this._zoneModel},t.prototype.getZoneRankInfo=function(){return this._rankInfo||[]},t.prototype.getMyZoneId=function(){return this._myZoneId},t.prototype.getZoneList=function(){return this.zoneList||[]},t.prototype.getHadShowLineupTip=function(){return this._hadShowLineupTip},t.prototype.setHadShowLineupTip=function(t){this._hadShowLineupTip=t},t.prototype.getShowTabIndex=function(){var t=this._zoneModel;if(!t)return 1;var e=t.getIsChampionGame(),i=t.getState(),n=t.getSubState(),a=i>=l.CrossCupState.GROUP_QUARTER||i==l.CrossCupState.GROUP_PROMOTION&&n==l.CrossCupSubState.SLEEP;return e?3:a?2:1},t.prototype.getHighestState=function(){return this._highestState||0},t.prototype.getDefaultLineUp=function(){var t={1:{},2:{},3:{}},e=n.GetConfig("CROSS_CUP_DEFAULT_LINEUP"),i=[],a=[];i.push(e[0][1][0][0]),i.push(e[1][1][0][0]),i.push(e[1][1][1][0]),i.push(e[2][1][0][0]),i.push(e[2][1][1][0]),i.push(e[2][1][2][0]),i.push(e[2][1][3][0]),a.push(e[0][1][0][1]),a.push(e[1][1][0][1]),a.push(e[1][1][1][1]),a.push(e[2][1][0][1]),a.push(e[2][1][1][1]),a.push(e[2][1][2][1]),a.push(e[2][1][3][1]);for(var r=0;r<7;r++){var o=void 0;o=r<1?1:r<3?2:3;var s=n.BattleArrayManager.getBattleArrayDataByPositionId(a[r]);s&&(t[o][i[r]]=s.getPositionId())}return t},t.prototype.getDefaultLineupMap=function(){var t=this.getDefaultLineUp();for(var e in t)if(t.hasOwnProperty(e)){var i=t[e];for(var a in i)if(i.hasOwnProperty(a)){var r=i[a],o=n.BattleArrayManager.getBattleArrayDataByPositionId(r).getMercenarySId(),s=c.default.getInstance().getHeroBySId(o);if(i[a]={level:0,power:0,roleId:0},s){s=s.getBattleHeroModel();var l=n.BattleArrayManager.getBattleArrayDataByConfigId(s.getId()),u=n.BattleArrayManager.getFightPowerByIndex(l.getOrderId());i[a]={level:s.getLevel(),power:u,roleId:s.getId(),camp:s.getCurCamp()}}}}return t},t.prototype.isShowMainPanelBtn=function(){var t=(this._zoneModel&&this._zoneModel.getEndTime())-n.TimeUtil.getTime();return!!(this.isLineupState()&&t>0&&t<=36e5)},t.prototype.isEnterBtnAniShowed=function(){return this._isEnterBtnAniShowed},t.prototype.setEnterBtnAniShowed=function(t){this._isEnterBtnAniShowed=t},t.prototype.isLineupState=function(){var t=this._zoneModel&&this._zoneModel.getSubState(),e=this._zoneModel&&this._zoneModel.getIsSelfCanGame();return!(t!=l.CrossCupSubState.LINEUP||!e)},t.prototype.resetMyCrossCupLineup=function(){if(n.UnlockManager.isPanelUnlock(n.PanelEnum.Panel_CrossCup,!1)){this._myEnterInfo,this._zoneModel&&this._zoneModel.getIsSelfCanGame();var t={lineupMap:{1:{},2:{},3:{}}},e=n.GetConfig("CROSS_CUP_DEFAULT_LINEUP"),i=[],a=[];i.push(e[0][1][0][0]),i.push(e[1][1][0][0]),i.push(e[1][1][1][0]),i.push(e[2][1][0][0]),i.push(e[2][1][1][0]),i.push(e[2][1][2][0]),i.push(e[2][1][3][0]),a.push(e[0][1][0][1]),a.push(e[1][1][0][1]),a.push(e[1][1][1][1]),a.push(e[2][1][0][1]),a.push(e[2][1][1][1]),a.push(e[2][1][2][1]),a.push(e[2][1][3][1]);for(var r=0;r<7;r++){var o=void 0;o=r<1?1:r<3?2:3;var s=n.BattleArrayManager.getBattleArrayDataByPositionId(a[r]);s&&(t.lineupMap[o][i[r]]=s.getPositionId())}n.EventUtil.dispatchEvent(n.EventNameEnum.REQ_CROSS_CUP_LINEUP,t)}},t.prototype.setCheckFightPacket=function(t,e){this._isCheckFight=t,this._checkData=e||{}},t.prototype.getIsCheckFightPacket=function(){return this._isCheckFight},t.prototype.getCheckData=function(){return this._checkData||{}},t.prototype.hadCheckPanel=function(){if(this._zoneModel){var t=this._zoneModel&&this._zoneModel.getState(),e=this._zoneModel&&this._zoneModel.getSubState();this._checkState=[t,e],n.EventUtil.dispatchEvent(n.EventNameEnum.ENTER_CROSS_CUP)}},t.prototype.isRedPointTips=function(){if(!this._zoneModel)return!1;var t=this._checkState||[],e=this._myZoneId,i=this._zoneModel.getZoneId(),n=this._zoneModel&&this._zoneModel.getState(),a=this._zoneModel&&this._zoneModel.getSubState(),r=this._zoneModel&&this._zoneModel.getIsSelfCanGame(),o=this._zoneModel&&(a==l.CrossCupSubState.LINEUP&&r||a==l.CrossCupSubState.BET||n==l.CrossCupState.ENTER);return 0!=e&&o&&i==e&&n!=t[0]&&a!=t[1]},t.prototype.redPointEvents=function(){return[n.EventNameEnum.ENTER_CROSS_CUP,n.EventNameEnum.REFRESH_CROSS_CUP_ZONE_INFO]},t}();i.default=u,cc._RF.pop()},{"../../Hero/Manager/HeroManager":"HeroManager","../Enum/CrossCupEnum":"CrossCupEnum",CrossCupPlayerModel:"CrossCupPlayerModel",CrossCupRankModel:"CrossCupRankModel",CrossCupRankRewardModel:"CrossCupRankRewardModel",CrossCupZoneModel:"CrossCupZoneModel"}],CrossCupPlayerModel:[function(t,e,i){"use strict";cc._RF.push(e,"0e58ebfOR5AioL4LZWN2Bdm","CrossCupPlayerModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("Model"),a=t("HeroModel"),r=t("../Manager/CrossCupManager"),o=cc.Class({extends:n,properties:{serverType:null,serverId:null,actorId:null,attributes:null,lineupMap:null,zoneId:null,groupId:null,oppositeId:null,eliminatedState:null,eliminatedBattleId:null,betMap:null,orderId:null},init:function(t){this.serverType=t.serverType,this.serverId=t.serverId,this.actorId=t.actorId,this.attributes=t.attributes,this.lineupMap=t.lineupMap,this.zoneId=t.zoneId,this.groupId=t.groupId,this.oppositeId=t.oppositeId,this.eliminatedState=t.eliminatedState,this.eliminatedBattleId=t.eliminatedBattleId,this.betMap=t.betMap,this.orderId=t.orderId},getServerType:function(){return this.serverType},getServerId:function(){return this.getServerId},getActorId:function(){return this.actorId},getAttributes:function(){return this.attributes},getLineupMap:function(){return this.lineupMap},_checkMyLineup:function(){if(this.getActorId()==td.Account.getUserData().getGamerId()){var t=this.getLineupMap(),e=!1;for(var i in t){var n=t[i];for(var a in n){if(!td.BattleArrayManager.getBattleArrayDataByConfigId(n[a].roleId)){e=!0;break}}}e&&r.default.getInstance().resetMyCrossCupLineup()}},getZoneId:function(){return this.zoneId},getGroupId:function(){return this.groupId},getOppositeId:function(){return this.oppositeId},getOppositeGroupId:function(){return this.oppositeGroupId},getEliminatedState:function(){return this.eliminatedState},getEliminatedBattleId:function(){return this.eliminatedBattleId},getBetMap:function(){return this.betMap},setPos:function(t){return this.pos=t},getPos:function(){return this.pos},getOrderId:function(){return this.orderId},getFightPowerByBattleType:function(t){var e=this.lineupMap,i=0;for(var n in e)if(n==t){var a=e[n];for(var r in a)i+=a[r].power}return i},getHerosByBattleType:function(t){var e=[],i=this.getLineupMap()[t];if(i)for(var n in i){var r=i[n].roleId,o=td.GetTableClass(td.TableEnum.HeroTable).getHeroById(r),s=new a;s.init(o),s.setLevel(i[n].level),i[n].camp&&s.setCamp(i[n].camp),e[e.length]=s}return e},getBetCountByMe:function(){var t=this.betMap,e=td.Account.getUserData().getGamerId(),i=0;for(var n in t){var a=t[n];for(var r in a)for(var o in a[r])e==o&&(i+=a[r][e])}return i},getTotalBetCount:function(){var t=this.betMap,e=0;for(var i in t){var n=t[i];for(var a in n)for(var r in n[a])e+=n[a][r]}return e},refreshMyBetCount:function(t){var e=td.Account.getUserData().getGamerId(),i=td.Account.getUserData().getServerId();this.betMap.hasOwnProperty(i)||(this.betMap[i]={}),this.betMap[i].hasOwnProperty(i)||(this.betMap[i][i]={});var n=this.betMap,a=!1;for(var r in n){var o=n[r];for(var s in o)for(var l in o[s])e==l&&(o[s][e]=t,a=!0)}a||(this.betMap[i][i][e]=t)}});e.exports=o,cc._RF.pop()},{"../Manager/CrossCupManager":"CrossCupManager",HeroModel:"HeroModel",Model:"Model"}],CrossCupRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"71c8dBm6mhN+IfI7UTSocnB","CrossCupRankModel");var n=t("Model"),a=cc.Class({extends:n,properties:{attributes:null,rank:null,stateTimes:null},init:function(t){this.attributes=t.attributes,this.rank=t.rank,this.stateTimes=t.stateTimes},getAttributes:function(){return this.attributes},getRank:function(){return this.rank},getStateTimes:function(){return this.stateTimes}});e.exports=a,cc._RF.pop()},{Model:"Model"}],CrossCupRankRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"923fbE2rNtEiot+bu497ReB","CrossCupRankRewardModel");var n=window.td,a=t("Model"),r=cc.Class({extends:a,properties:{_state:null,_rewards:null},init:function(t){this._super("CrossCupRankRewardModel"),this._state=t.state,this._rewards=t.rewards||[],this._rewards=n.RewardManager.parseRewardListDetail(this._rewards)},getState:function(){return this._state},getRewards:function(){return this._rewards}});e.exports=r,cc._RF.pop()},{Model:"Model"}],CrossCupRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"e8deeOEEWdGxor29dIqG6tW","CrossCupRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="CrossCupRewardConfig",e._tblName="cross_cup_reward_config",e._data=[],e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];this._data.push(n)}},e.prototype.getDatas=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],CrossCupZoneModel:[function(t,e,i){"use strict";cc._RF.push(e,"d439cr7kEpA0plXZmM13Bc9","CrossCupZoneModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("CrossCupGroupModel"),a=t("Model"),r=t("../Enum/CrossCupEnum"),o=t("../Manager/CrossCupManager"),s=cc.Class({extends:a,properties:{state:null,subState:null,startTime:null,endTime:null,zoneId:null,groupMap:null,myGroupData:null},init:function(t){this._super("CrossCupZoneModel"),this.state=t.state,this.subState=t.subState,this.startTime=t.startTime,this.endTime=t.endTime,this.zoneId=t.zoneId,this.groupMap&&delete this.groupMap,this.groupMap=t.groupMap,this.parseGroupMap()},parseGroupMap:function(){var t=this.groupMap;for(var e in this.groupMap.hasOwnProperty(0)||(this.myGroupData=null),t){var i=t[e],a=new n;a.init(i),0==e&&(this.myGroupData=a),this.groupMap[e]=a}},getIsGroupGaming:function(){var t=this.state,e=this.subState,i=t>=r.CrossCupState.GROUP_QUARTER&&t<=r.CrossCupState.SLEEP||t==r.CrossCupState.GROUP_PROMOTION&&e==r.CrossCupSubState.SLEEP;return this.groupMap[0]?this.groupMap.myLen()>1&&i:this.groupMap.myLen()>0&&i},getIsSelfCanGame:function(){var t=this.getMyEnterInfo();if(!t)return!1;if(o.default.getInstance().getMyZoneId()!=this.getZoneId())return!1;if(this.state==r.CrossCupState.ENTER||this.state==r.CrossCupState.GROUP_PROMOTION&&this.subState<=r.CrossCupSubState.BATTLE)return!0;var e=t.getEliminatedState();return e==r.CrossCupState.SLEEP||e==r.CrossCupState.NONE},getDefaultGroupIndex:function(){if(o.default.getInstance().getIsCheckFightPacket())return o.default.getInstance().getCheckData().groupId||1;var t=this.getMyEnterInfo();if(t)return t.getGroupId()||1;for(var e in this.groupMap)if(0!=e)return e;return 1},isMyGroup:function(t){var e=this.getMyEnterInfo();return!!e&&t==e.getGroupId()},getCanEnter:function(){if(o.default.getInstance().getMyZoneId()!=this.getZoneId())return!1;var t=this.getMyGroupData();return this.state===r.CrossCupState.ENTER&&!t},isMyZone:function(){return o.default.getInstance().getMyZoneId()==this.getZoneId()},getMyEnterInfo:function(){var t=this.getMyGroupData();if(!t)return null;if(t){var e=td.Account.getUserData().getGamerId();return t.getPlayerByActorId(e)}return null},getMyGroupData:function(){return this.myGroupData},getGroupData:function(){return this.groupMap},getGroupDataByGroupId:function(t){return this.groupMap[t]},getChapionGroup:function(){if(this.state===r.CrossCupState.QUARTER||this.state===r.CrossCupState.SEMI||this.state===r.CrossCupState.FINAL||this.state===r.CrossCupState.SLEEP){var t=[];for(var e in this.groupMap)if(0!=e){var i=this.groupMap[e].getPlayersMap();for(var n in i){var a=i[n],o=a.getEliminatedState();o!==r.CrossCupState.NONE&&o!==r.CrossCupState.QUARTER&&o!==r.CrossCupState.SEMI&&o!==r.CrossCupState.FINAL&&o!==r.CrossCupState.SLEEP||(t[t.length]=a)}}return t}return null},getTop2:function(){var t=[],e=this.getChapionGroup(),i=o.default.getInstance().getCurZoneInfo(),n=i.getState(),a=i.getSubState();if(!(n>=r.CrossCupState.FINAL||n==r.CrossCupState.SEMI&&a==r.CrossCupSubState.SLEEP))return t;for(var s=0;s<8;s++){var l=e[s];if(l){var c=l.getEliminatedState();c!==r.CrossCupState.NONE&&c!==r.CrossCupState.FINAL&&c!==r.CrossCupState.SLEEP||(t[t.length]=l)}}return t},getNum3And4:function(){var t=[],e=this.getChapionGroup(),i=o.default.getInstance().getCurZoneInfo(),n=i.getState(),a=i.getSubState();if(!(n>=r.CrossCupState.SEMI||n==r.CrossCupState.QUARTER&&a==r.CrossCupSubState.SLEEP))return t;for(var s=0;s<8;s++){var l=e[s];if(l)l.getEliminatedState()===r.CrossCupState.SEMI&&(t[t.length]=l)}return t},getTopest:function(){var t=this.getChapionGroup(),e=o.default.getInstance().getCurZoneInfo(),i=e.getState(),n=e.getSubState();if(!(i>=r.CrossCupState.SLEEP||i==r.CrossCupState.FINAL&&n==r.CrossCupSubState.SLEEP))return null;for(var a=0;a<8;a++){var s=t[a];if(s){var l=s.getEliminatedState();if(l==r.CrossCupState.SLEEP||l===r.CrossCupState.NONE)return s}}return null},getState:function(){return this.state},getIsChampionGame:function(){var t=this.getState(),e=this.getSubState();return t>=r.CrossCupState.QUARTER&&t<=r.CrossCupState.SLEEP||t==r.CrossCupState.GROUP_FINAL&&e==r.CrossCupSubState.SLEEP},getSubState:function(){return this.subState},getStartTime:function(){return this.startTime},getEndTime:function(){return this.endTime},getZoneId:function(){return this.zoneId},getPlayerByActorId:function(t){var e=this.groupMap;for(var i in e)if(0!=i){var n=e[i].getPlayerByActorId(t);if(n)return n}return null},getCurZoneState:function(){this.getEndTime();var t=this.getState(),e=this.getSubState();r.CrossCupState.ENTER,t==r.CrossCupState.GROUP_PROMOTION&&r.CrossCupSubState.LINEUP,e!=r.CrossCupState.GROUP_PROMOTION&&r.CrossCupSubState.LINEUP,r.CrossCupSubState.BET,t==r.CrossCupState.GROUP_PROMOTION&&r.CrossCupSubState.BATTLE,t!=r.CrossCupState.GROUP_PROMOTION&&r.CrossCupSubState.BATTLE,t==r.CrossCupState.GROUP_PROMOTION&&r.CrossCupSubState.SLEEP,t!=r.CrossCupState.GROUP_PROMOTION&&r.CrossCupSubState.SLEEP}});e.exports=s,cc._RF.pop()},{"../Enum/CrossCupEnum":"CrossCupEnum","../Manager/CrossCupManager":"CrossCupManager",CrossCupGroupModel:"CrossCupGroupModel",Model:"Model"}],CrystalAutoInputItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"2b11agSsRhJZ5zgU35+yJVt","CrystalAutoInputItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labItemName=null,e.labInput=null,e.labAutoInput=null,e.nodeItem=null,e.togAuto=null,e.labTog=null,e._curInput=0,e._curInputMax=1,e._lastInput=0,e._isAuto=!1,e._isChange=!1,e._isInit=!1,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._id=i.id,this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10);var n=r.GetConfig("GODDESS_BET_TIMES_RATE")/1e4;this._curInputMax=Math.floor(i.needCount*n);var a=this._controller.getBetTimes()[i.id];a?(this._curInput=a.autoBetCount,this._controller.getBetCrystal()<this._curInput&&a.autoBetCount>0?(this._isAuto=!1,this._curInput=0,this.labInput.string=this._curInput+"",this.togAuto.isChecked=this._isAuto,this._isChange=!0,r.EventUtil.dispatchEvent(r.EventNameEnum.EARETREASURE_AUTOINPUT_CHANGE)):(this.togAuto.isChecked=a.autoBetCount>0,this._isAuto=a.autoBetCount>0),this.labTog.string=a.autoBetCount>0?r.Language.CrystalAutoInputTog2:r.Language.CrystalAutoInputTog1,this.labAutoInput.string=a.autoBetCount+"/"+this._curInputMax):(this._curInput=0,this.togAuto.isChecked=!1,this.labTog.string=r.Language.CrystalAutoInputTog1,this.labAutoInput.string="0/"+this._curInputMax);this.labInput.string=this._curInput+"";var o=r.RewardManager.getRewardDetail(i.rewards[0]),s=r.GlobalFunction.createCommonIconWidget(26,o);this.labItemName.string=o.getName(),r.GlobalFunction.setNameColors(this.labItemName.node,o.getQuality()),this.nodeItem.removeAllChildren(),this.nodeItem.addChild(s)},e.prototype.onSubOne=function(){0!==this._curInput&&(this._lastInput=this._curInput,this._curInput--,this._curInput<=0&&(this._curInput=0),this._refreshInputLabs())},e.prototype.onSubTen=function(){0!==this._curInput&&(this._lastInput=this._curInput,this._curInput-=10,this._curInput<=0&&(this._curInput=0),this._refreshInputLabs())},e.prototype.onAddOne=function(){this._curInput!==this._curInputMax&&(this._lastInput=this._curInput,this._curInput++,this._curInput>this._curInputMax&&(this._curInput=this._curInputMax),this._refreshInputLabs())},e.prototype.onAddTen=function(){this._curInput!==this._curInputMax&&(this._lastInput=this._curInput,this._curInput+=10,this._curInput>this._curInputMax&&(this._curInput=this._curInputMax),this._refreshInputLabs())},e.prototype._refreshInputLabs=function(){if(this._controller.getBetCrystal()<this._curInput){this._curInput=this._lastInput;var t=new r.BroadcastContent(370);r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,t)}else this.labInput.string=this._curInput+"",this._isChange=!0,r.EventUtil.dispatchEvent(r.EventNameEnum.EARETREASURE_AUTOINPUT_CHANGE)},e.prototype.onTogAutoClick=function(){this._isAuto=!this._isAuto,this._isAuto||(this._curInput=0,this.labInput.string=this._curInput+""),this.togAuto.isChecked=this._isAuto,this._isInit&&(this._isChange=!0,r.EventUtil.dispatchEvent(r.EventNameEnum.EARETREASURE_AUTOINPUT_CHANGE)),this._isInit=!0},a([l(cc.Label)],e.prototype,"labItemName",void 0),a([l(cc.Label)],e.prototype,"labInput",void 0),a([l(cc.Label)],e.prototype,"labAutoInput",void 0),a([l(cc.Node)],e.prototype,"nodeItem",void 0),a([l(cc.Toggle)],e.prototype,"togAuto",void 0),a([l(cc.Label)],e.prototype,"labTog",void 0),e=a([s,c("module/Activity/RareTreasure/CrystalAutoInputItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],CrystalAutoInputWindow:[function(t,e,i){"use strict";cc._RF.push(e,"76d004W4sJKvLMO+ZqMoIXp","CrystalAutoInputWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=t("./CrystalAutoInputItemUI"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btn=null,e._isInit=!1,e._isChange=!1,e}return n(e,t),e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListners(),this._isChange=!1},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this)},e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_RareTreasureAutoInput},e.prototype.setData=function(){this._initWindow()},e.prototype._addEventListners=function(){var t={},e=r.EventNameEnum;t[e.RES_EARETREASURE_MYINFO]=this._initWindow,t[e.EARETREASURE_AUTOINPUT_CHANGE]=this._initStatue,r.EventUtil.registerEvents(t,this)},e.prototype._initStatue=function(){r.GlobalFunction.setButtonGray(this.btn,!1),this._isChange=!0},e.prototype._initWindow=function(){var t=[];r.GlobalFunction.setButtonGray(this.btn,!0),this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10);var e=this._controller.getActivityData(),i=r.GetTableClass(r.TableEnum.GoddessBoxTable).getAllBoxByData(e);for(var n in i)t.push(i[n]);var a=this.node.getComponent(d);this._isInit?a.refreshCurList(t):(a.setData(t),this._isInit=!0)},e.prototype.onBtn=function(){if(this._isChange){for(var e=this.node.getComponent(d).getAllItems(),i={},n=0;n<e.length;n++){var a=e[n].getComponent(h.default);a._isChange&&(a._isAuto?i[a._id]=a._curInput:i[a._id]=0)}var r={};r.parmeterMap={17:3,19:i},this._controller.operateActivity(r),this._isChange=!1,t.prototype.closeCallFunc.call(this)}},e.prototype.closeCallFunc=function(){if(this._isChange){var e={};e.strArray=[r.Language.CrystalAutoInput],e.okCallFunc=this.onBtn.bind(this),r.GlobalFunction.showConfirmWindow(e)}else t.prototype.closeCallFunc.call(this)},a([l(cc.Node)],e.prototype,"btn",void 0),e=a([s,c("module/Activity/RareTreasure/CrystalAutoInputWindow")],e)}(u);i.default=p,cc._RF.pop()},{"./CrystalAutoInputItemUI":"CrystalAutoInputItemUI",OptimizeVerticalListView:void 0,PanelBase:void 0}],CrystalGetItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"9e7acfv0eVP15NBTs7YHM3l","CrystalGetItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labDesc1=null,e.labDesc2=null,e.labNum=null,e.btnReceive=null,e.btnGoto=null,e.imgReceived=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._isExchange=i.isExchange;var n,a,o=r.TaskStatus.NONE,s=0;if(this._isExchange){var l=r.GetConfig("GODDESS_TREASURE_GOODS_UNIT")[0][0];n=cc.js.formatStr("%s",r.Language.treasureGiftExchange,l/10);var c=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10),u=c.getCharge(),d=c.getConverted();o=(s=Math.floor((u-d)/l))>0?r.TaskStatus.Finish:r.TaskStatus.Progress,a=r.Language.RareTreasureDes3+s}else n=i.getDes(),this._gotoPanel=i.getGotoPanel(),this._id=i.getId(),s=i.getActive(),o=i.getStatus(),a=r.Language.progress+":"+i.getValue()+"/"+i.getNeedValue();this.labDesc1.string=n,this.labDesc2.string=a,this.btnGoto.active=o===r.TaskStatus.Progress,this.btnReceive.active=o===r.TaskStatus.Finish,this.imgReceived.active=o===r.TaskStatus.Received,this.labNum.string="x"+s,this.labNum.node.active=s>0},e.prototype.onBtnReceiveClick=function(){if(this._isExchange){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10);if(!t)return;var e={parmeterMap:{17:1}};t.operateActivity(e)}else r.EventUtil.dispatchEvent(r.EventNameEnum.Req_TASK_RECEIVE,this._id)},e.prototype.onBtnGotoClick=function(){var t=r.PanelManager.getInstance().getCurShowPanel().getComponent("ActivityMainPanel");if(this._isExchange){var e=[r.ActivityEnum.Activity.ActivityVip,r.ActivityEnum.ActivityType.RechargePanel];t.setData(e),r.ActivityDataManager.setJumpBackData([r.ActivityEnum.Activity.ActivityConfig,r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10])}else{var i=null;this._gotoPanel[1]&&(i=this._gotoPanel[1]),this._gotoPanel[0]&&r.PanelEnum.Panel_Activity===this._gotoPanel[0]?(t.setData(i),r.ActivityDataManager.setJumpBackData([r.ActivityEnum.Activity.ActivityConfig,r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10])):r.PanelJumpManager.jumpToPanel(this._gotoPanel[0],i)}var n=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10);n&&n.onJumpToRecharge()},a([l(cc.Label)],e.prototype,"labDesc1",void 0),a([l(cc.Label)],e.prototype,"labDesc2",void 0),a([l(cc.Label)],e.prototype,"labNum",void 0),a([l(cc.Node)],e.prototype,"btnReceive",void 0),a([l(cc.Node)],e.prototype,"btnGoto",void 0),a([l(cc.Node)],e.prototype,"imgReceived",void 0),e=a([s,c("module/Activity/RareTreasure/CrystalGetItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],CrystalGetWindow:[function(t,e,i){"use strict";cc._RF.push(e,"3c4e1rJ5DlPJqpVB0ke8gMg","CrystalGetWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.menu,c=t("PanelBase"),u=t("OptimizeVerticalListView"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isInit=!1,e}return n(e,t),e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListners()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this)},e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_RareTreasureCrystalGet},e.prototype.setData=function(t){this._controller=r.ActivityDataManager.getActivityControllerById(t),this._refreshList()},e.prototype._addEventListners=function(){var t={},e=r.EventNameEnum;t[e.Res_GET_TASK_INFO]=this._refreshList,t[e.Res_GET_ACTIVITY_INFO]=this._refreshList,t[e.CLOSE_EARETREASURE_GET_WINDOW]=this.closeCallFunc,r.EventUtil.registerEvents(t,this)},e.prototype._refreshList=function(){var t=[],e={isExchange:!0};t.push(e);var i=r.TaskManager.getShowListByType(r.TaskType.GODDESS,[r.TaskStatus.UNOPENED,r.TaskStatus.NONE]);t=t.concat(i.sort(this._sortTaskList));var n=this.node.getComponent(u);this._isInit?n.refreshCurList(t):n.setData(t),this._isInit=!0},e.prototype._sortTaskList=function(t,e){if(t.getStatus()!=e.getStatus()){if(3===t.getStatus())return-1;if(3===e.getStatus())return 1;if(4===t.getStatus())return 1;if(4===e.getStatus())return-1}return t.getId()-e.getId()},e=a([s,l("module/Activity/RareTreasure/CrystalGetWindow")],e)}(c);i.default=d,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],CrystalInputWindow:[function(t,e,i){"use strict";cc._RF.push(e,"072b2+JJmtOeqYoxGVFyUrR","CrystalInputWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labMaxTimes=null,e.labNum=null,e.labNumTotal=null,e.labCost=null,e.labInput=null,e._curInput=1,e._curInputMax=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_RareTreasureInput},e.prototype.setData=function(){this._refreshInputLabs(),this.labMaxTimes.string=r.GetConfig("GODDESS_BET_TIMES_RATE")/100+"%"},e.prototype._refreshInputLabs=function(){this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10);var t=this._controller.getBetDataBySelect();this._id=t.boxId;var e=this._controller.getActivityData(),i=r.GetTableClass(r.TableEnum.GoddessBoxTable).getDataByDataAndId(e,this._id),n=r.GetConfig("GODDESS_BET_TIMES_RATE")/1e4,a=Math.floor(i.needCount*n)-t.betCount,o=this._controller.getTotalBetById(this._id),s=i.needCount-o;this._curInputMax=s<a?s:a,this.labInput.string=this._curInput+"",this.labNumTotal.string="/"+this._curInputMax,this.labNum.string=this._curInput+"",this.labCost.string=this._curInput+""},e.prototype.onSubOne=function(){this._curInput--,this._curInput<=0&&(this._curInput=1),this._refreshInputLabs()},e.prototype.onSubTen=function(){this._curInput-=10,this._curInput<=0&&(this._curInput=1),this._refreshInputLabs()},e.prototype.onAddOne=function(){this._curInput++,this._curInput>this._curInputMax&&(this._curInput=this._curInputMax),this._refreshInputLabs()},e.prototype.onAddTen=function(){this._curInput+=10,this._curInput>this._curInputMax&&(this._curInput=this._curInputMax),this._refreshInputLabs()},e.prototype.onCancel=function(){this.closeCallFunc()},e.prototype.onSure=function(){if(this._controller.getBetCrystal()<this._curInput){var t=new r.BroadcastContent(370);return r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,t),r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_RareTreasureCrystalGet),void this.closeCallFunc()}var e={};e.id=this._id,e.parmeterMap={6:this._curInput,17:2},this._controller.operateActivity(e),this.closeCallFunc()},a([l(cc.Label)],e.prototype,"labMaxTimes",void 0),a([l(cc.Label)],e.prototype,"labNum",void 0),a([l(cc.Label)],e.prototype,"labNumTotal",void 0),a([l(cc.Label)],e.prototype,"labCost",void 0),a([l(cc.Label)],e.prototype,"labInput",void 0),e=a([s,c("module/Activity/RareTreasure/CrystalInputWindow")],e)}(t("PanelBase"));i.default=u,cc._RF.pop()},{PanelBase:void 0}],CumulateGiftController:[function(t,e,i){"use strict";cc._RF.push(e,"09944cv0r1PlYfXVXBOeuvL","CumulateGiftController");var n=t("ActivityBaseController"),a=t("CumulateGiftModel"),r=cc.Class({extends:n,_model:null,initData:function(t){this._super(t),this.addServerListener(),this.addEventListener()},destroyData:function(){this._super()},addServerListener:function(){td.ServerDelegate.registerMessage(td.MsgModuleName.ExtensionCmd,td.MsgCmd.ExtensionCmd.GET_CUMULATEGIFT_INFO,this.dealLoadInfo.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.ExtensionCmd,td.MsgCmd.ExtensionCmd.PUSH_CUMULATEGIFT_INFO,this.dealPushInfo.bind(this))},addEventListener:function(){},dealLoadInfo:function(t,e){t===td.NetCode.SUCCESS&&(this.getData().initData(e),this.refreshData())},dealPushInfo:function(t,e){t===td.NetCode.SUCCESS&&(this.getData().initData(e),this.refreshData())},refreshData:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.CUMULATEGIFT_REFRESH_UI,this.getData())},getData:function(){return this._model||(this._model=new a,this._model.initData()),this._model},hasRedPoint:function(){return!0},isRedPointTip:function(){return this.isCumulateGiftRedPoint()},redPointEvts:function(){return[td.EventNameEnum.CUMULATEGIFT_REFRESH_UI,td.EventNameEnum.CUMULATEGIFT_GET_INFO]},isAllRecevied:function(){for(var t=!1,e=this.getData(),i=td.GetConfig("CHARGE_DAY_TOTAL_DAY_REWARD"),n=0;n<i.length;n++){if(e.getCumulateStatus(i[n][0])!=td.RewardStatus.RECEIVED){t=!0;break}}if(!t){var a=td.GetConfig("CHARGE_DAY_DAY_REWARD");(!e._state||e._days<a.length)&&(t=!0)}return t},isCumulateGiftRedPoint:function(){for(var t=!1,e=this.getData(),i=td.GetConfig("CHARGE_DAY_TOTAL_DAY_REWARD"),n=0;n<i.length;n++){if(e.getCumulateStatus(i[n][0])==td.RewardStatus.CAN_RECEIVE){t=!0;break}}if(!t){var a=td.GetConfig("CHARGE_DAY_CHARGE_LIMIT");!e._state&&e._charge>=a&&(t=!0)}return t}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",CumulateGiftModel:"CumulateGiftModel"}],CumulateGiftModel:[function(t,e,i){"use strict";cc._RF.push(e,"56d3fglvAVEf6DxyCxlwvHl","CumulateGiftModel");var n=cc.Class({properties:{_days:null,_state:null,_charge:null,_receives:null},initData:function(t){this._days=t?t.days:0,this._state=!!t&&t.state,this._charge=t?t.charge:0,this._receives=t?t.receives:[]},setData:function(t,e){this[t]=e},getProgress:function(){for(var t=td.GetConfig("CHARGE_DAY_TOTAL_DAY_REWARD"),e=0,i=[[t[0][0],0],[t[1][0],33],[t[2][0],67],[t[3][0],100]],n=i.length-1;n>=0;n--){var a=i[n][0],r=i[n][1];if(this._days>=a){if(n>=i.length-1)e=100;else{var o=i[n+1][0];e=r+(i[n+1][1]-r)*(this._days-a)/(o-a)}break}}return e/=100},getCumulateStatus:function(t){td.RewardStatus.CANNOT_RECEIVE;return t<=this._days?-1==this._receives.indexOf(t)?td.RewardStatus.CAN_RECEIVE:td.RewardStatus.RECEIVED:td.RewardStatus.CANNOT_RECEIVE}});e.exports=n,cc._RF.pop()},{}],CumulateGiftPanel:[function(t,e,i){"use strict";cc._RF.push(e,"37879I/FIJOLJnh0/2bLiAZ","CumulateGiftPanel");var n=t("ActivityBasePanel"),a=t("../../TS/Hero/Model/HeroModel"),r=cc.Class({extends:n,properties:{nodeHero:cc.Node,labCharge:cc.Label,progressBar:cc.ProgressBar,nodeRewardToday:cc.Node,nodeReward0:cc.Node,nodeReward1:cc.Node,nodeReward2:cc.Node,nodeReward3:cc.Node,nodeGotten0:cc.Node,nodeGotten1:cc.Node,nodeGotten2:cc.Node,nodeGotten3:cc.Node,labCharge0:cc.RichText,labCharge1:cc.RichText,labCharge2:cc.RichText,labCharge3:cc.RichText,btnCharge:cc.Node,btnGetDay:cc.Node,_init:null},initData:function(t){this._super(t)},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_CumulateGift},onEnable:function(){this._super(),this._controller=this.getActivityController(),this.addServerListener(),this.addEventListener(),this.refreshUI()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},addServerListener:function(){td.ServerDelegate.registerMessage(td.MsgModuleName.ExtensionCmd,td.MsgCmd.ExtensionCmd.GET_CUMULATEGIFT_REWARD_DAY,this.receiveReward.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.ExtensionCmd,td.MsgCmd.ExtensionCmd.GET_CUMULATEGIFT_REWARD_CUMULATE,this.receiveReward.bind(this))},addEventListener:function(){var t={};t[td.EventNameEnum.CUMULATEGIFT_REFRESH_UI]=this.refreshUI,td.EventUtil.registerEvents(t,this)},refreshUI:function(t){if(t||(t=this._controller.getData()),!this._init){this._init=!0,this.nodeHero.removeAllChildren(!0);var e=new a;e.init(td.GetTableClass(td.TableEnum.HeroTable).getHeroById(7007)),td.GlobalFunction.showMercenaryFigureAnimation(this.nodeHero,e,!0),this.nodeHero.setScale(1.5)}var i=td.GetConfig("CHARGE_DAY_CHARGE_LIMIT");this.labCharge.getComponent(cc.Label).string=cc.js.formatStr(td.Language.charged,t._charge/10,i/10);var n=t._days;t._charge>=i&&(n=t._days-1),this.nodeRewardToday.removeAllChildren(!0);var r=td.GetConfig("CHARGE_DAY_DAY_REWARD")[n],o=td.RewardManager.parseRewardListDetail([r[1]])[0],s=td.GlobalFunction.createCommonIconWidget(26,o);(u=s.getComponent("CommonIconWidget"))&&u.setNum(r[1][2],!0),this.nodeRewardToday.addChild(s),this.node.getChildByName("imgGotten").active=t._state,this.btnCharge.active=!t._state&&t._charge<i,this.btnGetDay.active=!t._state&&t._charge>=i;for(var l=td.GetConfig("CHARGE_DAY_TOTAL_DAY_REWARD"),c=0;c<l.length;c++){this["nodeReward"+c].removeAllChildren(!0);var u,d=l[c][1],h=td.RewardManager.parseRewardListDetail([d])[0],p=t.getCumulateStatus(l[c][0]),_=void 0;switch(p==td.RewardStatus.CAN_RECEIVE?(h._animationType=1,_=td.GlobalFunction.createCommonIconWidget(56,h)):_=td.GlobalFunction.createCommonIconWidget(26,h),_.setScale(.8),(u=_.getComponent("CommonIconWidget"))&&u.setNum(l[2],!0),this["nodeReward"+c].addChild(_),p){case td.RewardStatus.CANNOT_RECEIVE:var g=l[c][0]-t._days;this["labCharge"+c].getComponent(cc.RichText).string=cc.js.formatStr(td.Language.cumulateGiftDesc,g);break;case td.RewardStatus.CAN_RECEIVE:this["labCharge"+c].getComponent(cc.RichText).string="<color=#0CFF00>"+td.Language.canGet+"</c>",u&&(u.disableHeadTouch(),this.setCumulateRewardBtn(this["nodeReward"+c],l[c][0]));break;case td.RewardStatus.RECEIVED:this["labCharge"+c].getComponent(cc.RichText).string="",td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_yilingqu_02",this["nodeGotten"+c]),this["nodeGotten"+c].setScale(.6)}}this.progressBar.getComponent(cc.ProgressBar).progress=t.getProgress()},setCumulateRewardBtn:function(t,e){var i=t.getComponent(cc.Button);i.clickEvents=[];var n=new cc.Component.EventHandler;n.target=this.node,n.component="CumulateGiftPanel",n.handler="onCumulateRewardClick",n.customEventData=e,i.clickEvents.push(n)},onCumulateRewardClick:function(t,e){var i={module:td.MsgModuleName.ExtensionCmd,cmd:td.MsgCmd.ExtensionCmd.GET_CUMULATEGIFT_REWARD_CUMULATE,configId:e};td.ServerDelegate.sendMessage(i)},onGetDayClick:function(){var t={module:td.MsgModuleName.ExtensionCmd,cmd:td.MsgCmd.ExtensionCmd.GET_CUMULATEGIFT_REWARD_DAY};td.ServerDelegate.sendMessage(t)},onChargeClick:function(){var t=this._controller.getActivityType(),e=td.ActivityEnum.Activity.ActivityFixed;td.GlobalFunction.inActivityGotoRecharge([e,t])},receiveReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult,!0);td.GlobalFunction.showRewards(i)}},btnClose:function(){this.closeCallFunc()}});e.exports=r,cc._RF.pop()},{"../../TS/Hero/Model/HeroModel":"HeroModel",ActivityBasePanel:"ActivityBasePanel"}],CustomGiftController:[function(t,e,i){"use strict";cc._RF.push(e,"29980iBLjZIY6Fds7WxrB6E","CustomGiftController");var n=t("ActivityBaseController"),a=t("CustomGiftModel"),r=cc.Class({extends:n,properties:{_modelList:null},initData:function(t){this._super(t),this.clearData(),this._initData()},clearData:function(){this._modelList=[],this._receiveMap={}},getModelList:function(){return this._modelList},reqReqSelcetReward:function(t,e){var i={parmeterMap:{43:1,44:e},id:t};this.operateActivity(i)},reqReqRecievReward:function(t){var e={parmeterMap:{43:2},id:t};this.operateActivity(e)},activityParse:function(t){var e=t.record.map||{};for(var i in 0==Object.keys(e).length&&(this.clearData(),this._initData()),e){var n=e[i];this._updateModelInfo(i,n)}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_COUSTOM_GIFT_INFO)},_updateModelInfo:function(t,e){var i=this.getCustomModel(t);i&&i.updateInfo(e)},getCustomModel:function(t){for(var e=0,i=this._modelList.length;e<i;e++){var n=this._modelList[e];if(n.getChargeId()==t)return n}return null},_initData:function(){for(var t=td.GetTableClass(td.TableEnum.ActivityCoustomGiftTable).getDatasOfDataId(this.getActivityData()),e=0,i=t.length;e<i;e++){var n=t[e],r=new a;r.initData(n),this._modelList.push(r)}},hasRedPoint:function(){return!0},redPointTip:function(){for(var t=0,e=this._modelList.length;t<e;t++){if(this._modelList[t].hasRewardToReceive())return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.REFRESH_COUSTOM_GIFT_INFO]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",CustomGiftModel:"CustomGiftModel"}],CustomGiftItem2:[function(t,e,i){"use strict";cc._RF.push(e,"ad3bdxU8odFDbwIN8gkmGT3","CustomGiftItem2");var n=t("ListItem"),a=cc.Class({extends:n,properties:{item_0:cc.Node,labBtn:cc.Label,btnSelect:cc.Node,btnRecive:cc.Node,btnReselect:cc.Node,btnRecharge:cc.Node,imgSellout:cc.Node,richTextTips:cc.RichText},updateItem:function(t,e){this._super(t,e),this._model=e;var i=e.getRewards(),n=this.item_0.getChildByName("icon");n?n.getComponent("CommonIconWidget").setData(i):((n=td.GlobalFunction.createCommonIconWidget(26,i)).name="icon",this.item_0.addChild(n));for(var a=e.getCustomNum(),r=1;r<=3;r++){var o=this.node.getChildByName("Item_"+r),s=o.getChildByName("icon");if(r<=a){o.active=!0;var l=e.getOptionIdSelectReward(r);l?s?(s.active=!0,s.getComponent("CommonIconWidget").setData(l)):((s=td.GlobalFunction.createCommonIconWidget(26,l)).name="icon",o.addChild(s)):s&&(s.active=!1)}else o.active=!1}this.btnSelect.active=!1,this.btnRecive.active=!1,this.btnReselect.active=!1,this.btnRecharge.active=!1,this.imgSellout.active=!1,!e.isFull()&&e.getLeftTimes()>0?this.btnSelect.active=!0:0===e.getLeftTimes()?this.imgSellout.active=!0:e.getSate()===td.ActivityEnum.RewardStatus.NONE?(this.btnReselect.active=!0,this.btnRecharge.active=!0):e.getSate()===td.ActivityEnum.RewardStatus.FINISH&&(this.btnRecive.active=!0),this.richTextTips.string=cc.js.formatStr(td.Language[0===this._model.getLeftTimes()?"customGiftItemTips_2":"customGiftItemTips_1"],this._model.getDes(),this._model.getLeftTimes(),this._model.getTimes()),this.labBtn.string=this._model.getOriPrice(),td.RedPointUtil.createRedPointSimple(this.btnRecive,{x:-25,y:-25},this._model.hasRewardToReceive())},onBtnCharge:function(){var t=td.RechargeManager.getRechargeDataById(this._model.getChargeId());t&&td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,t)},onItemClicked:function(){0!==this._model.getLeftTimes()&&td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_CustomGiftSelect2,this._model)},onBtnReceive:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_44);t&&t.reqReqRecievReward(this._model.getChargeId())},onBtnGotoSelect:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_CustomGiftSelect2,this._model)}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],CustomGiftItem:[function(t,e,i){"use strict";cc._RF.push(e,"1ab68TKk9dCxqKCZ8oWf18W","CustomGiftItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{item_0:cc.Node,labBtn:cc.Label,btnSelect:cc.Node,btnRecive:cc.Node,btnReselect:cc.Node,btnRecharge:cc.Node,imgSellout:cc.Node,richTextTips:cc.RichText},updateItem:function(t,e){this._super(t,e),this._model=e;var i=e.getRewards(),n=this.item_0.getChildByName("icon");n?n.getComponent("CommonIconWidget").setData(i):((n=td.GlobalFunction.createCommonIconWidget(26,i)).name="icon",this.item_0.addChild(n));for(var a=e.getCustomNum(),r=1;r<=3;r++){var o=this.node.getChildByName("Item_"+r),s=o.getChildByName("icon");if(r<=a){o.active=!0;var l=e.getOptionIdSelectReward(r);l?s?(s.active=!0,s.getComponent("CommonIconWidget").setData(l)):((s=td.GlobalFunction.createCommonIconWidget(26,l)).name="icon",o.addChild(s)):s&&(s.active=!1)}else o.active=!1}this.btnSelect.active=!1,this.btnRecive.active=!1,this.btnReselect.active=!1,this.btnRecharge.active=!1,this.imgSellout.active=!1,!e.isFull()&&e.getLeftTimes()>0?this.btnSelect.active=!0:0===e.getLeftTimes()?this.imgSellout.active=!0:e.getSate()===td.ActivityEnum.RewardStatus.NONE?(this.btnReselect.active=!0,this.btnRecharge.active=!0):e.getSate()===td.ActivityEnum.RewardStatus.FINISH&&(this.btnRecive.active=!0),this.richTextTips.string=cc.js.formatStr(td.Language[0===this._model.getLeftTimes()?"customGiftItemTips_2":"customGiftItemTips_1"],this._model.getDes(),this._model.getLeftTimes(),this._model.getTimes()),this.labBtn.string=this._model.getOriPrice(),td.RedPointUtil.createRedPointSimple(this.btnRecive,{x:-25,y:-25},this._model.hasRewardToReceive())},onItemClicked:function(){0!==this._model.getLeftTimes()&&td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_CustonGiftPool,this._model)},onBtnReceive:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_43);t&&t.reqReqRecievReward(this._model.getChargeId())},onBtnGotoSelect:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_CustonGiftPool,this._model)},onBtnCharge:function(){var t=td.RechargeManager.getRechargeDataById(this._model.getChargeId());t&&td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,t)}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],CustomGiftModel:[function(t,e,i){"use strict";cc._RF.push(e,"cc0e6s10BtGnIPJ8aaQ2eQ9","CustomGiftModel");var n=t("CustomGiftPoolModel"),a=cc.Class({properties:{_data:null,_chargeId:null,_rewards:null,_rewardPools:null,_times:null,_des:null,_oriPrice:null,_des:null,_customNum:null,_poolModelList:null,_buyTimes:null,_selectId:null,_status:null},initData:function(t){this._rewardMap={},this._status=td.ActivityEnum.RewardStatus.NONE,this._data=t.data,this._chargeId=t.chargeId,this._des=t.des,this._oriPrice=t.oriPrice,this._reward=td.RewardManager.parseRewardListDetail(t.rewards)[0];var e=t.rewardPools;this._customNum=e.length,this._poolModelList={};for(var i=0;i<this._customNum;i++){var a=e[i],r=a[0],o=a[1],s=td.GetTableClass(td.TableEnum.ActivityCoustomGiftPoolTable).getRewardById(o);this._poolModelList[r]=[];for(var l=0,c=s.length;l<c;l++){var u=s[l],d=new n;d.initData(u,r),this._poolModelList[r].push(d)}this._poolModelList[r].sort(function(t,e){return t.getLevelLimit()-e.getLevelLimit()})}this._times=t.times},getData:function(){return this._data},getOriPrice:function(){return this._oriPrice},getChargeId:function(){return this._chargeId},getCost:function(){return this._cost},getDes:function(){return this._des},getCustomNum:function(){return this._customNum},getSelectNum:function(){return this._rewardMap.myLen()},getRewardMap:function(){return this._rewardMap},isFull:function(){return this.getSelectNum()===this.getCustomNum()},getTimes:function(){return this._times},getLeftTimes:function(){return this._times-this._buyTimes},getRewards:function(){return this._reward},getRewardPoolList:function(){return this._poolModelList},updateInfo:function(t){this._buyTimes=t.times,this._rewardMap=t.rewardMap,this._status=parseInt(t.status)},getSate:function(){return this._status},hasRewardToReceive:function(){return this._buyTimes<this._times&&this._status===td.ActivityEnum.RewardStatus.FINISH},getPoolByOption:function(t){return this._poolModelList[t]},getOptionIdSelectRewardId:function(t){return this._rewardMap[t]},getOptionIdSelectReward:function(t){for(var e=this.getOptionIdSelectRewardId(t),i=this._poolModelList[t],n=0,a=i.length;n<a;n++)if(i[n].getId()===e)return i[n].getReward();return null},getRewardByPoolId:function(t,e){for(var i=this._poolModelList[t],n=0,a=i.length;n<a;n++)if(i[n].getId()===e)return i[n].getReward();return null}});e.exports=a,cc._RF.pop()},{CustomGiftPoolModel:"CustomGiftPoolModel"}],CustomGiftPanel2:[function(t,e,i){"use strict";cc._RF.push(e,"009627qrYNB85nmd7vcNve2","CustomGiftPanel2");var n=t("CustomGiftPanel"),a=cc.Class({extends:n,init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_CustomGiftPanel2},setController:function(){var t=td.ActivityEnum.ActivityType.ACTIVITY_TYPE_44;this._controller=td.ActivityDataManager.getActivityControllerByType(t)}});e.exports=a,cc._RF.pop()},{CustomGiftPanel:"CustomGiftPanel"}],CustomGiftPanel:[function(t,e,i){"use strict";cc._RF.push(e,"912b8bkA8pLP5d3nA8Dagay","CustomGiftPanel");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{labTimecount:cc.Label,_controller:null},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.CustonGiftPanel},onLoad:function(){var t=this.node.getChildByName("scrollView");this._listView=t.getComponent("OptimizeVerticalListView"),this.setController()},setController:function(){var t=td.ActivityEnum.ActivityType.ACTIVITY_TYPE_43;this._controller=td.ActivityDataManager.getActivityControllerByType(t)},onEnable:function(){this._super(),this._addLocalListeners(),this._firstEnter=!0,this._updateTimecount(),gdk.Timer.loop(1e3,this,this._updateTimecount),this._refreshList()},onDisable:function(){gdk.Timer.clearAll(this),td.EventUtil.unregisterAllEvents(this),this._super()},getActivityLeftTimeStr:function(t){if(this._controller){var e=this._controller.getCurrentOpenStage();if(!e)return"";var i=e.showTime-td.TimeUtil.getTime();return i<=0?"":td.GlobalFunction.getTimeSecondsStringByDeltaTime(i,t)}},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REFRESH_COUSTOM_GIFT_INFO]=this._refreshList,i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this._onOperationSucc,i[e.ON_ACTIVITY_CLOSED]=this.closeCallFunc,t.registerEvents(i,this)},_updateTimecount:function(){this.labTimecount.string=this.getActivityLeftTimeStr()},_onOperationSucc:function(t){if(this._controller&&t.activityId===this._controller.getActivityId()){var e=t.rewardResult;if(e){var i=td.RewardManager.parseRewardResult(e,!0);i.length>0&&td.GlobalFunction.showRewards(i)}}},_refreshList:function(){if(this._controller){var t=this._controller.getModelList();this._firstEnter?this._listView.setData(t):this._listView.refreshCurList(t),this._firstEnter=!1}},scrollSV:function(t,e){var i=t.node.getComponent("OptimizeVerticalListView").getItemSize().height,n=t.getScrollOffset();this.firstIndex=Math.floor(n.y/i)}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],CustomGiftPoolItem:[function(t,e,i){"use strict";cc._RF.push(e,"22e6fuLrdFDcJEOo0d6To7C","CustomGiftPoolItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{imgMask:cc.Node,imgSelect:cc.Node,imgLock:cc.Node,_selectId:0},updateItem:function(t,e,i){this._super(t,e),this._model=e,this._selectId=i;var n=e.getReward(),a=this.node.getChildByName("icon");a?a.getComponent("CommonIconWidget").setData(n):((a=td.GlobalFunction.createCommonIconWidget(26,n)).name="icon",a.scale=.8,this.node.addChild(a,-1)),a.getComponent("CommonIconWidget").disableHeadTouch(),this._model.isUnlock()?this._selectId===this._model.getId()?(this.imgMask.active=!0,this.imgLock.active=!1,this.imgSelect.active=!0):(this.imgMask.active=!1,this.imgLock.active=!1,this.imgSelect.active=!1):(this.imgMask.active=!0,this.imgLock.active=!0,this.imgSelect.active=!1)},touchItem:function(){this._model.isUnlock(!0)&&(this._selectId===this._model.getId()||td.EventUtil.dispatchEvent(td.EventNameEnum.CUSTOM_GIFT_SELECT_REWARD,this._model.getId()))}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],CustomGiftPoolModel:[function(t,e,i){"use strict";cc._RF.push(e,"81c9a9Dt+lOFaKHrepswkO8","CustomGiftPoolModel");var n=cc.Class({properties:{_id:null,_poolId:null,_rewards:null,_levelLimit:null,_option:null,_selectId:null},initData:function(t,e){this._id=t.id,this._poolId=t.poolId,this._levelLimit=t.levelLimit,this._reward=td.RewardManager.parseRewardListDetail(t.rewards)[0],this._option=e},getId:function(){return this._id},getPoolId:function(){return this._poolId},getLevelLimit:function(){return this._levelLimit},getReward:function(){return this._reward},setSlectId:function(t){this._selectId=t},isUnlock:function(t){if(void 0===t&&(t=!1),td.Account.getUserData().level<this._levelLimit){if(t){var e=new td.BroadcastContent(177),i=new td.BroadcastParam(cc.js.formatStr(td.Language.reachLevelUnlock,this._levelLimit));e.setMainParam([i]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e)}return!1}return!0}});e.exports=n,cc._RF.pop()},{}],CustomGiftSelectWindow2:[function(t,e,i){"use strict";cc._RF.push(e,"46c6aswgd5HFYYTdnNsO8TR","CustomGiftSelectWindow2");var n=t("CustomGiftSelectWindow"),a=cc.Class({extends:n,init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_CustomGiftSelect2},getController:function(){var t=td.ActivityEnum.ActivityType.ACTIVITY_TYPE_44;return td.ActivityDataManager.getActivityControllerByType(t)}});e.exports=a,cc._RF.pop()},{CustomGiftSelectWindow:"CustomGiftSelectWindow"}],CustomGiftSelectWindow:[function(t,e,i){"use strict";cc._RF.push(e,"6f583mzt/dDqrdjL3Zv2dXU","CustomGiftSelectWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=(o.menu,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemTemplete=null,e.imgTipsBg=null,e.imgTipsArrow=null,e.labName=null,e.labTips=null,e.rewardPool=null,e.btnSave=null,e.labTipsEmpty=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_CustonGiftPool},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.CUSTOM_GIFT_SELECT_REWARD]=this._onSelectReward,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._model=e;var i=e.getRewardMap();for(var n in this._rewardMap={},i)this._rewardMap[n]=i[n];this.onSelectItem(null,1),this._initItems()},e.prototype._onSelectReward=function(t){this._rewardMap[this._showTab]=t,this._initRewardPool(this._showTab),this._initItems()},e.prototype.onSelectItem=function(t,e){e!==this._showTab&&(this._showTab=e,this._initRewardPool(e),this._initItems())},e.prototype._initItems=function(){var t=this._model.getCustomNum();r.GlobalFunction.setButtonGray(this.btnSave,this._rewardMap.myLen()!==t);var e=this.node.getChildByName("Item_"+this._showTab);this.imgTipsArrow.x=e.x,this.labTipsEmpty.active=!0,this.labName.node.active=!1,this.labTips.node.active=!1;for(var i=1;i<=3;i++){var n=this.node.getChildByName("Item_"+i);if(i>t)n&&(n.active=!1);else{var a=n.getChildByName("icon");if(n.getChildByName("imgSelect").active=i==this._showTab,this._rewardMap[i]){var o=this._model.getRewardByPoolId(i,this._rewardMap[i]);a?(a.active=!0,a.getComponent("CommonIconWidget").setData(o)):((a=r.GlobalFunction.createCommonIconWidget(26,o)).name="icon",n.addChild(a)),a.getComponent("CommonIconWidget").disableHeadTouch(),i==this._showTab&&this._initTipsInfo(i,o)}else a&&(a.active=!1)}}},e.prototype._initTipsInfo=function(t,e){this.labTipsEmpty.active=!1,this.labName.node.active=!0,this.labTips.node.active=!0;var i=this.node.getChildByName("Item_"+t);this.imgTipsArrow.x=i.x,this.labName.string=e.getName()+"x"+e.getCount(),r.GlobalFunction.setNameColors(this.labName.node,e.getQuality()),this.labTips.string=e.getDes()},e.prototype._initRewardPool=function(t){for(var e=this._model.getPoolByOption(t),i=0;i<20;i++){var n=this.rewardPool.getChildByName("poolItem_"+i);if(!n)break;n.active=!1}i=0;for(var a=e.length;i<a;i++){var r=e[i],o=this.rewardPool.getChildByName("poolItem_"+i);o||(o=cc.instantiate(this.itemTemplete),this.rewardPool.addChild(o)),o.getComponent("CustomGiftPoolItem").updateItem(i,r,this._rewardMap[t]),o.name="poolItem_"+i,o.active=!0}this.rewardPool.getComponent(cc.Layout).updateLayout()},e.prototype.getController=function(){var t=r.ActivityEnum.ActivityType.ACTIVITY_TYPE_43;return r.ActivityDataManager.getActivityControllerByType(t)},e.prototype.onBtnSave=function(){this.getController().reqReqSelcetReward(this._model.getChargeId(),this._rewardMap),this.closeCallFunc()},a([l(cc.Node)],e.prototype,"itemTemplete",void 0),a([l(cc.Node)],e.prototype,"imgTipsBg",void 0),a([l(cc.Node)],e.prototype,"imgTipsArrow",void 0),a([l(cc.Label)],e.prototype,"labName",void 0),a([l(cc.Label)],e.prototype,"labTips",void 0),a([l(cc.Node)],e.prototype,"rewardPool",void 0),a([l(cc.Node)],e.prototype,"btnSave",void 0),a([l(cc.Node)],e.prototype,"labTipsEmpty",void 0),e=a([s],e)}(t("PanelBase")));i.default=c,e.exports=c,cc._RF.pop()},{PanelBase:void 0}],DailyPreferentialController:[function(t,e,i){"use strict";cc._RF.push(e,"8a925WR1xhIoaqc9N9nXsDn","DailyPreferentialController");var n=t("ActivityBaseController"),a=t("DailyPreferentialModel"),r=cc.Class({extends:n,properties:{_curItem:null,_chargeTotal:null,_rewardStatus:null,_isHideAutoShow:null},initData:function(t){this._super(t),this.clearData()},clearData:function(){this._curItem=null,this._chargeTotal=0,this._rewardStatus=td.RewardStatus.CANNOT_RECEIVE,this._isInited=!1},hadReceiveData:function(){return null!==this._curItem},isHideAutoShow:function(){td.Account.getUserData().getUserId();return this._isHideAutoShow=td.GlobalFunction.getLocalSaveStatus("HIDE_DAILY_PREFERENTIAL_"),!this._isHideAutoShow},setHideAutoShow:function(t){this._isHideAutoShow=t;td.Account.getUserData().getUserId();this._isHideAutoShow?td.GlobalFunction.setLocalSaveStatus("HIDE_DAILY_PREFERENTIAL_",!0):td.GlobalFunction.removeLocalSaveStatus("HIDE_DAILY_PREFERENTIAL_")},getDiscountItemData:function(){return this._curItem},activityParse:function(t){t&&this._parseReceiveQueryData(t)},_parseReceiveQueryData:function(t){var e=t.global,i=t.record;this._chargeTotal=i.recharge;var n=e.id,r=this.getActivityData(),o=td.GetTableClass(td.TableEnum.DailyPreferentialTable).getDataByDataIdAndId(r,n);if(o){var s=new a;s.initData(o),this._curItem=s}if(this._curItem){this._rewardStatus=i.receiveStatus?td.RewardStatus.RECEIVED:this._chargeTotal>=this._curItem.getNeedRecharge()?td.RewardStatus.CAN_RECEIVE:td.RewardStatus.CANNOT_RECEIVE;var l=setTimeout(function(){clearTimeout(l),td.EventUtil.dispatchEvent(td.EventNameEnum.DAILY_DISCOUNT_UPDATED)},50);!this._isInited&&(this._isInited=!0),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL)}else cc.log("get daily discount data error for dataId = "+r+" id = "+n)},isCanShow:function(){return this._rewardStatus!==td.RewardStatus.RECEIVED},getRewardStatus:function(){return this._rewardStatus},getTotalRecharge:function(){return this._chargeTotal},hasRedPoint:function(){return!0},isRedPointTip:function(){return this._rewardStatus===td.RewardStatus.CAN_RECEIVE},RedTipsEvents:function(){return[td.EventNameEnum.DAILY_DISCOUNT_UPDATED]},isInited:function(){return this._isInited}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",DailyPreferentialModel:"DailyPreferentialModel"}],DailyPreferentialModel:[function(t,e,i){"use strict";cc._RF.push(e,"a3fdaP2voVFQZ0sZGv+ecEZ","DailyPreferentialModel");var n=cc.Class({properties:{_id:null,_needRecharge:null,_reward:null,_des:null,_type:null,_cost:null},initData:function(t){t&&(this._id=t.id,this._needRecharge=t.recharge,this._des=t.des,this._type=t.dailyDiscountType,this._cost=t.cost,this._reward=td.RewardManager.parseRewardListDetail(t.reward))},getId:function(){return this._id},getCost:function(){return this._cost},getType:function(){return this._type},getNeedRecharge:function(){return this._needRecharge},getReward:function(){return this._reward},getDescription:function(){return this._des}});e.exports=n,cc._RF.pop()},{}],DailyPreferentialTable:[function(t,e,i){"use strict";cc._RF.push(e,"63facJj7/pCYLy4YlQu7DtL","DailyPreferentialTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"DailyPreferentialTable",properties:{_tblName:"daily_discounts_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]=t[a.data]||{},t[a.data][a.id]=a}},getDataByDataIdAndId:function(t,e){return this._data&&this._data[t]&&this._data[t][e]?this._data[t][e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DailyPreferentialWindow:[function(t,e,i){"use strict";cc._RF.push(e,"0a8dbac435OgbVmcMqTVwDj","DailyPreferentialWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{lab_tips:cc.RichText,layout:cc.Node,lab_time:cc.Label,lab_charge:cc.Label,lab_max:cc.Label,img:cc.Node,btn_charge:cc.Node,btn_get:cc.Node,img_ylq:cc.Node,img_ygm:cc.Node,Layout:cc.Node,Layout1:cc.Node,icon:cc.Node,lab_cost:cc.Label,btn_buy:cc.Node,_controller:null,_activityType:null,_activityId:null,_bHide:null,_leftTime:null,_curDealData:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_DailyPreferential},onLoad:function(){this._super(),this._activityType=td.ActivityEnum.ActivityType.DailyPreferential,this._controller=td.ActivityDataManager.getActivityControllerByType(this._activityType),this._controller&&(this._activityId=this._controller.getActivityId(),this._leftTime=0,this._curDealData=null,this._bHide=!this._controller.isHideAutoShow(),this.img.active=this._bHide)},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.Recharge_Success]=this.refreshView,i[e.DAILY_DISCOUNT_UPDATED]=this.refreshView,i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.receiveRewardReturn,i[e.Res_GET_ACTIVITY_INFO]=this.refreshView,i[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,t.registerEvents(i,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},onEnable:function(){this._super(),this._addEventListener(),this._curDealData=this._controller.getDiscountItemData(),this._curDealData?this.refreshView():td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,this._activityId)},onDisable:function(){this._super(),this._removeAllListeners(),this.unschedule(this._updateActivityOddTime)},_setActivityTime:function(){this._leftTime=Math.floor((td.TimeUtil.getTodayTwentyFourMilliseconds()-td.TimeUtil.getTime())/1e3),this._leftTime<0&&(this._leftTime=0),this.lab_time.string=td.GlobalFunction.getConvertTimeFormat(this._leftTime),this.schedule(this._updateActivityOddTime,1)},_updateActivityOddTime:function(){this.lab_time&&this._leftTime&&this._leftTime>0?(this.lab_time.string=td.GlobalFunction.getConvertTimeFormat(this._leftTime),this._leftTime--):(this.lab_time.string="00:00:00",this.unschedule(this._updateActivityOddTime))},_setActivityDesc:function(){var t=this._curDealData.getDescription();this.lab_tips.string=t},_onActivityClose:function(t){this._activityId===t&&this.closeCallFunc()},setReward:function(){this._curDealData||(this._curDealData=this._controller.getDiscountItemData());var t=this._curDealData.getReward(),e=0,i=t.length;for(e=0;e<i;e++){var n=t[e];if(a=this.layout.getChildByName("rewardItem_"+e))a.getComponent("CommonIconWidget").setData(n);else a=td.GlobalFunction.createCommonIconWidget(57,n),this.layout.addChild(a),a.name="rewardItem_"+e,a.getChildByName("nameLabelBg").active=!1,a.width}for(;;){var a;if(!(a=this.layout.getChildByName("rewardItem_"+e)))break;a.removeFromParent(),e++}},refreshView:function(){if(this._controller=td.ActivityDataManager.getActivityControllerByType(this._activityType),this._controller){this._curDealData=this._controller.getDiscountItemData();var t=this._controller.getTotalRecharge(),e=this._curDealData.getNeedRecharge(),i=this._curDealData.getType(),n=this._controller.getRewardStatus();if(i===td.ActivityEnum.DailyDiscountType.BUY){this.Layout1.active=!0,this.Layout.active=!1,this.btn_charge.active=!1,this.btn_get.active=!1,this.img_ylq.active=!1;var a=this._curDealData.getCost(),r=td.GetTableClass(td.TableEnum.Item).getItemById(a[0][1]);this.lab_cost.string=a[0][2]+"",td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,r.liIconRes,this.icon),this.btn_buy.active=n!=td.RewardStatus.RECEIVED,this.img_ygm.active=n===td.RewardStatus.RECEIVED}else i===td.ActivityEnum.DailyDiscountType.RECHARGE&&(this.Layout1.active=!1,this.Layout.active=!0,this.btn_buy.active=!1,this.img_ygm.active=!1,this.lab_max.string="/"+cc.js.formatStr(td.Language.rechargeCount,e/10),this.lab_charge.string=t/10,this.lab_charge.node.color=t>=e?cc.color(11,232,0):cc.color(255,246,198),this.btn_charge.active=n===td.RewardStatus.CANNOT_RECEIVE,this.btn_get.active=n===td.RewardStatus.CAN_RECEIVE,this.img_ylq.active=n===td.RewardStatus.RECEIVED);this._setActivityTime(),this._setActivityDesc(),this.setReward()}},onChooseHideStatus:function(){this._bHide=!this.img.active,this.img.active=this._bHide,this._controller.setHideAutoShow(this._bHide)},onBtnCharge:function(){td.GlobalFunction.gotoRecharge()},onBtnOperateActivity:function(){if(this._curDealData.getType()===td.ActivityEnum.DailyDiscountType.BUY){var t=this._curDealData.getCost(),e=td.Account.getUserData();if(t[0][1]===td.ItemEnum.Diamond){if(e.getDiamond()<t[0][2]){var i=new td.BroadcastContent(282);return void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}}else if(t[0][1]===td.ItemEnum.Gold){if(e.getGold()<t[0][2]){i=new td.BroadcastContent(283);return void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}}}var n={id:this._curDealData.getId()};this._controller.operateActivity(n)},receiveRewardReturn:function(t){if(t.activityId===this._activityId){var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);td.GlobalFunction.showRewards(i),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL)}},closeCallFunc:function(){this._super(),this._controller.setHideAutoShow(this._bHide),td.EventUtil.dispatchEvent(td.EventNameEnum.CLOSED_POP_WINDOW)}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],DayDayRechargeController:[function(t,e,i){"use strict";cc._RF.push(e,"837f9EY7k9K7IIJSmgRZbnx","DayDayRechargeController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_rewardList:null,_selectIndex:null,_day:0},initData:function(t){this._super(t),this._day=0,this._rewardList=[]},getDay:function(){return this._day},getRewardList:function(){return this._rewardList},setSelectIndex:function(t){this._selectIndex=t,td.EventUtil.dispatchEvent(td.EventNameEnum.DayDayRecharge_CHANGE)},getRewardById:function(t){for(var e=0;e<this._rewardList.length;e++)if(this._rewardList[e].id===t)return this._rewardList[e];return null},activityParse:function(t){var e=t.record;this._day=e.day,this._rewardList=e.entities},hasRedPoint:function(){return!0},redPointTip:function(){var t=this.getActivityData(),e=td.GetTableClass(td.TableEnum.ContinuousTotalRechargeTable).getDatasOfDataId(t);if(e)for(var i=0;i<e.length;i++)if(this.isRedTipsByIndex(i))return!0;return!1},isRedTipsByIndex:function(t){var e=this.getActivityData(),i=td.GetTableClass(td.TableEnum.ContinuousTotalRechargeTable).getDatasOfDataId(e),n=this.getRewardById(i[t].id);if(!n)return!1;for(var a=n.dayReceives,r=n.dayRecharges,o=n.totalReceives,s=this.getDay(),l=0;l<r.length;l++)if(!(s<r[l]||a&&0!==a.length&&-1!==a.indexOf(parseInt(r[l]))))return!0;for(var c=r.length,u=i[t].totalRewards,d=0;d<u.length;d++){var h=u[d][0];if(c>=h&&(!o||0===o.length||-1===o.indexOf(h)))return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.Res_GET_ACTIVITY_INFO]},isRedPointTip:function(){return this.redPointTip()}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],DayDayRechargeItem:[function(t,e,i){"use strict";cc._RF.push(e,"c67fbD+iwhBtrpg5gcmIw9f","DayDayRechargeItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=(r.property,r.menu),l=window.td,c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.updateItem=function(e,i){if(t.prototype.updateItem.call(this,e,i),this._controller=l.ActivityDataManager.getActivityControllerByType(l.ActivityEnum.ActivityType.DayDayRecharge),this._controller){this._id=this._customData,this._last_day=i[0];var n=this._controller.getActivityData(),a=this._controller.getRewardById(this._id),r=l.GetTableClass(l.TableEnum.ContinuousTotalRechargeTable).getDataByDataIdAndId(n,this._id),o=this.node,s=o.getChildByName("btn_recharge"),c=o.getChildByName("btn_reward"),u=o.getChildByName("img_wdc"),d=o.getChildByName("img_wkq"),h=o.getChildByName("img_ylq"),p=o.getChildByName("layout"),_=o.getChildByName("lab_des"),g=r.charge/10;_.getComponent(cc.RichText).string=cc.js.formatStr("%s",l.Language.ContinuousTotalRecharge1,this._last_day,g);var f=this._controller.getDay();f<this._last_day?(s.active=!1,c.active=!1,u.active=!1,h.active=!1,d.active=!0):(d.active=!1,a?(c.active=-1!==a.dayRecharges.indexOf(this._last_day)&&-1===a.dayReceives.indexOf(this._last_day),h.active=-1!==a.dayReceives.indexOf(this._last_day),s.active=f===this._last_day&&-1===a.dayRecharges.indexOf(this._last_day),u.active=f>this._last_day&&-1===a.dayRecharges.indexOf(this._last_day)):(s.active=f===this._last_day,c.active=!1,h.active=!1,u.active=f!==this._last_day)),p.removeAllChildren(!0);for(var v=i[1],m=l.RewardManager.parseRewardListDetail(v),y=0;y<m.length;y++){var E=l.GlobalFunction.createCommonIconWidget(26,m[y]);E.setScale(.9),p.addChild(E)}}},e.prototype.onBtnCharge=function(){l.GlobalFunction.gotoRecharge()},e.prototype.onBtnReciveDay=function(){var t={};t.id=this._id,t.parmeterMap={8:this._last_day,9:0},this._controller.operateActivity(t)},e=a([o,s("module/Activity/DayDayRechargeItem")],e)}(t("ListItem"));i.default=c,cc._RF.pop()},{ListItem:void 0}],DayDayRechargePanel:[function(t,e,i){"use strict";cc._RF.push(e,"9eb09RydRVAbYUX3rezBQz4","DayDayRechargePanel");var n=t("ActivityBasePanel"),a=t("OptimizeVerticalListView"),r=cc.Class({extends:n,properties:{lab_time:cc.Label,_last_tab:null,_last_btn:null,_id:0},onEnable:function(){this._super(),this._addLocalListeners(),this.setActivityTime(),this.initTab()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.Recharge_Success]=this._refresh,i[e.Res_GET_ACTIVITY_INFO]=this._resInfo,i[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.receiveRewardReturn,t.registerEvents(i,this)},initTab:function(){for(var t=1;t<4;t++){var e=this.node.getChildByName("tab"+t),i=e.getChildByName("Label");td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_gy,"HD_anniu_06",e),i.color=cc.color(243,196,43),i.getComponent(cc.LabelOutline).color=cc.color(164,61,20);var n=this._controller.getActivityData(),a=td.GetTableClass(td.TableEnum.ContinuousTotalRechargeTable).getDatasOfDataId(n)[t-1].charge/10;i.getComponent(cc.Label).string=cc.js.formatStr("%s",td.Language.ContinuousTotalRecharge,a),td.RedPointUtil.createRedPointOld(e,{x:-20,y:-20},this._controller.isRedTipsByIndex.bind(this._controller,t-1),this._controller.redPointEvts())}this._last_tab=null,this._id=0,this.selectTab(null,1)},selectTab:function(t,e){if(this._last_tab){var i=this._last_tab.getChildByName("Label");td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_gy,"HD_anniu_06",this._last_tab),i.color=cc.color(243,196,43),i.getComponent(cc.LabelOutline).color=cc.color(164,61,20)}var n=this.node.getChildByName("tab"+e);this._last_tab=n,this._id=parseInt(e),this._controller.setSelectIndex(this._id-1);var a=n.getChildByName("Label");td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_gy,"HD_anniu_05",n),a.color=cc.color(255,255,255),a.getComponent(cc.LabelOutline).color=cc.color(176,102,14),this.initItem(),this._refresh()},initItem:function(){for(var t=this._controller.getActivityData(),e=td.GetTableClass(td.TableEnum.ContinuousTotalRechargeTable).getDataByDataIdAndId(t,this._id),i=1;i<3;i++){var n=this.node.getChildByName("item"+i),a=td.RewardManager.getRewardDetail(e.totalRewards[i-1][1][0]),r=n.getChildByName("icon");r?r.getComponent("CommonIconWidget").setData(a):((r=td.GlobalFunction.createCommonIconWidget(26,a)).name="icon",r.setScale(.9),r.x=-110,r.y=-20,n.addChild(r));var o=a.getDes();o.length>14&&(o=o.slice(0,15)+"...")}},_resInfo:function(t){t===this.getActivityId()&&this._refresh()},_refresh:function(){var t=this._controller.getActivityData(),e=this._controller.getRewardById(this._id),i=td.GetTableClass(td.TableEnum.ContinuousTotalRechargeTable).getDataByDataIdAndId(t,this._id),n=i.dayRewards,r=this.node.getComponent(a);r.setCustomData(this._id),r.refreshListData(n);for(var o=this._controller.getDay()-1,s=0;s<i.dayRewards.length;s++)e&&-1!==e.dayRecharges.indexOf(i.dayRewards[s][0])&&-1===e.dayReceives.indexOf(i.dayRewards[s][0])&&(o=s);r.scrollToRow(o);for(var l=1;l<3;l++){var c=this.node.getChildByName("item"+l),u=c.getChildByName("img_ylq"),d=c.getChildByName("btn_reward"),h=c.getChildByName("GY_hongdian"),p=c.getChildByName("lab_title"),_=e?e.dayRecharges.length:0,g=i.totalRewards[l-1][0];p.getComponent(cc.Label).string=cc.js.formatStr("%s",td.Language.ContinuousTotalRecharge3,g,_,g),_>=g?(td.GlobalFunction.setButtonGray(d,!1),e?(d.active=-1===e.totalReceives.indexOf(g),u.active=-1!==e.totalReceives.indexOf(g),h.active=-1===e.totalReceives.indexOf(g)):(d.active=!0,u.active=!1,h.active=!1)):(td.GlobalFunction.setButtonGray(d,!0),d.active=!0,u.active=!1,h.active=!1)}},setActivityTime:function(){var t=this.getDurationStr();this.lab_time.string=t},_onActivityClose:function(t){this._activityId===t&&this.onDestroy()},receiveRewardReturn:function(t){if(t.activityId===this._activityId){var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);td.GlobalFunction.showRewards(i)}},onBtnCharge:function(){td.GlobalFunction.gotoRecharge()},onBtnReciveTotal:function(t,e){var i=this._controller.getActivityData(),n=td.GetTableClass(td.TableEnum.ContinuousTotalRechargeTable).getDataByDataIdAndId(i,this._id).totalRewards[parseInt(e)][0],a={};a.id=this._id,a.parmeterMap={8:n,9:1},this._controller.operateActivity(a)}});e.exports=r,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0}],DecomposeConfig:[function(t,e,i){"use strict";cc._RF.push(e,"acb63+ySN9M77tY/W4o63xT","DecomposeConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"DecomposeConfig",properties:{_tblName:"decompose_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.type]=a}},getAllDecomposeConfig:function(){return this._data},getDecomposeConfig:function(t){return this._data[t]?this._data[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DemonTreasureCopyConfig:[function(t,e,i){"use strict";cc._RF.push(e,"966dbeeWYZNHJOtcVUhp5v+","DemonTreasureCopyConfig");var n=t("BaseTable"),a=cc.Class({extends:n,properties:{_tblName:"demon_treasure_config",_data:null},init:function(){this._data={},this._arrayData=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a,this._arrayData.push(a)}this._arrayData.length>1&&this._arrayData.sort(function(t,e){return t.maxPowerMin-e.maxPowerMin})},getCopyConfigByCopyId:function(t){if(this._data)for(var e in this._data)if(parseInt(e)==t)return this._data[e];return null},getAllCfgData:function(){return this._arrayData.slice(0)},getMaxDifficultCopyData:function(){if(!this._arrayData)return null;if(this._arrayData.length<=0)return null;var t=this._arrayData.slice(0);return t[t.length-1]},getMinDifficultCopyData:function(){return this._arrayData?this._arrayData.length<=0?null:this._arrayData.slice(0)[0]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DemonTreasureCopyManager:[function(t,e,i){"use strict";cc._RF.push(e,"60cdedHWGxFULizjDqs3AxH","DemonTreasureCopyManager");var n=t("CommonEnum"),a=t("ActorRankModel");td.DemonTreasureCopyManager={_copyDataList:null,_curCopyId:null,_actorRankList:[],_myActorRankInfo:null,_canChallengeTimes:null,_haveChallengedTimes:null,_haveBoughtTimes:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._copyDataList={},this._actorRankList=[],this._myActorRankInfo=null,this._haveBoughtTimes=0,this._haveChallengedTimes=0,this._canChallengeTimes=0},_addListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.DemonTreasure,i=td.MsgCmd.DemonTreasure;t.registerMessage(e,i.DEMON_TREASURE_PREPARE,this._parsePrepare.bind(this)),t.registerMessage(e,i.GET_DEMON_TREASURE_INFO,this._parseCopyInfo.bind(this)),t.registerMessage(e,i.DEMON_TREASURE_CHALLENGE,this._onChanllengeReturn.bind(this)),t.registerMessage(e,i.GET_DEMON_TREASURE_RANK,this._onGetDemonTreasureRankReward.bind(this)),t.registerMessage(e,i.DEMON_TREASURE_BUY_TIMES,this._onBuyTimes.bind(this)),t.registerMessage(e,i.PUSH_DEMON_TREASURE_INFO,this._parseCopyInfo.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQ_DEMON_TREASURE_COPY_PREPARE]=this._requestPrepare,i[e.REQUEST_DEMON_TREASURE_COPY_DATA]=this._requestGetCopyInfo,i[e.REQUEST_DEMON_TREASURE_COPY_CHALLENGE]=this._requestCopyChallenge,i[e.REQUEST_DEMON_TREASURE_RANK_REWARD]=this._reqestDemonTreasureRankReward,i[e.REQ_DEMON_TREASURE_BUY_TIEMS]=this._reqBuyTimes,t.registerEvents(i,this)},getLeftChallengeTimes:function(){var t=0,e=td.GetConfig("DEMON_TREASURE_CHALLENGE_FREE_TIMES");return this._canChallengeTimes=e+this._haveBoughtTimes-this._haveChallengedTimes,t=this._canChallengeTimes,td.UnlockManager.isTargetUnlock(td.ActorUnlockType.DEMON_TREASURE,0)||(t=0),t},haveFreeTimes:function(){var t=td.GetConfig("DEMON_TREASURE_CHALLENGE_FREE_TIMES");return!(this._haveChallengedTimes>=t)},isRedPointTips:function(){return!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.DEMON_TREASURE,0)&&(!!this._copyDataList&&!!this.haveFreeTimes())},redPointEvents:function(){var t=td.EventNameEnum;return[t.USER_ATTR_LEVEL_CHANGE,t.DEMON_TREASURE_COPY_DATA_CHANGED]},findSuitaleDemonTreasureCopy:function(){var t=td.Account.getUserData().getHistoryHighestPower(),e=td.GetTableClass(td.TableEnum.DemonTreasureCopyConfig).getMaxDifficultCopyData(),i=td.GetTableClass(td.TableEnum.DemonTreasureCopyConfig).getMinDifficultCopyData();if(e&&t>=e.maxPowerMin)return e;if(i&&t<i.maxPowerMin)return i;var n=td.GetTableClass(td.TableEnum.DemonTreasureCopyConfig).getAllCfgData();for(var a in n){var r=n[a];if(r.maxPowerMin<=t&&r.maxPowerMax>=t)return r}return i},getNextBuyVipLevel:function(t){var e=td.GetTableClass(td.TableEnum.VipPrivilegeTable).getPrerogativeByTypeAndOpenValue(n.PrerogativeEnum.CopyResetTime);if(!e)return null;var i=td.Account.getUserData();if(!i)return null;var a=i.vip,r=0;for(var o in e){var s=e[o=parseInt(o)];if(o<=a){if(!(u=s.value)||0===u.length)continue;for(var l=0,c=u.length;l<c;l++){if((d=u[l])[0]===t){d[1]>0&&(r=d[1]);break}}}else if(o>a){var u;if(!(u=s.value)||0===u.length)continue;for(l=0,c=u.length;l<c;l++){var d;if((d=u[l])[0]===t&&d[1]>r)return s.privilegeOpenValue}}}return null},getCopyInfoByCopyId:function(t){return this._copyDataList[t]?this._copyDataList[t]:null},getCopyInfoByIndex:function(t){if(!this._copyDataList)return null;for(var e in this._copyDataList)if(this._copyDataList[e].getIndex()===t)return this._copyDataList[e];return null},_requestPrepare:function(t){var e={};e.module=td.MsgModuleName.DemonTreasure,e.cmd=td.MsgCmd.DemonTreasure.DEMON_TREASURE_PREPARE,this._id=e.id=t.id,td.ServerDelegate.sendMessage(e)},_requestGetCopyInfo:function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.DEMON_TREASURE,0)){var t={};t.module=td.MsgModuleName.DemonTreasure,t.cmd=td.MsgCmd.DemonTreasure.GET_DEMON_TREASURE_INFO,td.ServerDelegate.sendMessage(t)}},_reqestDemonTreasureRankReward:function(){var t={};t.module=td.MsgModuleName.DemonTreasure,t.cmd=td.MsgCmd.DemonTreasure.GET_DEMON_TREASURE_RANK,t.id=this._curCopyId,td.ServerDelegate.sendMessage(t)},_parsePrepare:function(t){t==td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_DEMON_TREASURE_COPY_PREPARE)},_parseCopyInfo:function(t,e){if(t==td.NetCode.SUCCESS){this._haveChallengedTimes=e.challengeTimes,this._haveBoughtTimes=e.buyTimes;for(var i=td.GetTableClass(td.TableEnum.DemonTreasureCopyConfig).getAllCfgData(),n=0;n<i.length;n++){var a=i[n].id,r=new td.DemonTreasureCopyModel;r.init(a),this._copyDataList[a]||(this._copyDataList[a]=r)}td.EventUtil.dispatchEvent(td.EventNameEnum.DEMON_TREASURE_COPY_DATA_CHANGED)}},_requestCopyChallenge:function(t){if(td.GlobalFunction.checkCanClicked()){var e={};e.module=td.MsgModuleName.DemonTreasure,e.cmd=td.MsgCmd.DemonTreasure.DEMON_TREASURE_CHALLENGE,e.id=t.id,e.leftHP=t.leftHP,e.time=t.killTime,e.check=t.check,td.ServerDelegate.sendMessage(e)}},_onChanllengeReturn:function(t,e){if(t==td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.RECEIVE_PVE_FIHGT_REAWRD,n)}else td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PRE_PANEL)},_onGetDemonTreasureRankReward:function(t,e){if(t==td.NetCode.SUCCESS){var i=e.ranks;this._actorRankList=[],i.length>0&&(this._myActorRankInfo=new a,this._myActorRankInfo.init(i[i.length-1]),i.splice(i.length-1,1));for(var n=0,r=i.length;n<r;n++){var o=new a;o.init(i[n]),this._actorRankList[this._actorRankList.length]=o}td.EventUtil.dispatchEvent(td.EventNameEnum.RES_DEMON_TREASURE_RANK_REWARD)}},_reqBuyTimes:function(t){var e={};e.module=td.MsgModuleName.DemonTreasure,e.cmd=td.MsgCmd.DemonTreasure.DEMON_TREASURE_BUY_TIMES,e.times=t.times,td.ServerDelegate.sendMessage(e)},_onBuyTimes:function(t,e){t==td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_DEMON_TREASURE_BUY_TIEMS)},getBoughtTimes:function(){return this._haveBoughtTimes},setCurCopyId:function(t){this._curCopyId=t},getCurCopyId:function(){return this._curCopyId},getActorRankList:function(){return this._actorRankList.sort(function(t,e){return t.getRank()-e.getRank()}),this._actorRankList.slice(0)},getSelfRankData:function(){return this._myActorRankInfo},calNeedPayWithTimes:function(t,e){for(var i,n=td.GlobalFunction,a="DEMON_TREASURE_BUY_TIMES_COST",r=this._haveBoughtTimes,o=1+r;o<=e+r;o++)i?i.setCount(i.getCount()+n.getShareConfigUpCostCount(a,o)):i=n.getShareConfigUpCostDetail(a,o);return i}},cc._RF.pop()},{ActorRankModel:"ActorRankModel",CommonEnum:void 0}],DemonTreasureCopyModel:[function(t,e,i){"use strict";cc._RF.push(e,"cf49duUpG9BfqxoBluRmYKI","DemonTreasureCopyModel");var n=t("CommonEnum"),a=t("EnemyModel"),r=t("Model");td.DemonTreasureCopyModel=cc.Class({extends:r,properties:{_copyId:null,_hp:null,_maxPowerMin:null,_maxPowerMax:null,_index:null,_bossId:null,_gateId:null,_mapIndex:null,_roadIndex:null,_killRewards:null,_challengeRewards:null,_battleTimes:null,_challengeTimes:null,_initTimes:0,_buyTimes:0,_monsterData:null},init:function(t){this._super("DemonTreasureCopyModel"),this._copyId=parseInt(t),this._challengeTimes=0;var e=td.GetTableClass(td.TableEnum.DemonTreasureCopyConfig).getCopyConfigByCopyId(t);this._hp=e.hp,this._maxPowerMax=e.maxPowerMax,this._maxPowerMin=e.maxPowerMin,this._index=e.index,this._bossId=e.bossId,this._gateId=e.gateId,this._mapIndex=e.mapIndex,this._roadIndex=e.roadIndex;var i=e.killRewards;this._killRewards=[];for(var n=0;n<i.length;n++){var r=td.RewardManager.getRewardDetail(i[n]);this._killRewards.push(r)}var o=e.challengeRewards;this._challengeRewards=o,this._battleTimes=e.battleTime;var s=td.GetTableClass(td.TableEnum.PveEnemyTable).getEnemyCfgDataById(this._bossId);s&&(this._monsterData=new a,this._monsterData.init(s)),this._initTimes=td.GetConfig("DEMON_TREASURE_CHALLENGE_FREE_TIMES"),this._buyTimes=0},getCopyId:function(){return this._copyId},getHp:function(){return this._hp},getBossId:function(){return this._bossId},getIndex:function(){return this._index},getGateId:function(){return this._gateId},getMapIndex:function(){return this._mapIndex},getRoadIndex:function(){return this._roadIndex},getMaxPowerMin:function(){return this._maxPowerMin},getMaxPowerMax:function(){return this._maxPowerMax},getKillRewards:function(){return this._killRewards},getChallengeRewards:function(){return this._challengeRewards},getBattleTime:function(){return this._battleTimes},getBossInfo:function(){return this._monsterData},setChallengedTimes:function(t){this._challengeTimes=t},setBoughtTimes:function(t){this._buyTimes=t},getBoughtimes:function(){return this._buyTimes},getChallengeTimes:function(){return this._initTimes+this._buyTimes-this._challengeTimes},getMaxChallengeTimes:function(){return td.PrerogativeManager.getPrerogative(n.PrerogativeEnum.DemonTreasureChallengeTimes).getValue()},isUnLock:function(){var t=td.Account.getUserData().getHistoryHighestPower(),e=td.GetTableClass(td.TableEnum.DemonTreasureCopyConfig).getMaxDifficultCopyData(),i=td.GetTableClass(td.TableEnum.DemonTreasureCopyConfig).getMinDifficultCopyData();return!!(e&&t>=e.maxPowerMin&&e.id===this._copyId)||!(i&&t<i.maxPowerMin)&&(t<=this._maxPowerMax&&t>=this._maxPowerMin)}}),cc._RF.pop()},{CommonEnum:void 0,EnemyModel:"EnemyModel",Model:"Model"}],DemonTreasureRankRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"9c305ysrDJGnJMdM8djJpui","DemonTreasureRankRewardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"DemonTreasureRankConfig",properties:{_tblName:"demon_treasure_rank_config",_data:null},init:function(){this._data=[],this._typeDatas={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;i++){var a=e[i];t[t.length]=a;var r=a.id;this._typeDatas[r]||(this._typeDatas[r]={}),this._typeDatas[r][a.rank]=a}t.sort(function(t,e){return t.rank-e.rank});for(var o=0,s=t.length;o<s;o++){var l=t[o];l.maxRank=l.rank,l.minRank=t[o-1]?t[o-1].rank+1:l.rank}},getListById:function(t){var e=[],i=this._typeDatas[t];for(var n in i)e.push(i[n]);return e.sort(function(t,e){return t.rank-e.rank}),e},getAllRankRewardCfgs:function(){return this._data},getCfgDataByRank:function(t,e){if(this._typeDatas[t]){var i=this._typeDatas[t];for(var n in i){var a=i[n];if(a.minRank<=e&&a.maxRank>=e)return a}}return null},getRewardsByIdAndRank:function(t,e){if(e<=0)return null;var i=this._typeDatas[t];for(var n in i)if(i[n].rank>=e)return i[n];return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DestroyTempleEffectConfig:[function(t,e,i){"use strict";cc._RF.push(e,"36754zWMCRHwI157EACv5su","DestroyTempleEffectConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="DestroyTempleEffectConfig",e._tblName="destroy_temple_effect_config",e._data=[],e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}},e.prototype.getDestroyTempleEffectCfgs=function(){return this._data},e.prototype.getDestroyTempleEffectCfgById=function(t){for(var e=0,i=this._data.length;e<i;e++){var n=this._data[e];if(n.effectId===t)return n}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DestroyTempleEnum:[function(t,e,i){"use strict";cc._RF.push(e,"a1986cP0PBBOZqYF2MavMik","DestroyTempleEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.DestroyTempleRewardType=i.DestroyTempleRankViewType=void 0,i.DestroyTempleRankViewType={RankToday:1,RankYesterday:2,Reward:3},i.DestroyTempleRewardType={First:1,Daily:2},cc._RF.pop()},{}],DestroyTempleManager:[function(t,e,i){"use strict";cc._RF.push(e,"e9a76gohf5HGLdUi1/baSaT","DestroyTempleManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator.ccclass,r=window.td,o=t("DestroyTempleModel"),s=t("DestroyTempleRewardModel"),l=t("ActorRankModel"),c=t("CommonEnum"),u=function(){function t(){this._isSkipBattle=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener()},t.prototype.destroyData=function(){this._infoModel=null,this._rewards={},this._todayRankList=[],this._myRankToday=null,this._isSkipBattle=!1},t.prototype.addListener=function(){var t=r.MsgModuleName.DESTROY_TEMPLE,e=r.MsgCmd.DESTROY_TEMPLE;r.ServerDelegate.registerMessage(t,e.DESTROY_TEMPLE_INFO,this._parseInfo.bind(this)),r.ServerDelegate.registerMessage(t,e.DESTROY_TEMPLE_RESET,this._onResetReturn.bind(this)),r.ServerDelegate.registerMessage(t,e.DESTROY_TEMPLE_SWEEP,this._onSweepReturn.bind(this)),r.ServerDelegate.registerMessage(t,e.DESTROY_TEMPLE_RANK,this._parseRankToday.bind(this)),r.ServerDelegate.registerMessage(t,e.DESTROY_TEMPLE_RECEIVE,this._onReceiveRewards.bind(this)),r.ServerDelegate.registerMessage(t,e.PUSH_DESTROY_TEMPLE_INFO,this._parseInfo.bind(this))},t.prototype.addEventListener=function(){var t=r.EventUtil,e=r.EventNameEnum,i={};i[e.REQ_DESTROY_TEMPLE_INFO]=this._requestInfo,i[e.REQ_DESTROY_TEMPLE_CHALLENGE]=this._requestChallenge,i[e.REQ_DESTROY_TEMPLE_RESET]=this._requestReset,i[e.REQ_DESTROY_TEMPLE_SWEEP]=this._requestSweep,i[e.REQ_DESTROY_TEMPLE_RANK_TODAY]=this._requestRankToday,i[e.REQ_DESTROY_TEMPLE_RECEIVE]=this._requestReceiveReward,i[e.REQ_DESTROY_TEMPLE_INSPIRE]=this._requestInspire,i[e.ON_DESTROY_TEMPLE_SHOWN]=this._onFirstLoginShown,t.registerEvents(i,this)},t.prototype._onFirstLoginShown=function(){r.GlobalFunction.setLocalSaveStatus("DestroyTemple","true")},t.prototype.isRedPointTips=function(){return!!r.UnlockManager.isPanelUnlock(r.PanelEnum.Panel_DestroyTemple)&&(!r.GlobalFunction.getLocalSaveStatus("DestroyTemple")||this.isRewardRedPointTips())},t.prototype.isRewardRedPointTips=function(){if(!this._rewards)return!1;for(var t in this._rewards){var e=this._rewards[t].firstReward;if(e&&e.getRewardStatus()===r.RewardStatus.CAN_RECEIVE)return!0}return!1},t.prototype.redPointEvents=function(){var t=r.EventNameEnum;return[t.USER_ATTR_LEVEL_CHANGE,t.USER_ATTR_VIP_LEVEL_CHANGE,t.RES_DESTROY_TEMPLE_INFO,t.ON_DESTROY_TEMPLE_SHOWN]},t.prototype.getInfoModel=function(){return this._infoModel},t.prototype.getShowMonsters=function(){return this._infoModel?this._infoModel.getShowMonsters():null},t.prototype.getCurFloor=function(){return this._infoModel?this._infoModel.getFloor():0},t.prototype.getMaxFloor=function(){return this._infoModel?this._infoModel.getMaxFloor():0},t.prototype.getHaveResetTimes=function(){return this._infoModel?this._infoModel.getResetTimes():0},t.prototype.getDiffCourage=function(){return this._infoModel?this._infoModel.getDiffCourage():0},t.prototype.isReachMaxFloor=function(){return!!this._infoModel&&this._infoModel.isReachMaxFloor()},t.prototype.getMaxFullStarFloor=function(){return this._infoModel?this._infoModel.getMaxFullStarFloor():0},t.prototype.getLeftFailureTimes=function(){return this._infoModel?this._infoModel.getLeftFailureTimes():0},t.prototype.getShowRewards=function(){return this._rewards},t.prototype.getTodayRankList=function(){return this._todayRankList},t.prototype.getMyRankToday=function(){return this._myRankToday},t.prototype.getNextShowRewardsByFloor=function(t){if(!this._rewards||0===this._rewards.myLen())return null;for(var e in this._rewards){var i=parseInt(e);if(i>=t){var n={};return n.floor=i,n.reward=this._rewards[e],n}}return null},t.prototype.getEffectAddAttributes=function(){var t={};if(!this._infoModel)return t;var e=this._infoModel.getEffectList(),i=r.GetTableClass(r.TableEnum.SpecialAttributeTable);for(var n in e){var a=i.getDataById(n);if(a){var o=void 0,s=void 0,l=e[n],c=a.attributeTTPercent;c&&c[0]&&(o=c[0][0],s=c[0][1]),t[o]||(t[o]=0),t[o]+=s*l}else cc.log("destory temple panel get SpecialAttribute error for id = "+n)}return t},t.prototype.setIsSkipBattle=function(t){this._isSkipBattle=t},t.prototype.getIsSkipBattle=function(){return this._isSkipBattle},t.prototype.getCanResetTimes=function(){var t=r.Account.getUserData().vip,e=r.GetTableClass(r.TableEnum.VipPrivilegeTable).getPrerogativeByTypeAndOpenValue(c.PrerogativeEnum.DestroyTempleResetTimes),i=0;for(var n in e){var a=e[n];if(t<a.privilegeOpenValue)break;i=a.value}return i},t.prototype._requestInfo=function(){var t={};t.module=r.MsgModuleName.DESTROY_TEMPLE,t.cmd=r.MsgCmd.DESTROY_TEMPLE.DESTROY_TEMPLE_INFO,r.ServerDelegate.sendMessage(t)},t.prototype._parseInfo=function(t,e){if(t===r.NetCode.SUCCESS){this._infoModel||(this._infoModel=new o),this._infoModel.init(e),this._rewards&&0!==this._rewards.myLen()||this._initRewards();var i=e.receives,n=this._rewards,a=this._infoModel.getMaxFloor();for(var s in n){var l=n[s].firstReward;if(l){var c=parseInt(s);if(ArrayUtils.contains(i,c))l.setRewardStatus(r.RewardStatus.RECEIVED);else if(a>=c)l.setRewardStatus(r.RewardStatus.CAN_RECEIVE);else if(a<c)break}}r.EventUtil.dispatchEvent(r.EventNameEnum.RES_DESTROY_TEMPLE_INFO)}},t.prototype._requestChallenge=function(t){var e={};e.module=r.MsgModuleName.DESTROY_TEMPLE,e.cmd=r.MsgCmd.DESTROY_TEMPLE.DESTROY_TEMPLE_CHALLENGE,e.floor=t.floor,e.star=t.star,r.ServerDelegate.sendMessage(e)},t.prototype._requestReset=function(){var t={};t.module=r.MsgModuleName.DESTROY_TEMPLE,t.cmd=r.MsgCmd.DESTROY_TEMPLE.DESTROY_TEMPLE_RESET,r.ServerDelegate.sendMessage(t)},t.prototype._onResetReturn=function(t,e){t===r.NetCode.SUCCESS&&r.EventUtil.dispatchEvent(r.EventNameEnum.BUY_TIMES_SUCCESS)},t.prototype._requestSweep=function(){var t={};t.module=r.MsgModuleName.DESTROY_TEMPLE,t.cmd=r.MsgCmd.DESTROY_TEMPLE.DESTROY_TEMPLE_SWEEP,r.ServerDelegate.sendMessage(t)},t.prototype._onSweepReturn=function(t,e){if(t===r.NetCode.SUCCESS){var i=e.rewardResult,n=r.RewardManager.parseRewardResult(i),a=this.getDiffCourage();if(a>0){var o={};o.type=r.GoodsType.Type_Item,o.id=r.ItemEnum.Courage,o.count=a,n.unshift(o)}r.GlobalFunction.showRewards(n),r.EventUtil.dispatchEvent(r.EventNameEnum.RES_DESTROY_TEMPLE_SWEEP)}},t.prototype._requestRankToday=function(t){var e={};e.module=r.MsgModuleName.DESTROY_TEMPLE,e.cmd=r.MsgCmd.DESTROY_TEMPLE.DESTROY_TEMPLE_RANK,e.page=t||1,r.ServerDelegate.sendMessage(e)},t.prototype._parseRankToday=function(t,e){if(t===r.NetCode.SUCCESS){var i=e.ranks;this._myRankToday||(this._myRankToday=new l),this._myRankToday.init(i.pop());var n=this._todayRankList,a=n.length,o=i.length;a>o&&n.splice(o,a-o);for(var s=0;s<o;s++){var c=i[s],u=n[s];u||(u=new l,n[n.length]=u),u.init(c)}r.EventUtil.dispatchEvent(r.EventNameEnum.RES_DESTROY_TEMPLE_RANK_TODAY)}},t.prototype._requestReceiveReward=function(t){var e={};e.module=r.MsgModuleName.DESTROY_TEMPLE,e.cmd=r.MsgCmd.DESTROY_TEMPLE.DESTROY_TEMPLE_RECEIVE,e.floor=t,r.ServerDelegate.sendMessage(e)},t.prototype._onReceiveRewards=function(t,e){if(t===r.NetCode.SUCCESS){var i=r.RewardManager.parseRewardResult(e.rewardResult);r.GlobalFunction.showRewards(i),r.EventUtil.dispatchEvent(r.EventNameEnum.RES_DESTROY_TEMPLE_RECEIVE)}},t.prototype._requestInspire=function(t){var e={};e.module=r.MsgModuleName.DESTROY_TEMPLE,e.cmd=r.MsgCmd.DESTROY_TEMPLE.DESTROY_TEMPLE_EFFECT,e.effectId=t.effectId,e.times=t.times,r.ServerDelegate.sendMessage(e)},t.prototype._initRewards=function(){this._rewards={};var t=r.GetTableClass(r.TableEnum.DestroyTempleTable).getDestroyTempleCfgs();for(var e in t){var i=t[e],n={};if(i.firstRewards&&i.firstRewards.length>0)(u=new s).init(i.firstRewards),n.firstReward=u;if(i.dropRewards&&i.dropRewards.length>0){for(var a=i.dropRewards[0][1],o=[],l=0,c=a.length;l<c;l++)o=o.concat(a[l][0]);var u;(u=new s).init(o),n.dropReward=u}n.myLen()>0&&(this._rewards[e]=n)}},t=e=n([a],t)}();i.default=u,cc._RF.pop()},{ActorRankModel:"ActorRankModel",CommonEnum:void 0,DestroyTempleModel:"DestroyTempleModel",DestroyTempleRewardModel:"DestroyTempleRewardModel"}],DestroyTempleModel:[function(t,e,i){"use strict";cc._RF.push(e,"37311xnojlD/Jx4qwfvFNU7","DestroyTempleModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o},a=window.td,r=cc._decorator.ccclass,o=function(){function t(){this._isReachMax=!1,this._floor=0,this._passedFloor=0,this._maxFloor=0,this._todayMaxFloor=0,this._maxFullStarFloor=0,this._courage=0,this._diffCourage=0,this._failureTimes=0,this._resetTimes=0}return t.prototype.init=function(t){this._passedFloor=t.floor;var e=a.GetTableClass(a.TableEnum.DestroyTempleTable).getMaxConfigFloor(),i=this._passedFloor;this._passedFloor===e?this._isReachMax=!0:(this._isReachMax=!1,i+=1),this._floor!==i&&(this._updateLocalConfig(i),this._floor=i),this._maxFloor=t.maxFloor||0,this._todayMaxFloor=t.todayMaxFloor||0,this._maxFullStarFloor=t.maxFullStarFloor||0;var n=t.courage;this._diffCourage=n-this._courage,this._courage=n,this._effectList={};var r=t.effectIds;for(var o in r){var s=r[o];this._effectList[o]=s}this._failureTimes=t.failureTimes||0,this._resetTimes=t.resetTimes||0},t.prototype._updateLocalConfig=function(t){var e=a.GetTableClass(a.TableEnum.DestroyTempleTable).getDataByFloor(t);if(e){this._showMonsters={};for(var i=e.monsters,n=a.GetTableClass(a.TableEnum.MonsterGroup),r=a.GetTableClass(a.TableEnum.Monster),o=0,s=i.length;o<s;o++){var l=i[o],c=l[0],u=l[1],d=n.getMonsterGroupById(u),h=d.power,p=d.groupLeader,_=r.getMonsterDataById(p);if(_){var g=new a.MonsterModel;g.init(_),g.setFightPower(h),this._showMonsters[c]=g}else cc.log("destroy temple get show monster error for id = "+p)}}else cc.log("get DestroyTempleTable error for floor = "+t)},t.prototype.isReachMaxFloor=function(){return this._isReachMax},t.prototype.getFloor=function(){return this._floor},t.prototype.getShowMonsters=function(){return this._showMonsters},t.prototype.getMaxFloor=function(){return this._maxFloor},t.prototype.getTodayMaxFloor=function(){return this._todayMaxFloor},t.prototype.getMaxFullStarFloor=function(){return this._maxFullStarFloor},t.prototype.getCourage=function(){return this._courage},t.prototype.getDiffCourage=function(){var t=this._diffCourage;return this._diffCourage=0,t},t.prototype.getEffectList=function(){return this._effectList},t.prototype.getLeftFailureTimes=function(){return a.GetConfig("DESTROY_TEMPLE_FAILURE_TIMES")-this._failureTimes},t.prototype.getResetTimes=function(){return this._resetTimes},t=n([r],t)}();e.exports=o,cc._RF.pop()},{}],DestroyTempleRankRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"9efc7emuAZAGbb1c68XRblV","DestroyTempleRankRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="DestroyTempleRankRewardConfig",e._tblName="destroy_temple_rank_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}t.sort(function(t,e){return t.rank-e.rank});for(var r=0,o=t.length;r<o;r++){var s=t[r];s.maxRank=s.rank,s.minRank=t[r-1]?t[r-1].rank+1:s.rank}},e.prototype.getRankRewardConfigs=function(){return this._data},e.prototype.getDataByRank=function(t){if(this._data)for(var e=this._data,i=0,n=e.length;i<n;i++){var a=e[i];if(a.minRank<=t&&a.maxRank>=t)return a}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DestroyTempleRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"dd95f3OTFNODYC9CSbIpIrp","DestroyTempleRewardModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o},a=window.td,r=cc._decorator.ccclass,o=function(){function t(){}return t.prototype.init=function(t){t&&(this._rewards=a.RewardManager.parseRewardListDetail(t),this._rewardStatus=a.RewardStatus.CANNOT_RECEIVE)},t.prototype.getRewards=function(){return this._rewards},t.prototype.setRewardStatus=function(t){this._rewardStatus=t},t.prototype.getRewardStatus=function(){return this._rewardStatus},t=n([r],t)}();e.exports=o,cc._RF.pop()},{}],DestroyTempleTable:[function(t,e,i){"use strict";cc._RF.push(e,"11c42NufwFOrKFnl/IavMM9","DestroyTempleTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="DestroyTempleConfig",e._tblName="destroy_temple_config",e._data={},e._maxFloor=0,e}return n(e,t),e.prototype.init=function(){this._data={};var t=this._data,e=this._jsonData;this._maxFloor=0;for(var i=0,n=0,a=e.length;n<a;++n){var r=e[n],o=r.floor;t[o]=r,i=Math.max(o,i)}this._maxFloor=i},e.prototype.getMaxConfigFloor=function(){return this._maxFloor},e.prototype.getDataByFloor=function(t){return this._data[t]?this._data[t]:null},e.prototype.getDestroyTempleCfgs=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DiBao:[function(t,e,i){"use strict";cc._RF.push(e,"ca5f4fDLwBNpKoZJBBD7Nmd","DiBao");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="DiBao"}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],DiamondRebateController:[function(t,e,i){"use strict";cc._RF.push(e,"4781bLZ/XdMnIctGYXCz5NR","DiamondRebateController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("ActivityBaseController"),r=t("./DiamondRebateModel"),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._modelArray=[],e._isInited=!1,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this._modelArray=[]},e.prototype.onOpenPanel=function(){this._isPanelOpened=!0,td.GlobalFunction.setLocalSaveStatus("DiamondRebatePanel","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.DIAMONDREBATE_PANEL_SHOW)},e.prototype.isShowedToday=function(){return td.GlobalFunction.getLocalSaveStatus("DiamondRebatePanel")},e.prototype._initDataModel=function(){for(var t=this.getActivityData(),e=td.GetTableClass(td.TableEnum.ActivityDiamondRebateConfig).getDatasByDataId(t),i=0;i<e.length;i++){var n=e[i],a=new r.default;a.initData(n),this._modelArray.push(a)}this._isInited=!0},e.prototype.activityParse=function(t){this._isInited||this._initDataModel();var e=t.record.products;if(e)for(var i in e){var n=e[i];this.getModelById(parseInt(i)).setData(n)}},e.prototype.getModelById=function(t){for(var e=0;e<this._modelArray.length;e++){var i=this._modelArray[e];if(i.getId()==t)return i}},e.prototype.getDataArray=function(){return this._modelArray},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){if(this.isShowedToday())return!1;for(var t=0;t<this._modelArray.length;t++){if(this._modelArray[t].getStatus()==td.ActivityEnum.OperateStatus.OperateAble)return!0}return!1},e.prototype.redPointEvts=function(){return[td.EventNameEnum.DIAMONDREBATE_PANEL_SHOW,td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,td.EventNameEnum.Recharge_Success,td.EventNameEnum.ON_ACTIVITY_OPEN,td.EventNameEnum.ON_ACTIVITY_CLOSED,td.EventNameEnum.ACTIVITY_CLICKED,td.EventNameEnum.PUSH_ACTIVITY_INFO,td.EventNameEnum.Res_GET_ACTIVITY_INFO]},e}(a);i.default=o,e.exports=o,cc._RF.pop()},{"./DiamondRebateModel":"DiamondRebateModel",ActivityBaseController:"ActivityBaseController"}],DiamondRebateItem:[function(t,e,i){"use strict";cc._RF.push(e,"d9101OdgixMSbgNtmhC4zI5","DiamondRebateItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labCondition0=null,e.labCondition1=null,e.labPro0=null,e.labPro1=null,e.layReward=null,e.btnBuy=null,e.imgFinished=null,e.imgNotAchieve=null,e.labLimit=null,e.labLeft=null,e._DRModel=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._DRModel=i;var n=i.getTask()[0],a=i.getTask()[1];this.labCondition0.string=n?n.getDes():"",this.labCondition1.string=a?a.getDes():"",this.labPro0.string=n?n.getValue()+"/"+n.getNeedValue():"",this.labPro1.string=a?a.getValue()+"/"+a.getNeedValue():"",this.labPro0.node.color=n.getValue()<n.getNeedValue()?cc.color(199,0,0):cc.color(2,149,5),this.labPro1.node.color=a.getValue()<a.getNeedValue()?cc.color(199,0,0):cc.color(2,149,5),this.labLimit.string=c.Language.leftTimes,this.labLeft.string=(i.getMaxCount()-i.getCount()).toString();var r=i.getCost();this.btnBuy.getChildByName("labPrice").getComponent(cc.Label).string=r[2]+c.Language.diamond;var o=i.getStatus();this.imgNotAchieve.active=o==c.ActivityEnum.OperateStatus.NotOperateAble,this.btnBuy.active=o==c.ActivityEnum.OperateStatus.OperateAble,this.imgFinished.active=o==c.ActivityEnum.OperateStatus.Operated,this.labLimit.node.active=o==c.ActivityEnum.OperateStatus.OperateAble,this.labLeft.node.active=o==c.ActivityEnum.OperateStatus.OperateAble;for(var s=i.getRewards(),l=0;l<s.length;l++){var u=s[l],d=this.layReward.getChildByName("itemIcon"+l);d?d.getComponent("CommonIconWidget").setData(u):((d=c.GlobalFunction.createCommonIconWidget(26,u)).name="itemIcon"+l,d.setScale(.8),this.layReward.addChild(d))}this.layReward.getComponent(cc.Layout).updateLayout()},e.prototype.onExchangeClick=function(){var t={id:this._DRModel.getId()};c.ActivityDataManager.getActivityControllerByType(c.ActivityEnum.ActivityType.DiamondRebate).operateActivity(t)},a([s(cc.Label)],e.prototype,"labCondition0",void 0),a([s(cc.Label)],e.prototype,"labCondition1",void 0),a([s(cc.Label)],e.prototype,"labPro0",void 0),a([s(cc.Label)],e.prototype,"labPro1",void 0),a([s(cc.Node)],e.prototype,"layReward",void 0),a([s(cc.Node)],e.prototype,"btnBuy",void 0),a([s(cc.Node)],e.prototype,"imgFinished",void 0),a([s(cc.Node)],e.prototype,"imgNotAchieve",void 0),a([s(cc.Label)],e.prototype,"labLimit",void 0),a([s(cc.Label)],e.prototype,"labLeft",void 0),e=a([o,l("module/Activity/DiamondRebateItem")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],DiamondRebateModel:[function(t,e,i){"use strict";cc._RF.push(e,"fdc482626dN55pz0KNMCHm/","DiamondRebateModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._dataId=null,this._id=null,this._unlockId=[],this._maxCount=0,this._cost=[],this._rewards=[],this._count=0}return t.prototype.initData=function(t){this._dataId=t.data,this._id=t.id,this._unlockId=t.unlockId,this._maxCount=t.count,this._cost=t.cost,this._rewards=td.RewardManager.parseRewardListDetail(t.rewards)},t.prototype.setData=function(t){this._count=t},t.prototype.getUnlockId=function(){return this._unlockId},t.prototype.getMaxCount=function(){return this._maxCount},t.prototype.getCost=function(){return this._cost},t.prototype.getRewards=function(){return this._rewards},t.prototype.getId=function(){return this._id},t.prototype.getCount=function(){return this._count},t.prototype.getStatus=function(){return this.isUnlock()?this._count>=this._maxCount?td.ActivityEnum.OperateStatus.Operated:td.ActivityEnum.OperateStatus.OperateAble:td.ActivityEnum.OperateStatus.NotOperateAble},t.prototype.getTask=function(){for(var t=[],e=td.UnlockManager.getUnlockConfigById(this._unlockId).getCondition(),i=0;i<e.length;i++){var n=e[i],a=td.TaskManager.getTaskById(n.value);t.push(a)}return t},t.prototype.isUnlock=function(){return td.UnlockManager.isTargetUnlockById(this._unlockId,!1)},t}();i.default=n,cc._RF.pop()},{}],DiamondRebatePanel:[function(t,e,i){"use strict";cc._RF.push(e,"28db4zxJTFOTLenffBIZaoT","DiamondRebatePanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTime=null,e.scrollView=null,e._activityId=0,e._activityType=0,e._controller=null,e._isInit=!1,e}return n(e,t),e.prototype.init=function(){this._panelType=c.PanelType.Panel,this._panelEnum=c.PanelEnum.Panel_DiamondRebate},e.prototype.initData=function(e){t.prototype.initData.call(this,e),this._activityId=e,this._controller=c.ActivityDataManager.getActivityControllerById(e),this._activityType=this._controller.getActivityType()},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._isInit=!0,this._addEventListener(),this._controller.onOpenPanel(),this._refreshList()},e.prototype.onDisable=function(){c.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){},e.prototype._refreshList=function(){if(this._controller){this.labTime.string=this.getOpenEndTimeStr();var t=this._controller.getDataArray();t.sort(function(t,e){return t.getStatus()==e.getStatus()?t.getId()-e.getId():t.getStatus()==c.ActivityEnum.OperateStatus.OperateAble?-1:e.getStatus()==c.ActivityEnum.OperateStatus.OperateAble?1:t.getStatus()==c.ActivityEnum.OperateStatus.NotOperateAble?-1:e.getStatus()==c.ActivityEnum.OperateStatus.NotOperateAble?1:t.getStatus()==c.ActivityEnum.OperateStatus.Operated?-1:e.getStatus()==c.ActivityEnum.OperateStatus.Operated?1:void 0});var e=this.scrollView.getComponent("OptimizeVerticalListView");this._isInit?(this._isInit=!1,e.setData(t)):e.refreshCurList(t)}},e.prototype.onReceiveOperation=function(e){t.prototype.onReceiveOperation.call(this,e),this._refreshList()},e.prototype.getOpenEndTimeStr=function(){var t=this._controller.getCurrentOpenStage();if(t&&this.checkIsOpen(!0)){var e=t.openTime,i=new Date(e),n=t.closeTime,a=new Date(n),r=c.Language.timePattern5,o=i.pattern(r),s=a.pattern(r);return cc.js.formatStr(c.Language.activityTimeTip,o,s)}},a([s(cc.Label)],e.prototype,"labTime",void 0),a([s(cc.Node)],e.prototype,"scrollView",void 0),e=a([o,l("module/Activity/DiamondRebatePanel")],e)}(t("ActivityBasePanel"));i.default=u,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],DipperDifficultConfig:[function(t,e,i){"use strict";cc._RF.push(e,"4cc7ay/cpREma5mTz+s1Cmv","DipperDifficultConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="DipperDifficultConfig",e._tblName="dipper_difficult_config",e._data={},e._maxLevel=0,e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.level;this._maxLevel=Math.max(this._maxLevel,r),t[r]=a.hpTimes}},e.prototype.getHpTimesByLevel=function(t){return this._data&&this._data[t]?this._data[t]:this._data?this._data[this._maxLevel]:void 0},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DipperManager:[function(t,e,i){"use strict";cc._RF.push(e,"048d6jWNJ1B1rOWj/nthlUn","DipperManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this._totalScore=0,this._curPassedId=0,this._fightId=0,this._maxChallengeTimes=0,this._curSweepId=0,this._challengeLevel=0,this._receivedRewardIDs=[]}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},e.prototype.destroyData=function(){this._totalScore=0,this._curPassedId=0,this._maxChallengeTimes=0,this._challengeLevel=0,this._curSweepId=0,this._storyList={},this._isInit=!1},e.prototype.addListener=function(){var t=td.MsgModuleName.Dipper,e=td.MsgCmd.Dipper,i=td.ServerDelegate;i.registerMessage(t,e.DIPPER_GET_INFO,this._parseDipperInfo.bind(this)),i.registerMessage(t,e.DIPPER_PREPARE,this._parsePrepare.bind(this)),i.registerMessage(t,e.DIPPER_CHALLENGE,this._parseChallenge.bind(this)),i.registerMessage(t,e.DIPPER_SWEEP,this._parseSweep.bind(this)),i.registerMessage(t,e.DIPPER_REWARD_RECEIVE,this._onGetReward.bind(this)),i.registerMessage(t,e.PUSH_DIPPER_INFO,this._parseDipperInfo.bind(this))},e.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.REQ_GET_DIPPER_INFO]=this._requestGetDipperInfo,e[t.REQ_DIPPER_PREPARE]=this._reqPrepare,e[t.REQ_DIPPER_CHALLENGE]=this._reqChallenge,e[t.REQ_DIPPER_SWEEP]=this._reqSweep,e[t.REQ_DIPPER_GET_REWARD]=this._reqGetReward,td.EventUtil.registerEvents(e,this)},e.prototype.isRedPointTips=function(){if(!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Dipper))return!1;if(!this._storyList||0===this._storyList.myLen())return!1;var t=this.getMaxChallengeTimes(),e=this.getUnlockStoryId(),i=this._storyList[e].getChallengedTimes(),n=this.getChallengeCost(i+1);if(i<t&&n&&0==n.getCount())return!0;var a=this.getCanReceivedMinReward();if(a!=this.getCanReceivedMinReward()){var r=this.getTotalScore()>=a.score,o=this.isRewardReceived(a.id);if(r&&!o)return!0}return!1},e.prototype.redPointEvents=function(){var t=td.EventNameEnum;return[t.USER_ATTR_LEVEL_CHANGE,t.RES_GET_DIPPER_INFO]},e.prototype.isInit=function(){return this._isInit},e.prototype.getStoryList=function(){return this._storyList},e.prototype.getStoryById=function(t){return this._storyList&&this._storyList[t]?this._storyList[t]:null},e.prototype.getTotalScore=function(){return this._totalScore},e.prototype.getChallengeLevel=function(){return this._challengeLevel},e.prototype.getUnlockStoryId=function(){var t=td.TimeUtil.getServerDate().getDay();return t||7},e.prototype.getCurPassedId=function(){return this._curPassedId},e.prototype.getFightId=function(){var t=this._fightId;return this._fightId=0,t},e.prototype.isRewardReceived=function(t){return!!ArrayUtils.contains(this._receivedRewardIDs,t)},e.prototype.getCanReceivedMinReward=function(){var t=td.GetTableClass(td.TableEnum.DipperScoreRewardConfig).getMinScoreConfig(),e=t.score;if(this.getTotalScore()<e)return t;for(var i=td.GetTableClass(td.TableEnum.DipperScoreRewardConfig).getScoreRewards(),n=!1,a=0;a<i.length;a++){var r=i[a];this.isRewardReceived(r.id)||(e=r.score,t=r,n=!0)}return n?t:td.GetTableClass(td.TableEnum.DipperScoreRewardConfig).getMaxScoreConfig()},e.prototype.getMaxChallengeTimes=function(){if(!this._maxChallengeTimes){var t=td.GetConfig("DIPPER_CHALLENGE_COST");if(!t)return 0;this._maxChallengeTimes=t[t.length-1][0]}return this._maxChallengeTimes},e.prototype.getChallengeCost=function(t){var e=td.GetConfig("DIPPER_CHALLENGE_COST");if(!e)return null;for(var i=0,n=e.length;i<n;i++){if(t===e[i][0])return e[i][1]&&e[i][1].length>0?td.RewardManager.getRewardDetail(e[i][1]):null}},e.prototype.setCurSweepId=function(t){this._curSweepId=t},e.prototype._requestGetDipperInfo=function(){var t={};t.module=td.MsgModuleName.Dipper,t.cmd=td.MsgCmd.Dipper.DIPPER_GET_INFO,td.ServerDelegate.sendMessage(t)},e.prototype._parseDipperInfo=function(t,e){if(t===td.NetCode.SUCCESS){this._totalScore=e.totalScore,this._challengeLevel=e.actorLevel,this._storyList&&0!==this._storyList.myLen()||this._initStoryList(),this._curPassedId=0;var i=e.entityMap;if(i&&i.myLen()>0)for(var n in i){var a=i[n];(r=this._storyList[n])&&(this._curPassedId=Math.max(this._curPassedId,a.storyId),r.updateServerData(a))}else for(var n in this._storyList){var r;(r=this._storyList[n]).resetServerData()}this._receivedRewardIDs=e.receiveList,this._isInit=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.RES_GET_DIPPER_INFO)}},e.prototype._reqPrepare=function(t){var e={};e.module=td.MsgModuleName.Dipper,e.cmd=td.MsgCmd.Dipper.DIPPER_PREPARE,e.id=t,this._storyList[t]&&this._storyList[t].getChallengedTimes()>0&&(this._fightId=t),td.ServerDelegate.sendMessage(e)},e.prototype._parsePrepare=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_DIPPER_PREPARE)},e.prototype._reqChallenge=function(t){var e={};e.module=td.MsgModuleName.Dipper,e.cmd=td.MsgCmd.Dipper.DIPPER_CHALLENGE,e.id=t.id,e.blood=t.score,e.check=t.check,td.ServerDelegate.sendMessage(e)},e.prototype._parseChallenge=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.RECEIVE_PVE_FIHGT_REAWRD,n)}else td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PRE_PANEL)},e.prototype._reqSweep=function(t){var e={};e.module=td.MsgModuleName.Dipper,e.cmd=td.MsgCmd.Dipper.DIPPER_SWEEP,e.id=t,this.setCurSweepId(t),td.ServerDelegate.sendMessage(e)},e.prototype._parseSweep=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i),a=this.getStoryById(this._curSweepId),r=td.Language.getDiamondTitle+td.Language.score+":"+a.getMaxScore();td.GlobalFunction.showRewards(n,!1,r)}},e.prototype._reqGetReward=function(t){var e={};e.module=td.MsgModuleName.Dipper,e.cmd=td.MsgCmd.Dipper.DIPPER_REWARD_RECEIVE,e.id=t,td.ServerDelegate.sendMessage(e)},e.prototype._onGetReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.GlobalFunction.showRewards(n)}},e.prototype._initStoryList=function(){this._storyList={};for(var e=t("DipperStoryModel"),i=td.GetTableClass(td.TableEnum.DipperStoryConfig).getDipperStoryConfigs(),n=0,a=i.length;n<a;n++){var r=i[n],o=new e;o.init(r),this._storyList[o.getId()]=o}},e}();i.default=n,cc._RF.pop()},{DipperStoryModel:"DipperStoryModel"}],DipperScoreRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"16053cy6kdJ3LTMHoXLzdd6","DipperScoreRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("../Manager/DipperManager"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="DipperScoreRewardConfig",e._tblName="dipper_score_reward_config",e._data=[],e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}t.sort(function(t,e){return e.score-t.score})},e.prototype.getMinScore=function(){return this._data.length>0?this._data[this._data.length-1].score:0},e.prototype.getMinScoreConfig=function(){return this._data.length>0?this._data[this._data.length-1]:null},e.prototype.getMaxScoreConfig=function(){return this._data.length>0?this._data[0]:null},e.prototype.getScoreRewards=function(){for(var t=[],e=[],i=a.default.getInstance().getChallengeLevel(),n=0,r=this._data.length;n<r;n++){for(var o=this._data[n],s=o.rewards,l={id:o.id,score:o.score},c=0,u=0;u<s.length;u++){var d=s[u],h=d[0],p=d[1];h>=c&&i>=h&&(c=h,l.rewards=p)}i>=c&&!ArrayUtils.contains(e,o.score)&&(t.push(l),e.push(o.score))}return t},e.prototype.getRewardsByScore=function(t){var e=this.getScoreRewards();if(!e||0===e.length)return{};for(var i=0,n=e.length;i<n;i++){var a=e[i];if(t>=a.score)return{index:i,rewards:a.rewards}}return{}},e}(t("BaseTable"));e.exports=r,cc._RF.pop()},{"../Manager/DipperManager":"DipperManager",BaseTable:"BaseTable"}],DipperStoryConfig:[function(t,e,i){"use strict";cc._RF.push(e,"bcc9dsOEs1J9JeElUo94NY9","DipperStoryConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="DipperStoryConfig",e._tblName="dipper_story_config",e._data=[],e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}},e.prototype.getDipperStoryConfigs=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DipperStoryModel:[function(t,e,i){"use strict";cc._RF.push(e,"f0b4agJxsVHN6lCRRg+99bo","DipperStoryModel");var n=window.td,a=function(){function t(){this._id=0,this._score=0,this._gateId=0,this._mapIndex=0,this._roadIndex=0,this._maxScore=0,this._challengedTimes=0}return t.prototype.init=function(t){var e=this;t&&(this._id=t.id,this._score=t.score||0,this._gateId=t.gateId,this._mapIndex=t.mapIndex,this._roadIndex=t.roadIndex,this._rewards={},t.reward.forEach(function(t){e._rewards[t[0]]=n.RewardManager.parseRewardListDetail(t[1])}),this._passRewards={},t.passReward.forEach(function(t){e._passRewards[t[0]]=n.RewardManager.parseRewardListDetail(t[1])}))},t.prototype.updateServerData=function(t){this._maxScore=t.maxScore,this._challengedTimes=t.challengeTimes},t.prototype.resetServerData=function(){this._maxScore=0,this._challengedTimes=0},t.prototype.getId=function(){return this._id},t.prototype.getScore=function(){return this._score},t.prototype.getGateId=function(){return this._gateId},t.prototype.getMapIndex=function(){return this._mapIndex},t.prototype.getRoadIndex=function(){return this._roadIndex},t.prototype.getRewards=function(t){var e;for(var i in this._rewards){if(!(t>=i))return e;e=this._rewards[i]}return e},t.prototype.getPassRewards=function(t){var e;for(var i in this._passRewards){if(!(t>=i))return e;e=this._passRewards[i]}return e},t.prototype.getMaxScore=function(){return this._maxScore},t.prototype.getChallengedTimes=function(){return this._challengedTimes},t}();e.exports=a,cc._RF.pop()},{}],DivinePosHelper:[function(t,e,i){"use strict";cc._RF.push(e,"efe69ZJDAhMlpcHFtgEPwNC","DivinePosHelper"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("./DivinePositionManager"),a=t("../Enum/DivinePositionEnum"),r=function(){function t(){}return t.setDivinePosLab=function(t,e,i,r){if(void 0===i&&(i=a.DivineColorType.MAIN),void 0===r&&(r=1),t){var o=n.default.getInstance().getDivineCfgByLv(e);if(o){var s=[],l=[];i==a.DivineColorType.MAIN?(s=a.DivineColors,l=a.DivineStrokeColors):i==a.DivineColorType.CHANGE?(s=a.DivineColors1,l=a.DivineStrokeColors1):i==a.DivineColorType.ARENE&&(s=a.DivineColors2,l=a.DivineStrokeColors2),t.string=1==r?o.name:o.name_1,t.node.color=(new cc.Color).fromHEX(s[o.quality||0]),t.getComponent(cc.LabelOutline)&&(t.getComponent(cc.LabelOutline).color=(new cc.Color).fromHEX(l[o.quality])),this._showUIAni(t.node)}else t.string="",t.node.removeAllChildren(),t.node.width=0;t._forceUpdateRenderData()}},t._showUIAni=function(t,e){void 0===e&&(e=1);var i=t.getChildByName("chAni");if(i)this._refreshAniNode(t,i);else{var n=td.GlobalFunction.getResIdByNode(t);gdk.rm.loadRes(n,"uiAnima/CH_UI/CH_mengban",cc.Prefab,this._addUIAni.bind(this,t,e))}},t._addUIAni=function(t,e){void 0===e&&(e=1);var i=gdk.rm.getResByUrl("uiAnima/CH_UI/CH_mengban",cc.Prefab),n=cc.instantiate(i);n.name="chAni",t.addChild(n,1),n.scale=e,this._refreshAniNode(t,n)},t._refreshAniNode=function(t,e){var i=t.anchorX,n=t.width,a=t.height;0==i&&(e.x=n/2);var r=n/120,o=a/32;e.scaleX=r,e.scaleY=o},t.setDivineRankImgRes=function(t,e){if(t&&e){var i=e.quality;i<=0?i=1:i>=6&&(i=5);var n="XW02_ch_bg0"+i;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.XW02_xianwei02,n,t)}},t}();i.default=r,cc._RF.pop()},{"../Enum/DivinePositionEnum":"DivinePositionEnum","./DivinePositionManager":"DivinePositionManager"}],DivinePosHeroModel:[function(t,e,i){"use strict";cc._RF.push(e,"8e7c8VlR5tAEY94xTjd51Xy","DivinePosHeroModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._order=0,this._fight=0,this._needFight=0,this._heroData=null,this._isReach=!1}return t.prototype.init=function(t,e,i){this._order=t,this._needFight=e,i&&(this._fight=td.BattleArrayManager.getFightPowerByIndex(i.getOrderId()),this._heroData=td.BattleArrayManager.getBattleHeroByIndex(i.getOrderId())),this._isReach=this._fight>=this._needFight},t.prototype.getOrder=function(){return this._order},t.prototype.getFight=function(){return this._fight},t.prototype.getNeedFight=function(){return this._needFight},t.prototype.getHeroData=function(){return this._heroData},t.prototype.isReached=function(){return this._isReach},t}();i.default=n,cc._RF.pop()},{}],DivinePositionConfig:[function(t,e,i){"use strict";cc._RF.push(e,"22a71UN6GJFVomisbNgfBhD","DivinePositionConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="DivinePositionConfig",e._tblName="divine_position_level_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.level]=a}},e.prototype.getCfgByLv=function(t){return this._data?this._data[t]:null},e.prototype.getAllCfg=function(){return this._data},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DivinePositionEnum:[function(t,e,i){"use strict";var n,a,r,o,s,l;cc._RF.push(e,"07f81PTRh1CFKeIN6DnXgO/","DivinePositionEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.DivineStrokeColors2=i.DivineColors2=i.DivineStrokeColors1=i.DivineColors1=i.DivineStrokeColors=i.DivineColors=i.DivineColorType=void 0,function(t){t[t.MAIN=1]="MAIN",t[t.CHANGE=2]="CHANGE",t[t.ARENE=3]="ARENE"}(i.DivineColorType||(i.DivineColorType={})),i.DivineColors=((n={})[0]="#ffffff",n[1]="#00ff2a",n[2]="#00e4ff",n[3]="#ff1af2",n[4]="#ffa800",n[5]="#ff1111",n[6]="#fff600",n),i.DivineStrokeColors=((a={})[0]="#353535",a[1]="#006215",a[2]="#03437e",a[3]="#69006d",a[4]="#732b00",a[5]="#630500",a[6]="#804b00",a),i.DivineColors1=((r={})[0]="#ffffff",r[1]="#00ff2a",r[2]="#00e4ff",r[3]="#ff1af2",r[4]="#ffa800",r[5]="#ff1111",r[6]="#fff600",r),i.DivineStrokeColors1=((o={})[0]="#353535",o[1]="#006215",o[2]="#03437e",o[3]="#69006d",o[4]="#732b00",o[5]="#630500",o[6]="#804b00",o),i.DivineColors2=((s={})[0]="#ffffff",s[1]="#00ff2a",s[2]="#00e4ff",s[3]="#ff1af2",s[4]="#ffa800",s[5]="#ff1111",s[6]="#fff600",s),i.DivineStrokeColors2=((l={})[0]="#353535",l[1]="#006215",l[2]="#03437e",l[3]="#69006d",l[4]="#732b00",l[5]="#630500",l[6]="#804b00",l),cc._RF.pop()},{}],DivinePositionManager:[function(t,e,i){"use strict";cc._RF.push(e,"e8fd9rj0UhNRqy5XquiE19g","DivinePositionManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Model/DivinePosHeroModel"),a=function(){function t(){this._lastLevel=0,this._level=0,this._maxLevel=0,this._fightHerosMap={}}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.destroyData(),this.addListener(),this.addEventListener(),this.initData()},t.prototype.initData=function(){td.DIV_POS=this},t.prototype.destroyData=function(){this._lastLevel=0,this._level=0,this._maxLevel=0,this._fightHerosMap={}},t.prototype.addListener=function(){var t=td.ServerDelegate,e=td.MsgModuleName.DIVINE_POSITION,i=td.MsgCmd.DIVINE_POSITION;t.registerMessage(e,i.DIVINE_POSITION_GET_INFO,this._onGetInfo.bind(this)),t.registerMessage(e,i.DIVINE_POSITION_PROMOTE,this._onGetPromote.bind(this)),t.registerMessage(e,i.DIVINE_POSITION_RANK,this._onGetRank.bind(this)),t.registerMessage(e,i.DIVINE_POSITION_LEVEL_SYNCHRONIZATION_INFO,this._onGetSync.bind(this)),t.registerMessage(e,i.PUSH_IMMORTAL_INFO,this._onGetPushInfo.bind(this))},t.prototype.addEventListener=function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQ_DIVINE_POS_GET_INFO]=this._reqGetInfo,i[e.REQ_DIVINE_POS_PROMOTE]=this._reqPromote,i[e.REQ_DIVINE_POS_GET_RANK]=this._reqRank,i[e.REQ_DIVINE_POS_INFO_SYNC]=this._reqInfoSync,i[e.USER_ATTR_LEVEL_CHANGE]=this._reqGetInfo,t.registerEvents(i,this)},t.prototype._reqGetInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.DIVINE_POSITION,0)){var t={};t.module=td.MsgModuleName.DIVINE_POSITION,t.cmd=td.MsgCmd.DIVINE_POSITION.DIVINE_POSITION_GET_INFO,td.ServerDelegate.sendMessage(t)}},t.prototype._onGetInfo=function(t,e){t===td.NetCode.SUCCESS&&(this._lastLevel=e.lastLevel,this._level=e.level,this._maxLevel=e.maxLevel,td.EventUtil.dispatchEvent(td.EventNameEnum.ON_GET_DIV_POS_INFO))},t.prototype._reqPromote=function(){var t={};t.module=td.MsgModuleName.DIVINE_POSITION,t.cmd=td.MsgCmd.DIVINE_POSITION.DIVINE_POSITION_PROMOTE,td.ServerDelegate.sendMessage(t)},t.prototype._onGetPromote=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_GET_PROMOTE)},t.prototype._reqRank=function(t){var e={};e.module=td.MsgModuleName.DIVINE_POSITION,e.cmd=td.MsgCmd.DIVINE_POSITION.DIVINE_POSITION_RANK,e.page=t,td.ServerDelegate.sendMessage(e)},t.prototype._onGetRank=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_GET_DIV_POS_GET_RANK,[t,e])},t.prototype._reqInfoSync=function(){var t={};t.module=td.MsgModuleName.DIVINE_POSITION,t.cmd=td.MsgCmd.DIVINE_POSITION.DIVINE_POSITION_LEVEL_SYNCHRONIZATION_INFO,td.ServerDelegate.sendMessage(t)},t.prototype._onGetSync=function(t,e){t===td.NetCode.SUCCESS&&(this._lastLevel=e.lastLevel,this._level=e.level,this._maxLevel=e.maxLevel,td.EventUtil.dispatchEvent(td.EventNameEnum.ON_GET_DIV_POS_INFO_SYNC))},t.prototype._onGetPushInfo=function(t,e){t===td.NetCode.SUCCESS&&this._onGetInfo(t,e)},t.prototype.getHeroDetails=function(){for(var t=this.getConditionNeedFight(),e=[],i=0;i<td.MaxEnum.MaxBattleHeroCount;i++){var a=i+1,r=td.BattleArrayManager.getBattleEntityByIndex(a),o=new n.default;o.init(a,t,r),e.push(o)}return e},t.prototype.getFightReachHeroNum=function(){for(var t=this.getConditionNeedFight(),e=0,i=0;i<td.MaxEnum.MaxBattleHeroCount;i++){var n=i+1;if(td.BattleArrayManager.getBattleEntityByIndex(n))td.BattleArrayManager.getFightPowerByIndex(n)>=t&&e++}return e},t.prototype.getConditionNeedNum=function(){var t=this.getCurDivineCfg();return t&&t.condition&&t.condition.length>0?t.condition[0][0]:0},t.prototype.getConditionNeedFight=function(){var t=this.getCurDivineCfg();return t&&t.condition&&t.condition.length>0?t.condition[0][1]:0},t.prototype.getConditionNeedPlayerLv=function(){var t=this.getCurDivineCfg();return t&&t.limitLevel?t.limitLevel:1},t.prototype.getCurDivineCfg=function(){return this.getDivineCfgByLv(this._level)},t.prototype.getDivineCfgByLv=function(t){return td.GetTableClass(td.TableEnum.DivinePositionConfig).getCfgByLv(t)},t.prototype.getCurDivPosAttr=function(){if(!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.DIVINE_POSITION,0))return{};for(var t=this.getDivineAttrByLv(this._maxLevel),e={},i=0;t&&i<t.length;i++){var n=t[i],a=n[0],r=n[1];e[a]?e[a]+=r:e[a]=r}return e},t.prototype.getDivineAttrByLv=function(t){var e=this.getDivineCfgByLv(t);return e?e.attributes:null},t.prototype.getPvpAddedByLv=function(t){var e=this.getDivineCfgByLv(t);return e?e.confrontationLevel:0},t.prototype.getCostsByLv=function(t){var e=this.getDivineCfgByLv(t);if(!e)return[];var i=e.cost;return td.RewardManager.parseRewardListDetail(i)},t.prototype.getDivinePreviewCfgs=function(){var t=td.GetTableClass(td.TableEnum.DivinePositionConfig);if(!t)return[];var e=t.getAllCfg(),i=[],n=this._maxLevel+1;for(var a in e){var r=e[a];r.level<=n&&i.push(r)}return i.sort(function(t,e){return t.level-e.level}),i},t.prototype.isMaxCfgDivinePos=function(){var t=this.getDivineCfgByLv(this.getLevel());return!(t&&t.condition&&t.condition.length>0)},t.prototype.isCurMaxLv=function(){return this._level==this._maxLevel},t.prototype.getDivineNameByLv=function(t){var e=this.getDivineCfgByLv(t);return e?e.name:""},t.prototype.getDivineName1ByLv=function(t){var e=this.getDivineCfgByLv(t);return e?e.name_1:""},t.prototype.getLevel=function(){return this._level},t.prototype.getLastLv=function(){return this._lastLevel},t.prototype.getMaxLv=function(){return this._maxLevel},t.prototype._isFuncUnlock=function(){return!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.DIVINE_POSITION,0)},t.prototype.isFightPowerReach=function(){var t=this.getConditionNeedNum();return this.getFightReachHeroNum()>=t},t.prototype.isUpgradeCostReach=function(){for(var t=this.getCostsByLv(this.getLevel()),e=0;e<t.length;e++){var i=t[e],n=td.ItemManager.getItemNumById(i.getId());if(i.getCount()>n)return!1}return!0},t.prototype.isPlayerLvReach=function(){return td.Account.getUserData().getLevel()>=this.getConditionNeedPlayerLv()},t.prototype.isCanUpgrade=function(){return!this.isMaxCfgDivinePos()&&this.isFightPowerReach()&&this.isUpgradeCostReach()&&this.isPlayerLvReach()},t.prototype.isRedPointTips=function(){return this._isFuncUnlock()&&this.isCanUpgrade()},t.prototype.redPointEvents=function(){return[td.EventNameEnum.ON_GET_DIV_POS_INFO,td.EventNameEnum.USER_ATTR_FIGHT_POWER_CHANGE,td.EventNameEnum.ITEM_CHANGE,td.EventNameEnum.USER_ATTR_GOLD_CHANGE,td.EventNameEnum.USER_ATTR_DIAMOND_CHANGE]},t}();i.default=a,cc._RF.pop()},{"../Model/DivinePosHeroModel":"DivinePosHeroModel"}],Double11Enum:[function(t,e,i){"use strict";cc._RF.push(e,"6e95eQ/jt1GN5Zk0A4zDgA3","Double11Enum"),Object.defineProperty(i,"__esModule",{value:!0}),i.KILL_DATA_STAGE=void 0,function(t){t[t.OPENING=1]="OPENING",t[t.PASSED=2]="PASSED",t[t.ISCOMMING=3]="ISCOMMING"}(i.KILL_DATA_STAGE||(i.KILL_DATA_STAGE={})),cc._RF.pop()},{}],Double11ExchangeController:[function(t,e,i){"use strict";cc._RF.push(e,"0517eDFv+1FnrqxtD1o/UbM","Double11ExchangeController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("./Double11ExchangeItemModel"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this.clearData()},e.prototype.clearData=function(){this._modelList=[],this._receiveMap={},this._modelObj={},this._enoughList=[]},e.prototype.getModelList=function(){return this._modelList.sort(this.sortByTimes.bind(this)),this._modelList},e.prototype.sortByTimes=function(t,e){return this.checkTimes(t)&&!this.checkTimes(e)?1:!this.checkTimes(t)&&this.checkTimes(e)?-1:0},e.prototype.checkTimes=function(t){return this._receiveMap[t.getId()]==t.getTimes()},e.prototype.getModelById=function(t){return this._modelObj[t]},e.prototype.getCostModel=function(){return this._modelObj[1].getCost()[0]},e.prototype.getExchageTimesById=function(t){return this._receiveMap[t]||0},e.prototype.initEnoughList=function(){for(var t=this.getModelList(),e=0;e<t.length;e++){var i=t[e],n=i.getTimes()-this.getExchageTimesById(i.getId()),a=this.getCanExchange();n<=0&&(a=!1);for(var r=i.getCost(),o=0,s=r.length;o<s;o++){var l=r[o];if(a)td.ItemManager.getItemNumById(l.getId())<l.getCount()&&(a=!1)}this.setEnoughList(e,a)}},e.prototype.setEnoughList=function(t,e){this._enoughList[t]=e},e.prototype.activityParse=function(t){var e=t.record;this._receiveMap=e.receiveMap||{},this._modelList=[],this._modelObj={},this._enoughList=[];for(var i=td.GetTableClass(td.TableEnum.ActivityCollectWordConfig).getDatasOfDataId(this.getActivityData()),n=0,r=i.length;n<r;n++){var o=i[n],s=new a.default;s.initData(o);var l=s.getId();this._modelObj[l]=s,this._modelList.push(s)}this.initEnoughList(),td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_REFRESH_EXCHANGE)},e.prototype.getCanExchange=function(){var t=this.getCurrentOpenStage();return!!t&&t.showTime+6e3-td.TimeUtil.getTime()<=0},e.prototype.hasRedPoint=function(){return!0},e.prototype.redPointTip=function(){return this.isRedPointTip()},e.prototype.isRedPointTip=function(){for(var t=!1,e=0;e<this._enoughList.length;e++)if(this._enoughList[e]){t=!0;break}return t},e}(t("ActivityBaseController"));i.default=r,e.exports=r,cc._RF.pop()},{"./Double11ExchangeItemModel":"Double11ExchangeItemModel",ActivityBaseController:"ActivityBaseController"}],Double11ExchangeItemModel:[function(t,e,i){"use strict";cc._RF.push(e,"41bf4mugJZJFaqsa+A7HnQk","Double11ExchangeItemModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._id=null,this._cost=[],this._count=0}return t.prototype.initData=function(t){this._data=t.data,this._id=t.id,this._times=t.times,this._cost=td.RewardManager.parseRewardListDetail(t.cost),this._reward=td.RewardManager.parseRewardListDetail(t.reward)},t.prototype.getId=function(){return this._id},t.prototype.getData=function(){return this._data},t.prototype.getCost=function(){return this._cost},t.prototype.getTimes=function(){return this._times},t.prototype.getRewards=function(){return this._reward},t}();i.default=n,cc._RF.pop()},{}],Double11ExchangeItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"8eb4c8fPs5ISbvOwFk8c3Kc","Double11ExchangeItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Double11ExchangeItemView"),o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.Double11Exchange),a=i.getId();this._itemId=a;var r=i.getTimes(),o=r-n.getExchageTimesById(a);this.view.hideItem(),this.view.setCount(o,r);var s=n.getCanExchange();o<=0&&(s=!1);for(var l=i.getCost(),c=0,u=l.length;c<u;c++){var d=l[c],h=(p=this.view.getItem(c)).getChildByName("item");if(s)td.ItemManager.getItemNumById(d.getId())<d.getCount()&&(s=!1);h||((h=td.GlobalFunction.createCommonIconWidget(26,d)).name="item",p.addChild(h)),h.getComponent("CommonIconWidget").setData(d),p.active=!0}this.view.setState(!s);var p,_=i.getRewards()[0];_&&((h=(p=this.view.getItem(2)).getChildByName("item"))||((h=td.GlobalFunction.createCommonIconWidget(26,_)).name="item",p.addChild(h)),h.getComponent("CommonIconWidget").setData(_),p.active=!0)},e.prototype.onBtnExchange=function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.Double11Exchange),e={};e.id=this._itemId,e.parmeterMap={18:1},t.operateActivity(e)},a([l(r.Double11ExchangeItemView)],e.prototype,"view",void 0),e=a([s,c("module/Activity/Double11ExchangeItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{"./Double11ExchangeItemView":"Double11ExchangeItemView",ListItem:void 0}],Double11ExchangeItemView:[function(t,e,i){"use strict";cc._RF.push(e,"48adauPV6VCzo9GRaF20VRp","Double11ExchangeItemView");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.Double11ExchangeItemView=void 0;var r=t("../../../../Common/EventTrigger"),o=cc._decorator.property,s=cc._decorator.ccclass,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_count=void 0,e.m_btnExchange=void 0,e.m_item1=void 0,e.m_item2=void 0,e.m_item3=void 0,e._onBtnExchangeClickEvent=new r.EventTrigger,e}return n(e,t),e.prototype.deleteEventListeners=function(){this._onBtnExchangeClickEvent.unAlllisten()},e.prototype.setCount=function(t,e){this.m_count.string=t+"/"+e},e.prototype.setState=function(t){this.m_count.node.color=t?cc.color(106,106,106):cc.color(5,159,1),td.GlobalFunction.setButtonGray(this.m_btnExchange.node,t)},e.prototype.onBtnExchange=function(){this._onBtnExchangeClickEvent.trigger()},e.prototype.hideItem=function(){for(var t=[this.m_item1,this.m_item2,this.m_item3],e=0;e<t.length;e++)t[e].active=!1},e.prototype.getItem=function(t){var e=[this.m_item1,this.m_item2,this.m_item3];return e[t]?e[t]:null},a([o(cc.Label)],e.prototype,"m_count",void 0),a([o(cc.Button)],e.prototype,"m_btnExchange",void 0),a([o(cc.Node)],e.prototype,"m_item1",void 0),a([o(cc.Node)],e.prototype,"m_item2",void 0),a([o(cc.Node)],e.prototype,"m_item3",void 0),e=a([s],e)}(cc.Component);i.Double11ExchangeItemView=l,cc._RF.pop()},{"../../../../Common/EventTrigger":"EventTrigger"}],Double11ExchangePanel:[function(t,e,i){"use strict";cc._RF.push(e,"cd84cXoZzVK3IZ6Sf4XuslM","Double11ExchangePanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Double11ExchangeView"),o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e}return n(e,t),e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addLocalListeners(),this.refreshView()},e.prototype.onDisable=function(){td.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addLocalListeners=function(){var t=td.EventUtil,e={};e[td.EventNameEnum.DOUBLE_11_REFRESH_EXCHANGE]=this.refreshView,t.registerEvents(e,this)},e.prototype.refreshView=function(){var t=this.getActivityController();if(t){var e=this.getSleepTimeStrExchange(!0);this.view.setDurTime(e);var i=t.getCostModel(),n=td.ItemManager.getItemNumById(i.getId());td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,i.getLittleIconResPath(),this.view.getItemIcon()),this.view.setItemNum(n),this.refreshList()}},e.prototype.getSleepTimeStrExchange=function(t){var e=this._controller.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=new Date(e.showTime+6e4),n=new Date(e.closeTime),a=td.Language.timePattern5,r=td.Language.activityTimeTip2;return t&&(r=td.Language.activityTimeTip1),r=cc.js.formatStr(r,i.pattern(a),n.pattern(a))}},e.prototype.refreshList=function(){var t=this.view.getListViewCtrl();t.setCustomData(this._activityType);var e=this.getActivityController().getModelList();t.refreshCurList(e)},a([l(r.Double11ExchangeView)],e.prototype,"view",void 0),e=a([s,c("module/Activity/Double11ExchangePanel")],e)}(t("ActivityBasePanel"));i.default=u,cc._RF.pop()},{"./Double11ExchangeView":"Double11ExchangeView",ActivityBasePanel:"ActivityBasePanel"}],Double11ExchangeView:[function(t,e,i){"use strict";cc._RF.push(e,"4645eooMNJAup+eN88GStli","Double11ExchangeView");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.Double11ExchangeView=void 0;var r=cc._decorator.property,o=cc._decorator.ccclass,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_durTime=void 0,e.m_itemNum=void 0,e.m_itemIcon=void 0,e.m_scrollView=void 0,e}return n(e,t),e.prototype.setDurTime=function(t){this.m_durTime.string=t},e.prototype.setItemNum=function(t){this.m_itemNum.string=t+""},e.prototype.getItemIcon=function(){return this.m_itemIcon.node},e.prototype.getScrollView=function(){return this.m_scrollView.node},e.prototype.getListViewCtrl=function(){return this._listViewCtrl||(this._listViewCtrl=this.m_scrollView.node.getComponent("OptimizeVerticalListView")),this._listViewCtrl},a([r(cc.Label)],e.prototype,"m_durTime",void 0),a([r(cc.Label)],e.prototype,"m_itemNum",void 0),a([r(cc.Sprite)],e.prototype,"m_itemIcon",void 0),a([r(cc.ScrollView)],e.prototype,"m_scrollView",void 0),e=a([o],e)}(cc.Component);i.Double11ExchangeView=s,cc._RF.pop()},{}],Double11FundConfig:[function(t,e,i){"use strict";cc._RF.push(e,"1fa559FVexLNJR5Df8UOAKf","Double11FundConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Double11FundConfig",e._tblName="activity_2005_config",e._data={},e}return n(e,t),e.prototype.init=function(){for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t],i=e.data;this._data[i]||(this._data[i]={}),this._data[i][e.level]=e}},e.prototype.getCfgsByDataId=function(t){if(!this._data)return null;var e=this._data[t];return e||cc.error("====> \u53cc11\u8fd4\u5229\u57fa\u91d1\u8868 activity_2005_config \u6ca1\u6709\u5bf9\u5e94\u914d\u7f6eid: ",t),e},e.prototype.getDataByDataIdAndLevel=function(t,e){return this.getCfgsByDataId(t)[e]},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],Double11FundController:[function(t,e,i){"use strict";cc._RF.push(e,"e62f5AQVVlHEoz8G7gf+SnJ","Double11FundController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._level=0,e._recharge=0,e._diamond=0,e._drawTimes=0,e._maxLevel=0,e}return n(e,t),e.prototype.activityParse=function(t){var e=t.record;this._level=e.level,this._recharge=e.recharge,this._diamond=e.diamond;var i=this.getActivityData(),n=a.GetTableClass(a.TableEnum.Double11FundConfig).getCfgsByDataId(i),r=0;for(var o in n){var s=n[o].recharge,l=n[o].diamond,c=n[o].level;this._recharge>=s&&this._diamond>=l&&r<c&&(r=c),this._maxLevel<c&&(this._maxLevel=c)}this._drawTimes=r-this._level},e.prototype.getNextTarget=function(){var t=this.getActivityData();return this._level>=this._maxLevel?a.GetTableClass(a.TableEnum.Double11FundConfig).getDataByDataIdAndLevel(t,this._maxLevel):a.GetTableClass(a.TableEnum.Double11FundConfig).getDataByDataIdAndLevel(t,this._level+1)},e.prototype.getIsMax=function(){return this._level>=this._maxLevel},e.prototype.getRecharge=function(){return this._recharge},e.prototype.getDiamond=function(){return this._diamond},e.prototype.getDrawTimes=function(){return this._drawTimes},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){return this._drawTimes>0},e}(t("ActivityBaseController"));i.default=r,e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],Double11FundModel:[function(t,e,i){"use strict";cc._RF.push(e,"186e3XemlpFRLnzXje11Hn1","Double11FundModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._dataId=null,this._id=null,this._unlockId=[],this._maxCount=0,this._cost=[],this._rewards=[],this._count=0}return t.prototype.initData=function(t){this._dataId=t.data,this._id=t.id,this._unlockId=t.unlockId,this._maxCount=t.count,this._cost=t.cost,this._rewards=td.RewardManager.parseRewardListDetail(t.rewards)},t.prototype.setData=function(t){this._count=t},t.prototype.getUnlockId=function(){return this._unlockId},t.prototype.getMaxCount=function(){return this._maxCount},t.prototype.getCost=function(){return this._cost},t.prototype.getRewards=function(){return this._rewards},t.prototype.getId=function(){return this._id},t.prototype.getCount=function(){return this._count},t.prototype.getStatus=function(){return this.isUnlock()?this._count>=this._maxCount?td.ActivityEnum.OperateStatus.Operated:td.ActivityEnum.OperateStatus.OperateAble:td.ActivityEnum.OperateStatus.NotOperateAble},t.prototype.getTask=function(){for(var t=[],e=td.UnlockManager.getUnlockConfigById(this._unlockId).getCondition(),i=0;i<e.length;i++){var n=e[i],a=td.TaskManager.getTaskById(n.value);t.push(a)}return t},t.prototype.isUnlock=function(){return td.UnlockManager.isTargetUnlockById(this._unlockId,!1)},t}();i.default=n,cc._RF.pop()},{}],Double11FundPanel:[function(t,e,i){"use strict";cc._RF.push(e,"55cf31aSD1KnLVC2KuWknue","Double11FundPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=window.td,c=t("ActivityBasePanel"),u=t("./Double11FundView"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e._controller=null,e._rewards=null,e._isDrawing=!1,e._blockInputEvents=null,e}return n(e,t),e.prototype.onLoad=function(){this._controller||(this._controller=l.ActivityDataManager.getActivityControllerByType(l.ActivityEnum.ActivityType.Double11Fund))},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.addListener(),this._refreshUI(),this._setActivityTime(),this.view.resetScorll()},e.prototype.onDisable=function(){l.EventUtil.dispatchEvent(l.EventNameEnum.RESUME_UPDATE_MAIN_LAYER_DIAMOND),this.isDrawing=!1,this.deleteListener(),t.prototype.onDisable.call(this)},e.prototype.addListener=function(){this.view._onBtnDrawClickEvent.listen(this.onClickDraw.bind(this)),this.view._onBtnHelpClickEvent.listen(this.showHelpWidget.bind(this)),this.view._onDrawEndEvent.listen(this.onDrawEnd.bind(this))},e.prototype.deleteListener=function(){l.EventUtil.unregisterAllEvents(this),this.view.deleteEventListeners()},e.prototype._refreshUI=function(){var t={};t.fundTarget=this._controller.getNextTarget(),t.recharge=this._controller.getRecharge(),t.diamond=this._controller.getDiamond(),t.drawTimes=this._controller.getDrawTimes(),t.isMax=this._controller.getIsMax(),this.view.setUI(t)},e.prototype._setActivityTime=function(){var t=this.getDurationStr();this.view.setEndTime(t)},e.prototype.onClickDraw=function(){this.isDrawing||(this.isDrawing=!0,l.EventUtil.dispatchEvent(l.EventNameEnum.PAUSE_UPDATE_MAIN_LAYER_DIAMOND),this.addBlockInputEvents(),this._controller.operateActivity({}))},e.prototype.onReceiveOperation=function(t){if(t.activityId===this._activityId){this._controller.parseRewardReceived(t),this._rewards=t.rewardResult;var e=t.rewardResult.diamond;this.view.scrollErnie(e)}},e.prototype.onDrawEnd=function(){var t=l.RewardManager.parseRewardResult(this._rewards,!0);l.GlobalFunction.showRewards(t),this._rewards=null,l.EventUtil.dispatchEvent(l.EventNameEnum.RESUME_UPDATE_MAIN_LAYER_DIAMOND),this._refreshUI(),this.isDrawing=!1,this.destroyBlockInputEvents()},e.prototype.addBlockInputEvents=function(){var t=l.PanelManager.getInstance().getMainLayer();this._blockInputEvents=new cc.Node,this._blockInputEvents.addComponent(cc.BlockInputEvents),this._blockInputEvents.width=720,this._blockInputEvents.height=1280,this._blockInputEvents.parent=t.node,this._blockInputEvents.setPosition(0,0)},e.prototype.destroyBlockInputEvents=function(){this._blockInputEvents.destroy()},a([s(u.default)],e.prototype,"view",void 0),e=a([o],e)}(c);i.default=d,cc._RF.pop()},{"./Double11FundView":"Double11FundView",ActivityBasePanel:"ActivityBasePanel"}],Double11FundScrollWidget:[function(t,e,i){"use strict";cc._RF.push(e,"237b3pg10ZJa4udEtIDFOLp","Double11FundScrollWidget");var n=t("Double11FundScrollWidget");n=cc.Class({extends:cc.Component,properties:{_totalAngle:null,_scrollAngle:null,_destNum:null,_showAngle:null,_labelAngle:null},onLoad:function(){this._showAngle=40,this._init()},onDisable:function(){this.unschedule(this._update)},_init:function(){var t=119/165*this._showAngle;this._labelAngle=[];for(var e=0;e<=9;e++){var i=0+36*e-t/2;this._labelAngle[e]=[i,i+t,i+t/2]}},_update:function(t){if(this._scrollAngle+=720*t,this._scrollAngle>=this._totalAngle)return this.unschedule(this._update),void this.showWidgetByAngle(this._totalAngle);this.showWidgetByAngle(this._scrollAngle)},resetScroll:function(){this.setScroll(0)},setScroll:function(t){this.showWidgetByAngle(36*t)},startScroll:function(t,e,i){i=i||0,this._totalAngle=this._labelAngle[9][2]-this._labelAngle[i][2]+360*t+this._labelAngle[e][2]+36,this._scrollAngle=0,this._destNum=e,this.schedule(this._update,.1)},showWidgetByAngle:function(t){for(var e=[(t%=360)-this._showAngle/2,t+this._showAngle/2],i=this.node.height,n=this._labelAngle,a={},r=0;r<=9;r++){var o=n[r],s=[o[0]-360,o[1]-360,o[2]-360];if(o[0]>e[0]&&o[0]<e[1]||o[1]>e[0]&&o[1]<e[1]||s[0]>e[0]&&s[0]<e[1]||s[1]>e[0]&&s[1]<e[1]){var l=o[2]-e[0];l=l%360==0?0:l,a[r]=l/this._showAngle*i}}var c=this.node.getChildren(),u=this.node.getChildrenCount();r=0;for(var d in a){if(!c[r]){var h=new cc.Node;h.addComponent(cc.Sprite),h.setAnchorPoint(cc.v2(.5,.5)),h.setPosition(cc.v2(0,a[d])),this.node.addChild(h)}td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_59_s11,"HD_xffljj_"+d,c[r]),c[r].setPosition(cc.v2(0,a[d])),r++}for(;r<u;u--)c[r].removeFromParent()}});e.exports=n,cc._RF.pop()},{Double11FundScrollWidget:"Double11FundScrollWidget"}],Double11FundView:[function(t,e,i){"use strict";cc._RF.push(e,"8f879pdsR5Hl5heCUd/y4eR","Double11FundView");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator.property,o=cc._decorator.ccclass,s=window.td,l=t("../../../../Common/EventTrigger"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_timeDuration=void 0,e.m_taskNode=void 0,e.m_numNode=void 0,e.m_labelGetMax=void 0,e.m_btnStart=void 0,e.m_drawTimes=void 0,e._onBtnDrawClickEvent=new l.EventTrigger,e._onBtnHelpClickEvent=new l.EventTrigger,e._onDrawEndEvent=new l.EventTrigger,e}return n(e,t),e.prototype.deleteEventListeners=function(){this._onBtnDrawClickEvent.unAlllisten(),this._onBtnHelpClickEvent.unAlllisten(),this._onDrawEndEvent.unAlllisten(),gdk.Timer.clear(this,this._releaseHandler)},e.prototype.setUI=function(t){var e=this.m_taskNode.getChildByName("taskLevel"),i=this.m_taskNode.getChildByName("taskLabel"),n=this.m_taskNode.getChildByName("taskStatus"),a=this.m_taskNode.getChildByName("ConditionLayout1").getChildByName("taskCondition"),r=this.m_taskNode.getChildByName("ConditionLayout2").getChildByName("taskCondition");e.getComponent(cc.Label).string=t.fundTarget.fundsName+"\uff1a",i.getComponent(cc.Label).string=cc.js.formatStr(s.Language.Double11FundTask,Math.floor(t.fundTarget.recharge/10),t.fundTarget.diamond),a.getComponent(cc.Label).string=Math.floor(t.recharge/10)+"",r.getComponent(cc.Label).string=t.diamond,this.m_labelGetMax.string=t.fundTarget.reward[0]+"-"+t.fundTarget.reward[1],this.m_drawTimes.string=t.drawTimes,t.isMax?(s.GlobalFunction.createAltasSprite(s.resDef.pngPlist.Acitivty_59_s11,"HD_s11_ydc",n),s.GlobalFunction.setButtonGray(this.m_btnStart.node,!0),this.setRedPointOnBtn(!1)):t.drawTimes>0?(s.GlobalFunction.createAltasSprite(s.resDef.pngPlist.Acitivty_59_s11,"HD_s11_ydc",n),s.GlobalFunction.setButtonGray(this.m_btnStart.node,!1),this.m_btnStart.node.getChildByName("Label").color=cc.color(165,19,19),this.setRedPointOnBtn(!0)):(s.GlobalFunction.createAltasSprite(s.resDef.pngPlist.Acitivty_59_s11,"HD_s11_wdc",n),s.GlobalFunction.setButtonGray(this.m_btnStart.node,!0),this.setRedPointOnBtn(!1))},e.prototype.setEndTime=function(t){this.m_timeDuration.string=t},e.prototype.resetScorll=function(){for(var t=0;t<5;t++){this.m_numNode.node.getChildByName("item_"+(t+1)).getComponent("Double11FundScrollWidget").resetScroll()}},e.prototype.scrollErnie=function(t){var e=t;if(!(e<=0)){this.resetScorll();for(var i=String(e),n=0;n<i.length;n++){this.m_numNode.node.getChildByName("item_"+(n+1)).getComponent("Double11FundScrollWidget").startScroll(1+1*n,i[i.length-n-1])}var a=400*(i.length+1);gdk.Timer.once(a+1e3,this,this._releaseHandler)}},e.prototype._releaseHandler=function(){this._onDrawEndEvent.trigger()},e.prototype.onBtnDraw=function(){this.setRedPointOnBtn(!1),this._onBtnDrawClickEvent.trigger()},e.prototype.onBtnHelp=function(){this._onBtnHelpClickEvent.trigger()},e.prototype.setRedPointOnBtn=function(t){s.RedPointUtil.createRedPointSimple(this.m_btnStart.node,{x:-10,y:-10},t)},a([r(cc.Label)],e.prototype,"m_timeDuration",void 0),a([r(cc.Node)],e.prototype,"m_taskNode",void 0),a([r(cc.Layout)],e.prototype,"m_numNode",void 0),a([r(cc.Label)],e.prototype,"m_labelGetMax",void 0),a([r(cc.Button)],e.prototype,"m_btnStart",void 0),a([r(cc.Label)],e.prototype,"m_drawTimes",void 0),e=a([o],e)}(cc.Component);i.default=c,cc._RF.pop()},{"../../../../Common/EventTrigger":"EventTrigger"}],Double11IntegralConfig:[function(t,e,i){"use strict";cc._RF.push(e,"e9993bPPq5H6I3fqeEkkwuC","Double11IntegralConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Double11IntegralConfig",e._tblName="double_eleven_consume_score_config",e._data={},e}return n(e,t),e.prototype.init=function(){for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t],i=e.data;this._data[i]||(this._data[i]={}),this._data[i][e.score]=e}},e.prototype.getCfgsByDataId=function(t){if(!this._data)return null;var e=this._data[t];return e||cc.error("====> \u53cc11\u6d88\u8d39\u79ef\u5206\u5956\u52b1 double_eleven_consume_score_config \u6ca1\u6709\u5bf9\u5e94\u914d\u7f6eid: ",t),e},e.prototype.getListByDataId=function(t){var e=[],i=this.getCfgsByDataId(t);for(var n in i)e.push(i[n]);return e.sort(this.sortFunc),e},e.prototype.sortFunc=function(t,e){return t.score-e.score},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],Double11IntegralView:[function(t,e,i){"use strict";cc._RF.push(e,"2b880tY3DZOyasopFv7N3SQ","Double11IntegralView");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator.property,o=cc._decorator.ccclass,s=window.td,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.myScore=void 0,e.integralScrollView=void 0,e._isInitintegralList=!1,e}return n(e,t),e.prototype.setUI=function(t,e){var i=this.integralScrollView.getComponent("OptimizeVerticalListView");this._isInitintegralList?i.refreshCurList(t):(i.refreshListData(t),this._isInitintegralList=!0),this.myScore.string=cc.js.formatStr(s.Language.Double11RankMyScore,e)},a([r(cc.Label)],e.prototype,"myScore",void 0),a([r(cc.Node)],e.prototype,"integralScrollView",void 0),e=a([o],e)}(cc.Component);i.default=l,cc._RF.pop()},{}],Double11IntegralWindow:[function(t,e,i){"use strict";cc._RF.push(e,"633506jy+hIAK8xEaVwHOZ+","Double11IntegralWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.Double11IntegralWindow=void 0;var r=cc._decorator.property,o=cc._decorator.ccclass,s=window.td,l=t("PanelBase"),c=t("./Double11IntegralView"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e._controller=null,e}return n(e,t),e.prototype.init=function(){this._panelType=s.PanelType.Window,this._panelEnum=s.PanelEnum.Window_Double11Integral},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this._controller||(this._controller=s.ActivityDataManager.getActivityControllerByType(s.ActivityEnum.ActivityType.Double11Rank))},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),s.EventUtil.registerEvent(s.EventNameEnum.DOUBLE11_RANK_REFRESH_UI,this.setUI,this),this.setUI()},e.prototype.setUI=function(){this.view.setUI(this._controller.getIntergralModels(),this._controller.getMyScore())},e.prototype.onDisable=function(){s.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype.start=function(){},a([r(c.default)],e.prototype,"view",void 0),e=a([o],e)}(l);i.Double11IntegralWindow=u,cc._RF.pop()},{"./Double11IntegralView":"Double11IntegralView",PanelBase:void 0}],Double11IntergralItem:[function(t,e,i){"use strict";cc._RF.push(e,"4da2eEszblJyLoG8TVkyXJ4","Double11IntergralItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labScore=null,e.nodeReward=null,e.btn=null,e.ylqImg=null,e._score=0,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i;this._score=n.getScore();for(var a=n.getRewards(),o=this.nodeReward.children,s=0;s<o.length;s++)s+1>a.length&&(o[s].active=!1);for(var l=0;l<a.length;l++){var c=this.nodeReward.getChildByName("icon"+l),u=r.RewardManager.getRewardDetail(a[l]);c||(c=r.GlobalFunction.createCommonIconWidget(26,u),this.nodeReward.addChild(c),c.name="icon"+l,c.scale=.75,c.zIndex=l,c.$tag=a[l]);var d=c.getComponent("CommonIconWidget");a[l][0]==c.$tag[0]&&a[l][1]==c.$tag[1]&&a[l][2]==c.$tag[2]||(d.setData(u),c.$tag=a[l]),c.active=!0}this.labScore.string=cc.js.formatStr(r.Language.Double11RankTargetScore,n.getScore()),n.getState()==r.ActivityEnum.Double11IntegralState.CAN_RECEIVE?(this.btn.active=!0,this.ylqImg.active=!1,r.GlobalFunction.setButtonGray(this.btn,!1)):n.getState()==r.ActivityEnum.Double11IntegralState.UNFINISHED?(this.btn.active=!0,this.ylqImg.active=!1,r.GlobalFunction.setButtonGray(this.btn,!0)):n.getState()==r.ActivityEnum.Double11IntegralState.RECEIVED&&(this.btn.active=!1,this.ylqImg.active=!0)},e.prototype.onBtn=function(){r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Double11Rank).operateActivity({id:this._score})},a([c(cc.Label)],e.prototype,"labScore",void 0),a([c(cc.Node)],e.prototype,"nodeReward",void 0),a([c(cc.Node)],e.prototype,"btn",void 0),a([c(cc.Node)],e.prototype,"ylqImg",void 0),e=a([l],e)}(o);i.default=u,cc._RF.pop()},{ListItem:void 0}],Double11IntergralModel:[function(t,e,i){"use strict";cc._RF.push(e,"a7b65pUFndEnYjFJc4feEXM","Double11IntergralModel"),Object.defineProperty(i,"__esModule",{value:!0});t("BaseUser");var n=function(){function t(){this._score=null,this._rewards=null,this._state=null}return t.prototype.upData=function(t){this._rewards=t.scoreRewards,this._score=t.score},t.prototype.getState=function(){return this._state},t.prototype.getScore=function(){return this._score},t.prototype.getRewards=function(){return this._rewards},t.prototype.setState=function(t){this._state=t},t}();i.default=n,cc._RF.pop()},{BaseUser:"BaseUser"}],Double11KillConfig:[function(t,e,i){"use strict";cc._RF.push(e,"d1d0dW/FPtLxriGsiXfTtiI","Double11KillConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Double11KillConfig",e._tblName="activity_2003_stage_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getCfgsByDataId=function(t){if(!this._data)return null;var e=this._data[t];return e||cc.error("====> \u53cc11 \u8868 activity_2003_stage_config \u6ca1\u6709\u5bf9\u5e94\u914d\u7f6eid: ",t),e},e.prototype.getCfgsByDataIdAndDay=function(t,e){for(var i=this.getCfgsByDataId(t),n=[],a=0;a<i.length;a++){var r=i[a];r.openDay==e&&n.push(r)}return n},e.prototype.getCfgByDataIdAndTimeHour=function(t,e,i){var n=this.getCfgsByDataIdAndDay(t,e);if(!n)return cc.error("====> \u53cc11 \u8868 activity_2003_stage_config \u6ca1\u6709\u5bf9\u5e94\u914d\u7f6eid: ",t,e),[];n.sort(function(t,e){return t.stageOpenHour-e.stageOpenHour});for(var a=0;a<n.length;a++){var r=n[a];if(a+1<n.length){var o=n[a];if(i>=r.stageOpenHour&&i<o.stageOpenHour)return r}else if(i>=r.stageOpenHour&&i<24)return r}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],Double11KillDataModel:[function(t,e,i){"use strict";cc._RF.push(e,"e39b7ubuYJHnoJLH/BdWz3p","Double11KillDataModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("./Double11ShopItemViewModel"),a=function(){function t(){this._openDay=0,this._stageOpenHour=0,this._products=[],this._titleImg="",this._productDatas={},this._isInOpen=!1,this._openStage=0,this._endHour=0}return t.prototype.init=function(t){this._openDay=t.openDay,this._stageOpenHour=t.stageOpenHour,this._products=t.products,this._titleImg=t.titleImg;for(var e=0;e<this._products.length;e++){var i=this._products[e],a=td.GetTableClass(td.TableEnum.Double11ProductConfig);if(!a)return void cc.error("=======> \u600e\u4e48\u6ca1\u914d\u7f6e\u8868\u6570\u636e\uff1f activity_2003_product_config");var r=a.getProductById(i),o=this._productDatas[i];o||(o=new n.default),o.init(r),this._productDatas[i]=o}},t.prototype.refreshProductSelfData=function(t,e){this._productDatas[t].setSelfCurCount(e)},t.prototype.refreshProductAllData=function(t,e){this._productDatas[t].setAllCurCount(e)},t.prototype.getProductsList=function(){return this._productDatas.values()},t.prototype.getProductModelByShopId=function(t){return this._productDatas[t]},t.prototype.getOpenHour=function(){return this._stageOpenHour},t.prototype.getOpenDay=function(){return this._openDay},t.prototype.getTitleImg=function(){return this._titleImg},t.prototype.isInOpen=function(){return this._isInOpen},t.prototype.setOpenStage=function(t){this._openStage=t},t.prototype.getOpenStage=function(){return this._openStage},t.prototype.setInOpen=function(t){this._isInOpen=t},t.prototype.setEndHour=function(t){this._endHour=t},t.prototype.getEndHour=function(){return this._endHour},t}();i.default=a,cc._RF.pop()},{"./Double11ShopItemViewModel":"Double11ShopItemViewModel"}],Double11KillManager:[function(t,e,i){"use strict";cc._RF.push(e,"3ae4eQTWS5PtKKiBosY2SFq","Double11KillManager");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("./Double11Enum"),r=t("./Double11KillDataModel"),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._totalBuyMap={},e._buyMap={},e._openDay=0,e._isInit=!1,e._dataModels=null,e._isPanelShowed=!1,e._curRechargeData=null,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e)},e.prototype.clearData=function(){t.prototype.clearData.call(this),this._isInit=!1,this._dataModels=null},e.prototype.addLocalEventListener=function(){t.prototype.addLocalEventListener.call(this);var e={};e[td.EventNameEnum.DOUBLE_11_BUY_ITEM]=this._onRequestBuy,e[td.EventNameEnum.Recharge_Success]=this._onRechargeSucc,e[td.EventNameEnum.USER_ATTR_LEVEL_CHANGE]=this._onRequestActivityInfo,e[td.EventNameEnum.ON_TIME_OVER_DAY]=this._onTimeDayOver,td.EventUtil.registerEvents(e,this)},e.prototype.activityParse=function(t){if(t){var e=this._openDay,i=t.global,n=t.record;this._openDay=n.openDay,e!=this._openDay&&(this._isInit=!1),this._isInit||this._initDataModels();var a=[];if(i){var r=i.totalBuyMap||{};for(var o in r){var s=r[o];-1==a.indexOf(Number(o))&&a.push(Number(o)),(c=this.getModelByShopId(Number(o)))&&c.refreshProductAllData(Number(o),s)}}if(n){var l=n.buyMap||{};for(var o in l){var c;s=l[o];-1==a.indexOf(Number(o))&&a.push(Number(o)),(c=this.getModelByShopId(Number(o)))&&c.refreshProductSelfData(Number(o),s)}}for(var u=0;u<a.length;u++){o=a[u];td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_REFRESH_SHOP_ITEM,o)}this._isInit=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_KILL_GET_INFO)}},e.prototype._onRequestBuy=function(t){if(t.activityType==this.getActivityType()){var e={};e.id=t.shopId,this.operateActivity(e)}},e.prototype._onRechargeSucc=function(t){if(t&&this._curRechargeData&&this._curRechargeData.getChargeId()==t.getChargeId()){var e=this._getShowRewardList(t.getReward());td.GlobalFunction.showRewards(e),this.setRechargeData(null)}},e.prototype._onRequestActivityInfo=function(){var t=td.Account.getUserData().getLevel(),e=this._activityOpen._openConfig.level;!this._isInit&&t>=e&&td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,this.getActivityId)},e.prototype._onTimeDayOver=function(){this.isInOpenStatus()&&(td.Account.getUserData().getLevel()>=this._activityOpen._openConfig.level&&(this._isInit=!1,td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,this.getActivityId)))},e.prototype._getShowRewardList=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],a={};a.type=n[0],a.id=n[1],a.count=n[2],e[e.length]=a}return e=td.RewardManager.convertCfgType2GoodsType(e)},e.prototype._initDataModels=function(){var t=this.getActivityData(),e=td.GetTableClass(td.TableEnum.Double11KillConfig);if(e){this._dataModels={};for(var i=e.getCfgsByDataIdAndDay(t,this._openDay),n=0;n<i.length;n++){var a=i[n];this._dataModels[this._openDay]||(this._dataModels[this._openDay]={});var o=this._dataModels[this._openDay][a.stageOpenHour];o||(o=new r.default),o.init(a),this._dataModels[this._openDay][a.stageOpenHour]=o}}},e.prototype.getModelByShopId=function(t){var e=this._dataModels[this._openDay];for(var i in e){var n=e[i];if(n.getProductModelByShopId(t))return n}return null},e.prototype.getShopModelByShopId=function(t){var e=this._dataModels[this._openDay];for(var i in e){var n=e[i].getProductModelByShopId(t);if(n)return n}return null},e.prototype.getKillDataByHour=function(t){return this._dataModels[this._openDay][t]},e.prototype.getCurKillDatas=function(){if(!this._dataModels)return[];var t=td.TimeUtil.getServerDate().getHours(),e=[],i=this._dataModels[this._openDay];if(!i)return[];(e=i.values()).sort(function(t,e){return t.getOpenHour()-e.getOpenHour()});for(var n=0;n<e.length;n++){var r=e[n];if(n+1<e.length){var o=e[n+1];r.setEndHour(o.getOpenHour()),t>=r.getOpenHour()&&t<o.getOpenHour()?(r.setInOpen(!0),r.setOpenStage(a.KILL_DATA_STAGE.OPENING)):(r.getOpenHour()<t?r.setOpenStage(a.KILL_DATA_STAGE.PASSED):r.setOpenStage(a.KILL_DATA_STAGE.ISCOMMING),r.setInOpen(!1))}else r.setEndHour(24),t>=r.getOpenHour()&&t<=24?(r.setInOpen(!0),r.setOpenStage(a.KILL_DATA_STAGE.OPENING)):(r.getOpenHour()<t?r.setOpenStage(a.KILL_DATA_STAGE.PASSED):r.setOpenStage(a.KILL_DATA_STAGE.ISCOMMING),r.setInOpen(!1))}for(n=e.length-1;n>=0;n--){(r=e[n]).getOpenStage()==a.KILL_DATA_STAGE.PASSED&&e.splice(n,1)}return e},e.prototype.getCurProductsByHour=function(t){var e=this._dataModels[this._openDay];for(var i in e){var n=e[t];if(Number(i)==t)return n.getProductsList()}return[]},e.prototype.setRechargeData=function(t){this._curRechargeData=t},e.prototype.openPanel=function(){this._isPanelShowed=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_KILL_PANEL_OPEN)},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){return!this._isPanelShowed},e.prototype.redPointEvts=function(){return[td.EventNameEnum.DOUBLE_11_KILL_PANEL_OPEN]},e}(t("ActivityBaseController"));i.default=o,e.exports=o,cc._RF.pop()},{"./Double11Enum":"Double11Enum","./Double11KillDataModel":"Double11KillDataModel",ActivityBaseController:"ActivityBaseController"}],Double11KillPanelcontroller:[function(t,e,i){"use strict";cc._RF.push(e,"1cdfenIwm1GU4ZXxADRuwR3","Double11KillPanelcontroller");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Double11KillPanel"),o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=window.td,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.panelView=null,e._activeController=null,e._curHourList=[],e._curData=null,e._isNewRequest=!1,e}return n(e,t),e.prototype.init=function(){this._panelType=u.PanelType.Panel,this._panelEnum=u.PanelEnum.Panel_Double11Kill},e.prototype.onEnable=function(){if(t.prototype.onEnable.call(this),this._addEventListners(),this._activeController=u.ActivityDataManager.getActivityControllerByType(u.ActivityEnum.ActivityType.Double11_Kill),this._activeController){var e=this._activeController.getActivityId();this._activeController._isInit||(u.EventUtil.dispatchEvent(u.EventNameEnum.Req_GET_ACTIVITY_INFO,e),this._isNewRequest=!0)}},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),u.EventUtil.unregisterAllEvents(this),gdk.Timer.clearAll(this)},e.prototype._addEventListners=function(){var t={};t[u.EventNameEnum.DOUBLE_11_TOGGLE_SWITCH]=this._onToggleChangeRefresh,t[u.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]=this._onReceiveOperation,t[u.EventNameEnum.DOUBLE_11_KILL_GET_INFO]=this._onGetkillInfo,t[u.EventNameEnum.ON_TIME_OVER_DAY]=this._onTimeDayOver,u.EventUtil.registerEvents(t,this)},e.prototype.getDurationStr=function(t){var e=this._activeController.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=new Date(e.openTime),n=new Date(e.closeTime),a=u.Language.timePattern5,r=u.Language.activityTimeTip;return t&&(r=u.Language.activityTimeTip1),r=cc.js.formatStr(r,i.pattern(a),n.pattern(a))}},e.prototype.checkIsOpen=function(t){var e=this._activeController.isInOpenStatus();return e||t||u.MessageBox.tip(148),e},e.prototype.setData=function(e){if(t.prototype.setData.call(this,e),this._activeController){this._curHourList=[];for(var i=this._activeController.getCurKillDatas(),n=0;n<i.length;n++){var a=i[n];this._curHourList.push(a.getOpenHour())}this.panelView.setActivityTime(this.getDurationStr(!0)),this.panelView.refreshToggleScroll(i),i&&i.length>0&&(this._curData=i[0],this._onToggleChangeRefresh(this._curData.getOpenHour())),gdk.Timer.loop(1e3,this,this._updateLoop),this._activeController.openPanel()}},e.prototype._updateLoop=function(t){var e=this._activeController.getCurKillDatas();this._curHourList.length>e.length&&this.setData(null),this._curData&&this._curData.isInOpen()&&this._refreshTimeCount()},e.prototype._onToggleChangeRefresh=function(t){var e=this._activeController.getCurProductsByHour(t),i=this._activeController.getKillDataByHour(t);this._curData=i,this._refreshTimeCount(),this.panelView.setTitleImg(i.getTitleImg()),this.panelView.refreshItemScroll(e)},e.prototype._refreshTimeCount=function(){var t="";if(this._curData.isInOpen()){var e=u.TimeUtil.getTime(),i=this._curData.getEndHour()+":00:00",n=u.TimeUtil.getStampByHours(i)-e;t=u.Language.Double11_Txt_3+u.GlobalFunction.getTimeStringByDeltaTime(n)}else{t=this._curData.getOpenHour()+":00"+u.Language.Double11_Txt_2}this.panelView.setTimeCount(t)},e.prototype._onGetkillInfo=function(){this._isNewRequest&&(this.setData(null),this._isNewRequest=!1)},e.prototype._onTimeDayOver=function(){this._isNewRequest=!0,this.setData(null)},e.prototype._onReceiveOperation=function(t){if(t.activityId===this._activeController.getActivityId()){var e=t.rewardResult,i=u.RewardManager.parseRewardResult(e,!0);u.GlobalFunction.showRewards(i),this._activeController.parseRewardReceived(t)}},a([l(r.Double11KillPanel)],e.prototype,"panelView",void 0),e=a([s,c("module/Activity/Double11/Double11KillPanelcontroller")],e)}(t("PanelBase"));i.default=d,cc._RF.pop()},{"./Double11KillPanel":"Double11KillPanel",PanelBase:void 0}],Double11KillPanel:[function(t,e,i){"use strict";cc._RF.push(e,"2b068bJnF1Fz7gluF5SGWfy","Double11KillPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.Double11KillPanel=void 0;var r=cc._decorator.property,o=cc._decorator.ccclass,s=cc._decorator.menu,l=t("OptimizeVerticalListView"),c=t("./Double11KillToggleItemUI"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_labActivityTime=void 0,e.m_scrollView=void 0,e.m_labTimeCount=void 0,e.m_scrollToggles=void 0,e.m_toggleGroup=void 0,e.m_toggleItem=void 0,e.m_imgTitle=null,e._itemListView=null,e._isInit=!1,e}return n(e,t),e.prototype.start=function(){},e.prototype.onEnable=function(){},e.prototype.setActivityTime=function(t){this.m_labActivityTime.string=t},e.prototype.setTitleImg=function(t){td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_59_s11,t,this.m_imgTitle)},e.prototype.setTimeCount=function(t){this.m_labTimeCount.string=t},e.prototype.refreshItemScroll=function(t){t&&(this._itemListView||(this._itemListView=this.m_scrollView.node.getComponent(l)),this._itemListView.setCustomData({activityType:td.ActivityEnum.ActivityType.Double11_Kill}),this._isInit?this._itemListView.refreshCurList(t):this._itemListView.setData(t),this._isInit=!0)},e.prototype.refreshToggleScroll=function(t){if(t){for(var e=0,i=0;i<t.length;i++){var n=t[i];if(n){var a=this.m_toggleGroup.node.getChildByName("tog"+i);a||((a=cc.instantiate(this.m_toggleItem.node)).name="tog"+i,a.parent=this.m_toggleGroup.node,a.y=0),a.active=!0,a.getComponent(c.Double11KillToggleItemUI).setToggleData(n),e++}}var r=this.m_toggleGroup.node.children;for(i=e;i<r.length;i++){r[i].active=!1}}},e.prototype.onToggleGroupClick=function(t,e){var i=t.node.getComponent(c.Double11KillToggleItemUI);td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_TOGGLE_SWITCH,i.getCurDataHour())},a([r(cc.Label)],e.prototype,"m_labActivityTime",void 0),a([r(cc.ScrollView)],e.prototype,"m_scrollView",void 0),a([r(cc.Label)],e.prototype,"m_labTimeCount",void 0),a([r(cc.ScrollView)],e.prototype,"m_scrollToggles",void 0),a([r(cc.ToggleContainer)],e.prototype,"m_toggleGroup",void 0),a([r(cc.Button)],e.prototype,"m_toggleItem",void 0),a([r(cc.Node)],e.prototype,"m_imgTitle",void 0),e=a([o,s("module/Double11/Double11KillPanel")],e)}(cc.Component);i.Double11KillPanel=u,cc._RF.pop()},{"./Double11KillToggleItemUI":"Double11KillToggleItemUI",OptimizeVerticalListView:void 0}],Double11KillToggleItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"31d72IpkMdJ8qqqJm9mHyT/","Double11KillToggleItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.Double11KillToggleItemUI=void 0;var r=cc._decorator.property,o=cc._decorator.ccclass,s=cc._decorator.menu,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_imgBg=void 0,e.m_imgSelect=void 0,e.m_imgCur=void 0,e.m_labTime=void 0,e.m_labTip=null,e.m_toggle=null,e._curData=null,e}return n(e,t),e.prototype.setToggleData=function(t){this._curData=t,this.m_labTime.string=t.getOpenHour()+":00",this.m_imgCur.active=t.isInOpen(),t.isInOpen()?(this.m_labTime.node.color=cc.color(176,83,0),this.m_labTip.node.color=cc.color(176,83,0)):(this.m_labTime.node.color=cc.color(225,225,225),this.m_labTip.node.color=cc.color(225,225,225)),this.m_labTip.string=t.isInOpen()?td.Language.Double11_Txt_1:td.Language.Double11_Txt_2},e.prototype.getCurDataHour=function(){return this._curData.getOpenHour()},a([r(cc.Sprite)],e.prototype,"m_imgBg",void 0),a([r(cc.Sprite)],e.prototype,"m_imgSelect",void 0),a([r(cc.Node)],e.prototype,"m_imgCur",void 0),a([r(cc.Label)],e.prototype,"m_labTime",void 0),a([r(cc.Label)],e.prototype,"m_labTip",void 0),a([r(cc.Toggle)],e.prototype,"m_toggle",void 0),e=a([o,s("module/Double11/Double11KillToggleItemUI")],e)}(cc.Component);i.Double11KillToggleItemUI=l,cc._RF.pop()},{}],Double11LottoController:[function(t,e,i){"use strict";cc._RF.push(e,"7854acXvj5MgLJoKMPnqlAA","Double11LottoController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isJoin=!1,e._nameList=[],e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e)},e.prototype.activityParse=function(t){var e=t.record;this._isJoin=e.join;if(this._nameList=[[],[]],t.global){var i=t.global;this._luckyActorMap=i.luckyActorMap,this._luckyActorMap[1]&&(this._nameList[0]=this._luckyActorMap[1]),this._luckyActorMap[2]&&(this._nameList[1]=this._luckyActorMap[2])}td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_REFRESH_LOTTO)},e.prototype.getLuckActorMap=function(){return this._luckyActorMap},e.prototype.getNameList=function(t){return this._nameList[t]},e.prototype.isEmpty=function(t){return 0==this.getNameList(t).length},e.prototype.getLuck=function(t){return this.getNameList(t)[0]},e.prototype.getJoin=function(){return this._isJoin},e.prototype.setJoin=function(t){this._isJoin=t},e.prototype.hasRedPoint=function(){return!0},e.prototype.redPointTip=function(){return this.isRedPointTip()},e.prototype.isRedPointTip=function(){return!this.isActivityOver()&&!this._isJoin},e.prototype.isActivityOver=function(){var t=this.getCurrentOpenStage();return!!t&&t.showTime-108e5-td.TimeUtil.getTime()<=0},e}(t("ActivityBaseController"));i.default=a,e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],Double11LottoItemView:[function(t,e,i){"use strict";cc._RF.push(e,"3bfa5bBpl9PjIUUN1JCCgJL","Double11LottoItemView");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.Double11LottoItemView=void 0;var r=cc._decorator.property,o=cc._decorator.ccclass,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_reward0=void 0,e.m_reward1=void 0,e.m_name=void 0,e.m_layout=void 0,e.m_0=void 0,e.m_1=void 0,e.m_2=void 0,e.m_3=void 0,e.m_4=void 0,e.m_5=void 0,e.m_6=void 0,e.m_7=void 0,e.m_8=void 0,e.m_9=void 0,e}return n(e,t),e.prototype.setData=function(t){this.m_name.string=0!=t.length?"["+t[0][4]+"]"+t[0][6]:"";for(var e=0;e<10;e++){var i="";t[e+1]&&(i="["+t[e+1][4]+"]"+t[e+1][6]),this["m_"+e].string=i}},e.prototype.setReward=function(t,e){this.m_reward0.string=t,this.m_reward1.string=e},a([r(cc.Label)],e.prototype,"m_reward0",void 0),a([r(cc.Label)],e.prototype,"m_reward1",void 0),a([r(cc.Label)],e.prototype,"m_name",void 0),a([r(cc.Node)],e.prototype,"m_layout",void 0),a([r(cc.Label)],e.prototype,"m_0",void 0),a([r(cc.Label)],e.prototype,"m_1",void 0),a([r(cc.Label)],e.prototype,"m_2",void 0),a([r(cc.Label)],e.prototype,"m_3",void 0),a([r(cc.Label)],e.prototype,"m_4",void 0),a([r(cc.Label)],e.prototype,"m_5",void 0),a([r(cc.Label)],e.prototype,"m_6",void 0),a([r(cc.Label)],e.prototype,"m_7",void 0),a([r(cc.Label)],e.prototype,"m_8",void 0),a([r(cc.Label)],e.prototype,"m_9",void 0),e=a([o],e)}(cc.Component);i.Double11LottoItemView=s,cc._RF.pop()},{}],Double11LottoPanel:[function(t,e,i){"use strict";cc._RF.push(e,"a6805maqVhOC45MmUGnECwh","Double11LottoPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Double11LottoView"),o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e.node0=null,e.node1=null,e}return n(e,t),e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addLocalListeners(),this.initView(),this.refreshView()},e.prototype.onDisable=function(){td.EventUtil.unregisterAllEvents(this),this.view.deleteEventListeners(),t.prototype.onDisable.call(this)},e.prototype._addLocalListeners=function(){var t=td.EventUtil,e={};e[td.EventNameEnum.DOUBLE_11_REFRESH_LOTTO]=this.refreshView,this.view._onBtnDrawClickEvent.listen(this.onBtnJoin.bind(this)),t.registerEvents(e,this)},e.prototype.initView=function(){this.view.setDes(td.Language.Double11_Txt_12),this.view.setLevelLimit(cc.js.formatStr(td.Language.Double11_Txt_13,td.GetConfig("DOUBLE_ELEVEN_LOTTO_LEVEL_LIMIT")))},e.prototype.refreshView=function(){var t=this.getActivityController();if(t){this.view.setBtnState(t.getJoin(),this.isActivityOver()||this.isActivity21());var e=this.getOpenStr(!0);this.view.setDurTime(e),this.view.setDialogActive(this.isShowDialog()),this.isActivityOver()&&this.view.setDurTime("");for(var i=0;i<2;i++){var n=this["node"+i].getComponent("Double11LottoItemView");n&&(n.setData(t.getNameList(i)),n.setReward(td.Language["ActivityWord"+(3+2*i)],td.Language["ActivityWord"+(4+2*i)]))}}},e.prototype.isShowDialog=function(){var t=this._controller.getCurrentOpenStage();if(!t)return!1;var e=t.openTime,i=td.TimeUtil.getTime()-e;return i>=0&&i<=756e5},e.prototype.isActivity21=function(){var t=this._controller.getCurrentOpenStage();return!!t&&t.showTime-108e5-td.TimeUtil.getTime()<=0},e.prototype.onBtnJoin=function(){if(td.Account.getUserData().getLevel()<td.GetConfig("DOUBLE_ELEVEN_LOTTO_LEVEL_LIMIT"))td.GlobalFunction.showBroadcastTip(517);else{this._controller.operateActivity({}),td.GlobalFunction.showBroadcastTip(516)}},a([l(r.Double11LottoView)],e.prototype,"view",void 0),a([l(cc.Node)],e.prototype,"node0",void 0),a([l(cc.Node)],e.prototype,"node1",void 0),e=a([s,c("module/Activity/Double11LottoPanel")],e)}(t("ActivityBasePanel"));i.default=u,cc._RF.pop()},{"./Double11LottoView":"Double11LottoView",ActivityBasePanel:"ActivityBasePanel"}],Double11LottoView:[function(t,e,i){"use strict";cc._RF.push(e,"73a1eDBGRNJq6qTptH4D9B+","Double11LottoView");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.Double11LottoView=void 0;var r=t("../../../../Common/EventTrigger"),o=cc._decorator.property,s=cc._decorator.ccclass,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_draw=void 0,e.m_btn=void 0,e.m_levelLimit=void 0,e.m_durTime=void 0,e.m_time=void 0,e.m_des=void 0,e.m_end=void 0,e.m_dialog=void 0,e.m_effect=void 0,e._onBtnDrawClickEvent=new r.EventTrigger,e}return n(e,t),e.prototype.deleteEventListeners=function(){this._onBtnDrawClickEvent.unAlllisten()},e.prototype.setLevelLimit=function(t){this.m_levelLimit.string=t},e.prototype.setDurTime=function(t){this.m_durTime.string=t,this.m_end.active=""==t,this.m_time.active=""!=t},e.prototype.setDes=function(t){this.m_des.string=t},e.prototype.onBtnDraw=function(){this._onBtnDrawClickEvent.trigger()},e.prototype.setBtnState=function(t,e){td.GlobalFunction.setButtonGray(this.m_draw.node,t||e),this.m_effect.active=!t&&!e,td.RedPointUtil.createRedPointSimple(this.m_draw.node,{x:-15,y:-15},!t&&!e),this.m_btn.string=t?td.Language.ActivityWord2:td.Language.ActivityWord1,t||e||(this.m_btn.node.color=cc.color(165,19,19))},e.prototype.setDialogActive=function(t){this.m_dialog.active=t},a([o(cc.Button)],e.prototype,"m_draw",void 0),a([o(cc.Label)],e.prototype,"m_btn",void 0),a([o(cc.Label)],e.prototype,"m_levelLimit",void 0),a([o(cc.Label)],e.prototype,"m_durTime",void 0),a([o(cc.Node)],e.prototype,"m_time",void 0),a([o(cc.Label)],e.prototype,"m_des",void 0),a([o(cc.Node)],e.prototype,"m_end",void 0),a([o(cc.Node)],e.prototype,"m_dialog",void 0),a([o(cc.Node)],e.prototype,"m_effect",void 0),e=a([s],e)}(cc.Component);i.Double11LottoView=l,cc._RF.pop()},{"../../../../Common/EventTrigger":"EventTrigger"}],Double11PreviewConfig:[function(t,e,i){"use strict";cc._RF.push(e,"af47b73hLhE6L0B1pW+0Yje","Double11PreviewConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Double11PreviewConfig",e._tblName="activity_2009_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getCfgsByDataId=function(t){if(!this._data)return null;var e=this._data[t];return e||cc.error("====> \u53cc11 \u8868 activity_2009_config \u6ca1\u6709\u5bf9\u5e94\u914d\u7f6eid: ",t),e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],Double11PreviewManager:[function(t,e,i){"use strict";cc._RF.push(e,"85ad5igdcVJL7GBblhL/XYo","Double11PreviewManager");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("./Double11PreviewViewModel"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._openDay=0,e._receiveStages={},e._dataModels=null,e._isInit=!1,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e)},e.prototype.addLocalEventListener=function(){t.prototype.addLocalEventListener.call(this);var e={};e[td.EventNameEnum.DOUBLE_11_PREVIEW_RECEIVE]=this._onRequestReceive,e[td.EventNameEnum.USER_ATTR_LEVEL_CHANGE]=this._onRequestActivityInfo,e[td.EventNameEnum.ON_TIME_OVER_DAY]=this._onTimeDayOver,td.EventUtil.registerEvents(e,this)},e.prototype.activityParse=function(t){if(t){this._isInit||(this._initDataModels(),!0);var e=t.record,i=[];for(var n in e&&(i=e.receiveList||[],this._openDay=e.day),this._dataModels){var a=this._dataModels[n];-1!=i.indexOf(Number(n))?a.setReceived(!0):a.setReceived(!1),a.setPassed(this._openDay>Number(n)),a.setCurDay(this._openDay)}this._isInit=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_PREVIEW_GET_INFO),td.EventUtil.dispatchEvent(td.EventNameEnum.CLOSE_NEWSYSTEMOPEN_WINDOW,!0)}},e.prototype._initDataModels=function(){var t=this.getActivityData(),e=td.GetTableClass(td.TableEnum.Double11PreviewConfig);if(e){var i=e.getCfgsByDataId(t);if(i){this._dataModels={};for(var n=0;n<i.length;n++){var r=i[n],o=this._dataModels[r.day];o||(o=new a.default).init(r),this._dataModels[r.day]=o}}else this._isInit=!1}else this._isInit=!1},e.prototype._onRequestReceive=function(){this.operateActivity({})},e.prototype._onRequestActivityInfo=function(){if(this.isInOpenStatus()){var t=td.Account.getUserData().getLevel(),e=this._activityOpen._openConfig.level;!this._isInit&&t>=e&&td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,this.getActivityId)}},e.prototype._onTimeDayOver=function(){this.isInOpenStatus()&&(td.Account.getUserData().getLevel()>=this._activityOpen._openConfig.level&&td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,this.getActivityId))},e.prototype.getOpenDay=function(){return this._openDay},e.prototype.getPreviewDataList=function(){return this._dataModels?this._dataModels.values():[]},e.prototype.hasRedPoint=function(){return!0},e.prototype._isWaitingReceive=function(){if(!this._dataModels)return!1;var t=this._dataModels[this._openDay];return!t||!t.isReceived()},e.prototype._isItemCanReceive=function(t){if(!this._dataModels)return!1;var e=this._dataModels[t];return this._openDay==t&&!e.isReceived()},e.prototype.isRedPointTip=function(){return this._isWaitingReceive()},e.prototype.redPointEvts=function(){return[td.EventNameEnum.DOUBLE_11_PREVIEW_GET_INFO]},e}(t("ActivityBaseController"));i.default=r,e.exports=r,cc._RF.pop()},{"./Double11PreviewViewModel":"Double11PreviewViewModel",ActivityBaseController:"ActivityBaseController"}],Double11PreviewViewModel:[function(t,e,i){"use strict";cc._RF.push(e,"8ced1iSTVdI/qK48omXNCW0","Double11PreviewViewModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._openDay=0,this._reward=[],this._isRewardReceive=!1,this._isPassed=!1,this._isCurDay=!1}return t.prototype.init=function(t){this._openDay=t.day,this._reward=t.reward},t.prototype.getRewardModel=function(){return td.RewardManager.parseRewardListDetail(this._reward)[0]},t.prototype.getOpenDay=function(){return this._openDay},t.prototype.isReceived=function(){return this._isRewardReceive},t.prototype.setReceived=function(t){this._isRewardReceive=t},t.prototype.isPassed=function(){return this._isPassed},t.prototype.setPassed=function(t){this._isPassed=t},t.prototype.setCurDay=function(t){this._isCurDay=this._openDay==t},t.prototype.isCurDay=function(){return this._isCurDay},t}();i.default=n,cc._RF.pop()},{}],Double11PreviewWindowController:[function(t,e,i){"use strict";cc._RF.push(e,"06b86nQG0JEjKEeZtkQzK9e","Double11PreviewWindowController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Double11PreviewWindow"),o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.panelView=null,e._activeController=null,e._curHourList=[],e._isNewRequest=!1,e}return n(e,t),e.prototype.init=function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_Double11Preview},e.prototype.onEnable=function(){if(t.prototype.onEnable.call(this),this._addEventListners(),this._activeController=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.Double11_Preview),this._activeController){var e=this._activeController.getActivityId();this._activeController._isInit||(td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,e),this._isNewRequest=!0)}},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),td.EventUtil.unregisterAllEvents(this),gdk.Timer.clearAll(this)},e.prototype._addEventListners=function(){var t={};t[td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]=this._onReceiveOperation,t[td.EventNameEnum.DOUBLE_11_PREVIEW_GET_INFO]=this._onGetPreviewInfo,td.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){if(t.prototype.setData.call(this,e),this._activeController){var i=this._activeController.getPreviewDataList();this.panelView.refreshView(i);for(var n=0;n<i.length;n++){var a=i[n],r=this.panelView.nodeItems.getChildByName("item"+n);td.RedPointUtil.createRedPointOld(r,cc.v2(-15,-15),this._activeController._isItemCanReceive.bind(this._activeController,a.getOpenDay()),this._activeController.redPointEvts())}}},e.prototype._onGetPreviewInfo=function(){this.setData(null)},e.prototype._onReceiveOperation=function(t){if(t.activityId===this._activeController.getActivityId()){var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);td.GlobalFunction.showRewards(i),this._activeController.parseRewardReceived(t)}},e.prototype.onBtnReceiveClick=function(t){var e=t.currentTarget.itemData;e?e.getOpenDay()==this._activeController.getOpenDay()&&(e.isReceived()?td.GlobalFunction.showBroadcastTip(119):td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_PREVIEW_RECEIVE)):cc.error("====> \u8fd9\u9886\u53d6\u6309\u94ae\u4e0a\uff0c\u600e\u4e48\u6ca1\u7ed1\u5b9a\u7269\u54c1\u6570\u636e\u554a\uff1f\uff1f")},a([l(r.default)],e.prototype,"panelView",void 0),e=a([s,c("module/Double11/Double11PreviewWindowController")],e)}(t("PanelBase"));i.default=u,cc._RF.pop()},{"./Double11PreviewWindow":"Double11PreviewWindow",PanelBase:void 0}],Double11PreviewWindow:[function(t,e,i){"use strict";cc._RF.push(e,"d09c0KA5C5JC4enijmMkkPA","Double11PreviewWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labRich1=null,e.labRich2=null,e.labRich3=null,e.labTime1=null,e.labTime2=null,e.labTime3=null,e.nodeItems=null,e.nodeItemModel=null,e._activyController=null,e._curHourList=[],e}return n(e,t),e.prototype.onEnable=function(){this.labRich1.string=td.Language.Double11_Txt_4,this.labRich2.string=td.Language.Double11_Txt_5,this.labRich3.string=td.Language.Double11_Txt_6,this.labTime1.string=td.Language.Double11_Txt_7,this.labTime2.string=td.Language.Double11_Txt_8,this.labTime3.string=td.Language.Double11_Txt_9},e.prototype.refreshView=function(t){if(t)for(var e=0;e<t.length;e++){var i=t[e],n=this.nodeItems.getChildByName("item"+e);n||((n=cc.instantiate(this.nodeItemModel)).name="item"+e,n.parent=this.nodeItems,n.y=0,n.active=!0),this._refreshItemNode(n,i)}},e.prototype._refreshItemNode=function(t,e){if(t)if(e){var i=t.getChildByName("imgBg1"),n=t.getChildByName("imgBg2");i.active=!e.isReceived()&&e.isCurDay(),n.active=!i.active;var a=t.getChildByName("btn"),r=a.getComponent(cc.Label);a.itemData=e,a.getComponent(cc.Button).interactable=i.active,i.active?(r.string=td.Language.clickReceive,a.color=cc.color(255,255,255)):(a.color=cc.color(182,112,56),e.isReceived()?r.string=td.Language.recevied:e.isPassed()?r.string=td.Language.isTimePassed:r.string=td.Language["Double11_Txt_x"+e.getOpenDay()]),r._forceUpdateRenderData(),t.getChildByName("imgReceive").active=e.isReceived();var o=t.getChildByName("nodeItem"),s=o.getChildByName("itemIcon");if(s)s.getComponent("CommonIconWidget").setData(e.getRewardModel());else(s=td.GlobalFunction.createCommonIconWidget(26,e.getRewardModel())).parent=o,s.y=0,s.name="itemIcon"}else t.active=!1},a([s(cc.RichText)],e.prototype,"labRich1",void 0),a([s(cc.RichText)],e.prototype,"labRich2",void 0),a([s(cc.RichText)],e.prototype,"labRich3",void 0),a([s(cc.Label)],e.prototype,"labTime1",void 0),a([s(cc.Label)],e.prototype,"labTime2",void 0),a([s(cc.Label)],e.prototype,"labTime3",void 0),a([s(cc.Node)],e.prototype,"nodeItems",void 0),a([s(cc.Node)],e.prototype,"nodeItemModel",void 0),e=a([o,l("module/Double11/Double11PreviewWindow")],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],Double11ProductConfig:[function(t,e,i){"use strict";cc._RF.push(e,"3cba6mJnkBHUpnDJFVgkukr","Double11ProductConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Double11ProductConfig",e._tblName="activity_double_11_product_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.id;t[r]||(t[r]={}),t[r]=a}},e.prototype.getProductById=function(t){if(!this._data)return null;var e=this._data[t];return e||cc.error("====> \u53cc11 \u8868 activity_double_11_product_config \u6ca1\u6709\u5546\u54c1id: ",t),e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],Double11RankConfig:[function(t,e,i){"use strict";cc._RF.push(e,"7c4d7XO0spLjr3MuyBOlAl9","Double11RankConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Double11RankConfig",e._tblName="double_eleven_consume_rank_config",e._data={},e}return n(e,t),e.prototype.init=function(){for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t],i=e.data;this._data[i]||(this._data[i]={}),this._data[i][e.rank]=e}},e.prototype.getCfgsByDataId=function(t){if(!this._data)return null;var e=this._data[t];return e||cc.error("====> \u53cc11\u6392\u884c\u699c\u8868 double_eleven_consume_rank_config \u6ca1\u6709\u5bf9\u5e94\u914d\u7f6eid: ",t),e},e.prototype.getJoinRewardByDataId=function(t){return this.getCfgsByDataId(t)[0]},e.prototype.getListByDataId=function(t){var e=[],i=this.getCfgsByDataId(t);for(var n in i)Number(n)>0&&e.push(i[n]);return e.sort(this.sortFunc),e},e.prototype.sortFunc=function(t,e){return t.rank-e.rank},e.prototype.getMaxRankByDataId=function(t){return this.getListByDataId(t).pop().rank},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],Double11RankController:[function(t,e,i){"use strict";cc._RF.push(e,"4342d8RljdAppwttVOwyTB9","Double11RankController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("ActivityBaseController"),r=t("./Double11RankModel"),o=t("./Double11IntergralModel"),s=window.td,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._myRank=0,e._myScore=0,e._rankModels=[],e._intergralModels=[],e.redPoint=!1,e}return n(e,t),e.prototype.activityParse=function(t){var e=t.global;if(e){var i=t.record;this._myScore=i.score,this._myRank=0;var n=s.Account.getUserData().getGamerId();this._rankModels=[];for(var a=e.rankList,l=this.getActivityData(),c=s.GetTableClass(s.TableEnum.Double11RankConfig).getMaxRankByDataId(l),u=0;u<c;u++){var d=new r.default;if(d.initData(u+1),this._rankModels.push(d),a[u])d.upData(a[u]),n==d.getBaseUser().getGamerId()&&(this._myRank=d.getRank())}var h=new r.default;h.setJoinReward(),this._rankModels.push(h);var p=i.receiveList;this._intergralModels=[];var _=s.GetTableClass(s.TableEnum.Double11IntegralConfig).getListByDataId(l);this.redPoint=!1;for(u=0;u<_.length;u++){var g=new o.default;g.upData(_[u]),this._intergralModels.push(g),g.getScore()<=this._myScore?-1!=p.indexOf(g.getScore())?g.setState(s.ActivityEnum.Double11IntegralState.RECEIVED):(g.setState(s.ActivityEnum.Double11IntegralState.CAN_RECEIVE),this.redPoint=!0):g.setState(s.ActivityEnum.Double11IntegralState.UNFINISHED)}this._intergralModels.sort(this.sortFunc),s.EventUtil.dispatchEvent(s.EventNameEnum.DOUBLE11_RANK_REFRESH_UI)}},e.prototype.getJoinScore=function(){return s.GetTableClass(s.TableEnum.Config).getConfig("RANKING_CRITERIA")},e.prototype.getMyRank=function(){return this._myRank},e.prototype.getMyScore=function(){return this._myScore},e.prototype.getRankModels=function(){return this._rankModels},e.prototype.getIntergralModels=function(){return this._intergralModels},e.prototype.reqActInfo=function(){s.EventUtil.dispatchEvent(s.EventNameEnum.Req_GET_ACTIVITY_INFO,this._activityId)},e.prototype.sortFunc=function(t,e){return t.getState()-e.getState()},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){return this.redPoint},e}(a);i.default=l,e.exports=l,cc._RF.pop()},{"./Double11IntergralModel":"Double11IntergralModel","./Double11RankModel":"Double11RankModel",ActivityBaseController:"ActivityBaseController"}],Double11RankItem:[function(t,e,i){"use strict";cc._RF.push(e,"23a09tduABOCawPy+yCgeAY","Double11RankItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labRank=null,e.imgRank=null,e.nodeReward=null,e.playerName=null,e.score=null,e.setWaite=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i,a=this._customData;if(n.getIsJoinReward()){this.playerName.node.active=!1,this.score.node.active=!1,this.setWaite.node.active=!0,this.setWaite.string=r.Language.Double11RankJoinReward,this.labRank.node.active=!1,this.imgRank.active=!0,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Acitivty_59_s11,"HD_s11_cyj",this.imgRank);var o=r.GetTableClass(r.TableEnum.Double11RankConfig).getJoinRewardByDataId(a).rankRewards;this.setNodeReward(o)}else{n.getRank()<=3?(this.labRank.node.active=!1,this.imgRank.active=!0,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.GY0_Common,"GY0_paiming_0"+n.getRank(),this.imgRank)):(this.labRank.node.active=!0,this.imgRank.active=!1,this.labRank.string=n.getRank());for(var s=r.GetTableClass(r.TableEnum.Double11RankConfig).getListByDataId(a),l=[],c=0;c<s.length;c++)if(n.getRank()<=s[c].rank){l=s[c].rankRewards;break}this.setNodeReward(l),n.getIsHavePlayer()?(this.playerName.node.active=!0,this.score.node.active=!0,this.setWaite.node.active=!1,this.playerName.string=n.getBaseUser().getServerNickName(!0),this.score.string=n.getScore()):(this.playerName.node.active=!1,this.score.node.active=!1,this.setWaite.node.active=!0,this.setWaite.string=r.Language.setWaite)}},e.prototype.setNodeReward=function(t){for(var e=this.nodeReward.children,i=0;i<e.length;i++)i+1>t.length&&(e[i].active=!1);for(var n=0;n<t.length;n++){var a=this.nodeReward.getChildByName("icon"+n),o=r.RewardManager.getRewardDetail(t[n]);a||(a=r.GlobalFunction.createCommonIconWidget(26,o),this.nodeReward.addChild(a),a.name="icon"+n,a.scale=.9,a.zIndex=n,a.$tag=t[n]);var s=a.getComponent("CommonIconWidget");t[n][0]==a.$tag[0]&&t[n][1]==a.$tag[1]&&t[n][2]==a.$tag[2]||(s.setData(o),a.$tag=t[n]),a.active=!0}},a([c(cc.Label)],e.prototype,"labRank",void 0),a([c(cc.Node)],e.prototype,"imgRank",void 0),a([c(cc.Node)],e.prototype,"nodeReward",void 0),a([c(cc.Label)],e.prototype,"playerName",void 0),a([c(cc.Label)],e.prototype,"score",void 0),a([c(cc.Label)],e.prototype,"setWaite",void 0),e=a([l],e)}(o);i.default=u,cc._RF.pop()},{ListItem:void 0}],Double11RankModel:[function(t,e,i){"use strict";cc._RF.push(e,"5df6bjGbzFGE6nTIaV3CW4L","Double11RankModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("BaseUser"),a=function(){function t(){this._rank=null,this._score=null,this._userInfo=null,this._isHavePlayer=!1,this._isJoinReward=!1}return t.prototype.initData=function(t){this._rank=t},t.prototype.upData=function(t){this._isHavePlayer=!0,this._rank=t.rank,this._score=t.score,this._userInfo=new n,this._userInfo.init("",t.attributes)},t.prototype.setJoinReward=function(){this._isJoinReward=!0},t.prototype.getRank=function(){return this._rank},t.prototype.getScore=function(){return this._score},t.prototype.getBaseUser=function(){return this._userInfo},t.prototype.getIsHavePlayer=function(){return this._isHavePlayer},t.prototype.getIsJoinReward=function(){return this._isJoinReward},t}();i.default=a,cc._RF.pop()},{BaseUser:"BaseUser"}],Double11RankPanel:[function(t,e,i){"use strict";cc._RF.push(e,"6b1f2dJ/21OGIEeCdp79Ziy","Double11RankPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=window.td,c=t("ActivityBasePanel"),u=(t("Double11FundScrollWidget"),t("./Double11RankView")),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e._controller=null,e}return n(e,t),e.prototype.onLoad=function(){this._controller||(this._controller=l.ActivityDataManager.getActivityControllerByType(l.ActivityEnum.ActivityType.Double11Rank))},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.addListener(),this._refreshUI(),this._setActivityTime(),this._reqActInfo(),this.schedule(this._reqActInfo,5)},e.prototype.onDisable=function(){this.unschedule(this._reqActInfo),this.deleteListener(),t.prototype.onDisable.call(this)},e.prototype.addListener=function(){this.view._onBtnIntegralRewardClickEvent.listen(this.openIntegralWindow.bind(this)),this.view._onBtnHelpClickEvent.listen(this.showHelpWidget.bind(this)),l.EventUtil.registerEvent(l.EventNameEnum.DOUBLE11_RANK_REFRESH_UI,this._refreshUI,this),l.EventUtil.registerEvent(l.EventNameEnum.ON_TIME_OVER_DAY,this._setActivityTime,this)},e.prototype.deleteListener=function(){l.EventUtil.unregisterAllEvents(this),this.view.deleteEventListeners()},e.prototype._refreshUI=function(){var t={};t.joinScore=this._controller.getJoinScore(),t.myRank=this._controller.getMyRank(),t.myScore=this._controller.getMyScore(),t.rankModels=this._controller.getRankModels(),t.red=this._controller.isRedPointTip(),t.dataId=this._controller.getActivityData(),this.view.setUI(t)},e.prototype._setActivityTime=function(){var t=this.getActivityShowTimeStr(),e=new Date(t),i=l.Language.timePattern5,n=e.pattern(i);this.view.setEndTime(n,this.isActivityOver())},e.prototype._reqActInfo=function(){this._controller.reqActInfo()},e.prototype.openIntegralWindow=function(){l.PanelJumpManager.jumpToPanel(l.PanelEnum.Window_Double11Integral)},a([s(u.default)],e.prototype,"view",void 0),e=a([o],e)}(c);i.default=d,cc._RF.pop()},{"./Double11RankView":"Double11RankView",ActivityBasePanel:"ActivityBasePanel",Double11FundScrollWidget:"Double11FundScrollWidget"}],Double11RankView:[function(t,e,i){"use strict";cc._RF.push(e,"ccb1ez+SvRKkIpGIQeKFi8p","Double11RankView");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator.property,o=cc._decorator.ccclass,s=window.td,l=t("../../../../Common/EventTrigger"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.joinScoreLabel=void 0,e.end=void 0,e.endTimeLabel=void 0,e.myRankLabel=void 0,e.myRankWSB=void 0,e.myIntegralLabel=void 0,e.nodeRank=void 0,e.rankScrollview=void 0,e.btnIntegral=void 0,e._isInitRankList=!1,e._onBtnIntegralRewardClickEvent=new l.EventTrigger,e._onBtnHelpClickEvent=new l.EventTrigger,e}return n(e,t),e.prototype.deleteEventListeners=function(){this._onBtnIntegralRewardClickEvent.unAlllisten(),this._onBtnHelpClickEvent.unAlllisten()},e.prototype.setUI=function(t){this.joinScoreLabel.string=t.joinScore,0==t.myRank?(this.myRankLabel.node.active=!1,this.myRankWSB.active=!0):(this.myRankWSB.active=!1,this.myRankLabel.node.active=!0,this.myRankLabel.string=t.myRank),this.myIntegralLabel.string=t.myScore;var e=this.nodeRank.getComponent("OptimizeVerticalListView");this._isInitRankList?e.refreshCurList(t.rankModels):(e.refreshListData(t.rankModels),this._isInitRankList=!0),e.setCustomData(t.dataId),this.setRedPointOnBtn(t.red)},e.prototype.setEndTime=function(t,e){e?(this.end.active=!0,this.endTimeLabel.node.parent.active=!1):(this.endTimeLabel.node.parent.active=!0,this.endTimeLabel.string=t,this.end.active=!1)},e.prototype.onBtnIntegralReward=function(){this._onBtnIntegralRewardClickEvent.trigger()},e.prototype.onBtnHelp=function(){this._onBtnHelpClickEvent.trigger()},e.prototype.setRedPointOnBtn=function(t){s.RedPointUtil.createRedPointSimple(this.btnIntegral,{x:-15,y:-15},t)},a([r(cc.Label)],e.prototype,"joinScoreLabel",void 0),a([r(cc.Node)],e.prototype,"end",void 0),a([r(cc.Label)],e.prototype,"endTimeLabel",void 0),a([r(cc.Label)],e.prototype,"myRankLabel",void 0),a([r(cc.Node)],e.prototype,"myRankWSB",void 0),a([r(cc.Label)],e.prototype,"myIntegralLabel",void 0),a([r(cc.Node)],e.prototype,"nodeRank",void 0),a([r(cc.ScrollView)],e.prototype,"rankScrollview",void 0),a([r(cc.Node)],e.prototype,"btnIntegral",void 0),e=a([o],e)}(cc.Component);i.default=c,cc._RF.pop()},{"../../../../Common/EventTrigger":"EventTrigger"}],Double11ShopConfig:[function(t,e,i){"use strict";cc._RF.push(e,"ff9bevEWaNCwZzjgTW2p8P1","Double11ShopConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="Double11ShopConfig",e._tblName="activity_2004_stage_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]=a}},e.prototype.getCfgByDataId=function(t){if(!this._data)return null;var e=this._data[t];return e||cc.error("====> \u53cc11 \u8868 activity_2004_stage_config \u6ca1\u6709\u5bf9\u5e94\u914d\u7f6eid: ",t),e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],Double11ShopItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"097afH9pA9Pz4VdL1EMoZqx","Double11ShopItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.Double11ShopItemUI=void 0;var r=cc._decorator.property,o=cc._decorator.ccclass,s=cc._decorator.menu,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_nodeItem=void 0,e.m_labItemName=void 0,e.m_btnBuy=void 0,e.m_labBtn=void 0,e.m_nodeOriginPrice=void 0,e.m_nodeNowPrice=void 0,e.m_nodeSelfCount=void 0,e.m_nodeAllCount=void 0,e.m_imgDelLine=void 0,e.m_imgSoldOut=void 0,e.m_imgBuyed=void 0,e._shopId=0,e._curItemData=null,e._curActivityType=null,e._controller=null,e}return n(e,t),e.prototype.onEnable=function(){this._addEventListener()},e.prototype.onDisable=function(){td.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListener=function(){var t={};t[td.EventNameEnum.DOUBLE_11_REFRESH_SHOP_ITEM]=this._refershItem,td.EventUtil.registerEvents(t,this)},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=this._customData.activityType;this._curActivityType=n,this._controller=td.ActivityDataManager.getActivityControllerByType(n),this._curItemData=i,this._shopId=i.getShopId(),this.m_labItemName.string=this._curItemData.getItemName(),td.GlobalFunction.setNameColors(this.m_labItemName.node,this._curItemData.getItemQuality());var a=this.m_nodeItem.getChildByName("itemIcon"),r=this._curItemData.getItemData();a||((a=td.GlobalFunction.createCommonIconWidget(26,r)).name="itemIcon",a.parent=this.m_nodeItem),a.getComponent("CommonIconWidget").setData(r),this._refreshPriceNode(this.m_nodeOriginPrice.node,this._curItemData.getOriginPrice(),this._curItemData.getCostItemIcon()),this._refreshPriceNode(this.m_nodeNowPrice.node,this._curItemData.getNowPrice(),this._curItemData.getCostItemIcon()),this._refershItem(this._shopId)},e.prototype._refreshPriceNode=function(t,e,i){if(t){var n=t.getChildByName("labPrice").getComponent(cc.Label),a=t.getChildByName("imgItemIcon"),r=e+"";this._curItemData.getChargeId()&&(r="\uffe5"+e),n.string=r,a.active=!!i,i&&td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,i,a)}},e.prototype._refreshCountNode=function(t,e,i){if(t){var n=t.getChildByName("labCount").getComponent(cc.Label);n.string=i?e+"/"+i:e+""}},e.prototype._refershItem=function(t){if(t==this._shopId&&(this._curItemData=this._controller.getShopModelByShopId(this._shopId),this._curItemData)){this.m_imgSoldOut.node.active=this._curItemData.isSoldOut(),this.m_imgBuyed.node.active=this._curItemData.isBoughtOut()&&!this._curItemData.isSoldOut(),this.m_btnBuy.node.active=!(this._curItemData.isBoughtOut()||this._curItemData.isSoldOut());var e="";if(this._curItemData.getChargeId()?(e+="\uffe5",e+=this._curItemData.getNowPrice()):e=td.Language.buy,this.m_labBtn.node.color=cc.color(209,109,1),this._controller.getModelByShopId){var i=this._controller.getModelByShopId(this._shopId);i&&!i.isInOpen()?(e=td.Language.closed,this.m_labBtn.node.color=cc.color(87,87,87),td.GlobalFunction.setButtonGray(this.m_btnBuy,!0)):td.GlobalFunction.setButtonGray(this.m_btnBuy,!1)}else td.GlobalFunction.setButtonGray(this.m_btnBuy,!1);this.m_labBtn.string=e,this._refreshCountNode(this.m_nodeSelfCount.node,this._curItemData.getSelfTotalCount()-this._curItemData.getSelfCurCount(),this._curItemData.getSelfTotalCount()),this._refreshCountNode(this.m_nodeAllCount.node,this._curItemData.getAllTotalCount()-this._curItemData.getAllCurCount(),0)}},e.prototype.onBtnBuyClick=function(){if(this._controller.getModelByShopId){var t=this._controller.getModelByShopId(this._shopId);if(t&&!t.isInOpen())return void td.GlobalFunction.showBroadcastTip(157)}if(this._curItemData.getChargeId()){var e=td.RechargeManager.getRechargeDataById(this._curItemData.getChargeId());e&&(this._controller.setRechargeData&&this._controller.setRechargeData(e),td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,e))}else{var i=this._curItemData.getCostItemData();if(i.getCount()>td.ItemManager.getItemNumById(i.getId()))return void td.GlobalFunction.showBroadcastTip(77,[i.getName()]);td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_BUY_ITEM,{activityType:this._curActivityType,shopId:this._shopId})}},a([r(cc.Node)],e.prototype,"m_nodeItem",void 0),a([r(cc.Label)],e.prototype,"m_labItemName",void 0),a([r(cc.Button)],e.prototype,"m_btnBuy",void 0),a([r(cc.Label)],e.prototype,"m_labBtn",void 0),a([r(cc.Layout)],e.prototype,"m_nodeOriginPrice",void 0),a([r(cc.Layout)],e.prototype,"m_nodeNowPrice",void 0),a([r(cc.Layout)],e.prototype,"m_nodeSelfCount",void 0),a([r(cc.Layout)],e.prototype,"m_nodeAllCount",void 0),a([r(cc.Sprite)],e.prototype,"m_imgDelLine",void 0),a([r(cc.Sprite)],e.prototype,"m_imgSoldOut",void 0),a([r(cc.Sprite)],e.prototype,"m_imgBuyed",void 0),e=a([o,s("module/Double11/Double11ShopItemUI")],e)}(t("ListItem"));i.Double11ShopItemUI=l,cc._RF.pop()},{ListItem:void 0}],Double11ShopItemViewModel:[function(t,e,i){"use strict";cc._RF.push(e,"69e4eE6H8ZELJ1QeJep+7YE","Double11ShopItemViewModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._shopId=0,this._chargeId=0,this._selfTotalCount=0,this._allTotalCount=0,this._itemData=null,this._costItemId=0,this._costItemData=null,this._originPrice=0,this._nowPrice=0,this._selfCurCount=0,this._allCurCount=0}return t.prototype.init=function(t){this._shopId=t.id,this._chargeId=t.chargeId,this._originPrice=t.originalPrice,this._selfTotalCount=t.limitTimes;var e=[],i=[];if(this._chargeId){var n=td.GetTableClass(td.TableEnum.ChargeCommodityConfig).getDataByChargeId(this._chargeId);e=td.RewardManager.parseRewardListDetail(n.reward),this._nowPrice=n.goodsNumber/10}else e=td.RewardManager.parseRewardListDetail(t.product),i=td.RewardManager.parseRewardListDetail(t.price),this._costItemData=i[0],this._nowPrice=this._costItemData.getCount(),this._costItemId=this._costItemData.getId();this._itemData=e[0],this._allTotalCount=t.totalLimitTimes},t.prototype.getShopId=function(){return this._shopId},t.prototype.getItemData=function(){return this._itemData},t.prototype.getItemName=function(){return this.getItemData().getName()},t.prototype.getItemQuality=function(){return this.getItemData().getQuality()},t.prototype.getCostItemIcon=function(){return this._costItemData?this._costItemData.getLittleIconResPath():""},t.prototype.getCostItemId=function(){return this._costItemId},t.prototype.getCostItemData=function(){return this._costItemData},t.prototype.getChargeId=function(){return this._chargeId},t.prototype.getOriginPrice=function(){return this._originPrice},t.prototype.getNowPrice=function(){return this._nowPrice},t.prototype.getSelfCurCount=function(){return this._selfCurCount},t.prototype.setSelfCurCount=function(t){this._selfCurCount=t},t.prototype.getSelfTotalCount=function(){return this._selfTotalCount},t.prototype.getAllCurCount=function(){return this._allCurCount},t.prototype.setAllCurCount=function(t){this._allCurCount=t},t.prototype.getAllTotalCount=function(){return this._allTotalCount},t.prototype.isBoughtOut=function(){return this._selfCurCount>=this._selfTotalCount},t.prototype.isSoldOut=function(){return this._allCurCount>=this._allTotalCount},t}();i.default=n,cc._RF.pop()},{}],Double11ShopManager:[function(t,e,i){"use strict";cc._RF.push(e,"00c5aWcFXhKvIZ+ScKZOua/","Double11ShopManager");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("./Double11ShopItemViewModel"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._totalBuyMap={},e._buyMap={},e._dataModels=null,e._isInit=!1,e._curRechargeData=null,e._isPanelShowed=!1,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this._dataID=this.getActivityData()},e.prototype.clearData=function(){t.prototype.clearData.call(this),this._isInit=!1,this._dataModels=null},e.prototype.addLocalEventListener=function(){t.prototype.addLocalEventListener.call(this);var e={};e[td.EventNameEnum.DOUBLE_11_BUY_ITEM]=this._onRequestBuy,e[td.EventNameEnum.Recharge_Success]=this._onRechargeSucc,e[td.EventNameEnum.USER_ATTR_LEVEL_CHANGE]=this._onRequestActivityInfo,td.EventUtil.registerEvents(e,this)},e.prototype.activityParse=function(t){if(t){this._isInit||this._initDataModels();var e=t.global,i=t.record,n=[];if(e){var a=e.totalBuyMap||{};for(var r in a){var o=a[r];-1==n.indexOf(Number(r))&&n.push(Number(r)),(l=this._dataModels[r])&&(l.setAllCurCount(o),td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_REFRESH_SHOP_ITEM,r))}}if(i){var s=i.buyMap||{};for(var r in s){var l;o=s[r];-1==n.indexOf(Number(r))&&n.push(Number(r)),(l=this._dataModels[r])&&(l.setSelfCurCount(o),td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_REFRESH_SHOP_ITEM,r))}}for(var c=0;c<n.length;c++){r=n[c];td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_REFRESH_SHOP_ITEM,r)}this._isInit=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_SHOP_GET_INFO)}},e.prototype._onRequestBuy=function(t){if(t.activityType==this.getActivityType()){var e={};e.id=t.shopId,this.operateActivity(e)}},e.prototype._onRechargeSucc=function(t){if(t&&this._curRechargeData&&this._curRechargeData.getChargeId()==t.getChargeId()){var e=this._getShowRewardList(t.getReward());td.GlobalFunction.showRewards(e),this.setRechargeData(null)}},e.prototype._onRequestActivityInfo=function(){var t=td.Account.getUserData().getLevel(),e=this._activityOpen._openConfig.level;!this._isInit&&t>=e&&td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,this.getActivityId)},e.prototype._getShowRewardList=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],a={};a.type=n[0],a.id=n[1],a.count=n[2],e[e.length]=a}return e=td.RewardManager.convertCfgType2GoodsType(e)},e.prototype._initDataModels=function(){var t=this.getActivityData(),e=td.GetTableClass(td.TableEnum.Double11ShopConfig);if(e){var i=e.getCfgByDataId(t);this._dataModels={};for(var n=0;n<i.products.length;n++){var r=i.products[n],o=this._dataModels[r];if(!o){o=new a.default;var s=td.GetTableClass(td.TableEnum.Double11ProductConfig);if(!s)return void cc.error("=======> ??\u600e\u4e48\u6ca1\u914d\u7f6e\u8868\u6570\u636e\uff1f activity_2003_product_config");var l=s.getProductById(r);o.init(l)}this._dataModels[r]=o}}},e.prototype.getShopModelList=function(){return this._dataModels?this._dataModels.values():[]},e.prototype.getShopModelByShopId=function(t){for(var e in this._dataModels){var i=this._dataModels[e];if(i&&t==Number(e))return i}return null},e.prototype.setRechargeData=function(t){this._curRechargeData=t},e.prototype.openPanel=function(){this._isPanelShowed=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_11_SHOP_PANEL_OPEN)},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){return!this._isPanelShowed},e.prototype.redPointEvts=function(){return[td.EventNameEnum.DOUBLE_11_SHOP_PANEL_OPEN,td.EventNameEnum.DOUBLE_11_SHOP_GET_INFO]},e}(t("ActivityBaseController"));i.default=r,e.exports=r,cc._RF.pop()},{"./Double11ShopItemViewModel":"Double11ShopItemViewModel",ActivityBaseController:"ActivityBaseController"}],Double11ShopPanelController:[function(t,e,i){"use strict";cc._RF.push(e,"0f854pQetJBILHD6ykFiwWH","Double11ShopPanelController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./Double11ShopPanel"),o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=window.td,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.panelView=null,e._isNewRequest=!1,e._activeController=null,e}return n(e,t),e.prototype.onEnable=function(){if(t.prototype.onEnable.call(this),this._addEventListners(),this._activeController=u.ActivityDataManager.getActivityControllerByType(u.ActivityEnum.ActivityType.Double11_Shop),this._activeController){var e=this._activeController.getActivityId();if(!this._activeController._isInit)return u.EventUtil.dispatchEvent(u.EventNameEnum.Req_GET_ACTIVITY_INFO,e),void(this._isNewRequest=!0);this._setData()}},e.prototype._setData=function(){this.panelView.setActivityTime(this.getDurationStr(!0));var t=this._activeController.getShopModelList();this.panelView.refreshItemScroll(t),this._activeController.openPanel()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),u.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListners=function(){var t={};t[u.EventNameEnum.DOUBLE_11_SHOP_GET_INFO]=this._onGetShopInfo,u.EventUtil.registerEvents(t,this)},e.prototype._onGetShopInfo=function(){this._isNewRequest&&(this._setData(),this._isNewRequest=!1)},a([l(r.Double11ShopPanel)],e.prototype,"panelView",void 0),e=a([s,c("module/Double11/Double11ShopPanelController")],e)}(t("ActivityBasePanel"));i.default=d,cc._RF.pop()},{"./Double11ShopPanel":"Double11ShopPanel",ActivityBasePanel:"ActivityBasePanel"}],Double11ShopPanel:[function(t,e,i){"use strict";cc._RF.push(e,"d0177LJtb1HXYeKmDMSYUfA","Double11ShopPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.Double11ShopPanel=void 0;var r=cc._decorator.property,o=cc._decorator.ccclass,s=cc._decorator.menu,l=t("OptimizeVerticalListView"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_labActivityTime=void 0,e.m_scrollView=void 0,e._itemListView=null,e._isInit=!1,e}return n(e,t),e.prototype.setActivityTime=function(t){this.m_labActivityTime.string=t},e.prototype.refreshItemScroll=function(t){t&&(this._itemListView||(this._itemListView=this.m_scrollView.node.getComponent(l)),this._itemListView.setCustomData({activityType:td.ActivityEnum.ActivityType.Double11_Shop}),this._isInit?this._itemListView.refreshCurList(t):this._itemListView.setData(t),this._isInit=!0)},a([r(cc.Label)],e.prototype,"m_labActivityTime",void 0),a([r(cc.ScrollView)],e.prototype,"m_scrollView",void 0),e=a([o,s("module/Double11/Double11ShopPanel")],e)}(cc.Component);i.Double11ShopPanel=c,cc._RF.pop()},{OptimizeVerticalListView:void 0}],DoubleDropController:[function(t,e,i){"use strict";cc._RF.push(e,"ed292dszUlD/bw70oNILYyB","DoubleDropController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("./DoubleDropEnum"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataID=1001,e._isPanelOpened=!1,e}return n(e,t),e.prototype.initData=function(e){this.clearData(),t.prototype.initData.call(this,e),this._dataID=this.getActivityData(),this.addEventListener()},e.prototype.clearData=function(){this._dataId=0},e.prototype.addEventListener=function(){td.EventNameEnum;td.EventUtil.registerEvents({},this)},e.prototype.getCurCfg=function(){var t=td.GetTableClass(td.TableEnum.DoubleDropTable);return t?t.getCfgByDataId(this._dataID):null},e.prototype.isRoamDoubleOpen=function(){for(var t=this.getCurCfg().operationTypes,e=0;e<t.length;e++){if(t[e]==a.DoubleDropType.Roam)return!0}return!1},e.prototype.onOpenPanel=function(){this._isPanelOpened=!0,td.GlobalFunction.setLocalSaveStatus("DoubleDropPanel","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.DOUBLE_DROP_PANEL_SHOW)},e.prototype.isLoginTodayShow=function(){return!td.GlobalFunction.getLocalSaveStatus("DoubleDropPanel")},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){return this.isLoginTodayShow()},e.prototype.redPointEvts=function(){return[td.EventNameEnum.DOUBLE_DROP_PANEL_SHOW]},e}(t("ActivityBaseController"));i.default=r,e.exports=r,cc._RF.pop()},{"./DoubleDropEnum":"DoubleDropEnum",ActivityBaseController:"ActivityBaseController"}],DoubleDropEnum:[function(t,e,i){"use strict";cc._RF.push(e,"e0718RbLrNHJq3jHfB3SXNB","DoubleDropEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.DoubleDropType=void 0,function(t){t[t.Endless=111]="Endless",t[t.Copys=145]="Copys",t[t.RoadUp=222]="RoadUp",t[t.TreasureRob=306]="TreasureRob",t[t.HardCopy=309]="HardCopy",t[t.Roam=315]="Roam"}(i.DoubleDropType||(i.DoubleDropType={})),cc._RF.pop()},{}],DoubleDropPanel:[function(t,e,i){"use strict";cc._RF.push(e,"b761fpxCABFLpJDeTbsdJnw","DoubleDropPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgAds=null,e.labActivityTime=null,e.labTips=null,e._activityCotr=null,e._jumpCfg=null,e._namesPath={},e}return n(e,t),e.prototype.init=function(){this._panelType=c.PanelType.Panel,this._panelEnum=c.PanelEnum.Panel_DoubleDrop},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._activityCotr=c.ActivityDataManager.getActivityControllerByType(c.ActivityEnum.ActivityType.DoubleDrop),this._activityCotr&&(this._activityCotr.onOpenPanel(),this._refreshUI())},e.prototype.onDisable=function(){t.prototype.onDisable.call(this)},e.prototype.setData=function(){t.prototype.setData.call(this),this._refreshUI()},e.prototype._refreshUI=function(){this.labActivityTime.string=this.getDurationStr();var t=this._activityCotr.getCurCfg();if(t){var e=t.gotopanel;this._jumpCfg=e,t.textPic&&c.GlobalFunction.createAltasSprite(c.resDef.pngPlist.Acitivty_49_sbjl,t.textPic,this.imgAds),this.labTips.string=t.tips}},e.prototype.onBtnGoToClick=function(){null!=this._jumpCfg&&c.PanelJumpManager.jumpToPanel(this._jumpCfg[0],this._jumpCfg[1])},a([s(cc.Node)],e.prototype,"imgAds",void 0),a([s(cc.Label)],e.prototype,"labActivityTime",void 0),a([s(cc.Label)],e.prototype,"labTips",void 0),e=a([o,l("module/Activity/DoubleDropPanel")],e)}(t("ActivityBasePanel"));i.default=u,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],DoubleDropTable:[function(t,e,i){"use strict";cc._RF.push(e,"8a746Nd9ylI8rKqgcNAang6","DoubleDropTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="DoubleDropTable",e._tblName="activity_reward_double_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]=a}},e.prototype.getCfgByDataId=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DragonBossTable:[function(t,e,i){"use strict";cc._RF.push(e,"6f61f7omcVBAaTqJhCkCwpw","DragonBossTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="DragonBossConfig",e._tblName="dragon_boss_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.monsterId]=a}},e.prototype.getDataById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getList=function(){var t=[];for(var e in this._data)t.push(this._data[e]);return t},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DragonTreasurRechargeTable:[function(t,e,i){"use strict";cc._RF.push(e,"d9632TCBG5DGq4oTWZmbOYj","DragonTreasurRechargeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"Activity27RechargeConfig",properties:{_tblName:"activity_27_recharge_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]=t[a.data]||[],t[a.data].push(a)}},getDataByDataId:function(t){return this._data&&this._data[t]?this._data[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DragonTreasurRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"7fa6cu4KFZAcakmhoM32iME","DragonTreasurRewardModel");var n=cc.Class({properties:{_pos:null,_reward:null,_isReceived:null,_curChargeNum:null},initData:function(t,e,i){this._charge=t.charge,this._ticketNum=t.num,this._rewardStatus=td.RewardStatus.CANNOT_RECEIVE,this._activityType=i,this._curChargeNum=e},getNeedChargeNum:function(){return this._charge},setCurChargeNum:function(t){this._curChargeNum=t},getCurChargeNum:function(){return this._curChargeNum},getCanExchangeTicketNum:function(){return this._ticketNum},setRewardStatus:function(t){this._rewardStatus=t},getRewardStatus:function(){return this._rewardStatus},getActivityType:function(){return this._activityType}});e.exports=n,cc._RF.pop()},{}],DragonTreasurTable:[function(t,e,i){"use strict";cc._RF.push(e,"ddf8du9mWxJibN93YpjkNEh","DragonTreasurTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"Activity27PointConfig",properties:{_tblName:"activity_27_point_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]=t[a.data]||[],t[a.data].push(a)}},getDataByDataId:function(t){return this._data&&this._data[t]?this._data[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],DragonTreasure1Controller:[function(t,e,i){"use strict";cc._RF.push(e,"d81dcVbt1xOn4D9P4dzHuTm","DragonTreasure1Controller");var n=t("BaseTreasureController"),a=t("DragonTreasureModel"),r=t("DragonTreasurRewardModel"),o=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._events.update=td.EventNameEnum.DRAGON_TREASURE_UPDATED,this._events.getTicket=td.EventNameEnum.GET_DRAGON_TREASURE_TICKET,this._events.getReward=td.EventNameEnum.GET_DRAGON_TREASURE_REWARD_RETURN,this._configKeys.diamondCost="ACTIVITY27_DIAMOND_COST",this._configKeys.diamondMaxTimes="ACTIVITY27_DIAMOND_TAVERN_LIMIT",this._configKeys.ticketCost="ACTIVITY27_VOUCHER_COST",this._configKeys.ticketMaxTimes="ACTIVITY27_VOUCHER_TAVERN_LIMIT",this._configKeys.pointConfig=td.TableEnum.DragonTreasurTable,this._configKeys.rechargeConfig=td.TableEnum.DragonTreasurRechargeTable,this._models.item=a,this._models.recharge=r}});e.exports=o,cc._RF.pop()},{BaseTreasureController:"BaseTreasureController",DragonTreasurRewardModel:"DragonTreasurRewardModel",DragonTreasureModel:"DragonTreasureModel"}],DragonTreasure2Controller:[function(t,e,i){"use strict";cc._RF.push(e,"52230FHyBtNHpAKFt8CVfCx","DragonTreasure2Controller");var n=t("BaseTreasureController"),a=t("DragonTreasureModel"),r=t("DragonTreasurRewardModel"),o=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._events.update=td.EventNameEnum.DRAGON_TREASURE_UPDATED_2,this._events.getTicket=td.EventNameEnum.GET_DRAGON_TREASURE_TICKET_2,this._events.getReward=td.EventNameEnum.GET_DRAGON_TREASURE_REWARD_RETURN_2,this._configKeys.diamondCost="ACTIVITY30_DIAMOND_COST",this._configKeys.diamondMaxTimes="ACTIVITY30_DIAMOND_TAVERN_LIMIT",this._configKeys.ticketCost="ACTIVITY30_VOUCHER_COST",this._configKeys.ticketMaxTimes="ACTIVITY30_VOUCHER_TAVERN_LIMIT",this._configKeys.pointConfig=td.TableEnum.DragonTreasurTable,this._configKeys.rechargeConfig=td.TableEnum.DragonTreasurRechargeTable,this._models.item=a,this._models.recharge=r}});e.exports=o,cc._RF.pop()},{BaseTreasureController:"BaseTreasureController",DragonTreasurRewardModel:"DragonTreasurRewardModel",DragonTreasureModel:"DragonTreasureModel"}],DragonTreasureModel:[function(t,e,i){"use strict";cc._RF.push(e,"c76c7T/EMtKQ4aMpRPhd9BS","DragonTreasureModel");var n=cc.Class({properties:{_pos:null,_reward:null,_isReceived:null},initData:function(t){t&&(this._pos=t.pointId,this._reward=td.RewardManager.parseRewardListDetail(t.reward)[0],this._isReceived=!1)},getPos:function(){return this._pos},getReward:function(){return this._reward},setReceived:function(t){this._isReceived=t},isReceived:function(){return this._isReceived}});e.exports=n,cc._RF.pop()},{}],DragonTreasurePanel2:[function(t,e,i){"use strict";cc._RF.push(e,"77c96ebQsNEk4UwGfMepvfZ","DragonTreasurePanel2");var n=t("DragonTreasurePanel"),a=cc.Class({extends:n,initData:function(t){this._super(t),this._isPlaying=!1,this._costDiamond=0,this._costTicket=0},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.DRAGON_TREASURE_UPDATED_2]=this._onDataUpdated,i[e.GET_DRAGON_TREASURE_REWARD_RETURN_2]=this._playSuccessAnimation,t.registerEvents(i,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},_onDataUpdated:function(){var t=this._controller;t&&(t.isPlayReturn()?this._costDiamond&&this._costDiamond>0?this._minusCostDiamond():this._costTicket&&this._costTicket>0&&this._minusCostTicket():this._refreshInfo())},onReceiveOperation:function(t){t.activityId===this._activityId&&this._controller.parseRewardReceived(t)},_playSuccessAnimation:function(){var t=this._controller;t&&(this._costDiamond&&this._costDiamond>0?(td.EventUtil.dispatchEvent(td.EventNameEnum.UPDATE_DIAMOND_DIFF,-this._costDiamond),this._costDiamond=0):this._costTicket&&this._costTicket>0&&(this._costTicket=0),t.isLastPlay()?this._showPlayRewards():this._showPlayToPos(t.getLastPlayPos()-1))}});e.exports=a,cc._RF.pop()},{DragonTreasurePanel:"DragonTreasurePanel"}],DragonTreasurePanel:[function(t,e,i){"use strict";cc._RF.push(e,"71dd6L96X1LAb1u5B4iTA39","DragonTreasurePanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{labelLeftTime:cc.Label,labelDiamond:cc.Label,labelTicket:cc.Label,labelDiamondCost:cc.Label,labelTicketCost:cc.Label,itemsPanel:cc.Node,imgSelect:cc.Node,btnGetTicket:cc.Node,btnDaimondPlay:cc.Button,btnTicketPlay:cc.Button,costItem1:cc.Node,costItem2:cc.Node,specialIconNode:cc.Node,_isPlaying:null,_costDiamond:null,_costTicket:null},initData:function(t){this._super(t),this._isPlaying=!1,this._costDiamond=0,this._costTicket=0},onEnable:function(){this._super(),this._setActivityTime(),this.schedule(this.updateLeftTime,1),this._addLocalListeners(),this._initPos(),this._refreshInfo()},onDisable:function(){this._super(),this.unschedule(this.updateLeftTime),this._removeAllListeners();var t=this._controller.getPlayReward();this._isPlaying&&t&&(td.GlobalFunction.showRewards(t),this._isPlaying=!1)},onGotoCharge:function(){td.GlobalFunction.gotoRecharge()},onShowGetReward:function(){var t={};t.panelName=td.PanelEnum.Window_DragonTresureReward,t.callback={func:function(t,e){e.setData(t)},param:this._activityType},td.GlobalFunction.showPanel(t)},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.DRAGON_TREASURE_UPDATED]=this._onDataUpdated,i[e.GET_DRAGON_TREASURE_REWARD_RETURN]=this._playSuccessAnimation,t.registerEvents(i,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},updateLeftTime:function(t){this._setActivityTime()},_setActivityTime:function(){var t=this.getActivityLeftTimeStr(),e=cc.js.formatStr(td.Language.leftTime,t);this.labelLeftTime.string=e},_refreshInfo:function(){this._refreshNumInfo(),this._refreshItems()},_onDataUpdated:function(){var t=this._controller;t&&(t.isPlayReturn()?this._costDiamond&&this._costDiamond>0?this._minusCostDiamond():this._costTicket&&this._costTicket>0&&this._minusCostTicket():this._refreshInfo())},_refreshItems:function(){var t=this._controller;if(t){var e=this.specialIconNode.getChildByName("specialIcon"),i=t.getSpecialRewardItem(),n=i.getReward();e?e.getComponent("CommonIconWidget").setData(n):((e=td.GlobalFunction.createCommonIconWidget(33,n)).setName("specialIcon"),this.specialIconNode.addChild(e),e.scale=.9,e.y=20,e.getComponent("CommonIconWidget").setHeadClickShowInfo()),this._handleReceiveIcon(e,i.isReceived());for(var a=this.itemsPanel,r=t.getItems(),o=0;o<r.length;o++){var s=r[o],l=s.getPos(),c=a.getChildByName("icon_"+l),u=s.getReward();if(c)c.getComponent("CommonIconWidget").setData(u);else(c=td.GlobalFunction.createCommonIconWidget(33,u)).setPosition(this._poses[l-1]),c.setName("icon_"+l),a.addChild(c),c.scale=.85,c.getComponent("CommonIconWidget").setHeadClickShowInfo();this._handleReceiveIcon(c,s.isReceived())}var d=t.getLastPlayPos();!d&&(d=1);var h=this._poses[d-1];h&&(this.imgSelect.position=h),this.imgSelect.zIndex=99999}},_handleReceiveIcon:function(t,e){if(t){var i=t.getChildByName("receiveImg");if(e)if(i)i.active=!0;else{i=new cc.Node;var n=gdk.rm.getResByUrl(td.resDef.pngPlist.Meishuzi,cc.SpriteAtlas);i.addComponent(cc.Sprite).spriteFrame=n.getSpriteFrame("MSZ_yilingqu_02"),t.addChild(i),i.scale=1/t.scale}else i&&(i.active=!1)}},_refreshNumInfo:function(){var t=this._controller;if(t){td.RedPointUtil.createRedPointSimple(this.btnGetTicket,null,t.haveRewardCanReceive());var e=td.Account.getUserData(),i=e?e.getDiamond():0;this.labelDiamond.string=i;var n=t.getMyTicketNum();this.labelTicket.string=n;var a=t.getPlayCostByType(td.DragonTreasureReqType.DiamondPlay),r=a>0;this.btnDaimondPlay.interactable=r,this.btnDaimondPlay.node._tag=td.DragonTreasureReqType.DiamondPlay,this.labelDiamondCost.string=r?a:td.Language.timesOver,this.costItem1.active=r,this.labelDiamondCost.node.x=r?-86:-140,r=(a=t.getPlayCostByType(td.DragonTreasureReqType.TicketPlay))>0,this.labelTicketCost.string=r?a:td.Language.timesOver,this.btnTicketPlay.interactable=r,this.btnTicketPlay.node._tag=td.DragonTreasureReqType.TicketPlay,this.costItem2.active=r,this.labelTicketCost.node.x=r?77:7}},_minusCostDiamond:function(){var t=parseInt(this.labelDiamond.string),e=0;t&&t>0&&t>=this._costDiamond&&(e=t-this._costDiamond),this.labelDiamond.string=e},_minusCostTicket:function(){var t=parseInt(this.labelTicket.string),e=0;t&&t>0&&t>=this._costTicket&&(e=t-this._costTicket),this.labelTicket.string=e},_playSuccessAnimation:function(t){var e=this._controller;e&&(this._costDiamond&&this._costDiamond>0?(td.EventUtil.dispatchEvent(td.EventNameEnum.UPDATE_DIAMOND_DIFF,-this._costDiamond),this._costDiamond=0):this._costTicket&&this._costTicket>0&&(this._costTicket=0),e.isLastPlay()?this._showPlayRewards():this._showPlayToPos(e.getLastPlayPos()-1))},_showPlayToPos:function(t){if(cc.log("play to pos:"+t),!(t<0)){this._isPlaying=!0,this.imgSelect.active=!0,this.imgSelect.stopAllActions();var e=new cc.MoveArround(6,this._poses,t,2).easing(cc.easeSineOut()),i=cc.callFunc(this._showPlayRewards.bind(this)),n=cc.sequence(e,cc.delayTime(.2),i);this.imgSelect.runAction(n)}},_showPlayRewards:function(){this._isPlaying=!1;var t=this._controller;if(t){var e=t.getPlayReward();e&&(td.GlobalFunction.showRewards(e),t.clearPlayReward()),t.resetPlayReturn();var i=this;setTimeout(function(){i._refreshInfo()},500)}},_initPos:function(){if(!(this._poses&&this._poses.length>0)){var t,e;for(this._poses=[],this._poses[0]=this.imgSelect.position,t=1;t<=3;t++)e=cc.v2(this._poses[0].x+145*t,this._poses[0].y),this._poses[t]=e;for(t=4;t<=6;t++)e=cc.v2(this._poses[3].x,this._poses[3].y-164*(t-3)),this._poses[t]=e;for(t=7;t<=9;t++)e=cc.v2(this._poses[6].x-145*(t-6),this._poses[6].y),this._poses[t]=e;for(t=10;t<=11;t++)e=cc.v2(this._poses[9].x,this._poses[9].y+164*(t-9)),this._poses[t]=e}},tryPlay:function(t){if(!this._isPlaying){var e=t.target._tag,i=this._controller;if(i){var n=i.getPlayCostByType(e);if(e===td.DragonTreasureReqType.DiamondPlay){var a=td.Account.getUserData();if((a?a.getDiamond():0)<n)return void this.onGotoCharge();this._costDiamond=n}else if(e===td.DragonTreasureReqType.TicketPlay){if(i.getMyTicketNum()<n)return void this.onShowGetReward();this._costTicket=n}var r={};this._activityType===td.ActivityEnum.ActivityType.DragonTreasure1?r.parmeterMap={2:e}:this._activityType===td.ActivityEnum.ActivityType.DragonTreasure2&&(r.parmeterMap={3:e}),r.activityId=this.getActivityId(),i.operateActivity(r)}}},onReceiveOperation:function(t){t.activityId===this._activityId&&this._controller.parseRewardReceived(t)}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],DragonTreasureRewardItem:[function(t,e,i){"use strict";cc._RF.push(e,"b634dAjWAxDvYkcfsSnjc9J","DragonTreasureRewardItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{_activityType:null,_data:null},updateItem:function(t,e){if(this._super(t,e),e){this._data=e,this._activityType=e.getActivityType();var i=this.node.getChildByName("tips"),n=this.node.getChildByName("progress"),a=this.node.getChildByName("btnGoto"),r=this.node.getChildByName("btnReceive"),o=this.node.getChildByName("imgReceived"),s=this.node.getChildByName("num"),l=e.getRewardStatus();o.active=l===td.RewardStatus.RECEIVED,r.active=l===td.RewardStatus.CAN_RECEIVE,a.active=l===td.RewardStatus.CANNOT_RECEIVE,s.getComponent(cc.Label).string="x"+e.getCanExchangeTicketNum(),i.getComponent(cc.RichText).string=cc.js.formatStr(td.Language.dragonTresureRewardTips,e.getNeedChargeNum()/10),n.getComponent(cc.Label).string=td.Language.progress+": "+e.getCurChargeNum()/10+"/"+e.getNeedChargeNum()/10}},onReceive:function(){var t=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(t){var e={};e.id=this._data.getNeedChargeNum(),this._activityType===td.ActivityEnum.ActivityType.DragonTreasure1?e.parmeterMap={2:td.DragonTreasureReqType.ExchangeTicket}:this._activityType===td.ActivityEnum.ActivityType.DragonTreasure2&&(e.parmeterMap={3:td.DragonTreasureReqType.ExchangeTicket}),t.operateActivity(e)}},onGoto:function(){td.GlobalFunction.gotoRecharge(),td.PanelManager.getInstance().getCurShowWindow().getComponent("PanelBase").hide()}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],DragonTreasureRewardWindow:[function(t,e,i){"use strict";cc._RF.push(e,"a79b4eF4G1Bj4LfG2GH402q","DragonTreasureRewardWindow");var n=t("PanelBase"),a=t("OptimizeVerticalListView");cc.Class({extends:n,properties:{_controller:null,_updateLayer:null,_item:null,_listView:null,_activityType:null,rewardPanel:cc.Node,myRankLabel:cc.Label},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_DragonTresureReward,this._listView=this.node.getComponent(a)},onEnable:function(){this._super(),this._addEventListener()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum;t.registerEvent(e.ON_ACTIVITY_OPERATE_SUCCESS,this.refreshList,this),t.registerEvent(e.GET_DRAGON_TREASURE_TICKET_2,this._onExchangeSuccess,this),t.registerEvent(e.GET_DRAGON_TREASURE_TICKET,this._onExchangeSuccess,this)},clickBgListener:function(){this.closeCallFunc()},refreshList:function(){this.setData(this._activityType)},setData:function(t){this._super(t),this._activityType=t;var e=td.ActivityDataManager.getActivityControllerByType(t);if(e){var i=e.getExchangeTicketData();this._listView.setData(i)}},_onExchangeSuccess:function(t){var e=[],i={};i.type=td.GoodsType.Type_Item,i.id=this._activityType===td.ActivityEnum.ActivityType.DragonTreasure1?td.ItemEnum.DRAGON_TREASURE_TICKET:td.ItemEnum.DRAGON_TREASURE_2_TICKET,i.count=t,e.push(i),td.GlobalFunction.showRewards(e)}});cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],DrawEnergyConfig:[function(t,e,i){"use strict";cc._RF.push(e,"4173e4UBbZAurAVM4hfbhix","DrawEnergyConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"DrawEnergyConfig",properties:{_tblName:"draw_energy_config",_data:null},init:function(){this._data=[];for(var t=this._jsonData,e=this._data,i=0,n=t.length;i<n;i++){var a=t[i];e[e.length]=a}},getDrawEnergyConfigs:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EDConditionLayer:[function(t,e,i){"use strict";cc._RF.push(e,"cc2ecBJeEZAcLkI62QhWcbT","EDConditionLayer");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../EightDiagrams/Manager/EightDiagramsManager"),o=cc._decorator,s=o.ccclass,l=o.property,c=(o.menu,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeCondition=null,e.nodeLabCondition=null,e}return n(e,t),e.prototype.onEnable=function(){for(var t=r.default.getInstance().getCurStoryConditions(),e=0,i=0;i<t.length;i++){var n=t[i];this._getLabCondition(i).string=i+1+". "+n,e++}for(var a=e;a<this.nodeCondition.children.length;a++){this.nodeCondition.getChildByName("labCondition"+a).active=!1}},e.prototype._getLabCondition=function(t){var e=this.nodeCondition.getChildByName("labCondition"+t);return e||((e=cc.instantiate(this.nodeLabCondition)).parent=this.nodeCondition,e.name="labCondition"+t,e.active=!0),e.getComponent(cc.RichText)},e.prototype.onBtnCloseClick=function(){this.node.active=!1},a([l(cc.Node)],e.prototype,"nodeCondition",void 0),a([l(cc.Node)],e.prototype,"nodeLabCondition",void 0),e=a([s],e)}(cc.Component));i.default=c,cc._RF.pop()},{"../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager"}],EDUILayer:[function(t,e,i){"use strict";cc._RF.push(e,"61e70wdO7RFM4Ccve4KjtBw","EDUILayer");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnCondition=null,e.nodeCondition=null,e}var i;return n(e,t),i=e,e.showNode=function(t,e){if(null!=t){if(gdk.rm.getResByUrl("prefab/Pve/EDUILayer",cc.Prefab))return i.createUI(t,e);gdk.rm.loadRes(null,"prefab/Pve/EDUILayer",cc.Prefab,i.createUI.bind(this,t,e))}},e.createUI=function(t,e){var n=null,a=!1;i._staticNode?(n=i._staticNode,a=!0):(n=gdk.rm.getResByUrl("prefab/Pve/EDUILayer",cc.Prefab),n=cc.instantiate(n));var r=n.getComponent(i);return r||n.addComponent(i),r.setData(e),a||(t.addChild(n,100),n.name="EDUILayer"),i._staticNode=n,r},e.prototype.onDestroy=function(){i._staticNode=null},e.prototype.setData=function(t){this.node.active=t,this.nodeCondition.active=t},e.prototype.onBtnShowEDTips=function(){this.nodeCondition.active=!0},e._staticNode=null,a([s(cc.Node)],e.prototype,"btnCondition",void 0),a([s(cc.Node)],e.prototype,"nodeCondition",void 0),e=i=a([o,l("module/Pve/EDUILayer")],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],EatEnergyController:[function(t,e,i){"use strict";cc._RF.push(e,"ea4409RYotPDI5XMiMqXFB4","EatEnergyController");var n=t("ActivityBaseController"),a=t("Model"),r=t("GameAlarm"),o=cc.Class({extends:a,properties:{_eatState:null,_openTime:null,_closeTime:null,_limitTime:null},getTimeStr:function(){return this._openTime.toString()+"~"+this._closeTime.toString()},init:function(t,e,i){this._openTime=t,this._closeTime=e,this._limitTime=i},setState:function(t){this._eatState=t},getState:function(){var t=td.ActivityEnum.EatEnergyReceiveType;if(this._eatState!==t.RECEIVED){var e=100*this._openTime.getCfgHour()+this._openTime.getCfgMin(),i=100*this._closeTime.getCfgHour()+this._closeTime.getCfgMin(),n=[e,i],a=[i,100*this._limitTime.getCfgHour()+this._limitTime.getCfgMin()];td.TimeUtil.isCurTimeInTime(n)?this._eatState=t.CAN_RECEIVE:td.TimeUtil.isCurTimeInTime(a)?this._eatState=t.DELAY_RECEIVE:this._eatState=t.NONE}return this._eatState},getOpenTimeStr:function(){return this._openTime.toString()}}),s=cc.Class({extends:a,properties:{_hour:null,_minute:null,_strTime:null,_cfgHour:null,_cfgMin:null,_dayOffset:null},init:function(t){var e=td.TimeUtil.getMillisecondsByStr(t),i=e[0];this._dayOffset=e[1],i/=6e4,this._hour=Math.floor(i/60)%24,this._minute=i%60;var n=t.split(":");n.length>1&&(this._cfgHour=Number(n[0]),this._cfgMin=Number(n[1])),this._strTime=td.RegexUtil.pad(this._hour,2)+":"+td.RegexUtil.pad(this._minute,2)},getHour:function(){return this._hour},getCfgHour:function(){return this._cfgHour},getMinute:function(){return this._minute},getCfgMin:function(){return this._cfgMin},toString:function(){return this._strTime}}),l=cc.Class({extends:n,properties:{_lastEatEnergyTime:null,_eatTime:null,_eatCost:null,_eatAddEnergy:null,_eatStateList:null},initData:function(t){this._super(t);var e=td.GetTableClass(td.TableEnum.Config).getConfig("DRAW_ENERGY_TIME_LIMIT_COST");this._cost=td.RewardManager.parseRewardListDetail(e)[0],this._initEatList(),this.init()},init:function(){this.addListener(),this.addEventListener(),this._addAlarm()},_addAlarm:function(){for(var t=0,e=this._eatTime.length;t<e;t++){var i=this._eatTime[t],n=i[0],a=i[1];r.addAlarm(n.getHour(),n.getMinute(),0),r.addAlarm(a.getHour(),a.getMinute(),0)}},getEatAddEnergy:function(){return this._eatAddEnergy},getDelayEatCost:function(){return this._cost},requestBaseInfo:function(){},isNowCanEat:function(){for(var t in this._eatStateList){var e=this._eatStateList[t];if(e&&e.getState()===td.ActivityEnum.EatEnergyReceiveType.CAN_RECEIVE)return!0}return!1},_reqEatEnergyInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.GET_DRAW_ENERGY_INFO,td.ServerDelegate.sendMessage(t)},_reqEatEnergy:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.DRAW_ENERGY_RECEIVE,e.configId=t,td.ServerDelegate.sendMessage(e)},addEventListener:function(){var t={},e=td.EventNameEnum;t[e.Req_EatEnergy_Info]=this._reqEatEnergyInfo.bind(this),t[e.Req_EatEnergy]=this._reqEatEnergy.bind(this),td.EventUtil.registerEvents(t,this)},addListener:function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.GET_DRAW_ENERGY_INFO,this._parseEatEnergyInfo.bind(this)),i.registerMessage(t,e.DRAW_ENERGY_RECEIVE,this._onEatReturn.bind(this)),i.registerMessage(t,e.PUSH_DRAW_ENERGY_INFO,this._parseEatEnergyInfo.bind(this))},_initEatList:function(){var t=td.GetTableClass(td.TableEnum.DrawEnergyConfig).getDrawEnergyConfigs();this._eatTime=[],this._eatAddEnergy=0,this._eatStateList={};for(var e=0,i=t.length;e<i;e++){var n=t[e],a=n.id,r=new s;r.init(n.openTime);var l=new s;l.init(n.closeTime);var c=new s;c.init(n.limitTime),this._eatTime.push([r,l]);var u=new o;u.init(r,l,c),this._eatStateList[a]=u,this._eatAddEnergy=n.rewards[0][2]}},_parseEatEnergyInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.receiveList,n=td.ActivityEnum.EatEnergyReceiveType;for(var a in this._eatStateList){a=parseInt(a);var r=this._eatStateList[a];if(r)if(0===i.length)r.setState(n.NONE);else for(var o=0,s=i.length;o<s;o++)if(i[o]===a){r.setState(n.RECEIVED);break}}td.EventUtil.dispatchEvent(td.EventNameEnum.Res_EatEnergy_Info)}},getEatStateByType:function(t){return this._eatStateList[t]},_onEatReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,n),td.EventUtil.dispatchEvent(td.EventNameEnum.Res_EatEnergy)}},hasRedPoint:function(){return!0},redPointTip:function(){return this.isNowCanEat()},redPointEvts:function(){return[td.EventNameEnum.Res_EatEnergy,td.EventNameEnum.Res_EatEnergy_Info,td.EventNameEnum.GAME_ALARM_EVENT]},isRedPointTip:function(){return this.isNowCanEat()}});e.exports=l,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",GameAlarm:void 0,Model:"Model"}],EatEnergyHome:[function(t,e,i){"use strict";cc._RF.push(e,"225cfPdzCZP2ojrjWyoZjEU","EatEnergyHome");var n=t("ActivityBasePanel");td.EatEnergyHome=cc.Class({extends:n,properties:{eatPanel1:cc.Node,eatPanel2:cc.Node,timeBg1:cc.Node,timeBg2:cc.Node,canEat1:cc.Node,canEat2:cc.Node,canEatTips1:cc.Node,canEatTips2:cc.Node,tipsLabel:cc.Label,timeLabel:cc.RichText},initData:function(t){this._super(t)},onEnable:function(){this._super(),this._addEventListener(),td.EventUtil.dispatchEvent(td.EventNameEnum.Req_EatEnergy_Info)},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this)},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.Res_EatEnergy_Info]=this._initView,t[e.Res_EatEnergy]=this._initView,t[e.GAME_ALARM_EVENT]=this._initView,td.EventUtil.registerEvents(t,this)},btnEatEnergy:function(t,e){if(e=parseInt(e),this._controller.getEatStateByType(e).getState()===td.ActivityEnum.EatEnergyReceiveType.DELAY_RECEIVE){var i=new td.BroadcastContent(174),n=[],a=this._controller.getDelayEatCost().getCount();return n[n.length]=new td.BroadcastParam(a),i.setMainParam(n),i.setOkCallFunc(this._sureDelayEatEnergy.bind(this,e)),void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}td.EventUtil.dispatchEvent(td.EventNameEnum.Req_EatEnergy,e)},_sureDelayEatEnergy:function(t){t=parseInt(t),td.EventUtil.dispatchEvent(td.EventNameEnum.Req_EatEnergy,t)},_initView:function(){var t=td.ActivityEnum.EatEneryType;for(var e in t)this._setEatInfo(t[e]);this.tipsLabel.string=td.Language.eatEnergyTips,this.timeLabel.string=cc.js.formatStr(td.Language.eatEnergyTimeTips,this._controller.getEatStateByType(td.ActivityEnum.EatEneryType.LANCH).getTimeStr(),this._controller.getEatStateByType(td.ActivityEnum.EatEneryType.DINNER).getTimeStr(),this._controller.getEatAddEnergy())},_setEatInfo:function(t){var e=td.ActivityEnum.EatEnergyReceiveType,i=this._controller.getEatStateByType(t),n=i.getState();this["eatPanel"+t].active=n!==e.RECEIVED,this["canEat"+t].active=n!==e.RECEIVED,this["canEatTips"+t].active=n===e.DELAY_RECEIVE||n===e.CAN_RECEIVE;var a=this["canEatTips"+t].getChildByName("tips"),r=td.Language.eatEnergyTitle.split("|"),o="";n===e.CAN_RECEIVE?o=r[0]:n===e.DELAY_RECEIVE&&(o=r[1]),a.getComponent(cc.Label).string=o,this["timeBg"+t].active=n===e.NONE;var s=this["timeBg"+t].getChildByName("time");n!==e.NONE&&n!==e.RECEIVED||(s.getComponent(cc.Label).string=i.getTimeStr());var l=this["canEat"+t].getChildByName("EatEffect");if(n===e.DELAY_RECEIVE||n===e.CAN_RECEIVE)if(l){l.active=!0,l.getComponent(cc.Animation).play()}else{var c=td.GlobalFunction.getResIdByNode(this["canEat"+t]);gdk.rm.loadRes(c,"uiAnima/LinTiLi_effect/LinTiLi_effect",cc.Prefab,this._addEatEffect.bind(this,this["canEat"+t]))}else l&&l.removeFromParent(!0)},_addEatEffect:function(t){if(cc.isValid(t)){var e=t.getChildByName("EatEffect");if(!e){var i=gdk.rm.getResByUrl("uiAnima/LinTiLi_effect/LinTiLi_effect",cc.Prefab);(e=cc.instantiate(i)).name="EatEffect",t.addChild(e)}e.getComponent(cc.Animation).play()}},onEatClick:function(t,e){if(e=parseInt(e),this._controller){var i=this._controller.getEatStateByType(e);if(i){var n=i.getState();if(n===td.ActivityEnum.EatEnergyReceiveType.CAN_RECEIVE)td.EventUtil.dispatchEvent(td.EventNameEnum.Req_EatEnergy,e);else if(n===td.ActivityEnum.EatEnergyReceiveType.DELAY_RECEIVE){var a=new td.BroadcastContent(174),r=[],o=this._controller.getDelayEatCost().getCount();r[r.length]=new td.BroadcastParam(o),a.setMainParam(r),a.setOkCallFunc(function(){td.EventUtil.dispatchEvent(td.EventNameEnum.Req_EatEnergy,e)}),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a)}else n===td.ActivityEnum.EatEnergyReceiveType.NONE&&td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,new td.BroadcastContent(267))}}}}),cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],EffectFactory:[function(t,e,i){"use strict";cc._RF.push(e,"88b61JLGMFPfb2Q60yK7wuY","EffectFactory"),td.EffectFactory={createEffect:function(t,e){var i=td.EffectEnum[t];i||(i="PvpBufferEffect");var n=new td[i];return n.init(e),n}},cc._RF.pop()},{}],EightDiagramChapterTable:[function(t,e,i){"use strict";cc._RF.push(e,"64aeeRJtyhKGpzFhAyVvT89","EightDiagramChapterTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EightDiagramChapterTable",e._tblName="eight_diagram_chapter_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t.push(a)}},e.prototype.getAllCfgs=function(){return this._data},e.prototype.getCfgByChapterId=function(t){if(null==this._data)return null;for(var e=0;e<this._data.length;e++){var i=this._data[e];if(i.chapterId==t)return i}return null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EightDiagramsEnum:[function(t,e,i){"use strict";cc._RF.push(e,"7e2b622OQVJv4x+TZsVgP23","EightDiagramsEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.ED_LIMIT_TYPE=i.ED_FIGHT_TYPE=void 0,function(t){t[t.NORMAL=1]="NORMAL",t[t.CHASE=2]="CHASE"}(i.ED_FIGHT_TYPE||(i.ED_FIGHT_TYPE={})),function(t){t[t.HERO_FIGHT=1]="HERO_FIGHT",t[t.INSPIRE_LIMIT=2]="INSPIRE_LIMIT",t[t.ICE_RAIN_LIMIT=3]="ICE_RAIN_LIMIT",t[t.LIGHT_LIMIT=4]="LIGHT_LIMIT",t[t.MAX_ANGER=5]="MAX_ANGER"}(i.ED_LIMIT_TYPE||(i.ED_LIMIT_TYPE={})),cc._RF.pop()},{}],EightDiagramsLimitTable:[function(t,e,i){"use strict";cc._RF.push(e,"bd2b4IDpsJEM6WFPtjxJLm9","EightDiagramsLimitTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EightDiagramsLimitTable",e._tblName="eight_diagram_limit_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t.push(a)}},e.prototype.getCfgByLimitId=function(t){if(null==this._data)return null;for(var e=0;e<this._data.length;e++){var i=this._data[e];if(i.id==t)return i}return null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EightDiagramsManager:[function(t,e,i){"use strict";cc._RF.push(e,"eac6cpx+0JIMp4ElLHeTSNF","EightDiagramsManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Enum/EightDiagramsEnum"),a=function(){function t(){this._storyId=1001,this._passedStoryId=0,this._challengeTimes=0,this._pass=!1,this._receiveList=[],this._ranks=[],this._myRank={},this.MAX_TIMES=0,this._skillUseLimit={},this._skillUseTimes={},this._copyFightChange={},this._maxAnger=0,this._curCharpterId=1,this._curCharpterLv=1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.destroyData(),this.addListener(),this.addEventListener(),this.initData()},t.prototype.destroyData=function(){this._storyId=1001,this._passedStoryId=0,this._challengeTimes=0,this._pass=!1,this._receiveList=[],this._ranks=[],this._myRank={},this._skillUseLimit={},this._skillUseTimes={},this._copyFightChange={},this._maxAnger=0,this._curCharpterId=1,this._curCharpterLv=1},t.prototype.addListener=function(){var t=td.ServerDelegate,e=td.MsgModuleName.EIGHT_DIAGRAM,i=td.MsgCmd.EIGHT_DIAGRAM;t.registerMessage(e,i.EIGHT_DIAGRAM_GET_INFO,this._onGetPlayInfo.bind(this)),t.registerMessage(e,i.EIGHT_DIAGRAM_PREPARE,this._onEDFightPrepare.bind(this)),t.registerMessage(e,i.EIGHT_DIAGRAM_CHALLENGE,this._onEDFightSync.bind(this)),t.registerMessage(e,i.EIGHT_DIAGRAM_REWARD_RECEIVE,this._onGetReward.bind(this)),t.registerMessage(e,i.EIGHT_DIAGRAM_RANKS,this._onGetRanks.bind(this)),t.registerMessage(e,i.PUSH_EIGHT_DIAGRAM_INFO,this._onGetPlayInfo.bind(this))},t.prototype.addEventListener=function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.ED_REQUEST_INFO]=this._requestInfo,i[e.ED_REQUEST_FIGHT_PREPARE]=this._requestEDFightPrepare,i[e.ED_REQUEST_FIGHT_SYNC]=this._requestEDFightSync,i[e.ED_REQUEST_REWARD_RECEIVE]=this._requestRewardReceive,i[e.ED_REQUEST_RANKS]=this._requestRanks,i[e.USER_ATTR_LEVEL_CHANGE]=this._reqInfo,i[e.ON_GET_SERVER_START_DAYS]=this._reqInfo,t.registerEvents(i,this)},t.prototype.initData=function(){},t.prototype._reqInfo=function(){this._requestInfo()},t.prototype._requestInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.EIGHT_DIAGRAMS,0)){var t={};t.module=td.MsgModuleName.EIGHT_DIAGRAM,t.cmd=td.MsgCmd.EIGHT_DIAGRAM.EIGHT_DIAGRAM_GET_INFO,td.ServerDelegate.sendMessage(t)}},t.prototype._onGetPlayInfo=function(t,e){if(t===td.NetCode.SUCCESS){if(this._passedStoryId=e.storyId,this._passedStoryId){var i=this.getStoryCfgByStoryId(this._passedStoryId);i&&(this._storyId=i.nextStoryId)}else this._storyId=this._storyId;this._challengeTimes=e.challengeTimes,this._pass=e.pass,this._receiveList=e.receiveList||[],this.MAX_TIMES||(this.MAX_TIMES=td.GetConfig("EIGHT_DIAGRAM_CHALLENGE_TIMES")||10),this.resetLimits(),this.setCharpterInfo(),td.EventUtil.dispatchEvent(td.EventNameEnum.ED_ON_GET_INFO)}},t.prototype._requestEDFightPrepare=function(t){var e={};e.module=td.MsgModuleName.EIGHT_DIAGRAM,e.cmd=td.MsgCmd.EIGHT_DIAGRAM.EIGHT_DIAGRAM_PREPARE,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._onEDFightPrepare=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ED_ON_GET_FIGHT_PREPARE)},t.prototype._requestEDFightSync=function(t){var e={};e.module=td.MsgModuleName.EIGHT_DIAGRAM,e.cmd=td.MsgCmd.EIGHT_DIAGRAM.EIGHT_DIAGRAM_CHALLENGE,e.id=t.id,e.isWin=t.isWin,e.check=t.check,td.ServerDelegate.sendMessage(e)},t.prototype._onEDFightSync=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.RECEIVE_PVE_FIHGT_REAWRD,n)}else td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PRE_PANEL)},t.prototype._requestRewardReceive=function(t){var e={};e.module=td.MsgModuleName.EIGHT_DIAGRAM,e.cmd=td.MsgCmd.EIGHT_DIAGRAM.EIGHT_DIAGRAM_REWARD_RECEIVE,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._onGetReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.ED_ON_GET_REWARD_RECEIVE)}},t.prototype._requestRanks=function(){var t={};t.module=td.MsgModuleName.EIGHT_DIAGRAM,t.cmd=td.MsgCmd.EIGHT_DIAGRAM.EIGHT_DIAGRAM_RANKS,td.ServerDelegate.sendMessage(t)},t.prototype._onGetRanks=function(t,e){t===td.NetCode.SUCCESS&&(this._ranks=e.ranks||[],this._ranks&&this._ranks.length>0&&(this._myRank=this._ranks.pop()),this._ranks.sort(function(t,e){return t.rank-e.rank}),td.EventUtil.dispatchEvent(td.EventNameEnum.ED_ON_GET_RANKS))},t.prototype.getCurStoryId=function(){return this._storyId},t.prototype.getStoryCfgByStoryId=function(t){var e=td.GetTableClass(td.TableEnum.EightDiagramsTable);return null==e?null:e.getCfgByStoryId(t)},t.prototype.getAllCharpterCfgs=function(){var t=td.GetTableClass(td.TableEnum.EightDiagramChapterTable);return null==t?null:t.getAllCfgs()},t.prototype.getChapterCfgByChapterId=function(t){var e=td.GetTableClass(td.TableEnum.EightDiagramChapterTable);return null==e?null:e.getCfgByChapterId(t)},t.prototype.getLimitCfgByLimitId=function(t){var e=td.GetTableClass(td.TableEnum.EightDiagramsLimitTable);return null==e?null:e.getCfgByLimitId(t)},t.prototype.getCharpterLvByStoryId=function(t){var e=td.GetTableClass(td.TableEnum.EightDiagramsTable);return null==e?null:e.getCharpterLvByStoryId(t)},t.prototype.getCurStoryCfg=function(){var t=this.getStoryCfgByStoryId(this._storyId);return t||(t=this.getStoryCfgByStoryId(this._passedStoryId)),t},t.prototype.getPassedStoryCfg=function(){return this.getStoryCfgByStoryId(this._passedStoryId)},t.prototype.getStorysByCharpterId=function(t){var e=td.GetTableClass(td.TableEnum.EightDiagramsTable);return null==e?null:e.getStorysByCharpterId(t)},t.prototype.getCurCharpterMaxStoryCfg=function(){var t=this.getStorysByCharpterId(this._curCharpterId);return t[t.length-1]},t.prototype.getCharpterMaxStoryCfg=function(t){var e=this.getStorysByCharpterId(t);return e[e.length-1]},t.prototype.getCurStoryConditions=function(){for(var t=this.getCurStoryCfg().limitIds||[],e=[],i=0;i<t.length;i++){var n=t[i],a=this.getLimitCfgByLimitId(n);a&&e.push(a.tips)}return e},t.prototype.getShowRewardCharpterId=function(){var t=(this._receiveList[this._receiveList.length-1]||0)+1;return this.getChapterCfgByChapterId(t)?t:t-1},t.prototype.getShowChapterRewardsCfg=function(){var t=this.getShowRewardCharpterId();return this.getChapterCfgByChapterId(t)},t.prototype.getRanks=function(){return this._ranks},t.prototype.getMyRank=function(){return this._myRank},t.prototype.getPass=function(){return this._pass},t.prototype.getTimes=function(){return this.MAX_TIMES-this._challengeTimes},t.prototype.isChasingType=function(){var t=this.getCurStoryCfg();return!!t&&t.type==n.ED_FIGHT_TYPE.CHASE},t.prototype.setCharpterInfo=function(){var t=this.getCurStoryCfg();this._curCharpterId=t.chapterId,this._curCharpterLv=this.getCharpterLvByStoryId(t.storyId)},t.prototype.getCurCharpterId=function(){return this._curCharpterId},t.prototype.getCurCharpterLv=function(){return this._curCharpterLv},t.prototype.setLimitConditions=function(){for(var t=this.getCurStoryCfg().limitIds||[],e=0;e<t.length;e++){var i=t[e],a=this.getLimitCfgByLimitId(i);if(a&&a.type==n.ED_LIMIT_TYPE.HERO_FIGHT)for(var r=a.value,o=0;o<r.length;o++){var s=r[o];this._copyFightChange[s[0]]=s[1]}else a&&a.type==n.ED_LIMIT_TYPE.INSPIRE_LIMIT?this._skillUseLimit[td.PveEnum.PVE_UI_SKILL_ID.Inspire]=a.value:a&&a.type==n.ED_LIMIT_TYPE.ICE_RAIN_LIMIT?this._skillUseLimit[td.PveEnum.PVE_UI_SKILL_ID.IceRain]=a.value:a&&a.type==n.ED_LIMIT_TYPE.LIGHT_LIMIT?this._skillUseLimit[td.PveEnum.PVE_UI_SKILL_ID.Light]=a.value:a&&a.type==n.ED_LIMIT_TYPE.MAX_ANGER&&(this._maxAnger=a.value)}},t.prototype.getSkillUseLimit=function(){return this._skillUseLimit},t.prototype.getSkillUseLimitBySkillId=function(t){var e=this._skillUseLimit[t];return null==e&&(e=-1),e},t.prototype.setSkillUseTimesBySkillId=function(t){this._skillUseTimes[t]||(this._skillUseTimes[t]=0),this._skillUseTimes[t]+=1},t.prototype.getSkillUseBySkillId=function(t){return this._skillUseTimes[t]||0},t.prototype.resetLimits=function(){this._maxAnger=0,this._skillUseLimit={},this._skillUseTimes={},this.setLimitConditions()},t.prototype.isSkillTimesUseOut=function(t){var e=this.getSkillUseLimitBySkillId(t),i=this.getSkillUseBySkillId(t);return e>=0&&i>=e},t.prototype.getHeroFightChange=function(t){return this._copyFightChange[t]||1e4},t.prototype.getMaxAnger=function(){return this._maxAnger},t.prototype.isFirstCharpterLv=function(){return 1==this._curCharpterLv},t.prototype.isLastStoryPass=function(){return 0==this._storyId},t.prototype.isRewardReceived=function(t){return-1!==this._receiveList.indexOf(t)},t.prototype.isRewardReach=function(t){return this._curCharpterId>t||this._curCharpterId==t&&this.isLastStoryPass()},t.prototype.openPanel=function(){td.GlobalFunction.setLocalSaveStatus("EightDiagrams","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.ED_PANEL_OPENED)},t.prototype.isLoginTodayShow=function(){return!td.GlobalFunction.getLocalSaveStatus("EightDiagrams")},t.prototype._isFuncUnlock=function(){return!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.EIGHT_DIAGRAMS,0)},t.prototype.isChanllengeTimesEnough=function(){return this.getTimes()>0},t.prototype.isHavingRewardReceiving=function(){var t=this.getShowRewardCharpterId();return!this.isRewardReceived(t)&&(this._curCharpterId>t||this._curCharpterId==t&&this.isLastStoryPass())},t.prototype.isRedPointTips=function(){return this._isFuncUnlock()&&(this.isLoginTodayShow()||this.isHavingRewardReceiving())},t.prototype.redPointEvents=function(){return[td.EventNameEnum.ED_PANEL_OPENED,td.EventNameEnum.ED_ON_GET_INFO,td.EventNameEnum.ED_ON_GET_REWARD_RECEIVE]},t._instance=null,t}();i.default=a,cc._RF.pop()},{"../Enum/EightDiagramsEnum":"EightDiagramsEnum"}],EightDiagramsTable:[function(t,e,i){"use strict";cc._RF.push(e,"5e619hJ3OFGpp9+l9L8pODr","EightDiagramsTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EightDiagramsTable",e._tblName="eight_diagram_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t.push(a)}},e.prototype.getCfgByStoryId=function(t){if(null==this._data)return null;for(var e=this._data,i=0;i<e.length;i++){var n=e[i];if(n.storyId==t)return n}return null},e.prototype.getStorysByCharpterId=function(t){if(null==this._data)return null;for(var e=[],i=0;i<this._data.length;i++){var n=this._data[i];n.chapterId==t&&e.push(n)}return e},e.prototype.getCharpterLvByStoryId=function(t){if(null==this._data)return null;var e=this.getCfgByStoryId(t);if(e){var i=this.getStorysByCharpterId(e.chapterId);i.sort(function(t,e){return t.storyId-e.storyId});for(var n=0;n<i.length;n++){if(i[n].storyId==t)return n+1}}return 0},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EndlessEnum:[function(t,e,i){"use strict";cc._RF.push(e,"ee4f4etTYdJHaXtq05ZOlPz","EndlessEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.EndlessType=void 0,function(t){t[t.NORMAL=1]="NORMAL",t[t.MASTER=2]="MASTER",t[t.NONE=0]="NONE"}(i.EndlessType||(i.EndlessType={})),cc._RF.pop()},{}],EndlessManager:[function(t,e,i){"use strict";cc._RF.push(e,"78e98rPlchGL4PnfMGgOV5i","EndlessManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("EndlessModel"),r=t("../../Shop/Manager/ShopManager"),o=t("../Model/EndlessEnum"),s=t("../../Shop/Manager/ShopEnum"),l=function(){function t(){this.isInit=!0,this._isWait=!1,this._isShowRedPoint=!0,this._fightFloor=0,this._endLessType=0,this._isNextFloor=!1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._rankList={},this._model={},this._isWait=!1,this._isShowRedPoint=!0},t.prototype.addListener=function(){var t=n.MsgModuleName.ENDLESS,e=n.MsgCmd.ENDLESS;n.ServerDelegate.registerMessage(t,e.GET_ENDLESS_INFO,this.parseEndlessInfo.bind(this)),n.ServerDelegate.registerMessage(t,e.GET_ENDLESS_RANK,this.parseRankInfo.bind(this)),n.ServerDelegate.registerMessage(t,e.ENDLESS_CHALLENGE,this.parseChallenge.bind(this)),n.ServerDelegate.registerMessage(t,e.ENDLESS_PLAY,this.parsePlay.bind(this)),n.ServerDelegate.registerMessage(t,e.ENDLESS_SWEEP,this.parseSweep.bind(this)),n.ServerDelegate.registerMessage(t,e.ENDLESS_RESET,this.parseReset.bind(this)),n.ServerDelegate.registerMessage(t,e.ENDLESS_RECEIVE,this.parseReceive.bind(this)),n.ServerDelegate.registerMessage(t,e.PUSH_ENDLESS_INFO,this.parseEndlessInfo.bind(this))},t.prototype.addEventListener=function(){var t=n.EventUtil,e=n.EventNameEnum,i={};i[e.REQ_GET_ENDLESS_INFO]=this.requestEndlessInfo,i[e.REQ_GET_ENDLESS_RANK]=this.requestEndlessRank,i[e.REQ_ENDLESS_CHALLENGE]=this.requestChallenge,i[e.REQ_ENDLESS_PLAY]=this.requestEndlessPlay,i[e.REQ_ENDLESS_SWEEP]=this.requestSweep,i[e.REQ_ENDLESS_RESET]=this.requestReset,i[e.REQ_ENDLESS_RECEIVE]=this.requestReceive,t.registerEvents(i,this)},t.prototype.requestEndlessInfo=function(){var t={};t.module=n.MsgModuleName.ENDLESS,t.cmd=n.MsgCmd.ENDLESS.GET_ENDLESS_INFO,n.ServerDelegate.sendMessage(t)},t.prototype.requestEndlessRank=function(t){var e={};e.module=n.MsgModuleName.ENDLESS,e.cmd=n.MsgCmd.ENDLESS.GET_ENDLESS_RANK,e.type=t,n.ServerDelegate.sendMessage(e)},t.prototype.requestChallenge=function(t){var e={};e.module=n.MsgModuleName.ENDLESS,e.cmd=n.MsgCmd.ENDLESS.ENDLESS_CHALLENGE,e.type=t.type,e.floor=t.floor,n.ServerDelegate.sendMessage(e),this._fightFloor=t.floor,this._endLessType=t.type},t.prototype.requestEndlessPlay=function(t){var e={};e.module=n.MsgModuleName.ENDLESS,e.cmd=n.MsgCmd.ENDLESS.ENDLESS_PLAY,e.type=t.type,e.floor=t.floor,n.ServerDelegate.sendMessage(e)},t.prototype.requestSweep=function(t){var e={};e.module=n.MsgModuleName.ENDLESS,e.cmd=n.MsgCmd.ENDLESS.ENDLESS_SWEEP,e.type=t,n.ServerDelegate.sendMessage(e)},t.prototype.requestReset=function(t){var e={};e.module=n.MsgModuleName.ENDLESS,e.cmd=n.MsgCmd.ENDLESS.ENDLESS_RESET,e.type=t,n.ServerDelegate.sendMessage(e)},t.prototype.requestReceive=function(t){var e={};e.module=n.MsgModuleName.ENDLESS,e.cmd=n.MsgCmd.ENDLESS.ENDLESS_RECEIVE,e.id=t,n.ServerDelegate.sendMessage(e)},t.prototype.parseEndlessInfo=function(t,e){if(t===n.NetCode.SUCCESS&&e&&e.info){for(var i in e.info){var r=e.info[i];this._model[i]||(this._model[i]=new a),(r.floor||0==r.floor)&&this._model[i].setFloor(r.floor),(r.maxFloor||0==r.maxFloor)&&this._model[i].setMaxFloor(r.maxFloor),(r.resetTimes||0==r.resetTimes)&&this._model[i].setResetTimes(r.resetTimes),r.receiveList&&r.receiveList.length>0&&this._model[i].setReceiveList(r.receiveList)}n.EventUtil.dispatchEvent(n.EventNameEnum.RES_GET_ENDLESS_INFO)}},t.prototype.parseRankInfo=function(t,e){t===n.NetCode.SUCCESS&&(this._rankList[e.type]=e.ranks,n.EventUtil.dispatchEvent(n.EventNameEnum.RES_GET_ENDLESS_RANK,[t,e]))},t.prototype.parseChallenge=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_ENDLESS_CHALLENGE)},t.prototype.parsePlay=function(t,e){if(t===n.NetCode.SUCCESS){var i=n.RewardManager.parseRewardResult(e.reward);n.GlobalFunction.showRewards(i),n.EventUtil.dispatchEvent(n.EventNameEnum.RES_ENDLESS_PLAY)}},t.prototype.parseSweep=function(t,e){if(t===n.NetCode.SUCCESS){var i={};for(var a in e.rewards)if(e.rewards.hasOwnProperty(a)){var r=e.rewards[a],o=n.RewardManager.parseRewardResult(r);i[a]=o}n.EventUtil.dispatchEvent(n.EventNameEnum.RES_ENDLESS_SWEEP,i)}},t.prototype.parseReset=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_ENDLESS_RESET)},t.prototype.parseReceive=function(t,e){if(t===n.NetCode.SUCCESS){var i=n.RewardManager.parseRewardResult(e.reward);n.EventUtil.dispatchEvent(n.EventNameEnum.RES_ENDLESS_RECEIVE,i)}},t.prototype.hasNextGate=function(){var t=n.GetTableClass(n.TableEnum.EndlessTable).getMaxFloorByType(o.EndlessType.NORMAL),e=this.getModelByType(o.EndlessType.NORMAL),i=e?e.getMaxFloor():0;return(this._fightFloor%5!=0||this._fightFloor!==i)&&this._fightFloor!==t},t.prototype.getFightFloor=function(){return this._fightFloor},t.prototype.getIsNextFloor=function(){return this._isNextFloor},t.prototype.setIsNextFloor=function(t){this._isNextFloor=t},t.prototype.getFloor=function(){return this._floor},t.prototype.setFloor=function(t){this._floor=t},t.prototype.getRankListByType=function(t){return this._rankList[t]},t.prototype.getModelByType=function(t){return this._model[t]},t.prototype.getSelect=function(){var t=n.LocalStorageUtil.read(n.LocalDataKey.Endless_Skip);return"true"===t||!0===t},t.prototype.setSelect=function(t){n.LocalStorageUtil.write(n.LocalDataKey.Endless_Skip,t+"")},t.prototype.getIsWait=function(){return this._isWait},t.prototype.setIsWait=function(t){this._isWait=t},t.prototype.getIsShowRedPoint=function(){return this._isShowRedPoint},t.prototype.setIsShowRedPoint=function(t){this._isShowRedPoint=t},t.prototype.isRedPointTips=function(){if(!n.UnlockManager.isPanelUnlock(n.PanelEnum.Panel_DestroyTemple))return!1;if(this.checkNewGoods())return!0;if(!this._isShowRedPoint)return!1;var t=n.Account.getUserData().getVip(),e=(n.GetTableClass(n.TableEnum.VipPrivilegeTable).getPrerogativeValueByTypeAdnValue(3,t),this.getMaxFreeResetTimes());for(var i in this._model)if(Number(i)==o.EndlessType.NORMAL&&this._model[i].getResetTimes()<e)return!0;return!1},t.prototype.checkNewGoods=function(){return r.default.getInstance().isShopTipsByType(s.StoreType.EQUIPMENT)},t.prototype.redPointEvents=function(){return[]},t.prototype.getMaxFreeResetTimes=function(){for(var t=n.GetConfig("ENDLESS_RESET_COST"),e=0,i=0;i<t.length;i++){var a=t[i];if(i+1<t.length){var r=t[i+1];if(a[1].length<=0){e=r[0]-1;break}}}return e},t}();i.default=l,cc._RF.pop()},{"../../Shop/Manager/ShopEnum":"ShopEnum","../../Shop/Manager/ShopManager":"ShopManager","../Model/EndlessEnum":"EndlessEnum",EndlessModel:"EndlessModel"}],EndlessModel:[function(t,e,i){"use strict";cc._RF.push(e,"800c1M/BjxOAIbj5iZ6n71l","EndlessModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("Model"),r=t("../Model/EndlessEnum"),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._floor=0,e._maxFloor=0,e._resetTimes=0,e._receiveList=[],e._showlength=6,e._box=5,e}return n(e,t),e.prototype.getFloor=function(){return this._floor},e.prototype.getMaxFloor=function(){return this._maxFloor},e.prototype.getResetTimes=function(){return this._resetTimes},e.prototype.getReceiveList=function(){return this._receiveList},e.prototype.setFloor=function(t){this._floor=t},e.prototype.setMaxFloor=function(t){this._maxFloor=t},e.prototype.setResetTimes=function(t){this._resetTimes=t},e.prototype.setReceiveList=function(t){this._receiveList=t},e.prototype.getShowList=function(){var t=[],e=td.GetTableClass(td.TableEnum.EndlessTable).getMaxFloorByType(r.EndlessType.NORMAL);if(this._floor<2){for(var i=1;i<this._showlength;i++){var n=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,i);t.push(n)}var a=td.GetTableClass(td.TableEnum.EndlessRewardTable).getDataByfloorAndType(this._box,r.EndlessType.NORMAL);t.push(a)}else if(this._floor>e-3)for(i=e-2;i<=e;i++){n=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,i);t.push(n)}else{i=this._floor;for(this._floor%this._box!=0&&this._floor%this._box!=1&&i--;t.length<this._showlength;i++){n=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,i);if(t.push(n),i%this._box==0&&t.length<this._showlength){a=td.GetTableClass(td.TableEnum.EndlessRewardTable).getDataByfloorAndType(i,r.EndlessType.NORMAL);t.push(a)}}}for(var o=this._showlength-t.length;o>0;o--)t.push(null);return t},e.prototype.getOldFloor=function(){return this._floor<2?this._floor:this._floor-1},e.prototype.getOldShowList=function(){var t=[],e=this.getOldFloor(),i=td.GetTableClass(td.TableEnum.EndlessTable).getMaxFloorByType(r.EndlessType.NORMAL);if(e<2){for(var n=1;n<this._showlength;n++){var a=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,n);t.push(a)}var o=td.GetTableClass(td.TableEnum.EndlessRewardTable).getDataByfloorAndType(this._box,r.EndlessType.NORMAL);t.push(o)}else if(e>i-3)for(n=i-2;n<=i;n++){a=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,n);t.push(a)}else{n=e;for(e%this._box!=0&&e%this._box!=1&&n--;t.length<this._showlength;n++){a=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,n);if(t.push(a),n%this._box==0&&t.length<this._showlength){o=td.GetTableClass(td.TableEnum.EndlessRewardTable).getDataByfloorAndType(n,r.EndlessType.NORMAL);t.push(o)}}}for(var s=this._showlength-t.length;s>0;s--)t.push(null);return t},e.prototype.getNextShowListByFloor=function(t,e){var i=[];if(e)if(t%5==0){var n=td.GetTableClass(td.TableEnum.EndlessRewardTable).getDataByfloorAndType(t,r.EndlessType.NORMAL);a=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,t+1);n&&i.push(n),a&&i.push(a)}else if(t%5==4){n=td.GetTableClass(td.TableEnum.EndlessRewardTable).getDataByfloorAndType(t+1,r.EndlessType.NORMAL);(a=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,t+1))&&i.push(a),n&&i.push(n)}else{a=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,t+1),o=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,t+2);a&&i.push(a),o&&i.push(o)}else{var a=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,t+1),o=td.GetTableClass(td.TableEnum.EndlessTable).getDataByTypeAndFloor(r.EndlessType.NORMAL,t+2);a&&i.push(a),o&&i.push(o)}return i},e}(a);e.exports=o,cc._RF.pop()},{"../Model/EndlessEnum":"EndlessEnum",Model:"Model"}],EndlessRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"ccb41oVz7FGi7g/EhsxF4ws","EndlessRewardTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EndlessRewardConfig",e._tblName="endless_reward_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getData=function(t){return this._data[t]?this._data[t]:null},e.prototype.getDataByfloorAndType=function(t,e){for(var i in this._data){var n=this._data[i];if(n.floor==t&&n.type==e)return n}return null},e.prototype.getRewardListByType=function(t){var e=[];for(var i in this._data){var n=this._data[i];n.type==t&&e.push(n)}return e.sort(this.sortFunc)},e.prototype.sortFunc=function(t,e){return t.floor-e.floor},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EndlessTable:[function(t,e,i){"use strict";cc._RF.push(e,"21f11EFEa9LmowmyjOp/rnY","EndlessTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EndlessConfig",e._tblName="endless_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.type;t[r]||(t[r]={}),t[r][a.floor]=a}},e.prototype.getDataByTypeAndFloor=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].floor===e)return i[n]}}return null},e.prototype.getMaxFloorByType=function(t){return this._data[t]?this._data[t].myLen():0},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EnemyBuffCtrlComponent:[function(t,e,i){"use strict";cc._RF.push(e,"12810W7JMhJb7ofEPNtKgp9","EnemyBuffCtrlComponent");var n=t("BurnBuff"),a=t("FreezeBuff"),r=t("MDBuff"),o=t("PDBuff"),s=t("VertigoBuff"),l=t("PureHurt2Buff"),c=t("MonsterSpeedBuff"),u=(t("CommonEnum"),t("PveFightManager")),d=t("../../manager/PveDataHelper").default,h=cc.Class({extends:cc.Component,properties:{_updateFreezeBuff:null,_freezeBuffList:null,_updateVertigoBuff:null,_vertigoBuffList:null,_updateMDBuff:null,_MDBuffList:null,_updatePDBuff:null,_PDBuffList:null,_updateBurnBuff:null,_burnBuffList:null,_updatePureHurt2Buff:null,_pureHurt2BuffList:null,_updateSpeedChangeBuff:null,_speedChangeBuffList:null,_curSpeedMult:null,_curExecutingBuffKeyList:null,_buffUpateCount:0},onEnable:function(){this._freezeBuffList=[],this._vertigoBuffList=[],this._MDBuffList=[],this._PDBuffList=[],this._burnBuffList=[],this._pureHurt2BuffList=[],this._speedChangeBuffList=[],this._updateFreezeBuff=!0,this._updateVertigoBuff=!0,this._updateMDBuff=!0,this._updatePDBuff=!0,this._updateBurnBuff=!0,this._updatePureHurt2Buff=!0,this._updateSpeedChangeBuff=!0,this._buffUpateCount=0,this._curExecutingBuffKeyList=[],this._curSpeedMult=u.getCurFightSpeedMult()},onDisable:function(){this._freezeBuffList=null,this._vertigoBuffList=null,this._MDBuffList=null,this._PDBuffList=null,this._burnBuffList=null,this._pureHurt2BuffList=null,this._speedChangeBuffList=null,this._curSpeedMult=null,this._updateFreezeBuff=null,this._updateVertigoBuff=null,this._updateMDBuff=null,this._updatePDBuff=null,this._updateBurnBuff=null,this._updatePureHurt2Buff=null;for(var t=this.node.getChildByName("newBuffLayer").children,e=0;e<t.length;e++)t[e].active=!1},setCurSpeedMult:function(t){this._curSpeedMult=t},update:function(t){if(this._buffUpateCount++,this._buffUpateCount%5==0){var e=t*this._curSpeedMult;this._updateFreezeBuffList(e),this._updateVertigoBuffList(e),this._updateMDBuffList(e),this._updatePDBuffList(e),this._updateBurnBuffList(e),this._updatePureHurt2BuffList(e),this._updateSpeedChangeBuffList(e)}},_updateFreezeBuffList:function(t){for(var e=[],i=0,n=this._freezeBuffList.length;i<n;i++){var a=this._freezeBuffList[i],r=a.buffKey,o=a.buffData,s=this._isExecutingWithBuffKey(r);o.buffTime-=t,o.buffTime<=0&&!s&&e.push(a)}for(var l=0,c=e.length;l<c;l++){var u=e[l].buffKey;this._removeBuffDataFromList(u,this._freezeBuffList)}if(this._updateFreezeBuff){var d=this._freezeBuffList.shift();this.addNewEnemyBuff(d)}},_updateVertigoBuffList:function(t){for(var e=[],i=0,n=this._vertigoBuffList.length;i<n;i++){var a=this._vertigoBuffList[i],r=a.buffKey,o=a.buffData,s=this._isExecutingWithBuffKey(r);o.buffTime-=t,o.buffTime<=0&&!s&&e.push(a)}for(var l=0,c=e.length;l<c;l++){var u=e[l].buffKey;this._removeBuffDataFromList(u,this._vertigoBuffList)}if(this._updateVertigoBuff){var d=this._vertigoBuffList.shift();this.addNewEnemyBuff(d)}},_updateMDBuffList:function(t){for(var e=[],i=0,n=this._MDBuffList.length;i<n;i++){var a=this._MDBuffList[i],r=a.buffKey,o=a.buffData,s=this._isExecutingWithBuffKey(r);o.buffTime-=t,o.buffTime<=0&&!s&&e.push(a)}for(var l=0,c=e.length;l<c;l++){var u=e[l].buffKey;this._removeBuffDataFromList(u,this._MDBuffList)}if(this._updateMDBuff){var d=this._MDBuffList.shift();this.addNewEnemyBuff(d)}},_updatePDBuffList:function(t){for(var e=[],i=0,n=this._PDBuffList.length;i<n;i++){var a=this._PDBuffList[i],r=a.buffKey,o=a.buffData,s=this._isExecutingWithBuffKey(r);o.buffTime-=t,o.buffTime<=0&&!s&&e.push(a)}for(var l=0,c=e.length;l<c;l++){var u=e[l].buffKey;this._removeBuffDataFromList(u,this._PDBuffList)}if(this._updatePDBuff){var d=this._PDBuffList.shift();this.addNewEnemyBuff(d)}},_updateBurnBuffList:function(t){for(var e=[],i=0,n=this._burnBuffList.length;i<n;i++){var a=this._burnBuffList[i],r=a.buffKey,o=a.buffData,s=this._isExecutingWithBuffKey(r);o.buffTime-=t,o.buffTime<=0&&!s&&e.push(a)}for(var l=0,c=e.length;l<c;l++){var u=e[l].buffKey;this._removeBuffDataFromList(u,this._burnBuffList)}if(this._updateBurnBuff){var d=this._burnBuffList.shift();this.addNewEnemyBuff(d)}},_updatePureHurt2BuffList:function(t){for(var e=[],i=0,n=this._pureHurt2BuffList.length;i<n;i++){var a=this._pureHurt2BuffList[i],r=a.buffKey,o=a.buffData,s=this._isExecutingWithBuffKey(r);o.buffTime-=t,o.buffTime<=0&&!s&&e.push(a)}for(var l=0,c=e.length;l<c;l++){var u=e[l].buffKey;this._removeBuffDataFromList(u,this._pureHurt2BuffList)}if(this._updatePureHurt2Buff){var d=this._pureHurt2BuffList.shift();this.addNewEnemyBuff(d)}},_updateSpeedChangeBuffList:function(t){for(var e=[],i=0,n=this._speedChangeBuffList.length;i<n;i++){var a=this._speedChangeBuffList[i],r=a.buffKey,o=a.buffData,s=this._isExecutingWithBuffKey(r);o.buffTime-=t,o.buffTime<=0&&!s&&e.push(a)}for(var l=0,c=e.length;l<c;l++){var u=e[l].buffKey;this._removeBuffDataFromList(u,this._speedChangeBuffList)}if(this._updatePureHurt2Buff){var d=this._speedChangeBuffList.shift();this.addNewEnemyBuff(d)}},addBuffToList:function(t,e,i){var n={buffKey:e,buffData:i},a=this._getBuffListByType(t);if(a){this.handleTecEffect(n);var r=this._checkBuffDataInList(e,a);if(r)this._isExecutingWithBuffKey(e)?r.buffData=i:this._refreshBuffDataOfList(n,a);else a.push(n)}},handleTecEffect:function(t){var e=t.buffData,i=e.vocation,n=e.buffTime,a=e.buffData,r=e.buffType,o=d.getSkillAdditions(i,!0);switch(i){case td.PveEnum.PVE_HERO_VOCATION.GUNNER:if(r===td.PveEnum.PVE_EFFECT_TYPE.Vertigo&&o&&o[td.PveEnum.TecEffectType.EXTEND_VERTIGO]){var s=o[td.PveEnum.TecEffectType.EXTEND_VERTIGO];1e4*Math.random()<=s[0]&&(n+=Math.floor(s[1]/1e3)/10,e.buffTime=n)}break;case td.PveEnum.PVE_HERO_VOCATION.MASTER:if(r===td.PveEnum.PVE_EFFECT_TYPE.ReduceSpeed&&o&&o[td.PveEnum.TecEffectType.EXTEND_REDUCTION]){var l=o[td.PveEnum.TecEffectType.EXTEND_REDUCTION];1e4*Math.random()<=l[0]&&(n+=Math.floor(l[1]/1e3)/10,e.buffTime=n)}break;case td.PveEnum.PVE_HERO_VOCATION.COUNSELLOR:if(r===td.PveEnum.PVE_EFFECT_TYPE.PersistentInjury&&o&&o[td.PveEnum.TecEffectType.EXTEND_BURN]){var c=o[td.PveEnum.TecEffectType.EXTEND_BURN];1e4*Math.random()<=c[0]&&(a*=1+Math.floor(c[1]/100)/100,e.buffData=a)}var u=this.node.getComponent("BaseEnemy");if(u){var h=u.getDataModel().getGrade(),p=d.getSkillAdditions(i),_=0;if(p&&p[td.PveEnum.TecEffectType.HURT_ADD]){var g=p[td.PveEnum.TecEffectType.HURT_ADD];switch(g[0]){case 0:_=g[1]/1e4;break;case 1:h!==td.PveEnum.PVE_ENERMY_GRADE.NORMAL&&h!==td.PveEnum.PVE_ENERMY_GRADE.ELIET||(_=g[1]/1e4);break;case 2:h!==td.PveEnum.PVE_ENERMY_GRADE.BOSS&&h!==td.PveEnum.PVE_ENERMY_GRADE.DEMON_BOSS&&h!==td.PveEnum.PVE_ENERMY_GRADE.SMALLBOSS||(_=g[1]/1e4)}}var f=0;if(p&&p[td.PveEnum.TecEffectType.HURT_ADD_ALL])f=p[td.PveEnum.TecEffectType.HURT_ADD_ALL]/1e4;a*=1+_+f,e.buffData=a}}},removeBuffFromList:function(t,e){var i=this._getBuffListByType(t);i&&(this._removeBuffDataFromList(e,i),this._removeBuffKeyFromExecutingList(e),this._setBuffUpdateStatus(t,!0))},addNewEnemyBuff:function(t){if(!u.debugParams[5]&&t){var e=t.buffData,i=t.buffKey,n=e.buffType,a={buffKey:i,target:this.node,curBuffData:e},r=this._getBuffLogicScript(n),o=this.node.getChildByName("newBuffLayer"),s=o.getChildByName("buffNode_"+n);s?s.getComponent(r).initData(a):((s=new cc.Node).name="buffNode_"+n,s.addComponent(r).initData(a),o&&o.addChild(s));var l=this._getBuffNodePosByType(n);s.setPosition(l),s.active=!0,this._setBuffUpdateStatus(n,!1),this._addBuffKeyToExecutingList(i)}},_getBuffLogicScript:function(t){var e=null;switch(t){case td.PveEnum.PVE_EFFECT_TYPE.ReduceSpeed:e=a;break;case td.PveEnum.PVE_EFFECT_TYPE.Vertigo:e=s;break;case td.PveEnum.PVE_EFFECT_TYPE.PersistentInjury:e=n;break;case td.PveEnum.PVE_EFFECT_TYPE.ReduceMagicDefence:e=r;break;case td.PveEnum.PVE_EFFECT_TYPE.ReducePhysicsDefence:e=o;break;case td.PveEnum.PVE_EFFECT_TYPE.PureHurt2:e=l;break;case td.PveEnum.PVE_EFFECT_TYPE.SpeedChange:e=c}return e},_getBuffNodePosByType:function(t){var e=0,i=0,n=this.node.getContentSize();switch(t){case td.PveEnum.PVE_EFFECT_TYPE.ReduceSpeed:i=n.height/2;break;case td.PveEnum.PVE_EFFECT_TYPE.Vertigo:i=n.height;break;case td.PveEnum.PVE_EFFECT_TYPE.PersistentInjury:i=n.height/2;break;case td.PveEnum.PVE_EFFECT_TYPE.ReduceMagicDefence:case td.PveEnum.PVE_EFFECT_TYPE.ReducePhysicsDefence:i=0;break;default:e=0,i=n.height}return cc.v2(e,i)},_addBuffKeyToExecutingList:function(t){this._curExecutingBuffKeyList.push(t)},_removeBuffKeyFromExecutingList:function(t){var e=this._curExecutingBuffKeyList.indexOf(t);-1!==e&&this._curExecutingBuffKeyList.splice(e,1)},_refreshBuffDataOfList:function(t,e){var i=t.buffKey;this._removeBuffDataFromList(i,e),e.push(t)},_removeBuffDataFromList:function(t,e){for(var i=-1,n=0,a=e.length;n<a;n++){if(t===e[n].buffKey){i=n;break}}-1!==i&&e.splice(i,1)},_isExecutingWithBuffKey:function(t){for(var e=0,i=this._curExecutingBuffKeyList.length;e<i;e++){if(this._curExecutingBuffKeyList[e]===t)return!0}return!1},_checkBuffDataInList:function(t,e){for(var i=0,n=e.length;i<n;i++){var a=e[i];if(t===a.buffKey)return a}return null},_getBuffListByType:function(t){var e=null;switch(t){case td.PveEnum.PVE_EFFECT_TYPE.ReduceSpeed:e=this._freezeBuffList;break;case td.PveEnum.PVE_EFFECT_TYPE.Vertigo:e=this._vertigoBuffList;break;case td.PveEnum.PVE_EFFECT_TYPE.PersistentInjury:e=this._burnBuffList;break;case td.PveEnum.PVE_EFFECT_TYPE.ReduceMagicDefence:e=this._MDBuffList;break;case td.PveEnum.PVE_EFFECT_TYPE.ReducePhysicsDefence:e=this._PDBuffList;break;case td.PveEnum.PVE_EFFECT_TYPE.PureHurt2:e=this._pureHurt2BuffList;break;case td.PveEnum.PVE_EFFECT_TYPE.SpeedChange:e=this._speedChangeBuffList}return e},_setBuffUpdateStatus:function(t,e){switch(t){case td.PveEnum.PVE_EFFECT_TYPE.ReduceSpeed:this._updateFreezeBuff=e;break;case td.PveEnum.PVE_EFFECT_TYPE.Vertigo:this._updateVertigoBuff=e;break;case td.PveEnum.PVE_EFFECT_TYPE.PersistentInjury:this._updateBurnBuff=e;break;case td.PveEnum.PVE_EFFECT_TYPE.ReduceMagicDefence:this._updateMDBuff=e;break;case td.PveEnum.PVE_EFFECT_TYPE.ReducePhysicsDefence:this._updatePDBuff=e;break;case td.PveEnum.PVE_EFFECT_TYPE.PureHurt2:this._updatePureHurt2Buff=e;break;case td.PveEnum.PVE_EFFECT_TYPE.SpeedChange:this._updateSpeedChangeBuff=e}}});e.exports=h,cc._RF.pop()},{"../../manager/PveDataHelper":"PveDataHelper",BurnBuff:"BurnBuff",CommonEnum:void 0,FreezeBuff:"FreezeBuff",MDBuff:"MDBuff",MonsterSpeedBuff:"MonsterSpeedBuff",PDBuff:"PDBuff",PureHurt2Buff:"PureHurt2Buff",PveFightManager:"PveFightManager",VertigoBuff:"VertigoBuff"}],EnemyModel:[function(t,e,i){"use strict";cc._RF.push(e,"a3c9dT6l3ZBHboirOtjAbAw","EnemyModel");var n=cc.Class({_id:null,_enemyName:null,_enemyType:null,_enemyDesc:null,_moveSpeed:null,_level:null,_grade:null,_res:null,_hp:null,_physicalDefence:null,_migicDefence:null,_energyReward:null,_hpCost:null,_deadMusicId:null,_skillType:null,_resPath:null,_animationRes:null,_shadowScale:null,_roleType:null,_modelShowType:null,_enemyData:null,init:function(t){this._id=t.id,this._enemyName=t.name,this._enemyType=t.type,this._enemyDesc=t.Des,this._moveSpeed=t.moveSpeed,this._level=t.level,this._grade=t.grade,this._res=t.res,this._roleType=this._res.substring(this._res.lastIndexOf("_")+1,this._res.length),this._roleType=parseInt(this._roleType),this._hp=t.hp,this._physicalDefence=t.physicalDefence,this._migicDefence=t.magicDefence,this._energyReward=t.energyReward,this._hpCost=t.hpcost,this._deadMusicId=t.deadMisicId||0,this._skillType=t.skillType,this._animationRes=t.animationRes,this._shadowScale=t.shadowScale||50,this._shadowScale=this._shadowScale/100,this._enemyData=t,this._modelShowType=2},getGrade:function(){return this._grade},getRoleType:function(){return this._roleType},getModelShowType:function(){return this._modelShowType},getShadowScale:function(){return this._shadowScale},getId:function(){return this._id},getAnimationRes:function(){return this._animationRes},getResPath:function(){return this._resPath},getRes:function(){return this._res},getEnemyName:function(){return this._enemyName},getEnemyType:function(){return this._enemyType},getEnemyTypeName:function(){return td.Language["pve_enemy_type_"+this._enemyType+"_"+this._grade]},getEnemyDesc:function(){return this._enemyDesc},getMoveSpeed:function(){return this._moveSpeed},getHp:function(){return this._hp},getPhysicsDefence:function(){return this._physicalDefence},getMagicDefence:function(){return this._migicDefence},getEnergyReward:function(){return this._energyReward},getHpCost:function(){return this._hpCost},getDeadMusicId:function(){return this._deadMusicId},getSkillType:function(){return this._skillType},getAtlas:function(){return this._atlas},getUpAnimationClip:function(){return this._animationClipUp},getDownAnimationClip:function(){return this._animationClipDown},getRightAnimationClip:function(){return this._animationClipRight},getIdlePrefabe:function(){return this._enemyData.prefab_idle},getSkillPrefabe:function(){return this._enemyData.prefab_skill}});e.exports=n,cc._RF.pop()},{}],EnterBtnConfigTable:[function(t,e,i){"use strict";cc._RF.push(e,"82ff5PYywxGUbovsFAM69B5","EnterBtnConfigTable");var n=s(t("LimitGiftManager")),a=s(t("../../../Auction/Manager/AuctionManager")),r=t("../../../QQMoxie/Enum/QQMoxieEnum"),o=s(t("../../../QQMoxie/Manager/QQMoxieManager"));function s(t){return t&&t.__esModule?t:{default:t}}var l=t("BaseTable"),c=t("UFSdkManager"),u=cc.Class({extends:l,name:"EnterBtnConfigTable",properties:{_tblName:"enter_btn_config",_entranceData:null,_entranceNameList:null},init:function(){this._entranceData={},this._entranceNameList={};for(var t=0,e=this._jsonData.length;t<e;t++){var i=this._jsonData[t],n=i.posType;n<=0||(i.panelName=i.panelName||td.PanelEnum.Panel_PVE_FIGHT_HOOK,i.offsetPos=i.offsetPos||[0,0],this._entranceData[n]=this._entranceData[n]||[],this._entranceData[n].push(i),this._entranceNameList[i.enterBtnName]=i)}for(var a in this._entranceData){this._entranceData[a].sort(function(t,e){return t.rank-e.rank})}},getAllEnterCfgData:function(){return this._entranceData},getBtnConfigByPosType:function(t){return this._entranceData[t]?this._entranceData[t]:null},getBtnConfigByBtnName:function(t){return this._entranceNameList[t]?this._entranceNameList[t]:null},checkCanBtnShow:function(t){if(!this._entranceNameList[t])return!1;if(!td.Account.getUserData())return!1;var e=td.Account.getUserData().level,i=this._entranceNameList[t],s=i.panelName;if(e<(i.showLevel||0))return!1;var l=0,u=s;Array.isArray(s)&&(l=s[1],u=s[0]);var d=!0;if(!(u===td.PanelEnum.Panel_Activity&&l.length>0)){if(u!==td.PanelEnum.Window_ShopHome&&u!==td.PanelEnum.Window_ExtensionLoginGift&&td.IsCheckServer())return!1;if(u===td.PanelEnum.Window_MultipleFirstRecharge){var h=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MultipleFirstRecharge);if(d=window.isPayOpen&&!!h&&!h.isAllGet(),!window.isPayOpen)return!1}else if(u===td.PanelEnum.Window_MoneyPenny){if(!window.isPayOpen)return!1;var p=td.GetConfig("SAVE_MAX_DIAMOND"),_=(m=td.Account.getUserData()).getTotalSaveDiamond(),g=m.getCurrentSaveDiamond();_>=p&&g<=0&&(d=!1)}else if(u===td.PanelEnum.Window_SuperGift||u===td.PanelEnum.Window_PreferentialGift){if(!window.isPayOpen)return!1;var f=td.ActivityEnum.ActivityType.ACTIVITY_TYPE_16;u===td.PanelEnum.Window_PreferentialGift&&(f=td.ActivityEnum.ActivityType.PreferentialGift),d=!!(h=td.ActivityDataManager.getActivityControllerByType(f))&&h.isInOpenStatus()}else if(u===td.PanelEnum.Panel_AccumulatedRecharge){if(!window.isPayOpen)return!1;d=!!(h=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.AccumulatedRecharge))&&h.isInOpenStatus()}else if(u===td.PanelEnum.Window_DailyPreferential){if(!window.isPayOpen)return!1;if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.DAILYDISCOUNT))d=!!(h=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.DailyPreferential))&&(h.isInOpenStatus()&&h.getRewardStatus()!=td.RewardStatus.RECEIVED);else d=!1}else if(u===td.PanelEnum.Panel_RushRank){d=!!(h=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_11))&&h.isInOpenStatus()}else if(u===td.PanelEnum.Window_LoginDayGift){d=!!(h=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_4))&&(h.isInOpenStatus()&&!h.isAllReceived())}else if(u===td.PanelEnum.Window_ExtensionLoginGift){d=!!(h=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ExtensionLoginGift))&&!h.isAllReceived()}else if(u===td.PanelEnum.Panel_RedPacket)d=!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.RED_ENVELOPE);else if(u===td.PanelEnum.Panel_LimitGift){if(!window.isPayOpen)return!1;d=n.default.getInstance().getLimitGiftList().length>0}else if(u===td.PanelEnum.Panel_NewServerCarnivalActivity){var v=l;d=!!(h=td.ActivityDataManager.getActivityControllerByType(v))&&h.isInOpenStatus()}else if(u===td.PanelEnum.Panel_AwyGift){if(d=DX_CHANNEL==SdkType.AWY){var m=td.Account.getUserData();if(2==l){var y=c.getInstance()._userManager.isVerify(),E=!m.getVerifyRewardState();d=!y||E}else if(3==l){d=!m.getFocusRewardState()}}}else if(u===td.PanelEnum.Panel_TowerMaster){d=!!(h=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.TowerMaster))&&h.isInOpenStatus()}else if(u===td.PanelEnum.Window_SuperVIP){if(!window.isPayOpen)return!1;var T=td.Account.getUserData().getQQ();d=td.Account.isSuperVIP()&&0===T}else if(u===td.PanelEnum.CustonGiftPanel||u===td.PanelEnum.Panel_CustomGiftPanel2){if(!window.isPayOpen)return!1;f=td.ActivityEnum.ActivityType.ACTIVITY_TYPE_43;u===td.PanelEnum.Panel_CustomGiftPanel2&&(f=td.ActivityEnum.ActivityType.ACTIVITY_TYPE_44),d=!!(h=td.ActivityDataManager.getActivityControllerByType(f))&&h.isInOpenStatus()}else if(u===td.PanelEnum.Panel_HeroRepay||u===td.PanelEnum.Panel_GodPetsFeedback){if(!window.isPayOpen)return!1;var C=td.HeroRepayController;u===td.PanelEnum.Panel_GodPetsFeedback&&(C=td.HeroRepayController2),d=C.isShow()}else if(u===td.PanelEnum.Window_MonthCardRenewal){if(!window.isPayOpen)return!1;var R=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MonthCardRenewal);d=!!R&&(R.isInOpenStatus()&&R.getRewardStatus()!=td.ActivityEnum.RewardStatus.RECEIVED)}else if(u===td.PanelEnum.Panel_RichmanPlan){d=!!(h=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.RichmanPlan))&&h.isInOpenStatus()}else if(u===td.PanelEnum.Panel_BirdBridgeMeet){var S=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MagpieBridgeParty);if(S&&S.isInOpenStatus()){var I=S.getStageTimeWithType(td.QiXiStageEnum.MagpieBridgeParty);I||(d=!1);var A=td.TimeUtil.getTime();d=S.isInOpenStatus()&&A<I.endTime&&A>I.beginTime}else d=!1}else if(u===td.PanelEnum.Panel_MatchMakerBless){var b=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MagpieBridgeParty);d=!!b&&b.isInOpenStatus()}else if(u===td.PanelEnum.Panel_AuctionMain){var P=a.default.getInstance();P?i.posType==td.EnterBtnPosType.LeftTop?d=P.isShowMainEnter():i.posType==td.EnterBtnPosType.ShowMore&&(d=P.isShowMoreEnter()):d=!1}else if(u===td.PanelEnum.Panel_Double11Kill){var N=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.Double11_Kill);d=!!N&&N.isInOpenStatus()}else if(u===td.PanelEnum.Window_Double11Preview){var M=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.Double11_Preview);d=!!M&&M.isInOpenStatus()}else if(u===td.PanelEnum.Window_MoxieGetRewards){if(td.isMoXieQQ()){if(l==r.MOXIE_REWARD_TYPE.SUBSCRIBE||l==r.MOXIE_REWARD_TYPE.FAVORITES||l==r.MOXIE_REWARD_TYPE.COLOR_SIGN)d=!o.default.getInstance().isRewardReceived(l)}else d=!1}else u===td.PanelEnum.Window_MoxieVedioAds?td.isMoXieQQ()||(d=!1):u===td.PanelEnum.Window_MoxieRedPacket&&(td.isMoXieQQ()||(d=!1));return d}var L=l[0];if(td.IsCheckServer()||!window.isPayOpen)return!1;var D=l[1];if(!D){var B=td.ActivityDataManager.getSortedActivityShows(L);if(!(B&&B.length>0))return;D=B[0].getActivityType()}var w=td.ActivityDataManager.getActivityControllerByType(D);if(L===td.ActivityEnum.Activity.ActivityFixed&&D===td.ActivityEnum.ActivityType.LevelGift){if(!w||w.isAllRecevied())return!1}else if(L===td.ActivityEnum.Activity.ActivityFestival){if(!window.isPayOpen)return!1;d=!!w&&w.isInOpenStatus()}else(d=!!w&&w.isInOpenStatus())&&w&&w.isInSpecialOpenStatus&&(d=w.isInSpecialOpenStatus());return d}});e.exports=u,cc._RF.pop()},{"../../../Auction/Manager/AuctionManager":"AuctionManager","../../../QQMoxie/Enum/QQMoxieEnum":"QQMoxieEnum","../../../QQMoxie/Manager/QQMoxieManager":"QQMoxieManager",BaseTable:"BaseTable",LimitGiftManager:"LimitGiftManager",UFSdkManager:void 0}],EntryTable:[function(t,e,i){"use strict";cc._RF.push(e,"00d12hCejNDZZPEVjXiv82c","EntryTable");var n=t("BaseTable");cc.Class({extends:n,name:"EntryTable",properties:{_tblName:"entry_table",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.type]||(t[a.type]=[]),t[a.type][t[a.type].length]=a}},getEntryConfigByType:function(t){return this._data[t]?this._data[t]:null},getEntryTypeByPanelId:function(t){var e=this._data;for(var i in e)for(var n=e[i=parseInt(i)],a=0,r=n.length;a<r;a++){var o=n[a];if(o&&o.panelId&&o.panelId[0]===t)return i}}});cc._RF.pop()},{BaseTable:"BaseTable"}],EquipModel:[function(t,e,i){"use strict";cc._RF.push(e,"97c4f0/XlFP1bc4RIUtFPBB","EquipModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("../Manager/EquiptManager"),s=cc._decorator,l=s.ccclass,c=(s.property,t("PropertyModel")),u=t("../../Treasure/Model/SpecialAttributeEnum"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._starLevel=0,e._lastEvolveAttr=[],e}return n(e,t),e.prototype.init=function(e){t.prototype.init.call(this,"Equip",r.UserPropertyEnum.Equipment,e.equipId,e.name,null,null,e.animationType),this._goodsType=r.GoodsType.Type_Equip,this._isEquipped=!1,this._battleArrayOrderId=0,this.setReinforceLevel(1),this.setForgeLevel(0),this.setEvolveLevel(0),this.setStarLevel(0),this._quality=e.quality,this._icon=e.iconRes,this._pic=e.iconRes,this._desc=e.desc,this._type=e.type,this._groupId=e.groupId||0,this._obtainWay=e.obtainWay,this._baseEffect=e.baseEffect,this._baseAttrType=e.baseEffect[0][0],this._fragmentId=e.fragmentId,this._fragmentCount=e.fragmentCount,this._isStar=e.isStar,this._starUpName=e.starUpName,this._starUpIconRes=e.starUpIconRes,this._starUpQuality=e.starUpQuality,this._effectRes=e.effectRes,this._forgeExp=0,this._evolveExp=0,this._reinforceCfg=null,this._forgeCfg=null,this._evolveCfg=null,this._starCfg=null},e.prototype.setData=function(t){(t.forgeExp||0==t.forgeExp)&&(this._forgeExp=t.forgeExp);var e=!1,i={};if(t.evolveExp||0==t.evolveExp){if(t.evolveLevel&&t.evolveLevel>this._evolveLevel||t.evolveExp>this._evolveExp){var n=0;t.evolveLevel&&t.evolveLevel>this._evolveLevel?(this._lastEvolveAttr=this.getEvolveAttr(),n+=t.evolveExp,n+=this._evolveCfgCfg.exp-this._evolveExp):n+=t.evolveExp-this._evolveExp,i.attr=this.getEvolveAttr(),i.timse=n/o.default.getInstance().getEvolveSingleExp(),i.exp=n,e=!0}this._evolveExp=t.evolveExp}(t.reinforceLevel||0==t.reinforceLevel)&&this.setReinforceLevel(t.reinforceLevel),(t.forgeLevel||0==t.forgeLevel)&&this.setForgeLevel(t.forgeLevel),(t.evolveLevel||0==t.evolveLevel)&&this.setEvolveLevel(t.evolveLevel),(t.starLevel||0==t.starLevel)&&this.setStarLevel(t.starLevel),t.equipmentId&&this.setSId(t.equipmentId),e&&r.EventUtil.dispatchEvent(r.EventNameEnum.RES_EQUIPMENT_EVOLVE,i)},e.prototype.setReinforceLevel=function(t){this._reinforceLevel=t,this._reinforceCfg=r.GetTableClass(r.TableEnum.EquipmentReinforceTable).getDataByTypeAndQuality(this._type,this._quality)},e.prototype.setForgeLevel=function(t){this._forgeLevel=t,this._forgeCfg=r.GetTableClass(r.TableEnum.EquipmentForgeTable).getDataByTypeAndQualityAndLevel(this._type,this._quality,t)},e.prototype.setEvolveLevel=function(t){var e=t>this._evolveLevel;this._evolveLevel=t,this._evolveCfgCfg=r.GetTableClass(r.TableEnum.EquipmentEvolveTable).getDataByIdAndLevel(this._id,this.isEvolveMaxLv()?t:t+1),e&&r.EventUtil.dispatchEvent(r.EventNameEnum.EQUIPMENT_EVOLVE_UP)},e.prototype.setStarLevel=function(t){this._starLevel=t,this._starCfg=r.GetTableClass(r.TableEnum.EquipmentStarTable).getDataByIdAndLevel(this._id,t)},e.prototype.getReinforceLevel=function(){return this._reinforceLevel},e.prototype.getLevel=function(){return this._reinforceLevel},e.prototype.getReinforceAttr=function(){if(this._reinforceCfg){var t=this._reinforceCfg.attributes?this._reinforceCfg.attributes[0][1]:0,e=this._baseEffect[0][1]+(this._reinforceLevel-1)*t;return[[this._baseAttrType,e]]}return[[this._baseAttrType,0]]},e.prototype.getNextReinforceAttr=function(){if(this._reinforceCfg){var t=this._reinforceCfg.attributes?this._reinforceCfg.attributes[0][1]:0,e=this._baseEffect[0][1]+this._reinforceLevel*t;return[[this._baseAttrType,e]]}return[[this._baseAttrType,0]]},e.prototype.getReinforceCost=function(){return this._reinforceCfg&&this._reinforceCfg.goldExpr?this._reinforceCfg.goldExpr:null},e.prototype.getEvolveLevel=function(){return this._evolveLevel},e.prototype.getEvolveRank=function(){var t=Math.ceil(this._evolveLevel/5);return t||1},e.prototype.getEvolveGrade=function(){return this._evolveLevel-5*this.getEvolveRank()+5},e.prototype.getLastEvolveRank=function(){var t=Math.ceil((this._evolveLevel-1)/5);return t||1},e.prototype.getLastEvolveGrade=function(){return this._evolveLevel-5*this.getLastEvolveRank()+4},e.prototype.getEvolveIconRes=function(){var t,e=[],i=this.getEvolveRank(),n=this.getEvolveGrade();1===i?t="GY_xingxing":2===i?t="GY_yueliang":3===i&&(t="GY_taiyang");for(var a=0;a<5;a++)n>a?e.push(t):e.push(t+"02");return e},e.prototype.getLastEvolveIconRes=function(){var t,e=[],i=this.getLastEvolveRank(),n=this.getLastEvolveGrade();1===i?t="GY_xingxing":2===i?t="GY_yueliang":3===i&&(t="GY_taiyang");for(var a=0;a<5;a++)n>a?e.push(t):e.push(t+"02");return e},e.prototype.getEvolvePart=function(){return this._evolveCfgCfg&&this._evolveExp?Math.floor(this._evolveExp/(this._evolveCfgCfg.exp/8)):0},e.prototype.getEvolveTimes=function(){if(this._evolveCfgCfg&&this._evolveExp){var t=this._evolveExp%(this._evolveCfgCfg.exp/8);return Math.floor(t/o.default.getInstance().getEvolveSingleExp())}return 0},e.prototype.getEvolveTotalTimes=function(){var t=o.default.getInstance().getEvolveSingleExp();return Math.floor(this._evolveExp/t)},e.prototype.getEvolvePartExp=function(){return this._evolveCfgCfg?this._evolveCfgCfg.exp/8:0},e.prototype.getEvolveAttr=function(){if(!this._evolveCfgCfg)return[[this._baseAttrType,0]];if(this.isEvolveMaxLv()){var t=this.getTotalEvolveLvAttr();return[[this._baseAttrType,t]]}var e=this.getEvolvePart(),i=this.getEvolveTotalTimes(),n=this._evolveCfgCfg.singleAttributes[0][1],a=this._evolveCfgCfg.partAttributes[0][1],r=this.getTotalEvolveLvAttr();return[[this._baseAttrType,n*i+a*e+r]]},e.prototype.getTotalEvolveLvAttr=function(){var t=r.GetTableClass(r.TableEnum.EquipmentEvolveTable).getDataByIdAndLevel(this._id,this._evolveLevel);return t?t.attributes[0][1]:0},e.prototype.getNextEvolveAttr=function(){return this._evolveCfgCfg?this._evolveCfgCfg.attributes:[[this._baseAttrType,0]]},e.prototype.getLastEvolveAttr=function(){return this._lastEvolveAttr},e.prototype.getLastExtraEvolveAttr=function(){var t=r.GetTableClass(r.TableEnum.EquipmentEvolveTable).getDataByIdAndLevel(this._id,this._evolveLevel);if(!t)return[[this._baseAttrType,0]];var e=Math.floor(t.exp/o.default.getInstance().getEvolveSingleExp()),i=0;this._evolveLevel>1&&(i=r.GetTableClass(r.TableEnum.EquipmentEvolveTable).getDataByIdAndLevel(this._id,this._evolveLevel-1).attributes[0][1]);var n=t.attributes[0][1]-e*t.singleAttributes[0][1]-8*t.partAttributes[0][1]-i;return[[t.attributes[0],n]]},e.prototype.getExtraEvolveAttr=function(){if(!this._evolveCfgCfg||this.isEvolveMaxLv())return[[this._baseAttrType,0]];var t=Math.floor(this._evolveCfgCfg.exp/o.default.getInstance().getEvolveSingleExp()),e=0;this._evolveLevel>0&&(e=r.GetTableClass(r.TableEnum.EquipmentEvolveTable).getDataByIdAndLevel(this._id,this._evolveLevel).attributes[0][1]);var i=this._evolveCfgCfg.attributes[0][1]-t*this._evolveCfgCfg.singleAttributes[0][1]-8*this._evolveCfgCfg.partAttributes[0][1]-e;return[[this._evolveCfgCfg.attributes[0],i]]},e.prototype.getEvolveCost=function(){return this._evolveCfgCfg&&this._evolveCfgCfg.cost?this._evolveCfgCfg.cost:[]},e.prototype.isEvolveMaxLv=function(){return this._evolveLevel>=this.getEvolveMaxLv()},e.prototype.getEvolveMaxLv=function(){return r.GetTableClass(r.TableEnum.EquipmentEvolveTable).getMaxLvById(this._id)},e.prototype.getForgeLevel=function(){return this._forgeLevel},e.prototype.getForgeExp=function(){return this._forgeExp},e.prototype.setForgeExp=function(t){this._forgeExp=t},e.prototype.getForgeAttr=function(){return this._forgeCfg&&this._forgeCfg.attributes?this._forgeCfg.attributes:[[this._baseAttrType,0]]},e.prototype.getForgeSpecialEffectAttr=function(){var t=[];return r.GetTableClass(r.TableEnum.EquipmentForgeTable).getSpecialIdsByLv(this._type,this._quality,this._forgeLevel).forEach(function(e){var i=r.GetTableClass(r.TableEnum.SpecialEffectTable).getDataById(e);if(i&&i.type==u.SpecialEffectType.ATTRIBUTE){var n=r.GetTableClass(r.TableEnum.SpecialAttributeTable).getDataById(e);t.push(n)}}),t},e.prototype.getNextForgeAttr=function(){var t=r.GetTableClass(r.TableEnum.EquipmentForgeTable).getDataByTypeAndQualityAndLevel(this._type,this._quality,this.isForgeMaxLv()?this._forgeLevel:this._forgeLevel+1);return t?t.attributes:[[this._baseAttrType,0]]},e.prototype.getForgeAttrByLv=function(t){var e=r.GetTableClass(r.TableEnum.EquipmentForgeTable).getDataByTypeAndQualityAndLevel(this._type,this._quality,t);return e?e.attributes:[[this._baseAttrType,0]]},e.prototype.getForgeCost=function(){var t=r.GetTableClass(r.TableEnum.EquipmentForgeTable).getDataByTypeAndQualityAndLevel(this._type,this._quality,this.isForgeMaxLv()?this._forgeLevel:this._forgeLevel+1);return t?t.exp:0},e.prototype.getForgeCostBylv=function(t){var e=r.GetTableClass(r.TableEnum.EquipmentForgeTable).getDataByTypeAndQualityAndLevel(this._type,this._quality,t);return e?e.exp:0},e.prototype.getForgeMaxLv=function(){return r.GetTableClass(r.TableEnum.EquipmentForgeTable).getMaxLvByTypeAndQuality(this._type,this._quality)},e.prototype.isForgeMaxLv=function(){return this._forgeLevel>=r.GetTableClass(r.TableEnum.EquipmentForgeTable).getMaxLvByTypeAndQuality(this._type,this._quality)},e.prototype.getForgeSpecialIds=function(){return r.GetTableClass(r.TableEnum.EquipmentForgeEffectTable).getEffectsByEquipId(this._id)},e.prototype.getStarSpecialIds=function(){return r.GetTableClass(r.TableEnum.EquipmentStarTable).getSpecialIdsByLv(this._id,this._starLevel)},e.prototype.getAllStarSpecialIds=function(){return r.GetTableClass(r.TableEnum.EquipmentStarTable).getSpecialIds(this._id)},e.prototype.getStarLevel=function(){return this._starLevel},e.prototype.getStar=function(){return Math.floor(this._starLevel/r.GetConfig("EQUIP_STAR_UP_UNIT"))},e.prototype.getStarAttr=function(){if(!this._starCfg)return[[this._baseAttrType,0]];var t=this._starCfg.attributes[0][1];return[[this._baseAttrType,t]]},e.prototype.getStarAttrTT=function(){var t={};this._starCfg&&this._starCfg.attributeTTPercent.forEach(function(e){t[e[0]]=e[1]});return t},e.prototype.getStarSpecialEffectAttr=function(){var t=[];return r.GetTableClass(r.TableEnum.EquipmentStarTable).getSpecialIdsByLv(this._id,this._starLevel).forEach(function(e){var i=r.GetTableClass(r.TableEnum.SpecialEffectTable).getDataById(e);if(i&&i.type==u.SpecialEffectType.ATTRIBUTE){var n=r.GetTableClass(r.TableEnum.SpecialAttributeTable).getDataById(e);t.push(n)}}),t},e.prototype.getNextStarAttr=function(){var t=r.GetTableClass(r.TableEnum.EquipmentStarTable).getDataByIdAndLevel(this._id,this.isStarMaxLv()?this._starLevel:this._starLevel+1),e=0;return t.attributes.length>0&&(e+=t.attributes[0][1]),t.attributeTTPercent.length>0&&(e+=Math.ceil(t.attributeTTPercent[0][1]*this.getReinforceAttr()[0][1]/1e4)),[[this._baseAttrType,e]]},e.prototype.getStarCost=function(){return r.GetTableClass(r.TableEnum.EquipmentStarTable).getDataByIdAndLevel(this._id,this.isStarMaxLv()?this._starLevel:this._starLevel+1).cost},e.prototype.getStarMaxLv=function(){return r.GetTableClass(r.TableEnum.EquipmentStarTable).getMaxLvById(this._id)},e.prototype.isStarMaxLv=function(){return this._starLevel>=this.getStarMaxLv()},e.prototype.getSpecialIds=function(){return r.GetTableClass(r.TableEnum.EquipmentStarTable).getSpecialIds(this._id)},e.prototype.getTotalAttrTT=function(){var t={},e=this.getStarAttrTT(),i={},n={},a=this.getStarSpecialEffectAttr();for(var r in a.forEach(function(t){t.type==u.AttributeTargetType.SELF&&(t.attributeTTPercent&&t.attributeTTPercent.forEach(function(t){n[t[0]]?n[t[0]]+=t[1]:n[t[0]]=t[1]}))}),e)t[r]?t[r]+=e[r]:t[r]=e[r];for(var r in i)t[r]?t[r]+=i[r]:t[r]=i[r];for(var r in n)t[r]?t[r]+=n[r]:t[r]=n[r];return t},e.prototype.getTotalAttrAbsolute=function(){var t=this.getStarAttr(),e=this.getForgeAttr(),i=this.getEvolveAttr(),n=this.getReinforceAttr(),a={};this.getStarSpecialEffectAttr().forEach(function(t){t.type==u.AttributeTargetType.SELF&&(t.attributes&&t.attributes.forEach(function(t){a[t[0]]?a[t[0]]+=t[1]:a[t[0]]=t[1]}))});var r={};for(var o in a)r[o]?r[o]+=a[o]:r[o]=a[o];return e.forEach(function(t){r[t[0]]?r[t[0]]+=t[1]:r[t[0]]=t[1]}),t.forEach(function(t){r[t[0]]?r[t[0]]+=t[1]:r[t[0]]=t[1]}),i.forEach(function(t){r[t[0]]?r[t[0]]+=t[1]:r[t[0]]=t[1]}),n.forEach(function(t){r[t[0]]?r[t[0]]+=t[1]:r[t[0]]=t[1]}),r},e.prototype.getTotalAttr=function(){var t=this.getTotalAttrAbsolute(),e=this.getTotalAttrTT();return r.GlobalFunction.getAttrMultipyAttrTT(t,e),t},e.prototype.getType=function(){return this._type},e.prototype.getGroupId=function(){return this._groupId},e.prototype.getAllThisGroup=function(){var t=r.GetTableClass(r.TableEnum.EquipmentGroupTable).getDataById(this._groupId);return t&&t.equipmentIds?t.equipmentIds:[]},e.prototype.isGroupCanActive=function(t,e){if(0===this._groupId)return!1;for(var i=this.getAllThisGroup(),n=o.default.getInstance().getEquiptByQuality(this.getQuality(),!0,!1),a=i.length-1;a>=0;a--){if(t)for(var r in t){if((u=o.default.getInstance().getEquiptById(t[r])).getId()===i[a]&&u.getId()!==this.getId())return!0}if(n)for(var s=n.length-1;s>=0;s--){var l=n[s];if(l.getId()===i[a]&&l.getId()!==this.getId()){var c=l.getType();if(!t[c])return!0;var u=o.default.getInstance().getEquiptById(t[c]);if(l.getQuality()>u.getQuality())return!0;if(l.getQuality()==u.getQuality()&&(l.isPartnerCanActive(e)||!u.isPartnerCanActive(e)))return!0}}}return!1},e.prototype.isPartnerCanActive=function(t){for(var e=0;e<t.length;e++){var i=r.PartnershipManager.getPartnershipById(t[e]);if(i.getTargetType()==this.getGoodsType()&&-1!=i.getTargetIds().indexOf(this.getId()))return!0}return!1},e.prototype.getGroupOrderId=function(){var t=r.GetTableClass(r.TableEnum.EquipmentGroupTable).getDataById(this._groupId);return t?t.orderId:0},e.prototype.getBttleArrayOrderId=function(){return this._battleArrayOrderId},e.prototype.getQuality=function(){return this._quality},e.prototype.getIsStar=function(){return this._isStar},e.prototype.getShowQuality=function(){return this._isStar&&this.isStarMaxLv()?this._starUpQuality:this._quality},e.prototype.getIcon=function(){return this._isStar&&this.isStarMaxLv()?this._starUpIconRes:this._icon},e.prototype.getName=function(){return this._isStar&&this.isStarMaxLv()?this._starUpName:this._name},e.prototype.getPic=function(){return this._isStar&&this.isStarMaxLv()?this._starUpIconRes:this._pic},e.prototype.getDesc=function(){return this._desc},e.prototype.getDes=function(){return this._desc},e.prototype.getEffectRes=function(){return this._effectRes},e.prototype.getObtainWay=function(){return this._obtainWay},e.prototype.getBaseEffect=function(){return this._baseEffect},e.prototype.getGoodsType=function(){return this._goodsType},e.prototype.getFragmentId=function(){return this._fragmentId},e.prototype.getFragmentCount=function(){return this._fragmentCount},e.prototype.setEquipped=function(t){this._isEquipped=t},e.prototype.isEquipped=function(){return this._isEquipped},e.prototype.setBattleArrayEntityOrderId=function(t){this._battleArrayOrderId=t},e.prototype.setCount=function(t){this._count=t},e.prototype.getCount=function(){return this._count},e=a([l],e)}(c);e.exports=d,cc._RF.pop()},{"../../Treasure/Model/SpecialAttributeEnum":"SpecialAttributeEnum","../Manager/EquiptManager":"EquiptManager",PropertyModel:"PropertyModel"}],EquipmentEvolveTable:[function(t,e,i){"use strict";cc._RF.push(e,"20d84geLy1OR6qYn31pcELZ","EquipmentEvolveTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EquipmentEvolveConfig",e._tblName="equipment_evolve_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.id;t[r]||(t[r]={}),t[r][a.evolveLevel]=a}},e.prototype.getDataByIdAndLevel=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].evolveLevel===e)return i[n]}}return null},e.prototype.getMaxLvById=function(t){return this._data[t]?this._data[t].myLen():0},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EquipmentForgeEffectTable:[function(t,e,i){"use strict";cc._RF.push(e,"a21eaBsqipNKK4MKNShUa8S","EquipmentForgeEffectTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EquipmentForgeEffectConfig",e._tblName="equipment_forge_effect_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getDatas=function(){return this._data},e.prototype.getEffectsByEquipId=function(t){var e=[];for(var i in this._data){var n=this._data[i];-1!=n.equipmentIds.indexOf(t)&&e.push(n)}return e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EquipmentForgeTable:[function(t,e,i){"use strict";cc._RF.push(e,"d231fymIKFIVb/SMoxqVx9E","EquipmentForgeTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EquipmentForgeConfig",e._tblName="equipment_forge_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.type,o=a.quality;t[r]||(t[r]={}),t[r][o]||(t[r][o]={}),t[r][o][a.level]=a}},e.prototype.getDataByTypeAndQualityAndLevel=function(t,e,i){if(this._data[t]&&this._data[t][e]){var n=this._data[t][e];for(var a in n){if(n[a].level===i)return n[a]}}return null},e.prototype.getMaxLvByTypeAndQuality=function(t,e){return this._data[t]&&this._data[t][e]?this._data[t][e].myLen():0},e.prototype.getSpecialIds=function(t,e){var i=[];if(this._data[t]&&this._data[t][e]){var n=this._data[t][e];for(var a in n){var r=n[a];if(r.specialEffectId>0){var o={level:a,id:r.specialEffectId};i.push(o)}}}return i},e.prototype.getSpecialIdsByLv=function(t,e,i){var n=[];if(this._data[t]&&this._data[t][e]){var a=this._data[t][e];for(var r in a){var o=a[r];o.specialEffectId>0&&i>=o.level&&n.push(o.specialEffectId)}}return n},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EquipmentGroupConfig:[function(t,e,i){"use strict";cc._RF.push(e,"49d987+BFFIl5Q0ay4+HK4n","EquipmentGroupConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"EquipmentGroupConfig",properties:{_tblName:"equipment_group_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},getGroupData:function(t){return this._data[t]?this._data[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EquipmentGroupTable:[function(t,e,i){"use strict";cc._RF.push(e,"72602xxfi5DG4tlupThMNCj","EquipmentGroupTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EquipmentGroupConfig",e._tblName="equipment_group_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EquipmentReinforceTable:[function(t,e,i){"use strict";cc._RF.push(e,"d7408qBrB1Fyqs+D60nlGX6","EquipmentReinforceTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EquipmentReinforceConfig",e._tblName="equipment_reinforce_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.type;t[r]||(t[r]={}),t[r][a.quality]=a}},e.prototype.getDataByTypeAndQuality=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].quality===e)return i[e]}}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EquipmentStarTable:[function(t,e,i){"use strict";cc._RF.push(e,"4557bHJhetEa5lH9gQFBUbI","EquipmentStarTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tblName="equipment_star_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.id;t[r]||(t[r]={}),t[r][a.starLevel]=a}},e.prototype.getDataByIdAndLevel=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].starLevel===e)return i[n]}}return null},e.prototype.getMaxLvById=function(t){return this._data[t]?this._data[t].myLen():0},e.prototype.getSpecialIds=function(t){var e=[];if(this._data[t]){var i=this._data[t];for(var n in i){var a=i[n];if(a.specialEffectId>0){var r={level:n,id:a.specialEffectId};e.push(r)}}}return e},e.prototype.getSpecialIdsByLv=function(t,e){var i=[];if(this._data[t]){var n=this._data[t];for(var a in n){var r=n[a];r.specialEffectId>0&&r.starLevel<=e&&i.push(r.specialEffectId)}}return i},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EquipmentTable:[function(t,e,i){"use strict";cc._RF.push(e,"78af07tc7VP3orWnZA2PlxI","EquipmentTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EquipmentConfig",e._tblName="equipment_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.equipId]=a}},e.prototype.getDataById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getDatas=function(){return this._data},e.prototype.getEquipByFragmentId=function(t){for(var e in this._data){var i=this._data[e];if(i.fragmentId==t)return i}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EquiptManager:[function(t,e,i){"use strict";cc._RF.push(e,"261bfdmZAlPKquCvCb0V2WC","EquiptManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,window.td),s=t("../../Common/ResonancesEnum"),l=function(){function e(){this._equiptReplacePanelType=2,this._selectEquip=null,this._bagSelectType=1,this._evolve_critical_weight=[]}var i;return i=e,e.getInstance=function(){return null==this._instance&&(this._instance=new i),this._instance},e.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},e.prototype.destroyData=function(){this._equipMap={}},e.prototype.addListener=function(){var t=o.MsgModuleName.EQUIPMENT,e=o.MsgCmd.EQUIPMENT;o.ServerDelegate.registerMessage(t,e.GET_EQUIPMENT,this.parseEquipList.bind(this)),o.ServerDelegate.registerMessage(t,e.EQUIPMENT_REINFORCE,this.parseReinforce.bind(this)),o.ServerDelegate.registerMessage(t,e.EQUIPMENT_FORGE,this.parseForge.bind(this)),o.ServerDelegate.registerMessage(t,e.EQUIPMENT_EVOLVE,this.parseEvolve.bind(this)),o.ServerDelegate.registerMessage(t,e.EQUIPMENT_STAR_UP,this.parseStarUp.bind(this)),o.ServerDelegate.registerMessage(t,e.EQUIPMENT_SYNTHESIZE,this.parseSynthesize.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_EQUIPMENT_LIST,this.parseEquipList.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_DELETE_EQUIPMENT_LIST,this.deleteEquipList.bind(this))},e.prototype.parseReinforce=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_EQUIPMENT_REINFORCE)},e.prototype.parseForge=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_EQUIPMENT_FORGE)},e.prototype.parseEvolve=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_EQUIPMENT_EVOLVE_UP)},e.prototype.parseStarUp=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_EQUIPMENT_STAR_UP)},e.prototype.parseSynthesize=function(t,e){if(t===o.NetCode.SUCCESS){if(e&&e.rewardResult){var i=o.RewardManager.parseRewardResult(e.rewardResult);o.GlobalFunction.showRewards(i)}o.EventUtil.dispatchEvent(o.EventNameEnum.RES_EQUIPMENT_SYNTHESIZE)}},e.prototype.deleteEquipList=function(t,e){var i=this;t===o.NetCode.SUCCESS&&e&&e.equipmentIds&&e.equipmentIds.forEach(function(t){delete i._equipMap[t]})},e.prototype.parseEquipList=function(e,i){if(e===o.NetCode.SUCCESS){for(var n=i.equipmentList,a=0;a<n.length;a++){var r=n[a],s=r.equipmentId;if(this._equipMap[s])this._equipMap[s].setData(r);else{var l=o.GetTableClass(o.TableEnum.EquipmentTable).getDataById(r.configId);if(l){var c=new(t("EquipModel"));c.init(l),c.setData(r),this._equipMap[s]=c}else console.error("\u672a\u627e\u5230"+r.configId+"\u7684\u914d\u7f6e")}}o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GET_EQUIPMENT)}},e.prototype.addEventListener=function(){var t=o.EventUtil,e=o.EventNameEnum,i={};i[e.REQ_GET_EQUIPMENT]=this.requestGetEquipment,i[e.REQUEST_EQUIP_LIST]=this.requestGetEquipment,i[e.REQ_EQUIPMENT_REINFORCE]=this.requestReinforce,i[e.REQ_EQUIPMENT_FORGE]=this.requestForge,i[e.REQ_EQUIPMENT_EVOLVE]=this.requestEvolve,i[e.REQ_EQUIPMENT_STAR_UP]=this.requestStarUp,i[e.REQ_EQUIPMENT_SYNTHESIZE]=this.requestSynthesize,t.registerEvents(i,this)},e.prototype.requestGetEquipment=function(){var t={};t.module=o.MsgModuleName.EQUIPMENT,t.cmd=o.MsgCmd.EQUIPMENT.GET_EQUIPMENT,o.ServerDelegate.sendMessage(t)},e.prototype.requestStarUp=function(t){var e={};e.module=o.MsgModuleName.EQUIPMENT,e.cmd=o.MsgCmd.EQUIPMENT.EQUIPMENT_STAR_UP,e.equipmentId=t.equipmentId,o.ServerDelegate.sendMessage(e)},e.prototype.requestForge=function(t){var e={};e.module=o.MsgModuleName.EQUIPMENT,e.cmd=o.MsgCmd.EQUIPMENT.EQUIPMENT_FORGE;var i=t.forges,n={};for(var a in i)for(var r in n[a]||(n[a]={}),i[a])i[a][r]>0&&(n[a][r]||(n[a][r]=0),n[a][r]=n[a][r]+=i[a][r]);e.forges=n,o.ServerDelegate.sendMessage(e)},e.prototype.requestEvolve=function(t){var e={};e.module=o.MsgModuleName.EQUIPMENT,e.cmd=o.MsgCmd.EQUIPMENT.EQUIPMENT_EVOLVE,e.equipmentId=t.equipmentId,e.costId=t.costId,e.times=t.times,o.ServerDelegate.sendMessage(e)},e.prototype.requestSynthesize=function(t){var e={};e.module=o.MsgModuleName.EQUIPMENT,e.cmd=o.MsgCmd.EQUIPMENT.EQUIPMENT_SYNTHESIZE,e.configId=t.configId,e.count=t.count,o.ServerDelegate.sendMessage(e)},e.prototype.requestReinforce=function(t){var e={};e.module=o.MsgModuleName.EQUIPMENT,e.cmd=o.MsgCmd.EQUIPMENT.EQUIPMENT_REINFORCE,e.times=t.times,o.ServerDelegate.sendMessage(e)},e.prototype.getEquiptById=function(t){return this._equipMap[t]?this._equipMap[t]:null},e.prototype.getEquiptByQuality=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!0);var n=[];for(var a in this._equipMap){var r=this._equipMap[a];r.getQuality()===t&&(e&&r.isEquipped()||i&&(r.getReinforceLevel()>1||r.getForgeLevel()>0||r.getEvolveLevel()>0||r.getStarLevel()>0)||n.push(r))}return n},e.prototype.getEquipByBattleArrayOrderId=function(t){var e=[];for(var i in this._equipMap){var n=this._equipMap[i];n.isEquipped()&&n.getBttleArrayOrderId()==t&&e.push(n)}return e.length>0&&e.sort(this.sortByType),e},e.prototype.getLevelResLvByIdAndResType=function(t,e,i){void 0===i&&(i=!1);var n=this.getLevelByIdAndResType(t,e,i);return n.sort(this.sortFunc),n[0]},e.prototype.getLevelByIdAndResType=function(t,e,i){void 0===i&&(i=!1);for(var n=this.getEquipByBattleArrayOrderId(t),a=[],r=1;r<5;r++){var o=!1;t:for(var l=0;l<n.length;l++)if(n[l].getType()==r){switch(e){case s.ResonancesViewType.EQUIPMENT_LEVEL:a[r]=n[l].getReinforceLevel();break;case s.ResonancesViewType.EQUIPMENT_FORGE:a[r]=n[l].getForgeLevel();break;case s.ResonancesViewType.EQUIPMENT_EVOLVE:a[r]=n[l].getEvolveLevel();break;case s.ResonancesViewType.EQUIPMENT_STAR:a[r]=n[l].getStarLevel()}o=!0;break t}i||o||(a[r]=0)}return a},e.prototype.getAllEquipt=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=0);var n=[];for(var a in this._equipMap){var r=this._equipMap[a];t&&r.isEquipped()||e&&(r.getReinforceLevel()>1||r.getForgeLevel()>0||r.getEvolveLevel()>0||r.getStarLevel()>0)||i&&r.isEquipped()&&i==r.getBttleArrayOrderId()||(n[n.length]=r)}return n.sort(this.sortBySelect),n},e.prototype.getEquiptForRebirth=function(){var t=[];for(var e in this._equipMap){var i=this._equipMap[e];i.isEquipped()||(t[t.length]=i)}return t},e.prototype.getEquipNumById=function(t){for(var e=0,i=this.getAllEquipt(!1,!1),n=0;n<i.length;n++)i[n].getId()==t&&e++;return e},e.prototype.getEquiptByType=function(t,e,i,n){void 0===i&&(i=!1),void 0===n&&(n=0);var a=[];for(var r in this._equipMap){var o=this._equipMap[r];t&&t!=o.getType()||(e&&o.isEquipped()||i&&(o.getreinforceLevel()>1||o.getforgeLevel()>0||o.getevolveLevel()>0||o.getstarLevel()>0)||n&&o.isEquipped()&&n==o.getBttleArrayOrderId()||(a[a.length]=o))}return a.sort(this.sortBySelect),a},e.prototype.getEquipsByFragment=function(){var t=o.ItemManager.getItemsDatasByGoodsSubType(o.GoodsSubType.EQUIPMENT_FRAMENT),e=[],i=[];for(var n in t){var a=t[n].getId();o.ItemManager.getItemNumById(a)>=this.getEquipsByFragmentId(a).getFragmentCount()?e.push(t[n]):i.push(t[n])}return e.sort(this.sortByQuality),i.sort(this.sortByQuality),e.concat(i)},e.prototype.getEquipsByFragmentId=function(e){var i=o.GetTableClass(o.TableEnum.EquipmentTable).getEquipByFragmentId(e);if(i){var n=new(t("EquipModel"));return n.init(i),n}return null},e.prototype.sortFunc=function(t,e){return t-e},e.prototype.sortByType=function(t,e){return t.getType()!=e.getType()?t.getType()-e.getType():t.getId()-e.getId()},e.prototype.sortByQuality=function(t,e){return t.getQuality()!=e.getQuality()?e.getQuality()-t.getQuality():t.getId()-e.getId()},e.prototype.sortBySelect=function(t,e){return t.isEquipped()&&!e.isEquipped()?-1:!t.isEquipped()&&e.isEquipped()?1:t.getBttleArrayOrderId()!=e.getBttleArrayOrderId()?t.getBttleArrayOrderId()-e.getBttleArrayOrderId():t.getQuality()!=e.getQuality()?e.getQuality()-t.getQuality():t.getLevel()!=e.getLevel()?e.getLevel()-t.getLevel():t.getForgeLevel()!=e.getForgeLevel()?e.getForgeLevel()-t.getForgeLevel():t.getId()-e.getId()},e.prototype.getEquiptReplacePanelType=function(){return this._equiptReplacePanelType},e.prototype.setEquiptReplacePanelType=function(t){this._equiptReplacePanelType=t},e.prototype.getSelectEquip=function(){return this._selectEquip},e.prototype.setSelectEquip=function(t){this._selectEquip=t},e.prototype.clearSelectEquip=function(){this._selectEquip=null},e.prototype.getSelectedIndex=function(){return this._selected_index},e.prototype.setSelectedIndex=function(t){this._selected_index=t},e.prototype.getEvolveQualityLimit=function(){return this._evolve_quality_limit||(this._evolve_quality_limit=o.GetConfig("EQUIPMENT_EVOLVE_QUALITY_LIMIT")),this._evolve_quality_limit},e.prototype.getReinforceLimit=function(){return this._reinforce_limit||(this._reinforce_limit=o.GetConfig("EQUIPMENT_REINFORCE_ACTOR_LEVEL_MULTIPLES")),this._reinforce_limit},e.prototype.getEvolveSingleExp=function(){return this._evolve_single_exp||(this._evolve_single_exp=o.GetConfig("EQUIPMENT_EVOLVE_SINGLE_EXP")),this._evolve_single_exp},e.prototype.getEvolvePartCount=function(){return this._evolve_part_count||(this._evolve_part_count=o.GetConfig("EQUIPMENT_EVOLVE_PART_COUNT")),this._evolve_part_count},e.prototype.getEvolveCriticalWeight=function(){return this._evolve_critical_weight.length||(this._evolve_critical_weight=o.GetConfig("EQUIPMENT_EVOLVE_CRITICAL_WEIGHT")),this._evolve_critical_weight},e.prototype.getEvolveStarLimit=function(){return this._evolve_star_limit||(this._evolve_star_limit=o.GetConfig("EQUIPMENT_STAR_UP_EVOLVE_LIMIT")),this._evolve_star_limit},e.prototype.getBagSelectType=function(){return this._bagSelectType},e.prototype.setBagSelectType=function(t){this._bagSelectType=t},e.prototype.getResonancesLv=function(){return this._resonances_lv},e.prototype.setResonancesLv=function(t){this._resonances_lv=t},e.prototype.canLevelUp=function(t,e){void 0===e&&(e=1);for(var i=this.getEquiptById(t),n=o.Account.getUserData().getLevel()*this.getReinforceLimit(),a=i.getReinforceLevel(),r=o.Account.getUserData().getGold(),s=i.getReinforceCost(),l=1;l<=e;l++){if(a+l>n)return!1;var c=o.GlobalFunction.calculateExpression(s,[a+l-1]);if(r<c)return!1;r-=c}return!0},e.prototype.canForge=function(t){if(!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.EQUIPMENT_FORGE))return!1;var e=this.getEquiptById(t);if(e.isForgeMaxLv())return!1;var i=this.getOneKeyForge(e);if(i.myLen()<=0)return!1;var n=e.getForgeCost()-e.getForgeExp(),a=0;for(var r in i){a+=o.ItemManager.getItemDataBykey(r).getEffectValue()*i[r]}return!(a<n)},e.prototype.canEvolve=function(t,e){if(void 0===e&&(e=1),!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.EQUIPMENT_EVOLVE))return!1;var i=this.getEquiptById(t);if(i.getQuality()<this.getEvolveQualityLimit())return!1;if(i.isEvolveMaxLv())return!1;for(var n,a,r,s=i.getEvolveCost(),l=o.Account.getUserData().getGold(),c=o.ItemManager.getItemNumById(a),u=o.Account.getUserData().getDiamond(),d=!1,h=!1,p=!1,_=0;_<s.length;_++)t:for(var g=0;g<e;g++)switch(s[_][0]){case 1:if(!d&&(d=!0),(l-=s[_][1][2])<0)break t;break;case 2:if(!h&&(h=!0),r=s[_][1][2],(c-=n)<0)break t;break;case 3:if(!p&&(p=!0),n=s[_][1][2],a=s[_][1][1],(u-=r)<0)break t}return!!(d&&l>=0)||(!!(h&&c>=0)||!!(p&&u>=0))},e.prototype.canStarUp=function(t){if(!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.EQUIPMENT_STAR_UP,0,!1))return!1;var e=this.getEquiptById(t);if(e.getQuality()<this.getEvolveQualityLimit()||e.getEvolveLevel()<this.getEvolveStarLimit()||!e.getIsStar())return!1;if(e.isStarMaxLv())return!1;var i=e.getStarCost();return!(i[0][2]>o.ItemManager.getItemNumById(i[0][1]))},e.prototype.canUp=function(t){return!!this.canLevelUp(t)||(!!this.canForge(t)||(!!this.canEvolve(t)||!!this.canStarUp(t)))},e.prototype.canChange=function(t){for(var e=this.getEquiptById(t),i=e.getType(),n=e.getQuality(),a=e.getReinforceLevel(),r=e.getForgeLevel(),o=this.getEquiptByType(i,!0),s=0;s<o.length;s++){if(o[s].getQuality()>n)return!0;if(o[s].getQuality()===n){if(o[s].getReinforceLevel()>a)return!0;if(o[s].getReinforceLevel()===a)return o[s].getForgeLevel()>r}}return!1},e.prototype.getForgeItems=function(){return o.ItemManager.getConfigItemByGoodsSubType(o.GoodsSubType.EQUIPMENT_FORGE).sort(this.sortFcn)},e.prototype.sortFcn=function(t,e){return t.quality!=e.quality?t.quality-e.quality:t.goodsId-e.goodsId},e.prototype.getOneKeyForge=function(t,e,i){var n;void 0===e&&(e=0),void 0===i&&(i={}),n=e||t.getForgeCost()-t.getForgeExp();var a={},r=0,s=this.getForgeItems();t:for(var l=0;l<s.length;l++){var c=s[l].goodsId,u=void 0;if(!((u=i&&i.myLen()>0?this.getItemNumOfListById(c,i):o.ItemManager.getItemNumById(c))<=0)){var d=o.ItemManager.seekItemDataById(c,!1),h=parseInt(s[l].goodsEffectExpr),p=Math.ceil((n-r)/h);if(u>=p){r+=p*h;for(var _=p,g=0;g<d.length;g++){var f=d[g].getSId(),v=void 0;if((v=i&&i.myLen()>0?i[f]:o.ItemManager.getItemDataBykey(f).getCount())>=_){a[f]=_;break}v>0&&(_-=v,a[f]=v)}if(l>0)for(var m=l;m>=0;m--){var y=s[m].goodsId,E=o.ItemManager.getItemNumById(y),T=parseInt(s[m].goodsEffectExpr);if(!(E<=0)){var C=o.ItemManager.seekItemDataById(y,!1);e:for(var R=C.length;R>0;R--){var S=C[R-1].getSId(),I=void 0;for(I=i&&i.myLen()>0?i[S]:o.ItemManager.getItemDataBykey(S).getCount();I>0;I--){if(!(r-T>n)){if(r-T===n)return a[S]=a[S]-1,a;break e}r-=T,a[S]=a[S]-1}}}}break t}var A=u;for(g=0;g<d.length;g++){f=d[g].getSId(),v=void 0;if((v=i&&i.myLen()>0?i[f]:o.ItemManager.getItemDataBykey(f).getCount())>=A){a[f]=A;break}v>0&&(A-=v,a[f]=v)}r+=u*h}}return a},e.prototype.getItemNumOfListById=function(t,e){var i=0;for(var n in e){if(e[n]>0)o.ItemManager.getItemDataBykey(n).getId()===t&&(i+=e[n])}return i},e.prototype.getForgeMaxLv=function(t){for(var e=0,i=0,n=t.getForgeLevel(),a=t.getForgeMaxLv(),r=this.getForgeItems(),s=0;s<r.length;s++){var l=r[s].goodsId,c=o.ItemManager.getItemNumById(l);if(!(c<=0))e+=parseInt(r[s].goodsEffectExpr)*c}var u=t.getForgeCost()-t.getForgeExp();if(u>e)return i;for(e-=u,i++;e>=t.getForgeCostBylv(n+i+1)&&n+i<a;)i++,e-=t.getForgeCostBylv(n+i);return i},e.prototype.openFragment=function(){!o.GlobalFunction.getLocalSaveStatus("EquipFragment")&&this.hasFragmentToCompose()&&(o.GlobalFunction.setLocalSaveStatus("EquipFragment",!0),o.EventUtil.dispatchEvent(o.EventNameEnum.OPEN_EQUIPMENT_FRAGMENT))},e.prototype.hasFragmentToCompose=function(){if(o.GlobalFunction.getLocalSaveStatus("EquipFragment"))return!1;var t=o.ItemManager.getItemsDatasByGoodsSubType(o.GoodsSubType.EQUIPMENT_FRAMENT);for(var e in t){var i=t[e].getId();if(o.ItemManager.getItemNumById(i)>=this.getEquipsByFragmentId(i).getFragmentCount())return!0}return!1},e.prototype.fragmentComposeEvent=function(){return[o.EventNameEnum.ITEM_CHANGE,o.EventNameEnum.OPEN_EQUIPMENT_FRAGMENT]},e.prototype.hasBetterToReplace=function(t,e,i){var n=this.getEquiptById(t);if(n){for(var a=n.getType(),r=this.getEquiptByType(a,!0,!1),o=0,s=r.length;o<s;o++){var l=r[o];if(this.isReplaceable(n,l,i,e))return!0}return!1}},e.prototype.isReplaceable=function(t,e,i,n){if(t.getQuality()<e.getQuality())return!0;if(t.getQuality()>e.getQuality())return!1;if(!t.isPartnerCanActive(i)&&e.isPartnerCanActive(i))return!0;if(t.isPartnerCanActive(i)&&!e.isPartnerCanActive(i))return!1;if(!t.isGroupCanActive(n,i)&&e.isGroupCanActive(n,i))return!0;if(t.isGroupCanActive(n,i)&&!e.isGroupCanActive(n,i))return!1;if(t.isGroupCanActive(n,i)&&e.isGroupCanActive(n,i)){if(!this.isGroupExistPartner(t,i,n)&&this.isGroupExistPartner(e,i,n))return!0;if(this.isGroupExistPartner(t,i,n)&&!this.isGroupExistPartner(e,i,n))return!1;if(t.getGroupOrderId()<e.getGroupOrderId())return!0;if(t.getGroupOrderId()>e.getGroupOrderId())return!1}return this.normalCompare(t,e)},e.prototype.normalCompare=function(t,e){return t.getStarLevel()<e.getStarLevel()||!(t.getStarLevel()>e.getStarLevel())&&(t.getEvolveLevel()<e.getEvolveLevel()||!(t.getEvolveLevel()>e.getEvolveLevel())&&(t.getForgeLevel()<e.getForgeLevel()||!(t.getForgeLevel()>e.getForgeLevel())&&(t.getReinforceLevel()<e.getReinforceLevel()||!(t.getReinforceLevel()>e.getReinforceLevel())&&t.getId()>e.getId())))},e.prototype.isGroupExistPartner=function(t,e,n){for(var a=this.getAllEquipt(!0),r=t.getAllThisGroup(),s=r.length-1;s>=0;s--)for(var l=r[s],c=e.length-1;c>=0;c--){var u=o.PartnershipManager.getPartnershipById(e[c]);if(u.getTargetType()==o.GoodsType.Type_Equip&&-1!=u.getTargetIds().indexOf(l)){if(n)for(var d in n){if(i.getInstance().getEquiptById(n[d]).getId()==l)return!0}if(a)for(var h=a.length-1;h>=0;h--){if(a[h].getId()==l)return!0}}}return!1},e.prototype.getActivitedForgeSpecialEffectIdsByEquipId=function(t){var e=[],i=this.getEquiptById(t);if(!i||!i.isEquipped())return e;var n=i.getForgeSpecialIds(),a=o.BattleArrayManager.getBattleEquipByIndex(i.getBttleArrayOrderId());return n.forEach(function(t){var i=0,n=t.equipmentIds;for(var r in a)-1!=n.indexOf(a[r].getId())&&a[r].getForgeLevel()>=t.level&&i++;i>=t.count&&e.push(t.id)}),e},e=i=n([r],e)}();i.default=l,cc._RF.pop()},{"../../Common/ResonancesEnum":"ResonancesEnum",EquipModel:"EquipModel"}],EventTrigger:[function(t,e,i){"use strict";cc._RF.push(e,"18292X8975NzpgvtWLZSreV","EventTrigger"),Object.defineProperty(i,"__esModule",{value:!0}),i.EventTrigger=void 0;var n=function(){function t(){this.once=!1,this.handler=void 0}return t.prototype.release=function(){this.trigger.unlisten(this)},t}(),a=function(){function t(){this._eventHandlers=[],this._onceEventHandlers=[]}return t.prototype.listen=function(t){var e=new n;return e.handler=t,e.trigger=this,this._eventHandlers.push(e),e},t.prototype.listenOnce=function(t){var e=new n;return e.handler=t,e.once=!0,e.trigger=this,this._onceEventHandlers.push(e),e},t.prototype.unlisten=function(t){var e;t.once?-1!=(e=this._onceEventHandlers.indexOf(t))&&(this._onceEventHandlers[e]=void 0):-1!=(e=this._eventHandlers.indexOf(t))&&(this._eventHandlers[e]=void 0)},t.prototype.unAlllisten=function(){this._eventHandlers=[],this._onceEventHandlers=[]},t.prototype.purge=function(){for(var t=this._eventHandlers.length-1;t>=0;t--)this._eventHandlers[t]||this._eventHandlers.splice(t,1)},t.prototype.trigger=function(t){this.purge(),this._eventHandlers.forEach(function(e){e&&e.handler(t)}),this._onceEventHandlers.forEach(function(e){e&&e.handler(t)}),this._onceEventHandlers=[],this.purge()},t}();i.EventTrigger=a,cc._RF.pop()},{}],EvilGodBossModel:[function(t,e,i){"use strict";cc._RF.push(e,"d4a64ZHHglCjLc257hh7Vwe","EvilGodBossModel"),Object.defineProperty(i,"__esModule",{value:!0});window.td;var n=function(){function t(t){this._showBattleRewards=[],this._isKilled=!1,this._gateId=t.sectionId,this._id=t.id,this._nextId=t.nextId,this._monsterId=t.monsterId;var e=t.battleRewards;this._setShowBattleRewards(e)}return t.prototype._setShowBattleRewards=function(t){this._showBattleRewards=[];for(var e=0,i=t.length;e<i;e++)for(var n=t[e][0],a=0,r=n.length;a<r;a++){var o=n[a];this._checkShowRewards(o)}},t.prototype._checkShowRewards=function(t){for(var e=!1,i=0,n=this._showBattleRewards.length;i<n;i++){var a=this._showBattleRewards[i];if(a[0]==t[0]&&a[1]==t[1]){e=!0;break}}e||this._showBattleRewards.push(t)},t.prototype.setKillStatus=function(t){this._isKilled=t},t.prototype.getKillStatus=function(){return this._isKilled},t.prototype.getId=function(){return this._id},t.prototype.getNextId=function(){return this._nextId},t.prototype.getMonsterId=function(){return this._monsterId},t.prototype.getGateId=function(){return this._gateId},t.prototype.getBattleShowRewards=function(){return this._showBattleRewards},t}();i.default=n,cc._RF.pop()},{}],EvilGodBossTable:[function(t,e,i){"use strict";cc._RF.push(e,"87d463kB29O+LYkrC9FJfnl","EvilGodBossTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EvilGodBossTable",e._tblName="evil_god_boss_config",e._data={},e._maxBossId=0,e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=0,e=this._jsonData.length;t<e;++t){var i=this._jsonData[t],n=i.sectionId,a=i.id;this._data[n]=this._data[n]||[],this._data[n].push(i),this._maxBossId=Math.max(a,this._maxBossId)}},e.prototype.getMaxBossId=function(){return this._maxBossId},e.prototype.getBossDataByGateId=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EvilGodChapterModel:[function(t,e,i){"use strict";cc._RF.push(e,"77cb3MvyedGh435FnttJLyT","EvilGodChapterModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t){this._chapterBgIndex=1,this._gateRoadId=1,this._isPass=!1,this._chapterId=t.chapterId,this._nextChapterId=t.nextId,this._chapterIconRes=t.chapterIconRes,this._chapterBgIndex=t.chapterBgIndex,this._gateRoadId=t.gateRoadId}return t.prototype.getChapterId=function(){return this._chapterId},t.prototype.getNextChapterId=function(){return this._nextChapterId},t.prototype.setPassStatus=function(t){void 0===t&&(t=!1),this._isPass=t},t.prototype.getPassStatus=function(){return this._isPass},t.prototype.getChapterIconRes=function(){return this._chapterIconRes},t.prototype.getChapterBgIndex=function(){return this._chapterBgIndex},t.prototype.getGateRoadId=function(){return this._gateRoadId},t}();i.default=n,cc._RF.pop()},{}],EvilGodChapterTable:[function(t,e,i){"use strict";cc._RF.push(e,"2cc4607w+lKZojiEKjO5NU3","EvilGodChapterTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EvilGodChapterTable",e._tblName="evil_god_chapter_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=0,e=this._jsonData.length;t<e;++t){var i=this._jsonData[t],n=i.chapterId;this._data[n]=i}},e.prototype.getAllChapters=function(){return this._data},e.prototype.getChapterDataById=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EvilGodEnum:[function(t,e,i){"use strict";cc._RF.push(e,"d53ccXKfsVOd4Q4UGOxC94a","EvilGodEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.EvilGodType=void 0,function(t){t[t.ChapterRank=1]="ChapterRank",t[t.GateRank=2]="GateRank",t[t.DailyRank=3]="DailyRank"}(i.EvilGodType||(i.EvilGodType={})),cc._RF.pop()},{}],EvilGodGateModel:[function(t,e,i){"use strict";cc._RF.push(e,"c794e8MmJRI/LMmLAUHd75u","EvilGodGateModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t){this._isPass=!1,this._gateId=t.sectionId,this._chapterId=t.chapterId,this._nextGateId=t.nextId,this._gateNameRes=t.gateNameRes}return t.prototype.getGateId=function(){return this._gateId},t.prototype.getNextGateId=function(){return this._nextGateId},t.prototype.setPassStatus=function(t){void 0===t&&(t=!1),this._isPass=t},t.prototype.getPassStatus=function(){return this._isPass},t.prototype.getChapterId=function(){return this._chapterId},t.prototype.getGateNameRes=function(){return this._gateNameRes},t}();i.default=n,cc._RF.pop()},{}],EvilGodGateTable:[function(t,e,i){"use strict";cc._RF.push(e,"d1628W2WhxC/78CcghOZLdI","EvilGodGateTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EvilGodGateTable",e._tblName="evil_god_section_config",e._data={},e._maxGateId=0,e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=0,e=this._jsonData.length;t<e;++t){var i=this._jsonData[t],n=i.chapterId,a=i.sectionId;this._data[n]=this._data[n]||[],this._data[n].push(i),this._maxGateId=Math.max(a,this._maxGateId)}},e.prototype.getMaxGateId=function(){return this._maxGateId},e.prototype.getGatesDataById=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],EvilGodManager:[function(t,e,i){"use strict";cc._RF.push(e,"992aejimEZAyoGKG/R+5MmQ","EvilGodManager");var n=this&&this.__awaiter||function(t,e,i,n){function a(t){return t instanceof i?t:new i(function(e){e(t)})}return new(i||(i=Promise))(function(i,r){function o(t){try{l(n.next(t))}catch(t){r(t)}}function s(t){try{l(n.throw(t))}catch(t){r(t)}}function l(t){t.done?i(t.value):a(t.value).then(o,s)}l((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var i,n,a,r,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(t){return function(e){return l([t,e])}}function l(r){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(a=2&r[0]?n.return:r[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,r[1])).done)return a;switch(n=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,n=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){o=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){o.label=r[1];break}if(6===r[0]&&o.label<a[1]){o.label=a[1],a=r;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(r);break}a[2]&&o.ops.pop(),o.trys.pop();continue}r=e.call(t,o)}catch(t){r=[6,t],n=0}finally{i=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});t("CommonEnum");var r=t("../Model/EvilGodChapterModel"),o=t("../Model/EvilGodGateModel"),s=t("../Model/EvilGodBossModel"),l=t("../Model/EvilGodRankModel"),c=t("../EvilGodEnum"),u=function(){function t(){this._chapterList=[],this._gatesMap={},this._copyBossMap={},this._curChapterId=0,this._curGateId=0,this._curBossId=0,this._curBossLeftHp=0,this._fightTimes=0,this._receivedIdList=[],this._canSelectEffect=[],this._selectedEffectMap={},this._evilGodRankMap={},this._myCurRankMap={},this._curOpChapterId=0,this._curOpGateId=0,this._isMoreTimesBattle=!1,this._isRequestBattle=!1,this._isNeedShowGateRank=!1,this._isInResultWindow=!1}return t.getInstance=function(){var e=this;return null==this._instance&&function(){n(this,void 0,void 0,function(){return a(this,function(i){switch(i.label){case 0:return[4,void(null==e._instance&&(e._instance=new t))];case 1:return i.sent(),[2]}})})}(),this._instance},t.prototype.init=function(){this._addServerListeners(),this._addClientListeners()},t.prototype.destroyData=function(){},t.prototype._addServerListeners=function(){var t=td.ServerDelegate,e=td.MsgModuleName.EvilGod,i=td.MsgCmd.EvilGod;t.registerMessage(e,i.EVIL_GOD_INFO,this._receiveEvilGodInfo.bind(this)),t.registerMessage(e,i.EVIL_GOD_ACTOR,this._receiveEvilGodPlayerInfo.bind(this)),t.registerMessage(e,i.EVIL_GOD_BATTLE,this._receiveEvilGodBattleInfo.bind(this)),t.registerMessage(e,i.EVIL_GOD_CHOOSE,this._responseSelectEffect.bind(this)),t.registerMessage(e,i.EVIL_GOD_REWARD,this._EvilGodRewardResultResponse.bind(this)),t.registerMessage(e,i.EVIL_GOD_RANK,this._recevieEvilGodRankResponse.bind(this)),t.registerMessage(e,i.PUSH_EVIL_GOD_INFO,this._pushEvilGodInfo.bind(this)),t.registerMessage(e,i.PUSH_EVIL_GOD_ACTOR,this._pushEvilGodPlayerInfo.bind(this))},t.prototype._addClientListeners=function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.QUERY_EVIL_GOD_INFO]=this._queryEvilGodInfo,i[e.QUERY_EVIL_GOD_PLAYER_INFO]=this._queryEvilGodPlayerInfo,i[e.REQUEST_EVIL_GOD_BATTLE]=this._requestEvilGodBattle,i[e.REQUEST_SELECT_EVIL_GOD_EFFECT]=this._requestSelectSkillEffect,i[e.REQUEST_GET_EVIL_GOD_REWARD]=this._requestGetEvilGodReward,i[e.QUERY_EVIL_GOD_RANK]=this._queryEvilGodRank,i[e.CHECK_MORE_TIMES_BATTLE]=this._checkMoreTimesBattle,i[e.ON_TIME_OVER_DAY]=this._checkEvilGodOpenStatus,i[e.USER_ATTR_LEVEL_CHANGE]=this._checkEvilGodOpenStatus,i[e.ON_LOGIN_SERVER_OPEN_DATA_RETURN]=this._checkEvilGodOpenStatus,i[e.SET_EVIL_GOD_AUTO_BATTLE_STATUS]=this.setMoreTimesBattleStatus,t.registerEvents(i,this)},t.prototype.setIsInResultWindow=function(t){this._isInResultWindow=t},t.prototype.isInResultWindow=function(){return this._isInResultWindow},t.prototype.setShowGateRankStatus=function(t){this._isNeedShowGateRank=t},t.prototype.getShowGateRankStatus=function(){return this._isNeedShowGateRank},t.prototype._checkEvilGodOpenStatus=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.EVIL_GOD,0)){this._queryEvilGodInfo(),this._queryEvilGodPlayerInfo();var t={rankType:c.EvilGodType.DailyRank,id:0};this._queryEvilGodRank(t)}},t.prototype.getMaxGateId=function(){return td.GetTableClass(td.TableEnum.EvilGodGateTable).getMaxGateId()},t.prototype._initCopyData=function(){this._chapterList=[],this._gatesMap={},this._copyBossMap={};var t=td.GetTableClass(td.TableEnum.EvilGodChapterTable).getAllChapters();for(var e in t)if(t.hasOwnProperty(e)){var i=t[e],n=new r.default(i),a=n.getChapterId();this._initGatesData(a),this._chapterList.push(n)}this._chapterList.sort(function(t,e){return t.getChapterId()-e.getChapterId()})},t.prototype._initGatesData=function(t){this._gatesMap[t]=[];for(var e=td.GetTableClass(td.TableEnum.EvilGodGateTable).getGatesDataById(t),i=0,n=e.length;i<n;i++){var a=e[i],r=new o.default(a),s=r.getGateId();this._initCopyBossData(s),this._gatesMap[t].push(r)}},t.prototype._initCopyBossData=function(t){this._copyBossMap[t]=[];for(var e=td.GetTableClass(td.TableEnum.EvilGodBossTable).getBossDataByGateId(t),i=0,n=e.length;i<n;i++){var a=e[i],r=new s.default(a);this._copyBossMap[t].push(r)}},t.prototype.pushFightResult=function(t){this._isRequestBattle=!1,this._isInResultWindow?td.EventUtil.dispatchEvent(td.EventNameEnum.ADD_EVIL_GOD_BATTLE_RESULT,t):td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_EvilGodBattleResults,t)},t.prototype._checkMoreTimesBattle=function(){this._isMoreTimesBattle&&(td.GetConfig("EVIL_GOD_BATTLE_TIMES_LIMIT")-this._fightTimes>0?this._requestEvilGodBattle():this._isMoreTimesBattle=!1)},t.prototype.isGetBattleTimesReward=function(){return this._isGetTimesReward},t.prototype.setMoreTimesBattleStatus=function(t){this._isMoreTimesBattle=t},t.prototype.isMoreTimesBattle=function(){return this._isMoreTimesBattle},t.prototype.isRequestBattle=function(){return this._isRequestBattle},t.prototype.setOpGateId=function(t){this._curOpGateId=t},t.prototype.getOpGateId=function(){return this._curOpGateId},t.prototype.setOpChapterId=function(t){this._curOpChapterId=t,this._curOpChapterId>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.SELECT_EVIL_GOD_CHAPTER,t)},t.prototype.getOpChapterId=function(){return this._curOpChapterId},t.prototype.getCurChapterId=function(){return this._curChapterId},t.prototype.getCurGateId=function(){return this._curGateId},t.prototype.getCurBossId=function(){return this._curBossId},t.prototype.getCanSelectEffects=function(){return this._canSelectEffect},t.prototype.getEffectIdByTimes=function(t){return this._selectedEffectMap[t]?this._selectedEffectMap[t]:null},t.prototype.getLeftBattleTimes=function(){var t=td.GetConfig("EVIL_GOD_BATTLE_TIMES_LIMIT")-this._fightTimes;return t>0?t:0},t.prototype.getFightTimes=function(){return this._fightTimes},t.prototype.getChapterDataById=function(t){if(!this._chapterList||0==this._chapterList.length)return null;for(var e=0,i=this._chapterList.length;e<i;e++){var n=this._chapterList[e];if(t===n.getChapterId())return n}return null},t.prototype.getChapterList=function(){return this._chapterList},t.prototype.getGatesByChapterId=function(t){var e=this._gatesMap[t];return e.sort(function(t,e){return t.getGateId()-e.getGateId()}),e},t.prototype.getCurOpGateData=function(){for(var t=this.getGatesByChapterId(this._curOpChapterId),e=0,i=t.length;e<i;e++){var n=t[e];if(n.getGateId()===this._curOpGateId)return n}return null},t.prototype.getBossListByGateId=function(t){var e=this._copyBossMap[t];return e.sort(function(t,e){return t.getId()-e.getId()}),e},t.prototype.getCurBattleBossData=function(){for(var t=this.getBossListByGateId(this._curGateId),e=0,i=t.length;e<i;e++){var n=t[e];if(n.getId()===this._curBossId)return n}return null},t.prototype.getLastBossData=function(t,e){for(var i=this.getBossListByGateId(t),n=0,a=i.length;n<a;n++){var r=i[n];if(r.getNextId()===e)return r}return null},t.prototype.getCurLeftBossHp=function(){return this._curBossLeftHp},t.prototype.checkRewardGotStatus=function(t){return-1!==this._receivedIdList.indexOf(t)},t.prototype.checkLocalOwnRank=function(t,e){if(0===e||e===this._curGateId||e===this._curChapterId)return!1;var i=this._evilGodRankMap[e];return!!i&&!!i[t]},t.prototype.getRankInfo=function(t,e){return this._evilGodRankMap[e]&&this._evilGodRankMap[e][t]?this._evilGodRankMap[e][t]:null},t.prototype.getMyCurRankData=function(t,e){return this._myCurRankMap[t]&&this._myCurRankMap[t][e]?this._myCurRankMap[t][e]:null},t.prototype._parseChapterData=function(){for(var t=0,e=this._chapterList.length;t<e;t++){var i=this._chapterList[t],n=i.getChapterId();i.setPassStatus(n<this._curChapterId)}},t.prototype._parseGateData=function(){for(var t in this._gatesMap)if(this._gatesMap.hasOwnProperty(t))for(var e=this._gatesMap[t],i=0,n=e.length;i<n;i++){var a=e[i],r=a.getGateId();a.setPassStatus(r<this._curGateId)}},t.prototype._parseBossData=function(){for(var t in this._copyBossMap)if(this._copyBossMap.hasOwnProperty(t))for(var e=this._copyBossMap[t],i=0,n=e.length;i<n;i++){var a=e[i],r=a.getId();a.setKillStatus(r<this._curBossId)}},t.prototype._parseEvilGodCopyInfo=function(t){var e=t.chapterId,i=t.sectionId,n=t.bossId,a=t.hp;0!==this._chapterList.length&&0!==this._gatesMap.myLen()&&0!==this._copyBossMap.myLen()||this._initCopyData();var r=this._curChapterId!==e,o=this._curGateId!==i,s=this._curBossId!==n,l=this._curBossLeftHp!==a;this._curChapterId=e,this._curGateId=i,this._curBossId=n,this._curBossLeftHp=a,this._parseChapterData(),this._parseGateData(),this._parseBossData(),r&&td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_EVIL_GOD_CHAPTER_INFO),o&&td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_EVIL_GOD_GATE_INFO),s?td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_EVIL_GOD_BOSS_INFO):l&&td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_EVIL_GOD_BOSS_HP)},t.prototype._parsePlayerEvilGodInfo=function(t){this._receivedIdList=t.receives,this._canSelectEffect=t.options,this._selectedEffectMap=t.effects,this._isGetTimesReward=t.battleTimesReward;var e=t.times;this._fightTimes!==e&&(this._fightTimes=e,td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_EVIL_GOD_FIGHT_TIMES)),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_EVIL_GOD_PLAYER_INFO)},t.prototype.checkGateListHaveGateId=function(t,e){if(!t||t<=0)return!1;for(var i=this.getGatesByChapterId(e),n=0,a=i.length;n<a;n++){if(i[n].getGateId()==t)return!0}},t.prototype._queryEvilGodInfo=function(){var t={};t.module=td.MsgModuleName.EvilGod,t.cmd=td.MsgCmd.EvilGod.EVIL_GOD_INFO,td.ServerDelegate.sendMessage(t)},t.prototype._receiveEvilGodInfo=function(t,e){t===td.NetCode.SUCCESS&&this._parseEvilGodCopyInfo(e)},t.prototype._queryEvilGodPlayerInfo=function(){var t={};t.module=td.MsgModuleName.EvilGod,t.cmd=td.MsgCmd.EvilGod.EVIL_GOD_ACTOR,td.ServerDelegate.sendMessage(t)},t.prototype._receiveEvilGodPlayerInfo=function(t,e){t===td.NetCode.SUCCESS&&this._parsePlayerEvilGodInfo(e)},t.prototype._requestEvilGodBattle=function(){var t={};t.module=td.MsgModuleName.EvilGod,t.cmd=td.MsgCmd.EvilGod.EVIL_GOD_BATTLE,t.chapterId=this._curChapterId,t.sectionId=this._curGateId,t.bossId=this._curBossId,td.ServerDelegate.sendMessage(t),this._isMoreTimesBattle&&(this._isRequestBattle=!0)},t.prototype._receiveEvilGodBattleInfo=function(t,e){td.NetCode.SUCCESS},t.prototype._requestSelectSkillEffect=function(t){var e={};e.module=td.MsgModuleName.EvilGod,e.cmd=td.MsgCmd.EvilGod.EVIL_GOD_CHOOSE,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._responseSelectEffect=function(t,e){if(t===td.NetCode.SUCCESS){td.EventUtil.dispatchEvent(td.EventNameEnum.SELECT_SKILL_REWARD_RETURN);var i=this.getLeftBattleTimes();if(this._isMoreTimesBattle&&i>0){if(this.getCurOpGateData().getPassStatus())return;this._requestEvilGodBattle()}}},t.prototype._requestGetEvilGodReward=function(t){var e={};e.module=td.MsgModuleName.EvilGod,e.cmd=td.MsgCmd.EvilGod.EVIL_GOD_REWARD,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._EvilGodRewardResultResponse=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_EVIL_GOD_REWARD_INFO)}},t.prototype._queryEvilGodRank=function(t){var e={};e.module=td.MsgModuleName.EvilGod,e.cmd=td.MsgCmd.EvilGod.EVIL_GOD_RANK,e.type=t.rankType,e.id=t.id,td.ServerDelegate.sendMessage(e)},t.prototype._recevieEvilGodRankResponse=function(t,e){if(t===td.NetCode.SUCCESS){var i=parseInt(e.type),n=parseInt(e.id),a=e.ranks;this._evilGodRankMap[n]||(this._evilGodRankMap[n]={});for(var r=[],o=0,s=a.length;o<s;o++){var u=a[o],d=new l.default;d.init(u,i),r.push(d)}(this._curOpChapterId===this._curChapterId&&i===c.EvilGodType.ChapterRank||this._curOpGateId===this._curGateId&&i===c.EvilGodType.GateRank||0===n)&&(this._myCurRankMap[i]={},r.length>0?this._myCurRankMap[i][n]=r.pop():this._myCurRankMap[i][n]=null),this._evilGodRankMap[n][i]=r,td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_EVIL_GOD_RANK_INFO)}},t.prototype._pushEvilGodInfo=function(t,e){t===td.NetCode.SUCCESS&&this._parseEvilGodCopyInfo(e)},t.prototype._pushEvilGodPlayerInfo=function(t,e){t===td.NetCode.SUCCESS&&this._parsePlayerEvilGodInfo(e)},t.prototype.checkShowSkillRewardSelectWindow=function(){var t=this.getFightTimes();return!!td.GetConfig("EVIL_GOD_SPECIAL_EFFECT").some(function(e){return e[0]===t})&&(!this.getEffectIdByTimes(t)&&(td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_SELECT_SKILL_REWARD_WINDOW,td.FightType.EVIL_GOD),!0))},t.prototype.isCanGetReward=function(){if(this.checkBattleTimeRewardTip())return!0;for(var t=0,e=this._chapterList.length;t<e;t++){var i=this._chapterList[t].getChapterId();if(!(i>this._curChapterId))if(this.checkChapterRewardStatus(i))return!0}return!1},t.prototype.checkCopyEntranceRedPointTip=function(){return!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.EVIL_GOD,0)&&(this.getLeftBattleTimes()>0||this.isCanGetReward())},t.prototype.checkChapterRewardStatus=function(t){if(t>this._curChapterId)return!1;if(t<this._curChapterId&&!this.checkRewardGotStatus(t))return!0;for(var e=!1,i=this.getGatesByChapterId(t),n=0,a=i.length;n<a;n++){var r=i[n].getGateId();if(this.checkGateRewardStatus(r)){e=!0;break}}return e},t.prototype.checkGateRewardStatus=function(t){for(var e=this.getBossListByGateId(t),i=0,n=e.length;i<n;i++){var a=e[i],r=a.getKillStatus(),o=a.getId(),s=this.checkRewardGotStatus(o);if(r&&!s)return!0}return!1},t.prototype.checkBattleTimeRewardTip=function(){var t=this.isGetBattleTimesReward(),e=this.getLeftBattleTimes();return!t&&e<=0},t.prototype.redPointEvents=function(){return[td.EventNameEnum.REFRESH_EVIL_GOD_INFO,td.EventNameEnum.REFRESH_EVIL_GOD_PLAYER_INFO,td.EventNameEnum.REFRESH_EVIL_GOD_REWARD_INFO]},t._instance=null,t}();i.default=u,cc._RF.pop()},{"../EvilGodEnum":"EvilGodEnum","../Model/EvilGodBossModel":"EvilGodBossModel","../Model/EvilGodChapterModel":"EvilGodChapterModel","../Model/EvilGodGateModel":"EvilGodGateModel","../Model/EvilGodRankModel":"EvilGodRankModel",CommonEnum:void 0}],EvilGodRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"e90aaD4ymtP3onfss/YmFCg","EvilGodRankModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("BaseUser"),r=t("../EvilGodEnum"),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._rankType=r.EvilGodType.ChapterRank,e._rank=0,e._damage=0,e}return n(e,t),e.prototype.init=function(e,i){e&&(t.prototype.init.call(this,"EvilGodRankModel",e.attributes),this._rankType=i,this._rank=e.rank,this._damage=e.damage)},e.prototype.getRank=function(){return this._rank},e.prototype.getDamage=function(){return this._damage},e.prototype.getRankRewards=function(){var t=td.GetTableClass(td.TableEnum.EvilGodRankRewardTable).getCfgData(this._rankType,this._rank);return t?t.reward:[]},e}(a);i.default=o,cc._RF.pop()},{"../EvilGodEnum":"EvilGodEnum",BaseUser:"BaseUser"}],EvilGodRankRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"e10aaZ/2DlBrISuNNPREgNn","EvilGodRankRewardTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="EvilGodRankRewardTable",e._tblName="evil_god_rank_reward_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=0,e=this._jsonData.length;t<e;++t){var i=this._jsonData[t],n=i.type,a=i.rank;if(t>0&&i.type===this._jsonData[t-1].type){var r=this._jsonData[t-1];i.fromRank=r.rank+1}else i.fromRank=a;this._data[n]=this._data[n]||[],this._data[n].push(i)}},e.prototype.getCfgData=function(t,e){if(!this._data[t])return null;for(var i=this._data[t],n=0,a=i.length;n<a;n++){var r=i[n],o=r.fromRank,s=r.rank;if(e>=o&&e<=s)return r}return null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ExtensionLoginGiftController:[function(t,e,i){"use strict";cc._RF.push(e,"7a912ugaDZKS7fcLEyROOrF","ExtensionLoginGiftController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../../../SDK/SDKCommonEnum"),r=(window,t("ActivityBaseController")),o=t("ExtensionLoginGiftModel"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataId=0,e._days=0,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this.clearData(),this.addListener(),this.addEventListener()},e.prototype.clearData=function(){this._dataId=0,this._dayList={}},e.prototype.addListener=function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.GET_LOGIN_GIFT_INFO,this._parseGiftInfo.bind(this)),i.registerMessage(t,e.LOGIN_GIFT_RECEIVE,this._onReceiveGift.bind(this)),i.registerMessage(t,e.PUSH_LOGIN_GIFT_INFO,this._parseGiftInfo.bind(this))},e.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.REQ_EXT_LOGIN_DAY_GIFT]=this._requestGiftInfo,e[t.REQ_RECEIVE_EXT_LOGIN_GIFT]=this._requestReceiveGift,td.EventUtil.registerEvents(e,this)},e.prototype.isAllReceived=function(){if(!this._dayList||0===this._dayList.myLen())return!1;var t=!0;for(var e in this._dayList){if(this._dayList[e].getRewardStatus()!==td.RewardStatus.RECEIVED){t=!1;break}}return t},e.prototype.hasRedPoint=function(){if(!this._dayList||0===this._dayList.myLen())return!1;for(var t in this._dayList)if(this.isDayRedPoint(t))return!0;return!1},e.prototype.isDayRedPoint=function(t){return!(!this._dayList||!this._dayList[t])&&this._dayList[t].getRewardStatus()===td.RewardStatus.CAN_RECEIVE},e.prototype.redPointEvts=function(){return[td.EventNameEnum.EXT_LOGIN_DAY_GIFT_UPDATED]},e.prototype.getDayList=function(){return this._dayList},e.prototype.getDayData=function(t){return this._dayList&&this._dayList[t]?this._dayList[t]:null},e.prototype.getCurLoginDays=function(){return this._days},e.prototype.getCanReceiveDay=function(){if(!this._dayList||0===this._dayList.myLen())return 0;var t=0;for(var e in this._dayList){if(this._dayList[e].getRewardStatus()===td.RewardStatus.CAN_RECEIVE){t=parseInt(e);break}}return t},e.prototype.isLastDay=function(){return!(!this._dayList||0===this._dayList.myLen()||!this._days)&&this._days===this._dayList.myLen()},e.prototype._requestGiftInfo=function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.GET_LOGIN_GIFT_INFO,td.ServerDelegate.sendMessage(t)},e.prototype._parseGiftInfo=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.days||0,n=this._days!==i;this._days=i,this._initDayList(n);var r=e.list,o=this._dayList,s=td.RewardStatus;for(var l in o){var c=parseInt(l),u=o[c];ArrayUtils.contains(r,c)?u.setRewardStatus(s.RECEIVED):c<=this._days?u.setRewardStatus(s.CAN_RECEIVE):u.setRewardStatus(s.CANNOT_RECEIVE)}if(td.EventUtil.dispatchEvent(td.EventNameEnum.EXT_LOGIN_DAY_GIFT_UPDATED,n),ArrayUtils.contains(r,2))td.LocalStorageUtil.readRealLocal(td.LocalRealKey.FIRST_7DAYS_LOGIN_2)||(td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_POINT_REPORT,a.CHECK_POINT_TYPE.FIRST_7DAYS_LOGIN_2),td.LocalStorageUtil.writeRealLocal(td.LocalRealKey.FIRST_7DAYS_LOGIN_2,!0))}},e.prototype._requestReceiveGift=function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.LOGIN_GIFT_RECEIVE,e.configId=t,td.ServerDelegate.sendMessage(e)},e.prototype._onReceiveGift=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n)}},e.prototype._initDayList=function(t){if(!(this._dayList&&this._dayList.myLen()>0)||t){var e=td.GetTableClass(td.TableEnum.LoginGiftConfig).getShowDay(this._days);this._dayList={};for(var i=td.GetTableClass(td.TableEnum.LoginGiftConfig).getExtLoginDayGiftConfigbyShowday(e),n=0,a=i.length;n<a;n++){var r=i[n],s=new o;s.init(r),this._dayList[s.getDay()]=s}}},e}(r);e.exports=s,cc._RF.pop()},{"../../../../SDK/SDKCommonEnum":void 0,ActivityBaseController:"ActivityBaseController",ExtensionLoginGiftModel:"ExtensionLoginGiftModel"}],ExtensionLoginGiftModel:[function(t,e,i){"use strict";cc._RF.push(e,"eeef5TM/ENF94y8LAxqKi2J","ExtensionLoginGiftModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=function(){function t(){this._day=0,this._nameStr="",this._titleStr="",this._desStr="",this._resId="",this._rewardStatus=0}return t.prototype.init=function(t){if(t){this._day=t.day,this._nameStr=t.name||"",this._titleStr=t.title||"",this._desStr=t.des||"",this._showday=t.showday;var e=t.resId;this._resId=e<10?"0"+e:e+"",this._rewards=n.RewardManager.parseRewardListDetail(t.reward),this._rewardStatus=n.RewardStatus.CANNOT_RECEIVE}},t.prototype.getDay=function(){return this._day},t.prototype.getNameStr=function(){return this._nameStr},t.prototype.getTitleStr=function(){return this._titleStr},t.prototype.getDes=function(){return this._desStr},t.prototype.getShowday=function(){return this._showday},t.prototype.getResId=function(){return this._resId},t.prototype.getRewards=function(){return this._rewards},t.prototype.setRewardStatus=function(t){this._rewardStatus=t},t.prototype.getRewardStatus=function(){return this._rewardStatus},t}();e.exports=a,cc._RF.pop()},{}],ExtensionLoginGiftWindow:[function(t,e,i){"use strict";cc._RF.push(e,"8289bO0EbdPN6cBrcLoqvCl","ExtensionLoginGiftWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Hero/Manager/HeroManager"),o=t("PanelBase"),s=t("CommonIconWidget"),l=t("HeroModel"),c=cc._decorator,u=c.ccclass,d=c.property,h=c.menu,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._curSelectDay=0,e._curDay=0,e}return n(e,t),e.prototype.init=function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_ExtensionLoginGift},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.dayItem.active=!1,this._activityType=td.ActivityEnum.ActivityType.ExtensionLoginGift},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListeners(),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE_AND_HIDE_TOWER)},e.prototype.onDisable=function(){this._curDay=0,this._curSelectDay=0,td.EventUtil.unregisterAllEvents(this),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME_AND_SHOW_TOWER),t.prototype.onDisable.call(this)},e.prototype._addEventListeners=function(){var t=td.EventUtil,e={};e[td.EventNameEnum.EXT_LOGIN_DAY_GIFT_UPDATED]=this._onDataUpdated,t.registerEvents(e,this)},e.prototype._onDataUpdated=function(t){var e=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(e)if(t)this.setData();else{var i=e.getDayData(this._curSelectDay);if(!i)return;this._setDayItem(i,this._curSelectItem),this._refreshContent()}},e.prototype.setData=function(t){var e=this;void 0===t&&(t=0);var i=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(i){this._curDay=i.getCurLoginDays();var n=i.getCanReceiveDay();this._refreshDayList();var a=t||n||this._curDay;td.GuideManager.isDoingLoginGiftGuide()&&(a=2),this._selectDay(a);var r=0;if(a>3)r=(a-3)*this.dayItem.width;r>0?this.scheduleOnce(function(){e.dayScrollView.scrollToOffset(cc.v2(r,0))},.05):this.dayScrollView.scrollToLeft()}},e.prototype._refreshContent=function(){var t=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(t){var e=t.getDayData(this._curSelectDay);if(e){var i=this._curSelectDay;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_23_dlhl,"HD_dlhl_wz_mz"+e.getResId(),this.imgRewardName),this.labTitle.string=e.getTitleStr(),this.labDes.string=e.getDes();var n=e.getRewards(),a=n[0],o=a.getGoodsType();if(o===td.GoodsType.Type_Mercenary||o===td.GoodsType.Type_Item&&a.getGoodsSubType()===td.GoodsSubType.HERO_FRAGMENT){if(o===td.GoodsType.Type_Item){var c=r.default.getInstance().getFragmentComposeInfo(a.getId());(a=new l).init(c)}this.figureNode.active=!0,this.imgReward.active=!1,this.gemstoneNode.active=!1,td.GlobalFunction.showMercenaryFigureAnimation(this.figureNode,a,!1,!1,800)}else o===td.GoodsType.Type_Gemstone?(this.figureNode.active=!1,this.imgReward.active=!1,this.gemstoneNode.active=!0,td.GlobalFunction.createBigGemstoneIcon(a,this.gemstoneNode)):(this.figureNode.active=!1,this.imgReward.active=!0,this.gemstoneNode.active=!1,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_23_dlhl,"HD_dlhl_tb_"+e.getResId()+"_d",this.imgReward));for(var u=0,d=n.length;u<d;u++){var h=n[u];(p=this.layerReward.getChildByName("icon_"+u))?p.getComponent(s).setData(h):((p=td.GlobalFunction.createCommonIconWidget(56,h)).name="icon_"+u,p.scale=.8,p.parent=this.layerReward)}for(;;u++){var p;if(!(p=this.layerReward.getChildByName("icon_"+u)))break;p.removeFromParent(!0)}var _=e.getRewardStatus();if(_===td.RewardStatus.CAN_RECEIVE)this.btnReceive.active=!0,this.labTips.active=!1,this.imgReceived.active=!1;else if(_===td.RewardStatus.RECEIVED)this.btnReceive.active=!1,this.labTips.active=!1,this.imgReceived.active=!0;else{this.btnReceive.active=!1,this.labTips.active=!0,this.imgReceived.active=!1;var g=i-this._curDay,f=td.Language.loginDayGiftTips1;1!==g&&(f=cc.js.formatStr(td.Language.loginDayGiftTips2,g)),this.labTips.getComponent(cc.Label).string=f}}}},e.prototype._refreshDayList=function(){var t=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(t){var e=t.getDayList();for(var i in e){var n=parseInt(i),a=this.dayContent.getChildByName("item_"+i);a||((a=cc.instantiate(this.dayItem)).name="item_"+i,a.parent=this.dayContent,a.y=0,a.active=!0,a.on("touchend",this.touchItem,this),td.RedPointUtil.createRedPointOld(a,cc.v2(-15,-50),t.isDayRedPoint.bind(t,n),t.redPointEvts())),this._setDayItem(e[i],a)}}},e.prototype._setDayItem=function(t,e){var i=t.getDay();e._tag=i;var n=e.getChildByName("layerTitleNormal"),a=e.getChildByName("layerTitleSelect"),r=n.getChildByName("labDay");r.getComponent(cc.Label).string=i,(r=a.getChildByName("labDay")).getComponent(cc.Label).string=i;var o=t.getRewardStatus();e.getChildByName("imgReceived").active=o===td.RewardStatus.RECEIVED,e.getChildByName("labName").getComponent(cc.Label).string=t.getNameStr();var s=t.getRewards()[0],l=e.getChildByName("imgIcon");if(s.getGoodsType()===td.GoodsType.Type_Gemstone){l.removeAllChildren(!0);var c=td.GlobalFunction.getItemIcon(28,s.getGoodsType(),s.getId(),s.getCount());c.name="icon",c.parent=l,c.x=2,c.y=-5}else td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_23_dlhl,"HD_dlhl_tb_"+t.getResId(),l)},e.prototype._selectDay=function(t){if(t!==this._curSelectDay){this.updateData(t);var e=this.dayContent.getChildByName("item_"+t);e&&(this._curSelectItem&&this._setItemSelectStatus(this._curSelectItem,!1),this._curSelectDay=t,this._curSelectItem=e,this._setItemSelectStatus(e,!0),this._refreshContent())}},e.prototype._setItemSelectStatus=function(t,e){t.width=e?160:145;var i=t.getChildByName("imgBg"),n=t.getChildByName("imgIcon"),a=n.getChildByName("icon");a&&(a.y=e?-2:-5);var r=t.getChildByName("layerTitleNormal"),o=t.getChildByName("layerTitleSelect");r.active=!e,o.active=e,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_23_dlhl,e?"HD_dlhl_bg02":"HD_dlhl_bg01",i),n.y=e?-30:-37},e.prototype.touchItem=function(t){var e=t.currentTarget;e&&e._tag&&this._selectDay(e._tag)},e.prototype.onBtnReceive=function(){td.GlobalFunction.checkCanClicked()&&td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_RECEIVE_EXT_LOGIN_GIFT,this._curSelectDay)},a([d(cc.Node)],e.prototype,"imgRewardName",void 0),a([d(cc.Label)],e.prototype,"labTitle",void 0),a([d(cc.Label)],e.prototype,"labDes",void 0),a([d(cc.Node)],e.prototype,"labTips",void 0),a([d(cc.Node)],e.prototype,"btnReceive",void 0),a([d(cc.Node)],e.prototype,"imgReceived",void 0),a([d(cc.Node)],e.prototype,"figureNode",void 0),a([d(cc.Node)],e.prototype,"imgReward",void 0),a([d(cc.Node)],e.prototype,"gemstoneNode",void 0),a([d(cc.Node)],e.prototype,"layerReward",void 0),a([d(cc.ScrollView)],e.prototype,"dayScrollView",void 0),a([d(cc.Node)],e.prototype,"dayContent",void 0),a([d(cc.Node)],e.prototype,"dayItem",void 0),e=a([u,h("module/Activity/ExtensionLoginGiftWindow")],e)}(o);i.default=p,cc._RF.pop()},{"../../../Hero/Manager/HeroManager":"HeroManager",CommonIconWidget:"CommonIconWidget",HeroModel:"HeroModel",PanelBase:void 0}],FamousGeneralShopController:[function(t,e,i){"use strict";cc._RF.push(e,"270f9yxUsNFQZYeSXYHTVGD","FamousGeneralShopController");var n=t("ActivityBaseController"),a=t("FamousGeneralShopModel"),r=cc.Class({extends:n,properties:{_modelList:null},initData:function(t){this._super(t),this._modelList=[]},destroyData:function(){this._modelList=[]},getDataList:function(){return this._modelList},activityParse:function(t){var e=t.record,i=e.level,n=e.vipLevel,r=e.day,o=e.buyMap,s=this.getActivityData();this._modelList=[];var l=td.GetTableClass(td.TableEnum.FamousGeneralShopTable).getDataByDataIdAndDay(s,r);if(l)for(var c in l){var u=l[c];if(u.minLevel<i&&i<=u.maxLevel&&td.Account.getUserData().vip>=n){var d=new a;d.initData(l[c],this._activityType),o[c]&&d.setExchangeTimes(o[c]),this._modelList.push(d)}}},receiveReward:function(t){if(this.isInOpenStatus()){var e={};e.activityId=this.getActivityId(),e.id=t,this.operateActivity(e)}}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",FamousGeneralShopModel:"FamousGeneralShopModel"}],FamousGeneralShopListView:[function(t,e,i){"use strict";cc._RF.push(e,"e0bad6iu49FXK+TpY/nF4ex","FamousGeneralShopListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{_callBack:null,_activityType:null},setData:function(t){var e=t.dataList;this._callBack=t.callBack,this._activityType=t.activityType,this._super(e)},setItemView:function(t,e){if(e&&t){var i=t.getChildByName("labOddTimes"),n=t.getChildByName("labOwn"),a=t.getChildByName("labNeed"),r=t.getChildByName("labLine"),o=e.getExchangeTimes(),s=e.getTotalTimes(),l=e.getConsume(),c=e.getReward();i.getComponent(cc.Label).string=td.Language.leftTimes+(s-o)+"/"+s;var u=this._activityType===td.ActivityEnum.ActivityType.MagicShop;n.active=!u,a.active=!u,r.active=!u;var d=t.getChildByName("consume");d&&d.removeFromParent();var h=l[0],p=td.GlobalFunction.createCommonIconWidget(u?26:2,h);p.scale=.7,p.name="consume",p.setPosition(cc.v2(-270,10)),t.addChild(p);var _=h.getId(),g=h.getCount(),f=td.ItemManager.getItemNumById(_);n.getComponent(cc.Label).string=f,a.getComponent(cc.Label).string=g;var v,m,y=f<g?cc.color(255,0,0):cc.color(0,255,0);for(n.color=y,v=0,m=c.length;v<m;v++){var E=t.getChildByName("reward"+v);E&&E.removeFromParent()}var T=gdk.rm.getResByUrl("UI/Meishuzi",cc.SpriteAtlas),C=e.getActivityType(),R=null;C===td.ActivityEnum.ActivityType.FamousGeneralShop?R="MSZ_hdmj_mingjiang":C===td.ActivityEnum.ActivityType.GoldEquipShop&&(R="MSZ_hdmj_shenzhuang");var S=null;for(R&&(S=T.getSpriteFrame(R)),v=0,m=c.length;v<m;v++){var I=c[v],A=td.GlobalFunction.createCommonIconWidget(26,I);A.name="reward"+v;var b=new cc.Node;C===td.ActivityEnum.ActivityType.FamousGeneralShop&&I.getGoodsType()===td.GoodsType.Type_Mercenary||C===td.ActivityEnum.ActivityType.GoldEquipShop&&I.getGoodsType()===td.GoodsType.Type_Equip?b.addComponent(cc.Sprite).spriteFrame=S:b.addComponent(cc.Sprite).spriteFrame=null,b.x=-10,b.y=35,A.addChild(b),A.scale=.7,A.setPosition(cc.v2(145*v*.7-70,10)),t.addChild(A)}return this.setOperationBtn(t,e),t}},setOperationBtn:function(t,e){var i=t.getChildByName("btnOperation").getComponent(cc.Button);if(e.isCanExchange()){i.interactable=!0,i.clickEvents=[];var n=td.GlobalFunction.createClickEventHandler(this.node,"FamousGeneralShopListView","onExchange",e);i.clickEvents.push(n)}else i.interactable=!1},onExchange:function(t,e){var i=e.getId();this._callBack&&"function"==typeof this._callBack&&this._callBack(i)}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],FamousGeneralShopModel:[function(t,e,i){"use strict";cc._RF.push(e,"26f17oO5lRDkpO1zGpyrA7w","FamousGeneralShopModel");var n=cc.Class({properties:{_dataId:null,_id:null,_consumeList:null,_rewardList:null,_updateDay:null,_minLevel:null,_maxLevel:null,_vip:null,_totalTimes:null,_curTimes:null,_discount:null,_activityType:null},initData:function(t,e){t&&(this._activityType=e,this._dataId=t.data,this._id=t.id,this._consumeList=td.RewardManager.parseRewardListDetail(t.cost),this._rewardList=td.RewardManager.parseRewardListDetail(t.reward),this._updateDay=t.day,this._minLevel=t.minLevel,this._maxLevel=t.maxLevel,this._vip=t.vipLevel,this._totalTimes=t.times,this._discount=t.discount,this._curTimes=0)},getActivityType:function(){return this._activityType},getId:function(){return this._id},getConsume:function(){return this._consumeList},getReward:function(){return this._rewardList},getTotalTimes:function(){return this._totalTimes},setExchangeTimes:function(t){this._curTimes=t},getExchangeTimes:function(){return this._curTimes},isHaveLeftTimes:function(){return this._totalTimes-this._curTimes<=0?0:1},isCanExchange:function(){if(this._curTimes>=this._totalTimes)return!1;for(var t=0,e=this._consumeList.length;t<e;t++){var i=this._consumeList[t],n=i.getId(),a=i.getCount();if(td.ItemManager.getItemNumById(n)<a)return!1}return!0},getDiscount:function(){return this._discount}});e.exports=n,cc._RF.pop()},{}],FamousGeneralShopPanel:[function(t,e,i){"use strict";cc._RF.push(e,"663e4aOlrBME7UGv4+w06+L","FamousGeneralShopPanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{_listViewLogic:null},initData:function(t){this._super(t)},onLoad:function(){var t=this.node.getChildByName("itemWidget").getChildByName("scrollView");this._listViewLogic=t.getComponent("FamousGeneralShopListView")},_addEventListener:function(){var t={};t[td.EventNameEnum.Res_GET_ACTIVITY_INFO]=this._resInfo,td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},onEnable:function(){this._super(),this._addEventListener(),this._refreshView(),this._setActivityTime()},onDisable:function(){this._super(),this._removeAllListeners()},_resInfo:function(t){t===this.getActivityId()&&this._refreshView()},_refreshView:function(){var t=null;this._listViewLogic.getItemsCount()>0&&(t=this._listViewLogic.getScrollPanelPos());var e=this._controller.getDataList();e.sort(function(t,e){var i=t.isHaveLeftTimes(),n=e.isHaveLeftTimes();return i!==n?n-i:t.getId()-e.getId()});var i={dataList:e,callBack:this.onExchangeGoods.bind(this),activityType:this._activityType};this._listViewLogic.setData(i),t&&this._listViewLogic.scrollToPos(t)},_setActivityTime:function(){var t=this.node.getChildByName("titleWidget").getChildByName("labActivityTime"),e=td.Language.activityTime,i=this.getOpenEndTimeStr(),n=cc.js.formatStr("%s:%s",e,i);t.getComponent(cc.Label).string=n},onExchangeGoods:function(t){this._controller.receiveReward(t)}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],FamousGeneralShopTable:[function(t,e,i){"use strict";cc._RF.push(e,"07072LK6SdPyKzGANr2MloD","FamousGeneralShopTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"FamousGeneralShopTable",properties:{_tblName:"magic_store_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]||(t[a.data]={}),t[a.data][a.day]||(t[a.data][a.day]={}),t[a.data][a.day][a.id]=a}},getDataByDataId:function(t){return this._data&&this._data[t]?this._data[t]:null},getDataByDataIdAndDay:function(t,e){return this._data&&this._data[t]&&this._data[t][e]?this._data[t][e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FengKuangChanRao:[function(t,e,i){"use strict";cc._RF.push(e,"75b44uGhhJP55G3K+ny0gSU","FengKuangChanRao");var n=t("CommonSkill"),a=(t("PveFightManager"),cc.Class({extends:n,properties:{_targetEnemy:null},initData:function(t){this._super(t),this._skillName="FengKuangChanRao"},setTargetEnemy:function(t){this._targetEnemy=t},start:function(){var t=this._targetEnemy._tag,e=Math.floor(t/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._targetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=i.bDeath(),a=i.getTransferStatus();n||a?this.removeSelf():(this.setAttackEffectToEnemy(i),this.setEnemyHurt(i))},setEnemyHurt:function(t){var e=this._dataModel.getSkillPower(),i=this._curHeroAttackPower*e,n=this._cutHurtType;t.setHurt(this._heroSid,i,n,this._attackerVocation)},frameEventCallBack:function(){}}));e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill",PveFightManager:"PveFightManager"}],FerroTurntableConfig:[function(t,e,i){"use strict";cc._RF.push(e,"c1dd8D3zmpEJZJeHYZy6FsT","FerroTurntableConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityFuLuShouConfig",e._tblName="activity_fu_lu_shou_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getConfigByIdAndType=function(t,e){var i=[];if(this._data&&this._data[t]){for(var n=0;n<this._data[t].length;n++)this._data[t][n].type===e&&i.push(this._data[t][n]);i.sort(this.sortFunc)}return i},e.prototype.sortFunc=function(t,e){return t.sortRank-e.sortRank},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FerroTurntableController:[function(t,e,i){"use strict";cc._RF.push(e,"61e46oQqtVB1IESD+aUHFUu","FerroTurntableController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_isJumpToCharge:!1,_turnType:1},getTurnType:function(){return this._turnType},setTurnType:function(t){this._turnType=t},initData:function(t){this._super(t)},getIsJumpToCharge:function(){return this._isJumpToCharge},setIsJumpToCharge:function(t){this._isJumpToCharge=t},activityParse:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.RES_FERROTURNTABLE_INFO)},hasRedPoint:function(){return!0},redPointTip:function(){return this.isRedPointTip()},isRedPointTip:function(){if(this.isTaskRedTips())return!0;for(var t=td.GetConfig("ACTIVITY_FU_LU_SHOU_TYPE_COST"),e=0;e<t.length;e++)if(td.ItemManager.getItemNumById(t[e][1][1])>=10)return!0;var i=td.GlobalFunction.getLocalSaveStatus("FerroTurntable");return 1!=i&&"true"!==i},onOpenPanel:function(){td.GlobalFunction.setLocalSaveStatus("FerroTurntable",!0),td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_FERROTURNTABLE)},isTaskRedTips:function(){for(var t=td.TaskManager.getShowListByType(td.TaskType.ACTIVITY_TYPE_38,[]),e=0;e<t.length;e++)if(t[e].getStatus()===td.TaskStatus.Finish)return!0;return!1},redPointEvts:function(){return[td.EventNameEnum.OPEN_FERROTURNTABLE,td.EventNameEnum.Res_GET_TASK_INFO,td.EventNameEnum.RES_FERROTURNTABLE_INFO,td.EventNameEnum.ITEM_CHANGE]}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],FerroTurntablePanel:[function(t,e,i){"use strict";cc._RF.push(e,"e70d1nqyglAsa963jhImpH8","FerroTurntablePanel");var n=t("ActivityBasePanel"),a=t("CommonIconWidget"),r=t("ItemModel"),o=cc.Class({extends:n,properties:{rewardNode:cc.Node,img_light:cc.Node,lab_num1:cc.Label,lab_num2:cc.Label,lab_num3:cc.Label,lab_time:cc.Label,img_redPoint1:cc.Node,img_redPoint2:cc.Node,img_redPoint3:cc.Node,btn_task:cc.Node,_coordinates:null,_rewards:null,_activityData:null,_isOpenTask:!1,_isTrunning:!1,_turnType:1,_ids:null,_itemCount:0},onLoad:function(){this._coordinates=[cc.v2(-225,194),cc.v2(-135,194),cc.v2(-45,194),cc.v2(45,194),cc.v2(135,194),cc.v2(225,194),cc.v2(225,104),cc.v2(225,14),cc.v2(225,-76),cc.v2(225,-166),cc.v2(135,-166),cc.v2(45,-166),cc.v2(-45,-166),cc.v2(-135,-166),cc.v2(-225,-166),cc.v2(-225,-76),cc.v2(-225,14),cc.v2(-225,104)]},onEnable:function(){this._super();var t=td.GetConfig("ACTIVITY_FU_LU_SHOU_TYPE_COST");this._ids=[t[0][1][1],t[1][1][1],t[2][1][1]],this._activityData=this._controller.getActivityData(),this._isTrunning=!1,this._addLocalListeners(),this.setActivityTime(),this._turnType=this._controller.getTurnType();for(var e=1;e<4;e++){this.node.getChildByName("img_select"+e).active=e===this._turnType}this.initUI(),this.initNum(),this._controller.getIsJumpToCharge()&&(this._controller.setIsJumpToCharge(!1),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_FerroTurntableTask),this._isOpenTask=!0),td.RedPointUtil.createRedPointOld(this.btn_task,cc.v2(-10,-15),this._controller.isTaskRedTips.bind(this._controller),this._controller.redPointEvts()),this._controller.onOpenPanel()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this.img_light.stopAllActions(),this._isTrunning&&this.showReward(),this._controller.setTurnType(this._turnType),this._super()},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.RES_FERROTURNTABLE_INFO]=this.initNum,i[e.ITEM_CHANGE]=this.initNum,i[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.onReceiveOperation,i[e.FERROTURNTABLE_Task_Close]=this.onTaskCloss,t.registerEvents(i,this)},initItem:function(){for(var t=td.GetTableClass(td.TableEnum.FerroTurntableConfig).getConfigByIdAndType(this._activityData,this._turnType),e=0;e<this._coordinates.length;e++){var i=this.rewardNode.getChildByName("item"+e),n=t[e].rewards[0],r=td.RewardManager.getRewardDetail(n);if(i)i.getComponent(a).setData(r);else(i=td.GlobalFunction.createCommonIconWidget(26,r)).name="item"+e,i.x=this._coordinates[e].x,i.y=this._coordinates[e].y,i.setScale(.72),this.rewardNode.addChild(i,-1)}},initIndex:function(){this._isTrunning&&this.showReward(),this.img_light.stopAllActions(),this.img_light.x=this._coordinates[0].x,this.img_light.y=this._coordinates[0].y},initNum:function(){var t=td.ItemManager.getItemNumById(this._ids[0]),e=td.ItemManager.getItemNumById(this._ids[1]),i=td.ItemManager.getItemNumById(this._ids[2]);this.lab_num1.string=t+"",this.lab_num2.string=e+"",this.lab_num3.string=i+"",this.img_redPoint1.active=t>=10,this.img_redPoint2.active=e>=10,this.img_redPoint3.active=i>=10},initUI:function(){this.initIndex(),this.initItem()},setActivityTime:function(){var t=this.getDurationStr();this.lab_time.string=t},_onActivityClose:function(t){this._activityId===t&&this.onDestroy()},onBtnGet:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_FerroTurntableTask),this._isOpenTask=!0},onTaskCloss:function(){this._isOpenTask=!1},onSwitch:function(t,e){var i=parseInt(e);if(i!=this._turnType){this._turnType=i;for(var n=1;n<4;n++){this.node.getChildByName("img_select"+n).active=n===this._turnType}this.initUI()}},onBtn:function(t,e){if(!this._isTrunning){var i=parseInt(e),n=td.ItemManager.getItemNumById(this._ids[this._turnType-1]);if(n<1){var a=new td.BroadcastContent(412);return td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_FerroTurntableTask),void(this._isOpenTask=!0)}if(i>1){var o=td.GetTableClass(td.TableEnum.Item).getItemById(this._ids[this._turnType-1]),s=new r;s.init(o),s.setCount(1);var l={};return l.okCallFunc=this._goRequest.bind(this),l.buyCost1=s,l.buyCost2=null,l.maxNum=n,void td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_TurnTableQuickExact,l)}var c={};c.parmeterMap={6:i},c.id=this._turnType,this._controller.operateActivity(c)}},_goRequest:function(t){var e={};e.parmeterMap={6:t},e.id=this._turnType,this._controller.operateActivity(e)},onReceiveOperation:function(t){if(t.activityId===this._activityId&&!this._isOpenTask)if(this._rewards=td.RewardManager.parseRewardResult(t.rewardResult,!0),this.initUI(),this.isShowAni()){var e=this.getLastPlayPos();this.showAni(e)}else this.showReward()},isShowAni:function(){var t,e=!0;this._itemCount=0,0===this._rewards&&(e=!1);for(var i=0;i<this._rewards.length;i++)t?(t!=this._rewards[i].id&&(e=!1),this._itemCount+=this._rewards[i].count?this._rewards[i].count:1):(t=this._rewards[i].id,this._itemCount+=this._rewards[i].count?this._rewards[i].count:1);return e},getLastPlayPos:function(){for(var t=0,e=td.GetTableClass(td.TableEnum.FerroTurntableConfig).getConfigByIdAndType(this._activityData,this._turnType),i=0;i<e.length;i++){var n=e[i].rewards[0];if(n[1]===parseInt(this._rewards[0].id)&&n[2]===this._itemCount){t=e[i].sortRank-1;break}}return t},showAni:function(t){this._isTrunning=!0,this.img_light.stopAllActions();var e=new cc.MoveArround(3,this._coordinates,t,2).easing(cc.easeSineOut()),i=cc.callFunc(this.showReward.bind(this)),n=cc.sequence(e,cc.delayTime(.2),i);this.img_light.runAction(n)},showReward:function(){td.GlobalFunction.showRewards(this._rewards),this._isTrunning=!1,this._rewards=null}});e.exports=o,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",CommonIconWidget:"CommonIconWidget",ItemModel:"ItemModel"}],FerroTurntableTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"91c53n2XRxOVa12+1NhrMoq","FerroTurntableTaskItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=t("CommonIconWidget"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labDesc=null,e.labProTitle=null,e.labProgress=null,e.btnGoto=null,e.btnGet=null,e.imgGot=null,e.icon=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n,a=r.TaskStatus.NONE;n=i.getDes(),this._gotoPanel=i.getGotoPanel(),this._id=i.getId();var o=i.getRewards()[0],s=r.RewardManager.getRewardDetail(o),l=this.icon.getChildByName("item");l?l.getComponent(u).setData(s):((l=r.GlobalFunction.createCommonIconWidget(26,s)).name="item",l.setScale(.9),this.icon.addChild(l));a=i.getStatus(),this.labDesc.string=n,this.labProTitle.string=r.Language.progress+":",i.isChargeType()?this.labProgress.string=i.getValue()/10+"/"+i.getNeedValue()/10:this.labProgress.string=i.getValue()+"/"+i.getNeedValue(),this.btnGoto.active=a===r.TaskStatus.Progress,this.btnGet.active=a===r.TaskStatus.Finish,this.imgGot.active=a===r.TaskStatus.Received,this._gotoPanel&&0!==this._gotoPanel.length||(this.btnGoto.active=!1)},e.prototype.onJump=function(){var t=null;this._gotoPanel[1]&&(t=this._gotoPanel[1]);var e=r.PanelManager.getInstance().getCurShowPanel();if(this._gotoPanel[0]&&r.PanelEnum.Panel_Activity===this._gotoPanel[0]){e.getComponent("ActivityMainPanel").setData(t),r.ActivityDataManager.setJumpBackData([r.ActivityEnum.Activity.ActivityConfig,r.ActivityEnum.ActivityType.FerroTurntable]);var i=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.FerroTurntable);i&&(i.setIsJumpToCharge(!0),r.EventUtil.dispatchEvent(r.EventNameEnum.FERROTURNTABLE_TaskWindow_Close))}else r.PanelJumpManager.jumpToPanel(this._gotoPanel[0],t)},e.prototype.onReward=function(){r.EventUtil.dispatchEvent(r.EventNameEnum.Req_TASK_RECEIVE,this._id)},a([c(cc.Label)],e.prototype,"labDesc",void 0),a([c(cc.Label)],e.prototype,"labProTitle",void 0),a([c(cc.Label)],e.prototype,"labProgress",void 0),a([c(cc.Node)],e.prototype,"btnGoto",void 0),a([c(cc.Node)],e.prototype,"btnGet",void 0),a([c(cc.Node)],e.prototype,"imgGot",void 0),a([c(cc.Node)],e.prototype,"icon",void 0),e=a([l],e)}(o);i.default=d,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],FerroTurntableTaskWindow:[function(t,e,i){"use strict";cc._RF.push(e,"1400a4ZA6lGm6SMYEJjFTtJ","FerroTurntableTaskWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator.ccclass,s=t("PanelBase"),l=t("OptimizeVerticalListView"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_FerroTurntableTask},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.Res_GET_TASK_INFO]=this._refreshList,t[e.FERROTURNTABLE_TaskWindow_Close]=this.closeCallFunc,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(){t.prototype.setData.call(this),this._refreshList()},e.prototype._refreshList=function(){var t=r.TaskManager.getShowListByType(r.TaskType.ACTIVITY_TYPE_38,[r.TaskStatus.UNOPENED,r.TaskStatus.NONE]);t.sort(this._sortTaskList),this.node.getComponent(l).refreshListData(t)},e.prototype._sortTaskList=function(t,e){if(t.getStatus()!=e.getStatus()){if(3===t.getStatus())return-1;if(3===e.getStatus())return 1;if(4===t.getStatus())return 1;if(4===e.getStatus())return-1}return t.getId()-e.getId()},e.prototype.onBtnClose=function(){r.EventUtil.dispatchEvent(r.EventNameEnum.FERROTURNTABLE_Task_Close),this.closeCallFunc()},e=a([o],e)}(s);i.default=c,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],FestivalActivityTable:[function(t,e,i){"use strict";cc._RF.push(e,"11d41mqgWRI2JFKDnGmPTgo","FestivalActivityTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityFestivalChargeConfig",properties:{_tblName:"activity_festival_charge_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.data,o=a.stage;t[r]||(t[r]={}),t[r][o]||(t[r][o]=[]),t[r][o].push(a)}},getData:function(){return this._data},getDatasByDataIdAndStage:function(t,e){return this._data[t]?this._data[t][e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FestivalController:[function(t,e,i){"use strict";cc._RF.push(e,"256830MVexFu6ULNs/ovAXa","FestivalController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("./FestivalExchangeModel"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isOpened=!1,e._storeMap={},e._isWordsWindowShowed=!1,e._isExchangeWindowShowed=!1,e._selectType=1,e._isToTask=!1,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this.initStoreCfg()},e.prototype.activityParse=function(t){this._stage=t.global.stage,this._stageCloseTime=t.global.endTime;var e=t.record;this._chargeMap=e.chargeMap,this._receiveMap=e.receiveMap;var i=e.storeMap;for(var n in i)if(i.hasOwnProperty(n)){var a=i[n];this.refreshStoreCfgData(parseInt(n),a)}},e.prototype.initStoreCfg=function(){var t=this,e=td.GetTableClass(td.TableEnum.FestivalStoreTable);if(!e)return null;var i=e.getDatasByDataId(this._activityData);for(var n in i){var r=i[n];for(var o in r){r[o].forEach(function(e){var i=new a.default;i.initData(e),t._storeMap[e.id]=i})}}},e.prototype.refreshStoreCfgData=function(t,e){var i=this._storeMap[t];i&&i.setBuyTimes(e)},e.prototype.getStageList=function(){return td.GetTableClass(td.TableEnum.FestivalTable).getDatasByDataIdAndStage(this._activityData,this._stage)},e.prototype.getDiscountRewards=function(){var t=[];for(var e in this._storeMap)4===this._storeMap[e].getType()&&this._storeMap[e].getStage()===this._stage&&t.push(this._storeMap[e]);return t.sort(this.sortFunc)},e.prototype.getWordExchangeList=function(){var t=[];for(var e in this._storeMap)3===this._storeMap[e].getType()&&t.push(this._storeMap[e]);return t.sort(this.sortFunc)},e.prototype.getExchangeCfgList=function(){var t=[];for(var e in this._storeMap)1===this._storeMap[e].getType()&&t.push(this._storeMap[e]);return t.sort(this.sortFunc)},e.prototype.getExchangeCostModel=function(){var t=this.getExchangeCfgList();return t[0]?t[0].getCost()[0]:null},e.prototype.getRareCfgList=function(){var t=[];for(var e in this._storeMap)2===this._storeMap[e].getType()&&t.push(this._storeMap[e]);return t.sort(this.sortFunc)},e.prototype.getRareCostModel=function(){var t=this.getRareCfgList();return t[0]?t[0].getCost()[0]:null},e.prototype.sortFunc=function(t,e){return e.getSortRank()-t.getSortRank()},e.prototype.getStage=function(){return this._stage},e.prototype.getStageCloseTime=function(){return this._stageCloseTime},e.prototype.getChargeMap=function(){return this._chargeMap},e.prototype.getReceiveMap=function(){return this._receiveMap},e.prototype.getSelectType=function(){return this._selectType},e.prototype.setSelectType=function(t){this._selectType=t},e.prototype.getIsToTask=function(){return this._isToTask},e.prototype.setIsToTask=function(t){this._isToTask=t},e.prototype.getDurationStr=function(t){var e=this.getCurrentOpenStage();if(!e)return"";var i=new Date(e.openTime),n=new Date(e.closeTime),a=td.Language.timePattern5,r=td.Language.activityTimeTip;return t&&(r=td.Language.activityTimeTip1),r=cc.js.formatStr(r,i.pattern(a),n.pattern(a))},e.prototype.setJumpToRecharge=function(){this._isJumpToRecharge=!0},e.prototype.hasRedPoint=function(){return!0},e.prototype.onOpenPanel=function(){this._isOpened=!0,td.GlobalFunction.setLocalSaveStatus("FestivalPanel","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.FESTIVAL_PANEL_SHOW)},e.prototype.isFirstLoginToday=function(){return!td.GlobalFunction.getLocalSaveStatus("FestivalPanel")},e.prototype.isTaskFinish=function(){var t=this.getStageList();for(var e in t){var i=t[e].taskIds;if(i&&i.length>0)for(var n=td.TaskManager,a=0,r=i.length;a<r;a++){var o=i[a],s=n.getTaskById(o);if(s&&s.getStatus()===td.TaskStatus.Finish)return!0}}for(var l=td.GetTableClass(td.TableEnum.FestivalActivityTable).getDatasByDataIdAndStage(this._activityData,this._stage),c=0;c<l.length;c++){var u=l[c],d=this.getChargeMap(),h=this.getReceiveMap(),p=u.charge;u.times;if((d[p]?d[p]:0)>(h[p]?h[p]:0))return!0}return!1},e.prototype.isWordWindowRed=function(){for(var t=!1,e=this.getWordExchangeList(),i=0;i<e.length;i++){for(var n=e[i].getCost(),a=!0,r=0,o=n.length;r<o;r++){var s=n[r],l=td.ItemManager.getItemNumById(s.getId()),c=s.getCount();a&&l<c&&(a=!1)}if(a){t=!0;break}}return!(!t||this._isWordsWindowShowed)},e.prototype.openExchangeWindow=function(){this._isExchangeWindowShowed=!0},e.prototype.openWordsWindow=function(){this._isWordsWindowShowed=!0},e.prototype.isExchangeWindowRed=function(){var t=!1,e=this.getExchangeCostModel();if(!e)return!1;for(var i=td.ItemManager.getItemNumById(e.getId()),n=this.getExchangeCfgList(),a=0;a<n.length;a++){if(i>=n[a].getCost()[0].getCount()){t=!0;break}}if(!t){e=this.getRareCostModel(),i=td.ItemManager.getItemNumById(e.getId()),n=this.getRareCfgList();for(a=0;a<n.length;a++){if(i>=n[a].getCost()[0].getCount()){t=!0;break}}}return!(!t||this._isExchangeWindowShowed)},e.prototype.isRedPointTip=function(){return this.isFirstLoginToday()||this.isTaskFinish()||this.isWordWindowRed()||this.isExchangeWindowRed()},e.prototype.redPointEvts=function(){return[td.EventNameEnum.FESTIVAL_PANEL_SHOW,td.EventNameEnum.Res_GET_TASK_INFO,td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,td.EventNameEnum.FESTIVAL_EX_BTN_RED,td.EventNameEnum.FESTIVAL_WORD_BTN_RED]},e}(t("ActivityBaseController"));i.default=r,e.exports=r,cc._RF.pop()},{"./FestivalExchangeModel":"FestivalExchangeModel",ActivityBaseController:"ActivityBaseController"}],FestivalExchangeItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"0e929xAwdVAjq245H4PsV/H","FestivalExchangeItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labItemName=null,e.labLeftTimes=null,e.labCost=null,e.imgCostIcon=null,e.nodeItem=null,e.btnExchange=null,e.imgExchanged=null,e.imgExchangeTip=null,e._curActivityType=null,e._controller=null,e._goodId=0,e._itemDataModel=null,e._costItem=null,e._goodItem=null,e._index=0,e}return n(e,t),e.prototype.onEnable=function(){this._customData&&(this._curActivityType=this._customData.activityType,this._controller=r.ActivityDataManager.getActivityControllerByType(this._curActivityType))},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._curActivityType=this._customData.activityType,this._controller=r.ActivityDataManager.getActivityControllerByType(this._curActivityType),this._itemDataModel=i,this._index=e,this.imgExchangeTip.active=this._itemDataModel.isLimitBuy();var n=this._itemDataModel.getLeftBuyTimes();this.labLeftTimes.string=cc.js.formatStr(r.Language.exchangeGoodsTimes,n),this.btnExchange.active=n>0,this.imgExchanged.active=n<=0,this.imgExchangeTip.active=n>0&&this._itemDataModel.isLimitBuy();var a=this._itemDataModel.getCost()[0];this.labCost.string=a.getCount(),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,a.getLittleIconResPath(),this.imgCostIcon),this._costItem=a;var o=this._itemDataModel.getRewards()[0];this._goodItem=o,this._goodId=o.getId(),this.labItemName.string=this._goodItem.getName(),r.GlobalFunction.setNameColors(this.labItemName.node,o.getQuality());var s=this.nodeItem.getChildByName("icon");s||(s=r.GlobalFunction.createCommonIconWidget(26,o),this.nodeItem.addChild(s)),s.getComponent("CommonIconWidget").setData(o)},e.prototype.onBtnExchangeClick=function(){if(null!=this._controller){var t={};t.okCallFunc=this.onSendExchangeRequest.bind(this),t.consumeModel=this._costItem,t.buyProductModel=this._goodItem,t.maxNum=this._itemDataModel.getLeftBuyTimes()||99,t.singlePrice=this._costItem.getCount(),t.windowTitle=r.Language.exchange,t.btnTitle=r.Language.exchange,t.isNoItem=!1,r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_ActivityBuy,t)}},e.prototype.onSendExchangeRequest=function(t){if(this._controller){var e={id:this._itemDataModel.getId()};e.parmeterMap={6:t},e.parmeterMap[this._curActivityType]=2,this._controller.operateActivity(e),r.EventUtil.dispatchEvent(r.EventNameEnum.FESTIVAL_EX_SELECT_INDEX,this._index)}},a([c(cc.Label)],e.prototype,"labItemName",void 0),a([c(cc.Label)],e.prototype,"labLeftTimes",void 0),a([c(cc.Label)],e.prototype,"labCost",void 0),a([c(cc.Node)],e.prototype,"imgCostIcon",void 0),a([c(cc.Node)],e.prototype,"nodeItem",void 0),a([c(cc.Node)],e.prototype,"btnExchange",void 0),a([c(cc.Node)],e.prototype,"imgExchanged",void 0),a([c(cc.Node)],e.prototype,"imgExchangeTip",void 0),e=a([l,u("module/Activity/FestivalExchangeItemUI")],e)}(o);i.default=d,cc._RF.pop()},{ListItem:void 0}],FestivalExchangeModel:[function(t,e,i){"use strict";cc._RF.push(e,"1f28eEO7pRPrqwbmIkyUnwq","FestivalExchangeModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._data=null,this._id=null,this._reward=null,this._times=null,this._cost=null,this._discount=1,this._buyTimes=0,this._leftBuyTime=0}return t.prototype.initData=function(t){this._data=t.data,this._id=t.id,t.limitCount?this._times=t.limitCount:t.times&&(this._times=t.times),this._discount=t.discount,this._type=t.type,this._stage=t.stage,this._sortRank=t.sortRank,this._cost=td.RewardManager.parseRewardListDetail(t.costs),this._reward=td.RewardManager.parseRewardListDetail(t.rewards),this.setBuyTimes(0)},t.prototype.getId=function(){return this._id},t.prototype.getData=function(){return this._data},t.prototype.getDiscount=function(){return this._discount},t.prototype.getCost=function(){return this._cost},t.prototype.getTimes=function(){return this._times>0?this._times:99},t.prototype.getRewards=function(){return this._reward},t.prototype.getType=function(){return this._type},t.prototype.getStage=function(){return this._stage},t.prototype.getSortRank=function(){return this._sortRank},t.prototype.setBuyTimes=function(t){this._buyTimes=t,this._leftBuyTime=this._times-this._buyTimes,this._leftBuyTime<=0&&(this._leftBuyTime=0,this.isLimitBuy()||(this._leftBuyTime=99))},t.prototype.setLeftBuyTime=function(t){this._leftBuyTime=t},t.prototype.getLeftBuyTimes=function(){return this._leftBuyTime},t.prototype.isLimitBuy=function(){return this._times>0},t}();i.default=n,cc._RF.pop()},{}],FestivalExchangeWindow:[function(t,e,i){"use strict";cc._RF.push(e,"9feecAPeUZF5r0gxqADZmtW","FestivalExchangeWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=t("TabController"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labCoin=null,e.imgCoin=null,e.labTime=null,e.btnNormal=null,e.btnHigh=null,e._tableController=null,e._curActivityType=null,e._controller=null,e._isInit=!1,e._index=0,e._showTab=1,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_FestivalExchange},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this._tableController||(this._tableController=new h,this.btnNormal._tag=1,this.btnHigh._tag=2,this._tableController.init([this.btnNormal,this.btnHigh],this,1))},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this._index=0},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.Window_GetReward_CLOSE]=this._refreshView,t[e.FESTIVAL_EX_SELECT_INDEX]=this._curSelectIndex,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),e&&(this._curActivityType=e.activityType),this._controller=r.ActivityDataManager.getActivityControllerByType(this._curActivityType),this._refreshView()},e.prototype.showTab=function(t){this._showTab!=t&&(this._index=0,this._showTab=t,this._refreshView())},e.prototype._curSelectIndex=function(t){this._index=t},e.prototype._showRewards=function(t){if(t.activityId===this._controller.getActivityId()){var e=t.rewardResult,i=r.RewardManager.parseRewardResult(e,!0);r.GlobalFunction.showRewards(i)}},e.prototype._refreshView=function(t){if(null!=this._controller){this._controller.openExchangeWindow(),r.EventUtil.dispatchEvent(r.EventNameEnum.FESTIVAL_EX_BTN_RED),this.labTime.string=this._controller.getDurationStr(!0);var e=this.node.getComponent(d);e.setCustomData({activityType:this._curActivityType});var i=this._controller.getExchangeCfgList(),n=null;1==this._showTab?(n=this._controller.getExchangeCostModel(),i=this._controller.getExchangeCfgList()):(n=this._controller.getRareCostModel(),i=this._controller.getRareCfgList()),i.sort(function(t,e){var i=0,n=0;return t.getLeftBuyTimes()<=0&&t.isLimitBuy()&&(i=1),e.getLeftBuyTimes()<=0&&e.isLimitBuy()&&(n=1),i-n}),this._isInit?e.refreshCurList(i):e.refreshListData(i),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,n.getLittleIconResPath(),this.imgCoin);var a=r.ItemManager.getItemNumById(n.getId());this.labCoin.string=a,e.scrollToRow(this._index)}},a([l(cc.Label)],e.prototype,"labCoin",void 0),a([l(cc.Node)],e.prototype,"imgCoin",void 0),a([l(cc.Label)],e.prototype,"labTime",void 0),a([l(cc.Node)],e.prototype,"btnNormal",void 0),a([l(cc.Node)],e.prototype,"btnHigh",void 0),e=a([s,c("module/Activity/FestivalExchangeWindow")],e)}(u);i.default=p,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0,TabController:void 0}],FestivalItem:[function(t,e,i){"use strict";cc._RF.push(e,"ae760nYAVtNJYwBaMDWOa+d","FestivalItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=t("CommonIconWidget"),l=cc._decorator,c=l.ccclass,u=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleLabel=null,e.oriCostNode=null,e.costNode=null,e.progressNum=null,e.statusImg=null,e.conditionLabel=null,e.enterBtn=null,e.rewardLayer=null,e._storeModel=null,e}return n(e,t),e.prototype.updateItem=function(e,i){if(t.prototype.updateItem.call(this,e,i),i){this._storeModel=i;var n,a,o,l,c,u=[];if(1===this._customData.showType)if(this.conditionLabel.node.active=!1,this.oriCostNode.active=!1,this.costNode.active=!1,i.isCharge){var d=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Festival),h=d.getChargeMap(),p=d.getReceiveMap(),_=i.charge,g=i.times,f=h[_]?h[_]:0,v=p[_]?p[_]:0;u=r.RewardManager.getRewardDetailArray(i.rewards),this.titleLabel.string=cc.js.formatStr("%s",r.Language.singleRecharge,_/10);var m=void 0;v===g?(n=null,c=r.resDef.pngPlist.GY0_Common,l=r.resDef.GY0_Common.GY0_wz_yilingqu,m=cc.color(0,167,43)):f>v?(l=null,n=r.resDef.GY_Common.GY_anniu_03,a=r.Language.recevie,o=cc.color(16,98,161),m=cc.color(0,167,43),this._isReceive=!0):(l=null,n=r.resDef.GY_Common.GY_anniu_02,a=r.Language.goto,o=cc.color(176,79,0),m=cc.color(173,98,1),this._isReceive=!1),this.progressNum.string=r.Language.leftTimes+(g-v)+"/"+g,this.progressNum.node.color=m}else{this.titleLabel.string=i.getDes(),u=r.RewardManager.getRewardDetailArray(i.getRewards());var y=i.getStatus(),E=r.TaskStatus;y===E.Received?(n=null,c=r.resDef.pngPlist.GY0_Common,l=r.resDef.GY0_Common.GY0_wz_yilingqu):y===E.Finish?(l=null,n=r.resDef.GY_Common.GY_anniu_03,a=r.Language.recevie,o=cc.color(16,98,161)):(l=null,n=r.resDef.GY_Common.GY_anniu_02,a=r.Language.goto,o=cc.color(176,79,0));m=i.getStatus()===r.TaskStatus.Finish||i.getStatus()===r.TaskStatus.Received?cc.color(0,167,43):cc.color(173,98,1);var T=i.getValue(),C=i.getNeedValue();i.isChargeType()&&(T=i.getValue()/10,C=i.getNeedValue()/10,y!==E.Finish&&(a=r.Language.goto)),this.progressNum.string=T+"/"+C,this.progressNum.node.color=m}else{this.titleLabel.string=i.getRewards()[0].getName(),u=i.getRewards(),this.progressNum.node.active=!1;var R=i.getCost()[0],S=i.getDiscount();R?(this.oriCostNode.active=!0,this._setCostIconAndNum(this.oriCostNode,R,S)):this.oriCostNode.active=!1,S?(this.costNode.active=!0,this._setCostIconAndNum(this.costNode,R)):this.costNode.active=!1,this.costNode.y=-33,100===S&&(this.oriCostNode.active=!1,this.costNode.y=-13),i.getLeftBuyTimes()>0?(l=null,n=r.resDef.GY_Common.GY_anniu_02,a=r.Language.buy,o=cc.color(176,79,0),this.conditionLabel.node.active=!0,this.conditionLabel.string=cc.js.formatStr(r.Language.canBuyTimes,i.getLeftBuyTimes())):(n=null,l=r.resDef.GY0_Common.GY0_wz_yiguomai,c=r.resDef.pngPlist.GY0_Common,this.conditionLabel.node.active=!1)}if(null!==l?(this.statusImg.active=!0,r.GlobalFunction.createAltasSprite(c,l,this.statusImg)):this.statusImg.active=!1,null!==n){if(this.enterBtn.active=!0,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.GY_Common,n,this.enterBtn),a){var I=this.enterBtn.getChildByName("Label");I.color=o,I.getComponent(cc.Label).string=a}}else this.enterBtn.active=!1;for(var A=0,b=u.length;A<b;A++){var P=u[A];(N=this.rewardLayer.getChildByName("icon"+A))?N.getComponent(s).setData(P):((N=r.GlobalFunction.createCommonIconWidget(56,P)).name="icon"+A,N.scale=.8,N.parent=this.rewardLayer)}for(;;A++){var N;if(!(N=this.rewardLayer.getChildByName("icon"+A)))break;N.removeFromParent(!0)}}},e.prototype._setCostIconAndNum=function(t,e,i){void 0===i&&(i=100);var n=t.getChildByName("icon");n&&r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,e.getLittleIconResPath(),n);var a=t.getChildByName("num");a&&(a.getComponent(cc.Label).string=Math.floor(100*e.getCount()/i))},e.prototype.onClickEnterBtn=function(){if(this._item){var t=this._item,e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Festival),i={};if(1===this._customData.showType)if(e.setIsToTask(!0),t.isCharge)this._isReceive?(i.id=t.charge,i.parmeterMap={40:1},e.operateActivity(i)):r.GlobalFunction.inActivityGotoRecharge([r.ActivityEnum.Activity.ActivityConfig,r.ActivityEnum.ActivityType.Festival]);else if(t.getStatus()==r.TaskStatus.Finish)r.EventUtil.dispatchEvent(r.EventNameEnum.Req_TASK_RECEIVE,t.getId());else{var n=null,a=t.getGotoPanel();a[1]&&(n=a[1]);var o=r.PanelManager.getInstance().getCurShowPanel();if(a[0]&&r.PanelEnum.Panel_Activity===a[0])o.getComponent("ActivityMainPanel").setData(n),r.ActivityDataManager.setJumpBackData([r.ActivityEnum.Activity.ActivityConfig,r.ActivityEnum.ActivityType.Festival]);else r.PanelJumpManager.jumpToPanel(a[0],n)}else this.showBuyWindow()}},e.prototype.showBuyWindow=function(){if(null!=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Festival)&&this._storeModel){var t=this._storeModel.getCost()[0],e=this._storeModel.getRewards()[0],i={};i.okCallFunc=this.onSendExchangeRequest.bind(this),i.consumeModel=t,i.buyProductModel=e,i.maxNum=this._storeModel.getLeftBuyTimes()||99,i.singlePrice=t.getCount(),i.windowTitle=r.Language.exchange,i.btnTitle=r.Language.exchange,i.isNoItem=!1,r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_ActivityBuy,i)}},e.prototype.onSendExchangeRequest=function(t){var e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Festival);if(e){var i={id:this._storeModel.getId()};i.parmeterMap={40:2,6:t},e.operateActivity(i)}},a([u(cc.Label)],e.prototype,"titleLabel",void 0),a([u(cc.Node)],e.prototype,"oriCostNode",void 0),a([u(cc.Node)],e.prototype,"costNode",void 0),a([u(cc.Label)],e.prototype,"progressNum",void 0),a([u(cc.Node)],e.prototype,"statusImg",void 0),a([u(cc.Label)],e.prototype,"conditionLabel",void 0),a([u(cc.Node)],e.prototype,"enterBtn",void 0),a([u(cc.Node)],e.prototype,"rewardLayer",void 0),e=a([c],e)}(o);i.default=d,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],FestivalPanel:[function(t,e,i){"use strict";cc._RF.push(e,"19965wW6ttPb5+OHRQx2pTY","FestivalPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=t("TabController"),u=t("ActivityBasePanel"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.endTimeLabel=null,e.tabLayer=null,e.bannerBg=null,e.img1=null,e.img2=null,e.btnExchange=null,e.btnWords=null,e._tableController=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Panel,this._panelEnum=r.PanelEnum.Panel_Festival},e.prototype.onEnable=function(){if(t.prototype.onEnable.call(this),this._addEventListener(),this._controller.setIsToTask(!1),this._controller.onOpenPanel(),this._selectType=this._controller.getSelectType(),!this._tableController){this._tableController=new c;for(var e=[],i=1;i<=4;i++){var n=this.tabLayer.getChildByName("tabBtn"+i);n._tag=i,e.push(n)}this._tableController.init(e,this,1)}this._taskListComponent=this.node.getComponent(d),this.initUI();var a=this._selectType;this._selectType=-1,this._tableController.showTab(a),r.RedPointUtil.createRedPointOld(this.btnExchange,cc.v2(-30,-15),this._controller.isExchangeWindowRed.bind(this._controller),[r.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,r.EventNameEnum.FESTIVAL_EX_BTN_RED]),r.RedPointUtil.createRedPointOld(this.btnWords,cc.v2(-30,-15),this._controller.isWordWindowRed.bind(this._controller),[r.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,r.EventNameEnum.FESTIVAL_WORD_BTN_RED]);var o=this._controller.getWordExchangeList();!o||o.length<=0?this.btnWords.active=!1:this.btnWords.active=!0},e.prototype.initUI=function(){this._stage=this._controller.getStage();var t=this._controller.getStageList();if(t){for(var e=1;e<=4;e++){1===e&&(r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Acitivty_48_jrsd,t[e].bgPic,this.bannerBg),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Acitivty_48_jrsd,t[e].stageNameRes,this.img2),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Acitivty_48_jrsd,t[e].whichIssueRes,this.img1)),this.tabLayer.getChildByName("tabBtn"+e).getChildByName("Label").getComponent(cc.Label).string=t[e].name}this._initEndTime()}},e.prototype.showTab=function(t){this._selectType!==t&&(this._selectType=t,this._refreshList())},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),this._controller.setSelectType(1),t.prototype.onDisable.call(this)},e.prototype.onDestroy=function(){this._controller.getIsToTask()&&this._controller.setSelectType(this._selectType),t.prototype.onDestroy.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.Res_GET_TASK_INFO]=this._refreshList,t[e.Res_GET_ACTIVITY_INFO]=this._resInfo,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.receiveRewardReturn,t[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,r.EventUtil.registerEvents(t,this)},e.prototype._resInfo=function(t){t===this.getActivityId()&&this.refreshView()},e.prototype.refreshView=function(){this._controller.getStage()!=this._stage&&this.initUI(),this._refreshList()},e.prototype.receiveRewardReturn=function(t){t.activityId===this._activityId&&this._refreshList()},e.prototype.onBtnShop=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_FestivalExchange,{activityType:this._activityType})},e.prototype.onBtnCard=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_FestivalWords,{activityType:this._activityType})},e.prototype._onActivityClose=function(t){this._activityId===t&&this.onDestroy()},e.prototype._initEndTime=function(){this.unschedule(this.loopEndTime),this._endTime=this._controller.getStageCloseTime();var t=r.TimeUtil.getTime();this._endTime>t?(this.loopEndTime(),this.schedule(this.loopEndTime,1)):this.endTimeLabel.string=r.Language.end},e.prototype.loopEndTime=function(){var t=this._endTime-r.TimeUtil.getTime();t>0?this.endTimeLabel.string=r.Language.endTimecount+r.GlobalFunction.convertTimestamp(t/1e3,": dd\u5929HH:mm:ss"):(this.endTimeLabel.string=r.Language.end,this.unschedule(this.loopEndTime))},e.prototype._refreshList=function(){this._selectType||(this._selectType=1);var t=this._controller.getStageList();if(t){var e=t[this._selectType];if(e){var i,n,a=[],o=[],s=[],l=!1,c=e.taskIds;if(c&&c.length>0||1===this._selectType){for(var u=r.TaskManager,d=0,h=c.length;d<h;d++){var p=c[d],_=u.getTaskById(p);_&&(_.getStatus()===r.TaskStatus.Received?a.push(_):_.getStatus()===r.TaskStatus.Finish?o.push(_):s.push(_))}n=1}else{var g=this._controller.getDiscountRewards();g&&g.length>0&&(n=2,o=g.slice(0))}var f=r.GetTableClass(r.TableEnum.FestivalActivityTable).getDatasByDataIdAndStage(this._controller.getActivityData(),this._stage);f.sort(function(t,e){return t.charge-e.charge});for(var v=0;v<f.length;v++){var m=f[v];m.isCharge=!0;var y=this._controller.getChargeMap(),E=this._controller.getReceiveMap(),T=m.charge,C=m.times,R=y[T]?y[T]:0,S=E[T]?E[T]:0;S===C?1===this._selectType&&a.push(m):R>S?(l=!0,1===this._selectType&&o.push(m)):1===this._selectType&&s.push(m)}i=o.concat(s).concat(a);for(d=1;d<=4;d++){var I=this.tabLayer.getChildByName("tabBtn"+d).getChildByName("img_redPoint"),A=t[d],b=!1;if(d<=3){var P=A.taskIds;if(P&&P.length>0){u=r.TaskManager;var N=0;t:for(h=P.length;N<h;N++){var M=P[N],L=u.getTaskById(M);if(L&&L.getStatus()===r.TaskStatus.Finish){b=!0;break t}}}b||1!==d||l&&(b=!0),I.active=b&&d!=this._selectType}var D={};D.showType=n,this._taskListComponent.setCustomData(D),this._taskListComponent.setData(i)}}}},a([l(cc.Label)],e.prototype,"endTimeLabel",void 0),a([l(cc.Node)],e.prototype,"tabLayer",void 0),a([l(cc.Node)],e.prototype,"bannerBg",void 0),a([l(cc.Node)],e.prototype,"img1",void 0),a([l(cc.Node)],e.prototype,"img2",void 0),a([l(cc.Node)],e.prototype,"btnExchange",void 0),a([l(cc.Node)],e.prototype,"btnWords",void 0),e=a([s],e)}(u);i.default=h,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0,TabController:void 0}],FestivalStoreTable:[function(t,e,i){"use strict";cc._RF.push(e,"56bc5xvbshELaFRyKJ1PFPf","FestivalStoreTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityFestivalStoreConfig",properties:{_tblName:"activity_festival_store_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.data,o=a.type;t[r]||(t[r]={}),t[r][o]||(t[r][o]={}),t[r][o][a.stage]||(t[r][o][a.stage]=[]),t[r][o][a.stage].push(a)}},getData:function(){return this._data},getDatasByDataId:function(t){return this._data[t]},getDatasByDataIdAndType:function(t,e){return this._data[t]?this._data[t][e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FestivalTable:[function(t,e,i){"use strict";cc._RF.push(e,"7baa5HlvJZHf617QL5ds6I7","FestivalTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"FestivalConfig",properties:{_tblName:"festival_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.data,o=a.stage;t[r]||(t[r]={}),t[r][o]||(t[r][o]={}),t[r][o][a.subType]=a}},getData:function(){return this._data},getDatasByDataIdAndStage:function(t,e){return this._data[t]?this._data[t][e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FestivalWordsItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"9abff+Qjl1DwoMxOBH8m3pY","FestivalWordsItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labExchangeCount=null,e.nodeWordModel=null,e.nodeCost=null,e.nodeRewards=null,e.btnGoto=null,e._controller=null,e._itemModelData=null,e._itemData=null,e._itemId=null,e._activityType=null,e._canBuyMaxCount=null,e}return n(e,t),e.prototype.onEnable=function(){this._customData&&(this._activityType=this._customData.activityType,this._controller=td.ActivityDataManager.getActivityControllerByType(this._activityType))},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._itemModelData=i,this._activityType=this._customData.activityType,this._controller=td.ActivityDataManager.getActivityControllerByType(this._activityType);var n=this._itemModelData.getId();this._itemId=n;var a=this._itemModelData.getTimes(),r=(this._itemModelData.getTimes(),this._itemModelData.getLeftBuyTimes());this.labExchangeCount.string=r+"/"+a;var o=this._itemModelData.getCost(),s=this.nodeCost.childrenCount,l=!0;this._canBuyMaxCount=r;for(var c="",u=0,d=o.length;u<d;u++){var h=o[u];if(y=this.nodeCost.getChildByName("cost"+(u+1))){y.getChildByName("icon").getComponent("CommonIconWidget").setData(h)}else{y=cc.instantiate(this.nodeWordModel);var p=td.GlobalFunction.createCommonIconWidget(1,h);y.name="cost"+(u+1),this.nodeCost.addChild(y),y.addChild(p),p.setName("icon"),y.setScale(.6)}y.active=!0,c+=h.getName(),u!=d-1&&(c+="\u3001");var _=y.getChildByName("icon"),g=td.ItemManager.getItemNumById(h.getId()),f=h.getCount();(E=y.getChildByName("richText")).active=!0,E.getComponent(cc.RichText).string=g>=f?cc.js.formatStr("<size=32><color=#03b10c>%s</c><color=#1f5588>/%s</color></size>",g,f):cc.js.formatStr("<size=32><color=#ff0c0c>%s</c><color=#1f5588>/%s</color></size>",g,f),this._canBuyMaxCount=Math.min(this._canBuyMaxCount,Math.floor(g/f)),td.GlobalFunction.graySprite(_,g<f),l&&g<f&&(l=!1)}for(;u<s;u++){var v=this.nodeCost.getChildByName("cost"+(u+1));v&&v.removeFromParent()}this.nodeCost.setContentSize(cc.size(d*this.nodeWordModel.width,this.nodeWordModel.height)),this.nodeCost.getComponent(cc.Layout).updateLayout(),this.node.getChildByName("titleNode").getChildByName("label2").getComponent(cc.Label).string=cc.js.formatStr("\u3010%s\u3011",c);var m=this._itemModelData.getRewards();for(s=this.nodeRewards.childrenCount,u=0,d=m.length;u<d;u++){var y,E,T=m[u];if(y=this.nodeRewards.getChildByName("reward"+(u+1))){(_=y.getChildByName("icon")).getComponent("CommonIconWidget").setData(T)}else{y=cc.instantiate(this.nodeWordModel);p=td.GlobalFunction.createCommonIconWidget(26,T);y.name="reward"+(u+1),this.nodeRewards.addChild(y),y.addChild(p),p.setName("icon"),y.setScale(.6)}y.active=!0,(E=y.getChildByName("richText")).active=!1}for(;u<s;u++){var C=this.nodeCost.getChildByName("reward"+(u+1));C&&C.removeFromParent()}this.nodeRewards.setContentSize(cc.size(d*this.nodeWordModel.width,this.nodeWordModel.height)),this.nodeRewards.getComponent(cc.Layout).updateLayout(),td.GlobalFunction.setButtonGray(this.btnGoto,!l),this._itemData=m[0]},e.prototype.onClickBtnGoto=function(){var t=this._canBuyMaxCount,e={};e.item=this._itemData,e.max=t,e.id=this._itemId,e.activityType=this._activityType,td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_CollectWordExchange,e)},a([s(cc.Label)],e.prototype,"labExchangeCount",void 0),a([s(cc.Node)],e.prototype,"nodeWordModel",void 0),a([s(cc.Node)],e.prototype,"nodeCost",void 0),a([s(cc.Node)],e.prototype,"nodeRewards",void 0),a([s(cc.Node)],e.prototype,"btnGoto",void 0),e=a([o,l("module/Activity/FestivalWordsItemUI")],e)}(t("ListItem"));i.default=c,cc._RF.pop()},{ListItem:void 0}],FestivalWordsWindow:[function(t,e,i){"use strict";cc._RF.push(e,"ab97d89RzBIupEXC69rSY4E","FestivalWordsWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTime=null,e._curActivityType=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_FestivalWords},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.Window_GetReward_CLOSE]=this._refreshList,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._curActivityType=e.activityType,this._refreshList()},e.prototype._refreshList=function(){var t=r.ActivityDataManager.getActivityControllerByType(this._curActivityType);if(null!=t){t.openWordsWindow(),r.EventUtil.dispatchEvent(r.EventNameEnum.FESTIVAL_WORD_BTN_RED),this.labTime.string=t.getDurationStr(!0);var e=t.getWordExchangeList(),i=this.node.getComponent(d);i.setCustomData({activityType:this._curActivityType}),i.refreshListData(e)}},a([l(cc.Label)],e.prototype,"labTime",void 0),e=a([s,c("module/Activity/FestivalWordsWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],FightResultAniComponent:[function(t,e,i){"use strict";cc._RF.push(e,"07355N9smxEpJJ1T1oUAcYF","FightResultAniComponent");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=(r.property,r.menu),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.setShowNextAniEventFunc=function(t){"function"==typeof t&&(this._showNextAniCallFunc=t)},e.prototype.setShowRewardResultFunc=function(t){"function"==typeof t&&(this._showRewardCallFunc=t)},e.prototype.showNextAniEvent=function(t){"function"==typeof this._showNextAniCallFunc&&this._showNextAniCallFunc(t)},e.prototype.showRewardResult=function(t){"function"==typeof this._showRewardCallFunc&&this._showRewardCallFunc(t)},e=a([o,s("module/Fight/Utils/FightResultAniComponent")],e)}(t("AnimationComponent"));i.default=l,cc._RF.pop()},{AnimationComponent:void 0}],FirecrackerCostTable:[function(t,e,i){"use strict";cc._RF.push(e,"01c63HyqqtPqpmfwjgfzxpH","FirecrackerCostTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="FirecrackerCostTable",e._tblName="activity_firecracker_cost_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getCostByIdAndTimes=function(t,e){if(this._data&&this._data[t])for(var i in this._data[t])if(this._data[t].hasOwnProperty(i))for(var n=this._data[t][i].voucherCost,a=0;a<n.length;a++){var r=n[a];if(r[0]==e)return r[1]}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FirecrackerRechargeTable:[function(t,e,i){"use strict";cc._RF.push(e,"fb887kskzpNIoiKztG+j5NV","FirecrackerRechargeTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="FirecrackerRechargeTable",e._tblName="activity_firecracker_recharge_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FirecrackerTable:[function(t,e,i){"use strict";cc._RF.push(e,"6cf51Iqr2JFX5h96QgCEpt9","FirecrackerTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="FirecrackerTable",e._tblName="activity_firecracker_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][a.id]=a}},e.prototype.getRewardByDataAndId=function(t,e){return this._data[t]?this._data[t][e].rewards[0]:[]},e.prototype.getRewardsList=function(t){var e=[];if(this._data[t]){var i=this._data[t];for(var n in i)if(i.hasOwnProperty(n)){var a=i[n],r={};a.rewards&&(r.id=a.id,r.reward=a.rewards[0],e.push(r))}}return e.sort(function(t,e){return e.id-t.id}),e},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FirstRechargeController:[function(t,e,i){"use strict";cc._RF.push(e,"cfe8aM6n9tNF4MCK/JFUHIx","FirstRechargeController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_isFirstEnter:null},initData:function(t){this._super(t),this._isFirstEnter=!0,this.addEventListener()},addEventListener:function(){var t={};t[td.EventNameEnum.Recharge_Success]=this.rechargeSuccess.bind(this),td.EventUtil.registerEvents(t,this)},rechargeSuccess:function(){this.isInOpenStatus()||(td.ActivityPanelManager.setActivitiesChangeSynchronized(!1),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL))},isInOpenStatus:function(){return td.Account.getUserData().getVip()<=0},onClicked:function(){this._isFirstEnter=!1,this._super()},hasRedPoint:function(){return!0},redPointTip:function(){return!!this.isInOpenStatus()&&this._isFirstEnter},redPointEvts:function(){return td.RedPointUtil.firstRechargeRedPointEvts()},isRedPointTip:function(){return td.RedPointUtil.isFirstRechargeRedPointTips()}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],FirstRechargePanel:[function(t,e,i){"use strict";cc._RF.push(e,"096d0dodqdA3YvudpPX8Wwn","FirstRechargePanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{_rewardCfg:null,_rewardHero:null,_heroTalentListView:null},initData:function(t){this._super(t)},onLoad:function(){var t=cc.find("heroInfoPanel/scrollView",this.node);if(this._heroTalentListView=t.getComponent("SendHeroSkillAtrrListView"),this._rewardCfg=td.GetConfig("First_Recharge_Reward"),this._rewardCfg){for(var e=0,i=this._rewardCfg.length;e<i;e++){var n=this._rewardCfg[e];if(1===n[0]){var a=n[1],r=td.RewardManager.getRewardDetail(a);this._rewardHero=r}}var o=this.node.getChildByName("rechargePanel");td.UIAdaptiveUtil.adaptiveWinSizeWidth(o)}},_addLocalListeners:function(){var t={};t[td.EventNameEnum.Recharge_Success]=this._setRechargeBtnStatus.bind(this),td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},onEnable:function(){this._super(),this._addLocalListeners(),this._refreshView()},onDisable:function(){this._super(),this._removeAllListeners()},_refreshView:function(){this._setHeroPanelInfo(),this._setRewardPanelInfo(),this._setRechargeOperatePanel()},_setHeroPanelInfo:function(){if(this._rewardHero){var t=this._rewardHero.getName(),e=this._rewardHero.getQuality(),i=this.node.getChildByName("heroInfoPanel"),n=i.getChildByName("imgHeroFigure"),a=i.getChildByName("labName");td.GlobalFunction.showMercenaryFigureAnimation(n,this._rewardHero),a.getComponent(cc.Label).string=t,td.GlobalFunction.setNameColors(a,e),this._setHeroEvolveTalent()}},_setHeroEvolveTalent:function(){var t=this._rewardHero.getEvolveTalentIds()||[];if(!(t.length<=0)){var e={dataList:t,heroData:this._rewardHero};this._heroTalentListView.setData(e)}},_setRewardPanelInfo:function(){if(this._rewardCfg){for(var t=[],e=0,i=this._rewardCfg.length-1;e<=i;e++){var n=this._rewardCfg[e];1!==n[0]&&(t.push(n[1]),t.push(n[2]))}this._setReward(t)}},_setReward:function(t){for(var e=this.node.getChildByName("rewardPanel"),i=cc.size(144,165),n=t.length,a=0;a<n;a++){var r=t[a],o=td.RewardManager.getRewardDetail(r),s=cc.js.formatStr("icon_%s",a),l=e.getChildByName(s);if(l){var c=l.getComponent("CommonIconWidget");c.setType(27),c.setData(o)}else(l=td.GlobalFunction.createCommonIconWidget(57,o)).x=(.85*i.width+30)*(2*a+1-n)/2,l.y=15,l.scale=.85,l.name=s,e.addChild(l,1)}},_setRechargeOperatePanel:function(){for(var t=this.node.getChildByName("rechargePanel"),e=td.GetTableClass(td.TableEnum.ChargeCommodityConfig).getFirstActivityList(),i=0,n=e.length;i<n&&!(i>=4);i++){var a=e[i],r=t.getChildByName("btnRecharge_"+(i+1)),o=r.getChildByName("Label"),s=t.getChildByName("labGet_"+(i+1)),l=r.getComponent(cc.Button),c=a.chargeId,u=a.costValue/10,d=a.reward,h=a.firstActivityReward,p=a.type,_=td.Language.recharge;p===td.RechargeTypeEnum.MonthCard?_=td.Language.vipCard_1:p===td.RechargeTypeEnum.LifeTimeCard?_=td.Language.vipCard_2:p===td.RechargeTypeEnum.WeekCard&&(_=td.Language.vipCard_3),o.getComponent(cc.Label).string=_+"\uffe5"+u,s.getComponent(cc.Label).string=d[0][2]+h[0][2]+td.Language.diamond,l.clickEvents=[];var g=td.GlobalFunction.createClickEventHandler(this.node,"FirstRechargePanel","gotoRecharge",c);l.clickEvents.push(g)}},_setRechargeBtnStatus:function(){for(var t=this.node.getChildByName("rechargePanel"),e=td.Account.getUserData().vip,i=1;i<=4;i++){t.getChildByName("btnRecharge_"+i).getComponent(cc.Button).interactable=e<=0}},gotoRecharge:function(t,e){var i=parseInt(e),n=td.RechargeManager.getRechargeDataById(i);td.RechargeManager.buy(n)}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],FlashGiftTable:[function(t,e,i){"use strict";cc._RF.push(e,"8ffa8iEt5dIAp+NfHShX22v","FlashGiftTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="FlashGiftConfig",e._tblName="flash_gift_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FlashGiftsManager:[function(t,e,i){"use strict";cc._RF.push(e,"bbc28Vs+2pKVIy6PZUAQ5y3","FlashGiftsManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=function(){function t(){}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._status=0},t.prototype.addListener=function(){var t=n.MsgModuleName.ExtensionCmd,e=n.MsgCmd.ExtensionCmd,i=n.ServerDelegate;i.registerMessage(t,e.GET_FLASH_GIFT_INFO,this.receiveInfo.bind(this)),i.registerMessage(t,e.FLASH_GIFT_REWARD_RECEIVE,this.receiveReward.bind(this)),i.registerMessage(t,e.PUSH_FLASH_GIFT_INFO,this.receiveInfo.bind(this))},t.prototype.addEventListener=function(){var t={},e=n.EventNameEnum;t[e.REQ_GET_FLASH_GIFT_INFO]=this.requestInfo.bind(this),t[e.REQ_FLASH_GIFT_REWARD_RECEIVE]=this.requestReward.bind(this),n.EventUtil.registerEvents(t,this)},t.prototype.getStatus=function(){return this._status},t.prototype.getBeginTime=function(){return this._beginTime},t.prototype.getEndTime=function(){var t,e=n.GetTableClass(n.TableEnum.FlashGiftTable).getDataById(this._rewardId);return t=this.isDiscount()?60*e.discountTime*1e3:60*e.validTime*60*1e3,this._beginTime+t},t.prototype.getRewardId=function(){return this._rewardId},t.prototype.isDiscount=function(){var t=n.GetTableClass(n.TableEnum.FlashGiftTable).getDataById(this._rewardId),e=this._beginTime+60*t.discountTime*1e3;return n.TimeUtil.getTime()<e},t.prototype.isClose=function(){if(!this._rewardId)return!1;var t=n.GetTableClass(n.TableEnum.FlashGiftTable).getDataById(this._rewardId),e=this._beginTime+60*t.validTime*60*1e3;return n.TimeUtil.getTime()>e},t.prototype.requestInfo=function(){var t={};t.module=n.MsgModuleName.ExtensionCmd,t.cmd=n.MsgCmd.ExtensionCmd.GET_FLASH_GIFT_INFO,n.ServerDelegate.sendMessage(t)},t.prototype.receiveInfo=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.flashGiftList[0];void 0!==i.rewardState&&(this._status=parseInt(i.rewardState)),void 0!==i.id&&(this._rewardId=i.id),void 0!==i.beginTime&&(this._beginTime=i.beginTime,(0===this._beginTime||this.isClose())&&(this._status=0)),3!==this._status&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_GET_FLASH_GIFT_INFO)}},t.prototype.requestReward=function(){var t={};t.module=n.MsgModuleName.ExtensionCmd,t.cmd=n.MsgCmd.ExtensionCmd.FLASH_GIFT_REWARD_RECEIVE,t.configId=this._rewardId,n.ServerDelegate.sendMessage(t)},t.prototype.receiveReward=function(t,e){if(t===n.NetCode.SUCCESS){var i=n.RewardManager.parseRewardResult(e.rewardResult);n.GlobalFunction.showRewards(i),n.EventUtil.dispatchEvent(n.EventNameEnum.RES_FLASH_GIFT_REWARD_RECEIVE)}},t}();i.default=a,cc._RF.pop()},{}],FortuneCatBuyWindow:[function(t,e,i){"use strict";cc._RF.push(e,"998a6njhupDkYPe80HFhff2","FortuneCatBuyWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemName=null,e.img_icon=null,e.progressBar=null,e.sliderBar=null,e.lab_vigor=null,e.operateCountLabel=null,e._operateNum=0,e._limitNum=0,e._value=0,e._pricel=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.None,this._panelEnum=r.PanelEnum.Window_FortuneCatBuy},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.sliderBar.node.on("slide",this.onSliderChange,this)},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this._itemData=null},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._itemData=e.item,this._limitNum=e.max,this._pricel=e.price,this._productId=e.productId,this._operateNum=1,this._refreshBaseInfo(),this._updateProgress()},e.prototype._refreshBaseInfo=function(){var t=this._itemData;this.itemName.getComponent(cc.Label).string=t.getName(),r.GlobalFunction.setNameColors(this.itemName,t.getQuality());var e=this.node.getChildByName("itemIcon");e?e.getComponent("CommonIconWidget").setData(t):((e=r.GlobalFunction.createCommonIconWidget(26,t)).name="itemIcon",this.node.addChild(e),e.position=cc.v2(-205,205),e.getComponent("CommonIconWidget").disableHeadTouch())},e.prototype._updateProgress=function(){this._value=this._pricel*this._operateNum,this.operateCountLabel.string=cc.js.formatStr("%s/%s",this._operateNum,this._limitNum),this.lab_vigor.string=this._value+"",r.ItemManager.getItemNumById(r.ItemEnum.FortuneCatTicket)>=this._value?this.lab_vigor.node.color=cc.color(103,111,163):this.lab_vigor.node.color=cc.color(251,6,6);var t=this._operateNum/this._limitNum;this.progressBar.progress=t,this.sliderBar.progress=t},e.prototype.onSliderChange=function(t){var e=t.progress;this._operateNum=Math.floor(this._limitNum*e),this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onOperateNum=function(t,e){e=parseInt(e),this._operateNum+=e,this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onBtn=function(){if(r.ItemManager.getItemNumById(r.ItemEnum.FortuneCatTicket)>=this._value){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_61);if(!t)return;var e={};e.id=this._productId,e.parmeterMap={15:2,6:this._operateNum},t.operateActivity(e),this.closeCallFunc()}else{var i=new r.BroadcastContent(328);r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,i)}},a([l(cc.Node)],e.prototype,"itemName",void 0),a([l(cc.Node)],e.prototype,"img_icon",void 0),a([l(cc.ProgressBar)],e.prototype,"progressBar",void 0),a([l(cc.Slider)],e.prototype,"sliderBar",void 0),a([l(cc.Label)],e.prototype,"lab_vigor",void 0),a([l(cc.Label)],e.prototype,"operateCountLabel",void 0),e=a([s],e)}(t("PanelBase"));i.default=c,cc._RF.pop()},{PanelBase:void 0}],FortuneCatController:[function(t,e,i){"use strict";cc._RF.push(e,"fae02k1tjFNL5dKbnQTmd3m","FortuneCatController");var n=t("ActivityBaseController"),a=t("BaseUser"),r=cc.Class({extends:a,properties:{_count:null},init:function(t){this._super("LuckyErnieMsg",t.attributes),this._count=t.count},getCount:function(){return this._count}}),o=cc.Class({extends:n,properties:{_data:null,_curRecharge:null,_converted:null,_lastResult:null,_totalTimes:null,_curtimes:null,_chargeMaxTimes:null,_freeTimes:null,_isJump:null,_luckMsgList:null},initData:function(t){this._super(t)},onJumpToRecharge:function(){this._isJump=!0},isFromRecharge:function(){var t=this._isJump;return this._isJump=!1,t},getData:function(){return this._data},getCurRecharge:function(){return this._curRecharge},getTotalTimes:function(){return this._totalTimes},getConverted:function(){return this._converted},getLastResult:function(){return this._lastResult},activityParse:function(t){var e=(c=t.record).recharge;this._curRecharge=c.recharge,this._converted=c.converted;var i=c.times;this._curtimes=i;var n=td.GetTableClass(td.TableEnum.FortuneCatTable).getDatasById(this._activityData);for(var a in this._data=null,n&&n[i+1]?(this._data=new td.LuckyErnieModel,this._data.init(n[i+1]),this._data.setCurRecharge(e),this._totalTimes=td.GetTableClass(td.TableEnum.FortuneCatTable).getTotalTimesByRecharge(this._activityData,e)):(this._data=new td.LuckyErnieModel,this._data.init(n[i]),this._data.setCurRecharge(e),this._totalTimes=td.GetTableClass(td.TableEnum.FortuneCatTable).getTotalTimesByRecharge(this._activityData,e)),this._chargeMaxTimes=0,this._freeTimes=0,n)n[a].recharge>0?this._chargeMaxTimes++:this._freeTimes++;var o=t.global;if(this._luckMsgList=[],o&&o.recordList){for(var s=o.recordList,l=s.length-1;l>=0&&!(this._luckMsgList.length>=3);l--){var c=s[l],u=new r;u.init(c),this._luckMsgList[this._luckMsgList.length]=u}td.EventUtil.dispatchEvent(td.EventNameEnum.FORTUNECAT_RECORD_MSG_UPDATED)}td.EventUtil.dispatchEvent(td.EventNameEnum.FORTUNECAT_RECORD_UPDATED)},getLuckMsgList:function(){return this._luckMsgList},getFreeTimes:function(){return this._freeTimes},getChargeMaxTimes:function(){return this._chargeMaxTimes},isReachMaxTimes:function(){return this._freeTimes+this._chargeMaxTimes===this._curtimes},getCurTimes:function(){return this._curtimes},getLeftTimes:function(){return this._totalTimes-this._curtimes},parseRewardReceived:function(t){if(t.activityId===this.getActivityId()){for(var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e),n=0,a=0,r=i.length-1;a<=r;a++){var o=i[a];if(o.type===td.GoodsType.Type_Item&&parseInt(o.id)===td.ItemEnum.FortuneCatTicket){n=o.count;break}}this._lastResult=n,td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_FORTUNECAT_PANEL,{rewardNum:n,rewards:i})}},setShowBuyGiftRed:function(){td.GlobalFunction.getLocalSaveStatus("FortuneCat")||(td.GlobalFunction.setLocalSaveStatus("FortuneCat","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.CARNIVAL_GIFT_SHOWN))},setShowShopRed:function(){td.GlobalFunction.getLocalSaveStatus("FortuneCatShop")||(td.GlobalFunction.setLocalSaveStatus("FortuneCatShop","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.CARNIVAL_GIFT_SHOWN))},hasRedPoint:function(){return!0},redPointEvts:function(){return[td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.CARNIVAL_GIFT_SHOWN,td.EventNameEnum.Res_GET_TASK_INFO]},redPointTip:function(){return this.isRedPointTip()},isRedPointTip:function(){if(this.isTaskRedPoint())return!0;if(this.isShopRedPoint())return!0;if(td.GlobalFunction.getLocalSaveStatus("FortuneCat"))return!1;if(this.getLeftTimes()<=0)return!1;var t=this._data.getCost(),e=td.ItemManager.getItemNumById(td.ItemEnum.FortuneCatTicket);return!(t.getCount()>e)},isTaskRedPoint:function(){for(var t=td.TaskManager.getShowListByType(td.TaskType.FORTUNE_CAT,[]),e=0;e<t.length;e++)if(t[e].getStatus()===td.TaskStatus.Finish)return!0;return!1},isShopRedPoint:function(){if(td.GlobalFunction.getLocalSaveStatus("FortuneCatShop"))return!1;var t=td.ItemManager.getItemNumById(td.ItemEnum.FortuneCatTicket),e=this.getActivityData(),i=td.GetTableClass(td.TableEnum.FortuneCatShopTable).getDatasById(e);for(var n in i){if(t>=td.RewardManager.parseRewardListDetail(i[n].costs)[0].getCount())return!0}return!1}});e.exports=o,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",BaseUser:"BaseUser"}],FortuneCatPanel:[function(t,e,i){"use strict";cc._RF.push(e,"7fa60wGiwxJu4w25da3Uvji","FortuneCatPanel");var n=t("../../../../Common/Chat/Enum/ChatEnum"),a=t("ActivityBasePanel"),r=t("LuckyErnieScrollWidget"),o=cc.Class({extends:a,properties:{lableTime:cc.Label,lableGetMax:cc.Label,labelCost:cc.Label,leftTimes:cc.Label,costNode:cc.Node,lableTips:cc.Label,numNode:cc.Node,labnum:cc.Label,btnStart:cc.Node,richTips:cc.RichText,luckMsgLayer:cc.Node,btn_get:cc.Node,btn_exchange:cc.Node,_timeId:null,_isCloseTask:!0},initData:function(t){this._super(t)},onEnable:function(){this._super(),this._setActivityTime(),this._addLocalListeners(),this._initUI(),this._resetScorll(),this._controller.setShowBuyGiftRed(),td.RedPointUtil.createRedPointOld(this.btn_get,cc.v2(-15,-15),this._controller.isTaskRedPoint.bind(this._controller),this._controller.redPointEvts()),td.RedPointUtil.createRedPointOld(this.btn_exchange,cc.v2(-15,-15),this._controller.isShopRedPoint.bind(this._controller),this._controller.redPointEvts()),this._controller.isFromRecharge()&&this.onBtnGet()},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_CHAT_DELAY,n.ChatLocation.CENTER),this._showReward(),this._timeId>0&&(clearTimeout(this._timeId),this._timeId=null)},_addLocalListeners:function(){var t={},e=td.EventNameEnum;t[e.REFRESH_FORTUNECAT_PANEL]=this._scrollErnie,t[e.FORTUNECAT_RECORD_MSG_UPDATED]=this._refreshLuckMsg,t[e.CLOSE_FORTUNECAT_TASK_PANEL]=this._changeParamStatue,t[e.Res_GET_TASK_INFO]=this._setlabnum,td.EventUtil.registerEvents(t,this)},_setActivityTime:function(){var t=this.getDurationStr();this.lableTime.string=t},_showReward:function(){this._rewardList&&td.GlobalFunction.showRewards(this._rewardList),this._rewardList=null},_resetScorll:function(){for(var t=0;t<4;t++){this.numNode.getChildByName("item_"+(t+1)).getComponent(r).resetScroll()}},_initUI:function(){var t=this._controller.getData();if(this.leftTimes.string=cc.js.formatStr(td.Language.FortuneCatTitle,this._controller.getCurTimes()+1),this._controller.isReachMaxTimes())this.lableTips.node.active=!0,this.costNode.active=!1,td.GlobalFunction.setButtonGray(this.btnStart,!0);else{this.lableTips.node.active=!1,this.costNode.active=!0;var e=t.getReward();this.lableGetMax.string=e.getCount();var i=t.getCost();this.labelCost.string=i.getCount(),td.GlobalFunction.setButtonGray(this.btnStart,!1)}this.richTips.string=td.Language.FortuneCatRule||"",this._setlabnum(),this._refreshLuckMsg()},_setlabnum:function(){var t=td.ItemManager.getItemNumById(td.ItemEnum.FortuneCatTicket);this.labnum.string=t+""},_refreshLuckMsg:function(){for(var t=this._controller.getLuckMsgList(),e=t.length;;e++){if(!(n=this.luckMsgLayer.getChildByName("luckMsg"+e)))break;n.active=!1}for(e=t.length-1;e>=0;e--){var i=t[e],n=this.luckMsgLayer.getChildByName("luckMsg"+(t.length-e)),a=cc.js.formatStr(td.Language.FortuneCatMsg,i.nickName,i.getCount()),r=n.getComponent(td.UFRichText);r||(r=n.addComponent(td.UFRichText)),r.init(a,{quality:4}),n.active=!0}},onBtnStart:function(){if(td.GlobalFunction.checkCanClicked()&&!this._rewardList){var t=this._controller.getData(),e=t.getCost();if(this._controller.getLeftTimes()<=0){if(this._controller.isReachMaxTimes())r=new td.BroadcastContent(325);else{r=new td.BroadcastContent(307);var i=t.getRechargeLimit(),n=t.getCurRecharge();r.setMainParam([new td.BroadcastParam((i-n)/10)]),r.setOkCallFunc(function(){td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityConfig,td.ActivityEnum.ActivityType.ACTIVITY_TYPE_61])})}r&&td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,r)}else{var a=td.ItemManager.getItemNumById(td.ItemEnum.FortuneCatTicket);if(e.getCount()>a){var r=new td.BroadcastContent(326);return td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,r),void this.onBtnGet()}td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSE_UPDATE_MAIN_LAYER_DIAMOND);var o={parmeterMap:{15:1}};this._controller.operateActivity(o)}}},_scrollErnie:function(t){if(this._setlabnum(),this._isCloseTask){var e=t.rewardNum,i=t.rewards;if(!(e<=0)){this._rewardList=i,td.EventUtil.dispatchEvent(td.EventNameEnum.UPDATE_DIAMOND_DIFF,0),this._resetScorll();for(var a=String(e),o=0;o<a.length;o++){this.numNode.getChildByName("item_"+(o+1)).getComponent(r).startScroll(1+1*o,a[a.length-o-1])}var s=400*(a.length+1);this._timeId=setTimeout(function(){this._initUI(),this._showReward(),td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_UPDATE_MAIN_LAYER_DIAMOND),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_CHAT_DELAY,n.ChatLocation.CENTER)}.bind(this),s+1e3)}}},_changeParamStatue:function(){this._isCloseTask=!0},onReceiveOperation:function(t){t.activityId===this._activityId&&this._controller.parseRewardReceived(t)},onBtnExchange:function(){this._controller.setShowShopRed(),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_FortuneCatShop)},onBtnGet:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_FortuneCatTask),this._isCloseTask=!1}});e.exports=o,cc._RF.pop()},{"../../../../Common/Chat/Enum/ChatEnum":void 0,ActivityBasePanel:"ActivityBasePanel",LuckyErnieScrollWidget:"LuckyErnieScrollWidget"}],FortuneCatShopItem:[function(t,e,i){"use strict";cc._RF.push(e,"e5efbjwTNFKrIO63rY1hO7x","FortuneCatShopItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=t("CommonIconWidget"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labCost=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=r.RewardManager.parseRewardListDetail(i.rewards)[0],a=this.node.getChildByName("icon");a?a.getComponent(u).setData(n):((a=r.GlobalFunction.createCommonIconWidget(27,n)).name="icon",a.parent=this.node,a.position=cc.v2(-67,13),a.getComponent(u).setNameBgVisible(!1));var o=r.RewardManager.parseRewardListDetail(i.costs)[0];this.labCost.string=o.getCount(),this._item=n,this._cost=o.getCount(),this._id=i.id},e.prototype.onReward=function(){var t=r.ItemManager.getItemNumById(r.ItemEnum.FortuneCatTicket);if(t>=this._cost){var e=Math.floor(t/this._cost);if(e>1){var i={};i.item=this._item,i.max=e,i.price=this._cost,i.productId=this._id,r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_FortuneCatBuy,i)}else{var n=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_61);if(!n)return;var a={};a.id=this._id,a.parmeterMap={15:2,6:1},n.operateActivity(a)}}else{var o=new r.BroadcastContent(328);r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,o)}},a([c(cc.Label)],e.prototype,"labCost",void 0),e=a([l],e)}(o);i.default=d,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],FortuneCatShopTable:[function(t,e,i){"use strict";cc._RF.push(e,"855b5yEwCNPGouHBHEGP9Od","FortuneCatShopTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityFortuneCatBuyConfig",properties:{_tblName:"activity_fortune_cat_buy_config",_datas:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]||(t[a.data]={}),t[a.data][a.id]=a}},getDatasById:function(t){return this._data&&this._data[t]?this._data[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FortuneCatShopWindow:[function(t,e,i){"use strict";cc._RF.push(e,"33646RJ1UdAOoN8zPMdRqZv","FortuneCatShopWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=t("PanelBase"),u=t("OptimizeVerticalListView"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.num=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_FortuneCatShop},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.FORTUNECAT_RECORD_UPDATED]=this._refreshList,t[e.REFRESH_FORTUNECAT_PANEL]=this._showReward,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(){t.prototype.setData.call(this),this._refreshList()},e.prototype._refreshList=function(){var t=[],e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_61);if(e){var i=e.getActivityData(),n=r.GetTableClass(r.TableEnum.FortuneCatShopTable).getDatasById(i);for(var a in n)t.push(n[a]);this.node.getComponent(u).refreshListData(t.sort(this._sortFunc));var o=r.ItemManager.getItemNumById(r.ItemEnum.FortuneCatTicket);this.num.string=o+""}},e.prototype._showReward=function(t){var e=t.rewards;e&&r.GlobalFunction.showRewards(e)},e.prototype._sortFunc=function(t,e){return t.sortRank-e.sortRank},a([l(cc.Label)],e.prototype,"num",void 0),e=a([s],e)}(c);i.default=d,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],FortuneCatTable:[function(t,e,i){"use strict";cc._RF.push(e,"21330gZmJhO0po8zL61E2Dd","FortuneCatTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityFortuneCatConfig",properties:{_tblName:"activity_fortune_cat_config",_datas:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]||(t[a.data]={}),t[a.data][a.times]=a}},getDatasById:function(t){return this._data&&this._data[t]?this._data[t]:null},getTotalTimesByRecharge:function(t,e){var i=0,n=this._data[t];if(n){for(var a in n)n[a].recharge<=e&&(i+=1);return i}},getCost:function(t,e){var i=this._data[t];if(!i)return 9999999999;for(var n in i)if(i[n].times==e)return i[n].cost;return 9999999999}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FortuneCatTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"4c766ws2TlPGYBLRgwcTDyy","FortuneCatTaskItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labDesc=null,e.labProTitle=null,e.labProgress=null,e.labNum=null,e.btnGoto=null,e.btnGet=null,e.imgGot=null,e.numBg=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n,a,o=r.TaskStatus.NONE;a=i.getDes(),this._gotoPanel=i.getGotoPanel(),this._id=i.getId(),n=i.getRewards()[0][2],o=i.getStatus(),this.labDesc.string=a,this.labNum.string="x"+n,this.numBg.active=n>0,this.labNum.node.active=n>0,this.labProTitle.string=r.Language.progress+":",i.isChargeType()?this.labProgress.string=i.getValue()/10+"/"+i.getNeedValue()/10:this.labProgress.string=i.getValue()+"/"+i.getNeedValue(),this.btnGoto.active=o===r.TaskStatus.Progress,this.btnGet.active=o===r.TaskStatus.Finish,this.imgGot.active=o===r.TaskStatus.Received,this._gotoPanel&&0!==this._gotoPanel.length||(this.btnGoto.active=!1)},e.prototype.onJump=function(){var t=null;this._gotoPanel[1]&&(t=this._gotoPanel[1]);var e=r.PanelManager.getInstance().getCurShowPanel();this._gotoPanel[0]&&r.PanelEnum.Panel_Activity===this._gotoPanel[0]?(e.getComponent("ActivityMainPanel").setData(t),r.ActivityDataManager.setJumpBackData([r.ActivityEnum.Activity.ActivityConfig,r.ActivityEnum.ActivityType.ACTIVITY_TYPE_61])):r.PanelJumpManager.jumpToPanel(this._gotoPanel[0],t);var i=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_61);i&&(i.onJumpToRecharge(),r.EventUtil.dispatchEvent(r.EventNameEnum.CLOSE_FORTUNECAT_TASK))},e.prototype.onReward=function(){if(this._isExchange){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_61);if(!t)return;var e={parmeterMap:{15:2}};t.operateActivity(e)}else r.EventUtil.dispatchEvent(r.EventNameEnum.Req_TASK_RECEIVE,this._id)},a([c(cc.Label)],e.prototype,"labDesc",void 0),a([c(cc.Label)],e.prototype,"labProTitle",void 0),a([c(cc.Label)],e.prototype,"labProgress",void 0),a([c(cc.Label)],e.prototype,"labNum",void 0),a([c(cc.Node)],e.prototype,"btnGoto",void 0),a([c(cc.Node)],e.prototype,"btnGet",void 0),a([c(cc.Node)],e.prototype,"imgGot",void 0),a([c(cc.Node)],e.prototype,"numBg",void 0),e=a([l],e)}(o);i.default=u,cc._RF.pop()},{ListItem:void 0}],FortuneCatTaskWindow:[function(t,e,i){"use strict";cc._RF.push(e,"2abdeRh46NPGK6dSxu77HG9","FortuneCatTaskWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=(o.property,t("PanelBase")),c=t("OptimizeVerticalListView"),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_FortuneCatTask},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.FORTUNECAT_RECORD_UPDATED]=this._refreshList,t[e.Res_GET_TASK_INFO]=this._refreshList,t[e.REFRESH_FORTUNECAT_PANEL]=this._showReward,t[e.CLOSE_FORTUNECAT_TASK]=this.closeCallFunc,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(){t.prototype.setData.call(this),this._refreshList()},e.prototype._refreshList=function(){var t=[],e=r.TaskManager.getShowListByType(r.TaskType.FORTUNE_CAT,[r.TaskStatus.UNOPENED,r.TaskStatus.NONE]);t=t.concat(e.sort(this._sortTaskList)),this.node.getComponent(c).refreshListData(t)},e.prototype._sortTaskList=function(t,e){if(t.getStatus()!=e.getStatus()){if(3===t.getStatus())return-1;if(3===e.getStatus())return 1;if(4===t.getStatus())return 1;if(4===e.getStatus())return-1}return t.getId()-e.getId()},e.prototype._showReward=function(t){var e=t.rewards;e&&r.GlobalFunction.showRewards(e)},e.prototype.closeCallFunc=function(){t.prototype.closeCallFunc.call(this),r.EventUtil.dispatchEvent(r.EventNameEnum.CLOSE_FORTUNECAT_TASK_PANEL)},e=a([s],e)}(l);i.default=u,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],FreezeBuff:[function(t,e,i){"use strict";cc._RF.push(e,"c7468+n0Y1B/LKfgO967It2","FreezeBuff");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_clipName:null,_bShowBuff:null},initData:function(t){if(this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.ReduceSpeed,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff){var e=this.node.getChildByName("buffNode");if(!e){var i=gdk.rm.getResByUrl("fightRes/pve/buff/buffPrefab",cc.Prefab);e=cc.instantiate(i),this.node.addChild(e),e.y=-20,e.name="buffNode"}this._buffAnimation=e.getComponent(cc.Animation),this._clipName="freezeAnimation"}},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._super(),this._curSpeedMult=a.getCurFightSpeedMult(),this._bShowBuff&&(this.refreshSkillAnimationSpeed(this._curSpeedMult),this._buffAnimation.play(this._clipName)),this.setTargetBuffData(!0),this.schedule(this.onUpdateFreezeBuff,1/60)):this.removeSelf()},onDisable:function(){this._super(),this.unschedule(this.onUpdateFreezeBuff)},onChangeSpeedMult:function(t){this._super(t),this._bShowBuff&&this.refreshSkillAnimationSpeed(t)},refreshSkillAnimationSpeed:function(t){for(var e=this._buffAnimation,i=e.getClips(),n=0,a=i.length;n<a;n++){if(i[n])e.getAnimationState(i[n].name).speed=t}},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=i.getDataModel(),a=(t?-1:1)*n.getMoveSpeed()*this._curBuffData.buffData;i.setCurSpeedChange(a)},onUpdateFreezeBuff:function(t){if(!this._bFightPause){if(this._deltaTime+=t,this._curBuffData.buffTime<=0)return this.unschedule(this.onUpdateFreezeBuff),this.setTargetBuffData(!1),void this.endBuff();this._curBuffData.buffTime-=t*this._curSpeedMult}},endBuff:function(){(this._super(),cc.isValid(this._curTarget))&&this._curTarget.getComponent("EnemyBuffCtrlComponent").removeBuffFromList(this._buffType,this._curBuffKey)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],FriendManager:[function(t,e,i){"use strict";cc._RF.push(e,"a7d9fDVoDlHj67gBdZ2JqsJ","FriendManager"),td.FriendManager={_receiveTimes:null,_presentEnergyMap:null,_friendList:null,_applyList:null,_blackList:null,_friendSendEnergyList:null,_recommendFriendList:null,_findFriendList:null,_recommendPageNum:null,_requestedActorId:null,_isBalckRecovery:null,_canPrivateChat:null,_operateIndex:0,_isShowTips:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._friendList=[],this._presentEnergyMap=[],this._applyList=[],this._blackList={},this._friendSendEnergyList=[],this._isShowTips=!1},_addListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.FRIEND,i=td.MsgCmd.FRIEND;t.registerMessage(e,i.GET_FRIEND_INFO,this._resGetFriendInfo.bind(this)),t.registerMessage(e,i.SYSTEM_RECOMMEND,this._resGetRecommendFriendList.bind(this)),t.registerMessage(e,i.ADD_FRIEND,this._resAddFriend.bind(this)),t.registerMessage(e,i.MANUAL_FIND,this._resManuFind.bind(this)),t.registerMessage(e,i.AGREE_IGNORE,this._resAgreeIgnore.bind(this)),t.registerMessage(e,i.DELETE_FRIEND,this._resDelFriend.bind(this)),t.registerMessage(e,i.SEND_ENERGY,this._resPresentEnergy.bind(this)),t.registerMessage(e,i.QUICK_SEND_ENERGY,this._resQuickPresentEnergy.bind(this)),t.registerMessage(e,i.RECEIVE_ENERGY,this._resReceiveEnergy.bind(this)),t.registerMessage(e,i.QUICK_RECEIVE_ENERGY,this._resQuickReceiveEnergy.bind(this)),t.registerMessage(e,i.BLACK_LIST_PROCESS,this._resBlackList.bind(this)),t.registerMessage(e,i.GET_FRIEND_ATTRIBUTE,this._resAttribute.bind(this)),t.registerMessage(e,i.PUSH_FRIEND_INFO,this._pushGetFriendInfo.bind(this)),t.registerMessage(e,i.PUSH_FRIEND_DELETE,this._resDelFriend.bind(this)),t.registerMessage(e,i.PUSH_APPLY_DELETE,this._resAgreeIgnore.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.req_get_friend_info]=this._reqGetFriendInfo,i[e.req_get_recommend_friend_list]=this._reqGetRecommendFriendList,i[e.reqAddFriend]=this._reqAddFriend,i[e.reqManuFind]=this._reqManuFind,i[e.reqAgreeIgnore]=this._reqAgreeIgnore,i[e.reqDelFriend]=this._reqDelFriend,i[e.reqPresentEnergy]=this._reqPresentEnergy,i[e.reqQuickPresentEnergy]=this._reqQuickPresentEnergy,i[e.reqReceiveEnergy]=this._reqQuickPresentEnergy,i[e.reqReceiveEnergy]=this._reqReceiveEnergy,i[e.reqQuickReceiveEnergy]=this._reqQuickReceiveEnergy,i[e.REQ_BLACK_LIST_PROCESS]=this._reqBlackList,i[e.REQ_GET_FRIEND_ATTRIBUTE]=this._reqAttribute,i[e.REQ_FRIEND_FIGHT]=this._reqFriendFight,t.registerEvents(i,this)},canPrivateChat:function(){if(!this._canPrivateChat){var t=td.GetTableClass(td.TableEnum.ContactConfig).getContactInfo();this._canPrivateChat=!t||"0"!=t.privateChat}return this._canPrivateChat},isHasApplyList:function(){return!!(this._applyList&&this._applyList.length>0)},isEnergyCanRecive:function(){if(0===td.FriendManager.getLeftReceiveTimes())return!1;var t=!1;if(this._friendSendEnergyList&&this._friendSendEnergyList.length>0){for(var e=0;e<this._friendSendEnergyList.length;e++){t:for(var i=0;i<this._friendList.length;i++)if(this._friendList[i].getGamerId()===this._friendSendEnergyList[e]){t=!0;break t}if(!t)return!1}return!0}return!1},showRedPoint:function(){return!!this.isHasApplyList()||!!this.isEnergyCanRecive()},redPointEvebts:function(){return[td.EventNameEnum.resReceiveEnergy,td.EventNameEnum.resAgreeIgnore,td.EventNameEnum.res_get_friend_info]},canPresentEnergy:function(){if(!this._friendList)return!1;for(var t=0;t<this._friendList.length;t++){var e=this._friendList[t].getGamerId();if(!this._presentEnergyMap[e])return!0}return!1},canReceiveEnergy:function(t){if(!this._friendSendEnergyList||0===this._friendSendEnergyList.length){if(t){var e=new td.BroadcastContent(236);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e)}return!1}if(this.getLeftReceiveTimes()<0){if(t){e=new td.BroadcastContent(237);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e)}return!1}return!0},getFriendNum:function(){return this._friendList?this._friendList.length:0},getMaxFriendNum:function(){return td.GetConfig("FRIENDS_NUMBER_LIMIT")},getLeftReceiveTimes:function(){return td.GetConfig("FRIENDS_RECEIVE_ENERGY_TIMES")-this._receiveTimes},getReceiveTimes:function(){return this._receiveTimes||0},getFriendModel:function(t){return this._getFriendModel(t,this._friendList)},getFriendFindModel:function(t){return this._getFriendModel(t,this._findFriendList)},getFriendList:function(){return this._friendList||[]},getApplyList:function(){return this._applyList||[]},getPresentEnergyMap:function(){return this._presentEnergyMap},getBlackList:function(){return this._blackList||{}},isInBlacckList:function(t){return!!this._blackList[t]},getFriendSendEnergyList:function(){for(var t=[],e=0;e<this._friendSendEnergyList.length;e++)t:for(var i=0;i<this._friendList.length;i++)if(this._friendList[i].getGamerId()===this._friendSendEnergyList[e]){var n=this.getFriendModel(this._friendSendEnergyList[e],this._friendList);t.push(n);break t}return t},getRecommendList:function(t){if(!this._recommendFriendList)return null;for(var e=0;e<this._recommendFriendList.length;e++){this._recommendFriendList[e].isRequested()&&(this._recommendFriendList.splice(e,1),e--)}var i=this._recommendFriendList.length;this._recommendPageNum||(this._recommendPageNum=td.GetConfig("FriendRecPageNum"));var n=t*this._recommendPageNum,a=(t+1)*this._recommendPageNum;n>=i&&(n=0,t=0,a=this._recommendPageNum);return{data:a>=i?this._recommendFriendList.slice(n):this._recommendFriendList.slice(n,a),index:t}},getFindFriendList:function(){return this._findFriendList||[]},_reqGetFriendInfo:function(){if(td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Friend,!1)){var t={};t.module=td.MsgModuleName.FRIEND,t.cmd=td.MsgCmd.FRIEND.GET_FRIEND_INFO,td.ServerDelegate.sendMessage(t)}},_resGetFriendInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._receiveTimes=e.receiveTimes;var i=e.friendAttributeList,n=e.sendEnergyIdList,a=e.applyAttributeList,r=e.receiveEnergyIdList,o=e.blackListMap;if(o&&(this._blackList=o),i){this._friendList=[];for(var s=0,l=i.length;s<l;s++){var c=i[s].attributes[td.UserPropertyEnum.GamerId];if(!this._blackList[c])(h=new td.FriendModel).init(i[s]),this._friendList.push(h)}this._friendList.sort(function(t,e){return t.isOnline()&&!e.isOnline()?-1:e.isOnline()&&!t.isOnline()?1:e.getLastLogoutTime()-t.getLastLogoutTime()})}if(n){this._presentEnergyMap=[];for(var u=0;u<n.length;u++){var d=n[u];this._blackList[d]||this._presentEnergyMap.push(n[u])}}if(a){this._applyList=[];for(s=0,l=a.length;s<l;s++){var h,p=a[s].attributes[td.UserPropertyEnum.GamerId];if(!this._blackList[p])(h=new td.FriendModel).init(a[s]),this._applyList.push(h)}for(var _=td.GetConfig("FRIENDS_NUMBER_LIMIT"),g=this._applyList.length-_;g>0;g--)this._applyList.shift()}if(r){this._friendSendEnergyList=[];for(var f=0;f<r.length;f++){var v=r[f];this._blackList[v]||this._friendSendEnergyList.push(r[f])}}td.EventUtil.dispatchEvent(td.EventNameEnum.res_get_friend_info)}},_pushGetFriendInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._receiveTimes=e.receiveTimes;var i=e.friendAttributeList,n=e.sendEnergyIdList,a=e.applyAttributeList,r=e.receiveEnergyIdList,o=e.blackListMap;if(o&&(this._blackList=o),i){for(var s=0,l=i.length;s<l;s++){var c=i[s].attributes[td.UserPropertyEnum.GamerId];if(!this._blackList[c]){var u=!1;t:for(var d=0;d<this._friendList.length;d++)if(this._friendList[d].getGamerId()===c){u=!0,this._friendList[d].init(i[s]);break t}if(!u)(g=new td.FriendModel).init(i[s]),this._friendList.push(g)}}this._friendList.sort(function(t,e){return t.isOnline()&&!e.isOnline()?-1:e.isOnline()&&!t.isOnline()?1:e.getLastLogoutTime()-t.getLastLogoutTime()})}if(n){this._presentEnergyMap=[];for(var h=0;h<n.length;h++){var p=n[h];this._blackList[p]||this._presentEnergyMap.push(n[h])}}if(a){for(s=0,l=a.length;s<l;s++){var _=a[s].attributes[td.UserPropertyEnum.GamerId];if(!this._blackList[_]){var g,f=!1;t:for(var v=0;v<this._applyList.length;v++)if(this._applyList[v].getGamerId()===_){f=!0,this._applyList[v].init(a[s]);break t}if(!f)(g=new td.FriendModel).init(a[s]),this._applyList.push(g)}}for(var m=td.GetConfig("FRIENDS_NUMBER_LIMIT"),y=this._applyList.length-m;y>0;y--)this._applyList.shift()}if(r){this._friendSendEnergyList=[];for(var E=0;E<r.length;E++){var T=r[E];this._blackList[T]||this._friendSendEnergyList.push(r[E])}}td.EventUtil.dispatchEvent(td.EventNameEnum.res_get_friend_info)}},_reqGetRecommendFriendList:function(){var t={};t.module=td.MsgModuleName.FRIEND,t.cmd=td.MsgCmd.FRIEND.SYSTEM_RECOMMEND,td.ServerDelegate.sendMessage(t)},_resGetRecommendFriendList:function(t,e){if(t===td.NetCode.SUCCESS){this._recommendFriendList=[];var i=e.recommendVOList;if(i)for(var n=0,a=i.length;n<a;n++){var r=i[n].attributes[td.UserPropertyEnum.GamerId];if(!this._blackList[r]){var o=new td.FriendModel;o.init(i[n]),this._recommendFriendList.push(o)}}td.EventUtil.dispatchEvent(td.EventNameEnum.res_get_recommend_friend_list)}},_reqAddFriend:function(t){var e={};e.module=td.MsgModuleName.FRIEND,e.cmd=td.MsgCmd.FRIEND.ADD_FRIEND,e.targetId=t.targetId,e.serverId=t.serverId,this._requestedActorId=t.targetId,td.ServerDelegate.sendMessage(e)},_resAddFriend:function(t,e){t===td.NetCode.SUCCESS&&(this._setRequested(),td.EventUtil.dispatchEvent(td.EventNameEnum.resAddFriend))},_reqManuFind:function(t){var e={};e.module=td.MsgModuleName.FRIEND,e.cmd=td.MsgCmd.FRIEND.MANUAL_FIND,e.actorName=t,td.ServerDelegate.sendMessage(e)},_resManuFind:function(t,e){if(t===td.NetCode.SUCCESS){this._findFriendList=[];var i=e.recommendVOList;if(i)for(var n=0,a=i.length;n<a;n++){var r=i[n].attributes[td.UserPropertyEnum.GamerId];if(!this._blackList[r]){var o=new td.FriendModel;o.init(i[n]),this._findFriendList.push(o)}}this._findFriendList.sort(function(t,e){return t.level!=e.level?e.level-t.level:e.fightPower-t.fightPower}),td.EventUtil.dispatchEvent(td.EventNameEnum.resManuFind)}},_reqAgreeIgnore:function(t){var e={};e.module=td.MsgModuleName.FRIEND,e.cmd=td.MsgCmd.FRIEND.AGREE_IGNORE,e.targetId=t.targetId,e.isAdd=t.isAdd,e.serverId=t.serverId,td.ServerDelegate.sendMessage(e)},_resAgreeIgnore:function(t,e){if(t===td.NetCode.SUCCESS&&e){for(var i=e.id,n=0;n<this._applyList.length;n++)if(this._applyList[n].getGamerId()===i){this._applyList.splice(n,1);break}td.EventUtil.dispatchEvent(td.EventNameEnum.resAgreeIgnore)}},_reqDelFriend:function(t){var e={};e.module=td.MsgModuleName.FRIEND,e.cmd=td.MsgCmd.FRIEND.DELETE_FRIEND,e.targetId=t,td.ServerDelegate.sendMessage(e)},ShowDeleteTips:function(){this._isShowTips=!0},_resDelFriend:function(t,e){if(t===td.NetCode.SUCCESS&&e){for(var i=e.id,n=0;n<this._friendList.length;n++)if(this._friendList[n].getGamerId()===i){if(!0===this._isShowTips&&td.Account.getUserData().getGamerId()!==i){var a=new td.BroadcastContent(266),r=new td.BroadcastParam(this._friendList[n].getTrueName());a.setMainParam([r]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a),this._isShowTips=!1}this._friendList.splice(n,1);break}td.EventUtil.dispatchEvent(td.EventNameEnum.resDelFriend),td.EventUtil.dispatchEvent(td.EventNameEnum.req_get_friend_info)}},_reqPresentEnergy:function(t){var e={};e.module=td.MsgModuleName.FRIEND,e.cmd=td.MsgCmd.FRIEND.SEND_ENERGY,e.targetId=t,td.ServerDelegate.sendMessage(e)},_resPresentEnergy:function(t,e){if(t===td.NetCode.SUCCESS){var i=new td.BroadcastContent(251);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i),td.EventUtil.dispatchEvent(td.EventNameEnum.resPresentEnergy)}},_reqQuickPresentEnergy:function(){var t={};t.module=td.MsgModuleName.FRIEND,t.cmd=td.MsgCmd.FRIEND.QUICK_SEND_ENERGY,td.ServerDelegate.sendMessage(t)},_resQuickPresentEnergy:function(t,e){if(t===td.NetCode.SUCCESS){var i=new td.BroadcastContent(253);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i),td.EventUtil.dispatchEvent(td.EventNameEnum.resQuickPresentEnergy)}},_reqReceiveEnergy:function(t){var e={};e.module=td.MsgModuleName.FRIEND,e.cmd=td.MsgCmd.FRIEND.RECEIVE_ENERGY,e.targetId=t,td.ServerDelegate.sendMessage(e)},_resReceiveEnergy:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,n),td.EventUtil.dispatchEvent(td.EventNameEnum.resReceiveEnergy);var a=new td.BroadcastContent(252);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a)}},_reqQuickReceiveEnergy:function(){var t={};t.module=td.MsgModuleName.FRIEND,t.cmd=td.MsgCmd.FRIEND.QUICK_RECEIVE_ENERGY,td.ServerDelegate.sendMessage(t)},_reqBlackList:function(t){var e={};e.module=td.MsgModuleName.FRIEND,e.cmd=td.MsgCmd.FRIEND.BLACK_LIST_PROCESS,e.attribute=t,td.ServerDelegate.sendMessage(e)},_reqAttribute:function(t){var e={};e.module=td.MsgModuleName.FRIEND,e.cmd=td.MsgCmd.FRIEND.GET_FRIEND_ATTRIBUTE,e.targetId=t,td.ServerDelegate.sendMessage(e)},_reqFriendFight:function(t){var e={};e.module=td.MsgModuleName.BATTLE,e.cmd=td.MsgCmd.TBSBattle.BATTLE_COMPETE,e.actorId=t.actorId,e.serverId=t.serverId,td.ServerDelegate.sendMessage(e)},_onGetFriendFight:function(t,e){td.NetCode.SUCCESS},_resQuickReceiveEnergy:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,n),td.EventUtil.dispatchEvent(td.EventNameEnum.resQuickReceiveEnergy);var a=new td.BroadcastContent(254);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a)}},_resBlackList:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.attribute[td.UserPropertyEnum.GamerId];if(this._blackList[i])delete this._blackList[i];else{this._blackList[i]=e.attribute;var n=new td.BroadcastContent(424),a=new td.BroadcastParam(e.attribute.nickName);n.setMainParam([a]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,n)}td.EventUtil.dispatchEvent(td.EventNameEnum.RES_BLACK_LIST_PROCESS),td.EventUtil.dispatchEvent(td.EventNameEnum.req_get_friend_info)}},_resAttribute:function(t,e){td.NetCode.SUCCESS},_getFriendModel:function(t,e){if(e){for(var i=0,n=e.length;i<n;i++)if(e[i].sid===t)return e[i];return null}},_setRequested:function(){var t=this._getFriendModel(this._requestedActorId,this._recommendFriendList);t&&t.setRequested(!0);var e=this._getFriendModel(this._requestedActorId,this._findFriendList);e&&e.setRequested(!0)},getOperateIndex:function(){return this._operateIndex},setOperateIndex:function(t){this._operateIndex=t}},cc._RF.pop()},{}],FriendModel:[function(t,e,i){"use strict";cc._RF.push(e,"20975GvxYlDMKGKkK8i+p9j","FriendModel");var n=t("UserModel");td.FriendModel=cc.Class({extends:n,properties:{_isOnline:null,_lastLogoutTime:null,_isCanHelp:null,_isRequested:null},init:function(t){this._super(t.attributes),this._isOnline=t.isOnline||0,this._lastLogoutTime=td.TimeUtil.convertTimeWithOffset(t.lastLogoutTime||0),this._isCanHelp=t.isCanHelp||!1,this._isRequested=!1},isOnline:function(){return this._isOnline},getLastLogoutTime:function(){return this._lastLogoutTime},getCanHelp:function(){return this._isCanHelp},getOnlineTips:function(){var t="",e=td.TimeUtil.getTime()-this._lastLogoutTime;if(e<0&&(e=0),this._isOnline)t=td.Language.curOnline;else if(e<864e5){var i=Math.floor(e/36e5),n=Math.floor((e-36e5*i)/6e4);t=i>0?cc.js.formatStr("%s",td.Language.offlineTimTips1,i):cc.js.formatStr("%s",td.Language.offlineTimTips,n)}else t=e<6048e5?cc.js.formatStr("%s",td.Language.offlineTimTips2,Math.floor(e/864e5)):td.Language.offlineTimTips3;return t},setRequested:function(t){this._isRequested=t},isRequested:function(){return this._isRequested}}),cc._RF.pop()},{UserModel:"UserModel"}],FuKongShu:[function(t,e,i){"use strict";cc._RF.push(e,"90680BDGEtA/od4lAdkicbv","FuKongShu");var n=t("BaseBossSkill"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="FuKongShu"},effect:function(){if(cc.isValid(this._owner)){var t=a.getEnemyArrayExcept(this._owner),e=Math.abs(this._dataModel.getDamageRange()),i=[];i=e>=t.length?t:td.GlobalFunction.getRandomArrayElements(t,e);for(var n=0;n<i.length;n++){var r=i[n];this.setAttackEffectToEnemy(r)}}else this.removeSelf()}});e.exports=r,cc._RF.pop()},{BaseBossSkill:"BaseBossSkill",PveFightManager:"PveFightManager"}],FunctionPreviewConfig:[function(t,e,i){"use strict";cc._RF.push(e,"bd154ao03JDO6oNofH3XZ9Q","FunctionPreviewConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"FunctionPreviewConfig",properties:{_tblName:"module_lock_reward_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},getModuleLockConfig:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FunctionPreviewManager:[function(t,e,i){"use strict";cc._RF.push(e,"fe506GNvJ9ImL3ma8pU3ORF","FunctionPreviewManager"),td.FunctionPreviewManager={_sysList:null,_sysArray:null,_needShowNewSys:null,_showingNewSystemOpenId:0,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._sysList={},this._sysArray=[],this._needShowNewSys=[]},_addListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.ExtensionCmd,i=td.MsgCmd.ExtensionCmd;t.registerMessage(e,i.MODULE_LOCK_GET_INFO,this._parseUnlockInfo.bind(this)),t.registerMessage(e,i.MODULE_LOCK_RECEIVE_REWARD,this._onGetSysReward.bind(this)),t.registerMessage(e,i.PUSH_MODULE_LOCK_REWARD_INFO,this._parseUnlockInfo.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQUEST_SYS_UNLOCK_INFO]=this._requestSysUnlockInfo,i[e.REQUEST_GET_SYS_REWARD]=this._requestGetSysReward,i[e.CHECK_SHOW_NEW_SYS_OPEN]=this._checkShowNewSysOpen,t.registerEvents(i,this)},getSysOpenList:function(){return this._sysList},getSysOpenArray:function(){return this._sysArray},getShowingNewSystemOpen:function(){return this._showingNewSystemOpenId>0?this._sysList[this._showingNewSystemOpenId]:null},setShowingNewSystemOpenId:function(t){this._showingNewSystemOpenId=t},_requestSysUnlockInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.MODULE_LOCK_GET_INFO,td.ServerDelegate.sendMessage(t)},_parseUnlockInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=!1;this._sysList&&0!==this._sysList.myLen()||(this._initSysList(),i=!0);var n={},a=e.moduleRewardMap,r=null,o=[],s=[];for(var l in a){var c=parseInt(a[l]),u=this._sysList[l];if(u){if(u.getRewardStatus()===td.RewardStatus.CANNOT_RECEIVE&&c===td.RewardStatus.CAN_RECEIVE)if(r=u,s.push(r.getGotoPanel()),!i&&r.isShowOpen())(h=td.UnlockManager.getUnlockConfig(r.getType(),r.getOrderId())).setGoPanel(r.getGotoPanel()),h.setFunctionPreviewID(r.getId()),n[u.getRank()]=h;u.setRewardStatus(c)}}for(var d in n){var h=n[d];this._needShowNewSys[this._needShowNewSys.length]=h,h.getGuideId()>0&&(o[o.length]=h.getGuideId())}o.length>0&&td.GuideManager.saveSysGuideIds(o),td.EventUtil.dispatchEvent(td.EventNameEnum.SYS_UNLOCK_INFO_UPDATE),this._handlerReqSeverData(s)}},_handlerReqSeverData:function(t){for(var e=0;e<t.length;e++){switch(t[e][0]){case td.PanelEnum.Panel_PetMain:td.EventUtil.dispatchEvent(td.EventNameEnum.PET_GET_INFO),td.EventUtil.dispatchEvent(td.EventNameEnum.PET_GET_STATION_INFO);break;case td.PanelEnum.Panel_ChessMain:td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_CHESS_INFO);break;case td.PanelEnum.Panel_AuctionMain:td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_AUCTION_INFO)}}},_requestGetSysReward:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.MODULE_LOCK_RECEIVE_REWARD,e.configId=t,td.ServerDelegate.sendMessage(e)},_onGetSysReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult,!0);td.EventUtil.dispatchEvent(td.EventNameEnum.RES_GET_SYS_REWARD,i),td.EventUtil.dispatchEvent(td.EventNameEnum.SYS_UNLOCK_INFO_UPDATE)}},_initSysList:function(){this._sysList={},this._sysArray=[];var t=td.GetTableClass(td.TableEnum.FunctionPreviewConfig).getModuleLockConfig();for(var e in t){var i=t[e],n=new td.FunctionPreviewModel;n.initData(i),this._sysList[e]=n,this._sysArray[this._sysArray.length]=n}this._sysArray.sort(function(t,e){return t.rank-e.rank})},getShowPreviewData:function(){this._sysArray&&0!==this._sysArray.length||this._initSysList();for(var t=0,e=0,i=this._sysArray.length;e<i;e++){var n=this._sysArray[e];t=e;var a=n.getRewardStatus();if(!td.UnlockManager.isTargetUnlock(n.getType(),n.getOrderId(),!1)||a===td.RewardStatus.CAN_RECEIVE)break}var r=this._sysArray[t].getId();return this._sysList[r]},_checkShowNewSysOpen:function(){if(this._needShowNewSys.length>0){for(var t=this._needShowNewSys[0],e=[],i=1,n=this._needShowNewSys.length;i<n;i++){var a=this._needShowNewSys[i];if(a.getGuideId()>0){var r=a.getGuideId();e[e.length]=r,td.GuideManager.deleteSysOpenGuide(r)}}td.GuideManager._deleteSysOpenGuide(e),this._needShowNewSys=[],td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_NewSystemOpen,t)}else td.EventUtil.dispatchEvent(td.EventNameEnum.CLOSE_NEWSYSTEMOPEN_WINDOW)},hasNewSysOpen:function(){return!!(this._needShowNewSys&&this._needShowNewSys.length>0)},haveRewardCanReceive:function(){if(!this._sysList||0===this._sysList.myLen())return!1;var t=this._sysList;for(var e in t){if(t[e].getRewardStatus()===td.RewardStatus.CAN_RECEIVE)return!0}return!1},isGetAllReward:function(){if(!this._sysList||0===this._sysList.myLen())return!1;var t=this._sysList;for(var e in t){if(t[e].getRewardStatus()!=td.RewardStatus.RECEIVED)return!1}return!0},getNextReceiveData:function(){if(!this._sysList||0===this._sysList.myLen())return null;var t=this._sysList;for(var e in t){var i=t[e];if(i.getRewardStatus()===td.RewardStatus.CANNOT_RECEIVE)return i}for(var n=this._sysArray,a=n.length-1;a>=0;a--)if(t[n[a].id].getRewardStatus()===td.RewardStatus.CAN_RECEIVE)return t[n[a].id];return null},isFunctionRewardRedPointTips:function(t){var e=this._sysList[t];return!!e&&e.getRewardStatus()===td.RewardStatus.CAN_RECEIVE},showRedPoint:function(){var t=this._sysList;for(var e in t){if(t[e].getRewardStatus()==td.RewardStatus.CAN_RECEIVE)return!0}return!1}},cc._RF.pop()},{}],FunctionPreviewModel:[function(t,e,i){"use strict";cc._RF.push(e,"f4226BPCwxCob5EpDFeyFmA","FunctionPreviewModel");t("ActorUnlockModel");td.FunctionPreviewModel=cc.Class({properties:{id:null,type:null,orderId:null,rewards:null,rank:null,showOpen:null,goPanel:null,goPanel2:null,state:null,des:null,actorUnlockModel:null},initData:function(t){this.id=t.id,this.type=t.type,this.orderId=t.orderId,this.rewards=td.RewardManager.parseRewardListDetail(t.rewards),this.rank=t.rank,this.showOpen=t.showOpen,this.goPanel=t.goPanel,this.goPanel2=t.goPanel2,this.des=t.des,this.state=td.RewardStatus.CANNOT_RECEIVE,this.actorUnlockModel=td.UnlockManager.getUnlockConfig(this.type,this.orderId)},getRewardStatus:function(){return this.state},getDes:function(){return this.des},setRewardStatus:function(t){this.state=t},isShowOpen:function(){return this.showOpen},getType:function(){return this.type},getOrderId:function(){return this.orderId},getGotoPanel:function(){return this.goPanel},getId:function(){return this.id},getRank:function(){return this.rank},getUnlockData:function(){return this.actorUnlockModel},getShowRewards:function(){return this.rewards},setGoPanel:function(t){this.getGotoPanel=t}}),cc._RF.pop()},{ActorUnlockModel:"ActorUnlockModel"}],FunctionSecretaryConfig:[function(t,e,i){"use strict";cc._RF.push(e,"5dd51qfHHdJAJBrZ+F+FTUZ","FunctionSecretaryConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"FunctionSecretaryConfig",properties:{_tblName:"function_secretary_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.type;t[r]=t[r]||[],t[r][t[r].length]=a}},getFunctionSeretaryConfigs:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],FundCardController1:[function(t,e,i){"use strict";cc._RF.push(e,"e4739cOWZZPxLjqWDjlm9du","FundCardController1");var n=t("FundCardController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{FundCardController:"FundCardController"}],FundCardController:[function(t,e,i){"use strict";cc._RF.push(e,"c99d3JrUV1P+onEpmD8G4sA","FundCardController");var n=t("ActivityBaseController"),a=t("FundCardModel"),r=cc.Class({extends:n,properties:{_modelList:null,_isBuy:null},initData:function(t){this._super(t),this.clearData(),this._addLocalListeners()},clearData:function(){this._modelList=[],this._isBuy=td.ActivityEnum.FundCardType.NONE},_addLocalListeners:function(){var t=td.EventUtil;td.EventNameEnum;t.registerEvents({},this)},getModelList:function(){return this._modelList},getIsBuy:function(){return this._isBuy},activityParse:function(t){var e=t.record,i=e.statusMap,n=e.day;this._isBuy=parseInt(e.flag),this._modelList=[];for(var r=td.GetTableClass(td.TableEnum.FundCardTable).getDatasOfDataId(this.getActivityData())[0].rewards,o=0;o<r.length;o++){var s=r[o],l=new a;l.initData(s),this._modelList.push(l);var c=td.ActivityEnum.FundCardEnum.NONE;this._isBuy==td.ActivityEnum.FundCardType.IS_Activated?(c=td.ActivityEnum.FundCardEnum.CAN_NOT_Receive,n>=s[0]&&(c=td.ActivityEnum.FundCardEnum.CAN_Receive,i[s[0]]&&2==i[s[0]]&&(c=td.ActivityEnum.FundCardEnum.ALREADY_Receive))):c=td.ActivityEnum.FundCardEnum.NONE,l.setStatus(c)}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_FUND_CARD_INFO)},receiveReward:function(t){if(this.isInOpenStatus()){var e={};e.activityId=this.getActivityId(),e.id=t,this.operateActivity(e)}},hasRedPoint:function(){return!0},redPointTip:function(){for(var t=0,e=this._modelList.length;t<e;t++){if(this._modelList[t].getStatus()===td.ActivityEnum.FundCardEnum.CAN_Receive)return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.REFRESH_FUND_CARD_INFO]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",FundCardModel:"FundCardModel"}],FundCardListItem:[function(t,e,i){"use strict";cc._RF.push(e,"8e72cexuE5K+YjuggNDiotZ","FundCardListItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=(s.property,s.menu,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onEnable=function(){this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListener=function(){var t=r.EventUtil,e=r.EventNameEnum;t.registerEvent(e.ON_HERO_TALENT_SELECT_CHANGE,this._onChangeSelect,this)},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._receiveCallBack=this._customData;var n=this.node.getChildByName("labTitle"),a=this.node.getChildByName("rewardNode"),o=this.node.getChildByName("btnGet"),s=this.node.getChildByName("imgGot"),l=this.node.getChildByName("imgNotActive");o.active=!1,s.active=!1,l.active=!1,n.getComponent(cc.Label).string=cc.js.formatStr(r.Language.dayTitle,i.getId());for(var c=60,u=i.getRewards(),d=0;d<u.length;d++){var h=r.RewardManager.parseRewardListDetail([u[d]])[0],p=r.GlobalFunction.createCommonIconWidget(56,h);p&&(p.setScale(.8),p.setPosition(cc.v2(c,0)),a.addChild(p),c+=120)}var _=i.getStatus();_===r.ActivityEnum.FundCardEnum.ALREADY_Receive?s.active=!0:_===r.ActivityEnum.FundCardEnum.CAN_Receive?o.active=!0:l.active=!0;var g=o.getComponent(cc.Button);g.clickEvents=[];var f=new cc.Component.EventHandler;f.target=this.node,f.component="FundCardListItem",f.handler="onGetReward",f.customEventData=i,g.clickEvents.push(f),r.RedPointUtil.createRedPointSimple(o,{x:-10,y:-10},_===r.ActivityEnum.FundCardEnum.CAN_Receive)},e.prototype.onGetReward=function(t,e){var i=e;this._receiveCallBack&&"function"==typeof this._receiveCallBack&&this._receiveCallBack(i)},e=a([l],e)}(o));i.default=c,cc._RF.pop()},{ListItem:void 0}],FundCardModel:[function(t,e,i){"use strict";cc._RF.push(e,"372275HA4xH3pPqn6Q3u5EC","FundCardModel");var n=cc.Class({properties:{_id:null,_rewards:null,_status:null},initData:function(t,e){this._id=t[0],this._rewards=t[1],this._status=td.ActivityEnum.FundCardEnum.NONE},getId:function(){return this._id},getRewards:function(){return this._rewards},getStatus:function(){return this._status},setStatus:function(t){this._status=t}});e.exports=n,cc._RF.pop()},{}],FundCardPanel:[function(t,e,i){"use strict";cc._RF.push(e,"ed1d8CBwDFKmLr69WT13DYh","FundCardPanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{_RewardListView:null,jijinTypeImg:cc.Node,chargeNum:cc.Node,cardTypeImg:cc.Node},initData:function(t){this._super(t)},onLoad:function(){var t=this.node.getChildByName("scrollView");this._listView=t.getComponent("OptimizeHorizontalListView")},onEnable:function(){this._super(),this._addLocalListeners(),this._initUi()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_addLocalListeners:function(){var t=td.EventUtil,e={};e[td.EventNameEnum.REFRESH_FUND_CARD_INFO]=this._refreshList,t.registerEvents(e,this)},_initUi:function(){var t=this.node.getChildByName("preview").getChildByName("view").getChildByName("content"),e=this.node.getChildByName("labTime"),i=this.node.getChildByName("labMoney");t.removeAllChildren();for(var n=td.GetTableClass(td.TableEnum.FundCardTable).getDatasOfDataId(this._controller.getActivityData()),a=n[0].showRewards,r=70,o=0;o<a.length;o++){var s=a[o],l=td.RewardManager.getRewardDetail(s),c=td.GlobalFunction.createCommonIconWidget(56,l);c.scale=1,c.setPosition(r,0),t.addChild(c),r+=140}t.width=140*a.length,e.getComponent(cc.Label).string=this.getDurationStr(),i.getComponent(cc.Label).string=n[0].value,this.chargeNum.getComponent(cc.Label).string=n[0].charge/10+"",this._controller.getActivityType()===td.ActivityEnum.ActivityType.FundCardWeek?(td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_37_czjj,"HD_zhoujijin",this.jijinTypeImg),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_37_czjj,"HD_wz_jihuo",this.cardTypeImg)):this._controller.getActivityType()===td.ActivityEnum.ActivityType.FundCardMonth&&(td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_37_czjj,"HD_yuejijin",this.jijinTypeImg),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_37_czjj,"HD_wz_jihuo_02",this.cardTypeImg)),this._refreshList()},_refreshList:function(){var t=this.getActivityController();if(t){var e=t.getModelList();e.sort(function(t,e){var i=t.getStatus(),n=e.getStatus(),a=td.ActivityEnum.FundCardEnum;return i===a.CAN_Receive&&n!=a.CAN_Receive?-1:n===a.CAN_Receive&&i!=a.CAN_Receive?1:i===a.CAN_NOT_Receive&&n!=a.CAN_NOT_Receive?-1:n===a.CAN_NOT_Receive&&i!=a.CAN_NOT_Receive?1:i===a.ALREADY_Receive&&n!=a.ALREADY_Receive?-1:n===a.ALREADY_Receive&&i!=a.ALREADY_Receive?1:t.getId()-e.getId()}),this._listView&&(this._listView.setCustomData(this.getReward.bind(this)),this._listView.setData(e));var i=this._controller.getIsBuy(),n=this.node.getChildByName("btnGoto");td.GlobalFunction.setButtonGray(n,i==td.ActivityEnum.FundCardType.IS_Activated),n.getChildByName("Label").getComponent(cc.Label).string=i==td.ActivityEnum.FundCardType.IS_Activated?td.Language.beActive:td.Language.recharge}},getReward:function(t){var e={id:t.getId()};this.getActivityController().operateActivity(e)},gotoRecharge:function(){var t=this.getActivityController();td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityConfig,t.getActivityType()])},scrollLeft:function(){},scrollRight:function(){}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],FundCardTable:[function(t,e,i){"use strict";cc._RF.push(e,"cefdd6//yJMmJ6WobqUSu3W","FundCardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"FundCardTable",properties:{_tblName:"activity_fund_card_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GachaActivityController:[function(t,e,i){"use strict";cc._RF.push(e,"727faaDeA5IZ5aqD67xpffH","GachaActivityController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../../Gacha/Manager/GachaEnum"),r=t("../../../Gacha/Manager/GachaManager"),o=window.td,s=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return n(i,e),i.prototype.initData=function(t){e.prototype.initData.call(this,t),this._currencyId=o.ItemEnum.GachaEquipTicket,this._shopCurrencyId=o.ItemEnum.GachaEquipShopTicket,this._gachaType=a.GachaType.GOD_EQUIPMENT,this._maxMsgLength=o.GetConfig("GOD_EQUIPMENT_LUCK_MESSAGE_LIMIT")},i.prototype.destroyData=function(){e.prototype.destroyData.call(this),this._luckyMsgList=[],this._luckyMsgList2=[],this._maxMsgLength=0},i.prototype.activityParse=function(t){var e=t.record;this._score;this._score=e.score||0,this._score;var i=e.receivedList;if(void 0!==i){for(var n=this._scoreRewardList,a=o.RewardStatus,r=0,s=n.length;r<s;r++){(h=n[r]).getRewardStatus()!==a.RECEIVED&&(ArrayUtils.contains(i,h.getScore())?h.setRewardStatus(a.RECEIVED):this._score>=h.getScore()&&h.setRewardStatus(a.CAN_RECEIVE))}n.sort(function(t,e){return t.getRewardStatus()-e.getRewardStatus()})}var l=e.buyMap;if(void 0!==l){n=this._shopList;for(var c in l){var u=parseInt(c),d=l[u];for(r=0,s=n.length;r<s;r++){var h;if((h=n[r]).getProductId()===u){h.setBoughtTimes(d);break}}}}o.EventUtil.dispatchEvent(o.EventNameEnum.GACHA_EQUIP_ACTIVITY_CHANGED)},i.prototype.getShowLuckyMsgList=function(){return this._luckyMsgList},i.prototype.getLuckyMsgList=function(){return this._luckyMsgList2},i.prototype._reqGachaLuckyMsg=function(){var t={};t.module=o.MsgModuleName.GACHA,t.cmd=o.MsgCmd.GACHA.GET_GOD_EQUIPMENT_LUCK_INFO,t.type=this.getActivityType(),o.ServerDelegate.sendMessage(t)},i.prototype._parseGachaLuckyMsg=function(t,e){if(t===o.NetCode.SUCCESS&&e.type==this.getActivityType()){e.refresh&&(this._luckyMsgList=[],this._luckyMsgList2=[]);for(var i=e.messageList,n=this._luckyMsgList,a=this._luckyMsgList2,r=o.UserPropertyEnum,s=o.RewardManager,l=o.Language.GachaActivityEquipMsg,c=o.Language.GachaActivityEquipMsg2,u=0,d=i.length;u<d;u++)for(var h=i[u],p=h.attributes,_=h.rewardList,g=p[r.NickName],f=0,v=_.length;f<v;f++){var m=s.getRewardDetail(_[f]),y=(m.getName()||"")+"x"+(m.getCount?m.getCount():1),E=m.getQuality(),T=cc.js.formatStr(l,g,y);T=o.UFRichTextParser.parseXML(T,E);var C=cc.js.formatStr(c,g,y);C=o.UFRichTextParser.parseXML(C,E),n.unshift({quality:E,msg:T}),a.unshift({quality:E,msg:C})}this._luckyMsgList=n||[],this._luckyMsgList2=a||[],this._luckyMsgList.length>this._maxMsgLength&&(this._luckyMsgList=n.slice(0,this._maxMsgLength)),this._luckyMsgList2.length>this._maxMsgLength&&(this._luckyMsgList2=a.slice(0,this._maxMsgLength)),i.length>0&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GACHA_ACTIVITY_LUCKY_MSG,this._activityType)}},i.prototype._initRewardList=function(){var e=this.getActivityData();if(e!==this._dataId){this._dataId=e;var i=t("GachaActivityShopModel");this._shopList=[];for(var n=o.GetTableClass(o.TableEnum.GodEquipmentBuyConfig).getGodEquipmentBuyConfigById(e),a=0,r=n.length;a<r;a++){var s=n[a];(p=new i).init(s),this._shopList[this._shopList.length]=p}var l=t("GachaActivityScoreModel");this._scoreRewardList=[],this._showRewards={};var c=o.GetTableClass(o.TableEnum.ActivityGachaConfig).getActivityGachaConfigById(e);if(c){this._gachaId=c.gachaId;var u=c.equitGachaShow;for(a=0,r=u.length;a<r;a++){var d=u[a];this._showRewards[d[0]]=o.RewardManager.parseRewardListDetail(d[1])}var h=c.scheduleReward;for(a=0,r=h.length;a<r;a++){var p;s=h[a];(p=new l).init(s),this._scoreRewardList[this._scoreRewardList.length]=p}}}},i.prototype.canFreeGacha=function(){var t=r.default.getInstance().getGachaListById(this._gachaId);if(!t)return!1;var e=t.getNextFreeTime(),i=e-o.TimeUtil.getTime();return!!(e>0&&i<=0)||void 0},i.prototype.canReceiveScoreReward=function(){if(!this._scoreRewardList||0===this._scoreRewardList.length)return!1;for(var t=0,e=this._scoreRewardList.length;t<e;t++){if(this._scoreRewardList[t].getRewardStatus()===o.RewardStatus.CAN_RECEIVE)return!0}return!1},i.prototype.canExchangeEquip=function(){if(!this._shopList||0===this._shopList.length)return!1;for(var t=this.getShopCurrencyNum(),e=0,i=this._shopList.length;e<i;e++){var n=this._shopList[e],a=n.getCanBuyTimes(),r=n.getCost();if(-1===a||-1!==a&&a>0&&t>=r.getCount())return!0}return!1},i.prototype.hasRedPoint=function(){return!0},i.prototype.redPointTip=function(){return this.canFreeGacha()||this.canReceiveScoreReward()||this.canExchangeEquip()},i.prototype.redPointEvts=function(){return[o.EventNameEnum.GACHA_EQUIP_ACTIVITY_CHANGED]},i.prototype.isRedPointTip=function(){return this.redPointTip()},i}(function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataId=0,e._score=0,e._gachaType=0,e._gachaId=0,e._currencyId=0,e._shopCurrencyId=0,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this.clearData(),this.addListener(),this.addEventListener(),this._initRewardList()},e.prototype.clearData=function(){this._dataId=0,this._score=0,this._gachaType=0,this._gachaId=0,this._currencyId=0,this._shopCurrencyId=0,this._showRewards={},this._shopList=[],this._scoreRewardList=[]},e.prototype.addListener=function(){var t=o.MsgModuleName.GACHA,e=o.MsgCmd.GACHA;o.ServerDelegate.registerMessage(t,e.PUSH_GOD_EQUIPMENT_LUCK_MESSAGE,this._parseGachaLuckyMsg.bind(this))},e.prototype.addEventListener=function(){var t={};t[o.EventNameEnum.REQ_GACHA_ACTIVITY_LUCKY_MSG]=this._reqGachaLuckyMsg,o.EventUtil.registerEvents(t,this)},e.prototype.getGachaType=function(){return this._gachaType},e.prototype.getGachaId=function(){return this._gachaId},e.prototype.getScore=function(){return this._score},e.prototype.getCurrencyNum=function(){return this._currencyId?o.ItemManager.getItemNumById(this._currencyId):0},e.prototype.getCurrencyModel=function(){var t=o.GetTableClass(o.TableEnum.Item).getItemById(this._currencyId);if(!t)return null;var e=new o.Item;return e.init(t),e},e.prototype.getShopCurrencyNum=function(){return this._shopCurrencyId?o.ItemManager.getItemNumById(this._shopCurrencyId):0},e.prototype.getShopCurrencyModel=function(){var t=o.GetTableClass(o.TableEnum.Item).getItemById(this._shopCurrencyId);if(!t)return null;var e=new o.Item;return e.init(t),e},e.prototype.getScoreRewardList=function(){return this._scoreRewardList},e.prototype.getShopList=function(){return this._shopList},e.prototype.getShowRewards=function(){return this._showRewards},e.prototype.activityParse=function(t){},e.prototype._reqGachaLuckyMsg=function(){},e.prototype._parseGachaLuckyMsg=function(t,e){},e.prototype._initRewardList=function(){},e.prototype.hasRedPoint=function(){},e.prototype.redPointTip=function(){},e.prototype.redPointEvts=function(){},e.prototype.isRedPointTip=function(){},e}(t("ActivityBaseController")));e.exports=s,cc._RF.pop()},{"../../../Gacha/Manager/GachaEnum":"GachaEnum","../../../Gacha/Manager/GachaManager":"GachaManager",ActivityBaseController:"ActivityBaseController",GachaActivityScoreModel:"GachaActivityScoreModel",GachaActivityShopModel:"GachaActivityShopModel"}],GachaActivityHome:[function(t,e,i){"use strict";cc._RF.push(e,"a02cerbqH9JX7d+XZufK2w5","GachaActivityHome");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Gacha/Manager/GachaManager"),o=t("ActivityBasePanel"),s=t("CommonIconWidget"),l=cc._decorator,c=l.ccclass,u=l.property,d=l.menu,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTime=null,e.rewardNode1=null,e.rewardNode2=null,e.btnScore=null,e.btnShop=null,e.labScore=null,e.labTicket=null,e.imgTicket=null,e.nodeOnce=null,e.nodeTen=null,e.layerMsg=null,e._isDoingAction=!1,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e)},e.prototype.onLoad=function(){var t=this.nodeOnce.getChildByName("btnOnce");td.RedPointUtil.createRedPointOld(t,cc.v2(-5,-5),this._controller.canFreeGacha.bind(this._controller),this._controller.redPointEvts()),td.RedPointUtil.createRedPointOld(this.btnScore,cc.v2(-15,-15),this._controller.canReceiveScoreReward.bind(this._controller),this._controller.redPointEvts()),td.RedPointUtil.createRedPointOld(this.btnShop,cc.v2(-15,-15),this._controller.canExchangeEquip.bind(this._controller),this._controller.redPointEvts())},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListeners(),this._initUI(),td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_GACHA_ACTIVITY_LUCKY_MSG)},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),td.EventUtil.unregisterAllEvents(this),this._isDoingAction=!1},e.prototype._addEventListeners=function(){var t={},e=td.EventNameEnum;t[e.RES_GACHA]=this._onReward,t[e.RES_GACHA_ACTIVITY_LUCKY_MSG]=this._onReceiveLuckyMsg,td.EventUtil.registerEvents(t,this)},e.prototype._onReward=function(t){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_GachaReward,t)},e.prototype._initUI=function(){this._initActivityTime(),this._initShowReward(),this._refreshCurrency()},e.prototype._refreshCurrency=function(){var t=this,e=this._controller.getShopCurrencyNum();this.labScore.string=this._controller.getScore(),this.labTicket.string=e;var i=this._controller.getShopCurrencyModel();i&&td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,i.getLittleIconResPath(),this.imgTicket);var n=this._controller.getGachaId(),a=r.default.getInstance().getGachaListById(n);if(a){var o=a.getCost(),s=a.getDisCount();e=this._controller.getCurrencyNum(),i=this._controller.getCurrencyModel();var l=this.nodeOnce.getChildByName("btnOnce"),c=this.nodeOnce.getChildByName("imgCostBg"),u=this.nodeOnce.getChildByName("imgCost"),d=this.nodeOnce.getChildByName("labCost"),h=this.nodeOnce.getChildByName("labTime"),p=a.getNextFreeTime(),_=p-td.TimeUtil.getTime(),g=p>0&&_<=0;c.active=!g,u.active=!g,d.active=!g,h.active=p>0&&!g;var f,v,m,y=td.GetTableClass(td.TableEnum.Item).getItemById(td.ItemEnum.Diamond);g?(v=td.Language.freeTips,m=cc.color(16,98,161),f="GY_anniu_fl_04",this.addAni(l)):(v=cc.js.formatStr("%s",td.Language.summonTips5,"1"),m=cc.color(176,79,0),f="GY_anniu_fl_03",this.hideAni(l),e>=1?(d.getComponent(cc.Label).string=e+"/1",td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,i.getLittleIconResPath(),u)):(d.getComponent(cc.Label).string=o,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,y.liIconRes,u)),p>0&&td.GlobalFunction.addTimeLabel2(h,_,function(){t._refreshCurrency()},td.Language.freePattern));var E=l.getChildByName("Label");E.getComponent(cc.Label).string=v,E.color=m,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,f,l),d=this.nodeTen.getChildByName("labCost"),u=this.nodeTen.getChildByName("imgCost"),e>=10?(d.getComponent(cc.Label).string=e+"/10",td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,i.getLittleIconResPath(),u)):(d.getComponent(cc.Label).string=10*o*s+"",td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,y.liIconRes,u))}},e.prototype._initActivityTime=function(){var t=this,e=this._controller.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=e.closeTime-td.TimeUtil.getTime();i>0?td.GlobalFunction.addTimeLabel2(this.labTime.node,i,function(){t.labTime.string=td.Language.ActivityOver},td.Language.timeCountPattern3):this.labTime.string=td.Language.ActivityOver}},e.prototype._initShowReward=function(){var t=this._controller.getShowRewards();for(var e in t){var i=this["rewardNode"+e];i&&this._setShowReward(i,t[e],td.Language["equitGachaShow"+e])}},e.prototype._setShowReward=function(t,e,i){var n=t.getChildByName("layerReward");t.getChildByName("labName").getComponent(cc.Label).string=i;for(var a=0,r=e.length;a<r;a++){var o=e[a];(l=n.getChildByName("icon_"+a))?l.getComponent(s).setData(o):((l=td.GlobalFunction.createCommonIconWidget(56,o)).name="icon_"+a,l.parent=n)}for(;;a++){var l;if(!(l=n.getChildByName("icon_"+a)))break;l.removeFromParent(!0)}},e.prototype.addAni=function(t){var e=t.getChildByName("ZhaoHuan_ui");if(e){var i=e.getComponent(cc.Animation);i.play(i.defaultClip.name),e.active=!0}else{var n=td.GlobalFunction.getResIdByNode(t);gdk.rm.loadRes(n,"uiAnima/ZhaoHuan_ui2/ZhaoHuan_ui2",cc.Prefab,this.showAni.bind(this,t))}},e.prototype.hideAni=function(t){var e=t.getChildByName("ZhaoHuan_ui");e&&(e.active=!1)},e.prototype.showAni=function(t){if(cc.isValid(t)){var e=gdk.rm.getResByUrl("uiAnima/ZhaoHuan_ui2/ZhaoHuan_ui2",cc.Prefab),i=cc.instantiate(e);i.name="ZhaoHuan_ui",t.addChild(i)}},e.prototype._onReceiveLuckyMsg=function(t){var e=this;if(t===this._activityType&&!this._isDoingAction)for(var i=this._controller.getShowLuckyMsgList(),n=i.length,a=n>3,r=this.layerMsg.children,o=-3,s=0,l=function(t,r,c){r?(t.active=!0,c&&e._setRichText(t,r),a&&(t.runAction(cc.sequence(cc.moveBy(1.5,cc.v2(0,t.height+3)),cc.callFunc(function(){var e=!1;t.y>0&&(t.y=o-t.height/2,r=i[s],++s>=n&&(s=0),e=!0),l(t,r,e)}))),e._isDoingAction=!0)):t.active=!1},c=0,u=r.length;c<u;c++){var d=r[c];d.stopAllActions(),d.y=o-d.height/2,c!==u-1&&(o-=d.height+3);var h=i[s];++s>=n&&(s=0),l(d,h,!0)}},e.prototype._setRichText=function(t,e){var i=t.getComponent(td.UFRichText),n=e.msg,a={fontSize:22,quality:e.quality};i.init(n,a),i.setLeftCenter()},e.prototype.onBtnOnce=function(){var t=this._controller.getGachaId(),e=r.default.getInstance().getGachaListById(t);if(e){var i=e.getNextFreeTime(),n=e.getCost(),a=td.Account.getUserData().getDiamond(),o={};o.id=t,o.times=1;var s=this._controller.getCurrencyNum();if(i<=td.TimeUtil.getTime())o.useGoods=!1;else if(s>=1)o.useGoods=!0;else{if(!(0!=n&&a>=n)){var l={};return l.strArray=[td.Language.diamondlack],l.okCallFunc=td.GlobalFunction.gotoRecharge.bind(td.GlobalFunction),l.strBtnYes=td.Language.goto,l.strBtnNo=td.Language.cancel,void td.GlobalFunction.showConfirmWindow(l)}o.useGoods=!1}var c=this._controller.getGachaType();r.default.getInstance().setType(c),td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_GACHA,o)}},e.prototype.onBtnTen=function(){var t=this._controller.getGachaId(),e=r.default.getInstance().getGachaListById(t);if(e){var i={};i.id=t,i.times=10;var n=this._controller.getCurrencyNum(),a=e.getCost(),o=td.Account.getUserData().getDiamond(),s=e.getDisCount();if(n>=10)i.useGoods=!0;else{if(!(0!=a&&o>=10*a*s)){if(0===a){var l=new td.BroadcastContent(31);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,l)}else{var c={};c.strArray=[td.Language.diamondlack],c.okCallFunc=td.GlobalFunction.gotoRecharge.bind(td.GlobalFunction),c.strBtnYes=td.Language.goto,c.strBtnNo=td.Language.cancel,td.GlobalFunction.showConfirmWindow(c)}return}i.useGoods=!1}var u=this._controller.getGachaType();r.default.getInstance().setType(u),td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_GACHA,i)}},e.prototype.onBtnShop=function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_GachaActivityShop,td.ActivityEnum.GachaActivityShopType.Shop)},e.prototype.onBtnScore=function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_GachaActivityShop,td.ActivityEnum.GachaActivityShopType.Score)},e.prototype.onShowLuckMsg=function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_Lucky_Rank,this._activityType)},a([u(cc.Label)],e.prototype,"labTime",void 0),a([u(cc.Node)],e.prototype,"rewardNode1",void 0),a([u(cc.Node)],e.prototype,"rewardNode2",void 0),a([u(cc.Node)],e.prototype,"btnScore",void 0),a([u(cc.Node)],e.prototype,"btnShop",void 0),a([u(cc.Label)],e.prototype,"labScore",void 0),a([u(cc.Label)],e.prototype,"labTicket",void 0),a([u(cc.Node)],e.prototype,"imgTicket",void 0),a([u(cc.Node)],e.prototype,"nodeOnce",void 0),a([u(cc.Node)],e.prototype,"nodeTen",void 0),a([u(cc.Node)],e.prototype,"layerMsg",void 0),e=a([c,d("module/Activity/GachaActivityHome")],e)}(o);i.default=h,cc._RF.pop()},{"../../../Gacha/Manager/GachaManager":"GachaManager",ActivityBasePanel:"ActivityBasePanel",CommonIconWidget:"CommonIconWidget"}],GachaActivityScoreModel:[function(t,e,i){"use strict";cc._RF.push(e,"b8da7JuGqNL5rOIn6+81vpA","GachaActivityScoreModel");var n=function(){function t(){}return t.prototype.init=function(t){t&&(this._score=t[0],this._reward=td.RewardManager.parseRewardListDetail(t[1])[0],this._rewardStatus=td.RewardStatus.CANNOT_RECEIVE)},t.prototype.getScore=function(){return this._score},t.prototype.getReward=function(){return this._reward},t.prototype.setRewardStatus=function(t){this._rewardStatus=t},t.prototype.getRewardStatus=function(){return this._rewardStatus},t}();e.exports=n,cc._RF.pop()},{}],GachaActivityShopModel:[function(t,e,i){"use strict";cc._RF.push(e,"40af8JfQOtPt6/vcT05WqNV","GachaActivityShopModel");var n=window.td,a=function(){function t(){this._dataId=0,this._productId=0,this._limitTimes=0,this._boughtTimes=0}return t.prototype.init=function(t){t&&(this._dataId=t.data,this._productId=t.productId,this._limitTimes=t.times||-1,this._cost=n.RewardManager.parseRewardListDetail(t.costs)[0],this._reward=n.RewardManager.parseRewardListDetail(t.rewards)[0],this._originReward=t.rewards[0])},t.prototype.getProductId=function(){return this._productId},t.prototype.getLimitTimes=function(){return this._limitTimes},t.prototype.getCost=function(){return this._cost},t.prototype.getReward=function(){return this._reward},t.prototype.setBoughtTimes=function(t){this._boughtTimes=t},t.prototype.getCanBuyTimes=function(){return this._limitTimes<=0?-1:this._limitTimes-this._boughtTimes},t.prototype.getRewards=function(){return this._originReward},t.prototype.getMoneyId=function(){return this._cost.getId()},t}();e.exports=a,cc._RF.pop()},{}],GachaActivityShopPanel:[function(t,e,i){"use strict";cc._RF.push(e,"64fbb17Q6RJvJtn5At0Zfq+","GachaActivityShopPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.menu,c=o.property,u=t("PanelBase"),d=t("TabController"),h=t("OptimizeVerticalListView"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._selectTag=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Panel,this._panelEnum=r.PanelEnum.Panel_GachaActivityShop},e.prototype.onLoad=function(){this.btnScore._tag=r.ActivityEnum.GachaActivityShopType.Score,this.btnShop._tag=r.ActivityEnum.GachaActivityShopType.Shop;var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_13);t&&(r.RedPointUtil.createRedPointOld(this.btnScore,cc.v2(-5,-5),t.canReceiveScoreReward.bind(t),t.redPointEvts()),r.RedPointUtil.createRedPointOld(this.btnShop,cc.v2(-5,-5),t.canExchangeEquip.bind(t),t.redPointEvts())),this._tabController||(this._tabController=new d,this._tabController.init([this.btnScore,this.btnShop],this))},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),r.EventUtil.dispatchEvent(r.EventNameEnum.HIDE_MAIN_LAYER_BOTTOM_LAYER),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t=r.EventUtil,e=r.EventNameEnum,i={};i[e.GACHA_EQUIP_ACTIVITY_CHANGED]=this._refreshView,i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.onReceiveOperation,t.registerEvents(i,this)},e.prototype.setData=function(t){t=t||r.ActivityEnum.GachaActivityShopType.Score,this._tabController.showTab(t)},e.prototype.showTab=function(t){t!==this._selectTag&&(this._selectTag=t,this._refreshView(!0))},e.prototype._refreshView=function(t){var e=r.ActivityEnum.GachaActivityShopType;this._selectTag===e.Score?(this.scoreRewardPanel.active=!0,this.exchangePanel.active=!1,this._refreshScoreReward(t)):this._selectTag===e.Shop&&(this.scoreRewardPanel.active=!1,this.exchangePanel.active=!0,this._refreshExchangeShop(t))},e.prototype._refreshScoreReward=function(t){var e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_13);if(e){this.scoreRewardPanel.getChildByName("labOwnScore").getComponent(cc.Label).string=cc.js.formatStr(r.Language.myScoreTitle,e.getScore());var i=e.getScoreRewardList(),n=this.scoreRewardPanel.getChildByName("scrollView").getComponent(h);t?n.setData(i):n.refreshCurList(i)}},e.prototype._refreshExchangeShop=function(t){var e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_13);if(e){var i=this.exchangePanel.getChildByName("labOwn"),n=this.exchangePanel.getChildByName("imgCurrency");i.getComponent(cc.Label).string=e.getShopCurrencyNum();var a=e.getShopCurrencyModel();a&&r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,a.getLittleIconResPath(),n);var o=e.getShopList(),s=this.exchangePanel.getChildByName("scrollView").getComponent(h);t?s.setData(o):s.refreshCurList(o)}},e.prototype.onReceiveOperation=function(t){var e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_13);if(e&&t.activityId===e.getActivityId()){var i=t.rewardResult,n=r.RewardManager.parseRewardResult(i,!0);r.GlobalFunction.showRewards(n)}},a([c(cc.Node)],e.prototype,"scoreRewardPanel",void 0),a([c(cc.Node)],e.prototype,"exchangePanel",void 0),a([c(cc.Node)],e.prototype,"btnShop",void 0),a([c(cc.Node)],e.prototype,"btnScore",void 0),e=a([s,l("module/Activity/GachaActivityShopPanel")],e)}(u);i.default=p,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0,TabController:void 0}],GachaEnum:[function(t,e,i){"use strict";cc._RF.push(e,"9f15bOPpz9N3ow2El9JfIvH","GachaEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.GachaType=void 0,function(t){t[t.NORMAL_HERO=1]="NORMAL_HERO",t[t.DIAMOND_HERO=2]="DIAMOND_HERO",t[t.SUPREME_HERO=3]="SUPREME_HERO",t[t.GOD_EQUIPMENT=4]="GOD_EQUIPMENT",t[t.HERO_EXCLUSIVE_ARTIFACT=5]="HERO_EXCLUSIVE_ARTIFACT",t[t.TIME_LIMIT_GACHA=7]="TIME_LIMIT_GACHA",t[t.NONE=0]="NONE"}(i.GachaType||(i.GachaType={})),cc._RF.pop()},{}],GachaManager:[function(t,e,i){"use strict";cc._RF.push(e,"a9f3exDYDVHk4rwgVj9GkRK","GachaManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,window.td),s=t("GachaModel"),l=t("./GachaEnum"),c=function(){function t(){this._showHeroList=[],this._curGachaId=0,this._isActivityGacha=!1,this._isShowGachaAni=!0,this._bigRewardArr=[],this._isCalling=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e,this._instance._gachaList={}),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener()},t.prototype.destroyData=function(){this._curHero=null},t.prototype.addListener=function(){var t=o.MsgModuleName.GACHA,e=o.MsgCmd.GACHA;o.ServerDelegate.registerMessage(t,e.GET_GACHA_INFO,this.parseGachaInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.GACHA,this.parseGACHA.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_GACHA_INFO,this.parseGachaInfo.bind(this))},t.prototype.resetCallingSatatus=function(){this._isCalling=!1},t.prototype.getCallingStatus=function(){return this._isCalling},t.prototype.parseGachaInfo=function(t,e){var i=this;t===o.NetCode.SUCCESS&&(e.gachaList.forEach(function(t){var e=new s;e.setData(t),i._gachaList[t.id]=e}),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GET_GACHA_INFO))},t.prototype.parseGACHA=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GACHA,e.gachaMap)},t.prototype.addEventListener=function(){var t=o.EventUtil,e=o.EventNameEnum,i={};i[e.REQ_GET_GACHA_INFO]=this.requestGachaInfo,i[e.REQ_GACHA]=this.requestGacha,i[e.ON_GET_SERVER_SETTING]=this.setSuperHeroId,t.registerEvents(i,this)},t.prototype.requestGachaInfo=function(){var t={};t.module=o.MsgModuleName.GACHA,t.cmd=o.MsgCmd.GACHA.GET_GACHA_INFO,o.ServerDelegate.sendMessage(t)},t.prototype.requestGacha=function(t){var e={};e.module=o.MsgModuleName.GACHA,e.cmd=o.MsgCmd.GACHA.GACHA,e.id=t.id,e.times=t.times,e.useGoods=t.useGoods;var i=0;this._type===l.GachaType.HERO_EXCLUSIVE_ARTIFACT&&(i=t.heroId),e.heroId=i,o.ServerDelegate.sendMessage(e),o.DataReporter.onEvent("Gach_"+t.id,{times:t.times}),this._type!==l.GachaType.NORMAL_HERO&&this._type!==l.GachaType.DIAMOND_HERO&&this._type!==l.GachaType.SUPREME_HERO||(this._isCalling=!0,o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_POWER_CHANGE_LATER,!0))},t.prototype.setCurGachaId=function(t){this._curGachaId=t},t.prototype.getCurGachaId=function(){return this._curGachaId},t.prototype.setIsActivityGacha=function(t){this._isActivityGacha=t},t.prototype.isActivityGacha=function(){return this._isActivityGacha},t.prototype.setIsShowGachaAni=function(t){this._isShowGachaAni=t},t.prototype.isShowGachaAni=function(){return this._isShowGachaAni},t.prototype.getGachaListById=function(t){return this._gachaList[t]},t.prototype.getSuperHeroId=function(){return this._superHeroId},t.prototype.setSuperHeroId=function(){var t=o.SystemManager.getSettingByKey(o.ServerSettingKey.SUPREME_GACHA);if(t){var e=t.key;e!==this._superHeroId&&(this._superHeroId=e,o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GET_GACHA_INFO))}},t.prototype.getType=function(){return this._type},t.prototype.setType=function(t){this._type=t,this._type!==l.GachaType.HERO_EXCLUSIVE_ARTIFACT&&(this._curHero=null)},t.prototype.getCurHero=function(){return this._curHero},t.prototype.setCurHero=function(t){this._curHero=t},t.prototype.getShowHeroList=function(){var t=this;0==this._showHeroList.length&&o.GetConfig("SUPREME_GACHA_IDS").forEach(function(e){t._showHeroList.push(e)});return this._showHeroList},t.prototype.getShowHeroListById=function(t){var e=this;0==this._showHeroList.length&&o.GetConfig("SUPREME_GACHA_IDS").forEach(function(t){e._showHeroList.push(t)});for(var i=0;i<this._showHeroList.length;i++)if(this._showHeroList[i][0]===t)return this._showHeroList[i][1];return null},t.prototype.getBigRewardArr=function(){return this._bigRewardArr},t.prototype.setBigRewardArr=function(t){this._bigRewardArr=t.slice(0)},t.prototype.showBigRewards=function(){var t=this.getBigRewardArr();t&&t.length>0&&(o.GlobalFunction.showRewards(t.slice(0),null,null,null,2),this.setBigRewardArr([]))},t.prototype.isNormalRedPointTips=function(){return this.isRedPointById(3)},t.prototype.isDiamondRedPointTips=function(){return this.isRedPointById(4)},t.prototype.isSupremeRedPointTips=function(){var t=e.getInstance().getSuperHeroId();return!!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.GACHA,t)&&this.isRedPointById(t)},t.prototype.isRedPointById=function(t){var e=this.getGachaListById(t);if(!e)return!1;if(e.getNextFreeTime()<=o.TimeUtil.getTime())return!0;var i=e.getGoodsCost();return o.ItemManager.getItemNumById(i)>0},t.prototype.isRedPointTips=function(){return!!this.isNormalRedPointTips()||(!!this.isDiamondRedPointTips()||!!this.isSupremeRedPointTips())},t.prototype.redPointEvents=function(){var t=o.EventNameEnum;return[t.RES_GET_GACHA_INFO,t.UPGRADE_ITEM_CHANGE]},t=e=n([r],t)}();i.default=c,cc._RF.pop()},{"./GachaEnum":"GachaEnum",GachaModel:"GachaModel"}],GachaModel:[function(t,e,i){"use strict";cc._RF.push(e,"1061anRE3lMjI332lN4mBby","GachaModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o},a=window.td,r=cc._decorator.ccclass,o=function(){function t(){}return t.prototype.setData=function(t){if(t.id){this._id=t.id;var e=a.GetTableClass(a.TableEnum.GachaTable).getDataById(this._id);e&&(this._goodsCost=e.goodsCost[1],this._goodsCostNum=e.goodsCost[2],this._cost=e.cost.length>0?e.cost[2]:0,this._costId=e.cost.length>0?e.cost[1]:0,this._disCount=e.disCount)}(t.times||0==t.times)&&(this._times=t.times),(t.nextFreeTime||0==t.nextFreeTime)&&(this._nextFreeTime=t.nextFreeTime)},t.prototype.getId=function(){return this._id},t.prototype.getTimes=function(){return this._times},t.prototype.getNextFreeTime=function(){return this._nextFreeTime},t.prototype.getGoodsCost=function(){return this._goodsCost},t.prototype.getGoodsCostNum=function(){return this._goodsCostNum},t.prototype.getCost=function(){return this._cost},t.prototype.getCostId=function(){return this._costId},t.prototype.getDisCount=function(){return this._disCount},t=n([r],t)}();e.exports=o,cc._RF.pop()},{}],GachaScoreRewardItem:[function(t,e,i){"use strict";cc._RF.push(e,"add5alIOetB7KnE2sdMSb4V","GachaScoreRewardItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labName=null,e.labProgress=null,e.btnGet=null,e.img_get=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_13);if(n){var a=i.getScore(),o=n.getScore();this.labProgress.string=o>=a?"<color=#4989aa>"+r.Language.needScore+"</c><color=#0eb001>"+o+"/"+a+"</c><color=#4989aa>"+r.Language.canGet+"</c>":"<color=#4989aa>"+r.Language.needScore+"</c><color=#ff230c>"+o+"</c><color=#0eb001>/"+a+"</c><color=#4989aa>"+r.Language.canGet+"</c>";var s=i.getReward();this.labName.string=s.getName(),r.GlobalFunction.setNameColors(this.labName.node,s.getQuality());var l=this.node.getChildByName("itemIcon");if(l)l.getComponent("CommonIconWidget").setData(s);else(l=r.GlobalFunction.createCommonIconWidget(26,s)).scale=.9,l.name="itemIcon",l.setPosition(cc.v2(-260,0)),this.node.addChild(l);var c=i.getRewardStatus()===r.RewardStatus.RECEIVED;this.img_get.active=c,this.btnGet.active=!c,r.GlobalFunction.setButtonGray(this.btnGet,a>o)}},e.prototype.onReceive=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_13);if(t){var e=this._item.getScore(),i={};i.activityId=t.getActivityId(),i.id=e,i.parmeterMap={7:r.ActivityEnum.GachaActivityShopType.Score},t.operateActivity(i)}},a([c(cc.Label)],e.prototype,"labName",void 0),a([c(cc.RichText)],e.prototype,"labProgress",void 0),a([c(cc.Node)],e.prototype,"btnGet",void 0),a([c(cc.Node)],e.prototype,"img_get",void 0),e=a([l,u("module/Activity/GachaScoreRewardItem")],e)}(o);i.default=d,cc._RF.pop()},{ListItem:void 0}],GachaShopItem:[function(t,e,i){"use strict";cc._RF.push(e,"a1cbfaccOtNG5dnUPfCgXTP","GachaShopItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=t("CommonEnum"),l=cc._decorator,c=l.ccclass,u=l.property,d=l.menu,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labName=null,e.labDesc=null,e.labCost=null,e.imgCost=null,e.imgLimitBg=null,e.labLimit=null,e.btnExchange=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_13);if(n){var a=n.getShopCurrencyNum(),o=i.getCost();this.labCost.string=o.getCount(),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,o.getLittleIconResPath(),this.imgCost);var s=i.getCanBuyTimes();this.imgLimitBg.active=s>-1,this.labLimit.node.active=s>-1,s>-1&&(this.labLimit.string=cc.js.formatStr(r.Language.exchangeGoodsTimes,s)),r.GlobalFunction.setButtonGray(this.btnExchange,a<o.getCount()||!(-1===s||s>0));var l=i.getReward();this.labName.string=l.getName(),r.GlobalFunction.setNameColors(this.labName.node,l.getQuality()),this.labDesc.string=l.getDes();var c=this.node.getChildByName("itemIcon");if(c)c.getComponent("CommonIconWidget").setData(l);else(c=r.GlobalFunction.createCommonIconWidget(26,l)).scale=.9,c.name="itemIcon",c.setPosition(cc.v2(-260,0)),this.node.addChild(c)}},e.prototype.onBtnExchange=function(){if(r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_13)){var t=this._item.getCost();if(r.GamerResourceUtil.checkItem(t.getId(),t.getCount(),r.GamerResourceUtil.TipType.Tip)){var e={};e.opType=s.OperateItemType.ExchangeType,e.sureFunc=this._requestExchangeProduct.bind(this),e.itemData=this._item,e.calcFunc=this._calcNeedPayByItemNum.bind(this);var i=this._item.getCanBuyTimes(),n=r.ItemManager.getItemNumById(t.getId()),a=Math.floor(n/t.getCount());i>-1&&(a=Math.min(a,i)),e.maxLimitNum=a,r.GlobalFunction.showUseOrExchangeWindow(e)}}},e.prototype._calcNeedPayByItemNum=function(t,e){return t*e.getCost().getCount()},e.prototype._requestExchangeProduct=function(t){var e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_13);if(e){var i=t.model,n=t.num,a=i.getProductId(),o={};o.activityId=e.getActivityId(),o.id=a,o.parmeterMap={6:n,7:r.ActivityEnum.GachaActivityShopType.Shop},e.operateActivity(o)}},a([u(cc.Label)],e.prototype,"labName",void 0),a([u(cc.Label)],e.prototype,"labDesc",void 0),a([u(cc.Label)],e.prototype,"labCost",void 0),a([u(cc.Node)],e.prototype,"imgCost",void 0),a([u(cc.Node)],e.prototype,"imgLimitBg",void 0),a([u(cc.Label)],e.prototype,"labLimit",void 0),a([u(cc.Node)],e.prototype,"btnExchange",void 0),e=a([c,d("module/Activity/GachaShopItem")],e)}(o);i.default=h,cc._RF.pop()},{CommonEnum:void 0,ListItem:void 0}],GachaTable:[function(t,e,i){"use strict";cc._RF.push(e,"b5b9dyLYZtGHKSeaIDb9n0d","GachaTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="GachaConfig",e._tblName="gacha_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data[t]},e.prototype.getDataByType=function(t){for(var e in this._data)if(this._data[e].type==t)return this._data[e];return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GameTipsTable:[function(t,e,i){"use strict";cc._RF.push(e,"3517e3LxzlJlY6QTflGqQe0","GameTipsTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GameTipsTable",properties:{_tblName:"game_tips_config",_data:null},init:function(){var t=this._jsonData;this._data={};for(var e=this._data,i=0,n=t.length-1;i<=n;i++){var a=t[i];e[a.id]=a}},getTipsByLevel:function(t){var e=this.getAllDataByLevel(t);return 0===e.length?null:e[Math.floor(Math.random()*e.length)].tips},getAllDataByLevel:function(t){var e=this._data,i=[];for(var n in e){var a=e[n];(!t||t>=a.minLevel&&t<=a.maxLevel)&&(i[i.length]=a)}return i}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GemAwakenConfig:[function(t,e,i){"use strict";cc._RF.push(e,"1e531GlwvtF47XIprIVytY9","GemAwakenConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GemAwakenConfig",properties:{_tblName:"rune_awaken_config",_awakenConfig:null},init:function(){this._awakenConfig={};for(var t=this._awakenConfig,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.runeId,o=a.level;a.backdrop="backdrop/"+a.backdrop,t[r]=t[r]||{},t[r][o]=a}},canAwaken:function(t){return this._awakenConfig&&this._awakenConfig[t]&&this._awakenConfig[t].myLen()>0},getGemAwakenConfigs:function(t){return this._awakenConfig&&this._awakenConfig[t]?this._awakenConfig[t]:{}},getGemAwakenConfig:function(t,e){return this._awakenConfig&&this._awakenConfig[t]&&this._awakenConfig[t][e]?this._awakenConfig[t][e]:null},getNextSpecialConfig:function(t,e){if(this._awakenConfig&&this._awakenConfig[t])for(var i in this._awakenConfig[t]){i=parseInt(i);var n=this._awakenConfig[t][i];if(n.des.length>1&&i>e)return n}return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GemSpaceModel:[function(t,e,i){"use strict";cc._RF.push(e,"13b0a03dIBOJZkZlLpb1GI5","GemSpaceModel");var n=window.td,a=function(){function t(){this._type=0}return t.prototype.init=function(t,e){this._type=t,this.resetData(e)},t.prototype.resetData=function(t){this._setGemstoneList(t.runeEntityList),this._setHuntIds(t.vowIdList)},t.prototype.getHuntIds=function(){return this._huntIds},t.prototype.getGemstoneList=function(){return this._gemList},t.prototype._setHuntIds=function(t){this._huntIds=t},t.prototype._setGemstoneList=function(t){t||(t=[]),this._gemList=[];for(var e=this._gemList,i=0,a=t.length-1;i<=a;i++){var r=t[i],o=n.RewardManager.getRewardDetail(r.rewardObject);o.getGoodsType()===n.GoodsType.Type_Gemstone&&(o.setLevel(r.runeLevel),o.setLevelExp(r.exp)),e[e.length]=o}},t}();e.exports=a,cc._RF.pop()},{}],GemstoneAdvanceModel:[function(t,e,i){"use strict";cc._RF.push(e,"3bdefSQzyNId5t5G722Zx0V","GemstoneAdvanceModel"),td.GemstoneAdvanceModel=cc.Class({_configId:null,_advanceLevel:null,_cost:null,_resetCost:null,_devour:null,_restoreItem:null,initData:function(t){var e=td.RewardManager;this._configId=t.configId,this._advanceLevel=t.advanceLevel,this._cost=e.parseRewardListDetail(t.cost),this._resetCost=e.parseRewardListDetail(t.resetCost),this._devour=t.devour,this._restoreItem=e.parseRewardListDetail(t.restoreRewards)},getConfigId:function(){return this._configId},getLevel:function(){return this._advanceLevel},getCost:function(){return this._cost},getResetCost:function(){return this._resetCost},getDevour:function(){return this._devour},getRestoreItem:function(){return this._restoreItem}}),cc._RF.pop()},{}],GemstoneAdvanceResetModel:[function(t,e,i){"use strict";cc._RF.push(e,"bc276JDIrlHIZWZUVjeX2WY","GemstoneAdvanceResetModel"),td.GemstoneAdvanceResetModel=cc.Class({_id:null,_addAttriValue:null,_quality:null,_des:null,_topLevelDes:null,_isPersentAttri:null,initData:function(){this._id=0,this._addAttriValue=0,this._isPersentAttri=!0,this._quality=0,this._des="",this._topLevelDes=""},setId:function(t){this._id=t;var e=td.GetTableClass(td.TableEnum.GemstoneAdvanceResetTable).getResetDataById(this._id);e&&(this._isPersentAttri=!!e.attributeTTPercent&&!e.attributeValue,this._addAttriValue=this._isPersentAttri?e.attributeTTPercent:e.attributeValue,this._quality=e.quality,this._des=e.des,this._topLevelDes=e["2_des"])},getId:function(){return this._id},isAddPercentAtri:function(){return this._isPersentAttri},getAttrAddition:function(){return this._addAttriValue},getAddPercentStr:function(){return td.PercentNumberUtil.getPercentValueStr(this._addAttriValue,2)},getQuality:function(){return this._quality},getDescription:function(){return this._des},getTopDescrition:function(){return this._topLevelDes}}),cc._RF.pop()},{}],GemstoneAdvanceResetTable:[function(t,e,i){"use strict";cc._RF.push(e,"8bb1apj5d9CVqraWgZoNsBu","GemstoneAdvanceResetTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GemstoneAdvanceResetTable",properties:{_tblName:"rune_advance_reset_attr_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},getResetDataById:function(t){return this._data[t]?this._data[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GemstoneAdvanceTable:[function(t,e,i){"use strict";cc._RF.push(e,"d57f4IYHFBJiKUu+Nupoewv","GemstoneAdvanceTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GemstoneAdvanceTable",properties:{_tblName:"rune_advance_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}},getUpgradeLevelData:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GemstoneManager:[function(t,e,i){"use strict";cc._RF.push(e,"802a9Yxw/JClryBtbUAXOq9","GemstoneManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("GemSpaceModel"),r=t("HuntTreasureModel"),o=function(){function e(){this._operateIndex=0,this._replaceType=0,this._isAutoQuickCompose=!0,this._lastQuickHuntTimes=0,this._openQuickHunt=!1,this._posGemRedPointStatusMap={}}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},e.prototype.destroyData=function(){this._gemstoneList={},this._operateIndex=null,this._upgradeConfig=null,this._upgradeSelectedSIds=[],this._isAutoQuickCompose=!0,this._lastQuickHuntTimes=0,this._openQuickHunt=!1,this._posGemRedPointStatusMap={}},e.prototype.addListener=function(){var t=n.ServerDelegate,e=n.MsgModuleName.GEMSTONE,i=n.MsgCmd.Gemstone;t.registerMessage(e,i.GET_GEMSTONE,this._parseGemstoneList.bind(this)),t.registerMessage(e,i.GEMSTONE_REINFORCE,this._onGemstoneUpgradeReturn.bind(this)),t.registerMessage(e,i.GEMSTONE_AWAKEN,this._onAwakenReturn.bind(this)),t.registerMessage(e,i.PUSH_GEMSTONE_LIST,this._parseGemstoneList.bind(this)),t.registerMessage(e,i.PUSH_DELETE_GEMSTONES_LIST,this._pushDeleteGemstone.bind(this)),t.registerMessage(e,i.GEMSTONE_DECOMPOSE,this._onDecomposeReturn.bind(this)),e=n.MsgModuleName.HuntTreasure;var a=n.MsgCmd.HuntTreasureCmd;t.registerMessage(e,a.GET_HUNT_TREASURE_INFO,this._getHuntTreasureInfoReturn.bind(this)),t.registerMessage(e,a.DO_HUNT_TREASURE,this._onHuntTreasureReturn.bind(this)),t.registerMessage(e,a.QUICK_HUNT_TREASURE,this._onOneKeyHuntTreasureReturn.bind(this)),t.registerMessage(e,a.QUICK_PICK_UP,this._onOneKeyPickupReturn.bind(this)),t.registerMessage(e,a.QUICK_SYNTHESIS,this._onOneKeyComposeReturn.bind(this)),t.registerMessage(e,a.QUICK_REFINE,this._onQuickHuntReturn.bind(this)),t.registerMessage(e,a.PUSH_HUNT_TREASURE_INFO,this._pushHuntTreasureInfo.bind(this))},e.prototype.addEventListener=function(){var t=n.EventUtil,e=n.EventNameEnum,i={};i[e.REQUEST_GEMSTONE_LIST]=this._requestGetGemstoneList,i[e.REQUEST_GEMSTONE_STRENGTHEN]=this._requestGemstoneUpgrade,i[e.REQUEST_GEMSTONE_AWAKEN]=this._requestGemstoneAwaken,i[e.SET_OPERATE_GEMSTONE_INDEX]=this._setOperateIndex,i[e.GET_HUNT_TREASURE_INFO]=this._getHuntTreasureInfo,i[e.REQUEST_HUNT_TREASURE]=this._requesHuntTreasure,i[e.REQUEST_ONE_KEY_HUNT]=this._requesOneKeyHuntTreasure,i[e.REQUEST_ONE_KEY_PICKUP]=this._requestOneKeyPickup,i[e.REQUEST_ONE_KEY_COMPOSE]=this._requestOneKeyCompose,i[e.REQUEST_DECOMPOSE]=this._requestDecompose,i[e.REQUEST_QUICK_HUNT]=this._requestQuickHunt,t.registerEvents(i,this)},e.prototype.haveGemstone=function(){return this._gemstoneList&&this._gemstoneList.myLen()>0},e.prototype.getGemstoneData=function(){return this._gemstoneList},e.prototype.getGemstoneDataBySId=function(t){return this._gemstoneList[t]},e.prototype.getOperateIndex=function(){return this._operateIndex},e.prototype._setOperateIndex=function(t){this._operateIndex=t},e.prototype.setReplaceType=function(t){this._replaceType=t},e.prototype.getReplaceType=function(){return this._replaceType},e.prototype.getGemstoneNumByCfgId=function(t){var e=0;for(var i in this._gemstoneList){this._gemstoneList[i].getId()===t&&e++}return e},e.prototype.getGemstoneDataByCfgId=function(t,e){var i=this._gemstoneList,n=[];for(var a in i)if(i[a].getId()===t&&(n.push(i[a]),e))break;return e?n.length>0?n[0]:null:n},e.prototype.getGemForRebirth=function(){var t=this._gemstoneList,e=[];for(var i in t){var n=t[i];n.isEquipped()||(n.getLevel()>1||n.getLevelExp()>0||n.getAwakenLv()>0)&&e.push(n)}return e},e.prototype.getAllGem=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!1);var a=[],r=n.GetConfig("RUNE_DECOMPOSE_QUALITY");for(var o in this._gemstoneList){var s=this._gemstoneList[o];if(!(t&&s.isEquipped()||e&&(s.getLevel()>1||s.getLevelExp()>0||s.getAwakenLv()>0))){if(i){if(0===s.getType())continue;if(-1===r.indexOf(s.getQuality()))continue}a[a.length]=s}}return a},e.prototype.getGemModelById=function(e){var i=n.GetTableClass(n.TableEnum.GemstoneTable).getGemstoneById(e);if(!i)return null;var a=new(t("GemstoneModel"));return a.init(i),a},e.prototype.getCanDevourGemSIds=function(t,e){var i=[];for(var n in this._gemstoneList){var a=this._gemstoneList[n];a.getId()!==t||a.getSId()==e||a.getLevel()>1||a.getLevelExp()>0||a.getAwakenLv()>0||a.isEquipped()||(i[i.length]=a.getSId())}return i},e.prototype._getNewGemstone=function(e){var i=n.GetTableClass(n.TableEnum.GemstoneTable).getGemstoneById(e.configId);if(!i)return null;var a=new(t("GemstoneModel"));return a.init(i),a.setSId(e.runeId),a},e.prototype._initUpgradeConfig=function(){this._upgradeConfig={};for(var t=n.GetTableClass(n.TableEnum.GemstoneUpgradeTable).getUpgradeLevelData(),e=0,i=t.length;e<i;e++){var a=t[e],r=a.runeId,o=a.level,s=this.getUpgradeModelByLevel(r,o);s||(s=new n.GemstoneUpgradeModel),s.init(a),this._upgradeConfig[r]=this._upgradeConfig[r]||{},this._upgradeConfig[r][o]=s}},e.prototype.getUpgradeModelByLevel=function(t,e){return this._upgradeConfig&&this._upgradeConfig[t]?this._upgradeConfig[t][e]:null},e.prototype.getUpgradeConfig=function(){return this._upgradeConfig&&0!==this._upgradeConfig.myLen()||this._initUpgradeConfig(),this._upgradeConfig},e.prototype.getUpgradeLevelData=function(t,e){return this._upgradeConfig&&0!==this._upgradeConfig.myLen()||this._initUpgradeConfig(),this._upgradeConfig&&this._upgradeConfig[t]&&this._upgradeConfig[t][e]?this._upgradeConfig[t][e]:null},e.prototype.getGemSpaceListByType=function(t){return this._gemSpaceList[t]},e.prototype.setSelectSIds=function(t){this._upgradeSelectedSIds=t,n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_GEM_AUTO_SELECT_DATA)},e.prototype.getSelectSIds=function(){return this._upgradeSelectedSIds},e.prototype.checkIsCanUpgrade=function(t){if(!t||0===t.length)return 1;var e=t[0],i=t[4];return n.Account.getUserData().getLevel()<e?2:this.getUpgradeGemListWithCondition(t).length<i?3:1},e.prototype.getUpgradeGemListWithCondition=function(t){var e=t[1],i=t[2],n=t[3],a=[];for(var r in this._gemstoneList){var o=this._gemstoneList[r],s=o.getQuality(),l=o.getLevel(),c=o.getRuneType();o.isEquipped()&&s>=e&&l>=i&&c===n&&a.push(o)}return a},e.prototype.checkIsCanAwaken=function(t){if(!t||0===t.length)return 1;var e=t[3];return this.getAwakenGemListWithCondition(t).length<e?2:1},e.prototype.getAwakenGemListWithCondition=function(t){var e=t[0],i=t[1],n=t[2],a=[];for(var r in this._gemstoneList){var o=this._gemstoneList[r],s=o.getQuality(),l=o.getAwakenLv(),c=o.getRuneType();o.isEquipped()&&s>=e&&l>=i&&c===n&&a.push(o)}return a},e.prototype._requestGetGemstoneList=function(){var t={};t.module=n.MsgModuleName.GEMSTONE,t.cmd=n.MsgCmd.Gemstone.GET_GEMSTONE,n.ServerDelegate.sendMessage(t)},e.prototype._parseGemstoneList=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.runeList;i||(i=[]);for(var a=0;a<i.length;a++){var r=i[a],o=this._gemstoneList[r.runeId];o||(o=this._getNewGemstone(r)),o&&(this._gemstoneList[r.runeId]=o,o.setLevel(r.reinforceLevel),o.setLevelExp(r.exp),o.setAwakenLv(r.awakenLevel||0))}n.EventUtil.dispatchEvent(n.EventNameEnum.INIT_DATA_LOADED,n.LoadKey.Gemstone),n.EventUtil.dispatchEvent(n.EventNameEnum.GEMSTONE_CHANGED,i)}},e.prototype._pushDeleteGemstone=function(t,e){if(t===n.NetCode.SUCCESS){for(var i=e.runeIds,a=this._gemstoneList,r=0,o=i.length;r<o;r++){var s=i[r];a[s]&&delete a[s]}n.EventUtil.dispatchEvent(n.EventNameEnum.GEMSTONE_CHANGED)}},e.prototype._requestGemstoneUpgrade=function(t){var e={};e.module=n.MsgModuleName.GEMSTONE,e.cmd=n.MsgCmd.Gemstone.GEMSTONE_REINFORCE,e.runeId=t.curSid;for(var i=t.gemSids,a={},r=0,o=i.length;r<o;r++){var s=this.getGemstoneDataBySId(i[r]),l=s.getId(),c=s.getLevel();a[l]||(a[l]={}),a[l][c]||(a[l][c]=0),a[l][c]++}e.devourMap=a,n.ServerDelegate.sendMessage(e)},e.prototype._onGemstoneUpgradeReturn=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.GEMSTONE_STRENGTHEN_SUCCESS)},e.prototype._requestGemstoneAwaken=function(t){var e={};e.module=n.MsgModuleName.GEMSTONE,e.cmd=n.MsgCmd.Gemstone.GEMSTONE_AWAKEN,e.runeId=t.curSid,e.devourIds=t.gemSids,n.ServerDelegate.sendMessage(e)},e.prototype._onAwakenReturn=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.ON_GEMSTONE_AWAKEN_SUCCESS)},e.prototype._requestDecompose=function(t){if(t.type===n.DecomposeType.Gemstone){var e={};e.module=n.MsgModuleName.GEMSTONE,e.cmd=n.MsgCmd.Gemstone.GEMSTONE_DECOMPOSE,e.RuneIdList=t.idList,n.ServerDelegate.sendMessage(e)}},e.prototype._requestQuickHunt=function(t){var e={};e.module=n.MsgModuleName.HuntTreasure,e.cmd=n.MsgCmd.HuntTreasureCmd.QUICK_REFINE,e.vowType=t.type,e.times=t.times,e.synthesize=t.synthesize,n.ServerDelegate.sendMessage(e),this._lastQuickHuntTimes=t.times},e.prototype._onDecomposeReturn=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.rewardResult,a=n.RewardManager.parseRewardResult(i);n.EventUtil.dispatchEvent(n.EventNameEnum.DECOMPOSE_SUCCESS,a)}},e.prototype._initWishData=function(){if(!this._huntTreasureList||this._huntTreasureList.myLen()<=0){var t=n.GetTableClass(n.TableEnum.HuntTreasureTable).getData();for(var e in this._huntTreasureList={},t){var i=t[e];for(var a in this._huntTreasureList[e]={},i){var o=i[a],s=new r;s.init(o),this._huntTreasureList[e][s.getIndex()]=s}}}},e.prototype.getHuntDataListByType=function(t){return this._initWishData(),this._huntTreasureList[t]},e.prototype._getHuntTreasureInfo=function(t){var e={};e.module=n.MsgModuleName.HuntTreasure,e.cmd=n.MsgCmd.HuntTreasureCmd.GET_HUNT_TREASURE_INFO,n.ServerDelegate.sendMessage(e)},e.prototype._getHuntTreasureInfoReturn=function(t,e){t===n.NetCode.SUCCESS&&this._parseWishSpaceInfo(e)},e.prototype._requesHuntTreasure=function(t){var e={};e.module=n.MsgModuleName.HuntTreasure,e.cmd=n.MsgCmd.HuntTreasureCmd.DO_HUNT_TREASURE,e.vowId=t,n.ServerDelegate.sendMessage(e)},e.prototype._onHuntTreasureReturn=function(t,e){if(t===n.NetCode.SUCCESS){var i=e;n.EventUtil.dispatchEvent(n.EventNameEnum.ON_HUNT_TREASURE_RETURN,i)}},e.prototype._requesOneKeyHuntTreasure=function(t){var e={};e.module=n.MsgModuleName.HuntTreasure,e.cmd=n.MsgCmd.HuntTreasureCmd.QUICK_HUNT_TREASURE,e.vowType=t,n.ServerDelegate.sendMessage(e)},e.prototype._onOneKeyHuntTreasureReturn=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.vowList;n.EventUtil.dispatchEvent(n.EventNameEnum.ON_ONE_KEY_HUNT_RETURN,i)}},e.prototype._requestOneKeyPickup=function(t){var e={};e.module=n.MsgModuleName.HuntTreasure,e.cmd=n.MsgCmd.HuntTreasureCmd.QUICK_PICK_UP,e.vowType=t,n.ServerDelegate.sendMessage(e)},e.prototype._onOneKeyPickupReturn=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.ON_ONE_KEY_PICKUP_RETURN)},e.prototype._requestOneKeyCompose=function(t){var e={};e.module=n.MsgModuleName.HuntTreasure,e.cmd=n.MsgCmd.HuntTreasureCmd.QUICK_SYNTHESIS,e.vowType=t,n.ServerDelegate.sendMessage(e)},e.prototype._onOneKeyComposeReturn=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.exp||0;n.EventUtil.dispatchEvent(n.EventNameEnum.ON_ONE_KEY_COMPOSE_RETURN,i)}},e.prototype._onQuickHuntReturn=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.runeEntityList||[],a=e.fastCost,r=e.times,o=[];i.forEach(function(t){t.rewardObject.runeLevel=t.runeLevel,t.rewardObject.exp=t.exp,o.push(t.rewardObject)}),n.GlobalFunction.showRewards(o),n.EventUtil.dispatchEvent(n.EventNameEnum.ON_QUICK_HUNT_COST_RETURN,{fastCost:a,times:r})}},e.prototype._pushHuntTreasureInfo=function(t,e){t===n.NetCode.SUCCESS&&this._parseWishSpaceInfo(e)},e.prototype._parseWishSpaceInfo=function(t){this._gemSpaceList=this._gemSpaceList||{};var e=this._gemSpaceList,i=t.info;for(var r in i)if(i.hasOwnProperty(r)){var o=parseInt(r),s=e[o];s?s.resetData(i[o]):((s=new a).init(o,i[o]),e[o]=s)}n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HUNT_TREASURE_INFO)},e.prototype.isGemEquipRedPointTips=function(){},e.prototype.setPosGemRedPointStatus=function(t){var e=n.BattleArrayManager.getSelectBattleArrayIndex();this._posGemRedPointStatusMap[e]||(this._posGemRedPointStatusMap[e]={}),this._posGemRedPointStatusMap[e][t]=!0,n.EventUtil.dispatchEvent(n.EventNameEnum.GEM_RED_POINT_STATUS_CHANGED)},e.prototype.getCurSelectHeroGemByPosIndex=function(t){var e=n.BattleArrayManager,i=e.getBattleArrayData()[e.getSelectBattleArrayIndex()],a=(i?i.getGemstoneList():{})[t];return a?this.getGemstoneDataBySId(a):null},e.prototype.getCanSelectGemListBySid=function(t){var e=[],i=n.Quality.Yellow,a=this.getGemstoneData();for(var r in a)if(a.hasOwnProperty(r)){var o=a[r],s=o.isEquipped(),l=o.getQuality(),c=o.getType(),u=o.getSId(),d=o.getAwakenLv();s||u===t||d>0||0!==c&&l>=i||e.push(o)}return e},e.prototype.isGemPosCanUpgrade=function(t){if(!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.Gemstone,t))return!1;var i=n.BattleArrayManager.getSelectBattleArrayIndex();if(this._posGemRedPointStatusMap[i]&&this._posGemRedPointStatusMap[i][t])return!1;var a=this.getCurSelectHeroGemByPosIndex(t);if(!a)return!1;var r=n.GetConfig("gemRedTipLimitLevel"),o=a.getLevel();if(r<o)return!1;var s=a.getSId();if(this.getCanSelectGemListBySid(s).length<=0)return!1;var l=a.getUpgradeKey(),c=e.getInstance().getUpgradeModelByLevel(l,o).getCondition();return 1===this.checkIsCanUpgrade(c)},e.prototype.isGemPosCanAwaken=function(t){if(!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.GEMSTONE_AWAKE,0))return!1;var i=this.getCurSelectHeroGemByPosIndex(t);if(!i)return!1;var a=i.getSId(),r=i.getAwakenLv(),o=n.GetTableClass(n.TableEnum.GemAwakenConfig).getGemAwakenConfig(i.getId(),r+1);if(!o)return!1;var s=o.costs;if(!n.GamerResourceUtil.checkCost(s,n.GamerResourceUtil.TipType.None))return!1;if(o.devourCount>0&&e.getInstance().getCanDevourGemSIds(i.getId(),a).length<=0)return!1;var l=i.getAwakenCondition();return 1===this.checkIsCanAwaken(l)},e.prototype.isGemPosRedPointTips=function(t){return this.isGemPosCanUpgrade(t)||this.isGemPosCanAwaken(t)},e.prototype.GemPosRedPointEvents=function(){return[n.EventNameEnum.GEMSTONE_CHANGED,n.EventNameEnum.EQUIPPED_GEM_CHANGED,n.EventNameEnum.GEMSTONE_STRENGTHEN_SUCCESS,n.EventNameEnum.GEM_RED_POINT_STATUS_CHANGED]},e.prototype.isHuntTreasureTipsByType=function(t){},e.prototype.huntTreasureEvts=function(){},e.prototype.isBattleArrayOneEquipRedPointTips=function(){if(!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.Gemstone,1))return!1;var t=n.BattleArrayManager,e=t.getBattleArrayData();if(!e)return!1;var i,a,r=e[t.getSelectBattleArrayIndex()],o=r?r.getGemstoneList():{},s={},l={};for(var c in o){var u=o[c];1===(g=this.getGemstoneDataBySId(u)).getRuneType()?(s[g.getType()]=g,i&&!this.isReplaceable(g,i)||(i=g)):(l[g.getType()]=g,a&&!this.isReplaceable(g,a)||(a=g))}for(var d=n.MaxEnum.MaxGemstoneCount,h=0,p=0,_=1;_<=2*d;_++)n.UnlockManager.isTargetUnlock(n.ActorUnlockType.Gemstone,_)&&(_<=d?h++:p++);for(var c in this._gemstoneList){var g,f=(g=this._gemstoneList[c]).getType();if(!g.isEquipped()&&f)if(1===g.getRuneType()){if(h>0)if(s.myLen()<h){if(!s[f])return!0;if(this.isReplaceable(s[f],g))return!0}else if(this.isReplaceable(i,g)){if(!s[f])return!0;if(this.isReplaceable(s[f],g))return!0}}else if(p>0)if(l.myLen()<p){if(!l[f])return!0;if(this.isReplaceable(l[f],g))return!0}else if(this.isReplaceable(a,g)){if(!l[f])return!0;if(this.isReplaceable(l[f],g))return!0}}return!1},e.prototype.isReplaceable=function(t,e){return t.getQuality()<e.getQuality()||!(t.getQuality()>e.getQuality())&&(t.getAwakenLv()<e.getAwakenLv()||!(t.getAwakenLv()>e.getAwakenLv())&&(t.getLevel()<e.getLevel()||!(t.getLevel()>e.getLevel())&&t.getType()>e.getType()))},e.prototype.isBattleArrayRedPointTips=function(){if(!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.Gemstone,1))return!1;if(!n.BattleArrayManager.getBattleArrayData())return!1;for(var t=2*n.MaxEnum.MaxGemstoneCount,e=1;e<=t;e++){if(this.isGemPosRedPointTips(e))return!0}return!!this.isBattleArrayOneEquipRedPointTips()},e.prototype.openPanel=function(){n.GlobalFunction.setLocalSaveStatus("GemstonePanel",!0),n.EventUtil.dispatchEvent(n.EventNameEnum.OPEN_GEMSTONE)},e.prototype.setQuickAutoCompose=function(t){this._isAutoQuickCompose=t},e.prototype.getQuickAutoCompose=function(){return this._isAutoQuickCompose},e.prototype.getLastQuickHuntTimes=function(){return this._lastQuickHuntTimes},e.prototype.getOpenQuickHunt=function(){return this._openQuickHunt},e.prototype.setOpenQuickHunt=function(t){this._openQuickHunt=t},e.prototype.isRedPointTips=function(){if(!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.HuntTreasure,1))return!1;if(n.ItemManager.getItemNumById(n.ItemEnum.HUNT_GEM_ITEM)<=0)return!1;var t=n.GlobalFunction.getLocalSaveStatus("GemstonePanel");return!0!==t&&"true"!==t},e.prototype.redPointEvents=function(){return[n.EventNameEnum.ITEM_CHANGE,n.EventNameEnum.CHANGE_SELECT_HERO,n.EventNameEnum.OPEN_GEMSTONE]},e}();i.default=o,cc._RF.pop()},{GemSpaceModel:"GemSpaceModel",GemstoneModel:"GemstoneModel",HuntTreasureModel:"HuntTreasureModel"}],GemstoneModel:[function(t,e,i){"use strict";cc._RF.push(e,"0654dK5Za9GtadrNFGLiQTQ","GemstoneModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=t("PropertyModel"),o=t("../Manager/GemstoneManager"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._goodsType=a.GoodsType.Type_Gemstone,e._desc="",e._type=0,e._quality=0,e._gemMaxCount=0,e._maxLevel=0,e._engulfedExp=0,e._bigIconRes="",e._level=0,e._levelExp=0,e._levelUpCostExp=0,e._needExp=0,e._isAddBattle=!1,e._count=1,e._upCondition=0,e._isSelected=!1,e._rare=0,e._awakenLv=0,e}return n(e,t),e.prototype.init=function(e){if(e&&(t.prototype.init.call(this,"GemstoneModel",a.UserPropertyEnum.Gemstone,e.configId,e.name,e.icon,null,e.animationType),this._desc=e.des,this._type=e.runeAttributeType,this._runeType=e.runeType,this._quality=e.qualityType,this._gemMaxCount=e.runeMaxCount,this._obtainWay=e.obtainWay||[],this._decompose=e.decompose||[],this._engulfedExp=e.engulfedExp,this._bigIconRes=e.bigIconRes||"",this._rare=e.rareSymbol,0!==this._type)){var i=a.GetTableClass(a.TableEnum.GemstoneUpgradeTable);this._maxLevel=i.getMaxLevelById(this._id);var n=i.getBaseDataById(this._id);n&&(this._baseAttrValue=n.attributes,this._baseAttrPer=n.attributeTTPercent,this._upCondition=n.condition),this._canAwaken=null,this._awakenLv=0}},e.prototype.getGoodsType=function(){return this._goodsType},e.prototype.getQuality=function(){return this._quality},e.prototype.getDes=function(){return this._desc},e.prototype.getObtainWay=function(){return this._obtainWay},e.prototype.setCount=function(t){this._count=t},e.prototype.getCount=function(){return this._count},e.prototype.getBaseAttrValue=function(){return this._baseAttrValue},e.prototype.getBaseAttrPer=function(){return this._baseAttrPer},e.prototype.getType=function(){return this._type},e.prototype.getAttrTypr=function(){return[[this._type]]},e.prototype.getGemstoneMaxCount=function(){return this._gemMaxCount},e.prototype.getRuneType=function(){return this._runeType},e.prototype.getCondition=function(){return this._upCondition},e.prototype.getMaxLevel=function(){return this._maxLevel},e.prototype.setEquipped=function(t){this._isAddBattle=t},e.prototype.isEquipped=function(){return this._isAddBattle},e.prototype.getBigIconRes=function(){return this._bigIconRes},e.prototype.getRare=function(){return this._rare},e.prototype.getUpgradeKey=function(){return this._id},e.prototype.canAwaken=function(){return null===this._canAwaken&&(this._canAwaken=a.GetTableClass(a.TableEnum.GemAwakenConfig).canAwaken(this._id)),this._canAwaken},e.prototype.setAwakenLv=function(t){this._awakenLv=t},e.prototype.getAwakenLv=function(){return this._awakenLv},e.prototype.isAwakenMax=function(){var t=a.GetTableClass(a.TableEnum.GemAwakenConfig).getGemAwakenConfig(this._id,this._awakenLv);return!t||0===t.nextLevel||!a.GetTableClass(a.TableEnum.GemAwakenConfig).getGemAwakenConfig(this._id,this._awakenLv+1)},e.prototype.setLevel=function(t){if(this._level!==t){this._level=t,this._levelUpCostExp=0,this._needExp=0;var e=o.default.getInstance().getUpgradeConfig()[this._id];if(e){for(var i=0;i<t;i++){var n=e[i];n&&(this._levelUpCostExp+=n.getNeedExp())}var a=e[t];a&&(this._needExp=a.getNeedExp())}}},e.prototype.getAwakeCost=function(){if(this.canAwaken()){var t=a.GetTableClass(a.TableEnum.GemAwakenConfig).getGemAwakenConfig(this._id,this._awakenLv);if(!t)return[];var e=t.nextLevel;if(0!==e){var i=a.GetTableClass(a.TableEnum.GemAwakenConfig).getGemAwakenConfig(this._id,e);return i?i.costs:[]}}return[]},e.prototype.getAwakeDevourCount=function(){if(this.canAwaken()){var t=a.GetTableClass(a.TableEnum.GemAwakenConfig).getGemAwakenConfig(this._id,this._awakenLv);if(!t)return 0;var e=t.nextLevel;if(0!==e){var i=a.GetTableClass(a.TableEnum.GemAwakenConfig).getGemAwakenConfig(this._id,e);return i?i.devourCount:0}}return 0},e.prototype.getLevel=function(){return this._level},e.prototype.setLevelExp=function(t){this._levelExp=t},e.prototype.getLevelExp=function(){return this._levelExp},e.prototype.geLevelUpNeedExp=function(){return this._needExp},e.prototype.getLevelUpCostExp=function(){return this._levelUpCostExp},e.prototype.getEngulfedExp=function(){return this._engulfedExp},e.prototype.getOfferLevelExp=function(){var t=a.GetConfig("VOW_EXP_LOSS_POINT");return Math.floor((this._levelUpCostExp+this._levelExp)*t/1e4)+this._engulfedExp},e.prototype.getDecomposeGetProp=function(){return this._decompose},e.prototype.getLevelAttr=function(t,e){var i=0,n=o.default.getInstance().getUpgradeLevelData(this._id,this._level);return n?i=n.getAttributeByType(t,e):i},e.prototype.getAttrAddition=function(t){if(0===this._type)return{};var e=[],i=t?this._baseAttrPer:this._baseAttrValue;if(!i||""===i)return{};var n=i[0],r=[];r[0]=n[0],r[1]=n[1];var o=this.getLevelAttr(r[0],t);0!==o&&(r[1]=o);var s=a.GetTableClass(a.TableEnum.GemAwakenConfig).getGemAwakenConfig(this._id,this._awakenLv);if(s){var l=s.attributesAddition;l&&(r[1]+=a.PercentNumberUtil.getPercentValue(r[1],l))}return e[e.length]=r,a.GlobalFunction.parseEffectArray(e)},e.prototype.getTargetLevelAttr=function(t,e,i){var n=0,a=o.default.getInstance().getUpgradeLevelData(this._id,e);return a?n=a.getAttributeByType(t,i):n},e.prototype.getTargetLevelAddition=function(t,e){if(this._maxLevel===this._level)return this.getAttrAddition(e);var i=[],n=e?this._baseAttrPer:this._baseAttrValue;if(!n||""===n)return{};var r=n[0],o=[];o[0]=r[0],o[1]=r[1];var s=this.getTargetLevelAttr(o[0],t,e);return 0!==s&&(o[1]=s),i[i.length]=o,a.GlobalFunction.parseEffectArray(i)},e.prototype.getAttrStr=function(t){var e=this.getType(),i=this.getAttrAddition(t)[e];return i?t?(i.getOperateValue()/100).toFixed(2)+"%":a.GlobalFunction.getAttrValueStrByType(e,i.getOperateValue(),2):""},e.prototype.getTotalAttr=function(){var t={},e={},i=this.getAttrAddition(!1),n=this.getAttrAddition(!0);for(var r in i)t[r]?t[r]+=i[r]._operateValue:t[r]=i[r]._operateValue;for(var r in n)e[r]?e[r]+=n[r]._operateValue:e[r]=n[r]._operateValue;return 2!==this._runeType||1!==this._type&&2!==this._type&&3!==this._type&&4!==this._type?(a.GlobalFunction.getAttrMultipyAttrTT(t,e),t):e},e.prototype.getTargetLevelAttrStr=function(t,e){var i=this.getType(),n=this.getTargetLevelAddition(t,e)[i];if(!n)return"";var r=a.GetTableClass(a.TableEnum.GemAwakenConfig).getGemAwakenConfig(this._id,this._awakenLv);return r&&(n._operateValue=n.getOperateValue()*(1+r.attributesAddition/1e4)),e?(n.getOperateValue()/100).toFixed(2)+"%":a.GlobalFunction.getAttrValueStrByType(i,Math.floor(n.getOperateValue()))},e.prototype.getAwakenCondition=function(){var t=a.GetTableClass(a.TableEnum.GemAwakenConfig).getGemAwakenConfig(this._id,this._awakenLv+1);return t?t.condition:[]},e.prototype.setSelected=function(t){this._isSelected=t},e.prototype.isSelected=function(){return this._isSelected},e}(r);e.exports=s,cc._RF.pop()},{"../Manager/GemstoneManager":"GemstoneManager",PropertyModel:"PropertyModel"}],GemstoneTable:[function(t,e,i){"use strict";cc._RF.push(e,"fba729+qYBCA6dRY0p1RMHO","GemstoneTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GemstoneTable",properties:{_tblName:"rune_config",_gemstoneData:null,_luckIds:null},init:function(){var t=this;this._gemstoneData={},this._luckIds=[];for(var e=this._gemstoneData,i=this._jsonData,n=0,a=i.length;n<a;++n){var r=i[n];if(e[r.configId]=r,r.decomposeRandomRewards&&r.decomposeRandomRewards.length>0)r.decomposeRandomRewards.forEach(function(e){for(var i=e[0],n=0;n<i.length;n++){var a=i[n][1];-1===t._luckIds.indexOf(a)&&t._luckIds.push(a)}})}},getGemstoneTable:function(){return this._gemstoneData},getGemstoneById:function(t){return this._gemstoneData[t]},getLuckIds:function(){return this._luckIds}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GemstoneUpgradeTable:[function(t,e,i){"use strict";cc._RF.push(e,"ac38bc/Jf9DT6RXxJgSJpxO","GemstoneUpgradeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GemstoneUpgradeTable",properties:{_tblName:"rune_reinforce_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}},getUpgradeLevelData:function(){return this._data},getBaseDataById:function(t){for(var e=0,i=this._data.length;e<i;++e){var n=this._data[e];if(1===n.level&&n.runeId===t)return n}},getMaxLevelById:function(t){for(var e=0,i=0,n=this._data.length;i<n;++i){var a=this._data[i];a.level>e&&a.runeId===t&&(e=a.level)}return e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GlobalFunction:[function(t,e,i){"use strict";cc._RF.push(e,"90963e6GFBIP7ejx3EKtOnY","GlobalFunction");var n=h(t("../Treasure/Model/TreasureModel")),a=h(t("../Hero/Model/HeroModel")),r=h(t("../Hero/Model/HeroRuneModel")),o=h(t("../Gem/Model/GemstoneModel")),s=h(t("../OtherBattleArray/Manager/OtherBattleArrayManager")),l=h(t("../Roam/Manager/RoamManager")),c=h(t("../../Configs/ids/PanelId")),u=h(t("../Pet/Model/PetModel")),d=h(t("../Shop/Manager/ShopManager"));function h(t){return t&&t.__esModule?t:{default:t}}var p=t("CommonIconWidget"),_=t("AvatarHeadWidget"),g=t("TimerLabel2"),f=t("SpriteAnimation"),v=t("NodePoolManager");td.GlobalFunction={_lastClickTime:0,_commonIconSprite:null,clearData:function(){this._lastClickTime=0,this._commonIconSprite=null},showConfirmWindow:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,{panelName:td.PanelEnum.Window_ConfirmTip,callback:{func:function(t,e){e.setData(t)},param:t}})},showUseOrExchangeWindow:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,{panelName:td.PanelEnum.Window_AddSubConfirm,callback:{func:function(t,e){e.setData(t)},param:t}})},showBuyTimesWindow:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,{panelName:td.PanelEnum.Window_BuyTimes,callback:{func:function(t,e){e.setData(t)},param:t}})},showRewardPreviewWindow:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,{panelName:td.PanelEnum.Window_RewardPreview,callback:{func:function(t,e){e.setData(t)},param:t}})},addChildByUrl:function(t,e,i){cc.loader.loadRes(t,e,function(t,e){if(!t){var n=cc.instantiate(e);i.addChild(n)}})},pad:function(t,e){return e-(""+t).length<=0?t+"":Array(e-(""+t).length+1).join(0)+t},showRewards:function(t,e,i,n,a){if(t.length>0){var r={};r.retList=t,r.content=i,r.closeCb=n,r.titleType=a,e&&(r.type=td.RewardDialogType.Move);var o={};o.panelName=td.PanelEnum.Window_GetReward,o.callback={func:function(t,e){e.refUI(t)},param:r},td.GlobalFunction.showPanel(o)}},showPanel:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,{panelName:t.panelName,callback:t.callback})},showPanelDirect:function(t,e,i){if(null!=e){var n=c.default[t];if(null!=n)if(gdk.rm.getResByUrl(n.prefab,cc.Prefab))this._createShowPanel(e,n,i);else{var a=td.GlobalFunction.getResIdByNode(e);gdk.rm.loadRes(a,n.prefab,cc.Prefab,this._createShowPanel.bind(this,e,n,i))}}},_createShowPanel:function(t,e,i){if(null!=t){var n=gdk.rm.getResByUrl(e.prefab,cc.Prefab);n=cc.instantiate(n),t.addChild(n);var a=n.getComponent(e.module);a&&a.setData&&a.setData(i)}},disableStroke:function(t){var e,i=t.getComponent(cc.Label);if(i)e=t.getComponent(cc.LabelOutline);else{var n=t.getChildByName("Label");null!==n&&void 0!==n||(n=t.getChildByName("lable")),n&&(i=n.getComponent(cc.Label))&&(e=t.getComponent(cc.LabelOutline))}e&&((e=t.addComponent(cc.LabelOutline)).enabled=!1)},strokeFunction:function(t,e,i){if(t){e=e||cc.color(0,0,0),i=i||1;var n,a=t.getComponent(cc.Label);if(a)n=t.getComponent(cc.LabelOutline);else{var r=t.getChildByName("Label");null!==r&&void 0!==r||(r=t.getChildByName("lable")),r&&(a=r.getComponent(cc.Label))&&(n=t.getComponent(cc.LabelOutline))}void 0!==n&&null!==n||(n=t.addComponent(cc.LabelOutline)),n.width=i,n.color=e,n.enabled=!0}},setStarPanel:function(t,e,i,n){var a=t.getChildByName("Star_2").x-t.getChildByName("Star_1").x;n=n||t.getChildByName("Star_1").x;var r=t.getChildren(),o=r.length;if(o<e)for(var s=t.getChildByName("Star_1"),l=o+1;l<=e;l++){var c=cc.instantiate(s);t.addChild(c),c.setName("Star_"+l),c.y=s.y}o=(r=t.getChildren()).length;for(var u=0,d=0;d<o;d++){t.getChildByName("Star_"+(d+1)).active=d+1<=e,d+1<=e&&u++}i&&(n+=a*(o-u)/2);for(d=0;d<u;d++){t.getChildByName("Star_"+(d+1)).x=n,n=a+n}},copyData:function(t){(new Date).getTime();if(null===t)return null;if("object"!=typeof t)return t;if(t.constructor===Date)return new Date(t);if(t.constructor===RegExp)return new RegExp(t);var e=new t.constructor;for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];e[i]="object"==typeof n?this.copyData(n):n}return e},getHeroAttrsStr:function(t){var e=td.Language,i=e.attack,n=e.hp;return[[i,t.getAttack()],[n,t.getHp()]]},getArtifactBaseAttrsEffectStr:function(t){var e=t.getBaseAttr(),i=[],n=td.AttrStr,a=td.Language;for(var r in e)void 0!==e[r]&&null!==e[r]&&(i[i.length]=[a[n[r]],"+"+e[r]]);return i},getEquipAttrsEffectStr:function(t){var e=[];if(!t)return e;var i=td.Language,n=td.AttrStr,a=t.getAttr(),r=a[0],o=a[1];return cc.assert(o>0,"attrValue must bigger than 0"),e.push([i[n[r]],"+"+o]),e},getItemIcon:function(t,e,i,n){var a=this.getGoodsData(e,i,n);return a?this.createCommonIconWidget(t,a):null},getGoodsData:function(e,i,s){void 0===s&&(s=1);var l=null,c=td.GoodsType;switch(e){case c.Type_Item:(l=new td.Item).init(td.GetTableClass(td.TableEnum.Item).getItemById(i)),l&&l.setCount&&s&&l.setCount(s);break;case c.Type_Mercenary:(l=new a.default).init(td.GetTableClass(td.TableEnum.HeroTable).getHeroById(i)),l.setCount(s);break;case c.Type_Equip:(l=new(t("EquipModel"))).setCount(s),l.init(td.GetTableClass(td.TableEnum.EquipmentTable).getDataById(i));break;case c.Type_Gemstone:(l=new o.default).init(td.GetTableClass(td.TableEnum.GemstoneTable).getGemstoneById(i)),l.setCount(s),l.setLevel(1);break;case c.Type_Treasure:(l=new n.default).init(td.GetTableClass(td.TableEnum.TreasureTable).getTreasureById(i)),l.setCount(s);break;case c.Type_HeroRune:(l=new r.default).init(td.GetTableClass(td.TableEnum.HeroRuneTable).getHeroRuneById(i)),l.setCount(s);break;case c.Type_Artifact:(l=new(t("HeroArtifactModel"))).init(td.GetTableClass(td.TableEnum.HeroArtifactTable).getDataByArtifactId(i)),l.setCount(s);break;case c.Type_Spirit:(l=new(t("SpiritModel"))).init(td.GetTableClass(td.TableEnum.SpiritTable).getSpiritById(i)),l.setCount(s);break;case c.Type_Pet:(l=new u.default).init(td.GetTableClass(td.TableEnum.PetTable).getPetById(i)),l.setCount(s)}return l},_getNodeBase:function(t){if(!t||t instanceof cc.Scene)return td.PanelManager.getInstance().getCurShowPanel();var e=t.getComponent("PanelBase");return e||td.GlobalFunction._getNodeBase(t.parent)},getResIdByNode:function(t){var e=td.GlobalFunction._getNodeBase(t);return e?e.resId:null},createSpriteNode:function(t,e,i,n,a){if(cc.isValid(t)){void 0===i&&(i=cc.SpriteFrame);var r=t.getComponent(cc.Sprite);if(null!==r&&void 0!==r||(r=t.addComponent(cc.Sprite)),e)if("string"==typeof e){var o=i==cc.SpriteFrame?e:e+"#"+n;r._$_resId_=o,gdk.rm.loadRes(this.getResIdByNode(t),e,i,function(t){r.node&&r._$_resId_==o&&(i==cc.SpriteFrame?r.spriteFrame=t:i==cc.SpriteAtlas&&(r.spriteFrame=t.getSpriteFrame(n)),delete r._$_resId_,a&&a())})}else r.spriteFrame=e}},createPrefabInstance:function(t){var e=gdk.rm.getResByUrl(t,cc.Prefab);return null!==e&&void 0!==e?cc.instantiate(e):null},createSprite:function(t,e,i){this.createSpriteNode(e,t,cc.SpriteFrame,"",i)},createAltasSprite:function(t,e,i){var n=this,a=i.getComponent(cc.Sprite);a||(a=i.addComponent(cc.Sprite)),gdk.rm.loadRes(this.getResIdByNode(i),t,cc.SpriteAtlas,function(){if(cc.isValid(a)){var i=n.getAltasFrame(t,e);a.spriteFrame=i}})},getAltasFrame:function(t,e){return gdk.rm.getResByUrl(t,cc.SpriteAtlas).getSpriteFrame(e)},replaceAll:function(t,e,i){for(;t.indexOf(e)>=0;)t=t.replace(e,i);return t},createConfirmBroadcastTipWindow:function(e,i,n){var a=t("ConfirmBroadcastTipWindow"),r=td.PanelEnum.Window_ConfirmBroadcastTip,o=gdk.PanelId.getValue(r),s=gdk.rm.getResByUrl(o.prefab,cc.Prefab);if(s){var l=cc.instantiate(s),c=l.getComponent(a);c||(c=l.addComponent(a)),c.init(),c.setData(e),i.addChild(l,n)}else gdk.rm.loadResByPanel(r,null,null,function(t){if(!t){var r=gdk.rm.getResByUrl(o.prefab);if(r){var s=cc.instantiate(r),l=s.getComponent(a);l.init(),l.setData(e),i.addChild(s,n)}}})},createClickEventHandler:function(t,e,i,n){var a=new cc.Component.EventHandler;return a.target=t,a.component=e,a.handler=i,a.customEventData=n,a},createLabel:function(t,e,i){var n=new cc.Node,a=n.addComponent(cc.Label);if("string"==typeof e&&null!==e){var r=gdk.rm.getResByUrl(e,cc.LabelAtlas);a.font=r}return a.string=t,i&&(a.fontSize=i),n},createCommonIconWidget:function(t,e,i,n){i=i||!1,n=n||!1;var a=v.getNode(td.NodePoolType.CommonIconWidget);a?a.addComponent(p):(this._commonIconSprite||(this._commonIconSprite=this.createPrefabInstance("prefab/CommonView/CommonIconWidget"),this._commonIconSprite.addComponent(p)),a=cc.instantiate(this._commonIconSprite));var r=a.getComponent(p);return r.init(t,e,n),r.setTouchEnabled(!i),a},createAvatarHeadWidget:function(t,e,i){i=i||!1;var n=this.createPrefabInstance("prefab/CommonView/AvatarHead"),a=n.getComponent(_);return a.init(t,e),a.setTouchEnabled(!i),n},setImageContentSize:function(t,e){if(e){var i=e.indexOf(".png");i<0&&(i=e.indexOf(".jpg")),i>-1&&(e=e.substr(0,i));var n=td.GetResourceSize(e);n?n&&n[0]>0&&t.setContentSize(n[0],n[1]):cc.log("no content size data of "+e)}},getABC:function(t,e){var i={};return t.x===e.x?(i.B=0,i.A=1,i.C=-t.x,i):t.y===e.y?(i.A=0,i.B=1,i.C=-t.y,i):(i.B=-1,i.A=(e.y-t.y)/(e.x-t.x),i.C=t.y-i.A*t.x,i)},getCrossPoint:function(t,e){var i,n,a=this._getABC(t[0],t[1]),r=this._getABC(e[0],e[1]);if(0===a.A&&(n=-a.C/a.B,cc.assert(0!==r.A,"parrallel line no cross point"),i=-(r.B*n+r.C)/r.A),0===r.A&&(n=-r.C/r.B,cc.assert(0!==a.A,"parrallel line no cross point"),i=-(a.B*n+a.C)/a.A),0===a.B&&(i=-a.C/a.A,cc.assert(0!==r.B,"parrallel line no cross point"),n=-(r.C+r.A*i)/r.B),0===r.B&&(i=-r.C/r.A,cc.assert(0!==a.B,"parrallel line no cross point"),n=-(a.C+a.A*i)/a.B),void 0===i){var o=a.B-a.A*r.B/r.A;cc.assert(0!==o,"parrallel line no cross point"),n=(a.A*r.C/r.A-a.C)/o,i=-(a.B*n+a.C)/a.A}return(i>1e3||i<-50)&&cc.log("x:"+i),(n>1200||n<-50)&&cc.log("y:"+n),cc.v2(i,n)},getDistanceSQ:function(t,e){return(t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)},getDistance:function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},getRotation:function(t,e){var i=Math,n=e.x-t.x,a=e.y-t.y,r=180*i.atan2(a,n)/i.PI;return r<=0?-r:360-r},parseAttrArray:function(t){var e={};if(!t||0===t.length)return e;for(var i=0;i<t.length;i++){var n=t[i];if(!n||0===n.length)break;e[n[0]]=n[1]}return e},parseEffectArray:function(t){var e={};if(!t||0===t.length)return e;for(var i=0;i<t.length;i++){var n=t[i];if(!n||0===n.length)break;"24"===n[0]&&cc.log("test");var a=td.SkillEffectManager.getSkillEffect(n[0],n[1]);e[a.getAttrType()]=a}return e},calculateExpression:function(t,e){var i=[];if(e instanceof Array)i=[0].concat(e);else{for(var n in e)i[n]=e[n];for(var a=0,r=i.length;a<r;a++)i[a]=i[a]||0}return t=t.replace(/x/g,"$"),binding.eval(t,i)},setButtonGray:function(t,e){t.node||(t=t.getComponent(cc.Button));var i=t.node.getChildByName("Background")||t.node,n=i.getChildByName("Label");if(n||(n=i.getChildByName("label")),e)n&&(n.color=cc.color(87,87,87));else switch(t.getComponent(cc.Sprite).spriteFrame.name){case"GY_anniu_01":case"GY_anniu_02":case"GY_anniu_04":case"GY_anniu_06":n&&(n.color=cc.color(176,79,0));break;case"GY_anniu_01_ls":case"GY_anniu_03":case"GY_anniu_05":case"GY_anniu_07":n&&(n.color=cc.color(16,98,161))}t.enableAutoGrayEffect=e,t.interactable=!e},getSimpledNumStr:function(t,e){return t<(e=e||1e5)?t:Math.floor(t/1e4)+td.Language.tenThousand},getSimpledNumStrWan:function(t,e){if(t<(e=e||1e5))return t;var i=Math.floor(t/1e8),n=Math.floor(t%1e8/1e4),a=i>0?i+td.Language.oneHundredMillion:"";return a+=n>0?n+td.Language.tenThousand:""},getRoundSimpledNumStrWan:function(t,e){if(t<(e=e||1e5))return t;var i=0;i=t/1e8>=1?Math.round(t/1e8):0;var n=1e8*Math.round(t/1e8);t<1e8&&(n=t);var a=Math.round(n%1e8/1e4),r=i>0?i+td.Language.oneHundredMillion:"";return r+=a>0?a+td.Language.tenThousand:""},gatMessageLenEncodeByUtf8:function(t){for(var e=encodeURIComponent(t),i=[],n=0;n<e.length;n++){var a=e.charAt(n);if("%"===a){var r=e.charAt(n+1)+e.charAt(n+2),o=parseInt(r,16);i.push(o),n+=2}else i.push(a.charCodeAt(0))}return i.length},setNameColors:function(t,e,i){void 0===i&&(i=1),cc.isValid(t)&&(t.color=td.QualityColors[e],i&&this.strokeFunction(t,td.QualityStrokeColors[e],i))},setButtonTitle:function(t,e){var i=t.getChildByName("Label");(i||(i=t.getChildByName("label")),i)&&(i.getComponent(cc.Label).string=e)},createArmyFlagWidget:function(t,e,i,n){var a=t.getChildByName("flagImg");e="XM_qizi0"+e,n&&(e+="_x"),this.createAltasSprite(td.resDef.pngPlist.XM_xianmeng,e,a),t.getChildByName("flagLabel").getComponent(cc.Label).string=i},createRichText:function(t,e,i){void 0===i&&(i=!1);var n=new cc.Node;return n.addComponent(cc.RichText).handleTouchEvent=i,n.addComponent(td.UFRichText).init(t,e),n},getRichText:function(t){if(t){var e="string"==typeof t?td.UFRichTextParser.parseXML(t,this._quality):t;return e=td.UFRichTextParser.splitLineBreak(e),this.getRichTextContent(e)}cc.log("richText set str is null")},getRichTextContent:function(t){for(var e="",i="",n="",a=0;a<t.length;a++){var r=t[a];if(e="",i="","text"===r.type){var o=r.style||{},s=o.color||this._ufFontColor;if(s&&(e=e+"<color="+(s="#"+s.toHEX())+">",i="</color>"+i),o.size&&(e=e+"<size="+o.size+">",i="</size>"+i),o.strokeColor){var l=o.strokeColor||cc.color(0,0,0);e=e+"<outline color="+(l="#"+l.toHEX())+" width="+(o.strokeWidth||1)+">",i="</outline>"+i}e+=r.content}else"img"===r.type&&(e="<img src="+r.content+"/>");n=n+e+i}return n},setAttrPanel:function(t,e){td.AttrShowColor;var i,n,a,r,o,s=td.Language,l=td.AttrStr,c=1;for(var u in e){if(i=e[u],void 0===(n=t.getChildByName("AttrItem"+c))||null===n)break;n.getComponent(cc.Label).string=s[l[u]]+"\uff1a",(a=t.getChildByName("CurNum"+c)).getComponent(cc.Label).string=i.curNum,(o=t.getChildByName("nextAttrItem"+c))&&(o.getComponent(cc.Label).string=s[l[u]]+"\uff1a"),(r=t.getChildByName("NextNum"+c))&&(r.getComponent(cc.Label).string=i.nextNum),c++}for(;n=t.getChildByName("AttrItem"+(c+1)),a=t.getChildByName("CurNum"+(c+1)),r=t.getChildByName("NextNum"+(c+1)),o=t.getChildByName("nextAttrItem"+(c+1)),n;c++)n.active=!1,a.active=!1,r&&(r.active=!1)},getNumberStrWithPrecision:function(t,e,i){var n="number"==typeof t&&t>=0,a="number"==typeof e;if(cc.assert(n,"precision must be a number big or equals than 0!!!"),cc.assert(a,"number must be a number!!!"),!n||!a)return e;if(this._regexs=this._regexs||[],0===t)return(i?Math.ceil(e):Math.floor(e))+"";if(!(r=this._regexs[t])){var r=this._createRegex(t);this._regexs[t]=r}return(e+"").replace(r,"$1")},_createRegex:function(t){var e="var regex = /([0-9]+.[0-9]{"+t+"})[0-9]*/;";return new RegExp(cc.js.formatStr("([0-9]+.[0-9]{%s})[0-9]*",e))},showMercenaryFigureAnimation:function(t,e,i,n,a,r){void 0===i&&(i=!1),void 0===n&&(n=!1),void 0===a&&(a=0),void 0===r&&(r=!1);var o=t.getComponent(f);o||(o=t.addComponent(f)),o.setIsInBattle(!1),o.init(e,null,i,n,a,r)},createTimeLable2:function(t,e,i,n,a,r){var o=this.createLabel("",i,e);this.addTimeLabel2(o,t,n,a,r);return o},downAndPlayAnim:function(t,e,i,n,a,r,o,s){n=n||"animNode",a=a||1,r=r||cc.v2(0,0),s=s||0;var l=function(e){if(t&&t.parent){var l=t.getChildByName(n);if(l&&l.removeFromParent(),l=cc.instantiate(e))if(l.setScale(a),l.setPosition(r),l.setName(n),t.addChild(l,s),i&&""!==i&&l.getComponent(cc.Animation).play(i),o)l.getComponent(cc.Animation).on("finished",o)}},c=td.GlobalFunction._getNodeBase(t);c=c?c.getPanelEnum():null,gdk.rm.loadRes(c,e,cc.Prefab,function(t){l(t)})},addTimeLabel2:function(t,e,i,n,a){var r=t.getComponent(g);r||(r=t.addComponent(g)),r.init(e,i,n,a)},createGamerResourceNode:function(){var t=new cc.Node;return t.addComponent(td.GamerResourceNode),t},computeStringNumber:function(t){for(var e=0,i=t.length,n=-1,a=0;a<i;a++)e+=(n=t.charCodeAt(a))>=0&&n<=128?1:3;return e},computeStringNumber1:function(t){for(var e=0,i=t.length,n=-1,a=0;a<i;a++)e+=(n=t.charCodeAt(a))>=0&&n<=128?1:2;return e},getShareConfigUpCostDetail:function(t,e){var i=td.GlobalFunction.getShareConfigUpCost(t,e);return i&&i.length>0?td.RewardManager.getRewardDetail(i):null},getShareConfigUpCost:function(t,e){var i=td.GetConfig(t);return i?this.getUpCost(i,e):(cc.warn("get share config cost error for : "+t),null)},getUpCost:function(t,e){for(var i=t.length-1;i>=0;i--){if(e>=t[i][0])return t[i][1]}return null},getShareConfigUpCostCount:function(t,e){var i=td.GlobalFunction.getShareConfigUpCost(t,e);return i&&i.length>0?i[2]:0},getArtifactAttrsEffectStr:function(t){var e={};if(!t)return e;var i=td.Language,n=td.AttrStr,a=t.getFixedAttributePer();for(var r in a)e[0]||(e[0]=""),e[0]+=i[n[r]]+":"+a[r]/100+"%";var o=t.getWashAttrs();for(var s in o){var l=o[s],c=(r=l.getType(),l.getValue());!l.isAbsolute()&&(c=c/100+"%"),e[s]||(e[s]=""),e[s]+=i[n[r]]+"\uff1a"+c}return e},setLabelGray:function(t,e){if(cc.isValid(t)){var i,n=t.getComponent(cc.Label);if(n)e?((i=this._grayMaterial)||(i=cc.Material.getBuiltinMaterial("2d-gray-sprite")),i=this._grayMaterial=cc.MaterialVariant.create(i,n)):((i=this._normalMaterial)||(i=cc.Material.getBuiltinMaterial("2d-sprite",n)),i=this._normalMaterial=cc.MaterialVariant.create(i,n)),n.setMaterial(0,i),n._forceUpdateRenderData()}},graySprite:function(t,e){if(cc.isValid(t)){var i,n=t.getComponent(cc.Sprite);if(n)e?((i=this._grayMaterial)||(i=cc.Material.getBuiltinMaterial("2d-gray-sprite")),i=this._grayMaterial=cc.MaterialVariant.create(i,n)):((i=this._normalMaterial)||(i=cc.Material.getBuiltinMaterial("2d-sprite",n)),i=this._normalMaterial=cc.MaterialVariant.create(i,n)),n.setMaterial(0,i)}},getTimeStringByDeltaTime:function(t){var e=td.Language,i=td.RegexUtil,n=i.pad(Math.floor(t/864e5),2),a=i.pad(Math.floor((t-864e5*n)/36e5),2),r=i.pad(Math.floor((t-864e5*n-36e5*a)/6e4),2),o=i.pad(Math.floor((t-864e5*n-36e5*a-6e4*r)/1e3),2),s="";return n>0&&(s=n+e.day),s+=a+e.hour+r+e.minutes+o+e.second},getConvertTimeFormat:function(t){if(t<=0)return"00:00:00";var e=parseInt(t/60/60),i=parseInt(t/60%60),n=parseInt(t%60);return e<=9&&(e="0"+e),i<=9&&(i="0"+i),n<=9&&(n="0"+n),e+":"+i+":"+n},convertTimestamp:function(t,e){var i=e||"HH:mm:ss",n=parseInt(t/24/60/60),a=t-24*n*60*60,r=parseInt(a/60/60),o=parseInt(a/60%60),s=parseInt(a%60);return n<=9&&(n="0"+n),r<=9&&(r="0"+r),o<=9&&(o="0"+o),s<=9&&(s="0"+s),i=(i=(i=(i=i.replace("dd",n)).replace("HH",r)).replace("mm",o)).replace("ss",s)},convertTimestamp2:function(t,e){var i=e||"HH:mm:ss",n=parseInt(t/24/60/60),a=t-24*n*60*60,r=parseInt(a/60/60),o=parseInt(a/60%60),s=parseInt(a%60);return n<=9&&(n="0"+n),(r=24*n+r)<=9&&(r="0"+r),o<=9&&(o="0"+o),s<=9&&(s="0"+s),i=(i=(i=(i=i.replace("dd",n)).replace("HH",r)).replace("mm",o)).replace("ss",s)},getConvertTimeStr:function(t,e){if(void 0===e&&(e=!1),t<=0)return"00:00:00";var i,n=parseInt(t/60/60);e&&(i=parseInt(t/24/60/60),n=parseInt(t/60/60%24));var a=parseInt(t/60%60),r=parseInt(t%60);n<=9&&(n="0"+n),a<=9&&(a="0"+a),r<=9&&(r="0"+r);var o=td.Language;return e?i+o.day+n+o.hour+a+o.minutes+r+o.second:n+o.hour+a+o.minutes+r+o.second},randomInt:function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},random:function(t,e){var i=Math.random()*(e-t)+t;return i},getConfigOfTimes:function(t,e){var i;if(!e)return 0;e.sort(function(t,e){return t[0]-e[0]});for(var n=0;n<e.length;n++){var a=e[n];if(a[0]>t)break;i=a[1]}return i},createShockEffect:function(t,e,i,n){if(t){var a=t.getActionByTag(666);a||(n=n||4,i=i||1,t.initPos=cc.v2(t.x,t.y),(a=cc.repeatForever(cc.sequence(cc.moveBy(e/2,cc.v2(n/2,n/2)),cc.moveBy(e,cc.v2(-n,-n)),cc.moveBy(e/2,cc.v2(n/2,n/2))))).setTag(666),t.runAction(a),setTimeout(function(){t.stopActionByTag(666),t.x=t.initPos.x,t.y=t.initPos.y},1e3*i))}},copyList:function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e},getLocalSaveStatus:function(t){var e=new Date(td.TimeUtil.getTime()).pattern("yyyy-MM-dd");return!!td.LocalStorageUtil.read(t+e)},getLocalSaveData:function(t){var e=new Date(td.TimeUtil.getTime()).pattern("yyyy-MM-dd");return td.LocalStorageUtil.read(t+e)},setLocalSaveStatus:function(t,e){td.LocalStorageUtil.removeDateKey(t);var i=new Date(td.TimeUtil.getTime()),n=i.pattern("yyyy-MM-dd");td.LocalStorageUtil.write(t+n,e);var a=(i=new Date(td.TimeUtil.getTime()-864e5)).pattern("yyyy-MM-dd");td.LocalStorageUtil.read(t+a)&&td.LocalStorageUtil.removeItem(t+a)},removeLocalSaveStatus:function(t){td.LocalStorageUtil.removeDateKey(t);var e=new Date(td.TimeUtil.getTime()).pattern("yyyy-MM-dd");td.LocalStorageUtil.removeItem(t+e)},setFontNodeWidth:function(t){var e=t.getComponent(cc.Label),i=e.string.length;i=i>0?i:0,t.width=e.fontSize*i},getFeaturesRestraint:function(t,e){return t===e?td.BattleEnum.RESTRAINT_TYPE.RESTRAINT_DRAW:t-e==-1||t-e==3?td.BattleEnum.RESTRAINT_TYPE.RESTRAINT_LEFT:t-e==1||t-e==-3?td.BattleEnum.RESTRAINT_TYPE.RESTRAINT_RIGHT:td.BattleEnum.RESTRAINT_TYPE.RESTRAINT_BOTH},checkCanClicked:function(t){var e=td.TimeUtil.getTime(),i=e-this._lastClickTime;return i<0?(this._lastClickTime=e,!0):i>(t||1e3)&&(this._lastClickTime=e,!0)},setNodeOpacity:function(t,e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=0),t&&(n>0?t.runAction(cc.fadeTo(n,e)):t.opacity=e,i))for(var a=t.children,r=0;r<a.length;r++)this.setNodeOpacity(a[r],e,i)},getTimeSecondsStringByDeltaTime:function(t,e){void 0===e&&(e=0),t=t<0?0:t;var i=td.Language,n=td.RegexUtil,a=n.pad(Math.floor(t/864e5),2),r=n.pad(Math.floor((t-864e5*a)/36e5),2),o=n.pad(Math.floor((t-864e5*a-36e5*r)/6e4),2),s=n.pad(Math.floor((t-864e5*a-36e5*r-6e4*o)/1e3),2),l=a+i.day+r+i.hour+o+i.minutes+s+i.second;if(1==e)l=(a=n.pad(Math.floor(t/864e5),1))+i.day+r+":"+o+":"+s;return l},gotoRecharge:function(){if(window.isPayOpen){var t,e=td.PanelManager.getInstance().getCurShowPanel();if(e&&(t=e.getPanelEnum()),t&&td.PanelEnum.Panel_Activity===t){var i=e.getComponent("ActivityMainPanel");if(i){var n=i.getCurPanelParam(),a=[td.ActivityEnum.Activity.ActivityVip,td.ActivityEnum.ActivityType.RechargePanel];i.setData(a),td.ActivityDataManager.setJumpBackData(n)}}else{a=[td.ActivityEnum.Activity.ActivityVip,td.ActivityEnum.ActivityType.RechargePanel];td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_Activity,a)}}else console.warn("\u6682\u4e0d\u652f\u6301\u5145\u503c")},inActivityGotoRecharge:function(t){if(window.isPayOpen){var e,i=td.PanelManager.getInstance().getCurShowPanel();if(i&&(e=i.getPanelEnum()),e&&td.PanelEnum.Panel_Activity===e){var n=i.getComponent("ActivityMainPanel"),a=[td.ActivityEnum.Activity.ActivityVip,td.ActivityEnum.ActivityType.RechargePanel];n.setData(a)}var r=td.ActivityDataManager.getActivityControllerByType(t[1]);if(r){var o=r.getShowData().getBelongType()||t[0];t[0]=o}td.ActivityDataManager.setJumpBackData(t)}else console.warn("\u6682\u4e0d\u652f\u6301\u5145\u503c")},inActivityBack:function(){var t,e=td.ActivityDataManager.getJumpBackData(),i=td.PanelManager.getInstance().getCurShowPanel();if(i&&(t=i.getPanelEnum()),t&&td.PanelEnum.Panel_Activity===t){var n=e;i.getComponent("ActivityMainPanel").setData(n)}td.ActivityDataManager.setJumpBackData([])},showPlayerDetail:function(t){if(t&&t.sid){var e={gamerId:t.sid,userName:t.nickName,level:t.level,power:t.fightPower,serverId:t.serverId,avatar:t.avatar,vip:t.vip,curServerId:t.curServerId};s.default.getInstance().setActorData(e),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_OtherBattleArray)}},gotoAddVigour:function(t){void 0===t&&(t=0);var e=td.GetConfig("BUY_VIGOUR_ITEM_INFO"),i=td.GetConfig("ACTOR_VIGOUR_LIMIT"),n=td.Account.getUserData(),a={};a.title=td.Language.vigourTitle,a.getCurCountFunc=n.getVigour.bind(n),a.maxCount=i,a.getNextRecoverTime=n.getNextRecoverVigourTime.bind(n),a.getAllRecoverTime=n.getAllRecoverVigourTime.bind(n);var r={itemId:td.ItemEnum.VIGOUR_ITEM,shopType:e[0],productId:e[1],recoverInfo:a,selectType:t};!window.isPayOpen&&td.GlobalFunction.isShopItemBuyMax(r.shopType,r.productId,!0)||td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_ItemUseBuy,r)},gotoAddEnergy:function(t){void 0===t&&(t=0);var e=td.GetConfig("BUY_ENERGY_ITEM_INFO"),i=td.GetConfig("ACTOR_ENERGY_LIMIT"),n=td.Account.getUserData(),a={};a.title=td.Language.energyTitle,a.getCurCountFunc=n.getEnergy.bind(n),a.maxCount=i,a.getNextRecoverTime=n.getNextRecoverEnergyTime.bind(n),a.getAllRecoverTime=n.getAllRecoverEnergyTime.bind(n);var r={itemId:td.ItemEnum.EnergyItem,shopType:e[0],productId:e[1],recoverInfo:a,selectType:t};!window.isPayOpen&&td.GlobalFunction.isShopItemBuyMax(r.shopType,r.productId,!0)||td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_ItemUseBuy,r)},gotoAddRoam:function(t){void 0===t&&(t=0);var e={};e.itemId=td.ItemEnum.RoamItem;var i=td.GetConfig("BUY_ROAM_ITEM_INFO");if(i){e.shopType=i[0],e.productId=i[1];var n={};n.title=td.Language.roamCountTitle,n.maxCount=l.default.getInstance().getMaxTimes(),n.getCurCountFunc=l.default.getInstance().getLeftTimes.bind(l.default.getInstance()),n.getNextRecoverTime=l.default.getInstance().getNextRecoverTime.bind(l.default.getInstance()),n.getAllRecoverTime=l.default.getInstance().getAllRecoverTime.bind(l.default.getInstance()),e.recoverInfo=n,e.selectType=t,td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_ItemUseBuy,e)}else cc.log("get BUY_ROAM_ITEM_INFO error!")},getAttrValueStr:function(t){var e=[];if(t instanceof Array)e=t;else for(var i in t)e.length<2&&(e[e.length]=parseInt(i),e[e.length]=t[i]);return this.getAttrValueStrByType(e[0],e[1])},getGrowAttrValueStr:function(t,e){var i=t[0];return i>td.AttrType.Full&&i<td.AttrType.Crit||i==td.AttrType.TOWER_ATTACK_SPEED||i==td.AttrType.TOWER_ATTACK_RANGE?e[1]-t[1]:e[1]/100-t[1]/100+"%"},getAttrValueStrByType:function(t,e,i){return i=i||2,e=(t=parseInt(t))>td.AttrType.Full&&t<td.AttrType.Crit||t==td.AttrType.TOWER_ATTACK_SPEED||t==td.AttrType.TOWER_ATTACK_RANGE||t==td.AttrType.RAGE||t==td.AttrType.RAGE_RECOVER?e:(e/100).toFixed(i)+"%"},getAttrMultipyAttrTT:function(t,e){for(var i in e)if(e[td.AttrType.Full])for(var n=td.AttrType.Attack;n<=td.AttrType.SpellArmor;n++)t[n]&&(t[n]+=Math.ceil(t[n]*e[td.AttrType.Full]/1e4));else t[i]&&(t[i]+=Math.ceil(t[i]*e[i]/1e4))},getRandomArrayElements:function(t,e){var i,n,a=t.slice(0),r=t.length,o=r-e;for(o=o<0?0:o;r-- >o;)i=a[n=Math.floor((r+1)*Math.random())],a[n]=a[r],a[r]=i;return a.slice(o)},createBigGemstoneIcon:function(t,e){if(t&&e){var i=e.getChildByName("GemstoneEffect");i&&i.removeFromParent(!0);var n=t.getRuneType()===td.GemstoneType.Normal?"LingWan":"MoWan";t.getRare()&&t.getRuneType()===td.GemstoneType.Special&&(n="XY_"+n);var a=td.GlobalFunction.getResIdByNode(e);gdk.rm.loadRes(a,"uiAnima/LingWanMoWang/"+n,cc.Prefab,function(i){if(cc.isValid(e)&&!e.getChildByName("GemstoneEffect")){var n=e.getChildByName("GemstoneEffect");if(!n){var a=gdk.rm.getResByUrl("uiAnima/LingWanMoWang/"+i,cc.Prefab);if(!a)return;(n=cc.instantiate(a)).name="GemstoneEffect",n.scale=2,e.addChild(n);var r=n.getChildByName("icon_lingwen"),o=t.getBigIconRes();td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_lingwen_da,o,r)}var s=n.getComponent(cc.Animation),l=s.getClips()[t.getQuality()-2].name;s.play(l)}}.bind(this,n))}},showHeroSkillPreview:function(t,e){var i=td.GetTableClass(td.TableEnum.HeroPvpPreview).getDataById(t);i&&(td.PanelManager.getInstance().pushPanelData(-99999,e),td.PanelJumpManager.setJumpToBackPanel(!0),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PVERIEW_FIGHT,i))},getPlistByRewardType:function(t){var e=null;return t==td.RewardType.Mercenary?e=null:t==td.RewardType.Treasure?e=td.resDef.pngPlist.icon_baowu:t==td.RewardType.Equipment?e=td.resDef.pngPlist.icon_zhuangbei:t==td.RewardType.Item?e=td.resDef.pngPlist.icon_viplibao:t==td.RewardType.Gemstone&&(e=null),e},getPlistByGoodsType:function(t){var e=null;return t==td.GoodsType.Type_Mercenary?e=null:t==td.GoodsType.Type_Treasure?e=td.resDef.pngPlist.icon_baowu:t==td.GoodsType.Type_Equip?e=td.resDef.pngPlist.icon_zhuangbei:t==td.GoodsType.Type_Item?e=td.resDef.pngPlist.icon_viplibao:t==td.GoodsType.Type_HeroRune&&(e=null),e},getQualityName:function(t){return td.Language.colors.split("|")[t-1]},getNumName:function(t){return t>=0&&t<=10?td.Language.numStr.split("|")[t]:(cc.log("input error"),"")},hasEmojiCharacter:function(t){if(t){var e=t.match(/@[0-9][0-9]#/g);if(e&&e.length>0)return!0}return!1},splitStrWithEmoji:function(t){for(var e,i=t.match(/@[0-9][0-9]#/g),n=[],a="",r=0,o=i.length;r<o;r++){var s=i[r];e=t.indexOf(s);var l=s.length;if(0==e){if(a=t.substring(0,l),n.push(a),t=t.replace(s,""),r===o-1){n.push(t);break}}else{if(-1==e){n.push(t);break}a=t.substring(0,e),n.push(a),t=t.substring(e,t.length),r--}}return n},createBigEquipImg:function(t,e){var i=t.getChildByName("Equip_Anima");i&&i.removeFromParent(!0);var n=e.getEffectRes();if(n){t.removeComponent(cc.Sprite);var a=td.GlobalFunction.getResIdByNode(t);gdk.rm.loadRes(a,"uiAnima/Equip/"+n,cc.Prefab,this.playEquipImgAni.bind(this,[t,n]))}else this.createSpriteNode(t,"icon_zhuangbei_da/"+e.getPic())},playEquipImgAni:function(t){var e=t[0],i=t[1];if(cc.isValid(e)){var n=gdk.rm.getResByUrl("uiAnima/Equip/"+i,cc.Prefab),a=cc.instantiate(n);a.name="Equip_Anima",e.addChild(a)}},isEmojiCharacter:function(t){if(t)for(var e=0;e<t.length;e++){var i=t.charCodeAt(e);if(55296<=i&&i<=56319){if(t.length>1){var n=1024*(i-55296)+(t.charCodeAt(e+1)-56320)+65536;if(118784<=n&&n<=128895)return!0}}else if(t.length>1){if(8419==t.charCodeAt(e+1))return!0}else{if(8448<=i&&i<=10239)return!0;if(11013<=i&&i<=11015)return!0;if(10548<=i&&i<=10549)return!0;if(12951<=i&&i<=12953)return!0;if(169==i||174==i||12349==i||12336==i||11093==i||11036==i||11035==i||11088==i)return!0}}return!1},deleteStrWithEmoji:function(t){for(var e,i=t.match(/[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF][\u200D|\uFE0F]|[\uD83C|\uD83D|\uD83E][\uDC00-\uDFFF]|[0-9|*|#]\uFE0F\u20E3|[0-9|#]\u20E3|[\u203C-\u3299]\uFE0F\u200D|[\u203C-\u3299]\uFE0F|[\u2122-\u2B55]|\u303D|[\A9|\AE]\u3030|\uA9|\uAE|\u3030/gi),n="",a=0,r=i.length;a<r;a++){var o=i[a];if(0==(e=t.indexOf(o)))t=t.replace(o,"");else{if(-1==e)break;n+=t.substring(0,e),t=t.substring(e,t.length),a--}}return n+=t},grayPanel:function(t){var e=td.TimeUtil.getTime(),i=e>15859296e5&&e<1586015955e3;if(i&&t){var n=t.getChildrenCount();if(this.graySprite(t,i),this.grayLabel(t,i),n>0)for(var a=t.getChildren(),r=0;r<n;r++)this.grayPanel(a[r])}},grayLabel:function(t,e){var i=t.getComponent(cc.Label);i&&(i.color=cc.color(87,87,87))},showBroadcastTip:function(t,e){var i=new td.BroadcastContent(t);if(e&&e.length>0){for(var n=[],a=0;a<e.length;a++){var r=e[a],o=new td.BroadcastParam(r);n.push(o)}i.setMainParam(n)}td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)},isShopItemBuyMax:function(t,e,i){var n=d.default.getInstance().getShopItemModelByTypeAndProductId(t,e);if(!n)return!0;var a=n.getMaxTimes(),r=n.getNum(),o=a>0&&0===a-r;return o&&td.GlobalFunction.showBroadcastTip(135),o},transCfgHoursToZoneHours:function(t){var e=new RegExp("<#.*?#>","g"),i=(t=""+t).match(e);if(i){var n=i[0],a=n,r=a.slice(2,a.length-2),o=td.TimeUtil.getZoneTransHours(r);return t=t.replace(n,o),td.GlobalFunction.transCfgHoursToZoneHours(t)}return t},createNationFlag:function(t,e,i,n){if(e&&t){var a=function(t,e){if(t){var i=t.getChildByName("flagImg"),n=t.getChildByName("flagLabel"),a=e.getFlagId(),r=e.getFlag(),o="XM_qizi0"+a;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.XM_xianmeng,o,i),n.getComponent(cc.Label).string=r}},r=t.getChildByName("nationFlag");r?a(r,e):gdk.rm.loadRes(null,"prefab/Nation/NationFlagIcon",cc.Prefab,function(o){(r=td.GlobalFunction.createPrefabInstance("prefab/Nation/NationFlagIcon")).name="nationFlag",r.scale=i||1,r.setPosition(n||cc.p(0,0)),t.addChild(r,999),a(r,e)}.bind(this))}},getStringCodeLen:function(t){for(var e=0,i=0;i<t.length;i++)t.charCodeAt(i)>127||94==t.charCodeAt(i)?e+=2:e++;return e},transNicknameToSimple:function(t,e){void 0===e&&(e=6);var i="";if(this.getStringCodeLen(t)>e){for(var n=0,a=0;a<t.length&&n<=e&&(t.charCodeAt(a)>127||94==t.charCodeAt(a)?n+=2:n++,!(n>e));a++)i+=t[a];i+="..."}else i=t;return i},transNicknameToSimple1:function(t,e){void 0===e&&(e=3);var i="";return t.length>e?(i=t.substring(0,3),i+="..."):i=t,i},translateBrace:function(t){var e=t;if(e)for(var i=0;i<=100;i++){var n=e.indexOf("{"),a=e.indexOf("}");if(-1===n||-1===a)break;var r=e.slice(n+1,a);e=e.replace("{"+r+"}",td.Language[r])}return e}},cc._RF.pop()},{"../../Configs/ids/PanelId":void 0,"../Gem/Model/GemstoneModel":"GemstoneModel","../Hero/Model/HeroModel":"HeroModel","../Hero/Model/HeroRuneModel":"HeroRuneModel","../OtherBattleArray/Manager/OtherBattleArrayManager":"OtherBattleArrayManager","../Pet/Model/PetModel":"PetModel","../Roam/Manager/RoamManager":"RoamManager","../Shop/Manager/ShopManager":"ShopManager","../Treasure/Model/TreasureModel":"TreasureModel",AvatarHeadWidget:void 0,CommonIconWidget:"CommonIconWidget",ConfirmBroadcastTipWindow:"ConfirmBroadcastTipWindow",EquipModel:"EquipModel",HeroArtifactModel:"HeroArtifactModel",NodePoolManager:void 0,SpiritModel:"SpiritModel",SpriteAnimation:"SpriteAnimation",TimerLabel2:void 0}],GodEquipGachaController:[function(t,e,i){"use strict";cc._RF.push(e,"df6439DemxKnb2lDqE2tal8","GodEquipGachaController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../../Gacha/Manager/GachaEnum"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataID=1001,e._gachaType=0,e._charge=0,e._score=0,e._converted=0,e._maxMsgLength=20,e._luckyMsgList=[],e._luckyMsgList2=[],e._isOpened=!1,e._isShowAni=!0,e}return n(e,t),e.prototype.initData=function(e){this.clearData(),t.prototype.initData.call(this,e),this.addListener(),this.addEventListener(),this._currencyId=td.GetConfig("ACTIVITY_NEW_GACHA_GOODS_ID")||td.ItemEnum.GachaEquipTicket,this._gachaType=a.GachaType.GOD_EQUIPMENT,this._dataID=this.getActivityData()},e.prototype.clearData=function(){this._dataId=0,this._score=0,this._gachaType=0,this._gachaId=0,this._currencyId=0},e.prototype.addListener=function(){var t=td.MsgModuleName.GACHA,e=td.MsgCmd.GACHA;td.ServerDelegate.registerMessage(t,e.PUSH_GOD_EQUIPMENT_LUCK_MESSAGE,this._parseGachaLuckyMsg.bind(this))},e.prototype.addEventListener=function(){var t={};t[td.EventNameEnum.REQ_NEW_GACHA_EQUIP_LUCKY_MSG]=this._reqGachaLuckyMsg,td.EventUtil.registerEvents(t,this)},e.prototype.activityParse=function(t){var e=t.record;this._charge=e.charge||0,this._score=e.score||0,this._converted=e.converted||0},e.prototype.getShowLuckyMsgList=function(){return this._luckyMsgList},e.prototype.getLuckyMsgList=function(){return this._luckyMsgList2},e.prototype.getIsShowAni=function(){return this._isShowAni},e.prototype.setIsShowAni=function(t){this._isShowAni=t},e.prototype._reqGachaLuckyMsg=function(){var t={};t.module=td.MsgModuleName.GACHA,t.cmd=td.MsgCmd.GACHA.GET_GOD_EQUIPMENT_LUCK_INFO,t.type=this.getActivityType(),td.ServerDelegate.sendMessage(t)},e.prototype._parseGachaLuckyMsg=function(t,e){if(t===td.NetCode.SUCCESS&&e.type==this.getActivityType()){e.refresh&&(this._luckyMsgList=[],this._luckyMsgList2=[]);for(var i=e.messageList,n=this._luckyMsgList,a=this._luckyMsgList2,r=td.UserPropertyEnum,o=td.RewardManager,s=td.Language.GachaActivityEquipMsg3,l=td.Language.GachaActivityEquipMsg4,c=0,u=i.length;c<u;c++)for(var d=i[c],h=d.attributes,p=d.rewardList,_=h[r.NickName],g=h[r.ServerId],f=0,v=p.length;f<v;f++){var m=o.getRewardDetail(p[f]),y=(m.getName()||"")+"x"+(m.getCount?m.getCount():1),E=m.getQuality(),T=cc.js.formatStr(s,g,_,y);T=td.UFRichTextParser.parseXML(T,E);var C=cc.js.formatStr(l,g,_,y);C=td.UFRichTextParser.parseXML(C,E),n.unshift({quality:E,msg:T}),a.unshift({quality:E,msg:C})}this._luckyMsgList=n||[],this._luckyMsgList2=a||[],this._luckyMsgList.length>this._maxMsgLength&&(this._luckyMsgList=n.slice(0,this._maxMsgLength)),this._luckyMsgList2.length>this._maxMsgLength&&(this._luckyMsgList2=a.slice(0,this._maxMsgLength)),i.length>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_GACHA_ACTIVITY_LUCKY_MSG,this._activityType)}},e.prototype.setJumpToRecharge=function(){this._isJumpToRecharge=!0},e.prototype.isFromRecharge=function(){var t=this._isJumpToRecharge;return this._isJumpToRecharge=!1,t},e.prototype.getCurrencyNum=function(){return this._currencyId?td.ItemManager.getItemNumById(this._currencyId):0},e.prototype.getCurScore=function(){return this._score},e.prototype.getCurFloor=function(){var t=td.GetTableClass(td.TableEnum.NewGachaTable);return null==t?1:t.getFloorByScore(this._dataID,this._score)},e.prototype.getCurScoreData=function(){var t=td.GetTableClass(td.TableEnum.NewGachaTable);if(null!=t)return t.getDataByScore(this._dataID,this._score)},e.prototype.getCurNormalGachaId=function(){var t=this.getCurScoreData();return null==t?0:t.times[0][0]},e.prototype.getCurHighGachaId=function(){var t=this.getCurScoreData();return null==t?0:t.times[1][0]},e.prototype.getCurPreviewRewards=function(){return this.getCurScoreData().rewardPreview},e.prototype.getCurBigRewards=function(){return this.getCurScoreData().scheduleReward},e.prototype.getNextBigReward=function(){for(var t=this.getCurBigRewards(),e=0;e<t.length;e++){var i=t[e];if(this._score<i[0])return i}return t[t.length-1]},e.prototype.getAllBigRewards=function(){var t=td.GetTableClass(td.TableEnum.NewGachaTable);if(null!=t)return t.getAllRewardDatas(this._dataID)},e.prototype.isBigRewardReceived=function(t){for(var e=this.getCurBigRewards(),i=0;i<e.length;i++)for(var n=e[i],a=0;a<n.length;a++){if(n[a][1]==t)return this._score>=n[0]}return!1},e.prototype.getGachaLimitTime=function(t){for(var e=this.getCurScoreData().times,i=0;i<e.length;i++){var n=e[i];if(n[0]==t)return n[1]}},e.prototype.getGachaStars=function(t){for(var e=this.getCurScoreData().scores,i=0;i<e.length;i++){var n=e[i];if(n[0]==t)return n[1]}},e.prototype.getCanExchangeTicket=function(){var t=td.GetConfig("ACTIVITY_NEW_GACHA_GOODS_UNIT");return Math.floor((this._charge-this._converted)/t)},e.prototype.getGachaType=function(){return this._gachaType},e.prototype.getTaskList=function(){var t=[],e={},i=td.GetConfig("ACTIVITY_NEW_GACHA_GOODS_UNIT");return e.isRecharge=!0,e.value=this.getCanExchangeTicket(),e.desc=cc.js.formatStr(td.Language.treasureGiftExchange,i/10),t[t.length]=e,t},e.prototype.hasRedPoint=function(){return!0},e.prototype.onOpenPanel=function(){this._isOpened=!0},e.prototype.isFirstLoginToday=function(){return td.LoginManager.isFirstLoginToday2()&&!this._isOpened},e.prototype.isTicketsMoreThan10=function(){return this.getCurrencyNum()>10},e.prototype.isHaveTicketsToReceive=function(){return this.getCanExchangeTicket()>0},e.prototype.isRedPointTip=function(){return this.isFirstLoginToday()||this.isTicketsMoreThan10()||this.isHaveTicketsToReceive()},e.prototype.redPointEvts=function(){return[td.EventNameEnum.GACHA_EQUIP_ACTIVITY_CHANGED,td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]},e}(t("ActivityBaseController"));i.default=r,e.exports=r,cc._RF.pop()},{"../../../Gacha/Manager/GachaEnum":"GachaEnum",ActivityBaseController:"ActivityBaseController"}],GodEquipPreviewItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"d3a90nvASdLg5cDslREJ+4G","GodEquipPreviewItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeItem=null,e}return n(e,t),e.prototype.setData=function(t){var e=r.GlobalFunction.createCommonIconWidget(58,t);this.node.addChild(e)},a([l(cc.Node)],e.prototype,"nodeItem",void 0),e=a([s,c("module/Activity/GodEquipPreviewItemUI")],e)}(cc.Component);i.default=u,cc._RF.pop()},{}],GodEquipRewardItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"6cc83qpPsdGI71lJbZe1ilQ","GodEquipRewardItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgBg1=null,e.imgBg2=null,e.imgReceived=null,e.labName=null,e.nodeItem=null,e._needStarNum=0,e}return n(e,t),e.prototype.setData=function(t,e){var i=e[1][0];this._needStarNum=e[0],0==t||3==t?(this.nodeItem.scale=.65,this.labName.node.y=-48,this.imgBg1.active=!1,this.imgBg2.active=!0):(this.nodeItem.scale=.85,this.labName.node.y=-54,this.imgBg1.active=!0,this.imgBg2.active=!1);var n=this.nodeItem.getChildByName("icon"),a=r.RewardManager.getRewardDetail(i);null==n&&((n=r.GlobalFunction.createCommonIconWidget(58,a)).name="icon",n.parent=this.nodeItem),n.getComponent("CommonIconWidget").setData(a),this.labName.string=a.getName(),this.labName.node.color=r.QualityColors[a.getQuality()],this.labName.node.getComponent(cc.LabelOutline).color=r.QualityStrokeColors[a.getQuality()];var o=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.GodEquipGacha),s=o.isBigRewardReceived(a.getId());s=o.getCurScore()>=this._needStarNum,this.imgReceived.active=s},a([l(cc.Node)],e.prototype,"imgBg1",void 0),a([l(cc.Node)],e.prototype,"imgBg2",void 0),a([l(cc.Node)],e.prototype,"imgReceived",void 0),a([l(cc.Label)],e.prototype,"labName",void 0),a([l(cc.Node)],e.prototype,"nodeItem",void 0),e=a([s,c("module/Activity/GodEquipRewardItemUI")],e)}(cc.Component);i.default=u,cc._RF.pop()},{}],GodEquipRewardsWindow:[function(t,e,i){"use strict";cc._RF.push(e,"df8926AYv9N2K6iFODXp8N3","GodEquipRewardsWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scroll=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_GodEquipRewardsWindow},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._refreshList()},e.prototype._refreshList=function(){var t=this.scroll.getComponent(d);if(t){var e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.GodEquipGacha);if(null==e)return;t.setData(e.getAllBigRewards())}},a([l(cc.Node)],e.prototype,"scroll",void 0),e=a([s,c("module/Activity/GodEquipRewardsWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],GodEquipTicketsWindow:[function(t,e,i){"use strict";cc._RF.push(e,"5f159C1u9pN94uDpMTYGPSg","GodEquipTicketsWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=(o.property,o.menu),c=t("PanelBase"),u=t("OptimizeVerticalListView"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._controller=null,e}return n(e,t),e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListners()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this)},e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_TicketsWindow},e.prototype.setData=function(){this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.GodEquipGacha),this._refreshList()},e.prototype._addEventListners=function(){var t={};t[r.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]=this._refreshList,r.EventUtil.registerEvents(t,this)},e.prototype._refreshList=function(){var t;null!=this._controller&&(t=this._controller.getTaskList(),this.node.getComponent(u).refreshListData(t))},e=a([s,l("module/Activity/GodEquipTicketsWindow")],e)}(c);i.default=d,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],GodEquipmentBuyConfig:[function(t,e,i){"use strict";cc._RF.push(e,"7344bAeXkFI0onjMEL5mmLQ","GodEquipmentBuyConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="GodEquipmentBuyConfig",e._tblName="god_equipment_reward_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getGodEquipmentBuyConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GodEquipmentRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"d393drPd2FFU4cFRA214rJS","GodEquipmentRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="GodEquipmentRewardConfig",e._tblName="god_equipment_reward_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getGodEquipmentRewardConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GodFurnaceManager:[function(t,e,i){"use strict";cc._RF.push(e,"52089/y6r9O94tgDZbhQWGe","GodFurnaceManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("CommonEnum"),r=function(){function t(){}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._ranks=[],this._isInit=!1},t.prototype.addListener=function(){var t=n.MsgModuleName.ExtensionCmd,e=n.MsgCmd.ExtensionCmd,i=n.ServerDelegate;i.registerMessage(t,e.OPEN_GOD_FURNACE,this._resGodFurnaceStart.bind(this)),i.registerMessage(t,e.GOD_FURNACE_REFINE,this._resGodFurnaceRefine.bind(this)),i.registerMessage(t,e.CLOSE_GOD_FURNACE,this._resGodFurnaceReward.bind(this)),i.registerMessage(t,e.GET_GOD_FURNACE_RANKS,this._resGodFurnaceRanks.bind(this)),i.registerMessage(t,e.PUSH_GOD_FURNACE_RANK,this._resGodFurnaceRanks.bind(this)),i.registerMessage(t,e.GET_GOD_FURNACE_INFO,this._resGodFurnaceInfo.bind(this)),i.registerMessage(t,e.PUSH_GOD_FURNACE_INFO,this._resGodFurnaceInfo.bind(this))},t.prototype.addEventListener=function(){var t=n.EventNameEnum,e={};e[t.REQ_OPEN_GOD_FURNACE]=this._reqGodFurnaceStart,e[t.REQ_GOD_FURNACE_REFINE]=this._reqGodFurnaceRefine,e[t.REQ_CLOSE_GOD_FURNACE]=this._reqGodFurnaceReward,e[t.REQ_GET_GOD_FURNACE_RANKS]=this._reqGodFurnaceRanks,e[t.REQ_GET_GOD_FURNACE_INFO]=this._reqGodFurnaceInfo,e[t.USER_ATTR_LEVEL_CHANGE]=this.reqInfo,n.EventUtil.registerEvents(e,this)},t.prototype.reqInfo=function(){n.UnlockManager.isTargetUnlock(n.ActorUnlockType.GOD_FURNACE,0)&&(this._isInit||this._reqGodFurnaceInfo())},t.prototype._reqGodFurnaceStart=function(){var t={};t.module=n.MsgModuleName.ExtensionCmd,t.cmd=n.MsgCmd.ExtensionCmd.OPEN_GOD_FURNACE,n.ServerDelegate.sendMessage(t)},t.prototype._reqGodFurnaceRefine=function(){var t={};t.module=n.MsgModuleName.ExtensionCmd,t.cmd=n.MsgCmd.ExtensionCmd.GOD_FURNACE_REFINE,n.ServerDelegate.sendMessage(t)},t.prototype._reqGodFurnaceReward=function(){var t={};t.module=n.MsgModuleName.ExtensionCmd,t.cmd=n.MsgCmd.ExtensionCmd.CLOSE_GOD_FURNACE,n.ServerDelegate.sendMessage(t)},t.prototype._reqGodFurnaceRanks=function(){if(n.UnlockManager.isTargetUnlock(n.ActorUnlockType.GOD_FURNACE,0,!1)){var t={};t.module=n.MsgModuleName.ExtensionCmd,t.cmd=n.MsgCmd.ExtensionCmd.GET_GOD_FURNACE_RANKS,n.ServerDelegate.sendMessage(t)}},t.prototype._reqGodFurnaceInfo=function(){if(n.UnlockManager.isTargetUnlock(n.ActorUnlockType.GOD_FURNACE,0,!1)){var t={};t.module=n.MsgModuleName.ExtensionCmd,t.cmd=n.MsgCmd.ExtensionCmd.GET_GOD_FURNACE_INFO,n.ServerDelegate.sendMessage(t)}},t.prototype._resGodFurnaceStart=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_OPEN_GOD_FURNACE)},t.prototype._resGodFurnaceRefine=function(t,e){if(t===n.NetCode.SUCCESS){if(e.currFireLevel-this._currFireLevel>0)var i=new n.BroadcastContent(310);else i=new n.BroadcastContent(311);n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_BROADCAST,i),void 0!==e.currFireLevel&&(this._currFireLevel=e.currFireLevel),void 0!==e.refineTimes&&(this._refineTimes=e.refineTimes),n.EventUtil.dispatchEvent(n.EventNameEnum.RES_GOD_FURNACE_REFINE)}},t.prototype._resGodFurnaceReward=function(t,e){if(t===n.NetCode.SUCCESS){var i=n.RewardManager.parseRewardResult(e.rewardResult);n.GlobalFunction.showRewards(i),n.EventUtil.dispatchEvent(n.EventNameEnum.RES_CLOSE_GOD_FURNACE)}},t.prototype._resGodFurnaceRanks=function(t,e){t===n.NetCode.SUCCESS&&(this._ranks=e.rankList,n.EventUtil.dispatchEvent(n.EventNameEnum.RES_GET_GOD_FURNACE_RANKS))},t.prototype._resGodFurnaceInfo=function(t,e){t===n.NetCode.SUCCESS&&(void 0!==e.currFireLevel&&(this._currFireLevel=e.currFireLevel),void 0!==e.openFurnaceTimes&&(this._openFurnaceTimes=e.openFurnaceTimes),void 0!==e.refineTimes&&(this._refineTimes=e.refineTimes),0===this._currFireLevel&&0===this._openFurnaceTimes&&0===this._refineTimes&&this._reqGodFurnaceRanks(),this._isInit=!0,n.EventUtil.dispatchEvent(n.EventNameEnum.RES_GET_GOD_FURNACE_INFO))},t.prototype.getCurrFireLevel=function(){return this._currFireLevel},t.prototype.getMaxFireLevel=function(){return n.GetTableClass(n.TableEnum.GodFurnaceTable).getMaxLevel()},t.prototype.getOpenFurnaceTimes=function(){return this._openFurnaceTimes},t.prototype.getRefineTimes=function(){return this._refineTimes},t.prototype.getLastTimes=function(){for(var t=n.GetTableClass(n.TableEnum.VipPrivilegeTable).getTypeData(a.PrerogativeEnum.OPEN_GOD_FURNACE_TIMES,1),e=n.Account.getUserData().getVip(),i=0,r=0,o=t.length;r<o;r++){e>=t[r].privilegeOpenValue&&t[r].value>i&&(i=t[r].value)}return i-this._openFurnaceTimes>0?i-this._openFurnaceTimes:0},t.prototype.getRanks=function(){return this._ranks},t.prototype.isRedTips=function(){for(var t=n.GetTableClass(n.TableEnum.VipPrivilegeTable).getTypeData(a.PrerogativeEnum.OPEN_GOD_FURNACE_TIMES,1),e=n.Account.getUserData().getVip(),i=0,r=0,o=t.length;r<o;r++){e>=t[r].privilegeOpenValue&&t[r].value>i&&(i=t[r].value)}return i-this._openFurnaceTimes>0},t.prototype.redTipsEvent=function(){return[n.EventNameEnum.RES_GET_GOD_FURNACE_INFO]},t}();i.default=r,cc._RF.pop()},{CommonEnum:void 0}],GodFurnaceRankTable:[function(t,e,i){"use strict";cc._RF.push(e,"36646wwAM1P1ZEO3sIikF4r","GodFurnaceRankTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="GodFurnaceRankRewardConfig",e._tblName="god_furnace_rank_reward_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.rank]=a}},e.prototype.getAllData=function(){var t=[];for(var e in this._data)t.push(this._data[e]);return t},e.prototype.getDataByRank=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GodFurnaceTable:[function(t,e,i){"use strict";cc._RF.push(e,"71dd49zyHFGkregdqQvlHZW","GodFurnaceTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="GodFurnaceConfig",e._tblName="god_furnace_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getAllData=function(){var t=[];for(var e in this._data)t.push(this._data[e]);return t},e.prototype.getDataByLevel=function(t){return this._data[t]},e.prototype.getMaxLevel=function(){return this._data.myLen()},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GoddessBoxTable:[function(t,e,i){"use strict";cc._RF.push(e,"47cec9GX4hOa6innwg1jY3B","GoddessBoxTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="GoddessBoxConfig",e._tblName="goddess_box_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getDataByDataAndId=function(t,e){if(this._data[t])for(var i in this._data[t])if(this._data[t][i].id===e)return this._data[t][i];return null},e.prototype.getAllBoxByData=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GoddessStoreTable:[function(t,e,i){"use strict";cc._RF.push(e,"b5a56zk9sRDy4W6mcPBIssK","GoddessStoreTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="GoddessStoreConfig",e._tblName="goddess_store_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getBuyListConfigById=function(t){return this._data&&this._data[t]?(this._data[t].sort(function(t,e){return e.sortRank-t.sortRank}),this._data[t].sort(this.sortFunc)):[]},e.prototype.sortFunc=function(t,e){return t.sortRank-e.sortRank},e.prototype.getMinScoreById=function(t){var e=0;if(this._data&&this._data[t])for(var i=0;i<this._data[t].length;i++)e||(e=this._data[t][i].score),e>this._data[t][i].score&&(e=this._data[t][i].score);return e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GoldEquipShopController:[function(t,e,i){"use strict";cc._RF.push(e,"68e782hPO1M0qtDkKnsTx3F","GoldEquipShopController");var n=t("FamousGeneralShopController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{FamousGeneralShopController:"FamousGeneralShopController"}],GoldHeroActiveWindow2:[function(t,e,i){"use strict";cc._RF.push(e,"2dd2d4F4r1DqLSav4lyd7j3","GoldHeroActiveWindow2");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Pet/Model/PetModel"),o=t("./GoldHeroActiveWindow"),s=cc._decorator,l=s.ccclass,c=(s.property,s.menu,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_GoldHeroActive2},e.prototype.setData=function(t){var e=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.GoldHeroBackBuy2);if(e){this._controller=e,this._controller.setNewActiveHeroId(null);var i=new r.default,n=td.GetTableClass(td.TableEnum.PetTable).getPetById(t);i.init(n);var a=cc.js.formatStr("%s",td.Language.Gold_Hero_Back_Tip1,td.QualityColorStrs[i.getQuality()],"#"+td.QualityStrokeColors[i.getQuality()].toHEX("#rrggbb"),i.getName());this.labTip_1.string=a;var o=td.GlobalFunction.createCommonIconWidget(2,i);o.y=132,this.node.addChild(o)}else this.closeCallFunc()},e.prototype.onBtnSureClick=function(){t.prototype.closeCallFunc.call(this),td.EventUtil.dispatchEvent(td.EventNameEnum.CLOSED_POP_WINDOW,!0),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_Activity,[1,td.ActivityEnum.ActivityType.GoldHeroBackBuy2])},e=a([l],e)}(o.default));i.default=c,cc._RF.pop()},{"../../../Pet/Model/PetModel":"PetModel","./GoldHeroActiveWindow":"GoldHeroActiveWindow"}],GoldHeroActiveWindow:[function(t,e,i){"use strict";cc._RF.push(e,"cb8c3019v5KVo7bzXph4vtu","GoldHeroActiveWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("HeroModel"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTip_1=null,e._controller=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_GoldHeroActive},e.prototype.setData=function(t){var e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.GoldHeroBackBuy);if(e){this._controller=e,this._controller.setNewActiveHeroId(null);var i=r.GetTableClass(r.TableEnum.HeroTable).getHeroById(t),n=new d;n.init(i);var a=cc.js.formatStr("%s",r.Language.Gold_Hero_Back_Tip1,r.QualityColorStrs[n.getQuality()],"#"+r.QualityStrokeColors[n.getQuality()].toHEX("#rrggbb"),n.getName());this.labTip_1.string=a;var o=r.GlobalFunction.createCommonIconWidget(2,n);o.y=132,this.node.addChild(o)}else this.closeCallFunc()},e.prototype.closeCallFunc=function(){t.prototype.closeCallFunc.call(this),r.EventUtil.dispatchEvent(r.EventNameEnum.CLOSED_POP_WINDOW)},e.prototype.onBtnCancelClick=function(){this.closeCallFunc()},e.prototype.onBtnSureClick=function(){t.prototype.closeCallFunc.call(this),r.EventUtil.dispatchEvent(r.EventNameEnum.CLOSED_POP_WINDOW,!0),r.PanelJumpManager.jumpToPanel(r.PanelEnum.Panel_Activity,[1,r.ActivityEnum.ActivityType.GoldHeroBackBuy])},a([l(cc.RichText)],e.prototype,"labTip_1",void 0),e=a([s,c("module/Activity/GoldHeroActiveWindow")],e)}(u);i.default=h,cc._RF.pop()},{HeroModel:"HeroModel",PanelBase:void 0}],GoldHeroBackBuyController2:[function(t,e,i){"use strict";cc._RF.push(e,"c9065YAbGRCg4D6cySwhG8T","GoldHeroBackBuyController2");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("GoldHeroBackBuyController"),o=cc._decorator,s=o.ccclass,l=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.onOpenPanel=function(){this._isPanelOpened=!0,td.GlobalFunction.setLocalSaveStatus("PetBackBuyPanel","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.GH_PANEL_SHOW)},e.prototype.isLoginTodayShow=function(){return!td.GlobalFunction.getLocalSaveStatus("PetBackBuyPanel")},e.prototype._setNewActiveHeroId=function(t){if(null!=t){var e=this._heroIds||[],i=[];return e.concat(t).forEach(function(n){-1!==t.indexOf(n)&&-1===e.indexOf(n)&&i.push(n)}),i&&i.length>0?(td.LocalStorageUtil.write(td.LocalDataKey.MainPanel_isShowPopup,!1),td.LocalStorageUtil.write(td.LocalDataKey.MainPanel_isShowPopup+td.PanelEnum.Window_GoldHeroActive2,!1),this.setNewActiveHeroId(i[0]),td.EventUtil.dispatchEvent(td.EventNameEnum.NEW_PET_ACTIVE,!0),i[0]):(this.setNewActiveHeroId(null),null)}},e=a([s],e)}(r));i.default=l,e.exports=l,cc._RF.pop()},{GoldHeroBackBuyController:"GoldHeroBackBuyController"}],GoldHeroBackBuyController:[function(t,e,i){"use strict";cc._RF.push(e,"36b30F7j2FIfp26lSgMvRIG","GoldHeroBackBuyController");var n=t("RechargeBaseController"),a=t("GoldHeroBackBuyModel"),r=cc.Class({extends:n,properties:{_entityMap:null,_isActive:null,_isInit:null,_heroIds:null,_newActiveHeroId:null},initData:function(t){this._super(t),this._entityMap={},this._isActive=!1,this._isInit=!1,this._heroIds=[]},destroyData:function(){this._super()},parseQueryInfo:function(t){this._entityMap=t.entityMap,this._datas=[];var e=this.getActivityData(),i=td.GetTableClass(td.TableEnum.GoldHeroBackBuyTable).getDatasByDataId(e);this._isInit&&this._setNewActiveHeroId(t.ids),this._heroIds=t.ids;for(var n=this.getActivityId(),r=0;r<i.length;r++){i[r].isActive=this.isActived(t.ids?t.ids:[],i[r].roleId),i[r].id=i[r].chargeId;var o=new a;o.initData(i[r],n),this._datas.push(o)}td.EventUtil.dispatchEvent(td.EventNameEnum.GH_ON_GET_ACTIVITY_INFO),this._isInit=!0},_setNewActiveHeroId:function(t){if(null!=t){var e=this._heroIds||[],i=[];return e.concat(t).forEach(function(n){-1!==t.indexOf(n)&&-1===e.indexOf(n)&&i.push(n)}),i&&i.length>0?(td.LocalStorageUtil.write(td.LocalDataKey.MainPanel_isShowPopup,!1),td.LocalStorageUtil.write(td.LocalDataKey.MainPanel_isShowPopup+td.PanelEnum.Window_GoldHeroActive,!1),this.setNewActiveHeroId(i[0]),td.EventUtil.dispatchEvent(td.EventNameEnum.NEW_GOLD_HERO_ACTIVE,!0),i[0]):(this.setNewActiveHeroId(null),null)}},setNewActiveHeroId:function(t){this._newActiveHeroId=t},getNewActiveHeroId:function(){return this._newActiveHeroId},_onRechargeSuccess:function(t){},hasRedPoint:function(){return!0},getEntityMapById:function(t){return this._entityMap[t]},redPointTip:function(){for(var t=this._datas,e=0;e<t.length;e++){var i=t[e];if(this._entityMap){var n=this._entityMap[i.getChargeId()],a=n?n.status:td.ActivityEnum.RewardStatus.NONE;if((a=parseInt(a))===td.ActivityEnum.RewardStatus.FINISH)return!0}}return!1},onOpenPanel:function(){this._isPanelOpened=!0,td.GlobalFunction.setLocalSaveStatus("GoldHeroBackBuyPanel","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.GH_PANEL_SHOW)},isLoginTodayShow:function(){return!td.GlobalFunction.getLocalSaveStatus("GoldHeroBackBuyPanel")},redPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.GH_PANEL_SHOW,td.EventNameEnum.GH_ON_GET_ACTIVITY_INFO]},isRedPointTip:function(){return this.redPointTip()||this.isLoginTodayShow()},isActived:function(t,e){for(var i=!1,n=0;n<t.length;n++)if(t[n]===e){i=!0,this._isActive=!0;break}return i},isInSpecialOpenStatus:function(){return this._status===td.ActivityEnum.ActivityStatus.Open&&this._isActive}});e.exports=r,cc._RF.pop()},{GoldHeroBackBuyModel:"GoldHeroBackBuyModel",RechargeBaseController:"RechargeBaseController"}],GoldHeroBackBuyItem:[function(t,e,i){"use strict";cc._RF.push(e,"b7515tFoqJO/Y3VNU78N0X5","GoldHeroBackBuyItem");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../Pet/Model/PetModel"));var a=t("RechargeBaseItem"),r=t("HeroModel"),o=cc.Class({extends:a,properties:{},updateItem:function(t,e){this._super(t,e),this.node.getChildByName("labTitle").getComponent(cc.Label).string=e._titleText;var i=this.node.getChildByName("labOrigin");i.getComponent(cc.Label).string=e._originPrice;var a=this.node.getChildByName("labProgress"),o=this.node.getChildByName("labActive"),s=this.node.getChildByName("imgOrigin"),l=this.node.getChildByName("imgReceived"),c=this.node.getChildByName("btnOperation"),u=this.node.getChildByName("btnReceive"),d=this.node.getChildByName("imgRed"),h=c.getChildByName("Label");if(e._isActive){o.active=!1;var p=td.ActivityDataManager.getActivityControllerByType(this.getActivityType(e)).getEntityMapById(e.getChargeId()),_=p?p.times:0,g=p?p.status:td.ActivityEnum.RewardStatus.NONE;g=parseInt(g);var f=e.getTotalTimes(),v=f-_;if(v<=0)l.active=!0,c.active=!1,u.active=!1,d.active=!1,a.active=!0,i.active=!1,s.active=!1;else if(l.active=!1,a.active=!0,i.active=!0,s.active=!0,g===td.ActivityEnum.RewardStatus.NONE){c.active=!0,u.active=!1,d.active=!1;var m=td.RechargeManager.getRechargeDataById(e._rechargeId)._costValue/10;h.getComponent(cc.Label).string=cc.js.formatStr(td.Language.rechargeCount,m.toString())}else g===td.ActivityEnum.RewardStatus.FINISH&&(c.active=!1,u.active=!0,d.active=!0);a.getComponent(cc.RichText).string=" <color=#ad6201>"+td.Language.leftTimes+"</c> <color=#01ae09>"+v+"/"+f+"</c>"}else{o.active=!0,l.active=!1,a.active=!1,i.active=!1,s.active=!1,c.active=!1,u.active=!1,d.active=!1;var y="";if(e._type==td.RewardType.Mercenary){var E=new r;E.init(td.GetTableClass(td.TableEnum.HeroTable).getHeroById(e._heroId)),y=E.getName()}else if(e._type==td.RewardType.Pet){var T=new n.default,C=td.GetTableClass(td.TableEnum.PetTable).getPetById(e._heroId);T.init(C),y=T.getName()}o.getComponent(cc.Label).string=cc.js.formatStr(td.Language.getForActive,y)}this.setItemBtn(t,e)},onOperateItem:function(t,e){var i=e,n=td.ActivityDataManager.getActivityControllerByType(this.getActivityType(i)).getEntityMapById(i.getChargeId()),a=n?n.status:td.ActivityEnum.RewardStatus.NONE;if((a=parseInt(a))===td.ActivityEnum.RewardStatus.NONE){var r=td.RechargeManager.getRechargeDataById(i.getChargeId());r&&td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,r)}else a===td.ActivityEnum.RewardStatus.FINISH&&this.doReceiveAction(i)},setItemBtn:function(t,e){var i=this.node.getChildByName("btnOperation"),n=this.node.getChildByName("btnReceive");this._setItemBtn(t,e,i),this._setItemBtn(t,e,n)},_setItemBtn:function(t,e,i){var n=i.getComponent(cc.Button);n.clickEvents=[];var a=new cc.Component.EventHandler;a.target=this.node,a.component="GoldHeroBackBuyItem",a.handler="onOperateItem",a.customEventData=e,n.clickEvents.push(a)},getActivityType:function(t){return t._type==td.RewardType.Mercenary?td.ActivityEnum.ActivityType.GoldHeroBackBuy:t._type==td.RewardType.Pet?td.ActivityEnum.ActivityType.GoldHeroBackBuy2:null}});e.exports=o,cc._RF.pop()},{"../../../Pet/Model/PetModel":"PetModel",HeroModel:"HeroModel",RechargeBaseItem:"RechargeBaseItem"}],GoldHeroBackBuyModel:[function(t,e,i){"use strict";cc._RF.push(e,"99f02hVnSNBWbdTUk0BPdU5","GoldHeroBackBuyModel");var n=t("RechargeBaseModel"),a=cc.Class({extends:n,properties:{_rechargeId:null,_titleText:null,_originPrice:null},initData:function(t,e){this._super(t,e),this._rechargeId=t.chargeId,this._titleText=t.name||"",this._originPrice=t.originalPrice+"\u5143"||"",this._heroId=t.roleId||0,this._isActive=t.isActive,this._type=t.type||12},getReceiveStatus:function(){if(this.isReceived())return td.ActivityEnum.OperateStatus.Operated;var t=td.ActivityDataManager.getActivityControllerById(this._belongActivityId);if(!t)return td.ActivityEnum.OperateStatus.NotOperateAble;var e=this.getReceivedTimes(),i=t.getRechargeTimesByMoney(this.getMoney());return!i&&(i=0),i>e?td.ActivityEnum.OperateStatus.OperateAble:td.ActivityEnum.OperateStatus.NotOperateAble},getChargeId:function(){return this._rechargeId}});e.exports=a,cc._RF.pop()},{RechargeBaseModel:"RechargeBaseModel"}],GoldHeroBackBuyPanel2:[function(t,e,i){"use strict";cc._RF.push(e,"80d59XZMY5OPri560Iep0aP","GoldHeroBackBuyPanel2");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("GoldHeroBackBuyPanel"),o=cc._decorator,s=o.ccclass,l=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e=a([s],e)}(r));i.default=l,cc._RF.pop()},{GoldHeroBackBuyPanel:"GoldHeroBackBuyPanel"}],GoldHeroBackBuyPanel:[function(t,e,i){"use strict";cc._RF.push(e,"5e2d5lpR+JB+abbsjpZSrSu","GoldHeroBackBuyPanel");var n=t("RechargeBasePanel"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t)},onLoad:function(){this._super();var t=this.node.getChildByName("scrollView");this._listView=t.getComponent("OptimizeVerticalListView")},onEnable:function(){this._super(),this.getActivityController()&&this.getActivityController().onOpenPanel()},doReceiveAction:function(t){var e=this,i={id:t.getId()},n=t.getOptionalRewards?t.getOptionalRewards():[];if(n.length>0){var a={};a.itemList=n,a.callFunc=function(t){i.parmeterMap={10:t},e.getActivityController().operateActivity(i)},td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_SelectRechargeReward,a)}else i.parmeterMap={10:0},this.getActivityController().operateActivity(i)},onReceiveOperation:function(t){this._super(t)}});e.exports=a,cc._RF.pop()},{RechargeBasePanel:"RechargeBasePanel"}],GoldHeroBackBuyTable:[function(t,e,i){"use strict";cc._RF.push(e,"d4f6bU8j1ROk4MNwbeFR1q7","GoldHeroBackBuyTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GoldHeroBackBuyTable",properties:{_tblName:"activity_buy_back_config",_datas:null},init:function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.data]=this._datas[e.data]||[],this._datas[e.data].push(e)}},getDatasByDataId:function(t){if(!this._datas[t])return[];var e=this._datas[t];return e.sort(function(t,e){return t.charge-e.charge}),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GoldItem:[function(t,e,i){"use strict";cc._RF.push(e,"4960dFTTyBIbIkbRdU3vZS0","GoldItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=(r.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._animation=null,e._idleNode=null,e._idleCount=0,e}return n(e,t),e.prototype.onLoad=function(){this._animation=this.node.getComponent(cc.Animation),this._idleNode=cc.instantiate(gdk.rm.getResByUrl(td.resDef.Guajijinbi_idle_Prefab,cc.Prefab)),this.node.addChild(this._idleNode),this._idleNode.active=!1,this._idleNode.getComponent(cc.Animation).on("lastframe",this.idleLastFrame,this)},e.prototype.playDrop=function(){this._idleCount=0;var t=this.node.getComponent(cc.Animation),e=t.getClips(),i=Math.floor(Math.random()*e.length);t.play(e[i].name).wrapMode=cc.WrapMode.Normal,t.on("finished",this.dropFinished,this)},e.prototype.dropFinished=function(){this._idleNode.active=!0;var t=this._idleNode.getComponent(cc.Animation);t.on("lastframe",this.idleLastFrame,this),t.play(t.defaultClip.name)},e.prototype.idleLastFrame=function(){var t=120*Math.random(),e=120*Math.random(),i=(Math.floor(10*Math.random()),Math.floor(10*Math.random())%2==0);this._idleNode.x=i?t:-t,this._idleNode.y=i?e:-e},e=a([o],e)}(cc.Component));i.default=s,cc._RF.pop()},{}],GoldTreasureController:[function(t,e,i){"use strict";cc._RF.push(e,"309c8HZbRZF6aU/umsdavrt","GoldTreasureController");var n=t("ActivityBaseController"),a=t("CommonEnum"),r=cc.Class({extends:n,properties:{_exchangedTimes:0,_costConfig:null},initData:function(t){this._super(t),this._exchangedTimes=0,this._costConfig=td.GetTableClass(td.TableEnum.Config).getConfig("MONEY_TREE_COST"),this.addNetListener(),this.addEventListener()},destroyData:function(){this._super(),this._exchangedTimes=0},addNetListener:function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.GET_MONEY_TREE,this.receiveGoldTreasureInfo.bind(this)),i.registerMessage(t,e.USE_MONEY_TREE,this.receiveExchangeReturn.bind(this)),i.registerMessage(t,e.PUSH_MONEY_TREE_COUNT,this.pushGoldTreasureInfo.bind(this))},addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REQUEST_GOLD_TREASURE_INFO]=this.requestBaseInfo.bind(this),t[e.REQUEST_EXCHANGE_GOLD]=this.requestExchangeGold.bind(this),td.EventUtil.registerEvents(t,this)},getMaxExchangeTimes:function(){var t=td.PrerogativeManager.getPrerogative(a.PrerogativeEnum.GoldTreeTime);return t?t.getValue():0},getLeftExchangedTimes:function(){return this.getMaxExchangeTimes()-this._exchangedTimes},hasExchangeTimes:function(){return this._exchangedTimes<this.getMaxExchangeTimes()},getOneKeyExchangeTimes:function(){return Math.min(this.getLeftExchangedTimes(),10)},getCost:function(t){for(var e=0,i=this._exchangedTimes+1;i<=this._exchangedTimes+t;i++)e+=td.GlobalFunction.getConfigOfTimes(i,this._costConfig);return e},getGain:function(t){var e=td.Account.getUserData().getLevel();return td.GetTableClass(td.TableEnum.GoldTreasureTable).getGoldByLevel(e)*t},requestBaseInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.GET_MONEY_TREE,td.ServerDelegate.sendMessage(t)},receiveGoldTreasureInfo:function(t,e){t===td.NetCode.SUCCESS&&(this._parseExchangeTimes(e.count),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_GOLD_TREASURE_PANEL))},pushGoldTreasureInfo:function(t,e){t===td.NetCode.SUCCESS&&(this._parseExchangeTimes(e.count),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_GOLD_TREASURE_PANEL))},requestExchangeGold:function(t){var e=t,i={};i.module=td.MsgModuleName.ExtensionCmd,i.cmd=td.MsgCmd.ExtensionCmd.USE_MONEY_TREE,i.count=e||1,td.ServerDelegate.sendMessage(i)},receiveExchangeReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.criticalMap;td.EventUtil.dispatchEvent(td.EventNameEnum.EXCHANGE_GOLD_RETURN,i)}},_parseExchangeTimes:function(t){this._exchangedTimes=t},hasRedPoint:function(){return!1},redPointTip:function(){return!1},redPointEvts:function(){return[]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",CommonEnum:void 0}],GoldTreasurePanel:[function(t,e,i){"use strict";cc._RF.push(e,"13ab9TAmXVJYpXrlSXElE/R","GoldTreasurePanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{gainItem:cc.Node,goldAnimateNode:cc.Node,showLayer:cc.Node,goldTreasureAtlas:cc.SpriteAtlas,_bExchangeFiveTimes:null},initData:function(t){this._super(t)},onLoad:function(){this._bExchangeFiveTimes=!1,this.node.getChildByName("toggle").getComponent(cc.Toggle).isChecked=this._bExchangeFiveTimes,this.gainItem.active=!1,this.goldAnimateNode.active=!1,this.node.getChildByName("labTip").active=!td.IsCheckServer()},_addLocalListeners:function(){var t={},e=td.EventNameEnum;t[e.REFRESH_GOLD_TREASURE_PANEL]=this._refreshView.bind(this),t[e.EXCHANGE_GOLD_RETURN]=this._onExchangeReturn.bind(this),td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},onEnable:function(){this._super(),this._addLocalListeners(),this._refreshView()},onDisable:function(){this._super(),this._removeAllListeners(),this.node.getChildByName("imgBg").removeAllChildren(),this.showLayer.removeAllChildren()},_showManyGoldEffect:function(){var t=this.node.getChildByName("animaNode"),e=null;e=t.getChildByName("JuBaoPen_effect");var i=gdk.rm.getResByUrl("uiAnima/JuBaoPen_effect/JuBaoPen_effect",cc.Prefab);(e=cc.instantiate(i)).name="JuBaoPen_effect",t.addChild(e,1e3),e.active=!0;var n=e.getComponent(cc.Animation);n.play(n.defaultClip.name),n.on("finished",function(){e.removeFromParent()})},_onExchangeReturn:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.MoneyRain);var e=this.showLayer.getContentSize(),i=this._controller.getGain(1),n=0;for(var a in t){var r=t[a],o=cc.instantiate(this.gainItem);o.active=!0,o.scale=0,o.setPosition(Math.random()*e.width,Math.random()*e.height),this.showLayer.addChild(o),o.getChildByName("labGainGold").getComponent(cc.Label).string=i;var s=2===r||5===r||10===r,l=o.getChildByName("imgCritMult");if(l.active=s,s){var c=cc.js.formatStr("hd_jbbz_%sbei",r),u=this.goldTreasureAtlas.getSpriteFrame(c);l.getComponent(cc.Sprite).spriteFrame=u}var d=cc.delayTime(n),h=cc.callFunc(function(t){t.scale=1}),p=cc.moveBy(1.5,0,100),_=cc.fadeOut(1.5),g=cc.spawn(p,_),f=cc.callFunc(function(t){t.removeFromParent()}),v=cc.sequence(d,h,g,f);o.runAction(v),n+=.3}this._showManyGoldEffect()},_refreshView:function(){this._setOptionLayer(),this._setCostLayer(),this._setOwnTimes()},_setOptionLayer:function(){var t=this.node.getChildByName("toggle");this._controller.getLeftExchangedTimes()<=1&&(t.getComponent(cc.Toggle).isChecked=!1,this._bExchangeFiveTimes=!1)},_setCostLayer:function(){this._bExchangeFiveTimes?this._setDiamondsCoins(this._controller.getOneKeyExchangeTimes()):this._setDiamondsCoins(1)},_setOwnTimes:function(){var t=this.node.getChildByName("labOddTimes"),e=this._controller.getMaxExchangeTimes(),i=this._controller.getLeftExchangedTimes();t.getComponent(cc.Label).string=i+"/"+e},_setDiamondsCoins:function(t){this.node.getChildByName("labConsume").getComponent(cc.Label).string=this._controller.getCost(t),this.node.getChildByName("labGain").getComponent(cc.Label).string=this._controller.getGain(t)},onSelectExchavegeFiveTimes:function(t){var e=t.isChecked;e&&this._controller.getLeftExchangedTimes()<=1&&(this.node.getChildByName("toggle").getComponent(cc.Toggle).isChecked=!1,e=!1);this._bExchangeFiveTimes=e,this._setCostLayer(),this._setOwnTimes()},onTryToExchangeGold:function(){if(this._controller.hasExchangeTimes()){var t=this._bExchangeFiveTimes?this._controller.getOneKeyExchangeTimes():1,e=this._controller.getCost(t);td.GamerResourceUtil.checkResource(td.ItemEnum.Diamond,e)?this._doExchange(t):this._tipRecharge(23)}else this._tipRecharge(48)},_tipRecharge:function(t){var e=new td.BroadcastContent(t);e.setOkCallFunc(function(){td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityFixed,td.ActivityEnum.ActivityType.GoldTreasure])}.bind(this)),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e)},_doExchange:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_EXCHANGE_GOLD,t)}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],GoldTreasureTable:[function(t,e,i){"use strict";cc._RF.push(e,"abeb7T3r51MFKs3O5oad3Ok","GoldTreasureTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GoldTreasureTable",properties:{_tblName:"money_tree_config",_maxGold:null},init:function(){this._deleteJson=!1,this._maxGold=0;var t=this._jsonData;for(var e in t)this._maxGold=Math.max(this._maxGold,t[e])},getGoldByLevel:function(t){return this._jsonData[t]||this._maxGold}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GroupBuyWindow:[function(t,e,i){"use strict";cc._RF.push(e,"ddf153wU8ZJe5M1iUzLuCxe","GroupBuyWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemName=null,e.progressBar=null,e.sliderBar=null,e.lab_vigor=null,e.operateCountLabel=null,e._operateNum=0,e._limitNum=0,e._value=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_GroupBuy},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this.sliderBar.node.on("slide",this.onSliderChange,this)},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this._itemData=null},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.RES_HERO_RUNE_DECOMPOSE]=this.closeCallFunc,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._itemData=e.item,this._limitNum=e.max,this._price=e.price,this._reward=e.reward,this._operateNum=1,this._refreshBaseInfo(),this._updateProgress()},e.prototype._refreshBaseInfo=function(){this._productId=this._itemData.id;var t=this._reward;this.itemName.getComponent(cc.Label).string=t.getName(),r.GlobalFunction.setNameColors(this.itemName,t.getQuality());var e=this.node.getChildByName("itemIcon");e?e.getComponent("CommonIconWidget").setData(t):((e=r.GlobalFunction.createCommonIconWidget(26,t)).name="itemIcon",this.node.addChild(e),e.position=cc.v2(-205,205),e.getComponent("CommonIconWidget").disableHeadTouch())},e.prototype._updateProgress=function(){this._value=this._price*this._operateNum,this.operateCountLabel.string=cc.js.formatStr("%s/%s",this._operateNum,this._limitNum),this.lab_vigor.string=this._value+"",r.Account.getUserData().getDiamond()>=this._value?this.lab_vigor.node.color=cc.color(103,111,163):this.lab_vigor.node.color=cc.color(251,6,6);var t=this._operateNum/this._limitNum;this.progressBar.progress=t,this.sliderBar.progress=t},e.prototype.onSliderChange=function(t){var e=t.progress;this._operateNum=Math.floor(this._limitNum*e),this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onOperateNum=function(t,e){e=parseInt(e),this._operateNum+=e,this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onBtn=function(){if(r.Account.getUserData().getDiamond()>=this._value){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.GroupPurchase);if(!t||!t.isInOpenStatus()){var e=new r.BroadcastContent(235);return r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,e),void this.closeCallFunc()}var i={};i.id=this._productId,i.parmeterMap={6:this._operateNum},t.operateActivity(i),this.closeCallFunc()}else{e=new r.BroadcastContent(186);r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,e)}},a([l(cc.Node)],e.prototype,"itemName",void 0),a([l(cc.ProgressBar)],e.prototype,"progressBar",void 0),a([l(cc.Slider)],e.prototype,"sliderBar",void 0),a([l(cc.Label)],e.prototype,"lab_vigor",void 0),a([l(cc.Label)],e.prototype,"operateCountLabel",void 0),e=a([s],e)}(t("PanelBase"));i.default=c,cc._RF.pop()},{PanelBase:void 0}],GroupPurchaseController:[function(t,e,i){"use strict";cc._RF.push(e,"b85bba6TCVA/qs6sdQmvL1R","GroupPurchaseController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_groupDiscountMap:null},initData:function(t){this._super(t),this.clearData()},clearData:function(){this._groupDiscountMap=[]},activityParse:function(t){this._groupDiscountMap=[];var e=t.global;if(e)for(var i=e.productList,n=0;n<i.length;n++)this._groupDiscountMap.push(i[n]);td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_GROUP_PURCHASE_INFO)},getDiscountMap:function(){return this._groupDiscountMap}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],GroupPurchaseListView:[function(t,e,i){"use strict";cc._RF.push(e,"d4ca4BgEM1FJpklYJBJQrzg","GroupPurchaseListView");var n=t("ListItem"),a=cc.Class({extends:n,properties:{_data:null,_price:null,_num:null,_model:null},updateItem:function(t,e){this._super(t,e);var i=this.node,n=i.getChildByName("lab_num"),a=i.getChildByName("img_sell_out"),r=i.getChildByName("lab_old"),o=i.getChildByName("lab_new"),s=i.getChildByName("lab_discount"),l=i.getChildByName("img_point"),c=i.getChildByName("btn"),u=i.getChildByName("reward"),d=i.getChildByName("lab_name"),h=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.GroupPurchase).getActivityData(),p=td.GetTableClass(td.TableEnum.GroupPurchaseTable).getGoodsByDataIdAndId(h,e.id),_=p.count,g=p.cost,f=e.count;this._num=_-f,this._num<0&&(this._num=0),n.getComponent(cc.Label).string=this._num+"/"+_,r.getComponent(cc.Label).string=g[2];var v=e.discount/1e3,m=Math.floor(v);s.getComponent(cc.Label).string=m+"",this._price=Math.floor(g[2]*v/10),o.getComponent(cc.Label).string=this._price+"",m===v?(s.x=126,l.active=!1):(s.x=114,l.active=!0);var y=p.rewards,E=td.RewardManager.getRewardDetail(y[0]);this._model=E;var T=y[0][0],C=td.GlobalFunction.getPlistByRewardType(T);u.y=-64,T===td.RewardType.Item&&(u.y=-114),T===td.RewardType.Mercenary?td.GlobalFunction.showMercenaryFigureAnimation(u,E,!0):T===td.RewardType.Gemstone?td.GlobalFunction.createBigGemstoneIcon(E,u):td.GlobalFunction.createAltasSprite(C,E.getPic(),u),d.getComponent(cc.Label).string=E.getName(),td.GlobalFunction.setNameColors(d,E.getQuality()),a.active=f>=_,gdk.Timer.once(100,this,function(){td.GlobalFunction.setButtonGray(c,f>=_)}),this._data=e},onDisable:function(){gdk.Timer.clearAll(this)},onBuy:function(){var t=this._data;if(td.Account.getUserData().getDiamond()<this._price){var e=new td.BroadcastContent(23);return e.setOkCallFunc(this.gotoRecharge),void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e)}var i={};i.item=t,i.max=this._num,i.price=this._price,i.reward=this._model,td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_GroupBuy,i)},onReward:function(){td.ItemUtil.showItemInfo(this._model)},gotoRecharge:function(){td.GlobalFunction.gotoRecharge()}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],GroupPurchasePanel:[function(t,e,i){"use strict";cc._RF.push(e,"a4ce1YTkWNJXbStPO24i9gR","GroupPurchasePanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{lab_time:cc.Label,_endTime:null},onEnable:function(){this._super(),this._addLocalListeners(),this._refreshList()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this.unschedule(this.loopEndTime),this._super()},_addLocalListeners:function(){var t=td.EventUtil,e={};e[td.EventNameEnum.REFRESH_GROUP_PURCHASE_INFO]=this._refreshList,t.registerEvents(e,this)},_refreshList:function(){var t=this._controller.getDiscountMap();this.node.getComponent("OptimizeVerticalListView").refreshListData(t);var e=this._controller.getCurrentOpenStage().closeTime;this._endTime=new Date(e),this.loopEndTime(),this.schedule(this.loopEndTime,1)},loopEndTime:function(){var t=this._endTime-td.TimeUtil.getTime();t>0?this.lab_time.string=td.GlobalFunction.convertTimestamp(t/1e3,"dd\u5929HH:mm:ss"):(this.lab_time.string=td.Language.end,this.unschedule(this.loopEndTime))}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],GroupPurchaseTable:[function(t,e,i){"use strict";cc._RF.push(e,"8fbad3RFWdDb6Qp3JrF/8F4","GroupPurchaseTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GroupPurchaseTable",properties:{_tblName:"group_buy_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.data]=t[a.data]||{},t[a.data][a.id]=a}},getDataByDataId:function(t){var e=this._data[t];return e||(e={}),e},getGoodsByDataIdAndId:function(t,e){var i=this._data[t];return i?i[e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GroupPurchaseWindow:[function(t,e,i){"use strict";cc._RF.push(e,"64427abNoRGnpe2P5y5FlSn","GroupPurchaseWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemName=null,e.img_icon=null,e.progressBar=null,e.sliderBar=null,e.lab_vigor=null,e.operateCountLabel=null,e._operateNum=0,e._limitNum=0,e._value=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_VipShopBuy},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this.sliderBar.node.on("slide",this.onSliderChange,this)},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this._itemData=null},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.RES_HERO_RUNE_DECOMPOSE]=this.closeCallFunc,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._itemData=e.item,this._limitNum=e.max,this._operateNum=1,this._refreshBaseInfo(),this._updateProgress()},e.prototype._refreshBaseInfo=function(){var t=this._itemData.getRewards();this._productId=this._itemData.getId();var e=r.RewardManager.getRewardDetail(t[0]);this.itemName.getComponent(cc.Label).string=e.getName(),r.GlobalFunction.setNameColors(this.itemName,e.getQuality());var i=this.node.getChildByName("itemIcon");i?i.getComponent("CommonIconWidget").setData(e):((i=r.GlobalFunction.createCommonIconWidget(26,e)).name="itemIcon",this.node.addChild(i),i.position=cc.v2(-205,205),i.getComponent("CommonIconWidget").disableHeadTouch());var n=this._itemData.getCost();this._priceModel=r.RewardManager.getRewardDetail(n),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,this._priceModel.getLittleIconResPath(),this.img_icon)},e.prototype._updateProgress=function(){var t=this._itemData.getCost();this._value=t[2]*this._operateNum,this.operateCountLabel.string=cc.js.formatStr("%s/%s",this._operateNum,this._limitNum),this.lab_vigor.string=this._value+"",this._priceModel=r.RewardManager.getRewardDetail(t);var e=this._priceModel.getId();r.ItemManager.getItemNumById(e)>=this._value?this.lab_vigor.node.color=cc.color(103,111,163):this.lab_vigor.node.color=cc.color(251,6,6);var i=this._operateNum/this._limitNum;this.progressBar.progress=i,this.sliderBar.progress=i},e.prototype.onSliderChange=function(t){var e=t.progress;this._operateNum=Math.floor(this._limitNum*e),this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onOperateNum=function(t,e){e=parseInt(e),this._operateNum+=e,this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onBtn=function(){var t=this._priceModel.getId();if(r.ItemManager.getItemNumById(t)>=this._value){var e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.GroupPurchase);if(!e)return;var i={};i.id=this._productId,i.parmeterMap={6:this._operateNum},e.operateActivity(i),this.closeCallFunc()}else{var n=new r.BroadcastContent(77),a=new r.BroadcastParam(this._priceModel.getName());n.setMainParam([a]),r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,n)}},a([l(cc.Node)],e.prototype,"itemName",void 0),a([l(cc.Node)],e.prototype,"img_icon",void 0),a([l(cc.ProgressBar)],e.prototype,"progressBar",void 0),a([l(cc.Slider)],e.prototype,"sliderBar",void 0),a([l(cc.Label)],e.prototype,"lab_vigor",void 0),a([l(cc.Label)],e.prototype,"operateCountLabel",void 0),e=a([s],e)}(t("PanelBase"));i.default=c,cc._RF.pop()},{PanelBase:void 0}],GrowthPlanController:[function(t,e,i){"use strict";cc._RF.push(e,"e88c6HnLkxJeoLHU9ksqOSw","GrowthPlanController");var n=t("GrowthPlanModel"),a=t("ActivityBaseController"),r=cc.Class({extends:a,properties:{_growthPlanList:null,_buyList:null},initData:function(t){this._super(t),this._growthPlanList={},this._buyList={},this.addNetListener(),this.addEventListener()},addNetListener:function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.GROW_FUND_INFO,this.receiveGrowthPlanBaseInfo.bind(this)),i.registerMessage(t,e.BUY_GROW_FUND,this.onBuyGrowthFundReturn.bind(this)),i.registerMessage(t,e.GROW_FUND_RECEIVE,this.recGetGrowthFundReturn.bind(this)),i.registerMessage(t,e.PUSH_GROW_FUND,this.receiveGrowthPlanBaseInfo.bind(this))},addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REQUEST_GROWTH_PLAN_INFO]=this.requestBaseInfo.bind(this),t[e.REQUEST_BUY_GROWTH_FUND]=this.requestBuyGrowthFund.bind(this),t[e.REQUEST_GET_GROWTH_FUND]=this.requestGetGrowthFund.bind(this),td.EventUtil.registerEvents(t,this)},destroyData:function(){this._super(),this._growthPlanList=null,this._buyList=null},getWelfareLeftTime:function(){return td.SystemManager.getServerOpenTime()+24*td.GetConfig("ALL_WELFARE_LIMIT_DAY")*3600*1e3-td.TimeUtil.getTime()},getDataById:function(t){return this._growthPlanList[t]},getAllData:function(){return this._growthPlanList},getSortedData:function(t){var e=[],i=this._growthPlanList;for(var n in i)i[n]&&(t&&i[n].getType()!=t||(e[e.length]=i[n]));var a=td.ActivityEnum.GrowthPlanEnum;return e.sort(function(t,e){return t.getState()===a.ALREADY_Receive&&e.getState()!==a.ALREADY_Receive?1:t.getState()!==a.ALREADY_Receive&&e.getState()===a.ALREADY_Receive?-1:t.getId()-e.getId()}),e},getListByType:function(t){var e=[],i=this._growthPlanList;for(var n in i)i[n]&&i[n].getType()==t&&(e[e.length]=i[n]);return e},isCanBuy:function(){return!this._buyState&&td.UnlockManager.isTargetUnlock(td.ActorUnlockType.GrowthFund,1)},_initData:function(){if(!(this._growthPlanList.myLen()>0)){this._growthPlanList={};for(var t=td.GetTableClass(td.TableEnum.GrowthPlanTable).getAllData(),e=0,i=t.length;e<i;e++){var a=t[e],r=new n;r.initData(a),r&&(this._growthPlanList[r.getId()]=r)}if(!(this._buyList.myLen()>0)){this._buyList={};var o=td.ActivityEnum.GrowthPlanTableType,s=td.ActivityEnum.GrowthPlanActiveEnum.NOT_ACTIVE;for(var l in o){var c=o[l];this._buyList[c]=s}}}},getBuyList:function(){return this._buyList},isPlanActive:function(t){var e=td.ActivityEnum.GrowthPlanActiveEnum.IS_ACTIVE;return!(!this._buyList||!this._buyList[t])&&this._buyList[t]===e},requestBaseInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.GROW_FUND_INFO,td.ServerDelegate.sendMessage(t)},receiveGrowthPlanBaseInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._initData();var i=e.receives;for(var n in i){this._buyList[n]=td.ActivityEnum.GrowthPlanActiveEnum.IS_ACTIVE;for(var a=0;a<i[n].length;a++){var r=i[n][a],o=this._growthPlanList[r];o&&o.setState(td.ActivityEnum.GrowthPlanEnum.ALREADY_Receive)}}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_GROWTH_PLAN_VIEW)}},requestBuyGrowthFund:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.BUY_GROW_FUND,e.configId=t,td.ServerDelegate.sendMessage(e)},onBuyGrowthFundReturn:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.REC_BUY_GROWTH_FUND_RETURN)},requestGetGrowthFund:function(t){if(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.GROW_FUND_RECEIVE,e.configId=t,td.ServerDelegate.sendMessage(e)}},recGetGrowthFundReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.GlobalFunction.showRewards(n)}},isAllRecevied:function(){for(var t in this._growthPlanList){var e=this._growthPlanList[t];if(e&&e.getState()!==td.ActivityEnum.GrowthPlanEnum.ALREADY_Receive)return!1}return!0},hasRedPoint:function(){return!0},redPointTip:function(){if(!this._growthPlanList)return!1;var t=td.ActivityEnum.GrowthPlanTableType;for(var e in t){var i=t[e];if(this.redPointTipForType(i))return!0}return!1},redPointTipForType:function(t){if(!this._growthPlanList)return!1;if(t===td.ActivityEnum.GrowthPlanTableType.WELFARE&&this.getWelfareLeftTime()<=0)return!1;for(var e in this._growthPlanList){var i=this._growthPlanList[e];if(i&&i.getType()===t&&i.getState()===td.ActivityEnum.GrowthPlanEnum.CAN_Receive)return!0}},redPointEvts:function(){return[td.EventNameEnum.REFRESH_GROWTH_PLAN_VIEW,td.EventNameEnum.REC_BUY_GROWTH_FUND_RETURN,td.EventNameEnum.ON_GET_SERVER_SETTING]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",GrowthPlanModel:"GrowthPlanModel"}],GrowthPlanListItem:[function(t,e,i){"use strict";cc._RF.push(e,"ec4a1o3j8NOPYrdP2rnrqQQ","GrowthPlanListItem");var n=t("ListItem"),a=cc.Class({extends:n,onLoad:function(){this._super()},updateItem:function(t,e){this._super(t,e);var i=this.node,n=i.getChildByName("richTitle"),a=td.Account.getUserData();if(e.getType()==td.ActivityEnum.GrowthPlanTableType.LOGIN){var r=a.getLoginTotalDay();r>=e.getLimit()?n.getComponent(cc.RichText).string="<color=#A25B00>"+e.getTitleDesc()+"</c><color=#0eb001>("+r+"/</c><color=#0eb001>"+e.getLimit()+")</color>":n.getComponent(cc.RichText).string="<color=#A25B00>"+e.getTitleDesc()+"</c><color=#A25B00>("+r+"/</c><color=#A25B00>"+e.getLimit()+")</color>"}else if(e.getType()==td.ActivityEnum.GrowthPlanTableType.LEVEL)a.level>=e.getLimit()?n.getComponent(cc.RichText).string="<color=#A25B00>"+e.getTitleDesc()+"</c><color=#0eb001>("+a.level+"/</c><color=#0eb001>"+e.getLimit()+")</color>":n.getComponent(cc.RichText).string="<color=#A25B00>"+e.getTitleDesc()+"</c><color=#A25B00>("+a.level+"/</c><color=#A25B00>"+e.getLimit()+")</color>";else if(e.getType()==td.ActivityEnum.GrowthPlanTableType.CUSTOMS)n.getComponent(cc.RichText).string="<color=#A25B00>"+e.getTitleDesc()+"</c>";else if(e.getType()==td.ActivityEnum.GrowthPlanTableType.WELFARE){var o=td.SystemManager.getSettingByKey(td.ServerSettingKey.GROW_FUND_BUY_TOTAL_COUNT)||0;o>=e.getLimit()?n.getComponent(cc.RichText).string="<color=#A25B00>"+e.getTitleDesc()+"</c><color=#0eb001>("+o+"/</c><color=#0eb001>"+e.getLimit()+")</color>":n.getComponent(cc.RichText).string="<color=#A25B00>"+e.getTitleDesc()+"</c><color=#A25B00>("+o+"/</c><color=#A25B00>"+e.getLimit()+")</color>"}var s=i.getChildByName("rewardPanel");s.removeAllChildren();for(var l=e.getRewards(),c=0,u=l.length;c<u;c++){var d=l[c],h=td.GlobalFunction.createCommonIconWidget(26,d);h.setPosition(cc.v2(50+(5+.8*h.getContentSize().width)*c,50)),h.setScale(.8),s.addChild(h)}return this._setBtn(i,e),i},_setBtn:function(t,e){var i=t.getChildByName("btnOperation"),n=i.getComponent(cc.Button),a=t.getChildByName("imgReceived"),r=td.ActivityEnum.GrowthPlanEnum,o=e.getState();if(i.active=o===r.CAN_NOT_Receive||o===r.CAN_Receive,a.active=o===r.ALREADY_Receive,o===r.CAN_Receive){td.GlobalFunction.setButtonGray(i,!1),n.clickEvents=[];var s=td.GlobalFunction.createClickEventHandler(this.node,"GrowthPlanListItem","onBuy",e);n.clickEvents.push(s)}else td.GlobalFunction.setButtonGray(i,!0);td.RedPointUtil.createRedPointSimple(i,{x:-10,y:-10},o===r.CAN_Receive)},onBuy:function(t,e){if(e){var i=e.getId();td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_GET_GROWTH_FUND,i)}}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],GrowthPlanModel:[function(t,e,i){"use strict";cc._RF.push(e,"0d49f7rkChH1ZSwF6FetjJ4","GrowthPlanModel");var n=cc.Class({properties:{_id:null,_type:null,_minLimit:null,_titleDesc:null,_reward:null,_showReward:null,_state:null},initData:function(t){if(t){this._id=t.id,this._type=t.type,this._minLimit=t.minLimit,this._showReward=this._getShowRewardList(t.reward),this._reward=td.RewardManager.parseRewardListDetail(t.reward),this._state=td.ActivityEnum.GrowthPlanEnum.CAN_NOT_Receive;var e=td.ActivityEnum.GrowthPlanTableType;if(this._type==e.LOGIN)this._titleDesc=cc.js.formatStr(td.Language.GrowthPlanTitle1,this._minLimit);else if(this._type==e.LEVEL)this._titleDesc=cc.js.formatStr(td.Language.GrowthPlanTitle2,this._minLimit);else if(this._type==e.CUSTOMS){var i=td.GetTableClass(td.TableEnum.PveGeneralCopyGateTable).getStoryDataById(this._minLimit);this._titleDesc=cc.js.formatStr(td.Language.GrowthPlanTitle3,i.name)}else this._type==e.WELFARE&&(this._titleDesc=cc.js.formatStr(td.Language.GrowthPlanTitle4,this._minLimit))}},getId:function(){return this._id},getType:function(){return this._type},getLimit:function(){return this._minLimit},getShowReward:function(){return this._showReward},getRewards:function(){return this._reward},setState:function(t){this._state=t},getState:function(){var t=td.ActivityEnum.GrowthPlanEnum,e=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.GrowthPlan);if(!e||!e.isPlanActive(this._type))return t.CAN_NOT_Receive;if(this._state!==t.CAN_NOT_Receive)return this._state;var i=td.ActivityEnum.GrowthPlanTableType,n=td.ActivityEnum.GrowthPlanEnum.CAN_Receive,a=!1,r=td.Account.getUserData();switch(this._type){case i.LOGIN:a=r.getLoginTotalDay()>=this._minLimit;break;case i.LEVEL:a=r.level>=this._minLimit;break;case i.CUSTOMS:a=r.getCurStoryId()>this._minLimit;break;case i.WELFARE:a=(td.SystemManager.getSettingByKey(td.ServerSettingKey.GROW_FUND_BUY_TOTAL_COUNT)||0)>=this._minLimit}return a&&(this._state=n),this._state},getTitleDesc:function(){return this._titleDesc},_getShowRewardList:function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],a={};a.type=n[0],a.id=n[1],a.count=n[2],e[e.length]=a}return e=td.RewardManager.convertCfgType2GoodsType(e)}});e.exports=n,cc._RF.pop()},{}],GrowthPlanPanel:[function(t,e,i){"use strict";cc._RF.push(e,"2c727jLOsNHVqG8uhfxcvE9","GrowthPlanPanel");var n=t("ActivityBasePanel"),a=t("TabController"),r=t("OptimizeVerticalListView"),o=cc.Class({extends:n,properties:{_listViewLogic:null,btn_page0:cc.Node,btn_page1:cc.Node,btn_page2:cc.Node,btn_page3:cc.Node,wordImg:cc.Node,fundNode:cc.Node,welfareNode:cc.Node,timeLabel:cc.Label,_showTab:null},initData:function(t){this._super(t)},onLoad:function(){this._listViewLogic=this.node.getComponent(r),this.wordImg.active=!1,this.fundNode.active=!1,this.welfareNode.active=!1;var t=this._controller,e=td.ActivityEnum.GrowthPlanPage,i=[];for(var n in e){var o=e[n],s=this["btn_page"+o];s&&(s._tag=o,i[i.length]=s);var l=o+1;td.RedPointUtil.createRedPointOld(s,cc.v2(-10,-10),t.redPointTipForType.bind(t,l),t.redPointEvts())}this._tabController||(this._tabController=new a,this._tabController.init(i,this,e.Level))},onEnable:function(){this._super(),this._addLocalListeners(),this._tabController.resetEventListner();this._refreshWelfareStatus();this._showTab=td.ActivityEnum.GrowthPlanPage.Level,td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_GROWTH_PLAN_INFO)},onDisable:function(){this._super(),this._removeAllListeners(),this.unschedule(this._updateTimeLabel)},_addLocalListeners:function(){td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_GROWTH_PLAN_VIEW,this._refreshView,this),td.EventUtil.registerEvent(td.EventNameEnum.REC_BUY_GROWTH_FUND_RETURN,this.onBuySuccess,this),td.EventUtil.registerEvent(td.EventNameEnum.GET_GAME_FUND_SUCCESS,this.onReceiveSuccess,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_GET_SERVER_SETTING,this._onWelfareBuyCountChanged,this),td.EventUtil.registerEvent(td.EventNameEnum.USER_LOGIN_DAY_CHANGE,this._refreshLoginFund,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},_refreshLoginFund:function(){this._showTab===td.ActivityEnum.GrowthPlanPage.Login&&this._refreshListView()},_onWelfareBuyCountChanged:function(){this._showTab===td.ActivityEnum.GrowthPlanPage.Welfare&&(this._setWelfareState(),this._refreshListView())},_refreshWelfareStatus:function(){var t=this._controller.getWelfareLeftTime();return t>0?(this.btn_page3.active=!0,this.schedule(this._updateTimeLabel,1)):(this.btn_page3.active=!1,this.unschedule(this._updateTimeLabel)),t>0},_updateTimeLabel:function(){var t=this._controller.getWelfareLeftTime();t<0?this._refreshWelfareStatus():this.timeLabel.node.activeInHierarchy&&(this.timeLabel.string=td.Language.battleEndTime+td.GlobalFunction.getTimeSecondsStringByDeltaTime(t))},showTab:function(t){t!==this._showTab&&(this._showTab=t,this._refreshView())},_refreshView:function(){this._refreshTitleInfo(),this._refreshListView()},_refreshTitleInfo:function(){var t=this._showTab,e=td.ActivityEnum.GrowthPlanWordRes;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_15_ccjj,e[t],this.wordImg),this.wordImg.active=!0;var i=t===td.ActivityEnum.GrowthPlanPage.Welfare;this.fundNode.active=!i,this.welfareNode.active=i,i?this._setWelfareState():this._setBuyBtnState()},_refreshListView:function(){var t=this._controller.getSortedData(this._showTab+1);this._listViewLogic.setData(t)},_setWelfareState:function(){this._showTab===td.ActivityEnum.GrowthPlanPage.Welfare&&(this.welfareNode.getChildByName("buyNum").getComponent(cc.Label).string=td.SystemManager.getSettingByKey(td.ServerSettingKey.GROW_FUND_BUY_TOTAL_COUNT)||0,this._updateTimeLabel())},_setBuyBtnState:function(){var t=this.fundNode.getChildByName("labTips"),e=this.fundNode.getChildByName("btnBuyFund"),i=e.getChildByName("Label"),n=e.getChildByName("imgIcon"),a=this._showTab+1,r=td.GetTableClass(td.TableEnum.GrowthPlanRewardTable).getDataByType(a),o=r.minLimit;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_15_ccjj,"HD_ccjj_wz_vip"+o,t);var s=td.RewardManager.getRewardDetail(r.cost[0]);i.getComponent(cc.Label).string=s.getCount();var l=this._controller.isPlanActive(a);n.active=!l,l?(i.getComponent(cc.Label).string=td.Language.bought,i.x=50):i.x=33.5,td.GlobalFunction.setButtonGray(e,l)},onReceiveSuccess:function(t){},onTryToBuyGrowthFund:function(){var t=this._showTab+1,e=td.GetTableClass(td.TableEnum.GrowthPlanRewardTable).getDataByType(t),i=e.minLimit;if(td.Account.getUserData().vip<i)return(a=new td.BroadcastContent(206)).setMainParam([new td.BroadcastParam(i)]),void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a);var n=td.RewardManager.getRewardDetail(e.cost[0]).getCount();if(td.GamerResourceUtil.checkResource(td.ItemEnum.Diamond,n)){var a;(a=new td.BroadcastContent(46)).setMainParam([new td.BroadcastParam(n)]),a.setOkCallFunc(this.buyGrowthFund.bind(this)),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a)}else{var r=new td.BroadcastContent(23);r.setOkCallFunc(function(){td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityFixed,td.ActivityEnum.ActivityType.GrowthPlan])}.bind(this)),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,r)}},buyGrowthFund:function(){var t=this._showTab+1;td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_BUY_GROWTH_FUND,t)},onBuySuccess:function(t){var e=new td.BroadcastContent(47);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e)},onJumpBtn:function(){this._tabController.showTab(td.ActivityEnum.GrowthPlanPage.Login)}});e.exports=o,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0,TabController:void 0}],GrowthPlanRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"723dfyJQxRLxJAiLfMAVsg4","GrowthPlanRewardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GrowthPlanRewardTable",properties:{_tblName:"grow_fund_buy_config",_data:null,_idData:null},init:function(){this._data=[],this._idData={};for(var t=this._data,e=this._idData,i=this._jsonData,n=0,a=i.length;n<a;n++){var r=i[n];t[t.length]=r,e[r.type]=r}},getAllData:function(){return this._data},getDataByType:function(t){return this._idData[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GrowthPlanTable:[function(t,e,i){"use strict";cc._RF.push(e,"f103dUxcBtFK4/ABCFIadO1","GrowthPlanTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GrowthPlanTable",properties:{_tblName:"grow_fund_reward_config",_data:null,_idData:null},init:function(){this._data=[],this._idData={};for(var t=this._data,e=this._idData,i=this._jsonData,n=0,a=i.length;n<a;n++){var r=i[n];t[t.length]=r,e[r.id]=r}this._data.sort(function(t,e){return t.id-e.id})},getAllData:function(){return this._data},getDataById:function(t){return this._idData[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],GuideManager:[function(t,e,i){"use strict";cc._RF.push(e,"cfdb91KCV9GMajgTvhXPzvr","GuideManager");var n=r(t("../../Hero/Manager/HeroManager")),a=r(t("../../../View/Login/Enum/LoginFsmEventId"));function r(t){return t&&t.__esModule?t:{default:t}}var o=t("PveCopyEnum"),s=t("UFSdkManager"),l=t("PveHeroModel"),c=t("CommonEnum");td.GuideType={Normal:1,SystemOpen:2,TaskReceive:3},td.GuideManager={_bInitGuide:null,_panelGuideList:null,_isFirstBattle:null,_curGuideId:null,_curStepId:null,_curGuideData:null,_curGuidePanelId:null,_guideTrigger:null,_isFightReady:null,_isFightEnd:null,_isPveLightSkillBegin:null,_isGachaAniEnd:null,_canTreasureRob:null,_canTreasureCompose:null,_isMainSceneLoaded:null,_isAfterHeroFly:null,_minLevel:null,_maxNorGuideId:null,_stopGuide:!1,_checkTimes:0,_copyData:null,_finishList:null,_battleData:null,init:function(){this.destroyData(),this._addEventListener()},setStopGuide:function(t){this._stopGuide=t},destroyData:function(){this._isFirstBattle||(this._bInitGuide=!1,this._panelGuideList={},this._isFirstBattle=!1,this._curGuideId=0,this._curStepId=0,this._curGuidePanelId=0,this._curGuideData=null,this._guideTrigger=null,this._minLevel=150,this._maxNorGuideId=0,this._stopGuide=!1,this._checkTimes=0,this._isFightReady=!1,this._isFightEnd=!1,this._isPveLightSkillBegin=!1,this._isMainSceneLoaded=!1,this._isAfterHeroFly=!1,this._finishList={},this._battleData=null)},_addEventListener:function(){var t=td.EventNameEnum,e={};e[t.GUIDE_STEP_FINISH]=this._nextStepGuide,e[t.GUIDE_STAGE_EVENT]=this._triggerStageGuide,e[t.GUIDE_FORCE_NEXT_STAGE_EVENT]=this._foreDoNextStepGuide,e[t.GUIDE_CHECK_STEP]=this._checkStepGuide,e[t.GUIDE_CHECK_NEXT_STEP]=this._nextStepGuide,e[t.GUIDE_SKIP]=this._skipGuide,e[t.FIRST_BATTLE_FINISH]=this._firstBattleFinish,e[t.GUIDE_PVE_FIGHTING_TRIGGER]=this.triggerPveFirstBattleFightGuide,e[t.GENERAL_COPY_READY_RETURN]=this.triggerGuidePveCopyFirstGate,e[t.SDK_INIT_FINISH]=this.setGuideTest,e[t.GUIDE_CUSTOM_COND_CHANGE]=this._onCustomCondEvent,e[t.REQ_GUIDE_SAVE_BRIDE_DOT]=this.reqSaveBrideDot,e[t.GUIDE_BATTLE_UNIT_FINISH]=this._onBattleUnitFinish,td.EventUtil.registerEvents(e,this)},setGuideTest:function(){s.getInstance().showRecharge()||(GUIDE_TEST=!0)},isInitGuide:function(){return this._bInitGuide},_firstBattleFinish:function(){this._isFirstBattle=!1,this.reportGuide(td.GuideId.PveGuideId)},isFirstBattle:function(){return!GUIDE_TEST&&this._isFirstBattle},isPveLightSkillGuide:function(){return!GUIDE_TEST&&this._curGuideId&&this._curGuideId===td.GuideId.PveLightSkillId},isDoingGachaGuide:function(){return!GUIDE_TEST&&this._curGuideId&&this._curGuideId<=td.GuideId.GachaGuideId},isDoingEndlessGuide:function(){return!GUIDE_TEST&&this._curGuideId&&this._curGuideId===td.GuideId.EndlessGuideId},isDoingLoginGiftGuide:function(){return!GUIDE_TEST&&this._curGuideId&&this._curGuideId===td.GuideId.LoginGiftGuideId},isPvpBattleGuide:function(){return this.isDoingEndlessGuide()},getBattleData:function(){return this._battleData},_clearBattleData:function(){this._battleData=null},_onBattleUnitFinish:function(t){this._battleData=null,!GUIDE_TEST&&this.isPvpBattleGuide()&&(this._battleData=t,this._checkCurPanelGuide())},_onRoundComplete:function(t){!GUIDE_TEST&&this.isPvpBattleGuide()},_skipGuide:function(){},getGuideId:function(){return this._curGuideId},getCurGuideStepId:function(){return this._curStepId},getGuideData:function(){return this._curGuideData},getFightActivityPanelEnum:function(){if(!this._curGuideData||!this._curGuideData[this._curStepId])return null;var t=this._curGuideData[this._curStepId].targetName.split("_");return"item"===t[0]?parseInt(t[1]):null},isHasGuide:function(){return!(GUIDE_TEST||!this.chelLevelLimit())},isForceGuideFinshed:function(){if(GUIDE_TEST||!this.chelLevelLimit())return!0;var t=td.GetTableClass(td.TableEnum.GuideTable).getMaxNorGuideId();return this._maxNorGuideId>t},_setGuideData:function(t){this._curGuideData=t,this._curGuideId=t?t.guideId:0,this._curStepId=t?t.stepId:0},_checkStepGuide:function(t){if(!this._stopGuide){var e=this._panelGuideList[t];if(!e||0===e.length)return this._guideTrigger&&(clearTimeout(this._guideTrigger),this._guideTrigger=null),void td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_FINISH);this._curGuidePanelId=t;for(var i,n=td.GetTableClass(td.TableEnum.GuideTable),a=0,r=e.length;a<r;a++){var o=e[a],s=n.getStepData(o.guideId,o.stepId);if(td.GuideUtil.triggerConfigCondition(s)){i=s;break}}if(i){if(this._curGuideData===i.guideId&&this._curStepId===i.stepId)return;this._guideTrigger&&(clearTimeout(this._guideTrigger),this._guideTrigger=null),4e3===i.guideId&&td.LocalStorageUtil.write(td.LocalDataKey.Begin_Smelt_task,!0),4001===i.guideId&&td.LocalStorageUtil.write(td.LocalDataKey.Begin_Smelt_task1,!0);var l=this;this._guideTrigger=setTimeout(function(){l._guideTigger(i)},i.beforeDelayTime||0)}else td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_FINISH)}},_checkCurPanelGuide:function(){var t=this._curGuideData;if(t&&""==t.targetPanel){this._guideTrigger&&(clearTimeout(this._guideTrigger),this._guideTrigger=null);var e=this;this._guideTrigger=setTimeout(function(){e._guideTigger(t)},t.beforeDelayTime||0)}else{var i=this._curGuidePanelId;i&&this._checkStepGuide(i)}},deleteCompletedGuide:function(t){var e=t&&1===t.complete,i=t&&t.handleType===td.Guide.HandleType.Focus;if(e&&!i){this.reportGuide(this._curGuideId);var n=td.GetTableClass(td.TableEnum.GuideTable).getMaxNorGuideId();this._curGuideId===n&&(this._maxNorGuideId=n+1),t.guideType===td.GuideType.SystemOpen&&this._deleteSysOpenGuide(t.guideId)}},_nextStepGuide:function(){if(!this._stopGuide&&this._curGuideData){this._clearBattleData();var t=this._curGuideData;if(t&&t.finishEvent){var e=t.finishEvent;e&&this.handleEvents(e)}this._checkTimes=0;var i=td.GetTableClass(td.TableEnum.GuideTable),n=t&&1===t.complete;if(n){this.reportGuide(this._curGuideId);var a=i.getMaxNorGuideId();this._curGuideId===a&&(this._maxNorGuideId=a+1),t.guideType===td.GuideType.SystemOpen&&this._deleteSysOpenGuide(t.guideId)}t&&t.id>0&&(td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_GUIDE_SAVE_BRIDE_DOT,t.id),td.DataReporter.onEvent("GuideId_"+t.id));var r=this._curGuideId,o=this._curStepId,s=t.handleType===td.Guide.HandleType.Focus||"Dialog"===t.guideViewType||n,l=!1,c=i.getStepData(r,o+1);if(!c){l=!0;var u=t.nextGuideId;if(0!==u&&(c=i.getStepData(u,1))){if(c.taskId&&c.guideType!==td.GuideType.TaskReceive){var d=!1,h=td.TaskManager.getTaskById(c.taskId);h&&(d=h.getStatus()===td.TaskStatus.Finish||h.getStatus()===td.TaskStatus.Received),d&&(this._deleteGuide(u),c=0!==(u=c.nextGuideId)?i.getStepData(u,1):null)}this._resetCustomCondParam(),this._setGuideData(c)}}l?this._deleteGuide(r):s&&this._deleteGuide(r,o,n),c?this._doStepGuide(c):(td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_FINISH),this._resetCustomCondParam(),this._setGuideData(null))}},_deleteGuide:function(t,e,i){var n=this._panelGuideList,a=!1;for(var r in n){for(var o=n[r],s=o.length;s--;)if(o[s].guideId===t&&(!e||!i&&o[s].stepId===e||i&&o[s].stepId<=e)&&(o.splice(s,1),!i&&e)){a=!0;break}if(a)break}},handleEvents:function(t){if(t)for(var e=td.GuideEvent,i=0,r=t.length;i<r;i++){var o=t[i];switch(o[0]){case e.Pve_Battle_Pause:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_PAUSE_PVE_FIGHT);break;case e.Pve_Battle_Resume:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_RESUME_PVE_FIGHT);break;case e.Pve_Show_Inspire:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_SHOW_INPIRE_UI_SKILL),this._preLoadMainScenRes();break;case e.Pve_Show_Storm:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_SHOW_STORM_UI_SKILL),td.BattleArrayManager.preLoadBattleHeroRes();break;case e.Pve_Fight_Result:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_SHOW_PVE_FIGHT_RESULT);break;case e.Pve_Open_Build_Switch:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_SET_BUILD_TOWER_SWITCH,!0);break;case e.Pve_Close_Build_Switch:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_SET_BUILD_TOWER_SWITCH,!1);break;case e.Pve_Create_tmp_platform_flag:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_PVE_CREATE_TMP_PLATFORM_FLAG,o[1]);break;case e.Pve_show_tmp_platform_flag:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_PVE_SHOW_TMP_PLATFORM_FLAG,o[1]);break;case e.Pve_show_play_special_skill:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_PVE_PLAY_SPECIAL_SKILL,o[1]);case e.Pve_Line_Up_Hero:var s=o[1],c=n.default.getInstance().getGuideHeroDataBySid(s),u=td.TableManager.getTableClass(td.TableEnum.PveHeroFihgtShowTable).getPveHeroCfgById(s),d=new l;d.init(u,s,c),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_BUILD_TOWER,{heroDataModel:d,tag:o[2],bAction:!0});break;case e.Pve_Start_Battle:td.EventUtil.dispatchEvent(td.EventNameEnum.BEGIN_CREATE_ENEMY);break;case e.Pve_Show_Create_Role:gdk.fsm.Fsm.broadcastEvent(a.default.SHOW_CREATE_ROLE_WINDOW);break;case e.Pve_GRIL_MOVING:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_PVE_GIRL_MOVING,o[1]);break;case e.Pve_Full_Anger_Power:td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_FULL_ANGER_POWER);break;case e.Pve_Light_Skill_Guide:td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_PVE_LIGHT_SKILL);break;case e.Pvp_Battle_Pause:td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSE_FIGHT);break;case e.Pvp_Battle_Resume:td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_FIGHT);break;case e.Pvp_Show_Hero:td.EventUtil.dispatchEvent(td.EventNameEnum.PVP_SPECIAL_HERO_SHOW,o[1]);break;case e.Fly_Hero:td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_HERO_MODEL_FLY,{id:o[1],nodePath:o[2]});break;case e.Disable_Scroll:td.EventUtil.dispatchEvent(td.EventNameEnum.DISABLE_SCROLL);break;case e.Enable_Scroll:td.EventUtil.dispatchEvent(td.EventNameEnum.ENABLE_SCROLL);break;case e.Chapter_Fly_Hero:td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_CHAPTER_HERO_MODEL_FLY,{id:o[1],nodePath:o[2]})}}},_preLoadMainScenRes:function(){var e=t("PveLoader").getModules(!1,!0);gdk.rm.addLoadResInBackground(e.concat(["UnReleaseRes","Common","TaskView","MainPanel","GachaPanel","GachaRewardPanel"]),td.PanelEnum.Panel_PVE_FIGHT_HOOK)},reqSaveBrideDot:function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.SAVE_BRIDE_DOT,e.guideId=t,td.ServerDelegate.sendMessage(e)},_foreDoNextStepGuide:function(){var t=this._curGuideData,e=0;t?(td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_FINISH),t&&0!==t.nextGuideId&&(e=t.nextGuideId)):(td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_FINISH),(t=td.GetTableClass(td.TableEnum.GuideTable).getStepData(this._curGuideId,this._curStepId-1))&&0!==t.nextGuideId&&(e=t.nextGuideId)),0!==e&&(t=td.GetTableClass(td.TableEnum.GuideTable).getStepData(e,1))&&this._doStepGuide(t)},_triggerStageGuide:function(t){if(t){var e=td.GetTableClass(td.TableEnum.GuideTable).getStepData(t,1);e&&this._doStepGuide(e)}},_doStepGuide:function(t){if(this._guideTrigger&&(clearTimeout(this._guideTrigger),this._guideTrigger=null),t.trigger)this._setGuideData(t);else{var e=this;this._guideTrigger=setTimeout(function(){e._guideTigger(t)},t.beforeDelayTime||0)}},_guideTigger:function(t){if(this._guideTrigger&&(clearTimeout(this._guideTrigger),this._guideTrigger=null),this._setGuideData(t),td.GuideUtil.triggerCondition(t)){if(t&&t.beginEvent){var e=t.beginEvent;e&&this.handleEvents(e)}this.deleteCompletedGuide(t),td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_STEP_BEGIN,t)}},chelLevelLimit:function(){var t=td.Account.getUserData();return!!t&&!(t.getLevel()>td.GetConfig("GUIDE_LEVEL_LIMIT"))},insertSysOpenGuide:function(t){if(!this._finishList[t]){var e={},i=td.GetTableClass(td.TableEnum.GuideTable).getGuideDataById(t);for(var n in i){e[a=i[n=parseInt(n)].targetPanel]=e[a]||[],e[a][e[a].length]={guideId:t,stepId:n}}for(var a in e)this._panelGuideList[a]=this._panelGuideList[a]||[],this._panelGuideList[a]=e[a].concat(this._panelGuideList[a])}},deleteSysOpenGuide:function(t){if(!this._finishList[t]){var e=td.GetTableClass(td.TableEnum.GuideTable).getGuideDataById(t);for(var i in e){var n=e[i=parseInt(i)].targetPanel;this._panelGuideList[n]=this._panelGuideList[n]||[];var a=-1;this._panelGuideList[n].some(function(e,n){if(e.guideId==t&&e.stepId==i)return a=n,!0})&&ArrayUtils.removeIndex(this._panelGuideList[n],a)}}},saveSysGuideIds:function(t){for(var e=td.Guide.NewSystemKey,i=td.LocalStorageUtil.read(e)||{},n=t.length-1;n>=0;n--){var a=t[n];i[a]||(a===td.GuideId.TreasureRob?(i[td.GuideId.TreasureCompose]=1,this.insertSysOpenGuide(td.GuideId.TreasureCompose)):a===td.GuideId.HuntGem&&(i[td.GuideId.PickGem]=1,this.insertSysOpenGuide(td.GuideId.PickGem)),i[a]=1,this.insertSysOpenGuide(a))}td.LocalStorageUtil.write(e,i)},_deleteSysOpenGuide:function(t){var e=td.Guide.NewSystemKey,i=td.LocalStorageUtil.read(e);i&&(Array.isArray(t)?t.forEach(function(t){i[t]&&delete i[t]}):i[t]&&delete i[t],td.LocalStorageUtil.write(e,i))},initGuide:function(){if(GUIDE_TEST)return!1;var t=td.Account.getUserData().getGuideId();this._bInitGuide=!0;var e=td.GetTableClass(td.TableEnum.GuideTable),i=td.LocalStorageUtil.read(td.Guide.NewSystemKey)||{},n=e.getMaxNorGuideId();this._finishList={};for(var a=0,r=0,o=t.length;r<o;r++)this._finishList[t[r]]=!0,a=Math.max(a,t[r]);this._maxNorGuideId=a,a===n&&(this._maxNorGuideId=a+1),this._panelGuideList={};var s=e.getGuideList();for(var l in s){var u=s[l=parseInt(l)];for(var d in u){var h=u[d=parseInt(d)];if(!(this._finishList[l]||h.guideType===td.GuideType.SystemOpen&&!i[l]||h.handleType===td.Guide.HandleType.Focus&&!this.chelLevelLimit())){var p=h.targetPanel;this._panelGuideList[p]=this._panelGuideList[p]||[],this._panelGuideList[p][this._panelGuideList[p].length]={guideId:l,stepId:d}}}}if(this.chelLevelLimit()&&0===t.length){td.LocalStorageUtil.write("pveFightSpeed0",1),this._isFirstBattle=!0,td.PveCopyManager.prepareFirstBattle();var _=td.GetConfig("PVE_GUIDE_HERO_IDS");if(!_)return;for(var g=[],f=0,v=_.length;f<v;f++){var m={heroId:_[f],configId:_[f]};g[g.length]=m}td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_PARSE_HEROES_CFGS,g),td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_GUIDE_SAVE_BRIDE_DOT,c.SAVE_BRIDE_DOT.PVE_GUIDE)}},reportGuide:function(t){if(t>=13e4&&t<14e4){var e=td.PveGeneralCopyManager.getCurChapterId();td.PveGeneralCopyManager.setGuideState(!1);var i=td.LocalStorageUtil.read(td.LocalDataKey.Chapter_Open);(!i||i<e)&&td.LocalStorageUtil.write(td.LocalDataKey.Chapter_Open,!0)}td.EventUtil.dispatchEvent(td.EventNameEnum.Req_SAVE_GUIDE_STEP,t)},getCopyData:function(){return this._copyData},triggerPveFirstBattleFightGuide:function(t){if(cc.log("triggerPveFirstBattleFightGuide "+t.id+" "+t.index),this._curGuideData){var e=this._curGuideData;if(e.trigger){var i={type:td.GuideType.Normal,data:t};if(td.GuideUtil.triggerPveCopyCondition(e,i)){var n=this;this._copyData=i,this._guideTrigger=setTimeout(function(){n._guideTigger(e)},e.beforeDelayTime||0)}}}},triggerGuidePveCopyFirstGate:function(){var t=td.GuideManager.isHasGuide(),e=td.GuideManager.getGuideId();if(t&&10002===e){td.GuideManager.setStopGuide(!0);var i=td.PveGeneralCopyManager.getGateModelByGateId(1);td.PveGeneralCopyManager.setCurGatePassedStatus(!1);var n={copyType:o.PVEFightType.GeneralCopy,chapterId:i.getChapterId(),gateId:i.getGateId()};td.PveCopyManager.initCopyData(n),td.EventUtil.dispatchEvent(td.EventNameEnum.RUN_SCENE,td.SceneName.PveFightScene)}},isFightReady:function(){return this._isFightReady},isFightEnd:function(){return this._isFightEnd},isPveLightSkillGuideBegin:function(){return this._isPveLightSkillBegin},isGachaAniEnd:function(){return this._isGachaAniEnd},canTreasureRob:function(){return this._canTreasureRob},canTreasureCompose:function(){return this._canTreasureCompose},isMainSceneLoaded:function(){return this._isMainSceneLoaded},isAfterHeroFly:function(){return this._isAfterHeroFly},_onCustomCondEvent:function(t){if(t){var e=td.GuideCustomCond,i=!1;switch(t){case e.FightReady:this._isFightReady=!0,this._isFightEnd=!1,i=!0;break;case e.FightEnd:this._isFightEnd=!0,i=!0;break;case e.GachaAniEnd:this._isGachaAniEnd=!0,i=!0;break;case e.TreasureCanRob:this._canTreasureRob=!0,this._canTreasureCompose=!1,i=!0;break;case e.TreasureCanCompose:this._canTreasureCompose=!0,this._canTreasureRob=!1,i=!0;break;case e.MainSceneLoaded:this._isMainSceneLoaded=!0,i=!0;break;case e.PveLightSkillGuideBegin:this._isPveLightSkillBegin=!0,i=!0;break;case e.AfterHeroFly:this._isAfterHeroFly=!0,i=!0;break;case e.SmeltTaskEvent:i=!0}i&&this._checkCurPanelGuide()}},getPanelGuides:function(t){return this._panelGuideList[t]},_resetCustomCondParam:function(){this._isFightReady=!1,this._isFightEnd=!1,this._isGachaAniEnd=!1,this._canTreasureRob=!1,this._canTreasureCompose=!1,this._isMainSceneLoaded=!1,this._isPveLightSkillBegin=!1,this._isAfterHeroFly=!1}},cc._RF.pop()},{"../../../View/Login/Enum/LoginFsmEventId":void 0,"../../Hero/Manager/HeroManager":"HeroManager",CommonEnum:void 0,PveCopyEnum:void 0,PveHeroModel:"PveHeroModel",PveLoader:"PveLoader",UFSdkManager:void 0}],GuideTable:[function(t,e,i){"use strict";cc._RF.push(e,"9669adTmLdPT6KE+3sG6M66","GuideTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"GuideTable",properties:{_tblName:"guide_config",_guide:null,_firstGuideId:null,_nextGuideIds:null,_maxNorGuideId:null},init:function(){this._data=[],this._guide={};var t=this._guide,e=this._jsonData;this._nextGuideIds={},this._maxNorGuideId=0;for(var i=this._nextGuideIds,n=0,a=e.length-1;n<=a;n++){var r=e[n];t[r.guideId]||(t[r.guideId]={}),t[r.guideId][r.stepId]=r,1===r.guideType&&(i[r.guideId]=r.nextGuideId),r.guideType===td.GuideType.Normal&&r.handleType===td.Guide.HandleType.Focus&&r.guideId>this._maxNorGuideId&&(this._maxNorGuideId=r.guideId)}for(var o=td.ArrayUtil.frontKey(i);;){var s=o;for(var l in i)i[l]==o&&(o=i[l]);if(s==o)break}this._firstGuideId=Number(o)},getGuideList:function(){return this._guide},getGuideDataById:function(t){return this._guide[t]?this._guide[t]:null},getStepData:function(t,e){return this._guide[t]&&this._guide[t][e]?this._guide[t][e]:null},getMaxNorGuideId:function(){return this._maxNorGuideId},getFirstGuideId:function(){return this._firstGuideId},getNextGuideId:function(t){return this._nextGuideIds[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HalloweenController:[function(t,e,i){"use strict";cc._RF.push(e,"a972fk6e+lJspewx4RofMiQ","HalloweenController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataID=1001,e._myCount=0,e._recharge=0,e._converted=0,e._rewardsMap={},e._chargeRewards=null,e._totalTimes=0,e._receivedList=[],e._isJumpToCharge=!1,e._isOpened=!1,e._curFirecrackerIndex=0,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this._dataID=this.getActivityData()},e.prototype.activityParse=function(t){var e=t.record;e.key,this._myCount;for(var i in this._myCount=e.key||0,this._rewardsMap=e.rewardRecordMap||{},this._chargeRewards=e.chargeRewards||[],this._recharge=e.recharge||0,this._totalTimes=e.totalTimes||0,this._rewardsMap)if(this._rewardsMap.hasOwnProperty(i)){var n=this._rewardsMap[i];-1==this._receivedList.indexOf(n)&&this._receivedList.push(n)}td.EventUtil.dispatchEvent(td.EventNameEnum.RES_HALLOWEEN_INFO)},e.prototype.onOpenPanel=function(){this._isOpened=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.HALLOWEEN_PANEL_OPEN)},e.prototype.getRewardsList=function(){var t=td.GetTableClass(td.TableEnum.FirecrackerTable);return null==t?[]:t.getRewardsList(this._dataID)},e.prototype.isBaozhuFired=function(t){return!!(this._rewardsMap[t]||null)},e.prototype.getBaozhuRewardId=function(t){return this._rewardsMap[t]||null},e.prototype.isRewardReceived=function(t){return-1!=this._receivedList.indexOf(t)},e.prototype.getCharge=function(){return this._recharge},e.prototype.getChargeRewards=function(){return this._chargeRewards},e.prototype.getMyCount=function(){return td.ItemManager.getItemNumById(td.ItemEnum.HalloweenItem)},e.prototype.getCostItemData=function(){var t=td.GetTableClass(td.TableEnum.FirecrackerCostTable).getCostByIdAndTimes(this.getActivityData(),this._totalTimes+1);return t||((t=[])[0]=[11,td.ItemEnum.HalloweenItem,0]),td.RewardManager.getRewardDetail(t[0])},e.prototype.getCostNum=function(){return td.GetTableClass(td.TableEnum.FirecrackerCostTable).getCostByIdAndTimes(this.getActivityData(),this._totalTimes+1)},e.prototype.isCostEnough=function(){var t=this.getCostItemData().getCount();return td.ItemManager.getItemNumById(td.ItemEnum.HalloweenItem)>=t},e.prototype.getIsJumpToCharge=function(){return this._isJumpToCharge},e.prototype.setIsJumpToCharge=function(t){this._isJumpToCharge=t},e.prototype.getCurFirecrackerIndex=function(){return this._curFirecrackerIndex},e.prototype.setCurFirecrackerIndex=function(t){this._curFirecrackerIndex=t},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){return!(this._totalTimes>=12)&&(!!this.isCostEnough()||(!!this.isTaskRedTips()||!this._isOpened&&!td.LoginManager.isFirstLoginToday2()))},e.prototype.isTaskRedTips=function(){for(var t=td.GetTableClass(td.TableEnum.FirecrackerRechargeTable).getConfigById(this._activityData),e=0;e<t.length;e++){var i=t[e];if(i.charge<=this.getCharge()&&-1===this.getChargeRewards().indexOf(i.charge))return!0}return!1},e.prototype.redPointEvts=function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.RES_HALLOWEEN_INFO,td.EventNameEnum.HALLOWEEN_PANEL_OPEN]},e}(t("ActivityBaseController"));i.default=a,e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],HalloweenItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"a9a6ciBtWRApIxyczwgsg4+","HalloweenItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeBaozhu=null,e.nodeItem=null,e.nodeBtn=null,e._iconIndex=0,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i;this._iconIndex=i,this.node.name="item"+this._iconIndex;var a=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Halloween);if(!a)return this.nodeItem.active=!1,void(this.nodeBaozhu.active=!1);var o=a.getBaozhuRewardId(n);if(this.nodeBaozhu.active=!o,this.nodeItem.active=!!o,this.nodeBtn.active=!o,null!=o){var s=r.GetTableClass(r.TableEnum.FirecrackerTable);if(null==s)return[];var l=s.getRewardByDataAndId(a.getActivityData(),o),c=r.RewardManager.getRewardDetail(l),u=r.GlobalFunction.createCommonIconWidget(37,c);this.nodeItem.addChild(u),u.active=!0}},e.prototype.onItemClick=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Halloween);if(t){if(!(t.getCurFirecrackerIndex()>0)){if(!t.isCostEnough()){var e=t.getCostItemData(),i=new r.BroadcastContent(77);return i.setMainParam([new r.BroadcastParam(e.getName())]),r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,i),void t.setCurFirecrackerIndex(0)}var n={};n.id=this._iconIndex,n.parmeterMap={20:2},t.operateActivity(n),t.setCurFirecrackerIndex(this._iconIndex)}}else t.setCurFirecrackerIndex(0)},a([l(cc.Node)],e.prototype,"nodeBaozhu",void 0),a([l(cc.Node)],e.prototype,"nodeItem",void 0),a([l(cc.Node)],e.prototype,"nodeBtn",void 0),e=a([s,c("module/Activity/HalloweenItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],HalloweenPanel:[function(t,e,i){"use strict";cc._RF.push(e,"0cf12KP4gdETqugTVvDbdNu","HalloweenPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("OptimizeVerticalListView"),d=t("OptimizeHorizontalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTime=null,e.labMyCount=null,e.labCost=null,e.btnTask=null,e.imgCostIcon1=null,e.imgCostIcon2=null,e.scroll=null,e.scrollRewards=null,e.labCostTxt=null,e.labRewardTxt=null,e.animation=null,e._isInit=!1,e._listGrid=null,e._rewardsList=null,e._activityController=null,e._isOpenTask=!1,e._rewardsInfo=null,e}return n(e,t),e.prototype.init=function(){},e.prototype.onEnable=function(){t.prototype.onEnable.call(this);var e=this.animation.getComponent("AnimationComponent");e||(e=this.animation.addComponent("AnimationComponent")),e.setFrameEventCallBack(this._showReward.bind(this)),this._activityController=this._controller,this._addEventListener(),this._activityController&&(this._listGrid=this.scroll.getComponent(u),this._rewardsList=this.scrollRewards.getComponent(d),this.scroll.getComponent(cc.ScrollView).enabled=!1,this.labCostTxt.string=r.Language.Halloween_Txt1||this.labCostTxt.string,this.labRewardTxt.string=r.Language.Halloween_Txt2||this.labRewardTxt.string,this._refresUI(),this._isInit=!0,this._activityController.getIsJumpToCharge()&&(this._activityController.setIsJumpToCharge(!1),this.onBtnGetClick()),r.RedPointUtil.createRedPointOld(this.btnTask,cc.v2(-10,-10),this._activityController.isTaskRedTips.bind(this._activityController),this._activityController.redPointEvts()),this._activityController.onOpenPanel())},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this._activityController.setCurFirecrackerIndex(0)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.RES_HALLOWEEN_INFO]=this._refresUI,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.onReceiveOperation,t[e.HALLOWEEN_TASK_CLOSE]=this.onTaskWindowClose,r.EventUtil.registerEvents(t,this)},e.prototype._refresUI=function(){this.labTime.string=this.getDurationStr(),this.labMyCount.string=this._activityController.getMyCount()+"";var t=this._activityController.getCostItemData(),e="";t.getCount()>0?e+=t.getCount():e="-",this.labCost.string=e,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,t.getLittleIconResPath(),this.imgCostIcon1),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,t.getLittleIconResPath(),this.imgCostIcon2),this._activityController.getCurFirecrackerIndex()>0||(this._refreshList(),this._refreshRewardList())},e.prototype._refreshList=function(){for(var t=[],e=1;e<13;e++)t.push(e);this._isInit?this._listGrid.refreshListData(t):this._listGrid.setData(t)},e.prototype._refreshRewardList=function(){var t=this._activityController.getRewardsList();this._isInit?this._rewardsList.refreshListData(t):this._rewardsList.setData(t)},e.prototype._showFirecrakerAni=function(){this.animation&&this.animation.play()},e.prototype._showReward=function(){if(this._activityController.setCurFirecrackerIndex(0),this._refresUI(),this._rewardsInfo){var t=r.RewardManager.parseRewardResult(this._rewardsInfo,!0);r.GlobalFunction.showRewards(t)}},e.prototype.onBtnGetClick=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_HalloweenTask),this._isOpenTask=!0},e.prototype.onReceiveOperation=function(t){t.activityId===this._activityId&&(this._rewardsInfo=t.rewardResult,this._activityController.getCurFirecrackerIndex()>0?this._showFirecrakerAni():this._showReward())},e.prototype.onTaskWindowClose=function(){this._isOpenTask=!1},a([l(cc.Label)],e.prototype,"labTime",void 0),a([l(cc.Label)],e.prototype,"labMyCount",void 0),a([l(cc.Label)],e.prototype,"labCost",void 0),a([l(cc.Node)],e.prototype,"btnTask",void 0),a([l(cc.Node)],e.prototype,"imgCostIcon1",void 0),a([l(cc.Node)],e.prototype,"imgCostIcon2",void 0),a([l(cc.Node)],e.prototype,"scroll",void 0),a([l(cc.Node)],e.prototype,"scrollRewards",void 0),a([l(cc.Label)],e.prototype,"labCostTxt",void 0),a([l(cc.Label)],e.prototype,"labRewardTxt",void 0),a([l(cc.Animation)],e.prototype,"animation",void 0),e=a([s,c("module/Activity/HalloweenPanel")],e)}(t("ActivityBasePanel"));i.default=h,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeHorizontalListView:void 0,OptimizeVerticalListView:void 0}],HalloweenRewardItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"361c11f/AlENro+HuF+JicP","HalloweenRewardItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeItem=null,e.imgReceived=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.id,a=i.reward,o=r.RewardManager.getRewardDetail(a),s=this.nodeItem.getChildByName("nodeIcon");s||(s=r.GlobalFunction.createCommonIconWidget(37,o),this.nodeItem.addChild(s),s.active=!0,s.name="nodeIcon"),s.getComponent("CommonIconWidget").setData(o);var l=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Halloween);l&&(this.imgReceived.active=l.isRewardReceived(n))},a([l(cc.Node)],e.prototype,"nodeItem",void 0),a([l(cc.Node)],e.prototype,"imgReceived",void 0),e=a([s,c("module/Activity/HalloweenRewardItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],HalloweenTaskItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"09b57NAKFpApKmbkkjOgTrw","HalloweenTaskItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Activity_07_HavingTurntable/HavingTurntableTaskItem"),o=window.td,s=(t("ListItem"),cc._decorator),l=s.ccclass,c=s.menu,u=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.updateItem=function(t,e){this.labDesc.string=cc.js.formatStr("%s",o.Language.addUpRecharge,e.charge/10),this._charge=e.charge;var i=o.RewardManager.getRewardDetail(e.rewards[0]).getCount();this.labNum.string="x"+i,this.numBg.active=i>0,this.labNum.node.active=i>0,this.labProTitle.string=o.Language.progress+":";var n=o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.Halloween).getCharge();this.labProgress.string=n/10+"/"+e.charge/10,this.btnGoto.active=2===e.status,this.btnGet.active=3===e.status,this.imgGot.active=4===e.status},e.prototype.onJump=function(){var t=o.PanelManager.getInstance().getCurShowWindow();if(t){var e=t.getComponent("PanelBase");e&&e.closeCallFunc()}o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.Halloween).setIsJumpToCharge(!0),o.GlobalFunction.gotoRecharge()},e.prototype.onReward=function(){var t=o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.Halloween);if(t){var e={};e.id=this._charge,e.parmeterMap={20:1},t.operateActivity(e)}},e=a([l,c("module/Activity/HalloweenTaskItemUI")],e)}(r.default));i.default=u,cc._RF.pop()},{"../Activity_07_HavingTurntable/HavingTurntableTaskItem":"HavingTurntableTaskItem",ListItem:void 0}],HalloweenTaskWindow:[function(t,e,i){"use strict";cc._RF.push(e,"6d53ahZhnBPdZI+uDKXWtOm","HalloweenTaskWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../Activity_07_HavingTurntable/HavingTurntableTaskWindow"),o=window.td,s=cc._decorator,l=s.ccclass,c=s.property,u=t("OptimizeVerticalListView"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTitle=null,e}return n(e,t),e.prototype.init=function(){this._panelType=o.PanelType.Window,this._panelEnum=o.PanelEnum.Window_HalloweenTask},e.prototype.onEnable=function(){t.prototype.onEnable.call(this)},e.prototype._addEventListener=function(){var t={};t[o.EventNameEnum.RES_HALLOWEEN_INFO]=this._refreshList,o.EventUtil.registerEvents(t,this)},e.prototype._refreshList=function(){var t=this,e=o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.Halloween);if(e){var i=e.getActivityData(),n=o.GetTableClass(o.TableEnum.FirecrackerRechargeTable).getConfigById(i);this._value=e.getCharge(),this._rewards=e.getChargeRewards(),n.forEach(function(e){t.setStatus(e)}),n.sort(this.sortFunc),this.node.getComponent(u).refreshListData(n)}},e.prototype.closeCallFunc=function(){t.prototype.closeCallFunc.call(this),o.EventUtil.dispatchEvent(o.EventNameEnum.HALLOWEEN_TASK_CLOSE)},a([c(cc.Label)],e.prototype,"labTitle",void 0),e=a([l],e)}(r.default);i.default=d,cc._RF.pop()},{"../Activity_07_HavingTurntable/HavingTurntableTaskWindow":"HavingTurntableTaskWindow",OptimizeVerticalListView:void 0}],HammerRechargeListView:[function(t,e,i){"use strict";cc._RF.push(e,"9ee9308mnZEM58h9zDqAcUB","HammerRechargeListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{_activityController:null,_rechargeCall:null},setData:function(t){this._activityController=t.controller,this._rechargeCall=t.rechargeCall;var e=t.dataList;this._super(e)},setItemView:function(t,e){var i=t.getChildByName("labHammerNum"),n=t.getChildByName("labRechargeCount"),a=t.getChildByName("labUnit"),r=t.getChildByName("progress"),o=e.getHammerNum(),s=e.getRechargeNum()/10,l=s.toString();i.getComponent(cc.Label).string="x"+o,n.getComponent(cc.Label).string=l,a.x=n.x+16.5*l.length;var c=this._activityController.getTotalRecharge();return r.getComponent(cc.Label).string=cc.js.formatStr(td.Language.progressPattern,c/10,s),this._setBtn(t,e),t},_setBtn:function(t,e){var i=t.getChildByName("btnGoto"),n=t.getChildByName("btnReceive"),a=t.getChildByName("imgReceived"),r=n.getComponent(cc.Button);r.clickEvents=[];var o=i.getComponent(cc.Button);if(o.clickEvents=[],e.getRewardStatus())a.active=!0,i.active=!1,n.active=!1;else if(a.active=!1,this._activityController.getTotalRecharge()<e.getRechargeNum()){n.active=!1,i.active=!0;var s=td.GlobalFunction.createClickEventHandler(this.node,"HammerRechargeListView","goToRecharge",null);o.clickEvents.push(s)}else{i.active=!1,n.active=!0;s=td.GlobalFunction.createClickEventHandler(this.node,"HammerRechargeListView","receiveHammer",e);r.clickEvents.push(s)}},receiveHammer:function(t,e){var i={id:e.getRechargeNum(),parmeterMap:{5:1}};this._activityController.operateActivity(i)},goToRecharge:function(){this._rechargeCall&&"function"==typeof this._rechargeCall&&this._rechargeCall()}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],HammerRechargeModel:[function(t,e,i){"use strict";cc._RF.push(e,"46f65GtOsNPr7XzhTWYFnUm","HammerRechargeModel");var n=cc.Class({properties:{_dataId:null,_rechargeNum:null,_hammerNum:null,_isGot:null},initData:function(t){t&&(this._dataId=t.data,this._rechargeNum=t.charge,this._hammerNum=t.num,this._isGot=!1)},getDataId:function(){return this._dataId},getRechargeNum:function(){return this._rechargeNum},getHammerNum:function(){return this._hammerNum},setRewardStatus:function(t){this._isGot=t},getRewardStatus:function(){return this._isGot}});e.exports=n,cc._RF.pop()},{}],HammerRechargeWindow:[function(t,e,i){"use strict";cc._RF.push(e,"c8b573LvNdD/osGcN35AzVD","HammerRechargeWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{_listView:null,_activityController:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_HitGoldenEggRecharge},onLoad:function(){this._super(),this._activityController=null;var t=cc.find("updateLayer/scrollview",this._root);this._listView=t.getComponent("HammerRechargeListView")},_addLocalListeners:function(){var t={};t[td.EventNameEnum.Res_GET_ACTIVITY_INFO]=this.refreshView.bind(this),td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},onEnable:function(){this._super(),this._addLocalListeners()},onDisable:function(){this._super(),this._removeAllListeners()},setData:function(t){!t||t<0||(this._activityController=td.ActivityDataManager.getActivityControllerById(t),this.refreshView())},refreshView:function(){var t=this._activityController.getRechargeDataList();t.sort(function(t,e){var i=t.getRewardStatus(),n=e.getRewardStatus();return i&&n?t.getRechargeNum()-e.getRechargeNum():i?1:-1});var e={controller:this._activityController,dataList:t,rechargeCall:this.goToRecharge.bind(this)};this._listView.setData(e)},clickBgListener:function(){this.closeCallFunc()},goToRecharge:function(){this.closeCallFunc(),td.GlobalFunction.gotoRecharge()}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],HavingTurntableController:[function(t,e,i){"use strict";cc._RF.push(e,"457bcMKx6ZDA7gi3tC0mQ5S","HavingTurntableController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_lastPoint:null,_voucherNum:null,_rewardsIndex:null,_diamondTime:null,_voucherTime:null,_totalTime:null,_charge:null,_chargeRewards:null,_isJumpToCharge:null,_isOpen:null},initData:function(t){this._super(t),this._lastPoint=0,this._rewardsIndex=[],this._voucherNum=0,this._voucherTime=0,this._diamondTime=0,this._totalTime=0,this._charge=0,this._chargeRewards=[],this._isJumpToCharge=!1,this._isOpen=!1},getIsJumpToCharge:function(){return this._isJumpToCharge},setIsJumpToCharge:function(t){this._isJumpToCharge=t},getLastPoint:function(){return this._lastPoint},getRewardsIndex:function(){return this._rewardsIndex},getVoucherNum:function(){return this._voucherNum},getVoucherTime:function(){return this._voucherTime},getDiamondTime:function(){return this._diamondTime},getTotalTime:function(){return this._totalTime},getCharge:function(){return this._charge},getChargeRewards:function(){return this._chargeRewards},getRewardById:function(t){for(var e=0;e<this._rewardList.length;e++)if(this._rewardList[e].id===t)return this._rewardList[e];return null},activityParse:function(t){var e=t.record;this._lastPoint=e.lastPoint-1,this._rewardsIndex=e.getRewards,this._voucherNum=e.voucherNum,this._voucherTime=e.voucherTime,this._diamondTime=e.diamondTime,this._totalTime=e.hasTavernTime,this._charge=e.charge,this._chargeRewards=e.chargeRewards,td.EventUtil.dispatchEvent(td.EventNameEnum.RES_HAVINGTURNTABLE_INFO)},hasRedPoint:function(){return!0},redPointTip:function(){return this.isRedPointTip()},isRedPointTip:function(){return!!this.isTaskRedTips()||!this._isOpen},onOpenPanel:function(){this._isOpen=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_HAVINGTURNTABLE)},isTaskRedTips:function(){for(var t=td.GetTableClass(td.TableEnum.HeavenTurntableRechargeConfig).getConfigById(this._activityData),e=0;e<t.length;e++){var i=t[e];if(i.charge<=this.getCharge()&&-1===this.getChargeRewards().indexOf(i.charge))return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.RES_HAVINGTURNTABLE_INFO,td.EventNameEnum.OPEN_HAVINGTURNTABLE]}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],HavingTurntablePanel:[function(t,e,i){"use strict";cc._RF.push(e,"bb57761tr1NcKM1EOFLRiHy","HavingTurntablePanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{itemTemp:cc.Node,img_light:cc.Node,img_point:cc.Node,lab_diamond:cc.Label,lab_item:cc.Label,lab_diamond_cost:cc.Label,lab_item_cost:cc.Label,lab_time:cc.Label,btn_left:cc.Node,btn_right:cc.Node,btn_task:cc.Node,icon_diamond:cc.Node,icon_item_cost:cc.Node,lab_diamond_tips:cc.Node,lab_item_tips:cc.Node,_coordinates:null,_oldIndex:0,_rewards:null,_cfg:null,_activityData:null,_isOpenTask:!1,_isTrunning:!1},onLoad:function(){this._coordinates=[[0,-362],[134,-398],[232,-496],[268,-630],[232,-764],[134,-862],[0,-898],[-134,-862],[-232,-764],[-268,-630],[-232,-496],[-134,-398]]},onEnable:function(){this._super(),this._activityData=this._controller.getActivityData(),this._isTrunning=!1,this._addLocalListeners(),this.setActivityTime(),this.initItem(),this.upDataItem(),this.initIndex(),this.initUI(),this._controller.getIsJumpToCharge()&&(this._controller.setIsJumpToCharge(!1),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_HavingTurntableTask),this._isOpenTask=!0),td.RedPointUtil.createRedPointOld(this.btn_task,cc.v2(-10,-10),this._controller.isTaskRedTips.bind(this._controller),this._controller.redPointEvts()),this._controller.onOpenPanel()},onDisable:function(){if(td.EventUtil.unregisterAllEvents(this),gdk.Timer.clearAll(this),this.img_point.stopAllActions(),this._rewards){var t=td.RewardManager.parseRewardResult(this._rewards,!0);td.GlobalFunction.showRewards(t),this._rewards=null}this._super()},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.RES_HAVINGTURNTABLE_INFO]=this.initUI,i[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.onReceiveOperation,i[e.HavingTurntable_Task_Close]=this.onTaskCloss,t.registerEvents(i,this)},initItem:function(){var t=td.GetTableClass(td.TableEnum.HeavenTurntableConfig).getConfigById(this._activityData).slice(0);t.sort(this.sortFunc);for(var e=t.shift(),i=0;i<this._coordinates.length;i++){var n=this.node.getChildByName("item"+i);if(!n){(n=cc.instantiate(this.itemTemp)).active=!0,n.name="item"+i,n.x=this._coordinates[i][0],n.y=this._coordinates[i][1];var a=t[i].rewards[0],r=td.RewardManager.getRewardDetail(a),o=td.GlobalFunction.createCommonIconWidget(26,r);o.setScale(.8),o.name="icon",n.addChild(o,-1),this.node.addChild(n)}}var s=this.node.getChildByName("giftIcon");if(!s){var l=td.RewardManager.getRewardDetail(e.rewards[0]);(s=td.GlobalFunction.createCommonIconWidget(26,l)).x=0,s.y=-654,s.name="giftIcon",this.node.addChild(s);var c=new cc.Node;s.addChild(c),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_yilingqu_03",c),c.zIndex=101,c.name="img_get",c.x=-18,c.y=32}},sortFunc:function(t,e){return t.pointId-e.pointId},upDataItem:function(){for(var t=this._controller.getRewardsIndex(),e=0;e<this._coordinates.length;e++){var i=this.node.getChildByName("item"+e),n=i.getChildByName("img_get"),a=i.getChildByName("icon"),r=e+1,o=-1!==t.indexOf(r);n.active=o,a.getComponent("CommonIconWidget").setMaskShow(o)}var s=this.node.getChildByName("giftIcon"),l=s.getChildByName("img_get");t.length===this._coordinates.length?(s.getComponent("CommonIconWidget").setMaskShow(!0),l.active=!0):(s.getComponent("CommonIconWidget").setMaskShow(!1),l.active=!1)},initIndex:function(){this._oldIndex=this._controller.getLastPoint();var t=-30*this._oldIndex;this.img_point.angle=t,this.img_light.angle=t},initUI:function(){var t=this._controller.getVoucherTime()+1,e=this._controller.getDiamondTime()+1;this._cfg||(this._cfg=td.GetTableClass(td.TableEnum.HeavenConfig).getConfigById(this._activityData)[0]);var i=e>this._cfg.diamondCost[this._cfg.diamondCost.length-1][0],n=t>this._cfg.voucherCost[this._cfg.voucherCost.length-1][0];td.GlobalFunction.setButtonGray(this.btn_left,i),td.GlobalFunction.setButtonGray(this.btn_right,n),this.icon_diamond.active=!i,this.lab_diamond_cost.node.active=!i,this.lab_diamond_tips.active=i,this.icon_item_cost.active=!n,this.lab_item_tips.active=n,this.lab_item_cost.node.active=!n,this.lab_diamond_cost.string=td.GlobalFunction.getUpCost(this._cfg.diamondCost,e)[0][2],this.lab_item_cost.string=td.GlobalFunction.getUpCost(this._cfg.voucherCost,t),this.lab_diamond.string=td.Account.getUserData().getDiamond(),this.lab_item.string=this._controller.getVoucherNum()},setActivityTime:function(){var t=this.getDurationStr();this.lab_time.string=t},_onActivityClose:function(t){this._activityId===t&&this.onDestroy()},onBtnCharge:function(){td.GlobalFunction.gotoRecharge()},onBtnGet:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_HavingTurntableTask),this._isOpenTask=!0},onLeft:function(){if(!this._isTrunning){var t=td.Account.getUserData().getDiamond(),e=this._controller.getDiamondTime()+1;if(t<td.GlobalFunction.getUpCost(this._cfg.diamondCost,e)[0][2]){var i={};return i.strArray=[td.Language.diamondlack],i.okCallFunc=this.onBtnCharge.bind(this),i.strBtnYes=td.Language.goto,i.strBtnNo=td.Language.cancel,void td.GlobalFunction.showConfirmWindow(i)}var n={parmeterMap:{2:3}};this._controller.operateActivity(n)}},onTaskCloss:function(){this._isOpenTask=!1},onRight:function(){if(!this._isTrunning){var t=this._controller.getVoucherNum(),e=this._controller.getVoucherTime()+1;if(t<td.GlobalFunction.getUpCost(this._cfg.voucherCost,e))this.onBtnGet();else{var i={parmeterMap:{2:2}};this._controller.operateActivity(i)}}},onReceiveOperation:function(t){if(t.activityId===this._activityId&&!this._isOpenTask)if(this._rewards=t.rewardResult,this.initUI(),this._controller.getRewardsIndex().length<this._coordinates.length){var e=this._controller.getLastPoint();this.showAni(e)}else this.showReward()},showAni:function(t){this._isTrunning=!0,this.img_point.stopAllActions(),this.img_light.active=!1;var e=30*(12-this._oldIndex)+720+30*t;this._oldIndex=t;var i="2.4.2"===cc.ENGINE_VERSION,n=cc.sequence(cc.rotateBy(1.5,i?-e:e).easing(cc.easeCubicActionOut(3)),cc.callFunc(this.showLigth,this),cc.delayTime(1),cc.callFunc(this.showReward,this));this.img_point.runAction(n),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.TURN_SOUND)},showLigth:function(){var t=-30*this._oldIndex;this.img_light.angle=t;for(var e=1;e<=5;e++)gdk.Timer.once(200*e,this,this.switchLigth,[],!1)},switchLigth:function(){this.img_light.active=!this.img_light.active},showReward:function(){var t=td.RewardManager.parseRewardResult(this._rewards,!0);td.GlobalFunction.showRewards(t),this.upDataItem(),this._isTrunning=!1,this._rewards=null}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],HavingTurntableTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"5405dU7mo1NZY7VUzDsePaX","HavingTurntableTaskItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labDesc=null,e.labProTitle=null,e.labProgress=null,e.labNum=null,e.btnGoto=null,e.btnGet=null,e.imgGot=null,e.numBg=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this.labDesc.string=cc.js.formatStr("%s",r.Language.addUpRecharge,i.charge/10),this._charge=i.charge;var n=i.num;this.labNum.string="x"+n,this.numBg.active=n>0,this.labNum.node.active=n>0,this.labProTitle.string=r.Language.progress+":";var a=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_7).getCharge();this.labProgress.string=a/10+"/"+i.charge/10,this.btnGoto.active=2===i.status,this.btnGet.active=3===i.status,this.imgGot.active=4===i.status},e.prototype.onJump=function(){var t=r.PanelManager.getInstance().getCurShowWindow();if(t){var e=t.getComponent("PanelBase");e&&e.closeCallFunc()}r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_7).setIsJumpToCharge(!0),r.GlobalFunction.inActivityGotoRecharge([r.ActivityEnum.Activity.ActivityConfig,r.ActivityEnum.ActivityType.ACTIVITY_TYPE_7])},e.prototype.onReward=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_7);if(t){var e={};e.id=this._charge,e.parmeterMap={2:1},t.operateActivity(e)}},a([c(cc.Label)],e.prototype,"labDesc",void 0),a([c(cc.Label)],e.prototype,"labProTitle",void 0),a([c(cc.Label)],e.prototype,"labProgress",void 0),a([c(cc.Label)],e.prototype,"labNum",void 0),a([c(cc.Node)],e.prototype,"btnGoto",void 0),a([c(cc.Node)],e.prototype,"btnGet",void 0),a([c(cc.Node)],e.prototype,"imgGot",void 0),a([c(cc.Node)],e.prototype,"numBg",void 0),e=a([l],e)}(o);i.default=u,cc._RF.pop()},{ListItem:void 0}],HavingTurntableTaskWindow:[function(t,e,i){"use strict";cc._RF.push(e,"81bbaoX0TJMU46oatiGzZT/","HavingTurntableTaskWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=(o.property,t("PanelBase")),c=t("OptimizeVerticalListView"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._num=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_HavingTurntableTask},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.showReward,t[e.RES_HAVINGTURNTABLE_INFO]=this._refreshList,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(){t.prototype.setData.call(this),this._refreshList()},e.prototype._refreshList=function(){var t=this,e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_7),i=e.getActivityData(),n=r.GetTableClass(r.TableEnum.HeavenTurntableRechargeConfig).getConfigById(i);this._value=e.getCharge(),this._rewards=e.getChargeRewards(),n.forEach(function(e){t.setStatus(e)}),n.sort(this.sortFunc),this.node.getComponent(c).refreshListData(n)},e.prototype.setStatus=function(t){t.charge>this._value?t.status=2:-1===this._rewards.indexOf(t.charge)?t.status=3:t.status=4},e.prototype.sortFunc=function(t,e){if(t.status!=e.status){if(3===t.status)return-1;if(3===e.status)return 1;if(4===t.status)return 1;if(4===e.status)return-1}return t.charge-e.charge},e.prototype.showReward=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_7),e=t.getVoucherNum()-this._num;if(this._num=t.getVoucherNum(),e>0){var i={type:1};i.id=r.ItemEnum.HavingTurntableItem,i.count=e,r.GlobalFunction.showRewards([i])}this._refreshList()},e.prototype.closeCallFunc=function(){t.prototype.closeCallFunc.call(this),r.EventUtil.dispatchEvent(r.EventNameEnum.HavingTurntable_Task_Close)},e=a([s],e)}(l);i.default=u,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],HeavenConfig:[function(t,e,i){"use strict";cc._RF.push(e,"97d64+JI+FBEYC2adDrgLGK","HeavenConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityTreasuryConfig",e._tblName="activity_treasury_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeavenTurntableConfig:[function(t,e,i){"use strict";cc._RF.push(e,"d56d7d7xDNKvbKZ5jaTsLt7","HeavenTurntableConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityTreasuryPointConfig",e._tblName="activity_treasury_point_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeavenTurntableController:[function(t,e,i){"use strict";cc._RF.push(e,"b3cd7ynlxFHu6Qmq/YneaFb","HeavenTurntableController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_lastPoint:null,_voucherNum:null,_rewardsIndex:null,_diamondTime:null,_voucherTime:null,_totalTime:null,_charge:null,_chargeRewards:null,_isJumpToCharge:null,_isOpen:null},initData:function(t){this._super(t),this._lastPoint=0,this._rewardsIndex=[],this._voucherNum=0,this._voucherTime=0,this._diamondTime=0,this._totalTime=0,this._charge=0,this._chargeRewards=[],this._isJumpToCharge=!1,this._isOpen=!1},getIsJumpToCharge:function(){return this._isJumpToCharge},setIsJumpToCharge:function(t){this._isJumpToCharge=t},getLastPoint:function(){return this._lastPoint},getRewardsIndex:function(){return this._rewardsIndex},getVoucherNum:function(){return this._voucherNum},getVoucherTime:function(){return this._voucherTime},getDiamondTime:function(){return this._diamondTime},getTotalTime:function(){return this._totalTime},getCharge:function(){return this._charge},getChargeRewards:function(){return this._chargeRewards},getRewardById:function(t){for(var e=0;e<this._rewardList.length;e++)if(this._rewardList[e].id===t)return this._rewardList[e];return null},activityParse:function(t){var e=t.record;this._lastPoint=e.lastPoint,this._lastPoint>0&&(this._lastPoint=e.lastPoint-1),this._rewardsIndex=e.getRewards;var i=e.voucherNum-this._voucherNum;if(this._voucherNum=e.voucherNum,this._voucherTime=e.voucherTime,this._diamondTime=e.diamondTime,this._totalTime=e.hasTavernTime,this._charge=e.charge,this._chargeRewards=e.chargeRewards,i>0){var n=new td.Item;n.init(td.GetTableClass(td.TableEnum.Item).getItemById(td.ItemEnum.HeavenTurntableItem)),n.setCount(i),td.GlobalFunction.showRewards(n)}td.EventUtil.dispatchEvent(td.EventNameEnum.RES_HEAVENTURNTABLE_INFO)},hasRedPoint:function(){return!0},redPointTip:function(){return this.isRedPointTip()},onOpenPanel:function(){this._isOpen=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_HEAVENTURNTABLE)},isRedPointTip:function(){return!!this.isTaskRedTips()||!this._isOpen},isTaskRedTips:function(){for(var t=td.GetTableClass(td.TableEnum.HeavenTurntableRechargeConfig).getConfigById(this._activityData),e=0;e<t.length;e++){var i=t[e];if(i.charge<=this.getCharge()&&-1===this.getChargeRewards().indexOf(i.charge))return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.RES_HEAVENTURNTABLE_INFO,td.EventNameEnum.OPEN_HEAVENTURNTABLE]}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],HeavenTurntablePanel:[function(t,e,i){"use strict";cc._RF.push(e,"ba719MQQ1RKcoqNb+1tnBNG","HeavenTurntablePanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{itemTemp:cc.Node,img_light:cc.Node,lab_diamond:cc.Label,lab_item:cc.Label,lab_diamond_cost:cc.Label,lab_item_cost:cc.Label,lab_time:cc.Label,btn_left:cc.Node,btn_right:cc.Node,btn_task:cc.Node,icon_diamond:cc.Node,icon_item_cost:cc.Node,lab_diamond_tips:cc.Node,lab_item_tips:cc.Node,_coordinates:null,_oldIndex:0,_rewards:null,_cfg:null,_activityData:null,_isOpenTask:!1,_isTrunning:!1},onLoad:function(){this._coordinates=[cc.v2(-213,-495),cc.v2(-71,-495),cc.v2(71,-495),cc.v2(213,-495),cc.v2(213,-630),cc.v2(213,-765),cc.v2(213,-900),cc.v2(71,-900),cc.v2(-71,-900),cc.v2(-213,-900),cc.v2(-213,-765),cc.v2(-213,-630)]},onEnable:function(){this._super(),this._activityData=this._controller.getActivityData(),this._isTrunning=!1,this._addLocalListeners(),this.setActivityTime(),this.initItem(),this.upDataItem(),this.initIndex(),this.initUI(),this._controller.getIsJumpToCharge()&&(this._controller.setIsJumpToCharge(!1),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_HeavenTurntableTask),this._isOpenTask=!0),td.RedPointUtil.createRedPointOld(this.btn_task,cc.v2(-10,-15),this._controller.isTaskRedTips.bind(this._controller),this._controller.redPointEvts()),this._controller.onOpenPanel()},onDisable:function(){if(td.EventUtil.unregisterAllEvents(this),this.img_light.stopAllActions(),this._rewards){var t=td.RewardManager.parseRewardResult(this._rewards,!0);td.GlobalFunction.showRewards(t),this._rewards=null}this._super()},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.RES_HEAVENTURNTABLE_INFO]=this.initUI,i[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.onReceiveOperation,i[e.HEAVENTURNTABLE_Task_Close]=this.onTaskCloss,t.registerEvents(i,this)},initItem:function(){var t=td.GetTableClass(td.TableEnum.HeavenTurntableConfig).getConfigById(this._activityData).slice(0);t.sort(this.sortFunc);for(var e=t.shift(),i=0;i<this._coordinates.length;i++){var n=this.node.getChildByName("item"+i);if(!n){(n=cc.instantiate(this.itemTemp)).active=!0,n.name="item"+i,n.x=this._coordinates[i].x,n.y=this._coordinates[i].y;var a=t[i].rewards[0],r=td.RewardManager.getRewardDetail(a),o=td.GlobalFunction.createCommonIconWidget(26,r);o.setScale(.8),o.name="icon",n.addChild(o,-1),this.node.addChild(n)}}var s=this.node.getChildByName("giftIcon");if(!s){var l=td.RewardManager.getRewardDetail(e.rewards[0]);(s=td.GlobalFunction.createCommonIconWidget(26,l)).x=0,s.y=-665,s.name="giftIcon",this.node.addChild(s);var c=new cc.Node;s.addChild(c),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_yilingqu_03",c),c.zIndex=101,c.name="img_get",c.x=-18,c.y=32}},sortFunc:function(t,e){return t.pointId-e.pointId},upDataItem:function(){for(var t=this._controller.getRewardsIndex(),e=0;e<this._coordinates.length;e++){var i=this.node.getChildByName("item"+e),n=i.getChildByName("img_get"),a=i.getChildByName("icon"),r=e+1,o=-1!==t.indexOf(r);n.active=o,a.getComponent("CommonIconWidget").setMaskShow(o)}var s=this.node.getChildByName("giftIcon"),l=s.getChildByName("img_get");t.length===this._coordinates.length?(s.getComponent("CommonIconWidget").setMaskShow(!0),l.active=!0):(s.getComponent("CommonIconWidget").setMaskShow(!1),l.active=!1)},initIndex:function(){this._oldIndex=this._controller.getLastPoint(),this.img_light.x=this._coordinates[this._oldIndex].x,this.img_light.y=this._coordinates[this._oldIndex].y},initUI:function(){var t=this._controller.getVoucherTime()+1,e=this._controller.getDiamondTime()+1;this._cfg||(this._cfg=td.GetTableClass(td.TableEnum.HeavenConfig).getConfigById(this._activityData)[0]);var i=e>this._cfg.diamondCost[this._cfg.diamondCost.length-1][0],n=t>this._cfg.voucherCost[this._cfg.voucherCost.length-1][0];td.GlobalFunction.setButtonGray(this.btn_left,i),td.GlobalFunction.setButtonGray(this.btn_right,n),this.icon_diamond.active=!i,this.lab_diamond_cost.node.active=!i,this.lab_diamond_tips.active=i,this.icon_item_cost.active=!n,this.lab_item_tips.active=n,this.lab_item_cost.node.active=!n,this.lab_diamond_cost.string=td.GlobalFunction.getUpCost(this._cfg.diamondCost,e)[0][2],this.lab_item_cost.string=td.GlobalFunction.getUpCost(this._cfg.voucherCost,t),this.lab_diamond.string=td.Account.getUserData().getDiamond(),this.lab_item.string=this._controller.getVoucherNum()},setActivityTime:function(){var t=this.getDurationStr();this.lab_time.string=t},_onActivityClose:function(t){this._activityId===t&&this.onDestroy()},onBtnCharge:function(){td.GlobalFunction.gotoRecharge()},onBtnGet:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_HeavenTurntableTask),this._isOpenTask=!0},onTaskCloss:function(){this._isOpenTask=!1},onLeft:function(){if(!this._isTrunning){var t=td.Account.getUserData().getDiamond(),e=this._controller.getDiamondTime()+1;if(t<td.GlobalFunction.getUpCost(this._cfg.diamondCost,e)[0][2]){var i={};return i.strArray=[td.Language.diamondlack],i.okCallFunc=this.onBtnCharge.bind(this),i.strBtnYes=td.Language.goto,i.strBtnNo=td.Language.cancel,void td.GlobalFunction.showConfirmWindow(i)}var n={parmeterMap:{2:3}};this._controller.operateActivity(n)}},onRight:function(){if(!this._isTrunning){var t=this._controller.getVoucherNum(),e=this._controller.getVoucherTime()+1;if(t<td.GlobalFunction.getUpCost(this._cfg.voucherCost,e))this.onBtnGet();else{var i={parmeterMap:{2:2}};this._controller.operateActivity(i)}}},onReceiveOperation:function(t){if(t.activityId===this._activityId&&!this._isOpenTask)if(this._rewards=t.rewardResult,this.initUI(),this._controller.getRewardsIndex().length<this._coordinates.length){var e=this._controller.getLastPoint();this.showAni(e)}else this.showReward()},showAni:function(t){this._isTrunning=!0,this.img_light.stopAllActions();var e=new cc.MoveArround(3,this._coordinates,t,2).easing(cc.easeSineOut()),i=cc.callFunc(this.showReward.bind(this)),n=cc.sequence(e,cc.delayTime(.2),i);this.img_light.runAction(n)},showReward:function(){var t=td.RewardManager.parseRewardResult(this._rewards,!0);td.GlobalFunction.showRewards(t),this.upDataItem(),this._isTrunning=!1,this._rewards=null}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],HeavenTurntableRechargeConfig:[function(t,e,i){"use strict";cc._RF.push(e,"01cfeTlQ/BFhosZa9cg2eTs","HeavenTurntableRechargeConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ActivityTreasuryRechargeConfig",e._tblName="activity_treasury_recharge_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeavenTurntableTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"f3d249ogYJKPr6qX4+hbQQ6","HeavenTurntableTaskItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labDesc=null,e.labProTitle=null,e.labProgress=null,e.labNum=null,e.btnGoto=null,e.btnGet=null,e.imgGot=null,e.numBg=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this.labDesc.string=cc.js.formatStr("%s",r.Language.addUpRecharge,i.charge/10),this._charge=i.charge;var n=i.num;this.labNum.string="x"+n,this.numBg.active=n>0,this.labNum.node.active=n>0,this.labProTitle.string=r.Language.progress+":";var a=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_8).getCharge();this.labProgress.string=a/10+"/"+i.charge/10,this.btnGoto.active=2===i.status,this.btnGet.active=3===i.status,this.imgGot.active=4===i.status},e.prototype.onJump=function(){var t=r.PanelManager.getInstance().getCurShowWindow();if(t){var e=t.getComponent("PanelBase");e&&e.closeCallFunc()}r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_8).setIsJumpToCharge(!0),r.GlobalFunction.inActivityGotoRecharge([r.ActivityEnum.Activity.ActivityConfig,r.ActivityEnum.ActivityType.ACTIVITY_TYPE_8])},e.prototype.onReward=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_8);if(t){var e={};e.id=this._charge,e.parmeterMap={2:1},t.operateActivity(e)}},a([c(cc.Label)],e.prototype,"labDesc",void 0),a([c(cc.Label)],e.prototype,"labProTitle",void 0),a([c(cc.Label)],e.prototype,"labProgress",void 0),a([c(cc.Label)],e.prototype,"labNum",void 0),a([c(cc.Node)],e.prototype,"btnGoto",void 0),a([c(cc.Node)],e.prototype,"btnGet",void 0),a([c(cc.Node)],e.prototype,"imgGot",void 0),a([c(cc.Node)],e.prototype,"numBg",void 0),e=a([l],e)}(o);i.default=u,cc._RF.pop()},{ListItem:void 0}],HeavenTurntableTaskWindow:[function(t,e,i){"use strict";cc._RF.push(e,"6d06ehMtg9JZ69M4GRsWyBF","HeavenTurntableTaskWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=(o.property,t("PanelBase")),c=t("OptimizeVerticalListView"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._num=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_HeavenTurntableTask},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.showReward,t[e.RES_HEAVENTURNTABLE_INFO]=this._refreshList,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(){t.prototype.setData.call(this),this._refreshList()},e.prototype._refreshList=function(){var t=this,e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_8),i=e.getActivityData(),n=r.GetTableClass(r.TableEnum.HeavenTurntableRechargeConfig).getConfigById(i);this._value=e.getCharge(),this._rewards=e.getChargeRewards(),n.forEach(function(e){t.setStatus(e)}),n.sort(this.sortFunc),this.node.getComponent(c).refreshListData(n)},e.prototype.setStatus=function(t){t.charge>this._value?t.status=2:-1===this._rewards.indexOf(t.charge)?t.status=3:t.status=4},e.prototype.sortFunc=function(t,e){if(t.status!=e.status){if(3===t.status)return-1;if(3===e.status)return 1;if(4===t.status)return 1;if(4===e.status)return-1}return t.charge-e.charge},e.prototype.showReward=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_8),e=t.getVoucherNum()-this._num;if(this._num=t.getVoucherNum(),e>0){var i={type:1};i.id=r.ItemEnum.HeavenTurntableItem,i.count=e,r.GlobalFunction.showRewards([i])}this._refreshList()},e.prototype.closeCallFunc=function(){t.prototype.closeCallFunc.call(this),r.EventUtil.dispatchEvent(r.EventNameEnum.HEAVENTURNTABLE_Task_Close)},e=a([s],e)}(l);i.default=u,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],HelpDesTable:[function(t,e,i){"use strict";cc._RF.push(e,"60389rgfPlKeKFNG83tOSkU","HelpDesTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HelpDesTable",properties:{_tblName:"help_data",_desc:null},init:function(){this._desc={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._desc[n.panelName[0]]||(this._desc[n.panelName[0]]={}),n.panelName[1]?this._desc[n.panelName[0]][n.panelName[1]]=n:this._desc[n.panelName[0]][0]=n}},getHelpDesc:function(t,e){return this._desc[t]&&this._desc[t][e]?this._desc[t][e].desc:""}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HelpWindow:[function(t,e,i){"use strict";cc._RF.push(e,"09dbes7Xb9Gn4O3iH860535","HelpWindow");var n=t("PanelBase");cc.Class({extends:n,properties:{contentSV:cc.Node,richText:cc.RichText,_panelName:[]},init:function(){this._panelType=td.PanelType.None,this._panelEnum=td.PanelEnum.Window_Help},onDisable:function(){this._super(),gdk.Timer.clearAll(this)},setData:function(t){this._panelName=t,gdk.Timer.frameOnce(2,this,this._setRichText)},_setRichText:function(){var t=this._panelName,e=0;2===t.length&&(e=t[1]);var i=td.GetTableClass(td.TableEnum.HelpDesTable).getHelpDesc(t[0],e);if(i&&""!==i){i=td.GlobalFunction.transCfgHoursToZoneHours(i);var n=td.GlobalFunction.getRichText(i);this.richText.string=n,this.contentSV.height=this.richText.node.height}}});cc._RF.pop()},{PanelBase:void 0}],HeroArtifactEvolveTable:[function(t,e,i){"use strict";cc._RF.push(e,"c1e3erj07dAj7i7td8S12r3","HeroArtifactEvolveTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="HeroArtifactAdvanceConfig",e._tblName="hero_artifact_advance_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.id;t[r]||(t[r]={}),t[r][a.advanceLevel]=a}},e.prototype.getDataByIdAndLevel=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].advanceLevel===e)return i[n]}}return null},e.prototype.getDatasByArtifactId=function(t){if(this._data[t]){var e=this._data[t],i=[];for(var n in e)i.push(e[n]);return i.sort(function(t,e){return t.advanceLevel-e.advanceLevel}),i}return[]},e.prototype.getMaxLvByArtifactId=function(t){if(this._data[t]){var e=this._data[t],i=[];for(var n in e)i.push(e[n]);return i.sort(function(t,e){return t.advanceLevel-e.advanceLevel}),i.length>0?i[i.length-1].advanceLevel:0}return 0},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroArtifactManager:[function(t,e,i){"use strict";cc._RF.push(e,"60188F1thRKOJFAj95B8Lp3","HeroArtifactManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,window.td),s=t("../../Hero/Manager/HeroManager"),l=t("HeroArtifactModel"),c=function(){function t(){this._equiptReplacePanelType=2,this._selectEquip=null,this._bagSelectType=1,this._evolve_critical_weight=[]}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addNetListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._equipMap={},this._heroArtifactList=[],this._curSelectArtifact=null,this._isGotoGacha=!1,this._curOperateArtifact=null},t.prototype.addNetListener=function(){var t=o.MsgModuleName.HERO,e=o.MsgCmd.Hero;o.ServerDelegate.registerMessage(t,e.HERO_ARTIFACT_INFO,this.resHeroArtifactInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.HERO_ARTIFACT_REINFORCE,this.resHeroArtifactReinForce.bind(this)),o.ServerDelegate.registerMessage(t,e.HERO_ARTIFACT_ADVANCE,this.resHeroArtifactAdvance.bind(this)),o.ServerDelegate.registerMessage(t,e.HERO_ARTIFACT_EQUIPPED,this.resHeroArtifactEquipped.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_HERO_ARTIFACT_INFO,this.resHeroArtifactInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_DELETE_HERO_ARTIFACT,this.pushDeleteHeroArtifactList.bind(this))},t.prototype.pushDeleteHeroArtifactList=function(t,e){if(t===o.NetCode.SUCCESS){for(var i=e.ids,n=this._heroArtifactList,a=[],r=0,s=n.length;r<s;r++){for(var l=n[r],c=!1,u=0;u<i.length;u++)if(l.getSId()===i[u]){c=!0;break}c||a.push(l)}this._heroArtifactList=a}},t.prototype.resHeroArtifactInfo=function(t,e){if(t===o.NetCode.SUCCESS){var i=e.artifacts;if(i){for(var n=0;n<i.length;n++){for(var a=i[n].heroArtifactId,r=!1,s=0;s<this._heroArtifactList.length;s++)if(this._heroArtifactList[s].getSId()===a){r=!0,this._heroArtifactList[s].updateData(i[n]);break}if(!r){var c=o.GetTableClass(o.TableEnum.HeroArtifactTable).getDataByArtifactId(i[n].configId),u=new l;u.init(c),u.updateData(i[n]),this._heroArtifactList.push(u)}}o.EventUtil.dispatchEvent(o.EventNameEnum.RES_HERO_ARTIFACT_INFO)}}},t.prototype.resHeroArtifactReinForce=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_HERO_ARTIFACT_REINFORCE)},t.prototype.resHeroArtifactAdvance=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_HERO_ARTIFACT_ADVANCE)},t.prototype.resHeroArtifactEquipped=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_HERO_ARTIFACT_EQUIPPED)},t.prototype.addEventListener=function(){var t=o.EventUtil,e=o.EventNameEnum,i={};i[e.REQ_HERO_ARTIFACT_INFO]=this.requestGetHeroArtifactInfo,i[e.REQ_HERO_ARTIFACT_REINFORCE]=this.requestHeroArtifactReinforce,i[e.REQ_HERO_ARTIFACT_ADVANCE]=this.requestHeroArtifactAdvance,i[e.REQ_HERO_ARTIFACT_EQUIPPED]=this.requestHeroArtifactEquipped,i[e.ON_GET_SERVER_START_DAYS]=this.requestGetHeroArtifactInfo,t.registerEvents(i,this)},t.prototype.requestGetHeroArtifactInfo=function(){if(o.UnlockManager.isTargetUnlock(o.ActorUnlockType.HERO_ARTIFACT,0)){var t={};t.module=o.MsgModuleName.HERO,t.cmd=o.MsgCmd.Hero.HERO_ARTIFACT_INFO,o.ServerDelegate.sendMessage(t)}},t.prototype.requestHeroArtifactReinforce=function(t){if(o.UnlockManager.isTargetUnlock(o.ActorUnlockType.HERO_ARTIFACT,0)){var e={};e.module=o.MsgModuleName.HERO,e.cmd=o.MsgCmd.Hero.HERO_ARTIFACT_REINFORCE,e.id=t.id,e.times=t.times,o.ServerDelegate.sendMessage(e)}},t.prototype.requestHeroArtifactAdvance=function(t){if(o.UnlockManager.isTargetUnlock(o.ActorUnlockType.HERO_ARTIFACT,0)){var e={};e.module=o.MsgModuleName.HERO,e.cmd=o.MsgCmd.Hero.HERO_ARTIFACT_ADVANCE,e.id=t.id,e.devourIds=t.devourIds,o.ServerDelegate.sendMessage(e)}},t.prototype.requestHeroArtifactEquipped=function(t){if(o.UnlockManager.isTargetUnlock(o.ActorUnlockType.HERO_ARTIFACT,0)){var e={};e.module=o.MsgModuleName.HERO,e.cmd=o.MsgCmd.Hero.HERO_ARTIFACT_EQUIPPED,e.heroId=t.heroId,e.artifactId=t.artifactId,o.ServerDelegate.sendMessage(e)}},t.prototype.getArtifactModelByArtifactId=function(t){for(var e=0;e<this._heroArtifactList.length;e++){var i=this._heroArtifactList[e];if(i.getSId()===t)return i}},t.prototype.getArtifactModelByHeroSId=function(t){for(var e=0;e<this._heroArtifactList.length;e++){var i=this._heroArtifactList[e];if(i.getHeroSid()===t)return i}},t.prototype.getHeroArtifactNumByConfigId=function(t){for(var e=0,i=0;i<this._heroArtifactList.length;i++){this._heroArtifactList[i].getId()===t&&e++}return e},t.prototype.getArtifactModelsByConfigId=function(t,e,i){void 0===e&&(e=!1),void 0===i&&(i=!0);for(var n=[],a=0;a<this._heroArtifactList.length;a++){var r=this._heroArtifactList[a];if(r.getId()===t){if(e&&this._heroArtifactList[a].isEquipped())continue;if(i&&(this._heroArtifactList[a].getLevel()>1||this._heroArtifactList[a].getAdvanceLevel()>0))continue;n.push(r)}}return n.sort(this.sortFunction),n},t.prototype.getArtifactModelsByHeroId=function(t,e){void 0===e&&(e=!1);for(var i=[],n=0;n<this._heroArtifactList.length;n++){var a=this._heroArtifactList[n];if(a.getHeroId()===t){if(e&&this._heroArtifactList[n].isEquipped())continue;i.push(a)}}return i.sort(this.sortFunction),i},t.prototype.getAllArtifactModels=function(t){void 0===t&&(t=!1);for(var e=[],i=0;i<this._heroArtifactList.length;i++)t&&this._heroArtifactList[i].isEquipped()||e.push(this._heroArtifactList[i]);return e.sort(this.sortFunction),e},t.prototype.setCurOperateArtifact=function(t){this._curOperateArtifact=t},t.prototype.getCurOperateArtifact=function(){return this._curOperateArtifact},t.prototype.setCurSelectArtifact=function(t){this._curSelectArtifact=t},t.prototype.getCurSelectArtifact=function(){return this._curSelectArtifact},t.prototype.getArtifactNumByArtifactId=function(t,e){return this.getArtifactModelsByConfigId(t,e).length},t.prototype.getHeroArtifactByQuality=function(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!0);for(var n=[],a=0;a<this._heroArtifactList.length;a++)e&&this._heroArtifactList[a].isEquipped()||i&&(this._heroArtifactList[a].getLevel()>1||this._heroArtifactList[a].getAdvanceLevel()>0)||this._heroArtifactList[a].getQuality()===t&&n.push(this._heroArtifactList[a]);return n.sort(this.sortFunction),n},t.prototype.getHeroArtifactForRebirth=function(){for(var t=[],e=0;e<this._heroArtifactList.length;e++)this._heroArtifactList[e].isEquipped()||(this._heroArtifactList[e].getLevel()>1||this._heroArtifactList[e].getAdvanceLevel()>0)&&t.push(this._heroArtifactList[e]);return t},t.prototype.getArtifactCfgsByQuality=function(t){var e=o.GetTableClass(o.TableEnum.HeroArtifactTable);return null==e?[]:e.getCfgsByQuality(t)},t.prototype.sortFunction=function(t,e){if(t.isEquipped()&&e.isEquipped()){var i=t.getHeroSid(),n=e.getHeroSid(),a=s.default.getInstance().getHeroBySId(i),r=s.default.getInstance().getHeroBySId(n),o=a.getOrderId(),l=r.getOrderId();return"string"==typeof o&&(o=100+parseInt(o)),"string"==typeof l&&(l=100+parseInt(l)),o-l}return t.isEquipped()&&!e.isEquipped()?-1:!t.isEquipped()&&e.isEquipped()?1:t.getQuality()!==e.getQuality()?e.getQuality()-t.getQuality():t.getAdvanceLevel()!==e.getAdvanceLevel()?e.getAdvanceLevel()-t.getAdvanceLevel():t.getLevel()!==e.getLevel()?e.getLevel()-t.getLevel():t.getId()-e.getId()},t.prototype.canLevelUp=function(t,e){if(void 0===e&&(e=1),!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.HERO_ARTIFACT,0,!1))return!1;for(var i=this.getArtifactModelByArtifactId(t),n=i.getHeroId(),a=o.GetTableClass(o.TableEnum.HeroTable).getFirstHeroByRoleType(n).features,r=i.getQuality(),s=o.GetTableClass(o.TableEnum.HeroArtifactStrengthenTable).getMaxLevelByFeatureAndQuality(a,r),l=i.getLevel(),c=0,u=0,d=1;d<=e;d++){var h=l+d-1;if(l+d>s)return!1;var p=o.GetTableClass(o.TableEnum.HeroArtifactStrengthenTable).getDataByFeatureAndQualityAndLevel(a,r,h);if(!p)return!1;var _=p.cost,g=o.ItemManager.getItemNumById(_[0][1]);c+=_[0][2];var f=o.ItemManager.getItemNumById(_[1][1]);if(u+=_[1][2],g<c)return!1;if(f<u)return!1}return!0},t.prototype.canEvolve=function(t,e){if(void 0===e&&(e=1),!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.HERO_ARTIFACT_ADVANCE,0,!1))return!1;for(var i=this.getArtifactModelByArtifactId(t),n=i.getLevel(),a=i.getAdvanceLevel(),r=o.GetTableClass(o.TableEnum.HeroArtifactEvolveTable).getMaxLvByArtifactId(i.getId()),s=0,l=0,c=0,u=1;u<=e;u++){var d=a+u;if(a+u>r)return!1;var h=o.GetTableClass(o.TableEnum.HeroArtifactEvolveTable).getDataByIdAndLevel(i.getId(),d);if(!h)return!1;if(n<h.levelLimit)return!1;var p=h.cost,_=o.ItemManager.getItemNumById(p[0][1]);s+=p[0][2];var g=o.ItemManager.getItemNumById(p[1][1]);l+=p[1][2];var f=h.devour;if(f.length>0)if(c+=f[1],this.getArtifactNumByArtifactId(f[0],!0)<c)return!1;if(_<s)return!1;if(g<l)return!1}return!0},t.prototype.canReplace=function(t,e){if(!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.HERO_ARTIFACT,0,!1))return!1;var i,n,a,r;if(e){var s=this.getArtifactModelByArtifactId(t);i=s.getHeroId(),n=s.getQuality(),a=s.getLevel(),r=s.getAdvanceLevel()}else i=t,n=0,a=1,r=0;for(var l=0;l<this._heroArtifactList.length;l++)if(this._heroArtifactList[l].getHeroId()===i&&!this._heroArtifactList[l].isEquipped()){if(this._heroArtifactList[l].getQuality()>n)return!0;if(this._heroArtifactList[l].getQuality()===n&&(this._heroArtifactList[l].getAdvanceLevel()>r||this._heroArtifactList[l].getLevel()>a&&this._heroArtifactList[l].getAdvanceLevel()===r))return!0}return!1},t.prototype.isRedPoint=function(){var t=o.BattleArrayManager.getBattleArrayData();for(var e in t){var i=t[e].getMercenarySId(),n=s.default.getInstance().getHeroBySId(i),a=this.getArtifactModelByHeroSId(i),r=0;if(a){if(r=a.getSId(),this.canLevelUp(r))return!0;if(this.canEvolve(r))return!0}else r=n.getId();if(this.canReplace(r,a))return!0}return!1},t.prototype.isRedPointBySId=function(t){return!!this.canLevelUp(t)||(!!this.canEvolve(t)||!!this.canReplace(t,!0))},t.prototype.redPointEvents=function(){return[o.EventNameEnum.ITEM_CHANGE,o.EventNameEnum.RES_HERO_ARTIFACT_INFO,o.EventNameEnum.CHANGE_SELECT_HERO]},t.prototype.getIsGotoGacha=function(){var t=this._isGotoGacha;return this._isGotoGacha&&(this._isGotoGacha=!1),t},t.prototype.gotoGacha=function(){this._isGotoGacha=!0},t=e=n([r],t)}();i.default=c,cc._RF.pop()},{"../../Hero/Manager/HeroManager":"HeroManager",HeroArtifactModel:"HeroArtifactModel"}],HeroArtifactModel:[function(t,e,i){"use strict";cc._RF.push(e,"924d4s0HnVJmow+2+U6kzKy","HeroArtifactModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../Hero/Manager/HeroManager"),r=window.td,o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._heroId=0,e._name="",e._des="",e._goodsType=r.GoodsType.Type_Artifact,e._isEquipped=!1,e._strengthenLevel=0,e._advanceLevel=0,e._soulLinkArtifacts=[],e._isSoulLink=!1,e}return n(e,t),e.prototype.init=function(e){t.prototype.init.call(this,"HeroArtifactModel",r.UserPropertyEnum.Artifact,e.id,e.name,e.iconRes,null,e.animationType),this._heroId=e.roleType,this._quality=e.quality||0,this._decomposeRewards=e.decomposeRewards||[],this._obtainWay=e.obtainWay,this._des=e.desc||"",this._strengthenLevel=r.GetConfig("HERO_ARTIFACT_INIT_LEVEL")},e.prototype.updateData=function(t){(t.heroId||0===t.heroId)&&(this._heroSId=t.heroId),this._strengthenLevel=t.level,this._advanceLevel=t.advanceLevel,t.heroArtifactId&&this.setSId(t.heroArtifactId),this._setSoulLinkArtifact()},e.prototype._setSoulLinkArtifact=function(){if(this._heroSId){var t=a.default.getInstance().getHeroBySId(this._heroSId);if(t&&t.isHaveSoulLinkHeros()){var i=t.getSoulLinkHeroModels();if(i&&i.length>0)for(var n=0;n<i.length;n++){var o=i[n],s=this._getSoulLinkArtifact(o.getSId());s||(s=new e,this._soulLinkArtifacts.push(s));var l=r.GetTableClass(r.TableEnum.HeroArtifactTable).getArtifactByHeroIdAndQuality(o.getRoleType(),this.getQuality());s.init(l);var c={heroId:o.getSId(),level:this.getLevel(),advanceLevel:this.getAdvanceLevel()};s.updateData(c),s.setSoulLink(!0)}}}else this._soulLinkArtifacts=[]},e.prototype._getSoulLinkArtifact=function(t){if(!this._soulLinkArtifacts||this._soulLinkArtifacts.length<=0)return null;for(var e=0;e<this._soulLinkArtifacts.length;e++){var i=this._soulLinkArtifacts[e];if(i.getHeroSid()==t)return i}return null},e.prototype.getRealArtifactModel=function(){if(this._heroSId){var t=a.default.getInstance().getHeroBySId(this._heroSId);if(t.isBattleHero())return this;var e=t.getSoulLinkHeroModels();if(e&&e.length>0)for(var i=0;i<e.length;i++){var n=e[i];if(n.isBattleHero()){var r=this._getSoulLinkArtifact(n.getSId());return r||this}}}return this},e.prototype.getDes=function(){return this._des},e.prototype.getName=function(){return this._name},e.prototype.getQuality=function(){return this._quality},e.prototype.getHeroId=function(){return this._heroId},e.prototype.getDecomposeRewards=function(){return this._decomposeRewards.slice(0)},e.prototype.getObtainWay=function(){return this._obtainWay},e.prototype.getLevel=function(){return this._strengthenLevel},e.prototype.getAdvanceLevel=function(){return this._advanceLevel},e.prototype.getGoodsType=function(){return this._goodsType},e.prototype.isSoulLink=function(){return this._isSoulLink},e.prototype.setSoulLink=function(t){this._isSoulLink=t},e.prototype.isEquipped=function(){return void 0!==this._heroSId&&null!==this._heroSId&&0!==this._heroSId},e.prototype.setEquipped=function(t){this._isEquipped=t},e.prototype.getTotalAttr=function(){return null},e.prototype.getAttributes=function(){var t={},e=r.GetTableClass(r.TableEnum.HeroTable).getHeroById(this._heroId).features,i=r.GetTableClass(r.TableEnum.HeroArtifactStrengthenTable).getDataByFeatureAndQualityAndLevel(e,this._quality,this._strengthenLevel),n=[];i&&(n=i.attributes);for(var a=0;a<n.length;a++){t[(u=n[a])[0]]||(t[u[0]]=0),t[u[0]]+=u[1]}var o=r.GetTableClass(r.TableEnum.HeroArtifactEvolveTable).getDataByIdAndLevel(this._id,this._advanceLevel),s=[];o&&(s=o.attributes);for(a=0;a<s.length;a++){var l=s[a];t[l[0]]||(t[l[0]]=0),t[l[0]]+=l[1]}for(var c in this._attrbutes=[],t){var u;(u=[])[0]=c,u[1]=t[c],this._attrbutes.push(u)}return this._attrbutes},e.prototype.getLevelAttr=function(){var t={},e=r.GetTableClass(r.TableEnum.HeroTable).getHeroById(this._heroId).features,i=r.GetTableClass(r.TableEnum.HeroArtifactStrengthenTable).getDataByFeatureAndQualityAndLevel(e,this._quality,this._strengthenLevel),n=[];i&&(n=i.attributes);for(var a=0;a<n.length;a++){var o=n[a];t[o[0]]||(t[o[0]]=0),t[o[0]]+=o[1]}var s=[];for(var l in t)s.push([l,t[l]]);return s},e.prototype.getArtifactSpecialEffectAttr=function(){var t=r.GetTableClass(r.TableEnum.HeroArtifactEvolveTable).getDataByIdAndLevel(this._id,this._advanceLevel);if(t){var e=[];return t.specialEffectIds.forEach(function(t){var i=r.GetTableClass(r.TableEnum.SpecialEffectTable).getDataById(t);if(i&&1==i.type){var n=r.GetTableClass(r.TableEnum.SpecialAttributeTable).getDataById(t);e.push(n)}}),e}return[]},e.prototype.getHeroSid=function(){return this._heroSId},e.prototype.setHeroSid=function(t){this._heroSId=t},e.prototype.resetLevelInfo=function(){this._advanceLevel=0,this._strengthenLevel=r.GetConfig("HERO_ARTIFACT_INIT_LEVEL")},e.prototype.setCount=function(t){this._count=t},e.prototype.getCount=function(){return this._count},e}(t("PropertyModel"));e.exports=o,cc._RF.pop()},{"../../Hero/Manager/HeroManager":"HeroManager",PropertyModel:"PropertyModel"}],HeroArtifactStrengthenTable:[function(t,e,i){"use strict";cc._RF.push(e,"3ec1dsrP3lGMolrhSuiSoed","HeroArtifactStrengthenTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="HeroArtifactReinforceConfig",e._tblName="hero_artifact_reinforce_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={},this._levels=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.features;t[r]||(t[r]={}),t[r][a.quality]=t[r][a.quality]||[],t[r][a.quality].push(a)}},e.prototype.getDataByFeatureAndQualityAndLevel=function(t,e,i){if(this._data[t]){var n=this._data[t];if(!n[e])return null;for(var a=n[e].slice(0),r=0;r<a.length;r++){var o=a[r];if(o.level===i)return o}}return null},e.prototype.getMaxLevelByFeatureAndQuality=function(t,e){if(this._data[t]){var i=this._data[t][e];return i?(i.sort(function(t,e){return t.level-e.level}),i.length>0?i[i.length-1].level:null):null}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroArtifactTable:[function(t,e,i){"use strict";cc._RF.push(e,"55a2boxlc5Ht43j0xqD2bEL","HeroArtifactTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="HeroArtifactConfig",e._tblName="hero_artifact_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataByArtifactId=function(t){return this._data[t]?this._data[t]:null},e.prototype.getDatas=function(){return this._data},e.prototype.getCfgsByQuality=function(t){var e=[];for(var i in this._data){var n=this._data[i];n.quality==t&&e.push(n)}return e},e.prototype.getArtifactByHeroId=function(t){for(var e in this._data){var i=this._data[e];if(i.heroId==t)return i}return null},e.prototype.getArtifactByHeroIdAndQuality=function(t,e){for(var i in this._data){var n=this._data[i];if(n.roleType==t&&n.quality==e)return n}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroBreakoutTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"ad52bhpCu5Dn6pFgrM6cOlE","HeroBreakoutTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="HeroBreakoutConfig",e._tblName="hero_breakout_config",e._data={},e}n(e,t);var i=e.prototype;return i.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.roleType;t[r]||(t[r]={}),t[r][a.breakoutLevel]=a}},i.getDataByIdAndLevel=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].breakoutLevel===e)return i[n]}}return null},i.getSpecialIdsByLv=function(t,e,i,n){var a=[];if(this._data[t]){var r=this._data[t];for(var o in r){var s=r[o];if(s.specialEffects.length>0&&s.breakoutLevel<=e)for(var l=s.specialEffects,c=l.length-1;c>=0;c--)if(l[c][0]===i&&l[c][1]<=n){a.push(l[c][2]);break}}}return a},i.getSpecialIdsNumByEvolveLevel=function(t,e,i){var n=0,a=0;if(this._data[t]){var r=[];for(var o in this._data[t])r.push(this._data[t][o]);for(var s=r.length-1;s>=0;s--){var l=r[s];if(l.specialEffects.length>0)for(var c=l.specialEffects,u=c.length-1;u>=0;u--){if(c[u][0]===e&&c[u][1]===i){n=l.breakoutLevel;break}!a&&c[u][0]===e&&c[u][1]<i&&0!=c[u][1]&&(a=l.breakoutLevel)}}}return n||(n=a),n},i.getDataById=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroCultivateAttributeTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"cb678fdki1Bl4FrR3Niqa89","HeroCultivateAttributeTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="HeroCultivateAttributeConfig",e._tblName="hero_cultivate_attribute_config",e._data={},e}n(e,t);var i=e.prototype;return i.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.roleType;t[r]||(t[r]=[]),t[r].push(a)}},i.getListByHeroId=function(t){return this._data[t]},i.getAttrByHeroIdAndLevel=function(t,e){var i=this._data[t];if(i)for(var n=0;n<i.length;n++)if(i[n].level===e)return i[n];return null},i.getAttrsByHeroIdAndLevel=function(t,e){var i=[],n=this._data[t];if(n)for(var a=0;a<n.length;a++)n[a].level<=e&&i.push(n[a]);return i},i.getDataByHeroIdAndLevel=function(t,e){var i,n=this._data[t];if(n){n.sort(this.sortFunc);for(var a=0;a<n.length;a++)n[a].level>e&&(i=n[a]);!i&&0!=e&&n.length>0&&(i=n[0])}return i},i.sortFunc=function(t,e){return e.level-t.level},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroCultivateTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"2f508JUWK1Np52DvZ9qMQ9v","HeroCultivateTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="HeroCultivateConfig",e._tblName="hero_cultivate_config",e._data={},e}n(e,t);var i=e.prototype;return i.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.level;t[r]||(t[r]={}),t[r]=a}},i.getDataByLevel=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroEnum:[function(t,e,i){"use strict";cc._RF.push(e,"54783ZjvrhLjpask19kgt2z","HeroEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.HERO_MAX_EVOLVE_LEVEL=i.HERO_MAX_EVOLVE_NOCHANGE_LEVEL=i.HeroAptitude=i.HeroUpType=void 0,function(t){t[t.LevelUp=1]="LevelUp",t[t.Breakout=2]="Breakout",t[t.Cultivate=3]="Cultivate",t[t.StarUp=4]="StarUp",t[t.Evolve=5]="Evolve"}(i.HeroUpType||(i.HeroUpType={})),function(t){t[t.Normal=1]="Normal",t[t.S=2]="S",t[t.S_PLUS=3]="S_PLUS",t[t.SS=4]="SS",t[t.SS_PLUS=5]="SS_PLUS"}(i.HeroAptitude||(i.HeroAptitude={})),i.HERO_MAX_EVOLVE_NOCHANGE_LEVEL=15,i.HERO_MAX_EVOLVE_LEVEL=16,cc._RF.pop()},{}],HeroEvolveExtraAttrConfig:[function(t,e,i){"use strict";cc._RF.push(e,"3c5e6xq9vlPNZGgeyR37nA/","HeroEvolveExtraAttrConfig");var n=t("BaseTable");cc.Class({extends:n,name:"HeroEvolveExtraAttrConfig",properties:{_tblName:"hero_evolve_extra_attr_config",_data:null},init:function(){this._data=[];for(var t=0,e=this._jsonData.length;t<e;++t){var i=this._jsonData[t],n=this._data[i.heroId];n||(n={},this._data[i.heroId]=n),n[i.evolveLevel]=i}},getHeroEvolveExtraAttrConfig:function(t,e){var i=this._data[t];return i?i[e]:null}});cc._RF.pop()},{BaseTable:"BaseTable"}],HeroEvolveTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"71134QWr4dJOLmu7b8NOnwK","HeroEvolveTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="HeroEvolveConfig",e._tblName="hero_evolve_config",e._data={},e}n(e,t);var i=e.prototype;return i.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.heroId;t[r]||(t[r]={}),t[r][a.evolveLevel]=a}},i.getDataByIdAndLevel=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].evolveLevel===e)return i[n]}}return null},i.getLastDataById=function(t){if(this._data[t]){var e=this._data[t];for(var i in e){if(e[i].evolveLevel===e.myLen())return e[i]}}return null},i.getDataById=function(t){return this._data[t]?this._data[t]:null},i.getMaxELLvById=function(t){var e=0;if(this._data[t]){var i=this._data[t];for(var n in i)if(i.hasOwnProperty(n)){var a=i[n];a.evolveLevel>=e&&(e=a.evolveLevel)}}return e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroFragmentModel:[function(t,e,i){"use strict";cc._RF.push(e,"d69datfwzNCjYl4MFQ+DUmn","HeroFragmentModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("Model"),r=t("../Manager/HeroManager"),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._needCount=0,e._aptidude=0,e._enough=!1,e._features=0,e._camp=0,e._heroConfigId=0,e}return n(e,t),e.prototype.init=function(t){this._itemData=t;var e=r.default.getInstance().getFragmentComposeInfo(this._itemData.getId());e?(this._needCount=e.fragmentCount,this._aptidude=e.aptitude,this._features=e.features,this._camp=e.camp,this._heroConfigId=e.roleId,this._enough=this._itemData.getCount()>=this._needCount):this._itemData.getGoodsSubType()===td.GoodsSubType.HERO_RAND_FRAMENT&&(this._needCount=this._itemData.getEffectValue()[0],this._enough=this._itemData.getCount()>=this._needCount)},e.prototype.getItemData=function(){return this._itemData},e.prototype.getNeedCount=function(){return this._needCount||1e4},e.prototype.getEnoughState=function(){return this._enough},e.prototype.getAptitude=function(){return this._aptidude},e.prototype.getFeatures=function(){return this._features},e.prototype.getHeroConfigId=function(){return this._heroConfigId},e.prototype.getComposeCount=function(){return Math.floor(this._itemData.getCount()/this._needCount)},e.prototype.setCamp=function(t){this._camp=t},e.prototype.getCurCamp=function(){return this._camp},e}(a);e.exports=o,cc._RF.pop()},{"../Manager/HeroManager":"HeroManager",Model:"Model"}],HeroLevelUpTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"62428xiNk5KY6SzKhEUyfOk","HeroLevelUpTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="HeroLevelConfig",e._tblName="hero_level_config",e._data=[],e}n(e,t);var i=e.prototype;return i.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}},i.getUpgradeLevelData=function(){return this._data},i.getDataByLevel=function(t){return t<=this._data.length?this._data[t-1]:null},i.maxLevel=function(){return this._data?this._data.length:0},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroManager:[function(t,e,i){"use strict";cc._RF.push(e,"41c8cN35gBDT5sdcvCLFdwD","HeroManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("HeroRuneModel"),r=function(){function e(){this._starUpQuality=0,this._friendOperateOrderId=0,this._guideHeroList=null,this._selectIndex=0,this._heroBreakoutIndex=0,this._curOptSoulLinkIndex=0,this._tmpStarLv=0,this.isInit=!0}return e.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},e.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},e.prototype.destroyData=function(){this._heroMap={},this._heroRuneMap={},this.isInit=!0},e.prototype.addListener=function(){var t=n.MsgModuleName.HERO,e=n.MsgCmd.Hero;n.ServerDelegate.registerMessage(t,e.GET_HERO,this.parseGetHeroInfo.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_ADD_EXP,this.resHeroLevelup.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_BREAKOUT,this.resHeroBrakout.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_CULTIVATE,this.resHeroCultivate.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_STAR_UP,this.resHeroStarUp.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_EVOLVE,this.resHeroEvolve.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_SYNTHESIZE,this.resHeroSynthesize.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_RAND_SYNTHESIZE,this.resHeroSynthesize.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_RUNE_INFO,this.resHeroRuneInfo.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_RUNE_EQUIPPED,this.resHeroRuneEquipped.bind(this)),n.ServerDelegate.registerMessage(t,e.PUSH_HERO_LIST,this.parseGetHeroInfo.bind(this)),n.ServerDelegate.registerMessage(t,e.PUSH_DELETE_HERO_LIST,this.pushDeleteHeroList.bind(this)),n.ServerDelegate.registerMessage(t,e.PUSH_HERO_RUNE_LIST,this.resHeroRuneInfo.bind(this)),n.ServerDelegate.registerMessage(t,e.PUSH_DELETE_HERO_RUNE_LIST,this.pushDeleteHeroRuneList.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_RUNE_DECOMPOSE,this.resHeroRuneDecompose.bind(this)),n.ServerDelegate.registerMessage(t,e.HERO_QUICK_STAR_UP,this._onGetOneKeyStarUp.bind(this))},e.prototype.addEventListener=function(){var t=n.EventUtil,e=n.EventNameEnum,i={};i[e.REQ_GET_TREASURE_INFO]=this.requestGetHeroInfo,i[e.REQ_HERO_LEVEL_UP]=this.reqHeroLevelup,i[e.REQ_HERO_BREAKOUT]=this.reqHeroBrakout,i[e.REQ_HERO_CULTIVATE]=this.reqHeroCultivate,i[e.REQ_HERO_STAR_UP]=this.reqHeroStarUp,i[e.REQ_HERO_EVOLVE]=this.reqHeroEvolve,i[e.REQ_HERO_SYNTHESIZE]=this.reqHeroSynthesize,i[e.REQ_HERO_RAND_SYNTHESIZE]=this.reqHeroSynthesize1,i[e.REQ_HERO_RUNE_INFO]=this.reqHeroRuneInfo,i[e.REQ_HERO_RUNE_EQUIPPED]=this.reqHeroRuneEquipped,i[e.REQ_HERO_RUNE_DECOMPOSE]=this.reqHeroRuneDecompose,i[e.GUIDE_PARSE_HEROES_CFGS]=this.parseGuideHeroesData,i[e.REQ_HERO_STAR_UP_ONE_KEY]=this._reqOneKeyStarUp,t.registerEvents(i,this)},e.prototype.parseGuideHeroesData=function(t){this._guideHeroList={};for(var e=0,i=t.length;e<i;e++){var n=t[e],a=this._getNewMercenary(n),r=a.getSId();this._guideHeroList[r]=a}},e.prototype.getGuideHeroList=function(){return this._guideHeroList},e.prototype.getGuideHeroDataBySid=function(t){return this._guideHeroList[t]},e.prototype.getSelectIndex=function(){return this._selectIndex},e.prototype.setSelectIndex=function(t){this._selectIndex=t},e.prototype.getCurOptSoulLinkIndex=function(){return this._curOptSoulLinkIndex},e.prototype.setCurOptSoulLinkIndex=function(t){this._curOptSoulLinkIndex=t},e.prototype.getBreakoutSelectIndex=function(){return this._heroBreakoutIndex},e.prototype.setBreakoutSelectIndex=function(t){this._heroBreakoutIndex=t},e.prototype.requestGetHeroInfo=function(){var t={};t.module=n.MsgModuleName.HERO,t.cmd=n.MsgCmd.Hero.GET_HERO,n.ServerDelegate.sendMessage(t)},e.prototype.parseGetHeroInfo=function(t,e){if(t===n.NetCode.SUCCESS){for(var i=e.voList,a=0;a<i.length;a++){var r=i[a],o=this._heroMap[r.heroId];if(o||(o=this._getNewMercenary(r)),o.getId()!=r.configId){var s=n.GetTableClass(n.TableEnum.HeroTable).getHeroById(r.configId);o.init(s)}o&&(this._heroMap[r.heroId]=o,o.setLevel(r.level),o.setLevelExp(r.exp),o.setBreakoutLevel(r.breakoutLevel),o.setCultivateLevel(r.cultivateLevel),o.setCultivateExp(r.cultivateExp),o.setStarLevel(r.starLevel),o.setEvolveLevel(r.evolveLevel),o.setHeroRune(r.heroRuneList),o.setArtifactSid(r.heroArtifactId),o.setHeroArtifactLevel(r.heroArtifactLevel),o.setHeroArtifactAdvanceLevel(r.heroArtifactAdvanceLevel),o.setCamp(r.camp),o.refreshSoulLinkHero(o.getSoulList()))}this.isInit?this.isInit=!1:n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_LIST,i),n.EventUtil.dispatchEvent(n.EventNameEnum.INIT_DATA_LOADED,n.LoadKey.Mercenary)}},e.prototype._getNewMercenary=function(e){var i=n.GetTableClass(n.TableEnum.HeroTable).getHeroById(e.configId);if(!i)return cc.log("HeroManger._getNewMercenary() parse configId is error!!%s",e.configId),null;var a=new(t("HeroModel"));return a.init(i),a.setDefaultCamp(i.camp),a.setDefaultQuality(i.quality),a.setSId(e.heroId),a},e.prototype.reqHeroLevelup=function(t){var e={};e.module=n.MsgModuleName.HERO,e.cmd=n.MsgCmd.Hero.HERO_ADD_EXP,e.heroId=t.heroId,e.goodsMap=t.goodsMap,n.ServerDelegate.sendMessage(e)},e.prototype.resHeroLevelup=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_LEVEL_UP)},e.prototype.reqHeroBrakout=function(t){var e={};e.module=n.MsgModuleName.HERO,e.cmd=n.MsgCmd.Hero.HERO_BREAKOUT,e.id=t.id,e.devourIds=t.devourIds,n.ServerDelegate.sendMessage(e)},e.prototype.resHeroBrakout=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_BREAKOUT)},e.prototype.reqHeroCultivate=function(t){var e={};e.module=n.MsgModuleName.HERO,e.cmd=n.MsgCmd.Hero.HERO_CULTIVATE,e.heroId=t,n.ServerDelegate.sendMessage(e)},e.prototype.resHeroCultivate=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_CULTIVATE)},e.prototype.reqHeroStarUp=function(t){var e={};e.module=n.MsgModuleName.HERO,e.cmd=n.MsgCmd.Hero.HERO_STAR_UP,e.id=t.heroId,e.devourIds=t.devourIds,n.ServerDelegate.sendMessage(e)},e.prototype.resHeroStarUp=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_STAR_UP)},e.prototype.reqHeroEvolve=function(t){var e={};e.module=n.MsgModuleName.HERO,e.cmd=n.MsgCmd.Hero.HERO_EVOLVE,e.heroId=t,n.ServerDelegate.sendMessage(e)},e.prototype.resHeroEvolve=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_EVOLVE)},e.prototype.reqHeroSynthesize=function(t){var e={};e.module=n.MsgModuleName.HERO,e.cmd=n.MsgCmd.Hero.HERO_SYNTHESIZE,e.configId=t.configId,e.count=t.count,n.ServerDelegate.sendMessage(e)},e.prototype.reqHeroSynthesize1=function(t){var e={};e.module=n.MsgModuleName.HERO,e.cmd=n.MsgCmd.Hero.HERO_RAND_SYNTHESIZE,e.configId=t.configId,e.count=t.count,n.ServerDelegate.sendMessage(e)},e.prototype.resHeroSynthesize=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.rewardResult,a=n.RewardManager.parseRewardResult(i);1===a.length?n.PanelJumpManager.jumpToPanel(n.PanelEnum.Panel_HeroReward,a[0]):(n.GlobalFunction.showRewards(a),n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_SYNTHESIZE)),n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_SYNTHESIZE_SUCC)}},e.prototype.reqHeroRuneInfo=function(){var t={};t.module=n.MsgModuleName.HERO,t.cmd=n.MsgCmd.Hero.HERO_RUNE_INFO,n.ServerDelegate.sendMessage(t)},e.prototype.resHeroRuneInfo=function(t,e){if(t===n.NetCode.SUCCESS){for(var i=e.heroRuneList,r=0,o=i.length;r<o;r++){var s=i[r],l=s.heroRuneId,c=this._heroRuneMap[l];if(!c){c=new a;var u=n.GetTableClass(n.TableEnum.HeroRuneTable).getHeroRuneById(s.configId);c.init(u),this._heroRuneMap[l]=c}c.setSId(s.heroRuneId),c.setHeroId(s.heroId)}n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_RUNE_INFO)}},e.prototype.reqHeroRuneEquipped=function(t){var e={};e.module=n.MsgModuleName.HERO,e.cmd=n.MsgCmd.Hero.HERO_RUNE_EQUIPPED,e.heroId=t.heroId,e.heroRuneIds=t.heroRuneIds,n.ServerDelegate.sendMessage(e)},e.prototype.reqHeroRuneDecompose=function(t){var e={};e.module=n.MsgModuleName.HERO,e.cmd=n.MsgCmd.Hero.HERO_RUNE_DECOMPOSE,e.heroRuneIds=t.heroRuneIds,n.ServerDelegate.sendMessage(e)},e.prototype.resHeroRuneEquipped=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_RUNE_EQUIPPED)},e.prototype.pushDeleteHeroList=function(t,e){if(t===n.NetCode.SUCCESS){for(var i=e.heroIds,a=this._heroMap,r=0,o=i.length;r<o;r++){var s=i[r];null!==a[s]&&delete a[s]}n.EventUtil.dispatchEvent(n.EventNameEnum.PUSH_DELETE_HERO_LIST)}},e.prototype.pushDeleteHeroRuneList=function(t,e){if(t===n.NetCode.SUCCESS){for(var i=e.heroRuneIds,a=this._heroRuneMap,r=0,o=i.length;r<o;r++){var s=i[r];null!==a[s]&&delete a[s]}n.EventUtil.dispatchEvent(n.EventNameEnum.PUSH_DELETE_HERO_RUNE_LIST)}},e.prototype.resHeroRuneDecompose=function(t,e){if(t===n.NetCode.SUCCESS){var i=n.RewardManager.parseRewardResult(e.rewardResult);n.GlobalFunction.showRewards(i),n.EventUtil.dispatchEvent(n.EventNameEnum.RES_HERO_RUNE_DECOMPOSE)}},e.prototype._reqOneKeyStarUp=function(t){this.setTmpStarLv(t.lv);var e={};e.module=n.MsgModuleName.HERO,e.cmd=n.MsgCmd.Hero.HERO_QUICK_STAR_UP,e.id=t.id,e.times=t.times,n.ServerDelegate.sendMessage(e)},e.prototype._onGetOneKeyStarUp=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.ON_GET_STAR_UP_ONE_KEY)},e.prototype.setTmpStarLv=function(t){this._tmpStarLv=t},e.prototype.getTmpStarLv=function(){return this._tmpStarLv},e.prototype.getHeroStarUpQulityLimit=function(){return 0===this._starUpQuality&&(this._starUpQuality=n.GetConfig("HERO_EVOLVE_QUALITY_LIMIT")),this._starUpQuality},e.prototype.getHeroData=function(){return this._heroMap},e.prototype.getHeroRuneData=function(){return this._heroRuneMap},e.prototype.getCanReplaceHero=function(t,e,i,a,r){void 0===e&&(e=null),void 0===i&&(i=!1),void 0===a&&(a=!0),void 0===r&&(r=!0);var o,s,l=[];if(t){var c=n.BattleArrayManager.getBattleEntityByIndex(t);c&&(o=c.getMercenarySId())}else e&&(o=n.BattleArrayManager.getFriendHeroSIdByFriendIndex(e));var u=[],d=[];if(a&&o&&this._heroMap[o]){s=this._heroMap[o].getRoleType(),u=(g=this._heroMap[o]).getSoulLinkHeroModels();for(var h=0;h<u.length;h++){var p=u[h];d.push(p.getRoleType())}}for(var _ in this._heroMap){var g=this._heroMap[_];-1===d.indexOf(g.getRoleType())&&(s&&g.getRoleType()===s||g.isEquipped()||g.isReinforcementsed()||n.BattleArrayManager.isExistMercenaryWithRoleType(g.getRoleType(),t,e,r)||(l[l.length]=g))}return l.sort(this.sortCampConvert),l},e.prototype.getCanReplaceHeroInCamp=function(t){var e=[];for(var i in this._heroMap){var n=this._heroMap[i];e[e.length]=n}return e.sort(this.sortHero),e},e.prototype.getHeroDataArray=function(t,e,i,n){void 0===e&&(e=!1),void 0===i&&(i=!1),void 0===n&&(n=!1);var a=[];for(var r in this._heroMap){var o=this._heroMap[r];t&&(o.isEquipped()||o.isReinforcementsed())||e&&o.isExplore()||(i&&!o.canWonderland()||n&&o.isSoulLinked()||(a[a.length]=o))}return a.sort(this.sortHero),a},e.prototype.getEquipedHeroDataArray=function(){var t=[];for(var e in this._heroMap){var i=this._heroMap[e];(i.isEquipped()||i.isReinforcementsed())&&(t[t.length]=i)}return t},e.prototype.getHeroForRebirth=function(){var t=[],e=[],i=[],n=[],a=[];for(var r in this._heroMap){var o=this._heroMap[r];!o.isUp()&&o.isCampConverted()||(o.isEquipped()?e[e.length]=o:o.isReinforcementsed()?n[n.length]=o:o.isExplore()?a[a.length]=o:o.isSoulLinked()?i[i.length]=o:t[t.length]=o)}return t.sort(this.sortHero),e.sort(this.sortHero),i.sort(this.sortHero),n.sort(this.sortHero),a.sort(this.sortHero),t.concat(e,i,n,a)},e.prototype.getHeroDataArraySort=function(t){var e=this.getHeroDataArray(t);return e.sort(this.sortHero),e},e.prototype.getHeroDataArraySortCampConvert=function(){var t=this.getHeroDataArray(!1);return t.sort(this.sortCampConvert),t},e.prototype.getUnEquippedHeroDataSortArrayUniqueByRoleType=function(){var t=[];for(var e in this._heroMap){var i=this._heroMap[e];i.isEquipped()||i.isReinforcementsed()||(t[t.length]=i)}for(var n=t.slice(0),a=0;a<n.length;a++)for(var r=a+1;r<n.length;)n[a].getRoleType()==n[r].getRoleType()?n.splice(r,1):r++;return n.sort(this.sortHero),n},e.prototype.getEquippedHeroDataSortArrayUniqueByRoleType=function(){var t=[];for(var e in this._heroMap){var i=this._heroMap[e];(i.isEquipped()||i.isReinforcementsed())&&(t[t.length]=i)}for(var n=t.slice(0),a=0;a<n.length;a++)for(var r=a+1;r<n.length;)n[a].getRoleType()==n[r].getRoleType()?n.splice(r,1):r++;return n.sort(this.sortHero),n},e.prototype.sortHero=function(t,e){return t.isEquipped()&&!e.isEquipped()?-1:!t.isEquipped()&&e.isEquipped()?1:t.isEquipped()&&e.isEquipped()?t.getOrderId()-e.getOrderId():t.isSoulLinked()&&!e.isSoulLinked()?-1:!t.isSoulLinked()&&e.isSoulLinked()?1:t.isSoulLinked()&&e.isSoulLinked()?t.getOrderId()-e.getOrderId():t.isReinforcementsed()&&!e.isReinforcementsed()?-1:!t.isReinforcementsed()&&e.isReinforcementsed()?1:t.isReinforcementsed()&&e.isReinforcementsed()?t.getOrderId()-e.getOrderId():t.getAptitude()!==e.getAptitude()?e.getAptitude()-t.getAptitude():t.getCultivateLevel()!==e.getCultivateLevel()?e.getCultivateLevel()-t.getCultivateLevel():t.getBreakoutLevel()!==e.getBreakoutLevel()?e.getBreakoutLevel()-t.getBreakoutLevel():t.getLevel()!==e.getLevel()?e.getLevel()-t.getLevel():e.getId()-t.getId()},e.prototype.sortCampConvert=function(t,e){return t.isEquipped()&&!e.isEquipped()?-1:!t.isEquipped()&&e.isEquipped()?1:t.isEquipped()&&e.isEquipped()?t.getOrderId()-e.getOrderId():t.isSoulLinked()&&!e.isSoulLinked()?-1:!t.isSoulLinked()&&e.isSoulLinked()?1:t.isSoulLinked()&&e.isSoulLinked()?t.getOrderId()-e.getOrderId():t.isReinforcementsed()&&!e.isReinforcementsed()?-1:!t.isReinforcementsed()&&e.isReinforcementsed()?1:t.isReinforcementsed()&&e.isReinforcementsed()?t.getOrderId()-e.getOrderId():t.getAptitude()!==e.getAptitude()?e.getAptitude()-t.getAptitude():t.isCampConverted()&&!e.isCampConverted()?-1:!t.isCampConverted()&&e.isCampConverted()?1:t.getCultivateLevel()!==e.getCultivateLevel()?e.getCultivateLevel()-t.getCultivateLevel():t.getBreakoutLevel()!==e.getBreakoutLevel()?e.getBreakoutLevel()-t.getBreakoutLevel():t.getLevel()!==e.getLevel()?e.getLevel()-t.getLevel():e.getId()-t.getId()},e.prototype.getHeroBySId=function(t){return this._heroMap[t]},e.prototype.getHerosByRoleType=function(t){var e=[];for(var i in this._heroMap){var n=this._heroMap[i];n.getRoleType()===t&&(e[e.length]=n)}return e},e.prototype.setFriendOperateOrderId=function(t){this._friendOperateOrderId=t},e.prototype.getFriendOperateOrderId=function(){return this._friendOperateOrderId},e.prototype.getFragmentComposeInfo=function(t){var e=n.GetTableClass(n.TableEnum.HeroTable).getHeroData();for(var i in e){var a=e[i];if(a.fragmentId===t)return a}return null},e.prototype.getHeroNumById=function(t,e,i){return this.getHeroListByConfigId(t,e,i).length},e.prototype.getHeroListByConfigId=function(t,e,i,n){void 0===n&&(n=0);var a=[];for(var r in this._heroMap){var o=this._heroMap[r];o.getId()!==t||e&&(o.isEquipped()||o.isReinforcementsed()||o.isExplore())||i&&o.isUp()||n&&o.getSId()===n||(a[a.length]=o)}return a.sort(function(t,e){return!t.isCampConverted()&&e.isCampConverted()?-1:t.isCampConverted()&&!e.isCampConverted()?1:void 0}),a},e.prototype.getHeroByAptitude=function(t){var e=[];for(var i in this._heroMap){var n=this._heroMap[i];n.isEquipped()||n.isReinforcementsed()||n.isUp()||n.getAptitude()!=t||e.push(n)}return e},e.prototype.getHeroCanSoulLink=function(t,e,i,a,r){void 0===r&&(r=!1);var o=[],s=null;if(r){o=this.getCanReplaceHero(t,null,null,!1,!1);var l=n.BattleArrayManager.getBattleEntityByIndex(t),c=0;l&&(c=l.getMercenarySId()),s=this._heroMap[c]}else o=this.getHeroDataArray(!1);for(var u=[],d=0;d<o.length;d++){var h=o[d];if((!s||s.getRoleType()!=h.getRoleType())&&(!h.isSoulLinked()||h.getSId()!=e)){if(r){var p=n.BattleArrayManager.isExistMercenaryWithRoleType(h.getRoleType(),t);if(!h.isSoulLinked()&&p)continue}h.canSoullink()&&h.getCurCamp()==i&&h.getFlair()<=a&&u.push(h)}}return u},e.prototype.getHeroRuneNumByConfigId=function(t){var e=0;for(var i in this._heroRuneMap){var n=this._heroRuneMap[i];n.getId()==t&&0==n.getHeroId()&&e++}return e},e.prototype.getHeroRuneBySId=function(t){return this._heroRuneMap[t]?this._heroRuneMap[t]:null},e.prototype.getHeroRuneListByConfigId=function(t){var e=[];for(var i in this._heroRuneMap){var n=this._heroRuneMap[i];n.getId()==t&&0==n.getHeroId()&&(e[e.length]=n)}return e},e.prototype.getCostItemsByLevel=function(t,e){for(var i=0,a=t,r=a.getLevel()+e,o=a.getLevelExp(),s=n.Account.getUserData().level,l=a.getLevel();l<r&&!(l>s);l++){var c=n.GetTableClass(n.TableEnum.HeroLevelUpTable).getDataByLevel(l);c&&(i+=c.needExp)}var u={};return this._getCostItemCount(u,i-o,0),u},e.prototype._getCostItemCount=function(t,e,i){for(var a=e,r=[n.ItemEnum.HeroExpItem2,n.ItemEnum.HeroExpItem3,n.ItemEnum.HeroExpItem4,n.ItemEnum.HeroExpItem5],o=0==i?r.length:i,s=0;s<o;s++){var l=r[s];if(a<=0)delete t[l];else{var c=n.ItemManager.getItemNumById(l);if(!(c<=0)){var u=n.GetTableClass(n.TableEnum.Item).getItemById(l).goodsEffectExpr,d=Math.ceil(a/u);if(!(c<d)){t[l]=d,s>0&&this._getCostItemCount(t,e-u*d,s);break}t[l]=c,a-=u*c}}}},e.prototype.getHeroByFragmentId=function(e){var i=n.GetTableClass(n.TableEnum.HeroTable).getHeroByFragmentId(e);if(i){var a=new(t("HeroModel"));return a.init(i),a}return null},e.prototype.canLevelup=function(t,e){void 0===e&&(e=1);var i=this.getHeroBySId(t),a=n.Account.getUserData().level;if(!i||i.getLevel()+e>a||!i.getNextLevelCfg())return!1;var r=i.getCurLevelCfg();return i.getLevelExp()>=r.needExp||this.getCostItemsByLevel(i,e).myLen()>0},e.prototype.canBreakout=function(t){var i=this.getHeroBySId(t);if(!i)return!1;var a=i.getNextBreakoutCfg();if(!a||a.levelLimit>i.getLevel())return!1;var r=a.cost,o=0,s=i.getId(),l=a.devour;l.length>0&&(o=l[1],s=l[0]);var c=n.RewardManager.parseRewardListDetail(r);return!!n.GamerResourceUtil.checkCost(c,n.GamerResourceUtil.TipType.None)&&e.getInstance().getHeroListByConfigId(s,!0,!0,i.getSId()).length>=o},e.prototype.canCultivate=function(t){if(!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.HERO_CULTIVATE,0))return!1;var e=this.getHeroBySId(t);if(!e)return!1;var i=e.getNextCultivateCfg();if(!i)return!1;var a=i?i.singleCount:0;return!(0===a||!n.GamerResourceUtil.checkItem(n.GetConfig("HERO_CULTIVATE_GOODS_ID"),a,n.GamerResourceUtil.TipType.None))},e.prototype.canStarUp=function(t){if(!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.HERO_STAR_UP,0))return!1;var i=this.getHeroBySId(t);if(!i)return!1;var a=i.getNextStarCfg();if(!a)return!1;if(i.getBreakoutLevel()<i.getNeedBreakoutLevel())return!1;var r=i.getHeroRune(),o=a.cost,s=a.heroRunes,l=0,c=i.getId(),u=a.devour;u.length>0&&(l=u[1],c=u[0]);for(var d=[],h=0,p=s.length;h<p;h++)d[d.length]=[n.RewardType.HeroRune,s[h],1];var _=n.RewardManager.parseRewardListDetail(d),g=r.myLen()>=_.length;for(h=0,p=_.length;h<p;h++){var f=_[h];if(!r[f.getId()])if(e.getInstance().getHeroRuneNumByConfigId(f.getId())>0){g=!0;break}}return!!g&&(!!n.GamerResourceUtil.checkCost(o,n.GamerResourceUtil.TipType.None)&&e.getInstance().getHeroListByConfigId(c,!0,!0,i.getSId()).length>=l)},e.prototype.canEvolve=function(t){if(!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.HERO_EVOLVE,0))return!1;var e=this.getHeroBySId(t);if(!e)return!1;if(!e.getEvolveAble())return!1;var i=n.GetConfig("HERO_EVOLVE_BREAKOUT_LIMIT");if(e.getBreakoutLevel()<i)return!1;var a=e.getNextEvolveCfg();if(!a)return!1;var r=a.cost,o=n.RewardManager.parseRewardListDetail(r);return!!n.GamerResourceUtil.checkCost(o,n.GamerResourceUtil.TipType.None)},e.prototype.canHeroUp=function(t){return this.canLevelup(t)||this.canBreakout(t)||this.canCultivate(t)||this.canStarUp(t)||this.canEvolve(t)},e.prototype.isFriendRedPoint=function(){for(var t=n.ActorUnlockType.REINFORCEMENT,e=n.BattleArrayManager.getFriendList(),i=1;i<=n.MaxEnum.MaxBattleFriendCount;i++){if(n.UnlockManager.isTargetUnlock(t,i)&&!e[i])if(this.getCanReplaceHero(null,i,!0).length>0)return!0}return!1},e.prototype.hasFragmentToCompose=function(){if(n.GlobalFunction.getLocalSaveStatus("HeroFragment"))return!1;var t=n.ItemManager.getItemsDatasByGoodsSubType(n.GoodsSubType.HERO_FRAGMENT),i=n.ItemManager.getItemsDatasByGoodsSubType(n.GoodsSubType.HERO_RAND_FRAMENT);for(var a in t){var r=t[a];if(e.getInstance().getFragmentComposeInfo(r.getId()).fragmentCount<=r.getCount())return!0}for(var a in i){if((r=i[a]).getEffectValue()[0]<=r.getCount())return!0}return!1},e.prototype.openFragment=function(){!n.GlobalFunction.getLocalSaveStatus("HeroFragment")&&this.hasFragmentToCompose()&&(n.GlobalFunction.setLocalSaveStatus("HeroFragment",!0),n.EventUtil.dispatchEvent(n.EventNameEnum.OPEN_HERO_FRAGMENT))},e.prototype.fragmentComposeEvent=function(){return[n.EventNameEnum.ITEM_CHANGE,n.EventNameEnum.OPEN_HERO_FRAGMENT]},e.prototype.getHeroOneKeyStarupData=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=!1);var a=this.getHeroBySId(t),r={addLv:1},o=n.GetTableClass(n.TableEnum.HeroStarUpTable).getHeroAllStarCfs(a.getRoleType()),s=n.GetTableClass(n.TableEnum.HeroStarUpTable).getMaxLevelById(a.getRoleType()),l=a.getStarLevel();if(l>=s)return r;e||(e=s);var c={},u={},d=a.getHeroRune();for(var h in d)u.hasOwnProperty(h)?u[h]+=1:u[h]=1+this.getHeroRuneNumByConfigId(Number(h));var p={};p[t]=0;for(var _={},g=0,f=a.getBreakoutLevel(),v=1;v<=s&&v<=e&&!r.costNotEnoughStr;v++){var m=l+v,y=o[m];if(y||0!=m){if(!y)break;if(f<y.needBreakoutLevel){if(!(g<1||i))break;r.costNotEnoughStr=416}for(var E=y.cost,T={},C=!0,R=0;R<E.length;R++){var S=E[R],I=S[1],A=S[2];c.hasOwnProperty(I)||(c[I]=n.ItemManager.getItemNumById(I));var b=c[I]||0;if(b>=A||g<1||i){if(T[I]?T[I]+=A:T[I]=A,c[I]-=A,b<A&&!r.costNotEnoughStr){var P=n.GetTableClass(n.TableEnum.Item).getItemById(I);r.costNotEnoughStr=P.name}}else C=!1}if(g>0&&!C)break;T[t]=0;var N=y.devour;(!N||N.length<2)&&(N=[0,0]);var M=N[0];if(!c.hasOwnProperty(M)){var L=this.getHeroListByConfigId(M,!0,!0,t);c[M]=L.length}var D=N[1]||0,B=!0,w=c[M]||0;if(w>=D||g<1||i?(T[t]+=D,c[M]-=D,w<D&&!r.costNotEnoughStr&&(r.costNotEnoughStr=n.Language.self)):B=!1,g>0&&!B)break;for(var O={},F=y.heroRunes,G=!0,k=0;k<F.length;k++){h=F[k];u.hasOwnProperty(h)||(u[h]=this.getHeroRuneNumByConfigId(Number(h))||0);var U=u[h];U>0||g<1||i?(O[h]?O[h]+=1:O[h]=1,u[h]-=1,U<1&&!r.costNotEnoughStr&&(r.costNotEnoughStr=n.Language.rune)):G=!1}if(g>0&&!G)break;if(!(C&&B&&G))break;for(var H in T){var x=T[H];p[H]?p[H]+=x:p[H]=x}for(var h in O){x=O[h];_[h]?_[h]+=x:_[h]=x}g++,r.addLv=g}}return r.totalCost=p,r.totalRunes=_,r},e}();i.default=r,cc._RF.pop()},{HeroModel:"HeroModel",HeroRuneModel:"HeroRuneModel"}],HeroModel:[function(t,e,i){"use strict";cc._RF.push(e,"f9ce1AZYHNPHJOVvnn2rOum","HeroModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=t("PropertyModel"),o=t("HeroRuneModel"),s=t("./HeroEnum"),l=t("../../Treasure/Model/SpecialAttributeEnum"),c=t("../Manager/HeroManager"),u=t("../../WonderlandAdventure/Manager/WonderlandManager"),d=t("../../HeroArtifact/Manager/HeroArtifactManager"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._goodsType=0,e._level=0,e._exp=0,e._breakoutLevel=0,e._cultivateLevel=0,e._cultivateExp=0,e._starLevel=0,e._evolveLevel=0,e._avatarId=0,e._showId=0,e._features=0,e._quality=0,e._aptitude=0,e._fragmentId=0,e._fragmentCount=0,e._canWonderland=!0,e._flair=0,e._combinationSkillId=0,e._combinationHeroIds=[],e._engulfedExp=0,e._attack=0,e._hp=0,e._speed=0,e._physicalArmor=0,e._spellArmor=0,e._accuracy=0,e._evade=0,e._crit=0,e._toughness=0,e._damageBonus=0,e._damageReduction=0,e._skill=0,e._evolveSkill=0,e._reinforcementIds=[],e._avaliable=!0,e._count=0,e._orderId=0,e._sortId=0,e._isEvolveFull=!1,e._maxStar=0,e._shadowScale=1,e._modelShowType=1,e._isManualActivate=!1,e._isAddBattle=!1,e._isAddFriend=!1,e._needBreakoutLevel=0,e._soulList=[],e._isSoulLink=!1,e._soulLinkHeroModels=[],e._battleId=0,e._isSoulLinked=!1,e._camp=0,e._defaultCamp=0,e._defaultQuality=0,e}return n(e,t),e.prototype.init=function(e){e&&(t.prototype.init.call(this,"HeroModel",a.UserPropertyEnum.Mercenary,e.roleId,e.name,e.headImg,e.res,e.animationType),this._goodsType=a.GoodsType.Type_Mercenary,this._quality=e.quality,this._features=e.features,this._camp=e.camp,this._roleType=e.roleType,this._attack=e.attack,this._hp=e.hp,this._speed=e.speed,this._physicalArmor=e.physicalArmor,this._spellArmor=e.spellArmor,this._accuracy=e.accuracy,this._evade=e.evade,this._crit=e.crit,this._toughness=e.toughness,this._sortId=e.sortId,this._levelSkillIds=e.levelSpecialEffects,this._avaliable=1===e.available,this._baseAttr={},this._baseAttr[a.AttrType.Attack]=this._attack,this._baseAttr[a.AttrType.HP]=this._hp,this._baseAttr[a.AttrType.Speed]=this._speed,this._baseAttr[a.AttrType.PhysicalArmor]=this._physicalArmor,this._baseAttr[a.AttrType.SpellArmor]=this._spellArmor,this._baseAttr[a.AttrType.Accuracy]=this._accuracy,this._baseAttr[a.AttrType.Evade]=this._evade,this._baseAttr[a.AttrType.Crit]=this._crit,this._baseAttr[a.AttrType.Toughness]=this._toughness,this._aptitude=e.aptitude,this._fragmentCount=e.fragmentCount,this._fragmentId=e.fragmentId,this._canWonderland=1==e.canWonderland,this._flair=e.flair,this._commonAttack=e.commonAttack,this._skill=e.skill,this._reinforcementIds=e.reinforcementIds,this._showReinforcementIds=[],this._description=e.herodes,this._skillId=e.skill,this._reinforcement=a.GlobalFunction.parseEffectArray(e.reinforcementTTPercent),this._reinforcementUp=a.GlobalFunction.parseEffectArray(e.reinforcementUpTTPercent),this._animationOffset=e.animationOffset,this._animationRes=e.spriteAnimationRes,this._pveIdleRes=e.pveIdleRes,this._pvpIdleRes=e.pvpIdleRes,this._pveAttack=e.pveAttack,this._showIdleOffset=cc.v2(e.idleOffset[0],e.idleOffset[1]),this._decompose=e.decompose,this._levelAttributes=e.levelAttributes,this._combinationSkillId=e.combinationSkillId,this._combinationHeroIds=e.combinationHeroIds,this._combinationSkillReplaceIds=e.combinationSkillReplaceIds||[],this._shadowScale=e.shadowScale||100,this._shadowScale=this._shadowScale/100,this._specialEffectId=e.specialEffectId,this._obtainWay=e.obtainWay,this._evolveCompletedHero=e.evolveCompletedHero,this._evolveOldHero=e.evolveOldHero,this._evolveAble=e.evolveAble,this._isShow=1===e.isShow,this._level=1,this._levelExp=0,this._levelUpCostExp=0,this._evolveLevel=0,this._count=1,this._artifactSid=null,this._heroArtifactLevel=1,this._heroArtifactAdvanceLevel=0)},e.prototype.getBaseAttackPower=function(){var t=a.GetConfig("FIGHT_POWER_EXPRESSION"),e=this.getTotalAttr();return Math.floor(a.GlobalFunction.calculateExpression(t,e))},e.prototype.getBaseTotalAttr=function(){return this.getTotalAttr()},e.prototype.getModelShowType=function(){return this._modelShowType},e.prototype.getShadowScale=function(){return this._shadowScale},e.prototype.getCombinationSkillId=function(){return this._combinationSkillId},e.prototype.getCombinationHeroIds=function(){return this._combinationHeroIds},e.prototype.getCombinationSkillReplaceIds=function(){return this._combinationSkillReplaceIds},e.prototype.getFragmentId=function(){return this._fragmentId},e.prototype.getRealFragmentId=function(){var t=a.GetTableClass(a.TableEnum.HeroTable).getHeroByRoleTypeAndId(this._roleType,this._roleType);return t?t.fragmentId:0},e.prototype.getEvolveCompletedHero=function(){return this._evolveCompletedHero},e.prototype.getEvolveOldHero=function(){return this._evolveOldHero},e.prototype.getEvolveAble=function(){return this._evolveAble},e.prototype.getFragmentCount=function(){return this._fragmentCount},e.prototype.getLevelAttrButes=function(){var t={};if(this._evolveLevel>0)for(var e=0,i=(n=a.GetTableClass(a.TableEnum.HeroEvolveTable).getDataByIdAndLevel(this.getId(),this._evolveLevel).levelAttributes).length;e<i;e++){t[(r=n[e])[0]]?t[r[0]]+=r[1]:t[r[0]]=r[1]}if(this._breakoutLevel>0){var n;for(e=0,i=(n=a.GetTableClass(a.TableEnum.HeroBreakoutTable).getDataByIdAndLevel(this.getRoleType(),this._breakoutLevel).levelAttributes).length;e<i;e++){t[(r=n[e])[0]]?t[r[0]]+=r[1]:t[r[0]]=r[1]}}for(e=0,i=this._levelAttributes.length;e<i;e++){var r;t[(r=this._levelAttributes[e])[0]]?t[r[0]]+=r[1]:t[r[0]]=r[1]}return t},e.prototype.getGoodsType=function(){return this._goodsType},e.prototype.getQuality=function(){return this._quality},e.prototype.getLevelSkillIds=function(){return this._levelSkillIds},e.prototype.getFeatures=function(){return this._features},e.prototype.getRoleType=function(){return this._roleType},e.prototype.canWonderland=function(){return this._canWonderland},e.prototype.getFlair=function(){return this._flair},e.prototype.getAptitude=function(){return this._aptitude},e.prototype.getBaseAttr=function(){return this._baseAttr},e.prototype.getAttack=function(){var t=a.AttrType.Attack,e=this.getAttrSelf(t);return this._attack+e},e.prototype.getHp=function(){var t=a.AttrType.HP,e=this.getAttrSelf(t);return this._hp+e},e.prototype.getSpeed=function(){var t=a.AttrType.Speed,e=this.getAttrSelf(t);return this._speed+e},e.prototype.getPhysicalArmor=function(){var t=a.AttrType.PhysicalArmor,e=this.getAttrSelf(t);return this._physicalArmor+e},e.prototype.getSpellArmor=function(){var t=a.AttrType.SpellArmor,e=this.getAttrSelf(t);return this._spellArmor+e},e.prototype.getAccuracy=function(){var t=a.AttrType.Accuracy,e=this.getAttrSelf(t);return this._accuracy+e},e.prototype.getEvade=function(){var t=a.AttrType.Evade,e=this.getAttrSelf(t);return this._evade+e},e.prototype.getCrit=function(){var t=a.AttrType.Crit,e=this.getAttrSelf(t);return this._crit+e},e.prototype.getToughness=function(){var t=a.AttrType.Toughness,e=this.getAttrSelf(t);return this._toughness+e},e.prototype.getDamageBonus=function(){return 0},e.prototype.getDamageReduction=function(){return 0},e.prototype.getAttrSelf=function(t){return 0},e.prototype.getAttrByType=function(t){var e=a.AttrType;switch(t){case e.None:return null;case e.Attack:return this.getAttack();case e.HP:return this.getHp();case e.TOWER_ATTACK_SPEED:return this.getSpeed();case e.PhysicalArmor:return this.getPhysicalArmor();case e.PhysicalPen:return this.getPhysicalPen();case e.SpellArmor:return this.getSpellArmor();case e.SpellPen:return this.getSpellPen();case e.Accuracy:return this.getAccuracy();case e.Evade:return this.getEvade();case e.Crit:return this.getCrit();case e.Toughness:return this.getToughness();case e.DamageBonus:return this.getDamageBonus();case e.DamageReduction:return this.getDamageReduction();default:return 0}},e.prototype.getAnimationOffset=function(){return this._animationOffset},e.prototype.getPveIdleRes=function(){return this._pveIdleRes},e.prototype.getPvpIdleRes=function(){return this._pvpIdleRes},e.prototype.getAnimationRes=function(){return this._animationRes},e.prototype.setLevel=function(t){this._level=t,this._curLevelCfg=a.GetTableClass(a.TableEnum.HeroLevelUpTable).getDataByLevel(t),this._nextLevelCfg=a.GetTableClass(a.TableEnum.HeroLevelUpTable).getDataByLevel(t+1)},e.prototype.getCurLevelCfg=function(){return this._curLevelCfg},e.prototype.getNextLevelCfg=function(){return this._nextLevelCfg},e.prototype.getLevel=function(){return this._level},e.prototype.getAvaliable=function(){return this._avaliable},e.prototype.getIsShow=function(){return this._isShow},e.prototype.setLevelExp=function(t){this._exp=t},e.prototype.getLevelExp=function(){return this._exp},e.prototype.setBreakoutLevel=function(t){this._breakoutLevel=t,this._curBreakoutCfg=a.GetTableClass(a.TableEnum.HeroBreakoutTable).getDataByIdAndLevel(this.getRoleType(),t),this._nextBreakoutCfg=a.GetTableClass(a.TableEnum.HeroBreakoutTable).getDataByIdAndLevel(this.getRoleType(),t+1)},e.prototype.getBreakoutLevel=function(){return this._breakoutLevel},e.prototype.getCurBreakoutCfg=function(){return this._curBreakoutCfg},e.prototype.getNextBreakoutCfg=function(){return this._nextBreakoutCfg},e.prototype.setCultivateExp=function(t){this._cultivateExp=t},e.prototype.getCultivateExp=function(){return this._cultivateExp},e.prototype.setCultivateLevel=function(t){this._cultivateLevel=t,this._curCultivateCfg=a.GetTableClass(a.TableEnum.HeroCultivateTable).getDataByLevel(t),this._nextCultivateCfg=a.GetTableClass(a.TableEnum.HeroCultivateTable).getDataByLevel(t+1)},e.prototype.getCultivateLevel=function(){return this._cultivateLevel},e.prototype.getCurCultivateCfg=function(){return this._curCultivateCfg},e.prototype.getNextCultivateCfg=function(){return this._nextCultivateCfg},e.prototype.setStarLevel=function(t){this._starLevel=t,this._curStarLevelCfg=a.GetTableClass(a.TableEnum.HeroStarUpTable).getDataByIdAndLevel(this.getRoleType(),this._starLevel),this._nextStarLevelCfg=a.GetTableClass(a.TableEnum.HeroStarUpTable).getDataByIdAndLevel(this.getRoleType(),this._starLevel+1),this._nextStarLevelCfg&&(this._needBreakoutLevel=this._nextStarLevelCfg.needBreakoutLevel?this._nextStarLevelCfg.needBreakoutLevel:0)},e.prototype.getNeedBreakoutLevel=function(){return this._needBreakoutLevel},e.prototype.getCurStarCfg=function(){return this._curStarLevelCfg},e.prototype.getNextStarCfg=function(){return this._nextStarLevelCfg},e.prototype.getStarLevel=function(){return this._starLevel},e.prototype.getSpecialEffectId=function(){return this._specialEffectId},e.prototype.getIsManualActivate=function(){return this._isManualActivate},e.prototype.setIsManualActivate=function(){this._isManualActivate=!0},e.prototype.getStarRankInfo=function(){return{star:Math.floor(this._starLevel/a.GetConfig("HERO_STAR_UP_UNIT")),rank:this._starLevel%a.GetConfig("HERO_STAR_UP_UNIT")}},e.prototype.getStarRankStr=function(t){var e=t||this._starLevel,i=Math.floor(e/a.GetConfig("HERO_STAR_UP_UNIT")),n=e%a.GetConfig("HERO_STAR_UP_UNIT");return i>a.GetConfig("HERO_STAR_UP_RANK")?cc.js.formatStr(a.Language.heroStarRank1,i-a.GetConfig("HERO_STAR_UP_RANK"),n):cc.js.formatStr(a.Language.heroStarRank,i,n)},e.prototype.getStar=function(){return Math.floor(this._starLevel/a.GetConfig("HERO_STAR_UP_UNIT"))},e.prototype.getMaxStar=function(){if(0===this._maxStar){var t=a.GetTableClass(a.TableEnum.HeroStarUpTable).getMaxLevelById(this.getRoleType());this._maxStar=Math.min(Math.floor(t/a.GetConfig("HERO_STAR_UP_UNIT")),a.GetConfig("HERO_STAR_UP_RANK"))}return this._maxStar},e.prototype.setEvolveLevel=function(t){this._evolveLevel=t,this._curEvolveCfg=a.GetTableClass(a.TableEnum.HeroEvolveTable).getDataByIdAndLevel(this.getId(),this._evolveLevel),this._nextEvolveCfg=a.GetTableClass(a.TableEnum.HeroEvolveTable).getDataByIdAndLevel(this.getId(),this._evolveLevel+1),this._isEvolveFull=this._evolveLevel>=s.HERO_MAX_EVOLVE_NOCHANGE_LEVEL},e.prototype.getCurEvolveCfg=function(){return this._curEvolveCfg},e.prototype.getNextEvolveCfg=function(){return this._nextEvolveCfg},e.prototype.getCurrentLvAttr=function(){var t=this.getLevelAttrButes(),e={};for(var i in t){var n=parseInt(i);e[n]?e[n]+=t[i]*(this._level-1):e[n]=t[i]*(this._level-1)}var r=a.AttrType;return e[r.Attack]&&this._attack?e[r.Attack]+=this._attack:e[r.Attack]=this._attack,e[r.HP]&&this._hp?e[r.HP]+=this._hp:e[r.HP]=this._hp,e[r.TOWER_ATTACK_SPEED]&&this._speed?e[r.TOWER_ATTACK_SPEED]+=this._speed:e[r.TOWER_ATTACK_SPEED]=this._speed,e[r.PhysicalArmor]&&this._physicalArmor?e[r.PhysicalArmor]+=this._physicalArmor:e[r.PhysicalArmor]=this._physicalArmor,e[r.SpellArmor]&&this._spellArmor?e[r.SpellArmor]+=this._spellArmor:e[r.SpellArmor]=this._spellArmor,e[r.Accuracy]&&this._accuracy?e[r.Accuracy]+=this._accuracy:e[r.Accuracy]=this._accuracy,e[r.Evade]&&this._evade?e[r.Evade]+=this._evade:e[r.Evade]=this._evade,e[r.Crit]&&this._crit?e[r.Crit]+=this._crit:e[r.Crit]=this._crit,e[r.Toughness]&&this._toughness?e[r.Toughness]+=this._toughness:e[r.Toughness]=this._toughness,e},e.prototype.getCurrentBreakAttr=function(){return this.getBreakLevelAttr(this._breakoutLevel)},e.prototype.getBreakLevelAttr=function(t){for(var e={},i=t;i>0;i--){var n=a.GetTableClass(a.TableEnum.HeroBreakoutTable).getDataByIdAndLevel(this.getRoleType(),i);if(n)(n.attributes?n.attributes:[]).forEach(function(t){e[t[0]]?e[t[0]]+=t[1]:e[t[0]]=t[1]})}return e},e.prototype.getCurrentCultivateAttr=function(){var t={};this._curCultivateCfg&&this._curCultivateCfg.attributeTTPercent.forEach(function(e){t[e[0]]?t[e[0]]+=e[1]:t[e[0]]=e[1]});return t},e.prototype.getCultivateSpecialEffectAttr=function(){for(var t=a.GetTableClass(a.TableEnum.HeroCultivateAttributeTable).getAttrsByHeroIdAndLevel(this._roleType,this._cultivateLevel),e={},i=0;i<t.length;i++){t[i].attributes.forEach(function(t){e[t[0]]?e[t[0]]+=t[1]:e[t[0]]=t[1]})}return e},e.prototype.getCurrrenStarAttrTT=function(){var t={};this._curStarLevelCfg&&this._curStarLevelCfg.attributeTTPercent.forEach(function(e){t[e[0]]=e[1]});return t},e.prototype.getCurrentStarAttr=function(){var t={};if(this._curStarLevelCfg){var e={};if(this._curStarLevelCfg.attributes.forEach(function(t){e[t[0]]=t[1]}),this._starLevel>0)this._curStarLevelCfg.runesAttr.forEach(function(t){e[t[0]]?e[t[0]]+=t[1]:e[t[0]]=t[1]});for(var i in e)t[i]?t[i]+=e[i]:t[i]=e[i]}if(this._heroRune){var n={};for(var i in this._heroRune){var r=a.GetTableClass(a.TableEnum.HeroRuneTable).getHeroRuneById(i);r&&r.attributes.forEach(function(t){n[t[0]]?n[t[0]]+=t[1]:n[t[0]]=t[1]})}for(var i in n)t[i]?t[i]+=n[i]:t[i]=n[i]}return t},e.prototype.getCurrentEvolveAttr=function(){if(this._curEvolveCfg){var t={};return this._curEvolveCfg.attributes.forEach(function(e){t[e[0]]=e[1]}),t}return{}},e.prototype.getPartnershipAttrTT=function(){var t=[];this._reinforcementIds.forEach(function(e){var i=a.PartnershipManager.getPartnershipById(e);i&&i.isActive()&&t.push(i)});var e={};return t.forEach(function(t){t.getEffect().forEach(function(t){e[t[0]]?e[t[0]]+=t[1]:e[t[0]]=t[1]})}),e},e.prototype.getPartnershipNum=function(){var t=0;return this._reinforcementIds.forEach(function(e){var i=a.PartnershipManager.getPartnershipById(e);i&&i.isActive()&&t++}),t},e.prototype.getBattleArrayAttrByOrderId=function(t){var e=[];if(t){var i=a.BattleArrayManager.getBattleEntityByIndex(t);if(!i)return e;var n=i.getMercenarySId(),r=c.default.getInstance().getHeroBySId(n);r=r.getBattleHeroModel();for(var o=c.default.getInstance().getHeroDataArray(!1),s=0;s<o.length;s++){var u=o[s];if(u.isEquipped()&&!(u.getBreakoutLevel()<=0)&&u.getSId()!=n)(u=u.getBattleHeroModel()).getBreakoutSpecialEffectAttr().forEach(function(t){t.type!=r.getFeatures()&&t.type!=l.AttributeTargetType.LINEUP&&t.type!=r.getCurCamp()+7||e.push(t)})}}return e},e.prototype.getTotalAttrTT=function(){var t=this,e=this.getCurrentCultivateAttr(),i=this.getCurrrenStarAttrTT(),n=this.getPartnershipAttrTT(),a={};this.getBattleArrayAttrByOrderId(this._orderId).forEach(function(t){t.attributeTTPercent&&t.attributeTTPercent.forEach(function(t){a[t[0]]?a[t[0]]+=t[1]:a[t[0]]=t[1]})});var r={};this.getBreakoutSpecialEffectAttr().forEach(function(e){e.type!=l.AttributeTargetType.SELF&&e.type!=t.getFeatures()&&e.type!=l.AttributeTargetType.LINEUP&&e.type!=t.getCurCamp()+7||e.attributeTTPercent&&e.attributeTTPercent.forEach(function(t){r[t[0]]?r[t[0]]+=t[1]:r[t[0]]=t[1]})});var o={};for(var s in e)o[s]?o[s]+=e[s]:o[s]=e[s];for(var s in i)o[s]?o[s]+=i[s]:o[s]=i[s];for(var s in n)o[s]?o[s]+=n[s]:o[s]=n[s];for(var s in a)o[s]?o[s]+=a[s]:o[s]=a[s];for(var s in r)o[s]?o[s]+=r[s]:o[s]=r[s];return o},e.prototype.getTotalAttrAbsolute=function(){var t=this,e=this.getCurrentLvAttr(),i=this.getCurrentBreakAttr(),n=this.getCurrentStarAttr(),a=this.getCurrentEvolveAttr(),r={};for(var o in e)r[o]?r[o]+=e[o]:r[o]=e[o];for(var o in i)r[o]?r[o]+=i[o]:r[o]=i[o];for(var o in n)r[o]?r[o]+=n[o]:r[o]=n[o];var s=this.getCultivateSpecialEffectAttr();for(var o in s)r[o]?r[o]+=s[o]:r[o]=s[o];for(var o in a)r[o]?r[o]+=a[o]:r[o]=a[o];return this.getBattleArrayAttrByOrderId(this._orderId).forEach(function(t){t.attributes&&t.attributes.forEach(function(t){r[t[0]]?r[t[0]]+=t[1]:r[t[0]]=t[1]})}),this.getBreakoutSpecialEffectAttr().forEach(function(e){e.type!=l.AttributeTargetType.SELF&&e.type!=t.getFeatures()&&e.type!=l.AttributeTargetType.LINEUP&&e.type!=t.getCurCamp()+7||e.attributes&&e.attributes.forEach(function(t){r[t[0]]?r[t[0]]+=t[1]:r[t[0]]=t[1]})}),this.getCurrentArtifactSpecialEffectAttr().forEach(function(e){e.type!=l.AttributeTargetType.SELF&&e.type!=t.getFeatures()&&e.type!=l.AttributeTargetType.LINEUP&&e.type!=t.getCurCamp()+7||e.attributes&&e.attributes.forEach(function(t){r[t[0]]?r[t[0]]+=t[1]:r[t[0]]=t[1]})}),r},e.prototype.getTotalAttr=function(){var t=this.getTotalAttrAbsolute(),e=this.getTotalAttrTT();return a.GlobalFunction.getAttrMultipyAttrTT(t,e),t},e.prototype.getEvolveLevel=function(){return this._evolveLevel},e.prototype.isEvolveFull=function(){return this._isEvolveFull},e.prototype.isEquipped=function(){return this._isAddBattle},e.prototype.getSortId=function(){return this._sortId},e.prototype.setEquipped=function(t){this._isAddBattle=t,t||(this._orderId=0)},e.prototype.isReinforcementsed=function(){return this._isAddFriend},e.prototype.isUp=function(){return this._level>1||this._exp>0||this._breakoutLevel>0||this._cultivateLevel>0||this._cultivateExp>0||this._starLevel>0||this._evolveLevel>0||this._heroRune.myLen()>0},e.prototype.getBreakoutSpecialEffectAttr=function(){var t=[];return a.GetTableClass(a.TableEnum.HeroBreakoutTable).getSpecialIdsByLv(this.getRoleType(),this._breakoutLevel,this.getId(),this._evolveLevel).forEach(function(e){var i=a.GetTableClass(a.TableEnum.SpecialEffectTable).getDataById(e);if(i&&i.type==l.SpecialEffectType.ATTRIBUTE){var n=a.GetTableClass(a.TableEnum.SpecialAttributeTable).getDataById(e);t.push(n)}}),t},e.prototype.setReinforcementsed=function(t){this._isAddFriend=t,t||(this._orderId=0)},e.prototype.getGenAtk=function(){return this._commonAttack},e.prototype.getSkill=function(){return this._skillId},e.prototype.getReinforcementIds=function(){return this._reinforcementIds},e.prototype.getShowReinforcementIds=function(){return this._showReinforcementIds},e.prototype.getName=function(){return this._name},e.prototype.getShowModelResKey=function(){var t="npc_animation_"+this._roleType;if(!gdk.ResourceId.getValue(t)){var e={};e[t]={HeroIdel:{type:cc.Prefab,resArray:[this._animationRes,this._pveIdleRes,this._pvpIdleRes,this._pveAttack]}},gdk.ResourceId.mixins(e)}return t},e.prototype.getShowIdleOffset=function(){return this._showIdleOffset},e.prototype.getDes=function(){return this._description},e.prototype.setCount=function(t){this._count=t},e.prototype.getCount=function(){return this._count},e.prototype.getObtainWay=function(){return this._obtainWay||[]},e.prototype.setOrderId=function(t){this._orderId=t,this._refreshSoulHeroOrderId(t)},e.prototype.getOrderId=function(){return this._orderId},e.prototype.getHeroRune=function(){return this._heroRune},e.prototype.setHeroRune=function(t,e){void 0===e&&(e=!1),this._heroRune={};for(var i=0;i<t.length;i++){var n=void 0;if(e){n=new o;var r=a.GetTableClass(a.TableEnum.HeroRuneTable).getHeroRuneById(t[i]);n.init(r)}else n=c.default.getInstance().getHeroRuneBySId(t[i]);n&&(this._heroRune[n.getId()]=!0)}},e.prototype.resetLevelInfo=function(){this._level=1,this._exp=0,this._breakoutLevel=0,this._cultivateLevel=0,this._cultivateExp=0,this._starLevel=0,this._evolveLevel=0,this._heroRune={}},e.prototype.isExplore=function(){return u.default.getInstance().isHeroOnExplore(this.getSId())},e.prototype.getArtifactSid=function(){return this._artifactSid},e.prototype.setArtifactSid=function(t){this._artifactSid=t},e.prototype.getHeroArtifactLevel=function(){return this._heroArtifactLevel},e.prototype.setHeroArtifactLevel=function(t){this._heroArtifactLevel=t},e.prototype.getHeroArtifactAdvanceLevel=function(){return this._heroArtifactAdvanceLevel},e.prototype.setHeroArtifactAdvanceLevel=function(t){this._heroArtifactAdvanceLevel=t},e.prototype.getCurrentArtifactAttr=function(){if(this._artifactSid&&0!==this._artifactSid){var t=d.default.getInstance().getArtifactModelByArtifactId(this._artifactSid);if(!t)return{};var e={};return(t=t.getRealArtifactModel()).getAttributes().forEach(function(t){e[t[0]]=t[1]}),e}return{}},e.prototype.getCurrentArtifactSpecialEffectAttr=function(){if(this._artifactSid&&0!==this._artifactSid){var t=d.default.getInstance().getArtifactModelByArtifactId(this._artifactSid);return t?(t=t.getRealArtifactModel()).getArtifactSpecialEffectAttr():[]}return[]},e.prototype.getBattleHeroModel=function(){if(!this._soulLinkHeroModels||this._soulLinkHeroModels.length<=0)return this;for(var t=0;t<this._soulLinkHeroModels.length;t++){var e=this._soulLinkHeroModels[t];if(this.getBattleHeroId()==e.getSId())return e}return this},e.prototype.isBattleHero=function(){return this.getSId()==this._battleId},e.prototype.getSoulLinkHeroBySid=function(t){if(!this._soulLinkHeroModels||this._soulLinkHeroModels.length<=0)return null;for(var e=0;e<this._soulLinkHeroModels.length;e++){var i=this._soulLinkHeroModels[e];if(t==i.getSId())return i}return null},e.prototype.isSoulLink=function(){return this._isSoulLink},e.prototype.setIsSoulLink=function(t){this._isSoulLink=t},e.prototype.isSoulLinked=function(){return this._isSoulLinked},e.prototype.setSoulLinked=function(t){this._isSoulLinked=t},e.prototype.setBattleHeroId=function(t){this._battleId=t},e.prototype.getBattleHeroId=function(){return this._battleId},e.prototype.setSoulLinkHero=function(t){this._soulLinkHeroModels=t},e.prototype.getSoulLinkHeroModels=function(){return this._soulLinkHeroModels},e.prototype.getSoulList=function(){return this._soulList},e.prototype.isHaveSoulLinkHeros=function(){return!(!this._soulList||this._soulList.length<=0)},e.prototype.isTypeExistInSoulLink=function(t){if(this.isHaveSoulLinkHeros())for(var e=0;e<this._soulLinkHeroModels.length;e++){if(t==this._soulLinkHeroModels[e].getRoleType())return!0}return!1},e.prototype._refreshSoulHeroOrderId=function(t){if(this._soulLinkHeroModels&&!(this._soulLinkHeroModels.length<=0))for(var e=0;e<this._soulLinkHeroModels.length;e++){this._soulLinkHeroModels[e].setOrderId(t)}},e.prototype._getSoulHeroCfg=function(t){var e={heroCfg:{},curElLv:0},i=a.GetTableClass(a.TableEnum.HeroTable).getHerosByRoleType(t);i.sort(function(t,e){return t.aptitude-e.aptitude});for(var n=0;n<i.length;n++){var r=i[n];if(r.aptitude==this.getAptitude()){var o=a.GetTableClass(a.TableEnum.HeroEvolveTable).getMaxELLvById(r.roleId);return e.heroCfg=r,this.getEvolveLevel()>=o?e.curElLv=o:e.curElLv=this.getEvolveLevel(),e}}if(this.getAptitude()<i[0].aptitude)return e.heroCfg=i[0],e.curElLv=0,e;if(this.getAptitude()>i[i.length-1].aptitude){e.heroCfg=i[i.length-1];o=a.GetTableClass(a.TableEnum.HeroEvolveTable).getMaxELLvById(e.heroCfg.roleId);return e.curElLv=o,e}},e.prototype.refreshSoulLinkHero=function(t,i){if(void 0===i&&(i=!1),this._soulList=t,!t||t.length<=0)this.setSoulLinkHero([]);else{for(var n=0,r=0;r<t.length;r++,n++){var o=t[r],s=0,l={},u=0;if(i){s=t[r],l=a.GetTableClass(a.TableEnum.HeroTable).getHeroById(s),l=(h=this._getSoulHeroCfg(l.roleType)).heroCfg,u=h.curElLv,s=h.roleId}else{var h,p=c.default.getInstance().getHeroBySId(o);if(!p)return void this.setSoulLinkHero([]);l=(h=this._getSoulHeroCfg(p.getRoleType())).heroCfg,u=h.curElLv,s=l.roleId}var _=this._soulLinkHeroModels[r];null==_&&((_=new e).init(l),_.setSId(o)),_.getId()!=s&&_.init(l),_.setSId(o),_.setBattleHeroId(this.getBattleHeroId()),_.setLevel(this.getLevel()),_.setBreakoutLevel(this.getBreakoutLevel()),_.setCultivateLevel(this.getCultivateLevel()),_.setStarLevel(this.getStarLevel()),_.setEvolveLevel(u),_.setHeroArtifactLevel(this.getHeroArtifactLevel()),_.setHeroArtifactAdvanceLevel(this.getHeroArtifactAdvanceLevel()),_.setIsSoulLink(!0),_.setSoulLinked(!0),_.setOrderId(this.getOrderId()),_.setDefaultCamp(_._camp);var g=c.default.getInstance().getHeroBySId(o);g&&_.setCamp(g._camp),this._soulLinkHeroModels[r]=_;var f=a.GetTableClass(a.TableEnum.HeroArtifactTable).getDataByArtifactId(this.getArtifactSid());if(f){var v=a.GetTableClass(a.TableEnum.HeroArtifactTable).getArtifactByHeroIdAndQuality(_.getRoleType(),f.quality);_.setArtifactSid(v?v.id:0)}else{_.setArtifactSid(this.getArtifactSid());var m=d.default.getInstance().getArtifactModelByArtifactId(this.getArtifactSid());if(m){var y={heroId:this.getSId(),level:m.getLevel(),advanceLevel:m.getAdvanceLevel()};m.updateData(y)}}}for(r=n;r<this._soulLinkHeroModels.length;r++)this._soulLinkHeroModels[r]=null}},e.prototype.getSoulShowHeroId=function(t,e){if(void 0===t&&(t=!1),void 0===e&&(e=!1),!this._soulList||this._soulList.length<=0)return 0;var i=this.getSId();if(e&&(i=this.getId()),1==this._soulList.length){if(this._battleId==i)return this._soulList[0];if(this._battleId==this._soulList[0])return i}else if(2==this._soulList.length){if(this._battleId==i)return t?this._soulList[1]:this._soulList[0];if(this._battleId==this._soulList[0])return t?i:this._soulList[1];if(this._battleId==this._soulList[1])return t?this._soulList[0]:i}},e.prototype.setCamp=function(t){this._camp=t},e.prototype.getCurCamp=function(){return this._camp},e.prototype.isQualityGold=function(){return 0==this._defaultQuality?7==this._quality:7==this._defaultQuality},e.prototype.setDefaultQuality=function(t){this._defaultQuality=t},e.prototype.setDefaultCamp=function(t){this._defaultCamp=t},e.prototype.isCampConverted=function(){return 0!=this._defaultCamp&&this._defaultCamp!=this._camp},e.prototype.canSoullink=function(){return this._aptitude>2},e}(r);e.exports=h,cc._RF.pop()},{"../../HeroArtifact/Manager/HeroArtifactManager":"HeroArtifactManager","../../Treasure/Model/SpecialAttributeEnum":"SpecialAttributeEnum","../../WonderlandAdventure/Manager/WonderlandManager":"WonderlandManager","../Manager/HeroManager":"HeroManager","./HeroEnum":"HeroEnum",HeroRuneModel:"HeroRuneModel",PropertyModel:"PropertyModel"}],HeroOrdinarySkill:[function(t,e,i){"use strict";cc._RF.push(e,"fa207xOZ/1KpreKSN5CLsd3","HeroOrdinarySkill");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="HeroOrdinarySkill"}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],HeroPvpPreview:[function(t,e,i){"use strict";cc._RF.push(e,"2c186QR961CXYRa3iTa4ipX","HeroPvpPreview");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="HeroPvpPreview",e._tblName="hero_pvp_preview",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];n.report=n.report.replace(/&/g,""),this._data[n.id]=n}},e.prototype.getDataById=function(t){return this._data&&this._data[t]?this._data[t]:null},e.prototype.getDatas=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroRepayActivityController:[function(t,e,i){"use strict";cc._RF.push(e,"3c29bZoAP9JqLFKHxI/FxYS","HeroRepayActivityController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_entityMap:null,_table:null},initData:function(t){this._super(t),this._table=td.GetTableClass(td.TableEnum.HeroRepayTable)},destroyData:function(){this._super()},onActivityOpen:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_ACT_OPEN,this._activityType)},onActivityClose:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_ACT_CLOSE,this._activityType)},getNowOpenGroup:function(){var t=this.getActivityData();return this._table.getGroupByDataId(t)},getActDataId:function(){return this.getActivityData()},activityParse:function(t){if(t.activityId===this._activityId){var e=t.record||{};if(this._entityMap=e.entityMap||{},this._entityMap){var i={activityId:t.activityId,entityMap:this._entityMap};td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_ACT_RECORD,i)}}}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],HeroRepayBaseController:[function(t,e,i){"use strict";cc._RF.push(e,"4052dScZHVAMr/eUUTJGfRi","HeroRepayBaseController"),td.HeroRepayBaseController={init:function(){this.addServerListener()},destroyData:function(){},addServerListener:function(){td.ServerDelegate.registerMessage(td.MsgModuleName.ExtensionCmd,td.MsgCmd.ExtensionCmd.PUSH_ALL_HERO_REPAY_INFO,this.receiveAllInfo.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.ExtensionCmd,td.MsgCmd.ExtensionCmd.PUSH_HERO_REPAY_INFO,this.receivePartInfo.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.ExtensionCmd,td.MsgCmd.ExtensionCmd.GET_HERO_REPAY,this.receiveAllInfo.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.ExtensionCmd,td.MsgCmd.ExtensionCmd.GET_HEROREPAY_REWARD,this.receiveReward.bind(this))},receiveAllInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i={serverData:e,isAll:!0};td.EventUtil.dispatchEvent(td.EventNameEnum.PUSH_HERO_REPAY_INFO,i)}},receivePartInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i={serverData:e,isAll:!1};td.EventUtil.dispatchEvent(td.EventNameEnum.PUSH_HERO_REPAY_INFO,i)}},receiveReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult,!0);td.GlobalFunction.showRewards(i)}}},cc._RF.pop()},{}],HeroRepayController2:[function(t,e,i){"use strict";cc._RF.push(e,"71afeiFjTdN1axclyvaLCwh","HeroRepayController2");var n=t("HeroRepayGroupModel");td.HeroRepayController2={_table:null,_rTable:null,_groupList:null,curGroup:null,curRole:null,init:function(){this._groupList=[],this.addEventListener()},destroyData:function(){},addEventListener:function(){var t={};t[td.EventNameEnum.HEROREPAY_ACT_RECORD]=this.dealActInfo,t[td.EventNameEnum.HEROREPAY_CHANGE_GROUP]=this.onChangeGroup,t[td.EventNameEnum.HEROREPAY_ACT_CLOSE]=this.onActClose,t[td.EventNameEnum.HEROREPAY_ACT_OPEN]=this.onActOpen,t[td.EventNameEnum.HEROREPAY_GET_INFO]=this._requestHeroRepayInfo,t[td.EventNameEnum.PUSH_HERO_REPAY_INFO]=this.dealPushInfo,td.EventUtil.registerEvents(t,this)},getCurGroup:function(){return this.curGroup},getCurRole:function(){return this.curRole},dealActInfo:function(t){this._table||(this._table=td.GetTableClass(td.TableEnum.HeroRepayTable),this._rTable=td.GetTableClass(td.TableEnum.HeroRepayRewardTable));var e=t.activityId,i=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.GodPetsFeedback);if(i&&e==i.getActivityId()){var n=t.entityMap,a=i._activityOpen.getStartTime(),r=i._activityOpen.getCloseTime();if(i.isInOpenStatus())for(var o=i.getNowOpenGroup(),s=0;s<o.length;s++){var l=this.getGroup(a,o[s].groupId);l.setStatus(td.HeroRepayEnum.groupStatus.open),null==l._closeTime&&l.setCloseTime(r)}for(var c in n){var u=n[c],d=this.getGroup(a,c);d.setRoleId(u.roleId),"1"==u.status?d.setStatus(td.HeroRepayEnum.groupStatus.actived):d.setStatus(td.HeroRepayEnum.groupStatus.selected)}td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_REFRESH_UI,td.ActivityEnum.ActivityType.GodPetsFeedback)}},dealPushInfo:function(t){for(var e=t.serverData,i=t.isAll,n=null,a=0,r=e.length;a<r;a++){var o=e[a];if(o.activityType===td.ActivityEnum.ActivityType.GodPetsFeedback){n=o;break}}if(n){var s,l;if(this._table||(this._table=td.GetTableClass(td.TableEnum.HeroRepayTable),this._rTable=td.GetTableClass(td.TableEnum.HeroRepayRewardTable)),this.curGroup&&(s=this.curGroup._openTime,l=this.curGroup._groupId),i)for(var c=this._groupList.length-1;c>=0;c--){var u=this._groupList[c];u._status==td.HeroRepayEnum.groupStatus.actived&&(s&&l&&s==u._openTime&&l==u._groupId&&(this.curGroup=null,this.curRole=null),this._groupList.splice(c,1))}var d=n.repayInfo||{};for(var h in d){var p=d[h];for(var _ in p){var g=p[_],f=this.getGroup(h,_);f.initDataByServer(g),f.setStatus(td.HeroRepayEnum.groupStatus.actived),f.setCloseTime(td.TimeUtil.getTheZeroPointByStamp(g.rewardActivateTime)+864e5*f._days),s&&l&&f._openTime==s&&f._groupId==l&&(this.curGroup=f)}}td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_REFRESH_UI,td.ActivityEnum.ActivityType.GodPetsFeedback)}},onActClose:function(t){if(t===td.ActivityEnum.ActivityType.GodPetsFeedback){var e,i;this.curGroup&&(e=this.curGroup._openTime,i=this.curGroup._groupId);for(var n=td.TimeUtil.getTime(),a=this._groupList.length-1;a>=0;a--){var r=this._groupList[a];r._status!=td.HeroRepayEnum.groupStatus.actived&&n>r._closeTime&&(e&&i&&e==r._openTime&&i==r._groupId&&(this.curGroup=null,this.curRole=null),this._groupList.splice(a,1))}td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_REFRESH_UI,t)}},onActOpen:function(t){if(t===td.ActivityEnum.ActivityType.GodPetsFeedback){var e=td.ActivityDataManager.getActivityControllerByType(t),i=e._activityOpen.getStartTime(),n=e._activityOpen.getCloseTime();if(e.isInOpenStatus())for(var a=e.getNowOpenGroup(),r=0;r<a.length;r++){var o=this.getGroup(i,a[r].groupId);o.setStatus(td.HeroRepayEnum.groupStatus.open),o.setCloseTime(n)}td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_REFRESH_UI,t)}},getGroup:function(t,e){for(var i=null,a=0;a<this._groupList.length;a++){var r=this._groupList[a];if(r._openTime==t&&r._groupId==e){i=r;break}}if(!i){i=new n,this._table||(this._table=td.GetTableClass(td.TableEnum.HeroRepayTable),this._rTable=td.GetTableClass(td.TableEnum.HeroRepayRewardTable));var o=this._table.getDataByGroupId(e);i.initDataByTable(o),i.setOpenTime(t),this._groupList.push(i)}return i},sortGroupList:function(){this._groupList.sort(function(t,e){return t._status!=e._status?t._status-e._status:t._groupId!=e._groupId?t._groupId-e._groupId:e._openTime-t.openTime})},_requestHeroRepayInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.GET_HERO_REPAY,setTimeout(function(){td.ServerDelegate.sendMessage(t)},100)},onChangeGroup:function(t){t.activityType==td.ActivityEnum.ActivityType.GodPetsFeedback&&(this.curGroup=t.groupData,td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_REFRESH_UI,td.ActivityEnum.ActivityType.GodPetsFeedback))},getGroupList:function(){if(this._groupList.length<=0)return this._groupList=[],this.curGroup=null,this.curRole=null,td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_CLOSE_PANEL,td.ActivityEnum.ActivityType.GodPetsFeedback),[];this.sortGroupList();for(var t=0;t<this._groupList.length;t++){var e=this._groupList[t];e.setIdx(t),e.setIsShowRed(this.isShowGroupRedPoint(e))}return this.curGroup||(this.curGroup=this._groupList[0]),this._groupList},setRole:function(t){this.curRole=t},getHeroList:function(){var t=[];this.curRole=null;var e=this.curGroup;if(!e)return t;for(var i=0;i<e._heroGroup.length;i++){var n=e._heroGroup[i],a={_groupId:e._groupId,_roleId:n,_idx:i,_isSelect:!1};a._isSelect=this.isHeroSelect(n),a._isSelect&&(this.curRole=a),t.push(a)}return t},isHeroSelect:function(t){var e=!1;return this.curGroup._roleId&&this.curGroup._roleId==t&&(e=!0),e},getRewardStatus:function(t,e){var i;t._status==td.HeroRepayEnum.groupStatus.actived?i=e>td.TimeUtil.getCrossDay(t._activeTime)+1?td.HeroRepayEnum.RewardState.canNotGet:t._receive&&-1!=t._receive.indexOf(e)?td.HeroRepayEnum.RewardState.Gotten:td.HeroRepayEnum.RewardState.canGet:i=td.HeroRepayEnum.RewardState.canNotGet;return i},getRewardList:function(t){var e=[];if(!(t=t||this.curGroup))return e;for(var i=0;i<t._days;i++){var n=i+1,a=[],r=!1;t._roleId&&(r=!0,a=this._rTable.getReward(t._groupId,t._roleId,n));var o=2,s=this.getRewardStatus(t,n);switch(s){case td.HeroRepayEnum.RewardState.canNotGet:o=2;break;case td.HeroRepayEnum.RewardState.canGet:o=1;break;case td.HeroRepayEnum.RewardState.Gotten:o=3}var l={_groupId:t._groupId,_openTime:t._openTime,_status:s,_rewards:a,_isShow:r,_day:n,_order:o};e.push(l)}return e.sort(function(t,e){return t._order==e._order?t._day-e._day:t._order-e._order}),e},isShow:function(){return this._groupList.length>0},isShowGroupRedPoint:function(t){var e=!1;if(t._status==td.HeroRepayEnum.groupStatus.actived)for(var i=this.getRewardList(t),n=0;n<i.length;n++){if(i[n]._status==td.HeroRepayEnum.RewardState.canGet){e=!0;break}}return e},onOpenPanel:function(){this._isPanelOpened=!0;var t="HeroRepayPanel2",e=new Date(td.TimeUtil.getTime()),i=e.pattern("yyyy-MM-dd");td.LocalStorageUtil.write(t+i,2);var n=(e=new Date(td.TimeUtil.getTime()-864e5)).pattern("yyyy-MM-dd");td.LocalStorageUtil.read(t+n)&&td.LocalStorageUtil.removeItem(t+n),td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_PANEL_SHOW)},isShowEnterRedPoint:function(){for(var t=!1,e=this.getGroupList(),i=0;i<e.length;i++){var n=e[i];if(this.isShowGroupRedPoint(n)){t=!0;break}}if(!t){var a=new Date(td.TimeUtil.getTime()).pattern("yyyy-MM-dd");t=2!=td.LocalStorageUtil.read("HeroRepayPanel2"+a)}return t},enterRedPointEvts:function(){return[td.EventNameEnum.HEROREPAY_GET_INFO,td.EventNameEnum.HEROREPAY_REFRESH_UI,td.EventNameEnum.HEROREPAY_PANEL_SHOW]}},cc._RF.pop()},{HeroRepayGroupModel:"HeroRepayGroupModel"}],HeroRepayController:[function(t,e,i){"use strict";cc._RF.push(e,"83bdbIebUVCNoFv7Tfpyicx","HeroRepayController");var n=t("HeroRepayGroupModel");td.HeroRepayController={_table:null,_rTable:null,_groupList:null,curGroup:null,curRole:null,init:function(){this._groupList=[],this.addEventListener()},destroyData:function(){},addEventListener:function(){var t={};t[td.EventNameEnum.HEROREPAY_ACT_RECORD]=this.dealActInfo,t[td.EventNameEnum.HEROREPAY_CHANGE_GROUP]=this.onChangeGroup,t[td.EventNameEnum.HEROREPAY_ACT_CLOSE]=this.onActClose,t[td.EventNameEnum.HEROREPAY_ACT_OPEN]=this.onActOpen,t[td.EventNameEnum.HEROREPAY_GET_INFO]=this._requestHeroRepayInfo,t[td.EventNameEnum.PUSH_HERO_REPAY_INFO]=this.dealPushInfo,td.EventUtil.registerEvents(t,this)},getCurGroup:function(){return this.curGroup},getCurRole:function(){return this.curRole},dealActInfo:function(t){this._table||(this._table=td.GetTableClass(td.TableEnum.HeroRepayTable),this._rTable=td.GetTableClass(td.TableEnum.HeroRepayRewardTable));var e=t.activityId,i=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.HeroRepay);if(i&&e==i.getActivityId()){var n=t.entityMap,a=i._activityOpen.getStartTime(),r=i._activityOpen.getCloseTime();if(i.isInOpenStatus())for(var o=i.getNowOpenGroup(),s=0;s<o.length;s++){var l=this.getGroup(a,o[s].groupId);l.setStatus(td.HeroRepayEnum.groupStatus.open),null==l._closeTime&&l.setCloseTime(r)}for(var c in n){var u=n[c],d=this.getGroup(a,c);d.setRoleId(u.roleId),"1"==u.status?d.setStatus(td.HeroRepayEnum.groupStatus.actived):d.setStatus(td.HeroRepayEnum.groupStatus.selected)}td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_REFRESH_UI,td.ActivityEnum.ActivityType.HeroRepay)}},dealPushInfo:function(t){for(var e=t.serverData,i=t.isAll,n=null,a=0,r=e.length;a<r;a++){var o=e[a];if(o.activityType===td.ActivityEnum.ActivityType.HeroRepay){n=o;break}}if(n){var s,l;if(this._table||(this._table=td.GetTableClass(td.TableEnum.HeroRepayTable),this._rTable=td.GetTableClass(td.TableEnum.HeroRepayRewardTable)),this.curGroup&&(s=this.curGroup._openTime,l=this.curGroup._groupId),i)for(var c=this._groupList.length-1;c>=0;c--){var u=this._groupList[c];u._status==td.HeroRepayEnum.groupStatus.actived&&(s&&l&&s==u._openTime&&l==u._groupId&&(this.curGroup=null,this.curRole=null),this._groupList.splice(c,1))}var d=n.repayInfo||{};for(var h in d){var p=d[h];for(var _ in p){var g=p[_],f=this.getGroup(h,_);f.initDataByServer(g),f.setStatus(td.HeroRepayEnum.groupStatus.actived),f.setCloseTime(td.TimeUtil.getTheZeroPointByStamp(g.rewardActivateTime)+864e5*f._days),s&&l&&f._openTime==s&&f._groupId==l&&(this.curGroup=f)}}td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_REFRESH_UI,td.ActivityEnum.ActivityType.HeroRepay)}},onActClose:function(t){if(t===td.ActivityEnum.ActivityType.HeroRepay){var e,i;this.curGroup&&(e=this.curGroup._openTime,i=this.curGroup._groupId);for(var n=td.TimeUtil.getTime(),a=this._groupList.length-1;a>=0;a--){var r=this._groupList[a];r._status!=td.HeroRepayEnum.groupStatus.actived&&n>r._closeTime&&(e&&i&&e==r._openTime&&i==r._groupId&&(this.curGroup=null,this.curRole=null),this._groupList.splice(a,1))}td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_REFRESH_UI,t)}},onActOpen:function(t){if(t===td.ActivityEnum.ActivityType.HeroRepay){var e=td.ActivityDataManager.getActivityControllerByType(t),i=e._activityOpen.getStartTime(),n=e._activityOpen.getCloseTime();if(e.isInOpenStatus())for(var a=e.getNowOpenGroup(),r=0;r<a.length;r++){var o=this.getGroup(i,a[r].groupId);o.setStatus(td.HeroRepayEnum.groupStatus.open),o.setCloseTime(n)}td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_REFRESH_UI,t)}},getGroup:function(t,e){for(var i=null,a=0;a<this._groupList.length;a++){var r=this._groupList[a];if(r._openTime==t&&r._groupId==e){i=r;break}}if(!i){i=new n,this._table||(this._table=td.GetTableClass(td.TableEnum.HeroRepayTable),this._rTable=td.GetTableClass(td.TableEnum.HeroRepayRewardTable));var o=this._table.getDataByGroupId(e);i.initDataByTable(o),i.setOpenTime(t),this._groupList.push(i)}return i},sortGroupList:function(){this._groupList.sort(function(t,e){return t._status!=e._status?t._status-e._status:t._groupId!=e._groupId?t._groupId-e._groupId:e._openTime-t.openTime})},_requestHeroRepayInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.GET_HERO_REPAY,td.ServerDelegate.sendMessage(t)},onChangeGroup:function(t){t.activityType==td.ActivityEnum.ActivityType.HeroRepay&&(this.curGroup=t.groupData,td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_REFRESH_UI,td.ActivityEnum.ActivityType.HeroRepay))},getGroupList:function(){if(this._groupList.length<=0)return this._groupList=[],this.curGroup=null,this.curRole=null,td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_CLOSE_PANEL,td.ActivityEnum.ActivityType.HeroRepay),[];this.sortGroupList();for(var t=0;t<this._groupList.length;t++){var e=this._groupList[t];e.setIdx(t),e.setIsShowRed(this.isShowGroupRedPoint(e))}return this.curGroup||(this.curGroup=this._groupList[0]),this._groupList},setRole:function(t){this.curRole=t},getHeroList:function(){var t=[];this.curRole=null;var e=this.curGroup;if(!e)return t;for(var i=0;i<e._heroGroup.length;i++){var n=e._heroGroup[i],a={_groupId:e._groupId,_roleId:n,_idx:i,_isSelect:!1};a._isSelect=this.isHeroSelect(n),a._isSelect&&(this.curRole=a),t.push(a)}return t},isHeroSelect:function(t){var e=!1;return this.curGroup._roleId&&this.curGroup._roleId==t&&(e=!0),e},getRewardStatus:function(t,e){var i;t._status==td.HeroRepayEnum.groupStatus.actived?i=e>td.TimeUtil.getCrossDay(t._activeTime)+1?td.HeroRepayEnum.RewardState.canNotGet:t._receive&&-1!=t._receive.indexOf(e)?td.HeroRepayEnum.RewardState.Gotten:td.HeroRepayEnum.RewardState.canGet:i=td.HeroRepayEnum.RewardState.canNotGet;return i},getRewardList:function(t){var e=[];if(!(t=t||this.curGroup))return e;for(var i=0;i<t._days;i++){var n=i+1,a=[],r=!1;t._roleId&&(r=!0,a=this._rTable.getReward(t._groupId,t._roleId,n));var o=2,s=this.getRewardStatus(t,n);switch(s){case td.HeroRepayEnum.RewardState.canNotGet:o=2;break;case td.HeroRepayEnum.RewardState.canGet:o=1;break;case td.HeroRepayEnum.RewardState.Gotten:o=3}var l={_groupId:t._groupId,_openTime:t._openTime,_status:s,_rewards:a,_isShow:r,_day:n,_order:o};e.push(l)}return e.sort(function(t,e){return t._order==e._order?t._day-e._day:t._order-e._order}),e},isShow:function(){return this._groupList.length>0},isShowGroupRedPoint:function(t){var e=!1;if(t._status==td.HeroRepayEnum.groupStatus.actived)for(var i=this.getRewardList(t),n=0;n<i.length;n++){if(i[n]._status==td.HeroRepayEnum.RewardState.canGet){e=!0;break}}return e},onOpenPanel:function(){this._isPanelOpened=!0;var t="HeroRepayPanel1",e=new Date(td.TimeUtil.getTime()),i=e.pattern("yyyy-MM-dd");td.LocalStorageUtil.write(t+i,1);var n=(e=new Date(td.TimeUtil.getTime()-864e5)).pattern("yyyy-MM-dd");td.LocalStorageUtil.read(t+n)&&td.LocalStorageUtil.removeItem(t+n),td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_PANEL_SHOW)},isShowEnterRedPoint:function(){for(var t=!1,e=this.getGroupList(),i=0;i<e.length;i++){var n=e[i];if(this.isShowGroupRedPoint(n)){t=!0;break}}if(!t){var a=new Date(td.TimeUtil.getTime()).pattern("yyyy-MM-dd");t=1!=td.LocalStorageUtil.read("HeroRepayPanel1"+a)}return t},enterRedPointEvts:function(){return[td.EventNameEnum.HEROREPAY_GET_INFO,td.EventNameEnum.HEROREPAY_REFRESH_UI,td.EventNameEnum.HEROREPAY_PANEL_SHOW,td.EventNameEnum.HEROREPAY_CLOSE_PANEL]}},cc._RF.pop()},{HeroRepayGroupModel:"HeroRepayGroupModel"}],HeroRepayEnum:[function(t,e,i){"use strict";cc._RF.push(e,"7c195LLvw5C5banYLHq+pSK","HeroRepayEnum"),td.HeroRepayEnum={groupStatus:{open:1,selected:2,actived:3},RewardState:{canNotGet:1,canGet:2,Gotten:3}},cc._RF.pop()},{}],HeroRepayGroupItem2:[function(t,e,i){"use strict";cc._RF.push(e,"ba07dMD9WNPE5LuaHt/xOVn","HeroRepayGroupItem2");var n=t("HeroRepayGroupItem"),a=cc.Class({extends:n,properties:{},getCurGroupData:function(){return td.HeroRepayController2.getCurGroup()},setHeadImg:function(t,e){var i="HD_jrsd_tb"+e;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_56_schk,i,t)},doChangeGroupData:function(t){var e={activityType:td.ActivityEnum.ActivityType.GodPetsFeedback,groupData:t};td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_CHANGE_GROUP,e)},setItemBtn:function(t,e){var i=this.node.getComponent(cc.Button);i.clickEvents=[];var n=new cc.Component.EventHandler;n.target=this.node,n.component="HeroRepayGroupItem2",n.handler="onOperateItem",n.customEventData=e,i.clickEvents.push(n)}});e.exports=a,cc._RF.pop()},{HeroRepayGroupItem:"HeroRepayGroupItem"}],HeroRepayGroupItem:[function(t,e,i){"use strict";cc._RF.push(e,"7430aNjIoxGD68FyvmSZ7lM","HeroRepayGroupItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{},updateItem:function(t,e){this._super(t,e);var i=this.node.getChildByName("imgNotKnow"),n=this.node.getChildByName("imgHeroHead"),a=this.node.getChildByName("imgRedPoint"),r=this.node.getChildByName("imgSelect"),o=this.getCurGroupData();i.active=e._status==td.HeroRepayEnum.groupStatus.open,n.active=e._status!=td.HeroRepayEnum.groupStatus.open,a.active=e._isShowRed,r.active=e._openTime==o._openTime&&e._groupId==o._groupId,e._status!=td.HeroRepayEnum.groupStatus.open&&this.setHeadImg(n,e._roleId),this.setItemBtn(t,e)},setHeadImg:function(t,e){var i="HD_yingxiong"+e;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_50_yxhk,i,t)},onOperateItem:function(t,e){var i=this.getCurGroupData();e._openTime==i._openTime&&e._groupId==i._groupId||this.doChangeGroupData(e)},doChangeGroupData:function(t){var e={activityType:td.ActivityEnum.ActivityType.HeroRepay,groupData:t};td.EventUtil.dispatchEvent(td.EventNameEnum.HEROREPAY_CHANGE_GROUP,e)},setItemBtn:function(t,e){var i=this.node.getComponent(cc.Button);i.clickEvents=[];var n=new cc.Component.EventHandler;n.target=this.node,n.component="HeroRepayGroupItem",n.handler="onOperateItem",n.customEventData=e,i.clickEvents.push(n)},getCurGroupData:function(){return td.HeroRepayController.getCurGroup()}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],HeroRepayGroupModel:[function(t,e,i){"use strict";cc._RF.push(e,"68eb9GBILdCmoxWuLgxYWDm","HeroRepayGroupModel");var n=cc.Class({properties:{_dataId:null,_chargeId:null,_days:null,_heroGroup:null,_originPrice:null,_roleId:null,_activeTime:null,_receive:null,_groupId:null,_openTime:null,_idx:null,_closeTime:null,_status:null,_isShowRed:null},initDataByTable:function(t){this._dataId=t.data,this._chargeId=t.chargeId,this._groupId=t.groupId,this._heroGroup=t.heroGroup,this._days=t.days,this._originPrice=t.originalPrice,this._status=td.HeroRepayEnum.groupStatus.open},initDataByServer:function(t){this._groupId=t.groupId,this._roleId=t.roleId,this._openTime=t.activityOpenTime,this._receive=t.receive,this._activeTime=t.rewardActivateTime},setStatus:function(t){this._status=t},setCloseTime:function(t){this._closeTime=t},setReceive:function(t){this._receive=t},setOpenTime:function(t){this._openTime=t},setIdx:function(t){this._idx=t},setIsShowRed:function(t){this._isShowRed=t},setRoleId:function(t){this._roleId=t},setData:function(t,e){this[t]=e},getData:function(t){return this[t]}});e.exports=n,cc._RF.pop()},{}],HeroRepayHeroItem2:[function(t,e,i){"use strict";cc._RF.push(e,"9427cK0F4JOi5pI6IxfEY8T","HeroRepayHeroItem2");var n=t("HeroRepayHeroItem"),a=cc.Class({extends:n,properties:{},getCurGroupData:function(){return td.HeroRepayController2.getCurGroup()},getCurRole:function(){return td.HeroRepayController2.getCurRole()},getShowData:function(t){var e=[[td.RewardType.Pet,t._roleId,0]];return td.RewardManager.parseRewardListDetail(e)[0]},onChangeHero:function(t){var e=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.GodPetsFeedback);e&&e.operateActivity(t)},setItemBtn:function(t,e){var i=this.node.getComponent(cc.Button);i.clickEvents=[];var n=new cc.Component.EventHandler;n.target=this.node,n.component="HeroRepayHeroItem2",n.handler="onOperateItem",n.customEventData=e,i.clickEvents.push(n)}});e.exports=a,cc._RF.pop()},{HeroRepayHeroItem:"HeroRepayHeroItem"}],HeroRepayHeroItem:[function(t,e,i){"use strict";cc._RF.push(e,"d2b7aFZ1AlL+50cNXu1L/FV","HeroRepayHeroItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{},updateItem:function(t,e){this._super(t,e);var i=this.getShowData(e),n=td.GlobalFunction.createCommonIconWidget(2,i);n.setScale(.8);var a=n.getComponent("CommonIconWidget");a&&a.disableHeadTouch(),this.node.getChildByName("nodeHeroHead").addChild(n),this.node.getChildByName("nodeHeroHead").z=0;var r=this.node.getChildByName("imgSelect"),o=this.node.getChildByName("imgMengceng");r.active=e._isSelect,o.active=e._isSelect,this.setItemBtn(t,e)},getShowData:function(t){var e=[[td.RewardType.Mercenary,t._roleId,0]];return td.RewardManager.parseRewardListDetail(e)[0]},onOperateItem:function(t,e){var i=this.getCurRole();if(!e||!i||e._roleId!=i._roleId)if(this.getCurGroupData()._status!=td.HeroRepayEnum.groupStatus.actived){var n={id:e._groupId,parmeterMap:{49:e._roleId}};this.onChangeHero(n)}else{var a=new td.BroadcastContent(449);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a)}},onChangeHero:function(t){var e=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.HeroRepay);e&&e.operateActivity(t)},getCurGroupData:function(){return td.HeroRepayController.getCurGroup()},getCurRole:function(){return td.HeroRepayController.getCurRole()},setItemBtn:function(t,e){var i=this.node.getComponent(cc.Button);i.clickEvents=[];var n=new cc.Component.EventHandler;n.target=this.node,n.component="HeroRepayHeroItem",n.handler="onOperateItem",n.customEventData=e,i.clickEvents.push(n)}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],HeroRepayPanel2:[function(t,e,i){"use strict";cc._RF.push(e,"071fcpveu9DJYGvv8G0qvTI","HeroRepayPanel2");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../Pet/Model/PetModel"));var a=t("HeroRepayPanel"),r=cc.Class({extends:a,properties:{},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_GodPetsFeedback},addEventListener:function(){this._super()},closePanel:function(t){t===td.ActivityEnum.ActivityType.GodPetsFeedback&&this.closeCallFunc()},updateViewInfo:function(t){t===td.ActivityEnum.ActivityType.GodPetsFeedback&&this.refreshUI()},setDescription:function(t){this.node.getChildByName("labDesc").getComponent(cc.Label).string=cc.js.formatStr(td.Language.godPetRepayActiveDesc,t._days)},setFigureShow:function(t,e){var i=new n.default;i.init(td.GetTableClass(td.TableEnum.PetTable).getPetById(e._roleId)),td.GlobalFunction.showMercenaryFigureAnimation(t,i,!0)},getActivityController:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.GodPetsFeedback);return t&&t.isInOpenStatus()?t:null},getController:function(){return td.HeroRepayController2},onGetRepayClick:function(){var t=this.getController();if(td.TimeUtil.getTime()>t.getCurGroup()._closeTime)return td.GlobalFunction.showBroadcastTip(507),void this.refreshUI();var e={},i=t.getCurRole(),a=new n.default;a.init(td.GetTableClass(td.TableEnum.PetTable).getPetById(i._roleId));var r=td.QualityColorStrs[a.getQuality()],o=cc.js.formatStr(td.Language.GodPetRepayBuyConfirm,r,a.getName());e.strArray=[o],e.okCallFunc=this.gotoRecharge.bind(this),e.strBtnYes=td.Language.confirm,e.strBtnNo=td.Language.cancel,td.GlobalFunction.showConfirmWindow(e)}});e.exports=r,cc._RF.pop()},{"../Pet/Model/PetModel":"PetModel",HeroRepayPanel:"HeroRepayPanel"}],HeroRepayPanel:[function(t,e,i){"use strict";cc._RF.push(e,"e8b82gO8b9PpaVkwu7P33X8","HeroRepayPanel");var n=t("PanelBase"),a=t("../../TS/Hero/Model/HeroModel"),r=cc.Class({extends:n,properties:{_listHero:null,_listReward:null,_listGroup:null,_labTime:null},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_HeroRepay},onEnable:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_MAIN_LAYER_BOTTOM_LAYER),this.getController().onOpenPanel();var t=this.node.getChildByName("scroHero");this._listHero=t.getComponent("OptimizeVerticalListView");var e=this.node.getChildByName("scroReward");this._listReward=e.getComponent("OptimizeHorizontalListView");var i=this.node.getChildByName("scroGroup");this._listGroup=i.getComponent("OptimizeHorizontalListView"),this._labTime=this.node.getChildByName("labTime"),this.addServerListener(),this.addEventListener(),this.initData(),this.refreshUI()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this.unschedule(this.updateTime),this.node.getChildByName("nodeHeroShow").getChildByName("nodeHeroAnim").removeAllChildren(!0),this._super()},addServerListener:function(){},addEventListener:function(){var t={};t[td.EventNameEnum.HEROREPAY_REFRESH_UI]=this.updateViewInfo,t[td.EventNameEnum.HEROREPAY_CLOSE_PANEL]=this.closePanel,td.EventUtil.registerEvents(t,this)},getController:function(){return td.HeroRepayController},getActivityController:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.HeroRepay);return t&&t.isInOpenStatus()?t:null},initData:function(){this._timer=null,this.updateTime(),this.schedule(this.updateTime,1)},updateViewInfo:function(t){t===td.ActivityEnum.ActivityType.HeroRepay&&this.refreshUI()},refreshUI:function(){this._timer=null,this.refreshGroupUI(),this.refreshHeroUI(),this.refreshRewardUI(),this.refreshHeroShow(),this.refreshCenterUI()},updateTime:function(){if(!(this._timer&&this._timer<=0)){var t,e=this.getController().getCurGroup();e&&(this._timer=e._closeTime-td.TimeUtil.getTime(),e._status==td.HeroRepayEnum.groupStatus.actived?this._timeDesc=cc.js.formatStr(td.Language.leftTime,""):this._timeDesc=td.Language.activityTime+":",this._timer=Math.max(this._timer,0),t=td.GlobalFunction.getTimeStringByDeltaTime(this._timer),this._labTime.getComponent(cc.Label).string=this._timeDesc+t)}},closePanel:function(t){t===td.ActivityEnum.ActivityType.HeroRepay&&this.closeCallFunc()},refreshGroupUI:function(){var t=this.getController(),e=t.getGroupList();if(!(e.length<=0)){this._listGroup.setData(e);var i=t.getCurGroup();this._listGroup.scrollToRow(i._idx)}},refreshHeroUI:function(){var t=this.getController(),e=t.getHeroList();if(!(e.length<=0)){this._listHero.setData(e);var i=t.curRole?t.curRole._idx:0;this._listHero.scrollToRow(i)}},refreshCenterUI:function(){var t=this.getController().getCurGroup();if(t){var e=this.node.getChildByName("labOrigin");e.active=t._status==td.HeroRepayEnum.groupStatus.selected,e.getComponent(cc.Label).string=cc.js.formatStr(td.Language.carnivalChargeText,t._originPrice),this.node.getChildByName("imgRedLine").active=t._status==td.HeroRepayEnum.groupStatus.selected;var i=this.node.getChildByName("labCurrent");if(td.HeroRepayEnum.groupStatus.selected&&t._chargeId){var n=td.RechargeManager.getRechargeDataById(t._chargeId)._costValue/10,a=cc.js.formatStr(td.Language.DiscountPrice,n.toString());i.getComponent(cc.Label).string=cc.js.formatStr(td.Language.rechargeCount,a)}i.active=t._status==td.HeroRepayEnum.groupStatus.selected,this.node.getChildByName("btnGet").active=t._status==td.HeroRepayEnum.groupStatus.selected,this.node.getChildByName("labHadGet").active=t._status==td.HeroRepayEnum.groupStatus.actived,this.setDescription(t)}},setDescription:function(t){this.node.getChildByName("labDesc").getComponent(cc.Label).string=cc.js.formatStr(td.Language.heroRepayActiveDesc,t._days)},refreshRewardUI:function(){var t=this.getController().getRewardList();t.length<=0||this._listReward.setData(t)},refreshHeroShow:function(){var t=this.getController(),e=this.node.getChildByName("nodeHeroShow"),i=e.getChildByName("imgNotKnow"),n=t.curRole;i.active=!n;var a=e.getChildByName("nodeHeroAnim");a.removeAllChildren(!0),n&&this.setFigureShow(a,n)},setFigureShow:function(t,e){var i=new a;i.init(td.GetTableClass(td.TableEnum.HeroTable).getHeroById(e._roleId)),td.GlobalFunction.showMercenaryFigureAnimation(t,i,!0)},onGetRepayClick:function(){var t=this.getController();if(td.TimeUtil.getTime()>t.getCurGroup()._closeTime)return td.GlobalFunction.showBroadcastTip(507),void this.refreshUI();var e={},i=new a;i.init(td.GetTableClass(td.TableEnum.HeroTable).getHeroById(t.curRole._roleId));var n=td.QualityColorStrs[i.getQuality()],r=cc.js.formatStr(td.Language.heroRepayBuyConfirm,n,i.getName());e.strArray=[r],e.okCallFunc=this.gotoRecharge.bind(this),e.strBtnYes=td.Language.confirm,e.strBtnNo=td.Language.cancel,td.GlobalFunction.showConfirmWindow(e)},gotoRecharge:function(){var t=this.getController().getCurGroup(),e=td.RechargeManager.getRechargeDataById(t._chargeId);e&&td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,e)},btnClose:function(){this.closeCallFunc()}});e.exports=r,cc._RF.pop()},{"../../TS/Hero/Model/HeroModel":"HeroModel",PanelBase:void 0}],HeroRepayRewardItem2:[function(t,e,i){"use strict";cc._RF.push(e,"b0a4dsqbkdLTrS73aEHjikP","HeroRepayRewardItem2");var n=t("HeroRepayRewardItem"),a=cc.Class({extends:n,properties:{},onOperateItem:function(t,e){var i={module:td.MsgModuleName.ExtensionCmd,cmd:td.MsgCmd.ExtensionCmd.GET_HEROREPAY_REWARD,openTime:e._openTime,groupId:e._groupId,day:e._day,activityType:td.ActivityEnum.ActivityType.GodPetsFeedback};td.ServerDelegate.sendMessage(i)},setItemBtn:function(t,e){var i=t.getComponent(cc.Button);i.clickEvents=[];var n=new cc.Component.EventHandler;n.target=this.node,n.component="HeroRepayRewardItem2",n.handler="onOperateItem",n.customEventData=e,i.clickEvents.push(n)}});e.exports=a,cc._RF.pop()},{HeroRepayRewardItem:"HeroRepayRewardItem"}],HeroRepayRewardItem:[function(t,e,i){"use strict";cc._RF.push(e,"d27e3BN0dpOdo1UUoqf6l81","HeroRepayRewardItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{},updateItem:function(t,e){e._isShow||(e._isShow=!1,e._status=td.HeroRepayEnum.RewardState.canNotGet),this._super(t,e);for(var i=0;i<2;i++){var n=this.node.getChildByName("nodeReward"+(i+1).toString());if(n.getChildByName("nodeNotShow").active=!e._isShow,n.getChildByName("nodeReward").active=e._isShow,e._isShow){var a=td.RewardManager.parseRewardListDetail(e._rewards)[i],r=td.GlobalFunction.createCommonIconWidget(26,a);r.setScale(.7);var o=r.getComponent("CommonIconWidget");o&&o.setNum(e._rewards[2],!0),n.getChildByName("nodeReward").addChild(r)}}this.node.getChildByName("labDay").getComponent(cc.Label).string=cc.js.formatStr(td.Language.dayTitle,e._day.toString());var s=this.node.getChildByName("btnReceive"),l=this.node.getChildByName("imgReceived"),c=this.node.getChildByName("imgNotReach");s.active=e._status==td.HeroRepayEnum.RewardState.canGet,l.active=e._status==td.HeroRepayEnum.RewardState.Gotten,c.active=e._status==td.HeroRepayEnum.RewardState.canNotGet,this.setItemBtn(s,e)},onOperateItem:function(t,e){var i={module:td.MsgModuleName.ExtensionCmd,cmd:td.MsgCmd.ExtensionCmd.GET_HEROREPAY_REWARD,openTime:e._openTime,groupId:e._groupId,day:e._day,activityType:td.ActivityEnum.ActivityType.HeroRepay};td.ServerDelegate.sendMessage(i)},setItemBtn:function(t,e){var i=t.getComponent(cc.Button);i.clickEvents=[];var n=new cc.Component.EventHandler;n.target=this.node,n.component="HeroRepayRewardItem",n.handler="onOperateItem",n.customEventData=e,i.clickEvents.push(n)}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],HeroRepayRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"1fcf0rl1pJGQZ+1xICXhGu1","HeroRepayRewardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HeroRepayRewardTable",properties:{_tblName:"hero_repay_reward_config",_dataMap:null},init:function(){this._dataMap={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._dataMap[e.groupId]||(this._dataMap[e.groupId]={}),this._dataMap[e.groupId][e.roleId]=e.rewards}},getData:function(){return this._dataMap},getReward:function(t,e,i){return this._dataMap[t][e][i-1][1]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroRepayTable:[function(t,e,i){"use strict";cc._RF.push(e,"b8377Nl2slMeIpjeollBMxN","HeroRepayTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HeroRepayTable",properties:{_tblName:"activity_hero_repay_config",_dataMap:null},init:function(){for(var t in this._dataMap={},this._datas=this._jsonData,this._jsonData){var e=this._jsonData[t];this._dataMap[e.data]||(this._dataMap[e.data]={}),this._dataMap[e.data][e.groupId]=e}},getGroupByDataId:function(t){var e=[];this._dataMap[t]||(this._dataMap[t]={});var i=this._dataMap[t];for(var n in i){var a=this._dataMap[t][n];e.push(a)}return e},getDataByGroupId:function(t){var e={};for(var i in this._datas){var n=this._datas[i];if(n.groupId==t){e=n;break}}return e},getHeroList:function(t){for(var e=[],i=0;i<this._datas.length;i++){var n=this._datas[i];if(n.groupId==t){e=n.heroGroup;break}}return e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroRuneModel:[function(t,e,i){"use strict";cc._RF.push(e,"210a2XPkRNBeaBD8niZbewW","HeroRuneModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._goodsType=0,e._des="",e._heroId=0,e._count=1,e}return n(e,t),e.prototype.init=function(e){e&&(t.prototype.init.call(this,"HeroRuneModel",td.UserPropertyEnum.HeroRune,e.id,e.name,e.icon,null,e.animationType),this._goodsType=td.GoodsType.Type_HeroRune,this._quality=e.quality,this._attributes=e.attributes,this._des=e.des,this._obtainWay=e.obtain,this._count=1)},e.prototype.getDes=function(){return this._des},e.prototype.getGoodsType=function(){return this._goodsType},e.prototype.getQuality=function(){return this._quality},e.prototype.getAttr=function(){return this._attributes},e.prototype.setCount=function(t){this._count=t},e.prototype.getCount=function(){return this._count},e.prototype.getObtainWay=function(){return this._obtainWay||[]},e.prototype.setHeroId=function(t){this._heroId=t},e.prototype.getHeroId=function(){return this._heroId},e.prototype.getSortRank=function(){return this._id},e.prototype.showRedPoint=function(){return!1},e}(t("PropertyModel"));e.exports=a,cc._RF.pop()},{PropertyModel:"PropertyModel"}],HeroRuneTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"bccd2RUjFNBuYL1sCRtiyVK","HeroRuneTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="HeroRuneConfig",e._tblName="hero_rune_config",e._data={},e}n(e,t);var i=e.prototype;return i.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i)t[e[i].id]=e[i]},i.getHeroRuneData=function(){return this._data},i.getHeroRuneById=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroStarUpTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"bfc24qxmshKl7sekd7UeDAL","HeroStarUpTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="HeroStarConfig",e._tblName="hero_star_config",e._data={},e}n(e,t);var i=e.prototype;return i.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.roleType;t[r]||(t[r]={}),t[r][a.starLevel]=a}},i.getDataByIdAndLevel=function(t,e){if(this._data[t]){var i=this._data[t];if(i[e])return i[e]}return null},i.getMaxLevelById=function(t){return this._data[t]?this._data[t].myLen():0},i.getNextShowTipsData=function(t,e){if(this._data[t])for(var i=this._data[t],n=e,a=i.myLen();n<a;n++)if(i[n]&&i[n].showTips[0].length>0&&n>e)return i[n];return null},i.getHeroAllStarCfs=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HeroTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"5ce8bgaP35FS58vYkFErGTf","HeroTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="HeroTable",e._tblName="hero_config",e._data={},e}n(e,t);var i=e.prototype;return i.init=function(){this._data={},this._roleTypeData={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.roleId,o=a.roleType;a.headImg&&(a.headImg="Hero"+a.headImg),a.spriteAnimationRes="hero/hero_"+o+"/hero_"+o,a.pveIdleRes="hero/hero_"+o+"/pve/PVE_hero_"+o,a.pveAttack="hero/hero_"+o+"/pve/hero_"+o+"_1",a.pvpIdleRes="hero/hero_"+o+"/pvp/PVP_hero_"+o,a.animationOffset?a.animationOffset={x:a.animationOffset[0],y:a.animationOffset[1]}:a.animationOffset={x:0,y:0},t[r]=a}},i.getHeroData=function(){return this._data},i.getHeroById=function(t){return this._data[t]},i.getFirstHeroByRoleType=function(t){for(var e in this._data){var i=this._data[e];if(i.roleType==t)return i}return null},i.getHerosByRoleType=function(t){var e=[];for(var i in this._data){var n=this._data[i];if(n.roleType==t){if(n.roleId<=1004)continue;e.push(n)}}return e},i.getHeroByFragmentId=function(t){for(var e in this._data){var i=this._data[e];if(i.fragmentId==t)return i}return null},i.getHeroByRoleTypeAndId=function(t,e){for(var i in this._data){var n=this._data[i];if(n.roleType==t&&n.roleId==e)return n}},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HitEggBaseController:[function(t,e,i){"use strict";cc._RF.push(e,"6cc56uzbPZAipHJFoVchkJk","HitEggBaseController");var n=t("ActivityBaseController"),a=t("HitEggModel"),r=t("HammerRechargeModel"),o=cc.Class({extends:n,properties:{_hitTimes:null,_curHammerCount:null,_eggDataList:null,_curTotalRecharge:null,_rechargeDataList:null},initData:function(t){this._super(t),this._hitTimes=0,this._curHammerCount=0,this._eggDataList=[],this._curTotalRecharge=0,this._rechargeDataList=[]},destroyData:function(){this._hitTimes=null,this._curHammerCount=null,this._eggDataList=null,this._curTotalRecharge=null,this._rechargeDataList=null},getEggDataList:function(){return this._eggDataList},getRechargeDataList:function(){return this._rechargeDataList},getLeftHitTimes:function(){return 10-this._hitTimes},getCurHammerCount:function(){return this._curHammerCount},getTotalRecharge:function(){return this._curTotalRecharge},_initCfgData:function(){this._eggDataList=[];var t=this.getActivityData(),e=td.GetTableClass(td.TableEnum.HitGoldenEggTable).getDataByDataId(t);for(var i in e){if(o=e[i]){var n=new a;n.initData(o),this._eggDataList.push(n)}}for(var i in this._eggDataList.sort(function(t,e){return t.getPosId()-e.getPosId()}),this._rechargeDataList=[],e=td.GetTableClass(td.TableEnum.HitGoldenEggRechargeTable).getDataByDataId(t)){var o;if(o=e[i]){var s=new r;s.initData(o),this._rechargeDataList.push(s)}}this._rechargeDataList.sort(function(t,e){return t.getRechargeNum()-e.getRechargeNum()})},activityParse:function(t){0==this._eggDataList.length&&this._initCfgData(),this._activityId=t.activityId;var e=t.record;this._curTotalRecharge=e.charge,this._hitTimes=e.eggFrenzyTime,this._curHammerCount=e.hammerNum;for(var i=e.eggPoints,n=e.getRewards,a=0,r=i.length;a<r;a++){var o=i[a];this._eggDataList.forEach(function(t){var e=t.getPosId();o==e&&t.setHitStatus(!0)})}for(a=0,r=n.length;a<r;a++){o=n[a];this._eggDataList.forEach(function(t){var e=t.getPosId();o==e&&t.setRewardStatus(!0)})}var s=e.chargeRewards;for(a=0,r=s.length;a<r;a++){var l=s[a];this._rechargeDataList.forEach(function(t){var e=t.getRechargeNum();l==e&&t.setRewardStatus(!0)})}},isGetHammerTip:function(){for(var t=!1,e=0,i=this._rechargeDataList.length;e<i;e++){var n=this._rechargeDataList[e],a=n.getRewardStatus(),r=n.getRechargeNum();if(!a&&r<=this._curTotalRecharge){t=!0;break}}return t},hasRedPoint:function(){return!0},isRedPointTip:function(){var t=this.getLeftHitTimes(),e=this.getCurHammerCount();return t>0&&e>0},redPointEvts:function(){return[td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,td.EventNameEnum.PUSH_ACTIVITY_INFO,td.EventNameEnum.Res_GET_ACTIVITY_INFO]}});e.exports=o,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",HammerRechargeModel:"HammerRechargeModel",HitEggModel:"HitEggModel"}],HitEggBasePanel:[function(t,e,i){"use strict";cc._RF.push(e,"b8c98kqwjNNgbRQ2fnb8NtK","HitEggBasePanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{_isHitOperate:null,_effectNode:null,_resAtlas:null,_curRewardList:null},onLoad:function(){this._effectNode=this.node.getChildByName("effectNode"),this._effectNode.active=!1,this._isHitOperate=!1,this._curRewardList=null,this._resAtlas=gdk.rm.getResByUrl("UI/Activity/HD_ZaJinDan",cc.SpriteAtlas),this._addButtonRedPoint()},_addEventListener:function(){var t={};t[td.EventNameEnum.Res_GET_ACTIVITY_INFO]=this._resInfo,td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},_addButtonRedPoint:function(){var t=cc.find("infoPanel/btnGetHammer",this.node),e=this._controller.isGetHammerTip.bind(this._controller),i={tipEvents:this._controller.redPointEvts(),checkFunc:e,offset:cc.v2(-5,-5)};td.RedPointUtil.createRedPoint(t,i)},onEnable:function(){this._super(),this._addEventListener(),this._isHitOperate=!1,this.setView()},onDisable:function(){this._super(),this._removeAllListeners(),this._effectNode&&(this._effectNode.stopAllActions(),this._effectNode.active=!1),this._curRewardList&&(td.GlobalFunction.showRewards(this._curRewardList,!1),this._curRewardList=null)},setView:function(){this._setActivityTime(),this._setRewardTipWord(),this.refreshEggsInfoPanel()},_resInfo:function(t){t===this.getActivityId()&&this.refreshView()},refreshView:function(){this._isHitOperate||this.refreshEggsInfoPanel()},_setActivityTime:function(){var t=this.getDurationStr2();cc.find("titleWidget/labActivityTime",this.node).getComponent(cc.Label).string=t},_setRewardTipWord:function(){},refreshEggsInfoPanel:function(){this._isHitOperate=!1,this._curRewardList&&(this._curRewardList=null),this._setLeftTimes(),this._setEggsAndRewardPanel(),this._setHammerCount()},_setLeftTimes:function(){var t=this._controller.getLeftHitTimes();cc.find("infoPanel/labLeftTimes",this.node).getComponent(cc.Label).string=t},_setEggsAndRewardPanel:function(){for(var t=this.node.getChildByName("infoPanel"),e=t.getChildByName("rewardPanel"),i=this._controller.getEggDataList(),n=(e.height-247.5)/3,a=(e.width-540)/6,r=gdk.rm.getResByUrl(td.resDef.pngPlist.Meishuzi,cc.SpriteAtlas),o=0,s=i.length;o<s;o++){var l=i[o],c=l.getPosId();if(!(c<1||c>10)){var u=t.getChildByName("egg_"+c),d=l.getReward(),h=l.getRewardStatus();this._setEggTecture(u,l);var p=Math.ceil(c/5),_=c%5;_=0===_?5:_;var g=e.getChildByName("reward"+c);if(g){var f=g.getComponent("CommonIconWidget");f.setType(26),f.setData(d)}else(g=td.GlobalFunction.createCommonIconWidget(26,d)).name="reward"+c,g.scale=.75,g.x=a+54+(108+a)*(_-1),g.y=0-(n+61.875+(123.75+n)*(p-1)),e.addChild(g);var v=g.getChildByName("imgReceived");h?v?v.active=!0:((v=new cc.Node).name="imgReceived",v.addComponent(cc.Sprite).spriteFrame=r.getSpriteFrame("MSZ_yilingqu"),g.addChild(v)):v&&(v.active=!1)}}},_setEggTecture:function(t,e){},_setHammerCount:function(){var t=this._controller.getCurHammerCount();cc.find("infoPanel/labHammerNum",this.node).getComponent(cc.Label).string=t},requestHitEgg:function(t,e){if(this._controller.getCurHammerCount()<=0){var i=td.Language.noHammerTip;td.MessageBox.showMessage(i)}else if(!this._isHitOperate){this._isHitOperate=!0;var n={id:e.getPosId(),parmeterMap:{5:2}};this._controller.operateActivity(n)}},gotoGetHammer:function(){var t=this._activityId;td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_HitGoldenEggRecharge,t)},onReceiveOperation:function(t){if(this._isHitOperate){if(t.activityId!==this._activityId)return;var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);this._curRewardList=i;var n={rewardList:i,refreshViewCall:this.refreshEggsInfoPanel.bind(this)};this._effectNode&&(this._effectNode.active=!0,this._effectNode.getComponent("HitEggEffectFrameEvent").setData(n))}else this._super(t)}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],HitEggEffectFrameEvent:[function(t,e,i){"use strict";cc._RF.push(e,"510e3NTFPlNg5eqDPbahzID","HitEggEffectFrameEvent");var n=cc.Class({extends:cc.Component,properties:{_rewards:null,_refreshCall:null},setData:function(t){this._rewards=t.rewardList,this._refreshCall=t.refreshViewCall,this.node.getComponent(cc.Animation).play("JinDan_Effect")},showRewards:function(){this._refreshCall&&"function"==typeof this._refreshCall&&this._refreshCall(),td.GlobalFunction.showRewards(this._rewards,!1)}});e.exports=n,cc._RF.pop()},{}],HitEggModel:[function(t,e,i){"use strict";cc._RF.push(e,"10746ld2E1M7YMkPEkm6qo8","HitEggModel");var n=cc.Class({properties:{_dataId:null,_posId:null,_reward:null,_isHit:null,_isGot:null},initData:function(t){t&&(this._dataId=t.data,this._posId=t.pointId,this._reward=td.RewardManager.parseRewardListDetail(t.reward),this._isHit=!1,this._isGot=!1)},getDataId:function(){return this._dataId},getPosId:function(){return this._posId},getReward:function(){return this._reward[0]},setHitStatus:function(t){this._isHit=t},getHitStatus:function(){return this._isHit},setRewardStatus:function(t){this._isGot=t},getRewardStatus:function(){return this._isGot}});e.exports=n,cc._RF.pop()},{}],HitGoldenEggController:[function(t,e,i){"use strict";cc._RF.push(e,"e40ceEGHPdMvLp6OxsOMzyf","HitGoldenEggController");var n=t("HitEggBaseController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{HitEggBaseController:"HitEggBaseController"}],HitGoldenEggPanel:[function(t,e,i){"use strict";cc._RF.push(e,"70986bVltxFz5Go3GGLbB+a","HitGoldenEggPanel");var n=t("HitEggBasePanel"),a=cc.Class({extends:n,properties:{},onLoad:function(){this._super();var t=cc.find("infoPanel/btnGetHammer",this.node).getComponent(cc.Button);t.clickEvents=[];var e=td.GlobalFunction.createClickEventHandler(this.node,"HitGoldenEggPanel","gotoGetHammer",null);t.clickEvents.push(e)},_setRewardTipWord:function(){cc.find("infoPanel/imgEggWord",this.node).getComponent(cc.Sprite).spriteFrame=this._resAtlas.getSpriteFrame("hd_zjd_wenzi_04")},_setEggTecture:function(t,e){var i=e.getHitStatus(),n=i?"hd_zjd_jindan_02":"hd_zjd_jindan_01";t.getComponent(cc.Sprite).spriteFrame=this._resAtlas.getSpriteFrame(n);var a=t.getComponent(cc.Button);if(a.clickEvents=[],!i){var r=td.GlobalFunction.createClickEventHandler(this.node,"HitGoldenEggPanel","requestHitEgg",e);a.clickEvents.push(r)}}});e.exports=a,cc._RF.pop()},{HitEggBasePanel:"HitEggBasePanel"}],HitGoldenEggRechargeTable:[function(t,e,i){"use strict";cc._RF.push(e,"284e5eSCUlKf4RMPAoPvlGE","HitGoldenEggRechargeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HitGoldenEggRechargeTable",properties:{_tblName:"activity_75_recharge_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data,o=a.charge;t[r]=t[r]||{},t[r][o]=a}},getDataByDataId:function(t){return this._data&&this._data[t]?this._data[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HitGoldenEggTable:[function(t,e,i){"use strict";cc._RF.push(e,"42fc6+NJaZNjon52YuU5AO3","HitGoldenEggTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HitGoldenEggTable",properties:{_tblName:"activity_75_point_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data,o=a.pointId;t[r]=t[r]||{},t[r][o]=a}},getDataByDataId:function(t){return this._data&&this._data[t]?this._data[t]:null},getDataByDataIdAndPos:function(t,e){return this._data&&this._data[t]&&this._data[t][e]?this._data[t][e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HitSilverEggController:[function(t,e,i){"use strict";cc._RF.push(e,"3f2a49kvY5HgagWtGPBNKd4","HitSilverEggController");var n=t("HitEggBaseController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{HitEggBaseController:"HitEggBaseController"}],HitSilverEggPanel:[function(t,e,i){"use strict";cc._RF.push(e,"d16b8j9cjlNjL0Ri9TYBFd4","HitSilverEggPanel");var n=t("HitEggBasePanel"),a=cc.Class({extends:n,properties:{},onLoad:function(){this._super();var t=cc.find("infoPanel/btnGetHammer",this.node).getComponent(cc.Button);t.clickEvents=[];var e=td.GlobalFunction.createClickEventHandler(this.node,"HitSilverEggPanel","gotoGetHammer",null);t.clickEvents.push(e)},_setRewardTipWord:function(){cc.find("infoPanel/imgEggWord",this.node).getComponent(cc.Sprite).spriteFrame=this._resAtlas.getSpriteFrame("hd_zjd_wenzi_03")},_setEggTecture:function(t,e){var i=e.getHitStatus(),n=i?"hd_zjd_yindan_02":"hd_zjd_yindan_01";t.getComponent(cc.Sprite).spriteFrame=this._resAtlas.getSpriteFrame(n);var a=t.getComponent(cc.Button);if(a.clickEvents=[],!i){var r=td.GlobalFunction.createClickEventHandler(this.node,"HitSilverEggPanel","requestHitEgg",e);a.clickEvents.push(r)}}});e.exports=a,cc._RF.pop()},{HitEggBasePanel:"HitEggBasePanel"}],HuntTreasureModel:[function(t,e,i){"use strict";cc._RF.push(e,"303d3FgU4JPZJO8+IIh9v7f","HuntTreasureModel");var n=window.td,a=function(){function t(){this._id=0,this._index=0,this._type=0}return t.prototype.init=function(t){t&&(this._id=t.id,this._index=t.index,this._type=t.type,this._cost=n.RewardManager.getRewardDetail(t.cost))},t.prototype.getId=function(){return this._id},t.prototype.getIndex=function(){return this._index},t.prototype.getType=function(){return this._type},t.prototype.getCost=function(){return this._cost},t}();e.exports=a,cc._RF.pop()},{}],HuntTreasureTable:[function(t,e,i){"use strict";cc._RF.push(e,"728adQOMAlNtK6+z/sMXxzd","HuntTreasureTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HuntTreasureTable",properties:{_tblName:"vow_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.type]||(t[a.type]={}),t[a.type][a.index]=a}},getData:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],HurtStaticsView:[function(t,e,i){"use strict";cc._RF.push(e,"d4beauknjlLeaX7cklYG/ix","HurtStaticsView"),cc.Class({extends:cc.Component,properties:{scrollView:cc.ScrollView,_sizeY:0},start:function(){},onEnable:function(){},onDisable:function(){},setData:function(t){this._fightResult=t,this._setTotalHurt(),this.setListView(),this.scrollView.content.height=Math.abs(this._sizeY)>this.scrollView.content.height?Math.abs(this._sizeY):this.scrollView.content.height},_setTotalHurt:function(){var t=this.node.getChildByName("heroTotalDamage"),e=this.node.getChildByName("enermyTotalDamage"),i=this._fightResult.getDamages(),n=i[1].TotalDamages,a=i[2].TotalDamages;t.getComponent(cc.Label).string=n,e.getComponent(cc.Label).string=a},setListView:function(){var t=this._fightResult.getDamages();for(var e in t){var i,n=t[e];i=1==e?"hero":"enermy";var a=[];for(var r in n)"TotalDamages"!=r&&(n[r].damage||(n[r].damage=0),a.push(n[r]));a.sort(this.sortFunc);for(var o=1,s=0,l=(n.TotalDamages,0);l<a.length;l++){var c=a[l].damagePer,u=a[l].damage||0;if(void 0!==c){var d=a[l].sid;(f=this.node.getChildByName(i+o)).removeFromParent(!1),f.getChildByName("progressBar").getComponent(cc.ProgressBar).progress=c/100,f.getChildByName("AtkPercent").getComponent(cc.Label).string=c+"%";var h=td.PvpFightController.getInstance().getRoleDataBySId(d);if(h){var p=h.getBaseModel().getIconRes(),_=h.getBaseModel().getModelShowType(),g=f.getChildByName("icon");g.setScale(.7),td.GlobalFunction.createSpriteNode(g,_===td.SpriteType.PET?td.resDef.pngPlist.icon_chongwu:td.resDef.pngPlist.icon_touxiang,cc.SpriteAtlas,p),f.getChildByName("damage").getComponent(cc.Label).string=td.GlobalFunction.getSimpledNumStr(u),o++,this.scrollView.content.addChild(f),f.x=1==e?-153:149,f.y=s,s-=100}}}for(this._sizeY=s<this._sizeY?s:this._sizeY;o<=td.MaxEnum.MaxBattleHeroCount+td.MaxEnum.MaxBattlePetCount;o++){var f;(f=this.node.getChildByName(i+o)).active=!1}}},sortFunc:function(t,e){return e.damage-t.damage},clickThis:function(){this.node.removeFromParent()}}),cc._RF.pop()},{}],IceRainSkill:[function(t,e,i){"use strict";cc._RF.push(e,"d46747+Iu1AK6xI7aFRCTon","IceRainSkill");var n=t("CommonSkill"),a=t("PveFightManager"),r=t("../../../manager/PveDataHelper").default,o=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="IceRainSkill",this._isNeedShake=!0},calcHurt:function(){for(var t=this._dataModel.getSkillPower(),e=this._dataModel.getDamageRange()/2,i=a.getEnemyArray(),n=this.node.getPosition(),o=r.getTecAddition(),s=0,l=i.length;s<l;s++){var c=i[s];if(c){var u=Math.floor(c._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),d=c.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[u]),h=d.bDeath(),p=(d.getDataModel(),c.getPosition()),_=td.GlobalFunction.getDistance(n,p),g=r.getBattleHerosTotalPower(),f=Math.floor(t*g);if(f*=1+o,_<=e&&!h){for(var v=this._dataModel.getAttackEffect(),m=0,y=v.length;m<y;m++){var E=v[m];E[0]===td.PveEnum.PVE_EFFECT_TYPE.PureHurt1&&(f+=E[1])}var T=0-td.PveEnum.PVE_UI_SKILL_ID.IceRain;d.setHurt(T,f,td.PveEnum.PVE_HURT_TYPE.Real),this.setAttackEffectToEnemy(c)}}}},removeSelf:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SKILL_HURT_STATICS_END)}});e.exports=o,cc._RF.pop()},{"../../../manager/PveDataHelper":"PveDataHelper",CommonSkill:"CommonSkill",PveFightManager:"PveFightManager"}],ImmortalConfig:[function(t,e,i){"use strict";cc._RF.push(e,"17611W0UhZKE7gmMKAiPvFk","ImmortalConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ImmortalConfig",e._tblName="immortal_config",e}return n(e,t),e.prototype.init=function(){this._data={},this._groupMaxStar={};for(var t=Math.max,e=this._jsonData,i=this._groupMaxStar,n=0,a=e.length-1;n<=a;n++){var r=e[n];this._data[r.id]=r;var o=r.group,s=r.stars;i[o]?i[o]=t(s,i[o]):i[o]=s}},e.prototype.getImmortalConfigs=function(){return this._data},e.prototype.getImmortalConfigById=function(t){return this._data&&this._data[t]?this._data[t]:null},e.prototype.getMaxStarByGroupId=function(t){return this._groupMaxStar&&this._groupMaxStar[t]?this._groupMaxStar[t]:0},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ImmortalEnum:[function(t,e,i){"use strict";cc._RF.push(e,"bc71248wFRCN76enB6MhJrq","ImmortalEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.ImmortalRecordType=i.ImmortalVisitEventType=i.ImmortalShowType=void 0,i.ImmortalShowType={Immortal:1,Invite:2,Visit:3},function(t){t[t.NONE=0]="NONE",t[t.RANDOM=1]="RANDOM",t[t.ALL=2]="ALL",t[t.RECEIVE=3]="RECEIVE",t[t.CHOOSE=4]="CHOOSE"}(i.ImmortalVisitEventType||(i.ImmortalVisitEventType={})),i.ImmortalRecordType={Invite:1,Visit:2},cc._RF.pop()},{}],ImmortalEventModel:[function(t,e,i){"use strict";cc._RF.push(e,"c19789J8RtAvJLHokv2bYuL","ImmortalEventModel");var n=function(){function t(){}return t.prototype.init=function(t){if(t){if(this._id=t.id,void 0!==t.eventId){var e=t.eventId;this._configId!==e&&(this._initConfig(e),this._configId=e)}void 0!==t.endTime&&(this._endTime=t.endTime)}},t.prototype._initConfig=function(t){var e=td.GetTableClass(td.TableEnum.ImmortalVisitEventConfig).getImmortalVisitEventConfigById(t);if(e){this._type=e.type,this._name=e.name,this._des=e.des,this._icon=e.icon,this._img=e.pic,this._cost=td.RewardManager.parseRewardListDetail(e.cost);var i=e.rewards;this._rewards={};for(var n=0,a=i.length;n<a;n++){var r=i[n],o=r[0],s=td.RewardManager.getRewardDetail(r[1]);this._rewards[o]=s}}else cc.log("init immortal event config error for id = "+t)},t.prototype.getId=function(){return this._id},t.prototype.getEndTime=function(){return this._endTime},t.prototype.getType=function(){return this._type},t.prototype.getName=function(){return this._name},t.prototype.getDes=function(){return this._des},t.prototype.getRewards=function(){return this._rewards},t.prototype.getCost=function(){return this._cost[0]},t.prototype.getImg=function(){return this._img},t.prototype.getIcon=function(){return this._icon},t}();e.exports=n,cc._RF.pop()},{}],ImmortalInfoModel:[function(t,e,i){"use strict";cc._RF.push(e,"9f5aaYN4s5HqItv4BwQNhcf","ImmortalInfoModel");var n=window.td,a=function(){function t(){}return t.prototype.init=function(t){if(t){var e=!1;if(void 0!==t.immortalId){var i=t.immortalId;this._immortalId!==i&&(this._initConfig(i),this._immortalId=i),e=!0}return void 0!==t.rewardState&&(0===this._immortalId?this._isRewardReceived=!0:this._isRewardReceived=t.rewardState,e=!0),void 0!==t.visitTimes&&(this._visitTimes=t.visitTimes,e=!0),void 0!==t.nextRecoverTime&&(this._nextRecoverTime=t.nextRecoverTime,e=!0),void 0!==t.buyTimes&&(this._boughtVisitTimes=t.buyTimes,e=!0),e}},t.prototype._initConfig=function(t){var e=n.GetTableClass(n.TableEnum.ImmortalConfig),i=e.getImmortalConfigById(t);if(i){this._taskIds=i.taskIds||[],this._rewards=n.RewardManager.parseRewardListDetail(i.rewards);var a=i.attributes;this._attributes={};for(var r=0,o=a.length;r<o;r++){var s=a[r],l=s[0];this._attributes[l]=this._attributes[l]||0,this._attributes[l]+=s[1]}this._img=i.pic,this._name=i.name,this._stars=i.stars,this._groupId=i.group,this._maxStars=e.getMaxStarByGroupId(this._groupId)}else cc.log("init immortal config error for id = "+t)},t.prototype.getId=function(){return this._immortalId},t.prototype.getName=function(){return this._name},t.prototype.isReceived=function(){return this._isRewardReceived},t.prototype.getNextRecoverTime=function(){return this._nextRecoverTime},t.prototype.getVisitTimes=function(){return this._visitTimes},t.prototype.getTaskIds=function(){return this._taskIds},t.prototype.getRewards=function(){return this._rewards},t.prototype.getAttributes=function(){return this._attributes},t.prototype.getImg=function(){return this._img},t.prototype.getStars=function(){return this._stars},t.prototype.getMaxStars=function(){return this._maxStars},t.prototype.getGroupId=function(){return this._groupId},t.prototype.getBoughtVisitTimes=function(){return this._boughtVisitTimes},t}();e.exports=a,cc._RF.pop()},{}],ImmortalInviteConfig:[function(t,e,i){"use strict";cc._RF.push(e,"12c5159RJdNHrkudgdXp2AQ","ImmortalInviteConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ImmortalInviteConfig",e._tblName="immortal_invite_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];this._data[n.id]=n}},e.prototype.getImmortalInviteConfigById=function(t){return this._data&&this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ImmortalInviteModel:[function(t,e,i){"use strict";cc._RF.push(e,"463de5XY05Aorimkq5Chf+S","ImmortalInviteModel");var n=function(){function t(){}return t.prototype.init=function(t){if(t){if(void 0!==t.id){var e=t.id;this._id!==e&&(this._initConfig(e),this._id=e)}void 0!==t.times&&(this._times=t.times),void 0!==t.state&&(this._isActive=t.state),void 0!==t.endTime&&(this._endTime=t.endTime)}},t.prototype._initConfig=function(t){var e=td.GetTableClass(td.TableEnum.ImmortalInviteConfig).getImmortalInviteConfigById(t);e?(this._unlockId=e.unlockId,this._probability=e.rewardProbability,this._rewards=td.RewardManager.parseRewardListDetail(e.rewards),this._cost=td.RewardManager.parseRewardListDetail(e.cost)):cc.log("init immortal invite config error for id = "+t)},t.prototype.getId=function(){return this._id},t.prototype.getTimes=function(){return this._times},t.prototype.isActive=function(){return this._isActive},t.prototype.getEndTime=function(){return this._endTime},t.prototype.getProbability=function(){return this._probability},t.prototype.getRewards=function(){return this._rewards[0]},t.prototype.getUnlockId=function(){return this._unlockId},t.prototype.getCost=function(){return this._cost[0]},t}();e.exports=n,cc._RF.pop()},{}],ImmortalManager:[function(t,e,i){"use strict";cc._RF.push(e,"ad2acWGNrtPcrcBgTNjqeqz","ImmortalManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,t("ImmortalInfoModel")),s=t("ImmortalInviteModel"),l=t("ImmortalEventModel"),c=t("ImmortalRecordModel"),u=t("ImmortalVisitModel"),d=t("../Enum/ImmortalEnum"),h=function(){function t(){}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._immortalData=null,this._inviteList={},this._visitList=[],this._visitEventList=[],this._recordList={},this._inviteTickList={}},t.prototype.addListener=function(){var t=td.MsgModuleName.IMMORTAL,e=td.MsgCmd.IMMORTAL,i=td.ServerDelegate;i.registerMessage(t,e.IMMORTAL_GET_INFO,this._parseImmortalInfo.bind(this)),i.registerMessage(t,e.IMMORTAL_PROMOTE,this._onImmortalPromote.bind(this)),i.registerMessage(t,e.IMMORTAL_RECEIVE_REWARD,this._onReceiveImmortalReward.bind(this)),i.registerMessage(t,e.IMMORTAL_INVITE,this._onImmortalInvite.bind(this)),i.registerMessage(t,e.IMMORTAL_VISIT,this._onImmortalVisit.bind(this)),i.registerMessage(t,e.IMMORTAL_VISIT_EVENT,this._onHandleEvent.bind(this)),i.registerMessage(t,e.IMMORTAL_INVITE_RECORD_LIST,this._onGetInviteRecord.bind(this)),i.registerMessage(t,e.IMMORTAL_VISIT_RECORD_LIST,this._onGetVisitRecord.bind(this)),i.registerMessage(t,e.IMMORTAL_VISIT_TIMES,this._onBuyTimesSuccess.bind(this)),i.registerMessage(t,e.PUSH_IMMORTAL_INFO,this._parseImmortalInfo.bind(this))},t.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.REQUEST_IMMORTAL_INFO]=this._requestImmortalInfo,e[t.REQUEST_IMMORTAL_PROMOTE]=this._requestImmortalPromote,e[t.REQUEST_IMMORTAL_REWARD]=this._requestImmortalReward,e[t.REQUEST_IMMORTAL_INVITE]=this._requestImmortalInvite,e[t.REQUEST_IMMORTAL_VISIT]=this._requestImmortalVisit,e[t.REQUEST_IMMORTAL_EVENT]=this._requestImmortalEvent,e[t.REQUEST_IMMORTAL_INVITE_RECORD]=this._requestInviteRecord,e[t.REQUEST_IMMORTAL_VISIT_RECORD]=this._requestVisitRecord,e[t.REQUEST_BUY_VISIT_TIMES]=this._requestBuyVisitTimes,e[t.VISIT_EVENT_DISAPPEAR]=this._onDeleteVisitEvent,td.EventUtil.registerEvents(e,this)},t.prototype.isTaskGuide=function(t){if(!this._immortalData||this._immortalData.getId()>0)return!1;var e=this._immortalData.getTaskIds()[t-1];if(!e)return!1;var i=td.TaskManager.getTaskById(e);return!!i&&i.getStatus()===td.TaskStatus.Progress},t.prototype.isUpgradeGuide=function(){return!(!this._immortalData||this._immortalData.getId()>0)&&this.canUpgrade()},t.prototype.getImmortalData=function(){return this._immortalData?this._immortalData:(this._requestImmortalInfo(),null)},t.prototype.getTotalAttr=function(){return this._immortalData?this._immortalData.getAttributes():{}},t.prototype.isRedPoint=function(){return!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Immortal,0)&&(this.canReceiveDailyReward()||this.canUpgrade())},t.prototype.redPointEvts=function(){var t=td.EventNameEnum;return[t.IMMORTAL_INFO_CHANGED,t.Res_GET_TASK_INFO,t.USER_ATTR_LEVEL_CHANGE]},t.prototype.canReceiveDailyReward=function(){return!(!this._immortalData||this._immortalData.isReceived())},t.prototype.canUpgrade=function(){if(!this._immortalData)return!1;var t=this._immortalData.getTaskIds(),e=td.TaskManager;if(0===t.length)return!1;for(var i=0,n=t.length;i<n;i++){var a=t[i],r=e.getTaskById(a);if(r){var o=r.getStatus();if(o!==td.TaskStatus.Finish&&o!==td.TaskStatus.Received)return!1}}return!0},t.prototype.getInviteList=function(){return this._inviteList},t.prototype.getVisitList=function(){return this._visitList},t.prototype.getVisitEventList=function(){return this._visitEventList},t.prototype.getRecordList=function(t){return this._recordList[t]},t.prototype.getNextBuyVisitTimesCost=function(){return td.GlobalFunction.getShareConfigUpCostDetail("IMMORTAL_VISIT_TIMES_COST",this.getVisitBoughtTimes()+1)},t.prototype.getVisitBoughtTimes=function(){return this._immortalData?this._immortalData.getBoughtVisitTimes():0},t.prototype._onDeleteVisitEvent=function(t){for(var e=this._visitEventList,i=null,n=0,a=e.length;n<a;n++){if(e[n].getId()===t){i=n;break}}null!==i&&(this._visitEventList.splice(i,1),td.EventUtil.dispatchEvent(td.EventNameEnum.IMMORTAL_VISIT_CHANGED))},t.prototype.getInviteTickTime=function(t){var e=0;if(this._inviteTickList&&this._inviteTickList[t]){var i=td.TimeUtil.getTime();e=(e=this._inviteTickList[t]-i)>0?Math.floor(e/1e3):0}return e},t.prototype.saveInviteTickTime=function(t,e){!e||e<0||(this._inviteTickList[t]=td.TimeUtil.getTime()+1e3*e)},t.prototype._requestImmortalInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Immortal,0)){var t={};t.module=td.MsgModuleName.IMMORTAL,t.cmd=td.MsgCmd.IMMORTAL.IMMORTAL_GET_INFO,td.ServerDelegate.sendMessage(t)}},t.prototype._parseImmortalInfo=function(t,e){if(t===td.NetCode.SUCCESS){if(this._immortalData||(this._immortalData=new o),this._immortalData.init(e)&&td.EventUtil.dispatchEvent(td.EventNameEnum.IMMORTAL_INFO_CHANGED),void 0!==e.inviteList){var i=e.inviteList;this._inviteList={};for(var n=this._inviteList,a=0,r=i.length;a<r;a++){var c=(d=i[a]).id;(u=n[c])||(u=new s,n[c]=u),u.init(d)}td.EventUtil.dispatchEvent(td.EventNameEnum.IMMORTAL_INVITE_CHANGED)}if(void 0!==e.visitList){i=e.visitList;this._visitEventList=[];for(n=this._visitEventList,a=0,r=i.length;a<r;a++){var u,d=i[a];(u=new l).init(d),n[n.length]=u}td.EventUtil.dispatchEvent(td.EventNameEnum.IMMORTAL_VISIT_CHANGED)}}},t.prototype._requestImmortalPromote=function(){var t={};t.module=td.MsgModuleName.IMMORTAL,t.cmd=td.MsgCmd.IMMORTAL.IMMORTAL_PROMOTE,td.ServerDelegate.sendMessage(t)},t.prototype._onImmortalPromote=function(t,e){td.EventUtil.dispatchEvent(td.EventNameEnum.ON_IMMORTAL_PROMOTE)},t.prototype._requestImmortalReward=function(){var t={};t.module=td.MsgModuleName.IMMORTAL,t.cmd=td.MsgCmd.IMMORTAL.IMMORTAL_RECEIVE_REWARD,td.ServerDelegate.sendMessage(t)},t.prototype._onReceiveImmortalReward=function(t,e){t===td.NetCode.SUCCESS&&(this._onShowRewards(e),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_GET_IMMORTAL_REWARD))},t.prototype._requestImmortalInvite=function(t){var e={};e.module=td.MsgModuleName.IMMORTAL,e.cmd=td.MsgCmd.IMMORTAL.IMMORTAL_INVITE,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._onImmortalInvite=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResultList[0],n=i?td.RewardManager.parseRewardResult(i):null;td.EventUtil.dispatchEvent(td.EventNameEnum.ON_IMMORTAL_INVITE,n)}},t.prototype._requestImmortalVisit=function(t){if(td.GlobalFunction.checkCanClicked()){var e={};e.module=td.MsgModuleName.IMMORTAL,e.cmd=td.MsgCmd.IMMORTAL.IMMORTAL_VISIT,e.id=t,td.ServerDelegate.sendMessage(e)}},t.prototype._onImmortalVisit=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,n)}},t.prototype._requestImmortalEvent=function(t){var e={};e.module=td.MsgModuleName.IMMORTAL,e.cmd=td.MsgCmd.IMMORTAL.IMMORTAL_VISIT_EVENT,e.id=t.id,t.rewardId&&(e.rewardId=t.rewardId),td.ServerDelegate.sendMessage(e)},t.prototype._onHandleEvent=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.EventUtil.dispatchEvent(td.EventNameEnum.ON_IMMORTAL_EVENT,n)}},t.prototype._requestInviteRecord=function(){var t={};t.module=td.MsgModuleName.IMMORTAL,t.cmd=td.MsgCmd.IMMORTAL.IMMORTAL_INVITE_RECORD_LIST,td.ServerDelegate.sendMessage(t)},t.prototype._onGetInviteRecord=function(t,e){if(t===td.NetCode.SUCCESS){var i=d.ImmortalRecordType.Invite;this._handleRecord(i,e),td.EventUtil.dispatchEvent(td.EventNameEnum.IMMORTAL_RECORD_UPDATED,i)}},t.prototype._requestVisitRecord=function(){var t={};t.module=td.MsgModuleName.IMMORTAL,t.cmd=td.MsgCmd.IMMORTAL.IMMORTAL_VISIT_RECORD_LIST,td.ServerDelegate.sendMessage(t)},t.prototype._onGetVisitRecord=function(t,e){if(t===td.NetCode.SUCCESS){var i=d.ImmortalRecordType.Visit;this._handleRecord(i,e),td.EventUtil.dispatchEvent(td.EventNameEnum.IMMORTAL_RECORD_UPDATED,i)}},t.prototype._handleRecord=function(t,e){this._recordList[t]=this._recordList[t]||[];var i=e.recordList;if(i&&i.length>0){this._recordList[t]=[];for(var n=td.GetConfig("IMMORTAL_RECORD_LIMIT"),a=this._recordList[t],r=0,o=i.length;r<o;r++){var s=i[r],l=new c;l.init(t,s),a.unshift(l),a.length>n&&a.pop()}}},t.prototype._requestBuyVisitTimes=function(){var t={};t.module=td.MsgModuleName.IMMORTAL,t.cmd=td.MsgCmd.IMMORTAL.IMMORTAL_VISIT_TIMES,td.ServerDelegate.sendMessage(t)},t.prototype._onBuyTimesSuccess=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.BUY_TIMES_SUCCESS)},t.prototype._onShowRewards=function(t){var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);td.GlobalFunction.showRewards(i)},t.prototype._initVisitList=function(){this._visitList=[];for(var t=td.GetTableClass(td.TableEnum.ImmortalVisitConfig).getImmortalVisitConfig(),e=0,i=t.length;e<i;e++){var n=t[e],a=new u;a.init(n),this._visitList[this._visitList.length]=a}},t=e=n([r],t)}();i.default=h,cc._RF.pop()},{"../Enum/ImmortalEnum":"ImmortalEnum",ImmortalEventModel:"ImmortalEventModel",ImmortalInfoModel:"ImmortalInfoModel",ImmortalInviteModel:"ImmortalInviteModel",ImmortalRecordModel:"ImmortalRecordModel",ImmortalVisitModel:"ImmortalVisitModel"}],ImmortalRecordModel:[function(t,e,i){"use strict";cc._RF.push(e,"a86e1yz/oRJNbBUiSX0VlYQ","ImmortalRecordModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Enum/ImmortalEnum"),a=function(){function t(){}return t.prototype.init=function(t,e){e&&(t===n.ImmortalRecordType.Invite?this._handleInviteMsg(e):t===n.ImmortalRecordType.Visit&&this._handleVisitMsg(e))},t.prototype.getMsg=function(){return this._msg},t.prototype.getShowMsg=function(){return this._showMsg},t.prototype.getQuality=function(){return this._quality},t.prototype.getTime=function(){return this._time},t.prototype._handleInviteMsg=function(t){var e=td.Language.immortalInviteRecord1,i=td.Language.immortalInviteRecord2,n=t.id,a=td.GetTableClass(td.TableEnum.ImmortalInviteConfig).getImmortalInviteConfigById(n);if(a){this._time=t.time;var r=td.TimeUtil.convertDataTime(this._time,"HH:mm:ss"),o=td.RewardManager.parseRewardListDetail(a.rewards)[0];o?(this._quality=o.getQuality(),this._showMsg=cc.js.formatStr(e,t.name,r,o.getName()),this._msg=cc.js.formatStr(i,t.name,o.getName())):cc.log("_handleInviteMsg get hero data error!!!")}else cc.log("_handleInviteMsg get config error for inviteId = "+n)},t.prototype._handleVisitMsg=function(t){var e=t.id,i=td.GetTableClass(td.TableEnum.ImmortalVisitEventConfig).getImmortalVisitEventConfigById(e);if(i){var a=i.type,r=td.Language["immortalVisitRecord1"+a],o=td.Language["immortalVisitRecord2"+a];if(o)if(r){this._time=t.time;td.TimeUtil.convertDataTime(this._time,"HH:mm:ss");for(var s,l=t.rewardId,c=i.rewards,u=td.RewardManager,d="",h=0,p=c.length;h<p;h++){var _=c[h],g=_[0],f=u.getRewardDetail(_[1]);if(0===l||g===l){d+=f.getName();var v=f.getCount();v>1&&(d+="X"+v),d+=",",s||(s=f.getQuality())}}if(d.length>0&&(d=d.slice(0,d.length-1)),this._quality=s,a===n.ImmortalVisitEventType.RECEIVE)this._showMsg=cc.js.formatStr(r,t.name,d),this._msg=cc.js.formatStr(o,t.name,d);else{var m=u.parseRewardListDetail(i.cost)[0].getCount();this._showMsg=cc.js.formatStr(r,t.name,m,d),this._msg=cc.js.formatStr(o,t.name,m,d)}}else cc.log("get visit msg show templete error for type = "+a);else cc.log("get visit msg templete error for type = "+a)}else cc.log("_handleVisitMsg get config error for visitId = "+e)},t}();e.exports=a,cc._RF.pop()},{"../Enum/ImmortalEnum":"ImmortalEnum"}],ImmortalVisitConfig:[function(t,e,i){"use strict";cc._RF.push(e,"c740a5KuMhBk5ZrfY1qi513","ImmortalVisitConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ImmortalVisitConfig",e._tblName="immortal_visit_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[t.length]=a}},e.prototype.getImmortalVisitConfig=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ImmortalVisitEventConfig:[function(t,e,i){"use strict";cc._RF.push(e,"5ff60GQa7dDg7IVW8jWY8X0","ImmortalVisitEventConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ImmortalVisitEventConfig",e._tblName="immortal_visit_event_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];this._data[n.id]=n}},e.prototype.getImmortalVisitEventConfigById=function(t){return this._data&&this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ImmortalVisitModel:[function(t,e,i){"use strict";cc._RF.push(e,"9de89Zutx1AP5N+El0WZr9h","ImmortalVisitModel");var n=function(){function t(){}return t.prototype.init=function(t){t&&(this._id=t.id,this._unlockId=t.unlockId,this._nameImg=t.name,this._rewards=td.RewardManager.parseRewardListDetail(t.rewardDisplay))},t.prototype.getId=function(){return this._id},t.prototype.getUnlockId=function(){return this._unlockId},t.prototype.getNameImg=function(){return this._nameImg},t.prototype.getRewards=function(){return this._rewards},t}();e.exports=n,cc._RF.pop()},{}],InspireBuff:[function(t,e,i){"use strict";cc._RF.push(e,"83f6btu2z9EHokdHgzMd/6s","InspireBuff");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_clipName:null,_bShowBuff:null},initData:function(t){if(this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.Inspire,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff){var e=this.node.addComponent(cc.Sprite);e.atlas=gdk.rm.getResByUrl("fightRes/pve/buff/GuWu/Atlas",cc.SpriteAtlas),e.sizeMode=cc.Sprite.SizeMode.RAW,e.trim=!1,this.node.addComponent(cc.Animation);var i=gdk.rm.getResByUrl("fightRes/pve/buff/GuWu/buffAnimation",cc.AnimationClip);this._clipName=i.name,this.node.getComponent(cc.Animation).addClip(i,this._clipName)}},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._curSpeedMult=a.getCurFightSpeedMult(),this._bShowBuff&&(this.refreshSkillAnimationSpeed(this._curSpeedMult),this.node.getComponent(cc.Animation).play(this._clipName)),this.setTargetBuffData(!0),this.schedule(this.onUpdateInspireBuff,1/60)):this.removeSelf()},onDisable:function(){this._super(),this.unschedule(this.onUpdateInspireBuff)},onChangeSpeedMult:function(t){this._super(t),this._bShowBuff&&this.refreshSkillAnimationSpeed(t)},refreshSkillAnimationSpeed:function(t){for(var e=this.node.getComponent(cc.Animation),i=e.getClips(),n=0,a=i.length;n<a;n++){if(i[n])e.getAnimationState(i[n].name).speed=t}},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_HERO_SCRIPT[e]),n=this._curSpeedMult*(this._curBuffData.buffData+1),a={buffData:t?n:this._curSpeedMult,bInspire:t};i.setInspireData(a)},onUpdateInspireBuff:function(t){if(!this._bFightPause)return this._curBuffData.buffTime<=0?(this.unschedule(this.onUpdateInspireBuff),this.setTargetBuffData(!1),void this.endBuff()):void(this._curBuffData.buffTime-=t*this._curSpeedMult)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],IntensifyPowerTable:[function(t,e,i){"use strict";cc._RF.push(e,"638aeWxJHhPEZTrNYlPMCYP","IntensifyPowerTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="IntensifyPowerConfig",e._tblName="intensify_power_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.level]=a}},e.prototype.getDataByLv=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],IntensifyTable:[function(t,e,i){"use strict";cc._RF.push(e,"4754bxe345HQ7KUzZRFib+C","IntensifyTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="IntensifyConfig",e._tblName="intensify_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getUpDatasByLv=function(t){var e={};for(var i in this._data){var n=this._data[i];1===n.type&&n.level<=t&&(e[n.goalType]=n)}var a=[];for(var i in e)a.push(e[i]);return a.sort(this.sortFunc)},e.prototype.getGetDatasByLv=function(t){var e=[];for(var i in this._data){var n=this._data[i];2===n.type&&n.level<=t&&e.push(n)}return e.sort(this.sortFunc)},e.prototype.getHelpDatas=function(){var t=[];for(var e in this._data){var i=this._data[e];4===i.type&&t.push(i)}return t.sort(this.sortFunc)},e.prototype.sortFunc=function(t,e){return t.orderId-e.orderId},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],IntensifyType:[function(t,e,i){"use strict";cc._RF.push(e,"06452XwzeJGTJUqs3IW9wzA","IntensifyType"),Object.defineProperty(i,"__esModule",{value:!0}),i.IntensifyType=void 0,i.IntensifyType={HeroLv:1,HeroBreakout:2,HeroCultivate:3,HeroStar:4,HeroFriend:5,EquipNum:6,EquipLv:7,EquipForge:8,EquipEvolve:9,TreasureNum:10,TreasureLv:11,TreasureEvolve:12,GemstoneNum:13,GemstoneLv:14,GemstoneAwaken:15,HeroArtifactNum:16,HeroArtifactLv:17,HeroArtifactAdvanceLv:18,EquipStarUp:19,SpiritNum:20,SpiritLv:21,SpiritStarLv:22},cc._RF.pop()},{}],ItemEnum:[function(t,e,i){"use strict";cc._RF.push(e,"23862K7X51HKrV7qza7kIqq","ItemEnum"),td.GoodsOperateType={NONE:0,CURRENCY:1,RESOURCE:2,USE:3,FRAMENT:4},td.GoodsType={Type_None:0,Type_Item:1,Type_Mercenary:2,Type_Equip:3,Type_Gemstone:4,Type_Treasure:6,Type_HeroRune:7,Type_Artifact:8,Type_Spirit:9,Type_Pet:10},td.GoodsSubType={NONE:0,DIAMOND:1,GOLD:2,EVIL_GOD_COIN:14,DRAGON_SPIRIT:19,AMETHYST:1e3,ENERGON:1001,EP:32,EP_MAX:33,EXP:34,GACHA_VOUCHER:1005,MERCENARY_EVOLVE_REPLACE:1006,EQUIPMENT_EVOLVE_REPLACE:37,EQUIPMENT_STAR_UP:1007,HERO_STAR_UP:1008,EQUIPMENT_FORGE:1009,EQUIPMENT_EVOLVE:1013,ADD_ROAM_TIMES:71,ADD_EP_MAX:72,GIFT_BAG:73,CHOOSE_BAG:74,ADD_VIGOUR:78,ADD_VIP_EXP:79,TIMES_BAG:80,TITLE:81,DEFAULT_BAG:199,TREASURE_FRAGMENT:200,HERO_FRAGMENT:201,EQUIPMENT_FRAMENT:202,HERO_RAND_FRAMENT:203,SPIRIT_FRAGMENT:204,PET_EGG_FRAGMENT:205,PET_FRAGMENT:206,PET_EGG:1035},td.GoodsEffectType={ADD_EP:1,ADD_EP_MAX:2,GIFT_BAG:3,CHOOSE_BAG:4,TIMES_BAG:10,TITLE:11},td.ItemEnum={None:0,Diamond:1,Gold:2,Exp:3,ArenaCoin:4,WorldBossCoin:5,Amethyst:6,Score:7,AbyssCoin:8,NationCoin:9,NationExp:10,LuckyCoin:11,BattleAchieve:12,Prestige:13,EvilGodCoin:14,Energy:15,NationStudyPoint:16,VIP_EXP:17,AchPoint:18,CROSS_CUP_COIN:19,VIGOUR:20,MIND_VOWEL:21,SKY_JADE:22,HERO_RUNE_COIN:23,MERIT:24,SUP_SCI_TECH_POINT:25,MINE:26,FUND:27,ANCIENT:28,CROSS_ARENA_COIN:29,LEGEND_POINT:30,LEGEND_COIN:31,MAZE_COIN:32,CHESS_COIN:33,Total:99,ShopReFresh:2e4,HeroExpItem2:20001,HeroExpItem3:20002,HeroExpItem4:20003,HeroExpItem5:20004,Courage:20005,GachaEquipTicket:20020,GachaEquipShopTicket:20027,StarrySkyDiamond:20024,GachaEquipNewTicket:20031,TimeLimitTicket:20032,TechnologicalUpRunes:20014,TechnologicalRunes:20015,TurntableTicket:20025,FortuneCatTicket:20026,TurntableCurrency_1:20029,TurntableCurrency_2:20028,HeavenTurntableItem:20074,HavingTurntableItem:20075,BaoZhuFirecracker:20030,HeroEvolveItem2:20128,HeroEvolveItem3:20129,HeroEvolveItem4:20130,HeroEvolveItem5:20131,HeroEvolveItem6:20132,HeroEvolveItem7:20133,SummonHeroItem1:20191,SummonHeroItem2:20192,SummonHeroItem3:20193,HeroRelifeItem1:20103,HeroRelifeItem2:20104,HeroRelifeItem3:20105,HeroRelifeItem4:20106,HeroRelifeItem5:20107,HeroRelifeItem6:20108,HeroRelifeItem7:20109,HeroRelifeItem8:20110,EquipEvolveItem:20125,EquipEvolveItem2:20134,EquipEvolveItem3:20135,EquipEvolveItem4:20136,EquipEvolveItem5:20137,EquipEvolveItem6:20138,EquipEvolveItem7:20139,SpiritRewsetItem:20185,RoamItem:20009,SpiritTalentBook1:20186,SpiritTalentBook2:20187,SpiritTalentBook3:20188,ChessRefreshToken:20220,SUMMON_SHOP_HERO:20026,SUMMON_SHOP_EQUIP:20027,SUMMON_SHOP_GEMSTONE:20028,VIGOUR_ITEM:28006,EnergyItem:20033,HUNT_GEM_ITEM:20037,FRAGMENT_GIFT:20050,Purple_Egg:30116,Orange_Egg:30117,Red_Egg:30118,RichmanPlanTickets:900019,Firecracker:810001,CrusadeToken:810002,HalloweenItem:20223},td.RewardType={None:0,Resource:10,Item:11,Mercenary:12,Equipment:13,Gemstone:14,Prerogative:15,Artifact:17,Treasure:20,HeroRune:21,HeroArtifact:22,SPIRIT:23,Pet:24},td.Quality={White:1,Green:2,Blue:3,Purple:4,Yellow:5,Orange:6,Red:7,Golden:8},td.QualityBgImg=[null,null,"GY_zhuangbeik_02","GY_zhuangbeik_03","GY_zhuangbeik_04","GY_zhuangbeik_05","GY_zhuangbeik_06","GY_zhuangbeik_07"],td.QualitySpriteBgImg=[null,null,"GY_touxiangk_02","GY_touxiangk_03","GY_touxiangk_04","GY_touxiangk_05","GY_touxiangk_06","GY_touxiangk_07"],td.QualityTxtBgImg=[null,null,"UI/GY_GlobalRes/GY_wupinwzdikuang_01","UI/GY_GlobalRes/GY_wupinwzdikuang_02","UI/GY_GlobalRes/GY_wupinwzdikuang_03","UI/GY_GlobalRes/GY_wupinwzdikuang_04","UI/GY_GlobalRes/GY_wupinwzdikuang_05","UI/GY_GlobalRes/GY_wupinwzdikuang_06"],td.MercenaryQualityImg=[null,"UI/GY_GlobalRes/GY_yxjmpinjiese_01","UI/GY_GlobalRes/GY_yxjmpinjiese_01","UI/GY_GlobalRes/GY_yxjmpinjiese_02","UI/GY_GlobalRes/GY_yxjmpinjiese_03","UI/GY_GlobalRes/GY_yxjmpinjiese_04","UI/GY_GlobalRes/GY_yxjmpinjiese_05","UI/GY_GlobalRes/GY_yxjmpinjiese_06"],td.QualityColors=[null,cc.color(255,255,255),cc.color(5,253,17),cc.color(46,189,255),cc.color(255,27,247),cc.color(255,166,12),cc.color(255,8,8),cc.color(255,255,5)],td.AwakeLevelColors=[cc.color(138,138,138),cc.color(0,255,54),cc.color(5,176,255),cc.color(255,0,234),cc.color(255,198,0),cc.color(0,252,255),cc.color(255,0,0),cc.color(255,0,0)],td.QualityStrokeColors=[null,null,cc.color(4,79,9),cc.color(4,53,134),cc.color(81,1,104),cc.color(120,69,2),cc.color(81,30,3),cc.color(134,86,2)],td.QualityColorStrs=["","#ffffff","#05FD11","#2EBDFF","#FFBDF7","#FFA60C","#FF0808","#FFFF05"],td.SuitNameImg={2:"res/ui/Meishuzi/MSZ_jiantao02.png",3:"res/ui/Meishuzi/MSZ_jiantao03.png",4:"res/ui/Meishuzi/MSZ_jiantao04.png",6:"res/ui/Meishuzi/MSZ_jiantao06.png"},td.EquipUpgradeType={Evolve:1,Grow:2},td.EquipMasterType={Strengthen:1,Evolve:2},td.RewardPreviewType={Endless:1,Abyss:2},td.EquipUpgradeStatus={CanUpgrade:1,GoldUnEnough:2,FullLevel:3},td.GemstoneType={Normal:1,Special:2},td.GemOperateType={Upgrade:1,Awaken:2},cc._RF.pop()},{}],ItemManager:[function(t,e,i){"use strict";cc._RF.push(e,"f6393nE731IP7MjOzWwiF+Q","ItemManager");var n=o(t("../../Hero/Manager/HeroManager")),a=o(t("../../Nation/Manager/NationMainManager")),r=o(t("../../Chess/Manager/ChessManager"));function o(t){return t&&t.__esModule?t:{default:t}}var s=t("HeroRuneModel");td.ItemManager={_itemList:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._itemList={}},_addListener:function(){var t=td.MsgModuleName.GOODS,e=td.MsgCmd.Goods,i=td.ServerDelegate;i.registerMessage(t,e.GET_GOODS_LIST,this._parseItemList.bind(this)),i.registerMessage(t,e.USE_GOODS,this._onUseItemReturn.bind(this)),i.registerMessage(t,e.SYNTHESIZE_ENERGON,this._onBatchComposeReturn.bind(this)),i.registerMessage(t,e.PUSH_GOODS_LIST,this._parseItemList.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQUEST_ITEM_LIST]=this._requestGetItemList,i[e.REQUEST_USE_ITEM]=this._useItem,i[e.REQUEST_BATCH_COMPOSE]=this._requestBatchCompose,t.registerEvents(i,this)},getItemsData:function(){return this._itemList},getItemUseList:function(t){var e=[];for(var i in this._itemList){var a=this._itemList[i];if(!(a.getCount()<=0)){var r=a.getShowType();r&&r==t&&(e[e.length]=a)}}if(3==t){var o=n.default.getInstance().getHeroRuneData(),l={};for(var c in o){var u=o[c];if(0===u.getHeroId())if(l[u.getId()]){var d=l[u.getId()].getCount();l[u.getId()].setCount(d+1)}else{var h=new s,p=td.GetTableClass(td.TableEnum.HeroRuneTable).getHeroRuneById(u.getId());h.init(p),l[h.getId()]=h}}for(var _ in l)e[e.length]=l[_]}return e},showRedPoint:function(){for(var t=1;t<3;t++)for(var e=this.getItemUseList(t),i=0;i<e.length;i++)if(1==e[i].showRedPoint())return!0;return!1},redPointEvent:function(){return[td.EventNameEnum.ITEM_CHANGE]},getItemDataBykey:function(t){return this._itemList[t]},getItemsDatasByGoodsSubType:function(t){var e=this._itemList,i={};for(var n in e){var a=e[n];a.getGoodsSubType()==t&&(i[a.getId()]?i[a.getId()].setCount(i[a.getId()].getCount()+a.getCount()):i[a.getId()]=cc.instantiate(a))}return i},getConfigItemByGoodsSubType:function(t){return td.GetTableClass(td.TableEnum.Item).getItemBySubType(t)},getItemNumById:function(t){var e=0;if(t>td.ItemEnum.None&&t<td.ItemEnum.Total)if(t===td.ItemEnum.NationFund){var i=a.default.getInstance().getNationInfo();i&&(e=i.getFund())}else e=td.Account.getUserData().getUserItemProperty(t);else{if(t===td.ItemEnum.ChessRefreshToken)return r.default.getInstance().getTokens();var n=this.seekItemDataById(t);if(0===n.length)return 0;for(var o=0;o<n.length;o++)e+=n[o].getCount()}return e},seekItemDataById:function(t,e){var i=this._itemList,n=[];for(var a in i)if(i[a].getId()===t&&(n.push(i[a]),e))break;return n.sort(function(t,e){return t.getCount()-e.getCount()}),e?n.length>0?n[0]:null:n},_requestGetItemList:function(){var t={};t.module=td.MsgModuleName.GOODS,t.cmd=td.MsgCmd.Goods.GET_GOODS_LIST,td.ServerDelegate.sendMessage(t)},_parseItemList:function(t,e){if(t===td.NetCode.SUCCESS){for(var i=e.goodsList,n=this._itemList,a=0===this._itemList.myLen(),r=0;r<i.length;r++){var o=i[r],s=o.goodsUid;if(0!=s&&void 0!==s){var l,c=n[s];if(c)l=c.getId(),o.num<=0&&c.getGoodsSubType()!==td.GoodsSubType.TIMES_BAG?delete n[s]:(c.setCount(o.num),c.setUseTimes(o.times||0));else{var u=td.GetTableClass(td.TableEnum.Item).getItemById(o.goodsId),d=new td.Item;d.init(u),d.setSId(s),d.setCount(o.num),d.setUseTimes(o.times||0),l=d.getId(),n[s]=d}!a&&l&&this.checkUpgradeItem(l)}}a?td.EventUtil.dispatchEvent(td.EventNameEnum.INIT_DATA_LOADED,td.LoadKey.Item):td.EventUtil.dispatchEvent(td.EventNameEnum.ITEM_CHANGE)}},_useItem:function(t){var e={};e.module=td.MsgModuleName.GOODS,e.cmd=td.MsgCmd.Goods.USE_GOODS,e.goodsUid=t.goodsSId,e.num=t.num,t.ext&&(e.ext=t.ext),td.ServerDelegate.sendMessage(e),this._itemList[t.goodsSId]&&td.DataReporter.useItem(this._itemList[t.goodsSId].getName(),t.num)},_onUseItemReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.goodsId,n=e.count,a=td.GetTableClass(td.TableEnum.Item).getItemById(i),r=null;if(a&&(r=new td.Item).init(a),r){var o=r.getGoodsSubType();if(o===td.GoodsSubType.ADD_MANOR_BUFFER_TIME){var s=new td.BroadcastContent(115);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,s)}else{if(o===td.GoodsSubType.ADD_ROAM_TIMES){var l=r.getEffectValue();return(s=new td.BroadcastContent(204)).setMainParam([new td.BroadcastParam(l*n)]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,s),void td.EventUtil.dispatchEvent(td.EventNameEnum.USEITEM_SUCCESS)}if(o===td.GoodsSubType.ADD_VIP_EXP){var c=r.getEffectValue();(s=new td.BroadcastContent(324)).setMainParam([new td.BroadcastParam(c*n)]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,s),td.EventUtil.dispatchEvent(td.EventNameEnum.USEITEM_SUCCESS)}}}var u=e.rewardResult,d=td.RewardManager.parseRewardResult(u);if(td.GlobalFunction.showRewards(d),0!==u.exp)(e={}).type=td.GoodsType.Type_Item,e.id=td.ItemEnum.Exp,e.count=u.exp,td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,[e]);if(0!==u.vigour)(e={}).type=td.GoodsType.Type_Item,e.id=td.ItemEnum.VIGOUR,e.count=u.vigour,td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,[e]);td.EventUtil.dispatchEvent(td.EventNameEnum.USEITEM_SUCCESS,u)}},_requestBatchCompose:function(t){if(t.type===td.ComposeEnum.HeroExpItem||t.type===td.ComposeEnum.RuneExpItem){var e={};e.module=td.MsgModuleName.GOODS,e.cmd=td.MsgCmd.Goods.SYNTHESIZE_ENERGON,e.type=t.type,e.quality=t.quality,e.count=t.count,td.ServerDelegate.sendMessage(e)}},_onBatchComposeReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.COMPOSE_BATCH_REFRESH,n)}},isGold:function(t){return t==td.ItemEnum.Gold},isDiamond:function(t){return t==td.ItemEnum.Diamond},isHeroExpItem:function(t){return t>=td.ItemEnum.HeroExpItem2&&t<=td.ItemEnum.HeroExpItem6},isHeroEvolveItem:function(t){return t===td.ItemEnum.Gold||t>=td.ItemEnum.HeroEvolveItem2&&t<=td.ItemEnum.HeroEvolveItem7},isHeroRelifeItem:function(t){return t===td.ItemEnum.Gold||t>=td.ItemEnum.HeroRelifeItem1&&t<=td.ItemEnum.HeroRelifeItem8},isEquipUpgradeItem:function(t){return t===td.ItemEnum.Gold},isEquipEvolveItem:function(t){return t===td.ItemEnum.Gold||t===td.ItemEnum.EquipEvolveItem||t>=td.ItemEnum.EquipEvolveItem2&&t<=td.ItemEnum.EquipEvolveItem7},isSummonItem:function(t){return t===td.ItemEnum.SummonHeroItem1||t===td.ItemEnum.SummonHeroItem2||t===td.ItemEnum.SummonHeroItem3},isUpgradeItem:function(t){var e=[],i=td.ItemForCheckType;return this.isSummonItem(t)&&(e[e.length]=i.Summon),e},checkUpgradeItem:function(t){var e=this.isUpgradeItem(t);e&&e.length>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.UPGRADE_ITEM_CHANGE,e)}},cc._RF.pop()},{"../../Chess/Manager/ChessManager":"ChessManager","../../Hero/Manager/HeroManager":"HeroManager","../../Nation/Manager/NationMainManager":"NationMainManager",HeroRuneModel:"HeroRuneModel"}],ItemModel:[function(t,e,i){"use strict";cc._RF.push(e,"5226f51kfBEXKZn/G50HSeu","ItemModel");var n=t("PropertyModel");td.Item=cc.Class({extends:n,properties:{_goodsType:null,_goodsOperateType:null,_goodsSubType:null,_isSelect:null,_isTimesGift:null,_effectValue:null,_quality:null,_desc:null,_sortRank:null,_liIconRes:null,_canBatch:null,_obtainWay:null,_count:null,_useTimes:null,_redPoint:null,_treasureFlag:null,_isResource:null,_showType:null},init:function(t){t&&(this._super("Item",td.UserPropertyEnum.Item,t.goodsId,t.name,t.iconRes,null,t.animationType),this._goodsType=td.GoodsType.Type_Item,this._goodsOperateType=t.goodsType,this._isSelect=!1,this._isTimesGift=!1,this._effectValue=null,this._goodsSubType=t.goodsSubType,t.goodsSubType==td.GoodsSubType.CHOOSE_BAG&&t.goodsEffectType==td.GoodsEffectType.CHOOSE_BAG?(this._isSelect=!0,this._parseSelectId(t.goodsEffectExpr)):t.goodsSubType==td.GoodsSubType.TIMES_BAG&&t.goodsEffectType==td.GoodsEffectType.TIMES_BAG?(this._isTimesGift=!0,this._parseTimesRewards(t.goodsEffectExpr)):this._effectValue=t.goodsEffectExpr,this._quality=t.quality,this._desc=t.desc,this._sortRank=t.sortRank,this._liIconRes=t.liIconRes,this._bigIconRes=t.bigIconRes,this._canBatch=1===t.isRepeat,this._obtainWay=t.obtainWay||[],this._redPoint=1===t.redPoint,this._treasureFlag=t.treasureFlag,this._isResource=1===t.isResource,this._count=0,this._useTimes=0,this._boxUseTips=t.boxUseTips||"",this._showType=t.showType)},getGoodsOperateType:function(){return this._goodsOperateType},getGoodsType:function(){return this._goodsType},getGoodsSubType:function(){return this._goodsSubType},getQuality:function(){return this._quality},getDes:function(){return this._desc},getSortRank:function(){return this._sortRank},getLittleIconRes:function(){var t=gdk.rm.getResByUrl(td.resDef.pngPlist.icon_item,cc.SpriteAtlas);return t?t.getSpriteFrame(this._liIconRes):null},getLittleIconResPath:function(){return this._liIconRes},getPic:function(){return this._bigIconRes},getBigIconResPath:function(){return this._bigIconRes},getCount:function(){return this._count},setCount:function(t){this._count=t},canBatchUse:function(){return this._canBatch},isSelectItem:function(){return this._isSelect},isTimesGift:function(){return this._isTimesGift},getEffectValue:function(){return this._effectValue},getObtainWay:function(){return this._obtainWay},getTreasureFlag:function(){return this._treasureFlag},_parseSelectId:function(t){t.length<2||(this._effectValue=t[1])},_parseTimesRewards:function(t){if(!(t.length<2)){var e=t[1];this._effectValue=parseInt(e[0]||0)}},showRedPoint:function(){return this._redPoint},isResource:function(){return this._isResource},setUseTimes:function(t){this._useTimes=t},getUseTimes:function(){return this._useTimes},getLeftSpecialUseTimes:function(){var t=this.getUseTimes(),e=this.getEffectValue();return e-t%e},getBoxUseTips:function(){return this._boxUseTips},getShowType:function(){return this._showType}}),cc._RF.pop()},{PropertyModel:"PropertyModel"}],ItemTable:[function(t,e,i){"use strict";cc._RF.push(e,"10a75OF6shDx4qfTjQXVT15","ItemTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ItemTable",properties:{_tblName:"goods_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];a.iconRes&&(a.iconRes=a.iconRes),a.liIconRes&&(a.liIconRes=a.liIconRes),t[a.goodsId]=a}},getItemTable:function(){return this._data},getItemById:function(t){return this._data[t]},getItemBySubType:function(t){var e=[];for(var i in this._data)this._data[i].goodsSubType==t&&e.push(this._data[i]);return e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],KDChapterModel:[function(t,e,i){"use strict";cc._RF.push(e,"4871fNeyNJP6oa42GleZcnO","KDChapterModel"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}],KDDamageRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"7f199RAIrhPz5MMVuSyTe6Y","KDDamageRewardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"KDDamageRewardTable",properties:{_tblName:"dragon_damage_task_config",_data:null},init:function(){this._data={};for(var t=0,e=this._jsonData.length;t<e;t++){var i=this._jsonData[t],n=i.groupId;this._data[n]=this._data[n]||[],this._data[n].push(i)}},getDamageTaskCfgsByGroupId:function(t){return this._data[t]?this._data[t]:[]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],KDDamageTaskModel:[function(t,e,i){"use strict";cc._RF.push(e,"bdd740RklFGgo2/9i2A8v6k","KDDamageTaskModel"),td.KDDamageTaskModel=cc.Class({properties:{_groupId:null,_taskId:null,_damage:null,_rewards:null,_rewardState:null},init:function(t){this._rewardState=td.KDEnum.RewardState.canNotGet,this._groupId=t.groupId,this._taskId=t.taskId,this._damage=t.damage,this._rewards=td.RewardManager.parseRewardListDetail(t.rewards)},getGroupId:function(){return this._groupId},getTaskId:function(){return this._taskId},getDamage:function(){return this._damage},getTaskRewards:function(){return this._rewards},setReceivedStatus:function(t){this._rewardState=t},getReceivedStatus:function(){return this._rewardState}}),cc._RF.pop()},{}],KDEnum:[function(t,e,i){"use strict";cc._RF.push(e,"98b20MOYfZBq4w20SDQYdaY","KDEnum"),td.KDEnum={DragonBossState:{None:0,Fighting:1,Rest:2},RewardState:{canNotGet:1,canGet:2,Gotten:3},PageShowType:{DamageType:1,PreviewType:2}},cc._RF.pop()},{}],KDKillTaskModel:[function(t,e,i){"use strict";cc._RF.push(e,"afdeaSS7G1DgoYGbSy4ND60","KDKillTaskModel"),td.KDKillTaskModel=cc.Class({properties:{_count:null,_rewards:null,_rewardState:null},init:function(t){this._rewardState=td.KDEnum.RewardState.canNotGet,this._count=t[0],this._rewards=td.RewardManager.parseRewardListDetail(t[1])},getCount:function(){return this._count},getTaskRewards:function(){return this._rewards},setReceivedStatus:function(t){this._rewardState=t},getReceivedStatus:function(){return this._rewardState}}),cc._RF.pop()},{}],KDLevelRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"0c65c3MJpRABpAW6y/sHvOI","KDLevelRewardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"KDLevelRewardTable",properties:{_tblName:"dragon_level_reward_config",_data:null},init:function(){this._data=[];for(var t=0,e=this._jsonData.length;t<e;t++){var i=this._jsonData[t],n=this._jsonData[t+1],a=i.level,r=9999;n&&(r=n.level-1),i.formLevel=a,i.toLevel=r,this._data.push(i)}},getAllLevelRewardCfgs:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],KDPersonalChapterTable:[function(t,e,i){"use strict";cc._RF.push(e,"7f7cd9NPDlMMLaeDYbEBCe0","KDPersonalChapterTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"KDPersonalChapterTable",properties:{_tblName:"dragon_person_chapter_config",_chapterData:null},init:function(){this._chapterData=[];for(var t=0,e=this._jsonData.length;t<e;t++){var i=this._jsonData[t];this._chapterData.push(i)}},getAllChapterCfgs:function(){return this._chapterData}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],KDPersonalCopyTable:[function(t,e,i){"use strict";cc._RF.push(e,"43f4fO0Q1lGGaVzoLsPZTnT","KDPersonalCopyTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"KDPersonalCopyTable",properties:{_tblName:"dragon_person_boss_config",_copyData:null},init:function(){this._copyData={};for(var t=0,e=this._jsonData.length;t<e;t++){var i=this._jsonData[t],n=i.chapterId;this._copyData[n]=this._copyData[n]||[],this._copyData[n].push(i)}},getAllCopyCfgs:function(){return this._copyData},getCopyDataByChapterId:function(t){return this._copyData[t]?this._copyData[t]:[]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],KDRankRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"6e13dFdcn1FrY3lxQDieZPr","KDRankRewardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"KDRankRewardTable",properties:{_tblName:"dragon_rank_reward_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;i++){var a=e[i];t[t.length]=a}t.sort(function(t,e){return t.rank-e.rank});for(var r=0,o=t.length;r<o;r++){var s=t[r];s.maxRank=s.rank,s.minRank=t[r-1]?t[r-1].rank+1:s.rank}},getAllRankRewardCfgs:function(){return this._data},getCfgDataByRank:function(t){if(this._data)for(var e=this._data,i=0,n=e.length;i<n;i++){var a=e[i];if(a.minRank<=t&&a.maxRank>=t)return a}return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],KillDragonManager:[function(t,e,i){"use strict";cc._RF.push(e,"d9875PuoDRMMbwRPZzaszku","KillDragonManager");var n=t("CommonEnum");td.KillDragonManager={_curDragonBossState:null,_curDragonGroupId:null,_curDragonBossId:null,_curCloseTime:null,_curDragonBossLeftHp:null,_damageLogList:null,_bRefreshLog:null,_curLeftTimes:null,_boughtTimes:null,_curDamage:null,_totalDamage:null,_curDamageTaskList:null,_receiveList:null,_personalCopyResetTime:null,_personalChallengedTimes:null,_personalCopyBoughtTimes:null,_bInit:null,_chapterDataList:null,_select:null,_curChallengeTimes:0,_timesDamageMapList:[],_isSweep:!1,init:function(){this.destroyData(),this._addNetListeners(),this._addLocalListeners()},destroyData:function(){this._curDragonBossState=td.KDEnum.DragonBossState.None,this._curDragonGroupId=0,this._curDragonBossId=0,this._curCloseTime=0,this._curDragonBossLeftHp=0,this._damageLogList=[],this._bRefreshLog=!1,this._curLeftTimes=0,this._boughtTimes=0,this._curDamage=0,this._totalDamage=0,this._curDamageTaskList=[],this._receiveList=[],this._personalCopyResetTime=0,this._personalChallengedTimes=0,this._personalCopyBoughtTimes=0,this._bInit=!1,this._chapterDataList=[],this._curSendChallengeTimes=0,this._timesDamageMapList=[],this._isSweep=!1},_addNetListeners:function(){var t=td.ServerDelegate,e=td.MsgModuleName.KillDragon,i=td.MsgCmd.KILL_DRAGON;t.registerMessage(e,i.GET_DRAGON_BOSS_INFO,this.receiveDragonBossInfo.bind(this)),t.registerMessage(e,i.GET_DRAGON_PLAYER_INFO,this.receiveDragonPlayerInfo.bind(this)),t.registerMessage(e,i.REQ_CHALLENGE_DRAGON,this.challengeDragonReturn.bind(this)),t.registerMessage(e,i.BUY_KILL_DRAGON_TIMES,this.buyKillDragonTimesReturn.bind(this)),t.registerMessage(e,i.GET_DRAGON_DAMAGE_RANK,this.receiveDragonDamageRankInfo.bind(this)),t.registerMessage(e,i.GET_DAMAGE_TASK_REWARD,this.receiveDamageTaskReward.bind(this)),t.registerMessage(e,i.QUICKLY_GET_DAMAGE_TASK_REWARD,this.receiveDamageTaskReward.bind(this)),t.registerMessage(e,i.GET_DRAGON_RECEIVE_PROGRESS_REWARD,this.receiveProgressReward.bind(this)),t.registerMessage(e,i.PUSH_DRAGON_BOSS_INFO,this.pushDragonBossInfo.bind(this)),t.registerMessage(e,i.PUSH_DRAGON_PLAYER_INFO,this.pushDragonPlayerInfo.bind(this)),t.registerMessage(e,i.PUSH_DRAGON_SWEEP,this.pushDragonSweepResultInfo.bind(this))},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.QUERY_KILL_DRAGON_INFO]=this.queryKillDragonInfo,i[e.QUERY_DRAGON_DAMAGE_RANK_INFO]=this.queryDragonDamageRank,i[e.REQ_GET_DAMAGE_TASK_REWARD]=this.requestGetDamageTaskReward,i[e.REQ_QUICKLY_GET_DAMAGE_TASK_REWARD]=this.requestQuicklyGetDamageTaskReward,i[e.REQ_KILL_DRAGON_BOSS]=this.requestChallengeDragon,i[e.REQ_BUY_DRAGON_CHALLENGE_TIMES]=this.requestBuyKillDragonTimes,i[e.REQ_GET_KILL_DRAGON_COUNT_REWARD]=this.requestGetProgressReward,t.registerEvents(i,this)},getKillDragonStatus:function(){return this._curDragonBossState},getDragonLeftHp:function(){return this._curDragonBossLeftHp},getCurDamageTaskList:function(){return this._curDamageTaskList},getCurTotalKDDamage:function(){return this._curDamage},getCurDragonBossId:function(){return this._curDragonBossId},getReceiveList:function(){return this._receiveList},getSelect:function(){return this._select},setSelect:function(t){this._select=t},setCurSendChallengeChallengeTimes:function(t,e){void 0===e&&(e=1),this._isSweep=t,this._curSendChallengeTimes=e,1!==this._curSendChallengeTimes&&(this._timesDamageMapList=[])},getCurSendChallengeTimes:function(){return this._curSendChallengeTimes},isSweep:function(){return this._isSweep},getDragonKillReward:function(){return td.GetConfig("DRAGON_PROGRESS_REWARD")},_parseDragonBossInfo:function(t){var e=t.state,i=t.bossId;this._curCloseTime=t.closeTime,this._curDragonBossLeftHp=t.leftHP;var n=t.damageRecordList,a=!1;e===this._curDragonBossState&&i===this._curDragonBossId||(a=!0),this._curDragonBossId=t.bossId,this._curDragonBossState=t.state,this._setBossHurtLogInfo(n),a&&td.EventUtil.dispatchEvent(td.EventNameEnum.DRAGON_INFO_CHANGE),td.EventUtil.dispatchEvent(td.EventNameEnum.REC_KILL_DRAGON_INFO)},getCivilKDTotalChallengeTimes:function(){var t=td.GetConfig("DRAGON_ATTACK_FREE_TIMES");return this._boughtTimes+t},getCivilKDLeftChallengeTimes:function(){return this._curLeftTimes},getCivilKDBoughtTimes:function(){return this._boughtTimes},calcBuyCivilKDChallengeTimesCost:function(t){for(var e,i=td.GlobalFunction,n="DRAGON_ATTACK_TIMES_BUY_COST",a=1+this._boughtTimes;a<=t+this._boughtTimes;a++)e?e.setCount(e.getCount()+i.getShareConfigUpCostCount(n,a)):e=i.getShareConfigUpCostDetail(n,a);return e},_parseDragonPlayerInfo:function(t){this._curLeftTimes=t.remainTimes,this._boughtTimes=t.buyTimes,this._curDamage=t.damage,this._totalDamage=t.totalDamage,this._receiveList=t.receiveList,this._curDamageTaskList=[];for(var e=t.damageTaskGroupId,i=t.damageTaskList,n=td.GetTableClass(td.TableEnum.KDDamageRewardTable).getDamageTaskCfgsByGroupId(e),a=0,r=n.length;a<r;a++){var o=n[a],s=new td.KDDamageTaskModel;s.init(o);for(var l=s.getTaskId(),c=s.getDamage()<=this._curDamage?td.KDEnum.RewardState.canGet:td.KDEnum.RewardState.canNotGet,u=0,d=i.length;u<d;u++){if(i[u]===l){c=td.KDEnum.RewardState.Gotten;break}}s.setReceivedStatus(c),this._curDamageTaskList.push(s)}td.EventUtil.dispatchEvent(td.EventNameEnum.REC_DRAGONL_PLAYER_INFO)},queryKillDragonInfo:function(){this.queryDragonBossInfo(),this.queryDragonPlayerInfo()},queryDragonBossInfo:function(){var t={};t.module=td.MsgModuleName.KillDragon,t.cmd=td.MsgCmd.KILL_DRAGON.GET_DRAGON_BOSS_INFO,td.ServerDelegate.sendMessage(t)},receiveDragonBossInfo:function(t,e){t===td.NetCode.SUCCESS&&this._parseDragonBossInfo(e)},queryDragonPlayerInfo:function(){var t={};t.module=td.MsgModuleName.KillDragon,t.cmd=td.MsgCmd.KILL_DRAGON.GET_DRAGON_PLAYER_INFO,td.ServerDelegate.sendMessage(t)},receiveDragonPlayerInfo:function(t,e){t===td.NetCode.SUCCESS&&this._parseDragonPlayerInfo(e)},requestChallengeDragon:function(){var t={};t.module=td.MsgModuleName.KillDragon,t.cmd=td.MsgCmd.KILL_DRAGON.REQ_CHALLENGE_DRAGON,t.sweep=this._isSweep,td.ServerDelegate.sendMessage(t)},challengeDragonReturn:function(t,e){td.NetCode.SUCCESS},requestBuyKillDragonTimes:function(t){var e={};e.module=td.MsgModuleName.KillDragon,e.cmd=td.MsgCmd.KILL_DRAGON.BUY_KILL_DRAGON_TIMES,e.times=t,td.ServerDelegate.sendMessage(e)},buyKillDragonTimesReturn:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.REC_BUY_DRAGON_CHALLENGE_TIMES)},queryDragonDamageRank:function(){var t={};t.module=td.MsgModuleName.KillDragon,t.cmd=td.MsgCmd.KILL_DRAGON.GET_DRAGON_DAMAGE_RANK,td.ServerDelegate.sendMessage(t)},receiveDragonDamageRankInfo:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.REC_DRAGON_DAMAGE_RANK_INFO,e)},requestGetDamageTaskReward:function(t){var e={};e.module=td.MsgModuleName.KillDragon,e.cmd=td.MsgCmd.KILL_DRAGON.GET_DAMAGE_TASK_REWARD,e.taskId=t,td.ServerDelegate.sendMessage(e)},requestQuicklyGetDamageTaskReward:function(){var t={};t.module=td.MsgModuleName.KillDragon,t.cmd=td.MsgCmd.KILL_DRAGON.QUICKLY_GET_DAMAGE_TASK_REWARD,td.ServerDelegate.sendMessage(t)},receiveDamageTaskReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult);td.GlobalFunction.showRewards(i),td.EventUtil.dispatchEvent(td.EventNameEnum.GET_DAMAGE_TASK_REWARD_RETURN)}},requestGetProgressReward:function(t){var e={};e.module=td.MsgModuleName.KillDragon,e.cmd=td.MsgCmd.KILL_DRAGON.GET_DRAGON_RECEIVE_PROGRESS_REWARD,e.monsterId=t,td.ServerDelegate.sendMessage(e)},receiveProgressReward:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.REC_GET_KILL_DRAGON_COUNT_REWARD,e)},pushDragonBossInfo:function(t,e){t===td.NetCode.SUCCESS&&this._parseDragonBossInfo(e)},pushDragonPlayerInfo:function(t,e){t===td.NetCode.SUCCESS&&this._parseDragonPlayerInfo(e)},pushDragonSweepResultInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i),a={};a.damage=e.damage,a.rewards=n,td.EventUtil.dispatchEvent(td.EventNameEnum.RES_KILL_DRAGON_SWEEP,a)}},getBossHurtLogInfo:function(){return this._damageLogList},isNeedRefreshHurtReport:function(){return this._bRefreshLog},resetRefreshHurtReportStatus:function(){this._bRefreshLog=!1},_setBossHurtLogInfo:function(t){if(t&&0!==t.length){var e=this._parseRecordList(t);if(this._damageLogList&&0!==this._damageLogList.length){for(var i=!1,n=0,a=e.length;n<a;n++){var r=e[n].recordTime;if(i=this._checkIsNeedRefresh(r))break}this._bRefreshLog=i}else this._bRefreshLog=!0;this._damageLogList=e}else this._damageLogList=[]},_checkIsNeedRefresh:function(t){for(var e=0,i=this._damageLogList.length;e<i;e++){if(this._damageLogList[e].recordTime===t)return!1}return!0},_parseRecordList:function(t){for(var e=[],i=td.Language.worldBossChanllageLog,n=0,a=t.length;n<a;n++){var r=t[n],o=r.attributes,s=r.damage,l=r.time,c=r.bossId,u=td.GetTableClass(td.TableEnum.Monster).getMonsterDataById(c),d=(u=td.GetTableClass(td.TableEnum.MonsterTypeConfig).getMonsterTypeDataByType(u.type))?u.name:"",h=o[td.UserPropertyEnum.NickName],p={strLog:cc.js.formatStr(i,h,d,s),recordTime:parseFloat(l)};e.push(p)}return e.sort(function(t,e){return t.recordTime-e.recordTime}),e},_initChapterData:function(){this._chapterDataList=[];for(var t=td.GetTableClass(td.TableEnum.KDPersonalChapterTable).getAllChapterCfgs(),e=0,i=t.length;e<i;e++){var n=t[e],a=new td.KDPersonalChapterModel;a.init(n),this._chapterDataList.push(a)}this._chapterDataList.sort(function(t,e){return t.getChapterId()-e.getChapterId()})},getChapterDataList:function(){return this._bInit||(this._initChapterData(),this._bInit=!0),this._chapterDataList},getChapterDataById:function(t){for(var e=null,i=0,n=this._chapterDataList.length;i<n;i++){var a=this._chapterDataList[i];if(a.getChapterId()===t){e=a;break}}return e},getPersonalDragonTotalTimes:function(){var t=td.GetConfig("DRAGON_CHAPTER_ATTACK_FREE_TIMES");return this._personalCopyBoughtTimes+t},getPersonalDragonLeftTimes:function(){return this.getPersonalDragonTotalTimes()-this._personalChallengedTimes},getPersonalTargetBuyTimesVip:function(){var t=td.Account.getUserData().vip,e=td.GetTableClass(td.TableEnum.VipPrivilegeTable).getPrerogativeByTypeAndOpenValue(n.PrerogativeEnum.PersonalDragonCopyBuyTimes),i=0;for(var a in e){var r=e[a].privilegeOpenValue;if(r>t){i=r;break}}return i},getCanBuyLeftPersonalTimes:function(){var t=td.Account.getUserData().vip,e=td.GetTableClass(td.TableEnum.VipPrivilegeTable).getPrerogativeByTypeAndOpenValue(n.PrerogativeEnum.PersonalDragonCopyBuyTimes),i=0;for(var a in e){var r=e[a].privilegeOpenValue;if(r>t)break;i=r}var o=e[i],s=0;o&&o.value&&(s=o.value);for(var l=0,c=td.Account.getUserData().getDiamond(),u=1;u<=s;u++)if((l+=this.getBuyPersonalCopyChallengeTimesPrice(u))>c){s=u-1;break}return s-this._personalCopyBoughtTimes<=0?0:s-this._personalCopyBoughtTimes},getBuyPersonalCopyChallengeTimesPrice:function(t){for(var e=td.GetConfig("DRAGON_CHAPTER_ATTACK_TIMES_BUY_COST"),i=0,n=0,a=e.length-1;n<=a;n++){var r=e[n][0],o=td.RewardManager.getRewardDetail(e[n][1]);if(r>t)break;i=o.getCount()}return i},calcBuyPersonalCopyTimesCost:function(t){for(var e=0,i=1;i<=t;i++)e+=this.getBuyPersonalCopyChallengeTimesPrice(i);return e},_parsePersonalDragonCopyInfo:function(t){this._bInit||(this._initChapterData(),this._bInit=!0),this._personalCopyResetTime=t.nextMonsterResetTime,this._personalChallengedTimes=t.challengeTimes,this._personalCopyBoughtTimes=t.buyTimes;for(var e=t.dragonChapterList,i=0,n=e.length;i<n;i++)for(var a=e[i],r=a.chapterId,o=a.monsterMap,s=a.passRewardPosIdList,l=a.randomRewardResultList,c=a.randomRewardTimes,u=0,d=this._chapterDataList.length;u<d;u++){var h=this._chapterDataList[u];h.getChapterId()===r&&(h.setPosMonsterData(o),h.setRandomCardRewardList(l),h.setFlopCardTimes(c),h.setCopyPassRewardStatus(s))}td.EventUtil.dispatchEvent(td.EventNameEnum.REC_PERSONAL_DRAGON_COPY_INFO)},queryPersonalDragonCopyInfo:function(){var t={};t.module=td.MsgModuleName.KillDragon,t.cmd=td.MsgCmd.KILL_DRAGON.GET_PERSONAL_DRAGON_COPY_INFO,td.ServerDelegate.sendMessage(t)},receivePersonalDragonCopyInfo:function(t,e){t===td.NetCode.SUCCESS&&this._parsePersonalDragonCopyInfo(e)},requestChallengePersonalDragonCopy:function(t){var e={};e.module=td.MsgModuleName.KillDragon,e.cmd=td.MsgCmd.KILL_DRAGON.REQ_CHALLENGE_PERSONAL_DRAGON,e.chapterId=t.chapterId,e.posId=t.posId,td.ServerDelegate.sendMessage(e)},challengePersonalDragonCopyReturn:function(t,e){td.NetCode.SUCCESS},requestGetKillReward:function(t){var e={};e.module=td.MsgModuleName.KillDragon,e.cmd=td.MsgCmd.KILL_DRAGON.GET_DRAGON_KILL_REWARD,e.chapterId=t.chapterId,e.posId=t.posId,td.ServerDelegate.sendMessage(e)},receiveKillRewardReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult);td.EventUtil.dispatchEvent(td.EventNameEnum.REC_GET_DRAGON_KILL_REWARD,i)}},requestChapterPassedFlopCard:function(t){var e={};e.module=td.MsgModuleName.KillDragon,e.cmd=td.MsgCmd.KILL_DRAGON.CHAPTER_PASSED_FLOP_CARD,e.chapterId=t,td.ServerDelegate.sendMessage(e)},receiveFlopCardReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult);td.EventUtil.dispatchEvent(td.EventNameEnum.REC_CHAPTER_PASSED_FLOP_CARD_REWARD,i[0])}},requestBuyPersonalChallengeTimes:function(t){var e={};e.module=td.MsgModuleName.KillDragon,e.cmd=td.MsgCmd.KILL_DRAGON.BUY_PERSONAL_CHALLENGE_TIMES,e.times=t,td.ServerDelegate.sendMessage(e)},buyPersonalChallengeTimesReturn:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.REC_BUY_PERSONAL_CHALLENGE_TIMES)},pushPersonalDragonCopyInfo:function(t,e){t===td.NetCode.SUCCESS&&this._parsePersonalDragonCopyInfo(e)},getPersonalCopyResetStrTime:function(){var t=td.TimeUtil.getTime(),e=this._personalCopyResetTime-t;return e<=0?(this.queryPersonalDragonCopyInfo(),""):td.GlobalFunction.getTimeStringByDeltaTime(e)},getKillDragonEndStrTime:function(){var t=td.TimeUtil.getTime(),e=this._curCloseTime-t;return td.GlobalFunction.getTimeStringByDeltaTime(e)},getKillDragonEndTime:function(){var t=td.TimeUtil.getTime();return this._curCloseTime-t},isCivilKillDragonRedPointTips:function(){if(!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Dragon,1,!1))return!1;if(this.isCivilKDDamageRewardRedPointTips())return!0;for(var t=!1,e=td.GetTableClass(td.TableEnum.DragonBossTable).getList(),i=0;i<e.length;i++){var n=e[i].monsterId;if(n<this._curDragonBossId&&(!this._receiveList||-1===this._receiveList.indexOf(n))){t=!0;break}}return!!t||this.getKillDragonStatus()!==td.KDEnum.DragonBossState.Rest&&this.getCivilKDLeftChallengeTimes()>0},isCivilKDDamageRewardRedPointTips:function(){for(var t=this.getCurDamageTaskList(),e=0,i=t.length;e<i;e++){if(t[e].getReceivedStatus()===td.KDEnum.RewardState.canGet)return!0}return!1},isCivilKDKilledRewardRedPointTips:function(){if(!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Dragon,1,!1))return!1;var t=this._curKillDragonTaskList;if(!t||0===t.length)return!1;for(var e=td.KDEnum.RewardState.canGet,i=0,n=t.length;i<n;i++){if(t[i].getReceivedStatus()===e)return!0}return!1},civilKilledRewardRedPointEvents:function(){return[td.EventNameEnum.REC_KILL_DRAGON_INFO,td.EventNameEnum.REC_DRAGONL_PLAYER_INFO]},civilKillDragonRedPointEvents:function(){return this.civilKilledRewardRedPointEvents().concat([td.EventNameEnum.REC_BUY_DRAGON_CHALLENGE_TIMES,td.EventNameEnum.GET_DAMAGE_TASK_REWARD_RETURN])}},cc._RF.pop()},{CommonEnum:void 0}],KingdomTreasureController:[function(t,e,i){"use strict";cc._RF.push(e,"9a7820fqV9LH7FeJD3uzePo","KingdomTreasureController");var n=t("FamousGeneralShopController"),a=t("KingdomTreasureModel"),r=cc.Class({extends:n,activityParse:function(t){var e=t.record,i=e.level,n=e.vipLevel,r=e.day,o=e.buyMap,s=this.getActivityData();this._modelList=[];var l=td.GetTableClass(td.TableEnum.FamousGeneralShopTable).getDataByDataIdAndDay(s,r);if(l)for(var c in l){var u=l[c];if(u.minLevel<i&&i<=u.maxLevel&&td.Account.getUserData().vip>=n){var d=new a;d.initData(l[c]),o[c]&&d.setExchangeTimes(o[c]),this._modelList.push(d)}}}});e.exports=r,cc._RF.pop()},{FamousGeneralShopController:"FamousGeneralShopController",KingdomTreasureModel:"KingdomTreasureModel"}],KingdomTreasureListView:[function(t,e,i){"use strict";cc._RF.push(e,"54b3crach5CeLKdZpuge36i","KingdomTreasureListView");var n=t("FamousGeneralShopListView"),a=cc.Class({extends:n,setItemView:function(t,e){if(e&&t){var i=t.getChildByName("labOddTimes"),n=t.getChildByName("labOwn"),a=t.getChildByName("labNeed"),r=e.getExchangeTimes(),o=e.getTotalTimes(),s=e.getConsume(),l=e.getReward();i.getComponent(cc.Label).string=td.Language.leftTimes+(o-r)+"/"+o;var c=t.getChildByName("consume");c&&c.removeFromParent();var u=s[0],d=td.GlobalFunction.createCommonIconWidget(2,u);d.scale=.7,d.name="consume",d.setPosition(cc.v2(-270,10)),t.addChild(d);var h=u.getId(),p=u.getCount(),_=td.ItemManager.getItemNumById(h);n.getComponent(cc.Label).string=_,a.getComponent(cc.Label).string=p;var g,f,v=_<p?cc.color(255,0,0):cc.color(0,255,0);for(n.color=v,g=0,f=l.length;g<f;g++){var m=t.getChildByName("reward"+g);m&&m.removeFromParent()}for(g=0,f=l.length;g<f;g++){var y=l[g],E=td.GlobalFunction.createCommonIconWidget(26,y);E.name="reward"+g,E.scale=.7,E.setPosition(cc.v2(145*g*.7-70,10)),t.addChild(E)}return this.setOperationBtn(t,e),t}}});e.exports=a,cc._RF.pop()},{FamousGeneralShopListView:"FamousGeneralShopListView"}],KingdomTreasureModel:[function(t,e,i){"use strict";cc._RF.push(e,"f579dIA9elHgYGgD/jBy52M","KingdomTreasureModel");var n=t("FamousGeneralShopModel"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{FamousGeneralShopModel:"FamousGeneralShopModel"}],KingdomTreasurePanel:[function(t,e,i){"use strict";cc._RF.push(e,"3079crElJ9Al684SkAIQQnI","KingdomTreasurePanel");var n=t("FamousGeneralShopPanel"),a=cc.Class({extends:n,properties:{_listViewLogic:null},initData:function(t){this._super(t)},onLoad:function(){var t=this.node.getChildByName("itemWidget").getChildByName("scrollView");this._listViewLogic=t.getComponent("KingdomTreasureListView")},_setActivityTime:function(){}});e.exports=a,cc._RF.pop()},{FamousGeneralShopPanel:"FamousGeneralShopPanel"}],LanguageTable:[function(t,e,i){"use strict";cc._RF.push(e,"39506XQpcpPpbjcU7BinttV","LanguageTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"A_Translate",properties:{_tblName:"A_translate",_VipData:null,_maxVipLevel:null},init:function(){td.Language=this._jsonData}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LegendDailyRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"23118LMOudL+IqOx1Xixf5Q","LegendDailyRewardTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="LegendDailyRewardTable",e._tblName="legend_day_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t.push(a)}this._data.sort(function(t,e){return t.id-e.id})},e.prototype.getDatas=function(){return this._data},e.prototype.getRewardsByGroupId=function(t){if(!this._data)return[];for(var e=[],i=0;i<this._data.length;i++){var n=this._data[i];n.groupId==t&&e.push(n)}return e.sort(function(t,e){return t.id-e.id}),e},e.prototype.getDailyCfgById=function(t){if(!this._data)return null;for(var e=0;e<this._data.length;e++){var i=this._data[e];if(i.id==t)return i}return null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LegendDanTable:[function(t,e,i){"use strict";cc._RF.push(e,"2b9advreCZCdKzcffbcif/O","LegendDanTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="LegendDanTable",e._tblName="legend_dan_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t.push(a)}this._data.sort(function(t,e){return t.dan-e.dan})},e.prototype.getDanList=function(){return this._data},e.prototype.getDanCfgByDanId=function(t){if(!this._data)return null;for(var e=0;e<this._data.length;e++){var i=this._data[e];if(i.dan==t)return i}return null},e.prototype.getDanCfgByScore=function(t){if(!this._data)return null;for(var e=this._data.length-1;e>=0;e--){var i=this._data[e];if(t>=i.score)return i}return null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LegendEnum:[function(t,e,i){"use strict";cc._RF.push(e,"698d6c7iO5BQpQklt2qbwRj","LegendEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.LEGEND_REWARD_BOX_GROUP=i.LEGEND_RANK_CHANGE_TYPE=i.LEGEND_REPORT_TYPE=i.LEGEND_RANK_TYPE=i.SEASON_RANK_ITEM=i.REPORT_ITEM_TYPE=i.LEGEND_STATE=void 0,function(t){t[t.PREPARE=1]="PREPARE",t[t.BATTLE=2]="BATTLE",t[t.SLEEP=3]="SLEEP"}(i.LEGEND_STATE||(i.LEGEND_STATE={})),function(t){t[t.PRIVATE_REPORT=1]="PRIVATE_REPORT",t[t.AUTO_REPORT=2]="AUTO_REPORT",t[t.TOP_REPORT=3]="TOP_REPORT"}(i.REPORT_ITEM_TYPE||(i.REPORT_ITEM_TYPE={})),function(t){t[t.MY_AREA=td.MsgCmd.LEGEND.LEGEND_SERVER_RANK]="MY_AREA",t[t.AREAS=td.MsgCmd.LEGEND.LEGEND_ZONE_RANK]="AREAS",t[t.ALL_AREAS=td.MsgCmd.LEGEND.LEGEND_GLOBAL_RANK]="ALL_AREAS"}(i.SEASON_RANK_ITEM||(i.SEASON_RANK_ITEM={})),function(t){t[t.SERVER_RANK=td.MsgCmd.LEGEND.LEGEND_SERVER_RANK]="SERVER_RANK",t[t.ZONE_RANK=td.MsgCmd.LEGEND.LEGEND_ZONE_RANK]="ZONE_RANK",t[t.GLOBAL_RANK=td.MsgCmd.LEGEND.LEGEND_GLOBAL_RANK]="GLOBAL_RANK",t[t.ZONE_GOD_RANK=td.MsgCmd.LEGEND.LEGEND_SEASON_ZONE_GOD_RANK]="ZONE_GOD_RANK",t[t.GLOBAL_GOD_RANK=td.MsgCmd.LEGEND.LEGEND_SEASON_GLOBAL_GOD_RANK]="GLOBAL_GOD_RANK",t[t.ZONE_FLOATING_RANK=td.MsgCmd.LEGEND.LEGEND_ZONE_FLOATING_RANK]="ZONE_FLOATING_RANK",t[t.GLOBAL_FLOATING_RANK=td.MsgCmd.LEGEND.LEGEND_GLOBAL_FLOATING_RANK]="GLOBAL_FLOATING_RANK"}(i.LEGEND_RANK_TYPE||(i.LEGEND_RANK_TYPE={})),function(t){t[t.SELF_REPORTS=td.MsgCmd.LEGEND.LEGEND_BATTLE_REPORT]="SELF_REPORTS",t[t.ZONE_TOP_REPORTS=td.MsgCmd.LEGEND.LEGEND_ZONE_BATTLE_REPORT]="ZONE_TOP_REPORTS",t[t.GLOBAL_TOP_REPORTS=td.MsgCmd.LEGEND.LEGEND_GLOBAL_BATTLE_REPORT]="GLOBAL_TOP_REPORTS"}(i.LEGEND_REPORT_TYPE||(i.LEGEND_REPORT_TYPE={})),function(t){t[t.NEW_IN=1]="NEW_IN",t[t.UN_CHANGE=2]="UN_CHANGE",t[t.UP=3]="UP",t[t.DOWN=4]="DOWN"}(i.LEGEND_RANK_CHANGE_TYPE||(i.LEGEND_RANK_CHANGE_TYPE={})),function(t){t[t.NORMAL=1001]="NORMAL",t[t.MIDDLE=1002]="MIDDLE",t[t.HIGH=1003]="HIGH"}(i.LEGEND_REWARD_BOX_GROUP||(i.LEGEND_REWARD_BOX_GROUP={})),cc._RF.pop()},{}],LegendManager:[function(t,e,i){"use strict";cc._RF.push(e,"ca924+HaN5NQrVjPW671JQN","LegendManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("./../Model/LegendRankModel"),a=t("../Enum/LegendEnum"),r=t("../Model/LegendReportModel"),o=t("../../Title/Enum/TitleEnum"),s=(t("TitleTable"),function(){function t(){this._state=0,this._seasonMaxDan=0,this._dayMatchTimes=0,this._dayVictoryTimes=0,this._dayScore=0,this._adored=!1,this._dayReceiveList=[],this._seasonReceiveList=[],this._season=0,this._endTime=0,this._dan=0,this._score=0,this._preDan=0,this._defenceTimes=0,this._preSeasonDan=0,this._serverRank=0,this._zoneRank=0,this._globalRank=0,this._changeServerRank=0,this._rankListMap={},this._reportListMap={},this._curSelectSeason=0,this._isAutoFight=!1,this._isReplay=!1,this._isModelShowReady=!1,this._reportTmp=null,this._resultChangeScore=0,this._autoFightList=[],this._danChangeParam=null,this._seasonDanChangeParam=null,this._recordSelectRankType=a.LEGEND_RANK_TYPE.SERVER_RANK,this._recordCancelAuto=!1,this._myRanksMap={},this._isSelfAttacked=!1,this._isOnlineSelfAttacked=!1,this._isInLegendPanel=!1,this._isIngnorDanChange=!1,this._isSelfReportRequested=!1,this._isSeasonDanChangeShow=!1,this._destinationPanel=0,this.MAX_SELF_REPORT=0,this._autoFightStartDan=-1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.destroyData(),this.addListener(),this.addEventListener(),this.initData()},t.prototype.destroyData=function(){this._state=0,this._seasonMaxDan=0,this._dayMatchTimes=0,this._dayVictoryTimes=0,this._dayScore=0,this._adored=!1,this._dayReceiveList=[],this._seasonReceiveList=[],this._season=0,this._endTime=0,this._dan=0,this._score=0,this._preDan=0,this._defenceTimes=0,this._preSeasonDan=0,this._rankListMap={},this._reportListMap={},this._curSelectSeason=0,this._isAutoFight=!1,this._isReplay=!1,this._isModelShowReady=!1,this._reportTmp=null,this._autoFightList=[],this._danChangeParam=null,this._seasonDanChangeParam=null,this._recordSelectRankType=a.LEGEND_RANK_TYPE.SERVER_RANK,this._recordCancelAuto=!1,this._myRanksMap={},this._isSelfAttacked=!1,this._isOnlineSelfAttacked=!1,this._isInLegendPanel=!1,this._isIngnorDanChange=!1,this._isSelfReportRequested=!1,this._isSeasonDanChangeShow=!1,this._destinationPanel=0},t.prototype.addListener=function(){var t=td.ServerDelegate,e=td.MsgModuleName.LEGEND,i=td.MsgCmd.LEGEND;t.registerMessage(e,i.LEGEND_GET_ACTOR,this._onGetActorInfo.bind(this)),t.registerMessage(e,i.LEGEND_GET_INFO,this._onGetSeasonInfo.bind(this)),t.registerMessage(e,i.LEGEND_GET_PLAYER,this._onGetPlayerInfo.bind(this)),t.registerMessage(e,i.LEGEND_BATTLE,this._onGetBattleInfo.bind(this)),t.registerMessage(e,i.LEGEND_RECEIVE_DAY_REWARD,this._onReceiveReward.bind(this)),t.registerMessage(e,i.LEGEND_RECEIVE_SEASON_REWARD,this._onReceiveReward.bind(this)),t.registerMessage(e,i.LEGEND_REFRESH_DAN,this._onGetDanChanged.bind(this)),t.registerMessage(e,i.LEGEND_SERVER_RANK,this._onGetRankList6.bind(this)),t.registerMessage(e,i.LEGEND_ZONE_RANK,this._onGetRankList7.bind(this)),t.registerMessage(e,i.LEGEND_GLOBAL_RANK,this._onGetRankList8.bind(this)),t.registerMessage(e,i.LEGEND_SEASON_ZONE_GOD_RANK,this._onGetRankList9.bind(this)),t.registerMessage(e,i.LEGEND_SEASON_GLOBAL_GOD_RANK,this._onGetRankList10.bind(this)),t.registerMessage(e,i.LEGEND_ZONE_FLOATING_RANK,this._onGetRankList11.bind(this)),t.registerMessage(e,i.LEGEND_GLOBAL_FLOATING_RANK,this._onGetRankList12.bind(this)),t.registerMessage(e,i.LEGEND_ADORE,this._onReceiveReward.bind(this)),t.registerMessage(e,i.LEGEND_BATTLE_REPORT,this._onGetReportsList14.bind(this)),t.registerMessage(e,i.LEGEND_ZONE_BATTLE_REPORT,this._onGetReportsList15.bind(this)),t.registerMessage(e,i.LEGEND_GLOBAL_BATTLE_REPORT,this._onGetReportsList16.bind(this)),t.registerMessage(e,i.PUSH_LEGEND_ACTOR,this._onGetActorInfo.bind(this)),t.registerMessage(e,i.PUSH_LEGEND_PLAYER,this._onGetPlayerInfo.bind(this)),t.registerMessage(e,i.PUSH_LEGEND_INFO,this._onGetSeasonInfo.bind(this)),t.registerMessage(e,i.PUSH_LEGEND_BATTLE_REPORT,this._onGetReportsList14.bind(this)),t.registerMessage(e,i.PUSH_LEGEND_BATTLE_ERROR,this._onGetBattleErrPush.bind(this))},t.prototype.addEventListener=function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.LEGENG_REQUEST_ACTOR_INFO]=this._requestActorInfo,i[e.LEGENG_REQUEST_SEASON_INFO]=this._requestSeasonInfo,i[e.LEGENG_REQUEST_PLAYER_INFO]=this._requestPlayerInfo,i[e.LEGENG_REQUEST_DAILY_REWARD]=this._requestDailyReward,i[e.LEGENG_REQUEST_BATTLE]=this._requestLegendBattle,i[e.LEGENG_REQUEST_SEASON_REWARD]=this._requestSeasonReward,i[e.LEGENG_REQUEST_RANK_LIST]=this._requestRankList,i[e.LEGENG_REQUEST_REPORTS]=this._requestReports,i[e.LEGENG_REQUEST_DAN_REFRESH]=this._requestDanRefresh,i[e.LEGENG_REQUEST_ADMIRE]=this._requestAdmire,i[e.LEGEND_SELF_ATACKED]=this._onSelfAttacked,i[e.ON_GET_SERVER_START_DAYS]=this._reqInfo,i[e.USER_ATTR_LEVEL_CHANGE]=this._reqInfo,t.registerEvents(i,this)},t.prototype.initData=function(){},t.prototype._reqInfo=function(){this._requestActorInfo(),this._requestSeasonInfo(),this._requestReports(a.LEGEND_REPORT_TYPE.SELF_REPORTS);var t=this.getCurSelectSeason();t>0&&(this._requestRankList(a.LEGEND_RANK_TYPE.ZONE_GOD_RANK,t),this._requestRankList(a.LEGEND_RANK_TYPE.GLOBAL_GOD_RANK,t))},t.prototype._requestActorInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.LEGEND,0)){var t={};t.module=td.MsgModuleName.LEGEND,t.cmd=td.MsgCmd.LEGEND.LEGEND_GET_ACTOR,td.ServerDelegate.sendMessage(t)}},t.prototype._onGetActorInfo=function(t,e){t===td.NetCode.SUCCESS&&(this._dan=e.dan||this._dan,this._seasonMaxDan=e.seasonMaxDan,this._dayMatchTimes=e.dayMatchTimes,this._dayVictoryTimes=e.dayVictoryTimes,this._dayScore=e.dayScore,this._adored=e.adored,this._dayReceiveList=e.dayReceiveList||[],this._seasonReceiveList=e.seasonReceiveList||[],td.EventUtil.dispatchEvent(td.EventNameEnum.LEGEND_ON_GET_ACTOR_INFO))},t.prototype._requestSeasonInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.LEGEND,0)){var t={};t.module=td.MsgModuleName.LEGEND,t.cmd=td.MsgCmd.LEGEND.LEGEND_GET_INFO,td.ServerDelegate.sendMessage(t)}},t.prototype._onGetSeasonInfo=function(t,e){t===td.NetCode.SUCCESS&&(this._season=e.season,this._state=e.state,this._endTime=e.endTime,this._state==a.LEGEND_STATE.SLEEP?this._curSelectSeason=this._season:this._curSelectSeason=this._season-1,this._curSelectSeason||(this._curSelectSeason=1),this.isStateOK()&&this._requestPlayerInfo(),td.EventUtil.dispatchEvent(td.EventNameEnum.LEGEND_ON_GET_SEASON_INFO))},t.prototype._requestPlayerInfo=function(){var t={};t.module=td.MsgModuleName.LEGEND,t.cmd=td.MsgCmd.LEGEND.LEGEND_GET_PLAYER,td.ServerDelegate.sendMessage(t)},t.prototype._onGetPlayerInfo=function(t,e){if(t===td.NetCode.SUCCESS){this._dan=e.dan,this._score=e.score||0,this._defenceTimes=e.defenceTimes||0;var i=this._preDan;if(this._preDan=e.preDan||0,this._preSeasonDan=e.preSeasonDan||0,0!=this._preSeasonDan)this._seasonDanChangeParam={},(n={isUp:!1}).preDan=Math.abs(this._preSeasonDan),n.curDan=this._preDan,this._seasonDanChangeParam=n,td.EventUtil.dispatchEvent(td.EventNameEnum.LEGEND_SEASON_DAN_CHANGED,this._seasonDanChangeParam);if(!this._seasonDanChangeParam){if(0!=this._preDan&&this._preDan!=this._dan){var n={},a=this._dan;a=this._preSeasonDan&&0!=this._preSeasonDan&&this._preDan!=this._preSeasonDan?this._preSeasonDan:this._dan,n.isUp=Math.abs(a)>this._preDan,n.preDan=Math.abs(this._preDan),n.curDan=a,n.defenceTime=this._defenceTimes,this._danChangeParam&&(n.defenceTime=this._defenceTimes.defenceTime),this._danChangeParam=n,this._isIngnorDanChange&&(this._danChangeParam=null),this.isAutoFight()||td.EventUtil.dispatchEvent(td.EventNameEnum.LEGEND_DAN_CHANGED,n)}else this._danChangeParam=null;if(i!=this._preDan&&0!=this._preDan&&0!=i)(n={}).isUp=this._preDan>Math.abs(i),n.preDan=Math.abs(i),n.curDan=this._preDan,n.defenceTime=this._defenceTimes,this._danChangeParam&&(n.defenceTime=this._defenceTimes.defenceTime),this._danChangeParam=n,this._isIngnorDanChange&&(this._danChangeParam=null),this.isAutoFight()||td.EventUtil.dispatchEvent(td.EventNameEnum.LEGEND_DAN_CHANGED,n);else this._danChangeParam=null;if(-1!=this._autoFightStartDan&&this.isAutoFight())if(this._dan!=this._autoFightStartDan)(n={}).isUp=Math.abs(this._dan)>this._autoFightStartDan,n.preDan=Math.abs(this._autoFightStartDan),n.curDan=this._dan,n.defenceTime=this._defenceTimes,this._danChangeParam&&(n.defenceTime=this._defenceTimes.defenceTime),this._danChangeParam=n;else this._danChangeParam=null}var r=this._serverRank;this._serverRank=e.serverRank,0!=this._serverRank&&0!=r&&(this._changeServerRank=r-this._serverRank),this._zoneRank=e.zoneRank,this._globalRank=e.globalRank,td.EventUtil.dispatchEvent(td.EventNameEnum.LEGEND_ON_GET_PLAYER_INFO)}},t.prototype._requestLegendBattle=function(){var t={};t.module=td.MsgModuleName.LEGEND,t.cmd=td.MsgCmd.LEGEND.LEGEND_BATTLE,this.setReplay(!1),td.ServerDelegate.sendMessage(t)},t.prototype._onGetBattleInfo=function(t,e){if(t===td.NetCode.SUCCESS){var i={};i.attributes=e.attributes,i.score=e.score,i.dan=e.dan,i.divinePos=e.attributes[td.UserPropertyEnum.DIVINE_POSITION],this._isOnlineSelfAttacked=!1,td.EventUtil.dispatchEvent(td.EventNameEnum.LEGENG_ON_GET_BATTLE,i)}},t.prototype._requestDailyReward=function(t){var e={};e.module=td.MsgModuleName.LEGEND,e.cmd=td.MsgCmd.LEGEND.LEGEND_RECEIVE_DAY_REWARD,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._requestSeasonReward=function(t){var e={};e.module=td.MsgModuleName.LEGEND,e.cmd=td.MsgCmd.LEGEND.LEGEND_RECEIVE_SEASON_REWARD,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._requestAdmire=function(t){var e={};e.module=td.MsgModuleName.LEGEND,e.cmd=td.MsgCmd.LEGEND.LEGEND_ADORE,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._onReceiveReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.LEGENG_RECEIVE_REWARDS)}},t.prototype._requestDanRefresh=function(){if(null==this._danChangeParam&&null==this._seasonDanChangeParam){var t={};t.module=td.MsgModuleName.LEGEND,t.cmd=td.MsgCmd.LEGEND.LEGEND_REFRESH_DAN,td.ServerDelegate.sendMessage(t)}},t.prototype._onGetDanChanged=function(t,e){t===td.NetCode.SUCCESS&&(this._onGetPlayerInfo(t,e),this.setIngnorDanChange(!1))},t.prototype._requestRankList=function(t,e){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.LEGEND,0)){var i={};if(i.module=td.MsgModuleName.LEGEND,i.cmd=t,t==a.LEGEND_RANK_TYPE.SERVER_RANK||t==a.LEGEND_RANK_TYPE.ZONE_RANK||t==a.LEGEND_RANK_TYPE.GLOBAL_RANK){if(this._season<=0){var n=new td.BroadcastContent(432);return void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,n)}}else e&&(i.id=e);td.ServerDelegate.sendMessage(i)}},t.prototype._onGetRankList=function(t,e){if(e){var i=[];i=t==a.LEGEND_RANK_TYPE.SERVER_RANK?e.ranks:e||[];for(var r=[],o=0;o<i.length;o++){var s=i[o],l=new n.default;l.initData(s),r.push(l)}var c=[];if(c=r,t==a.LEGEND_RANK_TYPE.SERVER_RANK||t==a.LEGEND_RANK_TYPE.ZONE_RANK||t==a.LEGEND_RANK_TYPE.GLOBAL_RANK){var u=r.splice(r.length-1,1);this._myRanksMap[t]&&(this._myRanksMap[t]={}),this._myRanksMap[t]=u[0]}c&&c.sort(function(t,e){return t.getRank()-e.getRank()}),this._rankListMap[t]=c,td.EventUtil.dispatchEvent(td.EventNameEnum.LEGENG_RANK_LIST_REFRESH,{rankType:t,rankList:c})}},t.prototype._onGetRankList6=function(t,e){t===td.NetCode.SUCCESS&&this._onGetRankList(a.LEGEND_RANK_TYPE.SERVER_RANK,e)},t.prototype._onGetRankList7=function(t,e){t===td.NetCode.SUCCESS&&this._onGetRankList(a.LEGEND_RANK_TYPE.ZONE_RANK,e)},t.prototype._onGetRankList8=function(t,e){t===td.NetCode.SUCCESS&&this._onGetRankList(a.LEGEND_RANK_TYPE.GLOBAL_RANK,e)},t.prototype._onGetRankList9=function(t,e){t===td.NetCode.SUCCESS&&this._onGetRankList(a.LEGEND_RANK_TYPE.ZONE_GOD_RANK,e)},t.prototype._onGetRankList10=function(t,e){t===td.NetCode.SUCCESS&&this._onGetRankList(a.LEGEND_RANK_TYPE.GLOBAL_GOD_RANK,e)},t.prototype._onGetRankList11=function(t,e){t===td.NetCode.SUCCESS&&this._onGetRankList(a.LEGEND_RANK_TYPE.ZONE_FLOATING_RANK,e)},t.prototype._onGetRankList12=function(t,e){t===td.NetCode.SUCCESS&&this._onGetRankList(a.LEGEND_RANK_TYPE.GLOBAL_FLOATING_RANK,e)},t.prototype._requestReports=function(t){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.LEGEND,0)){var e={};e.module=td.MsgModuleName.LEGEND,e.cmd=t,t==a.LEGEND_REPORT_TYPE.SELF_REPORTS&&this._isSelfReportRequested||(t==a.LEGEND_REPORT_TYPE.SELF_REPORTS&&(this._isSelfReportRequested=!0),td.ServerDelegate.sendMessage(e))}},t.prototype._onGetReportsList=function(t,e){for(var i=[],n=e.reports||[],o=!1,s=0;s<n.length;s++){var l=n[s],c=new r.default;c.initData(l),i.push(c),t==a.LEGEND_REPORT_TYPE.SELF_REPORTS&&c.isSelfAtacked()&&(this.setSelfAttacked(!0),o=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.LEGEND_SELF_ATACKED,!0))}this._reportListMap[t]||(this._reportListMap[t]=[]);var u=[];if(t==a.LEGEND_REPORT_TYPE.SELF_REPORTS&&i.length>0){var d=this._reportListMap[t];d=i.concat(d),this.MAX_SELF_REPORT||(this.MAX_SELF_REPORT=td.GetConfig("LEGEND_BATTLE_REPORT_COUNT_LIMIT")||20),d.sort(function(t,e){return e.getTime()-t.getTime()}),d.length>this.MAX_SELF_REPORT&&d.splice(this.MAX_SELF_REPORT,d.length-this.MAX_SELF_REPORT),this._reportListMap[t]=d,u=d,this.isAutoFight()&&!o&&(this._autoFightList=this._autoFightList.concat(i),this._autoFightList.forEach(function(t,e){t._curTimes=e+1})),o&&1==i.length?this._isOnlineSelfAttacked=!0:this._isOnlineSelfAttacked=!1}else i.sort(function(t,e){return e.getTime()-t.getTime()}),this._reportListMap[t]=i,u=i;td.EventUtil.dispatchEvent(td.EventNameEnum.LEGEND_REPORTS_REFRESH,{reportType:t,reportList:u})},t.prototype._onGetReportsList14=function(t,e){t===td.NetCode.SUCCESS&&(this._onGetReportsList(a.LEGEND_REPORT_TYPE.SELF_REPORTS,e),td.EventUtil.dispatchEvent(td.EventNameEnum.LEGENG_ON_GET_BATTLE_REPORT))},t.prototype._onGetReportsList15=function(t,e){t===td.NetCode.SUCCESS&&this._onGetReportsList(a.LEGEND_REPORT_TYPE.ZONE_TOP_REPORTS,e)},t.prototype._onGetReportsList16=function(t,e){t===td.NetCode.SUCCESS&&this._onGetReportsList(a.LEGEND_REPORT_TYPE.GLOBAL_TOP_REPORTS,e)},t.prototype._onSelfAttacked=function(t){return this._isSelfAttacked=t,this._isSelfAttacked},t.prototype._onGetBattleErrPush=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.LEGEND_ON_BATTLE_ERR)},t.prototype.getSeasonMaxDan=function(){return this._seasonMaxDan},t.prototype.getDayMatchTimes=function(){return this._dayMatchTimes},t.prototype.getDayVictoryTimes=function(){return this._dayVictoryTimes},t.prototype.getDayScore=function(){return this._dayScore},t.prototype.isDailyBoxReceived=function(t){return-1!=this._dayReceiveList.indexOf(t)},t.prototype.getAllDailyCfgs=function(){var t=td.GetTableClass(td.TableEnum.LegendDailyRewardTable);return t?t.getDatas():null},t.prototype.getDailyCfgById=function(t){var e=td.GetTableClass(td.TableEnum.LegendDailyRewardTable);return e?e.getDailyCfgById(t):null},t.prototype.getRewardBoxes=function(){var t=td.GetTableClass(td.TableEnum.LegendDailyRewardTable);return null==t?[]:t.getDatas()},t.prototype.getRewardBoxByGroup=function(t){var e=td.GetTableClass(td.TableEnum.LegendDailyRewardTable);return null==e?[]:e.getRewardsByGroupId(t)},t.prototype.getCurShowRewardByGroupId=function(t){for(var e=this.getRewardBoxByGroup(t),i=null,n=0;n<e.length;n++){var a=e[n];if(i=a,!this.isDailyBoxReceived(a.id))break}return i},t.prototype.isDailyBoxReached=function(t){var e=this.getDailyCfgById(t);if(!e)return!1;var i=0;return e.groupId==a.LEGEND_REWARD_BOX_GROUP.NORMAL?i=this.getDayMatchTimes():e.groupId==a.LEGEND_REWARD_BOX_GROUP.MIDDLE?i=this.getDayVictoryTimes():e.groupId==a.LEGEND_REWARD_BOX_GROUP.HIGH&&(i=this.getDayScore()),i>=e.target},t.prototype.getState=function(){return this._state},t.prototype.getServerRank=function(){return this._serverRank},t.prototype.getZoneRank=function(){return this._zoneRank},t.prototype.getGlobalRank=function(){return this._globalRank},t.prototype.getChangeServerRank=function(){return this._changeServerRank},t.prototype.getDan=function(){return this._dan},t.prototype.getSeason=function(){return this._season},t.prototype.getNextDanCfg=function(){return this.getDanByDanId(this._dan+1)},t.prototype.getPreDan=function(){return this._preDan},t.prototype.getScore=function(){return this._score},t.prototype.getDefenceTimes=function(){return this._defenceTimes},t.prototype.getCloseTime=function(){return this._endTime},t.prototype.getLegendPoint=function(){return td.Account.getUserData().getLegendPoint()},t.prototype.getLegendCoin=function(){return td.Account.getUserData().getLegendCoin()},t.prototype.isAdmired=function(){return this._adored},t.prototype.getAdmireList=function(){for(var t=td.GetConfig("LEGEND_ADORE_COST"),e=td.GetConfig("LEGEND_ADORE_REWARD"),i=[],n=0;n<t.length;n++){var a=t[n],r=e[n],o={};o.id=a[0],o.costItem=td.RewardManager.getRewardDetail(a[1]),o.rewardItems=td.RewardManager.parseRewardListDetail(r[1]),i.push(o)}return i},t.prototype.getCurSelectSeason=function(){return this._curSelectSeason},t.prototype.setCurSelectSeason=function(t){this._curSelectSeason=t},t.prototype.getDanCfgList=function(){var t=td.GetTableClass(td.TableEnum.LegendDanTable);return null==t?null:t.getDanList()},t.prototype.getCurDanCfg=function(){return this.getDanByDanId(this._dan)},t.prototype.getDanByDanId=function(t){var e=td.GetTableClass(td.TableEnum.LegendDanTable);return null==e?null:e.getDanCfgByDanId(t)},t.prototype.getDanByScore=function(t){var e=td.GetTableClass(td.TableEnum.LegendDanTable);return null==e?null:e.getDanCfgByScore(t)},t.prototype.getTitleByRank=function(t){var e=td.GetTableClass(td.TableEnum.TitleTable);if(null==e)return null;for(var i=e.getTitleCfgsByConditionType(o.TITLE_CONDITION_TYPE.LEGEND),n=0;n<i.length;n++){var a=i[n];if(t<=a.value)return a}return null},t.prototype.getSeasonRankRewardsList=function(){var t=td.GetTableClass(td.TableEnum.LegendSeasonRankRewardTable);return null==t?[]:t.getDataList()},t.prototype.getSeasonRankRewards=function(t){var e=td.GetTableClass(td.TableEnum.LegendSeasonRankRewardTable);if(null==e)return[];var i=e.getRewardsByRank(t);return td.RewardManager.parseRewardListDetail(i)},t.prototype.getSeasonRewardsList=function(){var t=td.GetTableClass(td.TableEnum.LegendSeasonRewardTable);return null==t?[]:t.getDatas()},t.prototype.isSeasonRewardReceived=function(t){return-1!=this._seasonReceiveList.indexOf(t)},t.prototype.isSeasonRewardReached=function(t){return this.getSeasonMaxDan()>=t},t.prototype.getRankListByRankType=function(t,e,i){var n=this._rankListMap[t]||[];return n?(i&&(delete this._rankListMap[t],this._requestRankList(t,e)),n):(delete this._rankListMap[t],this._requestRankList(t,e),[])},t.prototype.getMyRankByRankType=function(t){return this._myRanksMap[t]},t.prototype.getReportsByReportType=function(t,e){void 0===e&&(e=!0);var i=this._reportListMap[t];return i||this._requestReports(t),e&&(delete this._reportListMap[t],this._requestReports(t)),i},t.prototype.getSeasonsList=function(){var t=1;t=this._state==a.LEGEND_STATE.SLEEP?this._season:this._season-1;for(var e=td.GetConfig("LEGEND_GOD_LIST_SEASON_LIMIT")||3,i=[],n=t;n>0&&n>t-e;n--){var r={};r.season=n,r.timeStr=this.getSeasonTimesStr(n),i.push(r)}return i},t.prototype.getGodRankSeason=function(){return this._state==a.LEGEND_STATE.SLEEP?this._season:this._season-1},t.prototype.getSeasonTimesStr=function(t){var e=this._season-t,i=this._endTime-7*e*24*60*60*1e3,n=i-5184e5;return td.TimeUtil.convertDate(n)+"~"+td.TimeUtil.convertDate(i)},t.prototype.setAutoFight=function(t){this._isAutoFight=t,t||(this._autoFightList=[])},t.prototype.setAutoFightStartDan=function(t){this._autoFightStartDan=t},t.prototype.isAutoFight=function(){return this._isAutoFight},t.prototype.getAutoFightReports=function(){return this._autoFightList},t.prototype.setReplay=function(t){this._isReplay=t},t.prototype.isReplay=function(){return this._isReplay},t.prototype.setModelShowReady=function(t){this._isModelShowReady=t},t.prototype.isModelShowReady=function(){return this._isModelShowReady},t.prototype.setReportTmp=function(t){if(this._reportTmp=t,this._reportTmp){var e=this._reportTmp.parameterMap;e?this.setResultChangeScore(e[57]):this.setResultChangeScore(0)}else this.setResultChangeScore(0)},t.prototype.getReportTmp=function(){return this._reportTmp},t.prototype.isStateOK=function(){return this._state==a.LEGEND_STATE.BATTLE},t.prototype.setResultChangeScore=function(t){this._resultChangeScore=t},t.prototype.getResultChangeScore=function(){return this._resultChangeScore},t.prototype.getDanChangeParam=function(){return this._danChangeParam},t.prototype.setDanChangeParam=function(t){this._danChangeParam=t},t.prototype.getSeasonDanChangeParam=function(){return this._seasonDanChangeParam},t.prototype.setSeasonDanChangeParam=function(t){this._seasonDanChangeParam=t},t.prototype.setRecordSelectRankType=function(t){this._recordSelectRankType=t},t.prototype.getRecordSelectRankType=function(){return this._recordSelectRankType},t.prototype.setRecordCancelAuto=function(t){this._recordCancelAuto=t},t.prototype.getRecordCancelAuto=function(){return this._recordCancelAuto},t.prototype.isInLegendPanel=function(){return this._isInLegendPanel},t.prototype.setInLegendPanel=function(t){this._isInLegendPanel=t},t.prototype.isIngnorDanChange=function(){return this._isIngnorDanChange},t.prototype.setIngnorDanChange=function(t){this._isIngnorDanChange=t},t.prototype.isOnlineSelfAttacked=function(){return this._isOnlineSelfAttacked},t.prototype.getMatchRandomPlayer=function(){for(var t={},e=td.Account.getUserData(),i=e.getFightPower(),n=td.GlobalFunction.random(.8,1.2)*i,a=td.GlobalFunction.random(.8,1.2)*this._score,r=td.GlobalFunction.randomInt(1,e.getServerId()),o="",s=td.GlobalFunction.randomInt(3,5),l=0;l<s;l++){var c="\\u"+(Math.round(20901*Math.random())+19968).toString(16);o+=unescape(c.replace(/\\u/gi,"%u"))}return t.name=o,t.fight=parseInt(n.toFixed(0).toString()),t.server=r,t.score=parseInt(a.toFixed(0).toString()),t.dan=this._dan,t.divinePos=e.getDivinePos(),t},t.prototype.isSeasonDanChangeShow=function(){return this._isSeasonDanChangeShow},t.prototype.setSeasonDanChangeShow=function(t){this._isSeasonDanChangeShow=t},t.prototype.getDestinationPanel=function(){return this._destinationPanel},t.prototype.setDestinationPanel=function(t){this._destinationPanel=t},t.prototype._isFuncUnlock=function(){return!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.LEGEND,0)},t.prototype.isSelfAttacked=function(){return this._isSelfAttacked},t.prototype.setSelfAttacked=function(t){this._isSelfAttacked=t},t.prototype.isCanAdmire=function(){var t=!0;this._season<=0?t=!1:1==this._season&&this._state!=a.LEGEND_STATE.SLEEP&&(t=!1);var e=this.getRankListByRankType(a.LEGEND_RANK_TYPE.ZONE_GOD_RANK,this._season,!1),i=this.getRankListByRankType(a.LEGEND_RANK_TYPE.GLOBAL_GOD_RANK,this._season,!1);return!(e.length<=0&&i.length<=0)&&(!this.isAdmired()&&t)},t.prototype.isFightPanelRed=function(){return(this.isBoxCanReceived()||this.isSeasonRewardsCanReceived()||this.isSelfAttacked())&&this.isStateOK()},t.prototype.isBoxCanReceived=function(){for(var t=this.getAllDailyCfgs(),e=0;e<t.length;e++){var i=t[e];if(this.isDailyBoxReached(i.id)&&!this.isDailyBoxReceived(i.id))return!0}return!1},t.prototype.isSeasonRewardsCanReceived=function(){for(var t=this.getSeasonRewardsList(),e=0;e<t.length;e++){var i=t[e];if(this.isSeasonRewardReached(i.danId)&&!this.isSeasonRewardReceived(i.id))return!0}return!1},t.prototype.isRedPointTips=function(){return this._isFuncUnlock()&&(this.isCanAdmire()||this.isFightPanelRed())},t.prototype.redPointEvents=function(){return[td.EventNameEnum.LEGEND_ON_GET_ACTOR_INFO,td.EventNameEnum.LEGEND_ON_GET_SEASON_INFO,td.EventNameEnum.LEGEND_ON_GET_PLAYER_INFO,td.EventNameEnum.LEGENG_RECEIVE_REWARDS,td.EventNameEnum.LEGEND_SELF_ATACKED]},t}());i.default=s,cc._RF.pop()},{"../../Title/Enum/TitleEnum":"TitleEnum","../Enum/LegendEnum":"LegendEnum","../Model/LegendReportModel":"LegendReportModel","./../Model/LegendRankModel":"LegendRankModel",TitleTable:"TitleTable"}],LegendRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"32f5dVpaPRB9qh/6u6wc6jN","LegendRankModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Manager/LegendManager"),a=t("../Enum/LegendEnum"),r=t("HeroModel"),o=t("BaseUser"),s=function(){function t(){this._playerAttr={},this._rank=0,this._preSeasonRank=0,this._score=0,this._battleTimes=0,this._victoryTimes=0,this._dan=1,this._modelData={},this._playerModel=null}return t.prototype.initData=function(t){this._playerAttr=t.attributes,this._rank=t.rank,this._preSeasonRank=t.preSeasonRank,this._score=t.score,this._dan=t.dan||1,this._battleTimes=t.battleTimes,this._victoryTimes=t.victoryTimes,this._modelData=new r;var e=td.GetTableClass(td.TableEnum.HeroTable),i=this._playerAttr[td.UserPropertyEnum.LINE_UP_SHOW_ID],n=td.GetTableClass(td.TableEnum.LiveShowConfigTable).getRoleTypeByShowId(i);this._modelData.init(e.getHeroById(n)),this._playerModel=new o,this._playerModel.init("",this._playerAttr)},t.prototype.getPlayerAttr=function(){return this._playerAttr},t.prototype.getPlayerName=function(){return this._playerAttr[td.UserPropertyEnum.NickName]},t.prototype.getPlayerServer=function(){return this._playerAttr[td.UserPropertyEnum.ServerId]},t.prototype.getPlayerFight=function(){return this._playerAttr[td.UserPropertyEnum.FightPower]},t.prototype.getPlayerNameAndServer=function(){var t=this.getPlayerName(),e=this.getPlayerServer();return"["+cc.js.formatStr(td.Language.serverArea,e)+"] "+t},t.prototype.getDan=function(){return this._dan},t.prototype.getScore=function(){return this._score},t.prototype.getRank=function(){return this._rank},t.prototype.getPreRank=function(){return this._preSeasonRank},t.prototype.getBattleTimes=function(){return this._battleTimes},t.prototype.getWinRate=function(){return(this._victoryTimes/(this._battleTimes||1)*100).toFixed(2)+"%"},t.prototype.getRankRewards=function(){return n.default.getInstance().getSeasonRankRewards(this._rank)},t.prototype.getHeroModel=function(){return this._modelData},t.prototype.getPlayerModel=function(){return this._playerModel},t.prototype.isRankUnChanged=function(){return this._rank==this._preSeasonRank},t.prototype.isNewInRank=function(){return 0==this._preSeasonRank},t.prototype.isRankUp=function(){return this._rank-this._preSeasonRank<0},t.prototype.isRankDown=function(){return this._rank-this._preSeasonRank>0},t.prototype.getChangedRank=function(){return this._preSeasonRank-this._rank},t.prototype.getRankChangeType=function(){return this.isNewInRank()?a.LEGEND_RANK_CHANGE_TYPE.NEW_IN:this.isRankUnChanged()?a.LEGEND_RANK_CHANGE_TYPE.UN_CHANGE:this.isRankUp()?a.LEGEND_RANK_CHANGE_TYPE.UP:this.isRankDown()?a.LEGEND_RANK_CHANGE_TYPE.DOWN:a.LEGEND_RANK_CHANGE_TYPE.UN_CHANGE},t}();i.default=s,cc._RF.pop()},{"../Enum/LegendEnum":"LegendEnum","../Manager/LegendManager":"LegendManager",BaseUser:"BaseUser",HeroModel:"HeroModel"}],LegendReportModel:[function(t,e,i){"use strict";cc._RF.push(e,"f29c3w+wONOr4e8hHKqa/NQ","LegendReportModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._reportResult={},this._reports={},this._members=[],this._parameterMap={},this._time=0,this._leftHeroModel={},this._rightHeroModel={},this._changeScore=0,this._changeScoreRight=0,this._curTimes=1}return t.prototype.initData=function(t){this._reportResult=t,this._reports=t.reports,this._members=t.members,this._parameterMap=t.parameterMap,this._time=this._parameterMap[58],this._changeScore=this._parameterMap[57],this._changeScoreRight=this._parameterMap[69]},t.prototype.getReportResult=function(){return this._reportResult},t.prototype.getLeftPlayer=function(){for(var t=null,e=0;e<this._members.length;e++){var i=this._members[e];if(1==i.camp){t=i;break}}return t},t.prototype.getLeftPlayerAttr=function(){return this.getLeftPlayer().attributeMap},t.prototype.getLeftHeroModel=function(){return this._leftHeroModel},t.prototype.setLeftHeroModel=function(){var t=this.getLeftPlayerAttr();this._leftHeroModel=new HeroModel;var e=td.GetTableClass(td.TableEnum.HeroTable),i=t[td.UserPropertyEnum.LINE_UP_SHOW_ID],n=td.GetTableClass(td.TableEnum.LiveShowConfigTable).getRoleTypeByShowId(i);this._leftHeroModel.init(e.getHeroById(n))},t.prototype.getRightPlayer=function(){for(var t=null,e=0;e<this._members.length;e++){var i=this._members[e];if(2==i.camp){t=i;break}}return t},t.prototype.getRightPlayerAttr=function(){return this.getRightPlayer().attributeMap},t.prototype.setRightHeroModel=function(){var t=this.getLeftPlayerAttr();this._rightHeroModel=new HeroModel;var e=td.GetTableClass(td.TableEnum.HeroTable),i=t[td.UserPropertyEnum.LINE_UP_SHOW_ID],n=td.GetTableClass(td.TableEnum.LiveShowConfigTable).getRoleTypeByShowId(i);this._rightHeroModel.init(e.getHeroById(n))},t.prototype.getRightHeroModel=function(){return this._rightHeroModel},t.prototype.getPlayerAttr=function(t){this.getRightPlayerAttr();return t?this.getLeftPlayerAttr():this.getRightPlayerAttr()},t.prototype.getPlayerScore=function(t){this.getLeftScore();return t?this.getLeftScore():this.getRightScore()},t.prototype.getPlayerFight=function(t){return this.getPlayerAttr(t)[td.UserPropertyEnum.FightPower]},t.prototype.getPlayerNameAndServer=function(t){var e=this.getRightPlayerAttr(),i=(e=t?this.getLeftPlayerAttr():this.getRightPlayerAttr())[td.UserPropertyEnum.NickName],n=e[td.UserPropertyEnum.ServerId];return"["+cc.js.formatStr(td.Language.serverArea,n)+"] "+i},t.prototype.getReports=function(){return this._reports},t.prototype.getTime=function(){return this._time},t.prototype.getTimeStr=function(){return td.TimeUtil.convertDataTime(this._time)},t.prototype.getLeftScore=function(){return this._parameterMap[55]},t.prototype.getRightScore=function(){return this._parameterMap[56]},t.prototype.isLeftWin=function(){var t=this.getLeftPlayer();return!(!t||t.camp!=this._reportResult.stats.winCamp)},t.prototype.isSelfAtacked=function(){var t=td.Account.getUserData().getGamerId();return this.getRightPlayerAttr()[td.UserPropertyEnum.GamerId]==t},t.prototype.getChangeScore=function(){return this._changeScore},t.prototype.getChangeScoreRight=function(){return this._changeScoreRight},t.prototype.getCurTimes=function(){return this._curTimes},t}();i.default=n,cc._RF.pop()},{}],LegendSeasonRankRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"30f930rlehPmK2DdWoB5nk1","LegendSeasonRankRewardTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="LegendSeasonRankRewardTable",e._tblName="legend_season_rank_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t.push(a)}this._data.sort(function(t,e){return t.rank-e.rank})},e.prototype.getDataList=function(){return this._data},e.prototype.getRewardsByRank=function(t){if(t<=0)return[];for(var e=0;e<this._data.length;e++){var i=this._data[e];if(t<=i.rank)return i.rewards}return[]},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LegendSeasonRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"3e01dRpuhBNBac1doMWx+4E","LegendSeasonRewardTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="LegendSeasonRewardTable",e._tblName="legend_season_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t.push(a)}this._data.sort(function(t,e){return t.id-e.id})},e.prototype.getDatas=function(){return this._data},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LeiTingYiJi:[function(t,e,i){"use strict";cc._RF.push(e,"1b67cI+xMVPqLd+SOeuJ095","LeiTingYiJi");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="LeiTingYiJi"}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],LevelGiftController:[function(t,e,i){"use strict";cc._RF.push(e,"b6da4O/8mBAu41R3jJpHaQW","LevelGiftController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_receiveList:null,_prerogativeReceives:null},initData:function(t){this._super(t),this._receiveList=[],this._prerogativeReceives=[],this.addNetListener(),this.addEventListener()},destroyData:function(){this._super(),this._receiveList=null,this._prerogativeReceives=null},addNetListener:function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.LEVEL_GIFT_GET,this._parseInfo.bind(this)),i.registerMessage(t,e.LEVEL_GIFT_RECEIVE,this._parseGift.bind(this)),i.registerMessage(t,e.PUSH_LEVEL_GIFT,this._parseInfo.bind(this))},addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REQ_LEVEL_GIFT_GET]=this._requestInfo.bind(this),t[e.REQ_LEVEL_GIFT_RECEIVE]=this._requestGift.bind(this),td.EventUtil.registerEvents(t,this)},_requestInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.LEVEL_GIFT_GET,td.ServerDelegate.sendMessage(t)},_requestGift:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.LEVEL_GIFT_RECEIVE,e.level=t,td.ServerDelegate.sendMessage(e)},_parseInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.receives;if(i)for(var n=0;n<i.length;n++)this._receiveList.push(i[n]);var a=e.prerogativeReceives;if(a)for(var r=0;r<a.length;r++)this._prerogativeReceives.push(a[r]);td.EventUtil.dispatchEvent(td.EventNameEnum.RES_LEVEL_GIFT_GET)}},_parseGift:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult);td.GlobalFunction.showRewards(i),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_LEVEL_GIFT_RECEIVE)}},isAllRecevied:function(){for(var t=td.GetTableClass(td.TableEnum.LevelGiftTable).getDatas(),e=0;e<t.length;e++){var i=t[e].level;if(i>td.Account.getUserData().getLevel())return!1;if(-1===this._receiveList.indexOf(i))return!1;if(-1===this._prerogativeReceives.indexOf(i))return!1;for(var n=td.GetTableClass(td.TableEnum.LevelGiftTable).getDataByLevel(i).taskid,a=0;a<n.length;a++){var r=td.TaskManager.getTaskById(n[a]);if(r&&r.getStatus()!==td.TaskStatus.Received)return!1}}return!0},getReceiveList:function(){return this._receiveList},getPrerogativeReceives:function(){return this._prerogativeReceives},hasRedPoint:function(){return!0},isRedPointTip:function(){for(var t=td.GetTableClass(td.TableEnum.LevelGiftTable).getDatas(),e=0;e<t.length;e++)if(this.getRedTipsByLevel(t[e].level))return!0;return!1},getRedTipsByLevel:function(t){if(t>td.Account.getUserData().getLevel())return!1;if(-1===this._receiveList.indexOf(t))return!0;for(var e=td.GetTableClass(td.TableEnum.LevelGiftTable).getDataByLevel(t),i=e.prerogativeCard,n=!1,a=0;a<i.length;a++)if(td.Account.getUserData().getVipCard(i[a])){n=!0;break}if(n&&-1===this._prerogativeReceives.indexOf(t))return!0;for(var r=e.taskid,o=0;o<r.length;o++){var s=td.TaskManager.getTaskById(r[o]);if(s&&s.getStatus()===td.TaskStatus.Finish)return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.RES_LEVEL_GIFT_GET,td.EventNameEnum.RES_LEVEL_GIFT_RECEIVE,td.EventNameEnum.USER_ATTR_LEVEL_CHANGE,td.EventNameEnum.Res_GET_TASK_INFO]}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],LevelGiftItem:[function(t,e,i){"use strict";cc._RF.push(e,"5dc6cxooXZORaNSewn5oDdN","LevelGiftItem");var n=t("ListItem");cc.Class({extends:n,properties:{btn_reward:cc.Node,btn_go:cc.Node,img:cc.Node,lab_title:cc.Label,lab_des:cc.Label,lab_progress:cc.Label,node1:cc.Node,node2:cc.Node,lab:cc.Label,_taskId:null,_gotoPanel:null},updateItem:function(t,e){this._super(t,e);var i=e.getStatus(),n=td.Account.getUserData().getLevel(),a=this._customData;n<a?(this.node1.active=!1,this.node2.active=!0,this.lab.string=cc.js.formatStr("%s",td.Language.lvUnlock,a)):(this.node1.active=!0,this.node2.active=!1,this.btn_reward.active=i===td.TaskStatus.Finish,this.btn_go.active=i===td.TaskStatus.Progress,this.img.active=i===td.TaskStatus.Received),this.lab_title.string=e.getName(),this.lab_des.string=e.getDes();var r=e.getWithProgress()>0;this.lab_progress.string=r?(e.getValue()>e.getNeedValue()?e.getNeedValue():e.getValue())+"/"+e.getNeedValue():i===td.TaskStatus.Finish||i===td.TaskStatus.Received?"1/1":"0/1",this._taskId=e.getId(),this._gotoPanel=e.getGotoPanel();var o=e.getRewards(),s=td.RewardManager.getRewardDetail(o[0]),l=this.node1.getChildByName("icon");l?l.getComponent("CommonIconWidget").setData(s):((l=td.GlobalFunction.createCommonIconWidget(26,s)).name="icon",l.x=-250,l.y=0,this.node1.addChild(l))},onBtnGo:function(){var t=null;this._gotoPanel[1]&&(t=this._gotoPanel[1]),td.PanelJumpManager.jumpToPanel(this._gotoPanel[0],t)},onBtnReward:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.Req_TASK_RECEIVE,this._taskId)}});cc._RF.pop()},{ListItem:void 0}],LevelGiftPanel:[function(t,e,i){"use strict";cc._RF.push(e,"70bec31wtBIs5LkMsF9IY0w","LevelGiftPanel");var n=t("ActivityBasePanel"),a=t("OptimizeVerticalListView");cc.Class({extends:n,properties:{TabContent:cc.Node,item:cc.Node,item_title:cc.Node,_list:null,_lastSelect:null,_select:null},initData:function(t){this._super(t)},onEnable:function(){this._super(),this._addEventListener(),td.EventUtil.dispatchEvent(td.EventNameEnum.Req_EatEnergy_Info),this.list=td.GetTableClass(td.TableEnum.LevelGiftTable).getDatas();for(var t=0,e=0;e<this.list.length;e++){var i=this.TabContent.getChildByName("item"+e);i||((i=cc.instantiate(this.item)).name="item"+e,i.active=!0,i.x=150*e+75,i.y=15,this.TabContent.addChild(i)),t+=150;var n=this.list[e];i.getChildByName("lab").getComponent(cc.RichText).string=cc.js.formatStr("%s",td.Language.LevelGift,n.level),i.getComponent(cc.Button).clickEvents[0].customEventData=e+""}this.TabContent.width=t;var a=-1,r=-1,o=td.Account.getUserData().getLevel(),s=this._controller.getReceiveList(),l=this._controller.getPrerogativeReceives();for(e=0;e<this.list.length;e++){for(var c=this.list[e].level,u=this.list[e].prerogativeCard,d=!1,h=0;h<u.length;h++)if(td.Account.getUserData().getVipCard(u[h])){d=!0;break}if(o>=c){if(-1===s.indexOf(c)||d&&-1===l.indexOf(c)){a=e;break}for(var p=this.list[e].taskid,_=0;_<p.length;_++){var g=td.TaskManager.getTaskById(p[_]);if(g)if(g.getStatus()===td.TaskStatus.Finish){a=e;break}}}else r<0&&(r=e);if(a>=0)break}if(a<0)for(var f=0;f<this.list.length;f++){var v=this.list[f].level;if(-1===l.indexOf(v)){a=f;break}for(var m=this.list[f].taskid,y=0;y<m.length;y++){var E=td.TaskManager.getTaskById(m[y]);if(E)if(E.getStatus()!==td.TaskStatus.Received){a=f;break}}if(a>=0)break}a<0&&(a=r<0?0:r),this.TabContent.x=-340-150*a,this.onItemBtn(null,a)},onItemBtn:function(t,e){this._lastSelect&&(this._lastSelect.getChildByName("img_light").active=!1);var i=this.TabContent.getChildByName("item"+e);this._lastSelect=i,this._lastSelect.getChildByName("img_light").active=!0,this._select=parseInt(e),this.initUI()},initUI:function(){var t=this.item_title.getChildByName("lab_title"),e=this.item_title.getChildByName("img"),i=this.item_title.getChildByName("btn_reward"),n=this.item_title.getChildByName("reward"),r=this._controller.getReceiveList(),o=this._controller.getPrerogativeReceives(),s=this.list[this._select],l=s.level,c=td.Account.getUserData().getLevel(),u=-1!==r.indexOf(l),d=-1!==o.indexOf(l);c>=l?(e.active=u&&d,i.active=!u||!d):(e.active=!1,i.active=!1),t.getComponent(cc.RichText).string=cc.js.formatStr("%s",td.Language.LevelGiftDes,l),n.removeAllChildren(!0);for(var h=s.reward,p=this.item_title.getChildByName("imgNode"),_=this.item_title.getChildByName("imgNode1"),g=0;g<h.length;g++){var f=td.RewardManager.getRewardDetail(h[g]),v=td.GlobalFunction.createCommonIconWidget(26,f);if(v.getComponent("CommonIconWidget").setMaskShow(u),u){var m=cc.instantiate(p);m.active=!0,v.addChild(m,101)}v.setScale(.8),n.addChild(v)}for(var y=s.prerogativeReward,E=0;E<y.length;E++){var T=td.RewardManager.getRewardDetail(y[E]),C=td.GlobalFunction.createCommonIconWidget(26,T);C.getComponent("CommonIconWidget").setMaskShow(d);var R=cc.instantiate(_);if(R.active=!0,C.addChild(R,101),d){var S=cc.instantiate(p);S.active=!0,C.addChild(S,102)}C.setScale(.8),n.addChild(C)}for(var I=s.taskid,A=[],b=0;b<I.length;b++){var P=td.TaskManager.getTaskById(I[b]);P&&A.push(P)}var N=this.node.getComponent(a);N.setCustomData(l),N.refreshListData(A),this.checkFinish(),p=null},checkFinish:function(){for(var t=td.Account.getUserData().getLevel(),e=this._controller.getReceiveList(),i=this._controller.getPrerogativeReceives(),n=0;n<this.list.length;n++){var a=this.TabContent.getChildByName("item"+n),r=a.getChildByName("img_title"),o=a.getChildByName("redPoint"),s=this.list[n].level;if(t>=s&&-1!==e.indexOf(s)&&-1!==i.indexOf(s)){var l=!0,c=this.list[n].taskid;t:for(var u=0;u<c.length;u++){var d=td.TaskManager.getTaskById(c[u]);if(d)if(d.getStatus()!==td.TaskStatus.Received){l=!1;break t}}r.active=l}else r.active=!1;o.active=this._controller.getRedTipsByLevel(s)}},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this)},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.RES_LEVEL_GIFT_GET]=this.initUI,t[e.Res_GET_TASK_INFO]=this.initUI,td.EventUtil.registerEvents(t,this)},onBtnReward:function(){var t=this.list[this._select],e=t.level;if(-1!==this._controller.getReceiveList().indexOf(e)){for(var i=t.prerogativeCard,n="",a=!1,r=0;r<i.length;r++)td.Account.getUserData().getVipCard(i[r])?a=!0:(n+=td.Language["vipCard_"+i[r]],n+=td.Language.lockOr);if(!a){n=n.substr(0,n.length-1);var o={};return o.strArray=[cc.js.formatStr("%s",td.Language.level_gift_Tips1,n),td.Language.level_gift_Tips2],o.okCallFunc=this.chargefunc,void td.GlobalFunction.showConfirmWindow(o)}}td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_LEVEL_GIFT_RECEIVE,e)},chargefunc:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MonthCard).getActivityId();td.PanelManager.getInstance().getCurShowPanel().switchPanel(t,!0)}});cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0}],LevelGiftTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"6af01mSQLpIvo70slb5XeyV","LevelGiftTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="LevelGiftConfig",e._tblName="level_gift_config",e._data={},e}n(e,t);var i=e.prototype;return i.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.level]=a}},i.getDataByLevel=function(t){return this._data[t]?this._data[t]:null},i.getDatas=function(){var t=[];for(var e in this._data)t.push(this._data[e]);return t.sort(this.sortFunc)},i.sortFunc=function(t,e){return t.level-e.level},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LianHuangDaJi:[function(t,e,i){"use strict";cc._RF.push(e,"b956bQ3hidI1acQRDnrrWbK","LianHuangDaJi");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="LianHuangDaJi",this.setRotationAndScale()},calcHurt:function(){if(this._curTargetEnemy&&cc.isValid(this._curTargetEnemy)){var t=this._dataModel.getSkillPower(),e=this._curHeroAttackPower*t,i=this._cutHurtType,n=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),a=this._curTargetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[n]);if(!a.bDeath()){for(var r=this._dataModel.getAttackEffect(),o=0,s=r.length;o<s;o++){var l=r[o];l[0]===td.PveEnum.PVE_EFFECT_TYPE.PureHurt1&&(e+=l[1])}a.setHurt(this._heroSid,e,i,this._attackerVocation),this.setAttackEffectToEnemy(this._curTargetEnemy)}}},setRotationAndScale:function(){var t=this._towerPos,e=this._curTargetEnemy.position,i=td.GlobalFunction.getDistance(t,e),n=t.x-e.x,a=t.y-e.y;this._speedX=n/i,this._speedY=a/i;var r=this._calcRotationDegree();this.node.rotation=r+45,this.node.scale=i/400},_calcRotationDegree:function(){var t=180*Math.atan2(this._speedY,this._speedX)/Math.PI;return t<=0?-t:360-t}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],LianXingPiFu:[function(t,e,i){"use strict";cc._RF.push(e,"5467c6lqtBEOI2ROBPpGoe9","LianXingPiFu");var n=t("BaseBossSkill"),a=(t("PveFightManager"),cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="LianXingPiFu"},effect:function(){if(cc.isValid(this._owner)){var t=this._owner._tag,e=Math.floor(t/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._owner.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=i.bDeath(),a=i.getTransferStatus();n||a?this.removeSelf():this.setAttackEffectToEnemy(i)}else this.removeSelf()}}));e.exports=a,cc._RF.pop()},{BaseBossSkill:"BaseBossSkill",PveFightManager:"PveFightManager"}],LifeCardRewardManager:[function(t,e,i){"use strict";cc._RF.push(e,"0d18d//gt5Ah52zGw/OICxp","LifeCardRewardManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,function(){function t(){this._isHideAutoShow=!1,this._durationDays=0}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._isHideAutoShow=!1},t.prototype.addListener=function(){var t=td.MsgModuleName.USER,e=td.MsgCmd.User;td.ServerDelegate.registerMessage(t,e.LIFETIME_VIP_CARD_REWARD,this._onReceiveReward.bind(this))},t.prototype.addEventListener=function(){var t={};t[td.EventNameEnum.REQ_GET_LIFE_CARD_REWARD]=this._requestGetReward,td.EventUtil.registerEvents(t,this)},t.prototype.getEndTime=function(){var t=td.SystemManager.getServerOpenTime(),e=new Date(t);return t-(1e3*(60*(60*e.getHours()+e.getMinutes())+e.getSeconds())+e.getMilliseconds())+24*this.getDurationDays()*3600*1e3-1e3},t.prototype.isInOpenStatus=function(){return!(td.TimeUtil.getTime()>this.getEndTime())&&!td.Account.getUserData().isLifeCardRewardReceived()},t.prototype.isShow=function(){return!this.isHideAutoShow()&&this.isInOpenStatus()},t.prototype.isHideAutoShow=function(){var t=td.Account.getUserData().getUserId();return this._isHideAutoShow=td.GlobalFunction.getLocalSaveStatus("HIDE_LIFE_CARD_REWARD_"+t),this._isHideAutoShow},t.prototype.setHideAutoShow=function(t){this._isHideAutoShow=t;var e=td.Account.getUserData().getUserId();this._isHideAutoShow?td.GlobalFunction.setLocalSaveStatus("HIDE_LIFE_CARD_REWARD_"+e,!0):td.GlobalFunction.removeLocalSaveStatus("HIDE_LIFE_CARD_REWARD_"+e)},t.prototype.getDurationDays=function(){return this._durationDays||(this._durationDays=td.GetConfig("LIFETIME_VIP_CARD_REWARD_LIMIT_TIME")),this._durationDays},t.prototype._requestGetReward=function(){var t={};t.module=td.MsgModuleName.USER,t.cmd=td.MsgCmd.User.LIFETIME_VIP_CARD_REWARD,td.ServerDelegate.sendMessage(t)},t.prototype._onReceiveReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult);td.GlobalFunction.showRewards(i),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_PANEL)}},t.prototype.isRedPointTips=function(){var t=td.Account.getUserData().isLifeCardRewardReceived(),e=td.Account.getUserData().getVipCard(td.VipCardType.LIFETIME_VIP_CARD);return!t&&!!e},t.prototype.redPointTipsEvts=function(){var t=td.EventNameEnum;return[t.Recharge_Success,t.USER_LIFE_CARD_REWAED_STATE_CHANGE]},t=e=n([r],t)}());i.default=o,cc._RF.pop()},{}],LightSkill:[function(t,e,i){"use strict";cc._RF.push(e,"eeb85R3WmpCdYyfUamkQqgA","LightSkill");var n=t("CommonSkill"),a=t("PveFightManager"),r=t("../../../manager/PveDataHelper").default,o=cc.Class({extends:n,properties:{_soundInterval:null,_hurtSoundTimeout:null,_isShowing:!1},initData:function(t){this._super(t),this._skillName="LightSkill",this._isNeedShake=!0},onEnable:function(){this._isShowing=!0;var t=this._dataModel.getSoundId();t&&t>0&&(this._soundInterval&&(clearInterval(this._soundInterval),this._soundInterval=null),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,t),this._soundInterval=setInterval(function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,t)},2400)),this.playScreenShakeAction()},onDisable:function(){this._isShowing=!1,this._soundInterval&&(clearInterval(this._soundInterval),this._soundInterval=null),this._hurtSoundTimeout&&(clearTimeout(this._hurtSoundTimeout),this._hurtSoundTimeout=null)},updateContinueTime:function(t){},calcHurt:function(){var t=this;if(this._isShowing){for(var e=this._dataModel.getSkillPower(),i=r.getTecAddition(),n=this._dataModel.getDamageRange()/2,o=a.getEnemyArray(),s=this.node.getPosition(),l=r.getBattleHerosAveragePower(),c=!1,u=0,d=o.length;u<d;u++){var h=o[u];if(h){var p=Math.floor(h._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),_=h.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[p]),g=_.bDeath(),f=h.getPosition(),v=td.GlobalFunction.getDistance(s,f),m=Math.floor(e*l);if(m*=1+i,v<=n&&!g){for(var y=this._dataModel.getAttackEffect(),E=0,T=y.length;E<T;E++){var C=y[E];C[0]===td.PveEnum.PVE_EFFECT_TYPE.PureHurt1&&(m+=C[1])}var R=0-td.PveEnum.PVE_UI_SKILL_ID.Light;_.setHurt(R,m,td.PveEnum.PVE_HURT_TYPE.Real),this.setAttackEffectToEnemy(h),c=!0}}}c&&!this._hurtSoundTimeout&&(td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,119),this._hurtSoundTimeout=setTimeout(function(){clearTimeout(t._hurtSoundTimeout),t._hurtSoundTimeout=null},200))}},removeSelf:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SKILL_HURT_STATICS_END)}});e.exports=o,cc._RF.pop()},{"../../../manager/PveDataHelper":"PveDataHelper",CommonSkill:"CommonSkill",PveFightManager:"PveFightManager"}],LimitGiftManager:[function(t,e,i){"use strict";cc._RF.push(e,"7439erDOJBBxog1JmLOjU9m","LimitGiftManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,t("LimitGiftModel")),s=function(){function t(){this._isOpen=!1,this._isInit=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._limitGiftList=[],this._lastGiftList={},this._isOpen=!1,this._isInit=!1,this._gift=null},t.prototype.addListener=function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.GET_LIMITED_TIME_CHARGE_INFO,this._parseInfo.bind(this)),i.registerMessage(t,e.LIMITED_TIME_CHARGE_RECEIVE,this._parseReward.bind(this)),i.registerMessage(t,e.PUSH_LIMITE_TIME_CHARGE_INFO,this._parseInfo.bind(this))},t.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.REQ_GET_LIMITED_TIME_CHARGE_INFO]=this._requestInfo,e[t.REQ_LIMITED_TIME_CHARGE_RECEIVE]=this._requestReward,td.EventUtil.registerEvents(e,this)},t.prototype.setCurSelectGiftId=function(t){this._curSelectId=t},t.prototype.getCurSelectGiftId=function(t){return this._curSelectId},t.prototype.getLimitGiftList=function(){return this._limitGiftList.sort(this.sortFunc)},t.prototype.getCountdownItem=function(){for(var t=null,e=0;e<this._limitGiftList.length;e++){if(2===this._limitGiftList[e].getStateType()){t=null;break}t||(t=this._limitGiftList[e])}return t},t.prototype.getLimitGiftById=function(t){for(var e=0;e<this._limitGiftList.length;e++)if(this._limitGiftList[e].getId()===t)return this._limitGiftList[e];return null},t.prototype.deleteById=function(t){for(var e=-1,i=0;i<this._limitGiftList.length;i++)if(this._limitGiftList[i].getId()===t){e=i;break}-1!==e&&this._limitGiftList.splice(e,1)},t.prototype.sortFunc=function(t,e){return t.getLimiteTimes()-e.getLimiteTimes()},t.prototype.openPage=function(){this._isOpen||(this._isOpen=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_LimitGift))},t.prototype._requestInfo=function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.GET_LIMITED_TIME_CHARGE_INFO,td.ServerDelegate.sendMessage(t)},t.prototype._requestReward=function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.LIMITED_TIME_CHARGE_RECEIVE,e.configId=t,td.ServerDelegate.sendMessage(e)},t.prototype._parseInfo=function(t,e){var i=this;if(t===td.NetCode.SUCCESS){var n=e.limitedTimeChargeList,a=td.TimeUtil.getTime();n.forEach(function(t){var e=i.getLimitGiftById(t.id);a<t.limitedTime?e?(e.setLimiteTimes(t.limitedTime),e.setId(t.id),e.setParam(t.param),e.setChargeStates(t.chargeState)):((e=new o).init(t.id),e.setLimiteTimes(t.limitedTime),e.setId(t.id),e.setParam(t.param),e.setChargeStates(t.chargeState),i._limitGiftList.push(e)):e&&e.isAllItemsReceived()&&i.deleteById(t.id)});for(var r=!1,s=0;s<this._limitGiftList.length;s++){var l=this._limitGiftList[s];a>=l.getLimiteTimes()||l.isAllItemsReceived()?this.deleteById(l.getId()):this._isInit&&l.isAllItemsNoFinished()&&!this._lastGiftList[l.getId()]&&(r||(this._gift=l,this._isOpen=!1,td.LocalStorageUtil.write(td.LocalDataKey.MainPanel_isShowPopup,!1),td.LocalStorageUtil.write(td.LocalDataKey.MainPanel_isShowPopup+td.PanelEnum.Panel_LimitGift,!1),td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_LimitGift),2!==l.getType()&&td.EventUtil.dispatchEvent(td.EventNameEnum.NEW_LimitGift),r=!0))}this._lastGiftList={};for(var c=0;c<this._limitGiftList.length;c++){var u=this._limitGiftList[c];this._lastGiftList[u.getId()]=u.isAllItemsNoFinished()}if(this._gift){var d=!1;for(s=0;s<this._limitGiftList.length;s++)if(this._gift.getId()===this._limitGiftList[s].getId()){d=!0;break}d||(this._gift=null)}0===this._limitGiftList.length&&this.clearGift(),this._isInit=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.RES_GET_LIMITED_TIME_CHARGE_INFO),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL)}},t.prototype.getGift=function(){return this._gift},t.prototype.clearGift=function(){this._gift=null},t.prototype._parseReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult);td.GlobalFunction.showRewards(i),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_LIMITED_TIME_CHARGE_RECEIVE)}},t.prototype.isRedPointTips=function(){for(var t=0;t<this._limitGiftList.length;t++){var e=this._limitGiftList[t].getChargeStates();for(var i in e)if(2===e[i])return!0}return!this._isOpen},t.prototype.redPointEvents=function(){var t=td.EventNameEnum;return[t.RES_LIMITED_TIME_CHARGE_RECEIVE,t.RES_GET_LIMITED_TIME_CHARGE_INFO,t.OPEN_LimitGift]},t=e=n([r],t)}();i.default=s,cc._RF.pop()},{LimitGiftModel:"LimitGiftModel"}],LimitGiftModel:[function(t,e,i){"use strict";cc._RF.push(e,"8b186HiT0FMRp83deJkALYX","LimitGiftModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.init=function(t){var e=td.GetTableClass(td.TableEnum.LimitGiftTable).getDataById(t);e&&(this.id=e.id,this.name=e.name,this.rewards=e.rewards,this.type=e.type,this.uiText=e.des,this.des=e.uiText,this.img=e.namePic),this.cost=0},t.prototype.getId=function(){return this.id},t.prototype.getImg=function(){return this.img},t.prototype.getName=function(){return this.name},t.prototype.getRewards=function(){return this.rewards},t.prototype.getType=function(){return this.type},t.prototype.getCost=function(){return this.cost},t.prototype.getStateType=function(){return this.stateType},t.prototype.getUiText=function(){return this.uiText},t.prototype.getDes=function(){return this.des},t.prototype.getParam=function(){return this.param},t.prototype.setId=function(t){this.id=t},t.prototype.setParam=function(t){this.param=t},t.prototype.setLimiteTimes=function(t){this.limiteTimes=t},t.prototype.getLimiteTimes=function(){return this.limiteTimes},t.prototype.setChargeStates=function(t){this.chargeStates=t},t.prototype.getChargeStates=function(){return this.chargeStates},t.prototype.isAllItemsFinished=function(){var t=this.chargeStates;for(var e in t){if(2!==t[e])return!1}return!0},t.prototype.isNotAllItemsNoFinished=function(){var t=this.chargeStates;for(var e in t){if(1!==t[e])return!0}return!1},t.prototype.isAllItemsNoFinished=function(){var t=this.chargeStates;for(var e in t){if(1!==t[e])return!1}return!0},t.prototype.isAllItemsReceived=function(){var t=this.chargeStates;for(var e in t){if(3!==t[e])return!1}return!0},t}();i.default=n,e.exports=n,cc._RF.pop()},{}],LimitGiftTable:[function(t,e,i){"use strict";cc._RF.push(e,"046d2Lt44dKQ7t8iaYagetQ","LimitGiftTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="LimitedTimeChargeConfig",e._tblName="limited_time_charge_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data&&this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LimitedTimeStoreTable:[function(t,e,i){"use strict";cc._RF.push(e,"19e66mxyKdEkKeiGM6/y6Z6","LimitedTimeStoreTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"LimitedTimeStoreConfig",properties:{_tblName:"limited_time_store_config",_data:null},init:function(){this._data={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._data[n.data]=this._data[n.data]||[];var a=this._data[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._data[t];return e||(e=[]),e},getDataByDataIdAndId:function(t,e){var i=this._data[t];if(i)for(var n=0;n<i.length;n++)if(i[n].id===e)return i[n];return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LineupRecommendTable:[function(t,e,i){"use strict";cc._RF.push(e,"edd0boHGh9Mdockh7Wf05Ex","LineupRecommendTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="LineupRecommendConfig",e._tblName="lineup_recommend_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDatas=function(){var t=[];for(var e in this._data)t.push(this._data[e]);return t.sort(this.sortFunc)},e.prototype.sortFunc=function(t,e){return t.id-e.id},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LiveShowConfigTable:[function(t,e,i){"use strict";cc._RF.push(e,"84ad8QCFQ9FkaSPmL/Dn3d1","LiveShowConfigTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"LiveShowConfigTable",properties:{_tblName:"show_config",_showData:null},init:function(){this._showData={};for(var t=0,e=this._jsonData.length;t<e;t++){var i=this._jsonData[t],n=i.id;this._showData[n]=i}},getLiveShowData:function(){return this._showData},getAvatarIdByShowId:function(t){for(var e in this._showData){var i=this._showData[e];if(i.id===t)return i.avatarId}return null},getRoleTypeByShowId:function(t){return(this._showData[t]||{}).roleType},getMercenaryByShowId:function(t){var e=showData.roleType;return e?new td.Mercenary(td.GetTableClass(td.TableEnum.Mercenary).getMercenaryById(e)):null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LiveShowModel:[function(t,e,i){"use strict";cc._RF.push(e,"5d3f1eKHOtIi5zNpPa+OBI3","LiveShowModel"),td.LiveShowModel=cc.Class({properties:{_id:null,_unlockDesc:null,_roleType:null,avatar:null,avatarIcon:null,_isUnlock:null,_sortIndex:null},init:function(t){this._id=t.id,this.avatar=t.avatarId,this._unlockDesc=t.unlockDesc,this._roleType=t.roleType,this.avatarIcon=td.GetTableClass(td.TableEnum.AvatarConfig).getAvatarIconByAvatarId(this.avatar)},getAvatar:function(){return this.avatar},getAvatarIcon:function(){return this.avatarIcon},getRoleType:function(){return this._roleType},setIsUnlock:function(t){this._isUnlock=t},getIsUnlock:function(){return this._isUnlock},setSortIndex:function(t){this._sortIndex=t},getSortIndex:function(){return this._sortIndex},getId:function(){return this._id},getUnlockDesc:function(){return this._unlockDesc}}),cc._RF.pop()},{}],LoginDayGiftController1002:[function(t,e,i){"use strict";cc._RF.push(e,"7afda2sjFZCQ4atkS+uqFEW","LoginDayGiftController1002");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("LoginDayGiftController"));e.exports=a,cc._RF.pop()},{LoginDayGiftController:"LoginDayGiftController"}],LoginDayGiftController:[function(t,e,i){"use strict";cc._RF.push(e,"d2778j4pZNBiIYfXh00cxBE","LoginDayGiftController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=window.td,r=t("ActivityBaseController"),o=(t("LoginDayGiftModel"),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._days=0,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e)},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){for(var t=a.GetTableClass(a.TableEnum.ActivityLoginDayGiftConfig).getLoginDayGiftConfigById(this.getActivityData()),e=0;e<t.length;e++)if(t[e].day<=this._days&&-1===this._receiveList.indexOf(t[e].day))return!0;return!1},e.prototype.redPointEvts=function(){return[a.EventNameEnum.LOGIN_DAY_GIFT_UPDATED]},e.prototype.getCurLoginDays=function(){return this._days},e.prototype.getReceiveList=function(){return this._receiveList},e.prototype.isLastDay=function(){return!(!this._dayList||0===this._dayList.myLen()||!this._days)&&this._days===this._dayList.myLen()},e.prototype.activityParse=function(t){var e=t.record,i=e.days||0;this._days=i,this._receiveList=e.list,a.EventUtil.dispatchEvent(a.EventNameEnum.LOGIN_DAY_GIFT_UPDATED)},e}(r));e.exports=o,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",LoginDayGiftModel:"LoginDayGiftModel"}],LoginDayGiftItem:[function(t,e,i){"use strict";cc._RF.push(e,"90758xHU2tP35tpFQl5yr/t","LoginDayGiftItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btn=null,e.img_wdc=null,e.img_ylq=null,e.layout=null,e.lab=null,e}return n(e,t),e.prototype.updateItem=function(e,i){if(t.prototype.updateItem.call(this,e,i),this._customData){var n=this._customData.activityType,a=this._customData.day||0;if(this._day=i.day,this._controller=c.ActivityDataManager.getActivityControllerByType(n),this._controller){var r=this._controller.getReceiveList();this.lab.string=cc.js.formatStr("%s",c.Language.LoginDayGift,a,this._day),a<this._day?(this.btn.active=!1,this.img_ylq.active=!1,this.img_wdc.active=!0):(this.img_wdc.active=!1,this.btn.active=-1===r.indexOf(this._day),this.img_ylq.active=-1!==r.indexOf(this._day)),this.layout.removeAllChildren(!0);for(var o=i.reward,s=c.RewardManager.parseRewardListDetail(o),l=0;l<s.length;l++){var u=c.GlobalFunction.createCommonIconWidget(26,s[l]);u.setScale(.9),this.layout.addChild(u)}}}},e.prototype.onBtnReciveDay=function(){var t={};t.id=this._day,this._controller.operateActivity(t)},a([s(cc.Node)],e.prototype,"btn",void 0),a([s(cc.Node)],e.prototype,"img_wdc",void 0),a([s(cc.Node)],e.prototype,"img_ylq",void 0),a([s(cc.Node)],e.prototype,"layout",void 0),a([s(cc.Label)],e.prototype,"lab",void 0),e=a([o,l("module/Activity/LoginDayGiftItem")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],LoginDayGiftModel:[function(t,e,i){"use strict";cc._RF.push(e,"c2f66+cq0NCwIc0pSstLhfU","LoginDayGiftModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=function(){function t(){this._day=0,this._nameStr="",this._titleStr="",this._desStr="",this._resId="",this._rewardStatus=0}return t.prototype.init=function(t){if(t){this._day=t.day,this._nameStr=t.name||"",this._titleStr=t.title||"",this._desStr=t.des||"";var e=t.resId;this._resId=e<10?"0"+e:e+"",this._rewards=n.RewardManager.parseRewardListDetail(t.reward),this._rewardStatus=n.RewardStatus.CANNOT_RECEIVE}},t.prototype.getDay=function(){return this._day},t.prototype.getNameStr=function(){return this._nameStr},t.prototype.getTitleStr=function(){return this._titleStr},t.prototype.getDes=function(){return this._desStr},t.prototype.getResId=function(){return this._resId},t.prototype.getRewards=function(){return this._rewards},t.prototype.setRewardStatus=function(t){this._rewardStatus=t},t.prototype.getRewardStatus=function(){return this._rewardStatus},t}();e.exports=a,cc._RF.pop()},{}],LoginDayGiftPanel:[function(t,e,i){"use strict";cc._RF.push(e,"2d792+vchhA/qQ4uChchpB7","LoginDayGiftPanel");var n=t("ActivityBasePanel"),a=t("OptimizeVerticalListView"),r=cc.Class({extends:n,properties:{lab_time:cc.Label},onEnable:function(){this._super(),this._addLocalListeners(),this.setActivityTime(),this._firstEnter=!0,this._refresh()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.Res_GET_ACTIVITY_INFO]=this._resInfo,i[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,t.registerEvents(i,this)},_resInfo:function(t){t===this.getActivityId()&&this._refresh()},_refresh:function(){var t=this._controller.getActivityData(),e=this._controller.getCurLoginDays(),i=this._controller.getReceiveList(),n=td.GetTableClass(td.TableEnum.ActivityLoginDayGiftConfig).getLoginDayGiftConfigById(t),r=this.node.getComponent(a),o={};o.day=e,o.activityType=this._controller.getActivityType(),r.setCustomData(o),this._firstEnter?r.refreshListData(n):r.refreshCurList(n),this._firstEnter=!1;for(var s=e-1,l=0;l<n.length;l++)if(n[l].day<=e&&-1===i.indexOf(n[l].day)){s=l;break}r.scrollToRow(s)},setActivityTime:function(){var t=this.getDurationStr();this.lab_time.string=t},_onActivityClose:function(t){this._activityId===t&&this.onDestroy()}});e.exports=r,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0}],LoginDayGiftWindow:[function(t,e,i){"use strict";cc._RF.push(e,"f21a0CUIz5Of6GxoMHQFOqg","LoginDayGiftWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Hero/Manager/HeroManager"),o=t("PanelBase"),s=t("CommonIconWidget"),l=cc._decorator,c=l.ccclass,u=l.property,d=l.menu,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgRewardName=null,e.labTitle=null,e.labDes=null,e.labTips=null,e.btnReceive=null,e.imgReceived=null,e.figureNode=null,e.imgReward=null,e.gemstoneNode=null,e.layerReward=null,e.dayScrollView=null,e.dayContent=null,e.dayItem=null,e._curSelectDay=0,e._curDay=0,e}return n(e,t),e.prototype.init=function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_LoginDayGift},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.dayItem.active=!1,this._activityType=td.ActivityEnum.ActivityType.ACTIVITY_TYPE_4},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListeners(),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE_AND_HIDE_TOWER)},e.prototype.onDisable=function(){this._curDay=0,this._curSelectDay=0,td.EventUtil.unregisterAllEvents(this),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME_AND_SHOW_TOWER),t.prototype.onDisable.call(this)},e.prototype._addEventListeners=function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.LOGIN_DAY_GIFT_UPDATED]=this._onDataUpdated,i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.onReceiveOperation,t.registerEvents(i,this)},e.prototype._onDataUpdated=function(t){var e=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(e)if(t)this.setData();else{var i=e.getDayData(this._curSelectDay);if(!i)return;this._setDayItem(i,this._curSelectItem),this._refreshContent()}},e.prototype.setData=function(t){var e=this,i=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(i){this._curDay=i.getCurLoginDays();var n=i.getCanReceiveDay();this._refreshDayList();var a=t||n||this._curDay;td.GuideManager.isDoingLoginGiftGuide()&&(a=2),this._selectDay(a);var r=0;if(a>3)r=(a-3)*this.dayItem.width;r>0?this.scheduleOnce(function(){e.dayScrollView.scrollToOffset(cc.v2(r,0))},.05):this.dayScrollView.scrollToLeft()}},e.prototype._refreshContent=function(){var t=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(t){var e=t.getDayData(this._curSelectDay);if(e){var i=this._curSelectDay;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_23_dlhl,"HD_dlhl_wz_mz"+e.getResId(),this.imgRewardName),this.labTitle.string=e.getTitleStr(),this.labDes.string=e.getDes();var n=e.getRewards(),a=n[0],o=a.getGoodsType();o===td.GoodsType.Type_Mercenary||o===td.GoodsType.Type_Item&&a.getGoodsSubType()===td.GoodsSubType.HERO_FRAGMENT?(o===td.GoodsType.Type_Item&&(a=r.default.getInstance().getFragmentComposeInfo(a.getId())),this.figureNode.active=!0,this.imgReward.active=!1,this.gemstoneNode.active=!1,td.GlobalFunction.showMercenaryFigureAnimation(this.figureNode,a,!1,!1,800)):o===td.GoodsType.Type_Gemstone?(this.figureNode.active=!1,this.imgReward.active=!1,this.gemstoneNode.active=!0,td.GlobalFunction.createBigGemstoneIcon(a,this.gemstoneNode)):(this.figureNode.active=!1,this.imgReward.active=!0,this.gemstoneNode.active=!1,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_23_dlhl,"HD_dlhl_tb_"+e.getResId()+"_d",this.imgReward));for(var l=0,c=n.length;l<c;l++){var u=n[l];(d=this.layerReward.getChildByName("icon_"+l))?d.getComponent(s).setData(u):((d=td.GlobalFunction.createCommonIconWidget(56,u)).name="icon_"+l,d.scale=.8,d.parent=this.layerReward)}for(;;l++){var d;if(!(d=this.layerReward.getChildByName("icon_"+l)))break;d.removeFromParent(!0)}var h=e.getRewardStatus();if(h===td.RewardStatus.CAN_RECEIVE)this.btnReceive.active=!0,this.labTips.active=!1,this.imgReceived.active=!1;else if(h===td.RewardStatus.RECEIVED)this.btnReceive.active=!1,this.labTips.active=!1,this.imgReceived.active=!0;else{this.btnReceive.active=!1,this.labTips.active=!0,this.imgReceived.active=!1;var p=i-this._curDay,_=td.Language.loginDayGiftTips1;1!==p&&(_=cc.js.formatStr(td.Language.loginDayGiftTips2,p)),this.labTips.getComponent(cc.Label).string=_}}}},e.prototype._refreshDayList=function(){var t=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(t){var e=t.getDayList();for(var i in e){var n=parseInt(i),a=this.dayContent.getChildByName("item_"+i);a||((a=cc.instantiate(this.dayItem)).name="item_"+i,a.parent=this.dayContent,a.y=0,a.active=!0,a.on("touchend",this.touchItem,this),td.RedPointUtil.createRedPointOld(a,cc.v2(-15,-50),t.isDayRedPoint.bind(t,n),t.redPointEvts())),this._setDayItem(e[i],a)}}},e.prototype._setDayItem=function(t,e){var i=t.getDay();e._tag=i;var n=e.getChildByName("layerTitleNormal"),a=e.getChildByName("layerTitleSelect"),r=n.getChildByName("labDay");r.getComponent(cc.Label).string=i,(r=a.getChildByName("labDay")).getComponent(cc.Label).string=i;var o=t.getRewardStatus();e.getChildByName("imgReceived").active=o===td.RewardStatus.RECEIVED,e.getChildByName("labName").getComponent(cc.Label).string=t.getNameStr();var s=t.getRewards()[0],l=e.getChildByName("imgIcon");if(s.getGoodsType()===td.GoodsType.Type_Gemstone){l.removeAllChildren(!0);var c=td.GlobalFunction.getItemIcon(28,s.getGoodsType(),s.getId(),s.getCount());c.name="icon",c.parent=l,c.x=2,c.y=-5}else td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_23_dlhl,"HD_dlhl_tb_"+t.getResId(),l)},e.prototype._selectDay=function(t){if(t!==this._curSelectDay){this.updateData(t);var e=this.dayContent.getChildByName("item_"+t);e&&(this._curSelectItem&&this._setItemSelectStatus(this._curSelectItem,!1),this._curSelectDay=t,this._curSelectItem=e,this._setItemSelectStatus(e,!0),this._refreshContent())}},e.prototype._setItemSelectStatus=function(t,e){t.width=e?160:145;var i=t.getChildByName("imgBg"),n=t.getChildByName("imgIcon"),a=n.getChildByName("icon");a&&(a.y=e?-2:-5);var r=t.getChildByName("layerTitleNormal"),o=t.getChildByName("layerTitleSelect");r.active=!e,o.active=e,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_23_dlhl,e?"HD_dlhl_bg02":"HD_dlhl_bg01",i),n.y=e?-30:-37},e.prototype.touchItem=function(t){var e=t.currentTarget;e&&e._tag&&this._selectDay(e._tag)},e.prototype.onBtnReceive=function(){if(td.GlobalFunction.checkCanClicked()){var t=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(t){var e={};e.activityId=t.getActivityId(),e.id=this._curSelectDay,t.operateActivity(e)}}},e.prototype.onReceiveOperation=function(t){var e=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(e&&t.activityId===e.getActivityId()){var i=t.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n)}},a([u(cc.Node)],e.prototype,"imgRewardName",void 0),a([u(cc.Label)],e.prototype,"labTitle",void 0),a([u(cc.Label)],e.prototype,"labDes",void 0),a([u(cc.Node)],e.prototype,"labTips",void 0),a([u(cc.Node)],e.prototype,"btnReceive",void 0),a([u(cc.Node)],e.prototype,"imgReceived",void 0),a([u(cc.Node)],e.prototype,"figureNode",void 0),a([u(cc.Node)],e.prototype,"imgReward",void 0),a([u(cc.Node)],e.prototype,"gemstoneNode",void 0),a([u(cc.Node)],e.prototype,"layerReward",void 0),a([u(cc.ScrollView)],e.prototype,"dayScrollView",void 0),a([u(cc.Node)],e.prototype,"dayContent",void 0),a([u(cc.Node)],e.prototype,"dayItem",void 0),e=a([c,d("module/Activity/LoginDayGiftWindow")],e)}(o);i.default=h,cc._RF.pop()},{"../../../Hero/Manager/HeroManager":"HeroManager",CommonIconWidget:"CommonIconWidget",PanelBase:void 0}],LoginGiftConfig:[function(t,e,i){"use strict";cc._RF.push(e,"05967QGo4xKcZa7iiBhcFcj","LoginGiftConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="LoginGiftConfig",e._tblName="login_gift_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[t.length]=a}},e.prototype.getExtLoginDayGiftConfig=function(){return this._data},e.prototype.getExtLoginDayGiftConfigbyShowday=function(t){for(var e=[],i=0;i<this._data.length;i++)this._data[i].day<=t&&e.push(this._data[i]);return e},e.prototype.getShowDay=function(t){for(var e=0,i=0;i<this._data.length;i++)this._data[i].day<=t&&(e=this._data[i].showday);return e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LuckyErnieController2:[function(t,e,i){"use strict";cc._RF.push(e,"eaf5aOLXQVF07Hyf8iAYb5s","LuckyErnieController2");var n=t("LuckyErnieController"),a=cc.Class({extends:n,properties:{}});e.exports=a,cc._RF.pop()},{LuckyErnieController:"LuckyErnieController"}],LuckyErnieController:[function(t,e,i){"use strict";cc._RF.push(e,"53ffb7Yr/BJT6II165JJkLe","LuckyErnieController");var n=t("ActivityBaseController"),a=t("Model"),r=t("BaseUser");td.LuckyErnieModel=cc.Class({extends:a,properties:{_dataId:null,_times:null,_cost:null,_reward:null,_rechargeLimit:null},init:function(t){this._super("LuckyErnieModel"),this._dataId=t.data,this._times=t.times,this._cost=td.RewardManager.parseRewardListDetail(t.cost),this._reward=td.RewardManager.parseRewardListDetail(t.reward),this._rechargeLimit=t.recharge},getId:function(){return this._dataId},getTimes:function(){return this._times},getCost:function(){return this._cost[0]},getReward:function(){return this._reward[0]},getRechargeLimit:function(){return this._rechargeLimit},setCurRecharge:function(t){this._curRecharge=t},getCurRecharge:function(){return this._curRecharge},isCanPlay:function(){return this._curRecharge>=this._curRecharge}});var o=cc.Class({extends:r,properties:{_count:null},init:function(t){this._super("LuckyErnieMsg",t.attributes),this._count=t.count},getCount:function(){return this._count}}),s=cc.Class({extends:n,properties:{_data:null,_curRecharge:null,_lastResult:null,_totalTimes:null,_curtimes:null,_chargeMaxTimes:null,_freeTimes:null,_luckMsgList:null},initData:function(t){this._super(t)},getData:function(){return this._data},getCurRecharge:function(){return this._curRecharge},getTotalTimes:function(){return this._totalTimes},getLastResult:function(){return this._lastResult},activityParse:function(t){var e=(u=t.record).recharge;this._curRecharge=u.recharge;var i=u.times;this._curtimes=i;var n=td.GetTableClass(td.TableEnum.LuckyErnieTable).getDatasById(this._activityData);for(var a in this._data=null,n&&n[i+1]?(this._data=new td.LuckyErnieModel,this._data.init(n[i+1]),this._data.setCurRecharge(e),this._totalTimes=td.GetTableClass(td.TableEnum.LuckyErnieTable).getTotalTimesByRecharge(this._activityData,e)):(this._data=new td.LuckyErnieModel,this._data.init(n[i]),this._data.setCurRecharge(e),this._totalTimes=td.GetTableClass(td.TableEnum.LuckyErnieTable).getTotalTimesByRecharge(this._activityData,e)),this._chargeMaxTimes=0,this._freeTimes=0,n)n[a].recharge>0?this._chargeMaxTimes++:this._freeTimes++;var r=t.global;if(this._luckMsgList=[],r&&r.recordList){for(var s=r.recordList,l=0,c=s.length;l<c&&!(this._luckMsgList.length>=3);l++){var u=s[l],d=new o;d.init(u),this._luckMsgList[this._luckMsgList.length]=d}td.EventUtil.dispatchEvent(td.EventNameEnum.LUCKY_ERNIE_RECORD_UPDATED)}},getLuckMsgList:function(){return this._luckMsgList},getFreeTimes:function(){return this._freeTimes},getChargeMaxTimes:function(){return this._chargeMaxTimes},isReachMaxTimes:function(){return this._freeTimes+this._chargeMaxTimes===this._curtimes},getCurTimes:function(){return this._curtimes},getLeftTimes:function(){return this._totalTimes-this._curtimes},getRuleStr:function(){var t=td.GetTableClass(td.TableEnum.LuckyErnieTable).getDatasById(this._activityData),e="";return t&&t[1]&&(e=t[1].c10_Des),td.Language[e]||""},parseRewardReceived:function(t){if(t.activityId===this.getActivityId()){for(var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e),n=0,a=0,r=i.length-1;a<=r;a++){var o=i[a];if(o.type===td.GoodsType.Type_Item&&o.id===td.ItemEnum.Diamond){n=o.count;break}}this._lastResult=n,td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_LUCKY_ERNIE_PANEL,{rewardNum:n,rewards:i})}},setShowBuyGiftRed:function(){td.GlobalFunction.getLocalSaveStatus("LuckyErnie")||(td.GlobalFunction.setLocalSaveStatus("LuckyErnie","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.CARNIVAL_GIFT_SHOWN))},hasRedPoint:function(){return!0},redPointEvts:function(){return[td.EventNameEnum.USER_ATTR_DIAMOND_CHANGE,td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.CARNIVAL_GIFT_SHOWN]},redPointTip:function(){return this.isRedPointTip()},isRedPointTip:function(){return!td.GlobalFunction.getLocalSaveStatus("LuckyErnie")&&(!(this.getLeftTimes()<=0)&&!(this._data.getCost().getCount()>td.Account.getUserData().getDiamond()))}});e.exports=s,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",BaseUser:"BaseUser",Model:"Model"}],LuckyErniePanel:[function(t,e,i){"use strict";cc._RF.push(e,"e94dfSbpNBB5LBoS0qiTfdB","LuckyErniePanel");var n=t("../../../../Common/Chat/Enum/ChatEnum"),a=t("ActivityBasePanel"),r=t("LuckyErnieScrollWidget"),o=cc.Class({extends:a,properties:{lableTime:cc.Label,lableGetMax:cc.Label,labelCost:cc.Label,leftTimes:cc.Label,costNode:cc.Node,lableTips:cc.Label,numNode:cc.Node,richTips:cc.RichText,luckMsgLayer:cc.Node,_timeId:null,_costDiamond:null},initData:function(t){this._super(t)},onEnable:function(){this._super(),this._setActivityTime(),this._addLocalListeners(),this._initUI(),this._resetScorll(),this._controller.setShowBuyGiftRed()},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this),td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_UPDATE_MAIN_LAYER_DIAMOND),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_CHAT_DELAY,n.ChatLocation.CENTER),this._showReward(),this._timeId>0&&(clearTimeout(this._timeId),this._timeId=null)},_addLocalListeners:function(){var t={},e=td.EventNameEnum;t[e.REFRESH_LUCKY_ERNIE_PANEL]=this._scrollErnie,t[e.LUCKY_ERNIE_RECORD_UPDATED]=this._refreshLuckMsg,td.EventUtil.registerEvents(t,this)},_setActivityTime:function(){var t=this.getDurationStr();this.lableTime.string=t},_showReward:function(){this._rewardList&&td.GlobalFunction.showRewards(this._rewardList),this._rewardList=null},_resetScorll:function(){for(var t=0;t<5;t++){this.numNode.getChildByName("item_"+(t+1)).getComponent(r).resetScroll()}},_initUI:function(){var t=this._controller.getData();if(this.leftTimes.string=cc.js.formatStr(td.Language.luckyErnieCostTitle,this._controller.getCurTimes()+1),this._controller.isReachMaxTimes())this.lableTips.string=cc.js.formatStr(td.Language["#broadcast117"]),this.lableTips.node.active=!0,this.costNode.active=!1;else{this.lableTips.node.active=!1,this.costNode.active=!0;var e=t.getReward();this.lableGetMax.string=e.getCount();var i=t.getCost();this.labelCost.string=i.getCount()}this.richTips.string=this._controller.getRuleStr(),this._refreshLuckMsg()},_refreshLuckMsg:function(){for(var t=this._controller.getLuckMsgList(),e=t.length;;e++){if(!(n=this.luckMsgLayer.getChildByName("luckMsg"+e)))break;n.active=!1}for(e=t.length-1;e>=0;e--){var i=t[e],n=this.luckMsgLayer.getChildByName("luckMsg"+(t.length-e)),a=cc.js.formatStr(td.Language.luckyErnieMsg,i.nickName,i.getCount()),r=n.getComponent(td.UFRichText);r||(r=n.addComponent(td.UFRichText)),r.init(a,{quality:4}),n.active=!0}},btnStart:function(){if(td.GlobalFunction.checkCanClicked()&&!this._rewardList){var t=this._controller.getData(),e=t.getCost();if(this._costDiamond=e.getCount(),this._controller.getLeftTimes()<=0){if(this._controller.isReachMaxTimes())a=new td.BroadcastContent(269);else{a=new td.BroadcastContent(307);var i=t.getRechargeLimit(),n=t.getCurRecharge();a.setMainParam([new td.BroadcastParam((i-n)/10)]),a.setOkCallFunc(function(){td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityConfig,td.ActivityEnum.ActivityType.Activity_LuckyErnie])})}a&&td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a)}else{var a;if(e.getCount()>td.Account.getUserData().getDiamond())return(a=new td.BroadcastContent(23)).setOkCallFunc(function(){td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityConfig,td.ActivityEnum.ActivityType.Activity_LuckyErnie])}.bind(this)),void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a);td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSE_UPDATE_MAIN_LAYER_DIAMOND),this._controller.operateActivity({})}}},_scrollErnie:function(t){var e=t.rewardNum,i=t.rewards;if(!(e<=0)){this._rewardList=i,td.EventUtil.dispatchEvent(td.EventNameEnum.UPDATE_DIAMOND_DIFF,-this._costDiamond),this._resetScorll();for(var a=String(e),o=0;o<a.length;o++){this.numNode.getChildByName("item_"+(o+1)).getComponent(r).startScroll(1+1*o,a[a.length-o-1])}var s=400*(a.length+1);this._timeId=setTimeout(function(){this._initUI(),this._showReward(),td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_UPDATE_MAIN_LAYER_DIAMOND),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_CHAT_DELAY,n.ChatLocation.CENTER)}.bind(this),s+1e3)}},onReceiveOperation:function(t){t.activityId===this._activityId&&this._controller.parseRewardReceived(t)}});e.exports=o,cc._RF.pop()},{"../../../../Common/Chat/Enum/ChatEnum":void 0,ActivityBasePanel:"ActivityBasePanel",LuckyErnieScrollWidget:"LuckyErnieScrollWidget"}],LuckyErnieScrollWidget:[function(t,e,i){"use strict";cc._RF.push(e,"e2d83xzLahDW7wjxNRgPmmT","LuckyErnieScrollWidget");var n=t("LuckyErnieScrollWidget");n=cc.Class({extends:cc.Component,properties:{_totalAngle:null,_scrollAngle:null,_destNum:null,_showAngle:null,_labelAngle:null},onLoad:function(){this._showAngle=50,this._init()},onDisable:function(){this.unschedule(this._update)},_init:function(){var t=74/165*this._showAngle;this._labelAngle=[];for(var e=0;e<=9;e++){var i=0+36*e-t/2;this._labelAngle[e]=[i,i+t,i+t/2]}},_update:function(t){if(this._scrollAngle+=720*t,this._scrollAngle>=this._totalAngle)return this.unschedule(this._update),void this.showWidgetByAngle(this._totalAngle);this.showWidgetByAngle(this._scrollAngle)},resetScroll:function(){this.setScroll(0)},setScroll:function(t){this.showWidgetByAngle(36*t)},startScroll:function(t,e,i){i=i||0,this._totalAngle=this._labelAngle[9][2]-this._labelAngle[i][2]+360*t+this._labelAngle[e][2]+36,this._scrollAngle=0,this._destNum=e,this.schedule(this._update,.1)},showWidgetByAngle:function(t){for(var e=[(t%=360)-this._showAngle/2,t+this._showAngle/2],i=this.node.height,n=this._labelAngle,a={},r=0;r<=9;r++){var o=n[r],s=[o[0]-360,o[1]-360,o[2]-360];if(o[0]>e[0]&&o[0]<e[1]||o[1]>e[0]&&o[1]<e[1]||s[0]>e[0]&&s[0]<e[1]||s[1]>e[0]&&s[1]<e[1]){var l=o[2]-e[0];l=l%360==0?0:l,a[r]=l/this._showAngle*i}}var c=this.node.getChildren(),u=this.node.getChildrenCount();r=0;for(var d in a){if(!c[r]){var h=new cc.Node;h.addComponent(cc.Sprite),h.setAnchorPoint(cc.v2(.5,.5)),h.setPosition(cc.v2(0,a[d])),this.node.addChild(h)}td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_19_ycs,"hd_ycs_"+d,c[r]),c[r].setPosition(cc.v2(0,a[d])),r++}for(;r<u;u--)c[r].removeFromParent()}});e.exports=n,cc._RF.pop()},{LuckyErnieScrollWidget:"LuckyErnieScrollWidget"}],LuckyErnieTable:[function(t,e,i){"use strict";cc._RF.push(e,"79656/HLq9I3KZ0ZVeRKLUo","LuckyErnieTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityMammonSacrificeConfig",properties:{_tblName:"activity_mammon_sacrifice_config",_datas:null},init:function(){this._data={},this._chargeTimes=0;for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]||(t[a.data]={}),t[a.data][a.times]=a}},getDatasById:function(t){return this._data&&this._data[t]?this._data[t]:null},getTotalTimesByRecharge:function(t,e){var i=0,n=this._data[t];if(n){for(var a in n)n[a].recharge<=e&&(i+=1);return i}},getCost:function(t,e){var i=this._data[t];if(!i)return 9999999999;for(var n in i)if(i[n].times==e)return i[n].cost;return 9999999999}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LuckyExchangeListView:[function(t,e,i){"use strict";cc._RF.push(e,"c006cOh951FeKp1KxcKrRNn","LuckyExchangeListView");var n=t("BaseScrollView"),a=t("CommonEnum"),r=t("ShopEnum"),o=(t("LuckyShopModel"),cc.Class({extends:n,properties:{},setItemView:function(t,e){var i=t.getChildByName("labName"),n=t.getChildByName("labDesc"),a=t.getChildByName("labPrice"),r=e.getPriceByTimes(1);a.getComponent(cc.Label).string=r[2];var o=td.RewardManager.getRewardDetail(e.getRewards());i.getComponent(cc.Label).string=o.getName(),td.GlobalFunction.setNameColors(i,o.getQuality()),n.getComponent(cc.Label).string=o.getDes();var s=t.getChildByName("itemIcon");s?s.getComponent("CommonIconWidget").setData(o):((s=td.GlobalFunction.createCommonIconWidget(26,o)).scale=.9,s.name="itemIcon",s.setPosition(cc.v2(-260,0)),t.addChild(s));return this._setReceiveBtn(t,e),t},_setReceiveBtn:function(t,e){var i=t.getChildByName("btnExchange"),n=t.getChildByName("labelLimit"),a=i.getComponent(cc.Button),r=e.getNum(),o=e.getMaxTimes();n.getComponent(cc.Label).string=td.Language.canExchangeTimes+(o-r)+"/"+o,n.active=o>0;var s=e.getCanBuyMaxCount(),l=o>0&&r<o||0===o;if(s>0&&l){td.GlobalFunction.setButtonGray(i,!1),a.clickEvents=[];var c=td.GlobalFunction.createClickEventHandler(this.node,"LuckyExchangeListView","onExchange",e);a.clickEvents.push(c)}else td.GlobalFunction.setButtonGray(i,!0);td.RedPointUtil.createRedPointSimple(i,{x:-10,y:-10},s>0&&l)},onExchange:function(t,e){this._showChooseNumWindow(e)},_showChooseNumWindow:function(t){var e=t._price[0][1][0][2],i=td.ItemManager.getItemNumById(td.ItemEnum.LuckyCoin),n=Math.floor(i/e),r=n>99?99:n,o=t.getMaxTimes();if(o>0){var s=t.getNum();r=Math.min(o-s,r)}var l={};t._moneyId=td.ItemEnum.LuckyCoin,l.opType=a.OperateItemType.ExchangeType,l.sureFunc=this.requestExchangeProduct.bind(this),l.itemData=t,l.calcFunc=this.calcNeedPayByItemNum.bind(this),l.maxLimitNum=r,l.showTimesLimit=!1,td.GlobalFunction.showUseOrExchangeWindow(l)},requestExchangeProduct:function(t){var e={},i={};i[t.model.getProductId()]=t.num,e.storeType=r.StoreType.TURNTABLE,e.productMap=i,td.EventUtil.dispatchEvent(td.EventNameEnum.REQBUY_GOODS,e)},calcNeedPayByItemNum:function(t,e){return t*e._price[0][1][0][2]}}));e.exports=o,cc._RF.pop()},{BaseScrollView:void 0,CommonEnum:void 0,LuckyShopModel:"LuckyShopModel",ShopEnum:"ShopEnum"}],LuckyExchangePanel:[function(t,e,i){"use strict";cc._RF.push(e,"cb144r68fVGwaw8HmTBB+GV","LuckyExchangePanel");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../../Shop/Manager/ShopManager"));var a=t("ShopEnum"),r=cc.Class({extends:cc.Component,properties:{_curExchangeType:null,_listViewLogic:null,_controller:null},onLoad:function(){this._curExchangeType=td.ActivityEnum.LuckySwitchType.PrimaryExchange;var t=this.node.getChildByName("scrollView");this._listViewLogic=t.getComponent("LuckyExchangeListView"),this._controller=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.LuckyTurntable)},onEnable:function(){this._addLocalListeners()},onDisable:function(){this._removeAllListeners()},_addLocalListeners:function(){var t={};t[td.EventNameEnum.RESBUY_GOODS]=this.refreshView,td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},hide:function(){this.node.active=!1},show:function(t){this.node.active=!0,this._curExchangeType=t,this.refreshView()},refreshView:function(){var t=n.default.getInstance().getShopModelByType(a.StoreType.TURNTABLE).getItemsBySubType(1);this._setListView(t),this._setPanelTopInfo()},_setPanelTopInfo:function(){var t=this.node.getChildByName("labOwn"),e=td.ItemManager.getItemNumById(td.ItemEnum.LuckyCoin);(new td.Item).init(td.GetTableClass(td.TableEnum.Item).getItemById(td.ItemEnum.LuckyCoin)),t.getComponent(cc.Label).string=e},_setListView:function(t){this._listViewLogic.setData(t),this._listViewLogic.scrollToTop()}});e.exports=r,cc._RF.pop()},{"../../../../Shop/Manager/ShopManager":"ShopManager",ShopEnum:"ShopEnum"}],LuckyModel:[function(t,e,i){"use strict";cc._RF.push(e,"9f800E6UgpG8pA5mTvRLwjQ","LuckyModel");var n=cc.Class({properties:{_id:null,_type:null,_rewardItem:null,_sortRank:null,_quality:null},initData:function(t){this._id=t.id,this._type=t.type,this._rewardItem=td.RewardManager.getRewardDetail(t.rewards[0]),this._sortRank=t.sortRank,this._quality=t.quality},getId:function(){return this._id},getType:function(){return this._type},getRewardItem:function(){return this._rewardItem},getSortRank:function(){return this._sortRank},getRewardQuality:function(){return this._quality}});e.exports=n,cc._RF.pop()},{}],LuckyRankWindowListView:[function(t,e,i){"use strict";cc._RF.push(e,"59a23Q3hKNO0optIn0ZrrOy","LuckyRankWindowListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{},setItemView:function(t,e){var i=t.getChildByName("labMsg").getComponent(td.UFRichText),n=e.msg,a={fontSize:24,quality:e.quality};return i.init(n,a),i.setLeftCenter(),t}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],LuckyRankWindow:[function(t,e,i){"use strict";cc._RF.push(e,"f3449ehN8tBGabIO3d8AseA","LuckyRankWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{_listViewLogic:null,_activityType:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_Lucky_Rank},onLoad:function(){this._super();var t=this._root.getChildByName("scrollView");this._listViewLogic=t.getComponent("LuckyRankWindowListView")},onEnable:function(){this._super(),this._addLocalListeners()},onDisable:function(){this._removeAllListeners(),this._super()},_addLocalListeners:function(){var t={};t[td.EventNameEnum.TURNTABLE_MSG_CHANGED]=this.setListView,td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},setData:function(t){this.setListView(t)},setListView:function(t){if(!this._activityType||this._activityType===t){this._activityType=t;var e=td.ActivityDataManager.getActivityControllerByType(this._activityType);if(e){var i=e.getLuckyMsgList();this._listViewLogic.setData(i)}}},clickBgListener:function(){this.closeCallFunc()}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],LuckyScoreRewardListView:[function(t,e,i){"use strict";cc._RF.push(e,"92f6cvedJtJ+rI8/B11tREu","LuckyScoreRewardListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{_controller:null},onLoad:function(){this._super(),this._controller=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.LuckyTurntable)},setItemView:function(t,e){var i=t.getChildByName("labName"),n=t.getChildByName("labProgress"),a=e.getNeedScore(),r=this._controller.getScore();n.getComponent(cc.RichText).string=r>=a?"<color=#4989aa>"+td.Language.needScore+"</c><color=#0eb001>"+r+"/"+a+"</c><color=#4989aa>"+td.Language.canGet+"</c>":"<color=#4989aa>"+td.Language.needScore+"</c><color=#ff230c>"+r+"</c><color=#0eb001>/"+a+"</c><color=#4989aa>"+td.Language.canGet+"</c>";var o=e.getItem();i.getComponent(cc.Label).string=o.getName(),td.GlobalFunction.setNameColors(i,o.getQuality());var s=t.getChildByName("itemIcon");if(s){var l=s.getComponent("CommonIconWidget");l.setType(26),l.setData(o)}else(s=td.GlobalFunction.createCommonIconWidget(26,o)).scale=.9,s.name="itemIcon",s.setPosition(cc.v2(-260,0)),t.addChild(s);return this._setReceiveBtn(t,e),t},_setReceiveBtn:function(t,e){var i=t.getChildByName("btnGet"),n=t.getChildByName("img_get"),a=i.getComponent(cc.Button);n.active=e.isReceive(),i.active=!e.isReceive();var r=e.isReceive();if(r)td.GlobalFunction.setButtonGray(i,!0);else{var o=e.getNeedScore(),s=this._controller.getScore();if(o<=s){td.GlobalFunction.setButtonGray(i,!1),a.clickEvents=[];var l=td.GlobalFunction.createClickEventHandler(this.node,"LuckyScoreRewardListView","onReceive",e);a.clickEvents.push(l)}else td.GlobalFunction.setButtonGray(i,!0)}td.RedPointUtil.createRedPointSimple(i,{x:-10,y:-10},!r&&o<=s)},onReceive:function(t,e){var i=e.getId();td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_TURN_TABLE_REWARD,i)}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],LuckyScoreRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"7d325PeeXJOnblLAbrTc9qN","LuckyScoreRewardModel");var n=cc.Class({properties:{_id:null,_needScore:null,_item:null,_isReceived:null},initData:function(t){this._id=t.id,this._needScore=t.score,this._item=td.RewardManager.getRewardDetail(t.rewards[0]),this._isReceived=!1},getId:function(){return this._id},getNeedScore:function(){return this._needScore},getItem:function(){return this._item},setIsReceive:function(t){this._isReceived=t},isReceive:function(){return this._isReceived}});e.exports=n,cc._RF.pop()},{}],LuckyScoreRewardPanel:[function(t,e,i){"use strict";cc._RF.push(e,"c4b57I2DwpCwIujZQxbTdn2","LuckyScoreRewardPanel");var n=cc.Class({extends:cc.Component,properties:{_controller:null,_listViewLogic:null},onLoad:function(){this._controller=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.LuckyTurntable);var t=this.node.getChildByName("scrollView");this._listViewLogic=t.getComponent("LuckyScoreRewardListView")},onEnable:function(){this._addLocalListeners()},onDisable:function(){this._removeAllListeners()},_addLocalListeners:function(){var t={};t[td.EventNameEnum.REFRESH_TURN_TABLE_REWARD]=this.refreshView,td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},hide:function(){this.node.active=!1},show:function(t){this.node.active=!0,this.refreshView()},refreshView:function(){this._setPanelTopInfo(),this._setListView()},_setPanelTopInfo:function(){var t=this.node.getChildByName("labOwnScore"),e=this._controller.getScore();t.getComponent(cc.Label).string=cc.js.formatStr(td.Language.myScoreTitle,e)},_setListView:function(){var t=this._controller.getTurnTableShopData();this._listViewLogic.setData(t),this._listViewLogic.scrollToTop()},setTimeDown:function(){var t=this.node.getChildByName("labResetScore"),e=this._controller.getNextResetTime()-td.TimeUtil.getTime();if(t.active=e>0,e>0){var i="";if(e>864e5){var n=parseInt(e/24/60/60/1e3);i=cc.js.formatStr("%s%s",n,td.Language.day)}else i=td.GlobalFunction.getConvertTimeFormat(e/1e3);t.getComponent(cc.Label).string=cc.js.formatStr(td.Language.resetScoreAfterTime,i)}}});e.exports=n,cc._RF.pop()},{}],LuckyScoreRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"1b5abYbnC9NMJ01G1oecKGg","LuckyScoreRewardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"LuckyScoreRewardTable",properties:{_tblName:"turn_score_reward_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0;i<e.length;i++){var n=e[i];t[t.length]=n}},getData:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LuckyShopModel:[function(t,e,i){"use strict";cc._RF.push(e,"6bfa2iYwHFDQIOGq6eHK1Ep","LuckyShopModel");var n=cc.Class({properties:{_productId:null,_reward:null,_price:null,_moneyId:null},initData:function(t){this._productId=t.productId,this._reward=t.rewards,this._price=t.price,this._times=t.times,this._item=td.RewardManager.getRewardDetail(this._reward),this._moneyId=this._price[1]},getProductId:function(){return this._productId},getReward:function(){return this._item},getMoneyId:function(){return this._moneyId},getPriceByTimes:function(t){var e=null,i=this._price.length;if(t>=this._price[i-1][0])e=this._price[i-1][1];else for(var n=0;n<i;n++){if(t<this._price[n][0]){e=0===n?this._price[n][1]:this._price[n-1][1];break}}return e&&(e=e[0]),e}});e.exports=n,cc._RF.pop()},{}],LuckyShopPanel:[function(t,e,i){"use strict";cc._RF.push(e,"6e153cCd7dMxLeTJ8hWpYQd","LuckyShopPanel");var n=t("PanelBase"),a=t("TabController"),r=cc.Class({extends:n,properties:{_scoreRewardPanelLogic:null,_exchangePanelLogic:null,_curSwitchType:0,_controller:null,_tabController:null},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_Lucky_Shop;var t=this._root.getChildByName("btnScoreReward"),e=this._root.getChildByName("btnPrimaryExchange"),i=this._root.getChildByName("btnSeniorExchange");t._tag=td.ActivityEnum.LuckySwitchType.ScoreReward,e._tag=td.ActivityEnum.LuckySwitchType.PrimaryExchange,i._tag=td.ActivityEnum.LuckySwitchType.SeniorExchange,this._tabController||(this._tabController=new a,this._tabController.init([t,e,i],this,td.ActivityEnum.LuckySwitchType.ScoreReward))},onLoad:function(){this._super();var t=this._root.getChildByName("scoreRewardPanel");this._scoreRewardPanelLogic=t.getComponent("LuckyScoreRewardPanel");var e=this._root.getChildByName("exchangePanel");this._exchangePanelLogic=e.getComponent("LuckyExchangePanel"),t.active=!1,e.active=!1,this._controller=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.LuckyTurntable),this._setRedPoint()},_setRedPoint:function(){var t=this._root.getChildByName("btnScoreReward"),e=td.RedPointUtil.isLuckyScoreRewardRedPointTips,i={tipEvents:[td.EventNameEnum.REFRESH_TURN_TABLE_REWARD,td.EventNameEnum.TURN_TABLE_INFO_CHANGED,td.EventNameEnum.RESBUY_GOODS],checkFunc:e,offset:cc.v2(-10,-10)};td.RedPointUtil.createRedPoint(t,i);var n=this._root.getChildByName("btnPrimaryExchange"),a=td.RedPointUtil.isLuckyExchangeRewardRedPointTips,r={tipEvents:[td.EventNameEnum.REFRESH_TURN_TABLE_REWARD,td.EventNameEnum.TURN_TABLE_INFO_CHANGED,td.EventNameEnum.RESBUY_GOODS],checkFunc:a,offset:cc.v2(-10,-10)};td.RedPointUtil.createRedPoint(n,r)},onEnable:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_MAIN_LAYER_BOTTOM_LAYER)},setData:function(t){t=t||td.ActivityEnum.LuckySwitchType.ScoreReward,this._tabController.showTab(t)},showTab:function(t){this._curSwitchType!=t&&(this._curSwitchType=t,this._setView())},_setView:function(){this._setPanelInfo(),this._setPanelTitle(),this._setSwitchBtnStatus()},_setSwitchBtnStatus:function(){var t=this._root.getChildByName("btnScoreReward"),e=this._root.getChildByName("btnPrimaryExchange"),i=this._root.getChildByName("btnSeniorExchange"),n=this._curSwitchType===td.ActivityEnum.LuckySwitchType.ScoreReward,a=this._curSwitchType===td.ActivityEnum.LuckySwitchType.PrimaryExchange,r=this._curSwitchType===td.ActivityEnum.LuckySwitchType.SeniorExchange;t.getComponent(cc.Button).interactable=!n,e.getComponent(cc.Button).interactable=!a,i.getComponent(cc.Button).interactable=!r},_setPanelTitle:function(){var t=this._root.getChildByName("labTitle"),e=this._curSwitchType===td.ActivityEnum.LuckySwitchType.ScoreReward,i=this._curSwitchType===td.ActivityEnum.LuckySwitchType.PrimaryExchange,n=this._curSwitchType===td.ActivityEnum.LuckySwitchType.SeniorExchange,a=td.Language.composeItemType.split("|"),r=td.Language.exchange,o=e?td.Language.scoreReward:i?a[0]+r:n?a[2]+r:"";t.getComponent(cc.Label).string=o},_setPanelInfo:function(){this._curSwitchType===td.ActivityEnum.LuckySwitchType.ScoreReward?(this._scoreRewardPanelLogic.show(),this._exchangePanelLogic.hide()):(this._scoreRewardPanelLogic.hide(),this._exchangePanelLogic.show(this._curSwitchType))},backToLucky:function(){var t=[td.ActivityEnum.Activity.ActivityFixed,td.ActivityEnum.ActivityType.LuckyTurntable];td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_Activity,t)}});e.exports=r,cc._RF.pop()},{PanelBase:void 0,TabController:void 0}],LuckyTurntableController:[function(t,e,i){"use strict";cc._RF.push(e,"a21bepvnl1A94bsvr5KLsHo","LuckyTurntableController");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../../TS/Shop/Manager/ShopManager"));var a=t("ActivityBaseController"),r=t("LuckyTypeModel"),o=t("LuckyScoreRewardModel"),s=t("LuckyShopModel"),l=t("ShopEnum"),c=cc.Class({extends:a,properties:{_playDataList:null,_maxMsgLength:null,_luckyMsgList:null,_showLuckyMsg:null,_score:null,_phase:null,_nextResetTime:null,_shopData:null,_shopList:null,_panelAnimationSkip:null},initData:function(t){this._super(t),this._maxMsgLength=0,this._luckyMsgList=[],this._showLuckyMsg=null,this._playDataList={},this._phase=0,this._score=0,this._nextResetTime=0,this._panelAnimationSkip=!1,this._shopList=[],this._initTurnTableShopData(),this._initTurnTableShopList(),this.addNetListener(),this.addEventListener()},destroyData:function(){this._super(),this._maxMsgLength=null,this._luckyMsgList=null,this._showLuckyMsg=null,this._playDataList=null,this._phase=null,this._score=null,this._nextResetTime=null,this._shopData=null,this._shopList=null},addNetListener:function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.TURN_TABLE_GET_INFO,this._parseTurnTableInfo.bind(this)),i.registerMessage(t,e.TURN_TABLE_TURN,this._onTurnTablePlay.bind(this)),i.registerMessage(t,e.TURN_TABLE_RECEIVE,this._onGetReward.bind(this)),i.registerMessage(t,e.PUSH_TURN_TABLE_INFO,this._parseTurnTableInfo.bind(this)),i.registerMessage(t,e.PUSH_TURN_TABLE_LUCK_MESSAGE,this._parseLuckyMsg.bind(this))},addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REQUEST_TURN_TABLE_INFO]=this._requestBaseInfo.bind(this),t[e.REQUEST_TURN_TABLE_PLAY]=this._requestTurnTablePlay.bind(this),t[e.REQUEST_TURN_TABLE_REWARD]=this._requestExchangeReward.bind(this),td.EventUtil.registerEvents(t,this)},getAniamtionSkipStatus:function(){return this._panelAnimationSkip},setAniamtionSkipStatus:function(t){this._panelAnimationSkip=t},getScore:function(){return this._score},getNextResetTime:function(){return this._nextResetTime},getItemsByType:function(t){var e=this._playDataList[t];return e?e.getItemList():[]},getScorePerTime:function(t){var e=this._playDataList[t];return e?e.getScorePerTime():0},getCostPerTime:function(t){var e=this._playDataList[t];return e?e.getCostPerTime():null},isFreePlay:function(t){var e=this._playDataList[t];return!!e&&e.getNextFreeTime()-td.TimeUtil.getTime()<=0},getNextFreeTime:function(t){var e=this._playDataList[t];return e?e.getNextFreeTime():0},getLastPlayPos:function(t){var e=this._playDataList[t];if(e)return e.getLastPlayPos()},getReplaceKeyId:function(t){var e=this._playDataList[t];return e?e.getReplaceKeyId():null},getLuckyScoreByType:function(t){var e=this._playDataList[t];return e?e.getLuckyScoreByType():0},getLuckyMsgList:function(){return this._luckyMsgList.slice(0)},getLastLuckyMsg:function(){return this._showLuckyMsg},getTurnTableShopData:function(){return this._shopData},getTurnTableShopList:function(){return this._shopList},_requestBaseInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.TURN_TABLE_GET_INFO,td.ServerDelegate.sendMessage(t)},_parseTurnTableInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.ActivityEnum.TurntableType;if(!this._playDataList||0===this._playDataList.myLen())for(var n in i){var a=i[n],o=new r;o.initData(a),this._playDataList[a]=o}var s=this._playDataList;if(this._score=e.score||0,this._nextResetTime=td.TimeUtil.convertTimeWithOffset(e.nextResetTime||0),this._phase!==e.phase){for(var n in i){(d=s[i[n]])&&d.updateItemList(e.phase)}this._phase=e.phase}for(var l=e.turnTables,c=0,u=l.length;c<u;c++){var d,h=l[c];(d=s[h.type])&&d.updateServerData(h)}this._shopData||this._initTurnTableShopData();var p=e.receives;for(c=0;c<this._shopData.length;c++){for(var _=this._shopData[c],g=!1,f=0;f<p.length;f++){if(p[f]===_.getId()){g=!0;break}}_.setIsReceive(g)}this._shopData.sort(function(t,e){return t.isReceive()&&!e.isReceive()?1:!t.isReceive()&&e.isReceive()?-1:t.getId()-e.getId()}),td.EventUtil.dispatchEvent(td.EventNameEnum.TURN_TABLE_INFO_CHANGED)}},_requestTurnTablePlay:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.TURN_TABLE_TURN,e.type=t.type,e.times=t.times,td.ServerDelegate.sendMessage(e)},_onTurnTablePlay:function(t,e){if(t===td.NetCode.SUCCESS){for(var i=e.rewardResults,n=td.RewardManager,a=[],r=0,o=i.length;r<o;r++){var s=n.parseRewardResult(i[r],!0);s&&s.length>0&&(a=a.concat(s))}td.EventUtil.dispatchEvent(td.EventNameEnum.TURNTABLE_ON_PLAY,a)}},_initTurnTableShopData:function(){this._shopData=[];for(var t=this._shopData,e=td.GetTableClass(td.TableEnum.LuckyScoreRewardTable).getData(),i=0;i<e.length;i++){var n=e[i],a=new o;a.initData(n),t[t.length]=a}},_initTurnTableShopList:function(){this._shopList=[];var t=this._shopList,e=l.StoreType.TURNTABLE,i=td.GetTableClass(td.TableEnum.ShopGoodsTable).getShopDataByShopType(e);for(var n in i){var a=i[n],r=new s;r.initData(a),t[t.length]=r}},_requestExchangeReward:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.TURN_TABLE_RECEIVE,e.configId=t,td.ServerDelegate.sendMessage(e)},_onGetReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_TURN_TABLE_REWARD)}},_parseLuckyMsg:function(t,e){if(t===td.NetCode.SUCCESS){e.refresh&&(this._luckyMsgList=[]);for(var i=this._luckyMsgList,n=e.messageList,a=td.UserPropertyEnum,r=td.RewardManager,o=td.Language.TopMsg12,s=td.Language.TopMsg12,l=0,c=n.length;l<c;l++)for(var u=n[l],d=u.attributes,h=u.rewardList,p=d[a.NickName],_=0,g=h.length;_<g;_++){var f=r.getRewardDetail(h[_]),v=(f.getName()||"")+"x"+(f.getCount?f.getCount():1),m=f.getQuality(),y=cc.js.formatStr(o,p,v);y=td.UFRichTextParser.parseXML(y),i.unshift({quality:m,msg:y}),l===c-1&&(y=cc.js.formatStr(s,p,v),this._showLuckyMsg={quality:m,msg:y})}this._luckyMsgList=i||[],this._maxMsgLength||(this._maxMsgLength=td.GetConfig("TURN_TABLE_LUCK_MESSAGE_LIMIT")),this._luckyMsgList.length>this._maxMsgLength&&(this._luckyMsgList=i.slice(0,this._maxMsgLength)),n.length>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.TURNTABLE_MSG_CHANGED,this._activityType)}},hasFreePlay:function(){return!!this.isFreePlay(td.ActivityEnum.TurntableType.Normal)||!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.TurnTable,td.ActivityEnum.TurntableType.Super)&&this.isFreePlay(td.ActivityEnum.TurntableType.Super)},hasRedPoint:function(){return!0},isScoreRewardRedPointTips:function(){for(var t=0,e=this._shopData.length;t<e;t++){var i=this._shopData[t],n=i.isReceive(),a=i.getNeedScore();if(!n&&a<=this._score)return!0}return!1},setShowBuyGiftRed:function(){td.GlobalFunction.getLocalSaveStatus("LuckyTurntable")||(td.GlobalFunction.setLocalSaveStatus("LuckyTurntable","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.CARNIVAL_GIFT_SHOWN))},isExchangeRewardRedPointTips:function(t){void 0===t&&(t=!1);var e=td.GlobalFunction.getLocalSaveStatus("LuckyTurntable");return(!t||!e)&&n.default.getInstance().isShopTipsByType(l.StoreType.TURNTABLE)},isFreeTimesRedPointTips:function(t){return t===td.ActivityEnum.TurntableType.Super?td.UnlockManager.isTargetUnlock(td.ActorUnlockType.TurnTable,td.ActivityEnum.TurntableType.Super,!1)&&this.isFreePlay(td.ActivityEnum.TurntableType.Super):this.isFreePlay(td.ActivityEnum.TurntableType.Normal)},freeTimesRedPointEvts:function(){return[td.EventNameEnum.TURNTABLE_ON_PLAY]},redPointTip:function(){return!!this.isLimitLevelOpen()&&(this.hasFreePlay()||this.isScoreRewardRedPointTips()||this.isExchangeRewardRedPointTips(!0))},redPointEvts:function(){return td.RedPointUtil.luckyTurntableRedPointEvts()},isRedPointTip:function(){return td.RedPointUtil.isLuckyTurntableRedPointTips()}});e.exports=c,cc._RF.pop()},{"../../../../TS/Shop/Manager/ShopManager":"ShopManager",ActivityBaseController:"ActivityBaseController",LuckyScoreRewardModel:"LuckyScoreRewardModel",LuckyShopModel:"LuckyShopModel",LuckyTypeModel:"LuckyTypeModel",ShopEnum:"ShopEnum"}],LuckyTurntablePanel:[function(t,e,i){"use strict";cc._RF.push(e,"75af5owL8ZOuqBhOhTE+Xwj","LuckyTurntablePanel");var n=t("ActivityBasePanel"),a=t("ShopEnum"),r=cc.Class({extends:n,properties:{labMsgItem:cc.Node,imgRotor:cc.Node,_posList:null,_bSkip:null,_curType:null,_playRewards:null,_isFree:null,_toShowMsgList:null,_isAnimateEnd:null,GY0Atlas:cc.SpriteAtlas},initData:function(t){this._super(t)},onLoad:function(){this.labMsgItem.active=!1,this.imgRotor.zIndex=10,this.imgRotor.active=!1,this._posList=[],this._initPosList(),this._toShowMsgList=[],this._bSkip=this._controller.getAniamtionSkipStatus(),this.node.getChildByName("toggle").getComponent(cc.Toggle).isChecked=this._bSkip},_setBtnShopRedPoint:function(){var t=this.node.getChildByName("btnLuckyScoreShop"),e=this.node.getChildByName("btnLuckyShop"),i=td.RedPointUtil.isLuckyScoreRewardRedPointTips.bind(td.RedPointUtil),n=td.RedPointUtil.luckyTurntableRedPointEvts(),a={tipEvents:n,checkFunc:i,offset:cc.v2(-10,-10)};td.RedPointUtil.createRedPoint(t,a),a={tipEvents:n,checkFunc:i=td.RedPointUtil.isLuckyExchangeRewardRedPointTips.bind(td.RedPointUtil),offset:cc.v2(-10,-10)},td.RedPointUtil.createRedPoint(e,a)},onEnable:function(){this._super(),this._addLocalListeners(),td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_TURN_TABLE_INFO),this._curType=td.ActivityEnum.TurntableType.Normal,this._isAnimateEnd=!0,this._setSwitchBtnStatus(),this._setOperateRedPoint(),this._setBtnShopRedPoint(),this.setTimeDown(),this.schedule(this.setTimeDown.bind(this),1),this._controller.setShowBuyGiftRed()},onDisable:function(){this._super(),this._removeAllListeners(),this.unschedule(this.setTimeDown),!this._isAnimateEnd&&this._playRewards&&(this.imgRotor.stopAllActions(),td.GlobalFunction.showRewards(this._playRewards),this._isAnimateEnd=!0)},_addLocalListeners:function(){var t={};t[td.EventNameEnum.TURNTABLE_ON_PLAY]=this._onPlaySuccess,t[td.EventNameEnum.TURN_TABLE_INFO_CHANGED]=this._refreshInfo,t[td.EventNameEnum.TURNTABLE_MSG_CHANGED]=this._refreshLuckyMsg,td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},_initPosList:function(){this._posList[0]=cc.v2(56,621.5);for(var t=null,e=1;e<=5;e++)t=cc.v2(this._posList[0].x+112*e,this._posList[0].y),this._posList[e]=t;for(e=6;e<=10;e++)t=cc.v2(this._posList[5].x,this._posList[5].y-113*(e-5)),this._posList[e]=t;for(e=11;e<=15;e++)t=cc.v2(this._posList[10].x-112*(e-10),this._posList[10].y),this._posList[e]=t;for(e=16;e<=19;e++)t=cc.v2(this._posList[15].x,this._posList[15].y+113*(e-15)),this._posList[e]=t},setTimeDown:function(t){var e=this.node.getChildByName("labFreeTimeDesc"),i=this.node.getChildByName("labFreeTime"),n=(this.node.getChildByName("operatePanel").getChildByName("btnOneTimes"),this._controller.getNextFreeTime(this._curType)-td.TimeUtil.getTime());n>0?(e.active=!0,i.position=cc.v2(-103.5,-776),i.getComponent(cc.Label).string=td.TimeUtil.getHoursFromMilliSecond(n)):(e.active=!1,i.position=cc.v2(-68,-740),i.getComponent(cc.Label).string=td.Language.freeTips);var a=this.node.getChildByName("labTimeCount"),r=this._controller.getNextResetTime()-td.TimeUtil.getTime();a.active=r>0,r>0&&(a.getComponent(cc.Label).string=cc.js.formatStr(td.Language.scoreCutDown,td.GlobalFunction.getTimeSecondsStringByDeltaTime(r)))},onChooseSkipStatus:function(t){this._bSkip=t.isChecked,this._controller.setAniamtionSkipStatus(this._bSkip)},_refreshInfo:function(){this._refreshView(!1),this.setTimeDown(),this._setBtnShopRedPoint()},_refreshView:function(t){this.imgRotor.active=!0,this.imgRotor.zIndex=99;for(var e=this.node.getChildByName("turntablePanel"),i=this._controller.getItemsByType(this._curType),n=td.GlobalFunction,a=0,r=i.length;a<r;a++){var o=i[a],s=o.getSortRank(),l=o.getRewardItem(),c=e.getChildByName("icon_"+s);if(c){var u=c.getComponent("CommonIconWidget");u.setType(26),u.setData(l)}else(c=n.createCommonIconWidget(26,l)).setPosition(this._posList[s-1]),c.scale=.9,c.name="icon_"+s,e.addChild(c,1);var d=o.getRewardQuality(),h=c.getChildByName("imgQualityFlag");if(0!==d){h||((h=new cc.Node).addComponent(cc.Sprite),h.x=-27,h.y=20,h.name="imgQualityFlag",c.addChild(h,80)),h.active=!0;var p="";1===d?p="GY0_bq_xiyou":2===d?p="GY0_bq_hanjian":3===d&&(p="GY0_bq_zhenxi");var _=this.GY0Atlas.getSpriteFrame(p);h.getComponent(cc.Sprite).spriteFrame=_}else h&&(h.active=!1)}if(!t){var g=this._controller.getLastPlayPos(this._curType),f=this._posList[g-1];f&&this.imgRotor.setPosition(f)}this._refreshCostInfo(),this._refreshLuckyInfoNum()},onSwitchTurntableType:function(t,e){var i=parseInt(e);this.imgRotor.getNumberOfRunningActions()>0||(this._curType=i,this._setSwitchBtnStatus(),this._refreshView(),this._setOperateRedPoint(),this._setBtnShopRedPoint(),this.setTimeDown(),this.schedule(this.setTimeDown.bind(this),1))},_setOperateRedPoint:function(){var t=this.node.getChildByName("operatePanel"),e=t.getChildByName("btnNormal"),i=t.getChildByName("btnSuper"),n=t.getChildByName("btnOneTimes"),a=this._controller.isFreeTimesRedPointTips.bind(this._controller,td.ActivityEnum.TurntableType.Normal),r=this._controller.freeTimesRedPointEvts(),o={tipEvents:r,checkFunc:a,offset:cc.v2(-20,-20)};td.RedPointUtil.createRedPoint(e,o);var s=this._controller.isFreeTimesRedPointTips.bind(this._controller,td.ActivityEnum.TurntableType.Super);o={tipEvents:r=this._controller.freeTimesRedPointEvts(),checkFunc:s,offset:cc.v2(-20,-20)},td.RedPointUtil.createRedPoint(i,o);var l=this._curType===td.ActivityEnum.TurntableType.Normal?a:s;o={tipEvents:r=this._controller.freeTimesRedPointEvts(),checkFunc:l,offset:cc.v2(-20,-10)},td.RedPointUtil.createRedPoint(n,o)},_setSwitchBtnStatus:function(){var t=this.node.getChildByName("operatePanel"),e=t.getChildByName("btnNormal"),i=t.getChildByName("btnSuper");e.getComponent(cc.Button).interactable=this._curType!==td.ActivityEnum.TurntableType.Normal,i.getComponent(cc.Button).interactable=this._curType!==td.ActivityEnum.TurntableType.Super;var n=this._curType===td.ActivityEnum.TurntableType.Normal;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_05_xyzp,n?"HD_anjian01":"HD_anjian02",e),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_05_xyzp,n?"HD_anjian02":"HD_anjian01",i);var a=e.getChildByName("Label"),r=a.getComponent(cc.LabelOutline);r.color=n?cc.color(234,94,0):cc.color(44,126,194),(r=(a=i.getChildByName("Label")).getComponent(cc.LabelOutline)).color=n?cc.color(44,126,194):cc.color(234,94,0);var o=this.node.getChildByName("labFreeTimeDesc"),s=this.node.getChildByName("labFreeTime"),l=this._controller.getNextFreeTime(this._curType)-td.TimeUtil.getTime();l>0?(o.active=!0,s.position=cc.v2(-103.5,-776),s.getComponent(cc.Label).string=td.TimeUtil.getHoursFromMilliSecond(l)):(o.active=!1,s.position=cc.v2(-68,-740),s.getComponent(cc.Label).string=td.Language.freeTips);var c=e.getChildByName("labScore"),u=i.getChildByName("labScore"),d=this._controller.getScorePerTime(td.ActivityEnum.TurntableType.Normal),h=this._controller.getScorePerTime(td.ActivityEnum.TurntableType.Super);c.getComponent(cc.Label).string=d+td.Language.score,u.getComponent(cc.Label).string=h+td.Language.score},_refreshCostInfo:function(){var t=this.node.getChildByName("operatePanel"),e=t.getChildByName("costPanel_1"),i=t.getChildByName("costPanel_2"),n=t.getChildByName("keyPanel"),a=this._controller.getReplaceKeyId(this._curType);n.getChildByName("labKey").getComponent(cc.Label).string=td.ItemManager.getItemNumById(a);var r=n.getChildByName("icon"),o=new td.Item;o.init(td.GetTableClass(td.TableEnum.Item).getItemById(a)),td.GlobalFunction.createSpriteNode(r,o.getLittleIconRes());var s=this._controller.getNextFreeTime(this._curType)-td.TimeUtil.getTime();this._isFree=s<=0,e.active=!this._isFree;var l=this._controller.getCostPerTime(this._curType);if(l){var c=l.getLittleIconRes(),u=l.getCount();td.ItemManager.getItemNumById(l.getId());if(!this._isFree){var d=e.getChildByName("imgCurrency"),h=e.getChildByName("labNeed"),p=0,_=null;(a=this._controller.getReplaceKeyId(this._curType))&&(p=td.ItemManager.getItemNumById(a),(_=new td.Item).init(td.GetTableClass(td.TableEnum.Item).getItemById(a))),p>0&&_?(d.getComponent(cc.Sprite).spriteFrame=_.getLittleIconRes(),h.getComponent(cc.Label).string=1):(d.getComponent(cc.Sprite).spriteFrame=c,h.getComponent(cc.Label).string=u)}var g=i.getChildByName("imgCurrency"),f=i.getChildByName("labNeed");g.getComponent(cc.Sprite).spriteFrame=c,f.getComponent(cc.Label).string=5*u}},_refreshLuckyInfoNum:function(){var t=this.node.getChildByName("labCurrencyNum"),e=td.ItemManager.getItemNumById(td.ItemEnum.LuckyCoin);td.GetTableClass(td.TableEnum.Item).getItemById(td.ItemEnum.LuckyCoin);t.getComponent(cc.Label).string=e;var i=this.node.getChildByName("topInfoPanel").getChildByName("labLuckyScore"),n=this._controller.getLuckyScoreByType(this._curType);i.getComponent(cc.Label).string=n;var a=this.node.getChildByName("labScoreNum");n=this._controller.getScore();a.getComponent(cc.Label).string=td.Language.myScoreTitle+n},onRotateTurntable:function(t,e){if(this._curType!==td.ActivityEnum.TurntableType.Super||td.UnlockManager.isTargetUnlock(td.ActorUnlockType.TurnTable,td.ActivityEnum.TurntableType.Super,!0)){var i=parseInt(e);if(!(this.imgRotor.getNumberOfRunningActions()>0)&&(this._curType!==td.ActivityEnum.TurntableType.Super||td.UnlockManager.isTargetUnlock(td.ActorUnlockType.TurnTable,td.ActivityEnum.TurntableType.Super,!0)))if(this._isFree&&1===i)this._tryToPlay(i);else{var n=td.GamerResourceUtil.TipType.Tip,a=this._controller.getCostPerTime(this._curType),r=this._controller.getReplaceKeyId(this._curType),o=0;r&&(o=td.ItemManager.getItemNumById(r)),(o>0||td.GamerResourceUtil.checkResource(a.getId(),a.getCount()*i,n))&&this._tryToPlay(i)}}},_tryToPlay:function(t){this._bSkip||td.EventUtil.dispatchEvent(td.EventNameEnum.SET_TOP_MSG_VISIBLE,!1);var e={};e.type=this._curType,e.times=t,td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_TURN_TABLE_PLAY,e)},_onPlaySuccess:function(t){if(this._bSkip||t.length>1)td.EventUtil.dispatchEvent(td.EventNameEnum.SET_TOP_MSG_VISIBLE,!0),this._refreshView(),td.GlobalFunction.showRewards(t),this._isAnimateEnd=!0;else{this._isAnimateEnd=!1,this._playRewards=t,this._refreshView(!0);var e=this._controller.getLastPlayPos(this._curType)-1;this._showPlayToPos(e)}this._setBtnShopRedPoint()},_showPlayToPos:function(t){this.imgRotor.stopAllActions();var e=new cc.MoveArround(6,this._posList,t,2).easing(cc.easeSineOut()),i=cc.callFunc(this._showPlayRewards.bind(this)),n=cc.sequence(e,cc.delayTime(.2),i);this.imgRotor.runAction(n)},_showPlayRewards:function(){this._playRewards&&(this._refreshLuckyInfoNum(),td.GlobalFunction.showRewards(this._playRewards),td.EventUtil.dispatchEvent(td.EventNameEnum.SET_TOP_MSG_VISIBLE,!0),this._playRewards=null),this._checkLuckyMsg(),this._isAnimateEnd=!0},_showLuckyMsg:function(){var t=this._controller.getLuckyMsgList();td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_SummonLucky,t)},_refreshLuckyMsg:function(){this._toShowMsgList=this._controller.getLuckyMsgList(),this.imgRotor.getNumberOfRunningActions()<=0&&this._checkLuckyMsg()},_checkLuckyMsg:function(){var t=this.node.getChildByName("broadPanel"),e=t.getChildByName("richText");if(!(e&&e.getNumberOfRunningActions()>0)){var i=this._toShowMsgList.shift();if(i||(i=this._controller.getLastLuckyMsg()),i&&(e||((e=this._createNewLuckyMsg(i)).x=t.width,e.y=0,e.name="richText",t.addChild(e,10)),e.getNumberOfRunningActions()<=0)){var n=e.width+t.width,a=cc.moveBy(10,-n,0),r=cc.callFunc(function(t){t.stopAllActions(),t.removeFromParent()}),o=cc.callFunc(function(){this._checkLuckyMsg()}.bind(this)),s=cc.sequence(a,r,o);e.runAction(s)}}},_createNewLuckyMsg:function(t){if(!t)return null;var e=cc.instantiate(this.labMsgItem);e.active=!0;var i=e.getComponent(td.UFRichText),n=t.msg,a={fontSize:28,quality:t.quality};return i.init(n,a),i.setLeftCenter(),e},gotoLuckyShop:function(t,e){e=parseInt(e);var i=a.StoreType.TURNTABLE;td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Shop,i,!0)&&(td.GetTableClass(td.TableEnum.ShopShowTable).getShowDataByShopType(i)&&td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_Lucky_Shop,e))},showLuckyMsgListWindow:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_Lucky_Rank,this._activityType)}});e.exports=r,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",ShopEnum:"ShopEnum"}],LuckyTurntableTable:[function(t,e,i){"use strict";cc._RF.push(e,"f0c10DrmWpKTaZX5+h420Ot","LuckyTurntableTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"LuckyTurntableTable",properties:{_tblName:"turn_table_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0;i<e.length;i++){var n=e[i],a=n.phase,r=n.type;t[a]=t[a]||{},t[a][r]=t[a][r]||[];var o=t[a][r];o[o.length]=n}},getTurnTableConfig:function(t,e){return this._data&&this._data[t]&&this._data[t][e]?this._data[t][e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],LuckyTypeModel:[function(t,e,i){"use strict";cc._RF.push(e,"b9aacx4/YBJhYQX4GqtqN97","LuckyTypeModel");var n=t("LuckyModel"),a=cc.Class({properties:{_playType:null,_itemList:null,_luckyScore:null,_lastPos:null,_nextFreeTime:null,_scorePerTime:null,_cost:null,_replaceItemId:null},initData:function(t){this._playType=t,this._itemList=[],this._lastPos=1,this._luckyScore=0,this._nextFreeTime=0,this._initConfig()},_initConfig:function(){for(var t=this._playType,e=td.GetConfig("TURN_TABLE_SCORE"),i=0,n=e.length;i<n;i++){if((a=e[i])[0]===t){this._scorePerTime=a[1];break}}for(i=0,n=(e=td.GetConfig("TURN_TABLE_TURN_COST")).length;i<n;i++){if((a=e[i])[0]===t){this._cost=td.RewardManager.getRewardDetail(a[1]);break}}for(i=0,n=(e=td.GetConfig("TURN_TABLE_REPLACE_GOODS")).length;i<n;i++){var a;if((a=e[i])[0]===t){this._replaceItemId=a[1];break}}},getItemList:function(){return this._itemList},getScorePerTime:function(){return this._scorePerTime},getCostPerTime:function(){return this._cost},getNextFreeTime:function(){return this._nextFreeTime},getLastPlayPos:function(){return this._lastPos},getReplaceKeyId:function(){return this._replaceItemId},getLuckyScoreByType:function(){return this._luckyScore},updateServerData:function(t){this._luckyScore=t.luckValue||0,this._lastPos=this._getPosById(t.id),this._nextFreeTime=td.TimeUtil.convertTimeWithOffset(t.nextFreeTime||0)},updateItemList:function(t){this._itemList=[];var e=td.GetTableClass(td.TableEnum.LuckyTurntableTable).getTurnTableConfig(t,this._playType);if(e&&0!==e.length){for(var i=this._itemList,a=0,r=e.length;a<r;a++){var o=e[a],s=new n;s.initData(o),i[i.length]=s}i.sort(function(t,e){return t.getSortRank()-e.getSortRank()})}else cc.log("get turntable config error for phase = "+t)},_getPosById:function(t){if(!t)return 1;for(var e=this._itemList,i=0,n=e.length;i<n;i++)if(e[i].getId()===t)return e[i].getSortRank();return 1}});e.exports=a,cc._RF.pop()},{LuckyModel:"LuckyModel"}],MDBuff:[function(t,e,i){"use strict";cc._RF.push(e,"54d8dGdQlpHrZ44Pl4O4Lwg","MDBuff");var n=t("PveBaseBuff"),a=(t("PveFightManager"),cc.Class({extends:n,properties:{_bShowBuff:null},initData:function(t){if(this._super(t),this.node.active=!1,this._buffType=td.PveEnum.PVE_EFFECT_TYPE.ReduceMagicDefence,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff){var e=this.node.getChildByName("MDBuff");if(!e){var i=gdk.rm.getResByUrl("fightRes/pve/buff/dun_buff/zidun",cc.Prefab);e=cc.instantiate(i),this.node.addChild(e),e.y=-20,e.name="MDBuff"}this._buffAnimation=e.getComponent(cc.Animation),this._clipName="MDBuff",cc.log("this is MD buff !!!")}},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._bShowBuff,this.setTargetBuffData(!0),this.schedule(this.onUpdateMagicDefenseBuff,1/60)):this.removeSelf()},onDisable:function(){this._super(),this.unschedule(this.onUpdateMagicDefenseBuff)},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=i.getDataModel(),a=(t?-1:1)*this._curBuffData.buffData*1e4,r=n.getGrade();this.node.scale=r>=3?2.5:.8,i.setCurMDChange(a)},onUpdateMagicDefenseBuff:function(t){if(!this._bFightPause)return this._curBuffData.buffTime<=0?(this.unschedule(this.onUpdateMagicDefenseBuff),this.setTargetBuffData(!1),void this.endBuff()):void(this._curBuffData.buffTime-=t*this._curSpeedMult)},onChangeSpeedMult:function(t){this._super(t),this._bShowBuff&&this.refreshSkillAnimationSpeed(t)},refreshSkillAnimationSpeed:function(t){},endBuff:function(){(this._super(),cc.isValid(this._curTarget))&&this._curTarget.getComponent("EnemyBuffCtrlComponent").removeBuffFromList(this._buffType,this._curBuffKey)}}));e.exports=a,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],MagicRecordEnum:[function(t,e,i){"use strict";cc._RF.push(e,"79f7fHmMh5HRoXZrtoPpHfk","MagicRecordEnum"),td.MagicRecordEnum={RewardState:{canGet:1,canNotGet:2,Gotten:3}},cc._RF.pop()},{}],MagicRecordManager:[function(t,e,i){"use strict";cc._RF.push(e,"cf145jS4qxB66etHjLVe+zD","MagicRecordManager"),td.MagicRecordManager={_buyTimes:null,_challengeTimes:null,_entities:null,_receives:null,challengeId:null,pageId:null,maxPage:null,selectId:null,_curMagicRecordTaskList:null,init:function(){this.destroyData(),this._addNetListeners(),this._addLocalListeners()},destroyData:function(){this._buyTimes=0,this._challengeTimes=0,this._entities=[],this._receives=[],this.challengeId=0,this.pageId=1,this.maxPage=1,this.selectId=0,this._curMagicRecordTaskList=[]},_addNetListeners:function(){var t=td.ServerDelegate,e=td.MsgModuleName.MAGIC_RECORD,i=td.MsgCmd.MAGIC_RECORD;t.registerMessage(e,i.MAGIC_RECORD_INFO,this.receiveMagicRecordInfo.bind(this)),t.registerMessage(e,i.MAGIC_RECORD_PREPARE,this.receiveMagicRecordPrepare.bind(this)),t.registerMessage(e,i.MAGIC_RECORD_CHALLENGE,this.receiveMagicRecordChallenge.bind(this)),t.registerMessage(e,i.MAGIC_RECORD_BUY_TIMES,this.receiveMagicRecordBuyTime.bind(this)),t.registerMessage(e,i.MAGIC_RECORD_RECEIVE,this.receiveMagicRecordReceive.bind(this)),t.registerMessage(e,i.MAGIC_RECORD_SWEEP,this.receiveMagicRecordSweep.bind(this)),t.registerMessage(e,i.MAGIC_RECORD_RESET,this.receiveMagicRecordReset.bind(this)),t.registerMessage(e,i.PUSH_MAGIC_RECORD_INFO,this.receiveMagicRecordInfo.bind(this))},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQ_MAGIC_RECORD_INFO]=this.queryMagicRecordInfo,i[e.REQ_MAGIC_RECORD_PREPARE]=this.queryMagicRecordPrepare,i[e.REQ_MAGIC_RECORD_CHALLENGE]=this.queryMagicRecordChallenge,i[e.REQ_MAGIC_RECORD_BUY_TIMES]=this.queryMagicRecordBuyTime,i[e.REQ_MAGIC_RECORD_RECEIVE]=this.queryMagicRecordReceive,i[e.REQ_MAGIC_RECORD_SWEEP]=this.queryMagicRecordSweep,i[e.REQ_MAGIC_RECORD_RESET]=this.queryMagicRecordReset,t.registerEvents(i,this)},haveRewardCanReceive:function(){for(var t=td.MagicRecordEnum.RewardState.canGet,e=0,i=this._curMagicRecordTaskList.length;e<i;e++){if(this._curMagicRecordTaskList[e].getReceivedStatus()===t)return!0}return!1},isRedPointTips:function(){return!!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_MagicRecord)&&(this._challengeTimes>0||this.haveRewardCanReceive())},redPointEvents:function(){var t=td.EventNameEnum;return[t.USER_ATTR_LEVEL_CHANGE,t.RES_MAGIC_RECORD_INFO,t.RES_MAGIC_RECORD_RECEIVE]},queryMagicRecordInfo:function(){var t={};t.module=td.MsgModuleName.MAGIC_RECORD,t.cmd=td.MsgCmd.MAGIC_RECORD.MAGIC_RECORD_INFO,td.ServerDelegate.sendMessage(t)},receiveMagicRecordInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._buyTimes=e.buyTimes,this._challengeTimes=e.challengeTimes,this._entities=e.entities,this._receives=e.receives;var i=td.GetConfig("MAGIC_RECORD_CHALLENGE_TIMES");this._challengeTimes=i-this._challengeTimes+this._buyTimes,this._parseMagicRecordInfo(this._receives),this.setPageAndSelectId(this._entities),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_MAGIC_RECORD_INFO)}},setPageAndSelectId:function(t){var e=t.length>0?t[t.length-1].id:0,i=td.GetTableClass(td.TableEnum.MagicRecordTable).getNextDataById(e);if(i){var n=i.storyIdLimit,a=i.levelLimit,r=td.Account.getUserData().getLevel();td.PveGeneralCopyManager.getCurPassedGateId()>=n&&r>=a?(this.pageId=Math.floor(t.length/5)+1,this.selectId=t.length%5):0==t.length?(this.pageId=1,this.selectId=-1):t.length%5==0?(this.pageId=Math.floor(t.length/5),this.selectId=4):(this.pageId=Math.floor(t.length/5)+1,this.selectId=t.length%5-1)}else this.pageId=Math.floor(t.length/5),this.selectId=4;console.log("pageId = "+this.pageId+"  selectId = "+this.selectId)},queryMagicRecordPrepare:function(t){this.challengeId=t.id;var e={};e.module=td.MsgModuleName.MAGIC_RECORD,e.cmd=td.MsgCmd.MAGIC_RECORD.MAGIC_RECORD_PREPARE,e.id=t.id,e.isRoll=t.isRoll||!1,td.ServerDelegate.sendMessage(e)},receiveMagicRecordPrepare:function(t,e){if(t===td.NetCode.SUCCESS)if(e&&e.rewardResult){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);n&&n.length>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.MAGIC_RECORD_ON_GET_CHALLENGE_QUICK,n)}else td.EventUtil.dispatchEvent(td.EventNameEnum.RES_MAGIC_RECORD_PREPARE)},queryMagicRecordChallenge:function(t){var e={};e.module=td.MsgModuleName.MAGIC_RECORD,e.cmd=td.MsgCmd.MAGIC_RECORD.MAGIC_RECORD_CHALLENGE,e.id=t.id,e.star=t.stars,td.ServerDelegate.sendMessage(e)},receiveMagicRecordChallenge:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.RECEIVE_PVE_FIHGT_REAWRD,n),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_MAGIC_RECORD_CHALLENGE)}else td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PRE_PANEL)},queryMagicRecordBuyTime:function(t){var e={};e.module=td.MsgModuleName.MAGIC_RECORD,e.cmd=td.MsgCmd.MAGIC_RECORD.MAGIC_RECORD_BUY_TIMES,e.times=t,td.ServerDelegate.sendMessage(e)},receiveMagicRecordBuyTime:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.BUY_TIMES_SUCCESS)},queryMagicRecordReceive:function(t){var e={};e.module=td.MsgModuleName.MAGIC_RECORD,e.cmd=td.MsgCmd.MAGIC_RECORD.MAGIC_RECORD_RECEIVE,e.star=t,td.ServerDelegate.sendMessage(e)},receiveMagicRecordReceive:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult);td.GlobalFunction.showRewards(i),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_MAGIC_RECORD_RECEIVE)}},queryMagicRecordSweep:function(t){this.challengeId=t;var e={};e.module=td.MsgModuleName.MAGIC_RECORD,e.cmd=td.MsgCmd.MAGIC_RECORD.MAGIC_RECORD_SWEEP,e.id=t,td.ServerDelegate.sendMessage(e)},receiveMagicRecordSweep:function(t,e){if(t===td.NetCode.SUCCESS){for(var i=[],n=e.rewardList,a=(td.RewardManager,0),r=n.length-1;a<=r;a++){for(var o={},s=td.RewardManager.parseRewardResult(n[a]),l=[],c=0;c<s.length;c++){var u=s[c],d=td.GlobalFunction.getGoodsData(u.type,u.id,u.count);l.push(d)}o.rewards=l,i[i.length]=o}td.EventUtil.dispatchEvent(td.EventNameEnum.RES_MAGIC_RECORD_SWEEP,i)}},queryMagicRecordReset:function(t){var e={};e.module=td.MsgModuleName.MAGIC_RECORD,e.cmd=td.MsgCmd.MAGIC_RECORD.MAGIC_RECORD_RESET,e.id=t,td.ServerDelegate.sendMessage(e)},receiveMagicRecordReset:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.BUY_TIMES_SUCCESS)},getCurUnlockId:function(){return this._entities&&0!==this._entities.length?this._entities[this._entities.length-1].id:0},getChallengeTimes:function(){return this._challengeTimes},getChallengeId:function(){return this.challengeId},getPageId:function(){return this.pageId},setPageId:function(t){this.pageId=t},getMaxPage:function(){return this.maxPage=td.GetTableClass(td.TableEnum.MagicRecordTable).getDatas().myLen()/5,this.maxPage},getSelectId:function(){return this.selectId},setSelectId:function(t){this.selectId=t},getEntities:function(){return this._entities},getReceives:function(){return this._receives},getMaxPassedId:function(){return this._entities&&0!==this._entities.length?this._entities[this._entities.length-1].id:0},getTotalStar:function(){for(var t=0,e=0;e<this._entities.length;e++)t+=this._entities[e].star;return t},getBoughtTimes:function(){return this._buyTimes},getCanBuyLeftCivilTimes:function(){var t=td.Account.getUserData().vip,e=td.GetTableClass(td.TableEnum.VipPrivilegeTable).getPrerogativeByTypeAndOpenValue(CommonEnum.PrerogativeEnum.MagicRecordBuyTimes),i=0;for(var n in e){var a=e[n].privilegeOpenValue;if(a>t)break;i=a}var r=e[i],o=0;r&&r.value&&(o=r.value);for(var s=0,l=td.Account.getUserData().getDiamond(),c=1;c<=o;c++)if((s+=this.getBuyCicilCopyChallengeTimesPrice(c))>l){o=c-1;break}return o-this._buyTimes<=0?0:o-this._buyTimes},calcBuyChallengeTimesCost:function(t){for(var e,i=td.GlobalFunction,n=this.getBoughtTimes(),a=1+n;a<=t+n;a++)e?e.setCount(e.getCount()+i.getShareConfigUpCostCount("MAGIC_RECORD_BUY_TIMES_COST",a)):e=i.getShareConfigUpCostDetail("MAGIC_RECORD_BUY_TIMES_COST",a);return e},_parseMagicRecordInfo:function(t){this._curMagicRecordTaskList=[];var e=td.GetTableClass(td.TableEnum.MagicRecordRewardTable).getDatas();for(var i in e){var n=new td.MagicRecordTaskModel;n.init(e[i]);for(var a=n.getCount(),r=this.getTotalStar()>=a?td.MagicRecordEnum.RewardState.canGet:td.MagicRecordEnum.RewardState.canNotGet,o=0;o<t.length;o++)if(-1!=t.indexOf(a)){r=td.MagicRecordEnum.RewardState.Gotten;break}n.setReceivedStatus(r),this._curMagicRecordTaskList.push(n)}},getCurMagicRecordTaskList:function(){return this._curMagicRecordTaskList}},cc._RF.pop()},{}],MagicRecordRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"2a13ad3+r5GuqnAnyOcmu0u","MagicRecordRewardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"MagicRecordRewardTable",properties:{_tblName:"magic_record_reward_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.star]=a}},getDatas:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MagicRecordTable:[function(t,e,i){"use strict";cc._RF.push(e,"0a2c6HUlmRBBZooz109itdP","MagicRecordTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"MagicRecordTable",properties:{_tblName:"magic_record_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.recordId]=a}},getDatas:function(){return this._data},getDataById:function(t){return this._data[t]?this._data[t]:null},getNextDataById:function(t){if(this._data[t]){var e=this._data[t].nextRecordId;return this._data[e]||null}return this._data[td.ArrayUtil.frontKey(this._data)]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MagicRecordTaskModel:[function(t,e,i){"use strict";cc._RF.push(e,"1874cvLltRNUZuKSQW98x8s","MagicRecordTaskModel"),td.MagicRecordTaskModel=cc.Class({properties:{_count:null,_rewards:null,_rewardState:null},init:function(t){this._rewardState=td.KDEnum.RewardState.canNotGet,this._count=t.star,this._rewards=td.RewardManager.parseRewardListDetail(t.reward)},getCount:function(){return this._count},getTaskRewards:function(){return this._rewards},setReceivedStatus:function(t){this._rewardState=t},getReceivedStatus:function(){return this._rewardState}}),cc._RF.pop()},{}],MagicShopController2:[function(t,e,i){"use strict";cc._RF.push(e,"764a0y58LBCcZL8XLkSjVSV","MagicShopController2");var n=t("FamousGeneralShopController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{FamousGeneralShopController:"FamousGeneralShopController"}],MagicShopController:[function(t,e,i){"use strict";cc._RF.push(e,"fba9fyDrqtAEaKaXjegT1J+","MagicShopController");var n=t("FamousGeneralShopController"),a=t("MagicShopModel"),r=cc.Class({extends:n,activityParse:function(t){var e=t.record,i=e.level,n=e.vipLevel,r=e.day,o=e.buyMap,s=this.getActivityData();this._modelList=[];var l=td.GetTableClass(td.TableEnum.FamousGeneralShopTable).getDataByDataIdAndDay(s,r);if(l)for(var c in l){var u=l[c];if(u.minLevel<i&&i<=u.maxLevel&&td.Account.getUserData().vip>=n){var d=new a;d.initData(l[c]),o[c]&&d.setExchangeTimes(o[c]),this._modelList.push(d)}}}});e.exports=r,cc._RF.pop()},{FamousGeneralShopController:"FamousGeneralShopController",MagicShopModel:"MagicShopModel"}],MagicShopListView:[function(t,e,i){"use strict";cc._RF.push(e,"23b79BiFuZFhYTaqasQcrtP","MagicShopListView");var n=t("FamousGeneralShopListView"),a=cc.Class({extends:n,properties:{discountItem:cc.Node},onLoad:function(){this._super(),this.discountItem&&(this.discountItem.active=!1)},setItemView:function(t,e){if(e&&t){var i=t.getChildByName("labOddTimes"),n=e.getExchangeTimes(),a=e.getTotalTimes(),r=e.getConsume(),o=e.getReward();i.getComponent(cc.Label).string=td.Language.leftTimes+(a-n)+"/"+a;var s=t.getChildByName("consume");s&&s.removeFromParent();var l,c,u=r[0],d=td.GlobalFunction.createCommonIconWidget(26,u);for(d.scale=.8,d.name="consume",d.setPosition(cc.v2(-270,0)),t.addChild(d),l=0,c=o.length;l<c;l++){var h=t.getChildByName("reward"+l);h&&h.removeFromParent()}var p=e.getDiscount();for(l=0,c=o.length;l<c;l++){var _=o[l],g=td.GlobalFunction.createCommonIconWidget(26,_);if(g.name="reward"+l,g.scale=.8,g.setPosition(cc.v2(145*l*.7-70,0)),p<10){var f=cc.instantiate(this.discountItem);f.active=!0,f.x=-55,f.y=65,f.getChildByName("labDiscount").getComponent(cc.Label).string=p,g.addChild(f)}t.addChild(g)}return this.setOperationBtn(t,e),t}}});e.exports=a,cc._RF.pop()},{FamousGeneralShopListView:"FamousGeneralShopListView"}],MagicShopModel:[function(t,e,i){"use strict";cc._RF.push(e,"ec930zTfo1OGZ0Qe/GMVzZi","MagicShopModel");var n=t("FamousGeneralShopModel"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{FamousGeneralShopModel:"FamousGeneralShopModel"}],MagicShopPanel:[function(t,e,i){"use strict";cc._RF.push(e,"5687297Sw1IopIywM8Q/BYq","MagicShopPanel");var n=t("FamousGeneralShopPanel"),a=cc.Class({extends:n,properties:{_listViewLogic:null},initData:function(t){this._super(t)},onLoad:function(){var t=this.node.getChildByName("itemWidget").getChildByName("scrollView");this._listViewLogic=t.getComponent("MagicShopListView")}});e.exports=a,cc._RF.pop()},{FamousGeneralShopPanel:"FamousGeneralShopPanel"}],MagpieBridgePartyController:[function(t,e,i){"use strict";cc._RF.push(e,"e96f0oedT5BqrZ0rOkRiETK","MagpieBridgePartyController"),td.QiXiStageEnum={MagpieBridgeParty:1,MatchmakerBless:2,RankShow:3};var n=t("GameAlarm"),a=t("BirdBridgePartyModel"),r=t("BirdBridgeRankModel"),o=t("BlessProgressRewardModel"),s=t("BlessTopPlayerModel"),l=t("ActivityBaseController"),c=cc.Class({extends:l,properties:{_curMeets:null,_curFateRankList:null,_myFateRankInfo:null,_curFlowerRankList:null,_myCharmRankInfo:null,_todayJoinTimes:null,_curMyBlessDot:null,_blessRewardList:null,_topThreePlayers:null,_offlineFlowers:null,_isPushedMeet:null,_curNeedPushMeet:null,_pushedMeets:null,_lastBuildTime:null,_curHelpMeetId:null,_isCloudShowing:null},initData:function(t){this._super(t),this._curMeets=[],this._curFateRankList=[],this._curFlowerRankList=[],this._todayJoinTimes=0,this._curMyBlessDot=0,this._blessRewardList=[],this._topThreePlayers=[],this._offlineFlowers=0,this._myFateRankInfo=null,this._myCharmRankInfo=null,this._lastBuildTime=0,this._curNeedPushMeet=null,this._isPushedMeet=!1,this._pushedMeets=[],this._isCloudShowing=!1,this._curHelpMeetId=0,this.setAlarm()},addLocalEventListener:function(){this._super();var t=td.EventNameEnum,e={};e[t.SET_CLOUD_SHOW_STATUS]=this.setCloudShowStatus,e[t.REQUEST_BB_MEETS_INFO]=this.requestBirdBridgeInfo,td.EventUtil.registerEvents(e,this)},setCloudShowStatus:function(t){this._isCloudShowing=t},getCloudShowStatus:function(){return this._isCloudShowing},requestBirdBridgeInfo:function(){if(this.isInOpenStatus()){this.operateActivity({parmeterMap:{57:1,58:0}})}},requestHelpBirdBridge:function(t){this._curHelpMeetId=t;var e={parmeterMap:{57:3,58:t}};this.operateActivity(e)},getLastHelpMeetId:function(){return this._curHelpMeetId},resetLastHelpMeetId:function(){this._curHelpMeetId=null},setAlarm:function(){var t=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_DAY");t*=864e5;var e=this._activityOpen.getCurrentOpenStage(),i=td.TimeUtil.getTime(),a=null;if(e){var r=new Date(e.openTime+t),o=1e3*(60*(60*r.getHours()+r.getMinutes())+r.getSeconds())+r.getMilliseconds(),s=e.openTime+t-o,l=e.showTime;i<s?a=new Date(s):i<l&&(a=new Date(l)),a&&(n.addAlarm(a.getHours(),a.getMinutes(),a.getSeconds()),n.refresh())}},_onAlarm:function(t){if(this._super(t),this.isInOpenStatus()){this.setAlarm();var e=td.TimeUtil.getTime(),i=this.getStageTimeWithType(td.QiXiStageEnum.MagpieBridgeParty);i&&e>=i.endTime-1e3&&td.EventUtil.dispatchEvent(td.EventNameEnum.BB_MEET_ACTIVITY_END)}},onActivityOpen:function(){this._super(),this.requestBirdBridgeInfo()},activityParse:function(t){var e=t.record,i=t.global,n=i.birdBridges||[],a=i.fateRanks||[],r=i.flowerRanks||[],o=i.birdBridgeActors||[],s=e.receiveList||[];void 0!=e.times&&(this._todayJoinTimes=e.times),void 0!=e.blessingDot&&(this._curMyBlessDot=e.blessingDot),void 0!=e.offlineTimes&&(this._offlineFlowers=e.offlineTimes),this.checkLastBuildTime(n),this.pauseMeetsData(n),this.pauseFateRankData(a),this.pauseCharmRankData(r),this.parseBlessProgressData(s),this.parseTopThreePlayersInfo(o)},getLeftTimes:function(){var t=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_REWARD_TIMES")-this._todayJoinTimes;return t<=0?0:t},checkLastBuildTime:function(t){for(var e=td.Account.getUserData().getGamerId(),i=0,n=t.length;i<n;i++){var r=t[i],o=new a;o.initData(r);var s=o.getEndTime();e==o.getBuilder().getGamerId()&&s>this._lastBuildTime&&(this._lastBuildTime=s)}},pauseMeetsData:function(t){if(t&&0!=t.length){for(var e=0,i=t.length;e<i;e++){var n=t[e],r=n.meetId;if(!this._curMeets.some(function(t,e,i){var a=t.getMeetId();if(r==a)return t.refreshData(n),!0})){var o=new a;o.initData(n),this._curMeets.push(o)}}this._isPushedMeet||(this._curNeedPushMeet=this.checkSatisfyPushMeet(),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PUSH_NEW_BB_MEET)),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_BB_MEETS_PANEL),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_BB_MEET_HELP_PANEL)}},getCurMeetsData:function(){return this._curMeets},getMeetDataById:function(t){if(!this._curMeets||0==this._curMeets.length)return null;for(var e=0,i=this._curMeets.length;e<i;e++){var n=this._curMeets[e];if(n.getMeetId()==t)return n}return null},pauseFateRankData:function(t){var e=this;if(t&&0!=t.length){var i=t.splice(t.length-1,1);if(i){var n=new r;n.initData(i[0]),this._myFateRankInfo=n}this._curFateRankList=[],t.forEach(function(t){var i=new r;i.initData(t),e._curFateRankList.push(i)}),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_BB_FATE_RANK_WINDOW)}},getFateRankData:function(){return this._curFateRankList.sort(function(t,e){return t.getRank()-e.getRank()}),this._curFateRankList},getMyFateRankInfo:function(){return this._myFateRankInfo},pauseCharmRankData:function(t){var e=this;if(t&&0!=t.length){var i=t.splice(t.length-1,1);if(i){var n=new r;n.initData(i[0]),this._myCharmRankInfo=n}this._curFlowerRankList=[],t.forEach(function(t){var i=new r;i.initData(t),e._curFlowerRankList.push(i)}),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_BB_CHARM_RANK_WINDOW)}},getFlowerRankDataByRank:function(t){for(var e=0,i=this._curFlowerRankList.length;e<i;e++){var n=this._curFlowerRankList[e];if(t==n.getRank())return n}return null},getMyCharmRankInfo:function(){return this._myCharmRankInfo},initBlessProgressRewards:function(){var t=this;this._blessRewardList=[];var e=this.getActivityData(),i=td.GetTableClass(td.TableEnum.BirdBridgeBlessProgressTable).getDataByDataId(e);i&&0!=i.length&&i.forEach(function(e){var i=new o;i.initData(e),t._blessRewardList.push(i)})},parseBlessProgressData:function(t){var e=this;this._blessRewardList&&0!=this._blessRewardList.length||this.initBlessProgressRewards(),this._blessRewardList.forEach(function(i){var n=i.getNeedBlessDot();-1!=t.indexOf(n)?i.setReceiveStatus(td.ActivityEnum.RewardStatus.RECEIVED):e._curMyBlessDot>=n?i.setReceiveStatus(td.ActivityEnum.RewardStatus.FINISH):i.setReceiveStatus(td.ActivityEnum.RewardStatus.NONE)}),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_BB_MATCHMAKER_PANEL)},parseTopThreePlayersInfo:function(t){if(t&&0!=t.length){for(var e=0,i=t.length;e<i;e++){var n=t[e],a=new s;a.initData(n);var r=a.getPlayerInfo().getGamerId();this._topThreePlayers.some(function(t,e,i){var a=t.getPlayerInfo().getGamerId();if(r==a)return t.initData(n),!0})||this._topThreePlayers.push(a)}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_BB_MATCHMAKER_PANEL)}},getTopThreePlayers:function(){return this._topThreePlayers.sort(function(t,e){var i=t.getCharmScore(),n=e.getCharmScore();if(i===n){if(0==i||0==n){var a=t.getFateScore();return e.getFateScore()-a}return t.getCharmTime()-e.getCharmTime()}return n-i}),this._topThreePlayers},getBlessPlayerDataById:function(t){for(var e=0,i=this._topThreePlayers.length;e<i;e++){var n=this._topThreePlayers[e];if(t==n.getPlayerInfo().getGamerId())return n}},getBlessRewardList:function(){return this._blessRewardList.sort(function(t,e){return t.getNeedBlessDot()-e.getNeedBlessDot()}),this._blessRewardList},getBlessRewardByBlessDot:function(t){for(var e=0,i=this._blessRewardList.length;e<i;e++){var n=this._blessRewardList[e];if(t===n.getNeedBlessDot())return n}return null},getShowBirdBridgeMeet:function(){if(!this._curMeets||0==this._curMeets.length)return[];for(var t=td.TimeUtil.getTime(),e=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_LIMIT"),i=0,n=this._curMeets.length;i<n;i++){var a=this._curMeets[i];if(a){var r=a.getEndTime(),o=a.getJoinersList().length;(t-r>=1e3||o>=e)&&(this._curMeets.splice(i,1),i--)}}var s=td.Account.getUserData().getGamerId();return this._curMeets.sort(function(t,e){var i=t.getBuilder().getGamerId(),n=e.getBuilder().getGamerId();return i!=n?i==s&&n!=s?-1:i!=s&&n==s?1:e.getEndTime()-t.getEndTime():e.getEndTime()-t.getEndTime()}),this._curMeets},getMyBlessDot:function(){return this._curMyBlessDot},checkSatisfyPushMeet:function(){var t=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_TIME"),e=td.TimeUtil.getTime();this._curMeets.sort(function(t,e){return e.getEndTime()-t.getEndTime()});for(var i=td.Account.getUserData().getGamerId(),n=0,a=this._curMeets.length;n<a;n++){var r=this._curMeets[n],o=r.getMeetId(),s=r.getEndTime()-60*t*1e3+1e4,l=r.getBuilder().getGamerId();if(s>e&&l!=i&&-1==this._pushedMeets.indexOf(o))return r}return null},getNeedPushMeetData:function(){if(this._isPushedMeet||!this._curNeedPushMeet)return null;var t=td.TimeUtil.getTime();return this._curNeedPushMeet.getEndTime()-60*td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_TIME")*1e3+1e4<=t&&(this._curNeedPushMeet=null),this._curNeedPushMeet},resetPushStatus:function(){this._isPushedMeet=!0},addPushedMeetId:function(t){t==this._curNeedPushMeet.getMeetId()&&(this._pushedMeets.push(t),this._curNeedPushMeet=null)},getOfflineFlowers:function(){return this._offlineFlowers},resetOfflineFlowers:function(){this._offlineFlowers=0},getStageTimeWithType:function(t){if(!this.isInOpenStatus())return null;var e={},i=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_DAY");i*=864e5;var n=this.getCurrentOpenStage();if(!n)return null;var a=td.TimeUtil.getServerDate(n.openTime+i),r=1e3*(60*(60*a.getHours()+a.getMinutes())+a.getSeconds())+a.getMilliseconds();return t===td.QiXiStageEnum.MagpieBridgeParty?(e.beginTime=n.openTime,e.endTime=n.openTime+i-r):t===td.QiXiStageEnum.MatchmakerBless?(e.beginTime=n.openTime+i-r,e.endTime=n.showTime):t===td.QiXiStageEnum.RankShow&&(e.beginTime=n.showTime,e.endTime=n.closeTime),e},checkOpenStatusByStage:function(t){if(!this.isInOpenStatus())return!1;var e=td.TimeUtil.getTime(),i=this.getStageTimeWithType(t);if(!i)return!1;if(t==td.QiXiStageEnum.MagpieBridgeParty)return e>=i.beginTime&&e<i.endTime;if(t==td.QiXiStageEnum.MatchmakerBless){var n=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_DAY");n*=864e5;var a=this.getCurrentOpenStage(),r=td.TimeUtil.getServerDate(a.openTime+n),o=1e3*(60*(60*r.getHours()+r.getMinutes())+r.getSeconds())+r.getMilliseconds(),s=a.openTime+n-o,l=a.closeTime;return e>=s&&e<l}return!1},onActivityClose:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.BIRD_BRIDGE_ACTIVITY_END)},doBuildBirdBridge:function(){var t=td.GetTableClass(td.TableEnum.Config).getConfig("biuldBirdBridgeInterval"),e=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_TIME"),i=60*t*1e3,n=td.TimeUtil.getTime(),a=this._lastBuildTime-60*e*1e3;if(a&&a>0&&n-a<i){var r=i-n+a;r=r<0?0:r;var o=Math.floor(r/6e4),s=Math.floor((r-6e4*o)/1e3),l=o+td.Language.minutes+s+td.Language.second,c=td.Language.forbidBuildBirdBridgeTip;td.MessageBox.showMessage(cc.js.formatStr(c,l))}else{this.operateActivity({parmeterMap:{57:3,58:0}})}},hasRedPoint:function(){return!0},isBBMeetsEntranceRedPointTip:function(){var t=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_COST"),e=t[2],i=td.RewardManager.getRewardDetail(t).getId();if(td.ItemManager.getItemNumById(i)>=e)return!0;for(var n=td.Account.getUserData().getGamerId(),a=td.TimeUtil.getTime(),r=td.GetTableClass(td.TableEnum.Config).getConfig("BIRD_BRIDGE_MEET_JOIN_LIMIT"),o=0,s=this._curMeets.length;o<s;o++){var l=this._curMeets[o];if(l&&"string"!=typeof l&&l.getJoinersList){var c=l.getJoinersList(),u=l.getEndTime(),d=r<=c.length;if(!(d||u<=a)){for(var h=!1,p=0,_=c.length;p<_;p++){if(c[p].getGamerId()==n){h=!0;break}}if(!h&&!d&&u>a)return!0}}}return!1},bbMeetsEntranceRedPointEvent:function(){return[td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.REFRESH_BB_MEETS_PANEL,td.EventNameEnum.REFRESH_BB_MEET_HELP_PANEL,td.EventNameEnum.SHOW_PANEL]},isMatchmakerBlessRedPointTip:function(){var t=td.TimeUtil.getTime(),e=this.getStageTimeWithType(td.QiXiStageEnum.MatchmakerBless);if(t<e.beginTime||t>e.endTime)return!1;if(!td.GlobalFunction.getLocalSaveStatus("matchmakerBlessLoginTip"))return!0;if(!this._blessRewardList||0==this._blessRewardList.length)return!1;for(var i=0,n=this._blessRewardList.length;i<n;i++){if(this._blessRewardList[i].getReceiveStatus()==td.ActivityEnum.RewardStatus.FINISH)return!0}return!1},matchmakerBlessRedPointEvent:function(){return[td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.REFRESH_BB_MATCHMAKER_PANEL]}});e.exports=c,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",BirdBridgePartyModel:"BirdBridgePartyModel",BirdBridgeRankModel:"BirdBridgeRankModel",BlessProgressRewardModel:"BlessProgressRewardModel",BlessTopPlayerModel:"BlessTopPlayerModel",GameAlarm:void 0}],MailManager:[function(t,e,i){"use strict";cc._RF.push(e,"2156aHrbFNLNLQuPg0j2/Kq","MailManager"),td.MailManager={_mailList:null,_curMail:null,_reqedMail:null,_mailAllstatus:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData(),this._reqedMail=!1,this._mailAllstatus=!1},destroyData:function(){this._mailList=[],this._curMail=null,this._reqedMail=!1},getMailList:function(){return this._sortMail(),this._mailList},getMail:function(t){for(var e=0;e<this._mailList.length;e++){var i=this._mailList[e];if(i.getMailId()==t)return i}return null},getCurMail:function(){return this._curMail},setCurMail:function(t){this._curMail=t},_addListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.MAIL,i=td.MsgCmd.MAIL;t.registerMessage(e,i.GET_MAIL_LIST,this._resGetMailList.bind(this)),t.registerMessage(e,i.MAIL_RECEIVE,this._paraseReciveMail.bind(this)),t.registerMessage(e,i.MAIL_QUICKLY_RECEIVE,this._paraseReciveMail.bind(this)),t.registerMessage(e,i.MAIL_READ,this._paraseReadMail.bind(this)),t.registerMessage(e,i.MAIL_DELETE,this._paraseDeleteMail.bind(this)),t.registerMessage(e,i.MAIL_QUICKLY_READ,this._paraseQuicklyRead.bind(this)),t.registerMessage(e,i.MAIL_QUICKLY_DELETE,this._paraseQuicklyDelete.bind(this)),t.registerMessage(e,i.PUSH_MAIL_LIST,this._paraseMailList.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.Req_GET_MAIL_LIST]=this._getMailList,i[e.Req_MAIL_RECEIVE]=this._reciveMail,i[e.Req_MAIL_QUICKLY_RECEIVE]=this._quickReciveMails,i[e.Req_MAIL_READ]=this._readMail,i[e.Req_MAIL_DELETE]=this._deleteMail,i[e.REQ_MAIL_QUICKLY_READ]=this._quicklyRead,i[e.REQ_MAIL_QUICKLY_DELETE]=this._quicklyDelete,t.registerEvents(i,this)},_getMailList:function(){var t={};t.module=td.MsgModuleName.MAIL,t.cmd=td.MsgCmd.MAIL.GET_MAIL_LIST,td.ServerDelegate.sendMessage(t)},_resGetMailList:function(t,e){t===td.NetCode.SUCCESS&&(this._reqedMail=!0,this._paraseMailList(t,e))},_paraseMailList:function(t,e){if(t===td.NetCode.SUCCESS){for(var i=e.mails,n=0;n<i.length;n++){e=i[n];this._updateMail(e)}this._curMail=null,td.EventUtil.dispatchEvent(td.EventNameEnum.Res_GET_MAIL_LIST)}},_updateMail:function(t){var e=this.getMail(t.mailId);if(e){var i=this._mailList.indexOf(e);t.state==td.MailState.DELETE?this._mailList.splice(i,1):(e.setState(t.state),e.setAttachments(t.attachments),this._mailList[i]=e)}else if(t.state!=td.MailState.DELETE){var n=new td.MailModel;n.init(t),this._mailList.push(n)}},_sortMail:function(){this._mailList.sort(this._sortFunc)},_sortFunc:function(t,e){return t.getSendTime()!=e.getSendTime()?e.getSendTime()-t.getSendTime():t.getMailId()-e.getMailId()},_reciveMail:function(t){var e={};e.module=td.MsgModuleName.MAIL,e.cmd=td.MsgCmd.MAIL.MAIL_RECEIVE,e.mailId=t,td.ServerDelegate.sendMessage(e)},_paraseReciveMail:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.GlobalFunction.showRewards(n,!1),td.EventUtil.dispatchEvent(td.EventNameEnum.Res_MAIL_RECEIVE)}},_quickReciveMails:function(){var t={};t.module=td.MsgModuleName.MAIL,t.cmd=td.MsgCmd.MAIL.MAIL_QUICKLY_RECEIVE,td.ServerDelegate.sendMessage(t)},_readMail:function(t){var e={};e.module=td.MsgModuleName.MAIL,e.cmd=td.MsgCmd.MAIL.MAIL_READ,e.mailId=t,td.ServerDelegate.sendMessage(e)},_deleteMail:function(t){var e={};e.module=td.MsgModuleName.MAIL,e.cmd=td.MsgCmd.MAIL.MAIL_DELETE,e.mailId=t,td.ServerDelegate.sendMessage(e)},_quicklyRead:function(){var t={};t.module=td.MsgModuleName.MAIL,t.cmd=td.MsgCmd.MAIL.MAIL_QUICKLY_READ,td.ServerDelegate.sendMessage(t)},_quicklyDelete:function(){var t={};t.module=td.MsgModuleName.MAIL,t.cmd=td.MsgCmd.MAIL.MAIL_QUICKLY_DELETE,td.ServerDelegate.sendMessage(t)},_paraseDeleteMail:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.Res_MAIL_DELETE)},_paraseQuicklyRead:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_MAIL_QUICKLY_READ)},_paraseQuicklyDelete:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_MAIL_QUICKLY_DELETE)},_paraseReadMail:function(t,e){td.NetCode.SUCCESS},isMailRedPointTips:function(){if(0===this._mailList.length)return!this._reqedMail&&this._mailAllstatus;for(var t=0,e=this._mailList.length;t<e;t++){if(this._mailList[t].hasRedPoint())return!0}return!1},oneKeyGetRedPoint:function(){if(!this._mailList)return!1;for(var t=0,e=this._mailList.length;t<e;t++){var i=this._mailList[t];if(i.hasAttachments()&&(i.getState()==td.MailState.UNREAD||i.getState()==td.MailState.READ))return!0}return!1},redPointEvebts:function(){return[td.EventNameEnum.Res_GET_MAIL_LIST,td.EventNameEnum.Res_MAIL_RECEIVE]},hasReqedMailData:function(){return this._reqedMail},hasAttachment2Recive:function(){if(!this._mailList)return!1;for(var t=0,e=this._mailList.length;t<e;t++){var i=this._mailList[t];if(i.hasAttachments()&&(i.getState()==td.MailState.UNREAD||i.getState()==td.MailState.READ))return!0}return!1},hasAttachment2Read:function(){if(!this._mailList)return!1;for(var t=0,e=this._mailList.length;t<e;t++){if(this._mailList[t].getState()==td.MailState.UNREAD)return!0}return!1},hasAttachment2Del:function(){if(!this._mailList)return!1;for(var t=0,e=this._mailList.length;t<e;t++){if(this._mailList[t].getState()==td.MailState.UNREAD)return!1}return!0}},td.MailState={UNREAD:1,READ:2,RECEIVED:3,DELETE:4},td.MailShowType={NONE:0,DOUBLE:1},cc._RF.pop()},{}],MailModel:[function(t,e,i){"use strict";cc._RF.push(e,"942e6CpuONH36uyOYcu8gze","MailModel");var n=t("Model");td.MailModel=cc.Class({extends:n,properties:{_mailId:null,_title:null,_content:null,_attachments:null,_sendTime:null,_state:null,_from:null,_showType:!1,clsName:{override:!0,default:"MailModel"}},init:function(t){t&&(this._mailId=t.mailId||0,this._title=t.title||"",this._content=t.content||"",this._from=t.from||"",this._sendTime=t.sendTime||0,this._state=parseInt(t.state)||0,this._showType=t.show||0,this._attachments=t.attachments||[],this._title=td.GlobalFunction.translateBrace(this._title),this._content=td.GlobalFunction.translateBrace(this._content))},getMailId:function(){return this._mailId},getTitle:function(){return this._title},getContent:function(){return this._content},getFrom:function(){return this._from},getSendTime:function(){return this._sendTime},getShowType:function(){return this._showType},getState:function(){return this._state},setState:function(t){this._state=t},getAttachments:function(){return this._attachments},setAttachments:function(t){this._attachments=t},hasAttachments:function(){return this._attachments.length>0},hasRedPoint:function(){return!!(this.getState()==td.MailState.UNREAD||this.hasAttachments()&&this.getState()==td.MailState.READ)}}),cc._RF.pop()},{Model:"Model"}],MainPopupTable:[function(t,e,i){"use strict";cc._RF.push(e,"5c301rmAn1E5J/6OVhmbRR7","MainPopupTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MainPopupConfig",e._tblName="main_popup_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.panelId]=a}},e.prototype.getDatas=function(){var t=[];for(var e in this._data)t.push(this._data[e]);return t.sort(this.sortFunc)},e.prototype.sortFunc=function(t,e){return t.orderId-e.orderId},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MainStoryTable:[function(t,e,i){"use strict";cc._RF.push(e,"c533fq/6M5DI6KhcA9hyy/Y","MainStoryTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"MainStory",properties:{_tblName:"main_story",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]||(t[a.id]=[]);var r=t[a.id].length;t[a.id][r]=a}},getDataById:function(t){var e=[];if(!this._data[t])return e;for(var i=0;i<this._data[t].length;i++)e.push(this._data[t][i]);return e.sort(this.sortFunc),e},sortFunc:function(t,e){return t.step-e.step}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ManualManager:[function(t,e,i){"use strict";cc._RF.push(e,"fa959lVOwhF04lgv01WtG5r","ManualManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function e(){this._isInit=!1,this._ischeck=!1,this._ischeckPet=!1,this._bShowTipLater=!1,this._tipList=[],this._petTipList=[],this._bShowPetTipLater=!1}return e.getInstance=function(){return null==this._instance&&(this._instance=new e,this._instance._manualList={},this._instance._receiveList=[],this._instance._spiritList=[],this._instance._petList=[]),this._instance},e.prototype.init=function(){this._addListener(),this._addEventListener()},e.prototype.destroyData=function(){this._manualList={},this._receiveList=[],this._spiritList=[],this._petList=[],this._isInit=!1,this._ischeck=!1,this._ischeckPet=!1,this._bShowTipLater=!1,this._bShowPetTipLater=!1},e.prototype._addListener=function(){var t=td.MsgModuleName.MANUAL,e=td.MsgCmd.MANUAL;td.ServerDelegate.registerMessage(t,e.GET_MANUAL_INFO,this._parseManualList.bind(this)),td.ServerDelegate.registerMessage(t,e.PUSH_MANUAL_INFO,this._parseManualList.bind(this)),td.ServerDelegate.registerMessage(t,e.RECEIVE_MANUAL_REWARD,this._parseReward.bind(this))},e.prototype._addEventListener=function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQUEST_MANUAL_INFO]=this._requestManualInfo,i[e.REQ_RECEIVE_MANUAL_REWARD]=this._requestManualReward,i[e.SHOW_SPRITE_ACTIVE_TIP]=this._onShowActiveTips,i[e.SHOW_POWER_CHANGE_LATER]=this._setShowTipsLater,i[e.SHOW_PET_ACTIVE_TIP]=this._onShowPetActiveTips,t.registerEvents(i,this)},e.prototype._requestManualInfo=function(){var t={};t.module=td.MsgModuleName.MANUAL,t.cmd=td.MsgCmd.MANUAL.GET_MANUAL_INFO,td.ServerDelegate.sendMessage(t)},e.prototype._requestManualReward=function(t){var e={};e.module=td.MsgModuleName.MANUAL,e.cmd=td.MsgCmd.MANUAL.RECEIVE_MANUAL_REWARD,e.configId=t,td.ServerDelegate.sendMessage(e)},e.prototype._parseManualList=function(t,e){var i=this;t===td.NetCode.SUCCESS&&(this._isInit||this.initManual(),td.PartnershipManager.setOldPartnershipActivity(),e&&e.manualList&&e.manualList.forEach(function(t){i._manualList[t].setIsManualActivate()}),this.checkNewSpirit(e.spiritList||[]),this.checkNewPet(e.petList||[]),this._receiveList=e.receiveList||[],this._spiritList=e.spiritList||[],this._petList=e.petList||[],td.EventUtil.dispatchEvent(td.EventNameEnum.MANUAL_INFO_CHANGED))},e.prototype.checkNewSpirit=function(t){var e=this;this._ischeck?t.forEach(function(i){if(-1===e._spiritList.indexOf(i)){for(var n=td.GetTableClass(td.TableEnum.SpiritManualTable).getDataBySpiritId(i),a=!0,r=0;r<n.spirits.length;r++)if(-1===t.indexOf(n.spirits[r])){a=!1;break}if(a)if(e._bShowTipLater)e._tipList.push(n.name);else{var o=new td.BroadcastContent(441),s=new td.BroadcastParam(n.name);o.setMainParam([s]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,o)}}}):this._ischeck=!0},e.prototype.checkNewPet=function(t){var e=this;this._ischeckPet?t.forEach(function(i){if(-1===e._petList.indexOf(i)){for(var n=td.GetTableClass(td.TableEnum.PetManualTable).getDataByPetId(i),a=!0,r=0;r<n.pets.length;r++)if(-1===t.indexOf(n.pets[r])){a=!1;break}if(a)if(e._bShowPetTipLater)e._petTipList.push(n.name);else{var o=new td.BroadcastContent(453),s=new td.BroadcastParam(n.name);o.setMainParam([s]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,o)}}}):this._ischeckPet=!0},e.prototype._parseReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult);td.GlobalFunction.showRewards(i),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_RECEIVE_MANUAL_REWARD)}},e.prototype.initManual=function(){var e=td.GetTableClass(td.TableEnum.HeroTable).getHeroData();for(var i in e){var n=new(t("HeroModel"));n.init(e[i]),n.getIsShow()&&(this._manualList[i]=n)}this._isInit=!0},e.prototype.getManualListByQuality=function(t){var e=[],i=td.GetConfig("PVE_GUIDE_HERO_IDS");for(var n in this._manualList)-1==i.indexOf(parseInt(n))&&this._manualList[n].getQuality()==t&&e.push(this._manualList[n]);return e.sort(this.sortFunc)},e.prototype.sortFunc=function(t,e){return t.getAptitude()!==e.getAptitude()?e.getAptitude()-t.getAptitude():e.getSortId()-t.getSortId()},e.prototype.getMax=function(){return this._manualList.myLen()},e.prototype.getActiveCount=function(){var t=0;for(var e in this._manualList)this._manualList[e].getIsManualActivate()&&t++;return t},e.prototype.getReceiveList=function(){return this._receiveList},e.prototype.getSpiritList=function(){return this._spiritList},e.prototype.getPetList=function(){return this._petList},e.prototype.showRedPoint=function(){var t=this.getActiveCount(),e=td.GetTableClass(td.TableEnum.ManualTable).getDatas();this._receiveList;for(var i=0;i<e.length&&!(t<e[i].count);i++)if(-1==this._receiveList.indexOf(e[i].count))return!0;return!1},e.prototype.redPointEvebts=function(){return[td.EventNameEnum.MANUAL_INFO_CHANGED,td.EventNameEnum.RES_RECEIVE_MANUAL_REWARD]},e.prototype.getTotalAttr=function(){var t={},e=td.GetTableClass(td.TableEnum.SpiritManualTable).getAllData();for(var i in e){for(var n=e[i].spirits,a=!0,r=0;r<n.length;r++)-1===this._spiritList.indexOf(n[r])&&(a=!1);if(a){var o=e[i].attributes;for(r=0;r<o.length;r++)t[o[r][0]]||(t[o[r][0]]=0),t[o[r][0]]+=o[r][1]}}return t},e.prototype.getTotalAttrTT=function(){var t={},e=td.GetTableClass(td.TableEnum.SpiritManualTable).getAllData();for(var i in e){for(var n=e[i].spirits,a=!0,r=0;r<n.length;r++)-1===this._spiritList.indexOf(n[r])&&(a=!1);if(a){var o=e[i].attributeTTPercent;for(r=0;r<o.length;r++)t[o[r][0]]||(t[o[r][0]]=0),t[o[r][0]]+=o[r][1]}}return t},e.prototype.setShowTipsLater=function(t){this._bShowTipLater=t},e.prototype.isShowTipsLater=function(){return this._bShowTipLater},e.prototype._onShowActiveTips=function(){if(this._tipList&&this._tipList.length>0){for(var t=0;t<this._tipList.length;t++){var e=this._tipList[t],i=new td.BroadcastContent(441),n=new td.BroadcastParam(e);i.setMainParam([n]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}this._tipList=[]}this.setShowTipsLater(!1)},e.prototype._setShowTipsLater=function(t){this.setShowTipsLater(t),this.setShowPetTipsLater(t)},e.prototype.getPetTotalAttr=function(){var t={},e=td.GetTableClass(td.TableEnum.PetManualTable).getAllData();for(var i in e){for(var n=e[i].pets,a=!0,r=0;r<n.length;r++)-1===this._petList.indexOf(n[r])&&(a=!1);if(a){var o=e[i].attributes;for(r=0;r<o.length;r++)t[o[r][0]]||(t[o[r][0]]=0),t[o[r][0]]+=o[r][1]}}return t},e.prototype.getPetTotalAttrTT=function(){var t={},e=td.GetTableClass(td.TableEnum.PetManualTable).getAllData();for(var i in e){for(var n=e[i].pets,a=!0,r=0;r<n.length;r++)-1===this._petList.indexOf(n[r])&&(a=!1);if(a){var o=e[i].attributeTTPercent;for(r=0;r<o.length;r++)t[o[r][0]]||(t[o[r][0]]=0),t[o[r][0]]+=o[r][1]}}return t},e.prototype.setShowPetTipsLater=function(t){this._bShowPetTipLater=t},e.prototype.isShowPetTipsLater=function(){return this._bShowPetTipLater},e.prototype._onShowPetActiveTips=function(){if(this._petTipList&&this._petTipList.length>0){for(var t=0;t<this._petTipList.length;t++){var e=this._petTipList[t],i=new td.BroadcastContent(453),n=new td.BroadcastParam(e);i.setMainParam([n]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}this._petTipList=[]}this.setShowPetTipsLater(!1)},e.prototype._setShowPetTipsLater=function(t){this.setShowPetTipsLater(t)},e.prototype.getActiveList=function(){var t=[];for(var e in this._manualList)this._manualList[e].getIsManualActivate()&&t.push(this._manualList[e]);return t},e.prototype.getActiveRoleTypeList=function(){var t=[];for(var e in this._manualList)this._manualList[e].getIsManualActivate()&&t.push(this._manualList[e].getRoleType());return t},e}();i.default=n,cc._RF.pop()},{HeroModel:"HeroModel"}],ManualTable:[function(t,e,i){"use strict";cc._RF.push(e,"42138X5FrZCELaJ2Ick+AOe","ManualTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ManualRewardConfig",e._tblName="manual_reward_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.count]=a}},e.prototype.getDataByCount=function(t){return this._data[t]?this._data[t]:null},e.prototype.getDatas=function(){var t=[];for(var e in this._data)t.push(this._data[e]);return t.sort(this.sortFunc)},e.prototype.sortFunc=function(t,e){return t.count-e.count},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MaterailCopyEntryTable:[function(t,e,i){"use strict";cc._RF.push(e,"12a8aJCJjhHLYQaogRvYCmc","MaterailCopyEntryTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"DungeonEentryTable",properties:{_tblName:"dungeon_entry_table",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]||(t[a.id]={}),t[a.id]=a}},getCopyEntryList:function(){return this._data},getDataByType:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MaterailCopyManager:[function(t,e,i){"use strict";cc._RF.push(e,"a911e5xNWdOop/upPcbUGZw","MaterailCopyManager");var n=t("CommonEnum");td.MaterailCopyManager={_copyDataList:null,_prepareCopy:null,_type:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._copyDataList={}},_addListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.DUNGEON,i=td.MsgCmd.DUNGEON;t.registerMessage(e,i.DUNGEON_GET_INFO,this._parseCopyInfo.bind(this)),t.registerMessage(e,i.DUNGEON_PREPARE,this._parsePrepare.bind(this)),t.registerMessage(e,i.DUNGEON_CHALLENGE,this._onChanllengeReturn.bind(this)),t.registerMessage(e,i.DUNGEON_SWEEP,this._onCopySweep.bind(this)),t.registerMessage(e,i.DUNGEON_RESET_TIMES,this._onBuyTimes.bind(this)),t.registerMessage(e,i.PUSH_DUNGEON_INFO,this._parseCopyInfo.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQ_COPY_PREPARE]=this._requestPrepare,i[e.REQUEST_COPY_DATA]=this._requestGetCopyInfo,i[e.REQUEST_COPY_CHALLENGE]=this._requestCopyChallenge,i[e.REQ_DUNGEON_SWEEP]=this._reqestSweep,i[e.REQ_BUY_TIEMS]=this._reqBuyTimes,t.registerEvents(i,this)},isRedPointTips:function(){if(!this._copyDataList)return!1;for(var t=!1,e=this.getCopyEntrySortList(),i=0;i<e.length;i++){var n=e[i].getId();if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Copy,n)){var a=this._copyDataList[n];if(a&&a.getChallengeTimes()>0){t=!0;break}}}return t},isCopyTypeRedPoint:function(t){if(!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Copy,t))return!1;var e=this.getCopyInfoByType(t);return!(!e||0===e.getChallengeTimes())},redPointEvents:function(){var t=td.EventNameEnum;return[t.USER_ATTR_LEVEL_CHANGE,t.COPY_DATA_CHANGED]},getCopyEntrySortList:function(){var t=[],e=td.GetTableClass(td.TableEnum.MaterailCopyEntryTable).getCopyEntryList();for(var i in e){var n=new td.CopyEntryModel;n.init(e[i]),t.push(n)}return t.sort(function(t,e){return t.getSortRank()-e.getSortRank()}),t},getPrepareCopy:function(){return this._prepareCopy},setPrepareCopy:function(t){this._prepareCopy=t},getTotalChanllengeTimes:function(){for(var t=0,e=this.getCopyEntrySortList(),i=0;i<e.length;i++){var n=e[i].getId();if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Copy,n)){var a=this._copyDataList[n];a&&a.getChallengeTimes()>0&&(t+=a.getChallengeTimes())}}return t},getNextBuyVipLevel:function(t){var e=td.GetTableClass(td.TableEnum.VipPrivilegeTable).getPrerogativeByTypeAndOpenValue(n.PrerogativeEnum.DUNGEON_CHALLENGE_TIMES);if(!e)return null;var i=td.Account.getUserData();if(!i)return null;var a=i.vip,r=0;for(var o in e){var s=e[o=parseInt(o)];if(o<=a){if(!(u=s.value)||0===u.length)continue;for(var l=0,c=u.length;l<c;l++){if((d=u[l])[0]===t){d[1]>0&&(r=d[1]);break}}}else if(o>a){var u;if(!(u=s.value)||0===u.length)continue;for(l=0,c=u.length;l<c;l++){var d;if((d=u[l])[0]===t&&d[1]>r)return s}}}return null},getCopyInfoByType:function(t){return this._copyDataList[t]?this._copyDataList[t]:null},getCopyData:function(t,e){return this._copyDataList[t]?this._copyDataList[t].getDataById(e):null},_requestPrepare:function(t){var e={};e.module=td.MsgModuleName.DUNGEON,e.cmd=td.MsgCmd.DUNGEON.DUNGEON_PREPARE,e.type=t.type,e.id=t.id,td.ServerDelegate.sendMessage(e)},_requestGetCopyInfo:function(){var t={};t.module=td.MsgModuleName.DUNGEON,t.cmd=td.MsgCmd.DUNGEON.DUNGEON_GET_INFO,td.ServerDelegate.sendMessage(t)},_parsePrepare:function(t){t==td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_COPY_PREPARE)},_parseCopyInfo:function(t,e){var i=this;t==td.NetCode.SUCCESS&&(e.dungeonVOList.forEach(function(t){var e=parseInt(t.type),n=t;if(!i._copyDataList[e]){var a=new td.CopyTypeModel;a.init(e),i._copyDataList[e]=a}i._copyDataList[e].setChallengeTimes(n.challengeTimes),i._copyDataList[e].setResetTimes(n.buyTimes),i._copyDataList[e].updataDataList(n.dungeonList)}),td.EventUtil.dispatchEvent(td.EventNameEnum.COPY_DATA_CHANGED))},_requestCopyChallenge:function(t){if(td.GlobalFunction.checkCanClicked()){var e={};e.module=td.MsgModuleName.DUNGEON,e.cmd=td.MsgCmd.DUNGEON.DUNGEON_CHALLENGE,e.type=t.type,e.id=t.id,e.star=t.stars,td.ServerDelegate.sendMessage(e)}},_onChanllengeReturn:function(t,e){if(t==td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.RECEIVE_PVE_FIHGT_REAWRD,n)}else td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PRE_PANEL)},_reqestSweep:function(t){var e={};e.module=td.MsgModuleName.DUNGEON,e.cmd=td.MsgCmd.DUNGEON.DUNGEON_SWEEP,e.type=t.type,e.id=t.id,td.ServerDelegate.sendMessage(e)},_onCopySweep:function(t,e){if(t==td.NetCode.SUCCESS){for(var i=[],n=e.rewardList,a=0,r=n.length-1;a<=r;a++){e={};for(var o=td.RewardManager.parseRewardResult(n[a]),s=[],l=0;l<o.length;l++){var c=o[l],u=td.GlobalFunction.getGoodsData(c.type,c.id,c.count);s.push(u)}e.rewards=s,i[i.length]=e}td.EventUtil.dispatchEvent(td.EventNameEnum.RES_DUNGEON_SWEEP,i)}},_reqBuyTimes:function(t){var e={};e.module=td.MsgModuleName.DUNGEON,e.cmd=td.MsgCmd.DUNGEON.DUNGEON_RESET_TIMES,e.type=t.type,e.times=t.times,td.ServerDelegate.sendMessage(e)},_onBuyTimes:function(t,e){t==td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_BUY_TIEMS)},getType:function(){return this._type},calNeedPayWithTiems:function(t,e){for(var i,n=td.GlobalFunction,a=this.getCopyInfoByType(t).getBuyTimes(),r=1+a;r<=e+a;r++)i?i.setCount(i.getCount()+n.getShareConfigUpCostCount("DUNGEON_BUY_TIMES_COST",r)):i=n.getShareConfigUpCostDetail("DUNGEON_BUY_TIMES_COST",r);return i}},cc._RF.pop()},{CommonEnum:void 0}],"MaterialCopyConfig copy":[function(t,e,i){"use strict";cc._RF.push(e,"e41acxWU0VDxL+qIbbI1XVe","MaterialCopyConfig copy");var n=t("BaseTable"),a=cc.Class({extends:n,properties:{_tblName:"dungeon_type_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.type]=a}},getCopyConfigByType:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MaterialCopyConfig:[function(t,e,i){"use strict";cc._RF.push(e,"dd1f2karCNFRqWP+w+VVgSu","MaterialCopyConfig");var n=t("BaseTable"),a=cc.Class({extends:n,properties:{_tblName:"dungeon_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.type]||(t[a.type]={}),t[a.type][a.id]=a}},getCopyConfigByType:function(t){return this._data[t]},getCopyConfigByTypeAndId:function(t,e){if(this._data[t])for(var i in this._data[t])if(parseInt(i)==e)return this._data[t][i];return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MaterialCopyTypeConfig:[function(t,e,i){"use strict";cc._RF.push(e,"a7cf5bW0a1Jt6qAWzRI8B6C","MaterialCopyTypeConfig");var n=t("BaseTable"),a=cc.Class({extends:n,properties:{_tblName:"dungeon_type_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.type]||(t[a.type]={}),t[a.type]=a}},getInspireData:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MazeEffectConfig:[function(t,e,i){"use strict";cc._RF.push(e,"22be9bd6q1A86me8sP9Lzhq","MazeEffectConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MazeEffectConfig",e._tblName="maze_effect_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t.push(a)}},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MazeEnum:[function(t,e,i){"use strict";cc._RF.push(e,"33229kbxQJHS4p9DxCs2MOv","MazeEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.MAZE_LINE_TYPE=i.MAZE_ITEM_TYPE=i.MAZE_EVENT_TYPE=i.MAZE_WINDOW_TYPE=i.MAZE_TYPE=void 0,function(t){t[t.PVE=1]="PVE",t[t.PVP=2]="PVP"}(i.MAZE_TYPE||(i.MAZE_TYPE={})),function(t){t[t.HERO_INIT=1]="HERO_INIT",t[t.HERO_BAG=2]="HERO_BAG",t[t.CHALLENGE_DETAIL=3]="CHALLENGE_DETAIL",t[t.ITEM_USE=4]="ITEM_USE",t[t.HERO_CHOOSE=5]="HERO_CHOOSE",t[t.SET_UP=6]="SET_UP"}(i.MAZE_WINDOW_TYPE||(i.MAZE_WINDOW_TYPE={})),function(t){t[t.START=0]="START",t[t.ITEM=1]="ITEM",t[t.HERO=2]="HERO",t[t.SKILL=3]="SKILL"}(i.MAZE_EVENT_TYPE||(i.MAZE_EVENT_TYPE={})),function(t){t[t.RELIVE=1]="RELIVE",t[t.RECOVER=2]="RECOVER"}(i.MAZE_ITEM_TYPE||(i.MAZE_ITEM_TYPE={})),function(t){t[t.PVE=0]="PVE",t[t.ATTEND=1]="ATTEND",t[t.DEFENSE=2]="DEFENSE"}(i.MAZE_LINE_TYPE||(i.MAZE_LINE_TYPE={})),cc._RF.pop()},{}],MazeHeroConfig:[function(t,e,i){"use strict";cc._RF.push(e,"df90ax312VO3q70kXq+9YPI","MazeHeroConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MazeHeroConfig",e._tblName="maze_hero_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.heroId;t[r]||(t[r]={}),t[r]=a}},e.prototype.getHeroCfgByHeroId=function(t){return this._data[t]},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MazeHeroModel:[function(t,e,i){"use strict";cc._RF.push(e,"68ac7cRo2FDLKGFpJC0WcyM","MazeHeroModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._tableData=null,this._heroSid=0,this._heroId=0,this._positionId=0,this._hp=0,this._hpMax=0,this._rage=0,this._rageMax=4,this._isEquip=!1,this._isDied=!1,this._heroTable=null}return t.prototype.initData=function(t){this._tableData=t,this._heroTable=td.GetTableClass(td.TableEnum.HeroTable).getHeroById(t.heroId)},t.prototype.refreshData=function(t){t&&(this._heroSid=t.heroUId,this._heroId=t.heroId,this._positionId=t.positionId,this._hp=t.hp,this._rage=t.rage,this._hpMax=t.maxHp||1,this._isDied=this._hp<=0)},t.prototype.getHeroSId=function(){return this._heroSid},t.prototype.getHeroId=function(){return this._heroId},t.prototype.getPositionId=function(){return this._positionId},t.prototype.getHp=function(){return this._hp},t.prototype.getHpMax=function(){return this._hpMax},t.prototype.getRage=function(){return this._rage},t.prototype.getRageMax=function(){return this._rageMax},t.prototype.getHeroType=function(){return this._tableData.roleType},t.prototype.getQuality=function(){return this._heroTable?this._heroTable.quality:4},t.prototype.getName=function(){return this._heroTable?this._heroTable.name:""},t.prototype.setEquip=function(t){this._isEquip=t},t.prototype.isEquip=function(){return this._isEquip},t.prototype.isDied=function(){return this._isDied},t}();i.default=n,cc._RF.pop()},{}],MazeHeroPoolConfig:[function(t,e,i){"use strict";cc._RF.push(e,"93459mZEmRKG4ljVowTeBxY","MazeHeroPoolConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MazeHeroPoolConfig",e._tblName="maze_hero_pool_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.poolId;t[r]||(t[r]={}),t[r]=a}},e.prototype.getHerosByPoolId=function(t){return(this._data[t]||{}).heroWeight},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MazeHurtNodeUI:[function(t,e,i){"use strict";cc._RF.push(e,"285beU5JfpPWaFkbosTGF+Z","MazeHurtNodeUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=(t("OptimizeVerticalListView"),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeContent=null,e._fightResult=null,e}var i;return n(e,t),i=e,e.showNode=function(t,e){if(null!=t)if(gdk.rm.getResByUrl("prefab/Pvp/NodeMazeHurt",cc.Prefab))i.createUI(t,e);else{gdk.rm.loadRes(null,"prefab/Pvp/NodeMazeHurt",cc.Prefab,i.createUI.bind(this,t,e))}},e.createUI=function(t,e){var n=null,a=!1;i._staticNode?(n=i._staticNode,a=!0):(n=gdk.rm.getResByUrl("prefab/Pvp/NodeMazeHurt",cc.Prefab),n=cc.instantiate(n));var r=n.getComponent(i);return r||n.addComponent(i),r.setData(e),a||t.addChild(n,100),i._staticNode=n,r},e.prototype.onDestroy=function(){i._staticNode=null},e.prototype._setTotalHurt=function(){var t=this.node.getChildByName("heroTotalDamage"),e=this.node.getChildByName("enermyTotalDamage"),i=this._fightResult.getDamages(),n=i[1].TotalDamages,a=i[2].TotalDamages;t.getComponent(cc.Label).string=n,e.getComponent(cc.Label).string=a},e.prototype.setData=function(t){this._fightResult=t,this._setTotalHurt(),this.setListView()},e.prototype.setListView=function(){var t=this._fightResult.getDamages();for(var e in t){var i=t[e],n="";n=1==Number(e)?"hero":"enermy";var a=[];for(var o in i)"TotalDamages"!=o&&(i[o].damage||(i[o].damage=0),a.push(i[o]));a.sort(this.sortFunc);for(var s=1,l=0;l<a.length;l++){var c=a[l].damagePer,u=a[l].damage||0;if(void 0!==c){var d=a[l].sid;(v=this.nodeContent.getChildByName(n+s)).getChildByName("progressBar").getComponent(cc.ProgressBar).progress=c/100,v.getChildByName("AtkPercent").getComponent(cc.Label).string=c+"%";var h=r.PvpFightController.getInstance().getRoleDataBySId(d);if(h){var p=h.getBaseModel().getIconRes(),_=v.getChildByName("icon");_.setScale(.7),r.GlobalFunction.createSpriteNode(_,r.resDef.pngPlist.icon_touxiang,cc.SpriteAtlas,p);var g=v.getChildByName("imgQuality"),f=r.QualityBgImg[h.getBaseModel().getQuality()];g.setScale(.7),r.GlobalFunction.createSpriteNode(g,r.resDef.pngPlist.GY_Common,cc.SpriteAtlas,f),v.getChildByName("damage").getComponent(cc.Label).string=r.GlobalFunction.getSimpledNumStr(u),s++}}}for(;s<=r.MaxEnum.MaxBattleHeroCount;s++){var v;(v=this.nodeContent.getChildByName(n+s)).active=!1}}},e.prototype.sortFunc=function(t,e){return e.damage-t.damage},e._staticNode=null,a([l(cc.Node)],e.prototype,"nodeContent",void 0),e=i=a([s,c("module/Maze/MazeHurtNodeUI")],e)}(cc.Component));i.default=u,cc._RF.pop()},{OptimizeVerticalListView:void 0}],MazeManager:[function(t,e,i){"use strict";cc._RF.push(e,"7412awPvKlLVoAPiGFoLPa0","MazeManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Model/MazeHeroModel"),a=t("../Model/MazeStoryModel"),r=t("../Enum/MazeEnum"),o=t("../Model/MazePlayerModel"),s=t("../Model/MazeReportModel"),l=function(){function t(){this._passDay=0,this._currDay=-1,this._story=0,this._pass=!1,this._receive=!1,this._roadRecord={},this._monsterLineup={},this._lineup={},this._heroMap={},this._heroBag={},this._skillBag=[],this._optional=[],this._reviewOptional={},this._reviewMonsterLineup={},this._mazeTangledInfos=[],this._scanEffect=[],this._scanPosition=[],this._playerMap={},this._playerModelList=[],this._allStoryMap=null,this._curStoryMap=null,this._recoverItemCost=null,this._reliveItemCost=null,this._recoverCost=null,this._reliveCost=null,this._curPreViewStory=null,this._flagStory=null,this._isCurDayPass=!1,this._maxPosNum=0,this._myPlayerModel=null,this._pvpLastData={},this._isReplayFight=!1,this._fallStoryIds=[],this._canShowFallAni=!1,this._isGoFight=!1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.destroyData(),this.addListener(),this.addEventListener(),this.initData()},t.prototype.initData=function(){td.MAZE_M=this},t.prototype.destroyData=function(){this._currDay=-1,this._passDay=0,this._story=0,this._pass=!1,this._receive=!1,this._monsterLineup={},this._lineup={},this._heroMap={},this._heroBag={},this._skillBag=[],this._optional=[],this._reviewOptional={},this._reviewMonsterLineup={},this._mazeTangledInfos=[],this._playerMap={},this._playerModelList=[],this._flagStory=null,this._allStoryMap=null,this._curStoryMap=null,this._recoverItemCost=null,this._reliveItemCost=null,this._curPreViewStory=null,this._maxPosNum=0,this._isCurDayPass=!1,this._isReplayFight=!1,this._fallStoryIds=[],this._canShowFallAni=!1,this._isGoFight=!1},t.prototype.addListener=function(){var t=td.ServerDelegate,e=td.MsgModuleName.MAZE,i=td.MsgCmd.MAZE;t.registerMessage(e,i.GET_MAZE_INFO,this._onGetMazeInfo.bind(this)),t.registerMessage(e,i.GET_MAZE_HERO,this._onGetInitHeroInfo.bind(this)),t.registerMessage(e,i.PREPARE_MAZE_NEXT,this._onGetMazePrepare.bind(this)),t.registerMessage(e,i.CHALLENGE_MAZE,this._onGetMazeChallenge.bind(this)),t.registerMessage(e,i.CHOOSE_MAZE_REWARD,this._onGetChooseReward.bind(this)),t.registerMessage(e,i.CHANGE_MAZE_LINEUP,this._onGetMazeLineup.bind(this)),t.registerMessage(e,i.OPERATION_HERO,this._onGetMazeItemUse.bind(this)),t.registerMessage(e,i.REVIEW_STORY,this._onGetReviewNext.bind(this)),t.registerMessage(e,i.GET_MAZE_BATTLE_INFO,this._onGetBattleInfo.bind(this)),t.registerMessage(e,i.GET_MAZE_BATTLE_REPORTS,this._onGetReportsInfo.bind(this)),t.registerMessage(e,i.DISCARD_EFFECT,this._onGetSkillDiscard.bind(this)),t.registerMessage(e,i.PUSH_MAZE_INFO,this._onGetMazeInfoPush.bind(this)),t.registerMessage(e,i.PUSH_MAZE_BATTLE_INFO,this._onGetBattleInfoPush.bind(this)),t.registerMessage(e,i.PUSH_MAZE_TANGLED_BATTLE_REPORT,this._onGetReportsInfoPush.bind(this))},t.prototype.addEventListener=function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQ_MAZE_INFO]=this._reqGetMazeInfo,i[e.REQ_MAZE_INIT_HERO]=this._reqInitHeroInfo,i[e.REQ_MAZE_PREPARE]=this._reqMazePrepare,i[e.REQ_MAZE_CHALLENGE]=this._reqMazeChallenge,i[e.REQ_CHOOSE_REWARD]=this._reqChooseReward,i[e.REQ_MAZE_LINEUP]=this._reqLineup,i[e.REQ_MAZE_ITEM_USE]=this._reqItemUse,i[e.REQ_MAZE_REVIEW_NEXT]=this._reqReviewNext,i[e.REQ_MAZE_DISCARD]=this._reqSkillDiscard,i[e.REQ_MAZE_BATTLE_INFO]=this._reqBattleInfo,i[e.REQ_MAZE_REPORTS]=this._reqGetReports,i[e.ON_GET_SERVER_START_DAYS]=this._reqInfo,i[e.USER_ATTR_LEVEL_CHANGE]=this._reqInfo,t.registerEvents(i,this)},t.prototype._initStoryCfg=function(){var t=td.GetTableClass(td.TableEnum.MazeStoryConfig);if(t){var e=t.getAllDatas();for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];this._allStoryMap[i]||(this._allStoryMap[i]=[]);for(var r=0;r<n.length;r++){var o=n[r],s=new a.default;s.initData(o),this._allStoryMap[i].push(s)}}}},t.prototype.getCurStoryDay=function(){var t=this._currDay;return this._currDay!=this._passDay&&this._currDay>=this._passDay&&(t=this._passDay+1),t},t.prototype._refreshCurStoryList=function(t){var e=this.getCurStoryDay(),i=td.GetTableClass(td.TableEnum.MazeStoryConfig);if(i){var n=i.getCfgByStoryId(this._story);if(t||!this._curStoryMap||Object.keys(this._curStoryMap).length<=0){var r=i.getAllDatas();this._curStoryMap={};var o=r[e];if(!o)return;for(var s=0;s<o.length;s++){var l=o[s],c=this._curStoryMap[s];c||(this._curStoryMap[s]={},c=new a.default),this._curStoryMap[s]=c,c.initData(l)}}for(var u in this._fallStoryIds=[],this._curStoryMap){if(this._curStoryMap.hasOwnProperty(u))(p=this._curStoryMap[u]).setShowFlag(!1),p.setIsPassed(this._story>p.getStoryId()),this._story==p.getStoryId()&&p.setIsPassed(this._pass),n.floor==p.getFloor()&&this._story!=p.getStoryId()&&(p.setIsPassed(!0),this._fallStoryIds.push(p.getStoryId()))}var d=this._roadRecord[e]||[],h=this.getCurDayStoryByStoryId(0);for(s=0;s<d.length;s++){var p;u=d[s];(p=this.getCurDayStoryByStoryId(u))&&p.isPassed()&&(h=p)}this._fallStoryIds.sort(function(t,e){return t-e}),h&&h.setShowFlag(!0),this._flagStory=h}},t.prototype._refreshHeroBag=function(){if(this._heroMap){for(var t in Object.keys(this._heroMap).length<=0&&(this._heroBag={}),this._heroMap)if(this._heroMap.hasOwnProperty(t)){var e=this._heroMap[t];if(!(a=this._heroBag[t])){a=new n.default;var i=td.GetTableClass(td.TableEnum.MazeHeroConfig).getHeroCfgByHeroId(e.heroId);a.initData(i)}a.refreshData(e),this._heroBag[t]=a}for(var t in this._heroBag){var a;if(this._heroBag.hasOwnProperty(t))(a=this._heroBag[t]).setEquip(this.isHeroLineup(a.getHeroSId()))}}},t.prototype.isHeroLineup=function(t){if(!this._lineup)return!1;for(var e in this._lineup){if(this._lineup[e]==t)return!0}return!1},t.prototype.getCurDayStoryByStoryId=function(t){return this._curStoryMap[t]},t.prototype.getCurDayStoryByFloorAndCol=function(t,e){for(var i in this._curStoryMap)if(this._curStoryMap.hasOwnProperty(i)){var n=this._curStoryMap[i];if(n.getFloor()==t&&n.getCol()==e)return n}return null},t.prototype.isStoryCanFall=function(t){return!!this.canShowFallAni()&&-1!=this._fallStoryIds.indexOf(t)},t.prototype.getFallIndex=function(t){this._fallStoryIds;for(var e=0;e<this._fallStoryIds.length;e++){if(this._fallStoryIds[e]==t)return e}return 0},t.prototype.removeFallStory=function(t){for(var e=this._fallStoryIds.length-1;e>=0;e--){if(this._fallStoryIds[e]==t){this._fallStoryIds.splice(0,1);break}}this._fallStoryIds.length<=0&&this.setShowFallAni(!1)},t.prototype._reqInfo=function(){this._reqGetMazeInfo(),this._reqBattleInfo()},t.prototype._reqGetMazeInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.MAZE,0)){var t={};t.module=td.MsgModuleName.MAZE,t.cmd=td.MsgCmd.MAZE.GET_MAZE_INFO,td.ServerDelegate.sendMessage(t)}},t.prototype._onGetMazeInfo=function(t,e){if(t===td.NetCode.SUCCESS){var i=this._passDay,n=this._currDay;n==e.currDay&&i==this._passDay||this.destroyData(),this._currDay=e.currDay,this._story=e.story,this._pass=e.pass,this._receive=e.receive,this._passDay=e.passDay,this._monsterLineup=e.monsterLineup,this._lineup=e.lineup,this._roadRecord=e.roadRecord,this._heroMap=e.heroMap,this._skillBag=e.specialEffects,this._optional=e.optional,this._reviewOptional=e.reviewOptional,this._reviewMonsterLineup=e.reviewMonsterLineup,this._scanEffect=e.scanEffect,this._scanPosition=e.scanPosition,this._refreshHeroBag();var a=this.getCurStoryDay(),o=1==td.GetTableClass(td.TableEnum.MazeStoryConfig).getCfgByStoryIdAndDay(this._story,a).boss,s=this._passDay;if(o&&this._pass&&(s+=1),this._isCurDayPass=s==this._currDay,i!=this._passDay&&this._curStoryMap&&!this.isCurDayPass()&&td.EventUtil.dispatchEvent(td.EventNameEnum.MAZE_PVE_PASSED_ALL),this.isCurDayPass()){var l=this._roadRecord[this._currDay]||[0];this._story=l[l.length-1]}if(this._refreshCurStoryList(n!=e.currDay||i!=this._passDay),!this._recoverItemCost||!this._reliveItemCost){for(var c=td.GetConfig("MAZE_HERO_OPERATION"),u=0;u<c.length;u++){(h=c[u])[0]==r.MAZE_ITEM_TYPE.RECOVER?this._recoverItemCost=td.RewardManager.getRewardDetail(h[1]):h[0]==r.MAZE_ITEM_TYPE.RELIVE&&(this._reliveItemCost=td.RewardManager.getRewardDetail(h[1]))}var d=td.GetConfig("MAZE_HERO_OPERATION_COST");for(u=0;u<d.length;u++){var h;(h=d[u])[0]==r.MAZE_ITEM_TYPE.RECOVER?this._recoverCost=td.RewardManager.getRewardDetail(h[1]):h[0]==r.MAZE_ITEM_TYPE.RELIVE&&(this._reliveCost=td.RewardManager.getRewardDetail(h[1]))}}this._maxPosNum||(this._maxPosNum=td.GetConfig("MAZE_LINEUP_MAX_HERO_COUNT")||7),td.EventUtil.dispatchEvent(td.EventNameEnum.GET_MAZE_INFO);var p=this.isMazeOpen(!0),_=this.isMazeOpen(!1);p||td.EventUtil.dispatchEvent(td.EventNameEnum.MAZE_PVE_CLOSE),_||td.EventUtil.dispatchEvent(td.EventNameEnum.MAZE_PVP_CLOSE)}},t.prototype._reqInitHeroInfo=function(){var t={};t.module=td.MsgModuleName.MAZE,t.cmd=td.MsgCmd.MAZE.GET_MAZE_HERO,td.ServerDelegate.sendMessage(t)},t.prototype._onGetInitHeroInfo=function(t,e){t===td.NetCode.SUCCESS&&(this._optional=e.optional,td.EventUtil.dispatchEvent(td.EventNameEnum.GET_MAZE_INIT_HERO))},t.prototype._reqMazePrepare=function(t){var e={};e.module=td.MsgModuleName.MAZE,e.cmd=td.MsgCmd.MAZE.PREPARE_MAZE_NEXT,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._onGetMazePrepare=function(t,e){t===td.NetCode.SUCCESS&&(this.setShowFallAni(!0),td.EventUtil.dispatchEvent(td.EventNameEnum.GET_MAZE_PREPARE))},t.prototype._reqMazeChallenge=function(t){var e={};e.module=td.MsgModuleName.MAZE,e.cmd=td.MsgCmd.MAZE.CHALLENGE_MAZE,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._onGetMazeChallenge=function(t,e){t===td.NetCode.SUCCESS&&(this._isGoFight=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.GET_MAZE_CHALLENGE))},t.prototype._reqChooseReward=function(t){var e={};e.module=td.MsgModuleName.MAZE,e.cmd=td.MsgCmd.MAZE.CHOOSE_MAZE_REWARD,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._onGetChooseReward=function(t,e){if(t===td.NetCode.SUCCESS){if(e.optional){var i=this.getCurDayStoryByStoryId(this._story);if(i.getEventType()==r.MAZE_EVENT_TYPE.HERO){var n=td.GetTableClass(td.TableEnum.HeroTable).getHeroById(e.optional);td.GlobalFunction.showBroadcastTip(463,[n.name])}else i.getEventType()==r.MAZE_EVENT_TYPE.SKILL&&td.GlobalFunction.showBroadcastTip(464)}var a=e.reward;if(a){var o=td.RewardManager.parseRewardResult(a,!0);td.GlobalFunction.showRewards(o)}td.EventUtil.dispatchEvent(td.EventNameEnum.GET_CHOOSE_REWARD)}},t.prototype._reqLineup=function(t){var e={};e.module=td.MsgModuleName.MAZE,e.cmd=td.MsgCmd.MAZE.CHANGE_MAZE_LINEUP,e.type=t.type,e.newPosition=t.newPosition,e.heroUId=t.heroUId,td.ServerDelegate.sendMessage(e)},t.prototype._onGetMazeLineup=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.GET_MAZE_LINEUP)},t.prototype._reqItemUse=function(t){var e={};e.module=td.MsgModuleName.MAZE,e.cmd=td.MsgCmd.MAZE.OPERATION_HERO,e.type=t.type,e.heroUId=t.heroUId,td.ServerDelegate.sendMessage(e)},t.prototype._onGetMazeItemUse=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.GET_MAZE_ITEM_USE)},t.prototype._reqReviewNext=function(t){var e={};e.module=td.MsgModuleName.MAZE,e.cmd=td.MsgCmd.MAZE.REVIEW_STORY,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._onGetReviewNext=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.GET_MAZE_REVIEW_NEXT)},t.prototype._reqSkillDiscard=function(t){var e={};e.module=td.MsgModuleName.MAZE,e.cmd=td.MsgCmd.MAZE.DISCARD_EFFECT,e.id=t,td.ServerDelegate.sendMessage(e)},t.prototype._onGetSkillDiscard=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.GET_MAZE_DISCARD)},t.prototype._reqBattleInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.MAZE,0)&&(this.isCurDayPass()&&this.isMazeOpen(!1))){var t={};t.module=td.MsgModuleName.MAZE,t.cmd=td.MsgCmd.MAZE.GET_MAZE_BATTLE_INFO,td.ServerDelegate.sendMessage(t)}},t.prototype._onGetBattleInfo=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.mazeTangledInfos||[];this._mazeTangledInfos=i;var n=td.Account.getUserData().getGamerId();this._myPlayerModel&&(this._pvpLastData={rank:this._myPlayerModel.getRank(),score:this._myPlayerModel.getScore()});for(var a=0;a<i.length;a++){var r=i[a],s=r.attributes[td.UserPropertyEnum.GamerId]||r.robotConfigId,l=this._playerMap[s];l||(l=new o.default,this._playerMap[s]=l),l.refreshData(r),l.setIsSelf(n==l.getSId()),l.isSelf()&&(this._myPlayerModel=l)}this._playerModelList=Object.values(this._playerMap),this._playerModelList.sort(function(t,e){return t.getScore()===e.getScore()?e.getFightPower()-t.getFightPower():e.getScore()-t.getScore()}),this._playerModelList.forEach(function(t,e){t.setRank(e+1)}),this._playerModelList.sort(function(t,e){return t.getPosition()-e.getPosition()}),td.EventUtil.dispatchEvent(td.EventNameEnum.GET_MAZE_BATTLE_INFO)}},t.prototype._reqGetReports=function(){var t={};t.module=td.MsgModuleName.MAZE,t.cmd=td.MsgCmd.MAZE.GET_MAZE_BATTLE_REPORTS,td.ServerDelegate.sendMessage(t)},t.prototype._onGetReportsInfo=function(t,e){td.NetCode.SUCCESS},t.prototype._onGetMazeInfoPush=function(t,e){t===td.NetCode.SUCCESS&&this._onGetMazeInfo(t,e)},t.prototype._onGetBattleInfoPush=function(t,e){t===td.NetCode.SUCCESS&&this._onGetBattleInfo(t,e)},t.prototype._onGetReportsInfoPush=function(t,e){if(t===td.NetCode.SUCCESS){for(var i=[],n=e.reports||[],a=0;a<n.length;a++){var r=n[a],o=new s.default;o.initData(r),i.push(o)}i.sort(function(t,e){return e.getTime()-t.getTime()}),td.EventUtil.dispatchEvent(td.EventNameEnum.GET_MAZE_REPORTS,i)}},t.prototype.getCurStoryId=function(){return this._story},t.prototype.getMyLineup=function(){return this._lineup},t.prototype.getInitRandomHeros=function(){return[]},t.prototype.getMyHeroList=function(){var t=[];return this._heroBag&&(t=Object.values(this._heroBag)),t.sort(this._sortHeroList),t},t.prototype.getMyHeroNumExceptSame=function(){var t={};for(var e in this._heroBag)if(Object.prototype.hasOwnProperty.call(this._heroBag,e)){var i=this._heroBag[e];t[i.getHeroType()]||(t[i.getHeroType()]=i)}return Object.keys(t).length},t.prototype._sortHeroList=function(t,e){return t.isDied()&&!e.isDied()?1:!t.isDied()&&e.isDied()?-1:t.getQuality()==e.getQuality()?e.getHeroId()-t.getHeroId():e.getQuality()-t.getQuality()},t.prototype.getHeroByUid=function(t){return this._heroBag||t?this._heroBag[t]:null},t.prototype.getHeroByHeroId=function(t){for(var e=this.getMyHeroList(),i=0;i<e.length;i++){var n=e[i];if(n.getHeroId()==t)return n}return null},t.prototype.getCurBossStoryCfg=function(){var t=td.GetTableClass(td.TableEnum.MazeStoryConfig);return t?t.getCfgByDayAndBoss(this._currDay,!0):null},t.prototype.getOpenInfo=function(t){return{isOpen:this.isMazeOpen(t),stateEndTime:this.getStageEndTime(t)}},t.prototype.getStageEndTime=function(t){var e=this.isMazeOpen(t),i=[];i=t?td.GetConfig("MAZE_PASS_BARRIER_TIME"):td.GetConfig("MAZE_BATTLE_TIME");var n=null,a=td.TimeUtil.getTheZeroPoint();if(e)n=i[1],a=td.TimeUtil.getTheZeroPoint();else{n=i[0];var r=td.TimeUtil.getServerDate(),o=100*r.getHours()+r.getMinutes();n<=o&&(a=td.TimeUtil.getSecondDayZeroPoint());var s=i[1],l=r.getDay();s<=o&&6==l&&(a+=864e5)}0==this._currDay&&(a=td.TimeUtil.getTheZeroPoint());var c=a+60*(60*Math.floor(n/100)+n%100)*1e3;return e||(c+=1e3),0==this._currDay&&(c+=864e5),c},t.prototype.isMazeOpen=function(t){var e=[];return e=t?td.GetConfig("MAZE_PASS_BARRIER_TIME"):td.GetConfig("MAZE_BATTLE_TIME"),!!(td.TimeUtil.isCurTimeInTime(e,1e3)&&this._currDay>0)},t.prototype.getInitFightHeroIds=function(){return this._optional},t.prototype.getInitHeroIds=function(){var t=td.GetConfig("MAZE_INIT_HERO_POOL_ID"),e=td.GetTableClass(td.TableEnum.MazeHeroPoolConfig);if(!e)return[];for(var i=e.getHerosByPoolId(t),n=[],a=0;a<i.length;a++){var r=i[a];n.push(r[0])}return n},t.prototype.getChooseList=function(t){return void 0===t&&(t=0),this._optional.length<=0?this._reviewOptional[t]:this._optional||[]},t.prototype.getSkillBagList=function(){return this._skillBag},t.prototype.getRecoverItemCost=function(){return this._recoverItemCost},t.prototype.getReliveItemCost=function(){return this._reliveItemCost},t.prototype.getRecoverCost=function(){return this._recoverCost},t.prototype.getReliveCost=function(){return this._reliveCost},t.prototype.getCostItemByType=function(t){return t==r.MAZE_ITEM_TYPE.RECOVER?this._recoverItemCost:t==r.MAZE_ITEM_TYPE.RELIVE?this._reliveItemCost:null},t.prototype.getCostByType=function(t){return t==r.MAZE_ITEM_TYPE.RECOVER?this._recoverCost:t==r.MAZE_ITEM_TYPE.RELIVE?this._reliveCost:null},t.prototype.getHeroListByType=function(t){var e=[];return t==r.MAZE_ITEM_TYPE.RELIVE?e=this.getDiedHeros():t==r.MAZE_ITEM_TYPE.RECOVER&&(e=this.getHurtHeros()),e},t.prototype.setCurPreViewStory=function(t){this._curPreViewStory=t},t.prototype.getCurPreViewStory=function(){return this._curPreViewStory},t.prototype.getMonsterLineup=function(t){return void 0===t&&(t=0),Object.keys(this._monsterLineup).length<=0?this._reviewMonsterLineup[t]:this._monsterLineup},t.prototype.getMaxPosNum=function(){return this._maxPosNum},t.prototype.getCanLineNum=function(){var t=[];for(var e in this._heroBag)if(this._heroBag.hasOwnProperty(e)){var i=this._heroBag[e];i.isDied()||-1!=t.indexOf(i.getHeroType())||t.push(i.getHeroType())}return t.length},t.prototype.isHeroTypeInLineup=function(t,e,i){if(!i)return!1;for(var n in i)if(i.hasOwnProperty(n)){var a=i[n];if(e==(t==r.MAZE_LINE_TYPE.PVE?this._heroBag[a]:this.getHeroByHeroId(a)).getHeroType())return!0}return!1},t.prototype.isHeroIdInBag=function(t){if(!this._heroBag)return!1;for(var e in this._heroBag){if(t==this._heroBag[e].getHeroId())return!0}return!1},t.prototype.isPassed=function(){return this._pass},t.prototype.isReceived=function(){return this._receive},t.prototype.isCurStoryRewardToReceive=function(){return!(!this._pass||this._receive)},t.prototype.getEmptyPos=function(t){if(!t)return 1;for(var e=1;e<=this._maxPosNum;e++){if(!t[e])return e}return 0},t.prototype.isCurStory=function(t){return this._story==t},t.prototype.isNextStory=function(t){if(!this._flagStory)return!1;for(var e=this._flagStory.getNextStory(),i=0;i<e.length;i++){if(e[i]==t)return!0}return!1},t.prototype.isInPassRoad=function(t){if(0==t)return!0;var e=this.getCurStoryDay();return-1!=(this._roadRecord[e]||[]).indexOf(t)},t.prototype.isCurDayPass=function(){return this._isCurDayPass},t.prototype.getCurrDay=function(){return this._currDay},t.prototype.getPassDay=function(){return this._passDay},t.prototype.getCurStoryModel=function(){return this._curStoryMap[this._story]},t.prototype.setShowFallAni=function(t){this._canShowFallAni=t},t.prototype.canShowFallAni=function(){return this._canShowFallAni},t.prototype.isGoFight=function(){return this._isGoFight},t.prototype.setGoFight=function(t){this._isGoFight=t},t.prototype.isAllHeroDied=function(){if(!this._heroBag)return!0;for(var t in this._heroBag){if(this._heroBag.hasOwnProperty(t))if(!this._heroBag[t].isDied())return!1}return!0},t.prototype.getHurtHeros=function(){var t=[];if(!this._heroBag)return t;for(var e in this._heroBag)if(this._heroBag.hasOwnProperty(e)){var i=this._heroBag[e];!i.isDied()&&i.getHp()<i.getHpMax()&&t.push(i)}return t.sort(this._sortHeroList),t},t.prototype.getDiedHeros=function(){var t=[];if(!this._heroBag)return t;for(var e in this._heroBag)if(this._heroBag.hasOwnProperty(e)){var i=this._heroBag[e];i.isDied()&&t.push(i)}return t.sort(this._sortHeroList),t},t.prototype.getMyPlayerModel=function(){return this._myPlayerModel},t.prototype.getMyLastPvpData=function(){return this._pvpLastData||{}},t.prototype.getConstScore=function(){return td.GetConfig("MAZE_MANGLED_SCORE")},t.prototype.getPlayerList=function(){return this._playerModelList},t.prototype.getScoreRewardCfgs=function(){var t=td.GetTableClass(td.TableEnum.MazeScoreRewardConfig);return t?t.getAllCfg():[]},t.prototype.getRewardByScore=function(t){var e=td.GetTableClass(td.TableEnum.MazeScoreRewardConfig);if(!e)return[];var i=e.getCfgByScore(t);return i?td.RewardManager.parseRewardListDetail(i.rewards):[]},t.prototype.getScanSkills=function(){return this._scanEffect},t.prototype.getScanPostion=function(){return this._scanPosition},t.prototype.getSkillOwner=function(){for(var t=0;t<this._playerModelList.length;t++){var e=this._playerModelList[t];if(e.getPosition()==this._scanPosition)return e}return null},t.prototype.setReplayFight=function(t){this._isReplayFight=t},t.prototype.isReplayFight=function(){return this._isReplayFight},t.prototype.isSunday=function(){return 0==this._currDay},t.prototype._isFuncUnlock=function(){return!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.MAZE,0)},t.prototype.isOpenPveViewToday=function(){return td.GlobalFunction.getLocalSaveStatus("MazePve")},t.prototype.isOpenPvpViewToday=function(){return td.GlobalFunction.getLocalSaveStatus("MazePvp")},t.prototype.openPvePanel=function(){td.GlobalFunction.setLocalSaveStatus("MazePve","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.MAZE_PANEL_OPENED)},t.prototype.openPvpPanel=function(){td.GlobalFunction.setLocalSaveStatus("MazePvp","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.MAZE_PANEL_OPENED)},t.prototype.isPveRed=function(){var t=this.isMazeOpen(!0);return t&&(t=!this.isOpenPveViewToday()),t},t.prototype.isPvpRed=function(){var t=this.isMazeOpen(!1);return t&&(t=this.isCurDayPass())&&(t=!this.isOpenPvpViewToday()),t},t.prototype.isRedPointTips=function(){return this._isFuncUnlock()&&(this.isPveRed()||this.isPvpRed())},t.prototype.redPointEvents=function(){return[td.EventNameEnum.MAZE_PANEL_OPENED,td.EventNameEnum.GET_MAZE_INFO,td.EventNameEnum.GET_MAZE_BATTLE_INFO]},t}();i.default=l,cc._RF.pop()},{"../Enum/MazeEnum":"MazeEnum","../Model/MazeHeroModel":"MazeHeroModel","../Model/MazePlayerModel":"MazePlayerModel","../Model/MazeReportModel":"MazeReportModel","../Model/MazeStoryModel":"MazeStoryModel"}],MazePlayerModel:[function(t,e,i){"use strict";cc._RF.push(e,"12e31KaztpHY7xU/GbofRFZ","MazePlayerModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("BaseUser"),a=function(){function t(){this._attributes=null,this._robotConfigId=0,this._groupId=0,this._position=0,this._score=0,this._attendLineup=null,this._defenseLineup=null,this._challengeMap=null,this._userModel=null,this._isSelf=!1,this._rank=0}return t.prototype.refreshData=function(t){t&&(this._attributes=t.attributes,this._robotConfigId=t.robotConfigId,this._groupId=t.groupId,this._position=t.position,this._score=t.score,this._attendLineup=t.attendLineup,this._defenseLineup=t.defenseLineup,this._challengeMap=t.challengeMap,this._robotConfigId&&(this._attributes[td.UserPropertyEnum.GamerId]=this._robotConfigId),this._userModel=new n,this._userModel.init("",this._attributes))},t.prototype.getSId=function(){return this._userModel.getGamerId()},t.prototype.getUserModel=function(){return this._userModel},t.prototype.getFightPower=function(){return this._userModel.getFightPower()},t.prototype.getGroupId=function(){return this._groupId},t.prototype.getPosition=function(){return this._position},t.prototype.getScore=function(){return this._score},t.prototype.getAttendLineup=function(){return this._attendLineup},t.prototype.getDefenseLineup=function(){return this._defenseLineup},t.prototype.getChallengeMap=function(){return this._challengeMap},t.prototype.setIsSelf=function(t){this._isSelf=t},t.prototype.isSelf=function(){return this._isSelf},t.prototype.setRank=function(t){this._rank=t},t.prototype.getRank=function(){return this._rank},t.prototype.isPlayerChallenged=function(t){return null!=this._challengeMap[t]},t.prototype.isChallengeWin=function(t){return!!this._challengeMap[t]},t.prototype.getShowHeroId=function(){return this._userModel.firstHeroId},t.prototype.isHeroInAttend=function(t){if(!this._attendLineup)return!1;for(var e in this._attendLineup){if(this._attendLineup.hasOwnProperty(e))if(t==this._attendLineup[e])return!0}return!1},t.prototype.isHeroInDefense=function(t){if(!this._defenseLineup)return!1;for(var e in this._defenseLineup){if(this._defenseLineup.hasOwnProperty(e))if(t==this._defenseLineup[e])return!0}return!1},t}();i.default=a,cc._RF.pop()},{BaseUser:"BaseUser"}],MazeReportModel:[function(t,e,i){"use strict";cc._RF.push(e,"ba1d2El6+xOrJxT9TwadDqJ","MazeReportModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("BaseUser"),a=function(){function t(){this._reportResult={},this._reports={},this._members=[],this._parameterMap={},this._time=0,this._leftPlayerModel=null,this._rightPlayerModel=null,this._leftHeroModel={},this._rightHeroModel={},this._changeScore=0,this._constScore=3}return t.prototype.initData=function(t){this._reportResult=t,this._reports=t.reports,this._members=t.members,this._parameterMap=t.parameterMap,this._time=this._parameterMap[58],this._setPlayerInfo();var e=td.GetConfig("MAZE_MANGLED_SCORE");this._constScore=e;var i=this.isLeftWin();this.isSelfAtacked()?this._changeScore=i?-e:0:this._changeScore=i?e:0},t.prototype.getReportResult=function(){return this._reportResult},t.prototype._setPlayerInfo=function(){for(var t=0;t<this._members.length;t++){var e=this._members[t];if(1==e.camp){var i=e.attributeMap;this._leftPlayerModel=new n,this._leftPlayerModel.init("",i)}else if(2==e.camp){i=e.attributeMap;this._rightPlayerModel=new n,this._rightPlayerModel.init("",i)}}},t.prototype.getLeftPlayer=function(){for(var t=null,e=0;e<this._members.length;e++){var i=this._members[e];if(1==i.camp){t=i;break}}return t},t.prototype.getLeftPlayerAttr=function(){return this.getLeftPlayer().attributeMap},t.prototype.getLeftShowHeroModel=function(){return this._leftHeroModel},t.prototype.getRightPlayer=function(){for(var t=null,e=0;e<this._members.length;e++){var i=this._members[e];if(2==i.camp){t=i;break}}return t},t.prototype.getRightPlayerAttr=function(){return this.getRightPlayer().attributeMap},t.prototype.getRightShowHeroModel=function(){return this._rightHeroModel},t.prototype.getPlayerAttr=function(t){this.getRightPlayerAttr();return t?this.getLeftPlayerAttr():this.getRightPlayerAttr()},t.prototype.getPlayerScore=function(t){this.getLeftScore();return t?this.getLeftScore():this.getRightScore()},t.prototype.getPlayerFight=function(t){return this.getPlayerAttr(t)[td.UserPropertyEnum.FightPower]},t.prototype.getPlayerName=function(t){this.getRightPlayerAttr();return(t?this.getLeftPlayerAttr():this.getRightPlayerAttr())[td.UserPropertyEnum.NickName]},t.prototype.getPlayerNameAndServer=function(t){var e=this.getRightPlayerAttr(),i=(e=t?this.getLeftPlayerAttr():this.getRightPlayerAttr())[td.UserPropertyEnum.NickName],n=e[td.UserPropertyEnum.ServerId];return"["+cc.js.formatStr(td.Language.serverArea,n)+"] "+i},t.prototype.getPlayerModel=function(t){return t?this._leftPlayerModel:this._rightPlayerModel},t.prototype.getReports=function(){return this._reports},t.prototype.getTime=function(){return this._time},t.prototype.getTimeStr=function(){return td.TimeUtil.convertDataTime(this._time)},t.prototype.getLeftScore=function(){return this._parameterMap[55]},t.prototype.getRightScore=function(){return this._parameterMap[56]},t.prototype.isLeftWin=function(){var t=this.getLeftPlayer();return!(!t||t.camp!=this._reportResult.stats.winCamp)},t.prototype.isSelfAtacked=function(){var t=td.Account.getUserData().getGamerId();return this.getRightPlayerAttr()[td.UserPropertyEnum.GamerId]==t},t.prototype.getChangeScore=function(){return this._changeScore},t.prototype.getConstScore=function(){return this._constScore},t}();i.default=a,cc._RF.pop()},{BaseUser:"BaseUser"}],MazeRobotConfig:[function(t,e,i){"use strict";cc._RF.push(e,"c511bfkq1hIAKrpO2DnBBYE","MazeRobotConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MazeRobotConfig",e._tblName="maze_robot_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.robotId;t[r]||(t[r]={}),t[r]=a}},e.prototype.getRobotCfgById=function(t){return this._data[t]},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MazeScoreRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"c1a63gNZmFJe7wsnIBr7K+U","MazeScoreRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MazeScoreRewardConfig",e._tblName="maze_score_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t.push(a)}for(var r=0;r<this._data.length;r++){var o=this._data[r];if(r+1<this._data.length){var s=this._data[r+1];o.maxScore=s.score}else o.maxScore=-1}this._data.sort(function(t,e){return e.score-t.score})},e.prototype.getAllCfg=function(){return this._data},e.prototype.getCfgByScore=function(t){if(!this._data)return null;for(var e=0;e<this._data.length;e++){var i=this._data[e];if(t>=i.score&&(t<i.maxScore||i.maxScore<0))return i}return null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MazeStoryConfig:[function(t,e,i){"use strict";cc._RF.push(e,"60bd5YbVmpEG77GinHQtk5c","MazeStoryConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MazeStoryConfig",e._tblName="maze_story_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.day]||(t[a.day]=[]),t[a.day].push(a)}for(var r in this._data){if(this._data.hasOwnProperty(r))this._data[r].sort(function(t,e){return t.storyId-e.storyId})}},e.prototype.getAllDatas=function(){return this._data},e.prototype.getCfgByStoryId=function(t){for(var e in this._data)if(this._data.hasOwnProperty(e))for(var i=this._data[e],n=0;n<i.length;n++){var a=i[n];if(a.storyId==t)return a}return null},e.prototype.getCfgByStoryIdAndDay=function(t,e){for(var i in this._data)if(this._data.hasOwnProperty(i))for(var n=this._data[i],a=0;a<n.length;a++){var r=n[a];if(r.storyId==t&&r.day==i)return r}return null},e.prototype.getCfgByDayAndBoss=function(t,e){var i=this._data[t];if(i)for(var n=0;n<i.length;n++){var a=i[n];if(a.boss==e)return a}return null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MazeStoryModel:[function(t,e,i){"use strict";cc._RF.push(e,"fa6a0P3DhxGXoxeQR4SOAVD","MazeStoryModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._day=0,this._storyId=0,this._floor=0,this._col=0,this._eventType=0,this._isBoss=!1,this._nextStory=[],this._poolId=0,this._effectRandomCount=0,this._name="",this._passRewards=[],this._isShowFlat=!1,this._isPassed=!1}return t.prototype.initData=function(t){t&&(this._day=t.day,this._storyId=t.storyId,this._floor=t.floor,this._col=t.col,this._eventType=t.type,this._isBoss=1==t.boss,this._nextStory=t.nextStory,this._poolId=t.poolId,this._effectRandomCount=t.effectRandomCount,this._name=t.name,this._passRewards=t.passRewards)},t.prototype.refreshData=function(t){},t.prototype.getStoryId=function(){return this._storyId},t.prototype.getDay=function(){return this._day},t.prototype.getFloor=function(){return this._floor},t.prototype.getCol=function(){return this._col},t.prototype.getEventType=function(){return this._eventType},t.prototype.isBoss=function(){return this._isBoss},t.prototype.getNextStory=function(){return this._nextStory},t.prototype.getPoolId=function(){return this._poolId},t.prototype.getEffectRandomCount=function(){return this._effectRandomCount},t.prototype.getName=function(){return this._name},t.prototype.getPassRewards=function(){return td.RewardManager.parseRewardListDetail(this._passRewards)},t.prototype.setIsPassed=function(t){this._isPassed=t},t.prototype.isPassed=function(){return this._isPassed},t.prototype.setShowFlag=function(t){this._isShowFlat=t},t.prototype.isShowFlag=function(){return this._isShowFlat},t.prototype.setStoryState=function(t){this.setIsPassed(this._storyId<t),this.setShowFlag(this._storyId==t)},t}();i.default=n,cc._RF.pop()},{}],MercenaryAssistantConfig:[function(t,e,i){"use strict";cc._RF.push(e,"2445e+xp/hKoKLDDivCE6UE","MercenaryAssistantConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HeroAssistantConfig",properties:{_tblName:"hero_assistant_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];a.icon&&(3!==a.type?a.icon="res/ui/fjIcon/FJ_icon_"+a.icon+".png":a.icon="res/ui/heroIcon/HI_icon_"+a.icon+".png"),t[a.id]=a}},getData:function(){return this._data},getAssistantDataById:function(t){return this._data[t]?this._data[t]:(cc.log("assistant Id is error:",t),null)}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MercenaryAwakeStrengthenTable:[function(t,e,i){"use strict";cc._RF.push(e,"75638K3tJNFzLdaHRt9kJex","MercenaryAwakeStrengthenTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HeroAwakeStrengthenTable",properties:{_tblName:"hero_awaken_strengthen_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i)t[t.length]=e[i]},getData:function(){return this._data},getAwakeStrengthenDataById:function(t){for(var e=[],i=0,n=this._data.length;i<n;i++){var a=this._data[i];t===a.id&&(e[e.length]=a)}return e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MercenaryAwakenConfig:[function(t,e,i){"use strict";cc._RF.push(e,"825f2MJWGFNcrh+kzj8ZuHu","MercenaryAwakenConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HeroAwakenConfig",properties:{_tblName:"hero_awaken_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i)t[t.length]=e[i]},getData:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MercenaryEnum:[function(t,e,i){"use strict";cc._RF.push(e,"bea9eKrI3dDjZl+ddkC1CBy","MercenaryEnum"),td.FeaturesFont={1:"UI/PvpFont/huiheZD_kjshuzi_shui",2:"UI/PvpFont/huiheZD_kjshuzi_huo",3:"UI/PvpFont/huiheZD_kjshuzi_feng",4:"UI/PvpFont/huiheZD_kjshuzi_tu"},td.FeaturesImg={1:"GY_zhiye_01",2:"GY_zhiye_02",3:"GY_zhiye_03",4:"GY_zhiye_04",5:"CW_leixian_02",6:"CW_leixian_01"},td.MercenaryUpViewTab={upGradeTab:1,evolveTab:2,practiceTab:3,starUpTab:4},td.AssistRelationType={Count:1,Feature:2,Id:3},td.BattleSelectType={Friend:1,Assistant:2},cc._RF.pop()},{}],MercenaryEvolveConfig:[function(t,e,i){"use strict";cc._RF.push(e,"2ba87JBDSVFh4SiwO0QBAf/","MercenaryEvolveConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HeroEvolveConfig",properties:{_tblName:"hero_evolve_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}},getEvolveConfig:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MercenaryFightModel:[function(t,e,i){"use strict";cc._RF.push(e,"94086edVuNPo4KAwrHCUUaZ","MercenaryFightModel");var n=t("Model"),a=t("HeroModel");td.MercenaryFightModel=cc.Class({extends:n,properties:{_baseModel:null,_camp:null,_pos:null,_hp:null,_maxHp:null,_rage:null,_maxRage:null,_curCamp:null},init:function(t){if(t){var e=t.attributes,i=e[td.SpriteKey.ConfigId],n=td.GetTableClass(td.TableEnum.HeroTable).getHeroById(i);n||(cc.error("\u627e\u4e0d\u5230\u82f1\u96c4id=",i),td.GetTableClass(td.TableEnum.Monster).getMonsterDataById(i)),this._baseModel=new a,this._baseModel.init(n),this._baseModel.setSId(e[td.SpriteKey.Sid]),this._camp=e[td.SpriteKey.Camp],this._pos=e[td.SpriteKey.Position]-1,this._hp=e[td.SpriteKey.HP]||0,this._maxHp=e[td.SpriteKey.MaxHp]||0,this._rage=e[td.SpriteKey.RAGE]||0,this._maxRage=e[td.SpriteKey.MaxRage]||0,this._curCamp=e[td.SpriteKey.HERO_CAMP]||0}},getBaseModel:function(){return this._baseModel},getSId:function(){return this._baseModel.getSId()},getRoleType:function(){return this._baseModel.getRoleType()},getModelShowType:function(){return this._baseModel.getModelShowType()},getAnimationIndex:function(){return this._baseModel.getAnimationIndex()},getAnimationRes:function(){return this._baseModel.getAnimationRes()},getPos:function(){return this._pos},getCamp:function(){return this._camp},getCurCamp:function(){return this._curCamp},getHp:function(){return this._hp},setHp:function(t){t=Math.min(t,this._maxHp),this._hp=t},getMaxHp:function(){return this._maxHp},getRage:function(){return this._rage},setRage:function(t){return this._rage=t},getMaxRage:function(){return this._maxRage}}),cc._RF.pop()},{HeroModel:"HeroModel",Model:"Model"}],MercenaryFightShowTable:[function(t,e,i){"use strict";cc._RF.push(e,"706fdGSC+hAuLtEqFCS0XoG","MercenaryFightShowTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HeroFightShowTable",properties:{_tblName:"hero_fightshow_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.spriteType,o=a.roleType+"_"+a.spriteType;t[o]||(t[o]={});var s=a.roleType,l=a.skillId;if(r===td.SpriteType.PET?(a.skillAnimation&&(a.skillAnimationRes="pet/pet_"+s+"/pvp/"+a.skillAnimation),a.mercenaryAtkAnimation&&(a.mercenaryAtkAnimationRes="pet/pet_"+s+"/pvp/"+a.mercenaryAtkAnimation)):(a.skillAnimation&&(a.skillAnimationRes="hero/hero_"+s+"/pvp/"+a.skillAnimation),a.mercenaryAtkAnimation&&(a.mercenaryAtkAnimationRes="hero/hero_"+s+"/pvp/"+a.mercenaryAtkAnimation)),a.underAtkSkillAnimation&&(a.underAtkSkillAnimationRes="fightRes/pvp/under_attack/"+a.underAtkSkillAnimation),a.trajectorySp)a.trajectorySp&&(a.trajectorySpRes="hero/hero_"+s+"/pvp/"+a.trajectorySp);a.skillName&&(a.skillName="animation/skill/"+a.skillName);for(var c=0,u=l.length;c<u;++c){var d=l[c],h=td.GlobalFunction.copyData(a);h.skillId=d,t[o][d]=h}}},getShowDataByType:function(t,e){void 0===e&&(e=td.SpriteType.HERO);var i=t+"_"+e;return this._data[i]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MercenaryLevelConfig:[function(t,e,i){"use strict";cc._RF.push(e,"ed875ndjl1F8oJcXQBnk7Ix","MercenaryLevelConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HeroLevelConfig",properties:{_tblName:"hero_level_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}},getUpgradeLevelData:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MercenaryReinforcementConfig:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"8a973ZF9U9J7q1Ten3sgnkR","MercenaryReinforcementConfig");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="HeroReinforcementConfig",e._tblName="hero_reinforcement_config",e._data={},e}n(e,t);var i=e.prototype;return i.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},i.getPartnership=function(){return this._data},i.getPartnershipById=function(t){return this._data[t]?this._data[t]:(cc.log("partnership Id is error:",t),null)},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MercenaryRelifeConfig:[function(t,e,i){"use strict";cc._RF.push(e,"ca9beC28kZFeIjqh6RyXZG1","MercenaryRelifeConfig");var n=t("BaseTable");cc.Class({extends:n,name:"HeroRelifeConfig",properties:{_tblName:"hero_relife_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.roleId]=a}},getRelifeCost:function(t){return this._data[t]?this._data[t].cost:null},getRelifeRestoreReward:function(t){return this._data[t]?this._data[t].restoreRewards:null},getRelifeRoleId:function(t){return this._data[t]?this._data[t].relifeRoleId:null}});cc._RF.pop()},{BaseTable:"BaseTable"}],MercenaryTable:[function(t,e,i){"use strict";cc._RF.push(e,"a788cIKx/JJV6KOAMgqxAcd","MercenaryTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"HeroTable",properties:{_tblName:"hero_config",_data:null,_roleTypeData:null},init:function(){this._data={},this._roleTypeData={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.roleType;a.headImg&&(a.headImg="Hero"+a.headImg),a.spriteAnimationRes="hero/hero_"+r+"/hero_"+r,a.animationOffset?a.animationOffset={x:a.animationOffset[0],y:a.animationOffset[1]}:a.animationOffset={x:0,y:0},t[a.roleId]=a;var o=this._roleTypeData[a.roleType];o||(o={},this._roleTypeData[a.roleType]=o),o[a.relifeTimes]=a.roleId}var s=this._data;for(var l in s){var c=s[l],u=c.nextRoleId,d=this.getMercenaryById(u);d&&(d.preRoleId=c.roleId)}},getMercenaryData:function(){return this._data},getMercenaryById:function(t){return this._data[t]},getHeroIdByTypeRelife:function(t,e){var i=this._roleTypeData[t];return i?i[e]:null},getHeroByRoleType:function(t){return this._roleTypeData[t]}});e.exports=a,td.MercenaryLevelTable=cc.Class({extends:n,properties:{_name:"mercenary_level_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.level,o=a.star;t[r]||(t[r]={}),t[r][o]||(t[r][o]={}),t[r][o]=a}},getMercenaryLevelInfo:function(t,e){return this._data[t]&&this._data[t][e]?this._data[t][e]:null}}),cc._RF.pop()},{BaseTable:"BaseTable"}],MoXieCashRedEnvelopeConfig:[function(t,e,i){"use strict";cc._RF.push(e,"76cf5+jVIJDk77X0vk4g1+E","MoXieCashRedEnvelopeConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MoXieCashRedEnvelopeConfig",e._tblName="mo_xie_cash_red_envelope_config",e._datas={},e}return n(e,t),e.prototype.init=function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.day]=e}},e.prototype.getDatas=function(){return this._datas},e.prototype.getDataByDay=function(t){for(var e in this._datas){var i=this._datas[e];if(parseInt(e)==t)return i}return{}},e.prototype.getRechargeList=function(t){return this.getDataByDay(t).charges},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MoXieLoginRedEnvelopeConfig:[function(t,e,i){"use strict";cc._RF.push(e,"19f2auAnqhB0JZAytrifoy5","MoXieLoginRedEnvelopeConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MoXieLoginRedEnvelopeConfig",e._tblName="mo_xie_login_red_envelope_config",e._datas={},e}return n(e,t),e.prototype.init=function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.day]=e}},e.prototype.getDatas=function(){return this._datas},e.prototype.getDataByDay=function(t){for(var e in this._datas){var i=this._datas[e];if(parseInt(e)==t)return i}return{}},e.prototype.getAmountMaxByDay=function(t){return(this.getDataByDay(t).amountMax/100).toFixed(2)},e.prototype.getAmountByDay=function(t){return(this.getDataByDay(t).redEnvelopeAmount/100).toFixed(2)},e.prototype.getDesTipsByDay=function(t){return this.getDataByDay(t).desTips},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MobilizationTable:[function(t,e,i){"use strict";cc._RF.push(e,"fdda7/35JlK0ajcNU4T7JQC","MobilizationTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MobilizationTable",e._tblName="activity_mobilization_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r].push(a)}},e.prototype.getDataByDataIdAndDay=function(t,e){var i=this._data[t];if(i){i.sort(function(t,e){return t.serverOpenDay-e.serverOpenDay});for(var n=i[0],a=0;a<i.length;a++){var r=i[a];e>=r.serverOpenDay&&(n=r)}return n}},e.prototype.getDataByDataIdAndNum=function(t,e){var i=this._data[t];if(i){i.sort(function(t,e){return t.count-e.count});for(var n=i[0],a=0;a<i.length;a++){var r=i[a];e>=r.count&&(n=r)}return n}},e.prototype.getDataByDataIdAndId=function(t,e){var i=this._data[t];if(i){for(var n=0;n<i.length;n++){var a=i[n];if(a.id==e)return a}return i[i.length-1]}},e.prototype.getDatasByDataId=function(t){var e=this._data[t];return e.sort(function(t,e){return t.id-e.id}),e},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ModelCreator:[function(t,e,i){"use strict";cc._RF.push(e,"88bf6JMx7FAcrPrra9CXRP4","ModelCreator"),td.ModelCreator={createModel:function(t,e){switch(t){case td.TableEnum.Item:var i=td.GetTableClass(td.TableEnum.Item).getItemById(e);new td.Item(i).init(td.UserPropertyEnum.Item,i.goodsId,i.name,i.iconRes)}}},cc._RF.pop()},{}],ModelShowTable:[function(t,e,i){"use strict";cc._RF.push(e,"b1ca1ryod5L2IJc6U/EBVSF","ModelShowTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ModeShowConfig",properties:{_tblName:"model_show_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];""===a.height&&(a.height=0),a.idleScale=a.idleScale/100,a.h5_idleScale&&(a.h5_idleScale=a.h5_idleScale/100);var r=a.type;t[r]||(t[r]={}),t[r][a.roleId]=a}},getDataByTypeAndId:function(t,e){return this._data[t]?this._data[t][e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],Model:[function(t,e,i){"use strict";cc._RF.push(e,"b19f5cx9Q9Dtpo9bKVWpPX6","Model");var n=cc.Class({properties:{clsName:""},init:function(t){this.clsName=t}});e.exports=n,cc._RF.pop()},{}],ModuleManager:[function(t,e,i){"use strict";cc._RF.push(e,"ca2bcezUnJCqqYTIsoO0eli","ModuleManager");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../../TS/Hero/Manager/HeroManager"));td.PvpLoadPart={All:1,FIRST:2,SECOND:3},td.ModuleManager={_fightModules:null,_idleModules:null,setSelfMercenaryModules:function(){var t=[],e=td.BattleArrayManager.getBattleArrayData(),i=n.default.getInstance().getHeroData(),a=[];for(var r in e){var o=e[r];a[a.length]=i[o.getMercenarySId()],t=t.concat([i[o.getMercenarySId()].getShowModelResKey()])}this._fightModules=this.getHeroesModule(a),this._idleModules=t,td.GuideManager.isFirstBattle()||setTimeout(function(){gdk.rm.addLoadResInBackground(this._fightModules)}.bind(this),2e3)},getSelfMercenaryModules:function(){return this._fightModules},getSelfMercenaryIdleModules:function(){return this._idleModules},getMonstersModule:function(t,e){return this.getHeroesModule(t,e)},getHeroesModuleFirstPart:function(t){var e=[];t||(t=[]),t instanceof Array||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i],a="npc_"+n.getRoleType()+"_"+n.getModelShowType()+"_frist",r=gdk.ResourceId.getValue(a);r||((r={})[a]={},gdk.ResourceId.mixins(r),r=r[a]);var o=[],s=n.getAnimationRes();this._checkResIsExist(o,s)||(o[o.length]=s),o.length>0&&(r.atlas={type:cc.Prefab,resArray:o}),ArrayUtils.contains(e,a)||(e[e.length]=a)}return e},getHeroesModuleSecondPart:function(t){var e=[];t||(t=[]),t instanceof Array||(t=[t]);for(var i=0;i<t.length;i++){var n=t[i],a=n.getRoleType(),r=n.getModelShowType(),o="npc_"+a+"_"+r+"_second",s=gdk.ResourceId.getValue(o);s||((s={})[o]={},gdk.ResourceId.mixins(s),s=s[o]);var l=[],c=[],u=td.GetTableClass(td.TableEnum.PvpFightShow).getShowDataByType(a,r);for(var d in u){var h=u[d];h.skillAnimationRes&&!this._checkResIsExist(l,h.skillAnimationRes)&&(l[l.length]=h.skillAnimationRes),h.mercenaryAtkAnimationRes&&!this._checkResIsExist(l,h.mercenaryAtkAnimationRes)&&(l[l.length]=h.mercenaryAtkAnimationRes),h.trajectorySp&&!this._checkResIsExist(l,h.trajectorySp)&&(l[l.length]=h.trajectorySpRes),h.underAtkSkillAnimationRes&&!this._checkResIsExist(c,h.underAtkSkillAnimationRes)&&(c[c.length]=h.underAtkSkillAnimationRes,s.underAttackAnimationPrefab={type:cc.Prefab,resArray:c})}l.length>0&&(s.skillAnimationPrefab={type:cc.Prefab,resArray:l}),ArrayUtils.contains(e,o)||(e[e.length]=o)}return e},getHeroesModule:function(t,e){switch(e=e||td.PvpLoadPart.All){case td.PvpLoadPart.All:return this.getHeroesModuleFirstPart(t).concat(this.getHeroesModuleSecondPart(t));case td.PvpLoadPart.FIRST:return this.getHeroesModuleFirstPart(t);case td.PvpLoadPart.SECOND:return this.getHeroesModuleSecondPart(t)}},_checkResIsExist:function(t,e){for(var i=!1,n=0,a=t.length;n<a;n++){t[n]===e&&(i=!0)}return i}},cc._RF.pop()},{"../../../../TS/Hero/Manager/HeroManager":"HeroManager"}],MoneyPennyItem:[function(t,e,i){"use strict";cc._RF.push(e,"361a4TKYRxMKoo6MpJ8V6g9","MoneyPennyItem");var n=cc.Class({extends:cc.Component,properties:{labCount:cc.Label,imgIcon:cc.Node,redPoint:cc.Node,mask:cc.Node,img:cc.Node},start:function(){},setCount:function(t){this.labCount.getComponent(cc.Label).string="X"+t},updateItem:function(t){},clickGoto:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_MoneyPenny)}});e.exports=n,cc._RF.pop()},{}],MoneyPennyWindow:[function(t,e,i){"use strict";cc._RF.push(e,"29a9fEaHdVDtpv4mnxW1CK7","MoneyPennyWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{_controller:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_MoneyPenny},onLoad:function(){this._super(),this._controller=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MoneyPenny)},_addEventListener:function(){var t=td.EventUtil,e={};e[td.EventNameEnum.REFRESH_RECEIVE_DIAMOND]=this._initUi,t.registerEvents(e,this)},onEnable:function(){this._super(),this._addEventListener(),this._initUi(),this.setBgOpacity(217),td.GlobalFunction.setLocalSaveStatus("MoneyPennyRedPoint",!0),td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_MONEYPENNY)},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_initUi:function(){var t=td.GetConfig("SAVE_MAX_DIAMOND"),e=this.node.getChildByName("labNum"),i=this.node.getChildByName("btnActive"),n=this.node.getChildByName("btnGet"),a=this.node.getChildByName("labPro"),r=td.Account.getUserData(),o=r.getTotalSaveDiamond(),s=r.getCurrentSaveDiamond();r.getVip();e.getComponent(cc.Label).string=s,a.getComponent(cc.Label).string=o+"/"+t;var l=td.UnlockManager.isTargetUnlock(td.ActorUnlockType.SAVE_DIAMOND,0);i.active=!l,n.active=!!l,td.RedPointUtil.createRedPointSimple(n,{x:-25,y:-20},s>0),td.RedPointUtil.createRedPointSimple(i,{x:-25,y:-20},!l)},btnGet:function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.SAVE_DIAMOND,0,!0)){var t=td.GetConfig("SAVE_MAX_DIAMOND"),e=td.Account.getUserData(),i=e.getTotalSaveDiamond(),n=e.getCurrentSaveDiamond();if(i>=t){var a=new td.BroadcastContent(292);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a)}else if(n<=0){a=new td.BroadcastContent(210);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a)}else td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECEIVE_DIAMOND)}},gotoActive:function(){td.GlobalFunction.gotoRecharge()},clickBgListener:function(){this.closeCallFunc()}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],MonopolyBuyDiceWindow:[function(t,e,i){"use strict";cc._RF.push(e,"e4fa3P7YIZGi6bj6+1EBnXt","MonopolyBuyDiceWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeCostIcon=null,e.nodeGoods=null,e.labCostNum=null,e.labGoodsNum=null,e.labHasBuy=null,e.labTip=null,e._controller=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_MonopolyBuy},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Monopoly)},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){r.EventNameEnum;r.EventUtil.registerEvents({},this)},e.prototype.setData=function(){this.labScore.string="";var t=this.nodeReward.getComponent(d),e=this._controller.getExchangeCfgList();t.refreshListData(e)},e.prototype.onBtnOnceClick=function(){this.closeCallFunc()},e.prototype.onBtnTenClick=function(){},a([l(cc.Node)],e.prototype,"nodeCostIcon",void 0),a([l(cc.Node)],e.prototype,"nodeGoods",void 0),a([l(cc.Label)],e.prototype,"labCostNum",void 0),a([l(cc.Label)],e.prototype,"labGoodsNum",void 0),a([l(cc.Label)],e.prototype,"labHasBuy",void 0),a([l(cc.Label)],e.prototype,"labTip",void 0),e=a([s,c("module/Activity/MonopolyBuyDiceWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],MonopolyController:[function(t,e,i){"use strict";cc._RF.push(e,"f8afeHw1TREOK9iTZ/uixCC","MonopolyController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("./MonopolyEnum"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataID=1001,e._circle=0,e._point=0,e._lastPoint=0,e._score=0,e._storeMap={},e._receiveList=[],e._currencyId=0,e._scoreItemId=0,e._diceNum=0,e._dailySendDice=0,e._singleCostNum=0,e._isPanelOpened=!1,e._isJumpToRecharge=!1,e}return n(e,t),e.prototype.initData=function(e){this.clearData(),t.prototype.initData.call(this,e);var i=td.GetConfig("MONOPOLY_GOODS_ID_LIST")||[];this._currencyId=i[0],this._scoreItemId=i[1];var n=td.GetConfig("MONOPOLY_REWARD")||[];this._dailySendDice=n[0][2];var a=td.GetConfig("MONOPOLY_COST")||[];this._singleCostNum=a[0][2],this._dataID=this.getActivityData(),this.addEventListener()},e.prototype.clearData=function(){this._dataId=0},e.prototype.addEventListener=function(){td.EventNameEnum;td.EventUtil.registerEvents({},this)},e.prototype.activityParse=function(t){var e=t.record;t.global;if(this._circle=e.circle,this._lastPoint=this._point,this._point=e.point,this._point!=this._lastPoint){var i=this._point-this._lastPoint;i<0&&(i+=this.getMaxPoint()),td.EventUtil.dispatchEvent(td.EventNameEnum.MONOPOLY_RUN_DICE,i)}this._storeMap=e.storeMap,this._receiveList=e.receiveList,td.EventUtil.dispatchEvent(td.EventNameEnum.MONOPOLY_INFO_CHANGE)},e.prototype.setJumpToRecharge=function(){this._isJumpToRecharge=!0},e.prototype.isFromRecharge=function(){var t=this._isJumpToRecharge;return this._isJumpToRecharge=!1,t},e.prototype.getImgAdsName=function(){return this.getAllPointsCfg()[0].bannerPic},e.prototype.getAllPointsCfg=function(){var t=td.GetTableClass(td.TableEnum.MonopolyTable);return null==t?[]:t.getAllCfgByDataId(this._dataID)},e.prototype.getPointCfgByPoint=function(t){var e=td.GetTableClass(td.TableEnum.MonopolyTable);return null==e?null:e.getPointCfgByDataIdAndId(this._dataID,t)},e.prototype.getExchangeCfgList=function(){var t=td.GetTableClass(td.TableEnum.MonopolyStoreTable);return null==t?[]:t.getAllCfgByDataId(this._dataID)},e.prototype.getProgressCfgList=function(){var t=td.GetTableClass(td.TableEnum.MonopolyProgressTable);return null==t?[]:t.getAllCfgByDataId(this._dataID)},e.prototype.getMaxPoint=function(){var t=td.GetTableClass(td.TableEnum.MonopolyTable);return null==t?0:t.getMaxPoint(this._dataID)},e.prototype.getTaskList=function(){var t=[],e=td.TaskManager.getShowListByType(td.TaskType.ACTIVITY_TYPE_42,[td.TaskStatus.UNOPENED,td.TaskStatus.NONE]);return t=t.concat(e.sort(this._sortTaskList))},e.prototype._sortTaskList=function(t,e){if(t.getStatus()!=e.getStatus()){if(3===t.getStatus())return-1;if(3===e.getStatus())return 1;if(4===t.getStatus())return 1;if(4===e.getStatus())return-1}return t.getId()-e.getId()},e.prototype.getCurrencyId=function(){return this._currencyId},e.prototype.getScoreItemId=function(){return this._scoreItemId},e.prototype.getPoint=function(){return this._point},e.prototype.getCircle=function(){return this._circle},e.prototype.getDailySendDice=function(){return this._dailySendDice},e.prototype.getLeftExchangeTimes=function(t){return this._storeMap[t]||0},e.prototype.isProgressReceived=function(t){return-1!=this._receiveList.indexOf(t)},e.prototype.isProgressReached=function(t){return this._circle>=t},e.prototype.getRechargedList=function(){return this._rechargedList},e.prototype.getScore=function(){return this._score=td.ItemManager.getItemNumById(this._scoreItemId),this._score},e.prototype.getDiceNum=function(){return this._currencyId?(this._diceNum=td.ItemManager.getItemNumById(this._currencyId),this._diceNum):(this._diceNum=0,0)},e.prototype.isNextRewardsDouble=function(t){var e=this.getPointCfgByPoint(t);return null!=e&&e.rewardIcon==a.IconResType.NextRewardTimes},e.prototype.onOpenPanel=function(){this._isPanelOpened=!0,td.GlobalFunction.setLocalSaveStatus("MonopolyPanel","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.MONOPOLY_PANEL_SHOW)},e.prototype.hasRedPoint=function(){return!0},e.prototype.isLoginTodayShow=function(){return!td.GlobalFunction.getLocalSaveStatus("MonopolyPanel")},e.prototype.isHaveRewardsToGet=function(){for(var t=this.getProgressCfgList(),e=0;e<t.length;e++){var i=t[e];if(-1==this._receiveList.indexOf(i.circle)&&this._circle>=i.circle)return!0}return!1},e.prototype.isHaveTaskToFinish=function(){for(var t=td.TaskManager.getShowListByType(td.TaskType.ACTIVITY_TYPE_42,[td.TaskStatus.UNOPENED,td.TaskStatus.NONE]),e=0;e<t.length;e++)if(t[e].getStatus()===td.TaskStatus.Finish)return!0;return!1},e.prototype.isDiceNumLarge=function(){return this.getDiceNum()>this.getDailySendDice()},e.prototype.isRedPointTip=function(){return this.isLoginTodayShow()||this.isHaveRewardsToGet()||this.isHaveTaskToFinish()||this.isDiceNumLarge()},e.prototype.redPointEvts=function(){return[td.EventNameEnum.MONOPOLY_PANEL_SHOW,td.EventNameEnum.MONOPOLY_INFO_CHANGE,td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,td.EventNameEnum.Res_GET_TASK_INFO]},e}(t("ActivityBaseController"));i.default=r,e.exports=r,cc._RF.pop()},{"./MonopolyEnum":"MonopolyEnum",ActivityBaseController:"ActivityBaseController"}],MonopolyEnum:[function(t,e,i){"use strict";cc._RF.push(e,"18eddLNGbxGr5TtKRmCGtbF","MonopolyEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.IconResType=i.ItemCfgType=void 0,function(t){t[t.Item=1]="Item",t[t.Score=2]="Score",t[t.NextRewardTimes=3]="NextRewardTimes"}(i.ItemCfgType||(i.ItemCfgType={})),function(t){t[t.StartPoint=1]="StartPoint",t[t.ScorePoint=2]="ScorePoint",t[t.Diamond=3]="Diamond",t[t.RandomBag=4]="RandomBag",t[t.NextRewardTimes=5]="NextRewardTimes"}(i.IconResType||(i.IconResType={})),cc._RF.pop()},{}],MonopolyExchangeItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"3eadbqlYDJFjrUBysBZ0ia9","MonopolyExchangeItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labItemName=null,e.labItemDesc=null,e.labLeftTimes=null,e.labCost=null,e.imgCostIcon=null,e.nodeItem=null,e.btnExchange=null,e.imgExchanged=null,e._controller=null,e._goodId=0,e._cfgData=null,e._costItem=null,e._goodItem=null,e._index=0,e}return n(e,t),e.prototype.onEnable=function(){this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Monopoly)},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._cfgData=i,this._index=e;var n=i.limitCount-this._controller.getLeftExchangeTimes(i.id);i.limitCount>=999999?(this.labLeftTimes.node.active=!1,this._cfgData.leftTimes=99):(this.labLeftTimes.node.active=!0,this._cfgData.leftTimes=n),this.labLeftTimes.string="("+cc.js.formatStr(r.Language.exchangeGoodsTimes,n)+")",this.btnExchange.active=n>0,this.imgExchanged.active=n<=0;var a=r.RewardManager.getRewardDetailArray(i.costs)[0];this.labCost.string=a.getCount(),this._costItem=a;var o=r.RewardManager.getRewardDetailArray(i.rewards)[0];this._goodItem=o,this._goodId=o.getId(),this.labItemName.string=this._goodItem.getName(),r.GlobalFunction.setNameColors(this.labItemName.node,o.getQuality());var s=this.nodeItem.getChildByName("icon");s||(s=r.GlobalFunction.createCommonIconWidget(26,o),this.nodeItem.addChild(s)),s.getComponent("CommonIconWidget").setData(o),o.getDes&&(this.labItemDesc.string=o.getDes()),o.getDesc&&(this.labItemDesc.string=o.getDesc())},e.prototype.onBtnExchangeClick=function(){if(null!=this._controller){var t={};t.okCallFunc=this.onSendExchangeRequest.bind(this),t.consumeModel=this._costItem,t.buyProductModel=this._goodItem,t.maxNum=this._cfgData.leftTimes,t.singlePrice=this._costItem.getCount(),t.windowTitle=r.Language.exchange,t.btnTitle=r.Language.exchange,t.isNoItem=!1,t.showNumNode=!1,r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_ActivityBuy,t)}},e.prototype.onSendExchangeRequest=function(t){if(this._controller){var e={id:this._cfgData.id};e.parmeterMap={42:3,6:t},this._controller.operateActivity(e),r.EventUtil.dispatchEvent(r.EventNameEnum.MONOPOLY_CUR_SELECT_INDEX,this._index)}},a([c(cc.Label)],e.prototype,"labItemName",void 0),a([c(cc.Label)],e.prototype,"labItemDesc",void 0),a([c(cc.Label)],e.prototype,"labLeftTimes",void 0),a([c(cc.Label)],e.prototype,"labCost",void 0),a([c(cc.Node)],e.prototype,"imgCostIcon",void 0),a([c(cc.Node)],e.prototype,"nodeItem",void 0),a([c(cc.Node)],e.prototype,"btnExchange",void 0),a([c(cc.Node)],e.prototype,"imgExchanged",void 0),e=a([l,u("module/Activity/MonopolyExchangeItemUI")],e)}(o);i.default=d,cc._RF.pop()},{ListItem:void 0}],MonopolyExchangeWindow:[function(t,e,i){"use strict";cc._RF.push(e,"5d5bavBnChLir5xOAaFB5Tb","MonopolyExchangeWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labCoin=null,e.imgCoin=null,e._controller=null,e._isInit=!1,e._index=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_MonopolyExchange},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Monopoly),this._refreshView()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this._index=0,r.EventUtil.dispatchEvent(r.EventNameEnum.MONOPOLY_WINDOW_CLOSE)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this._refreshView,t[e.MONOPOLY_CUR_SELECT_INDEX]=this._curSelectIndex,r.EventUtil.registerEvents(t,this)},e.prototype._curSelectIndex=function(t){this._index=t},e.prototype._showRewards=function(t){if(t.activityId===this._controller.getActivityId()){var e=t.rewardResult,i=r.RewardManager.parseRewardResult(e,!0);r.GlobalFunction.showRewards(i)}},e.prototype._refreshView=function(t){if(t&&this._showRewards(t),null!=this._controller){this.labCoin.string=this._controller.getScore()+"";var e=this.node.getComponent(d),i=this._controller.getExchangeCfgList();this._isInit?e.refreshCurList(i):e.refreshListData(i),e.scrollToRow(this._index)}},a([l(cc.Label)],e.prototype,"labCoin",void 0),a([l(cc.Node)],e.prototype,"imgCoin",void 0),e=a([s,c("module/Activity/MonopolyExchangeWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],MonopolyPanel:[function(t,e,i){"use strict";cc._RF.push(e,"feccc6yAoVNR7kl46SgO1tg","MonopolyPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./MonopolyEnum"),o=window.td,s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=t("ItemModel"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgAdd=null,e.labActivityTime=null,e.labScore=null,e.labCurDice=null,e.nodeIcon=null,e.nodeBetModel=null,e.nodeBets=null,e.imgSelect=null,e.imgDice=null,e.labTips=null,e.imgDoubleTip=null,e.nodeDiceAni=null,e.nodeLightAni=null,e.btnAutoBet=null,e.btnGet=null,e.btnProgress=null,e.btnManyRoll=null,e._activityCotr=null,e._posList=[],e._curIndex=0,e._isAutoRoll=!1,e._isPlayingAni=!1,e._betRewards=[],e._curDicePoint=1,e._posCfgList=[cc.v2(-297,35),cc.v2(-178,35),cc.v2(-178,165),cc.v2(-60,165),cc.v2(58,165),cc.v2(178,165),cc.v2(178,35),cc.v2(297,35),cc.v2(297,-94),cc.v2(297,-222),cc.v2(178,-222),cc.v2(58,-222),cc.v2(-60,-222),cc.v2(-178,-222),cc.v2(-297,-222),cc.v2(-297,-94)],e._isWaitResponse=!1,e._isPlayingScoreAni=!1,e._recordAutoBet=!1,e._curRecordScores=[],e}return n(e,t),e.prototype.init=function(){this._panelType=o.PanelType.Panel,this._panelEnum=o.PanelEnum.Panel_Monopoly},e.prototype.onEnable=function(){if(t.prototype.onEnable.call(this),this._activityCotr=o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.Monopoly),this._addEventListener(),this._activityCotr){this._activityCotr.isFromRecharge()&&this.onBtnGetClick(),this._activityCotr.onOpenPanel(),o.RedPointUtil.createRedPointOld(this.btnGet,cc.v2(-30,-15),this._activityCotr.isHaveTaskToFinish.bind(this._activityCotr),[o.EventNameEnum.Res_GET_TASK_INFO]),o.RedPointUtil.createRedPointOld(this.btnProgress,cc.v2(-30,-15),this._activityCotr.isHaveRewardsToGet.bind(this._activityCotr),[o.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]);var e=cc.js.formatStr(o.Language.MonopolyResetTip2,"0:00",this._activityCotr.getDailySendDice());this.labTips.string=o.GlobalFunction.transCfgHoursToZoneHours(e);var i=this._activityCotr.getImgAdsName();i&&o.GlobalFunction.createAltasSprite(o.resDef.pngPlist.Acitivty_47_sjfw,i,this.imgAdd),this._refreshUI()}},e.prototype.onDisable=function(){o.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this._isPlayingAni=!1,this._isAutoRoll=!1,this._betRewards=[],this._isWaitResponse=!1,this._isPlayingScoreAni=!1,this._curRecordScores=[],this._autoBetClose(),this.unschedule(this._rewardPanelAutoClose),this.nodeDiceAni.getComponent(cc.Animation).off("finished",this._onDiceAniFinish,this),this._stopAllAction()},e.prototype._addEventListener=function(){var t={},e=o.EventNameEnum;t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this._refreshLabs,t[e.MONOPOLY_RUN_DICE]=this.playDiceAni,t[e.Res_GET_TASK_INFO]=this._refreshLabs,t[e.ITEM_CHANGE]=this._refreshLabs,t[e.MONOPOLY_WINDOW_CLOSE]=this.onOtherWindowClose,o.EventUtil.registerEvents(t,this)},e.prototype.onReceiveOperation=function(t){if(t.activityId===this._activityId){var e=t.rewardResult,i=o.RewardManager.parseRewardResult(e,!0);this._dontPlay?o.GlobalFunction.showRewards(i,!1):this._betRewards=i}},e.prototype._refreshUI=function(){this._betRewards=[],this.labActivityTime.string=this.getDurationStr(),this._refreshLabs(),this._curIndex=this._activityCotr.getPoint()-1,this.imgDoubleTip.active=this._activityCotr.isNextRewardsDouble(this._activityCotr.getPoint()),this._refreshBets()},e.prototype._refreshLabs=function(){this.labCurDice.string=this._activityCotr.getDiceNum()+"",this._isPlayingAni||this._isWaitResponse||this._isPlayingScoreAni||(this.labScore.string=this._activityCotr.getScore()+"")},e.prototype._refreshScore=function(){this.labScore.string=this._curRecordScores.shift()+""},e.prototype._refreshBets=function(){for(var t=this._activityCotr.getAllPointsCfg(),e=0;e<t.length;e++){var i=t[e],n=i.id,a=this.nodeBets.getChildByName("betNode"+(n-1));a||(a=this._createBetNode(n-1)),this._refreshBetNode(a,i)}var r=this._posCfgList[this._curIndex];this.nodeIcon.position=cc.v2(r.x,r.y+80),this.imgSelect.position=cc.v2(r.x,r.y+5),this.imgSelect.active=!0},e.prototype._createBetNode=function(t){var e=cc.instantiate(this.nodeBetModel);return this.nodeBets.addChild(e,-1),e.name="betNode"+t,e.position=this._posCfgList[t],e.active=!0,e},e.prototype._refreshBetNode=function(t,e){if(null!=t){var i=t.getChildByName("imgBg"),n=t.getChildByName("nodeIcon"),a=t.getChildByName("labNum").getComponent(cc.Label),s=e.monopolyReward,l=e.backQuality,c=e.rewardIcon;if(o.GlobalFunction.createAltasSprite(o.resDef.pngPlist.Acitivty_47_sjfw,"HD_sjfw_wpk0"+l,i),c==r.IconResType.StartPoint){a.node.active=!1;var u=this._activityCotr.getCurrencyId();if(d=o.GetTableClass(o.TableEnum.Item).getItemById(u))(h=new o.Item).init(d),t.itemData=h;o.GlobalFunction.createAltasSprite(o.resDef.pngPlist.Acitivty_47_sjfw,"HD_sjfw_zi01",n)}else if(c==r.IconResType.ScorePoint||c==r.IconResType.Diamond){var d,h;if(d=o.GetTableClass(o.TableEnum.Item).getItemById(s[0][0][0][1]))(h=new o.Item).init(d),t.itemData=h,o.GlobalFunction.createAltasSprite(o.resDef.pngPlist.icon_item,h.getIconRes(),n);var p=s[0][0][0][2];a.node.active=p>0,a.string="x"+p}else c==r.IconResType.RandomBag?(o.GlobalFunction.createAltasSprite(o.resDef.pngPlist.icon_item,"27005",n),a.node.active=!1,t.tips=o.Language.MonopolyTip2):c==r.IconResType.NextRewardTimes?(a.node.active=!1,t.tips=o.Language.MonopolyTip1,o.GlobalFunction.createAltasSprite(o.resDef.pngPlist.Acitivty_47_sjfw,"HD_sjfw_zi02",n)):(a.node.active=!1,t.tips="null")}},e.prototype.playDiceAni=function(t){if(!(t<=0||this._isPlayingAni))if(this._isWaitResponse=!1,this._curDicePoint=Math.floor(t),this._isPlayingAni=!0,this.nodeDiceAni)if(this._dontPlay){this._isPlayingAni=!1,this._curIndex=this._curIndex+Number(this._curDicePoint)-1,this._curIndex=this._curIndex%this._posCfgList.length;var e=this._posCfgList[this._curIndex];this.imgSelect.position=cc.v2(e.x,e.y+5),this._refreshUI()}else{var i=this.nodeDiceAni.getComponent(cc.Animation);i.on("finished",this._onDiceAniFinish,this),i.play("TouZiDongHua_"+this._curDicePoint)}else{var n=o.GlobalFunction.getResIdByNode(this.node);gdk.rm.loadRes(n,"uiAnima/TouZiDongHua/TouZiDongHua",cc.Prefab,this._addDiceEffect.bind(this,this.imgDice))}},e.prototype._addDiceEffect=function(t){if(null!=t){if(!this.nodeDiceAni){var e=gdk.rm.getResByUrl("uiAnima/TouZiDongHua/TouZiDongHua",cc.Prefab);this.nodeDiceAni=cc.instantiate(e),this.nodeDiceAni.name="TouZiDongHua_1",t.addChild(this.nodeDiceAni,-1)}if(this._dontPlay){this._isPlayingAni=!1,this._curIndex=this._curIndex+Number(this._curDicePoint)-1,this._curIndex=this._curIndex%this._posCfgList.length;var i=this._posCfgList[this._curIndex];this.imgSelect.position=cc.v2(i.x,i.y+5),this._refreshUI()}else{var n=this.nodeDiceAni.getComponent(cc.Animation);n.on("finished",this._onDiceAniFinish,this),n.play("TouZiDongHua_"+this._curDicePoint)}}},e.prototype._onDiceAniFinish=function(){this._playMoveAction()},e.prototype._getMovePos=function(){var t=this._curIndex;this._curIndex=t;for(var e=t+this._curDicePoint,i=[],n=t+1;n<=e;n++){var a=n%this._posCfgList.length,r=this._posCfgList[a];i.push(r)}return i},e.prototype._playMoveAction=function(){this._posList=this._getMovePos(),this._doMove(this.nodeIcon,this._posList.shift()),this._curIndex++,this._curIndex=this._curIndex%this._posCfgList.length},e.prototype._stopAllAction=function(){this._posList=[],this.nodeIcon.stopAllActions(),this.nodeLightAni.active=!1,this.nodeLightAni.stopAllActions()},e.prototype._doMove=function(t,e){if(null!=t&&null!=e){var i=cc.sequence(cc.moveTo(.3,cc.v2(e.x,e.y+80)),cc.delayTime(.07),cc.callFunc(this._onMoveCb.bind(this)));t.runAction(i)}},e.prototype._onMoveCb=function(){if(this._posList&&this._posList.length>0)this._doMove(this.nodeIcon,this._posList.shift()),this._curIndex++,this._curIndex=this._curIndex%this._posCfgList.length;else{this._isPlayingAni=!1;var t=this._posCfgList[this._curIndex];if(this.imgSelect.position=cc.v2(t.x,t.y+5),this._showReward(),this._refreshUI(),this._isAutoRoll)this._activityCotr.getDiceNum()>0?this.onBtnRollClick():this._autoBetClose()}},e.prototype._showReward=function(){var t=this._activityCotr.getPoint(),e=this._activityCotr.getPointCfgByPoint(t);e.rewardIcon==r.IconResType.ScorePoint?(this.imgDoubleTip.active=!1,this._isPlayingScoreAni=!0,this._curRecordScores.push(this._activityCotr.getScore()),this._showScoreMove()):e.rewardIcon==r.IconResType.NextRewardTimes?(this.imgDoubleTip.active=!0,o.MessageBox.showMessage(o.Language.MonopolyTip1)):(this.imgDoubleTip.active=!1,this._betRewards&&this._betRewards.length>0&&(this._isAutoRoll?(o.GlobalFunction.showRewards(this._betRewards,null,null,this.onBtnAutoRollClick.bind(this)),this._autoBetClose(),this.unschedule(this._rewardPanelAutoClose),this.scheduleOnce(this._rewardPanelAutoClose,1)):o.GlobalFunction.showRewards(this._betRewards)))},e.prototype._rewardPanelAutoClose=function(){var t=o.PanelManager.getInstance().getCurShowNoneLayer();t&&"getRewardWindow"==t.node.name&&t.closeCallFunc()},e.prototype._showScoreMove=function(){this.nodeLightAni.getChildByName("nodeIcon");this._playScoreAni()},e.prototype._playScoreAni=function(){this.nodeLightAni.stopAllActions(),this.nodeLightAni.active=!0;var t=this._posCfgList[this._curIndex];this.nodeLightAni.position=t;var e=cc.v2(285,275),i=t.sub(e).mag()/1e3,n=cc.sequence(cc.moveTo(i,e),cc.callFunc(this._onScoreMoveCb.bind(this,this.nodeLightAni)));this.nodeLightAni.runAction(n)},e.prototype._onScoreMoveCb=function(t){t&&(t.active=!1),this._isPlayingScoreAni=!1,this.labScore.node.stopAllActions(),this.labScore.node.scale=1;var e=cc.sequence(cc.scaleTo(.2,1.5),cc.callFunc(this._refreshScore.bind(this)),cc.delayTime(.05),cc.scaleTo(.2,1));this.labScore.node.runAction(e)},e.prototype._showAutoBetAni=function(){var t=this.btnAutoBet.getChildByName("autoBetAni");if(o.GlobalFunction.setButtonGray(this.btnManyRoll,!0),t)t.active=!0;else{var e=o.GlobalFunction.getResIdByNode(this.node);gdk.rm.loadRes(e,"uiAnima/XianWei_jingsheng/XianWei_ui",cc.Prefab,this._addAutoBetAni.bind(this,this.btnAutoBet))}},e.prototype._addAutoBetAni=function(t){var e=null;if(!e){var i=gdk.rm.getResByUrl("uiAnima/XianWei_jingsheng/XianWei_ui",cc.Prefab);(e=cc.instantiate(i)).name="autoBetAni",t.addChild(e,-1),e.scale=.8,e.y=1}e.getComponent(cc.Animation).play(),e.active=!0},e.prototype._autoBetClose=function(){this._isAutoRoll=!1;var t=this.btnAutoBet.getChildByName("autoBetAni");t&&(t.active=!1),o.GlobalFunction.setButtonGray(this.btnManyRoll,!1)},e.prototype.onClickBetIcon=function(t){var e=t.target,i=e.itemData;if(i)o.ItemUtil.showItemInfo(i);else{var n=e.tips;n&&o.MessageBox.showMessage(n)}},e.prototype.onBtnProgressClick=function(){this._recordAutoBet=this._isAutoRoll,this._autoBetClose(),o.PanelJumpManager.jumpToPanel(o.PanelEnum.Window_MonopolyProgress)},e.prototype.onBtnExchangeClick=function(){this._recordAutoBet=this._isAutoRoll,this._autoBetClose(),o.PanelJumpManager.jumpToPanel(o.PanelEnum.Window_MonopolyExchange)},e.prototype.onBtnGetClick=function(){o.PanelJumpManager.jumpToPanel(o.PanelEnum.Window_CommonTask,{activityType:this._activityType,isTaskCfg:!0,title:o.Language.MonopolyTaskTitle})},e.prototype.onBtnRollClick=function(){if(!this._isPlayingAni){if(this._isWaitResponse=!0,this._activityCotr.getDiceNum()<=0){var t=new o.BroadcastContent(201);return o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_BROADCAST,t),void this.onBtnGetClick()}this._dontPlay=!1;var e={parmeterMap:{6:1,42:1}};this._activityCotr.operateActivity(e)}},e.prototype._goRequest=function(t){var e={};t>1&&(this._dontPlay=!0),e.parmeterMap={6:t,42:1},this._activityCotr.operateActivity(e)},e.prototype.onBtnAutoRollClick=function(){if(!this._isPlayingAni&&!this._isAutoRoll){var t=this._activityCotr.getDiceNum();if(t<=0)return o.GlobalFunction.showBroadcastTip(201),void this.onBtnGetClick();var e=o.GetTableClass(o.TableEnum.Item).getItemById(this._activityCotr.getCurrencyId()),i=new d;i.init(e),i.setCount(1);var n={};n.okCallFunc=this._goRequest.bind(this),n.buyCost1=i,n.buyCost2=null,n.maxNum=t,n.titleStr=o.Language.Monopoly_Txt_1,o.PanelJumpManager.jumpToPanel(o.PanelEnum.Window_TurnTableQuickExact,n)}},e.prototype.onBtnRollManyTimes=function(){if(!this._isPlayingAni&&!this._isAutoRoll){if(this._activityCotr.getDiceNum()<50){var t=new o.BroadcastContent(201);return o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_BROADCAST,t),void this.onBtnGetClick()}this._dontPlay=!0;var e={parmeterMap:{6:50,42:1}};this._activityCotr.operateActivity(e)}},e.prototype.onOtherWindowClose=function(){this._recordAutoBet&&this.onBtnAutoRollClick()},a([c(cc.Node)],e.prototype,"imgAdd",void 0),a([c(cc.Label)],e.prototype,"labActivityTime",void 0),a([c(cc.Label)],e.prototype,"labScore",void 0),a([c(cc.Label)],e.prototype,"labCurDice",void 0),a([c(cc.Node)],e.prototype,"nodeIcon",void 0),a([c(cc.Node)],e.prototype,"nodeBetModel",void 0),a([c(cc.Node)],e.prototype,"nodeBets",void 0),a([c(cc.Node)],e.prototype,"imgSelect",void 0),a([c(cc.Node)],e.prototype,"imgDice",void 0),a([c(cc.Label)],e.prototype,"labTips",void 0),a([c(cc.Node)],e.prototype,"imgDoubleTip",void 0),a([c(cc.Node)],e.prototype,"nodeDiceAni",void 0),a([c(cc.Node)],e.prototype,"nodeLightAni",void 0),a([c(cc.Node)],e.prototype,"btnAutoBet",void 0),a([c(cc.Node)],e.prototype,"btnGet",void 0),a([c(cc.Node)],e.prototype,"btnProgress",void 0),a([c(cc.Node)],e.prototype,"btnManyRoll",void 0),e=a([l,u("module/Activity/MonopolyPanel")],e)}(t("ActivityBasePanel"));i.default=h,cc._RF.pop()},{"./MonopolyEnum":"MonopolyEnum",ActivityBasePanel:"ActivityBasePanel",ItemModel:"ItemModel"}],MonopolyProgressItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"9a3edqGzyJKiqfy6PAJHXSB","MonopolyProgressItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeItem=null,e.labDesc=null,e.progress=null,e.labProgress=null,e.btnReceive=null,e.imgReceived=null,e.imgUnreach=null,e._controller=null,e._itemData=null,e._circle=0,e}return n(e,t),e.prototype.onEnable=function(){this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Monopoly)},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._circle=i.circle,this.labDesc.string=cc.js.formatStr(r.Language.MonopolyExchangeTxt,i.circle);var n=r.RewardManager.getRewardDetailArray(i.rewards)[0],a=this.nodeItem.getChildByName("icon");a||(a=r.GlobalFunction.createCommonIconWidget(26,n),this.nodeItem.addChild(a)),a.getComponent("CommonIconWidget").setData(n);var o=this._controller.getCircle(),s=this._controller.isProgressReceived(this._circle),l=this._controller.isProgressReached(this._circle);this.imgReceived.active=s,this.btnReceive.active=!s,this.imgUnreach.active=!s,s||(this.imgUnreach.active=!l,this.btnReceive.active=l),o>this._circle&&(o=this._circle),this.labProgress.string=o+"/"+this._circle,this.progress.progress=o/this._circle},e.prototype.onBtnReceiveClick=function(){if(null!=this._controller){var t={id:this._circle,parmeterMap:{42:2}};this._controller.operateActivity(t)}},a([c(cc.Node)],e.prototype,"nodeItem",void 0),a([c(cc.Label)],e.prototype,"labDesc",void 0),a([c(cc.ProgressBar)],e.prototype,"progress",void 0),a([c(cc.Label)],e.prototype,"labProgress",void 0),a([c(cc.Node)],e.prototype,"btnReceive",void 0),a([c(cc.Node)],e.prototype,"imgReceived",void 0),a([c(cc.Node)],e.prototype,"imgUnreach",void 0),e=a([l,u("module/Activity/MonopolyProgressItemUI")],e)}(o);i.default=d,cc._RF.pop()},{ListItem:void 0}],MonopolyProgressTable:[function(t,e,i){"use strict";cc._RF.push(e,"c80468RS1RNSLh3x5bjUXvv","MonopolyProgressTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MonopolyProgressTable",e._tblName="monopoly_progress_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r].push(a)}},e.prototype.getAllCfgByDataId=function(t){if(null==this._data)return[];var e=this._data[t];return e.sort(function(t,e){return t.circle-e.circle}),e},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MonopolyProgressWindow:[function(t,e,i){"use strict";cc._RF.push(e,"0ac09xuH7xOHaN41pGQEl3j","MonopolyProgressWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labCircles=null,e._controller=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_MonopolyProgress},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.Monopoly),this._refreshView()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),r.EventUtil.dispatchEvent(r.EventNameEnum.MONOPOLY_WINDOW_CLOSE)},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]=this._refreshView,r.EventUtil.registerEvents(t,this)},e.prototype._showRewards=function(t){if(t.activityId===this._controller.getActivityId()){var e=t.rewardResult,i=r.RewardManager.parseRewardResult(e,!0);r.GlobalFunction.showRewards(i)}},e.prototype._refreshView=function(t){if(t&&this._showRewards(t),null!=this._controller){this.labCircles.string=""+this._controller.getCircle();for(var e=this.node.getComponent(d),i=this._controller.getProgressCfgList().slice(0),n=[],a=i.length-1;a>=0;a--){var r=i[a];this._controller.isProgressReceived(r.circle)&&(i.splice(a,1),n.push(r))}i=i.concat(n.reverse()),e.setData(i)}},a([l(cc.Label)],e.prototype,"labCircles",void 0),e=a([s,c("module/Activity/MonopolyProgressWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],MonopolyStoreTable:[function(t,e,i){"use strict";cc._RF.push(e,"f21d5MFrLhAQrVvtvCFFVWg","MonopolyStoreTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MonopolyStoreTable",e._tblName="monopoly_store_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r].push(a)}},e.prototype.getAllCfgByDataId=function(t){return null==this._data?[]:this._data[t]},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MonopolyTable:[function(t,e,i){"use strict";cc._RF.push(e,"cf613mqIqhLiIdbVgPX9W1o","MonopolyTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="MonopolyTable",e._tblName="activity_monopoly_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r].push(a)}},e.prototype.getAllCfgByDataId=function(t){if(null==this._data)return[];var e=this._data[t];return e.sort(function(t,e){return t.id-e.id}),e},e.prototype.getMaxPoint=function(t){return null==this._data?0:this._data[t].length},e.prototype.getPointCfgByDataIdAndId=function(t,e){if(null==this._data)return null;for(var i=this._data[t],n=0;n<i.length;n++){var a=i[n];if(a.id==e)return a}return null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MonsterCapabilityConfig:[function(t,e,i){"use strict";cc._RF.push(e,"a02cbs/4BJPxb22eXerkgw9","MonsterCapabilityConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"MonsterCapabilityConfig",properties:{_tblName:"monster_capability_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.capabilityId]=a}},getMonsterCapabilityConfig:function(){return this._data},getMonsterNumberDataById:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MonsterChangeTowerSpeed:[function(t,e,i){"use strict";cc._RF.push(e,"b5f7eIQ2ptN3awd3Ay5Xjj+","MonsterChangeTowerSpeed");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_bShowBuff:null},initData:function(t){if(this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.TowerSpeedChange,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff){var e=this.node.getChildByName("MCTSBuff");if(!e){var i=gdk.rm.getResByUrl("fightRes/pve/buff/buffPrefab",cc.Prefab);e=cc.instantiate(i),this.node.addChild(e),e.y=20,e.name="MCTSBuff"}this._buffAnimation=e.getComponent(cc.Animation),this._clipName="freezeAnimation"}},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._curSpeedMult=a.getCurFightSpeedMult(),this._bShowBuff&&this._buffAnimation.play(this._clipName),this.setTargetBuffData(!0)):this.removeSelf()},update:function(t){if(this._super(t),!this._bFightPause)return this._curBuffData.buffTime<=0?(this.setTargetBuffData(!1),void this.endBuff()):void(this._curBuffData.buffTime-=t*this._curSpeedMult)},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_HERO_SCRIPT[e]),n=this._curBuffData.buffData+1,a=t?n:1;i.setMonsterEffctSpeedRate(a)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],MonsterFightModel:[function(t,e,i){"use strict";cc._RF.push(e,"f2309VDecBF+7w3Diw8rL17","MonsterFightModel");var n=t("Model");td.MonsterFightModel=cc.Class({extends:n,properties:{_baseModel:null,_camp:null,_pos:null,_hp:null,_maxHp:null,_rage:null,_maxRage:null,_curCamp:null},init:function(t){if(t){var e=t.attributes,i=e[td.SpriteKey.ConfigId];this._baseModel=new td.MonsterModel,this._baseModel.init({type:i}),this._baseModel.setSId(e[td.SpriteKey.Sid]),this._camp=e[td.SpriteKey.Camp],this._pos=e[td.SpriteKey.Position]-1,this._hp=e[td.SpriteKey.HP]||0,this._maxHp=e[td.SpriteKey.MaxHp]||0,this._rage=e[td.SpriteKey.RAGE]||0,this._maxRage=e[td.SpriteKey.MaxRage]||0,this._curCamp=e[td.SpriteKey.HERO_CAMP]||0}},getBaseModel:function(){return this._baseModel},getSId:function(){return this._baseModel.getSId()},getRoleType:function(){return this._baseModel.getRoleType()},getModelShowType:function(){return this._baseModel.getModelShowType()},getAnimationIndex:function(){return this._baseModel.getAnimationIndex()},getAnimationRes:function(){return this._baseModel.getAnimationRes()},getPos:function(){return this._pos},getCamp:function(){return this._camp},getCurCamp:function(){return this._curCamp},getHp:function(){return this._hp},setHp:function(t){t=Math.min(t,this._maxHp),this._hp=t},getMaxHp:function(){return this._maxHp},getRage:function(){return this._rage},setRage:function(t){return this._rage=Math.min(t,this._maxRage)},getMaxRage:function(){return this._maxRage},getScale:function(){return this._baseModel.getScale()},getFightOffset:function(){return this._baseModel.getFightOffset()},getSuperArmor:function(){return this._baseModel.getSuperArmor()},getChangeColorData:function(){return this._baseModel.getChangeColorData()}}),cc._RF.pop()},{Model:"Model"}],MonsterGroupConfig:[function(t,e,i){"use strict";cc._RF.push(e,"dbe324HHbxMqqpNeR7TtANw","MonsterGroupConfig");var n=t("BaseTable"),a=t("BaseUser"),r=cc.Class({extends:n,name:"MonsterGroupConfig",properties:{_tblName:"monster_group_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},getMonsterGroupTable:function(){return this._data},getMonsterGroupById:function(t){return this._data[t]},getBaseUserById:function(t){var e=td.GetTableClass(td.TableEnum.MonsterGroup).getMonsterGroupById(t),i=new a;return i.level=e.level,i.nickName=e.name,i.level=e.level,i.fightPower=e.power,i.avatar=e.avatarId,i.isMonster=!0,i},getMonsterGroupDataArrayById:function(t){if(!this._data||!this._data[t])return[];for(var e=[],i=this._data[t].group,n=0;n<i.length;n++){var a=i[n],r=td.GetTableClass(td.TableEnum.Monster).getMonsterDataById(a[0]);if(r){var o=new td.MonsterModel;o.init(r),o.setPositionId(a[1]),e[e.length]=o}}return e},getMonsterGroupDataById:function(t){if(!this._data||!this._data[t])return[];for(var e={},i=this._data[t].group,n=0;n<i.length;n++){var a=i[n],r=td.GetTableClass(td.TableEnum.Monster).getMonsterDataById(a[0]);if(r){var o=new td.MonsterModel;o.init(r),o.setPositionId(a[1]),e[o.getPositionId()]=o}}return e}});e.exports=r,cc._RF.pop()},{BaseTable:"BaseTable",BaseUser:"BaseUser"}],MonsterModel:[function(t,e,i){"use strict";var n;cc._RF.push(e,"ff123jcc1hOgbF6/rDoWnEm","MonsterModel");var a=t("PropertyModel");td.MonsterModel=cc.Class(((n={extends:a,properties:{_roleType:null,_image:null,_headIcon:null,_commonAttack:null,_skill:null,_restraintSkill:null,_quality:null,_attack:null,_hp:null,_fightPower:null,_scale2:1,_animationIndex:null,_animationOffset:null,_animationRes:null,_features:null,_showIdleRes:null,_showIdleOffset:null,_scale:null,_fightOffset:null,_superArmor:null,_changeColorConfig:null,_level:null,_goodsType:null,_modelShowType:0,_camp:0},_positionId:null,init:function(t){this._monsterType=t.type,this._capabilityId=t.capabilityId;var e=td.GetTableClass(td.TableEnum.MonsterTypeConfig).getMonsterTypeDataByType(this._monsterType),i=td.GetTableClass(td.TableEnum.MonsterCapabilityConfig).getMonsterNumberDataById(this._capabilityId)||{};this._super("Monster",td.UserPropertyEnum.Mercenary,e.roleId,e.name,e.headImg,e.res),this._propertyType=td.UserPropertyEnum.Mercenary,this._goodsType=td.GoodsType.Type_Mercenary,this._sid=0,this._id=t.id,this._name=e.name,this._roleType=e.roleType,this._image=e.res,this._headIcon=e.headImg,this._commonAttack=e.commonAttack,this._skill=e.skill,this._restraintSkill=e.restraintSkill,this._quality=e.quality,this._aptitude=e.aptitude||2,this._animationIndex=e.animationIndex,this._animationRes=e.animationRes,this._features=e.features,this._camp=e.camp,this._animationOffset=e.animationOffset,this._animationRes=e.spriteAnimationRes,this._pvpIdleRes=e.pvpIdleRes,this._combinationSkillId=e.combinationSkillId||0,this._combinationHeroIds=e.combinationHeroIds||[],this._combinationSkillReplaceIds=e.combinationSkillReplaceIds||[],this._scale=e.scale,this._scale2=e.scale2,this._showIdleOffset=cc.v2(e.idleOffset[0],e.idleOffset[1]),e.fightOffset?this._fightOffset=cc.v2(e.fightOffset[0],e.fightOffset[1]):this._fightOffset=cc.v2(0,0),this._superArmor=!!e.BaTi,this._changeColorConfig=null;e.changeColorId;this._level=e.level,this._attack=i.attack,this._hp=i.hp,this._fightPower=i.power,this._positionId=0,this._modelShowType=1},getPvpIdleRes:function(){return this._pvpIdleRes},getModelShowType:function(){return this._modelShowType},getAptitude:function(){return this._aptitude},getCombinationSkillId:function(){return this._combinationSkillId},getCombinationHeroIds:function(){return this._combinationHeroIds},getCombinationSkillReplaceIds:function(){return this._combinationSkillReplaceIds},getAnimationOffset:function(){return this._animationOffset},getPropertyType:function(){return this._propertyType},getGoodsType:function(){return this._goodsType},setSId:function(t){this._sid=t},getSId:function(){return this._sid},getId:function(){return this._id},getName:function(){return this._name},getLevel:function(){return this._level},getRoleType:function(){return this._roleType},setFightPower:function(t){this._fightPower=t},getFightPower:function(){return this._fightPower},getIconRes:function(){return this._headIcon},getImgRes:function(){return this._image},getQuality:function(){return this._quality},getAttack:function(){return this._attack},getHp:function(){return this._hp},setHP:function(t){this._hp=t},getAnimationIndex:function(){return this._animationIndex},getAnimationRes:function(){return this._animationRes}}).getAnimationOffset=function(){return this._animationOffset},n.getGenAtk=function(){return this._commonAttack},n.getSkill=function(){return this._skill},n.getRestraintSkill=function(){return this._restraintSkill},n.getFeatures=function(){return this._features},n.getShowIdleRes=function(){return this._showIdleRes},n.getShowModelResKey=function(){var t="npc_animation_"+this._roleType;if(!gdk.ResourceId.getValue(t)){var e={};e[t]={HeroIdel:{type:cc.Prefab,resArray:[this._animationRes]}},gdk.ResourceId.mixins(e)}return t},n.getShowIdleOffset=function(){return this._showIdleOffset},n.getScale=function(){return this._scale},n.getScale2=function(){return this._scale2||1},n.getFightOffset=function(){return this._fightOffset},n.getSuperArmor=function(){return this._superArmor},n.getChangeColorData=function(){return this._changeColorConfig},n.getPositionId=function(){return this._positionId},n.setPositionId=function(t){this._positionId=t},n.getEvolveLevel=function(){return 0},n.clone=function(){return cc.instantiate(this)},n.getCurCamp=function(){return this._camp},n.setCamp=function(t){this._camp=t},n)),cc._RF.pop()},{PropertyModel:"PropertyModel"}],MonsterSpeedBuff:[function(t,e,i){"use strict";cc._RF.push(e,"8a6b5fcHENHFIeMu9ccjL0L","MonsterSpeedBuff");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_clipName:null,_bShowBuff:null},initData:function(t){if(this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.SpeedChange,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff){var e=this.node.getChildByName("MSBuff");if(!e){var i=gdk.rm.getResByUrl("fightRes/pve/buff/9027/9027",cc.Prefab);e=cc.instantiate(i),this.node.addChild(e),e.y=-100,e.name="MSBuff"}this._buffAnimation=e.getComponent(cc.Animation),this._clipName="9027"}},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._super(),this._curSpeedMult=a.getCurFightSpeedMult(),this._bShowBuff&&(this.refreshSkillAnimationSpeed(this._curSpeedMult),this._buffAnimation.play(this._clipName)),this.setTargetBuffData(!0),this.schedule(this.onUpdateBuff,1/60)):this.removeSelf()},onDisable:function(){this._super(),this.unschedule(this.onUpdateBuff)},onChangeSpeedMult:function(t){this._super(t),this._bShowBuff&&this.refreshSkillAnimationSpeed(t)},refreshSkillAnimationSpeed:function(t){for(var e=this._buffAnimation,i=e.getClips(),n=0,a=i.length;n<a;n++){if(i[n])e.getAnimationState(i[n].name).speed=t}},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=(i.getDataModel(),this._curBuffData.buffData+1),r=a.getCurFightSpeedMult(),o=t?n*r:r;i.onChangeSpeedMult(o)},onUpdateBuff:function(t){if(!this._bFightPause){if(this._deltaTime+=t,this._curBuffData.buffTime<=0)return this.unschedule(this.onUpdateBuff),this.setTargetBuffData(!1),void this.endBuff();this._curBuffData.buffTime-=t*this._curSpeedMult}},endBuff:function(){(this._super(),cc.isValid(this._curTarget))&&this._curTarget.getComponent("EnemyBuffCtrlComponent").removeBuffFromList(this._buffType,this._curBuffKey)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],MonsterTable:[function(t,e,i){"use strict";cc._RF.push(e,"c81d5V6y4NPSbFF/Hl/qlM8","MonsterTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"MonsterTable",properties:{_tblName:"monster_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.roleType;a.headImg&&(a.headImg="Hero"+a.headImg),a.spriteAnimationRes="hero/hero_"+r+"/hero_"+r,a.animationOffset?a.animationOffset={x:a.animationOffset[0],y:a.animationOffset[1]}:a.animationOffset={x:0,y:0},a.scale=a.scale/100,a.scale2=a.scale2/100,t[a.id]=a}},getMonsterTable:function(){return this._data},getMonsterDataById:function(t){return this._data[t]},getMonsterDataByType:function(t){for(var e in this._data)if(this._data.hasOwnProperty(e)){var i=this._data[e];if(i.type==t)return i}}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MonsterTypeConfig:[function(t,e,i){"use strict";cc._RF.push(e,"18b6cWxD2FOD7lAVhID3JEZ","MonsterTypeConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"MonsterTypeConfig",properties:{_tblName:"monster_type_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.roleType;a.headImg&&(a.headImg="Hero"+a.headImg),a.spriteAnimationRes="hero/hero_"+r+"/hero_"+r,a.pvpIdleRes="hero/hero_"+r+"/pvp/PVP_hero_"+r,a.animationOffset?a.animationOffset={x:a.animationOffset[0],y:a.animationOffset[1]}:a.animationOffset={x:0,y:0},a.scale=a.scale/100,a.scale2=a.scale2/100,t[a.type]=a}},getMonsterTypeConfig:function(){return this._data},getMonsterTypeDataByType:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MonthCardController:[function(t,e,i){"use strict";cc._RF.push(e,"e73bcqOFrZFtaxEf5VyhcJR","MonthCardController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_firstLogin:null},initData:function(t){this._super(t)},setFirstLogin:function(){td.GlobalFunction.setLocalSaveStatus("MonthCardHome","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_MONTH_CARD_SHOWN)},hasRedPoint:function(){return!0},redPointTip:function(){if(!td.GlobalFunction.getLocalSaveStatus("MonthCardHome"))return!0;for(var t=0,e=0;e<3;e++)if(0==e){if(t=td.ActivityEnum.MonthCardType.WEEK,td.Account.getUserData().getVipCard(td.VipCardType.WEEK_VIP_CARD)){var i=td.GetTableClass(td.TableEnum.MonthCardTable).getDataByType(t).taskId;if(n=td.TaskManager.getTaskById(i))if(n.getStatus()!=td.TaskStatus.Received)return!0}}else if(1==e){if(t=td.ActivityEnum.MonthCardType.MONTH,td.Account.getUserData().getVipCard(td.VipCardType.MOUTH_VIP_CARD)){i=td.GetTableClass(td.TableEnum.MonthCardTable).getDataByType(t).taskId;if(n=td.TaskManager.getTaskById(i))if(n.getStatus()!=td.TaskStatus.Received)return!0}}else if(2==e&&(t=td.ActivityEnum.MonthCardType.LIFE,td.Account.getUserData().getVipCard(td.VipCardType.LIFETIME_VIP_CARD))){var n;i=td.GetTableClass(td.TableEnum.MonthCardTable).getDataByType(t).taskId;if(n=td.TaskManager.getTaskById(i))if(n.getStatus()!=td.TaskStatus.Received)return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.Res_TASK_RECEIVE,td.EventNameEnum.ON_MONTH_CARD_SHOWN]},isRedPointTip:function(){return this.redPointTip()}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],MonthCardHome:[function(t,e,i){"use strict";cc._RF.push(e,"de6815wI+dClJPr7anvSBFK","MonthCardHome");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{weekCard:cc.Node,monthCard:cc.Node,lifeCard:cc.Node},initData:function(t){this._super(t)},onLoad:function(){},onEnable:function(){this._super(),this._addLocalListeners(),this._refreshCardState(),this._controller.setFirstLogin()},onDisable:function(){this._super(),this._removeAllListeners()},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.Recharge_Success]=this._refreshCardState,i[e.Res_GET_ACTIVITY_INFO]=this._resInfo,i[e.Res_TASK_RECEIVE]=this._refreshCardState,t.registerEvents(i,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},_resInfo:function(t){t===this.getActivityId()&&this._refreshCardState()},_refreshCardState:function(){var t=td.ActivityEnum.MonthCardType,e=td.TaskManager;for(var i in t){var n=t[i],a=this.node.getChildByName("card_"+n),r=td.Account.getUserData().getVipCard(n),o=td.GetTableClass(td.TableEnum.MonthCardTable).getDataByType(n);if(a&&o){var s=o.taskId,l=e.getTaskById(s);if(!cc.isValid(l))continue;var c=l.getStatus(),u=a.getChildByName("labDay"),d=a.getChildByName("btnBuy"),h=a.getChildByName("btnGet");if(2===n){var p=d.getChildByName("Label");DX_CHANNEL!=window.SdkType.AWY?(p.getComponent(cc.Label).string="198\u5143\u8d2d\u4e70",td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_08_tqk,"HD_tqk_zska",a)):(p.getComponent(cc.Label).string="98\u5143\u8d2d\u4e70",td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_08_tqk,"HD_tqk_zska02",a))}if(r){var _=r.expirationTime>=td.TimeUtil.getTime();d.active=!_,h.active=!!_;c=td.TaskManager.getTaskById(s).getStatus();if(td.GlobalFunction.setButtonGray(h,c==td.TaskStatus.Received),h.getChildByName("Label").getComponent(cc.Label).string=c==td.TaskStatus.Received?td.Language.recevied:td.Language.recevie,td.RedPointUtil.createRedPointSimple(h,{x:-10,y:-10},c!=td.TaskStatus.Received),_){var g="";if(n!=t.LIFE){var f=r.expirationTime-td.TimeUtil.getTime(),v=0;f>=864e5?(v=parseInt(f/864e5),g=cc.js.formatStr(td.Language.leftDay,v,td.Language.day)):(v=parseInt(f%864e5/36e5),g=cc.js.formatStr(td.Language.leftDay,v,td.Language.hour))}else g=cc.js.formatStr(td.Language.leftDay,td.Language.forever);u.getComponent(cc.Label).string=g,u.active=!0}else u.active=!1}else u.active=!1,d.active=!0,h.active=!1}}},onRequestBuy:function(t,e){e=parseInt(e);var i=td.RechargeManager.getRechargeDataByType(e);i&&td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,i)},onGetReward:function(t,e){e=parseInt(e);var i=td.GetTableClass(td.TableEnum.MonthCardTable).getDataByType(e);td.EventUtil.dispatchEvent(td.EventNameEnum.Req_TASK_RECEIVE,i.taskId)}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],MonthCardRenewalController:[function(t,e,i){"use strict";cc._RF.push(e,"629384Vz+5K5qo1XQ0gUV1F","MonthCardRenewalController");var n=t("ActivityBaseController"),a=(t("MonthCardRenewalModel"),cc.Class({extends:n,properties:{_rewardStatus:null,_chargeStatus:null,_chargeId:null,_chargeLimit:null},initData:function(t){this._super(t);var e=this.getActivityData(),i=td.GetTableClass(td.TableEnum.MonthCardRenewalTable).getDataById(e);this._chargeId=i.chargeIds[1],this._chargeLimit=i.chargeIds[0]},activityParse:function(t){t&&this._parseReceiveQueryData(t)},_parseReceiveQueryData:function(t){var e=this._rewardStatus;this._rewardStatus=t.record.status,e&&e==this._rewardStatus||td.EventUtil.dispatchEvent(td.EventNameEnum.MONTHCARDRENEWAL_REFRESH_UI)},getRewardStatus:function(){return this._rewardStatus},hasRedPoint:function(){return!0},isRedPointTip:function(){return this._rewardStatus==td.ActivityEnum.RewardStatus.FINISH},redPointEvts:function(){return[td.EventNameEnum.MONTHCARDRENEWAL_REFRESH_UI]}}));e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",MonthCardRenewalModel:"MonthCardRenewalModel"}],MonthCardRenewalItem:[function(t,e,i){"use strict";cc._RF.push(e,"90270D4H9RPrptstHP0zUfa","MonthCardRenewalItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{},updateItem:function(t,e){this._super(t,e);var i=td.RewardManager.parseRewardListDetail([e])[0],n=td.GlobalFunction.createCommonIconWidget(27,i);n.getComponent("CommonIconWidget").setNameBgVisible(!1),this.node.addChild(n),n.setScale(.8),n.y=n.y+10}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],MonthCardRenewalModel:[function(t,e,i){"use strict";cc._RF.push(e,"74ca2HPcwlDI7hQeg2cs5JG","MonthCardRenewalModel");var n=cc.Class({properties:{_dataId:null,_chargeId:null,_reward:null},initData:function(t){this._dataId=t.data,this._chargeId=t.chargeId,this._reward=t.reward},setData:function(t,e){this[t]=e}});e.exports=n,cc._RF.pop()},{}],MonthCardRenewalTable:[function(t,e,i){"use strict";cc._RF.push(e,"a541dqi9/lKX6lvRrb/Uzjt","MonthCardRenewalTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"MonthCardRenewalTable",properties:{_tblName:"activity_vip_card_renewal_config",_datas:null},init:function(){for(var t in this._datas=this._jsonData,this._jsonData){var e=this._jsonData[t],i=e.data;this._datas[i]=e}},getDataById:function(t){return this._datas[t]||{}}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MonthCardRenewalWindow:[function(t,e,i){"use strict";cc._RF.push(e,"00f89AT4axJPIlKTZvBv5RI","MonthCardRenewalWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{btnGo:cc.Node,btnGet:cc.Node,lab_time:cc.Label,scroll:cc.ScrollView,item:cc.Node,imgGotten:cc.Sprite,controller:null,list:null,chargeIds:null,reward:null,_leftTime:null,_activityId:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_MonthCardRenewal},onLoad:function(){this._super(),this._activityType=td.ActivityEnum.ActivityType.MonthCardRenewal,this.controller=td.ActivityDataManager.getActivityControllerByType(this._activityType),this.controller&&(this._activityId=this.controller.getActivityId(),this._leftTime=0)},onEnable:function(){this._super(),this.addEventListener()},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this),this.unschedule(this._updateActivityOddTime)},setData:function(t){this._activityType=t||td.ActivityEnum.ActivityType.MonthCardRenewal,this.initUI()},clearData:function(){this._isInited=!1},addEventListener:function(){var t={};t[td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]=this.receiveRewardReturn,t[td.EventNameEnum.MONTHCARDRENEWAL_REFRESH_UI]=this.refreshUI,t[td.EventNameEnum.ON_ACTIVITY_CLOSED]=this._onActivityClose,td.EventUtil.registerEvents(t,this)},initUI:function(){this.list=this.scroll.getComponent("OptimizeHorizontalListView");var t=this.controller.getActivityData(),e=td.GetTableClass(td.TableEnum.MonthCardRenewalTable).getDataById(t);this.list.setData(e.reward||[]),this.chargeIds=e.chargeIds,this.refreshUI()},refreshUI:function(){this.btnGo.active=this.controller._rewardStatus==td.ActivityEnum.RewardStatus.NONE,this.btnGet.active=this.controller._rewardStatus==td.ActivityEnum.RewardStatus.FINISH,this.imgGotten.active=this.controller._rewardStatus==td.ActivityEnum.RewardStatus.RECEIVED,this._setActivityTime(),!this._isInited&&(this._isInited=!0)},_setActivityTime:function(){var t=td.TimeUtil.getZoneOffsetTime(),e=this.controller._activityOpen.getCurrentOpenStage();this._leftTime=Math.floor(e.closeTime-td.TimeUtil.getTime()+t),this._leftTime<0&&(this._leftTime=0);var i=td.GlobalFunction.getTimeStringByDeltaTime(this._leftTime);this.lab_time.string=cc.js.formatStr(td.Language.leftTime,i),this.schedule(this._updateActivityOddTime,1)},_updateActivityOddTime:function(){if(this.lab_time&&this._leftTime&&this._leftTime>0){var t=td.GlobalFunction.getTimeStringByDeltaTime(this._leftTime);this.lab_time.string=cc.js.formatStr(td.Language.leftTime,t),this._leftTime=this._leftTime-1e3}else this.lab_time.string=cc.js.formatStr(td.Language.leftTime,"00:00:00"),this.unschedule(this._updateActivityOddTime)},onGoClick:function(){td.GlobalFunction.gotoRecharge()},onGetClick:function(){var t={id:this.controller.getActivityData()};this.controller.operateActivity(t)},_onActivityClose:function(t){this._activityId===t&&this.closeCallFunc()},receiveRewardReturn:function(t){if(t.activityId===this._activityId){var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);td.GlobalFunction.showRewards(i),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL)}},closeCallFunc:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.CLOSED_POP_WINDOW)},isInited:function(){return this._isInited}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],MonthCardTable:[function(t,e,i){"use strict";cc._RF.push(e,"2df9diEOrBMer1yDjY5vxvf","MonthCardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"MonthCardTable",properties:{_tblName:"vip_card_config",_datas:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.type]=a}},getDatas:function(){return this._data},getDataByType:function(t){return this._data[t]?this._data[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MoveArround:[function(t,e,i){"use strict";cc._RF.push(e,"b610aIzzeBPzqdUszYRZI/D","MoveArround"),cc.MoveArround=cc.Class({name:"cc.MoveArround",extends:cc.ActionInterval,properties:{_posList:null,_startPosIndex:null,_endPosIndex:null,_round:null,_deltaPosIndex:null,_timePassed:null},ctor:function(t,e,i,n){this._timePassed=0,this._startPosIndex=null,void 0!==e&&e.length>0&&cc.MoveArround.prototype.initWithDuration.call(this,t,e,i,n)},initWithDuration:function(t,e,i,n){return!!cc.ActionInterval.prototype.initWithDuration.call(this,t)&&(this._posList=e,this._endPosIndex=i,this._round=n,!0)},clone:function(){var t=new cc.MoveArround;return this._cloneDecoration(t),t.initWithDuration(this._duration,this._posList,this._endPosIndex),t},startWithTarget:function(t){cc.ActionInterval.prototype.startWithTarget.call(this,t),this._timePassed=0,this._startPosIndex||(this._startPosIndex=this._computeCurPos());var e,i=this._posList.length;e=this._endPosIndex===this._startPosIndex?i:(i+this._endPosIndex-this._startPosIndex)%i,this._deltaPosIndex=this._round*i+e},_computeCurPos:function(){for(var t=this.target.getPosition(),e=0;e<this._posList.length;e++){var i=this._posList[e];if(uf.utils.Math.distanceSQ(t,i)<=4)return e}},update:function(t){if(t=this._computeEaseTime(t),this.target){var e=this._startPosIndex+Math.floor(this._deltaPosIndex*t),i=this._posList[e%this._posList.length];i.x===this.target.x&&i.y===this.target.y||td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.Roulette),this.target.setPosition(i)}},reverse:function(){this._startPosIndex||(this._startPosIndex=this._computeCurPos());var t=this._startPosIndex,e=this._posList.reverse(),i=new cc.MoveArround(this._duration,e,t,this._round);return i._startPosIndex=this._endPosIndex,this._cloneDecoration(i),this._reverseEaseList(i),i}}),cc._RF.pop()},{}],MoxieReqVO:[function(t,e,i){"use strict";cc._RF.push(e,"bb4b9fopGpLaaLXKHpDaCAm","MoxieReqVO");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.MoXieRedEnvelopeWithdrawalVO=i.MoXieRedEnvelopeReceiveVO=i.MoXieRedEnvelopeVO=i.MoxieGetInfoVO=i.MoxieBaseVO=void 0;var a=t("../Enum/QQMoxieEnum"),r=function(){return function(){this.module=td.MsgModuleName.ExtensionCmd,this.cmd=0}}();i.MoxieBaseVO=r;var o=function(t){function e(){var e=t.call(this)||this;return e.cmd=td.MsgCmd.ExtensionCmd.MO_XIE_INFO,e}return n(e,t),e}(r);i.MoxieGetInfoVO=o;var s=function(t){function e(){var e=t.call(this)||this;return e.cmd=td.MsgCmd.ExtensionCmd.MO_XIE_RED_ENVELOPE,e}return n(e,t),e}(r);i.MoXieRedEnvelopeVO=s;var l=function(t){function e(e,i){var n=t.call(this)||this;return n.cmd=td.MsgCmd.ExtensionCmd.MO_XIE_RED_ENVELOPE_RECEIVE,n.type=e,n.id=i,n.os=cc.sys.os==cc.sys.OS_IOS?a.MoXieOS_Type.IOS:a.MoXieOS_Type.ANDROID,n}return n(e,t),e}(r);i.MoXieRedEnvelopeReceiveVO=l;var c=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.cmd=td.MsgCmd.ExtensionCmd.MO_XIE_RED_ENVELOPE_WITHDRAWAL,n}return n(e,t),e}(l);i.MoXieRedEnvelopeWithdrawalVO=c,cc._RF.pop()},{"../Enum/QQMoxieEnum":"QQMoxieEnum"}],MoxieRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"f604bzL3JNAS7QRLvsj2/ss","MoxieRewardModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Enum/QQMoxieEnum"),a=function(){function t(){this._rewardType=0,this._rewards=null,this._receivedTimes=0,this._maxTimes=0,this._titleImg="",this._roleImg="",this._descImg="",this._btnImg="",this._roleImgX=-142}return t.prototype.init=function(t){this._rewardType=t[0],this._rewards=td.RewardManager.parseRewardListDetail(t[1]),this._rewardType==n.MOXIE_REWARD_TYPE.COLOR_SIGN?(this._titleImg="QQ_bt_cqhl",this._roleImg="QQ_renwu_03",this._descImg="QQ_gg_tjcq",this._btnImg="QQ_anniu_tjcq",this._roleImgX=-142):this._rewardType==n.MOXIE_REWARD_TYPE.FAVORITES?(this._titleImg="QQ_bt_scyl",this._roleImg="QQ_renwu_02",this._descImg="",this._btnImg="QQ_anniu_ljtj",this._roleImgX=-135):this._rewardType==n.MOXIE_REWARD_TYPE.SHARE?(this._titleImg="QQ_bt_hyfx",this._roleImg="QQ_renwu_01",this._descImg="QQ_gg_hyfx",this._btnImg="QQ_anniu_fxyx",this._roleImgX=-148):this._rewardType==n.MOXIE_REWARD_TYPE.SUBSCRIBE&&(this._titleImg="QQ_bt_tyyl",this._roleImg="QQ_renwu_01",this._descImg="QQ_gg_dyyl",this._btnImg="QQ_anniu_dy",this._roleImgX=-148)},t.prototype.isCanReceive=function(){return this._receivedTimes<this._maxTimes},t.prototype.getRewardType=function(){return this._rewardType},t.prototype.setReceivedTimes=function(t){this._receivedTimes=t},t.prototype.getReceivedTimes=function(){return this._receivedTimes},t.prototype.setMaxTimes=function(t){this._maxTimes=t},t.prototype.getMaxTimes=function(){return this._maxTimes},t.prototype.getRewards=function(){return this._rewards},t.prototype.getTitleImg=function(){return this._titleImg},t.prototype.getDescImg=function(){return this._descImg},t.prototype.getRoleImg=function(){return this._roleImg},t.prototype.getBtnImg=function(){return this._btnImg},t.prototype.getRoleImgX=function(){return this._roleImgX},t}();i.default=a,cc._RF.pop()},{"../Enum/QQMoxieEnum":"QQMoxieEnum"}],MultipleFirstRechargeController:[function(t,e,i){"use strict";cc._RF.push(e,"47992M9CfZDYIjp+/kYiizw","MultipleFirstRechargeController");var n=t("../../../../SDK/SDKCommonEnum"),a=t("ActivityBaseController"),r=cc.Class({extends:a,properties:{_finishList:null,_stateList:null,_showView:!1,_lastCloseTime:0,_showTimes:0},initData:function(t){this._super(t),this._finishList=[],this._stateList=[[],[],[]],this.addNetListener(),this.addEventListener(),this._requestInfo(),this._showView=!1},destroyData:function(){this._super(),this._finishList=null,this._stateList=null},addNetListener:function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.FIRST_CHARGE_INFO,this._parseInfo.bind(this)),i.registerMessage(t,e.FIRST_CHARGE_RECEIVE_REWARD,this._onGetReward.bind(this)),i.registerMessage(t,e.PUSH_FIRST_CHARGE_INFO,this._pushInfo.bind(this))},addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REQUEST_FIRST_CHARGE_INFO]=this._requestInfo.bind(this),t[e.REQUEST_FIRST_CHARGE_RECEIVE_REWARD]=this._requestExchange.bind(this),td.EventUtil.registerEvents(t,this)},_requestInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.FIRST_CHARGE_INFO,td.ServerDelegate.sendMessage(t)},_requestExchange:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.FIRST_CHARGE_RECEIVE_REWARD,e.id=t.id,e.day=t.day,td.ServerDelegate.sendMessage(e)},_parseInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.firstCharges;if(i){this._finishList=[],this._stateList=[[],[],[]];for(var n=td.ActivityEnum.MultipleFirstRechargeType,a=0;a<3;a++)this._stateList[a][0]=n.CAN_NOT_Receive,this._stateList[a][1]=n.CAN_NOT_Receive,this._stateList[a][2]=n.CAN_NOT_Receive;for(var r=td.GetTableClass(td.TableEnum.MultpleFirstRechargeTable).getDatas(),o=0;o<i.length;o++){var s=0;for(var l in r){if(l==i[o].configId){this._finishList[this._finishList.length]=i[o].configId;var c=i[o].receiveList,u=i[o].chargeTime,d=td.TimeUtil.getTheZeroPoint();this._stateList[s][0]=n.CAN_NOT_Receive,this._stateList[s][1]=n.CAN_NOT_Receive,this._stateList[s][2]=n.CAN_NOT_Receive,d<u?(this._stateList[s][0]=-1!=c.indexOf(1)?n.ALREADY_Receive:n.CAN_Receive,this._stateList[s][1]=n.CAN_NOT_Receive,this._stateList[s][2]=n.CAN_NOT_Receive):d-u>864e5?(this._stateList[s][0]=-1!=c.indexOf(1)?n.ALREADY_Receive:n.CAN_Receive,this._stateList[s][1]=-1!=c.indexOf(2)?n.ALREADY_Receive:n.CAN_Receive,this._stateList[s][2]=-1!=c.indexOf(3)?n.ALREADY_Receive:n.CAN_Receive):(this._stateList[s][0]=-1!=c.indexOf(1)?n.ALREADY_Receive:n.CAN_Receive,this._stateList[s][1]=-1!=c.indexOf(2)?n.ALREADY_Receive:n.CAN_Receive,this._stateList[s][2]=n.CAN_NOT_Receive)}s++}}}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_FIRST_CHARGE_INFO)}},_pushInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=td.ActivityEnum.MultipleFirstRechargeType,n=e.firstCharges,a=n[0].receiveList,r=n[0].chargeTime,o=td.TimeUtil.getTheZeroPoint(),s=[],l=td.GetTableClass(td.TableEnum.MultpleFirstRechargeTable).getDatas();for(var c in l)s[s.length]=parseInt(c);var u=0;n.length>0&&(u=s.indexOf(n[u].configId)),this._stateList[u][0]=i.CAN_NOT_Receive,this._stateList[u][1]=i.CAN_NOT_Receive,this._stateList[u][2]=i.CAN_NOT_Receive,o<r?(this._stateList[u][0]=-1!=a.indexOf(1)?i.ALREADY_Receive:i.CAN_Receive,this._stateList[u][1]=i.CAN_NOT_Receive,this._stateList[u][2]=i.CAN_NOT_Receive):o-r>864e5?(this._stateList[u][0]=-1!=a.indexOf(1)?i.ALREADY_Receive:i.CAN_Receive,this._stateList[u][1]=-1!=a.indexOf(2)?i.ALREADY_Receive:i.CAN_Receive,this._stateList[u][2]=-1!=a.indexOf(3)?i.ALREADY_Receive:i.CAN_Receive):(this._stateList[u][0]=-1!=a.indexOf(1)?i.ALREADY_Receive:i.CAN_Receive,this._stateList[u][1]=-1!=a.indexOf(2)?i.ALREADY_Receive:i.CAN_Receive,this._stateList[u][2]=i.CAN_NOT_Receive),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_FIRST_CHARGE_INFO)}},getFinishList:function(){return this._finishList},isAllGet:function(){for(var t=!0,e=this._stateList,i=0;i<e.length;i++){for(var n=0;n<e[i].length;n++)if(2!=e[i][n]){t=!1;break}if(!t)break}return t},checkLevel:function(){if(this._showView){var t=td.Account.getUserData().getLevel();-1!==td.GetConfig("MULTIPLEFIRSTRECHARGE_LEVEL").indexOf(t)&&(this._showView=!1)}},checkTime:function(){if(this._showView){var t=td.GetConfig("MULTIPLEFIRSTRECHARGE_TIME");this._lastCloseTime?td.TimeUtil.getTime()>=this._lastCloseTime+60*t*1e3&&(this._showView=!1):this._showView=!1}},setLastCloseTime:function(t){this._lastCloseTime=t;var e=td.GetConfig("MULTIPLEFIRSTRECHARGE_TIME");gdk.Timer.once(60*e*1e3,this,function(){td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_PANEL)})},getStateList:function(){return this._stateList},_onGetReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,a=td.RewardManager.parseRewardResult(i);td.GlobalFunction.showRewards(a),td.LocalStorageUtil.readRealLocal(td.LocalRealKey.FIRST_RECEIVE_FIRST_RECHARGE)||(td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_POINT_REPORT,n.CHECK_POINT_TYPE.FIRST_RECEIVE_FIRST_RECHARGE),td.LocalStorageUtil.writeRealLocal(td.LocalRealKey.FIRST_RECEIVE_FIRST_RECHARGE,!0))}},hasRedPoint:function(){return!0},redPointTip:function(){for(var t=td.ActivityEnum.MultipleFirstRechargeType,e=0;e<3;e++){var i=this._stateList[e];if(0==e){for(var n=0;n<i.length;n++)if(i[n]===t.CAN_Receive)return!0}else if(1==e){for(var a=0;a<i.length;a++)if(i[a]===t.CAN_Receive)return!0}else if(2==e)for(var r=0;r<i.length;r++)if(i[r]===t.CAN_Receive)return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.REFRESH_FIRST_CHARGE_INFO]},isRedPointTip:function(){return this.redPointTip()},setShowView:function(t){this._showView=t},addShowTimes:function(){this._showTimes++},isShowView:function(){return this._showTimes>4||this._showView}});e.exports=r,cc._RF.pop()},{"../../../../SDK/SDKCommonEnum":void 0,ActivityBaseController:"ActivityBaseController"}],MultipleFirstRechargeWindow:[function(t,e,i){"use strict";cc._RF.push(e,"bbce1YIj+JLn4sUjQzK+j4W","MultipleFirstRechargeWindow");var n=t("../../../../SDK/SDKCommonEnum"),a=t("PanelBase"),r=t("TabController"),o=cc.Class({extends:a,properties:{_controller:null,_chargeList:null,btn_page0:cc.Node,btn_page1:cc.Node,btn_page2:cc.Node,deluxeNode:cc.Node,superNode:cc.Node,supremacyNode:cc.Node,labCost:cc.Label,_showTab:0},init:function(){this._panelType=td.PanelType.NONE,this._panelEnum=td.PanelEnum.Window_MultipleFirstRecharge,td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_FIRST_CHARGE_INFO)},onLoad:function(){this._super(),this._controller=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MultipleFirstRecharge)},_addEventListener:function(){var t=td.EventUtil,e={};e[td.EventNameEnum.REFRESH_FIRST_CHARGE_INFO]=this.refreshView,t.registerEvents(e,this)},onEnable:function(){this._super(),this._addEventListener(),this._initUi(),this._showTab=0,this.deluxeNode.active=!1,this.superNode.active=!1,this.supremacyNode.active=!1,this.btn_page0._tag=td.ActivityEnum.MultipleFirstRechargePage.Deluxe,this.btn_page1._tag=td.ActivityEnum.MultipleFirstRechargePage.Super,this.btn_page2._tag=td.ActivityEnum.MultipleFirstRechargePage.Supremacy,this._tabController||(this._tabController=new r,this._tabController.init([this.btn_page0,this.btn_page1,this.btn_page2],this,td.ActivityEnum.MultipleFirstRechargePage.Deluxe,!0)),this._controller.setShowView(!0),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_PANEL),td.LocalStorageUtil.readRealLocal(td.LocalRealKey.FIRST_SHOW_FIRST_RECHARGE)||(td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_POINT_REPORT,n.CHECK_POINT_TYPE.FIRST_SHOW_FIRST_RECHARGE),td.LocalStorageUtil.writeRealLocal(td.LocalRealKey.FIRST_SHOW_FIRST_RECHARGE,!0))},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_initUi:function(){this._chargeList=[];var t=td.GetTableClass(td.TableEnum.MultpleFirstRechargeTable).getDatas();for(var e in t)this._chargeList[this._chargeList.length]=e;this.node.getChildByName("labRecharge").getComponent(cc.Label).string=cc.js.formatStr(td.Language.alreadyRecharge,td.Account.getUserData().getRechargeExcpetPresent()/10)},refreshView:function(){this._tabController.showTab(this._showTab);var t=this._controller.getFinishList();this.btn_page2.active=t.length>1,this.setRedPoint()},setRedPoint:function(){for(var t=td.ActivityEnum.MultipleFirstRechargeType,e=0;e<3;e++){for(var i=this._controller.getStateList()[e],n=!1,a=0;a<i.length;a++)if(i[a]===t.CAN_Receive){n=!0;break}td.RedPointUtil.createRedPointSimple(this["btn_page"+e],{x:-10,y:-10},n)}},showTab:function(t){this._showTab=t,this.deluxeNode.active=0==t,this.superNode.active=1==t,this.supremacyNode.active=2==t;var e=cc.color(243,104,2),i=cc.color(94,69,4),n=this.btn_page0.getChildByName("Label"),a=this.btn_page1.getChildByName("Label"),r=this.btn_page2.getChildByName("Label");n.getComponent(cc.LabelOutline).color=0==t?e:i,a.getComponent(cc.LabelOutline).color=1==t?e:i,r.getComponent(cc.LabelOutline).color=2==t?e:i;var o=parseInt(this._chargeList[this._showTab]),s=td.GetTableClass(td.TableEnum.MultpleFirstRechargeTable).getDataByCharge(o),l=s.rewards;this.labCost.string=s.showPrice;for(var c=0;c<l.length;c++){(A=(I=this.node.getChildByName("giftNode"+c)).getChildByName("rewardPanel")).removeAllChildren();for(var u=l[c],d=-50,h=0;h<u.length;h++){var p=u[1][h],_=td.RewardManager.getRewardDetail(p),g=td.GlobalFunction.createCommonIconWidget(57,_);g.scale=.75,g.setName("iconItem"+h),g.setPosition(d,0),A.addChild(g),d+=100}}var f=this._controller.getFinishList(),v=this.node.getChildByName("btnRecharge"),m=this.node.getChildByName("imgCanGet"),y=this.node.getChildByName("imgNextDay"),E=this.node.getChildByName("imgIsGet"),T=this.node.getChildByName("imgStageBg");m.active=!1,y.active=!1,E.active=!1,-1!=f.indexOf(o)?(v.active=!1,T.active=!0):(v.active=!0,T.active=!1);for(var C=td.ActivityEnum.MultipleFirstRechargeType,R=this._controller.getStateList()[t],S=0;S<R.length;S++){for(var I,A=(I=this.node.getChildByName("giftNode"+S)).getChildByName("rewardPanel"),b=R[S]===C.ALREADY_Receive,P=A.children,N=0;N<P.length;N++){var M=P[N],L=M.getChildByName("imgGot");b?L?L.active=!0:((L=new cc.Node).addComponent(cc.Sprite),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_wz_yilingqu_03",L),L.name="imgGot",L.parent=M,L.zIndex=100,L.setAnchorPoint(cc.v2(0,1)),L.position=cc.v2(-56,54)):L&&(L.active=!1)}td.RedPointUtil.createRedPointSimple(I,{x:-10,y:-10},R[S]===C.CAN_Receive)}if(-1!=R.indexOf(C.CAN_Receive))m.active=!0,T.active=!1;else if(-1!=R.indexOf(C.ALREADY_Receive)&&-1!=R.indexOf(C.CAN_NOT_Receive)){y.active=!0;var D=cc.repeatForever(cc.sequence(cc.scaleTo(.25,1.1),cc.scaleTo(.25,1),cc.scaleTo(.25,.9),cc.scaleTo(.25,1)));y.runAction(D)}else R[0]==C.ALREADY_Receive&&R[1]==C.ALREADY_Receive&&R[2]==C.ALREADY_Receive&&(E.active=!0)},btnGet:function(){for(var t=this._controller.getStateList()[this._showTab],e=1;e<4;e++)if(t[e-1]===td.ActivityEnum.MultipleFirstRechargeType.CAN_Receive){var i={};i.id=this._chargeList[this._showTab],i.day=e,td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_FIRST_CHARGE_RECEIVE_REWARD,i);break}},gotoRecharge:function(){td.GlobalFunction.gotoRecharge()}});e.exports=o,cc._RF.pop()},{"../../../../SDK/SDKCommonEnum":void 0,PanelBase:void 0,TabController:void 0}],MultpleFirstRechargeTable:[function(t,e,i){"use strict";cc._RF.push(e,"3fe99wt1KNKfbWQsEQlnBQd","MultpleFirstRechargeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"MultpleFirstRechargeTable",properties:{_tblName:"first_charge_config",_datas:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},getDatas:function(){return this._data},getDataByCharge:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],MyNumRecordsItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"82700Fm58lHaYhDb4jog267","MyNumRecordsItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labNum=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this.labNum.string=i+""},a([s(cc.Label)],e.prototype,"labNum",void 0),e=a([o,l("module/Activity/RareTreasure/MyNumRecordsItemUI")],e)}(t("ListItem"));i.default=c,cc._RF.pop()},{ListItem:void 0}],MyNumRecordsLayer:[function(t,e,i){"use strict";cc._RF.push(e,"277f86Cr8JMMohitI9X91W7","MyNumRecordsLayer");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("OptimizeVerticalListView"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.phaseScroll=null,e.recordScroll=null,e.lab_tips=null,e._recordsListView=null,e._phaseListView=null,e._controller=null,e._selectIndex=0,e._ids=[],e}return n(e,t),e.prototype.init=function(t){this._controller=t},e.prototype.onEnable=function(){this._recordsListView||(this._recordsListView=this.recordScroll.getComponent(u)),this._phaseListView||(this._phaseListView=this.phaseScroll.getComponent(u)),this._addEventListener(),this._initWindow()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.EARETREASURE_SELECT_PHASE_BOX]=this._refreshWindow,r.EventUtil.registerEvents(t,this)},e.prototype._initWindow=function(){var t=[],e=this._controller.getActivityData(),i=r.GetTableClass(r.TableEnum.GoddessBoxTable).getAllBoxByData(e);for(var n in i)t.push(i[n]),this._ids.push(i[n].id);this._selectIndex=-1,this._controller.setBoxSelectIndex(this._selectIndex),this._phaseListView.setData(t),r.EventUtil.dispatchEvent(r.EventNameEnum.EARETREASURE_SELECT_PHASE_BOX,0)},e.prototype._refreshWindow=function(t){this._selectIndex=t,this._controller.setBoxSelectIndex(this._selectIndex),r.EventUtil.dispatchEvent(r.EventNameEnum.RES_EARETREASURE_SELECT_PHASE_BOX);var e=this._ids[this._selectIndex],i=this._controller.getPresentDataById(e),n=[];i&&(n=i.betInfo),this.lab_tips.active=0===n.length,this.recordScroll.active=n.length>0,n.length>0&&this._recordsListView.setData(n)},a([l(cc.Node)],e.prototype,"phaseScroll",void 0),a([l(cc.Node)],e.prototype,"recordScroll",void 0),a([l(cc.Node)],e.prototype,"lab_tips",void 0),e=a([s,c("module/Activity/RareTreasure/MyNumRecordsLayer")],e)}(cc.Component);i.default=d,cc._RF.pop()},{OptimizeVerticalListView:void 0}],MyRecordsWindow:[function(t,e,i){"use strict";cc._RF.push(e,"f7955k1QDdPkIrfQYQw7IB2","MyRecordsWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./RareTreasureEnums"),o=t("./MyNumRecordsLayer"),s=t("./BuyRecordsLayer"),l=t("./WinRecordsLayer"),c=t("./PhaseBoxItemUI2"),u=t("./RareTreasurePhaseBoxItemUI"),d=window.td,h=cc._decorator,p=h.ccclass,_=h.property,g=h.menu,f=t("PanelBase"),v=t("TabController"),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.btnMyNum=null,e.btnBuyRecord=null,e.btnWinRecord=null,e.myNumLayer=null,e.buyRecordLayer=null,e.winRecordLayer=null,e._controller=null,e}return n(e,t),e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._initSubLayer(),this._togGroup||(this._togGroup=new v,this.btnMyNum._tag=r.MY_RECORD_LAYERS.MY_NUMS,this.btnBuyRecord._tag=r.MY_RECORD_LAYERS.BUY_RECORDS,this.btnWinRecord._tag=r.MY_RECORD_LAYERS.WIN_RECORDS,this._togGroup.init([this.btnMyNum,this.btnBuyRecord,this.btnWinRecord],this))},e.prototype.onDisable=function(){d.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),c.default.CurSelectId=null,u.default.CurSelectId=null},e.prototype.init=function(){this._panelType=d.PanelType.Window,this._panelEnum=d.PanelEnum.Window_RareTreasureMyRecords},e.prototype.setData=function(){this._togGroup.showTab(r.MY_RECORD_LAYERS.MY_NUMS)},e.prototype._initSubLayer=function(){this._controller=d.ActivityDataManager.getActivityControllerByType(d.ActivityEnum.ActivityType.ACTIVITY_TYPE_10),this.myNumLayer&&this.myNumLayer.init(this._controller),this.buyRecordLayer&&this.buyRecordLayer.init(this._controller),this.winRecordLayer&&this.winRecordLayer.init(this._controller)},e.prototype.showTab=function(t){this._curLayerType!==t&&(this._curLayerType=t,this.myNumLayer.node.active=this._curLayerType==r.MY_RECORD_LAYERS.MY_NUMS,this.buyRecordLayer.node.active=this._curLayerType==r.MY_RECORD_LAYERS.BUY_RECORDS,this.winRecordLayer.node.active=this._curLayerType==r.MY_RECORD_LAYERS.WIN_RECORDS)},a([_(cc.Node)],e.prototype,"btnMyNum",void 0),a([_(cc.Node)],e.prototype,"btnBuyRecord",void 0),a([_(cc.Node)],e.prototype,"btnWinRecord",void 0),a([_(o.default)],e.prototype,"myNumLayer",void 0),a([_(s.default)],e.prototype,"buyRecordLayer",void 0),a([_(l.default)],e.prototype,"winRecordLayer",void 0),e=a([p,g("module/Activity/RareTreasure/MyRecordsWindow")],e)}(f);i.default=m,cc._RF.pop()},{"./BuyRecordsLayer":"BuyRecordsLayer","./MyNumRecordsLayer":"MyNumRecordsLayer","./PhaseBoxItemUI2":"PhaseBoxItemUI2","./RareTreasureEnums":"RareTreasureEnums","./RareTreasurePhaseBoxItemUI":"RareTreasurePhaseBoxItemUI","./WinRecordsLayer":"WinRecordsLayer",PanelBase:void 0,TabController:void 0}],NationBaseInfo:[function(t,e,i){"use strict";cc._RF.push(e,"0613dx14+5MFpni/2N2kR3z","NationBaseInfo");var n=window.td,a=t("NationSimpleInfo"),r=function(){function t(){this._fund=0,this._limitType=0,this._actorCount=0,this._limitMemberCount=0,this._needExp=0,this._warBaseRewardCount=0}return t.prototype.init=function(t){this._nationSimpleVO=new a,this._nationSimpleVO.init(t.simpleVO);var e=this._fund;this._fund=t.fund||0,this._actorCount=t.actorCount||0,e!==this._fund&&n.EventUtil.dispatchEvent(n.EventNameEnum.USER_ATTR_NATION_FUND_CHANGE),void 0!==t.limit&&(this._limitType=parseInt(t.limit.type),this._limitValue=t.limit.value);var i=n.GetTableClass(n.TableEnum.NationLevelTable).getDataByLevel(this._nationSimpleVO.getLevel());if(i){this._limitMemberCount=i.memberCount,this._needExp=i.needExp,this._warBaseRewardCount=i.warBaseRewardCount;var r=i.officerCount;this._officerCount={};for(var o=0,s=r.length;o<s;o++){var l=r[o];this._officerCount[l[0]]=l[1]}}},t.prototype.getMemberTypeLimitCount=function(t){return this._officerCount&&this._officerCount[t]?this._officerCount[t]:0},t.prototype.getNeedExp=function(){return this._needExp},t.prototype.getId=function(){return this._nationSimpleVO?this._nationSimpleVO.getId():0},t.prototype.getArmyName=function(){return this._nationSimpleVO?this._nationSimpleVO.getName():""},t.prototype.getFlagId=function(){return this._nationSimpleVO?this._nationSimpleVO.getFlagId():1},t.prototype.getFlag=function(){return this._nationSimpleVO?this._nationSimpleVO.getFlag():""},t.prototype.getLevel=function(){return this._nationSimpleVO.getLevel()},t.prototype.getKingName=function(){return this._nationSimpleVO.getKingName()},t.prototype.getKingServerId=function(){return this._nationSimpleVO.getKingServerId()},t.prototype.getNationSimpleInfo=function(){return this._nationSimpleVO},t.prototype.getLimitType=function(){return this._limitType},t.prototype.getActorCount=function(){return this._actorCount},t.prototype.getLimitValue=function(){return this._limitValue},t.prototype.getFund=function(){return this._fund},t.prototype.getMemberCount=function(){return this._nationSimpleVO.getMemberCount()},t.prototype.getLimitMemberCount=function(){return this._limitMemberCount},t}();e.exports=r,cc._RF.pop()},{NationSimpleInfo:"NationSimpleInfo"}],NationBeastFoodModel:[function(t,e,i){"use strict";cc._RF.push(e,"9595dXFzEJGQLRfyJL3yTjx","NationBeastFoodModel");var n=window.td,a=function(){function t(){}return t.prototype.setData=function(t){t&&(this._id=t.id,this._cost=n.RewardManager.parseRewardListDetail(t.cost),this._growthValue=t.growthValue,this._rewards=n.RewardManager.parseRewardListDetail(t.rewards))},t.prototype.getId=function(){return this._id},t.prototype.getCost=function(){return this._cost},t.prototype.getGrowthValue=function(){return this._growthValue},t.prototype.getRewards=function(){return this._rewards},t}();e.exports=a,cc._RF.pop()},{}],NationBeastFoodTable:[function(t,e,i){"use strict";cc._RF.push(e,"51ff187L5tIBofDhAVzkKY1","NationBeastFoodTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationBeastFoodTable",e._tblName="nation_holy_beast_food_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getData=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationBeastInfoModel:[function(t,e,i){"use strict";cc._RF.push(e,"6c114w3cbRJXJiWRPE7b4D1","NationBeastInfoModel");var n=window.td,a=function(){function t(){this._hp=0}return t.prototype.setData=function(t){t&&(this._nationId=t.nationId,this._id=t.id,this._hp=t.hp||0,this._leftHp=t.leftHp,this._growthValue=t.growthValue,this._openTime=t.openTime,this._feedActorIdList=t.feedActorIdList,this._challengeActorIdList=t.challengeActorIdList,this._receiveRewardMap=t.holyBeastRewardList,this._inspire=t.inspire,this._receiveReward=t.receiveReward,this._allowOpen=t.allowOpen,this._state=t.state,this._luckyDrawMap=t.luckList,this._nextChallengeTime=t.nextChallengeTime,this._autoCombat=t.autoCombat)},t.prototype.getNationId=function(){return this._nationId},t.prototype.getConfigId=function(){return this._id},t.prototype.getLeftHp=function(){return this._leftHp},t.prototype.getHp=function(){return this._hp},t.prototype.getGrowthValue=function(){return this._growthValue},t.prototype.getOpenTime=function(){return this._openTime},t.prototype.getCloseTime=function(){var t=this.getOpenTime();if(!t)return 0;var e=n.TimeUtil.getStampZeroPoint(t),i=n.GetConfig("HOLY_BEAST_OPEN_TIME")[1].toString(),a=i.substr(0,2),r=i.substr(2,2);return this._closeTime=e+60*a*60*1e3+60*r*1e3,this._closeTime},t.prototype.getFeedActorIdList=function(){return this._feedActorIdList||[]},t.prototype.getChallengeActorIdList=function(){return this._challengeActorIdList||[]},t.prototype.getReceiveRewardMap=function(){return this._receiveRewardMap},t.prototype.getInspireTimes=function(){return this._inspire},t.prototype.getReceiveRewardState=function(){return this._receiveReward},t.prototype.getIsAllowOpen=function(){return this._allowOpen},t.prototype.getState=function(){return this._state},t.prototype.getLuckyDrawMap=function(){return this._luckyDrawMap||[]},t.prototype.getNextChallengeTime=function(){return this._nextChallengeTime||0},t.prototype.isAutoBattle=function(){return this._autoCombat},t}();e.exports=a,cc._RF.pop()},{}],NationBeastManager:[function(t,e,i){"use strict";cc._RF.push(e,"131b4RtZJND5rgUSv8cpSJn","NationBeastManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("NationBeastInfoModel"),r=t("NationBeastModel"),o=t("NationBeastFoodModel"),s=t("../Enum/NationEnum"),l=t("./NationMainManager"),c=function(){function t(){this._damageList=null,this._isDamageInit=!1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._hadEnterNationBeast=null,this._hadEnterFeed=null,this._hadChallenge=null,this._enterReward=null,this._nationBeastList=null,this._nationBeastFoodList=null,this._nationBeastFoodArray=null,this._showHomePageNationBeastBtnAnim=!0,this.initData.hasInit=!1},t.prototype.addListener=function(){var t=n.MsgModuleName.NATIONBEAST,e=n.MsgCmd.NATIONBEAST,i=n.ServerDelegate;i.registerMessage(t,e.HOLY_BEAST,this._parseNationBeastInfo.bind(this)),i.registerMessage(t,e.CHALLENGE,this._parseChallengeReturn.bind(this)),i.registerMessage(t,e.FEED,this._parseFeedReturn.bind(this)),i.registerMessage(t,e.OPEN,this._parseOpenReturn.bind(this)),i.registerMessage(t,e.INSPIRE,this._parseInspireReturn.bind(this)),i.registerMessage(t,e.RECEIVE_REWARD,this._parseReceiveRewardReturn.bind(this)),i.registerMessage(t,e.PUSH_HOLY_BEAST_INFO,this._pushBeastInfoReturn.bind(this)),i.registerMessage(t,e.PUSH_HOLY_BEAST_AUTO_COMBAT_DAMAGE,this._parseBeastDamage.bind(this))},t.prototype.addEventListener=function(){var t=n.EventNameEnum,e={};e[t.REQUEST_NATION_BEAST_INFO]=this._requestNationBeastInfo,e[t.REQUEST_CHALLENGE_BEAST]=this._requestBeastChallenge,e[t.REQUEST_AUTO_CHALLENGE_BEAST]=this._requestBeastAutoChallenge,e[t.REQUEST_FEED_BEAST]=this._requestBeastFeed,e[t.REQUEST_OPEN_BEAST]=this._requestNationBeastOpen,e[t.REQUEST_INSPIRE_BEAST]=this._requestBeastInspire,e[t.RECEIVE_BEAST_REWARD]=this._requestReceiveBeastReward,n.EventUtil.registerEvents(e,this)},t.prototype._requestNationBeastInfo=function(t){if(n.UnlockManager.isTargetUnlock(n.ActorUnlockType.HOLY_BEAST,0)){var e={};e.module=n.MsgModuleName.NATIONBEAST,e.cmd=n.MsgCmd.NATIONBEAST.HOLY_BEAST,n.ServerDelegate.sendMessage(e)}},t.prototype._requestBeastChallenge=function(t){var e={};e.module=n.MsgModuleName.NATIONBEAST,e.cmd=n.MsgCmd.NATIONBEAST.CHALLENGE,n.ServerDelegate.sendMessage(e)},t.prototype._requestBeastAutoChallenge=function(t){var e={};e.module=n.MsgModuleName.NATIONBEAST,e.cmd=n.MsgCmd.NATIONBEAST.AUTO_COMBAT,e.state=t,n.ServerDelegate.sendMessage(e)},t.prototype._requestBeastFeed=function(t){var e={};e.module=n.MsgModuleName.NATIONBEAST,e.cmd=n.MsgCmd.NATIONBEAST.FEED,e.foodId=t.foodId,e.num=t.num,n.ServerDelegate.sendMessage(e)},t.prototype._requestNationBeastOpen=function(t){var e={};e.module=n.MsgModuleName.NATIONBEAST,e.cmd=n.MsgCmd.NATIONBEAST.OPEN,n.ServerDelegate.sendMessage(e)},t.prototype._requestBeastInspire=function(t){var e={};e.module=n.MsgModuleName.NATIONBEAST,e.cmd=n.MsgCmd.NATIONBEAST.INSPIRE,n.ServerDelegate.sendMessage(e)},t.prototype._requestReceiveBeastReward=function(t){var e={};e.module=n.MsgModuleName.NATIONBEAST,e.cmd=n.MsgCmd.NATIONBEAST.RECEIVE_REWARD,e.positionId=t.locationId,n.ServerDelegate.sendMessage(e)},t.prototype._parseNationBeastInfo=function(t,e){t===n.NetCode.SUCCESS&&(this._nationBeastInfo||(this._nationBeastInfo=new a),this._nationBeastInfo.setData(e),this._setDamageList(e.damageList),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_BEAST_INFO))},t.prototype._parseChallengeReturn=function(t,e){t===n.NetCode.SUCCESS&&this.setHadChallenge()},t.prototype._parseFeedReturn=function(t,e){if(t===n.NetCode.SUCCESS){var i=n.RewardManager.parseRewardResult(e.rewardResult,!0);n.GlobalFunction.showRewards(i);var a=new n.BroadcastContent(355),r=new n.BroadcastParam(e.growthValue);a.setMainParam([r]),n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_BROADCAST,a)}},t.prototype._parseOpenReturn=function(t,e){n.NetCode.SUCCESS},t.prototype._parseInspireReturn=function(t,e){if(t===n.NetCode.SUCCESS){var i=n.RewardManager.parseRewardResult(e.rewardResult,!0);n.GlobalFunction.showRewards(i);var a=new n.BroadcastContent(358),r=n.GetConfig("HOLY_BEAST_INSPIRE_ATTACK")/100+"%",o=new n.BroadcastParam(r);a.setMainParam([o]),n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_BROADCAST,a)}},t.prototype._parseReceiveRewardReturn=function(t,e){if(t===n.NetCode.SUCCESS){var i=n.RewardManager.parseRewardResult(e.rewardResult,!0);n.GlobalFunction.showRewards(i)}},t.prototype._pushBeastInfoReturn=function(t,e){t===n.NetCode.SUCCESS&&(this._nationBeastInfo||(this._nationBeastInfo=new a),this._nationBeastInfo.setData(e),this._setDamageList(e.damageList),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_BEAST_INFO))},t.prototype._parseBeastDamage=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.value||0;n.EventUtil.dispatchEvent(n.EventNameEnum.PUSH_BEAST_DAMAGE,i)}},t.prototype._setDamageList=function(t){var e=[];this._isDamageInit&&(e=this._setNewDamageList(t)),this._damageList=t,this._damageList.length>0&&(this._damageList[0].isFirst=!0),this._nationBeastInfo.getLeftHp()<=0&&this._damageList.length>0&&(this._damageList[this._damageList.length-1].isLast=!0),this._damageList.sort(function(t,e){return t.time-e.time}),this._isDamageInit=!0,e.length>0&&n.EventUtil.dispatchEvent(n.EventNameEnum.ON_GET_BEAST_FIGHTED,e)},t.prototype._setNewDamageList=function(t){var e=this;if(null!=t){var i=this._damageList||[],n=[];return i.concat(t).forEach(function(a){e._isDataExist(t,a)&&!e._isDataExist(i,a)&&n.push(a)}),n}},t.prototype._isDataExist=function(t,e){for(var i=0;i<t.length;i++){var n=t[i];if(n.time==e.time&&n.damage==e.damage)return!0}return!1},t.prototype.getNationBeastInfo=function(){return this._nationBeastInfo},t.prototype.getNationBeastState=function(){var t=this.getNationBeastInfo(),e=t&&t.getState();return e||cc.log("nationBeast state not open!"),e},t.prototype.initData=function(){if(!this.initData.hasInit){this._nationBeastList={};var t=n.GetTableClass(n.TableEnum.NationBeastTable).getData();for(var e in this.maxStar=0,this.maxConfigId=0,t){var i=t[e];(l=new r).setData(i),l.getStar()>this.maxStar&&(this.maxStar=l.getStar());var a=l.getId();a>this.maxConfigId&&(this.maxConfigId=a),this._nationBeastList[a]=l}this._nationBeastFoodList={},this._nationBeastFoodArray=[];var s=n.GetTableClass(n.TableEnum.NationBeastFoodTable).getData();for(var e in s){var l;i=s[e];(l=new o).setData(i);l.getCost();this._nationBeastFoodList[e]=l,this._nationBeastFoodArray.push(l)}this._goodsIdList={};var c=n.GetConfig("HOLY_BEAST_INSPIRE_TIMES_COST");this._inspireCost={};for(var u=0,d=c.length;u<d;u++){i=c[u];this._inspireCost[i[0]]=n.RewardManager.getRewardDetail(i[1])}this.initData.hasInit=!0}},t.prototype.getMaxStar=function(){return this.maxStar||7},t.prototype.getNationBeastConfigData=function(){return this._nationBeastList||this.initData(),this._nationBeastList},t.prototype.getBossDataByConfigId=function(t){return this.getNationBeastConfigData()[t]},t.prototype.getBeastFoodArray=function(){return this._nationBeastFoodArray||this.initData(),this._nationBeastFoodArray},t.prototype.getRewardQuality=function(t){this._goodsIdList||this.initData();var e=this._goodsIdList,i=t.getId();for(var n in e){var a=e[n];if(ArrayUtils.contains(a,i))return n}return null},t.prototype.getInspireCost=function(){this._inspireCost||this.initData();var t,e=this._inspireCost,i=this.getNationBeastInfo().getInspireTimes();for(var n in e){if(!(i+1>=n))break;t=e[n]}return t},t.prototype.getCanReceiveBoxReward=function(){var t=this.getNationBeastInfo();if((t&&t.getState())!==s.NationBeastState.Kill)return!1;var e=t.getReceiveRewardState()===s.NationBeastRewardState.Received,i=t.getFeedActorIdList(),a=t.getChallengeActorIdList(),r=n.Account.getUserData().getGamerId();return!e&&(ArrayUtils.contains(i,r)||ArrayUtils.contains(a,r))},t.prototype.getCanReceiveBigRewardNum=function(){return this.getNationBeastInfo().getChallengeActorIdList().length},t.prototype.getBossConfigData=function(){var t=this.getNationBeastInfo().getConfigId();return this.getBossDataByConfigId(t)},t.prototype.getCanBuyFoodCount=function(t){var e=this._nationBeastInfo.getConfigId();if(e==this.maxConfigId-1){var i=this.getBossDataByConfigId(e).getGrowthValue(),n=this._nationBeastInfo.getGrowthValue(),a=this.getBeastFoodArray()[t].getGrowthValue();return Math.ceil((i-n)/a)}return 9999},t.prototype.enterNationBeast=function(){this._hadEnterNationBeast=!0},t.prototype.enterFeedBeast=function(){if(!this._hadEnterFeed){var t=n.TimeUtil.getServerDate().getDate();n.LocalStorageUtil.write("nationBeastFeedEnter",t)}this._hadEnterFeed=!0},t.prototype.setHadChallenge=function(){this._hadChallenge=!0},t.prototype.setHadEnterReward=function(){this._enterReward=!0},t.prototype.setShowHomePageNationBeastAnim=function(t){this._showHomePageNationBeastBtnAnim=t},t.prototype.getRecordMsgs=function(){var t=this._damageList.length>=6?this._damageList.length-6:0;return this._damageList.slice(t,this._damageList.length)},t.prototype.isBeastFightOpen=function(){var t=this.getNationBeastInfo();if(null==t)return!1;var e=t.getIsAllowOpen(),i=t.getState();return!e&&i===s.NationBeastState.Battle},t.prototype.isShowHomePageNationBeastAnim=function(){return this._showHomePageNationBeastBtnAnim},t.prototype.isShowMainEnterNationBeast=function(){return l.default.getInstance().isJoinNation()&&this.getNationBeastState()===s.NationBeastState.Battle},t.prototype.entryRedPointTip=function(){return!!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.HOLY_BEAST,0)&&(this.bossBtnRedPointTip()||this.feedBtnRedPointTip()||this.boxRewardTip())},t.prototype.feedBtnRedPointTip=function(){var t=this.getNationBeastState()===s.NationBeastState.Feed,e=!0;if(!this._hadEnterFeed){var i=n.LocalStorageUtil.read("nationBeastFeedEnter");if(i)n.TimeUtil.getServerDate().getDate()==i&&(e=!1)}return t&&!this._hadEnterFeed&&e},t.prototype.bossBtnRedPointTip=function(){var t=this.getNationBeastState();return!this._hadChallenge&&t===s.NationBeastState.Battle},t.prototype.boxRewardTip=function(){return this.getNationBeastState()===s.NationBeastState.Kill&&this.getCanReceiveBoxReward()},t.prototype.redPointEvts=function(){return[n.EventNameEnum.REFRESH_BEAST_INFO,n.EventNameEnum.Res_NATION_GET_ACTOR]},t}();i.default=c,cc._RF.pop()},{"../Enum/NationEnum":"NationEnum","./NationMainManager":"NationMainManager",NationBeastFoodModel:"NationBeastFoodModel",NationBeastInfoModel:"NationBeastInfoModel",NationBeastModel:"NationBeastModel"}],NationBeastModel:[function(t,e,i){"use strict";cc._RF.push(e,"65ee8u0eS1LjJa9v1tpyQpy","NationBeastModel");var n=t("MonsterModel"),a=window.td,r=function(){function t(){}return t.prototype.setData=function(t){if(t){if(this._randomReward=t.randomReward,this._randomReward instanceof Array)for(var e=[],i=0,n=this._randomReward.length;i<n;i++){var r=a.RewardManager.getRewardDetail(this._randomReward[i][0]);e.push(r)}this._randomReward=e,this._luckRewards=a.RewardManager.parseRewardListDetail(t.luckRewards),this._id=t.id,this._star=t.star,this._bossId=t.bossId,this._growthValue=t.growthValue,this._showLevel=t.showLevel,this._deswords=t.deswords,this._setMonster()}},t.prototype._setMonster=function(){var t=a.GetTableClass(a.TableEnum.Monster).getMonsterDataById(this._bossId);t&&(this._monsterData=new n,this._monsterData.init(t))},t.prototype.getMonster=function(){return this._monsterData},t.prototype.getId=function(){return this._id},t.prototype.getStar=function(){return this._star},t.prototype.getBossId=function(){return this._bossId},t.prototype.getRandomReward=function(){return this._randomReward},t.prototype.getLuckRewards=function(){return this._luckRewards},t.prototype.getGrowthValue=function(){return this._growthValue},t.prototype.getShowLevel=function(){return this._showLevel},t.prototype.getDes=function(){return this._deswords||""},t}();e.exports=r,cc._RF.pop()},{MonsterModel:"MonsterModel"}],NationBeastTable:[function(t,e,i){"use strict";cc._RF.push(e,"dc0d8FPGhdIPojX4T2F1wof","NationBeastTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationBeastTable",e._tblName="nation_holy_beast_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getData=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationBossActorScoreRankRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"3b606IHbslK8Z7G6i5wir3v","NationBossActorScoreRankRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationBossActorScoreRankRewardConfig",e._tblName="nation_boss_actor_score_rank_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}t.sort(function(t,e){return t.rank-e.rank});for(var r=0,o=t.length;r<o;r++){var s=t[r];s.maxRank=s.rank,s.minRank=t[r-1]?t[r-1].rank+1:s.rank}},e.prototype.getRankRewardConfigs=function(){return this._data},e.prototype.getDataByRank=function(t){if(this._data)for(var e=this._data,i=0,n=e.length;i<n;i++){var a=e[i];if(a.minRank<=t&&a.maxRank>=t)return a}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationBossConfig:[function(t,e,i){"use strict";cc._RF.push(e,"f35adH6nKBEHb7+sm+ldifA","NationBossConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationBossConfig",e._tblName="nation_boss_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];this._data[this._data.length]=n}},e.prototype.getAllBossData=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationBossManager:[function(t,e,i){"use strict";cc._RF.push(e,"eb53a2pbr1JPI2fJdM92zfE","NationBossManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("./NationMainManager"),r=t("../Enum/NationEnum"),o=t("NationBossModel"),s=t("NationRankInfo"),l=t("ActorRankModel"),c=t("NationBossTaskModel"),u=t("NationBossRecord"),d=function(){function t(){this._taskGroupId=0,this._bGetNewRecord=!1,this._isSweep=!1,this._challengeBossId=0,this._isToChallenge=!1,this._isFirstSetData=!0}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._nationBossList={},this._unlockDifficultList={},this._nationRankList=[],this._myNationRankInfo=null,this._actorRankList=[],this._taskList=[],this._myActorRankInfo=null,this._recordList=[],this._bGetNewRecord=!1,this._isSweep=!1,this._taskGroupId=0,this._curBossId={},this._hpList={},this._toDeadList={},this._sweepList={},this._isToChallenge=!1,this._isFirstSetData=!0},t.prototype.addEventListener=function(){var t={},e=n.EventNameEnum;t[e.REQUEST_NATION_BOSS_INFO]=this.requestNationBossInfo,t[e.REQUEST_CHALLENGE_NATION_BOSS]=this.requestChallengeNationBoss,t[e.REQUEST_BUY_NB_CHALLENGE_TIMES]=this.requestBuyNationBossChallengeTimes,t[e.REQUEST_NATION_BOSS_REWARD]=this._requestReceiveBossReward,t[e.REQ_GET_ALL_NATION_BOSS_REWARD]=this._requestOneKeyReceiveBossReward,t[e.REQ_GET_NATION_BOSS_TASK]=this._requestReceiveBossTask,t[e.REQ_GET_ALL_NATION_BOSS_TASK]=this._requestOneKeyReceiveBossTask,t[e.REQUEST_NATION_BOSS_RANK]=this._requestBossRank,t[e.REQUEST_NATION_BOSS_RECORD]=this._requestBossRecord,t[e.REFRESH_NB_CHALLENGE_TIMES]=this._updateTaskList,t[e.NATION_BOSS_TASK_STATUS_UPDATED]=this._updateTaskList,t[e.NATION_BOSS_TASK_GROUP_ID_CHANGED]=this._updateTaskGroupId,n.EventUtil.registerEvents(t,this)},t.prototype.addListener=function(){var t=n.MsgModuleName.NationBoss,e=n.MsgCmd.NationBoss,i=n.ServerDelegate;i.registerMessage(t,e.GET_NATION_BOSS_INFO,this.parseNationBossInfo.bind(this)),i.registerMessage(t,e.CHALLENGE_NATION_BOSS,this.challengeNationBossReturn.bind(this)),i.registerMessage(t,e.BUY_CHALLENGE_TIMES,this.buyChallengeTimesReturn.bind(this)),i.registerMessage(t,e.PUSH_NATION_BOSS_INFO,this.parseNationBossInfo.bind(this)),t=n.MsgModuleName.NATION,e=n.MsgCmd.NATION,i.registerMessage(t,e.NATION_BOSS_RECEIVE,this._onReceiveBossReward.bind(this)),i.registerMessage(t,e.NATION_BOSS_SCORE_TASK_RECEIVE,this._onReceiveBossReward.bind(this)),i.registerMessage(t,e.NATION_BOSS_SCORE_TASK_QUICK_RECEIVE,this._onReceiveBossReward.bind(this)),i.registerMessage(t,e.NATION_BOSS_NATION_SCORE_RANK,this._onGetBossNationRank.bind(this)),i.registerMessage(t,e.NATION_BOSS_ACTOR_SCORE_RANK,this._onGetBossActorRank.bind(this)),i.registerMessage(t,e.NATION_BOSS_RECORD,this._parseBossRecord.bind(this)),i.registerMessage(t,e.PUSH_NATION_BOSS_RECORD,this._parseBossRecord.bind(this))},t.prototype.isInChallengeTime=function(){var t=n.TimeUtil.getTime(),e=n.GetConfig("NATION_BOSS_ATTACK_TIME"),i=e[0],a=e[1],r=n.TimeUtil.getStampByHours(i+":00"),o=n.TimeUtil.getStampByHours(a+":00");return t>=r&&t<=o},t.prototype.getBossDataById=function(t){return this._nationBossList&&this._nationBossList[t]?this._nationBossList[t]:null},t.prototype.getBossListByDifficult=function(t){var e=[];if(!this._nationBossList||0===this._nationBossList.myLen())return e;var i=this._nationBossList;for(var n in i){var a=i[n];a.getDifficult()===t&&(e[e.length]=a)}return e},t.prototype.canChallengeForDifficult=function(t){return this._unlockDifficultList[t]},t.prototype.getNationBossScore=function(){var t=a.default.getInstance().getNationInfo();return t?t.getNationBossScore():0},t.prototype.isBossRewardReceived=function(t){var e=a.default.getInstance().getNationInfo();if(!e)return!1;var i=e.getNationBossRewardStatus();return!(!i||0===i.length)&&ArrayUtils.contains(i,t)},t.prototype.getLeftChallengeTimes=function(){var t=n.GetConfig("NATION_BOSS_ATTACK_TIMES"),e=a.default.getInstance().getNationInfo();return e.getNationBossBoughtTimes()+t-e.getNationBossChallengedTimes()},t.prototype.calcBuyChallengeTimesCost=function(t){for(var e,i=n.GlobalFunction,r="NATION_BOSS_BUY_ATTACK_TIMES_COST",o=a.default.getInstance().getNationInfo().getNationBossBoughtTimes(),s=1+o;s<=t+o;s++)e?e.setCount(e.getCount()+i.getShareConfigUpCostCount(r,s)):e=i.getShareConfigUpCostDetail(r,s);return e},t.prototype.getNationBossRankList=function(t){switch(t){case r.NationBossRankType.Personal:return this._actorRankList;case r.NationBossRankType.National:return this._nationRankList}return[]},t.prototype.getNationBossMyRankInfo=function(t){switch(t){case r.NationBossRankType.Personal:return this._myActorRankInfo;case r.NationBossRankType.National:return this._myNationRankInfo}return null},t.prototype.getNationBossRecord=function(){return this._recordList},t.prototype.isReceivedNewRecord=function(){var t=this._bGetNewRecord;return this._bGetNewRecord=!1,t},t.prototype.setIsSweep=function(t){this._isSweep=t},t.prototype.getIsSweep=function(){return this._isSweep},t.prototype.getCurChallengeBossId=function(){return this._challengeBossId},t.prototype.getCurUnlockBossId=function(t){return this._curBossId&&this._curBossId[t]?this._curBossId[t]:0},t.prototype.getCurChallengeScore=function(t){return this._challengeBossId?this.getBattleScore(this._challengeBossId,t):1},t.prototype.getBattleScore=function(t,e){if(!e)return 1;var i=this._nationBossList[t];if(!i)return 1;var a=i.getTotalHp(),r=n.PercentNumberUtil.getValuePercent(e,a),o=n.PercentNumberUtil.getPercentValue(i.getScore(),r);return o=Math.max(o,1)},t.prototype.getBossTaskList=function(){return this._taskList},t.prototype.isBossRewardReceivedFull=function(){var t=a.default.getInstance().getNationInfo();return!!t&&t.getNationBossRewardStatus().length>=n.GetConfig("NATION_BOSS_RECEIVE_REWARD_TIMES")},t.prototype.isBossChangeToDead=function(t){var e=this._toDeadList[t];return delete this._toDeadList[t],e},t.prototype.clearSweepList=function(){this._sweepList={}},t.prototype.getSweepList=function(t){return this._sweepList[t]},t.prototype.isToChallenge=function(){return this._isToChallenge},t.prototype.resetToChallengeState=function(){this._isToChallenge=!1},t.prototype._updateTaskGroupId=function(t){t!==this._taskGroupId&&(this._taskGroupId=t,this._initTaskList()),n.EventUtil.dispatchEvent(n.EventNameEnum.NATION_BOSS_TASK_CHANGED)},t.prototype._updateTaskList=function(){var t=a.default.getInstance().getNationInfo();if(t){for(var e=t.getNationBossScore(),i=t.getNationBossTaskStatus(),r=this._taskList,o=0,s=r.length;o<s;o++){var l=r[o];ArrayUtils.contains(i,l.getTaskId())?l.setRewardStatus(n.RewardStatus.RECEIVED):e>=l.getNeedScore()&&l.setRewardStatus(n.RewardStatus.CAN_RECEIVE)}r.sort(function(t,e){return t.getRewardStatus()!==e.getRewardStatus()?t.getRewardStatus()-e.getRewardStatus():t.getNeedScore()-e.getNeedScore()})}},t.prototype.getCanReceiveRewardBossIds=function(t){var e=[];if(!t)return e;var i=this._nationBossList;for(var n in i){var a=i[n],r=a.getDifficult();if(r>t)break;r===t&&a.isKilled()&&!this.isBossRewardReceived(a.getBossId())&&(e[e.length]=a.getBossId())}return e=e.reverse()},t.prototype.getAllCanReceiveRewardBossIds=function(){var t=[],e=this._nationBossList;for(var i in e){var n=e[i],a=0===n.getNextBossId(),r=n.getDeadTime();n.isKilled()&&!this.isBossRewardReceived(n.getBossId())?t[t.length]=n.getBossId():a&&r&&!this.isBossRewardReceived(n.getBossId())&&(t[t.length]=n.getBossId())}return t=t.reverse()},t.prototype.requestNationBossInfo=function(){var t={};t.module=n.MsgModuleName.NationBoss,t.cmd=n.MsgCmd.NationBoss.GET_NATION_BOSS_INFO,n.ServerDelegate.sendMessage(t)},t.prototype.parseNationBossInfo=function(t,e){if(t===n.NetCode.SUCCESS){var i=!1;this._nationBossList&&0!==this._nationBossList.myLen()||(this._initNationBoss(),i=!0),this._unlockDifficultList={};var a=e.nationBossVOs;if(a&&!(a.length<=0)){this._curBossId={},this._toDeadList={},this._sweepList={};for(var r=0,o=a.length;r<o;r++){var s=a[r],l=s.nationBossId,c=s.leftHP,u=s.deadTime,d=this._nationBossList[l],h=0===d.getNextBossId();if(d){var p=d.getBossId();d.setCurLeftHp(c,i),(!i&&this._hpList[p]>0&&0===c||h&&!this._isFirstSetData&&u&&u!==d.getDeadTime())&&(this._toDeadList[p]=!0,h&&(this._sweepList[p]=!0)),this._hpList[p]=c,d.setDeadTime(s.deadTime),d.setCanSweep(s.sweepState);var _=d.getDifficult();this._unlockDifficultList[_]=!0,this._curBossId[_]?this._curBossId[_]=Math.max(this._curBossId[_],p):this._curBossId[_]=p}}this._isFirstSetData=!1,n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_NATION_BOSS_INFO,!0)}}},t.prototype.requestChallengeNationBoss=function(t){var e={};e.module=n.MsgModuleName.NationBoss,e.cmd=n.MsgCmd.NationBoss.CHALLENGE_NATION_BOSS,e.id=t,this._challengeBossId=t,!this._isSweep&&(this._isToChallenge=!0),n.ServerDelegate.sendMessage(e)},t.prototype.challengeNationBossReturn=function(t,e){t===n.NetCode.SUCCESS||this.resetToChallengeState()},t.prototype.requestBuyNationBossChallengeTimes=function(t){var e={};e.module=n.MsgModuleName.NationBoss,e.cmd=n.MsgCmd.NationBoss.BUY_CHALLENGE_TIMES,e.times=t,n.ServerDelegate.sendMessage(e)},t.prototype.buyChallengeTimesReturn=function(t,e){n.NetCode.SUCCESS},t.prototype._requestReceiveBossReward=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_BOSS_RECEIVE,e.ids=[t],n.ServerDelegate.sendMessage(e)},t.prototype._requestOneKeyReceiveBossReward=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_BOSS_RECEIVE,e.ids=t,n.ServerDelegate.sendMessage(e)},t.prototype._requestReceiveBossTask=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_BOSS_SCORE_TASK_RECEIVE,e.id=t,n.ServerDelegate.sendMessage(e)},t.prototype._requestOneKeyReceiveBossTask=function(){var t={};t.module=n.MsgModuleName.NATION,t.cmd=n.MsgCmd.NATION.NATION_BOSS_SCORE_TASK_QUICK_RECEIVE,n.ServerDelegate.sendMessage(t)},t.prototype._onReceiveBossReward=function(t,e){if(t===n.NetCode.SUCCESS){var i=n.RewardManager.parseRewardResult(e.rewardResult);n.GlobalFunction.showRewards(i),n.EventUtil.dispatchEvent(n.EventNameEnum.ON_GET_NATION_BOSS_REWARD)}},t.prototype._requestBossRank=function(t){switch(t){case r.NationBossRankType.Personal:this._requestBossActorRank(1);break;case r.NationBossRankType.National:this._requestBossNationRank(1)}},t.prototype._requestBossNationRank=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_BOSS_NATION_SCORE_RANK,e.page=t||1,n.ServerDelegate.sendMessage(e)},t.prototype._onGetBossNationRank=function(t,e){if(t===n.NetCode.SUCCESS){var i=a.default.getInstance().isJoinNation(),o=e.ranks;this._nationRankList=[],i&&o.length>0&&(this._myNationRankInfo=new s,this._myNationRankInfo.init(o[o.length-1]),o.splice(o.length-1,1));for(var l=0,c=o.length;l<c;l++){var u=new s;u.init(o[l]),this._nationRankList[this._nationRankList.length]=u}n.EventUtil.dispatchEvent(n.EventNameEnum.ON_GET_NATION_BOSS_RANK,r.NationBossRankType.National)}},t.prototype._requestBossActorRank=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_BOSS_ACTOR_SCORE_RANK,e.page=t||1,n.ServerDelegate.sendMessage(e)},t.prototype._onGetBossActorRank=function(t,e){if(t===n.NetCode.SUCCESS){var i=a.default.getInstance().isJoinNation(),o=e.ranks;this._actorRankList=[],i&&o.length>0&&(this._myActorRankInfo=new l,this._myActorRankInfo.init(o[o.length-1]),o.splice(o.length-1,1));for(var s=0,c=o.length;s<c;s++){var u=new l;u.init(o[s]),this._actorRankList[this._actorRankList.length]=u}n.EventUtil.dispatchEvent(n.EventNameEnum.ON_GET_NATION_BOSS_RANK,r.NationBossRankType.Personal)}},t.prototype._requestBossRecord=function(){var t={};t.module=n.MsgModuleName.NATION,t.cmd=n.MsgCmd.NATION.NATION_BOSS_RECORD,n.ServerDelegate.sendMessage(t)},t.prototype._parseBossRecord=function(t,e){if(t===n.NetCode.SUCCESS){for(var i=!1,a=[],r=e.records,o=0,s=r.length;o<s;o++){var l=r[o],c=new u;c.init(l),a[a.length]=c,i||(i=this._checkIsNewRecord(c.getTime()))}this._bGetNewRecord=i,this._recordList=a,this._recordList.sort(function(t,e){return e.getTime()-t.getTime()}),n.EventUtil.dispatchEvent(n.EventNameEnum.ON_GET_NATION_BOSS_RECORD)}},t.prototype._checkIsNewRecord=function(t){for(var e=0,i=this._recordList.length;e<i;e++){if(this._recordList[e].getTime()===t)return!1}return!0},t.prototype.isNationBossRedPointTips=function(){return!!(a.default.getInstance().isJoinNation()&&this.isInChallengeTime()&&n.UnlockManager.isTargetUnlock(n.ActorUnlockType.NATION_BOSS,0,!1))&&(this.getLeftChallengeTimes()>0||!(!this.haveBossRewardCanReceive()&&!this.haveBossTaskCanReceive()))},t.prototype.haveBossTaskCanReceive=function(){if(!a.default.getInstance().isJoinNation()||!this.isInChallengeTime()||!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.NATION_BOSS,0,!1))return!1;var t=this._taskList;if(!t||0===t.length)return!1;for(var e=0,i=t.length;e<i;e++){if(t[e].getRewardStatus()===n.RewardStatus.CAN_RECEIVE)return!0}return!1},t.prototype.haveBossRewardCanReceive=function(){for(var t in r.NationBossDifficult){var e=r.NationBossDifficult[t];if(this.haveBossRewardCanReceiveInDifficult(e))return!0}return!1},t.prototype.haveBossRewardCanReceiveInDifficult=function(t){if(!a.default.getInstance().isJoinNation()||!this.isInChallengeTime()||!n.UnlockManager.isTargetUnlock(n.ActorUnlockType.NATION_BOSS,0,!1))return!1;if(this.isBossRewardReceivedFull())return!1;var e=this._nationBossList;for(var i in e){var r=e[i];if(r.getDifficult()>t)break;if(!(r.getDifficult()<t)&&(r.isKilled()&&!this.isBossRewardReceived(r.getBossId())))return!0}return!1},t.prototype.nationBossRedPointEvents=function(){return[n.EventNameEnum.REFRESH_NATION_BOSS_INFO,n.EventNameEnum.ON_GET_NATION_BOSS_REWARD,n.EventNameEnum.REFRESH_NB_CHALLENGE_TIMES,n.EventNameEnum.Res_NATION_GET_ACTOR]},t.prototype._initNationBoss=function(){this._nationBossList={},this._hpList={};for(var t=n.GetTableClass(n.TableEnum.NationBossConfig).getAllBossData(),e=t.length-1;e>=0;e--){var i=t[e];if(i){var a=new o;a.init(i);var r=a.getBossId();this._nationBossList[r]=a;var s=a.getNextBossId(),l=this._nationBossList[s];l&&l.setFrontBossId(r),this._hpList[r]=a.getTotalHp()}}},t.prototype._initTaskList=function(){this._taskList=[];for(var t=n.GetTableClass(n.TableEnum.NationBossScoreTaskConfig).getNationBossScoreTaskConfigsByGroupId(this._taskGroupId),e=0,i=t.length;e<i;e++){var a=t[e],r=new c;r.init(a),this._taskList[this._taskList.length]=r}},t}();i.default=d,cc._RF.pop()},{"../Enum/NationEnum":"NationEnum","./NationMainManager":"NationMainManager",ActorRankModel:"ActorRankModel",NationBossModel:"NationBossModel",NationBossRecord:"NationBossRecord",NationBossTaskModel:"NationBossTaskModel",NationRankInfo:"NationRankInfo"}],NationBossModel:[function(t,e,i){"use strict";cc._RF.push(e,"96675TGt/9PraetWheGY3uJ","NationBossModel");var n=window.td,a=t("MonsterModel"),r=function(){function t(){this._bossId=0,this._nextBossId=0,this._frontBossId=0,this._nationExp=0,this._totalHp=0,this._leftHp=0,this._score=0,this._star=0,this._difficult=0,this._pos=cc.v2(0,0),this._canChallenge=!1,this._canSweep=!1,this._newUnlock=!1}return t.prototype.init=function(t){if(t){this._bossId=t.bossId,this._nextBossId=t.nextBossId,this._frontBossId=0;var e=t.monsterGroupId,i=n.GetTableClass(n.TableEnum.MonsterGroup).getMonsterGroupById(e);if(i&&i.group){for(var r=i.group,o=n.GetTableClass(n.TableEnum.Monster),s=0,l=n.GetTableClass(n.TableEnum.MonsterCapabilityConfig),c=0;c<r.length;c++){var u=r[c][0],d=o.getMonsterDataById(u);s+=l.getMonsterNumberDataById(d.capabilityId).hp}var h=i.groupLeader,p=o.getMonsterDataById(h);this._showMonster=new a,this._showMonster.init(p),this._totalHp=s,this._leftHp=this._totalHp,this._score=t.score,this._star=t.star,this._difficult=t.difficult;var _=t.position;this._pos=cc.v2(_[0],_[1]),this._nationExp=t.nationExp,this._challengeRewards=n.RewardManager.parseRewardListDetail(t.challengeRewards),this._killActorRewards=n.RewardManager.parseRewardListDetail(t.killActorRewards)}else cc.log("NationBossModel get boss group error for id = "+e)}},t.prototype.getBossId=function(){return this._bossId},t.prototype.getNextBossId=function(){return this._nextBossId},t.prototype.setFrontBossId=function(t){this._frontBossId=t},t.prototype.getFrontBossId=function(){return this._frontBossId},t.prototype.isKilled=function(){return this._leftHp<=0},t.prototype.setCurLeftHp=function(t,e){this._leftHp=t,this._newUnlock=!e&&!this._canChallenge&&t>0,this._canChallenge=!0},t.prototype.getCurLeftHp=function(){return this._leftHp},t.prototype.setCanSweep=function(t){this._canSweep=t},t.prototype.canSweep=function(){return this._canSweep},t.prototype.setDeadTime=function(t){this._deadTime=t},t.prototype.getDeadTime=function(){return this._deadTime},t.prototype.getTotalHp=function(){return this._totalHp},t.prototype.getShowMonster=function(){return this._showMonster},t.prototype.getNationExp=function(){return this._nationExp},t.prototype.getScore=function(){return this._score},t.prototype.getStar=function(){return this._star},t.prototype.getDifficult=function(){return this._difficult},t.prototype.getPosition=function(){return this._pos},t.prototype.getChallengeRewards=function(){return this._challengeRewards},t.prototype.getKillActorRewards=function(){return this._killActorRewards},t.prototype.canChallenge=function(){return this._canChallenge},t.prototype.isNewUnlock=function(){var t=this._newUnlock;return this._newUnlock=!1,t},t}();e.exports=r,cc._RF.pop()},{MonsterModel:"MonsterModel"}],NationBossNationScoreRankRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"16562NuvONG5otCmBjhZTDU","NationBossNationScoreRankRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationBossNationScoreRankRewardConfig",e._tblName="nation_boss_nation_score_rank_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}t.sort(function(t,e){return t.rank-e.rank});for(var r=0,o=t.length;r<o;r++){var s=t[r];s.maxRank=s.rank,s.minRank=t[r-1]?t[r-1].rank+1:s.rank}},e.prototype.getRankRewardConfigs=function(){return this._data},e.prototype.getDataByRank=function(t){if(this._data)for(var e=this._data,i=0,n=e.length;i<n;i++){var a=e[i];if(a.minRank<=t&&a.maxRank>=t)return a}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationBossRecord:[function(t,e,i){"use strict";cc._RF.push(e,"20c3ad7KGhJDJ8TH0gLEO8p","NationBossRecord");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("../Manager/NationBossManager"),r=window.td,o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._bossId=0,e._damage=0,e._time=0,e}return n(e,t),e.prototype.init=function(e,i){void 0===i&&(i="NationBossRecord"),e&&(t.prototype.init.call(this,i,e.attributes),this._bossId=e.bossId,this._damage=e.damage,this._time=e.time,this._rewards=r.RewardManager.parseRewardListDetail(e.rewards),this._quality=null)},e.prototype.getTime=function(){return this._time},e.prototype.getPreviewStr=function(){var t;return t=this._rewards.length>0?r.Language["#nationBoss4"]:r.Language["#nationBoss3"],this._getRecordStr(t)},e.prototype.getDetailStr=function(){var t;return t=this._rewards.length>0?r.Language["#nationBoss2"]:r.Language["#nationBoss1"],this._getRecordStr(t)},e.prototype._getRecordStr=function(t){if(!t)return"";var e=a.default.getInstance().getBossDataById(this._bossId);if(!e)return"";var i=e.getShowMonster(),n="";if(this._rewards&&this._rewards.length>0){this._quality=this._rewards[0].getQuality();for(var r=0,o=this._rewards.length;r<o;r++){var s=this._rewards[r];n+=s.getName()+"X"+s.getCount(),r!==o-1&&(n+=",")}}else n=this._damage.toString();return t=cc.js.formatStr(t,this.getServerNickName(),i.getName(),n)},e.prototype.getQuality=function(){return this._quality},e}(t("BaseUser"));e.exports=o,cc._RF.pop()},{"../Manager/NationBossManager":"NationBossManager",BaseUser:"BaseUser"}],NationBossScoreTaskConfig:[function(t,e,i){"use strict";cc._RF.push(e,"f7a69Kp5HdGP6fdtI6wk6DS","NationBossScoreTaskConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationBossScoreTaskConfig",e._tblName="nation_boss_score_task_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._jsonData,e=this._data,i=0,n=t.length-1;i<=n;i++){var a=t[i],r=a.groupId;e[r]=e[r]||[],e[r][e[r].length]=a}},e.prototype.getNationBossScoreTaskConfigsByGroupId=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationBossTaskModel:[function(t,e,i){"use strict";cc._RF.push(e,"77c05q2k6JP2reIQJ82Awka","NationBossTaskModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=function(){function t(){this._groupId=0,this._taskId=0,this._needScore=0}return t.prototype.init=function(t){t&&(this._groupId=t.groupId,this._taskId=t.taskId,this._needScore=t.score,this._rewards=n.RewardManager.parseRewardListDetail(t.rewards),this._rewardStatus=n.RewardStatus.CANNOT_RECEIVE)},t.prototype.getGroupId=function(){return this._groupId},t.prototype.getTaskId=function(){return this._taskId},t.prototype.getNeedScore=function(){return this._needScore},t.prototype.getRewards=function(){return this._rewards},t.prototype.setRewardStatus=function(t){this._rewardStatus=t},t.prototype.getRewardStatus=function(){return this._rewardStatus},t}();e.exports=a,cc._RF.pop()},{}],NationCityModel:[function(t,e,i){"use strict";cc._RF.push(e,"7a648OQmjZDoIt0WwvlYwZi","NationCityModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../../Manager/NationMainManager"),a=window.td,r=t("NationSimpleInfo"),o=(t("CityDefenderModel"),t("CitySiegePlayerModel")),s=(t("SiegeGuardModel"),function(){function t(){this._id=0,this._name="",this._res="",this._level=0,this._nationLevelLimit=0,this._siegePassedScore=0,this._leftHp=0,this._totalHp=0,this._myDamage=0,this._isSelfInGuard=!1}return t.prototype.init=function(t,e,i){this._setTableData(e,i),this.updateServerData(t),this._myDamage=0,this._ranks={},this._defendRanks={},this._cityAttackRank=[],this._isSelfInGuard=!1},t.prototype.getColorBlock=function(){return this._colorBlock},t.prototype.getColor=function(){return this._cityColor},t.prototype.getCityAttackRank=function(){return this._cityAttackRank},t.prototype.getTotalLeftDefend=function(){return this._totalLeftDefend},t.prototype.getSiegeTime=function(){return this._siegeTime},t.prototype.getAddDefendTimes=function(){return this._addDefendTimes},t.prototype.getAddDefendStr=function(){var t=a.GetConfig("NATION_CHANGE_TIMES_ADD_ATTRIBUTE");return a.Language.DefendUp+this._addDefendTimes*t/100+"%"},t.prototype.getTotalDefend=function(){},t.prototype.getOccupyTimes=function(){return 0},t.prototype.getGuardNum=function(){return this._totalGuardNum},t.prototype.getLineUpMap=function(){},t.prototype.isSelfInGuard=function(){return this._isSelfInGuard},t.prototype.getCityIndexGuardList=function(t){},t.prototype.getId=function(){return this._id},t.prototype.getName=function(){return this._name},t.prototype.getRes=function(){return this._res},t.prototype.getNationId=function(){return this._nationSimpleInfo?this._nationSimpleInfo.getId():0},t.prototype.getNationSimpleInfo=function(){return this._nationSimpleInfo},t.prototype.isAttacked=function(){return!!this._nationSimpleInfo&&(this._nationSimpleInfo.getId()>0||this._leftHp<=0)},t.prototype.getLevel=function(){return this._level},t.prototype.getPosition=function(){return this._pos},t.prototype.getFlagPos=function(){return this._flagPos},t.prototype.getBoxScaleX=function(){return this._boxScaleX},t.prototype.getBoxPos=function(){return this._boxPos},t.prototype.getLimitNationLevel=function(){return this._nationLevelLimit},t.prototype.getLeftHp=function(){return this._leftHp},t.prototype.getHpPercent=function(){var t=0;return this._totalHp>0&&(t=this._leftHp/this._totalHp),t=(t=t<0?0:t)>1?1:t},t.prototype.getHpPercentText=function(){return(100*this.getHpPercent()).toFixed(2)+"%"},t.prototype.getTotalHp=function(){return this._totalHp},t.prototype.getSiegeChallengeReward=function(){return this._siegeChallengeReward},t.prototype.getSiegePassedScore=function(){return this._siegePassedScore},t.prototype.getSiegePassedReward=function(){return this._siegePassedReward},t.prototype.getTerritorySuccRewards=function(){return this._territorySuccRewards||[]},t.prototype.getTerritorySeizedRewards=function(){return this._territorySeizedRewards},t.prototype.getBoxRewards=function(){return this._boxRewards},t.prototype.getSiegeRanks=function(){return this._ranks},t.prototype.getDefendRanks=function(){return this._defendRanks},t.prototype.getMyDamage=function(){return this._myDamage},t.prototype.getNationIdList=function(){return this._nationIdList},t.prototype.getMonsterHps=function(){return this._monsterHps},t.prototype.getMonsterLeftHps=function(){return this._monsterLeftHps},t.prototype.getDefendEntityMap=function(){return this._defendEntityMap},t.prototype.getDefendStrByIndex=function(t){var e="",i=0;if(this._defendEntityMap[t]&&this._defendEntityMap[t].actors&&(i=this._defendEntityMap[t].actors.length),0===i)e=a.Language.No_defense;else{var n=this._defendEntityMap[t].defend,r=this._defendEntityMap[t].totalDefend,o=i;r>0&&(o=Math.ceil(n/(r/i))),e=o+"/"+i}return e},t.prototype.getChallengeIndex=function(){for(var t=0,e=this._monsterLeftHps.length-1;e>=0;e--){if(this._monsterLeftHps[e]<this._monsterHps[e]){t=e;break}if(this._monsterLeftHps[e]===this._monsterHps[e]&&e-1>=0&&0===this._monsterLeftHps[e-1]){t=e;break}}return t},t.prototype.isMyNationBox=function(){return this._nationSimpleInfo.getId()==n.default.getInstance().getNationInfo().getId()},t.prototype.isBoxCanReceiveInTime=function(){var t=a.GetConfig("SIEGE_CITY_BOX_RECEIVE_TIME"),e=t[0].toString(),i=e.substr(0,2),n=e.substr(2,2),r=t[1].toString(),o=r.substr(0,2),s=r.substr(2,2),l=a.TimeUtil.getServerDate(),c=l.getHours(),u=l.getMinutes();if(c>i&&c<o)return!0;if(c==i){if(u>=n)return!0}else if(c==o&&u<=s)return!0;return!1},t.prototype.getBoxCanReceiveTime=function(){var t=a.GetConfig("SIEGE_CITY_BOX_RECEIVE_TIME"),e=t[0].toString(),i=e.substr(0,2),n=e.substr(2,2),r=t[1].toString(),o=r.substr(0,2),s=r.substr(2,2);return a.TimeUtil.getZoneTransHours(i+":"+n)+"~"+a.TimeUtil.getZoneTransHours(o+":"+s)},t.prototype.updateServerData=function(t){if(void 0!==t.damage&&(this._myDamage=t.damage),void 0!==t.ranks){this._ranks={};for(var e=t.ranks,i=0;i<e.length;i++){var n=e[i];(s=new o).init(n),this._ranks[n.rank]=s}}if(void 0!==t.defendRanks){this._defendRanks={};var a=t.defendRanks;a.sort(function(t,e){return e.nationDefend-t.nationDefend});for(i=0;i<a.length;i++){var s;(n=a[i]).rank=i+1,(s=new o).init(n),this._defendRanks[n.rank]=s}}if(void 0!==t.defendEntityMap)for(var l in this._defendEntityMap=t.defendEntityMap,this._leftHp=0,this._totalHp=0,this._monsterHps=[],this._monsterLeftHps=[],this._defendEntityMap){var c=this._defendEntityMap[l];this._leftHp+=c.defend,this._totalHp+=c.totalDefend,this._monsterHps.push(c.totalDefend),this._monsterLeftHps.push(c.defend)}void 0!==t.nation&&(this._nationSimpleInfo=new r,this._nationSimpleInfo.init(t.nation)),void 0!==t.cityColor&&(this._cityColor=t.cityColor),void 0!==t.nationIdList&&(this._nationIdList=t.nationIdList),void 0!==t.siegeTime&&(this._siegeTime=t.siegeTime),void 0!==t.addDefendTimes&&(this._addDefendTimes=t.addDefendTimes)},t.prototype._setTableData=function(t,e){this._id=t.cityId,this._name=t.cityName,this._res=t.res;var i=t.pos;this._pos=cc.v2(i[0],i[1]);var n=t.flagPos;this._flagPos=cc.v2(n[0],n[1]);var r=t.boxPos;this._boxPos=cc.v2(r[1],r[2]),0==r[0]?this._boxScaleX=-1:this._boxScaleX=1,this._level=t.cityLevel,this._nationLevelLimit=t.nationLevelLimit,this._siegePassedScore=t.passedScore,this._siegeChallengeReward=a.RewardManager.getRewardDetail(t.challengeRewards[0]),this._siegePassedReward=[],this._boxRewards=t.boxRewards;var o=t.passedRewards[0][1];this._siegePassedReward[this._siegePassedReward.length]=a.RewardManager.getRewardDetailArray(o),this._territorySuccRewards=[];for(var s=t.territorySucessedRewards,l=0,c=s.length;l<c;l++){var u=a.RewardManager.getRewardDetail(s[l]);this._territorySuccRewards[this._territorySuccRewards.length]=u}this._territorySeizedRewards=[];var d=t.territorySeizedRewards;for(l=0,c=d.length;l<c;l++){u=a.RewardManager.getRewardDetail(d[l]);this._territorySeizedRewards[this._territorySeizedRewards.length]=u}this._colorBlock=t.colorBlock},t}());i.default=s,e.exports=s,cc._RF.pop()},{"../../Manager/NationMainManager":"NationMainManager",CityDefenderModel:"CityDefenderModel",CitySiegePlayerModel:"CitySiegePlayerModel",NationSimpleInfo:"NationSimpleInfo",SiegeGuardModel:"SiegeGuardModel"}],NationCityWarManager:[function(t,e,i){"use strict";cc._RF.push(e,"fe8a963ekNKL46yGp0JWTHg","NationCityWarManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("./NationMainManager"),a=t("../Enum/NationEnum"),r=t("CommonEnum"),o=t("NationCityWarModel"),s=t("NationWarAttackerModel"),l=t("SiegeNationWarRankModel"),c=t("SiegeNationWarActorRankModel"),u=t("NationMemberInfo"),d=function(){function t(){this._inMatchMembers={}}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._nationWarData=null,this._attackNationArray=[],this._attackNationIdList={},this._ranks={},this._myRanks={},this._bWarReportChange=!1,this._bCanShowReport=!1,this._attackId=0},t.prototype.addListener=function(){var t=td.MsgModuleName.SIEGE,e=td.MsgCmd.SIEGE,i=td.ServerDelegate;i.registerMessage(t,e.SIEGE_GET_INFO,this._parseSiegeInfo.bind(this)),i.registerMessage(t,e.SIEGE_GET_ACTOR,this._parseSiegeActor.bind(this)),i.registerMessage(t,e.SIEGE_GET_CITY,this._getCityInfo.bind(this)),i.registerMessage(t,e.PUSH_SIEGE_INFO,this._parseSiegeInfo.bind(this)),i.registerMessage(t,e.SIEGE_NATION_RANK,this._resGetSigeNationRank.bind(this)),i.registerMessage(t,e.SIEGE_NATION_ACTOR_RANK,this._resGetSigeNationActorRank.bind(this)),i.registerMessage(t,e.SIEGE_ATTACK,this._resSiegeAttack.bind(this)),i.registerMessage(t,e.SIEGE_BUY_TIMES,this._onSiegeBuyTimes.bind(this)),i.registerMessage(t,e.PUSH_SIEGE_CITY,this._getCityInfo.bind(this)),i.registerMessage(t,e.PUSH_SIEGE_ACTOR,this._parseSiegeActor.bind(this)),i.registerMessage(t,e.PUSH_SIEGE_CITY_REFRESH,this._onCityDataUpdated.bind(this)),i.registerMessage(t,e.SIEGE_NATION_PARTICIPANT,this._resGetInMatchMembers.bind(this)),i.registerMessage(t,e.SIEGE_CITY_BOX_REWARD_RECEIVE,this._resGetBoxReceive.bind(this)),i.registerMessage(t,e.PUSH_SIEGE_NATION_PARTICIPANT,this._resGetInMatchMembers.bind(this)),i.registerMessage(t,e.PUSH_SIEGE_ATTEND_RESPONSE,this._resGetAttackInfo.bind(this)),i.registerMessage(t,e.NATION_WAR_REPORT,this.receiveNationWarReportInfo.bind(this))},t.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.REQUEST_GET_SIEGE_INFO]=this._requestSiegeInfo,e[t.REQUEST_GET_SIEGE_ACTOR]=this._requestSiegeActor,e[t.REQUEST_GET_SIEGE_CITY]=this._requestSiegeCityInfo,e[t.REQUEST_SIEGE_ATTACK]=this._requestSiegeAttack,e[t.REQUEST_SIEGE_BUY_TIMES]=this._openBuyTimesWindow,e[t.Req_Get_SIEGE_Nation_RANK]=this._reqGetSigeNationRank,e[t.Req_Get_SIEGE_Nation_Actor_RANK]=this._reqGetSigeNationActorRank,e[t.REQUEST_SIEGE_IN_MATCH_MEMBERS]=this._reqGetInMatchMembers,e[t.REQUEST_SIEGE_BOX_RECEIVE]=this._reqBoxReceive,e[t.QUERY_NATION_WAR_REPORT_INFO]=this.queryNationWarReportInfo,e[t.RED_POINT_FROM_SERVER]=this.checkNationWarReportChange,td.EventUtil.registerEvents(e,this)},t.prototype.setRankType=function(t){this._curRankType=t},t.prototype.getCurRankType=function(){return this._curRankType},t.prototype.getRanks=function(){return this._ranks[this._curRankType]},t.prototype.openPanel=function(){td.GlobalFunction.setLocalSaveStatus("NationCityWar",!0),td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_NATION_CITYWAE)},t.prototype.getMyRank=function(){return this._myRanks[this._curRankType]},t.prototype.getLineInfoList=function(){return this._lineInfoList},t.prototype.setFightCityId=function(t){this._fightCityId=t},t.prototype.getFightCityId=function(){return this._fightCityId},t.prototype.getNationWarData=function(){return this._nationWarData},t.prototype.getAddAttrByOccupyTiems=function(t){var e=0;this._attrAddPerList||(this._attrAddPerList=td.GetConfig("NATION_CHANGE_TIMES_ADD_ATTRIBUTE"));for(var i=0,n=this._attrAddPerList.length;i<n&&(e=this._attrAddPerList[i][1],!(this._attrAddPerList[i][0]>=t));i++);return Math.floor(100*e/1e4)},t.prototype.getMaxGuardMatch=function(t){return this._guard_match||(this._guard_match=td.GetTableClass(td.TableEnum.SiegeCityDefenceConfig).getDefenceNumData()),this._guard_match[t]},t.prototype._openBuyTimesWindow=function(){var t=this.getNationWarData(),e=t.getState()===a.SiegeState.NATION_BATTLE,i=e?r.PrerogativeEnum.NationAttackBuyTimes:r.PrerogativeEnum.SiegeBuyTimes,n=e?t.getBuyNationTimes():t.getBuyTimes(),o={};o.vipPrerogative=i,o.boughtTimes=n,o.sureFunc=this.requestSiegeBuyTimes.bind(this),o.calcFunc=this.getBuyCost.bind(this),td.GlobalFunction.showBuyTimesWindow(o)},t.prototype.getBuyCost=function(t){for(var e,i=td.GlobalFunction,n=this._nationWarData.getState()===a.SiegeState.NATION_BATTLE,r=n?"NATION_WAR_BUY_ATTACK_TIMES_COST":"SIEGE_BUY_ATTACK_TIMES_COST",o=n?this._nationWarData.getBuyNationTimes():this._nationWarData.getBuyTimes(),s=1+o;s<=t+o;s++)e?e.setCount(e.getCount()+i.getShareConfigUpCostCount(r,s)):e=i.getShareConfigUpCostDetail(r,s);return e},t.prototype.getCityDataById=function(t){return this._nationWarData?this._nationWarData.getCityModelById(t):null},t.prototype.getSelfRankInfo=function(){return this._selfRankInfo},t.prototype.getAttackNationArray=function(){return this._attackNationArray},t.prototype.getLeftPlayTimes=function(){return this._nationWarData?this._nationWarData.getLeftPlayTimes():0},t.prototype.getNationWarState=function(){return this._nationWarData?this._nationWarData.getState():a.SiegeState.NONE},t.prototype.isBattleCloseDay=function(){return td.TimeUtil.getServerDate().getDay()==this._nationWarData.getBattleCloseDay()},t.prototype.isSleepCloseDay=function(){return td.TimeUtil.getServerDate().getDay()==this._nationWarData.getSleepCloseDay()},t.prototype.getInMatchMembers=function(){var t=[];for(var e in this._inMatchMembers)t.push(this._inMatchMembers[e]);return this._sortMemberList(t),t},t.prototype.isSelfInMatch=function(){return!!this._inMatchMembers.hasOwnProperty(td.GameRoleInfo.roleId)},t.prototype._sortMemberList=function(t){t.sort(function(t,e){var i=t.onLineState,n=e.onLineState,a=t.getMemberType(),r=e.getMemberType();return i&&!n?-1:!i&&n?1:a!==r?a-r:t.level<e.level?1:t.level>e.level?-1:t.fightPower<e.fightPower?1:t.fightPower>e.fightPower?-1:void 0})},t.prototype.isSelfReceivedBox=function(t){return this._nationWarData.isSelfReceivedBox(t)},t.prototype.isSelfHaveReward=function(){if(!this.isSelfInMatch())return!1;if(this._nationWarData.getState()!==a.SiegeState.NATION_SLEEP)return!1;for(var t=this._nationWarData.getReceiveBoxList(),e=this._nationWarData.getMyNationCityIdList(),i=0;i<e.length;i++){var n=e[i];if(-1==t.indexOf(n))return!0}return!1},t.prototype._requestSiegeInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Siege,0)){var t={};t.module=td.MsgModuleName.SIEGE,t.cmd=td.MsgCmd.SIEGE.SIEGE_GET_INFO,td.ServerDelegate.sendMessage(t)}},t.prototype.isBoxCanReceiveInTime=function(){var t=td.GetConfig("SIEGE_CITY_BOX_RECEIVE_TIME"),e=t[0].toString(),i=e.substr(0,2),n=e.substr(2,2),a=t[1].toString(),r=a.substr(0,2),o=a.substr(2,2),s=td.TimeUtil.getMondayTime()+2592e5,l=s+60*i*60*1e3+60*n*1e3,c=s+60*r*60*1e3+60*o*1e3,u=td.TimeUtil.getTime();return u>=l&&u<c},t.prototype._parseSiegeInfo=function(t,e){if(t===td.NetCode.SUCCESS){this._nationWarData||(this._nationWarData=new o);var i=this._nationWarData.getState();i&&i!==e.state&&(this._attackNationIdList={}),this._nationWarData.init(e);var n=this._attackNationArray,a=this._attackNationIdList;if(e.nationList){this._attackNationArray=[],this._attackNationIdList={},n=this._attackNationArray,a=this._attackNationIdList;for(var r=e.nationList.length,l=0;l<r;l++){var c=e.nationList[l],u=new s;u.init(c),n[n.length]=u,a[u.getNationInfo().getId()]=u}this._lineInfoList={};for(var d=this._nationWarData.getCityList(),h=(l=0,d.length);l<h;l++){var p=d[l],_=p.getNationIdList();if(_)for(var g=0,f=_.length;g<f;g++){var v=_[g];a[v]&&(a[v].setAttackCities(p),this._lineInfoList["line_"+v+"_"+p.getId()]=!0)}}td.EventUtil.dispatchEvent(td.EventNameEnum.SIEGE_INFO_CHANGED)}}},t.prototype._requestSiegeActor=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Siege,0)){var t={};t.module=td.MsgModuleName.SIEGE,t.cmd=td.MsgCmd.SIEGE.SIEGE_GET_ACTOR,td.ServerDelegate.sendMessage(t)}},t.prototype._parseSiegeActor=function(t,e){t===td.NetCode.SUCCESS&&(this._nationWarData||(this._nationWarData=new o),this._nationWarData.initActor(e),td.EventUtil.dispatchEvent(td.EventNameEnum.SIEGE_ACTOR_CHANGED))},t.prototype._requestSiegeCityInfo=function(t){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Siege,0)){var e={};e.module=td.MsgModuleName.SIEGE,e.cmd=td.MsgCmd.SIEGE.SIEGE_GET_CITY,e.cityId=t,td.ServerDelegate.sendMessage(e)}},t.prototype._getCityInfo=function(t,e){t===td.NetCode.SUCCESS&&this._nationWarData&&(this._nationWarData.updateCity(e),td.EventUtil.dispatchEvent(td.EventNameEnum.GET_SIEGE_CITY_INFO,e))},t.prototype._onCityDataUpdated=function(t,e){if(t===td.NetCode.SUCCESS&&this._nationWarData){var i=e.cityVO,n=i.cityId,r=this._nationWarData.getCityModelById(n);if(r){var o=e.nationVO,l=r.getId(),c=r.getNationIdList();this._nationWarData.updateCity(i);var u=this._attackNationIdList[o.id],d=r.getNationIdList(),h=this.getNationWarData().getState(),p=i.defendEntityMap,_=0,g=0;for(var f in p){var v=p[f];_+=v.defend,g+=v.totalDefend}if(i.nation&&i.nation.id>0&&(0===_||_===g)){for(var m=this._attackNationArray.length-1;m>=0;m--){(T=this._attackNationArray[m]).removeAttackCities(r),0===T.getAttackCities().length&&(this._attackNationArray.splice(m,1),this._attackNationIdList[T.getNationId()]&&delete this._attackNationIdList[T.getNationId()])}if(c){m=0;for(var y=c.length;m<y;m++){var E=c[m];delete this._lineInfoList["line_"+E+"_"+l]}}}else if(0===g||h===a.SiegeState.BATTLE&&0===_){for(m=this._attackNationArray.length-1;m>=0;m--){var T;(T=this._attackNationArray[m]).removeAttackCities(r),0===T.getAttackCities().length&&(this._attackNationArray.splice(m,1),this._attackNationIdList[T.getNationId()]&&delete this._attackNationIdList[T.getNationId()])}if(c)for(m=0,y=c.length;m<y;m++){E=c[m];this._lineInfoList&&delete this._lineInfoList["line_"+E+"_"+l]}}else d&&d.length>0&&(u?u.updateServerData(o):((u=new s).init(o),this._attackNationArray[this._attackNationArray.length]=u,this._attackNationIdList[u.getNationId()]=u),u.setAttackCities(r),this._lineInfoList||(this._lineInfoList={}),this._lineInfoList["line_"+u.getNationId()+"_"+l]=!0);td.EventUtil.dispatchEvent(td.EventNameEnum.SIEGE_CITY_UPDATED,l)}}},t.prototype._requestSiegeAttack=function(t){var e=t.cityId,i=t.targetActorId,n={};n.module=td.MsgModuleName.SIEGE,n.cmd=td.MsgCmd.SIEGE.SIEGE_ATTACK,this._attackId=e,n.cityId=e,n.targetActorId=i,td.ServerDelegate.sendMessage(n)},t.prototype.requestSiegeBuyTimes=function(t){var e={};e.module=td.MsgModuleName.SIEGE,e.cmd=td.MsgCmd.SIEGE.SIEGE_BUY_TIMES,e.times=t,td.ServerDelegate.sendMessage(e)},t.prototype._onSiegeBuyTimes=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_SIEGE_BUY_TIMES)},t.prototype._reqGetSigeNationRank=function(t){var e={};e.module=td.MsgModuleName.SIEGE,e.cmd=td.MsgCmd.SIEGE.SIEGE_NATION_RANK,e.page=t||1,e.rankTypeId=this._curRankType,td.ServerDelegate.sendMessage(e)},t.prototype._resGetSigeNationRank=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rankList,n=i.length,r=null;this._curRankType!==a.NationWarRankType.ARMY_ROUND_FIRST&&n>0&&((r=new l).init(i[n-1]),i.splice(n-1,1));for(var o=[],s=0;s<i.length;s++){var c=new l;c.init(i[s]),o.push(c)}this._ranks[this._curRankType]=o,this._myRanks[this._curRankType]=r,td.EventUtil.dispatchEvent(td.EventNameEnum.Res_Get_SIEGE_Nation_RANK)}},t.prototype._reqGetSigeNationActorRank=function(t){var e={};e.module=td.MsgModuleName.SIEGE,e.cmd=td.MsgCmd.SIEGE.SIEGE_NATION_ACTOR_RANK,e.page=t||1,e.rankTypeId=this._curRankType,td.ServerDelegate.sendMessage(e)},t.prototype._resGetSigeNationActorRank=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rankList,n=i.length,a=null;n>0&&((a=new c).init(i[n-1]),i.splice(n-1,1));for(var r=[],o=0;o<i.length;o++)if(i[o].attributes.myLen()>0){var s=new c(i[o]);s.init(i[o]),r.push(s)}this._ranks[this._curRankType]=r,this._myRanks[this._curRankType]=a,td.EventUtil.dispatchEvent(td.EventNameEnum.Res_Get_SIEGE_Nation_Actor_RANK)}},t.prototype._resSiegeAttack=function(t,e){t===td.NetCode.SUCCESS?td.EventUtil.dispatchEvent(td.EventNameEnum.Res_Get_SIEGE_Attack_succ):td.EventUtil.dispatchEvent(td.EventNameEnum.Res_Get_SIEGE_Attack_error)},t.prototype._reqGetInMatchMembers=function(){var t={};t.module=td.MsgModuleName.SIEGE,t.cmd=td.MsgCmd.SIEGE.SIEGE_NATION_PARTICIPANT,td.ServerDelegate.sendMessage(t)},t.prototype._resGetInMatchMembers=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.members;if(i){if(this._inMatchMembers){for(var n in this._inMatchMembers)this._inMatchMembers.hasOwnProperty(n)&&delete this._inMatchMembers[n];this._inMatchMembers={}}else this._inMatchMembers={};if(i.length>0)for(var a=0,r=i.length;a<r;a++){var o=i[a].attributes[td.UserPropertyEnum.GamerId];if(this._inMatchMembers[o])this._inMatchMembers[o].updateAttr(i[a]);else{var s=new u;s.init(i[a]),this._inMatchMembers[o]=s}}td.EventUtil.dispatchEvent(td.EventNameEnum.RESPONSE_SIEGE_IN_MATCH_MEMBERS)}}},t.prototype._reqBoxReceive=function(t){var e={};e.module=td.MsgModuleName.SIEGE,e.cmd=td.MsgCmd.SIEGE.SIEGE_CITY_BOX_REWARD_RECEIVE,e.cityId=t,td.ServerDelegate.sendMessage(e)},t.prototype._resGetBoxReceive=function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RESPONSE_SIEGE_BOX_RECEIVE,e)},t.prototype._resGetAttackInfo=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.damage,n=e.rewardResult,a=td.RewardManager.parseRewardResult(n)[0],r=td.GlobalFunction.getGoodsData(a.type,a.id,a.count);if(null!=r){var o=new td.BroadcastContent(381),s=new td.BroadcastParam(i),l=new td.BroadcastParam(r.getName()+"*"+r.getCount());o.setMainParam([s,l]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,o)}}},t.prototype.setWarReportChangeStatus=function(t){this._bWarReportChange=t},t.prototype.isWarReportChange=function(){return this._bWarReportChange},t.prototype.setCanShowReportStatus=function(t){this._bCanShowReport=t},t.prototype.isCanShowWarReportWindow=function(){return this._bCanShowReport},t.prototype.queryNationWarReportInfo=function(){var t={};t.module=td.MsgModuleName.SIEGE,t.cmd=td.MsgCmd.SIEGE.NATION_WAR_REPORT,td.ServerDelegate.sendMessage(t)},t.prototype.receiveNationWarReportInfo=function(t,e){if(t===td.NetCode.SUCCESS){for(var i=e.reportList,n=[],a=0,r=i.length;a<r;a++){var o=i[a],s=new td.NationWarReportModel;s.init(o),n.push(s)}n.sort(function(t,e){return e.getOccupyTime()-t.getOccupyTime()}),td.EventUtil.dispatchEvent(td.EventNameEnum.RECEIVE_NATION_WAR_REPORT_INFO,n)}},t.prototype.checkNationWarReportChange=function(t){1===t[td.RedPointType.NationWarReportChange]&&(this._bWarReportChange=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.NATION_WAR_REPORT_CHANGE))},t.prototype.isNationWarTips=function(){var t=td.TimeUtil.getServerDate().getDay();if(5==t||6==t||0==t)return!1;if(!n.default.getInstance().isJoinNation())return!1;if(!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_NationCityWar))return!1;if(!this._nationWarData)return!1;var e=this._nationWarData.getState();if(this.isSelfHaveReward()&&e===a.SiegeState.NATION_SLEEP){if(this.isSleepCloseDay())return!1;if(this.isBoxCanReceiveInTime())return!0;var i=td.GlobalFunction.getLocalSaveStatus("NationCityWar");if(!0!==i&&"true"!==i)return!0}if(!this.isSelfInMatch())return!1;var r=this._nationWarData.getLeftPlayTimes(),o=this._nationWarData.hasEmptyCity2Attack();if(e===a.SiegeState.BATTLE&&r>0&&o)return!0;var s=n.default.getInstance().getNationInfo().getId(),l=(o=this._nationWarData.hasCityToOccupy(s),this._nationWarData.getLeftNationTimes());return!!(e===a.SiegeState.NATION_BATTLE&&l>0&&o)},t.prototype.nationWarTipsEvents=function(){return[td.EventNameEnum.SIEGE_INFO_CHANGED,td.EventNameEnum.OPEN_NATION_CITYWAE]},t.prototype.getOpenDays=function(){var t=td.SystemManager.getServerOpenDays(),e=td.GetConfig("SIEGE_OPEN_DAYS"),i=td.TimeUtil.getTime(),n=td.TimeUtil.getStampZeroPoint(i-864e5*t);return Math.floor((this._nationWarData._closeTime-864e5*e-n)/864e5)},t}();i.default=d,cc._RF.pop()},{"../Enum/NationEnum":"NationEnum","./NationMainManager":"NationMainManager",CommonEnum:void 0,NationCityWarModel:"NationCityWarModel",NationMemberInfo:"NationMemberInfo",NationWarAttackerModel:"NationWarAttackerModel",SiegeNationWarActorRankModel:"SiegeNationWarActorRankModel",SiegeNationWarRankModel:"SiegeNationWarRankModel"}],NationCityWarModel:[function(t,e,i){"use strict";cc._RF.push(e,"1fe63VNJOxBTqOwdfgMai7B","NationCityWarModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("../../Enum/NationEnum"),r=t("NationCityModel"),o=function(){function t(){this._name="",this._round=0,this._cityRound=0,this._closeTime=0,this._leftTimes=0,this._buyTimes=0,this._leftNationTimes=0,this._nationTimes=0,this._buyNationTimes=0,this._receiveList=[]}return t.prototype.init=function(t){if(this._name="",this._round=t.round||0,this._cityRound=t.cityRound||0,this._state=parseInt(t.state)||a.SiegeState.NONE,this._closeTime=t.closeTime||0,this._state==a.SiegeState.NATION_SLEEP){var e=24*n.GetConfig("NATION_WAR_SLEEP_DAYS")*60*60*1e3,i=n.TimeUtil.getServerDate(this._closeTime-e);this._battleCloseDay=i.getDay();var r=n.TimeUtil.getServerDate(this._closeTime);this._sleepCloseDay=r.getDay()}this._percent=t.percent||1e4,this._createCityList(t.cityList)},t.prototype.initActor=function(t){this._leftTimes=t.leftTimes||0,this._buyTimes=t.buyTimes||0,this._leftNationTimes=t.leftNationTimes||0,this._nationTimes=t.nationTimes||0,this._buyNationTimes=t.buyNationTimes||0,this._receiveList=t.receiveList||[]},t.prototype.getLeftNationTimes=function(){return this._leftNationTimes},t.prototype.getNationTimes=function(){return this._nationTimes},t.prototype.getBuyNationTimes=function(){return this._buyNationTimes},t.prototype.getName=function(){return this._name},t.prototype.getRound=function(){return this._round},t.prototype.getCityRound=function(){return this._cityRound},t.prototype.getState=function(){return this._state},t.prototype.getPercent=function(){return this._percent},t.prototype.getCloseTime=function(){return this._closeTime},t.prototype.getBattleCloseDay=function(){return this._battleCloseDay},t.prototype.getSleepCloseDay=function(){return this._sleepCloseDay},t.prototype.getLeftPlayTimes=function(){return this._leftTimes},t.prototype.getBuyTimes=function(){return this._buyTimes},t.prototype.hasEmptyCity2Attack=function(){if(!this._cityList)return!1;for(var t=0,e=this._cityList.length;t<e;t++){if(!this._cityList[t].isAttacked())return!0}return!1},t.prototype.hasCityToOccupy=function(t){if(!this._cityList)return!1;for(var e=0,i=this._cityList.length;e<i;e++){var n=this._cityList[e].getNationId();if(0!==n&&n!==t)return!0}return!1},t.prototype.getCityModelById=function(t){var e=this._cityIdList;return e[t]?e[t]:null},t.prototype.getCityList=function(){return this._cityList},t.prototype.getReceiveBoxList=function(){return this._receiveList},t.prototype.isSelfReceivedBox=function(t){return-1!=this._receiveList.indexOf(t)},t.prototype.getMyNationCityIdList=function(){var t=[];for(var e in this._cityIdList)if(this._cityIdList.hasOwnProperty(e)){var i=this._cityIdList[e];i.isMyNationBox()&&t.push(i.getId())}return t},t.prototype.getDefendIds=function(){for(var t=[],e=n.Account.getUserData().getGamerId(),i=0;i<this._cityList.length;i++){var a=this._cityList[i].getDefendEntityMap();for(var r in a)for(var o=a[r].actors,s=0;s<o.length;s++)e===parseInt(o[s])&&t.push(this._cityList[i].getId())}return t},t.prototype._createCityList=function(t){this._cityList=[],this._cityIdList={};var e=n.GetTableClass(n.TableEnum.SiegeCityConfig).getNationCityByRound(this._cityRound);if(e){this._name=e[n.ArrayUtil.frontKey(e)].chapterName;for(var i=this._cityList,a=this._cityIdList,o=0,s=t.length-1;o<=s;o++){var l=e[t[o].cityId];if(l){var c=new r;c.init(t[o],l,this._percent),i[i.length]=c,a[c.getId()]=c}}this._cityList.sort(function(t,e){var i=t.getPosition(),n=e.getPosition();return i.y!==n.y?n.y-i.y:i.x!==n.x?n.x-i.x:void 0})}},t.prototype.updateCity=function(t){var e=t.cityId,i=this.getCityModelById(e);i&&i.updateServerData(t)},t}();e.exports=o,cc._RF.pop()},{"../../Enum/NationEnum":"NationEnum",NationCityModel:"NationCityModel"}],NationDonateTable:[function(t,e,i){"use strict";cc._RF.push(e,"c2519Ktyx1HDJYDmlEDS0nI","NationDonateTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationDonateTable",e._tblName="nation_donate_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data&&this._data[t]?this._data[t]:null},e.prototype.getdatas=function(){var t=[];for(var e in this._data)t.push(this._data[e]);return t},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationDuelCampConfig:[function(t,e,i){"use strict";cc._RF.push(e,"c4567e0V6pOJpYCAV2B7u83","NationDuelCampConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationDuelCampConfig",e._tblName="nation_duel_camp_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.camp]=a}},e.prototype.getDatas=function(){return this._data},e.prototype.getDefenceScore=function(t){var e=this._data[t];return e?e.defenceScore:1},e.prototype.getOffensiveScore=function(t){var e=this._data[t];return e?e.offensiveScore:1},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationDuelCampModel:[function(t,e,i){"use strict";cc._RF.push(e,"c6d603DwPxPFZTTpmTAsUIk","NationDuelCampModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=window.td,r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.setData=function(t){t&&(this._camp=t.camp,this._offensiveScore=t.offensiveScore,this._defenceScore=t.defenceScore,this._roundScoreLimit=t.roundScoreLimit,this._reward=a.RewardManager.parseRewardListDetail(t.reward))},e.prototype.getCamp=function(){return this._camp},e.prototype.getOffensiveScore=function(){return this._offensiveScore},e.prototype.getDefenceScore=function(){return this._defenceScore},e.prototype.getRoundScoreLimit=function(){return this._roundScoreLimit},e.prototype.getReward=function(){return this._reward},e}(t("Model"));e.exports=r,cc._RF.pop()},{Model:"Model"}],NationDuelEnum:[function(t,e,i){"use strict";var n,a;cc._RF.push(e,"67ceenUaWVJiKemfH43Hthw","NationDuelEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.NationDuelCamp=i.NationDuelState=void 0,function(t){t[t.PREPARE=1]="PREPARE",t[t.BATTLE=2]="BATTLE",t[t.SLEEP=3]="SLEEP",t[t.NONE=0]="NONE"}(n||(n={})),i.NationDuelState=n,function(t){t[t.MARSHAL=1]="MARSHAL",t[t.GENERAL=2]="GENERAL",t[t.SOLDIER=3]="SOLDIER",t[t.NONE=0]="NONE"}(a||(a={})),i.NationDuelCamp=a,cc._RF.pop()},{}],NationDuelInfoModel:[function(t,e,i){"use strict";cc._RF.push(e,"1a69fuNzTRPE6jm0vF+cHIJ","NationDuelInfoModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});window.td;var a=t("Model"),r=t("NationDuelSVOModel"),o=t("../../Manager/NationMainManager"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.setData=function(t){t&&(this._season=t.season,this._round=t.round,this._state=t.state,this._endTime=t.endTime,this._rank=t.rank,this._score=t.score,this.setNationListData(t.nationList))},e.prototype.setNationListData=function(t){this._nationList=this._nationList||[];for(var e=0,i=(t=t||[]).length;e<i;e++)this._nationList[e]||(this._nationList[e]=new r),this._nationList[e].setData(t[e]);for(i=this._nationList.length;e<i;e++)this._nationList.pop();var n=[],a=[],s=o.default.getInstance().getNationInfo().getId(),l=this.findNationById(s);if(a[a.length]=s,l){n[n.length]=l,a[a.length]=s;var c=l.getOppositeId();a[a.length]=c,n[n.length]=this.findNationById(c)}for(e=0,i=this._nationList.length;e<i;e++)if(n.length<=12){var u=this._nationList[e].getId();c=this._nationList[e].getOppositeId();if(!ArrayUtils.contains(a,u)){a[a.length]=u;var d=this.findNationById(u);n[n.length]=d,a[a.length]=c,d=this.findNationById(c),n[n.length]=d}}n=n.slice(0,12),this._nationList=n},e.prototype.getMyOppositeNationId=function(){return this._nationList[1]?this._nationList[1].getId():0},e.prototype.getMyNationDuelInfo=function(){return this._nationList[0]},e.prototype.findNationById=function(t){for(var e=this._nationList,i=0,n=e.length;i<n;i++)if(e[i]&&t==e[i].getId())return e[i]},e.prototype.getNationByIndex=function(t){return this._nationList[t]},e.prototype.getSeason=function(){return this._season},e.prototype.getRound=function(){return this._round},e.prototype.getState=function(){return this._state},e.prototype.getEndTime=function(){return this._endTime},e.prototype.getRank=function(){return this._rank},e.prototype.getScore=function(){return this._score||0},e.prototype.getNationList=function(){return this._nationList||[]},e}(a);e.exports=s,cc._RF.pop()},{"../../Manager/NationMainManager":"NationMainManager",Model:"Model",NationDuelSVOModel:"NationDuelSVOModel"}],NationDuelManager:[function(t,e,i){"use strict";cc._RF.push(e,"708addI/HdEvoD8YtPz+7ja","NationDuelManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("NationDuelCampModel"),r=t("NationDuelOffensiveStarModel"),o=t("NationDuelInfoModel"),s=t("NationDuelSeasonRankVOModel"),l=t("NationDuelRankVOModel"),c=t("NationDuelNationVOModel"),u=t("NationDuelRankRewardModel"),d=t("./NationMainManager"),h=t("../Enum/NationDuelEnum"),p=function(){function t(){this._isFromAppoint=!1,this._changeStar=0,this._changePoint=0,this._destPanelData=null,this._isEnterBtnAniShowed=!1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._nationDuelInfo=null,this._challengeTimes=0,this._curOffensiveStar=0,this._receiveList=[],this._oppoentDetail=null,this._myNationDetail=null,this._ranks=null,this._historyRanks=null,this.initData.hasInit=!1},t.prototype.addListener=function(){var t=n.MsgModuleName.NATION_DUEL,e=n.MsgCmd.NATION_DUEL,i=n.ServerDelegate;i.registerMessage(t,e.GET_NATION_DUEL_INFO,this._parseNationDuelInfo.bind(this)),i.registerMessage(t,e.GET_NATION_DUEL_ACTOR,this._parseNationDuelActorInfo.bind(this)),i.registerMessage(t,e.GET_NATION_DUEL_NATION,this._parseNationDuelNationInfo.bind(this)),i.registerMessage(t,e.NATION_DUEL_APPOINT,this._parseNationDuelAppointRes.bind(this)),i.registerMessage(t,e.NATION_DUEL_OFFENSIVE,this._parseNationDuelOffensiveRes.bind(this)),i.registerMessage(t,e.NATION_DUEL_RANK,this._parseNationDuelRankInfo.bind(this)),i.registerMessage(t,e.NATION_DUEL_SEASON_RANK,this._parseNationDuelRankHistoryInfo.bind(this)),i.registerMessage(t,e.NATION_DUEL_RECEIVE_REWARD,this._parseNationDuelRewardResult.bind(this)),i.registerMessage(t,e.PUSH_NATION_DUEL_INFO,this._parseNationDuelInfo.bind(this)),i.registerMessage(t,e.PUSH_NATION_DUEL_ACTOR,this._parseNationDuelActorInfo.bind(this)),i.registerMessage(t,e.PUSH_NATION_DUEL_NATION,this._pushNationDuelNationInfo.bind(this))},t.prototype.addEventListener=function(){var t=n.EventNameEnum,e={};e[t.REQ_NATION_DUEL_INFO]=this._requestNationDuelInfo,e[t.REQ_NATION_DUEL_PERSONAL_INFO]=this._requestNationDuelPersonalInfo,e[t.REQ_NATION_DUEL_NATION_INFO]=this._requestNationDuelNationInfo,e[t.REQ_NATION_DUEL_APPOINT]=this._requestNationDuelAppoint,e[t.REQ_NATION_DUEL_ATTACK]=this._requestNationDuelAttack,e[t.REQ_NATION_DUEL_RANK]=this._requestNationDuelRank,e[t.REQ_NATION_DUEL_HISTORY_RANK]=this._requestNationDuelHistoryRank,e[t.REQ_NATION_DUEL_RECEIVE_REWARD]=this._requestNationDuelReward,e[t.Res_Nation_Exit]=this.handleNationExit,n.EventUtil.registerEvents(e,this)},t.prototype.initData=function(){if(!this.initData.hasInit){var t=n.GetTableClass(n.TableEnum.NationDuelCampConfig).getDatas();for(var e in this._campConfigs=[],t){var i=t[e];(p=new a).setData(i),this._campConfigs[this._campConfigs.length]=p}var o=n.GetTableClass(n.TableEnum.NationDuelOffensiveStarConfig).getDatas();for(var s in this._starConfigs={},o){this._starConfigs[s]||(this._starConfigs[s]=[]);for(var l=o[s],c=0,d=l.length;c<d;++c){i=l[c];(p=new r).setData(i),this._starConfigs[s][this._starConfigs[s].length]=p}}var h=n.GetTableClass(n.TableEnum.NationDuelRankRewardConfig).getDatas();this._rankRewardConfigs=[];for(c=0,d=h.length;c<d;++c){var p;i=h[c];(p=new u).setData(i),this._rankRewardConfigs[this._rankRewardConfigs.length]=p}this.initData.hasInit=!0}},t.prototype._requestNationDuelInfo=function(){if(this.isNationDuelOpen()){this.initData();var t={};t.module=n.MsgModuleName.NATION_DUEL,t.cmd=n.MsgCmd.NATION_DUEL.GET_NATION_DUEL_INFO,n.ServerDelegate.sendMessage(t)}},t.prototype._requestNationDuelPersonalInfo=function(){var t={};t.module=n.MsgModuleName.NATION_DUEL,t.cmd=n.MsgCmd.NATION_DUEL.GET_NATION_DUEL_ACTOR,n.ServerDelegate.sendMessage(t)},t.prototype._requestNationDuelNationInfo=function(t){var e=d.default.getInstance().getNationInfo().getId(),i=[];if(this._nationDuelInfo.getNationList().forEach(function(t){t&&i.push(t.getId())}),ArrayUtils.contains(i,e)){var a={};a.module=n.MsgModuleName.NATION_DUEL,a.cmd=n.MsgCmd.NATION_DUEL.GET_NATION_DUEL_NATION,a.nationIdList=t.nationIdList,n.ServerDelegate.sendMessage(a)}},t.prototype._requestNationDuelAppoint=function(t){var e={};e.module=n.MsgModuleName.NATION_DUEL,e.cmd=n.MsgCmd.NATION_DUEL.NATION_DUEL_APPOINT,e.actorId=t.actorId,e.replaceId=t.replaceId,e.camp=t.camp,n.ServerDelegate.sendMessage(e)},t.prototype._requestNationDuelAttack=function(t){var e={};e.module=n.MsgModuleName.NATION_DUEL,e.cmd=n.MsgCmd.NATION_DUEL.NATION_DUEL_OFFENSIVE,e.actorId=t.actorId,e.replaceId=0,n.ServerDelegate.sendMessage(e)},t.prototype._requestNationDuelRank=function(){var t={};t.module=n.MsgModuleName.NATION_DUEL,t.cmd=n.MsgCmd.NATION_DUEL.NATION_DUEL_RANK,n.ServerDelegate.sendMessage(t)},t.prototype._requestNationDuelHistoryRank=function(){var t={};t.module=n.MsgModuleName.NATION_DUEL,t.cmd=n.MsgCmd.NATION_DUEL.NATION_DUEL_SEASON_RANK,n.ServerDelegate.sendMessage(t)},t.prototype._requestNationDuelReward=function(t){var e={};e.module=n.MsgModuleName.NATION_DUEL,e.cmd=n.MsgCmd.NATION_DUEL.NATION_DUEL_RECEIVE_REWARD,e.id=t.id,n.ServerDelegate.sendMessage(e)},t.prototype._parseNationDuelInfo=function(t,e){if(t===n.NetCode.SUCCESS){n.NationDuel=this,this._nationDuelInfo||(this._nationDuelInfo=new o),this._nationDuelInfo.setData(e);var i=this._nationDuelInfo.getRound(),a=this._nationDuelInfo.getState();3==i&&a==h.NationDuelState.SLEEP&&n.EventUtil.dispatchEvent(n.EventNameEnum.REQ_NATION_DUEL_HISTORY_RANK),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_NATION_INFO);var r=d.default.getInstance().getNationInfo().getId(),s=this._nationDuelInfo.getMyOppositeNationId(),l=[r];s&&(l[l.length]=s),n.EventUtil.dispatchEvent(n.EventNameEnum.REQ_NATION_DUEL_NATION_INFO,{nationIdList:l})}},t.prototype._parseNationDuelActorInfo=function(t,e){if(t===n.NetCode.SUCCESS){if(this._challengeTimes=e.times||0,this._curOffensiveStar=this._curOffensiveStar||0,e.offensiveStar=e.offensiveStar||0,this._changeStar=e.offensiveStar-this._curOffensiveStar,this._myNationDetail){var i=this._myNationDetail.getMyCamp(),a=n.GetTableClass(n.TableEnum.NationDuelCampConfig).getOffensiveScore(i);this._changePoint=parseInt(this._changeStar)*parseInt(a)}this._curOffensiveStar=e.offensiveStar,this._receiveList=e.receiveList||[],n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_NATION_PERSONAL_INFO)}},t.prototype._parseNationDuelNationInfo=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.nationList,a=d.default.getInstance().getNationInfo().getId();if(2==i.length){var r=i[1]&&i[1].nationId;if(r&&r==a){var o=i[1];i[1]=i[0],i[0]=o}}else 1==i.length&&i[0].nationId!=a&&(i[1]=i[0],i[0]=void 0);this._myNationDetail||(this._myNationDetail=new c),i[0]&&this._myNationDetail.setData(i[0]),this._oppoentDetail||(this._oppoentDetail=new c),i[1]&&this._oppoentDetail.setData(i[1]),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_NATION_PERSONAL_INFO)}},t.prototype._pushNationDuelNationInfo=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.nationList,a=d.default.getInstance().getNationInfo().getId();if(2==i.length){var r=i[1]&&i[1].nationId;if(r&&r==a){var o=i[1];i[1]=i[0],i[0]=o}}else 1==i.length&&i[0].nationId!=a&&(i[1]=i[0],i[0]=void 0);this._myNationDetail||(this._myNationDetail=new c),i[0]&&this._myNationDetail.refresh(i[0]),this._oppoentDetail||(this._oppoentDetail=new c),i[1]&&this._oppoentDetail.refresh(i[1]),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_NATION_PERSONAL_INFO)}},t.prototype._parseNationDuelAppointRes=function(t,e){t===n.NetCode.SUCCESS?n.EventUtil.dispatchEvent(n.EventNameEnum.NATION_DUEL_APPOINT_SUCCESS):n.EventUtil.dispatchEvent(n.EventNameEnum.NATION_DUEL_APPOINT_FAIL)},t.prototype._parseNationDuelOffensiveRes=function(t,e){n.NetCode.SUCCESS},t.prototype._parseNationDuelRankInfo=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.ranks||[];this._ranks=this._ranks||[];for(var a=this._ranks,r=0,o=i.length;r<o;r++)a[r]||(a[r]=new l),a[r].setData(i[r]);this._myRank=this._ranks.slice(-1),this._ranks=this._ranks.slice(0,this._ranks.length-1),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_NATION_DETAIL_RANK_INFO)}},t.prototype._parseNationDuelRankHistoryInfo=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.ranks||[];this._historyRanks=this._historyRanks||[];for(var a=this._historyRanks,r=0,o=i.length;r<o;r++)a[r]||(a[r]=new s),a[r].setData(i[r]);for(o=a.length;r<o;r++)a.pop();this._historyRanks.sort(function(t,e){return e.getSeason()-t.getSeason()}),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_NATION_DUEL_HISTORY_RANK_INFO)}},t.prototype._parseNationDuelRewardResult=function(t,e){if(t===n.NetCode.SUCCESS){var i=n.RewardManager.parseRewardResult(e.rewardResult);n.GlobalFunction.showRewards(i)}},t.prototype.reqBaseInfo=function(){n.EventUtil.dispatchEvent(n.EventNameEnum.REQ_NATION_DUEL_INFO),n.EventUtil.dispatchEvent(n.EventNameEnum.REQ_NATION_DUEL_PERSONAL_INFO)},t.prototype.getRankReward=function(){return this._rankRewardConfigs},t.prototype.getChangeStar=function(){return this._changeStar},t.prototype.getChangePoint=function(){return this._changePoint},t.prototype.isNationDuelOpen=function(){var t=d.default.getInstance().getNationInfo(),e=n.GetConfig("NATION_DUEL_NATION_LEVEL_LIMIT");return!(!t||t&&t.getLevel()<e)},t.prototype.setIsFromAppoint=function(t){this._isFromAppoint=t},t.prototype.getIsFromAppoint=function(){return this._isFromAppoint},t.prototype.getMyNationDetail=function(){return this._myNationDetail},t.prototype.getOppoentDetail=function(){return this._oppoentDetail},t.prototype.getCampConfig=function(){return this._campConfigs||[]},t.prototype.getStarConfig=function(){return this._starConfigs||{}},t.prototype.getCurStarConfig=function(){var t,e=n.Account.getUserData().getLevel(),i=this.getStarConfig();for(var a in i){if(!(e>=a))break;t=i[a]}return t||[]},t.prototype.getCanJump=function(){var t=this.getNationDuelInfo();return!!t&&!(0==t.getNationList().length&&0==t.getRank())},t.prototype.getLeftTimes=function(){var t=n.GetConfig("NATION_DUEL_OFFENSIVE_TIMES");return parseInt(t)-parseInt(this._challengeTimes)},t.prototype.getCurOffensiveStar=function(){return this._curOffensiveStar},t.prototype.isStarRewardReceived=function(t){return ArrayUtils.contains(this._receiveList,t)},t.prototype.getNationDuelInfo=function(){return this._nationDuelInfo},t.prototype.getMyOpponentId=function(){for(var t=d.default.getInstance().getNationInfo().getId(),e=this.getNationDuelInfo().getNationList(),i=0,n=e.length;i<n;++i){if(t===e[i].getId())return e[i].getOppositeId()}return cc.error("nation duel opponentId error"),0},t.prototype.clearMyOppoentDetail=function(){this._oppoentDetail=null},t.prototype.getRanks=function(){return this._ranks||[]},t.prototype.getMyRank=function(){if(this._myRank)return this._myRank[0]},t.prototype.getHistoryRanks=function(){return this._historyRanks||[]},t.prototype.setDestPanelData=function(t){this._destPanelData=t},t.prototype.getDestPanelData=function(){return this._destPanelData},t.prototype.isEnterBtnAniShowed=function(){return this._isEnterBtnAniShowed},t.prototype.setEnterBtnAniShowed=function(t){this._isEnterBtnAniShowed=t},t.prototype.isShowMainPanelBtn=function(){if(!this.isNationDuelOpen())return!1;var t=this.getNationDuelInfo();if(!t)return cc.log("no nationDUelInfo!"),!1;if(!this.getCanJump())return!1;var e=this.getMyNationDetail(),i=e&&e.isSelfCanFight(),n=this.getNationDuelInfo()&&this.getNationDuelInfo().getNationByIndex(1);return!!(t.getState()==h.NationDuelState.BATTLE&&i&&!!n&&this.getLeftTimes()>0)},t.prototype.handleNationExit=function(){var t=n.PanelJumpManager.getDestination();t&&t==n.PanelEnum.Panel_NationDuel&&(n.PanelJumpManager.clearDestination(),n.PanelJumpManager.setDestination(n.PanelEnum.Panel_PVE_FIGHT_HOOK))},t.prototype.entryRedPointTip=function(){if(!this.isNationDuelOpen())return!1;var t=this.getNationDuelInfo();if(!t)return cc.log("no nationDUelInfo!"),!1;if(!this.getCanJump())return!1;var e=this.getMyNationDetail(),i=e&&e.isSelfCanFight(),n=this.getNationDuelInfo()&&this.getNationDuelInfo().getNationByIndex(1),a=t.getState()==h.NationDuelState.BATTLE&&i&&!!n,r=this.getCurStarConfig(),o=this.getCurOffensiveStar(),s=this,l=r.some(function(t){var e=t.getStar();return!s.isStarRewardReceived(e)&&o>=e});return a&&this.getLeftTimes()>0||l},t.prototype.redPointEvts=function(){return[n.EventNameEnum.REFRESH_BEAST_INFO,n.EventNameEnum.Res_NATION_GET_ACTOR,n.EventNameEnum.Res_Nation_Exit]},t}();i.default=p,cc._RF.pop()},{"../Enum/NationDuelEnum":"NationDuelEnum","./NationMainManager":"NationMainManager",NationDuelCampModel:"NationDuelCampModel",NationDuelInfoModel:"NationDuelInfoModel",NationDuelNationVOModel:"NationDuelNationVOModel",NationDuelOffensiveStarModel:"NationDuelOffensiveStarModel",NationDuelRankRewardModel:"NationDuelRankRewardModel",NationDuelRankVOModel:"NationDuelRankVOModel",NationDuelSeasonRankVOModel:"NationDuelSeasonRankVOModel"}],NationDuelNationVOModel:[function(t,e,i){"use strict";cc._RF.push(e,"8e169Ff4chKjImU9zNIOQYK","NationDuelNationVOModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=t("Model"),o=t("../../Enum/NationDuelEnum"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.setData=function(t){t&&(this._nationId=t.nationId,this._playerList=t.playerList)},e.prototype.refresh=function(t){if(this._nationId==t.nationId)for(var e=a.UserPropertyEnum.GamerId,i=t.playerList,n=function(){var t=i[o].attributes[e],n=-1;r._playerList.some(function(i,a){var r=i.attributes[e]==t;if(r)return n=a,r})&&-1!=n?r._playerList[n]=i[o]:r._playerList[r._playerList.length]=i[o]},r=this,o=0,s=i.length;o<s;o++)n()},e.prototype.getNationId=function(){return this._nationId},e.prototype.getPlayerList=function(){return this._playerList||[]},e.prototype.getMembersByCamp=function(t){for(var e=this.getPlayerList(),i=[],n=0,a=e.length;n<a;n++)t==e[n].camp&&(i[i.length]=e[n]);return i},e.prototype.getMembers=function(){var t=this.getPlayerList();return t.sort(function(t,e){return e.attributes[a.UserPropertyEnum.FightPower]-t.attributes[a.UserPropertyEnum.FightPower]}),t},e.prototype.getTotalPointByCamp=function(t){for(var e=this.getMembersByCamp(t),i=0,n=0,a=0,r=e.length;a<r;a++)i+=e[a].roundOffensive,n+=e[a].roundDefence;return parseInt(i)+parseInt(n)},e.prototype.isSelfCanFight=function(){var t=this.getPlayerList(),e=a.Account.getUserData().getGamerId();return!!t.some(function(t){return t.attributes[a.UserPropertyEnum.GamerId]==e})},e.prototype.getMyCamp=function(){var t=this.getPlayerList(),e=a.Account.getUserData().getGamerId(),i=o.NationDuelCamp.NONE;if(t.some(function(t){var n=t.attributes[a.UserPropertyEnum.GamerId]==e;return n&&(i=t.camp),n}))return i},e.prototype.getMyData=function(){var t,e=this.getPlayerList(),i=a.Account.getUserData().getGamerId();if(e.some(function(e){var n=e.attributes[a.UserPropertyEnum.GamerId]==i;return n&&(t=e),n}))return t},e}(r);e.exports=s,cc._RF.pop()},{"../../Enum/NationDuelEnum":"NationDuelEnum",Model:"Model"}],NationDuelOffensiveStarConfig:[function(t,e,i){"use strict";cc._RF.push(e,"2ceb5f17wJGIZXvpj/7TAIB","NationDuelOffensiveStarConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationDuelOffensiveStarConfig",e._tblName="nation_duel_offensive_star_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.level]||(t[a.level]=[]),t[a.level][t[a.level].length]=a}},e.prototype.getDatas=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationDuelOffensiveStarModel:[function(t,e,i){"use strict";cc._RF.push(e,"2ecd35arY5MZ63YeHGLwWL1","NationDuelOffensiveStarModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=window.td,r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.setData=function(t){t&&(this._level=t.level,this._star=t.star,this._reward=a.RewardManager.parseRewardListDetail(t.reward))},e.prototype.getLevel=function(){return this._level},e.prototype.getStar=function(){return this._star},e.prototype.getReward=function(){return this._reward},e}(t("Model"));e.exports=r,cc._RF.pop()},{Model:"Model"}],NationDuelRankRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"4968aizDRJP8rbGskFHjKK5","NationDuelRankRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationDuelRankRewardConfig",e._tblName="nation_duel_rank_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=1,n=0,a=e.length;n<a;++n){var r=e[n];r.fromRank=i,i=r.rank-0+1,t[t.length]=r}},e.prototype.getDatas=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationDuelRankRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"211e6EMcUxLm5cGqtOOA8XD","NationDuelRankRewardModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=window.td,r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.setData=function(t){t&&(this._rank=t.rank,this._fromRank=t.fromRank,this._reward=a.RewardManager.parseRewardListDetail(t.reward))},e.prototype.getFromRank=function(){return this._fromRank},e.prototype.getRank=function(){return this._rank},e.prototype.getReward=function(){return this._reward},e}(t("Model"));e.exports=r,cc._RF.pop()},{Model:"Model"}],NationDuelRankVOModel:[function(t,e,i){"use strict";cc._RF.push(e,"3416ek7B0RKP5Tk4XGGWahU","NationDuelRankVOModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.setData=function(e){e&&(t.prototype.init.call(this,e.nation),this._rank=e.rank,this._score=e.score)},e.prototype.getRank=function(){return this._rank},e.prototype.getScore=function(){return this._score},e}(t("NationSimpleInfo")));e.exports=a,cc._RF.pop()},{NationSimpleInfo:"NationSimpleInfo"}],NationDuelSVOModel:[function(t,e,i){"use strict";cc._RF.push(e,"89fcbsvBg1CJoi9cRUd3gEW","NationDuelSVOModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.setData=function(e){e&&(t.prototype.init.call(this,e.nation),this._oppositeId=e.oppositeId,this._score=e.score)},e.prototype.getOppositeId=function(){return this._oppositeId},e.prototype.getScore=function(){return this._score},e}(t("NationSimpleInfo")));e.exports=a,cc._RF.pop()},{NationSimpleInfo:"NationSimpleInfo"}],NationDuelSeasonRankVOModel:[function(t,e,i){"use strict";cc._RF.push(e,"ce183YurIFFx4AhPPCp53R/","NationDuelSeasonRankVOModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.setData=function(e){e&&(t.prototype.init.call(this,e.nation),this._season=e.season,this._score=e.score)},e.prototype.getSeason=function(){return this._season},e.prototype.getScore=function(){return this._score},e}(t("NationSimpleInfo")));e.exports=a,cc._RF.pop()},{NationSimpleInfo:"NationSimpleInfo"}],NationDungeonManager:[function(t,e,i){"use strict";cc._RF.push(e,"deda5PHJphANJQ0WxTXTaZx","NationDungeonManager"),cc._RF.pop()},{}],NationDungeonModel:[function(t,e,i){"use strict";cc._RF.push(e,"7e754SPuVpD8aaGsL1D/UFt","NationDungeonModel");var n=window.td,a=function(){function t(){this._id=0,this._nextId=0,this._preId=0,this._totalTimes=0,this._passTimes=0,this._rewardStatus=!0,this._bgImg="",this._nameImg="",this._isCanChallenge=!1,this._monsterTotalHp=0,this._monsterLeftHp=0}return t.prototype.init=function(t){this._id=t.id,this._nextId=t.nextId,this._preId=t.preId,this._totalTimes=t.passedTimes,this._baseRewards=n.RewardManager.getRewardListDetailArray(t.baseRewards),this._passedRewards=n.RewardManager.getRewardListDetailArray(t.passedRewards),this._bgImg=t.bgImg,this._nameImg=t.nameImg;var e=n.GetTableClass(n.TableEnum.MonsterGroup).getMonsterGroupDataById(t.monsterGroupId);this._monsterTotalHp=0;for(var i=0;i<e.length;i++)this._monsterTotalHp=e[i].getHp();this._monsterLeftHp=this._monsterTotalHp},t.prototype.getId=function(){return this._id},t.prototype.getNextId=function(){return this._nextId},t.prototype.getPreId=function(){return this._preId},t.prototype.setCanChallenge=function(t){this._isCanChallenge=t},t.prototype.isCanChallenge=function(){return this._isCanChallenge},t.prototype.setPassTimes=function(t){this._passTimes=t},t.prototype.getPassTimes=function(){return this._passTimes},t.prototype.getTotalTimes=function(){return this._totalTimes},t.prototype.getBaseRewards=function(){return this._baseRewards},t.prototype.getPassRewards=function(){return this._passedRewards},t.prototype.setRewardStatus=function(t){this._rewardStatus=t},t.prototype.getRewardStatus=function(){return this._rewardStatus},t.prototype.isPassed=function(){return this._passTimes>=this._totalTimes},t.prototype.getBgImg=function(){return this._bgImg},t.prototype.getNameImg=function(){return this._nameImg},t.prototype.getMonsterTotalHp=function(){return this._monsterTotalHp},t.prototype.setMonsterLeftHp=function(t){this._monsterLeftHp=t},t.prototype.getMonsterLeftHp=function(){return this._monsterLeftHp},t.prototype.getPercent=function(){var t;return(t=((this._totalTimes-this._passTimes-1)*this._monsterTotalHp+this._monsterLeftHp)/(this._totalTimes*this._monsterTotalHp)*100)<0?t=0:t>100&&(t=100),t},t}();e.exports=a,cc._RF.pop()},{}],NationDungeonTable:[function(t,e,i){"use strict";cc._RF.push(e,"e9cf1Z+Z/lO8amG3Dq4aVPN","NationDungeonTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationDungeonTable",e._tblName="nation_dungeon_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];a.bgImg="res/ui/GJ_guojia/"+a.bgImg+".png",a.nameImg="res/ui/Meishuzi/"+a.nameImg+".png",t[a.id]=a}},e.prototype.getDataById=function(t){return this._data&&this._data[t]?this._data[t]:null},e.prototype.getAllData=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationEndlessManager:[function(t,e,i){"use strict";cc._RF.push(e,"7fe32R3wJ9B+ZZFsy1XrSv4","NationEndlessManager"),cc._RF.pop()},{}],NationEndlessModel:[function(t,e,i){"use strict";cc._RF.push(e,"c2fceS7KblADZZXg6fPcTvJ","NationEndlessModel");var n=window.td,a=function(){function t(){this._floor=0,this._showId=0,this._groupId=0,this._des=""}return t.prototype.init=function(t){t&&(this._floor=t.floor,this._showId=t.showID,this._groupId=t.monsterGroup,this._des=t.des||"",this._baseReward=n.RewardManager.getRewardListDetailArray(t.baseRewards),this._attributeAdd=n.GlobalFunction.parseEffectArray(t.passedAttributeTTPercent))},t.prototype.getFloor=function(){return this._floor},t.prototype.getShowMonsterId=function(){return this._showId},t.prototype.getMonsterGroupId=function(){return this._groupId},t.prototype.getDes=function(){return this._des},t.prototype.getRewards=function(){return this._baseReward},t.prototype.getAttributeAdd=function(){return this._attributeAdd},t}();e.exports=a,cc._RF.pop()},{}],NationEndlessTable:[function(t,e,i){"use strict";cc._RF.push(e,"d0091qHpGtAFpcwPbvBwYfB","NationEndlessTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationEndlessTable",e._tblName="nation_endless_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.floor]=a}},e.prototype.getDataByFloor=function(t){return this._data&&this._data[t]?this._data[t]:null},e.prototype.getAllData=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationEnum:[function(t,e,i){"use strict";cc._RF.push(e,"b9c58K3VANFCo9PpyA+oA6q","NationEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.ScuffleYamaRankRecordBtnType=i.ScuffleYamaSwitchType=i.ScuffleYamaChallengeType=i.ScuffleYamaStage=i.NationBeastRewardState=i.NationBeastState=i.NationBossRankType=i.NationBossDifficult=i.NationWarRankType=i.NationWarAttackDetailTag=i.SiegeState=i.NationRecordMax=i.ArmyFlagMax=i.NationTechOperateType=i.NationMemberTypeImg=i.NationDonateType=i.NationRankType=i.NationRecordType=i.ArmyJoinLimitType=i.NationAddType=i.NationMemberType=void 0,function(t){t[t.NONE=0]="NONE",t[t.KING=1]="KING",t[t.EARL=2]="EARL",t[t.ELITE=3]="ELITE",t[t.MEMBER=4]="MEMBER"}(i.NationMemberType||(i.NationMemberType={})),function(t){t[t.JOIN=1]="JOIN",t[t.CREATE=2]="CREATE"}(i.NationAddType||(i.NationAddType={})),function(t){t[t.NONE=0]="NONE",t[t.NO_LIMIT=1]="NO_LIMIT",t[t.ACTOR_LEVEL=2]="ACTOR_LEVEL",t[t.REFUSE_IN=3]="REFUSE_IN"}(i.ArmyJoinLimitType||(i.ArmyJoinLimitType={})),function(t){t[t.JOIN=1]="JOIN",t[t.APPOINT_OFFICER=2]="APPOINT_OFFICER",t[t.APPOINT_MEMBER=3]="APPOINT_MEMBER",t[t.KING_REPLACE=4]="KING_REPLACE",t[t.Donate_Gold=5]="Donate_Gold",t[t.Donate_Diamond=6]="Donate_Diamond",t[t.Donate_VIP=7]="Donate_VIP"}(i.NationRecordType||(i.NationRecordType={})),function(t){t[t.Combat=1]="Combat",t[t.Level=2]="Level"}(i.NationRankType||(i.NationRankType={})),function(t){t[t.crystalDonateType=1]="crystalDonateType",t[t.diamondDonateType=2]="diamondDonateType"}(i.NationDonateType||(i.NationDonateType={})),i.NationMemberTypeImg={0:"XM_wz_chenghao_cy",4:"XM_wz_chenghao_cy",3:"XM_wz_chenghao_jy",2:"XM_wz_chenghao_fmz",1:"XM_wz_chenghao_mz"},i.NationTechOperateType={learn:1,study:2},i.ArmyFlagMax=4,i.NationRecordMax=50,function(t){t[t.NONE=0]="NONE",t[t.BATTLE=1]="BATTLE",t[t.SLEEP=2]="SLEEP",t[t.NATION_BATTLE=3]="NATION_BATTLE",t[t.NATION_SLEEP=4]="NATION_SLEEP"}(i.SiegeState||(i.SiegeState={})),i.NationWarAttackDetailTag={NationTag:1,PersonTag:2},i.NationWarRankType={ARMY_ROUND_SCORE:1,GAMER_ROUND_SCORE:2,ARMY_ROUND_FIRST:3,ARMY_TERRITORY_SCORE:4,ARMY_SIEGE_SCORE:5,GAMER_TERRITORY_SCORE:6},i.NationBossDifficult={Normal:1,Hard:2,Nightmare:3},i.NationBossRankType={Personal:1,National:2},i.NationBeastState={None:0,Feed:1,Battle:2,Kill:3,NotKill:4},i.NationBeastRewardState={NotReceive:0,Received:1},i.ScuffleYamaStage={Prepare:0,Fight:1,Over:2},i.ScuffleYamaChallengeType={None:0,ChallengeBoss:1,ChallengePlayer:2},i.ScuffleYamaSwitchType={None:0,NationRank:1,PlayerRank:2,ChallengeRecord:3},i.ScuffleYamaRankRecordBtnType={Rank:0,Record:1},cc._RF.pop()},{}],NationInfoModel:[function(t,e,i){"use strict";cc._RF.push(e,"bdc73V0Zk9JGp4hkbwbhHso","NationInfoModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("BaseUser"),r=(t("CommonEnum"),t("NationBaseInfo")),o=t("NationMemberInfo"),s=t("NationRecord"),l=t("NationTechModel"),c=t("../Enum/NationEnum"),u=function(){function t(){this._memberType=0,this._appliedIdList=[],this._bossScore=0,this._bossBoughtTimes=0,this._bossChallengedTimes=0,this._exp=0,this._notice="",this._appointNextTime=0,this._noticeNextTime=0,this._renameNextTime=0,this._reflagNextTime=0,this._applyList=[],this._donateProgress=0,this._donateList=[],this._donateId=0,this._donateReceiveList=[],this._kickOffCount=0,this._lastExitTime=0}return t.prototype.init=function(){this._initTech()},t.prototype.setData=function(t){if(void 0!==t.memberType&&(this._memberType=parseInt(t.memberType)),void 0!==t.appliedList&&(this._appliedIdList=t.appliedList),void 0!==t.sciTechMap){var e=t.sciTechMap;for(var i in this._sciTechModelList){var o=this._sciTechModelList[i];if(o){var s=e[i]||0;o.setPersonTechLevel(s)}}}if((void 0!==t.nationBossTimes&&this._bossChallengedTimes!==t.nationBossTimes||void 0!==t.nationBossBuyTimes&&this._bossBoughtTimes!==t.nationBossBuyTimes||void 0!==t.bossScore&&this._bossScore!==t.bossScore)&&(void 0!==t.bossScore&&(this._bossScore=t.bossScore),void 0!==t.nationBossTimes&&(this._bossChallengedTimes=t.nationBossTimes),void 0!==t.nationBossBuyTimes&&(this._bossBoughtTimes=t.nationBossBuyTimes),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_NB_CHALLENGE_TIMES)),void 0!==t.nationBossReceivesList&&(this._bossRewardStatus=t.nationBossReceivesList,n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_NATION_BOSS_REWARD)),void 0!==t.scoreTaskGroupId&&(this._bossTaskGroupId=t.scoreTaskGroupId,n.EventUtil.dispatchEvent(n.EventNameEnum.NATION_BOSS_TASK_GROUP_ID_CHANGED,this._bossTaskGroupId)),void 0!==t.scoreTaskList&&(this._bossTaskStatus=t.scoreTaskList,n.EventUtil.dispatchEvent(n.EventNameEnum.NATION_BOSS_TASK_STATUS_UPDATED)),void 0!==t.vo&&(this._myNationBaseInfo=new r,this._myNationBaseInfo.init(t.vo)),void 0!==t.exp&&(this._exp=t.exp),void 0!==t.notice&&(this._notice=t.notice),void 0!==t.appointNextTime&&(this._appointNextTime=t.appointNextTime),void 0!==t.noticeNextTime&&(this._noticeNextTime=t.noticeNextTime),void 0!==t.renameNextTime&&(this._renameNextTime=t.renameNextTime),void 0!==t.reflagNextTime&&(this._reflagNextTime=t.reflagNextTime),void 0!==t.donateProgress&&(this._donateProgress=t.donateProgress),void 0!==t.donateList&&(this._donateList=t.donateList),void 0!==t.donateId&&(this._donateId=t.donateId),void 0!==t.donateReceiveList&&(this._donateReceiveList=t.donateReceiveList),void 0!==t.lastCreateTime&&(this._lastCreateTime=parseInt(t.lastCreateTime)),void 0!==t.lastExitTime&&(this._lastExitTime=parseInt(t.lastExitTime)),void 0!==t.kickOffCount&&(this._kickOffCount=parseInt(t.kickOffCount)),void 0!==t.applyList){var l=t.applyList;this._applyList=[];for(var c=0,u=l.length;c<u;c++){var d=l[c],h=new a;h.init("ApplyUserInfo",d),this._applyList.push(h)}this._applyList.sort(function(t,e){return e.fightPower-t.fightPower})}},t.prototype.getNationBossScore=function(){return this._bossScore},t.prototype.getNationBossChallengedTimes=function(){return this._bossChallengedTimes},t.prototype.getNationBossBoughtTimes=function(){return this._bossBoughtTimes},t.prototype.getNationBossRewardStatus=function(){return this._bossRewardStatus||[]},t.prototype.getNationBossTaskGroupId=function(){return this._bossTaskGroupId},t.prototype.getNationBossTaskStatus=function(){return this._bossTaskStatus||[]},t.prototype.getLevel=function(){return this._myNationBaseInfo?this._myNationBaseInfo.getLevel():0},t.prototype.getFund=function(){return this._myNationBaseInfo?this._myNationBaseInfo.getFund():0},t.prototype.getId=function(){return this._myNationBaseInfo?this._myNationBaseInfo.getId():0},t.prototype.getNeedExp=function(){return this._myNationBaseInfo?this._myNationBaseInfo.getNeedExp():1},t.prototype.getMemberCount=function(){return this._myNationBaseInfo?this._myNationBaseInfo.getMemberCount():0},t.prototype.getLimitMemberCount=function(){return this._myNationBaseInfo?this._myNationBaseInfo.getLimitMemberCount():0},t.prototype.getNationName=function(){return this._myNationBaseInfo?this._myNationBaseInfo.getNationSimpleInfo().getName():null},t.prototype.getMyNationBaseInfo=function(){return this._myNationBaseInfo},t.prototype.getSelfMemberType=function(){return this._memberType},t.prototype.canJoin=function(){return this.getJionCd()<=0},t.prototype.getJoinCdStr=function(){var t,e,i=this.getJionCd();if(!i)return null;var n=[];return i>=36e5?(t=Math.floor(i/36e5),e=Math.floor((i-36e5*t)/6e4%6e4),n.push(t.toString()),n.push(e.toString())):(e=Math.ceil(i/6e4%6e4),n.push(e.toString())),n},t.prototype.getJionCd=function(){var t=n.TimeUtil.getTime();return 60*n.GetConfig("NATION_EXIT_INTERVAL_TIME")*60*1e3-(t-this._lastExitTime)},t.prototype.canCreate=function(){return!this._lastCreateTime||n.TimeUtil.getTime()-24*n.GetConfig("NATION_CREATE_INTERVAL_TIME")*60*60*1e3>=this._lastCreateTime},t.prototype.lefeTime=function(){var t=n.TimeUtil.getTime(),e=n.GetConfig("NATION_CREATE_INTERVAL_TIME");return(this._lastCreateTime+24*e*60*60*1e3-t)/1e3},t.prototype.getExp=function(){return this._exp},t.prototype.getExpPercent=function(){return parseInt(this._exp/this.getNeedExp()*1e4)/100},t.prototype.getNotice=function(){return this._notice},t.prototype.getSciTechModelList=function(){return this._sciTechModelList},t.prototype.getAppointNextTime=function(){return this._appointNextTime},t.prototype.getNoticeNextTime=function(){return this._noticeNextTime},t.prototype.getRenameNextTime=function(){return this._renameNextTime},t.prototype.getReFalgNextTime=function(){return this._reflagNextTime},t.prototype.getApplyList=function(){return this._applyList},t.prototype.delApplyData=function(t){for(var e=0,i=this._applyList.length;e<i;e++){if(this._applyList[e].sid===t)return void this._applyList.splice(e,1)}},t.prototype.delAllApplyData=function(){this._applyList=[]},t.prototype.getMemberType=function(){return this._memberType},t.prototype.getEndLessFloor=function(){return this._endlessFloor},t.prototype.getDonateProgress=function(){return this._donateProgress},t.prototype.getDonateList=function(){return this._donateList},t.prototype.getDonateState=function(){return this._donateId},t.prototype.getDonateReceiveList=function(){return this._donateReceiveList},t.prototype.getLeftChallengeTimes=function(){var t=this._challengeTotalTimes-this._challengeTimes;return t<0&&(t=0),t},t.prototype.getChallengeTimes=function(){return this._challengeTimes},t.prototype.getChallengeTotalTimes=function(){return this._challengeTotalTimes},t.prototype.isRequestedNation=function(t){return ArrayUtils.contains(this._appliedIdList,t)},t.prototype.getMemberTypeName=function(t){return this._memberType===c.NationMemberType.NONE?"":(this._jobs||(this._jobs=n.Language.nationJobs.split("|")),this._jobs[t-1])},t.prototype._sortMemberList=function(t){t.sort(function(t,e){var i=t.onLineState,n=e.onLineState,a=t.getMemberType(),r=e.getMemberType();return i&&!n?-1:!i&&n?1:a!==r?a-r:t.level<e.level?1:t.level>e.level?-1:t.fightPower<e.fightPower?1:t.fightPower>e.fightPower?-1:void 0})},t.prototype.clearMemberList=function(){this._memberList=null},t.prototype.delMember=function(t){this._memberList&&this._memberList[t]&&delete this._memberList[t]},t.prototype.setMemberList=function(t){if(t&&0!==t.length){this._memberList||(this._memberList={});for(var e=0,i=t.length;e<i;e++){var a=t[e].attributes[n.UserPropertyEnum.GamerId];if(this._memberList[a])this._memberList[a].updateAttr(t[e]);else{var r=new o;r.init(t[e]),this._memberList[a]=r}}}},t.prototype.getMemTypeCount=function(t){var e=0;for(var i in this._memberList){this._memberList[i].getMemberType()===t&&e++}return e},t.prototype.getMemberList=function(){var t=[];for(var e in this._memberList)t.push(this._memberList[e]);return this._sortMemberList(t),t},t.prototype.setRecordList=function(t){if(t&&this.getMyNationBaseInfo()){this._recordList=[];for(var e=0,i=t.length;e<i;e++){var n=new s;n.init(t[e]),this._recordList.push(n)}this._recordList.sort(function(t,e){return e.getTime()-t.getTime()}),this._recordList.length>c.NationRecordMax&&this._recordList.splice(c.NationRecordMax-1,this._recordList.length-c.NationRecordMax)}},t.prototype.addRecordList=function(t){if(t&&this.getMyNationBaseInfo()){this._recordList||(this._recordList=[]);for(var e=0,i=t.length;e<i;e++){var n=new s;n.init(t[e]),this._recordList.push(n)}this._recordList.sort(function(t,e){return e.getTime()-t.getTime()}),this._recordList.length>c.NationRecordMax&&this._recordList.splice(c.NationRecordMax-1,this._recordList.length-c.NationRecordMax)}},t.prototype.getRecordList=function(){var t=[];if(!this._recordList)return t;for(var e=n.TimeUtil.getTime(),i=60*n.GetTableClass(n.TableEnum.Config).getConfig("nationRecordMsgInterval")*1e3,a=0;a<this._recordList.length;a++){var r=this._recordList[a];r.getTime()+i<=e||t.push(r)}return t},t.prototype.getNationTechModelById=function(t){return this._sciTechModelList[t]},t.prototype.nationTechHasRedPoint=function(t){var e=this.getLevel(),i=n.ItemManager;for(var a in this._sciTechModelList){var r=this._sciTechModelList[a];if(r.getFeatures()===t){var o=r.getPersonTechLevel(),s=r.getMaxUpLvByNationLv(e);if(!(o>=r.getMaxLv()||o>=s)){var l=r.getUpgradeCost();if(l&&l.length>0)if(l=l[0],i.getItemNumById(l[1])>=l[2])return!0}}}return!1},t.prototype._initTech=function(){this._sciTechModelList={};var t=n.GetTableClass(n.TableEnum.NationSciTechTypeTable).getTechDataList();for(var e in t){var i=t[e];if(i){var a=new l;a.init(i),this._sciTechModelList[e]=a}}},t.prototype.canJoinCityAttack=function(){return!1},t.prototype.getKickOffCount=function(){return this._kickOffCount},t}();e.exports=u,cc._RF.pop()},{"../Enum/NationEnum":"NationEnum",BaseUser:"BaseUser",CommonEnum:void 0,NationBaseInfo:"NationBaseInfo",NationMemberInfo:"NationMemberInfo",NationRecord:"NationRecord",NationTechModel:"NationTechModel"}],NationLevelTable:[function(t,e,i){"use strict";cc._RF.push(e,"7c047Ck9zJA17cjhndrbB84","NationLevelTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationLevelTable",e._tblName="nation_level_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.level]=a}},e.prototype.getDataByLevel=function(t){return this._data&&this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationMainManager:[function(t,e,i){"use strict";cc._RF.push(e,"d0dd0cQyUtFbIooVj8PU2Qj","NationMainManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("../Enum/NationEnum"),r=t("./NationDuelManager"),o=t("../../Shop/Manager/ShopManager"),s=t("../../Shop/Manager/ShopEnum"),l=t("NationInfoModel"),c=t("NationBaseInfo"),u=t("NationRankInfo"),d=function(){function t(){this._nationListCurPage=0,this._nationListPages=0,this._bShowOnHookPanel=!1,this._approveGamerId=0,this._rankCurPage=0,this._rankMaxPages=0,this.MAX_KICKOFF=0,this._isLoadInfo=!1,this._isOpened=!1,this._isRequestRecord=!1}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._nationInfo=null,this._nationList=[],this._nationListCurPage=0,this._nationListPages=0,this._rankCurPage=0,this._rankMaxPages=0,this._donateRecords=[],this._bShowOnHookPanel=!1,this._isLoadInfo=!1,this._isRequestRecord=!1},t.prototype.addListener=function(){var t=n.MsgModuleName.NATION,e=n.MsgCmd.NATION,i=n.ServerDelegate;i.registerMessage(t,e.GET_ACTOR,this._resNationGetActor.bind(this)),i.registerMessage(t,e.GET_INFO,this._resNationGetInfo.bind(this)),i.registerMessage(t,e.PUSH_NATION_ACTOR,this._resNationGetActor.bind(this)),i.registerMessage(t,e.PUSH_NATION_INFO,this._resNationGetInfo.bind(this)),i.registerMessage(t,e.GET_MEMBER,this._receiveMemberInfo.bind(this)),i.registerMessage(t,e.NATION_GET_RECORD,this._resNationRecord.bind(this)),i.registerMessage(t,e.NATION_APPOINT,this._resNationAppoint.bind(this)),i.registerMessage(t,e.NATION_DONATE_PROGRESS,this._resNationReceiveSalary.bind(this)),i.registerMessage(t,e.NATION_NOTICE,this._resNationNotice.bind(this)),i.registerMessage(t,e.NATION_DONATE,this._resNationDonate.bind(this)),i.registerMessage(t,e.PUSH_NATION_MEMBER,this._receiveMemberInfo.bind(this)),i.registerMessage(t,e.PUSH_NATION_RECORD,this._pushNationRecord.bind(this)),i.registerMessage(t,e.NATION_GET_LIST,this._resGetNationList.bind(this)),i.registerMessage(t,e.NATION_APPLY,this._resNationApply.bind(this)),i.registerMessage(t,e.NATION_CREATE,this._resArmyCreate.bind(this)),i.registerMessage(t,e.NATION_RENAME,this._resArmyRename.bind(this)),i.registerMessage(t,e.NATION_REFLAG,this._resArmyReFlag.bind(this)),i.registerMessage(t,e.NATION_LIMIT,this._resArmySetting.bind(this)),i.registerMessage(t,e.NATION_TRANSFER,this._resArmyTransfer.bind(this)),i.registerMessage(t,e.NATION_KICK_OFF,this._resKickOff.bind(this)),i.registerMessage(t,e.NATION_EXIT,this._resExit.bind(this)),i.registerMessage(t,e.NATION_APPROVE,this._resNationApprove.bind(this)),i.registerMessage(t,e.NATION_LEVEL_RANK,this._resRankLevel.bind(this)),i.registerMessage(t,e.NATION_POWER_RANK,this._resRankPower.bind(this)),i.registerMessage(t,e.PUSH_NATION_EXIT,this._pushNationExit.bind(this)),i.registerMessage(t,e.NATION_DONATE_RANK,this._resDonateRank.bind(this)),i.registerMessage(t,e.NATION_SCI_TECH_UPGRADE,this._resNationTechLearn.bind(this)),i.registerMessage(t,e.NATION_SCI_TECH_RESET,this._onGetTechReset.bind(this))},t.prototype.addEventListener=function(){var t=n.EventNameEnum,e={};e[t.Req_NATION_GET_ACTOR]=this._reqNationGetActor,e[t.Req_NATION_GET_INFO]=this._reqNationGetInfo,e[t.Req_Apply_Join_Nation]=this._reqNationApply,e[t.Req_NATION_MEMBER]=this._requestNationMemberInfo,e[t.Req_NATION_RECORD]=this._reqNationRecord,e[t.Req_NATION_RECEIVE_SALARY]=this._reqNationReceiveSalary,e[t.Req_NATION_NOTICE]=this._reqNationNotice,e[t.Req_NATION_APPOINT]=this._reqNationAppoint,e[t.Req_NATION_Donate]=this._reqNationDonate,e[t.Req_Get_Nation_List]=this._reqGetNationList,e[t.Req_Army_Create]=this._reqArmyCreate,e[t.Req_Modify_Nation_Name]=this._reqArmyRename,e[t.Req_Modify_Nation_Flag]=this._reqArmyReFlag,e[t.Req_Nation_Limit_Modify]=this._reqArmySetting,e[t.Req_Nation_Transfer]=this._reqArmyTransfer,e[t.Req_Nation_Kick_Off]=this._reqKickOff,e[t.Req_Nation_Exit]=this._reqExit,e[t.Req_Approve_join_Nation]=this._reqNationApprove,e[t.Req_Nation_Power_Rank]=this._reqRankPower,e[t.Req_Nation_Level_Rank]=this._reqRankLevel,e[t.Req_Nation_Donate_Rank]=this._reqDonateRank,e[t.Req_Tech_Learn]=this._reqNationTechLearn,e[t.OPEN_NATION_ADD_VIEW]=this._onOpenAddView,e[t.REQUEST_NATION_TECH_RESET]=this._requestTechReset,n.EventUtil.registerEvents(e,this)},t.prototype.isRequestedRecord=function(){return this._isRequestRecord},t.prototype.getNationInfo=function(){return this._nationInfo},t.prototype.getNationList=function(){return this._nationList},t.prototype.getNationListPage=function(){return this._nationListCurPage},t.prototype.getNationListPages=function(){return this._nationListPages},t.prototype.isJoinNation=function(){return!(!this._nationInfo||this._nationInfo.getSelfMemberType()===a.NationMemberType.NONE)},t.prototype.getCurRankPage=function(){return this._rankCurPage},t.prototype.getMaxRankpages=function(){return this._rankMaxPages},t.prototype.getSelfRankInfo=function(){return this._selfRankInfo},t.prototype.getMemberTypeImg=function(t){return a.NationMemberTypeImg[t]},t.prototype.getNatioDonateReocreds=function(){return this._donateRecords},t.prototype._reqNationGetActor=function(){var t={};t.module=n.MsgModuleName.NATION,t.cmd=n.MsgCmd.NATION.GET_ACTOR,n.ServerDelegate.sendMessage(t)},t.prototype._resNationGetActor=function(t,e){t===n.NetCode.SUCCESS&&(this._nationInfo||(this._nationInfo=new l,this._nationInfo.init()),this._nationInfo.setData(e),n.EventUtil.dispatchEvent(n.EventNameEnum.Res_NATION_GET_ACTOR),this.isJoinNation()?n.EventUtil.dispatchEvent(n.EventNameEnum.REQUEST_NATION_BEAST_INFO):n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_BEAST_INFO),this._isLoadInfo||this._nationInfo.getSelfMemberType()==a.NationMemberType.NONE||n.EventUtil.dispatchEvent(n.EventNameEnum.Req_NATION_GET_INFO),n.EventUtil.dispatchEvent(n.EventNameEnum.INIT_DATA_LOADED,n.LoadKey.NationActor))},t.prototype._reqNationGetInfo=function(){var t={};t.module=n.MsgModuleName.NATION,t.cmd=n.MsgCmd.NATION.GET_INFO,n.ServerDelegate.sendMessage(t)},t.prototype._resNationGetInfo=function(t,e){t===n.NetCode.SUCCESS&&(this._nationInfo||(this._nationInfo=new l,this._nationInfo.init()),this._nationInfo.setData(e),this._isLoadInfo=!0,r.default.getInstance().reqBaseInfo(),n.EventUtil.dispatchEvent(n.EventNameEnum.NATION_GET_INFO_UPDATED))},t.prototype._reqNationApply=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_APPLY,e.nationId=t,n.ServerDelegate.sendMessage(e)},t.prototype._resNationApply=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Apply_Join_Nation)},t.prototype._requestNationMemberInfo=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.GET_MEMBER,e.page=t,1===t&&this._nationInfo.clearMemberList(),n.ServerDelegate.sendMessage(e)},t.prototype._receiveMemberInfo=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.members;this._nationInfo&&(this._nationInfo.setMemberList(i),n.EventUtil.dispatchEvent(n.EventNameEnum.Res_NATION_MEMBER))}},t.prototype._reqNationRecord=function(){if(!this._isRequestRecord){var t={};t.module=n.MsgModuleName.NATION,t.cmd=n.MsgCmd.NATION.NATION_GET_RECORD,n.ServerDelegate.sendMessage(t)}},t.prototype._resNationRecord=function(t,e){if(t===n.NetCode.SUCCESS){this._isRequestRecord=!0;var i=e.records;this._nationInfo&&this._nationInfo.setRecordList(i),n.EventUtil.dispatchEvent(n.EventNameEnum.Res_NATION_RECORD)}},t.prototype._pushNationRecord=function(t,e){if(t===n.NetCode.SUCCESS){this._isRequestRecord=!0;var i=e.records;this._nationInfo&&this._nationInfo.addRecordList(i),n.EventUtil.dispatchEvent(n.EventNameEnum.Res_NATION_RECORD)}},t.prototype._reqNationReceiveSalary=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_DONATE_PROGRESS,e.id=t,n.ServerDelegate.sendMessage(e)},t.prototype._resNationReceiveSalary=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.rewardResult,a=n.RewardManager.parseRewardResult(i);n.GlobalFunction.showRewards(a),n.EventUtil.dispatchEvent(n.EventNameEnum.Res_NATION_RECEIVE_SALARY)}},t.prototype._reqNationNotice=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_NOTICE,e.notice=t,n.ServerDelegate.sendMessage(e)},t.prototype._resNationNotice=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.Res_NATION_NOTICE)},t.prototype._reqNationAppoint=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_APPOINT,e.targeterId=t.gamerId,e.memberType=t.memberType,n.ServerDelegate.sendMessage(e)},t.prototype._resNationAppoint=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.Res_NATION_APPOINT)},t.prototype._reqNationDonate=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_DONATE,e.id=t,n.ServerDelegate.sendMessage(e)},t.prototype._resNationDonate=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.rewardResult,a=n.RewardManager.parseRewardResult(i);n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_GET_ITEM_TIPS,a),n.EventUtil.dispatchEvent(n.EventNameEnum.Res_NATION_Donate)}},t.prototype._reqGetNationList=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_GET_LIST,e.page=t,1===t&&(this._nationList=[]),n.ServerDelegate.sendMessage(e)},t.prototype._resGetNationList=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.page,a=e.pages,r=e.list;this._nationListCurPage=i,this._nationListPages=a;for(var o=[],s=0,l=r.length;s<l;s++){var u=new c;u.init(r[s]),this._updateNationVO(u,o)}n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Get_Nation_List,o)}},t.prototype._updateNationVO=function(t,e){for(var i=this._nationList,n=!1,a=0,r=i.length;a<r;a++){var o=i[a];if(o.getNationSimpleInfo().getId()===t.getNationSimpleInfo().getId()){o=t,n=!0;break}}n||(e.push(t),i.push(t))},t.prototype._reqArmyCreate=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_CREATE,e.name=t.getName(),e.flag=t.getFlag(),e.flagId=t.getFlagId(),n.ServerDelegate.sendMessage(e)},t.prototype._resArmyCreate=function(t,e){t===n.NetCode.SUCCESS&&(this._nationInfo&&this._nationInfo.setData(e),n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Army_Create))},t.prototype._reqArmyRename=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_RENAME,e.notice=t,n.ServerDelegate.sendMessage(e)},t.prototype._resArmyRename=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Modify_Nation_Name)},t.prototype._reqArmyReFlag=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_REFLAG,e.notice=t,n.ServerDelegate.sendMessage(e)},t.prototype._resArmyReFlag=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Modify_Nation_Flag)},t.prototype._reqArmySetting=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_LIMIT,e.type=t.type,e.value=t.value,n.ServerDelegate.sendMessage(e)},t.prototype._resArmySetting=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Nation_Limit_Modify)},t.prototype._reqArmyTransfer=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_TRANSFER,e.targetId=t,n.ServerDelegate.sendMessage(e)},t.prototype._resArmyTransfer=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Nation_Transfer)},t.prototype._reqKickOff=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_KICK_OFF,e.targetId=t,n.ServerDelegate.sendMessage(e)},t.prototype._resKickOff=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Nation_Kick_Off)},t.prototype._reqExit=function(){var t={};t.module=n.MsgModuleName.NATION,t.cmd=n.MsgCmd.NATION.NATION_EXIT,n.ServerDelegate.sendMessage(t)},t.prototype._resExit=function(t,e){if(t===n.NetCode.SUCCESS&&(this._isLoadInfo=!1,n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Nation_Exit),!this._bShowOnHookPanel)){this._bShowOnHookPanel=!0;var i=setTimeout(function(){clearTimeout(i),n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_PANEL,n.PanelEnum.Panel_PVE_FIGHT_HOOK)},20)}},t.prototype._pushNationExit=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.targetId,a=e.selfExit;if(this._nationInfo&&(this._nationInfo.delMember(i),i===n.Account.getUserData().sid)){var r=new n.BroadcastContent(a?85:84);if(n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_BROADCAST,r),this._isLoadInfo=!1,this.isInNationView()&&!this._bShowOnHookPanel){this._bShowOnHookPanel=!0;var o=setTimeout(function(){clearTimeout(o),n.EventUtil.dispatchEvent(n.EventNameEnum.SHOW_PANEL,n.PanelEnum.Panel_PVE_FIGHT_HOOK)},20)}n.EventUtil.dispatchEvent(n.EventNameEnum.CLEAR_NATION_DATA),n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Nation_Exit),n.EventUtil.dispatchEvent(n.EventNameEnum.Req_NATION_GET_ACTOR)}}},t.prototype._reqNationApprove=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_APPROVE,e.targetId=t.gamerId,e.isApproved=t.isApproved,this._approveGamerId=t.gamerId,n.ServerDelegate.sendMessage(e)},t.prototype._resNationApprove=function(t,e){t===n.NetCode.SUCCESS&&(0===this._approveGamerId?this._nationInfo.delAllApplyData():this._nationInfo.delApplyData(this._approveGamerId),n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Approve_join_Nation))},t.prototype._reqRankPower=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_POWER_RANK,e.page=t||1,n.ServerDelegate.sendMessage(e)},t.prototype._resRankPower=function(t,e){if(t===n.NetCode.SUCCESS){this._rankCurPage=e.page,this._rankMaxPages=e.pages;var i=e.ranks,r=[];this.isJoinNation()&&i.length>0&&(this._selfRankInfo=new u,this._selfRankInfo.init(i[i.length-1]),this._selfRankInfo.setType(a.NationRankType.Combat),i.splice(i.length-1,1));for(var o=0,s=i.length;o<s;o++){var l=new u;l.setType(a.NationRankType.Combat),l.init(i[o]),r.push(l)}n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Nation_Power_Rank,r)}},t.prototype._reqRankLevel=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_LEVEL_RANK,e.page=t||1,n.ServerDelegate.sendMessage(e)},t.prototype._resRankLevel=function(t,e){if(t===n.NetCode.SUCCESS){this._rankCurPage=e.page,this._rankMaxPages=e.pages;var i=e.ranks,r=[];this.isJoinNation()&&i.length>0&&(this._selfRankInfo=new u,this._selfRankInfo.init(i[i.length-1]),this._selfRankInfo.setType(a.NationRankType.Level),i.splice(i.length-1,1));for(var o=0,s=i.length;o<s;o++){var l=new u;l.init(i[o]),l.setType(a.NationRankType.Level),r.push(l)}n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Nation_Level_Rank,r)}},t.prototype._reqDonateRank=function(){var t={};t.module=n.MsgModuleName.NATION,t.cmd=n.MsgCmd.NATION.NATION_DONATE_RANK,n.ServerDelegate.sendMessage(t)},t.prototype._resDonateRank=function(t,e){if(t===n.NetCode.SUCCESS){this._rankCurPage=e.page,this._rankMaxPages=e.pages;e.ranks;n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Nation_Donate_Rank,[])}},t.prototype._reqNationTechLearn=function(t){var e={};e.module=n.MsgModuleName.NATION,e.cmd=n.MsgCmd.NATION.NATION_SCI_TECH_UPGRADE,e.id=t,n.ServerDelegate.sendMessage(e)},t.prototype._resNationTechLearn=function(t,e){t===n.NetCode.SUCCESS&&n.EventUtil.dispatchEvent(n.EventNameEnum.Res_Tech_Learn)},t.prototype.isInNationView=function(){if(gdk.scene.getSceneName()!==n.SceneName.MainScene)return!1;var t=n.PanelManager.getInstance().getCurShowPanel();if(!t)return!1;var e=t.getPanelEnum(),i=n.PanelEnum,a=[i.Panel_NationMain,i.Panel_NationDonationView,i.Panel_NationTechMain,i.Panel_NationBoss,i.Panel_NationCityWar,i.Panel_NationDuel,i.Panel_NationDuelAppoint,i.Panel_NationDuelCampVs];return!!ArrayUtils.contains(a,e)},t.prototype._onOpenAddView=function(){this._isOpened=!0},t.prototype._requestTechReset=function(){var t={};t.module=n.MsgModuleName.NATION,t.cmd=n.MsgCmd.NATION.NATION_SCI_TECH_RESET,n.ServerDelegate.sendMessage(t)},t.prototype._onGetTechReset=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.rewardResult,a=n.RewardManager.parseRewardResult(i);n.GlobalFunction.showRewards(a),n.EventUtil.dispatchEvent(n.EventNameEnum.ON_NATION_TECH_RESET)}},t.prototype.isOutNationAndFirstLogin=function(){return!this.isJoinNation()&&(!!n.LoginManager.isFirstLoginToday()&&!this._isOpened)},t.prototype.isDonationRedPoint=function(){if(!this.isJoinNation())return!1;var t=this.getNationInfo();if(0===t.getDonateState())return!0;for(var e=t.getDonateProgress(),i=n.GetConfig("NATION_DONATE_PROGRESS_REWARD"),a=t.getDonateReceiveList(),r=0;r<i.length;r++)if(e>=i[r][0]&&-1===a.indexOf(i[r][0]))return!0;return!1},t.prototype.nationDoanteEvents=function(){return[n.EventNameEnum.Res_NATION_Donate,n.EventNameEnum.Res_NATION_GET_ACTOR]},t.prototype.isNationTechRedPoint=function(){return!1},t.prototype.isNationTechRedPointByType=function(t){return!1},t.prototype.nationTechEvents=function(){return[n.EventNameEnum.Res_NATION_Donate,n.EventNameEnum.Res_NATION_GET_ACTOR]},t.prototype.isNationApplyListTips=function(){if(!this.isJoinNation()||!this._nationInfo)return!1;if(this._nationInfo.getSelfMemberType()>a.NationMemberType.EARL)return!1;var t=this._nationInfo.getApplyList();return!!t&&t.length>0},t.prototype.nationApplyListEvents=function(){return[n.EventNameEnum.NATION_GET_INFO_UPDATED,n.EventNameEnum.Res_Approve_join_Nation]},t.prototype.isNationShopRedPointTips=function(){return!!this.isJoinNation()&&o.default.getInstance().isShopTipsByType(s.StoreType.NATION)},t.prototype.getNationTechAttrByFeature=function(t){var e={};if(this._nationInfo){var i=this._nationInfo.getSciTechModelList();for(var n in i){var a=i[n];if(a.getPersonTechLevel()>0&&a.getFeatures()===t){var r=a.getAttributeValue();for(var o in r.forEach(function(t){e[t[0]]?e[t[0]]+=t[1]:e[t[0]]=t[1]}),r);}}}return e},t.prototype.getNationTechAttrTTByFeature=function(t){return{}},t.prototype.getSciTechDataByFeatures=function(t){var e=[],i=this._nationInfo.getSciTechModelList();for(var n in i)i[n].getFeatures()===t&&e.push(i[n]);return e},t.prototype.getSciTechModelList=function(){return this._nationInfo.getSciTechModelList()},t.prototype.getMaxKickoffNum=function(){return this.MAX_KICKOFF||(this.MAX_KICKOFF=n.GetConfig("NATION_KICK_OFF_LIMIT")||5),this.MAX_KICKOFF},t}();i.default=d,cc._RF.pop()},{"../../Shop/Manager/ShopEnum":"ShopEnum","../../Shop/Manager/ShopManager":"ShopManager","../Enum/NationEnum":"NationEnum","./NationDuelManager":"NationDuelManager",NationBaseInfo:"NationBaseInfo",NationInfoModel:"NationInfoModel",NationRankInfo:"NationRankInfo"}],NationManagerHandler:[function(t,e,i){"use strict";cc._RF.push(e,"b42047qQ6hKIb4y/JEGtwY8","NationManagerHandler");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,window.td),s=t("./NationMainManager"),l=t("./NationBossManager"),c=t("./NationCityWarManager"),u=t("../../Shop/Manager/ShopManager"),d=t("./GodFurnaceManager"),h=t("./ScuffleYamaManager"),p=function(){function t(){this._isLoadSubInfo=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addEventListener(),this.initMationManager()},t.prototype.initMationManager=function(){s.default.getInstance().init(),l.default.getInstance().init(),c.default.getInstance().init()},t.prototype.destroyData=function(){this._isLoadSubInfo=!1,s.default.getInstance().destroyData(),l.default.getInstance().destroyData(),c.default.getInstance().destroyData()},t.prototype.addEventListener=function(){var t=o.EventNameEnum,e={};e[t.CLEAR_NATION_DATA]=this.destroyData,e[t.NATION_GET_INFO_UPDATED]=this._onLoadNationInfoComplete,o.EventUtil.registerEvents(e,this)},t.prototype._onLoadNationInfoComplete=function(){this._isLoadSubInfo||(o.EventUtil.dispatchEvent(o.EventNameEnum.REQUEST_GET_SIEGE_INFO),o.EventUtil.dispatchEvent(o.EventNameEnum.REQUEST_GET_SIEGE_ACTOR),o.EventUtil.dispatchEvent(o.EventNameEnum.REQUEST_NATION_ALTAR_INFO),o.EventUtil.dispatchEvent(o.EventNameEnum.REQUEST_NATION_BOSS_INFO),this._isLoadSubInfo=!0)},t.prototype.isNationTips=function(){return!!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.Army,0,!1)&&(s.default.getInstance().isOutNationAndFirstLogin()||s.default.getInstance().isDonationRedPoint()||s.default.getInstance().isNationTechRedPoint()||s.default.getInstance().isNationApplyListTips()||s.default.getInstance().isNationShopRedPointTips()||l.default.getInstance().isNationBossRedPointTips()||c.default.getInstance().isNationWarTips()||d.default.getInstance().isRedTips()||h.default.getInstance().scuffleYamaRedPointTip())},t.prototype.nationEvents=function(){return[o.EventNameEnum.OPEN_NATION_ADD_VIEW].concat(s.default.getInstance().nationDoanteEvents(),s.default.getInstance().nationTechEvents(),s.default.getInstance().nationApplyListEvents(),l.default.getInstance().nationBossRedPointEvents(),c.default.getInstance().nationWarTipsEvents(),u.default.getInstance().shopTipsEvents(),d.default.getInstance().redTipsEvent(),h.default.getInstance().scuffleYamaRedPointEvents())},t=e=n([r],t)}();i.default=p,cc._RF.pop()},{"../../Shop/Manager/ShopManager":"ShopManager","./GodFurnaceManager":"GodFurnaceManager","./NationBossManager":"NationBossManager","./NationCityWarManager":"NationCityWarManager","./NationMainManager":"NationMainManager","./ScuffleYamaManager":"ScuffleYamaManager"}],NationMemberInfo:[function(t,e,i){"use strict";cc._RF.push(e,"a38c9aoNEVDP4p6fA3f3HgH","NationMemberInfo");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=t("BaseUser"),r=(window.td,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._memberType=0,e._buildTotalScore=0,e._buildScore=0,e}return n(e,t),e.prototype.init=function(e){t.prototype.init.call(this,"NationMemberInfo",e.attributes),this._memberType=parseInt(e.memberType),this._buildTotalScore=e.buildTotalScore||this._buildTotalScore,this._buildScore=e.buildScore||this._buildScore},e.prototype.updateAttr=function(t){this._memberType=parseInt(t.memberType)},e.prototype.getMemberType=function(){return this._memberType},e.prototype.getBuildTotalScore=function(){return this._buildTotalScore},e.prototype.getBuildScore=function(){return this._buildScore},e}(a));e.exports=r,cc._RF.pop()},{BaseUser:"BaseUser"}],NationRankInfo:[function(t,e,i){"use strict";cc._RF.push(e,"f3a08AJoAVCFrWPI07zYVbq","NationRankInfo");window.td;var n=t("NationSimpleInfo"),a=function(){function t(){this._rank=0,this._level=0,this._power=0,this._kingName="",this._type=0,this._bossScore=0}return t.prototype.init=function(t){this._nationSimpleInfo=new n,this._nationSimpleInfo.init(t.simpleVO),void 0!==t.rank&&(this._rank=t.rank),void 0!==t.power&&(this._power=t.power),void 0!==t.score&&(this._bossScore=t.score)},t.prototype.setType=function(t){this._type=t},t.prototype.getType=function(){return this._type},t.prototype.getRank=function(){return this._rank},t.prototype.getPower=function(){return this._power},t.prototype.getNationBossScore=function(){return this._bossScore},t.prototype.getNationSimpleInfo=function(){return this._nationSimpleInfo},t.prototype.getName=function(){return this._nationSimpleInfo.getName()},t.prototype.getLevel=function(){return this._nationSimpleInfo.getLevel()},t.prototype.getKingName=function(){return this._nationSimpleInfo.getKingName()},t.prototype.getMemberCount=function(){return this._nationSimpleInfo.getMemberCount()},t.prototype.getMaxMember=function(){return this._nationSimpleInfo.getMaxMember()},t}();e.exports=a,cc._RF.pop()},{NationSimpleInfo:"NationSimpleInfo"}],NationRecordTable:[function(t,e,i){"use strict";cc._RF.push(e,"de15czt8lhBmLvI+5yzj7Ga","NationRecordTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationRecordTable",e._tblName="nation_record_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.type]=a}},e.prototype.getDataByType=function(t){return this._data&&this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationRecord:[function(t,e,i){"use strict";cc._RF.push(e,"1e312a/FXBPXby24PhFxsjV","NationRecord"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("BaseUser"),r=t("../Manager/NationMainManager"),o=t("../Enum/NationEnum"),s=function(){function t(){this._recordType=0,this._msg="",this._newMsg="",this._time=0,this._timeTag="",this._memberType=0}return t.prototype.init=function(t){this._recordType=parseInt(t.recordType),this._king=new a,this._king.init("kingInfo",t.king),this._targeter=new a,this._targeter.init("targetInfo",t.targeter),this._time=t.time,this._memberType=t.memberType,this._parasMsg()},t.prototype._parasMsg=function(){var t=r.default.getInstance().getNationInfo();if(t){var e=t.getMyNationBaseInfo();if(e){var i=e.getNationSimpleInfo(),a=n.GetTableClass(n.TableEnum.NationRecordTable).getDataByType(this._recordType);switch(this._recordType){case o.NationRecordType.JOIN:this._msg=cc.js.formatStr(a.des,this._targeter.getServerNickName(),i.getName()),this._newMsg=cc.js.formatStr(a.des2,this._targeter.getServerNickName(),i.getName());break;case o.NationRecordType.APPOINT_OFFICER:var s=t.getMemberTypeName(this._memberType);this._msg=cc.js.formatStr(a.des,this._king.getServerNickName(),this._targeter.getServerNickName(),s),this._newMsg=cc.js.formatStr(a.des2,this._king.getServerNickName(),this._targeter.getServerNickName(),s);break;case o.NationRecordType.APPOINT_MEMBER:case o.NationRecordType.KING_REPLACE:this._msg=cc.js.formatStr(a.des,this._targeter.getServerNickName()),this._newMsg=cc.js.formatStr(a.des2,this._targeter.getServerNickName());break;case o.NationRecordType.Donate_VIP:case o.NationRecordType.Donate_Diamond:case o.NationRecordType.Donate_Gold:this._msg=cc.js.formatStr(a.des,this._targeter.getServerNickName()),this._newMsg=cc.js.formatStr(a.des2,this._targeter.getServerNickName())}var l=n.TimeUtil.getTime()-this._time;this._timeTag=l<=36e5?n.Language.justNow:l<=864e5?n.Language.beforeOneHour:n.Language.beoreOneDay}}},t.prototype.getKingBaseUser=function(){return this._king},t.prototype.getTargeterBaseUser=function(){return this._targeter},t.prototype.getMsg=function(){return this._newMsg},t.prototype.getChatMsg=function(){return this._msg},t.prototype.getTimeTag=function(){return this._timeTag},t.prototype.getTime=function(){return this._time},t.prototype.isNationRecord=function(){return!0},t}();e.exports=s,cc._RF.pop()},{"../Enum/NationEnum":"NationEnum","../Manager/NationMainManager":"NationMainManager",BaseUser:"BaseUser"}],NationSciTechLevelConfig:[function(t,e,i){"use strict";cc._RF.push(e,"97a2cAi4YRCVZzwgfrPxhLs","NationSciTechLevelConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationSciTechLevelConfig",e._tblName="nation_sci_tech_level_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.id,o=t[r]||{};o[a.level]=a,t[r]=o}},e.prototype.getDataByIdAndLevel=function(t,e){return this._data[t][e]},e.prototype.getMaxLvbyIdAndNationLv=function(t,e){var i=0;if(this._data[t]){var n=this._data[t];for(var a in n)n[a].nationLevelLimit<=e&&n[a].level>i&&(i=n[a].level)}return i},e.prototype.getMaxLvbyId=function(t){var e=0;if(this._data[t]){var i=this._data[t];for(var n in i)i[n].id===t&&i[n].level>e&&(e=i[n].level)}return e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationSciTechTypeTable:[function(t,e,i){"use strict";cc._RF.push(e,"ebd1e/tOMFC3YycYtuhbMNw","NationSciTechTypeTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NationSciTechTypeTable",e._tblName="nation_sci_tech_type_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.id]=a}},e.prototype.getTechDataList=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NationSimpleInfo:[function(t,e,i){"use strict";cc._RF.push(e,"de3aeuz7ldG97cKW7HDllEm","NationSimpleInfo"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("BaseUser"),r=function(){function t(){this._id=0,this._name="",this._flag="",this._flagId=0,this._level=0,this._memberCount=0,this._maxMemberCount=0}return t.prototype.init=function(t){if(t){this._kingInfo||(this._kingInfo=new a),this._kingInfo.init("NationSimpleInfoKing",t.attributes),this._id=t.id||0,this._name=t.name||"",this._flag=t.flag||"",this._flagId=t.flagId||0,this._level=t.level||0,this._memberCount=t.memberCount||0;var e=n.GetTableClass(n.TableEnum.NationLevelTable).getDataByLevel(this._level);this._maxMemberCount=e?e.memberCount:0}},t.prototype.getId=function(){return this._id},t.prototype.getName=function(){return this._name},t.prototype.getFlag=function(){return this._flag},t.prototype.getFlagId=function(){return this._flagId},t.prototype.setLevel=function(t){this._level=t},t.prototype.getLevel=function(){return this._level},t.prototype.getKingName=function(){return this._kingInfo?this._kingInfo.getServerNickName():""},t.prototype.getKingServerId=function(){return this._kingInfo?this._kingInfo.serverId:""},t.prototype.getMemberCount=function(){return this._memberCount},t.prototype.getMaxMember=function(){return this._maxMemberCount},t}();i.default=r,e.exports=r,cc._RF.pop()},{BaseUser:"BaseUser"}],NationTechModel:[function(t,e,i){"use strict";cc._RF.push(e,"47b2costnlHdq4DEnLxR7CS","NationTechModel");var n=window.td,a=function(){function t(){this._id=0,this._features=0,this._icon="",this._name="",this._nationLevelLimit=0,this._personTechLevel=0}return t.prototype.init=function(t){this._id=t.id||0,this._icon=t.icon,this._features=t.features||"",this._nationLevelLimit=t.nationLeveLimit||"",this._name=t.name,this.setPersonTechLevel(0)},t.prototype.getId=function(){return this._id},t.prototype.getName=function(){return this._name},t.prototype.getIcon=function(){return this._icon},t.prototype.getFeatures=function(){return this._features},t.prototype.getNationLevelLimit=function(){return this._nationLevelLimit},t.prototype.setPersonTechLevel=function(t){this._personTechLevel=t;var e=n.GetTableClass(n.TableEnum.NationSciTechLevelConfig).getDataByIdAndLevel(this._id,t);e?(this._nationLevelLimit=e.nationLevelLimit,this._attributeValue=e.attributeValue,this._upgradeCost=e.upgradeCost):(this._nationLevelLimit=0,this._attributeValue=[],this._upgradeCost=[])},t.prototype.getPersonTechLevel=function(){return this._personTechLevel},t.prototype.getAttributeValue=function(){return this._attributeValue},t.prototype.getNextAttributeValue=function(){var t=n.GetTableClass(n.TableEnum.NationSciTechLevelConfig).getDataByIdAndLevel(this._id,this._personTechLevel+1);return t?t.attributeValue:null},t.prototype.getUpgradeCost=function(){return this._upgradeCost},t.prototype.getMaxUpLvByNationLv=function(t){return n.GetTableClass(n.TableEnum.NationSciTechLevelConfig).getMaxLvbyIdAndNationLv(this._id,t)},t.prototype.getMaxLv=function(){return n.GetTableClass(n.TableEnum.NationSciTechLevelConfig).getMaxLvbyId(this._id)},t}();e.exports=a,cc._RF.pop()},{}],NationWarAttackerModel:[function(t,e,i){"use strict";cc._RF.push(e,"07ca6AQRSdCgKAmE1+JzXE7","NationWarAttackerModel");window.td;var n=t("NationSimpleInfo"),a=function(){function t(){}return t.prototype.init=function(t){this.updateServerData(t),this._attackCities=[]},t.prototype.updateServerData=function(t){this._nationInfo||(this._nationInfo=new n),this._nationInfo.init(t)},t.prototype.getNationInfo=function(){return this._nationInfo},t.prototype.getNationId=function(){return this._nationInfo.getId()},t.prototype.getFlagId=function(){return this._nationInfo.getFlagId()},t.prototype.setAttackCities=function(t){var e=t.getId();ArrayUtils.contains(this._attackCities,e)||(this._attackCities[this._attackCities.length]=e)},t.prototype.removeAttackCities=function(t){if(this._attackCities&&0!==this._attackCities.length)for(var e=0,i=this._attackCities.length;e<i;e++){if(this._attackCities[e]===t.getId()){this._attackCities.splice(e,1);break}}},t.prototype.getAttackCities=function(){return this._attackCities},t}();e.exports=a,cc._RF.pop()},{NationSimpleInfo:"NationSimpleInfo"}],NetErrorTips:[function(t,e,i){"use strict";cc._RF.push(e,"f9ddbTlG1FETa05umcpSweB","NetErrorTips");var n=t("BaseTable"),a=cc.Class({extends:n,name:"NetErrorTips",properties:{_tblName:"error_data",_deleteJson:{default:!1,override:!0}},getNetErrorTips:function(t){return this._jsonData[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NewAreaPowerRankController:[function(t,e,i){"use strict";cc._RF.push(e,"79d685807pCmqkYKIMuW8Ja","NewAreaPowerRankController");var n=t("ActivityBaseController"),a=t("NewAreaPowerRankModel"),r=t("ActorRankModel"),o=cc.Class({extends:n,properties:{_myRank:null,_modelList:null},initData:function(t){this._super(t),this._modelList=[],this._myRank=0},destroyData:function(){this._modelList=[],this._myRank=0},getDataList:function(){return this._modelList},getMyRank:function(){return this._myRank},activityParse:function(t){var e=t.global,i=e.entityList;if(parseInt(e.type)===this._activityType){var n=this.getActivityData();this._modelList=[];var o=td.GetTableClass(td.TableEnum.NewAreaPowerRankRewardTable).getDatasOfDataId(n);if(o)for(var s=0,l=o.length;s<l;s++){var c=o[s],u=new a;u.initData(c);for(var d=u.getRank(),h=0,p=i.length;h<p;h++){var _=i[h],g=(_.attributes,_.rank);if(0!==h){if(d===g){var f=new r;f.init(_),u.setRankPlayerInfo(f);break}}else this._myRank=g}this._modelList.push(u)}}}});e.exports=o,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",ActorRankModel:"ActorRankModel",NewAreaPowerRankModel:"NewAreaPowerRankModel"}],NewAreaPowerRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"92a04PDAABHQK8pXfyWVov9","NewAreaPowerRankModel");var n=cc.Class({extends:cc.Component,properties:{_dataId:null,_rank:null,_rewardList:null,_playerRankInfo:null},initData:function(t){t&&(this._dataId=t.data,this._rank=t.rank,this._rewardList=td.RewardManager.parseRewardListDetail(t.reward),this._playerAttr=null)},getDataId:function(){return this._dataId},getRank:function(){return this._rank},getRewardList:function(){return this._rewardList},setRankPlayerInfo:function(t){this._playerRankInfo=t},getRankPlayerInfo:function(){return this._playerRankInfo}});e.exports=n,cc._RF.pop()},{}],NewAreaPowerRankPanel:[function(t,e,i){"use strict";cc._RF.push(e,"8e38fymGbhJ9p0Jf4O13Q25","NewAreaPowerRankPanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{_listViewLogic:null,labEndTime:cc.Label,labLeftTime:cc.Label,labMyRank:cc.Label,labMyPower:cc.Label},initData:function(t){this._super(t)},onLoad:function(){var t=cc.find("infoPanel/scrollView",this.node);this._listViewLogic=t.getComponent("PowerRankListView")},_addEventListener:function(){var t={};t[td.EventNameEnum.Res_GET_ACTIVITY_INFO]=this._resInfo,td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},onEnable:function(){this._super(),this.setView(),this._controller.setInfoOutOfDate(!0,this._activityId)},onDisable:function(){this._super(),this.unschedule(this._updateLeftTime)},_resInfo:function(t){t===this.getActivityId()&&this.setView()},setView:function(){this._refreshView(),this._setMyRankInfo();var t=this.isActivityOver();t||this._setActivityTime(),this._setActivityTipStatus(t)},_refreshView:function(){this._listViewLogic.removeAllItems();var t=this._controller.getDataList();t.sort(function(t,e){return t.getRank()-e.getRank()});var e={dataList:t};this._listViewLogic.setData(e)},_setActivityTipStatus:function(t){var e=this.node.getChildByName("titleWidget");e.getChildByName("labEndTimeT").active=!t,e.getChildByName("labEndTime").active=!t,e.getChildByName("labLeftTimeT").active=!t,e.getChildByName("labLeftTime").active=!t,e.getChildByName("labShowTimeTip").active=t},_setActivityTime:function(){var t=this.getEndTimeStr();this.labEndTime.string=t,this.schedule(this._updateLeftTime,1)},getEndTimeStr:function(){var t=this._controller.getCurrentOpenStage();if(t&&this.checkIsOpen(!0)){var e=t.showTime,i=new Date(e),n=td.Language.timePattern5;return i.pattern(n)}},_updateLeftTime:function(t){var e=this.isActivityOver();if(e)return this._setActivityTipStatus(e),void this.unschedule(this._updateLeftTime);var i=this.getActivityLeftTimeStr();this.labLeftTime.string=i||""},_setMyRankInfo:function(){var t=this._controller.getMyRank(),e=t>0&&t<=10?t:td.Language.notInRank;this.labMyRank.string=e;var i=td.Account.getUserData().getFightPower();this.labMyPower.string=i}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],NewAreaPowerRankRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"1392coQeoZAxK2fpjFA86iC","NewAreaPowerRankRewardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"NewAreaPowerRankRewardTable",properties:{_tblName:"power_rank_reward_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e],a=n.data;this._datas[a]=this._datas[a]||[],this._datas[a].push(n)}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e.sort(function(t,e){return t.rank-e.rank}),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NewGachaActivityHome:[function(t,e,i){"use strict";cc._RF.push(e,"ab597hRkAZG56jKt1pfVkdP","NewGachaActivityHome");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./GodEquipRewardItemUI"),o=t("../../../Gacha/Manager/GachaManager"),s=window.td,l=cc._decorator,c=l.ccclass,u=l.property,d=l.menu,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labActivityTime=null,e.labTickets=null,e.imgFloor=null,e.btnTickets=null,e.nodePreview=null,e.nodeRewards=null,e.nodeRewardModel=null,e.labNeedStar=null,e.labStarProgress=null,e.nodeNormal=null,e.nodeOnce=null,e.nodeTen=null,e.nodeRecords=null,e.labDesNode=null,e._rewardsPosList=[cc.v2(-251,-18),cc.v2(-92,-11),cc.v2(92,-11),cc.v2(251,-18)],e._activityCotr=null,e._originPreviewPos1=null,e._originPreviewPos2=null,e._originRecordPos1=null,e._originRecordPos2=null,e._isDoingAction=!1,e._isDoingItemAction=!1,e._progressStrModel="<color=#00FF24><outline color=#3F1106 width=2>(<color=%s>%s</color>/%s)</outline></color>",e}return n(e,t),e.prototype.init=function(){this._panelType=s.PanelType.Panel,this._panelEnum=s.PanelEnum.Panel_GodEquipGacha},e.prototype.onEnable=function(){(t.prototype.onEnable.call(this),this._activityCotr=s.ActivityDataManager.getActivityControllerByType(s.ActivityEnum.ActivityType.GodEquipGacha),this._addEventListener(),this._activityCotr)&&(this._activityCotr.isFromRecharge()&&this.onBtnGetClick(),this._activityCotr.onOpenPanel(),o.default.getInstance().setCurGachaId(0),o.default.getInstance().setIsActivityGacha(!1),o.default.getInstance().showBigRewards(),s.RedPointUtil.createRedPointOld(this.btnTickets,cc.v2(-30,-15),this._activityCotr.isHaveTicketsToReceive.bind(this._activityCotr),this._activityCotr.redPointEvts()),this._refreshUI(),0===this._activityCotr.getShowLuckyMsgList().length&&s.EventUtil.dispatchEvent(s.EventNameEnum.REQ_NEW_GACHA_EQUIP_LUCKY_MSG))},e.prototype.onDisable=function(){s.EventUtil.unregisterAllEvents(this),this._isDoingAction=!1,this._isDoingItemAction=!1,t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=s.EventNameEnum;t[e.RES_GACHA]=this._onReward,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this._refreshUI,t[e.RES_GACHA_ACTIVITY_LUCKY_MSG]=this._onReceiveLuckyMsg,s.EventUtil.registerEvents(t,this)},e.prototype._refreshUI=function(){this._initActivityTime(),s.TaskListManager.pushTask(this._panelEnum,null,this._refreshBtns.bind(this)),s.TaskListManager.pushTask(this._panelEnum,null,this._refreshRewards.bind(this)),s.TaskListManager.pushTask(this._panelEnum,null,this._refreshPreview.bind(this)),s.TaskListManager.pushTask(this._panelEnum,null,this._onReceiveLuckyMsg.bind(this))},e.prototype._initActivityTime=function(){var t=this,e=this._controller.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=e.closeTime-s.TimeUtil.getTime();i>0?s.GlobalFunction.addTimeLabel2(this.labActivityTime.node,i,function(){t.labActivityTime.string=s.Language.ActivityOver},s.Language.timeCountPattern3):this.labActivityTime.string=s.Language.ActivityOver}},e.prototype._refreshRewards=function(){for(var t=this._activityCotr.getCurBigRewards(),e=0;e<t.length;e++){var i=t[e],n=this.nodeRewards.getChildByName("nodeReward"+e);null==n&&((n=cc.instantiate(this.nodeRewardModel)).active=!0,n.name="nodeReward"+e,n.parent=this.nodeRewards);var a=n.getChildByName("HD_szzh_djbq"),o=n.getComponent(r.default),l=e;a.y=18,a.x=-24,1==e?l=3:2==e?(l=1,a.y=30,a.x=-36):3==e&&(l=2,a.y=30,a.x=-36),o.setData(l,i);var c=this._rewardsPosList[l];n.position=c}var u=this._activityCotr.getNextBigReward();this.labNeedStar.string=u[0];var d="#00ff24";d=this._activityCotr.getCurScore()>=u[0]?"#00ff24":"#ff0024";var h=cc.js.formatStr(this._progressStrModel,d,this._activityCotr.getCurScore(),u[0]);this.labStarProgress.string=h,this.labTickets.string=this._activityCotr.getCurrencyNum();var p=this._activityCotr.getCurFloor();s.GlobalFunction.createAltasSprite(s.resDef.pngPlist.NewGodEquip,"HD_szzh_zi_0"+p,this.imgFloor),this.labDesNode.active=p<3},e.prototype._refreshBtns=function(){var t=this._activityCotr.getCurFloor(),e=t>=2?10:1,i=t>=2?100:10;this._setBtnInfo(this.nodeNormal,{gachaId:t>=2?this._activityCotr.getCurHighGachaId():this._activityCotr.getCurNormalGachaId(),count:1,isNormal:!0}),this._setBtnInfo(this.nodeOnce,{gachaId:this._activityCotr.getCurHighGachaId(),count:e,isNormal:!1}),this._setBtnInfo(this.nodeTen,{gachaId:this._activityCotr.getCurHighGachaId(),count:i,isNormal:!1})},e.prototype._setBtnInfo=function(t,e){if(null!=t&&null!=e){var i=t.getChildByName("labStarNum").getComponent(cc.Label),n=t.getChildByName("imgCost"),a=t.getChildByName("labCost").getComponent(cc.Label),r=o.default.getInstance().getGachaListById(e.gachaId);if(r){var l=r.getTimes(),c=this._activityCotr.getGachaLimitTime(e.gachaId),u=r.getCost()||1,d=1==this._activityCotr.getCurFloor()&&e.isNormal;e.isNormal&&d&&s.GlobalFunction.setButtonGray(t.getChildByName("btn"),l>=c);var h=this._activityCotr.getGachaStars(e.gachaId);u*=e.count,h*=e.count,i.string=h+"",a.string=u+"";var p=t.getChildByName("btn").getChildByName("labLimit");if(p)p.active=d,p.getComponent(cc.Label).string="("+(c-l)+"/"+c+")";s.GlobalFunction.createAltasSprite(s.resDef.pngPlist.icon_item,d?"icon_t_zhuanshi":"icon_szzhq_x",n);var _=t.getChildByName("btn").getChildByName("Label");if(_)_.y=d?14:3,_.getComponent(cc.Label).string=d?cc.js.formatStr(s.Language.NormalSummonTip,e.count):cc.js.formatStr(s.Language.AdvanceSummonTip,e.count)}}},e.prototype._refreshPreview=function(){this._doPreviewAni()},e.prototype._doPreviewAni=function(){var t=this;if(!this._isDoingItemAction)for(var e=this._activityCotr.getCurPreviewRewards(),i=s.RewardManager.parseRewardListDetail(e),n=i.length,a=0,r=0,o=n>=6,l=function(e,s,c){if(s){if(o){if(e.active=!0,c)e.getComponent("CommonIconWidget").setData(s);e.runAction(cc.sequence(cc.moveBy(1.5,cc.v2(-(e.width/2+3),0)),cc.callFunc(function(){var t=!1;e.x<=-e.width/2&&(e.x=a+e.width/2,s=i[r],++r>=n&&(r=0),t=!0),l(e,s,t)}))),t._isDoingItemAction=!0}}else e.active=!1},c=0;c<6;c++)if(!(n<=c)){var u=this.nodePreview.getChildByName("preview"+c),d=i[r];u||((u=s.GlobalFunction.createCommonIconWidget(58,d)).name="preview"+c,u.parent=this.nodePreview),u.stopAllActions(),u.x=a+u.width/2,5!==c&&(a+=u.width+3),++r>=n&&(r=0),l(u,d,!0)}},e.prototype._onReward=function(t){s.PanelJumpManager.jumpToPanel(s.PanelEnum.Panel_GachaReward,t)},e.prototype._onReceiveLuckyMsg=function(t){var e=this;if(null==t&&(t=this._activityType),t===this._activityType&&!this._isDoingAction)for(var i=this._activityCotr.getShowLuckyMsgList(),n=i.length,a=n>=3,r=this.nodeRecords.children,o=-3,s=0,l=function(t,r,c){r?(t.active=!0,c&&e._setRichText(t,r),a&&(t.runAction(cc.sequence(cc.moveBy(1.5,cc.v2(0,t.height+3)),cc.callFunc(function(){var e=!1;t.y>0&&(t.y=o-t.height/2,r=i[s],++s>=n&&(s=0),e=!0),l(t,r,e)}))),e._isDoingAction=!0)):t.active=!1},c=0,u=r.length;c<u;c++)if(!(n<=c)){var d=r[c];d.stopAllActions(),d.y=o-d.height/2,c!==u-1&&(o-=d.height+3);var h=i[s];++s>=n&&(s=0),l(d,h,!0)}},e.prototype._setRichText=function(t,e){var i=t.getComponent(s.UFRichText),n=e.msg,a={fontSize:22,quality:e.quality};i.init(n,a),i.setLeftCenter()},e.prototype.onBtnRewardsCliCK=function(){s.PanelJumpManager.jumpToPanel(s.PanelEnum.Window_GodEquipRewardsWindow)},e.prototype.onBtnGetClick=function(){s.PanelJumpManager.jumpToPanel(s.PanelEnum.Window_TicketsWindow)},e.prototype.onBtnNormalClick=function(){var t=this._activityCotr.getCurFloor(),e=t>=2?this._activityCotr.getCurHighGachaId():this._activityCotr.getCurNormalGachaId();o.default.getInstance().setCurGachaId(e),o.default.getInstance().setIsActivityGacha(!0);var i=o.default.getInstance().getGachaListById(e);if(i){var n=i.getCost(),a=s.Account.getUserData().getDiamond(),r=this._controller.getCurrencyNum(),l={};if(l.id=e,l.times=1,a>=n&&t<2||r>=1&&t>=2){l.useGoods=t>=2;var c=this._controller.getGachaType();o.default.getInstance().setType(c),s.EventUtil.dispatchEvent(s.EventNameEnum.REQ_GACHA,l)}else if(t>=2){var u=new s.BroadcastContent(31);s.EventUtil.dispatchEvent(s.EventNameEnum.SHOW_BROADCAST,u),this.onBtnGetClick()}else{var d={};d.strArray=[s.Language.diamondlack],d.okCallFunc=s.GlobalFunction.gotoRecharge.bind(s.GlobalFunction),d.strBtnYes=s.Language.goto,d.strBtnNo=s.Language.cancel,s.GlobalFunction.showConfirmWindow(d)}}},e.prototype.onBtnOnce=function(){var t=this._activityCotr.getCurHighGachaId();o.default.getInstance().setCurGachaId(t),o.default.getInstance().setIsActivityGacha(!0);var e=o.default.getInstance().getGachaListById(t);if(e){var i=e.getCost(),n=this._activityCotr.getCurFloor()>=2?10:1,a=this._activityCotr.getCurScoreData(),r=this._activityCotr.getGachaStars(t),l=this._activityCotr.getCurScore(),c=a.scheduleReward[a.scheduleReward.length-1][0],u=Math.ceil((c-l)/r);u>0&&u<n&&(n=u);var d={};if(d.id=t,d.times=n,this._controller.getCurrencyNum()>=n){d.useGoods=!0;var h=this._controller.getGachaType();o.default.getInstance().setType(h),s.EventUtil.dispatchEvent(s.EventNameEnum.REQ_GACHA,d)}else if(0===i){var p=new s.BroadcastContent(31);s.EventUtil.dispatchEvent(s.EventNameEnum.SHOW_BROADCAST,p),this.onBtnGetClick()}else{var _={};_.strArray=[s.Language.diamondlack],_.okCallFunc=s.GlobalFunction.gotoRecharge.bind(s.GlobalFunction),_.strBtnYes=s.Language.goto,_.strBtnNo=s.Language.cancel,s.GlobalFunction.showConfirmWindow(_)}}},e.prototype.onBtnTen=function(){var t=this._activityCotr.getCurHighGachaId();o.default.getInstance().setCurGachaId(t),o.default.getInstance().setIsActivityGacha(!0);var e=o.default.getInstance().getGachaListById(t);if(e){var i=this._activityCotr.getCurFloor()>=2?100:10,n=this._activityCotr.getCurScoreData(),a=this._activityCotr.getGachaStars(t),r=this._activityCotr.getCurScore(),l=n.scheduleReward[n.scheduleReward.length-1][0],c=Math.ceil((l-r)/a);c>0&&c<i&&(i=c);var u={};u.id=t,u.times=i;var d=this._controller.getCurrencyNum(),h=e.getCost();if(d>=i){u.useGoods=!0;var p=this._controller.getGachaType();o.default.getInstance().setType(p),s.EventUtil.dispatchEvent(s.EventNameEnum.REQ_GACHA,u)}else if(0===h){var _=new s.BroadcastContent(31);s.EventUtil.dispatchEvent(s.EventNameEnum.SHOW_BROADCAST,_),this.onBtnGetClick()}else{var g={};g.strArray=[s.Language.diamondlack],g.okCallFunc=s.GlobalFunction.gotoRecharge.bind(s.GlobalFunction),g.strBtnYes=s.Language.goto,g.strBtnNo=s.Language.cancel,s.GlobalFunction.showConfirmWindow(g)}}},a([u(cc.Label)],e.prototype,"labActivityTime",void 0),a([u(cc.Label)],e.prototype,"labTickets",void 0),a([u(cc.Node)],e.prototype,"imgFloor",void 0),a([u(cc.Node)],e.prototype,"btnTickets",void 0),a([u(cc.Node)],e.prototype,"nodePreview",void 0),a([u(cc.Node)],e.prototype,"nodeRewards",void 0),a([u(cc.Node)],e.prototype,"nodeRewardModel",void 0),a([u(cc.Label)],e.prototype,"labNeedStar",void 0),a([u(cc.RichText)],e.prototype,"labStarProgress",void 0),a([u(cc.Node)],e.prototype,"nodeNormal",void 0),a([u(cc.Node)],e.prototype,"nodeOnce",void 0),a([u(cc.Node)],e.prototype,"nodeTen",void 0),a([u(cc.Node)],e.prototype,"nodeRecords",void 0),a([u(cc.Node)],e.prototype,"labDesNode",void 0),e=a([c,d("module/Activity/NewGachaActivityHome")],e)}(t("ActivityBasePanel"));i.default=h,cc._RF.pop()},{"../../../Gacha/Manager/GachaManager":"GachaManager","./GodEquipRewardItemUI":"GodEquipRewardItemUI",ActivityBasePanel:"ActivityBasePanel"}],NewGachaTable:[function(t,e,i){"use strict";cc._RF.push(e,"f0a18Xl2dpBwavtknyfKxvU","NewGachaTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="NewGachaTable",e._tblName="activity_new_gacha_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getAllRewardDatas=function(t){var e=this._data[t],i=[];if(e)for(var n=0;n<e.length;n++){var a=e[n];i.push(a.scheduleReward)}return i},e.prototype.getDataByScore=function(t,e){var i=this._data[t],n=null;if(i){i.sort(function(t,e){return t.score-e.score});for(var a=0;a<i.length;a++){var r=i[a];e>=r.score&&(n=r)}}return n},e.prototype.getFloorByScore=function(t,e){var i=this._data[t],n=1;if(i){i.sort(function(t,e){return t.score-e.score});for(var a=0;a<i.length;a++){e>=i[a].score&&(n=a+1)}}return n},e.prototype.getRewardPreview=function(t,e){var i=this._data[t];if(i){i.sort(function(t,e){return t.score-e.score});for(var n=0;n<i.length;n++){var a=i[n];if(e<=a.score)return a.rewardPreview}return i[i.length-1].rewardPreview}},e.prototype.getBigRewards=function(t,e){},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],NewServerCarnivalController1:[function(t,e,i){"use strict";cc._RF.push(e,"ef5c3bBTlRMra/HrVqKV1Hg","NewServerCarnivalController1");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=t("NewServerCarnivalController"),o=cc._decorator,s=o.ccclass,l=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e=a([s],e)}(r));i.default=l,e.exports=l,cc._RF.pop()},{NewServerCarnivalController:"NewServerCarnivalController"}],NewServerCarnivalController2:[function(t,e,i){"use strict";cc._RF.push(e,"5f41bAKvHNIIZsavevJvKE2","NewServerCarnivalController2");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=t("NewServerCarnivalController"),o=cc._decorator,s=o.ccclass,l=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e=a([s],e)}(r));i.default=l,e.exports=l,cc._RF.pop()},{NewServerCarnivalController:"NewServerCarnivalController"}],NewServerCarnivalController3:[function(t,e,i){"use strict";cc._RF.push(e,"5095fxr3udK+b4gpCDTA3VP","NewServerCarnivalController3");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=t("NewServerCarnivalController"),o=cc._decorator,s=o.ccclass,l=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e=a([s],e)}(r));i.default=l,e.exports=l,cc._RF.pop()},{NewServerCarnivalController:"NewServerCarnivalController"}],NewServerCarnivalController4:[function(t,e,i){"use strict";cc._RF.push(e,"49d38DdX25IFrE2b7pHJbJb","NewServerCarnivalController4");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=t("NewServerCarnivalController"),o=cc._decorator,s=o.ccclass,l=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e=a([s],e)}(r));i.default=l,e.exports=l,cc._RF.pop()},{NewServerCarnivalController:"NewServerCarnivalController"}],NewServerCarnivalController5:[function(t,e,i){"use strict";cc._RF.push(e,"f36b5P6sYZNm4q+rRh/QcSu","NewServerCarnivalController5");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=t("NewServerCarnivalController"),o=cc._decorator,s=o.ccclass,l=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e=a([s],e)}(r));i.default=l,e.exports=l,cc._RF.pop()},{NewServerCarnivalController:"NewServerCarnivalController"}],NewServerCarnivalController6:[function(t,e,i){"use strict";cc._RF.push(e,"b3782NWXx9Fy61ig+nSmkJq","NewServerCarnivalController6");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=t("NewServerCarnivalController"),o=cc._decorator,s=o.ccclass,l=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e=a([s],e)}(r));i.default=l,e.exports=l,cc._RF.pop()},{NewServerCarnivalController:"NewServerCarnivalController"}],NewServerCarnivalController7:[function(t,e,i){"use strict";cc._RF.push(e,"ca582VB5MlC6qzZORdFFu1Q","NewServerCarnivalController7");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=t("NewServerCarnivalController"),o=cc._decorator,s=o.ccclass,l=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e=a([s],e)}(r));i.default=l,e.exports=l,cc._RF.pop()},{NewServerCarnivalController:"NewServerCarnivalController"}],NewServerCarnivalController8:[function(t,e,i){"use strict";cc._RF.push(e,"9b95daXd8RMyrfLyTgasRlS","NewServerCarnivalController8");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=t("NewServerCarnivalController"),o=cc._decorator,s=o.ccclass,l=(o.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e=a([s],e)}(r));i.default=l,e.exports=l,cc._RF.pop()},{NewServerCarnivalController:"NewServerCarnivalController"}],NewServerCarnivalController:[function(t,e,i){"use strict";cc._RF.push(e,"4beffb6VkBFTpPVGtvnySyk","NewServerCarnivalController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ActivityBaseController"),s=t("CarnivalTypeModel"),l=t("CarnivalGiftModel"),c=cc._decorator,u=c.ccclass,d=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._totalTaskNum=0,e._curDay=0,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this.clearData(),this.addEventListener(),this.initBannerBg(),this.initRedPointState()},e.prototype.clearData=function(){this._dataList={},this._specialDesList={},this._giftDataList={},this._discountMap={},this._scoreList=[],this._bannerBg=null,this._redPointMap=[]},e.prototype.initRedPointState=function(){var t={1:!0,4:!0};this._redPointMap=[];for(var e=r.GetTableClass(r.TableEnum.CarnivalTypeConfig).getMaxDay(),i=0;i<e;i++){var n={};n[1]=t[1],n[4]=t[4],this._redPointMap.push(n)}},e.prototype.addEventListener=function(){var t=r.EventNameEnum,e={};e[t.REQ_CARNIVAL_DISCOUNT]=this._reqBuyGift,e[t.REQ_CARNIVAL_SCORE]=this._reqScoreReward,r.EventUtil.registerEvents(e,this)},e.prototype.activityParse=function(t){this.getActivityData();var e=t.record;this._scoreList=e.scoreList||[],this._discountMap=e.discountMap,this._curDay=e.day,this._refreshData()},e.prototype.initBannerBg=function(){for(var t=this.getActivityData(),e=r.GetTableClass(r.TableEnum.CarnivalTypeConfig).getDatasByDataId(t),i=0,n=e.length;i<n;i++){var a=e[i];if(null===this._bannerBg&&""!==a.bgPic){this._bannerBg=a.bgPic;break}}},e.prototype.setRedPointState=function(t,e,i){for(var n=0;n<this._redPointMap.length;n++)if(n===t-1){this._redPointMap[n][e]=i;break}},e.prototype.getRedPointState=function(t,e){return this._redPointMap[t-1][e]||!1},e.prototype._refreshData=function(){this._initDatas(),this._updateGiftState()},e.prototype._initDatas=function(){this._durationDays=r.GetTableClass(r.TableEnum.CarnivalTypeConfig).getMaxDay(),this._showingDays=this._durationDays;var t=this.getActivityData();this._dataList={},this._specialDesList={},this._totalTaskNum=0;for(var e=this._dataList,i=r.GetTableClass(r.TableEnum.CarnivalTypeConfig).getDatasByDataId(t),n=0;n<i.length;n++){var a=i[n];(h=new s).init(a);var o=h.getDay(),c=h.getType(),u=h.getDes();e[o]||(e[o]={}),e[o][c]=h,u&&""!==u&&(this._specialDesList[o]=u),this._totalTaskNum+=h.getTaskIds().length}this._giftDataList={};var d=r.GetTableClass(r.TableEnum.CarnivalDiscountConfig).getDatasByDataId(t);for(n=0;n<d.length;n++){var h,p=d[n];(h=new l).init(p);o=h.getDay();this._giftDataList[o]||(this._giftDataList[o]=[]),this._giftDataList[o][this._giftDataList[o].length]=h}this._scoreRewards={};for(var _=r.GetTableClass(r.TableEnum.CarnivalScoreConfig).getDatasByDataId(t),g=r.RewardStatus.CANNOT_RECEIVE,f=(n=0,_.length);n<f;n++){var v=_[n],m=v.score,y=v.rewards,E={};E.rewards=r.RewardManager.parseRewardListDetail(y),E.state=g,this._scoreRewards[m]=E}},e.prototype._updateGiftState=function(){if(this._dataList&&0!==this._dataList.myLen()){var t=this._discountMap;if(t&&t.myLen()>0){var e=this._giftDataList;for(var i in t){i=parseInt(i);var n=!1;for(var a in e){if(n)break;for(var o=e[a],s=0,l=o.length;s<l;s++){if((d=o[s]).getId()===i){d.setBoughtTimes(t[i]),n=!0;break}}}}}var c=r.RewardStatus,u=this._scoreList;if(u&&u.length>0)for(e=this._scoreRewards,s=0,l=u.length;s<l;s++){var d;(d=e[u[s]])&&(d.state=c.RECEIVED)}r.EventUtil.dispatchEvent(r.EventNameEnum.ON_CARNIVAL_DATA_CHANGED)}},e.prototype.isCanShow=function(){return this._curDay&&this._curDay<=this._showingDays},e.prototype.canComplete=function(){return this._curDay&&this._curDay<=this._durationDays},e.prototype._isInActiveDay=function(t){return t<=this._curDay},e.prototype.getDayList=function(t){return this._dataList&&this._dataList[t]?this._dataList[t]:null},e.prototype.getStartTime=function(){return this._startTime},e.prototype.getDurationDays=function(){return this._durationDays},e.prototype.getShowDays=function(){return this._showingDays},e.prototype.getCurDay=function(){return this._curDay},e.prototype.getBannerBg=function(){return this._bannerBg},e.prototype.getSpecialDesList=function(){return this._specialDesList},e.prototype.getTotalTaskNum=function(){return this._totalTaskNum},e.prototype.getScoreRewards=function(){return this._scoreRewards},e.prototype.getScoreReward=function(t){return this._scoreRewards[t]},e.prototype.getDiscountRewards=function(t){return this._giftDataList&&this._giftDataList[t]?this._giftDataList[t]:null},e.prototype.getFinishTaskNum=function(){var t=this._dataList,e=this._curDay,i=0,n=r.TaskManager,a=r.TaskStatus;for(var o in t){if((o=parseInt(o))>e)break;var s=t[o];for(var l in s){var c=s[l].getTaskIds();if(c&&c.length>0)for(var u=0,d=c.length;u<d;u++){var h=n.getTaskById(c[u]);if(h){var p=h.getStatus();p!==a.Finish&&p!==a.Received||i++}}}}var _=this._scoreRewards,g=r.RewardStatus;for(var f in _)_[f=parseInt(f)].state===g.CANNOT_RECEIVE&&i>=f&&(_[f].state=g.CAN_RECEIVE);return i},e.prototype._reqBuyGift=function(t){var e=t.id,i=t.activityId;if(this._activityId==i){var n={id:e,parmeterMap:{16:1}};this.operateActivity(n)}},e.prototype._reqScoreReward=function(t){var e={id:t,parmeterMap:{16:2}};this.operateActivity(e)},e.prototype.hasRedPoint=function(){return!1},e.prototype.redPointEvts=function(){var t=r.EventNameEnum;return[t.ON_CARNIVAL_DATA_CHANGED,t.Res_GET_TASK_INFO,t.CARNIVAL_TAB_CHANGED]},e.prototype.isRedPointTip=function(){for(var t=this._durationDays,e=1;e<=t+1;e++){if(this.isDayAddRedPoint(e))return!0}return!!this.isScoreRewardRedPoint()},e.prototype.isDayAddRedPoint=function(t){if(!this._dataList||0===this._dataList.myLen())return!1;if(!this._isInActiveDay(t))return!1;if(!this._dataList[t]||0===this._dataList[t].myLen())return!1;var e=this._dataList[t];for(var i in e)if(this.isTypeAddRedPoint(t,i))return!0;return!1},e.prototype.isTypeAddRedPoint=function(t,e){if(!this._dataList||0===this._dataList.myLen())return!1;if(!this._dataList[t]||!this._dataList[t][e])return!1;if(!this._isInActiveDay(t))return!1;var i=this._dataList[t][e].getTaskIds();if(i&&i.length>0)for(var n,a=r.TaskManager,o=r.TaskStatus.Finish,s=0;n=i[s++];){var l=a.getTaskById(n);if(l){var c=this.getRedPointState(t,e);if(l.getConditionType()===r.TaskConditionType.ACTOR_DIRECT_PURCHASING){if(l.getStatus()===o||c)return!0}else if(l.getStatus()===o)return!0}}else{var u=this._giftDataList[t]||[],d=this.getRedPointState(t,e);if(this.canComplete())for(var h=0,p=u.length;h<p;h++){var _=u[h];if(_.getCanBuyTimes()>_.getBoughtTimes()&&d)return!0}if(d)return!0}return!1},e.prototype.isScoreRewardRedPoint=function(){var t=this._scoreRewards,e=r.RewardStatus;for(var i in t)if(t[i=parseInt(i)].state===e.CAN_RECEIVE)return!0;return!1},e=a([u],e)}(o));i.default=d,e.exports=d,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",CarnivalGiftModel:"CarnivalGiftModel",CarnivalTypeModel:"CarnivalTypeModel"}],NewServerCarnivalItem:[function(t,e,i){"use strict";cc._RF.push(e,"840adFdAmhP9I0PRqavEO/1","NewServerCarnivalItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=t("CommonIconWidget"),l=cc._decorator,c=l.ccclass,u=l.property,d=l.menu,h=1,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.titleLabel=null,e.oriCostNode=null,e.costNode=null,e.progressNum=null,e.statusImg=null,e.conditionLabel=null,e.enterBtn=null,e.rewardLayer=null,e}return n(e,t),e.prototype.updateItem=function(e,i){if(t.prototype.updateItem.call(this,e,i),i){var n,a,o,l,c,u=this._customData.showType,d=this._customData.controller,p=[],_=d.canComplete(),g=d.getCurDay(),f=i._day;if(u===h){this.titleLabel.string=i.getDes(),this.conditionLabel.node.active=!1,this.oriCostNode.active=!1,this.costNode.active=!1,p=r.RewardManager.getRewardDetailArray(i.getRewards());var v=i.getStatus(),m=r.TaskStatus;if(f>g?(n=null,l="HD_wz_wkq",c=r.resDef.pngPlist.Acitivty_gy):v===m.Received?(n=null,c=r.resDef.pngPlist.GY0_Common,l=r.resDef.GY0_Common.GY0_wz_yilingqu):v===m.Finish?(l=null,n=r.resDef.GY_Common.GY_anniu_03,a=r.Language.recevie,o=cc.color(16,98,161)):_?(l=null,n=r.resDef.GY_Common.GY_anniu_02,a=r.Language.goto,o=cc.color(176,79,0)):(n=null,l=r.resDef.Acitivty_16_cfkh.HD_xfkh_wwc,c=r.resDef.pngPlist.Acitivty_16_cfkh),i.getConditionType()===r.TaskConditionType.ACTOR_DIRECT_PURCHASING){this.progressNum.node.active=!1;var y=r.RechargeManager.getRechargeDataById(i.getNeedValue()).getCostValue()/10;v!==m.Finish&&(a=cc.js.formatStr(r.Language.rechargeCount,y))}else{if(f<=g&&i.getWithProgress()>0){this.progressNum.node.active=!0;var E=i.getStatus()===r.TaskStatus.Finish||i.getStatus()===r.TaskStatus.Received?cc.color(0,167,43):cc.color(173,98,1),T=r.GlobalFunction.getSimpledNumStrWan(i.getValue()),C=r.GlobalFunction.getSimpledNumStrWan(i.getNeedValue());i.getConditionType()===r.TaskConditionType.ACTOR_RECHARGE&&(T/=10,C/=10),this.progressNum.string=cc.js.formatStr("(%s/%s)",T,C),this.progressNum.node.color=E}else this.progressNum.node.active=!1;this.oriCostNode.active=!1,this.costNode.active=!1}}else{this.titleLabel.string=i.getDes(),p=r.RewardManager.getRewardDetailArray(i.getRewards()),this.progressNum.node.active=!1;var R=i.getOrginalCost();R?(this.oriCostNode.active=!0,this._setCostIconAndNum(this.oriCostNode,R)):this.oriCostNode.active=!1;var S=i.getCost();S?(this.costNode.active=!0,this._setCostIconAndNum(this.costNode,S)):this.costNode.active=!1;var I=i.getCanBuyTimes(),A=i.getBoughtTimes();f>g?(n=null,l="HD_wz_wkq",c=r.resDef.pngPlist.Acitivty_gy,this.conditionLabel.node.active=!1):I-A>0?_?(l=null,n=r.resDef.GY_Common.GY_anniu_02,a=r.Language.buy,o=cc.color(176,79,0),this.conditionLabel.node.active=!0,this.conditionLabel.string=cc.js.formatStr(r.Language.GrowthPlanVipTips,i.getCanBuyVip())):(n=null,l=r.resDef.Acitivty_16_cfkh.HD_xfkh_ygq,c=r.resDef.pngPlist.Acitivty_16_cfkh,this.conditionLabel.node.active=!1):(n=null,l=r.resDef.GY0_Common.GY0_wz_yiguomai,c=r.resDef.pngPlist.GY0_Common,this.conditionLabel.node.active=!1)}if(null!==l?(this.statusImg.active=!0,r.GlobalFunction.createAltasSprite(c,l,this.statusImg)):this.statusImg.active=!1,null!==n){if(this.enterBtn.active=!0,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.GY_Common,n,this.enterBtn),a){var b=this.enterBtn.getChildByName("Label");b.color=o,b.getComponent(cc.Label).string=a}}else this.enterBtn.active=!1;for(var P=0,N=p.length;P<N;P++){var M=p[P];(L=this.rewardLayer.getChildByName("icon"+P))?L.getComponent(s).setData(M):((L=r.GlobalFunction.createCommonIconWidget(56,M)).name="icon"+P,L.scale=.8,L.parent=this.rewardLayer)}for(;;P++){var L;if(!(L=this.rewardLayer.getChildByName("icon"+P)))break;L.removeFromParent(!0)}}},e.prototype._setCostIconAndNum=function(t,e){var i=t.getChildByName("icon");i&&r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,e.getLittleIconResPath(),i);var n=t.getChildByName("num");n&&(n.getComponent(cc.Label).string=e.getCount())},e.prototype.onClickEnterBtn=function(){if(this._item){var t=this._item,e=this._customData.showType,i=this._customData.controller;if(e===h){if(t.getStatus()==r.TaskStatus.Finish)r.EventUtil.dispatchEvent(r.EventNameEnum.Req_TASK_RECEIVE,t.getId());else if(t.getConditionType()===r.TaskConditionType.ACTOR_DIRECT_PURCHASING){var n=r.RechargeManager.getRechargeDataById(t.getNeedValue());n&&r.EventUtil.dispatchEvent(r.EventNameEnum.REQUEST_RECHARGE,n)}else{var a=t.getGotoPanel(),o=null;a[1]&&(o=a[1]),r.PanelJumpManager.jumpToPanel(a[0],o)}}else{var s=t.getCanBuyTimes(),l=t.getBoughtTimes(),c=t.getCanBuyVip();if(c>r.Account.getUserData().vip){var u=new r.BroadcastContent(112);return u.setMainParam([new r.BroadcastParam(c)]),void r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,u)}if(s>l){var d={};d.activityId=i.getActivityId(),d.id=t.getId(),r.EventUtil.dispatchEvent(r.EventNameEnum.REQ_CARNIVAL_DISCOUNT,d)}}}},a([u(cc.Label)],e.prototype,"titleLabel",void 0),a([u(cc.Node)],e.prototype,"oriCostNode",void 0),a([u(cc.Node)],e.prototype,"costNode",void 0),a([u(cc.Label)],e.prototype,"progressNum",void 0),a([u(cc.Node)],e.prototype,"statusImg",void 0),a([u(cc.Label)],e.prototype,"conditionLabel",void 0),a([u(cc.Node)],e.prototype,"enterBtn",void 0),a([u(cc.Node)],e.prototype,"rewardLayer",void 0),e=a([c,d("module/Activity/ActivityConfig/NewServerCarnivalItem")],e)}(o);i.default=p,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],NewServerCarnivalPanel:[function(t,e,i){"use strict";cc._RF.push(e,"fc51fv0UPJBn6Lg8klZR53s","NewServerCarnivalPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=t("CommonIconWidget"),p=1,_=2,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dayScrollView=null,e.dayScrollContent=null,e.endTimeLabel=null,e.receiveTimeLabel=null,e.receiveTimeLabelT=null,e.tabLayer=null,e.progressLayer=null,e.taskScrollView=null,e.dayItem=null,e.img=null,e.bannerBg=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Panel,this._panelEnum=r.PanelEnum.Panel_NewServerCarnivalActivity},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this._selectType=1,this._selectDayBtn=null,this._selectDay=0,this._taskList=null},e.prototype.setData=function(e){if(t.prototype.setData.call(this,e),this._activityType=e,this._taskListComponent=this.node.getComponent(d),this._controller=r.ActivityDataManager.getActivityControllerByType(this._activityType),this._controller){this._activityId=this._controller.getActivityId(),r.EventUtil.dispatchEvent(r.EventNameEnum.Req_GET_ACTIVITY_INFO,this._activityId);var i=this._controller.getBannerBg();r.GlobalFunction.createSprite("Activity_bg/"+i,this.bannerBg),this._initDaysScroll(),this._initEndTime(),this._refreshView()}},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.Res_GET_TASK_INFO]=this._onTaskUpdate,t[e.ON_CARNIVAL_DATA_CHANGED]=this._refreshView,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.receiveRewardReturn,t[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,t[e.Recharge_Success]=this._refreshView,t[e.Res_GET_ACTIVITY_INFO]=this._onGetActivityInfo,r.EventUtil.registerEvents(t,this)},e.prototype.setNewData=function(t){this._refreshProgressLayer(),this._refreshCurDay(t)},e.prototype.receiveRewardReturn=function(t){if(t.activityId===this._activityId){var e=t.rewardResult,i=r.RewardManager.parseRewardResult(e,!0);r.GlobalFunction.showRewards(i),this._refreshView()}},e.prototype._onActivityClose=function(t){this._activityId===t&&this.closeCallFunc()},e.prototype._refreshView=function(){this._refreshList(),this._refreshProgressLayer(),this._refreshCurDay(null)},e.prototype._onTaskUpdate=function(){this._refreshProgressLayer(),this._refreshList()},e.prototype._onGetActivityInfo=function(t){this._activityId===t&&this._refreshView()},e.prototype._refreshProgressLayer=function(){var t=this.progressLayer,e=this._controller.getFinishTaskNum();t.getChildByName("numBg").getChildByName("myProgress").getComponent(cc.Label).string=e.toString();var i=this._controller.getScoreRewards(),n=r.RewardStatus,a=1;for(var o in i){var s=i[o],l=t.getChildByName("node"+a);if(!l){cc.log("can not find rewardbox for "+a);break}l.getChildByName("lab_num").getComponent(cc.Label).string=o;var c=s.state,u=l.getChildByName("rewardItem");if(!u){var d=s.rewards;(u=r.GlobalFunction.createCommonIconWidget(26,d[0])).setScale(.85),u.y=10,u.name="rewardItem",l.addChild(u)}var p=u.getComponent(h);if(c===n.CAN_RECEIVE)this._addSelectAni(u),p.setTouchEnabled(!1);else{this._hideSelectAni(u),p.setTouchEnabled(!0);var _=u.getChildByName("HD_bq_yilingqu");_||((_=cc.instantiate(this.img)).active=!0,_.name="HD_bq_yilingqu",u.addChild(_),_.zIndex=101),_.active=c===n.RECEIVED,p.setMaskShow(c===n.RECEIVED)}l._tag=o,l.getComponent(cc.Button).interactable=c!==n.RECEIVED,a++}},e.prototype._refreshCurDay=function(t){var e=this._controller.getDurationDays(),i=this._selectDay||this._controller.getCurDay(),n=i;t&&(this._selectType=t.type||null,n=t&&t.selectDay?t.selectDay:i);for(var a=1;a<=e;a++){var r=this.dayScrollContent.getChildByName("dayItem"+a);(a===n||i>e&&a===e)&&this._switchDay(r,a)}},e.prototype._initEndTime=function(){this.unschedule(this.loopEndTime);var t=0,e=this._controller.getCurrentOpenStage();e&&(t=e.closeTime),this._endTime=t;var i=r.TimeUtil.getTime();this._endTime>i?(this.loopEndTime(),this.schedule(this.loopEndTime,1)):this.endTimeLabel.string=r.Language.end},e.prototype.loopEndTime=function(){var t=this._endTime-r.TimeUtil.getTime();t>0?this.endTimeLabel.string=r.GlobalFunction.convertTimestamp(t/1e3,"dd\u5929HH:mm:ss"):(this.endTimeLabel.string=r.Language.end,this.unschedule(this.loopEndTime))},e.prototype._initDaysScroll=function(){for(var t=this._controller.getDurationDays(),e=this.dayScrollContent,i=r.GlobalFunction,n=r.RedPointUtil,a=r.resDef.pngPlist.Acitivty_16_cfkh,o=1;o<=t;o++){var s=e.getChildByName("dayItem"+o);if(!s){(s=cc.instantiate(this.dayItem)).x=-s.width/2,s.active=!0,s.name="dayItem"+o,s.parent=e,s.getComponent(cc.Button).clickEvents=[];var l=r.GlobalFunction.createClickEventHandler(this,"NewServerCarnivalPanel","_switchDay",o);s.getComponent(cc.Button).clickEvents.push(l)}if(0===s.getComponent(cc.Button).clickEvents.length){l=r.GlobalFunction.createClickEventHandler(this,"NewServerCarnivalPanel","_switchDay",o);s.getComponent(cc.Button).clickEvents.push(l)}if(o===t)s.getChildByName("imgLineDown").active=!0;n.createRedPointOld(s,cc.v2(-25,-15),this._controller.isDayAddRedPoint.bind(this._controller,o),this._controller.redPointEvts());var c=s.getChildByName("dayImg");i.createAltasSprite(a,"HD_xfkh_tianshu_0"+o,c)}},e.prototype._switchDay=function(t,e){var i=t.currentTarget||t,n=i.getName();if(!this._selectDayBtn||this._selectDayBtn.getName()!==n){var a=r.GlobalFunction,o=r.resDef.pngPlist.Acitivty_16_cfkh;if(this._selectDayBtn){var s=this._selectDayBtn.getChildByName("bg"),l=this._selectDayBtn.getChildByName("dayImg");a.createAltasSprite(o,"HD_xfkh_tianshu_0"+this._selectDay,l),a.createAltasSprite(o,"HD_xfkh_tianshu_bg01",s),this._selectDayBtn.height=65;var c=this._selectDayBtn.getChildByName("imgLineUp"),u=this._selectDayBtn.getChildByName("imgLineDown"),d=this._controller.getDurationDays();c.active=!0,u.active=this._selectDay===d}this._selectDay=e;var h=i.getChildByName("bg"),p=i.getChildByName("dayImg");a.createAltasSprite(o,"HD_xfkh_tianshu_0"+this._selectDay+"_02",p),a.createAltasSprite(o,"HD_xfkh_tianshu_bg02",h),this._selectDayBtn=i;var _=this._selectDayBtn.getChildByName("imgLineUp"),g=this._selectDayBtn.getChildByName("imgLineDown");_.active=!1,g.active=!1,this._selectDayBtn.height=74,this._switchType()}},e.prototype._switchType=function(){this._selectType||(this._selectType=1);var t={};t.selectDay=this._selectDay,t.type=this._selectType,this.setNewData(t),this._refreshList(!0)},e.prototype.onTabClick=function(t){var e=t.currentTarget||t;this._selectType!==e._tag&&(this._selectType=e._tag||1,this._switchType())},e.prototype._refreshList=function(t){void 0===t&&(t=!1),this._selectDay||(this._selectDay=this._controller.getCurDay()),this._selectType||(this._selectType=1),this._controller.setRedPointState(this._selectDay,this._selectType,!1);var e=this._controller.getDayList(this._selectDay);if(e){var i=this.tabLayer,n=this._selectType,a=r.resDef.Acitivty_gy,o=r.RedPointUtil;if(t){var s=1,l=i.getChildByName("tabBtn1");for(var c in e){c=parseInt(c);var u=i.getChildByName("tabBtn"+s),d=e[c];if(d){u||((u=cc.instantiate(l)).name="tabBtn"+s,u.parent=i),u.on(cc.Node.EventType.TOUCH_END,this.onTabClick,this),u._tag=c,u.getChildByName("Label").getComponent(cc.Label).string=d.getName();var h=c===n;u.getComponent(cc.Button).interactable=!h,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Acitivty_gy,h?a.HD_anniu_01:a.HD_anniu_02,u);var g=u.getChildByName("Label");g&&(g.getComponent(cc.LabelOutline).color=h?cc.color(223,144,59):cc.color(17,152,238)),u&&o.createRedPointOld(u,{x:-10,y:-10},this._controller.isTypeAddRedPoint.bind(this._controller,this._selectDay,c),this._controller.redPointEvts()),s++}}for(;;s++){if(!(u=i.getChildByName("tabBtn"+s)))break;u.removeFromParent(!0)}}else{(u=i.getChildByName("tabBtn"+n))&&o.createRedPointOld(u,{x:-10,y:-10},this._controller.isTypeAddRedPoint.bind(this._controller,this._selectDay,n),this._controller.redPointEvts())}r.EventUtil.dispatchEvent(r.EventNameEnum.CARNIVAL_TAB_CHANGED);var f=e[n];if(f){var v,m=[],y=f.getTaskIds();if(y&&y.length>0){for(var E=r.TaskManager,T=(s=0,y.length);s<T;s++){var C=y[s],R=E.getTaskById(C);R&&(R.getConditionType()===r.TaskConditionType.ACTOR_DIRECT_PURCHASING&&(R.price=f._des[s]),R._day=f._day,m[m.length]=R)}m.sort(r.SortUtil.receiveTaskSort),v=p}else{var S=this._controller.getDiscountRewards(this._selectDay);S&&S.length>0&&(v=_,m=S.slice(0))}var I={};I.showType=v,I.controller=this._controller,this._taskListComponent.setCustomData(I),this._taskListComponent.setData(m)}}},e.prototype.onClickRewardBox=function(t){var e=t.currentTarget;if(e){var i=e._tag,n=this._controller.getScoreReward(i);if(n)n.state===r.RewardStatus.CAN_RECEIVE&&r.EventUtil.dispatchEvent(r.EventNameEnum.REQ_CARNIVAL_SCORE,i)}},e.prototype._addSelectAni=function(t){var e=t.getChildByName("selectAni");if(e){e.active=!0;var i=e.getComponent(cc.Animation);i.play(i.defaultClip.name)}else{var n=r.GlobalFunction.getResIdByNode(this.node);gdk.rm.loadRes(n,"uiAnima/QianDao_UI/QianDao_UI",cc.Prefab,this._playSelectAni.bind(this,t))}},e.prototype._hideSelectAni=function(t){var e=t.getChildByName("selectAni");e&&(e.active=!1)},e.prototype._playSelectAni=function(t){if(cc.isValid(this.node)&&cc.isValid(t)&&!t.getChildByName("selectAni")){var e=gdk.rm.getResByUrl("uiAnima/QianDao_UI/QianDao_UI",cc.Prefab),i=cc.instantiate(e);i.name="selectAni",i.parent=t;var n=i.getComponent(cc.Animation);n.play(n.defaultClip.name)}},a([l(cc.ScrollView)],e.prototype,"dayScrollView",void 0),a([l(cc.Node)],e.prototype,"dayScrollContent",void 0),a([l(cc.Label)],e.prototype,"endTimeLabel",void 0),a([l(cc.Label)],e.prototype,"receiveTimeLabel",void 0),a([l(cc.Label)],e.prototype,"receiveTimeLabelT",void 0),a([l(cc.Node)],e.prototype,"tabLayer",void 0),a([l(cc.Node)],e.prototype,"progressLayer",void 0),a([l(cc.Node)],e.prototype,"taskScrollView",void 0),a([l(cc.Node)],e.prototype,"dayItem",void 0),a([l(cc.Node)],e.prototype,"img",void 0),a([l(cc.Node)],e.prototype,"bannerBg",void 0),e=a([s,c("module/Activity/NewServerCarnival/NewServerCarnivalPanel")],e)}(u);i.default=g,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",OptimizeVerticalListView:void 0,PanelBase:void 0}],NoticeItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"2b7abc+yj9MYaid9fKgjzxj","NoticeItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeLabel=null,e._str=null,e.ModelWord="",e}return n(e,t),e.prototype.updateItem=function(t,e){this.ModelWord||(this.ModelWord=r.Language.RareTreasureNoticeTip1);var i=r.RewardManager.getRewardDetail(e.reward),n=cc.js.formatStr(this.ModelWord,e.server,e.playerName,e.num+"",e.phase+"",r.QualityColorStrs[i.getQuality()],i.getName()+"x"+i.getCount(),e.luckNum+"");this._str=n,gdk.Timer.clearAll(this),gdk.Timer.once(200*t,this,this.showRichText),cc.log("index: "+t)},e.prototype.showRichText=function(){this.nodeLabel.getComponent(cc.RichText).string=this._str,cc.log("showRichText ")},e.prototype.onDisable=function(){gdk.Timer.clearAll(this)},a([l(cc.Node)],e.prototype,"nodeLabel",void 0),e=a([s,c("module/Activity/RareTreasure/NoticeItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],ObtainWayTable:[function(t,e,i){"use strict";cc._RF.push(e,"7cd474YiltJwp5t0wHV9XxJ","ObtainWayTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ObtainWayTable",properties:{_tblName:"obtain_way",_name:"",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},getObtainWayDataById:function(t){return this._data[t]?this._data[t]:(cc.log("read ObtainWay Data is error!!!"),null)},getDatas:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],OnlineRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"d9939w8/ZdKXa6rSpHiOtof","OnlineRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="OnlineRewardConfig",e._tblName="online_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[t.length]=a}},e.prototype.getOnlineRewardConfigs=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],OnlineRewardManager:[function(t,e,i){"use strict";cc._RF.push(e,"87774M7m/xAjYwLn5ecQaYn","OnlineRewardManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,t("OnlineRewardModel")),s=function(){function t(){this._curRewardId=0,this._nextReceiveTime=0,this._isAllReceived=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._curRewardId=0,this._nextReceiveTime=0,this._dataList={},this._isAllReceived=!1},t.prototype.addListener=function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.GET_ONLINE_REWARD_INFO,this._parseOnlineRewardInfo.bind(this)),i.registerMessage(t,e.ONLINE_REWARD_RECEIVE,this._onReceiveReward.bind(this)),i.registerMessage(t,e.PUSH_ONLINE_REWARD_INFO,this._parseOnlineRewardInfo.bind(this))},t.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.REQ_ONLINE_REWARD_INFO]=this._requestOnlineRewardInfo,e[t.REQ_RECEIVE_ONLINE_REWARD]=this._requestReceiveOnlineReward,td.EventUtil.registerEvents(e,this)},t.prototype.getOnlineRewardList=function(){return this._dataList},t.prototype.getNextReceiveTime=function(){return this._nextReceiveTime},t.prototype.isAllReceived=function(){return this._isAllReceived},t.prototype.getCurRewardId=function(){return this._curRewardId},t.prototype._requestOnlineRewardInfo=function(){if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.ONLINE_REWARD,0)){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.GET_ONLINE_REWARD_INFO,td.ServerDelegate.sendMessage(t)}},t.prototype._parseOnlineRewardInfo=function(t,e){if(t===td.NetCode.SUCCESS){this._initRewardList();var i=e.id;this._curRewardId=i,this._isAllReceived=0===i,this._nextReceiveTime=e.time,td.EventUtil.dispatchEvent(td.EventNameEnum.RES_ONLINE_REWARD_INFO)}else this._isAllReceived=!0},t.prototype._requestReceiveOnlineReward=function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.ONLINE_REWARD_RECEIVE,t.configId=this._curRewardId,td.ServerDelegate.sendMessage(t)},t.prototype._onReceiveReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult);td.GlobalFunction.showRewards(i)}},t.prototype._initRewardList=function(){if(!(this._dataList&&this._dataList.myLen()>0)){this._dataList={};for(var t=td.GetTableClass(td.TableEnum.OnlineRewardConfig).getOnlineRewardConfigs(),e=0,i=t.length;e<i;e++){var n=t[e],a=new o;a.init(n),this._dataList[a.getId()]=a}}},t=e=n([r],t)}();i.default=s,cc._RF.pop()},{OnlineRewardModel:"OnlineRewardModel"}],OnlineRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"0c13aFln4hF75QlH/DLSRYA","OnlineRewardModel");var n=window.td,a=function(){function t(){this._id=0,this._time=0,this._showContent=""}return t.prototype.init=function(t){t&&(this._id=t.id,this._time=t.time,this._showContent=t.showContent,this._rewards=n.RewardManager.parseRewardListDetail(t.rewards))},t.prototype.getId=function(){return this._id},t.prototype.getTime=function(){return this._time},t.prototype.getShowContent=function(){return this._showContent},t.prototype.getRewards=function(){return this._rewards},t.prototype.getShowReward=function(){return this._rewards&&this._rewards[0]?this._rewards[0]:null},t}();e.exports=a,cc._RF.pop()},{}],OperationTypeTable:[function(t,e,i){"use strict";cc._RF.push(e,"53ab1ne7zRAJb91cLEi02XD","OperationTypeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"OperationTypeTable",properties:{_tblName:"operation_type_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.id]=a}},getOperationName:function(t){return this._data[t].name}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],OrdinaryBullet:[function(t,e,i){"use strict";cc._RF.push(e,"7056dNckxVILZT4X9QhPLFH","OrdinaryBullet");var n=t("BaseBullet"),a=t("PveNodePoolManager"),r=cc.Class({extends:n,initData:function(t){this._super(t),this.setRenderWithStatus(td.PveEnum.PVE_BUTTET_STATUS.Fly),this.node.setPosition(this._curBornPos),this._moveType===td.PveEnum.PVE_BULLET_MOVE_TYPE.Parabolic?this._moveByParabolicTracking():this._calcStraightLineTrackingSpeed()},putToNodePool:function(){a.putBulletToPool(this.getBulletId(),this.node)}});e.exports=r,cc._RF.pop()},{BaseBullet:"BaseBullet",PveNodePoolManager:"PveNodePoolManager"}],OrdinaryEnemy:[function(t,e,i){"use strict";cc._RF.push(e,"f6510eAIF1Km5LD9VyheccT","OrdinaryEnemy");var n=t("BaseEnemy"),a=t("PveNodePoolManager"),r=cc.Class({extends:n,properties:{},initData:function(t){this._super(t)},putToNodePool:function(){cc.isValid(this.node)&&this.node.getParent()&&a.putEnemyToPool(this.getDataModel().getRoleType(),this.node)}});e.exports=r,cc._RF.pop()},{BaseEnemy:"BaseEnemy",PveNodePoolManager:"PveNodePoolManager"}],OtherBattleArrayEntity:[function(t,e,i){"use strict";cc._RF.push(e,"375fbXewcJCq66Vlv1vyZAK","OtherBattleArrayEntity");var n=window.td,a=function(){function t(){this._orderId=0,this._fightPower=0,this._heroData=null,this._equipList={},this._treasureMap={},this._gemList={},this._suitData={},this._camp=0}return t.prototype.setOrderId=function(t){this._orderId=t},t.prototype.getOrderId=function(){return this._orderId},t.prototype.setFightPower=function(t){this._fightPower=t},t.prototype.getFightPower=function(){return this._fightPower},t.prototype.setHeroData=function(t){this._heroData=t},t.prototype.getHeroData=function(){return this._heroData},t.prototype.setEquipList=function(t){for(var e in this._equipList=t,this._suitData={},t){var i=t[e],n=i.getGroupId();n&&0!=n&&(this._suitData[n]||(this._suitData[n]={}),this._suitData[n][i.getType()]=i.getSId())}},t.prototype.getEquipList=function(){return this._equipList},t.prototype.setTreasureMap=function(t){this._treasureMap=t},t.prototype.getTreasureMap=function(){return this._treasureMap},t.prototype.setSpirit=function(t){this._spirit=t},t.prototype.getSpirit=function(){return this._spirit},t.prototype.setGemList=function(t){this._gemList=t},t.prototype.getGemList=function(){return this._gemList},t.prototype.isGroupActive=function(t){if(!this._suitData||!this._suitData[t])return!1;var e=this._suitData[t],i=n.GetTableClass(n.TableEnum.EquipmentGroupTable).getDataById(t);if(!i)return!1;for(var a=i.attributes,r=0;r<a.length;r++){var o=a[0];if(e.myLen()>=o)return!0}return e.myLen()>=a[0][0]},t.prototype.setCurCamp=function(t){this._camp=t},t.prototype.getCurCamp=function(){return this._camp},t}();e.exports=a,cc._RF.pop()},{}],OtherBattleArrayManager:[function(t,e,i){"use strict";cc._RF.push(e,"fea3dPwPlBK5rNTPmvwiZus","OtherBattleArrayManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,t("OtherBattleArrayEntity")),s=t("HeroModel"),l=t("EquipModel"),c=t("TreasureModel"),u=t("GemstoneModel"),d=t("SpiritModel"),h=t("../../Pet/Model/PetModel"),p=function(){function t(){this._actorData=null,this._battleArray={},this._friendList={},this._petList={},this._selectIndex=1,this._storyId=0}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._actorData=null,this._battleArray={},this._friendList={},this._selectIndex=1,this._petList={}},t.prototype.addListener=function(){var t=td.ServerDelegate,e=td.MsgModuleName.LINEUP,i=td.MsgCmd.LINEUP;t.registerMessage(e,i.QUERY_LINE_UP,this._resQueryLineup.bind(this)),t.registerMessage(e,i.QUERY_SIMPLE_LINE_UP,this._onGetOtherLineupPos.bind(this))},t.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.CHANGE_OTHER_HERO_INDEX]=this._changeSelectIndex,e[t.Req_QueryLineup]=this._reqQueryLineup,e[t.REQUEST_OTHER_LINEUP_POS]=this._requestOtherLineupPos,td.EventUtil.registerEvents(e,this)},t.prototype.getSelectIndex=function(){return this._selectIndex},t.prototype._changeSelectIndex=function(t){this._selectIndex=t},t.prototype.setActorData=function(t){this._actorData=t,this._checkActorData()},t.prototype._checkActorData=function(){var t=!1,e={tdErrorType:"error",errMsg:"BattleArrayOtherManager setActorData "};this._actorData?(this._actorData.gamerId||(t=!0,e.errMsg+="actorData gamerId is undefined"),this._actorData.userName||(t=!0,e.errMsg+="actorData userName is undefined",this._actorData.userName=""),this._actorData.level||(t=!0,e.errMsg+="actorData level is undefined",this._actorData.level=1),this._actorData.power||(t=!0,e.errMsg+="actorData power is undefined",this._actorData.power=0)):(t=!0,e.errMsg+="actorData is null"),t&&cc.log(e)},t.prototype.getActorData=function(){return this._actorData},t.prototype.getBattleArray=function(){return this._battleArray},t.prototype.getPetList=function(){return this._petList},t.prototype.getBattleArrayTotalFight=function(){var t=0;for(var e in this._battleArray)if(this._battleArray.hasOwnProperty(e)){var i=this._battleArray[e];i.getHeroData()&&(t+=i.getFightPower())}return t},t.prototype.getBattleEntityForIndex=function(t){return this._battleArray&&this._battleArray[t]?this._battleArray[t]:null},t.prototype.getFriendList=function(){return this._friendList},t.prototype.getCurStoryId=function(){return this._storyId},t.prototype.getUnlockNeedData=function(){var t={};return t.level=this._actorData.level||0,t.vip=this._actorData.vip||0,t.storyId=this._storyId||0,t},t.prototype._reqQueryLineup=function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.QUERY_LINE_UP,e.actorId=t.actorId,e.serverId=t.serverId,td.ServerDelegate.sendMessage(e)},t.prototype._resQueryLineup=function(t,e){if(t===td.NetCode.SUCCESS){if(this._petList={},e.petList&&e.petList.length>0)for(var i=e.petList,n=0;n<i.length;n++){var a=i[n],r=new h.default,s=td.GetTableClass(td.TableEnum.PetTable).getPetById(a.pet.configId);r.init(s),r.setData(a.pet),r.setStationLevel(e.petPlatformLevel||0),this._petList[a.orderId]=r}this._battleArray={};var l=this._battleArray,c=e.lineupList;if(void 0!==c){n=0;for(var u=c.length;n<u;n++){var d=c[n],p=d.orderId,_=l[p];_||(_=new o,l[p]=_),this._updateBattleEntity(_,d)}}this._friendList={},l=this._friendList;var g=e.reinforcementMap;if(g)for(var f in g){var v=g[f=parseInt(f)],m=td.GetTableClass(td.TableEnum.HeroTable).getHeroById(v.configId);if(m){var y=this._createHeroData(m,v);y.setReinforcementsed(!0),y.setOrderId(f),this._friendList[f]=y}}this._storyId=e.storyId||0,this._selectIndex=1,td.EventUtil.dispatchEvent(td.EventNameEnum.Res_QueryLineup)}},t.prototype._updateBattleEntity=function(t,e){t.setOrderId(e.orderId),t.setFightPower(e.power);var i=e.hero,n=i.configId,a=e.battleId,r=e.soulLinks||[],o=i.camp||0;t.setCurCamp(o);var s=td.GetTableClass(td.TableEnum.HeroTable).getHeroById(n);if(s){var h=this._createHeroData(s,i,a,r);h.setEquipped(!0),h.setOrderId(e.orderId),t.setHeroData(h)}var p=e.equipmentMap,_={};for(var g in p){var f=p[g];if(s=td.GetTableClass(td.TableEnum.EquipmentTable).getDataById(f.configId)){var v=new l;v.init(s),v.setData(f),_[g]=v}}t.setEquipList(_);var m=e.treasureMap,y={};for(var E in m){var T=m[E];if(s=td.GetTableClass(td.TableEnum.TreasureTable).getTreasureById(T.configId)){var C=new c;C.init(s),C.setData(T),y[E]=C}}t.setTreasureMap(y);var R=e.runeMap,S={};for(var E in R){var I=R[E];if(s=td.GetTableClass(td.TableEnum.GemstoneTable).getGemstoneById(I.configId)){var A=new u;A.init(s),A.setSId(I.runeId),A.setLevel(I.reinforceLevel),A.setLevelExp(I.exp),A.setAwakenLv(I.awakenLevel),S[E]=A}}t.setGemList(S);var b=e.spirit,P=b.configId;if(P){var N=new d,M=td.GetTableClass(td.TableEnum.SpiritTable).getSpiritById(P);N.init(M),N.setData(b),t.setSpirit(N)}},t.prototype._createHeroData=function(t,e,i,n){var a=new s;return a.init(t),a.setSId(e.heroId),a.setLevel(e.level),a.setLevelExp(e.exp),e.breakoutLevel&&a.setBreakoutLevel(e.breakoutLevel),e.cultivateLevel&&a.setCultivateLevel(e.cultivateLevel),e.cultivateExp&&a.setCultivateExp(e.cultivateExp),e.starLevel&&a.setStarLevel(e.starLevel),e.evolveLevel&&a.setEvolveLevel(e.evolveLevel),e.heroRuneList&&a.setHeroRune(e.heroRuneList,!0),e.heroArtifactId&&a.setArtifactSid(e.heroArtifactId),e.heroArtifactLevel&&a.setHeroArtifactLevel(e.heroArtifactLevel),e.heroArtifactAdvanceLevel&&a.setHeroArtifactAdvanceLevel(e.heroArtifactAdvanceLevel),i&&a.setBattleHeroId(i),n&&a.refreshSoulLinkHero(n,!0),a},t.prototype._requestOtherLineupPos=function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.QUERY_SIMPLE_LINE_UP,e.actorId=t.actorId,e.serverId=t.serverId,td.ServerDelegate.sendMessage(e)},t.prototype._onGetOtherLineupPos=function(t,e){if(t===td.NetCode.SUCCESS){for(var i={},n=e.lineupList,a=0,r=n.length;a<r;a++){var o=n[a].roleId,l=n[a].positionId,c=new s;c.init(td.GetTableClass(td.TableEnum.HeroTable).getHeroById(o)),i[l]=c}td.EventUtil.dispatchEvent(td.EventNameEnum.GET_OTHER_LINEUP_POS,i)}},t=e=n([r],t)}();i.default=p,cc._RF.pop()},{"../../Pet/Model/PetModel":"PetModel",EquipModel:"EquipModel",GemstoneModel:"GemstoneModel",HeroModel:"HeroModel",OtherBattleArrayEntity:"OtherBattleArrayEntity",SpiritModel:"SpiritModel",TreasureModel:"TreasureModel"}],PDBuff:[function(t,e,i){"use strict";cc._RF.push(e,"7ba67UtkJlL869swoHEBpna","PDBuff");var n=t("PveBaseBuff"),a=(t("PveFightManager"),cc.Class({extends:n,properties:{_bShowBuff:null},initData:function(t){if(this._super(t),this.node.active=!1,this._buffType=td.PveEnum.PVE_EFFECT_TYPE.ReducePhysicsDefence,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff){var e=this.node.getChildByName("PDBuff");if(!e){var i=gdk.rm.getResByUrl("fightRes/pve/buff/dun_buff/jindun",cc.Prefab);e=cc.instantiate(i),this.node.addChild(e),e.y=-20,e.name="PDBuff"}this._buffAnimation=e.getComponent(cc.Animation),this._clipName="PDBuff",cc.log("this is PD buff !!!")}},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._bShowBuff,this.setTargetBuffData(!0),this.schedule(this.onUpdateMagicDefenseBuff,1/60)):this.removeSelf()},onDisable:function(){this._super(),this.unschedule(this.onUpdateMagicDefenseBuff)},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=i.getDataModel(),a=(t?-1:1)*this._curBuffData.buffData*1e4,r=n.getGrade();this.node.scale=r>=3?2.5:.8,i.setCurPDChange(a)},onUpdateMagicDefenseBuff:function(t){if(!this._bFightPause)return this._curBuffData.buffTime<=0?(this.unschedule(this.onUpdateMagicDefenseBuff),this.setTargetBuffData(!1),void this.endBuff()):void(this._curBuffData.buffTime-=t*this._curSpeedMult)},onChangeSpeedMult:function(t){this._super(t),this._bShowBuff&&this.refreshSkillAnimationSpeed(t)},refreshSkillAnimationSpeed:function(t){},endBuff:function(){(this._super(),cc.isValid(this._curTarget))&&this._curTarget.getComponent("EnemyBuffCtrlComponent").removeBuffFromList(this._buffType,this._curBuffKey)}}));e.exports=a,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],PagodaConfig:[function(t,e,i){"use strict";cc._RF.push(e,"d14bfVeX7BIVKHRjf9/ftxa","PagodaConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PagodaConfig",e._tblName="pagoda_config",e._maxFloor=0,e}return n(e,t),e.prototype.init=function(){for(var t=this._jsonData,e=Math.max,i=0,n=t.length-1;i<=n;i++){var a=t[i];this._maxFloor=e(a.floor,this._maxFloor)}},e.prototype.getMaxFloor=function(){return this._maxFloor},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PagodaEnum:[function(t,e,i){"use strict";cc._RF.push(e,"7ae25R4GLVBc4zsbFyLxW0e","PagodaEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.MazePointState=i.PagodaWall=void 0,i.PagodaWall={Up:2,Down:4,Left:8,Right:16},function(t){t[t.DISABLED=1]="DISABLED",t[t.VISIBLED=2]="VISIBLED",t[t.ENABLED=3]="ENABLED"}(i.MazePointState||(i.MazePointState={})),cc._RF.pop()},{}],PagodaInfoModel:[function(t,e,i){"use strict";cc._RF.push(e,"6f2c9xiQ7BJPaqqA+idyVX4","PagodaInfoModel"),Object.defineProperty(i,"__esModule",{value:!0});window.td;var n=t("PagodaPointModel"),a=t("../Enum/PagodaEnum"),r=function(){function t(){this._acotrId=0,this._floor=0,this._maxFullStarFloor=0,this._star=0,this._maxStar=0,this._achieveMaxStarTime=0,this._resetTimes=0,this._lastResetTime=0,this._mapInfo={},this._maxRewardCount=3,this._curRewardCount=0,this._maxMonsterCount=3,this._curMonsterCount=0}return t.prototype.init=function(t){if(t){this._acotrId=t.actorId,this._floor=t.floor,this._maxFullStarFloor=t.maxFullStarFloor||0,this._star=t.star||0,this._maxStar=t.maxStar||0,this._achieveMaxStarTime=t.achieveMaxStarTime||0,this._resetTimes=t.resetTimes,this._lastResetTime=t.lastResetTime||0;var e=t.mazePointMap;if(e)for(var i in e){var a=e[i];for(var r in this._mapInfo[i]=this._mapInfo[i]||{},a){var o=a[r],s=this._mapInfo[i][r];s||(s=new n,this._mapInfo[i][r]=s),s.init(o)}}this._current=this._convertSPointToLPoint(t.current);var l=this._convertSPointToLPoint(t.start),c=this._getPointInMap(l);c&&c.setIsStartPoint();var u=this._convertSPointToLPoint(t.end),d=this._getPointInMap(u);d&&d.setIsEndPoint();var h=t.rewardMap;if(h)for(var p in this._curRewardCount=h.myLen(),h){p=parseInt(p);var _=this._convertSPointToLPoint(p);(f=this._getPointInMap(_))&&f.setRewardData(h[p])}var g=t.monsterMap;if(g)for(var p in this._curMonsterCount=g.myLen(),g){p=parseInt(p);var f;_=this._convertSPointToLPoint(p);(f=this._getPointInMap(_))&&f.setMonsterData(g[p])}}},t.prototype.updateCurPosData=function(t){this._current=this._convertSPointToLPoint(t.current);var e=this._getPointInMap(this._current);(e.setState(a.MazePointState.ENABLED),e)&&(e.haveReward()&&(e.setRewardData(null),this._curRewardCount--),e.haveMonster()&&(e.setMonsterData(null),this._curMonsterCount--));for(var i=t.enableList,n=0,r=i.length;n<r;n++){var o=this._convertSPointToLPoint(i[n]),s=this._getPointInMap(o);s&&s.setState(a.MazePointState.VISIBLED)}this._star=t.star,this._star>this._maxStar&&(this._maxStar=this._star)},t.prototype.isClear=function(){return this._curMonsterCount<=0&&this._curRewardCount<=0},t.prototype.canSweep=function(){return this._floor<this._maxFullStarFloor||this._floor===this._maxFullStarFloor&&this._curMonsterCount>0&&this._curRewardCount>0},t.prototype.getMaxStar=function(){return this._maxStar},t.prototype.getCurStar=function(){return this._star},t.prototype.getMaxRewardCount=function(){return this._maxRewardCount},t.prototype.getCurRewardCount=function(){return this._curRewardCount},t.prototype.getMaxMonsterCount=function(){return this._maxMonsterCount},t.prototype.getCurMonsterCount=function(){return this._curMonsterCount},t.prototype.getMapInfo=function(){return this._mapInfo},t.prototype.getCurPos=function(){return this._current},t.prototype.getCurFloor=function(){return this._floor},t.prototype.getResetTimes=function(){return this._resetTimes},t.prototype._convertSPointToLPoint=function(t){return cc.v2(Math.floor(t/10),t%10)},t.prototype._getPointInMap=function(t){return this._mapInfo&&this._mapInfo[t.x]?this._mapInfo[t.x][t.y]:null},t}();e.exports=r,cc._RF.pop()},{"../Enum/PagodaEnum":"PagodaEnum",PagodaPointModel:"PagodaPointModel"}],PagodaManager:[function(t,e,i){"use strict";cc._RF.push(e,"1ecdcutSfRLZIcFwMr5zEvx","PagodaManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,t("PagodaInfoModel")),s=t("PagodaRankModel"),l=t("../../Shop/Manager/ShopManager"),c=t("../../Shop/Manager/ShopEnum"),u=function(){function t(){this._sweepStartFloor=0}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._pagodaData=null,this._fightPointData=null,this._sweepStartFloor=0},t.prototype.addListener=function(){var t=td.MsgModuleName.PAGODA,e=td.MsgCmd.PAGODA,i=td.ServerDelegate;i.registerMessage(t,e.PAGODA_INFO,this._parsePagodaInfo.bind(this)),i.registerMessage(t,e.PAGODA_RANK,this._onGetPagodaRank.bind(this)),i.registerMessage(t,e.PAGODA_MOVE,this._onMoveReturn.bind(this)),i.registerMessage(t,e.PAGODA_SWEEP,this._onSweepReturn.bind(this)),i.registerMessage(t,e.PUSH_PAGODA_INFO,this._parsePagodaInfo.bind(this)),i.registerMessage(t,e.PUSH_PAGODA_POSITION,this._updatePosData.bind(this)),i.registerMessage(t,e.PUSH_PAGODA_REWARD_RESULT,this._onReceiveReward.bind(this))},t.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.REQUEST_PAGODA_INFO]=this._requestPagodaInfo,e[t.REQUEST_PAGODA_MOVE]=this._requestMove,e[t.REQUEST_PAGODA_RESET]=this._requestReset,e[t.REQUEST_PAGODA_RANK]=this._requestPagodaRank,e[t.REQUEST_PAGODA_SWEEP]=this._requestPagodaSweep,td.EventUtil.registerEvents(e,this)},t.prototype.isRedPointTips=function(){if(!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Pagoda))return!1;if(!this._pagodaData)return!1;var t=this._pagodaData.getResetTimes();return!td.GlobalFunction.getShareConfigUpCostDetail("PAGODA_RESET_COST",t+1)||l.default.getInstance().isShopTipsByType(c.StoreType.EQUIPMENT)},t.prototype.redPointEvents=function(){var t=td.EventNameEnum;return[t.USER_ATTR_LEVEL_CHANGE,t.PAGODA_INFO_CHANGED].concat(l.default.getInstance().shopTipsEvents())},t.prototype.getPagodaData=function(){return this._pagodaData},t.prototype.getPointData=function(t,e){if(!this._pagodaData)return!1;var i=this._pagodaData.getMapInfo();return!!i&&(i[t]&&i[t][e]||null)},t.prototype.saveFightPoint=function(t,e){this._fightPointData={},this._fightPointData.cur=t,this._fightPointData.next=e},t.prototype.haveFightPointData=function(){return null!==this._fightPointData},t.prototype.getFightPointData=function(){var t=this._fightPointData;return this._fightPointData=null,t},t.prototype._requestPagodaInfo=function(){var t={};t.module=td.MsgModuleName.PAGODA,t.cmd=td.MsgCmd.PAGODA.PAGODA_INFO,td.ServerDelegate.sendMessage(t)},t.prototype._parsePagodaInfo=function(t,e){t===td.NetCode.SUCCESS&&(this._pagodaData||(this._pagodaData=new o),this._pagodaData.init(e.pagoda),td.EventUtil.dispatchEvent(td.EventNameEnum.PAGODA_INFO_CHANGED))},t.prototype._requestMove=function(t){var e={};e.module=td.MsgModuleName.PAGODA,e.cmd=td.MsgCmd.PAGODA.PAGODA_MOVE,e.x=t.x,e.y=t.y,td.ServerDelegate.sendMessage(e)},t.prototype._updatePosData=function(t,e){t===td.NetCode.SUCCESS&&this._pagodaData&&this._pagodaData.updateCurPosData(e)},t.prototype._onReceiveReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult,!0);td.GlobalFunction.showRewards(i)}},t.prototype._requestReset=function(){var t={};t.module=td.MsgModuleName.PAGODA,t.cmd=td.MsgCmd.PAGODA.PAGODA_RESET,td.ServerDelegate.sendMessage(t)},t.prototype._onMoveReturn=function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PAGODA_POS_UPDATED)},t.prototype._requestPagodaRank=function(){var t={};t.module=td.MsgModuleName.PAGODA,t.cmd=td.MsgCmd.PAGODA.PAGODA_RANK,td.ServerDelegate.sendMessage(t)},t.prototype._onGetPagodaRank=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.ranks,n=i.pop(),a=new s;a.init(n);for(var r=[],o=0,l=i.length;o<l;o++){var c=new s;c.init(i[o]),r[r.length]=c}r.sort(function(t,e){return t.getRank()-e.getRank()});var u={};u.myRank=a,u.rankList=r,td.EventUtil.dispatchEvent(td.EventNameEnum.PAGODA_RANK_UPDATED,u)}},t.prototype._requestPagodaSweep=function(){var t={};t.module=td.MsgModuleName.PAGODA,t.cmd=td.MsgCmd.PAGODA.PAGODA_SWEEP,this._sweepStartFloor=this._pagodaData.getCurFloor(),td.ServerDelegate.sendMessage(t)},t.prototype._onSweepReturn=function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager,n=td.ItemEnum,a=[],r=e.rewardList,o=this._sweepStartFloor;if(r&&r.length>0)for(var s=0,l=r.length;s<l;s++){var c=r[s],u={};u.floor=o+s,u.skyJade=0,u.gold=0,u.rewardList=[];for(var d=0,h=c.length;d<h;d++){var p=i.getRewardDetail(c[d]);p.getId()===n.SKY_JADE?u.skyJade+=p.getCount():p.getId()===n.Gold?u.gold+=p.getCount():u.rewardList[u.rewardList.length]=p}a[a.length]=u}this._sweepStartFloor=0,td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PAGODA_SWEEP,a)}},t=e=n([r],t)}();i.default=u,cc._RF.pop()},{"../../Shop/Manager/ShopEnum":"ShopEnum","../../Shop/Manager/ShopManager":"ShopManager",PagodaInfoModel:"PagodaInfoModel",PagodaRankModel:"PagodaRankModel"}],PagodaPointModel:[function(t,e,i){"use strict";cc._RF.push(e,"91c02/wnatKKq3zVKO4S0/5","PagodaPointModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("../Enum/PagodaEnum"),r=function(){function t(){this._state=a.MazePointState.DISABLED,this._wallInfo={},this._isStart=!1,this._isEnd=!1,this._reward=null,this._monster=null}return t.prototype.init=function(t){this._state=parseInt(t.state),this._pos=cc.v2(t.x,t.y),this._setWallData(t.closing),this._isStart=!1,this._isEnd=!1,this._reward=null,this._monster=null},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t.prototype.getPos=function(){return this._pos},t.prototype.isStartPoint=function(){return this._isStart},t.prototype.setIsStartPoint=function(){this._isStart=!0},t.prototype.isEndPoint=function(){return this._isEnd},t.prototype.setIsEndPoint=function(){this._isEnd=!0},t.prototype.getWallInfo=function(){return this._wallInfo},t.prototype.getRewardData=function(){return this._reward},t.prototype.getMonsterData=function(){return this._monster},t.prototype.haveReward=function(){return!!this._reward},t.prototype.haveMonster=function(){return!!this._monster},t.prototype.getReward=function(){return this._reward},t.prototype.getMonster=function(){return this._monster},t.prototype._setWallData=function(t){for(var e in a.PagodaWall){var i=parseInt(a.PagodaWall[e]);this._wallInfo[i]=(i&t)===i}},t.prototype.setRewardData=function(t){void 0===t&&(t=null),t?1===t?this._reward="GY0_baoxiang01":2===t?this._reward="GY0_baoxiang03":3===t&&(this._reward="GY0_baoxiang05"):this._reward=null},t.prototype.setMonsterData=function(t){if(void 0===t&&(t=null),t){var e=n.GetTableClass(n.TableEnum.MonsterGroup).getMonsterGroupById(t).groupLeader,i=n.GetTableClass(n.TableEnum.Monster).getMonsterDataById(e);this._monster=new n.MonsterModel,this._monster.init(i)}else this._monster=null},t}();e.exports=r,cc._RF.pop()},{"../Enum/PagodaEnum":"PagodaEnum"}],PagodaRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"0cdc9N+r15BZ7R6xP4HjZAe","PagodaRankModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._rank=0,e._star=0,e}return n(e,t),e.prototype.init=function(e){t.prototype.init.call(this,"PagodaRankModel",e.attributes),this._rank=e.rank||0,this._star=e.star||0},e.prototype.getRank=function(){return this._rank},e.prototype.getStar=function(){return this._star},e}(t("BaseUser")));e.exports=a,cc._RF.pop()},{BaseUser:"BaseUser"}],PanelJumpManager:[function(t,e,i){"use strict";cc._RF.push(e,"ef76fTX7wJA1ZsO4PRx2Z7D","PanelJumpManager");var n=c(t("../../Nation/Manager/NationMainManager")),a=c(t("../../Nation/Manager/NationBossManager")),r=c(t("../../CrossCup/Manager/CrossCupManager")),o=c(t("../../Nation/Manager/NationDuelManager")),s=c(t("../../Legend/Manager/LegendManager")),l=t("../../Legend/Enum/LegendEnum");function c(t){return t&&t.__esModule?t:{default:t}}td.PanelJumpManager={_destPanelName:null,_jumpData:null,_jumpToBackPanel:null,setDestination:function(t,e){this._destPanelName=t,this._jumpData=e},getDestination:function(){return this._destPanelName},clearDestination:function(){this._destPanelName=null,this._jumpData=null},jumpToLastDestination:function(){if(!this._destPanelName)return!1;this.jumpToPanel(this._destPanelName,this._jumpData)},haveDestination:function(){return null!==this._destPanelName},setJumpToBackPanel:function(t){this._jumpToBackPanel=t},isJumpToBackPanel:function(){return this._jumpToBackPanel},jumpToBackPanel:function(){if(!this._jumpToBackPanel)return!1;this._jumpToBackPanel=!1,td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PRE_PANEL)},jumpToPanel:function(t,e){var i=td.PanelManager.getInstance().getCurShowPanel(),n=td.PanelManager.getInstance().getCurShowWindow();if(i&&n&&i.getPanelEnum()===t&&t!==td.PanelEnum.Panel_ShopType1)n.closeCallFunc();else{if(this._destPanelName=t,!this.jumpToPanelLimit(t,e))return this._destPanelName=null,void(this._jumpData=null);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,{panelName:t,callback:{func:this._showPanelCallBack.bind(this),param:e}})}},jumpToPanelLimit:function(t,e){if(td.UnlockManager.isPanelUnlock(t,!0)){var i=!0,r=td.PanelEnum,c=null;switch(t){case r.Panel_NationDonationView:var u=n.default.getInstance().isJoinNation();u||(c=new td.BroadcastContent(63),i=!1);break;case r.Panel_ShopType1:td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Shop,e)||(c=new td.BroadcastContent(257),i=!1);break;case r.Window_PveCopyGate:if(e){var d=e;e.chapterId&&(d=e.chapterId);var h=td.PveGeneralCopyManager.getChapterDataByChapterId(d);h&&(td.PveGeneralCopyManager.getIsOpenByChapter(h)||(c=new td.BroadcastContent(193),i=!1))}break;case r.Panel_NationBoss:n.default.getInstance().isJoinNation()||(c=new td.BroadcastContent(63),i=!1),a.default.getInstance().isInChallengeTime()?td.UnlockManager.isTargetUnlock(td.ActorUnlockType.NATION_BOSS,0,!0)||(i=!1):(c=new td.BroadcastContent(284),i=!1);break;case r.Panel_NationTechMain:case r.Panel_NationDonationView:case r.Panel_GodFurnace:n.default.getInstance().isJoinNation()||(c=new td.BroadcastContent(63),i=!1);break;case r.Panel_NationCityWar:if(!n.default.getInstance().isJoinNation()){c=new td.BroadcastContent(63),i=!1;break}if(5==(p=td.TimeUtil.getServerDate().getDay())||6==p||0==p){c=new td.BroadcastContent(425),i=!1;break}break;case r.Panel_NationBeast:n.default.getInstance().isJoinNation()||(u||(c=new td.BroadcastContent(63)),i=!1);break;case r.Panel_NationDuel:if(!n.default.getInstance().isJoinNation()){c=new td.BroadcastContent(63),i=!1;break}var p,_=n.default.getInstance().getNationInfo(),g=o.default.getInstance().getCanJump(),f=td.GetConfig("NATION_DUEL_NATION_LEVEL_LIMIT");if(_.getLevel()<f){c=new td.BroadcastContent(417),i=!1;break}if((p=td.TimeUtil.getServerDate().getDay())>=1&&p<4){c=new td.BroadcastContent(426),i=!1;break}if(!g){c=new td.BroadcastContent(418),i=!1;break}break;case r.Panel_LegendMain:var v=s.default.getInstance().getSeason();if(v<=0||1==v&&s.default.getInstance().getState()==l.LEGEND_STATE.PREPARE){var m=new td.BroadcastContent(432);return void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,m)}break;case r.Panel_MazeMain:td.TimeUtil.isSunday()&&(td.GlobalFunction.showBroadcastTip(340),i=!1);break;case r.Panel_CrossArenaHome:if(0===td.TimeUtil.getServerDate().getDay()){m=new td.BroadcastContent(340);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,m),i=!1}}return c&&td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,c),i}},_showPanelCallBack:function(t,e){var i=td.PanelEnum;switch(this._destPanelName){case i.Window_PveGeneralChapter:var n={};"number"==typeof t?n.difficult=t:n=t,e.setData(n);break;case i.Panel_MagicTower:td.MagicTowerManager.setChallengeReturn();var a=td.MagicTowerManager.getCurMagicTowerType();e.setData(a);break;case i.Window_PveCopyGate:if(t){var o,s=t;t.chapterId&&(s=t.chapterId),t.gateId&&(o=t.gateId),e.setData(s?{chapterId:s,gateId:o}:null)}else e.setData();break;case i.Panel_Treasure_Bag:if("number"==typeof t){var l=t;(t={}).type=l,e.setData(t)}else e.setData(t);break;case i.Panel_CrossCup:if(t)e.setData(t);else{var c=r.default.getInstance().getShowTabIndex();e.setData(c)}break;default:e.setData&&e.setData(t)}this._destPanelName=null,this._jumpData=null}},cc._RF.pop()},{"../../CrossCup/Manager/CrossCupManager":"CrossCupManager","../../Legend/Enum/LegendEnum":"LegendEnum","../../Legend/Manager/LegendManager":"LegendManager","../../Nation/Manager/NationBossManager":"NationBossManager","../../Nation/Manager/NationDuelManager":"NationDuelManager","../../Nation/Manager/NationMainManager":"NationMainManager"}],PanelManager:[function(t,e,i){"use strict";cc._RF.push(e,"efc92JYB7pIq6aASonNpnu0","PanelManager");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../EvilGodCopy/Mananger/EvilGodManager"));td.PanelData=cc.Class({properties:{panelName:null,_panelData:null,_windowData:[],_cachePanelData:null,_lastShowData:null},init:function(t,e){this.panelName=t||0,this._panelData=e},getPanelEnum:function(){return this.panelName},setPanelEnum:function(t){this.panelName=t},getPanelData:function(){return this._panelData},setPanelData:function(t){this._panelData=t},pushWindowData:function(t){this._windowData[this._windowData.length]=t},getWindowQueue:function(){return this._windowData},setWindowQueue:function(t){this._windowData=t},popWindowData:function(){var t=this._windowData.length;if(0===t)return null;var e=this._windowData[t-1];return this._windowData.splice(t-1,1),e}});var a=cc.Class({extends:cc.Component,properties:{_panelLayer:null,_panelLayerOrder:1,_mainLayer:null,_mainLayerOrder:2,_windowLayer:null,_windowLayerOrder:4,_uiLayer:null,_uiPanelArray:null,_uiLayerOrder:998,_panelArray:null,_panelActiveTime:null,_loadingLayerNode:null,_isFirstEnterPveHook:null},onLoad:function(){this._uiPanelArray=[],this._panelArray={},this._isFirstEnterPveHook=!1;var t=cc.winSize,e=gdk.gui.layers.popupLayer.getChildByName("uiLayer");e?this._uiLayer=e:(this._uiLayer=new cc.Node,this._uiLayer.setName("uiLayer"),this._uiLayer.setContentSize(t),gdk.gui.layers.popupLayer.addChild(this._uiLayer,this._uiLayerOrder)),this.addCustomEventListener()},onDisable:function(){this.removeCustomEventListener()},addCustomEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum;t.registerEvent(e.SHOW_PANEL,this.showPanelByType,this),t.registerEvent(e.HIDE_PANEL,this._hidePanelByType,this),t.registerEvent(e.SHOW_PRE_PANEL,this._showPrePanel,this),t.registerEvent(e.ON_BACK_CALL,this._onBackCall,this)},removeCustomEventListener:function(){td.EventUtil.unregisterAllEvents(this)},showPanel:function(t,e){var i=t.getPanelEnum(),n=-1;this._panelLayer&&(n=this._panelLayer.getPanelEnum()),i!==n?(null!==this._panelLayer&&this._panelLayer.hide(),null!==this._windowLayer&&(i!==td.PanelEnum.Panel_PVE_FIGHT_HOOK||this._isFirstEnterPveHook?this._windowLayer.hide():this._isFirstEnterPveHook=!0),this.removeAllNonePanel(),this._panelLayer=t,this._panelLayer.node.zIndex=this._panelLayerOrder,this._panelLayer&&(i===td.PanelEnum.Panel_PVE_FIGHT||td.PanelEnum.Panel_PVE_FIGHT_HOOK,i===td.PanelEnum.Panel_HomePage&&this.clearShowPanelQueue(),i!==td.PanelEnum.Panel_NationAdd&&this.pushPanelData(i,td.PanelType.Panel,e))):t.hide()},clearShowPanelQueue:function(){cc.warn("show panel queue clear"),td.backDataList=[],this.pushPanelData(td.PanelEnum.Panel_PVE_FIGHT_HOOK,td.PanelType.Panel)},pushPanelData:function(t,e,i){var n=td.backDataList;if(e===td.PanelType.Panel){for(var a=-1,r=n.length-1;r>=0;r--){if(n[r].getPanelEnum()===t){a=r;break}}a>=0&&n.splice(a,n.length-a),(o=new td.PanelData).init(t,i),n[n.length]=o,cc.warn("push panel id = "+t)}else if(e===td.PanelType.Window){var o,s=n[n.length-1];if(!s)return;var l=s.getWindowQueue();for(a=-1,r=l.length-1;r>=0;r--){if(l[r].getPanelEnum()===t){a=r;break}}a>=0&&l.splice(a,l.length-a),(o=new td.PanelData).init(t,i),s.pushWindowData(o),cc.warn("push window id = "+t)}},hidePanel:function(t){var e=t.getPanelEnum();t===this._panelLayer&&null!==t?(t.close(),this._panelLayer=null):cc.log("this Panel visible is false or this panel is null.."),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_PANEL_COMPLETE,e)},showWindow:function(t,e){if(t!==this._windowLayer){var i=t._panelEnum;null!==this._windowLayer&&this._windowLayer.hide(),this.removeAllNonePanel(),this._windowLayer=t,this._windowLayer.node.zIndex=this._windowLayerOrder,this.pushPanelData(i,td.PanelType.Window,e)}},hideWindow:function(t){var e=t.getPanelEnum();t===this._windowLayer&&null!==t?(t.close(),this._windowLayer=null):cc.log("this window visible is false or this window is null.."),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_PANEL_COMPLETE,e)},releasePanel:function(t){delete this._panelArray[t]},addNonePanel:function(t,e){t.node.parent=this._uiLayer,t.node.zIndex=e||1,-1==this._uiPanelArray.indexOf(t)&&this._uiPanelArray.push(t)},removeNonePanel:function(t){if(this._uiPanelArray){var e=this._uiPanelArray.indexOf(t);-1!=e&&(this._uiPanelArray.splice(e,1),t.close())}},removeAllNonePanel:function(){for(var t=this._uiPanelArray.length-1;t>=0;t--)this.removeNonePanel(this._uiPanelArray[t])},_hidePanelByType:function(t){var e=t;this._panelLayer&&this._panelLayer._panelEnum==e?this._panelLayer.hide():this._windowLayer&&this._windowLayer._panelEnum==e?this._windowLayer.hide():cc.log("the Panel or the window not show!!")},showPanelByType:function(t){var e=this;if("number"==typeof t&&(cc.log("show_panel pass number will not support later!!!"),t={panelName:t}),this._lastShowData&&this._lastShowData.panelName===t.panelName)cc.error("twice called show panel "+t.panelName);else if(td.UnlockManager.isPanelUnlock(t.panelName,!0)){var i=gdk.PanelId.getValue(t.panelName);if(!cc.isValid(i))return td.DataReporter.onEvent("error showPanelByType "+t.panelName),void cc.error("=====> PanelId, \u6ca1\u6709\u5bf9\u5e94Id\u3010"+t.panelName+"\u3011");var a=this._panelLayer;if(t.panelName==td.PanelEnum.PanelMain&&(a=this._mainLayer),a&&a.getPanelEnum()===t.panelName){if(!t.callback||td.PanelEnum.Panel_ShopType1!==t.panelName&&td.PanelEnum.Panel_Activity!==t.panelName)return;var r=a.getPanelData()||null,o=t.callback.param||null;if(r instanceof Array&&o instanceof Array){if(r.length===o.length){for(var s=!0,l=0,c=r.length;l<c;l++)if(r[l]!==o[l]){s=!1;break}if(s)return}}else if(o===r)return;a.hide()}this._lastShowData=t,t.panelName!=td.PanelEnum.Panel_PVE_FIGHT&&t.panelName!==td.PanelEnum.Panel_PVE_FIGHT_HOOK||t.panelName===td.PanelEnum.Panel_PVE_FIGHT_HOOK&&td.PveCopyManager.prepareHookData();var u=td.TimeUtil.getTime();cc.log("showPanel begin time = "+td.TimeUtil.getTime()+" PanleEnum = "+t.panelName);var d={type:td.LoadingType.Panel,key:td.LoadingKey.Loading_Res,tips:td.LoadingTips.Loading_Res};td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_LOADING_LAYER,d),gdk.panel.open(i.__resId||t.panelName,function(i){if(i){i.show(),e._lastShowData=null;var a=t.callback;a&&a.func&&a.func(a.param,i),t.panelName==td.PanelEnum.PanelMain&&(i.node.zIndex=e._mainLayerOrder,e._mainLayer=i),i.getPanelEnum()!==td.PanelEnum.Panel_PVE_FIGHT_HOOK&&i.getPanelEnum()!==td.PanelEnum.Panel_HomePage||gdk.Timer.once(100,e,function(){td.EventUtil.dispatchEvent(td.EventNameEnum.ON_HOOK_OR_HOME_SHOWN,!0)}),i.getPanelType()===td.PanelType.Panel&&e._cachePanelData&&e._cachePanelData.panelName===td.PanelEnum.Panel_EvilGodMain&&t.panelName!==td.PanelEnum.Panel_EvilGodGateBoss&&(n.default.getInstance().setOpChapterId(0),n.default.getInstance().setOpGateId(0)),e._cachePanelData=t,td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_LOADING_LAYER,td.LoadingKey.Loading_Res),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PUSH_NEW_BB_MEET),cc.log("showPanel end time = "+td.TimeUtil.getTime()+" PanleEnum = "+t.panelName+"costTime "+(td.TimeUtil.getTime()-u))}else td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_LOADING_LAYER,td.LoadingKey.Loading_Res)},this)}},getPanelByType:function(t){var e=null;return void 0!==this._panelArray[t]?e=this._panelArray[t]:cc.log("NOT FOUNED panel,please create the panel at first."),e},getCurShowPanel:function(){return this._panelLayer},getCurShowWindow:function(){return this._windowLayer},getCurShowNoneLayer:function(){return this._uiPanelArray.length>0?this._uiPanelArray[this._uiPanelArray.length-1]:null},getCurWindowEnum:function(){if(cc.isValid(this._windowLayer)){var t=this._windowLayer.getComponent("PanelBase");return t?t.getPanelEnum():0}return 0},addMainLayer:function(t){this.removeMainLayer(),this._mainLayer=t,gdk.gui.layers.popupLayer.addChild(this._mainLayer,this._uiLayerOrder+1)},removeMainLayer:function(){this._mainLayer&&this._mainLayer.removeFromParent()},getMainLayer:function(){return this._mainLayer},getMainLayerComponent:function(){return this._mainLayer?this._mainLayer.getComponent("MainPanel"):null},delPanelData:function(t){for(var e=td.backDataList.length-1;e>=0;e--){if(td.backDataList[e].getPanelEnum()===t){td.backDataList.splice(e,1);break}}},popPanelData:function(){var t=td.backDataList.length;if(0===t)return null;var e=td.backDataList[t-1];return td.backDataList.splice(t-1,1),e},popLastSecondData:function(){var t=td.backDataList.length;if(t<2)return null;var e=td.backDataList[t-2];return td.backDataList.splice(t-2,2),e},popLastWindowData:function(){var t=td.backDataList.length;if(0===t)return null;var e=td.backDataList[t-1];return e?e.popWindowData():void 0},updatePanelData:function(t,e){for(var i=td.backDataList.length-1;i>=0;i--){var n=td.backDataList[i];if(!n)return;if(n.getPanelEnum()===t)return n.setPanelData(e),!0;for(var a=n.getWindowQueue()||[],r=a.length-1;r>=0;r--){var o=a[r];if(o&&o.getPanelEnum()===t)return o.setPanelData(e),!0}}return!1},_showPrePanel:function(){var t;if((this._panelLayer?this._panelLayer.getPanelEnum():null)===td.PanelEnum.Panel_NationAdd)var e=this.popPanelData();else{var i=td.backDataList[td.backDataList.length-1];if(i){i.getPanelEnum()<0&&(i=this.popPanelData());var n=i.popWindowData();if(n){if(!(t=i.popWindowData())){if(this._panelLayer)return;e=this.popPanelData(),t=e.popWindowData()}n.getPanelEnum()<0&&!this._panelLayer&&(e=i)}else{var a=this.popPanelData();this._panelLayer?(e=this.popPanelData())&&(t=e.popWindowData()):(e=a)&&(t=a.popWindowData())}}}if(e){var r=e.getPanelEnum();cc.warn("will show pre panel; id = "+r),td.PanelJumpManager.jumpToPanel(r,e.getPanelData())}if(t){if(e)var o=setTimeout(function(){td.PanelJumpManager.jumpToPanel(t.getPanelEnum(),t.getPanelData()),clearTimeout(o)},500);else td.PanelJumpManager.jumpToPanel(t.getPanelEnum(),t.getPanelData());cc.warn("will show pre window; id = "+t.getPanelEnum())}t||e||(td.GuideManager.isForceGuideFinshed()?td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,td.PanelEnum.Panel_HomePage):td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,td.PanelEnum.Panel_PVE_FIGHT_HOOK))},_onBackCall:function(){if(console.log("PanelManager _onBackCall "),gdk.scene.getSceneName()==td.SceneName.MainScene){var t=this._panelLayer?this._panelLayer.getPanelEnum():null,e=td.backDataList[td.backDataList.length-1];e&&e.getPanelEnum()<0&&(e=this.popPanelData());var i=e.popWindowData();if(t==td.PanelEnum.Panel_PVE_FIGHT)return;if(t==td.PanelEnum.Panel_HomePage)if(i)this._hidePanelByType(i.panelName);else{var n=new td.BroadcastContent(489);n.setOkCallFunc(function(){console.log(" ****** cc.game.end *******")}),n.setCancelCallFunc(function(){}),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,n)}else i?this._hidePanelByType(i.panelName):this._showPrePanel()}},_showPanel:function(t){if(cc.log("_showPanel  if log to much and to fast, call tree , game is gg !!!!!!! "),0!==t.length){var e=this;td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,{panelName:t[0].getPanelId(),callback:{func:function(t,i){td.PanelManager.getInstance().getPanelByType(i).setBackPanelData(t[0].getPanelData()),t.length>1&&(t.splice(0,1),e._showPanel(t))},param:t}})}},onPanelActive:function(t){this._panelActiveTime[t]=td.TimeUtil.getTime()},removePanelDataByPanelEnum:function(t){for(var e=td.backDataList,i=e.length-1;i>=0;i--){var n=e[i];if(!n)return;if(n.getPanelEnum()===t)return void td.backDataList.splice(i,1);for(var a=n.getWindowQueue()||[],r=a.length-1;r>=0;r--){var o=a[r];if(o&&o.getPanelEnum()===t)return a.splice(r,1),void n.setWindowQueue(a)}}}}),r={instance:null,getInstance:function(){return this.instance||(this.instance=new cc.Node,this.instance.addComponent(a)),this.instance.getComponent(a)},removeInstance:function(){this.instance&&(this.instance.removeFromParent(),this.instance.destroy(),this.instance=null)}};td.backDataList=[],td.PanelManager=r,cc._RF.pop()},{"../../EvilGodCopy/Mananger/EvilGodManager":"EvilGodManager"}],PartnershipManager:[function(t,e,i){"use strict";cc._RF.push(e,"e0855YeVPREAYrf1Gs4r3U/","PartnershipManager");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../Hero/Manager/HeroManager"));var a=t("Partnership");td.PartnershipManager={_partnershipList:null,_partnerPool:null,_isShowData:null,_oldParnerShip:null,_isShowing:null,init:function(){this._addEventListener(),this.destroyData()},destroyData:function(){this._partnershipList={},this._partnerPool={},this._isShowData=[],this._oldParnerShip={},this._isShowing=!1},_addEventListener:function(){var t=td.EventUtil,e={};e[td.EventNameEnum.INIT_PARTNERSHIP]=this._initPartnerShipData,t.registerEvents(e,this)},setShowStatus:function(t){this._isShowing=t},getShowStatus:function(){return this._isShowing},_initPartnerShipData:function(){this._partnershipList={};var t=td.GetTableClass(td.TableEnum.ReinforcementConfig).getPartnership();for(var e in t){var i=new a(t[e]);i.init(t[e]),this._partnershipList[i.getId()]=i}},getPartnershipById:function(t){return this._partnershipList[t]},getUnactivePartnerDatas:function(t,e){var i=this,n=[];return t.sort(function(t,e){return e-t}),t.forEach(function(t){var a=i.getPartnershipById(t);a.getTargetType()===e&&(a.isActive()||n.push(a))}),n},getShowPartnerData:function(t,e){var i=this,n=[],a=[];t.forEach(function(t){var r=i.getPartnershipById(t);r.getTargetType()===e&&(r.isActive()?n.push(t):a.push(t))});var r=0;return(n.length>0?n:a).forEach(function(t){r<=t&&(r=t)}),this.getPartnershipById(r)},getPartnershipByRoleType:function(t){for(var e in this._partnershipList)if(this._partnershipList[e].getTargetIds()==t)return this._partnershipList[e];return null},setPartnershipActivity:function(){this._isShowData=[];var t=td.BattleArrayManager.getBattleArrayData();if(t)for(var e in t){var i=t[e].getBattleHeroId();if(i){var n=this.updatePartnershipActivity(i,e);if(n&&n.length>0)for(var a=0;a<n.length;a++)this._isShowData.push(n[a])}}},setOldPartnershipActivity:function(){this._oldParnerShip={};var t=td.BattleArrayManager.getBattleArrayData();if(t)for(var e in t){var i=t[e].getBattleHeroId();if(i){var a=n.default.getInstance().getHeroBySId(i);if(a){var r=a.getRoleType();this._oldParnerShip[r]||(this._oldParnerShip[r]=[]);var o=this.updatePartnershipActivity(i,e);if(o.length>0)for(var s=0;s<o.length;s++)this._oldParnerShip[r].push(o[s].partnershipData.getId())}}}},getIsShowData:function(){return this._isShowData},clearIsShowData:function(){this._isShowData=[]},getIsRelationShipChange:function(){for(var t=this._relationShip||{},e={},i=td.GlobalFunction.copyList(this._isShowData),n=0,a=i.length;n<a;n++){var r=i[n],o=r.mercenary.getId(),s=r.partnershipData.getTargetIds()||[];e[o]=s}if(0===t.myLen())for(var l in e)t[l]=[];if(e.myLen()<=0)return!1;for(var c in t)if(!e[c]||e[c].sort().toString()!=t[c].sort().toString())return this._relationShip=e,!0;return this._relationShip=e,!1},checkShowPartnerShip:function(){this.getIsRelationShipChange()&&td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_PARTNERSHIP)},setRelationShip:function(){this._relationShip={};for(var t=td.GlobalFunction.copyList(this._isShowData),e=0,i=t.length;e<i;e++){var n=t[e],a=n.mercenary.getId(),r=n.partnershipData.getTargetIds();this._relationShip[a]=r}},updatePartnershipActivity:function(t,e){var i=n.default.getInstance().getHeroBySId(t);if(i){for(var a=[],r=i.getReinforcementIds(),o=0,s=r.length;o<s;++o){var l=r[o],c=this._partnershipList[l];if(c){for(var u=!0,d=c.getTargetIds(),h=0;h<d.length;h++){var p=d[h],_=c.getTargetType();if(_===td.GoodsType.Type_Mercenary){if(p==i.getId()){u=!1;break}u=td.BattleArrayManager.isExistMercenaryWithRoleType(p,null,null,!0,!0)}else _===td.GoodsType.Type_Equip?u=td.BattleArrayManager.isExistEquipWithEquipId(parseInt(e),p):_===td.GoodsType.Type_Treasure&&(u=td.BattleArrayManager.isTreasureWithTreasureId(parseInt(e),p));if(!u)break}var g=i.getRoleType();if(this._oldParnerShip&&this._oldParnerShip[g]&&-1!==this._oldParnerShip[g].indexOf(l))c.setActive(u);else if(c.setActive(u),c.isActive()){var f={};f.mercenary=i,f.partnershipData=c,a.push(f)}}}return a}cc.log("updatePartnershipActivity get mercenary error!! for sId = "+t)},resetPartnershipActivity:function(t){var e=n.default.getInstance().getHeroBySId(t);if(e){var i=e.getReinforcementIds();if(i&&0!==i.length)for(var a=0,r=i.length;a<r;++a){var o=i[a],s=this._partnershipList[o];s&&s.setActive(!1)}}else cc.log("resetPartnershipActivity get heroData error!! for sId = "+t)},addPartner:function(t){if(t)for(var e=t.getReinforcementIds(),i=0,n=e.length;i<n;++i){var a=e[i],r=this._partnershipList[a];if(r)for(var o=0,s=r.getTargetIds().length;o<s;++o){var l=r.getTargetIds()[o];this._addToPartnerPool(l)}}},removePartner:function(t){for(var e=t.getReinforcementIds(),i=0,n=e.length;i<n;++i){var a=e[i],r=this._partnershipList[a];if(r)for(var o=0,s=r.getTargetIds().length;o<s;++o){var l=r.getTargetIds()[o];this._removeFromPartnerPool(l)}}},_addToPartnerPool:function(t){this._partnerPool[t]?this._partnerPool[t]+=1:this._partnerPool[t]=1},_removeFromPartnerPool:function(t){this._partnerPool[t]?(this._partnerPool[t]-=1,0===this._partnerPool[t]&&delete this._partnerPool[t]):cc.log("remove from partner pool error for type ="+t)},isInPartnership:function(t){return!!(this._partnerPool[t]&&this._partnerPool[t]>0)},getNumOfPartnershipWithConfigId:function(t){var e=0,i=td.BattleArrayManager.getBattleArrayData();if(!i)return e;var a=this._partnershipList;for(var r in i){var o=i[r].getBattleHeroId(),s=n.default.getInstance().getHeroBySId(o);if(s)for(var l=s.getReinforcementIds(),c=0,u=l.length;c<u;++c){var d=a[l[c]];if(d)if(d.getTargetType()==td.GoodsType.Type_Mercenary){var h=d.getTargetIds();ArrayUtils.contains(h,t)&&(e+=1)}}}return e}},cc._RF.pop()},{"../../Hero/Manager/HeroManager":"HeroManager",Partnership:"Partnership"}],Partnership:[function(t,e,i){"use strict";cc._RF.push(e,"56d03MfMqZFpJmbPdwXuv+E","Partnership");var n=t("Model"),a=cc.Class({extends:n,properties:{_id:null,_name:null,_targetType:null,_targetIds:null,_effect:null,_description:null,_isActive:null,_isShowTips:null},init:function(t){this._super("Partnership"),this._id=t.id,this._name=t.helpname,this._targetIds=[];var e=t.roleTypes,i=t.equipmentIds,n=t.treasureIds;e.length>0?(this._targetIds=t.roleTypes,this._targetType=td.GoodsType.Type_Mercenary):i.length>0?(this._targetIds=t.equipmentIds,this._targetType=td.GoodsType.Type_Equip):n.length>0&&(this._targetIds=t.treasureIds,this._targetType=td.GoodsType.Type_Treasure),this._effect=t.effectTTPercent,this._description=t.des,this._isActive=!1,this._isShowTips=!1},getId:function(){return this._id},getName:function(){return this._name},getTargetIds:function(){return this._targetIds},getTargetType:function(){return this._targetType},getEffect:function(){return this._effect},getDescription:function(){return this._description},setActive:function(t){this._isShowTips=td.BattleArrayManager.getNeedShowPartnerShip()&&t&&this._isActive!==t,this._isActive=t},isActive:function(){return this._isActive},isShowTips:function(){return this._isShowTips}});e.exports=a,cc._RF.pop()},{Model:"Model"}],PetAptitudeTable:[function(t,e,i){"use strict";cc._RF.push(e,"ba480IHLTpLoKNavqy3YNlD","PetAptitudeTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PetAptitudeTable",e._tblName="pet_aptitude_config",e._data={},e}return n(e,t),e.prototype.init=function(){for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._data[e.quality]||(this._data[e.quality]={}),this._data[e.quality][e.aptitude]=e}},e.prototype.getData=function(t,e){return this._data[t]?this._data[t][e]:null},e.prototype.getMaxAptitude=function(t){var e=5;for(var i in this._data[t])e=Math.max(e,parseInt(i));return e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PetEggFragmentModel:[function(t,e,i){"use strict";cc._RF.push(e,"48a269Fu81J06nZkwJwQ5LA","PetEggFragmentModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._needCount=0,e._enough=!1,e._eggId=0,e._fragmentId=0,e._petName="",e}return n(e,t),e.prototype.init=function(t){this._itemData=t;for(var e=td.GetConfig("PET_EGG_SYNTHESIZE"),i=0;i<e.length;i++){var n=e[i];n[1][1]==t.getId()&&(this._eggId=n[0],this._fragmentId=n[1][1],this._needCount=n[1][2],this._enough=this._itemData.getCount()>=n[1][2])}},e.prototype.getItemData=function(){return this._itemData},e.prototype.getName=function(){return this._itemData._name},e.prototype.getNeedCount=function(){return this._needCount},e.prototype.getEnoughState=function(){return this._enough},e.prototype.getEggId=function(){return this._eggId},e.prototype.getFragmentId=function(){return this._fragmentId},e.prototype.getComposeCount=function(){return Math.floor(this._itemData.getCount()/this._needCount)},e}(t("Model"));i.default=a,cc._RF.pop()},{Model:"Model"}],PetEnum:[function(t,e,i){"use strict";cc._RF.push(e,"f6bc0LtWqdMFpAElP6eRoFO","PetEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.PET_POS_STATUS=i.PET_UP_TYPE=i.PET_VIP_STATUS=i.HATCH_STATUS=i.BUILD_TYPE=void 0,function(t){t[t.PETUP=0]="PETUP",t[t.HATCH=1]="HATCH",t[t.STATION=2]="STATION",t[t.MANUAL=3]="MANUAL",t[t.BAG=4]="BAG"}(i.BUILD_TYPE||(i.BUILD_TYPE={})),function(t){t[t.FREE=1]="FREE",t[t.HATCHING=2]="HATCHING",t[t.HATCHED=3]="HATCHED",t[t.LEVEL_LOCK=4]="LEVEL_LOCK",t[t.VIP_LOCK=5]="VIP_LOCK"}(i.HATCH_STATUS||(i.HATCH_STATUS={})),function(t){t[t.NOT_GET=1]="NOT_GET",t[t.NOT_RECEIVE=2]="NOT_RECEIVE",t[t.RECEIVED=3]="RECEIVED"}(i.PET_VIP_STATUS||(i.PET_VIP_STATUS={})),function(t){t[t.INFO=1]="INFO",t[t.LEVEL_UP=2]="LEVEL_UP",t[t.STAR_UP=3]="STAR_UP",t[t.REFINE=4]="REFINE"}(i.PET_UP_TYPE||(i.PET_UP_TYPE={})),function(t){t[t.LOCK=1]="LOCK",t[t.NOT_UP=2]="NOT_UP",t[t.UP=3]="UP"}(i.PET_POS_STATUS||(i.PET_POS_STATUS={})),cc._RF.pop()},{}],PetExchangeController:[function(t,e,i){"use strict";cc._RF.push(e,"44f79DCtjRMYqNqCZmMbH70","PetExchangeController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("./PetExchangeModel"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._convert=null,e._modelObj=null,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this.clearData()},e.prototype.clearData=function(){this._convert={},this._modelObj={}},e.prototype._initCfgs=function(){for(var t=td.GetTableClass(td.TableEnum.ActivityConvertConfig).getDatasOfDataId(this.getActivityData()),e=0,i=t.length;e<i;e++){var n=t[e],r=new a.default;r.initData(n);var o=r.getId();this._modelObj[o]=r}},e.prototype.activityParse=function(t){var e=t.record;for(var i in this._convert=e.convert||{},this._modelObj={},(!this._modelObj||Object.keys(this._modelObj).length<=0)&&this._initCfgs(),this._convert){var n=this._convert[i],a=this._modelObj[i];a?a.setUsedTimes(n):cc.error("=============> activity_convert_config \u8c8c\u4f3c\u6ca1\u6709\u914d\u7f6e\uff1a",i)}td.EventUtil.dispatchEvent(td.EventNameEnum.PET_EXCHANGE_GET_INFO)},e.prototype.getModelList=function(){(!this._modelObj||Object.keys(this._modelObj).length<=0)&&this._initCfgs();for(var t=Object.values(this._modelObj),e=[],i=td.Account.getUserData().getLevel(),n=0;n<t.length;n++){var a=t[n];i>=a.getShowLv()&&e.push(a)}return e},e.prototype.getModelById=function(t){return this._modelObj[t]},e.prototype.getExchageTimesById=function(t){return this._convert[t]||0},e.prototype.hasRedPoint=function(){return!0},e.prototype.isExchangeEnable=function(){for(var t=this.getModelList(),e=0;e<t.length;e++){var i=t[e];if(i.getLeftTimes()>0&&i.isExchangeEnable())return!0}return!1},e.prototype.redPointEvts=function(){return t.prototype.redPointEvts.call(this),[td.EventNameEnum.ITEM_CHANGE]},e.prototype.isRedPointTip=function(){return this.isExchangeEnable()},e}(t("ActivityBaseController"));i.default=r,e.exports=r,cc._RF.pop()},{"./PetExchangeModel":"PetExchangeModel",ActivityBaseController:"ActivityBaseController"}],PetExchangeItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"12c7e07ZUdIM7xpU3yOps+l","PetExchangeItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgSoldOut=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.getId();this._itemId=n;var a=i.getTimes(),r=i.getLeftTimes();this.node.getChildByName("exchangeCount").getComponent(cc.Label).string=r+"/"+a;var o=this.node.getChildByName("contentNode"),s=o.getChildByName("costNode"),l=i.getCost(),u=this.node.getChildByName("wordItem"),d=s.getChildrenCount(),h=!0;this._canBuyMaxCount=r;for(var p="",_=0,g=l.length;_<g;_++){var f=l[_];if(I=s.getChildByName("cost"+(_+1))){(v=I.getChildByName("icon").getComponent("CommonIconWidget")).setData(f)}else{I=cc.instantiate(u);var v=c.GlobalFunction.createCommonIconWidget(1,f);I.setName("cost"+(_+1)),s.addChild(I),I.addChild(v),v.setName("icon"),I.setScale(.6)}I.active=!0,p+=f.getName(),_!=g-1&&(p+="\u3001");var m=I.getChildByName("icon"),y=c.ItemManager.getItemNumById(f.getId()),E=f.getCount();(R=I.getChildByName("richText")).active=!0,R.getComponent(cc.RichText).string=y>=E?cc.js.formatStr("<size=32><color=#05BB09>%s</c><color=#AD6201>/%s</color></size>",y,E):cc.js.formatStr("<size=32><color=#FF0000>%s</c><color=#AD6201>/%s</color></size>",y,E),this._canBuyMaxCount=Math.min(this._canBuyMaxCount,Math.floor(y/E)),c.GlobalFunction.graySprite(m,y<E),h&&y<E&&(h=!1)}for(;_<d;_++){(I=s.getChildByName("cost"+(_+1)))&&I.removeFromParent()}s.setContentSize(cc.size(g*u.width,u.height)),s.getComponent(cc.Layout).updateLayout(),this.node.getChildByName("titleNode").getChildByName("label2").getComponent(cc.Label).string=cc.js.formatStr("\u3010%s\u3011",p);var T=o.getChildByName("rewardNode"),C=i.getRewards();for(d=T.getChildrenCount(),_=0,g=C.length;_<g;_++){var R,S=C[_];if(I=T.getChildByName("reward"+(_+1))){(v=(m=I.getChildByName("icon")).getComponent("CommonIconWidget")).setData(S)}else{I=cc.instantiate(u);var v=c.GlobalFunction.createCommonIconWidget(26,S);I.setName("reward"+(_+1)),T.addChild(I),I.addChild(v),v.setName("icon"),I.setScale(.6)}I.active=!0,(R=I.getChildByName("richText")).active=!1}for(;_<d;_++){var I;(I=s.getChildByName("reward"+(_+1)))&&I.removeFromParent()}T.setContentSize(cc.size(g*u.width,u.height)),T.getComponent(cc.Layout).updateLayout();var A=this.node.getChildByName("btnGoto");c.GlobalFunction.setButtonGray(A,!h||r<=0),this._itemData=C[0],A.active=r>0,this.imgSoldOut.active=!A.active},e.prototype.onClickBtnGoto=function(){var t=this._canBuyMaxCount,e={};e.item=this._itemData,e.max=t,e.id=this._itemId,e.activityType=c.ActivityEnum.ActivityType.PetExchange,c.PanelJumpManager.jumpToPanel(c.PanelEnum.Window_CollectWordExchange,e)},a([s(cc.Node)],e.prototype,"imgSoldOut",void 0),e=a([o,l("module/Activity/PetExchangeItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],PetExchangeModel:[function(t,e,i){"use strict";cc._RF.push(e,"17beb8I24dGL6clEAtA+u5J","PetExchangeModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._id=null,this._data=null,this._times=null,this._showLevel=0,this._cost=null,this._reward=null,this._usedTimes=0,this._canExchange=!1}return t.prototype.initData=function(t){this._data=t.data,this._id=t.id,this._times=t.times,this._showLevel=t.showLevel,this._cost=td.RewardManager.parseRewardListDetail(t.cost),this._reward=td.RewardManager.parseRewardListDetail(t.reward)},t.prototype.getId=function(){return this._id},t.prototype.getData=function(){return this._data},t.prototype.getCost=function(){return this._cost},t.prototype.getTimes=function(){return this._times},t.prototype.getRewards=function(){return this._reward},t.prototype.getShowLv=function(){return this._showLevel},t.prototype.getUsedTimes=function(){return this._usedTimes},t.prototype.setUsedTimes=function(t){this._usedTimes=t},t.prototype.getLeftTimes=function(){return 0==this._times?99:this._times-this._usedTimes},t.prototype.isExchangeEnable=function(){for(var t=this._cost,e=0,i=t.length;e<i;e++){var n=t[e];if(td.ItemManager.getItemNumById(n.getId())<n.getCount())return!1}return!0},t}();i.default=n,cc._RF.pop()},{}],PetExchangePanel:[function(t,e,i){"use strict";cc._RF.push(e,"0f62axGcI5MV7YPGKcU/950","PetExchangePanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.activityTimeLabel=null,e._listView=null,e._activityType=0,e._activityId=0,e._controller=null,e}return n(e,t),e.prototype.init=function(){this._panelType=c.PanelType.Panel,this._panelEnum=c.PanelEnum.Panel_Monopoly},e.prototype.initData=function(e){t.prototype.initData.call(this,e),this._activityId=e,this._controller=c.ActivityDataManager.getActivityControllerById(e),this._activityType=this._controller.getActivityType()},e.prototype.onLoad=function(){var t=this.node.getChildByName("scrollView");this._listView=t.getComponent("OptimizeVerticalListView")},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addLocalListeners(),this._firstEnter=!0,gdk.Timer.once(50,this,this._refreshList)},e.prototype.onDisable=function(){gdk.Timer.clearAll(this),c.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addLocalListeners=function(){var t={};t[c.EventNameEnum.PET_EXCHANGE_GET_INFO]=this._refreshList,c.EventUtil.registerEvents(t,this)},e.prototype._refreshList=function(){if(this._controller){this.activityTimeLabel.string=this.getDurationStr();var t=this._controller.getModelList();this._firstEnter?this._listView.setData(t):this._listView.refreshCurList(t),this._firstEnter=!1}},e.prototype.scrollSV=function(t,e){var i=t.node.getComponent("OptimizeVerticalListView").getItemSize().height,n=t.getScrollOffset();this.firstIndex=Math.floor(n.y/i)},a([s(cc.Label)],e.prototype,"activityTimeLabel",void 0),e=a([o,l("module/Activity/PetExchangePanel")],e)}(t("ActivityBasePanel"));i.default=u,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],PetFightModel:[function(t,e,i){"use strict";cc._RF.push(e,"703b181KotLMpTtQKajeEyI","PetFightModel");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../../TS/Pet/Model/PetModel"));var a=t("Model");td.PetFightModel=cc.Class({extends:a,properties:{_baseModel:null,_camp:null,_pos:null,_hp:null,_maxHp:null,_rage:null,_maxRage:null,_curCamp:null},init:function(t){if(t){var e=t.attributes,i=e[td.SpriteKey.ConfigId],a=td.GetTableClass(td.TableEnum.PetTable).getPetById(i);this._baseModel=new n.default,this._baseModel.init(a),this._baseModel.setSId(e[td.SpriteKey.Sid]),this._camp=e[td.SpriteKey.Camp],this._pos=Math.abs(e[td.SpriteKey.Position])+6,this._hp=e[td.SpriteKey.HP]||0,this._maxHp=e[td.SpriteKey.MaxHp]||0,this._rage=e[td.SpriteKey.RAGE]||0,this._maxRage=e[td.SpriteKey.MaxRage]||0,this._curCamp=e[td.SpriteKey.HERO_CAMP]||0}},getBaseModel:function(){return this._baseModel},getSId:function(){return this._baseModel.getSId()},getRoleType:function(){return this._baseModel.getRoleType()},getModelShowType:function(){return this._baseModel.getModelShowType()},getAnimationIndex:function(){return this._baseModel.getAnimationIndex()},getAnimationRes:function(){return this._baseModel.getAnimationRes()},getPos:function(){return this._pos},getCamp:function(){return this._camp},getCurCamp:function(){return this._curCamp},getHp:function(){return this._hp},setHp:function(t){t=Math.min(t,this._maxHp),this._hp=t},getMaxHp:function(){return this._maxHp},getRage:function(){return this._rage},setRage:function(t){return this._rage=Math.min(t,this._maxRage)},getMaxRage:function(){return this._maxRage},getScale:function(){return this._baseModel.getScale()}}),cc._RF.pop()},{"../../../../TS/Pet/Model/PetModel":"PetModel",Model:"Model"}],PetFragmentModel:[function(t,e,i){"use strict";cc._RF.push(e,"59ccfFt0PpJ0KzVqQ7Ne6pF","PetFragmentModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._needCount=0,e._aptidude=0,e._enough=!1,e._features=0,e._petConfigId=0,e._fragmentId=0,e._quality=0,e._petName="",e}return n(e,t),e.prototype.init=function(t){this._itemData=t;var e=td.GetTableClass(td.TableEnum.PetTable).getPetByFragmentId(this._itemData.getId());e&&(this._needCount=e.fragmentCount,this._features=e.features,this._petConfigId=e.id,this._fragmentId=e.fragmentId,this._quality=e.quality,this._petName=e.name,this._enough=this._itemData.getCount()>=this._needCount)},e.prototype.getItemData=function(){return this._itemData},e.prototype.getName=function(){return this._itemData._name},e.prototype.getNeedCount=function(){return this._needCount},e.prototype.getQuality=function(){return this._quality},e.prototype.getEnoughState=function(){return this._enough},e.prototype.getFeatures=function(){return this._features},e.prototype.getPetConfigId=function(){return this._petConfigId},e.prototype.getPetName=function(){return this._petName},e.prototype.getFragmentId=function(){return this._fragmentId},e.prototype.getComposeCount=function(){return Math.floor(this._itemData.getCount()/this._needCount)},e}(t("Model"));i.default=a,cc._RF.pop()},{Model:"Model"}],PetLevelUpTable:[function(t,e,i){"use strict";cc._RF.push(e,"aa062XsZqtFc6VLV6437ufN","PetLevelUpTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PetLevelConfig",e._tblName="pet_level_config",e._data={},e}return n(e,t),e.prototype.init=function(){for(var t=0,e=this._jsonData.length;t<e;++t){var i=this._jsonData[t];this._data[i.id]||(this._data[i.id]={}),this._data[i.id][i.level]=i}},e.prototype.getData=function(t,e){return this._data[t]&&this._data[t][e]?this._data[t][e]:null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PetManager:[function(t,e,i){"use strict";cc._RF.push(e,"f81c473ShtDIpD4aeF1A2+g","PetManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Enum/PetEnum"),a=t("../Model/PetFragmentModel"),r=t("../Model/PetModel"),o=window.td,s=function(){function t(){this._stationLevel=0,this._hatchMap={},this._petMap={}}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this._addServerListener(),this._addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._stationLevel=0,this._hatchMap={},this._petMap={}},t.prototype._addServerListener=function(){var t=o.MsgModuleName.PET,e=o.MsgCmd.PET;o.ServerDelegate.registerMessage(t,e.GET_PET_INFO,this._parsePetResponse.bind(this)),o.ServerDelegate.registerMessage(t,e.GET_STATION_INFO,this._parseStationResponse.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_DELETE_PET,this._parseDeletePetInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_PET,this._parsePetResponse.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_STATION,this._parseStationResponse.bind(this)),o.ServerDelegate.registerMessage(t,e.COMPOSE_PET,this._parseComposePetResponse.bind(this)),o.ServerDelegate.registerMessage(t,e.COMPOSE_EGG,this._parseComposeEggResponse.bind(this)),o.ServerDelegate.registerMessage(t,e.UP_LEVEL,this._onLevelUpSuc.bind(this)),o.ServerDelegate.registerMessage(t,e.UP_STAR,this._onStarUpSuc.bind(this)),o.ServerDelegate.registerMessage(t,e.STATION_UP_LEVEL,this._onStationLevelUpSuc.bind(this)),o.ServerDelegate.registerMessage(t,e.UP_REFINE,this._onRefineSuc.bind(this)),o.ServerDelegate.registerMessage(t,e.GET_GRADE,this._onRefineChangeSuc.bind(this)),o.ServerDelegate.registerMessage(t,e.CANCEL_GRADE,this._onRefineSaveSuc.bind(this)),o.ServerDelegate.registerMessage(t,e.HATCH_EGG,this._onBeginHatchSuc.bind(this)),o.ServerDelegate.registerMessage(t,e.QUICK_HATCH,this._onQuickHatchSuc.bind(this)),o.ServerDelegate.registerMessage(t,e.RECEIVE_PET,this._onReceiveHatchSuc.bind(this))},t.prototype._parsePetResponse=function(t,e){if(t==o.NetCode.SUCCESS)for(var i=e.pets,n=0;n<i.length;n++){var a=i[n],s=parseInt(a.petId),l=this.getPetBySId(s);if(null==l){l=new r.default,this._petMap[s]=l;var c=o.GetTableClass(o.TableEnum.PetTable).getPetById(a.configId);l.init(c),l.getStationLevel()!=this._stationLevel&&l.setStationLevel(this._stationLevel)}l.setData(a)}},t.prototype._parseDeletePetInfo=function(t,e){if(t==o.NetCode.SUCCESS)for(var i=e.ids,n=0;n<i.length;n++){var a=parseInt(i[n]);this._petMap[a]=null,delete this._petMap[a]}},t.prototype._parseStationResponse=function(t,e){if(t==o.NetCode.SUCCESS){if(e.level&&e.level!=this._stationLevel){for(var i in this._stationLevel=e.level,this._petMap){var n=this._petMap[i];n&&n.setStationLevel(this._stationLevel)}o.EventUtil.dispatchEvent(o.EventNameEnum.PET_REFRESH_HATCH_EGG,2)}var a=cc.instantiate(this._hatchMap);for(var i in e.incubators){var r=e.incubators[i],s=parseInt(i);this._hatchMap[s]=r;var l=a[s];l&&l.id==r.id&&l.goodsId==r.goodsId&&l.expirationTime==r.expirationTime||o.EventUtil.dispatchEvent(o.EventNameEnum.PET_REFRESH_HATCH_EGG,s)}}},t.prototype._onRefineSuc=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.PET_REFINE_SUC)},t.prototype._onRefineChangeSuc=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.PET_REFINE_CHANGE_SUC)},t.prototype._onRefineSaveSuc=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.PET_REFINE_SAVE_SUC)},t.prototype._parseComposePetResponse=function(t,e){if(t===o.NetCode.SUCCESS){var i=o.RewardManager.parseRewardResult(e.rewardResult,!0);o.GlobalFunction.showRewards(i),o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_PET_ACTIVE_TIP),o.EventUtil.dispatchEvent(o.EventNameEnum.PET_REFRESH_BAG),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_PET_COMPOSE_SUCC)}},t.prototype._parseComposeEggResponse=function(t,e){if(t===o.NetCode.SUCCESS){var i=o.RewardManager.parseRewardResult(e.rewardResult,!0);o.GlobalFunction.showRewards(i),o.EventUtil.dispatchEvent(o.EventNameEnum.PET_REFRESH_BAG),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_PET_EGG_COMPOSE_SUCC)}},t.prototype._onBeginHatchSuc=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.PET_EGG_SELECT_SUC)},t.prototype._onQuickHatchSuc=function(t,e){o.NetCode.SUCCESS},t.prototype._onReceiveHatchSuc=function(t,e){if(t===o.NetCode.SUCCESS){var i=[];for(var n in e.rewardResult.petMap){var a=this.getPetBySId(parseInt(n));i.push(a)}o.EventUtil.dispatchEvent(o.EventNameEnum.RES_PET_GET_SUCC,i[0]),o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_PET_ACTIVE_TIP)}},t.prototype._onLevelUpSuc=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.PET_LEVEL_UP_SUC)},t.prototype._onStarUpSuc=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.PET_STAR_UP_SUC)},t.prototype._onStationLevelUpSuc=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.PET_STATION_LEVEL_UP_SUC)},t.prototype._addEventListener=function(){var t=o.EventNameEnum,e={};e[t.PET_GET_INFO]=this._requestPetInfo,e[t.PET_GET_STATION_INFO]=this._requestPetStationInfo,e[t.PET_STATION_LEVEL_UP]=this._stationLevelUp,e[t.PET_COMPOSE]=this._composePet,e[t.PET_EGG_COMPOSE]=this._composeEgg,e[t.PET_EGG_HATCH]=this._hatchEgg,e[t.PET_EGG_GET_PET]=this._getPetFromEgg,e[t.PET_EGG_HATCH_ACC]=this._accHatchEgg,e[t.PET_LEVEL_UP]=this._petLevelUp,e[t.PET_STAR_UP]=this._petStarUp,e[t.PET_REFINE]=this._petRefine,e[t.PET_REFINE_SAVE]=this._petRefineSave,e[t.PET_REFINE_CHANGE]=this._petRefineChange,o.EventUtil.registerEvents(e,this)},t.prototype._requestPetInfo=function(){if(o.UnlockManager.isTargetUnlock(o.ActorUnlockType.PET,0,!1)){var t={};t.module=o.MsgModuleName.PET,t.cmd=o.MsgCmd.PET.GET_PET_INFO,o.ServerDelegate.sendMessage(t)}},t.prototype._requestPetStationInfo=function(){if(o.UnlockManager.isTargetUnlock(o.ActorUnlockType.PET,0,!1)){var t={};t.module=o.MsgModuleName.PET,t.cmd=o.MsgCmd.PET.GET_STATION_INFO,o.ServerDelegate.sendMessage(t)}},t.prototype._petRefine=function(t){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.UP_REFINE,id:t})},t.prototype._petRefineSave=function(t){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.CANCEL_GRADE,id:t})},t.prototype._petRefineChange=function(t){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.GET_GRADE,id:t})},t.prototype._stationLevelUp=function(){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.STATION_UP_LEVEL})},t.prototype._composePet=function(t){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.COMPOSE_PET,configId:t.configId,count:t.count})},t.prototype._composeEgg=function(t){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.COMPOSE_EGG,configId:t.configId,count:t.count})},t.prototype._hatchEgg=function(t){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.HATCH_EGG,id:t.hatchIdx,goodsId:t.goodsId})},t.prototype._getPetFromEgg=function(t){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.RECEIVE_PET,id:t.hatchIdx})},t.prototype._accHatchEgg=function(t){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.QUICK_HATCH,id:t.hatchIdx})},t.prototype.getStationLevel=function(){return this._stationLevel},t.prototype.getHatchMap=function(){return this._hatchMap},t.prototype.getHatchById=function(t){return this._hatchMap[t]?this._hatchMap[t]:null},t.prototype.getPetBySId=function(t){return this._petMap[t]?this._petMap[t]:null},t.prototype.showRedPoint=function(){var t=!1;if(o.UnlockManager.isTargetUnlock(o.ActorUnlockType.PET,0,!1))for(var e=0;e<5;e++)if(this.isShowPetMainRedPoint(e)){t=!0;break}return t},t.prototype.redPointEvents=function(){var t=o.EventNameEnum;return[t.PET_GET_INFO,t.PET_GET_STATION_INFO,t.PET_STATION_LEVEL_UP,t.PET_COMPOSE,t.PET_EGG_COMPOSE,t.PET_EGG_HATCH,t.PET_EGG_GET_PET,t.PET_EGG_HATCH_ACC,t.PET_LEVEL_UP,t.PET_STAR_UP,t.PET_REFINE,t.PET_REFINE_SAVE,t.PET_REFINE_CHANGE]},t.prototype.isShowPetMainRedPoint=function(t){var e=!0;switch(t){case n.BUILD_TYPE.PETUP:e=this.isShowPetUpRedPoint();break;case n.BUILD_TYPE.HATCH:e=this.isShowHatchRedPoint();break;case n.BUILD_TYPE.STATION:e=this.isShowPetStationRedPoint();break;case n.BUILD_TYPE.MANUAL:e=!1;break;case n.BUILD_TYPE.BAG:e=this.isShowBagRedPoint()}return e},t.prototype.isShowPetUpRedPoint=function(){var t=!1,e=o.BattleArrayManager.getPetLineupMap();if(e.myLen()<=0)return o.UnlockManager.isTargetUnlock(o.ActorUnlockType.PET,0,!1)&&this.getPetArray(!0,!1).length>0&&(t=!0),t;for(var i in e){var n=e[i].getSId();if(t=this.canLevelUp(n))return t;if(t=this.canStarUp(n))return t;if(t=this.canRefine(n))return t}},t.prototype.isShowPetStationRedPoint=function(){var t=!0,e=o.GetTableClass(o.TableEnum.PetStationTable);if(this._stationLevel>=e.getMaxLevel())t=!1;else for(var i=e.getStationInfo(this._stationLevel),n=0;n<i.cost.length;n++){var a=i.cost[n];if(o.ItemManager.getItemNumById(a[1])<a[2]){t=!1;break}}return t},t.prototype.isShowHatchRedPoint=function(){for(var t=!1,e=1;e<=3;e++)if(this.getHatchStatus(e)==n.HATCH_STATUS.HATCHED||this.isHaveEgg()&&this.getHatchStatus(e)==n.HATCH_STATUS.FREE){t=!0;break}return t||(t=this.isShowPetVipCardRedPoint()),t},t.prototype.isHaveEgg=function(){for(var t={1:o.ItemEnum.Purple_Egg,2:o.ItemEnum.Orange_Egg,3:o.ItemEnum.Red_Egg},e=o.ItemManager.getItemsDatasByGoodsSubType(o.GoodsSubType.PET_EGG),i=1;i<=3;i++){var n=t[i];if((e[n]?e[n].getCount():0)>0)return!0}return!1},t.prototype.isShowBagRedPoint=function(){var t=!1,e=o.ItemManager.getItemsDatasByGoodsSubType(o.GoodsSubType.PET_FRAGMENT);for(var i in e){var n=e[i],r=new a.default;if(r.init(n),r.getEnoughState()){t=!0;break}}return t},t.prototype.getHatchStatus=function(t){var e,i=this.getHatchById(t),a=o.TimeUtil.getTime(),r=o.UnlockManager.isTargetUnlock(o.ActorUnlockType.PET_HATCH_STATUS,t);return i&&0!=i.goodsId?e=i.expirationTime<=a?n.HATCH_STATUS.HATCHED:n.HATCH_STATUS.HATCHING:r?e=n.HATCH_STATUS.FREE:2==t?e=n.HATCH_STATUS.LEVEL_LOCK:3==t&&(e=n.HATCH_STATUS.VIP_LOCK),e},t.prototype.getPetArray=function(t,e,i,n){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===i&&(i=0),void 0===n&&(n=0);var a=[];for(var r in this._petMap){var o=this._petMap[r];o&&(t&&o.isEquipped()||e&&(1!=o.getLevel()||0!=o.getStarLevel())||0!=i&&o.getId()!=i||0!=n&&o.getSId()==n||a.push(o))}return a.sort(function(t,e){return t.getQuality()!=e.getQuality()?e.getQuality()-t.getQuality():t.getAptitude()!=e.getAptitude()?e.getAptitude()-t.getAptitude():t.getStarLevel()!=e.getStarLevel()?e.getStarLevel()-t.getStarLevel():t.getLevel()!=e.getLevel()?e.getLevel()-t.getLevel():Math.random()-.5}),a},t.prototype.getHideArray=function(){var t=[],e=[];for(var i in this._petMap){var n=this._petMap[i];n&&(n.isEquipped()&&e.push(n.getId()))}for(var i in this._petMap){var a=this._petMap[i];if(a){for(var r=a.getId(),o=!0,s=0;s<e.length;s++)if(r==e[s]){o=!1;break}o&&t.push(a)}}return t},t.prototype.getPetNumById=function(t){var e=0;for(var i in this._petMap){var n=this._petMap[i];n&&(n.getId()==t&&(e+=1))}return e},t.prototype.getPetLevelLimit=function(){return o.GetTableClass(o.TableEnum.PetStationTable).getStationInfo(this._stationLevel).levelLimit},t.prototype.getPetLineupLimit=function(){return o.GetTableClass(o.TableEnum.PetStationTable).getStationInfo(this._stationLevel).countLimit},t.prototype.isUnlockPos=function(t){return o.UnlockManager.isTargetUnlock(o.ActorUnlockType.PET_BATTLE_POS,t,!0)},t.prototype.canLevelUp=function(t){var e=this.getPetBySId(t);if(e.isFullLevel())return!1;if(e.getLevel()>=this.getPetLevelLimit())return!1;for(var i=e.getCurLevelCfg().cost,n=0;n<i.length;n++){var a=i[n];if(o.ItemManager.getItemNumById(a[1])<a[2])return!1}return!0},t.prototype.canStarUp=function(t){var e=this.getPetBySId(t);if(e.isFullStarLevel())return!1;if(this.getPetArray(!0,!0,e.getId(),t).length<e.getCurStarLevelCfg().devourCount)return!1;for(var i=e.getCurStarLevelCfg().cost,n=0;n<i.length;n++){var a=i[n];if(o.ItemManager.getItemNumById(a[1])<a[2])return!1}return!0},t.prototype.canRefine=function(t){for(var e=o.GetConfig("PET_REFRESH_APTITUDE_COST"),i=0;i<e.length;i++){var n=e[i];if(o.ItemManager.getItemNumById(n[1])<n[2])return!1}return!0},t.prototype.getPetVipCardStatus=function(){var t=o.Account.getUserData().getVipCard(o.VipCardType.PET_VIP_CARD),e=o.GetTableClass(o.TableEnum.TaskTable),i=o.TaskManager.getTaskById(e.getTaskByType(o.TaskType.PET_VIP_CARD)[0].taskId);return t?i.getStatus()==o.TaskStatus.Received?n.PET_VIP_STATUS.RECEIVED:n.PET_VIP_STATUS.NOT_RECEIVE:n.PET_VIP_STATUS.NOT_GET},t.prototype.isShowPetVipCardRedPoint=function(){return this.getPetVipCardStatus()==n.PET_VIP_STATUS.NOT_RECEIVE},t.prototype.isConfirmRefine=function(t){return this.getPetBySId(t).getTempAptitude().myLen()>0},t.prototype._petLevelUp=function(t){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.UP_LEVEL,id:t})},t.prototype._petStarUp=function(t){o.ServerDelegate.sendMessage({module:o.MsgModuleName.PET,cmd:o.MsgCmd.PET.UP_STAR,id:t.sId,devourIds:t.devourIds})},t.prototype.isUnlock=function(){return!0},t.prototype.getPetByQuality=function(t){for(var e=[],i=this.getPetArray(!0,!0,0,0),n=0;n<i.length;n++){var a=i[n];a.getQuality()==t&&e.push(a)}return e},t.prototype.getPetByFragmentId=function(t){var e=o.GetTableClass(o.TableEnum.PetTable).getPetByFragmentId(t);if(e){var i=new r.default;return i.init(e),i}return null},t.prototype.getPetListForRebirth=function(){for(var t=[],e=this.getPetArray(!0,!1),i=0;i<e.length;i++){var n=e[i];(n.getLevel()>1||n.getStarLevel()>0)&&t.push(n)}return t},t.prototype.getPetLineup=function(){var t={};for(var e in this._petMap){var i=this._petMap[e];i.isEquipped()&&(t[i.getOrderId()]=i)}return t},t.prototype.getPetTotalAttr=function(){var t=this.getPetLineup(),e={};for(var i in t){var n=t[i].getTotalPetAttr();for(var a in n){var r=n[a];e[a]?e[a]+=r:e[a]=r}}for(var s in e){r=e[s];e[s]=Math.ceil(r*o.GetConfig("PET_ATTRIBUTE_COEFFICIENT")/1e4)}return e},t}();i.default=s,cc._RF.pop()},{"../Enum/PetEnum":"PetEnum","../Model/PetFragmentModel":"PetFragmentModel","../Model/PetModel":"PetModel"}],PetManualTable:[function(t,e,i){"use strict";cc._RF.push(e,"506f6rFk5VCuaszRZA8Jpkz","PetManualTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PetManualTable",e._tblName="pet_manual_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getAllData=function(){return this._data},e.prototype.getDataByPetId=function(t){for(var e in this._data)for(var i=this._data[e].pets,n=0;n<i.length;n++)if(i[n]===t)return this._data[e];return null},e.prototype.getBondageByPetId=function(t){var e=this.getDataByPetId(t);if(!e||e.pets.length<2)return 0;for(var i=0;i<e.pets.length;i++){var n=e.pets[i];if(t!=n)return n}},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PetModel:[function(t,e,i){"use strict";cc._RF.push(e,"6920fcZTeNOSIPnR8OJmDCY","PetModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._sId=0,e._level=0,e._starLevel=0,e._quality=0,e._aptitude=0,e._aptitudeMap={1:0,2:0,3:0,4:0},e._tempAptitude=0,e._tempAptitudeMap={},e._luck=0,e._sortId=0,e._fragmentId=0,e._fragmentCount=0,e._pveSkillId=0,e._pvpSkillId=0,e._skillLv=0,e._avatarId=0,e._showId=0,e._features=0,e._maxStar=0,e._maxLevel=0,e._spriteAnimationRes=null,e._animationOffset={},e._pveIdleRes="",e._pvpIdleRes="",e._pveAttack="",e._shadowScale=1,e._modelShowType=3,e._bondage=0,e._pveShowId=0,e._goodsType=0,e._curLevelCfg={},e._nextLevelCfg={},e._curStarLevelCfg={},e._nextStarLevelCfg={},e._isAddBattle=!1,e._orderId=0,e._baseAttr={},e._count=0,e._stationLevel=0,e}return n(e,t),e.prototype.init=function(e){e&&(t.prototype.init.call(this,"PetModel",a.UserPropertyEnum.Pet,e.id,e.name,e.headImg,e.res,e.animationType),this._quality=e.quality,this._features=e.features,this._sortId=e.sortId,this._fragmentId=e.fragmentId,this._fragmentCount=e.fragmentCount,this._avatarId=e.avatarId,this._showId=e.showId,this._description=e.petdesc,this._maxStar=e.maxStar,this._maxLevel=e.maxLevel,this._spriteAnimationRes=e.spriteAnimationRes,this._animationOffset=e.animationOffset,this._pveIdleRes=e.pveIdleRes,this._pvpIdleRes=e.pvpIdleRes,this._pveAttack=e.pveAttack,this._bondage=a.GetTableClass(a.TableEnum.PetManualTable).getBondageByPetId(),this._goodsType=a.GoodsType.Type_Pet,this._pveShowId=e.pveShowId,this.setLevel(1),this.setStarLevel(1))},e.prototype.setData=function(t){this._configId=t.configId,this._sId=t.petId,this.setLevel(t.level),this.setStarLevel(t.starLevel),this._aptitude=t.aptitude,this._aptitudeMap=t.attributeAptitudes,this._tempAptitude=t.tempAptitude,this._tempAptitudeMap=t.tempAttributeAptitudeMap,this._luck=t.luck||0},e.prototype.getLevel=function(){return this._level},e.prototype.setLevel=function(t){this._level=t,this._curLevelCfg=a.GetTableClass(a.TableEnum.PetLevelUpTable).getData(this._id,t),this._nextLevelCfg=a.GetTableClass(a.TableEnum.PetLevelUpTable).getData(this._id,t+1);for(var e=0;e<this._curLevelCfg.attribute.length;e++){var i=this._curLevelCfg.attribute[e];this._baseAttr[i[0]]=i[1]}},e.prototype.getStarLevel=function(){return this._starLevel},e.prototype.setStarLevel=function(t){this._starLevel=t,this._curStarLevelCfg=a.GetTableClass(a.TableEnum.PetStarUpTable).getData(this._id,t),this._nextStarLevelCfg=a.GetTableClass(a.TableEnum.PetStarUpTable).getData(this._id,t+1),this._pveSkillId=this._curStarLevelCfg.pveskillId,this._pvpSkillId=this._curStarLevelCfg.skillId,this._skillLv=this._curStarLevelCfg.skillLv},e.prototype.getCurLevelCfg=function(){return this._curLevelCfg},e.prototype.getNextLevelCfg=function(){return this._nextLevelCfg},e.prototype.getCurStarLevelCfg=function(){return this._curStarLevelCfg},e.prototype.getNextStarLevelCfg=function(){return this._nextStarLevelCfg},e.prototype.getQuality=function(){return this._quality},e.prototype.setAptitude=function(t){this._aptitude=t},e.prototype.getAptitude=function(){return this._aptitude},e.prototype.getAptitudeMap=function(){return this._aptitudeMap},e.prototype.getTotalAptitude=function(){var t=0;for(var e in this._aptitudeMap)t+=this._aptitudeMap[e];return t},e.prototype.getTempTotalAptitude=function(){var t=0;for(var e in this._tempAptitudeMap)t+=this._tempAptitudeMap[e];return t},e.prototype.getTempAptitudeMap=function(){return this._tempAptitudeMap},e.prototype.setCount=function(t){this._count=t},e.prototype.getCount=function(){return this._count},e.prototype.getGoodsType=function(){return this._goodsType},e.prototype.getFragmentCount=function(){return this._fragmentCount},e.prototype.getFragmentId=function(){return this._fragmentId},e.prototype.getMaxLevel=function(){return this._maxLevel},e.prototype.getMaxStarLevel=function(){return this._maxStar},e.prototype.setPveSkillId=function(t){this._pveSkillId=t},e.prototype.setPvpSkillId=function(t){this._pvpSkillId=t},e.prototype.getPveSkillId=function(){return this._pveSkillId},e.prototype.getPvpSkillId=function(){return this._pvpSkillId},e.prototype.getSkillLv=function(){return this._skillLv},e.prototype.getFeatures=function(){return this._features},e.prototype.getDesc=function(){return this._description},e.prototype.getDes=function(){return this._description},e.prototype.getSId=function(){return this._sId},e.prototype.getLuck=function(){return this._luck},e.prototype.setOrderId=function(t){this._orderId=t},e.prototype.getOrderId=function(){return this._orderId},e.prototype.getSortId=function(){return this._sortId},e.prototype.getTempAptitude=function(){return this._tempAptitude},e.prototype.setEquipped=function(t){this._isAddBattle=t,t||(this._orderId=0)},e.prototype.isEquipped=function(){return this._isAddBattle},e.prototype.getAnimationRes=function(){return this._spriteAnimationRes},e.prototype.getModelShowType=function(){return this._modelShowType},e.prototype.getShadowScale=function(){return this._shadowScale},e.prototype.getRoleType=function(){return this._id},e.prototype.getBondage=function(){return this._bondage},e.prototype.getStationLevel=function(){return this._stationLevel},e.prototype.setStationLevel=function(t){this._stationLevel=t},e.prototype.getPveIdleRes=function(){return this._pveIdleRes},e.prototype.getPvpIdleRes=function(){return this._pvpIdleRes},e.prototype.getBaseAttackPower=function(){var t=a.GetConfig("FIGHT_POWER_EXPRESSION"),e=this.getTotalAttr();return Math.ceil(a.GlobalFunction.calculateExpression(t,e))},e.prototype.getPveSkillRes=function(){return a.TableManager.getTableClass(a.TableEnum.PveSkillTable).getSkillCfgDataById(this.getPveSkillId()).prefab_top||""},e.prototype.getPveShowId=function(){return this._pveShowId},e.prototype.getTotalAttr=function(){for(var t={},e=a.AttrType.Full;e<=a.AttrType.RAGE_RECOVER;e++){var i=this.getAttrByType(e);t[e]=i}return t},e.prototype.getTotalAttrTT=function(){},e.prototype.getBaseAttrByLevel=function(t){for(var e=[],i=a.GetTableClass(a.TableEnum.PetLevelUpTable).getData(this._id,t),n=0;n<i.attribute.length;n++){var r=i.attribute[n];e[r[0]]=r[1]}return e},e.prototype._getTransCfg=function(t){for(var e=a.GetConfig("PET_APTITUDE_ATTRIBUTE_COEFFICIENT"),i=0;i<e.length;i++){var n=e[i];if(t==n[0])return n[1]}return 1e4},e.prototype.getAttrByType=function(t,e){void 0===e&&(e=0);var i=0;e||(e=this._level);var n=this.getBaseAttrByLevel(e)[t]||0,a=this._aptitudeMap[t]||0,r=this._getTransCfg(t)/1e4,o=this.getOtherUp(t),s=1+this.getAllAttrBonus(t);i=n;var l=(e-1)*a;return i+=l=Math.ceil(l*r),i+=o,i=Math.ceil(i*s)},e.prototype.getNextAttrArray=function(){for(var t=[],e=1;e<=4;e++){var i=this.getAttrByType(e,this._level+1);i=Math.floor(i),t.push(i)}return t},e.prototype.getAttack=function(){return this.getAttrByType(a.AttrType.Attack)},e.prototype.getHp=function(){return this.getAttrByType(a.AttrType.HP)},e.prototype.getPhysicalArmor=function(){return this.getAttrByType(a.AttrType.PhysicalArmor)},e.prototype.getSpellArmor=function(){return this.getAttrByType(a.AttrType.SpellArmor)},e.prototype.getAttrArray=function(){return[this.getAttack(),this.getHp(),this.getPhysicalArmor(),this.getSpellArmor()]},e.prototype.isFullLevel=function(){return this._level>=this._maxLevel},e.prototype.isFullStarLevel=function(){return this._starLevel>=this._maxStar},e.prototype.getAllAttrBonus=function(t){var e=0;if(t<a.AttrType.Attack||t>a.AttrType.SpellArmor)return e;if(this._curStarLevelCfg)for(var i=this._curStarLevelCfg.attributeTTPercent,n=0;n<i.length;n++){var r=i[n],o=r[0],s=r[1];o!=a.AttrType.Full&&o!=t||(e+=s)}return e/1e4},e.prototype.getPlatformCfg=function(t){return a.GetTableClass(a.TableEnum.PetStationTable).getStationInfo(t)},e.prototype.getOtherUp=function(t){for(var e=0,i=this.getPlatformCfg(this._stationLevel).specialEffectIds,n=0;n<i.length;n++){var r=i[n],o=a.GetTableClass(a.TableEnum.SpecialEffectTable).getDataById(r);if(o)for(var s=a.GetTableClass(a.TableEnum.SpecialAttributeTable).getDataById(o.effectId),l=0;l<s.attributes.length;l++){var c=s.attributes[l];t==c[0]&&(e+=c[1])}else cc.warn("================> PetModel.getOtherUp() special_effect_config \u914d\u7f6e\u4e3a\u7a7a\uff1a ",r)}return e},e.prototype.getOtherUpTT=function(t){for(var e=0,i=this.getPlatformCfg(this._stationLevel).specialEffectIds,n=0;n<i.length;n++){var r=i[n],o=a.GetTableClass(a.TableEnum.SpecialEffectTable).getDataById(r);if(o)for(var s=a.GetTableClass(a.TableEnum.SpecialAttributeTable).getDataById(o.effectId),l=0;l<s.attributes.length;l++){var c=s.attributeTTPercent[l];t==c[0]&&(e+=c[1])}else cc.warn("================> PetModel.getOtherUpTT() special_effect_config \u914d\u7f6e\u4e3a\u7a7a\uff1a ",r)}return e/1e4},e.prototype.getFullAptitude=function(){var t=a.GetTableClass(a.TableEnum.PetAptitudeTable),e=t.getMaxAptitude(this._quality);return a.GetConfig("PET_APTITUDE_RANGE")[1]*(t.getData(this._quality,e).coefficient/1e4)},e.prototype.getAptitudeCfg=function(){return a.GetTableClass(a.TableEnum.PetAptitudeTable).getData(this._quality,this._aptitude)},e.prototype.getTotalPetAttr=function(){for(var t={},e=a.AttrType.Full;e<=a.AttrType.RAGE_RECOVER;e++){var i=this.getAttrByType(e);Math.ceil(i)&&(t[e]=Math.ceil(i))}return t},e.prototype.getStarRes=function(){var t,e=[],i=this._starLevel;this._starLevel>10?(t="GY_taiyang",i=this._starLevel-10):this._starLevel>5?(t="GY_yueliang",i=this._starLevel-5):t="GY_xingxing";for(var n=1;n<=5;n++)n<=i?e.push(t):e.push(t+"02");return e},e.prototype.getObtainWay=function(){return a.GetTableClass(a.TableEnum.Item).getItemById(this._fragmentId).obtainWay},e.prototype.getCurCamp=function(){return this._features},e}(t("PropertyModel"));i.default=r,cc._RF.pop()},{PropertyModel:"PropertyModel"}],PetStarUpTable:[function(t,e,i){"use strict";cc._RF.push(e,"1164eUth5VCp5wMK3c/t8ex","PetStarUpTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PetStarConfig",e._tblName="pet_star_config",e._data={},e._table=[],e}return n(e,t),e.prototype.init=function(){this._table=this._jsonData;for(var t=0,e=this._jsonData.length;t<e;++t){var i=this._jsonData[t];this._data[i.id]||(this._data[i.id]={}),this._data[i.id][i.starLevel]=i}},e.prototype.getData=function(t,e){return this._data[t]&&this._data[t][e]?this._data[t][e]:null},e.prototype.getUnlockLevel=function(t,e){var i;for(var n in this._data[t]){var a=this._data[t][n];a.skillLv==e&&(i=i?Math.min(i,a.starLevel):a.starLevel)}return i},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PetStationTable:[function(t,e,i){"use strict";cc._RF.push(e,"13693xDgzxI27/3+mH40k5m","PetStationTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PetStationConfig",e._tblName="pet_platform_config",e._data={},e._maxLevel=0,e._talentList=[],e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=0,e=this._jsonData.length;t<e;++t){var i=this._jsonData[t];i.specialId&&this._talentList.push(i.specialId),this._maxLevel=Math.max(this._maxLevel,i.level),this._data[i.level]=i}},e.prototype.getStationInfo=function(t){return this._data[t]?this._data[t]:null},e.prototype.getAllInfo=function(){return this._data},e.prototype.getMaxLevel=function(){return this._maxLevel},e.prototype.getPosUnlockLvByOrderId=function(t){for(var e=0;e<=this._maxLevel;e++)if(this._data[e].countLimit==t)return e},e.prototype.getTalentList=function(){return this._talentList},e.prototype.getShowTalentIdx=function(t){if(t>=this._maxLevel)return this._talentList.length-1;for(var e=this._data[t+1].specialId,i=0;i<this._talentList.length;i++){if(e==this._talentList[i])return i}},e.prototype.getUnlockLv=function(t){for(var e in this._data){var i=this._data[e];if(i.specialId==t)return i.level}},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PetTable:[function(t,e,i){"use strict";cc._RF.push(e,"f09f8UXCOZMgpw+x2JXoGYo","PetTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PetConfig",e._tblName="pet_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=0,e=this._jsonData.length;t<e;++t){var i=this._jsonData[t],n=i.id;i.spriteAnimationRes="pet/pet_"+i.id+"/pet_"+i.id,i.pveIdleRes="pet/pet_"+n+"/pve/PVE_pet_"+n,i.pveAttack="pet/pet_"+n+"/pve/pet_"+n+"_1",i.animationOffset={x:0,y:0},this._data[i.id]=i}},e.prototype.getPetById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getPetByFragmentId=function(t){for(var e in this._data)if(this._data[e].fragmentId==t)return this._data[e];return null},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PhaseBoxItemUI2:[function(t,e,i){"use strict";cc._RF.push(e,"857b4L+g/lHoIrENL4cWoMa","PhaseBoxItemUI2");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("ListItem"),d=t("CommonIconWidget"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeItem=null,e.imgSelect=null,e}return n(e,t),e.prototype.onEnable=function(){this._addEventListners()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListners=function(){var t={};t[r.EventNameEnum.RES_EARETREASURE_SELECT_PHASE_BOX2]=this._setSelect,r.EventUtil.registerEvents(t,this)},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._index=e;var n=r.RewardManager.getRewardDetail(i.rewards[0]),a=r.GlobalFunction.createCommonIconWidget(26,n);this.nodeItem.removeAllChildren(),this.nodeItem.addChild(a),a.getComponent(d).setTouchEnabled(!1),this._setSelect()},e.prototype._setSelect=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10).getBoxSelectIndex();this.imgSelect.active=this._index===t},e.prototype.onItemClick=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10).getBoxSelectIndex();this._index!==t&&r.EventUtil.dispatchEvent(r.EventNameEnum.EARETREASURE_SELECT_PHASE_BOX2,this._index)},a([l(cc.Node)],e.prototype,"nodeItem",void 0),a([l(cc.Node)],e.prototype,"imgSelect",void 0),e=a([s,c("module/Activity/RareTreasure/PhaseBoxItemUI2")],e)}(u);i.default=h,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],PlayerManager:[function(t,e,i){"use strict";cc._RF.push(e,"0796cZag3RJcJWnz1e6+qw5","PlayerManager");var n=a(t("../../Rank/Manager/RankManager"));a(t("../../Manual/Manager/ManualManager"));function a(t){return t&&t.__esModule?t:{default:t}}var r=t("UserModel"),o=t("UFSdkManager"),s=t("CommonEnum");td.Account={_userModel:null,_initLoadList:null,_isInit:null,_flowerPeople:null,_curSavedLevel:null,_laterShowPower:null,_isShowPowerChangeLater:!1,init:function(){this.resetLoadAllData(),this._addListener(),this._addEventListener()},destroyData:function(){this.resetLoadAllData(),this._userModel=null,this._flowerPeople=0,this._curSavedLevel=0},reloadData:function(){this.resetLoadAllData()},_addListener:function(){td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.ACTOR_RENAME,this._onReNameSucc.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.PUSH_ACTOR_ATTRIBUTE,this._parseActorAttr.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.ACTOR_ABORE,this._resAbore.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.SAVE_GUIDE_STEP,this._resSaveGuideStep.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.ACTOR_RANK_ABORE,this._resAborArena.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.REVEIVE_SAVE_DIAMOND,this._resGetDiamond.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.PUSH_ACTOR_OFFLINE_FLOWERED,this._onOfflineFlowered.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.RANDOM_NAME,this._onRandomNameSucc.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.EXCHANGE,td.MsgCmd.EXCHANGE.USE_EXCHANGE_CODE,this._recExchangeCodeReturn.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.ACTOR_SHARED,this._resRewardResult.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.ACTOR_FOCUS,this._resRewardResult.bind(this)),td.ServerDelegate.registerMessage(td.MsgModuleName.USER,td.MsgCmd.User.ACTOR_VERIFY,this._resRewardResult.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.PARSE_ACTOR_ATTR]=this.initUserData,i[e.INIT_DATA_LOADED]=this._loadInitDataComplete,i[e.CHECK_INIT_DATA]=this._checkInitData,i[e.REQUEST_CHANGE_USERNAME]=this._requestChangeUserName,i[e.REQUEST_CHANGE_VIP_SHOW]=this._requestChangeVipShow,i[e.REQUEST_EXCHANGE_CODE]=this._requestExchangeCode,i[e.Req_ACTOR_ABORE]=this._reqAbore,i[e.Req_ACTOR_ABORE_FLOWER]=this._reqAboreFlower,i[e.Req_SAVE_GUIDE_STEP]=this._reqSaveGuideStep,i[e.REQUEST_RECEIVE_DIAMOND]=this._reqGetDiamond,i[e.REQ_RANDOM_NAME]=this._reqRandomName,i[e.RECORD_CUR_LEVEL]=this._recordCurLevel,i[e.SHOW_RECORDED_LEVEL_CHANGE]=this._showRecordedLevelChange,i[e.REQ_RECEIVE_SHARE]=this._reqReceiveShare,i[e.REQ_RECEIVE_FOCUS]=this._reqReceiveFocus,i[e.REQ_RECEIVE_VERIFY]=this._reqReceiveVerify,i[e.Recharge_Success]=this._checkShowSuperVIP,i[e.CUMULATEGIFT_GET_INFO]=this._requestCumulateGiftInfo,i[e.SHOW_SPRITE_ACTIVE_TIP]=this._showPowerChange,i[e.SHOW_POWER_CHANGE_LATER]=this._onPowerChangeLater,t.registerEvents(i,this)},_checkInitData:function(){this.isLoadAllData()||this.loadPlayerData()},isLoadAllData:function(){var t=td.LoadKey;for(var e in t)if(!this._initLoadList[t[e]])return cc.warn(e+" is not init complete!!!"),!1;return!0},loadPlayerData:function(){this.resetLoadAllData();var t=td.EventUtil,e=td.EventNameEnum;t.dispatchEvent(e.INIT_PARTNERSHIP),t.dispatchEvent(e.REQUEST_SERVER_SETTING,[td.ServerSettingKey.SERVER_START_TIME,td.ServerSettingKey.SUPREME_GACHA,td.ServerSettingKey.GROW_FUND_BUY_TOTAL_COUNT]),t.dispatchEvent(e.REQUEST_SERVER_START_DAYS),t.dispatchEvent(e.REQ_GET_HOOKUP_INFO),t.dispatchEvent(e.REQUEST_PREROGATIVE_INFO),t.dispatchEvent(e.REQUEST_ITEM_LIST),t.dispatchEvent(e.REQ_HERO_LIST),t.dispatchEvent(e.GET_CLIENT_DATA),t.dispatchEvent(e.REQ_HERO_RUNE_INFO),t.dispatchEvent(e.REQUEST_EQUIP_LIST),t.dispatchEvent(e.REQ_GET_SPIRIT),t.dispatchEvent(e.PET_GET_INFO),t.dispatchEvent(e.PET_GET_STATION_INFO),t.dispatchEvent(e.REQUEST_GEMSTONE_LIST),t.dispatchEvent(e.REQUEST_ARTIFACT_LIST),t.dispatchEvent(e.REQ_GET_TREASURE_INFO),t.dispatchEvent(e.GET_HUNT_TREASURE_INFO),t.dispatchEvent(e.Req_GET_TASK_INFO),t.dispatchEvent(e.Req_GET_ACTIVE_INFO),t.dispatchEvent(e.REQUEST_BATTLE_ARRAY),t.dispatchEvent(e.QUERY_PVE_GENERAL_COPY_INFO),t.dispatchEvent(e.REQUEST_ACTIVITY_CONFIG),t.dispatchEvent(e.Req_GET_ACTIVITY_INFO),t.dispatchEvent(e.Req_NATION_GET_ACTOR),t.dispatchEvent(e.REQUEST_SUMMON_INFO),t.dispatchEvent(e.Req_GET_CHAT_INFO),t.dispatchEvent(e.REQ_GET_MAGIC_TOWER_INFO),t.dispatchEvent(e.REQUEST_GET_SIEGE_INFO),t.dispatchEvent(e.REQ_GET_GOD_FURNACE_INFO),t.dispatchEvent(td.EventNameEnum.REQ_GET_GOD_FURNACE_RANKS),t.dispatchEvent(e.QUERY_PERSONAL_DRAGON_COPY_INFO),t.dispatchEvent(e.REQUEST_RECHARGE_INFO),t.dispatchEvent(e.Req_GET_TECHNOLOGY_LIST),t.dispatchEvent(e.Req_GET_MAIL_LIST),t.dispatchEvent(e.REQUEST_ARENA_INFO),t.dispatchEvent(e.REQUEST_SYS_UNLOCK_INFO),t.dispatchEvent(e.REQUEST_COPY_DATA),t.dispatchEvent(e.REQUEST_MANUAL_INFO),t.dispatchEvent(e.REQ_GET_GACHA_INFO),t.dispatchEvent(e.REQUEST_ROAM_INFO),t.dispatchEvent(e.REQ_STAR_UP_ROAD_INFO),t.dispatchEvent(e.REQ_STAR_UP_ROAD_STAR_REWARD),t.dispatchEvent(e.REQUEST_IMMORTAL_INFO),t.dispatchEvent(e.REQ_GET_ENDLESS_INFO),t.dispatchEvent(e.req_get_friend_info),t.dispatchEvent(e.REQ_VIP_DAILY_BENEFITS_INFO),t.dispatchEvent(e.REQUEST_RANK_BASE_INFO),t.dispatchEvent(e.REQ_GET_PRIVATE_RED_ENVELOPE_LIST),t.dispatchEvent(e.REQ_GET_PUBLIC_RED_ENVELOPE_LIST),t.dispatchEvent(e.REQ_SUPER_GIFT_INFO),t.dispatchEvent(e.Req_EatEnergy_Info),t.dispatchEvent(e.REQ_LEVEL_GIFT_GET),t.dispatchEvent(e.REQ_MAGIC_RECORD_INFO),t.dispatchEvent(e.REQ_TREASURE_SNATCH_RECORD),t.dispatchEvent(e.REQ_DESTROY_TEMPLE_INFO),t.dispatchEvent(e.REQ_GET_WHOLE_BOSS_INFO),t.dispatchEvent(e.REQ_GET_WHOLE_BOSS_ACTOR),t.dispatchEvent(e.REQUEST_TURN_TABLE_INFO),t.dispatchEvent(e.REQ_GET_DAILY_SIGN_CONFIG),t.dispatchEvent(e.REQUEST_SKY_DIAMOND_INFO),t.dispatchEvent(e.REQ_EXT_LOGIN_DAY_GIFT),t.dispatchEvent(e.REQ_GET_FLASH_GIFT_INFO),t.dispatchEvent(e.REQ_ONLINE_REWARD_INFO),t.dispatchEvent(e.REQ_GET_STORY_REWARD_INFO),t.dispatchEvent(e.Req_ACTOR_POWER_TOP_RANK),t.dispatchEvent(e.REQGET_STORE_INFO),t.dispatchEvent(e.REQ_GET_ANCIENT_INFO),t.dispatchEvent(e.REQ_GET_LIMITED_TIME_CHARGE_INFO),t.dispatchEvent(e.REQ_GET_DIPPER_INFO),t.dispatchEvent(e.REQUEST_WONDERLAND_DATA),t.dispatchEvent(e.REQ_GET_SERVER_MAX_LEVEL),t.dispatchEvent(e.REQ_GET_SERVER_ZONE_NAME),t.dispatchEvent(e.REQ_GET_BABEL_INFO),t.dispatchEvent(e.REQ_GET_BABEL_BATTLE_INFO),t.dispatchEvent(e.REQ_GET_TITLE_INFO),t.dispatchEvent(e.REQ_CROSS_CUP_ACTOR_INFO),t.dispatchEvent(e.REQ_NATION_DUEL_INFO),t.dispatchEvent(e.LEGENG_REQUEST_ACTOR_INFO),t.dispatchEvent(e.LEGENG_REQUEST_SEASON_INFO),t.dispatchEvent(e.ED_REQUEST_INFO),t.dispatchEvent(e.CUMULATEGIFT_GET_INFO),t.dispatchEvent(e.REQ_MAZE_INFO),t.dispatchEvent(e.REQ_MAZE_BATTLE_INFO),t.dispatchEvent(e.REQ_DIVINE_POS_GET_INFO),t.dispatchEvent(e.REQUEST_SCUFFLE_YAMA_INFO),td.isMoXieQQ()&&td.EventUtil.dispatchEvent(td.EventNameEnum.MOXIE_REQ_INFO)},requestModuleDatasAfterPlayeData:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_DEMON_TREASURE_COPY_DATA)},resetLoadAllData:function(){this._isInit=!1,this._initLoadList={},this._laterShowPower=0,this._isShowPowerChangeLater=!1},getAddExp:function(){var t=td.Account.getUserData().getLevel(),e=td.SystemManager.getServerMaxLevel(),i=td.GetConfig("ACTOR_ADD_EXP_PREROGATIVE_CONDITION_EXPR"),n=td.GlobalFunction.calculateExpression(i,[e,t]),a=td.GetTableClass(td.TableEnum.VipPrivilegeTable).getPrerogativeByTypeAndOpenValue(s.PrerogativeEnum.ADD_EXP_TEN_THOUSAND),r=0;if(n&&"false"!==n){var o=td.Account.getUserData().vip;for(var l in a){var c=a[l];c.privilegeOpenValue<=o&&(r=c.value)}}return r/1e4+1},_loadInitDataComplete:function(t){cc.log("_loadInitDataComplete "+t),this._initLoadList[t]=!0,this._checkDataLoad()},_checkDataLoad:function(){!this._isInit&&this.isLoadAllData()&&(this._isInit=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.ALL_DATA_LOADED),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_LOADING_LAYER,td.LoadingKey.Loading_Player),this.requestModuleDatasAfterPlayeData())},initUserData:function(t){t&&null!==t&&(null===this._userModel&&(this._userModel=new r,this._userModel.init(t),td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_CHESS_INFO)),td.EventUtil.dispatchEvent(td.EventNameEnum.SEVEN_DAYS_AWARD_UPDATED,t))},getUserData:function(){return this._userModel},getOfflineFloweredPeople:function(){var t=this._flowerPeople;return this._flowerPeople=0,t},_parseActorAttr:function(t,e){if(null!==this._userModel){var i=this._userModel,n=i.level,a=i.vip,r=i.fightPower,s=i.nickName,l=i.getCurStoryId(),c=i.getEnergy(),u=i.getVigour(),d=i.getMerit(),h=i.getNationTechPoint(),p=i.getNationCoin(),_=i.getTechnologyPoint(),g=i.getLoginTotalDay(),f=i.getAvatarList(),v=i.getShowList(),m=e.actorAttributeMap;this._userModel.updateAttr(m);var y=td.UserPropertyEnum;if(m[y.Level]&&n!==this._userModel.level)td.DataReporter.levelChange(this._userModel.level),this._curSavedLevel||td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_LEVEL_CHANGE,n),td.GameRoleInfo.eventType="2",td.GameRoleInfo.roleLevel=this._userModel.level+"",td.GameRoleInfo.fightValue=this._userModel.fightPower+"",td.GameRoleInfo.vipLevel=this._userModel.vip+"",td.GameRoleInfo.roleName=this._userModel.nickName,o.getInstance().reportRoleInfo(td.GameRoleInfo),td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_LEVEL_CHANGE,n),td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MultipleFirstRecharge).checkLevel();m[y.Vip]&&a!==this._userModel.vip&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_VIP_LEVEL_CHANGE),m[y.NickName]&&s!==this._userModel.nickName&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_USERNAME_CHANGE);var E=this._userModel.fightPower-r;if(m[y.FightPower]&&0!==E&&(this._isShowPowerChangeLater?this._laterShowPower=E:td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_FIGHT_POWER_CHANGE,E)),void 0!==m[y.Gold]&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_GOLD_CHANGE),void 0!==m[y.Diamond]&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_DIAMOND_CHANGE),m[y.StoryId]&&l!==this._userModel.getCurStoryId()&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_STORY_ID_CHANGE),void 0!==m[y.ENERGY]&&c!==this._userModel.getEnergy()&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_ENERGY_CHANGE),m[y.NationTechPoint]&&h!==this._userModel.getNationTechPoint()&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_NATION_TECH_POINT_CHANGE),m[y.NationCoin]&&p!==this._userModel.getNationCoin()&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_NATION_COIN_CHANGE),m[y.SUP_SCI_TECH_POINT]&&_!==this._userModel.getTechnologyPoint()&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_TECH_POINT_CHANGE),m[y.VIGOUR]&&u!==this._userModel.getVigour()&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_VIGOUR_CHANGE),m[y.MERIT]&&d!==this._userModel.getMerit()&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_MERIT_CHANGE),void 0!==m[y.LAST_REFRESH_MERIT_TIME]&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_MERIT_CHANGE),m[y.GUIDE_ID]&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_GUIDE_ID_CHANGE),m[y.LOGIN_TOTAL_DAY]&&g!==this._userModel.getLoginTotalDay()&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_LOGIN_DAY_CHANGE),m[y.AvartarList]&&f.length<this._userModel.getAvatarList().length){for(var T=[],C=this._userModel.getAvatarList(),R=0,S=C.length;R<S;R++){var I=C[R];ArrayUtils.contains(f,I)||(T[T.length]=I)}td.EventUtil.dispatchEvent(td.EventNameEnum.USER_AVATAR_CHANGE,T)}if(m[y.ShowList]&&v.length<this._userModel.getShowList().length){var A=[],b=this._userModel.getShowList();for(R=0,S=b.length;R<S;R++){var P=b[R];ArrayUtils.contains(v,P)||(A[A.length]=P)}td.EventUtil.dispatchEvent(td.EventNameEnum.USER_SHOW_CHANGE,A)}void 0!==m[y.FLOWER_STATE]&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_FLOWER_STATE_CHANGE),void 0!==m[y.TITLE_ID]&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_TITLE_ID_CHANGE),void 0!==m[y.LIFETIME_VIP_CARD_REWARD_STATE]&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_LIFE_CARD_REWAED_STATE_CHANGE),void 0===m[y.SharedState]&&void 0===m[y.FocusState]&&void 0===m[y.VerifyState]||td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_AWYGIFT),td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ON_ATTR_CHANGE)}td.EventUtil.dispatchEvent(td.EventNameEnum.SEVEN_DAYS_AWARD_UPDATED,e.actorAttributeMap)},_reqRandomName:function(){var t={};t.module=td.MsgModuleName.USER,t.cmd=td.MsgCmd.User.RANDOM_NAME,td.ServerDelegate.sendMessage(t)},_onRandomNameSucc:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_RANDOM_NAME,e)},_requestChangeUserName:function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.ACTOR_RENAME,e.actorName=t.name,e.free=t.free,td.ServerDelegate.sendMessage(e)},_requestChangeVipShow:function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.CHANGE_VIP_SHOW,e.vipStatus=t.vipStatus,td.ServerDelegate.sendMessage(e)},_onReNameSucc:function(t,e){var i=td.Account.getUserData();td.GameRoleInfo.eventType="3",td.GameRoleInfo.serverId=UFServerManager.getInstance().getSelectServerData().serverId+"",td.GameRoleInfo.serverName=UFServerManager.getInstance().getSelectServerData().serverName,td.GameRoleInfo.roleLevel=i.level+"",td.GameRoleInfo.roleName=i.nickName,td.GameRoleInfo.roleId=i.sid+"",td.GameRoleInfo.userId=i.userId+"",td.GameRoleInfo.vipLevel=i.vip+"",td.GameRoleInfo.fightValue=i.fightPower+"",td.GameRoleInfo.balance=i.getDiamond()+"",td.GameRoleInfo.roleCreateTime=i.getActorCreateTime()+"",o.getInstance().reportRoleInfo(td.GameRoleInfo),td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_CHANGE_USERNAME_SUCC,t)},_requestExchangeCode:function(t){var e={};e.module=td.MsgModuleName.EXCHANGE,e.cmd=td.MsgCmd.EXCHANGE.USE_EXCHANGE_CODE,e.code=t,td.ServerDelegate.sendMessage(e)},_recExchangeCodeReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,n),td.EventUtil.dispatchEvent(td.EventNameEnum.RECEIVE_EXCHANGE_CODE)}},_reqAbore:function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.ACTOR_ABORE,e.messages=t,td.ServerDelegate.sendMessage(e)},_resAbore:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,n),td.EventUtil.dispatchEvent(td.EventNameEnum.Res_ACTOR_ABORE)}},_reqAboreFlower:function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.ACTOR_RANK_ABORE,e.messages=t,td.ServerDelegate.sendMessage(e)},_resAborArena:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,a=e.countMap;for(var r in a)n.default.getInstance().addFlowerdCount(1,a[r]);var o=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,o),td.EventUtil.dispatchEvent(td.EventNameEnum.Req_ACTOR_POWER_TOP_RANK,o),td.EventUtil.dispatchEvent(td.EventNameEnum.Res_ACTOR_ABORE_FLOWER)}},_reqReceiveShare:function(){var t={};t.module=td.MsgModuleName.USER,t.cmd=td.MsgCmd.User.ACTOR_SHARED,td.ServerDelegate.sendMessage(t)},_reqReceiveFocus:function(){var t={};t.module=td.MsgModuleName.USER,t.cmd=td.MsgCmd.User.ACTOR_FOCUS,td.ServerDelegate.sendMessage(t)},_reqReceiveVerify:function(){var t={};t.module=td.MsgModuleName.USER,t.cmd=td.MsgCmd.User.ACTOR_VERIFY,td.ServerDelegate.sendMessage(t)},_resRewardResult:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_AWYGIFT)}},_requestCumulateGiftInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.GET_CUMULATEGIFT_INFO,td.ServerDelegate.sendMessage(t)},_reqGetDiamond:function(){var t={};t.module=td.MsgModuleName.USER,t.cmd=td.MsgCmd.User.REVEIVE_SAVE_DIAMOND,td.ServerDelegate.sendMessage(t)},_resGetDiamond:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_RECEIVE_DIAMOND),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_MAIN_LEFT_TOP_PANEL)}},_reqSaveGuideStep:function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.SAVE_GUIDE_STEP,e.guideId=t,td.ServerDelegate.sendMessage(e)},_resSaveGuideStep:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.Res_SAVE_GUIDE_STEP)},getOriginLevelByExp:function(t){var e=1,i=td.GetTableClass(td.TableEnum.ActorLevelConfig).getAllLevelConfig();if(!i)return e;var n=this._userModel;if(!n)return e;for(var a=n.level,r=n.exp,o=1;o<a;o++)i[o]&&(r+=i[o]);var s=r-t;for(var l in i){if(!((s-=i[l])>=0))break;e=parseInt(l)+1}return e},_onOfflineFlowered:function(t,e){t===td.NetCode.SUCCESS&&(this._flowerPeople=e.count,td.EventUtil.dispatchEvent(td.EventNameEnum.ON_OFFLINE_FLOWERED))},isRecordedLevel:function(){return!!this._curSavedLevel},_recordCurLevel:function(){this._curSavedLevel=td.Account.getUserData().level},_showRecordedLevelChange:function(){var t=td.Account.getUserData().level;this._curSavedLevel&&this._curSavedLevel<t&&td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_LEVEL_CHANGE,this._curSavedLevel),this._curSavedLevel=0},isSuperVIP:function(){return!!td.isNeedShowSuperVip()&&td.Account.getUserData().getVipLevel()>=td.GetConfig("SUPERVIPLV")},isShowSuperVip:function(){var t=td.LocalStorageUtil.read(td.LocalDataKey.SUPERVIPLV);return!t&&"true"!==t&&(td.LocalStorageUtil.write(td.LocalDataKey.SUPERVIPLV,!0),!0)},_checkShowSuperVIP:function(){this.isSuperVIP()&&this.isShowSuperVip()&&td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_SuperVIP)},isShowSuperVipToDay:function(){return!td.GlobalFunction.getLocalSaveStatus("IS_HIDE_SUPERVIP")},setHideAutoShow:function(t){t?td.GlobalFunction.setLocalSaveStatus("IS_HIDE_SUPERVIP",!0):td.GlobalFunction.removeLocalSaveStatus("IS_HIDE_SUPERVIP")},_showPowerChange:function(){this._laterShowPower&&td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_FIGHT_POWER_CHANGE,this._laterShowPower),this._laterShowPower=0,this._isShowPowerChangeLater=!1},_onPowerChangeLater:function(t){this._isShowPowerChangeLater=t}},cc._RF.pop()},{"../../Manual/Manager/ManualManager":"ManualManager","../../Rank/Manager/RankManager":"RankManager",CommonEnum:void 0,UFSdkManager:void 0,UserModel:"UserModel"}],PopupWindowController:[function(t,e,i){"use strict";cc._RF.push(e,"60291IbuU1MFptHr1vGYmOO","PopupWindowController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,_receiveList:null,_data:null,_isInit:!1,initData:function(t){this._super(t),this._isInit=!0,this._data=td.GetTableClass(td.TableEnum.ActivityPopupWindowConfig).getActivityPopWindowConfigById(this._activityData),this._super(t)},isInited:function(){return this._isInit},activityParse:function(t){var e=t.record;this._receiveList=e.receiveList},hasRedPoint:function(){return!1},redPointTip:function(){return this.isRedPointTip()},isAllRecevied:function(){if(null===this._receiveList)return!0;for(var t=0,e=this._data.length;t<e;t++){var i=this._data[t].id;if(this._receiveList.indexOf(i)<0)return!1}return!0},getData:function(){return this._data||[]},isReceiveById:function(t){return null!==this._receiveList&&this._receiveList.indexOf(t)>=0},isPopWindow:function(){return this.isInOpenStatus()&&!this.isAllRecevied()}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],PowerRankListView:[function(t,e,i){"use strict";cc._RF.push(e,"cd4acmxextL+4ri+Zz/icOd","PowerRankListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{ItemIconAtlas:cc.SpriteAtlas},setData:function(t){var e=t.dataList;this._super(e)},setItemView:function(t,e){if(e&&t){var i=t.getChildByName("imgRank"),n=t.getChildByName("labRank"),a=t.getChildByName("rewardPanel"),r=t.getChildByName("labEmptyTip"),o=t.getChildByName("playerInfoPanel"),s=e.getRank(),l=1===s?"UI/GY_Window2/GB_wenzidikuang_11":2===s?"UI/GY_Window2/GB_wenzidikuang_08":3===s?"UI/GY_Window2/GB_wenzidikuang_09":"UI/GY_Window2/GB_wenzidikuang_07";if(td.GlobalFunction.createSpriteNode(t,l),i.active=s<=3,n.active=s>3,s<=3){var c=this.ItemIconAtlas.getSpriteFrame(cc.js.formatStr("icon_paiming0%s",s));i.getComponent(cc.Sprite).spriteFrame=c}else n.getComponent(cc.Label).string=s;var u=e.getRewardList(),d=e.getRankPlayerInfo();if(o.active=!!d,r.active=!d,d){var h=td.GlobalFunction.createAvatarHeadWidget(3,d);h.x=70,h.y=0,h.scale=.7,t.addChild(h),this._setPlayerInfo(o,d)}return this._setRewardInfo(a,u),t}},_setPlayerInfo:function(t,e){var i=t.getChildByName("labPlayerName"),n=t.getChildByName("labNationName"),a=t.getChildByName("labPower"),r=e.getUserName(),o=e.getPower(),s=e.getArmyName();i.getComponent(cc.Label).string=r,n.getComponent(cc.Label).string=s,a.getComponent(cc.Label).string=o},_setRewardInfo:function(t,e){for(var i=0,n=e.length;i<n;i++){var a=e[i],r=td.GlobalFunction.createCommonIconWidget(33,a);r.name="reward"+i,r.scale=.7;var o=(t.width-n*r.width*.7)/(n+1);r.x=o+.7*r.width/2+(o+.7*r.width)*i,r.y=0,t.addChild(r)}}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],PreLoadConfig:[function(t,e,i){"use strict";cc._RF.push(e,"7fa2eswIWFLn4+PDdMY/+lF","PreLoadConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PreLoadConfig",properties:{_tblName:"pre_load_config",_maxLevel:0,_preloadData:null},init:function(){this._preloadData={};for(var t=this._jsonData,e=this._preloadData,i=0,n=t.length;i<n;++i){var a=t[i];e[a.level]=a,this._maxLevel=a.level}},getAllPreLoadDataByLevel:function(t){var e=t;this._maxLevel<=t&&(e=this._maxLevel);var i=[];for(var n in this._preloadData){var a=this._preloadData[n];if(!(a.level<=e))break;var r=a.downPanelEnum;i=i.concat(r)}return i},getCurPreLoadDataByLevel:function(t){return this._maxLevel<=t?null:this._preloadData[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PreferentialGiftController:[function(t,e,i){"use strict";cc._RF.push(e,"abe36WbhTJIE40AUhz/Ltp6","PreferentialGiftController");var n=t("SuperGiftController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{SuperGiftController:"SuperGiftController"}],PreferentialGiftListView:[function(t,e,i){"use strict";cc._RF.push(e,"d200bOX9SFGfY0g6e5HqS0k","PreferentialGiftListView");var n=t("SuperGiftListView"),a=cc.Class({extends:n,doReceiveAction:function(){this._controller=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.PreferentialGift),this._controller.operateActivity({id:this._id})}});e.exports=a,cc._RF.pop()},{SuperGiftListView:"SuperGiftListView"}],PreferentialGiftWindow:[function(t,e,i){"use strict";cc._RF.push(e,"c2968PsRdRKmZXJ5cnCGqyg","PreferentialGiftWindow");var n=t("SuperGiftWindow"),a=cc.Class({extends:n,properties:{},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_PreferentialGift},refreshController:function(){this._activityType=td.ActivityEnum.ActivityType.PreferentialGift,this._controller=td.ActivityDataManager.getActivityControllerByType(this._activityType)}});e.exports=a,cc._RF.pop()},{SuperGiftWindow:"SuperGiftWindow"}],PrerogativeManager:[function(t,e,i){"use strict";cc._RF.push(e,"eed94KR0W1C1a36u/XxneXN","PrerogativeManager");var n=t("PrerogativeModel");td.PrerogativeManager={_prerogativeData:null,init:function(){this.destroyData(),this._addEventListener(),this._addListener()},destroyData:function(){this._prerogativeData={}},_addEventListener:function(){var t={};t[td.EventNameEnum.REQUEST_PREROGATIVE_INFO]=this._requestBaseInfo,td.EventUtil.registerEvents(t,this)},_addListener:function(){var t=td.MsgModuleName.PREROGATIVE,e=td.MsgCmd.PREROGATIVE,i=td.ServerDelegate;i.registerMessage(t,e.GET_PREROGATIVE_LIST,this._receiveBaseInfo.bind(this)),i.registerMessage(t,e.PUSH_PREROGATIVE_LIST,this._pushPrerogative.bind(this))},getPrerogative:function(t){var e=this._prerogativeData[t];if(!e)return null;for(var i=null,a=0;a<e.length;a++){var r=e[a];if(r){var o=r.getExpirationTime();if(0===o||o>td.TimeUtil.getTime())if(i){i.getValue()instanceof Array||i.setValue(i.getValue()+r.getValue())}else{var s=td.GetTableClass(td.TableEnum.VipPrivilegeTable).getDataById(r.getId());(i=new n).initData(s)}}}return i},getPrerogativeById:function(t){for(key in this._prerogativeData)for(var e=this._prerogativeData[key],i=0,n=e.length;i<n;i++){var a=e[i];if(a.getId()===t)return a}return null},_requestBaseInfo:function(t){var e={};e.module=td.MsgModuleName.PREROGATIVE,e.cmd=td.MsgCmd.PREROGATIVE.GET_PREROGATIVE_LIST,td.ServerDelegate.sendMessage(e)},_receiveBaseInfo:function(t,e){t===td.NetCode.SUCCESS&&this._parsePrerogative(e)},_pushPrerogative:function(t,e){t===td.NetCode.SUCCESS&&(this._parsePrerogative(e),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_PREROGATIVE_INFO))},_parsePrerogative:function(t){this._prerogativeData={};var e=td.GetTableClass(td.TableEnum.VipPrivilegeTable),i=t.prerogatives;for(var a in i)for(var r=i[a],o=0,s=r.length-1;o<=s;o++){var l=r[o],c=e.getDataById(l.id);c&&((l=new n).initData(c),this._updatePrerogative(l))}td.EventUtil.dispatchEvent(td.EventNameEnum.INIT_DATA_LOADED,td.LoadKey.Prerogative)},_updatePrerogative:function(t){var e=this._prerogativeData[t.getType()];if(e){for(var i=!1,n=0,a=e.length;n<a;n++){var r=e[n];if(r.getId()===t.getId()&&r.getId()===t.getId()){r=t,i=!0;break}}i||e.push(t)}else this._prerogativeData[t.getType()]=[],this._prerogativeData[t.getType()].push(t)}},cc._RF.pop()},{PrerogativeModel:"PrerogativeModel"}],PrerogativeModel:[function(t,e,i){"use strict";cc._RF.push(e,"31defRyyBFLQJ3+UXl7Jy6t","PrerogativeModel");var n=cc.Class({properties:{_id:null,_type:null,_value:null,_prerogativeType:null,_privilegeOpenValue:null,_time:null},initData:function(t){this._id=t.id,this._type=t.type,this._value=t.value,this._prerogativeType=t.privilegeType,this._privilegeOpenValue=t.privilegeOpenValue,this._time=0},getId:function(){return this._id},getType:function(){return this._type},setValue:function(t){this._value=t},getValue:function(){return this._value},setExpirationTime:function(t){this._time=t},getExpirationTime:function(){return this._time},getPrerogativeType:function(){return this._prerogativeType},getPrerogativeOpenValue:function(){return this._privilegeOpenValue},getNextLimitVipLevel:function(){for(var t=td.GetTableClass(td.TableEnum.VipPrivilegeTable).getPrerogativeByTypeAndOpenValue(this._type),e=td.Account.getUserData().getVip(),i=-1,n=0,a=t.length;n<a;n++){var r=t[n].privilegeOpenValue;if(e<r){i=r;break}}return i}});e.exports=n,cc._RF.pop()},{}],PreviousRecordItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"e5777Vu07VJ5ogL0iJ7o2FU","PreviousRecordItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("ListItem"),d=t("BaseUser"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labPhase=null,e.labLv=null,e.labName=null,e.labInput=null,e.nodePlayer=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this.labPhase.string=i.term;var n=new d;this.labInput.string=i.luckActorBetCount,n.init("",i.luckActor),this.labLv.string="Lv."+n.getLevel(),this.labName.string=n.getNickNameAndServer(),this.nodePlayer.removeAllChildren();var a=r.GlobalFunction.createAvatarHeadWidget(3,n,!1);a.x=0,a.y=0,this.nodePlayer.addChild(a)},a([l(cc.Label)],e.prototype,"labPhase",void 0),a([l(cc.Label)],e.prototype,"labLv",void 0),a([l(cc.Label)],e.prototype,"labName",void 0),a([l(cc.Label)],e.prototype,"labInput",void 0),a([l(cc.Node)],e.prototype,"nodePlayer",void 0),e=a([s,c("module/Activity/RareTreasure/PreviousRecordItemUI")],e)}(u);i.default=h,cc._RF.pop()},{BaseUser:"BaseUser",ListItem:void 0}],PreviousRecordsWindow:[function(t,e,i){"use strict";cc._RF.push(e,"a5a5aius3JGXp2vyHe8MFUH","PreviousRecordsWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.phaseScroll=null,e.recordScroll=null,e._recordsListView=null,e._phaseListView=null,e._controller=null,e._selectIndex=0,e._ids=[],e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_RareTreasurePresiouRecords},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._recordsListView||(this._recordsListView=this.recordScroll.getComponent(d)),this._phaseListView||(this._phaseListView=this.phaseScroll.getComponent(d)),this._addEventListners()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListners=function(){var t={};t[r.EventNameEnum.EARETREASURE_SELECT_PHASE_BOX2]=this._refreshWindow,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(){this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10),this._initWindow()},e.prototype._initWindow=function(){var t=[],e=this._controller.getActivityData(),i=r.GetTableClass(r.TableEnum.GoddessBoxTable).getAllBoxByData(e);for(var n in i)t.push(i[n]),this._ids.push(i[n].id);this._selectIndex=-1,this._controller.setBoxSelectIndex(this._selectIndex),this._phaseListView.setData(t),r.EventUtil.dispatchEvent(r.EventNameEnum.EARETREASURE_SELECT_PHASE_BOX2,0)},e.prototype._refreshWindow=function(t){this._selectIndex=t,this._controller.setBoxSelectIndex(this._selectIndex),r.EventUtil.dispatchEvent(r.EventNameEnum.RES_EARETREASURE_SELECT_PHASE_BOX2);var e=this._ids[this._selectIndex],i=this._controller.getRecordsBetTimes(),n=[];if(i){var a=i[e];if(a)for(var o in a)a[o].luckNum&&n.push(a[o])}n.sort(this.sortFun),this._recordsListView.setData(n)},e.prototype.sortFun=function(t,e){return e.term-t.term},a([l(cc.Node)],e.prototype,"phaseScroll",void 0),a([l(cc.Node)],e.prototype,"recordScroll",void 0),e=a([s,c("module/Activity/RareTreasure/PreviousRecordsWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],PropertyModel:[function(t,e,i){"use strict";cc._RF.push(e,"e2f9flbXUdEcYjXDmbM4Q6W","PropertyModel");var n=t("Model"),a=cc.Class({extends:n,properties:{_propertyType:null,_id:null,_sId:null,_name:null,_icon:null,_res:null,_animationType:null},init:function(t,e,i,n,a,r,o){this._super(t||"PropertyModel"),this._propertyType=e,this._id=i,this._name=n,this._icon=a,this._res=r,this._animationType=o},getPropertyType:function(){return this._propertyType},getId:function(){return this._id},setSId:function(t){this._sId=t},getSId:function(){return this._sId},getName:function(){return this._name},getIconRes:function(){return this._icon},getImgRes:function(){return this._res},getCount:function(){return 1},getAnimationType:function(){return this._animationType}});e.exports=a,cc._RF.pop()},{Model:"Model"}],ProtegeEDCmp:[function(t,e,i){"use strict";cc._RF.push(e,"5bd1c66NFtO9q7KpUkWPv/X","ProtegeEDCmp");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r,o=t("../../../EightDiagrams/Manager/EightDiagramsManager"),s=cc._decorator,l=s.ccclass,c=s.property,u=(s.menu,t("PveMapManager")),d=t("PveFightObject"),h=t("PveFightManager");(function(t){t[t.RUN=1]="RUN",t[t.REST=2]="REST",t[t.IDLE=3]="IDLE"})(r||(r={}));var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progress=null,e._curSpeed=0,e._road=null,e._roadId=null,e._curTargetPos=null,e._speedX=null,e._speedY=null,e._curDir=null,e._speakNode=null,e._curPower=0,e.MAX_POWER=3,e._time=0,e._isPowerRecovering=!1,e._isFightBegin=!1,e._isFightOver=!1,e._costPerS=0,e._recoverPerS=0,e._curDirection=null,e._protege=null,e}return n(e,t),e.prototype.onLoad=function(){t.prototype.onLoad.call(this);var e=this.node.getChildByName("powerBar");e&&(this.progress=e.getComponent(cc.ProgressBar))},e.prototype._addListeners=function(){t.prototype._addListeners.call(this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_BEGIN,this._onFightBegin,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_FIGHT_OVER,this._onFightOver,this)},e.prototype.setData=function(t){this._protege=this.node.getComponent("Protege");var e=o.default.getInstance().getCurStoryCfg();if(e){this._curSpeed=e.targetSpeed,this._roadId=e.targetRoad,this.MAX_POWER=e.targetStrength;var i=e.targetCose,n=e.targetRecover;this._costPerS=i,this._recoverPerS=n;var a=u.getLines();this._road=a[this._roadId],this._curPower=this.MAX_POWER,this.progress.node.active=!0;var r=this.node.getComponent(cc.BoxCollider);o.default.getInstance().isChasingType()?(r.offset=cc.Vec2.ZERO,r.size=cc.size(140,140)):(r.offset=cc.v2(0,20),r.size=cc.size(120,30))}else cc.error("\u6ca1\u6709\u627e\u5230\u300a\u516b\u9635\u56fe\u300b\u526f\u672c\u914d\u7f6e: ",o.default.getInstance().getCurStoryId());this._curSpeedMult=h.getCurFightSpeedMult(),this._curPower=this.MAX_POWER,this.progress.node.active=!0,this.node.position=this._road.shift(),this._calcXYSpeed()},e.prototype._resetRoad=function(){var t=u.getLines();this._road=t[this._roadId],this._curPower=this.MAX_POWER,this.node.position=this._road.shift(),this._calcXYSpeed()},e.prototype.update=function(t){if(this._isFightBegin&&!this._isFightOver&&!this._bFightPause){this._time=t*this._curSpeedMult;var e=this._time*this._costPerS,i=this._time*this._recoverPerS;if(this._isPowerRecovering)return this._curPower+=i,this._curPower>=this.MAX_POWER&&(this._curPower=this.MAX_POWER,this._isPowerRecovering=!1,this._playAni(r.RUN)),void this._refreshBar();if(this._curPower<=0||this._isPowerRecovering)return this._isPowerRecovering=!0,this._showTalk(td.Language.ED_restTip),void this._playAni(r.REST);var n=this._curSpeed*this._curSpeedMult;if(!(n<=0)&&this._curTargetPos){this._curPower-=e,this._refreshBar();var a=t*n,o=this._speedX*a,s=this._speedY*a,l=Math.abs,c=Math.ceil;if(l(this._curTargetPos.x-this.node.x)>c(l(o))||l(this._curTargetPos.y-this.node.y)>c(l(s))){var u=td.GlobalFunction.getRotation(cc.v2(this.node.x,this.node.y),cc.v2(this.node.x+o,this.node.y+s)),d=this._getDir(u);this._turnDir(d),this.node.x+=o,this.node.y+=s}else this.node.x=this._curTargetPos.x,this.node.y=this._curTargetPos.y,this._calcXYSpeed()}}},e.prototype._onFightBegin=function(){this._isFightBegin=!0,this._isFightOver=!1,this._playAni(r.RUN)},e.prototype._onFightOver=function(){this._isFightOver=!0,this._isFightBegin=!1},e.prototype._calcXYSpeed=function(){if(0===this._road.length)return this._curTargetPos=null,this._playAni(r.IDLE),void td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_FIGHT_OVER);var t=this.node.getPosition(),e=this._road.shift(),i=e.x-t.x,n=e.y-t.y,a=td.GlobalFunction.getDistance(t,e);this._speedX=i/a,this._speedY=n/a,this._curTargetPos=e},e.prototype._playAni=function(t){t==r.RUN?this._protege._playRun():t==r.REST?this._protege._playRest():t==r.IDLE&&this._protege._playPrincessAnimation(!1,!0),this._turnDir(this._curDir)},e.prototype._getDir=function(t){var e=Math.floor(t/45),i=t%45>22.5?45*(e+1):45*e;return td.PveEnum.DIR_DEGREE[i]},e.prototype._turnDir=function(t){if(t){this._curDir=t;var e=td.PveEnum.DIR_DEGREE_TYPE[t],i=this._protege.getPrincessNode();if(i){var n=i.getComponent(cc.Animation),a=n.currentClip?n.currentClip.name:"";if(e===td.PveEnum.DIR_DEGREE_TYPE.xia)"MaliGongZhu2"!==a&&n.play("MaliGongZhu2");else{var r=e===td.PveEnum.DIR_DEGREE_TYPE.you;"MaliGongZhu2_1"!==a&&(n.play("MaliGongZhu2_1"),i.scaleX=Math.abs(i.scaleX)*(r?-1:1))}}}},e.prototype._refreshBar=function(){this.progress&&(this.progress.progress=this._curPower/this.MAX_POWER)},e.prototype._showTalk=function(t,e){var i=this;void 0===e&&(e=!1),this._speakNode||(this._speakNode=td.GlobalFunction.createPrefabInstance("prefab/Pve/MonsterSpeaker"),this.node.addChild(this._speakNode),this._speakNode.name="speakNode",this._speakNode.anchorX=0,this._speakNode.anchorY=.5,this._speakNode.y=200);var n=this._speakNode.getChildByName("labTip"),a=n.getComponent(cc.Label),r=this._speakNode.getComponent(cc.Layout);this.node.x>360?(this._speakNode.x=0,this._speakNode.scaleX=-1,n.scaleX=-1):(this._speakNode.x=0,this._speakNode.scaleX=1,n.scaleX=1),a.string=t,a.overflow=cc.Label.Overflow.NONE,a._forceUpdateRenderData(),n.width>180&&(n.width=180,a.overflow=cc.Label.Overflow.RESIZE_HEIGHT,a._forceUpdateRenderData()),r.updateLayout(),this._speakNode.active=!0,this._speakNode.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(2),cc.fadeOut(.2),cc.callFunc(function(){i._speakNode.active=!1})))},a([c(cc.ProgressBar)],e.prototype,"progress",void 0),e=a([l],e)}(d);i.default=p,cc._RF.pop()},{"../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager",PveFightManager:"PveFightManager",PveFightObject:"PveFightObject",PveMapManager:"PveMapManager"}],Protege:[function(t,e,i){"use strict";cc._RF.push(e,"663d8iTxq1OZYLHZy4FA22R","Protege");var n=r(t("../../../EightDiagrams/Manager/EightDiagramsManager")),a=r(t("../../../../View/Login/Enum/LoginFsmEventId"));function r(t){return t&&t.__esModule?t:{default:t}}var o=t("PveFightObject"),s=t("PveFightManager"),l=t("PveCopyEnum"),c=cc.Class({extends:o,properties:{_labCount:null,_labAction:null,_bDamaged:null,_bCrying:null,_animationPrincess:null},onLoad:function(){this._super(),this._labCount=this.node.getChildByName("labCount");var t=s.getCurHeartCount();this._labCount.getComponent(cc.Label).string=t,this._bRefreshScale=!0,this._bDamaged=!1,this._bCrying=!1,this._labAction=this.node.getChildByName("labAction"),this._labAction.active=!1,this._animationPrincess&&(this._animationPrincess.removeFromParent(),this._animationPrincess=null),this._playPrincessAnimation(!1,!0)},onDestroy:function(){this._super(),this._labCount=null,this._bDamaged=!1,this._bCrying=!1},update:function(t){this._super(t),this._bDamaged&&!this._bCrying&&(this._bCrying=!0,this._playPrincessAnimation(!0))},refreshView:function(){var t=s.getCurHeartCount();this._labCount.getComponent(cc.Label).string=t},removeSelf:function(){this.node.removeFromParent()},pause:function(){if(this._animationPrincess){this._animationPrincess.getComponent(cc.Animation).pause();var t=this._animationPrincess.getChildByName("hero");if(t){var e=t.getComponent(cc.SkeletonAnimation);e&&e.pause()}}},resume:function(){if(this._animationPrincess){this._animationPrincess.getComponent(cc.Animation).resume();var t=this._animationPrincess.getChildByName("hero");if(t){var e=t.getComponent(cc.SkeletonAnimation);e&&e.resume()}}},onRestartFight:function(){this.refreshView(),this._bDamaged=!1,this._bCrying=!1,this._playPrincessAnimation(!1)},_playPrincessAnimation:function(t,e){if(td.PveCopyManager.getCopyType()!==l.PVEFightType.EightDiagrams||!n.default.getInstance().isChasingType()||(t=!1,e)){this._animationPrincess&&(this._animationPrincess.removeFromParent(),this._animationPrincess=null);var i=t?"MaliGongZhu1":"MaliGongZhu",a=t?gdk.rm.getResByUrl("fightRes/pve/protege/MaliGongZhu1",cc.Prefab):gdk.rm.getResByUrl("fightRes/pve/protege/MaliGongZhu",cc.Prefab);this._animationPrincess=cc.instantiate(a),this._animationPrincess.x=0,this._animationPrincess.y=0,this.node.addChild(this._animationPrincess,-1),this._animationPrincess.getComponent(cc.Animation).play(i)}},_playRun:function(){this._animationPrincess&&(this._animationPrincess.removeFromParent(),this._animationPrincess=null);var t=gdk.rm.getResByUrl("fightRes/pve/protege/MaliGongZhu2",cc.Prefab);this._animationPrincess=cc.instantiate(t),this._animationPrincess.x=0,this._animationPrincess.y=0,this.node.addChild(this._animationPrincess,-1)},_playRest:function(){this._animationPrincess&&(this._animationPrincess.removeFromParent(),this._animationPrincess=null);var t=gdk.rm.getResByUrl("fightRes/pve/protege/MaliGongZhu3",cc.Prefab);this._animationPrincess=cc.instantiate(t),this._animationPrincess.x=0,this._animationPrincess.y=0,this.node.addChild(this._animationPrincess,-1),this._animationPrincess.getComponent(cc.Animation).play("MaliGongZhu3")},getPrincessNode:function(){return this._animationPrincess},playReduceOneAction:function(t){var e=cc.instantiate(this._labAction);e.active=!0,e.setPosition(this._labAction.getPosition()),this.node.addChild(e),e.string=t;var i=cc.moveBy(1,cc.v2(0,60)),n=cc.fadeOut(1),a=cc.spawn(i,n),r=cc.callFunc(function(){e.removeFromParent()}),o=cc.sequence(a,r);e.runAction(o)},onCollisionEnter:function(t){var e=t.node;if(t.node.group===td.PveEnum.COLLISION_GROUP.EnemyGroup){var i=Math.floor(e._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),n=e.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[i]).getDataModel().getHpCost();this._bDamaged=!0;var r=s.getCurHeartCount()-n;r=r<0?0:r,s.setCurHeartCount(r),this.refreshView(),this.playReduceOneAction(n),0===r&&(td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_FIGHT_OVER),td.GuideManager.isFirstBattle()&&gdk.fsm.Fsm.broadcastEvent(a.default.SHOW_CREATE_ROLE_WINDOW))}}});e.exports=c,cc._RF.pop()},{"../../../../View/Login/Enum/LoginFsmEventId":void 0,"../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager",PveCopyEnum:void 0,PveFightManager:"PveFightManager",PveFightObject:"PveFightObject"}],PulseEnum:[function(t,e,i){"use strict";cc._RF.push(e,"e93a6TNCAtH+pjKZs+4cy0E","PulseEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.PulseRankViewType=i.PulseType=void 0,i.PulseType={NONE:0,EXTREME_PULSE:1,SUPER_PULSE:2,HIGH_PULSE:3,MEDIUM_PULSE:4,LOW_PULSE:5},i.PulseRankViewType={Rank:1,Reward:2},cc._RF.pop()},{}],PulseFairylandModel:[function(t,e,i){"use strict";cc._RF.push(e,"bfa36X2SJlApYgbIuJjMegX","PulseFairylandModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("../Manager/PulseManager"),r=function(){function t(){this._isEmpty=!1,this._nation_occupy_min_num=2}return t.prototype.init=function(t){this._id=t;var e=n.GetTableClass(n.TableEnum.PurpleFairylandTable).getDataById(t);this._type=e.type,this._godPulses=e.godPulses,this.initPulses()},t.prototype.initPulses=function(){var t={};this._isEmpty=!1,this._fixRewardBoxId=0;for(var e=0;e<this._godPulses.length;e++){var i=this._godPulses[e];if(d=a.default.getInstance().getPulseByPulseId(i)){var r=d.getAttributes(),o=d.getFixRewardBoxId();if(o>this._fixRewardBoxId&&(this._fixRewardBoxId=o),0===r.myLen())this._isEmpty||(this._isEmpty=!0);else 0!==(h=r[n.UserPropertyEnum.NATION_ID])&&(t[h]||(t[h]=0),t[h]=t[h]+1)}}var s=0,l=0;for(var c in t)t[c]>s&&(s=t[c])>=this._nation_occupy_min_num&&(l=parseInt(c));this._addition=s,this._nationId=l;var u="[%s"+n.Language.arena+"]%s";for(e=0;e<this._godPulses.length;e++){var d,h;i=this._godPulses[e];if(d=a.default.getInstance().getPulseByPulseId(i))if(d.setAddition(0),s>=this._nation_occupy_min_num)0!==(h=d.getAttributes()[n.UserPropertyEnum.NATION_ID])&&h===this._nationId&&(d.setAddition(s),this._nationName=cc.js.formatStr(u,d.getAttributes()[n.UserPropertyEnum.ServerId],d.getAttributes()[n.UserPropertyEnum.NATION_NAME]),this._nationFlagName=d.getAttributes()[n.UserPropertyEnum.NATION_FLAG],this._nationFlagId=d.getAttributes()[n.UserPropertyEnum.NATION_FLAGID])}},t.prototype.getFixRewardBoxId=function(){return this._fixRewardBoxId},t.prototype.getId=function(){return this._id},t.prototype.getGodPulses=function(){return this._godPulses},t.prototype.getType=function(){return this._type},t.prototype.getNationId=function(){return this._nationId},t.prototype.getNationName=function(){return this._nationName},t.prototype.getIsEmpty=function(){return this._isEmpty},t.prototype.getAddition=function(){return this._addition},t.prototype.getNationFlagId=function(){return this._nationFlagId},t.prototype.getNationFlagName=function(){return this._nationFlagName},t}();e.exports=r,cc._RF.pop()},{"../Manager/PulseManager":"PulseManager"}],PulseManager:[function(t,e,i){"use strict";cc._RF.push(e,"48e8cH+9L5BOKCU49QYfwg1","PulseManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,window.td),s=t("PulseFairylandModel"),l=t("PulseModel"),c=t("ActorPulseModel"),u=t("PulseRankModel"),d=function(){function t(){this._pageNum=0,this._isLoad=!1,this._openReportIndex=-1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._pulseFairylands=[],this._pulseList={},this._rankList=[],this._efficiencys=[],this._additions=[],this._time_unit=[],this._myRankInfo=null,this._openReportIndex=-1,this._isLoad=!1},t.prototype.addListener=function(){var t=o.MsgModuleName.PurpleFairyland,e=o.MsgCmd.PurpleFairyland;o.ServerDelegate.registerMessage(t,e.GET_PURPLE_FAIRYLAND,this.responsePurple.bind(this)),o.ServerDelegate.registerMessage(t,e.GET_PULSE_INFO,this.responsePulse.bind(this)),o.ServerDelegate.registerMessage(t,e.OCCUPY_PULSE,this.responseOccupy.bind(this)),o.ServerDelegate.registerMessage(t,e.EXPLOIT_PULSE,this.responseExploit.bind(this)),o.ServerDelegate.registerMessage(t,e.RECEIVE_REWARD,this.responseReward.bind(this)),o.ServerDelegate.registerMessage(t,e.ABANDON_PULSE,this.responseAbandon.bind(this)),o.ServerDelegate.registerMessage(t,e.BUY_TIME,this.responseBuyTime.bind(this)),o.ServerDelegate.registerMessage(t,e.GET_PULSE_RANK,this.responseRank.bind(this)),o.ServerDelegate.registerMessage(t,e.BUY_PULSE_ADDITION,this.responseBuyAddition.bind(this)),o.ServerDelegate.registerMessage(t,e.GET_PULSE_ID,this.responsePulseId.bind(this)),o.ServerDelegate.registerMessage(t,e.BUY_OCCUPY_TIMES,this.responseBuyOccupyTimes.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_PULSE_DATA,this.responsePurple.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_ACTOR_PULSE_DATA,this.responsePulse.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_ACTOR_MINE_RANK,this.responseRank.bind(this))},t.prototype.responsePurple=function(t,e){var i=this;if(t===o.NetCode.SUCCESS){this._isLoad||this.loadCfg();var n=e.purpleFairylandList;n&&0!==n.length&&(n.forEach(function(t){var e=t.pulseId;i._pulseList[e]?i._pulseList[e].setData(t):console.error("\u4f20\u5165pulseId\u5f02\u5e38,\u627e\u4e0d\u5230\u6570\u636e  pulseId:"+e)}),this._actorPulseModel&&this._actorPulseModel.initMyPulse(),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GET_PURPLE_FAIRYLAND,n))}},t.prototype.responsePulse=function(t,e){t===o.NetCode.SUCCESS&&(this._actorPulseModel||(this._actorPulseModel=new c),this._actorPulseModel.setData(e.actorPulseVO),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GET_PULSE_INFO))},t.prototype.responseOccupy=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_OCCUPY_PULSE)},t.prototype.responseExploit=function(t,e){if(t===o.NetCode.SUCCESS&&e){var i=e.result;if(i){var n=o.RewardManager.parseRewardResult(i);o.GlobalFunction.showRewards(n),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_EXPLOIT_PULSE)}}},t.prototype.responseReward=function(t,e){if(t===o.NetCode.SUCCESS&&e){var i=e.result,n=o.RewardManager.parseRewardResult(i);o.GlobalFunction.showRewards(n),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_RECEIVE_REWARD)}},t.prototype.responseAbandon=function(t,e){t===o.NetCode.SUCCESS&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_ABANDON_PULSE)},t.prototype.responseBuyTime=function(t,e){if(t===o.NetCode.SUCCESS){var i=new o.BroadcastContent(47);o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_BROADCAST,i),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_BUY_TIME)}},t.prototype.responseBuyAddition=function(t,e){if(t===o.NetCode.SUCCESS){var i=new o.BroadcastContent(47);o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_BROADCAST,i),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_BUY_PULSE_ADDITION)}},t.prototype.responseRank=function(t,e){if(t===o.NetCode.SUCCESS&&e){var i=e.collection;this._rankList=[],i.length>0&&(this._myRankInfo=new u,this._myRankInfo.init(i[i.length-1]),i.splice(i.length-1,1));for(var n=0,a=i.length;n<a;n++){var r=new u;r.init(i[n]),this._rankList[this._rankList.length]=r}o.EventUtil.dispatchEvent(o.EventNameEnum.RES_GET_PULSE_RANK)}},t.prototype.responseBuyOccupyTimes=function(t){if(t===o.NetCode.SUCCESS){var e=new o.BroadcastContent(47);o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_BROADCAST,e),o.EventUtil.dispatchEvent(o.EventNameEnum.ON_GET_PULSE_ID_FOR_USER)}},t.prototype.responsePulseId=function(t,e){if(t===o.NetCode.SUCCESS&&e){var i=e.id;o.EventUtil.dispatchEvent(o.EventNameEnum.ON_GET_PULSE_ID_FOR_USER,i)}},t.prototype.addEventListener=function(){var t=o.EventUtil,e=o.EventNameEnum,i={};i[e.REQ_GET_PURPLE_FAIRYLAND]=this.requestPurple,i[e.REQ_GET_PULSE_INFO]=this.requestPulse,i[e.REQ_OCCUPY_PULSE]=this.requestOccupy,i[e.REQ_EXPLOIT_PULSE]=this.requestExploit,i[e.REQ_RECEIVE_REWARD]=this.requestReward,i[e.REQ_ABANDON_PULSE]=this.requestAbandon,i[e.REQ_BUY_TIME]=this.requestBuyTime,i[e.REQ_BUY_PULSE_ADDITION]=this.requestBuyAddition,i[e.REQ_GET_PULSE_RANK]=this.requestRank,i[e.REQ_BUY_OCCUPY_TIMES]=this.requestBuyOccupyTimes,i[e.GET_PULSE_ID_FOR_USER]=this.requestPulseIdByActorId,i[e.ON_GET_SERVER_START_DAYS]=this.reqInfo,i[e.USER_ATTR_LEVEL_CHANGE]=this.reqInfo,t.registerEvents(i,this)},t.prototype.reqInfo=function(){this.requestPurple(),this.requestPulse()},t.prototype.requestPurple=function(){if(o.UnlockManager.isTargetUnlock(o.ActorUnlockType.PULSE,0)){var t={};t.module=o.MsgModuleName.PurpleFairyland,t.cmd=o.MsgCmd.PurpleFairyland.GET_PURPLE_FAIRYLAND,o.ServerDelegate.sendMessage(t)}},t.prototype.requestPulse=function(){if(o.UnlockManager.isTargetUnlock(o.ActorUnlockType.PULSE,0)){var t={};t.module=o.MsgModuleName.PurpleFairyland,t.cmd=o.MsgCmd.PurpleFairyland.GET_PULSE_INFO,o.ServerDelegate.sendMessage(t)}},t.prototype.requestOccupy=function(t){var e={};e.module=o.MsgModuleName.PurpleFairyland,e.cmd=o.MsgCmd.PurpleFairyland.OCCUPY_PULSE,e.pulseId=t,o.ServerDelegate.sendMessage(e)},t.prototype.requestExploit=function(t){var e={};e.module=o.MsgModuleName.PurpleFairyland,e.cmd=o.MsgCmd.PurpleFairyland.EXPLOIT_PULSE;var i=t[0];if(e.pulseId=i,t[1]){var n=t[1];e.para=n}o.ServerDelegate.sendMessage(e)},t.prototype.requestReward=function(t){var e={};e.module=o.MsgModuleName.PurpleFairyland,e.cmd=o.MsgCmd.PurpleFairyland.RECEIVE_REWARD,e.pulseId=t,o.ServerDelegate.sendMessage(e)},t.prototype.requestAbandon=function(t){var e={};e.module=o.MsgModuleName.PurpleFairyland,e.cmd=o.MsgCmd.PurpleFairyland.ABANDON_PULSE,e.pulseId=t,o.ServerDelegate.sendMessage(e)},t.prototype.requestBuyTime=function(t){var e={};e.module=o.MsgModuleName.PurpleFairyland,e.cmd=o.MsgCmd.PurpleFairyland.BUY_TIME;var i=t[0];if(e.pulseId=i,t[1]){var n=t[1];e.para=n}o.ServerDelegate.sendMessage(e)},t.prototype.requestBuyAddition=function(t){var e={};e.module=o.MsgModuleName.PurpleFairyland,e.cmd=o.MsgCmd.PurpleFairyland.BUY_PULSE_ADDITION,e.id=t,o.ServerDelegate.sendMessage(e)},t.prototype.requestRank=function(){var t={};t.module=o.MsgModuleName.PurpleFairyland,t.cmd=o.MsgCmd.PurpleFairyland.GET_PULSE_RANK,o.ServerDelegate.sendMessage(t)},t.prototype.requestBuyOccupyTimes=function(t){var e={};e.module=o.MsgModuleName.PurpleFairyland,e.cmd=o.MsgCmd.PurpleFairyland.BUY_OCCUPY_TIMES,e.times=t,o.ServerDelegate.sendMessage(e)},t.prototype.requestPulseIdByActorId=function(t){var e={};e.module=o.MsgModuleName.PurpleFairyland,e.cmd=o.MsgCmd.PurpleFairyland.GET_PULSE_ID,e.id=t,o.ServerDelegate.sendMessage(e)},t.prototype.loadCfg=function(){var t=o.GetTableClass(o.TableEnum.PurpleFairylandPulseTable).getAllData();for(var e in t){var i=parseInt(e),n=new l;n.init(i),this._pulseList[i]=n}this._isLoad=!0},t.prototype.getPulseByPulseId=function(t,e){if(void 0===e&&(e=!1),e){var i=this._pulseList[t].getFairylandId();this.getPulsesByPulseFairylandId(i)}return this._pulseList[t]},t.prototype.getActorPulseModel=function(){return this._actorPulseModel},t.prototype.getPageByPulseFairylandId=function(t){return 0===this._pageNum&&(this._pageNum=o.GetConfig("PULSE_FAIRYLAND_ONEPAGENUM")),Math.floor((t-1)/this._pageNum)},t.prototype.getPulsesByPulseFairylandId=function(t){var e=new s;return e.init(t),e},t.prototype.getPulseFairylandByPage=function(t){0===this._pageNum&&(this._pageNum=o.GetConfig("PULSE_FAIRYLAND_ONEPAGENUM"));for(var e=0;e<this._pageNum;e++){var i=t*this._pageNum-e;this._pulseFairylands[e]||(this._pulseFairylands[e]=new s),this._pulseFairylands[e].init(i)}return this._pulseFairylands},t.prototype.getEmptyPulse=function(){var t={};for(var e in this._pulseList){var i=this._pulseList[e],n=i.getType();if(!t[n])0===i.getAttributes().myLen()&&(t[n]=i)}return t},t.prototype.getLeftTimes=function(){return this._actorPulseModel.getLeftTimes()},t.prototype.getPulseFairylandByNationId=function(t){var i={},n=e.getInstance().getActorPulseModel().getPulseId();for(var a in this._pulseList){var r=this._pulseList[a],l=r.getAttributes()[o.UserPropertyEnum.NATION_ID];r.getAttributes();if(0!==l&&l===t&&(0===n||n!==r.getPulseId())){var c=r.getFairylandId();i[c]||(i[c]=new s,i[c].init(c))}}return i},t.prototype.getOutputByPulseType=function(t){var e=0;0===this._efficiencys.length&&(this._efficiencys=o.GetConfig("PULSE_OUTPUT_EFFICIENCY")),0===this._time_unit.length&&(this._time_unit=o.GetConfig("PULSE_OUTPUT_EFFICIENCY_TIME"));for(var i=this._efficiencys[0][2],n=0;n<this._time_unit.length;n++)if(t===this._time_unit[n][0]){e=Math.floor(3600*i/this._time_unit[n][1]);break}return e},t.prototype.getMinTimeByType=function(t){0===this._time_unit.length&&(this._time_unit=o.GetConfig("PULSE_OUTPUT_EFFICIENCY_TIME"));for(var e=this._time_unit[0][1],i=0;i<this._time_unit.length;i++)if(t===this._time_unit[i][0]){e=this._time_unit[i][1];break}return e},t.prototype.getPulseByActorId=function(t){for(var e in this._pulseList){var i=this._pulseList[e],n=i.getAttributes();if(n&&0!==n.myLen()&&n[o.UserPropertyEnum.GamerId]===t)return i}return null},t.prototype.getAdditioneByNumAndEffect=function(t,e){0===this._additions.length&&(this._additions=o.GetConfig("NATION_MINE_ADD_RATE"));for(var i=0,n=0;n<this._additions.length;n++)if(t===this._additions[n][0]){i=this._additions[n][1];break}return(i?1+i/1e4:1)*(e?1+e/1e4:1)},t.prototype.getPulseFairylandIdByPulseId=function(t){return o.GetTableClass(o.TableEnum.PurpleFairylandPulseTable).getDataById(t).fairylandId},t.prototype.getRankList=function(){return this._rankList},t.prototype.getMyRankInfo=function(){return this._myRankInfo},t.prototype.setPulseId=function(t){this._pulseId=t},t.prototype.getPulseId=function(){return this._pulseId},t.prototype.getOpenReportIndex=function(){return this._openReportIndex},t.prototype.saveOpenReportIndex=function(t){this._openReportIndex=t},t.prototype.clearOpenReportIndex=function(){this._openReportIndex=-1},t.prototype.isRedPointTips=function(){return!!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.PULSE,0)&&(!!this.isTaskRedPointTips()||(!!this.checkOpenStatue()||this._actorPulseModel.getLeftTimes()>0&&0===this._actorPulseModel.getPulseId()))},t.prototype.redPointEvents=function(){return[o.EventNameEnum.RES_GET_PULSE_INFO,o.EventNameEnum.Res_GET_TASK_INFO]},t.prototype.isTaskRedPointTips=function(){for(var t=o.GetTableClass(o.TableEnum.TaskTable).getTaskByType(o.TaskType.PULSE),e=0;e<t.length;e++){var i=o.TaskManager.getTaskById(t[e].taskId);if(i&&i.getStatus()===o.TaskStatus.Finish)return!0}return!1},t.prototype.openTips=function(){var t=o.TimeUtil.getTime();this._lastOpenTipsTimestamp=t},t.prototype.checkOpenStatue=function(){for(var t,e=o.GetConfig("PULSE_FIXED_REWARD_TIME"),i=o.TimeUtil.getServerDate(),n=i.getHours(),a=i.getMinutes(),r=!1,s=0;s<e.length;s++)e[s][0]===n&&a<e[s][1]&&(r=!0,t=o.TimeUtil.getStampByHours(e[s][0]+":00"));return!(!r||this._lastOpenTipsTimestamp&&!(this._lastOpenTipsTimestamp<t))},t=e=n([r],t)}();i.default=d,cc._RF.pop()},{ActorPulseModel:"ActorPulseModel",PulseFairylandModel:"PulseFairylandModel",PulseModel:"PulseModel",PulseRankModel:"PulseRankModel"}],PulseModel:[function(t,e,i){"use strict";cc._RF.push(e,"dc0afbiI6hAZrdBkZofAzMF","PulseModel");var n=window.td,a=function(){function t(){this._addition=0,this._additionId=0,this._effect=0}return t.prototype.init=function(t){this._pulseId=t;var e=n.GetTableClass(n.TableEnum.PurpleFairylandPulseTable).getDataById(t);e&&(this._type=e.type,this._fairylandId=e.fairylandId,this._orderId=e.orderId),this._attributes={},this._pulseTimeOut=0,this._fixRewardBoxId=0},t.prototype.setData=function(t){if(void 0!==t.attributes&&(this._attributes=t.attributes),void 0!==t.pulseTimeOut&&(this._pulseTimeOut=t.pulseTimeOut),void 0!==t.lastReceiveTime&&(this._lastReceiveTime=t.lastReceiveTime),void 0!==t.nextOccupyPulseRewardTime&&(this._nextOccupyPulseExtraRewardTime=t.nextOccupyPulseRewardTime),void 0!==t.lastOccupyPulseTime&&(this._lastOccupyPulseTime=t.lastOccupyPulseTime),void 0!==t.fixRewardBoxId&&(this._fixRewardBoxId=t.fixRewardBoxId),void 0!==t.additionId)if(this._additionId=t.additionId,this._additionId>0){var e=n.GetTableClass(n.TableEnum.PurpleFairylandAdditionTable).getDataById(this._additionId);this._effect=e.effect}else this._effect=0},t.prototype.getPulseId=function(){return this._pulseId},t.prototype.getType=function(){return this._type},t.prototype.getFairylandId=function(){return this._fairylandId},t.prototype.getOrderId=function(){return this._orderId},t.prototype.getFixRewardBoxId=function(){return this._fixRewardBoxId},t.prototype.getAttributes=function(){return this._attributes},t.prototype.getPulseTimeOut=function(){return this._pulseTimeOut},t.prototype.getLastReceiveTime=function(){return this._lastReceiveTime},t.prototype.getNextOccupyPulseExtraRewardTime=function(){return this._nextOccupyPulseExtraRewardTime},t.prototype.getAdditionId=function(){return this._additionId},t.prototype.getAdditionEffect=function(){return this._effect},t.prototype.setAddition=function(t){this._addition=t},t.prototype.getAddition=function(){return this._addition},t.prototype.getLastOccupyPulseTime=function(){return this._lastOccupyPulseTime},t}();e.exports=a,cc._RF.pop()},{}],PulseRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"10ec6P/XgtGC7kmYUhE+Gds","PulseRankModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._rank=0,e._mineCount=0,e}return n(e,t),e.prototype.init=function(e,i){void 0===i&&(i="PulseRankModel"),e&&(t.prototype.init.call(this,i,e.attributes),this._rank=e.rank||0,this._mineCount=e.mineCount||0)},e.prototype.getRank=function(){return this._rank},e.prototype.getMineCount=function(){return this._mineCount},e}(t("BaseUser")));e.exports=a,cc._RF.pop()},{BaseUser:"BaseUser"}],PulseRankRewardConfig:[function(t,e,i){"use strict";cc._RF.push(e,"ce1fd1gAxtNhLmbH2HD9cQP","PulseRankRewardConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PulseRankRewardConfig",e._tblName="pulse_rank_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}t.sort(function(t,e){return t.rank-e.rank});for(var r=0,o=t.length;r<o;r++){var s=t[r];s.maxRank=s.rank,s.minRank=t[r-1]?t[r-1].rank+1:s.rank}},e.prototype.getRankRewardConfigs=function(){return this._data},e.prototype.getDataByRank=function(t){if(this._data)for(var e=this._data,i=0,n=e.length;i<n;i++){var a=e[i];if(a.minRank<=t&&a.maxRank>=t)return a}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PulseRecordModel:[function(t,e,i){"use strict";cc._RF.push(e,"f8ae4GSgVBMPYOKBUuUBebC","PulseRecordModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isPlayer=!1,e._isDefendSuccess=!1,e._lossCount=0,e}return n(e,t),e.prototype.init=function(e,i){void 0===i&&(i="PulseRecordModel"),e&&(t.prototype.init.call(this,i,e.attributes),this._fightTime=e.fightTime||0,this._durationTime=e.durationTime||0,this._targetPulseId=e.targetPulseId||0,this._allocationPulseId=e.allocationPulseId||0,this._lossCount=e.lossCount||0,this._isDefendSuccess=this._allocationPulseId===this._targetPulseId)},e.prototype.getFightTime=function(){return this._fightTime},e.prototype.setIsPlayer=function(t){this._isPlayer=t},e.prototype.isPlayer=function(){return this._isPlayer},e.prototype.isDefendSuccess=function(){return this._isDefendSuccess},e.prototype.getNewPulseId=function(){return this._allocationPulseId},e.prototype.getDefendPulseId=function(){return this._targetPulseId},e.prototype.getOccupyDuration=function(){return this._durationTime},e.prototype.getLossCount=function(){return this._lossCount},e}(t("BaseUser")));e.exports=a,cc._RF.pop()},{BaseUser:"BaseUser"}],PureHurt2Buff:[function(t,e,i){"use strict";cc._RF.push(e,"73e1f/KpdJFuqoykRI6u0YV","PureHurt2Buff");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_clipName:null,_bShowBuff:null},initData:function(t){if(this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.PureHurt2,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff){var e=this.node.addComponent(cc.Sprite);e.atlas=gdk.rm.getResByUrl("fightRes/pve/buff/buff",cc.SpriteAtlas),e.sizeMode=cc.Sprite.SizeMode.RAW,e.trim=!1,this.node.addComponent(cc.Animation);var i=gdk.rm.getResByUrl("fightRes/pve/buff/burnAnimation",cc.AnimationClip);this._clipName=i.name,this.node.getComponent(cc.Animation).addClip(i,this._clipName),cc.log("this is burn buff !!!")}},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this.node.setScale(2),this._curSpeedMult=a.getCurFightSpeedMult(),this._bShowBuff&&(this.refreshSkillAnimationSpeed(this._curSpeedMult),this.node.getComponent(cc.Animation).play(this._clipName)),this.schedule(this.onUpdateBurnBuff,1/this._curSpeedMult)):this.removeSelf()},onDisable:function(){this._super(),this.unschedule(this.onUpdateBurnBuff)},onChangeSpeedMult:function(t){this._super(t),this._bShowBuff&&this.refreshSkillAnimationSpeed(t),this.unschedule(this.onUpdateBurnBuff),this.schedule(this.onUpdateBurnBuff,1/this._curSpeedMult)},refreshSkillAnimationSpeed:function(t){for(var e=this.node.getComponent(cc.Animation),i=e.getClips(),n=0,a=i.length;n<a;n++){if(i[n])e.getAnimationState(i[n].name).speed=t}},onUpdateBurnBuff:function(t){if(!this._bFightPause)if(this._curBuffData.buffTime<=0)this.endBuff();else if(this._curTarget.getParent()){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=(i.getDataModel(),this._curBuffData.buffData);this._curBuffData.buffTime-=t*this._curSpeedMult,i.setHurt(this._heroSid,n,this._curBuffData.hurtType)}},endBuff:function(){(this.unschedule(this.onUpdateBurnBuff),this._super(),cc.isValid(this._curTarget))&&this._curTarget.getComponent("EnemyBuffCtrlComponent").removeBuffFromList(this._buffType,this._curBuffKey)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],PurpleFairylandAdditionTable:[function(t,e,i){"use strict";cc._RF.push(e,"1592bhyk3VIv6/WhSCr3/F2","PurpleFairylandAdditionTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PurpleFairylandAdditionConfig",e._tblName="purple_fairyland_addition_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];this._data[n.id]=n}},e.prototype.getDataById=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PurpleFairylandPulseTable:[function(t,e,i){"use strict";cc._RF.push(e,"1b19djmnYJD/p+5hcqdRfDM","PurpleFairylandPulseTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PurpleFairylandPulseConfig",e._tblName="purple_fairyland_pulse_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];this._data[n.id]=n}},e.prototype.getDataById=function(t){return this._data[t]},e.prototype.getAllData=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PurpleFairylandTable:[function(t,e,i){"use strict";cc._RF.push(e,"6c204CykkpEw507HGfwx4YE","PurpleFairylandTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="PurpleFairylandConfig",e._tblName="purple_fairyland_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];this._data[n.id]=n}},e.prototype.getDataById=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PvPNodePoolManager:[function(t,e,i){"use strict";cc._RF.push(e,"afea41M/nBIvY7J5B3nzWoJ","PvPNodePoolManager");var n={_skillEffectMap:null,_prefabPoolMap:null,_nodePoolMap:null,init:function(){this._skillEffectMap={},this._prefabPoolMap={},this._nodePoolMap={}},onDestroy:function(){for(var t in this._skillEffectMap){this._skillEffectMap[t].clear()}for(var e in this._prefabPoolMap){this._prefabPoolMap[e].clear()}for(var i in this._nodePoolMap){this._nodePoolMap[i].clear()}},getSkillEffectNodePool:function(t){var e=this._skillEffectMap[t];return e?e.get():null},putSkillEffectNodeToPool:function(t,e){this._skillEffectMap[t]||(this._skillEffectMap[t]=new cc.NodePool),this._skillEffectMap[t].put(e)},getPrefabFromNodePool:function(t){return this._prefabPoolMap[t]&&0!=this._prefabPoolMap[t].size()?this._prefabPoolMap[t].get():null},putPrefabToNodePool:function(t,e){this._prefabPoolMap[t]||(this._prefabPoolMap[t]=new cc.NodePool),this._prefabPoolMap[t].put(e)},getNodeFromNodePool:function(t){return this._nodePoolMap[t]&&0!=this._nodePoolMap[t].size()?this._nodePoolMap[t].get():null},putNodeToNodePool:function(t,e){this._nodePoolMap[t]||(this._nodePoolMap[t]=new cc.NodePool),this._nodePoolMap[t].put(e)}};e.exports=n,cc._RF.pop()},{}],PveAnimationObject:[function(t,e,i){"use strict";cc._RF.push(e,"aaa03rS0f9JX6ue6IWdU8v3","PveAnimationObject");var n=t("PveFightObject"),a=t("PveNodePoolManager"),r=cc.Class({extends:n,properties:{_endDestroy:!0},onChangeSpeedMult:function(t){this._super(t),this.refreshSkillAnimationSpeed(t);var e=this.node.getComponent(cc.Animation);e.off("finished",this.removeSelf,this),e.play(e.defaultClip.name),e.on("finished",this.removeSelf,this)},refreshSkillAnimationSpeed:function(t){for(var e=this.node.getComponent(cc.Animation),i=e.getClips(),n=0,a=i.length;n<a;n++)if(i[n]){var r=e.getAnimationState(i[n].name);r&&(r.speed=t)}},onRestartFight:function(){this.removeSelf()},onFightOver:function(){this.removeSelf()},setEndDestroy:function(t){this._endDestroy=t},removeSelf:function(){this._endDestroy?cc.isValid(this.node)&&this.node.parent&&this.node.destroy():cc.isValid(this.node)&&this.node.parent&&a.putTowerSkillNode(this.node.name,this.node)}});e.exports=r,cc._RF.pop()},{PveFightObject:"PveFightObject",PveNodePoolManager:"PveNodePoolManager"}],PveBaseBuff:[function(t,e,i){"use strict";cc._RF.push(e,"99455wpLllHtrmGnfLSwqdZ","PveBaseBuff");var n=t("PveFightObject"),a=cc.Class({extends:n,properties:{_curBuffKey:null,_curTarget:null,_curBuffData:null,_buffType:null,_heroSid:null},initData:function(t){this._curBuffKey=t.buffKey,this._curTarget=t.target,this._curBuffData=t.curBuffData,this._heroSid=t.heroSid,this._bRefreshScale=!1},onEnable:function(){this.addLocalListener()},addLocalListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.REMOVE_PVE_BUFF,this.removeBuff,this)},removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},onDisable:function(){this.removeListeners()},onChangeSpeedMult:function(t){this._super(t)},onRestartFight:function(){this.endBuff()},onFightOver:function(){this.endBuff()},refreshSkillAnimationSpeed:function(t){},pause:function(){this.node.pauseAllActions();var t=this.node.getComponent(cc.Animation);t&&t.pause()},resume:function(){this.node.resumeAllActions();var t=this.node.getComponent(cc.Animation);t&&t.resume()},removeBuff:function(t){t===this._curTarget._tag&&this.endBuff()},endBuff:function(){this.node.stopAllActions(),this.removeSelf()},removeSelf:function(){this.node.destroy()},putToNodePool:function(){if(PveFightManager.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.FIHGT){var t=this._curBuffData.buffType;PveNodePoolManager.putBuffInPoolWithType(t,this.node)}}});e.exports=a,cc._RF.pop()},{PveFightObject:"PveFightObject"}],PveBaseGateModel:[function(t,e,i){"use strict";cc._RF.push(e,"1bd70KbL71FB7YZ9H55+Fso","PveBaseGateModel");var n=cc.Class({_chapterId:null,_gateId:null,_gateIndex:null,_imgMapRes:null,_tiledMapRes:null,_gateId2:null,_hpTimes:null,_roadIndex:null,_mapIndex:null,init:function(t){this._gateId=t.storyId,this._gateIndex=t.gateIndex||1,this._chapterId=t.chapterId,this._gateId2=t.gateId,this._hpTimes=t.hpTimes,this._imgMapRes=gdk.rm.getResByUrl(t.mapRes,cc.SpriteFrame),this._tiledMapRes=gdk.rm.getResByUrl(t.roadRes,cc.TiledMapAsset),this._roadIndex=t.roadIndex,this._mapIndex=t.mapIndex},getChapterId:function(){return this._chapterId},getGateId:function(){return this._gateId},getGateId2:function(){return this._gateId2},getHpTimes:function(){return this._hpTimes},getMapIndex:function(){return this._mapIndex},getGateIndex:function(){return this._gateIndex},getImgMapRes:function(){return this._imgMapRes},getTiledMapRes:function(){return this._tiledMapRes},getRoadIndex:function(){return this._roadIndex}});e.exports=n,cc._RF.pop()},{}],PveBaseTower:[function(t,e,i){"use strict";var n;cc._RF.push(e,"8e01ct151hLyLsFve6dsH8D","PveBaseTower");t("CommonEnum");var a=t("PveFightObject"),r=t("AnimationComponent"),o=t("PveFightManager"),s=t("PveUiManager"),l=t("PveNodePoolManager"),c=t("OrdinaryBullet"),u=t("WithoutBallisticBullet"),d=t("SpriteAnimation"),h=t("UFButton"),p=t("PveMapManager"),_=t("PveCopyEnum"),g=(t("PveEnum"),cc.Class(((n={extends:a,properties:{_heroResPrefix:"",_heroId:null,_vocationType:null,_curAttackInterval:null,_deltaAttackInterval:null,_curAttackRange:null,_curSeriesAttackTimes:null,_curSeriesAttackInterval:null,_curIsSeriesAttack:!1,_curOrdiraryAttackAdd:null,_curSkillAttackAdd:null,_monsterEffctSpeedRate:1,_curDirection:{default:td.PveEnum.PVE_DIRECTION.DOWN,displayName:"\u5f53\u524d\u52a8\u753b\u7684\u671d\u5411",tooltip:"\u5bf9\u5e94\u5e27\u52a8\u753b\u7684\u540d\u79f0\u91cc\u7684\u65b9\u5411\uff0c\u9ed8\u8ba4\u65b9\u5411\u671d\u4e0b"},_curHeroActionType:{default:td.PveEnum.PVE_ACTION_TYPE.Idle,displayName:"\u5f53\u524d\u52a8\u4f5c\u7c7b\u578b",tooltip:"\u5bf9\u5e94\u5e27\u52a8\u753b\u7684\u540d\u79f0\u91cc\u7684\u52a8\u4f5c\u7c7b\u578b\uff0c\u9ed8\u8ba4\u4e3a\u5f85\u673a\u52a8\u4f5c"},_spriteHero:null,_spriteHeroScript:null,_curTargetEnemy:null,_posTag:null,_curSkillTrigger:null,_attackTimes:null,_fightTime:null,_skillCdTime:null,_bInspiring:null,_attackEffectNode:null,_curAttackClipName:null,_bSkillReleased:null,_upSpeedTimes:1,_isPlayingAttack:!1,_shadowScale:1,_skillNodeTop:null,_skillNodeDimian:null,_speakNode:null,_speedMuti:1,_bFreeze:!1,_curTmpSpeed:1,GUIDE_SKILL_IDS:null,_isPetTower:null,_curPetTime:null,MAX_PET_TIME:null},initData:function(t){var e=t.heroDataModel,i=e.getPveSkillModel();this._posTag=t.posTag,this._isPetTower=e.isPet(),this.GUIDE_SKILL_IDS=[9993,9994],this._dataModel=e,this._heroResPrefix=e.getRes(),this._heroId=e.getId(),this._vocationType=e.getFeatures(),this._curAttackInterval=e.getAttackInterval(),this._curAttackRange=e.getAttackRange(),this._shadowScale=e.getShadowScale(),this._curOrdiraryAttackAdd=1,this._curSkillAttackAdd=1,this._curSeriesAttackTimes=1,this._curSeriesAttackInterval=0,this._curIsSeriesAttack=!1,this._bInspiring=!1,this._bRefreshScale=!1,this._bSkillReleased=!1,this._speedMuti=1,this._curSpeedMult=o.getCurFightSpeedMult(),this._curTmpSpeed=this._curSpeedMult,this._monsterEffctSpeedRate=1;var n=this.node.getChildByName("shadow");n.scale=this._shadowScale,n.active=!td.PveCopyManager.isHook(),this._spriteHero&&this._spriteHeroScript||(this._spriteHero=this.node.getChildByName("hero"),this._spriteHero.scale=td.PveEnum.HeroScale,this._spriteHeroScript=this._spriteHero.addComponent(d)),this._spriteHeroScript.setFightType(1),this._spriteHeroScript.init(e,7),this._spriteHeroScript.onChangeAnimationSpeed(this._curTmpSpeed),this._attackEffectNode&&(this._attackEffectNode.removeFromParent(),this._attackEffectNode=null),this._deltaAttackInterval=this._curAttackInterval,this._attackTimes=0,this._fightTime=0,this._skillCdTime=0,this._curSkillTrigger=[],i&&(this._curSkillTrigger=i.getTriggerCfg()),this._playAttackAnimation(),this._bFreeze=!1,this._isPetTower&&(this._curPetTime=0,this.MAX_PET_TIME=td.GetConfig("PET_PVE_SHOW_TIME"),this.schedule(this.updatePetTowerTime,.1))},getHeroModel:function(){return this._dataModel},getPosTag:function(){return this._posTag},_addListeners:function(){this._super(),td.EventUtil.registerEvent(td.EventNameEnum.PVE_HOOK_HERO_SPEAK,this._heroSpeak,this)},getBaseAttackPower:function(){return td.PveCopyManager.getCopyType()===_.PVEFightType.EightDiagrams?this._dataModel.getRecoverFixPower():this._dataModel.getAttackPower()},_heroSpeak:function(t){var e=this,i=t.tag;if(this.node._tag===i){if(!this._speakNode){this._speakNode=new cc.Node,this.node.addChild(this._speakNode),this._speakNode.anchorX=0,this._speakNode.anchorY=.5,this._speakNode.y=120,this._speakNode.name="speakName",td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"pve_qipaokuang",this._speakNode);var n=this._speakNode.getComponent(cc.Sprite);n.sizeMode=cc.Sprite.SizeMode.CUSTOM,n.type=cc.Sprite.Type.SLICED;var a=new cc.Node;a.name="labTip",a.anchorX=.5,a.anchorY=.5,a.x=15,a.y=4,a.color=cc.color(40,90,173);var r=a.addComponent(cc.Label);r.fontSize=22,r.lineHeight=32,this._speakNode.addChild(a),this.node.x>360?(this._speakNode.x=-20,this._speakNode.scaleX=-1,a.scaleX=-1):(this._speakNode.x=20,this._speakNode.scaleX=1,a.scaleX=1)}var o=this._speakNode.getChildByName("labTip"),s=o.getComponent(cc.Label);s.string=td.Language[t.tips],s._forceUpdateRenderData(),this._speakNode.height=78,this._speakNode.width=o.width+30,o.x=this._speakNode.width/2,this._speakNode.active=!0,this._speakNode.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(3.4),cc.fadeOut(.2),cc.callFunc(function(){e._speakNode.active=!1})))}},onLoad:function(){this._super();var t=this.node.addComponent(h);t.setTouchBeginCallBack(this._figureTowerTouchBegin.bind(this)),t.setTouchMoveCallBack(this._figureTowerTouchMove.bind(this)),t.setTouchMoveOutCallBack(this._figureTowerTouchMove.bind(this)),t.setTouchCancelCallBack(this._figureTowerTouchEnd.bind(this)),t.setTouchEndedCallBack(this._figureTowerTouchEnd.bind(this))},_figureTowerTouchBegin:function(t){return this._curTarget=t.currentTarget,this._touchBeginPos=t.getLocation(),this._isMoved=!1,!0},_figureTowerTouchMove:function(t){var e=this.node.getParent().convertToNodeSpaceAR(t.getLocation());if(this._movingNode&&this._movingNode.setPosition(e),this._touchPoint=t.getLocation(),o.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.READY&&this._isMoved){if(!this._movingNode){e=this.node.getParent().convertToNodeSpaceAR(t.getLocation());this._movingNode=cc.instantiate(this._curTarget),this._movingNode.getChildByName("hero").getChildByName("spriteAnima").z=900,this._movingNode.setPosition(e),this.node.getParent().addChild(this._movingNode,1e3)}}else this._movingNode&&this._movingNode.removeFromParent(),this._movingNode=null;this._touchPoint=t.getLocation(),td.GlobalFunction.getDistance(this._touchPoint,this._touchBeginPos)>10&&(this._isMoved=!0)},_figureTowerTouchEnd:function(t){if(o.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.READY&&this._isMoved){var e=this._getContainTowerId();if(this._touchPoint=null,e){for(var i=o.getTowerArray(),n=null,a=0,r=i.length;a<r;a++){var s=i[a];if(s.getComponent("PveBaseTower").getPosTag()===e){n=s;break}}var l=this._curTarget.getComponent("PveBaseTower"),c={tag:e,heroDataModel:l.getHeroModel(),bAction:!0};td.EventUtil.dispatchEvent(td.EventNameEnum.DESTROY_TOWER,this._curTarget._tag);var u={posTag:l.getPosTag(),heroDataModel:l.getHeroModel()};if(td.EventUtil.dispatchEvent(td.EventNameEnum.ON_UNBUILD_TOWER,u),n){var d=n.getComponent("PveBaseTower"),h={tag:this._curTarget.getComponent("PveBaseTower").getPosTag(),heroDataModel:d.getHeroModel(),bAction:!0};td.EventUtil.dispatchEvent(td.EventNameEnum.DESTROY_TOWER,n._tag);var p={posTag:d.getPosTag(),heroDataModel:d.getHeroModel()};td.EventUtil.dispatchEvent(td.EventNameEnum.ON_UNBUILD_TOWER,p),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_BUILD_TOWER,h)}td.EventUtil.dispatchEvent(td.EventNameEnum.ON_BUILD_TOWER,c),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.ON_LINE)}else this._isMoved||this.onClickHeroCallback(t)}else this.onClickHeroCallback(t);this._movingNode&&this._movingNode.removeFromParent(),this._movingNode=null},_getContainTowerId:function(){if(!this._movingNode)return null;for(var t=this._movingNode.getPosition(),e=cc.rect(t.x-this._movingNode.width/2,t.y,this._movingNode.width,this._movingNode.height/2),i=this._curTarget.getComponent("PveBaseTower"),n=o.getTowerArray(),a=n.length-1;a>=0;a--){var r=n[a],s=r.getComponent("PveBaseTower");if(s.getPosTag()!==i.getPosTag())if(cc.rect(r.x-r.width/4,r.y,r.width/2,r.height/4).intersects(e))return s.getPosTag()}var l=p.getTowerPoints();for(var c in l){var u=parseInt(c),d=l[c];if(u!==i.getPosTag())if(cc.rect(d.x-60,d.y-60,120,120).intersects(e))return u}return null},onDestroy:function(){this._super()},onEnable:function(){this.addEventLister()},onDisable:function(){td.EventUtil.unregisterAllEvents(this)},addEventLister:function(){var t={};t[td.EventNameEnum.GUIDE_PVE_PLAY_SPECIAL_SKILL]=this.releaseGuideSkill,td.EventUtil.registerEvents(t,this)},releaseGuideSkill:function(t){t&&this._dataModel&&this._dataModel.getSid()===t&&(this._skillCdTime=0,this.createSkill())},pause:function(){this.node.pauseAllActions(),this._spriteHeroScript.pauseAnimation(),this._attackEffectNode&&this._attackEffectNode.getComponent(cc.Animation).pause(),td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSE_EFFECT)},resume:function(){this._bFreeze||(this.node.resumeAllActions(),this._spriteHeroScript.resumeAnimation(),this._attackEffectNode&&this._attackEffectNode.getComponent(cc.Animation).resume(),td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_EFFECT))},onRestartFight:function(){this._curSpeedMult=o.getCurFightSpeedMult(),this._bInspiring=!1,this._monsterEffctSpeedRate=1},setOrdinaryAttackPowerAddition:function(t){null!==t&&(this._curOrdiraryAttackAdd+=t)},setSkillAttackPowerAddition:function(t){null!==t&&(this._curSkillAttackAdd+=t)},getSkillAttackPowerAddition:function(){return this._curSkillAttackAdd},setSkillFreezeBuff:function(t){this._bFreeze=t,t?this.pause():this.resume()},update:function(t){if(!this._bFightPause&&!this._bFreeze){this._super(t);var e=o.getFightStatus(),i=o.getCurFightSpeedMult();if(e===td.PveEnum.PVE_FIGHT_STATUS.FIHGT&&(this._fightTime+=t*this._curTmpSpeed,this._bSkillReleased&&this._skillCdTime>0&&(this._skillCdTime-=t*i),!1===this._curIsSeriesAttack)){this._deltaAttackInterval+=t*this._curTmpSpeed;var n=this._checkCurTargetEnemyStatus(),a=0;this._curTargetEnemy&&(a=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio)),this._curTargetEnemy&&n&&a!==td.PveEnum.PVE_ENEMY_TYPE.BOSS_SKILL||(this._curTargetEnemy=this._getEnemyInAttackRange())}if(this._curSkillTrigger[0]===td.PveEnum.SKILL_TRIGGER_TYPE.IntervalTrigger&&this._fightTime>this._curSkillTrigger[1]&&this._skillCdTime<=0&&this._curTargetEnemy&&(this._fightTime=0-this._curSkillTrigger[1],this.createSkill()),!this._isPlayingAttack){var r=this._calcAtatckType(),s=this._calcAttackDirection();this._curHeroActionType===r&&r===td.PveEnum.PVE_ACTION_TYPE.Idle&&s===this._curDirection||(this._curHeroActionType=r,this._curDirection=s,r===td.PveEnum.PVE_ACTION_TYPE.Idle&&this._attackEffectNode&&(this._attackEffectNode.active=!1,this._spriteHero.active=!0),this._playAttackAnimation())}}},updatePetTowerTime:function(t){if(!this._bFightPause&&!this._bFreeze)if(this._curPetTime+=t*this._curSpeedMult,this._curPetTime>=this.MAX_PET_TIME){this.unschedule(this.updatePetTowerTime);var e=gdk.rm.getResByUrl("fightRes/pve/otherAnimation/ZhaoHuanYingXiong/Zhaohuanyingxiong",cc.Prefab);this._createTowerAniNode=this.node.getChildByName("createTowerAniNode"),this._createTowerAniNode||(this._createTowerAniNode=cc.instantiate(e),this._createTowerAniNode.setPosition(cc.v2(0,0)),this._createTowerAniNode.name="createTowerAniNode",this._createTowerAniNode.active=!0,this._createTowerAniNode.getComponent("BuildTowerAnimateComponent").setFrameEventCallBack(this.onPetRemove.bind(this)),this.node.addChild(this._createTowerAniNode))}else;},onPetRemove:function(){this.node.active=!1,td.EventUtil.dispatchEvent(td.EventNameEnum.DESTROY_TOWER,td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio+this._posTag)},onClickHeroCallback:function(t){if(!this._isPetTower){var e=s.getSelectedSkill();if(0!==e||td.PveCopyManager.isHook()){if(e===td.PveEnum.PVE_UI_SKILL_ID.Inspire)td.EventUtil.dispatchEvent(td.EventNameEnum.CREATE_UI_SKILL,{skillId:e,tower:this.node});else if(e===td.PveEnum.PVE_UI_SKILL_ID.IceRain){var i=t.target,n=cc.v2(360,640);if(cc.isValid(i)&&cc.isValid(t.touch)){var a=t.touch.getLocation();n=i.parent.convertToNodeSpaceAR(a)}td.EventUtil.dispatchEvent(td.EventNameEnum.CREATE_UI_SKILL,{skillId:e,pos:n})}}else{if(td.GuideManager.isFirstBattle())return;var r={posTag:this._posTag,heroDataModel:this._dataModel,pos:this.getCurPos(),selfTag:this.node._tag};td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_HETO_DETAIL,r),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_HIDE_TIMES_NODE)}}},setInspireData:function(t){this._curSpeedMult=t.buffData,this._bInspiring=t.bInspire,this.node.runAction(cc.scaleTo(.2,this._bInspiring?1.2:1)),this.onChangeSpeedMult(Math.max(this._curSpeedMult,this._speedMuti)*this._monsterEffctSpeedRate),this._turnDir(this._curDirection)},setSpeedMuti:function(t){this._speedMuti=t,this.onChangeSpeedMult(Math.max(this._curSpeedMult,this._speedMuti)*this._monsterEffctSpeedRate)},setMonsterEffctSpeedRate:function(t){t>0&&(this._monsterEffctSpeedRate=t),this.onChangeSpeedMult(this._curSpeedMult*this._monsterEffctSpeedRate)},getBuffNodePosByType:function(t){var e=0,i=0,n=this.node.getContentSize();return t===td.PveEnum.PVE_EFFECT_TYPE.Inspire||t===td.PveEnum.PVE_EFFECT_TYPE.TowerHurt&&(e=n.width/2,i=n.height),cc.v2(e,i)},onChangeSpeedMult:function(t){this._curTmpSpeed=t,cc.log("onChangeSpeedMult  "+t);var e=this._dataModel.getNotChangeSpeedAnimationList();(this._spriteHeroScript.onChangeAnimationSpeed(t,e),this._isPetTower&&(this.unschedule(this.updatePetTowerTime),this.schedule(this.updatePetTowerTime,.1)),this._attackEffectNode)&&this._attackEffectNode.getComponent(r).onChangeAnimationSpeed(t)},_playAttackAnimation:function(){if(!o.debugParams[1]){var t=td.PveEnum.DIR_DEGREE_TYPE[this._curDirection];if(this._curHeroActionType===td.PveEnum.PVE_ACTION_TYPE.Idle)this._spriteHeroScript.changeDir(t);else if(this._curHeroActionType===td.PveEnum.PVE_ACTION_TYPE.Attack){var e=this._spriteHeroScript.changeDir(t),i=this._dataModel.getRes()+"_"+e[0];if(this._spriteHeroScript.pauseAnimation(),this._isPlayingAttack=!0,this._spriteHero.active=!1,this._curAttackClipName=i,this._attackEffectNode)this._attackEffectNode.active=!0;else{var n=this._dataModel.getResPath()+"_1",a=gdk.rm.getResByUrl(n,cc.Prefab);this._attackEffectNode=cc.instantiate(a),this._attackEffectNode.addComponent(r).setFrameEventCallBack(this.startAttack.bind(this)),this._attackEffectNode.scale=td.PveEnum.HeroScale,this.node.addChild(this._attackEffectNode)}var s=this._attackEffectNode.getComponent(cc.Animation);this._attackEffectNode.scaleX=Math.abs(this._attackEffectNode.scaleX)*e[1];var l=s.play(i);l||(l=s.play(this._dataModel.getRes()+"_1"),this._curAttackClipName=this._dataModel.getRes()+"_1"),l.wrapMode=cc.WrapMode.Normal;var c=this._attackEffectNode.getComponent(r);c.setFrameEventCallBack(this.startAttack.bind(this)),c.setFinishAnimationCallBack(this._attackActionFinished.bind(this));for(var u=this._attackEffectNode.getComponent(cc.Animation),d=u.getClips(),h=0,p=d.length;h<p;h++)if(d[h]){var _=u.getAnimationState(d[h].name);_.wrapMode=cc.WrapMode.Normal,d[h].duration>this._curAttackInterval?_.speed=d[h].duration/this._curAttackInterval*this._curTmpSpeed:_.speed=this._curTmpSpeed,this._upSpeedTimes=_.speed}}this._turnDir(this._curDirection)}},_attackActionFinished:function(){this._isPlayingAttack=!1,this._spriteHeroScript.resumeAnimation(),this._spriteHeroScript.playIdle(),this._spriteHero.active=!0},getAttackPrefabByDirection:function(t){var e=null;switch(t){case td.PveEnum.PVE_DIRECTION.UP:e=this._dataModel.getUpAttackPrefab();break;case td.PveEnum.PVE_DIRECTION.DOWN:e=this._dataModel.getDownAttackPrefab();break;case td.PveEnum.PVE_DIRECTION.RIGHT:e=this._dataModel.getRightAttackPrefab();break;case td.PveEnum.PVE_DIRECTION.RIGHT_UP:e=this._dataModel.getRightUpAttackPrefab();break;case td.PveEnum.PVE_DIRECTION.RIGHT_DOWN:e=this._dataModel.getRightDownAttackPrefab()}return e},_calcAtatckType:function(){var t=o.getFightStatus();return this._curTargetEnemy&&t!==td.PveEnum.PVE_FIGHT_STATUS.OVER&&t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT?this._deltaAttackInterval>=this._curAttackInterval&&this._curHeroActionType===td.PveEnum.PVE_ACTION_TYPE.Idle&&!1===this._curIsSeriesAttack?td.PveEnum.PVE_ACTION_TYPE.Attack:this._isPlayingAttack&&this._curHeroActionType===td.PveEnum.PVE_ACTION_TYPE.Attack?td.PveEnum.PVE_ACTION_TYPE.Attack:td.PveEnum.PVE_ACTION_TYPE.Idle:td.PveEnum.PVE_ACTION_TYPE.Idle},_calcAttackDirection:function(){var t=o.getFightStatus();if(!this._curTargetEnemy||t===td.PveEnum.PVE_FIGHT_STATUS.OVER)return this._curDirection;var e=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._curTargetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=i.bDeath(),a=i.getTransferStatus();if(n||a)return this._curTargetEnemy=null,this._curDirection;var r=this._curTargetEnemy.getPosition(),s=this.node.getPosition(),l=td.GlobalFunction.getRotation(s,r);return this._getDir(l)},_getDir:function(t){var e=Math.floor(t/45),i=t%45>22.5?45*(e+1):45*e,n=td.PveEnum.DIR_DEGREE[i];return o.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.FIHGT?this._deltaAttackInterval>=this._curAttackInterval?n:this._curDirection:n},_turnDir:function(t){},_checkCurTargetEnemyStatus:function(){if(!cc.isValid(this._curTargetEnemy))return!1;var t=this._curTargetEnemy.getPosition(),e=this.getCurPos();if(td.GlobalFunction.getDistance(t,e)>this._curAttackRange)return!1;var i=Math.floor(this._curTargetEnemy._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),n=this._curTargetEnemy.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[i]),a=n.getTransferStatus();return!n.bDeath()&&!a},_getEnemyInAttackRange:function(t){void 0===t&&(t=!1);for(var e=p.getProtegePos(),i=this._curAttackRange,n=o.getEnemyArray(),a=[],r=this.getCurPos(),s=0,l=n.length;s<l;s++)if(cc.isValid(n[s])){var c=n[s].getPosition(),u=Math.floor(n[s]._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),d=n[s].getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[u]),h=d.bDeath(),g=td.GlobalFunction.getDistance(c,r),f=d.getTransferStatus();!(g<=i||d.isIgnorDistance()||t)||h||f||a.push(n[s])}var v=td.PveCopyManager.getCopyType(),m=this;return v!==_.PVEFightType.AncientCorridor&&a.sort(function(t,i){var n=t.getPosition(),a=i.getPosition(),r=td.GlobalFunction.getDistance(n,e),o=td.GlobalFunction.getDistance(a,e),s=Math.floor(t._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),l=Math.floor(i._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio);if(v===_.PVEFightType.DemonTreasureCopy&&s!==l)return s-l;if(v!==_.PVEFightType.DemonTreasureCopy&&(m._vocationType===td.PveEnum.PVE_HERO_VOCATION.MASTER||m._vocationType===td.PveEnum.PVE_HERO_VOCATION.SHOOTER)){var c=t.getComponent("BaseEnemy").isBoss(),u=i.getComponent("BaseEnemy").isBoss();if((c||u)&&console.log("isBOSS 000"),c&&!u)return-1;if(!c&&u)return 1}if(r!==o)return r-o;s=Math.floor(t._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),l=Math.floor(i._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio);var d=t.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[s]),h=t.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[l]);return d.getCurHp()-h.getCurHp()}),a.shift()},isSkillForceIngnorDis:function(){var t=this._dataModel.getPveSkillModel();return(!this.GUIDE_SKILL_IDS||this.GUIDE_SKILL_IDS.length<=0)&&(this.GUIDE_SKILL_IDS=[9993,9994]),-1!==this.GUIDE_SKILL_IDS.indexOf(t.getId())},createSkill:function(){if(!o.debugParams[2]&&!(!this._curTargetEnemy&&!this.isSkillForceIngnorDis()||this._skillCdTime>0)){var t=this._dataModel.getPveSkillModel();t&&this._playTowerReleaseSkillAni(t)}},_doReleaseSkill:function(){if(!(!this._curTargetEnemy&&!this.isSkillForceIngnorDis()||this._skillCdTime>0)&&(this._curTargetEnemy||(this._curTargetEnemy=this._getEnemyInAttackRange(!0),this._curTargetEnemy))){var t=this._dataModel.getPveSkillModel();if(t){this._bSkillReleased||(this._bSkillReleased=!0);var e=this._curTargetEnemy.getPosition(),i=t.getType();this._skillCdTime=t.getCDTime(),this._curSkillTrigger[0]===td.PveEnum.SKILL_TRIGGER_TYPE.IntervalTrigger&&(this._skillCdTime=Math.max(t.getCDTime(),this._curSkillTrigger[1]));var n=t.getSkillPrefabTop(),a=t.getPrefabDimian(),r=t.getResType(),c="topName_"+this._dataModel.getId()+"_"+t.getId(),u="dimianName_"+this._dataModel.getId()+"_"+t.getId(),d={skillDataModel:t,attackPower:this.getCurSkillAttackPower(),hurtType:this.getHeroHurtType(),heroId:this._dataModel.getId(),curTargetEnemy:this._curTargetEnemy,baseAttackPower:this.getAttackPower(),vocation:this._dataModel.getFeatures(),heroSid:this._dataModel.getSid(),towerPos:this.node.getPosition()},h=null,p=null;switch(r){case td.PveEnum.PVE_SKILL_RES_TYPE.TOP:(h=l.getTowerSkillNode(c))||(h=cc.instantiate(n)),h.name=c;break;case td.PveEnum.PVE_SKILL_RES_TYPE.MIX:(h=l.getTowerSkillNode(c))||(h=cc.instantiate(n)),h.name=c,(p=l.getTowerSkillNode(u))||(p=cc.instantiate(a)),p.name=u;break;case td.PveEnum.PVE_SKILL_RES_TYPE.GROUND:(p=l.getTowerSkillNode(u))||(p=cc.instantiate(a)),p.name=u}var _=null,g=null;cc.isValid(h)?((_=h.getComponent(td.PveEnum.PVE_TOWER_SKILL_ENUM[i]))||(_=h.addComponent(td.PveEnum.PVE_TOWER_SKILL_ENUM[i])),cc.isValid(p)&&((g=p.getComponent("PveAnimationObject"))||(g=p.addComponent("PveAnimationObject")),g.onChangeSpeedMult(o.getCurFightSpeedMult()),g.setEndDestroy(!1))):(_=p.getComponent(td.PveEnum.PVE_TOWER_SKILL_ENUM[i]))||(_=p.addComponent(td.PveEnum.PVE_TOWER_SKILL_ENUM[i])),_.initData(d),_.setEndDestroy(!1);var f=s.getEffectLayer(),v=s.getFightLayer();i===td.PveEnum.PVE_TOWER_SKILL.FengKuangChanRao?_.setTargetEnemy(this._curTargetEnemy):i===td.PveEnum.PVE_TOWER_SKILL.ShouXueFeiTeng&&_.setTargetTower(this.node);var m=this.getCurPos();i===td.PveEnum.PVE_TOWER_SKILL.SiWangDiaoLing||i===td.PveEnum.PVE_TOWER_SKILL.ShouXueFeiTeng||i===td.PveEnum.PVE_TOWER_SKILL.ChuangYunJian?(cc.isValid(h)&&h.setPosition(m),cc.isValid(p)&&p.setPosition(m)):(cc.isValid(h)&&h.setPosition(e),cc.isValid(p)&&p.setPosition(e)),cc.isValid(h)&&f.addChild(h,99),cc.isValid(p)&&v.addChild(p,-99)}}},_playTowerReleaseSkillAni:function(t){var e=this;this.node.runAction(cc.scaleTo(.2,1.2));var i=this.node.getChildByName("guanInstance");if(!cc.isValid(i)){(i=l.getSkillNameNode())||(i=td.GlobalFunction.createPrefabInstance("fightRes/pvp/ui_anima/ShiFang_Effect/skillPrefab")),i.name="guanInstance",i.addComponent(r),this.node.addChild(i);var n=i.getChildByName("shifang_ziti");n.scale=1.2;var a=n.getChildByName("shifang_name1"),o=n.getChildByName("shifang_name2");a.active=!1,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_skillName,t.getSkillNamePic(),o)}i.opacity=255;var s=i.getComponent(cc.Animation),c=s.getClips(),u=(this._dataModel.getFeatures(),c[0].name),d=s.getAnimationState(u);d.wrapMode=cc.WrapMode.Normal,d.speed=this._curTmpSpeed,s.play(u),i.getComponent(r).setFrameEventCallBack(function(){cc.isValid(e.node)&&(i.opacity=0,e.node.runAction(cc.scaleTo(.2,1)),e._doReleaseSkill())});var h=t.getReleaseSound();h&&h>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,h)},_playReleaseSkillSound:function(){if(this._dataModel)this._dataModel.getPveSkillModel()},startAttack:function(){this._attackTimes+=1;var t=this._dataModel.getPveSkillModel();if(t){t.getTriggerCfg();if(this._curSkillTrigger[0]===td.PveEnum.SKILL_TRIGGER_TYPE.AttackTimesTrigger&&this._attackTimes>0&&this._attackTimes%this._curSkillTrigger[1]==0)this.createSkill();else if(this._curSkillTrigger[0]===td.PveEnum.SKILL_TRIGGER_TYPE.ChanceTrigger){1e4*Math.random()<=this._curSkillTrigger[1]&&this.createSkill()}}this._deltaAttackInterval=0,this.createBullet();var e=this._dataModel.getAttackSoundId();e>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,e)},seriesAttack:function(){this._curIsSeriesAttack=!0;var t=this._curSeriesAttackInterval/this._curSeriesAttackTimes,e=this,i=cc.delayTime(t),n=cc.callFunc(function(){e.createBullet()});this.node.runAction(cc.sequence(n,i)).repeat(this._curSeriesAttackTimes),this.scheduleOnce(function(){e._curIsSeriesAttack=!1,e._deltaAttackInterval=0},e._curSeriesAttackInterval)},createBullet:function(){if(this._checkCurTargetEnemyStatus()||(this._curTargetEnemy=this._getEnemyInAttackRange()),this._curTargetEnemy){var t=this._curTargetEnemy,e=this._bInspiring?this._dataModel.getPveInspireBulletDataModel():this._dataModel.getPveBulletDataModel(),i={bulletDataModel:e,targetEnemy:t,bornPos:this.getBulletBornPos(),commonAtlas:o.getCommonAtlas(),heroAttackPower:this.getCurOrdiraryAttackPower(),baseAttackPower:this.getAttackPower(),attackEffect:this._dataModel.getAttackEffectCfg(),hurtType:this.getHeroHurtType(),vocation:this._dataModel.getFeatures(),heroSid:this._dataModel.getSid(),towerPos:this.node.getPosition(),speed:this._curTmpSpeed,targetPos:t.getPosition()},n=null,a=null,r=e.getSkillType();if(r===td.PveEnum.PVE_BULLET_SKILL_TYPE.Ordinary)n=l.getBulletInPool(e.getId()),a=c;else if(r===td.PveEnum.PVE_BULLET_SKILL_TYPE.WithoutBallistic){var s=t.getPosition();i.bornPos=cc.v2(s.x,s.y+50),n=l.getBulletInPool(e.getId()),a=u}cc.isValid(n)||(n=cc.instantiate(o.getBulletPrefab())).addComponent(a);var d=n.getComponent(a);d.setUpSpeedTimes(this._upSpeedTimes),d.initData(i),this.node.getParent().addChild(n,1e3)}},getBulletBornPos:function(){var t=null;switch(this._curDirection){case td.PveEnum.PVE_DIRECTION.UP:t=this._dataModel.getUpAttackBulletOffect();break;case td.PveEnum.PVE_DIRECTION.DOWN:t=this._dataModel.getDownAttackBulletOffect();break;case td.PveEnum.PVE_DIRECTION.LEFT:var e=this._dataModel.getRightAttackBulletOffect();t=[-e[0],e[1]];break;case td.PveEnum.PVE_DIRECTION.RIGHT:t=this._dataModel.getRightAttackBulletOffect();break;case td.PveEnum.PVE_DIRECTION.RIGHT_UP:t=this._dataModel.getRightUpAttackBulletOffect();break;case td.PveEnum.PVE_DIRECTION.LEFT_UP:var i=this._dataModel.getRightUpAttackBulletOffect();t=[-i[0],i[1]];break;case td.PveEnum.PVE_DIRECTION.RIGHT_DOWN:t=this._dataModel.getRightDownAttackBulletOffect();break;case td.PveEnum.PVE_DIRECTION.LEFT_DOWN:var n=this._dataModel.getRightDownAttackBulletOffect();t=[-n[0],n[1]]}return cc.v2(this.node.x+t[0],this.node.y+t[1])},getCurOrdiraryAttackPower:function(){var t=this._dataModel.getTowerBaseMight(),e=this._dataModel.getAttackPower();if(td.PveCopyManager.isHook()){var i=o.getTowerArray();e=td.GetConfig("HookHeroTotalCombat")/i.length}var n=e*this._curOrdiraryAttackAdd*t;return Math.floor(n)},getAttackPower:function(){var t=this._dataModel.getAttackPower();if(td.PveCopyManager.isHook()){var e=o.getTowerArray();t=td.GetConfig("HookHeroTotalCombat")/e.length}return t},getCurSkillAttackPower:function(){var t=this._dataModel.getTowerBaseMight(),e=this._dataModel.getAttackPower();if(td.PveCopyManager.isHook()){var i=o.getTowerArray();e=td.GetConfig("HookHeroTotalCombat")/i.length}var n=e*this._curSkillAttackAdd*t;return Math.floor(n)},getHeroHurtType:function(){var t=this._dataModel.getMercenaryDataModel().getFeatures();return td.PveEnum.getVocationHurtType(t)},update3DModelZ:function(t){if(this._spriteHero){this._isPetTower&&(t+=200);var e=this._spriteHero.getChildByName("spriteAnima");if(e&&(e.z=t),this._attackEffectNode){var i=this._attackEffectNode.getChildByName("hero");i&&(i.z=t)}}},addTowerBuff:function(e){if(e){var i=e.buffType,n=null,a=this.node.getChildByName("towerBuff_"+i),r={target:this.node,curBuffData:e};if(a)i===td.PveEnum.PVE_EFFECT_TYPE.Inspire?n=t("InspireBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.TowerHurt?n=t("TowerHurtBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.TowerSpeedBuff?n=t("TowerSpeedBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.TowerAttackBuff?n=t("TowerAttackBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.TowerFreezeBuff?n=t("TowerFreezeBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.FinalHurtAddition?n=t("FinalHurtAddtionBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.TowerSpeedChange&&(n=t("MonsterChangeTowerSpeed")),a.getComponent(n).initData(r);else{if(i===td.PveEnum.PVE_EFFECT_TYPE.Inspire){n=t("InspireBuff");var o=gdk.rm.getResByUrl("fightRes/pve/buff/GuWu/buffPrefab",cc.Prefab);a=cc.instantiate(o)}else i===td.PveEnum.PVE_EFFECT_TYPE.TowerHurt?n=t("TowerHurtBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.TowerSpeedBuff?n=t("TowerSpeedBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.TowerAttackBuff?n=t("TowerAttackBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.TowerFreezeBuff?n=t("TowerFreezeBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.FinalHurtAddition?n=t("FinalHurtAddtionBuff"):i===td.PveEnum.PVE_EFFECT_TYPE.TowerSpeedChange&&(n=t("MonsterChangeTowerSpeed"));a||(a=new cc.Node),a.addComponent(n).initData(r),a.name="towerBuff_"+i,this.node.addChild(a,99)}var s=this.getBuffNodePosByType(e.buffType);a.setPosition(s),a.active=!0}}}).getBuffNodePosByType=function(t){var e=0,i=0,n=this.node.getContentSize();return t===td.PveEnum.PVE_EFFECT_TYPE.TowerHurt&&(e=n.width/2,i=n.height),cc.v2(e,i)},n.isPetTower=function(){return this._isPetTower},n)));e.exports=g,cc._RF.pop()},{AnimationComponent:void 0,CommonEnum:void 0,FinalHurtAddtionBuff:void 0,InspireBuff:"InspireBuff",MonsterChangeTowerSpeed:"MonsterChangeTowerSpeed",OrdinaryBullet:"OrdinaryBullet",PveCopyEnum:void 0,PveEnum:"PveEnum",PveFightManager:"PveFightManager",PveFightObject:"PveFightObject",PveMapManager:"PveMapManager",PveNodePoolManager:"PveNodePoolManager",PveUiManager:"PveUiManager",SpriteAnimation:"SpriteAnimation",TowerAttackBuff:"TowerAttackBuff",TowerFreezeBuff:"TowerFreezeBuff",TowerHurtBuff:"TowerHurtBuff",TowerSpeedBuff:"TowerSpeedBuff",UFButton:void 0,WithoutBallisticBullet:"WithoutBallisticBullet"}],PveBuildTowerManager:[function(t,e,i){"use strict";cc._RF.push(e,"13d0as25FhNx4tvmo1bmagJ","PveBuildTowerManager");var n=o(t("../../../../TS/Hero/Manager/HeroManager")),a=o(t("./PveDataHelper")),r=o(t("../../../Chess/Manager/ChessManager"));function o(t){return t&&t.__esModule?t:{default:t}}var s=t("PveHeroModel"),l=t("PveMapManager"),c=t("PveCopyEnum"),u={_heroModels:null,_petModels:null,_buildMap:null,_curRoadIndex:null,_curBuildFlagVec:null,_tmpHeroModels:null,init:function(){this._curBuildFlagVec={},this._curRoadIndex=td.PveCopyManager.getCopyRoadIndex(),this.initBuildMap(this._curRoadIndex),this._addEventListener()},_addEventListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.ON_CHANGE_BUILD_DATA,this.changeBuildTowerData,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_ONE_KEY_EMBATTLE,this.oneKeyEmbattle,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_UNBUILD_TOWER,this.onUnbuildTower,this)},_removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},onDestroy:function(){this._heroModels=null,this._petModels=null,this._tmpHeroModels=null,this._removeListeners(),this._buildMap={}},resetBuildData:function(){this._curBuildFlagVec={},this.initTowers(),this.initBuildMap(this._curRoadIndex)},initBuildMap:function(t){td.PveCopyManager.isHook()?this._buildMap={}:this._buildMap=this.getLocalJson("road_"+t)||{};var e=[];for(var i in this._buildMap){for(var n=this._buildMap[i],a=0,r=e.length;a<r;a++)if(n===e[a])return void(this._buildMap={});e.push(n)}},saveBuildMap:function(){this.setLocalJson("road_"+this._curRoadIndex,this._buildMap)},setCurBuildFlagVec:function(t){t&&(this._curBuildFlagVec=t)},getCurBuildFlagVec:function(){return this._curBuildFlagVec},setCurBuildFlagStatus:function(t,e){this._curBuildFlagVec[t].buildStatus=e},initTowers:function(){this._heroModels=[],this._petModels=[],this._tmpHeroModels=[];var t=td.TableManager.getTableClass(td.TableEnum.PveHeroFihgtShowTable);if(td.GuideManager.isFirstBattle()){var e=n.default.getInstance().getGuideHeroList();for(var i in e){var r=e[i],o=r.getId(),l=r.getSId(),c=t.getPveHeroCfgById(o),u=new s;u.init(c,l,r),this._heroModels.push(u),this._tmpHeroModels.push(u)}}else{for(var d=a.default.getBattleHeroModels(),h=0;h<d.length;h++){var p=d[h],_=p.getRoleType(),g=p.getSId()||p.getId(),f=t.getPveHeroCfgById(_);(y=new s).init(f,g,p),this._heroModels.push(y),this._tmpHeroModels.push(y)}for(var v=a.default.getBattlePetModels(),m=0;m<v.length;m++){var y,E=v[m],T=E.getPveShowId();g=E.getSId(),f=t.getPveHeroCfgById(T);(y=new s).init(f,g,E),this._petModels.push(y),0}}this._heroModels.sort(function(t,e){return e.getAttackPower()-t.getAttackPower()})},getHerosCanBuild:function(){if(0===this._heroModels.length)return[];var t=this._heroModels.slice(0);return t.length>1&&t.sort(function(t,e){return a.default.getIndexByHeroSid(t.getSid())-a.default.getIndexByHeroSid(e.getSid())}),t},hasTowerBuilt:function(){var t=!1;for(var e in this._curBuildFlagVec){if(1===this._curBuildFlagVec[e].buildStatus){t=!0;break}}return t},isTowerBuilded:function(t){return"number"==typeof this._buildMap[t]},_powerSortFunc:function(t,e){return this._getHeroIndexPower(e)-this._getHeroIndexPower(t)},_vocationSortFunc:function(t,e){var i=t.getFeatures(),n=e.getFeatures();if(i!==n){var a=i%2,r=n%2;return a!==r?a-r:n-i}return this._getHeroIndexPower(e)-this._getHeroIndexPower(t)},_getHeroIndexPower:function(t){var e=td.BattleArrayDataManager.getIndexByHeroSid(t.getSID());return td.BattleArrayDataManager.getFightPowerByIndex(e)},isBuildFinished:function(){if(!this._heroModels||0===this._heroModels.length)return!0;var t=!0;for(var e in this._curBuildFlagVec){if(0===this._curBuildFlagVec[e].buildStatus){t=!1;break}}return t},buildBySaveConfig:function(t){if(!td.PveCopyManager.isHook()){for(var e={},i=0;i<this._heroModels.length;i++){var n=this._heroModels[i];e[a.default.getIndexByHeroSid(n.getSid())]=n}var o=0;for(var s in this._curBuildFlagVec)if("number"==typeof this._buildMap[s]){if(td.PveCopyManager.getCopyType()===c.PVEFightType.CHESS)if(o>=r.default.getInstance().getCurBattleHeroNum())break;n=e[this._buildMap[s]];if(ArrayUtils.remove(this._heroModels,n),!n){this._buildMap[s]=null,this.saveBuildMap(this._curRoadIndex);break}td.EventUtil.dispatchEvent(td.EventNameEnum.ON_BUILD_TOWER,{heroDataModel:n,tag:parseInt(s),bAction:t}),o++}}},changeBuildTowerData:function(t){ArrayUtils.remove(this._heroModels,t.heroDataModel),this._setBuildMap(t.heroDataModel,t.tag)},onUnbuildTower:function(t){for(var e=t.heroDataModel,i=e.getSid(),n=0,a=this._heroModels.length;n<a;n++){if(this._heroModels[n].getSid()===i)return}var r=t.posTag;this._resetBuildMap(r),this._heroModels.push(e),this._curBuildFlagVec[r]&&this.setCurBuildFlagStatus(r,0)},oneKeyEmbattle:function(t){if(!this.isBuildFinished()){var e=l.getTowerPoints(),i=this._heroModels.length,n=td.PveFightManager.canBuildMoreTower();n&&td.PveCopyManager.getCopyType()===c.PVEFightType.CHESS&&n<i&&(i=n);var a=this._heroModels.slice(0,i);for(var r in a.sort(function(t,e){return e.getAttackPower()-t.getAttackPower()}),e.myLen()<a.length&&a.splice(e.myLen(),a.length-e.myLen()),a.sort(function(t,e){return e.getFeatures()>t.getFeatures()?-1:e.getFeatures()<t.getFeatures()?1:e.getAttackPower()-t.getAttackPower()}),this._curBuildFlagVec){var o=parseInt(r);if(!this.isTowerBuilded(o)){var s=a.shift();if(!s)break;ArrayUtils.remove(this._heroModels,s),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_BUILD_TOWER,{heroDataModel:s,tag:o,bAction:t}),this._setBuildMap(s,o)}}}},_setBuildMap:function(t,e){var i=a.default.getIndexByHeroSid(t.getSid());this._buildMap[e]=i},_resetBuildMap:function(t){delete this._buildMap[t]},getBuildMap:function(){return this._buildMap},getLocalJson:function(t){return td.GuideManager.isFirstBattle()?null:(td.PveCopyManager.getCopyType()==c.PVEFightType.CHESS&&(t+="_"+c.PVEFightType.CHESS),td.LocalStorageUtil.read(t))},setLocalJson:function(t,e){var i=td.GuideManager.isFirstBattle();!e||i||td.PveCopyManager.isHook()||(td.PveCopyManager.getCopyType()==c.PVEFightType.CHESS&&(t+="_"+c.PVEFightType.CHESS),td.LocalStorageUtil.write(t,e))},getPetBuildModelList:function(){return this._petModels},getPetBuildModelBySid:function(t){if(!this._petModels)return null;for(var e=0;e<this._petModels.length;e++){var i=this._petModels[e];if(i.getSid()==t)return i}return model},getHeroModelBySid:function(t){if(!this._tmpHeroModels)return null;for(var e=0;e<this._tmpHeroModels.length;e++){var i=this._tmpHeroModels[e];if(i.getSid()==t)return i}return null}};e.exports=u,cc._RF.pop()},{"../../../../TS/Hero/Manager/HeroManager":"HeroManager","../../../Chess/Manager/ChessManager":"ChessManager","./PveDataHelper":"PveDataHelper",PveCopyEnum:void 0,PveHeroModel:"PveHeroModel",PveMapManager:"PveMapManager"}],PveBulletTable:[function(t,e,i){"use strict";cc._RF.push(e,"3b22ezaohBDmqTKuia8+wep","PveBulletTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PveBulletTable",properties:{_tblName:"pve_bullet_config",_bulletData:null},init:function(){this._bulletData={};for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];n.resPath="fightRes/pve/bullet/";var a=n.effectArray;n.movePrefab=2===a[0]&&n.movePrefab?n.resPath+n.movePrefab:null,n.attackPrefab=2===a[1]&&n.attackPrefab?n.resPath+n.attackPrefab:null,this._bulletData[n.id]=n}},getBulletCfgDataById:function(t){return this._bulletData[t]?this._bulletData[t]:(cc.log(cc.js.formatStr("the bullet is not exist! (id = %s)",t)),null)}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PveCopyBibleEnum:[function(t,e,i){"use strict";cc._RF.push(e,"72761M9GoVIcZI47oQRIMFC","PveCopyBibleEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.PVE_COPY_BIBLE_TYPE=void 0,function(t){t[t.START=0]="START",t[t.HERO=1]="HERO"}(i.PVE_COPY_BIBLE_TYPE||(i.PVE_COPY_BIBLE_TYPE={})),cc._RF.pop()},{}],PveCopyBibleManager:[function(t,e,i){"use strict";cc._RF.push(e,"1c3acxp4iFFB7rLcPJGXnVt","PveCopyBibleManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("../Model/PveCopyBibleReqVO"),a=cc._decorator,r=(a.ccclass,a.property,t("../../../TS/Hero/Model/HeroFragmentModel")),o=function(){function t(){this._tabIndex=0,this._heroFragmentIndex=0}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addServerListener(),this.addEventListener()},t.prototype.destroyData=function(){this._heroFragmentList=null,this._allLevelList=null,this._allHeroChipsList=null,this._fullLevelList=null,this._heroFragmentIndex=0},t.prototype.addServerListener=function(){var t=td.MsgModuleName.PveGeneralCopy,e=td.MsgCmd.PVE_GENERAL_COPY;td.ServerDelegate.registerMessage(t,e.STORY_QUICKLY_RECEIVE_STAR_REWARD,this.onReward.bind(this))},t.prototype.addEventListener=function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.PVE_COPY_BIBLE_HERO_FRAGMENT_SELECT]=this.onHeroFragmentSelelct,i[e.PVE_COPY_BIBLE_ONE_KEY]=this.oneKeyReward,t.registerEvents(i,this)},t.prototype.onReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_COPY_BIBLE_REFRESH_ONE_KEY)}},t.prototype.onHeroFragmentSelelct=function(t){this.setHeroFragmentIndex(t),td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_COPY_BIBLE_HERO_REFRESH)},t.prototype.setHeroFragmentIndex=function(t){this._heroFragmentIndex=t},t.prototype.getHeroFragmentIndex=function(){return this._heroFragmentIndex},t.prototype.setTabIndex=function(t){this._tabIndex=t},t.prototype.getTabIndex=function(){return this._tabIndex},t.prototype.getNotFullLevelList=function(){return td.PveGeneralCopyManager.getGateModelByNotFull()||[]},t.prototype.initAllLevelList=function(){return td.PveGeneralCopyManager.getAllGateData()||[]},t.prototype.initFullLevelList=function(){return td.PveGeneralCopyManager.getGateModelByFull()||[]},t.prototype.setGateDataById=function(t){var e=td.PveGeneralCopyManager.getGateModelByGateId(t);e&&(this._showGateData=e)},t.prototype.getGateData=function(){return this._showGateData},t.prototype.initAllHeroChipsByList=function(t){for(var e={1:[],2:[],3:[]},i=0;i<t.length;i++)for(var n=t[i],a=td.RewardManager.parseRewardListDetail(n.getDropShowRewards()),o=0;o<a.length;o++){var s=a[o];if(s.getGoodsSubType()==td.GoodsSubType.HERO_FRAGMENT){var l=new r;l.init(s);var c=e[l.getCurCamp()];c.includes(s.getId())||c.push(s.getId())}}for(var u=1;u<=3;u++)e[u].reverse();return e},t.prototype.getAllHeroChipsByList=function(){return this._allHeroChipsList||(this._allHeroChipsList=this.initAllHeroChipsByList(this.getAllLevelList())),this._allHeroChipsList},t.prototype.getAllLevelList=function(){return this._allLevelList||(this._allLevelList=this.initAllLevelList()),this._allLevelList},t.prototype.getFullLevelList=function(){return this._fullLevelList||(this._fullLevelList=this.initFullLevelList()),this._fullLevelList},t.prototype.oneKeyReward=function(){var t=new n.PveCopyBibleOneKeyRewardReqVO;td.ServerDelegate.sendMessage(t)},t.prototype.getListByCamp=function(t){return this._heroFragmentList||(this._heroFragmentList=this.getAllHeroChipsByList()),this._heroFragmentList[t]},t.prototype.getGateListByRewardId=function(t){for(var e=[],i=this.getFullLevelList(),n=i.length-1;n>=0;n--)for(var a=i[n],r=a.getDropShowRewards(),o=0;o<r.length;o++){if(r[o][1]==t){e.push(a);break}}return e},t.prototype.getSweepCount=function(t){for(var e=0,i=0;i<t.length;i++)e+=t[i].getLeftChallengeTimes();return e},t.prototype.getStoryIdList=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].getStroyId());return e},t.prototype.getUserLife=function(t){td.Account.getUserData().getEnergy()},t.prototype.setSweepData=function(t){this._sweepData=t},t.prototype.getSweepData=function(){return this._sweepData},t.prototype.setOneKeyData=function(t){this._oneKeyData=t},t.prototype.getOneKeyData=function(){return this._oneKeyData},t.prototype.setOneKeyNum=function(t){this._oneKeyNum=t},t.prototype.getOneKeyNum=function(){return this._oneKeyNum},t.prototype.getEnergyCount=function(){return td.ItemManager.getItemNumById(td.ItemEnum.EnergyItem)},t.prototype.getOneKeyActive=function(){td.PveGeneralCopyManager.hasBoxToReceive(1,td.PveGeneralCopyManager.getCurChapterId())},t}();i.default=o,cc._RF.pop()},{"../../../TS/Hero/Model/HeroFragmentModel":"HeroFragmentModel","../Model/PveCopyBibleReqVO":"PveCopyBibleReqVO"}],PveCopyBibleReqVO:[function(t,e,i){"use strict";cc._RF.push(e,"fc30dWvmh5JJrEVLU2HCYtj","PveCopyBibleReqVO");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.PveCopyBibleOneKeySweepReqVO=i.PveCopyBibleOneKeyRewardReqVO=i.PveCopyBibleReqBaseVO=void 0;var a=function(){return function(){this.module=td.MsgModuleName.PveGeneralCopy,this.cmd=0}}();i.PveCopyBibleReqBaseVO=a;var r=function(t){function e(){var e=t.call(this)||this;return e.cmd=td.MsgCmd.PVE_GENERAL_COPY.STORY_QUICKLY_RECEIVE_STAR_REWARD,e}return n(e,t),e}(a);i.PveCopyBibleOneKeyRewardReqVO=r;var o=function(t){function e(e,i,n,a){var r=t.call(this)||this;return r.goodsUid="",r.cmd=td.MsgCmd.PVE_GENERAL_COPY.STORY_QUICKLY_WIPE_OUT,r.goodsUid=a,r.storyIdList=e,r.hangUpTimes=i,r.num=n,r}return n(e,t),e}(a);i.PveCopyBibleOneKeySweepReqVO=o,cc._RF.pop()},{}],PveCopyManager:[function(t,e,i){"use strict";cc._RF.push(e,"87d2ePbQbtKHo5XINy08ohc","PveCopyManager");var n,a=o(t("../../../TS/fight/pvp/Model/PvpFsmEventId")),r=(o(t("../../Hero/Manager/HeroManager")),o(t("../../Pet/Manager/PetManager")),o(t("./../../fight/pve/manager/PveDataHelper")));function o(t){return t&&t.__esModule?t:{default:t}}var s=t("PveCopyEnum"),l=t("PveMapManager"),c=t("PveFightManager"),u=t("PveUiManager"),d=t("PveNodePoolManager"),h=t("PveBuildTowerManager");td.PveCopyManager=((n={_copyType:null,_copyId:null,_chapterId:null,_gateId:null,_gateData:null,_bPassJump:null,_isHook:null,_battleTime:null,_lastHookEnermyWave:0,_hookEnermyWaveArray:null,isFirstEnterHook:!0,_bossTotalDamage:null,_statisticsBossDamage:null,_bossInspriteAdd:0,_bossHp:null,_bossLeftHp:null,_killTime:null,_maxSingleHurtHeroSId:0,_maxSingleHurt:0,_skillMaxSingleHurt:0,_maxSingleHurtIsCritical:!1,_hurtStatistics:null,_maxHurtPet:0,_maxHurtPetSid:0,_challengeRewards:null,_hpTimes:100,_lastWaveData:null,_heartCount:10,_floor:1,init:function(){this._copyType=0,this._chapterId=0,this._gateId=0,this._gateData=null,this._bPassJump=!1,this._isHook=!1,this._battleTime=0,this._lastIsHook=null,this._bossInspriteAdd=0,this._bossHp=0,this._bossLeftHp=0,this._killRewards=[],this._bossTotalDamage=0,this._maxSingleHurt=0,this._maxSingleHurtHeroSId=0,this._skillMaxSingleHurt=0,this._maxSingleHurtIsCritical=!1,this._recordId=0,this._hpTimes=100,this._lastWaveData={},this._killTime=0,this._heartCount=10,this._hurtStatistics={},this._floor=1},gotoPveFight:function(){c.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.OVER),gdk.fsm.Fsm.broadcastEvent(a.default.ENTER_PVP_PANEL)},initCopyData:function(t,e){switch(void 0===e&&(e=!1),this._copyType=t.copyType,this._hpTimes=100,this._copyType){case s.PVEFightType.GeneralCopy:this._initGeneralCopy(t);break;case s.PVEFightType.MaterialsCopy:this._initMaterialsCopy(t);break;case s.PVEFightType.MagicRecordCopy:this._initMagicRecordCopy(t);break;case s.PVEFightType.DemonTreasureCopy:this._initDemonTreasureCopy(t);break;case s.PVEFightType.AncientCorridor:this._initAncientCopy(t);break;case s.PVEFightType.Dipper:this._initDipperCopy(t);break;case s.PVEFightType.EightDiagrams:this._initEightDiagramsCopy(t);break;case s.PVEFightType.CHESS:this._initChessCopy(t)}e?(this._maxSingleHurt=0,this._maxSingleHurtHeroSId=0,this._skillMaxSingleHurt=0,this._maxSingleHurtIsCritical=!1,this._maxHurtPet=0,this._maxHurtPetSid=0):(u.removeFightLayer(),u.onDestroy(),l.onDestroy(),c.onDestroy(),h.onDestroy())},_initGeneralCopy:function(t){if(this._chapterId=t.chapterId,this._storyId=t.gateId,this._gateId=t.gateId2,this._isHook=t.isHook||!1,this._hpTimes=t.hpTimes||0,9999===this._chapterId)this._bPassJump=!1,this._copyName=td.Language.FirstBattleName;else{var e=td.PveGeneralCopyManager.getChapterDataByChapterId(this._chapterId);this._bPassJump=!e.isPassed(),this._copyName=e.getChapterName()}this._gateData=td.GetTableClass(td.TableEnum.PveGeneralCopyGateTable).getCfgDataByChapterAndGate(this._chapterId,this._storyId),this._roadRes=this._isHook?this._gateData.autoRoadRes:this._gateData.roadRes,this._mapRes=this._isHook?this._gateData.autoMapRes:this._gateData.mapRes,this._roadIndex=this._isHook?this._gateData.autoRoadIndex:this._gateData.roadIndex,this._gateId=this._isHook?this._gateData.autoGateId:this._gateId,this._mapIndex=this._gateData.mapIndex},_initAncientCopy:function(t){var e=t.mapIndex,i=t.roadIndex,n=t.gateId,a=t.battleTime;this._copyId=t.id,this._roadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(i,3)),this._mapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(e,3)),this._roadIndex=i,this._copyName=t.name,this._hpTimes=t.hpTimes,this._lastWaveData=t.lastWaveData,this._gateId=n,this._battleTime=a,this._mapIndex=e},_initDipperCopy:function(t){var e=t.mapIndex,i=t.roadIndex,n=t.gateId;this._copyId=t.id,this._roadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(i,3)),this._mapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(e,3)),this._roadIndex=i,this._copyName=t.name,this._hpTimes=t.hpTimes,this._gateId=n,this._mapIndex=e,this._heartCount=t.heartCount},_initDemonTreasureCopy:function(t){var e=t.mapIndex,i=t.roadIndex,n=t.gateId,a=t.battleTime;this._roadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(i,3)),this._mapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(e,3)),this._roadIndex=i,this._copyName=t.name,this._gateId=n,this._battleTime=a,this._bossId=t.bossId,this._bossHp=t.bossHp,this._killRewards=t.killRewards,this._bossTotalDamage=0,this._mapIndex=e,this._killTime=0},_initMaterialsCopy:function(t){var e=t.mapIndex,i=t.roadIndex,n=t.gateId;this._roadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(i,3)),this._mapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(e,3)),this._roadIndex=i,this._copyName=t.name,this._copyId=t.copyId,this._gateData=t.gateData,this._gateId=n,this._mapIndex=e},_initMagicRecordCopy:function(t){var e=t.mapIndex,i=t.roadIndex,n=t.gateId;this._roadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(i,3)),this._mapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(e,3)),this._roadIndex=i,this._copyName=t.name,this._gateId=n,this._recordId=t.recordId,this._mapIndex=e,this._hpTimes=t.hpTimes},_initEightDiagramsCopy:function(t){var e=t.mapIndex,i=t.roadIndex,n=t.gateId;this._roadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(i,3)),this._mapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(e,3)),this._roadIndex=i,this._copyName=t.name,this._gateId=n,this._mapIndex=e,this._hpTimes=t.hpTimes},_initChessCopy:function(t){var e=t.mapIndex,i=t.roadIndex,n=t.gateId;this._roadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(i,3)),this._mapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(e,3)),this._roadIndex=i,this._copyName=t.name,this._gateId=n,this._mapIndex=e,this._hpTimes=t.hpTimes,this._heartCount=t.heartCount,this._floor=t.floor},initHookInfo:function(){this._hpTimes=100,this._copyType=s.PVEFightType.Hook;var t=td.GetConfig("HOOK_UP_MAP"),e=td.GetConfig("HOOK_UP_MAP_ROAD");this._hookEnermyWaveArray&&0!==this._hookEnermyWaveArray.length||(this._hookEnermyWaveArray=td.GetConfig("HOOK_UP_ENERMY_WAVES").slice(0));var i=Math.floor(Math.random()*this._hookEnermyWaveArray.length);this._roadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(e,3)),this._mapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(t,3)),this._roadIndex=e,this._gateId=this._hookEnermyWaveArray[i],this._isHook=!0,this._lastHookEnermyWave=i,this._hookEnermyWaveArray.splice(i,1),td.TableManager.getTableClass(td.TableEnum.PveCreateEnemyTable).loadGateCfgById(this._gateId),this._mapIndex=t,this._lastWaveData={}},prepareHookData:function(){this.initHookInfo(),u.removeFightLayer(),u.onDestroy(),l.onDestroy(),c.onDestroy(),d.destroyData(),d.init(),h.onDestroy()},prepareFirstBattle:function(){var t=td.GetConfig("PVE_GUIDE_MAP"),e=td.GetConfig("PVE_GUIDE_ROAD"),i=td.GetConfig("PVE_GUIDE_GATE");this._roadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(e,3)),this._mapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(t,3)),this._roadIndex=e,this._gateId=i,this._isHook=!1,this._mapIndex=t,this._hpTimes=100,td.TableManager.getTableClass(td.TableEnum.PveCreateEnemyTable).loadGateCfgById(this._gateId),u.removeFightLayer(),u.onDestroy(),l.onDestroy(),c.onDestroy(),d.destroyData(),d.init(),h.onDestroy()},getPveMapParticalName:function(){for(var t=td.GetConfig("PVE_MAP_PARTICLE"),e=t.length-1;e>=0;e--){var i=t[e];if(ArrayUtils.contains(i[1],this._mapIndex))return"fightRes/pve/otherAnimation/PVE_Particle/"+i[0]}return null},isHook:function(){return this._isHook},isLastHook:function(){return this._lastIsHook},getBattleTime:function(){return this._battleTime},getBossId:function(){return this._bossId},destroyData:function(){this._copyType=null,this._chapterId=null,this._gateId=null,this._gateData=null,this._bPassJump=null,this._lastIsHook=this._isHook,this._isHook=null,this._bossId=null,this._battleTime=null,this._statisticsBossDamage={},this._bossInspriteAdd=0,this._killRewards=[],this._bossLeftHp=0,this._bossTotalDamage=0,this._maxSingleHurt=0,this._maxSingleHurtHeroSId=0,this._skillMaxSingleHurt=0,this._recordId=0,this._heartCount=10,this._hurtStatistics={},this._maxHurtPet=0,this._maxHurtPetSid=0},clearStatistics:function(){this._statisticsBossDamage={},this._hurtStatistics={},this._bossLeftHp=0,this._bossTotalDamage=0,this._maxSingleHurt=0,this._maxSingleHurtHeroSId=0,this._skillMaxSingleHurt=0,this._maxHurtPet=0,this._maxHurtPetSid=0}}).isHook=function(){return this._isHook},n.getJumpStatus=function(){return this._bPassJump},n.getCopyType=function(){return this._copyType},n.getCopyId=function(){return this._copyType===s.PVEFightType.MaterialsCopy||this._copyType===s.PVEFightType.AncientCorridor||this._copyType===s.PVEFightType.Dipper?this._copyId:this._gateData?this._gateData.storyId:this._gateId},n.getRecordId=function(){return this._recordId},n.getGateId=function(){return this._gateId},n.getStoryId=function(){return this._storyId},n.getChapterId=function(){return this._chapterId},n.getCopyMapRes=function(){return this._mapRes},n.getCopyRoadRes=function(){return this._roadRes},n.getCopyRoadIndex=function(){return this._roadIndex},n.getGateIndex=function(){return this._gateData?this._gateData.gateIndex:1},n.getCopyDifficult=function(){return this._gateData.chapterType},n.getGateData=function(){return this._gateData},n.getCopyName=function(){return this._copyName},n.setBossTotalDamage=function(t){this._bossTotalDamage=t<this._bossHp?t:this._bossHp,this._bossTotalDamage=this._bossTotalDamage>0?this._bossTotalDamage:0},n.getBossTotalDamage=function(){return this._bossTotalDamage},n.getBossHp=function(){return this._bossHp},n.setBossLeftHp=function(t){this._bossLeftHp=t},n.getBossLeftHp=function(){return this._bossLeftHp>0?this._bossLeftHp:0},n.setKillTime=function(t){this._killTime=t},n.getKillTime=function(){return Math.floor(1e3*this._killTime)},n.getCopyKillRewards=function(){return this._copyType!==s.PVEFightType.DemonTreasureCopy||this._bossLeftHp>0?[]:this._killRewards},n.statisticsBossDamage=function(t,e){t&&(this._statisticsBossDamage[t]||(this._statisticsBossDamage[t]=0),this._statisticsBossDamage[t]+=e)},n.statisticsTotalDamage=function(t,e){t&&(this._hurtStatistics[t]||(this._hurtStatistics[t]=0),this._hurtStatistics[t]+=e)},n.getStatisticsBossDamage=function(){return this._statisticsBossDamage},n.getHurtStatistics=function(){return this._hurtStatistics},n.getTotalHurtStatistics=function(){var t=0;for(var e in this._hurtStatistics)t+=this._hurtStatistics[e];return t},n.clearBossDamage=function(){this._statisticsBossDamage={},this._bossTotalDamage=0},n.getBossAtkMult=function(t){return this._bossInspriteAdd||0},n.staticSingleHurt=function(t,e,i){(void 0===i&&(i=!1),t===0-td.PveEnum.PVE_UI_SKILL_ID.IceRain||t===0-td.PveEnum.PVE_UI_SKILL_ID.Light)?this._skillMaxSingleHurt=Math.max(e,this._skillMaxSingleHurt):(e>this._maxSingleHurt||e>this._maxHurtPet)&&t&&(r.default.getHeroModelBySid(t)?(this._maxSingleHurt=e,this._maxSingleHurtHeroSId=t,this._maxSingleHurtIsCritical=i):r.default.getPetModelBySid(t)&&(this._maxHurtPet=e,this._maxHurtPetSid=t))},n.getMaxSingleHurtRoleType=function(){var t=r.default.getHeroModelBySid(this._maxSingleHurtHeroSId);return t&&t.getId()||0},n.getMaxSingleHurt=function(){return Math.floor(this._maxSingleHurt,this._skillMaxSingleHurt)},n.isMaxSingleHurtCritical=function(){return this._maxSingleHurtIsCritical},n.getMaxPetHurt=function(){return this._maxHurtPet},n.getMaxHurtPetId=function(){var t=r.default.getPetModelBySid(this._maxHurtPetSid);return t?t.getId():0},n.getHpTimes=function(){return this._hpTimes||100},n.getLastWavaData=function(){return this._lastWaveData||{}},n.getCurHeartCount=function(){return this._heartCount||10},n.getFloor=function(){return this._floor},n),cc._RF.pop()},{"../../../TS/fight/pvp/Model/PvpFsmEventId":"PvpFsmEventId","../../Hero/Manager/HeroManager":"HeroManager","../../Pet/Manager/PetManager":"PetManager","./../../fight/pve/manager/PveDataHelper":"PveDataHelper",PveBuildTowerManager:"PveBuildTowerManager",PveCopyEnum:void 0,PveFightManager:"PveFightManager",PveMapManager:"PveMapManager",PveNodePoolManager:"PveNodePoolManager",PveUiManager:"PveUiManager"}],PveCreateEnemyTable:[function(t,e,i){"use strict";cc._RF.push(e,"b1f39NuMMBNxrrmfiAnsZlW","PveCreateEnemyTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PveCreateEnemyTable",properties:{_tblName:"pve_produce_monster_config",_cfgData:null,_deleteJson:{default:!1,override:!0}},init:function(){this._cfgData=[],this._jsonData.sort(function(t,e){return t.gateId-e.gateId})},loadGateCfgById:function(t){this._cfgData=[];for(var e=0,i=this._jsonData.length;e<i;e++){var n=this._jsonData[e];if(n.gateId>t)break;if(n.gateId===t){var a={number:n.number,interval:n.interval,enemyId:n.enemyId,roadId:n.roadId,dirTipsPointId:n.dirTipsPointId,showTime:n.showTime,waveId:n.id};this._cfgData.push(a)}}this._cfgData.sort(function(t,e){return t.showTime-e.showTime})},getCurGateCfg:function(){return cc.assert(this._cfgData.length>0,"please call loadWaveByGateId first!"),this._cfgData},getCfgByWaveId:function(t){for(var e=0,i=this._jsonData.length;e<i;e++){var n=this._jsonData[e];if(n.id===t)return n}return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PveDataHelper:[function(t,e,i){"use strict";cc._RF.push(e,"783e7yJ8otHmJxw6kFc5UJi","PveDataHelper"),Object.defineProperty(i,"__esModule",{value:!0});var n=t("PveCopyEnum"),a=t("PveBuildTowerManager"),r=t("../../../Chess/Manager/ChessManager"),o=t("../../../Hero/Manager/HeroManager"),s=function(){function t(){}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.getBattleHeroModels=function(){var t=[];if(td.PveCopyManager.getCopyType()!=n.PVEFightType.CHESS||td.PveCopyManager.isHook()){var e=td.BattleArrayManager.getBattleArrayData();for(var i in e){if(!e.hasOwnProperty(i))return;var a=e[i],s=o.default.getInstance().getHeroBySId(a.getMercenarySId());s=s.getBattleHeroModel(),t.push(s)}}else t=r.default.getInstance().getChessArray();return t},t.getBattlePetModels=function(){var t=[];if(td.PveCopyManager.getCopyType()==n.PVEFightType.CHESS);else{var e=td.BattleArrayManager.getPetLineupMap();t=Object.values(e)}return t.sort(function(t,e){return t.getOrderId()-e.getOrderId()}),t},t.getSkillAdditions=function(t,e){return void 0===e&&(e=!1),td.PveCopyManager.getCopyType()==n.PVEFightType.CHESS?r.default.getInstance().getSkillEffect(t):e?td.TechnologyManager.getAdvanceEfect(t):td.TechnologyManager.getTecEffect(t)},t.getHeroModelBySid=function(t){var e=a.getHeroModelBySid(t);return e?e.getMercenaryDataModel():null},t.getPetModelBySid=function(t){for(var e=this.getBattlePetModels(),i=0;i<e.length;i++){var n=e[i];if(n.getSId()==t)return n}return null},t.getBattleHerosTotalPower=function(){var t=td.PveFightManager.getTotalAttrAttack();if(td.PveCopyManager.getCopyType()==n.PVEFightType.CHESS)for(var e=this.getBattleHeroModels(),i=0;i<e.length;i++){t+=e[i].getBaseAttackPower()}else t=td.Account.getUserData().fightPower;return t},t.getBattleHerosAveragePower=function(){return this.getBattleHerosTotalPower()/this.getBattleHeroModels().length},t.getTecAddition=function(){var t=0;return td.PveCopyManager.getCopyType()==n.PVEFightType.CHESS||(t=td.TechnologyManager.getAllTecLevel()*td.GetConfig("PVE_TEC_UI_SKILL_FACTOR")/1e4),t},t.getIndexByHeroSid=function(t){var e=-1;td.PveCopyManager.getCopyType()==n.PVEFightType.CHESS?e=this.getHeroModelBySid(t).getOrderId():e=td.BattleArrayManager.getIndexByMercenarySid(t);return e},t}();i.default=s,cc._RF.pop()},{"../../../Chess/Manager/ChessManager":"ChessManager","../../../Hero/Manager/HeroManager":"HeroManager",PveBuildTowerManager:"PveBuildTowerManager",PveCopyEnum:void 0}],PveEffectLayer:[function(t,e,i){"use strict";cc._RF.push(e,"5af0b1toYFMKIENr25N1RYS","PveEffectLayer");t("PveFightManager");var n=cc.Class({extends:cc.Component,properties:{_bossCommingNode:null},onLoad:function(){},_addUserEventListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE,this.onPause,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME,this.onResume,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_RESTART_FIGHT,this.removeAllEffect,this),td.EventUtil.registerEvent(td.EventNameEnum.PLAY_BOSS_COMMING,this._playBossComming,this)},_playBossComming:function(){if(!cc.isValid(this._bossCommingNode)){if(this._bossCommingNode=td.GlobalFunction.createPrefabInstance("uiAnima/BOSS_laixi/BOSS_laixi"),!this._bossCommingNode)return;this.node.addChild(this._bossCommingNode),this._bossCommingNode.y=this.node.height/2+200,this._bossCommingNode.x=this.node.width/2}var t=this._bossCommingNode.getComponent(cc.Animation);t.play(t.defaultClip.name),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.BOSS_COMING)},_removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},onEnable:function(){this._addUserEventListener()},onDestroy:function(){this._removeListeners()},onPause:function(){for(var t=this.node.children,e=0,i=t.length;e<i;e++)t[e].pauseAllActions();this.node.active=!1},onResume:function(){this.node.active=!0;for(var t=this.node.children,e=0,i=t.length;e<i;e++)t[e].resumeAllActions()},removeAllEffect:function(){this.node.removeAllChildren();var t=td.GlobalFunction.createPrefabInstance(td.PveCopyManager.getPveMapParticalName());t&&(this.node.addChild(t),t.name="mapPartical",t.x=this.node.width/2,t.y=this.node.height/2)}});e.exports=n,cc._RF.pop()},{PveFightManager:"PveFightManager"}],PveEnemyDetailListView:[function(t,e,i){"use strict";cc._RF.push(e,"2b140TisjdCdYomQv1iEmOh","PveEnemyDetailListView");var n=t("BaseScrollView"),a=t("SpriteAnimation"),r=t("PveFightManager"),o=cc.Class({extends:n,properties:{},setData:function(t){this._super(t)},setItemView:function(t,e){var i=t.getChildByName("layout"),n=i.getChildByName("labName"),o=i.getChildByName("labLeftCount"),s=t.getChildByName("imgEnemy"),l=t.getChildByName("labEnemyTypeName"),c=t.getChildByName("labEnemyDesc"),u=e.getEnemyName(),d=e.getEnemyTypeName(),h=e.getEnemyDesc();t._tag=e.getId(),n.getComponent(cc.Label).string=u,o.getComponent(cc.Label).string="x"+r.getLeftEnemyNumById(e.getId()),l.getComponent(cc.Label).string=d,c.getComponent(cc.Label).string=h,s.addComponent(a).init(e,7,!1,null,900);var p=1;switch(e.getGrade()){case 1:case 2:p=.7;break;case 3:p=.45;break;case 5:p=.6}return s.scale=2*p,t}});e.exports=o,cc._RF.pop()},{BaseScrollView:void 0,PveFightManager:"PveFightManager",SpriteAnimation:"SpriteAnimation"}],PveEnemyDetail:[function(t,e,i){"use strict";cc._RF.push(e,"7bb11UkVBJLdJyEalDK1zyp","PveEnemyDetail");var n=t("EnemyModel"),a=t("PveFightManager"),r=cc.Class({extends:cc.Component,properties:{_scrollViewLogic:null,_bSet:null},onLoad:function(){this._bSet=!1;var t=this.node.getChildByName("scrollView");this._scrollViewLogic=t.getComponent("PveEnemyDetailListView"),this._item=this.node.getChildByName("infoItem"),this._item.active=!1,this.addCustomListener()},addCustomListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.SHOW_PVE_FIGHT_RESULT_VIEW,this.closeWindows,this),td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_ENEMY_NUM,this.refreshEnemyNum,this)},closeWindows:function(){cc.isValid(this.node)&&this.node.removeFromParent()},refreshEnemyNum:function(){if(cc.isValid(this.node))for(var t=this._scrollViewLogic.getAllItems(),e=0,i=t.length;e<i;e++)for(var n=t[e].children,a=0,r=n.length;a<r;a++){var o=n[a];this.updateNum(o)}},updateNum:function(t){var e=t.getChildByName("layout").getChildByName("labLeftCount"),i=t._tag;e.getComponent(cc.Label).string="x"+a.getLeftEnemyNumById(i)},setEnemyDetail:function(){this._scrollViewLogic.removeAllItems();for(var t={},e=td.TableManager.getTableClass(td.TableEnum.PveCreateEnemyTable).getCurGateCfg(),i=0,a=e.length;i<a;i++){var r=e[i].enemyId,o=td.TableManager.getTableClass(td.TableEnum.PveEnemyTable).getEnemyCfgDataById(r);!t[r]&&o&&(t[r]=o)}var s=[];for(var r in t){o=t[r];var l=new n;l.init(o),s.push(l)}s.sort(function(t,e){return t.getGrade()!==e.getGrade()?e.getGrade()-t.getGrade():t.getId()-e.getId()}),this._scrollViewLogic.setData(s)},onCloseDetailPanel:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_ENEMY_DETAIL)}});e.exports=r,cc._RF.pop()},{EnemyModel:"EnemyModel",PveFightManager:"PveFightManager"}],PveEnemySoul:[function(t,e,i){"use strict";cc._RF.push(e,"9b5a9fWPEFMFbCoBhOorZ3Y","PveEnemySoul");var n=t("PveFightObject"),a=t("PveUiManager"),r=(t("CommonEnum"),cc.Class({extends:n,properties:{_selfData:null},initData:function(t){this._selfData=t,this._bRefreshScale=!1,this.node.scale=.5,this.node.setPosition(t.startPos),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"PVE _nengliang",this.node),this.playFlyAction()},onLoad:function(){this._super()},onDestroy:function(){this._super(),this._selfData=null},playFlyAction:function(){var t=120*Math.random(),e=a.getUILayer().getChildByName("PveNode").getChildByName("angerPanel").getPosition(),i=cc.v2(e.x+40,e.y);i.x-=t;var n=this._selfData.startPos,r=td.GlobalFunction.getDistance(n,i)/600,o=this,s=cc.callFunc(function(){o.addAngerPower()}),l=cc.sequence(cc.moveTo(r,i),s),c=cc.jumpBy(r,cc.v2(t,0),t,1),u=cc.spawn(l,c);this.node.runAction(u)},onRestartFight:function(){this.removeSelf()},addAngerPower:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.CHANGE_CUR_SKILL_POWER_COUNT,this._selfData.soulNum),this.removeSelf()},removeSelf:function(){this.node.stopAllActions(),this.node.removeFromParent(),this.node.destroy()}}));e.exports=r,cc._RF.pop()},{CommonEnum:void 0,PveFightObject:"PveFightObject",PveUiManager:"PveUiManager"}],PveEnemyTable:[function(t,e,i){"use strict";cc._RF.push(e,"68259TXRCdEzYrsEVt15j1T","PveEnemyTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PveEnemyTable",properties:{_tblName:"pve_enemy",_enemyData:null},init:function(){this._enemyData={};this._enemyData;for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];n.animationRes="fightRes/pve/enemy/"+n.res+"/"+n.res+"_run",2===n.skillType&&(n.animationRes="fightRes/pve/Boss/"+n.res+"/"+n.res+"_idle",n.resPath="fightRes/pve/Boss/"+n.res+"/",n.prefab_skill=n.resPath+n.res+"_skill"),this._enemyData[n.id]=n}},getEnemyCfgDataById:function(t){return this._enemyData[t]?this._enemyData[t]:(cc.log(cc.js.formatStr("the Enemy is not exist! (id = %s)",t)),null)}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PveEnum:[function(t,e,i){"use strict";var n;cc._RF.push(e,"9bb09JIMzVCEbcZA8I8QODQ","PveEnum"),td.PveEnum={HeroScale:1.4,RenderType:{None:0,SingleSprite:1,AnimationClip:2},PVE_DIRECTION:{UP:"shang",DOWN:"xia",LEFT:"zuo",RIGHT:"you",RIGHT_UP:"youshang",LEFT_UP:"zuoshang",RIGHT_DOWN:"youxia",LEFT_DOWN:"zuoxia"},DIR_DEGREE:{270:"shang",90:"xia",180:"zuo",0:"you",315:"youshang",225:"zuoshang",45:"youxia",135:"zuoxia",360:"you"},DIR_DEGREE_TYPE:(n={shang:3,xia:7,zuo:5,you:1,youshang:2,zuoshang:4,youxia:8,zuoxia:6},n.you=1,n),PVE_ACTION_TYPE:{Idle:"Idle_",Attack:"Attack_",Run:"Move_",Die:"Die_"},PVE_HERO_VOCATION:{SHOOTER:1,GUNNER:2,MASTER:3,COUNSELLOR:4,PET_PHYSIC:5,PET_MAGIC:6},VOCATION_RESISTANT:{1:2,2:3,3:4,4:1},CAMP_RESISTANT:{1:2,2:3,3:1},PVE_HERO_SCRIPT:{1:"PveOrdiraryTower",2:"PveMovableTower"},PVE_ENEMY_ATTR_TYPE:{ORDINARY:1,PHYSICS_DEFENSE:2,MAGIC_DEFENSE:3,BOSS:4},PVE_ENEMY_SKILL_TYPE:{NONE:1,BOMB:2},PVE_ENEMY_SCRIPT:{1:"OrdinaryEnemy",2:"BombEnemy",3:"BossSkillEnemy"},PVE_ENEMY_TYPE:{BOSS_SKILL:3},PVE_BULLET_SKILL_TYPE:{Ordinary:1,WithoutBallistic:2,BOUNCE:3,PIERCE_THROUGH:4},PVE_FIGHT_STATUS:{ENTER:0,READY:1,FIHGT:2,OVER:3},PVE_EFFECT_TYPE:{PureHurt1:1,ReduceSpeed:2,Vertigo:3,PersistentInjury:4,ReduceMagicDefence:5,ReducePhysicsDefence:6,Inspire:7,PureHurt2:8,TowerHurt:9,TowerSpeedBuff:10,TowerFreezeBuff:11,TowerAttackBuff:12,FinalHurtAddition:13,AnyTimesHurtK:14,TowerDamageCrit:15,TowerSpeedChange:16,SpeedChange:17,MonsterHpRecover:18},PVE_ATTACK_TYPE:{Monomer:1,Group:2},PVE_HURT_TYPE:{Physical:1,Magical:2,Real:3,HpRecover:4},PVE_BULLET_MOVE_TYPE:{None:0,Straight:1,Parabolic:2},PVE_ENEMY_STATUS:{READY:0,Move:1,Die:2},PVE_BUTTET_STATUS:{Fly:1,Bomb:2,Die:3},PVE_PROTEGE_STATUS:{Alive:1,Die:2},PVE_OBJECT_TAG_RATIO:{Enemy_Ratio:1e4,Hero_Ratio:100,LoveSkill_Ratio:10},COLLISION_GROUP:{None:"None",BulletGroup:"bulletGroup",TowerGroup:"towerGroup",ProtegeGroup:"protegeGroup",EnemyGroup:"enemyGroup",LoveSkillGroup:"LoveSkillGroup",SkillFlyGroup:"SkillFlyGroup"},SKILL_TRIGGER_TYPE:{AttackTimesTrigger:1,ChanceTrigger:2,IntervalTrigger:3},PVE_UI_SKILL_ID:{IceRain:2001,Inspire:2002,Light:2003},PVE_LOVE_SKILL_TYPE:{LineLove:1,AreaLove:2,TowerBuffChange:3},PVE_LOVE_SKILL_EFFECT_TYPE:{OneTimeHurt:0,DurativeHurt:1,ReduceSpeed:2,ReducePhysicsDefence:3,ReduceMagicDefence:4,OddsSkill:5,ChangeTowerOrdinaryHurt:6,ChangeTowerSkillHurt:7},PVE_TOWER_SKILL:{ChuangYunJian:1,LianHuangDaJi:2,DiBao:3,LeiTingYiJi:4,BingCi:5,BingFengZhiLi:6,YunShi:7,ChuanSongMen:8,RuYiBang:101,BaoLieJianYu:102,TianYuanHuLuZhen:103,WuXianJianZhi:1e3,XianXueLingYU:1001,SiWangDiaoLing:1002,FengKuangChanRao:1003,ShouXueFeiTeng:1004},PVE_TOWER_SKILL_ENUM:{1:t("ChuangYunJian"),2:t("LianHuangDaJi"),3:t("DiBao"),4:t("LeiTingYiJi"),5:t("BingCi"),6:t("BingFengZhiLi"),7:t("YunShi"),8:t("ChuanSongMen"),101:t("RuYiBang"),102:t("BaoLieJianYu"),103:t("TianYuanHuLuZhen"),1004:t("ShouXueFeiTeng")},PVE_BOSS_SKILL_TYPE:{XieNengFaDun:301,ShiHuaPiFu:302,QiMenDunJia:303,LianXingPiFu:304,BingDongZhiLi:305,BingShuangDaDi:306,ZiRanZhiLi:307,FuKongShu:308},PVE_BOSS_SKILL_ENUM:{301:t("XieNengFaDun"),302:t("ShiHuaPiFu"),303:t("QiMenDunJia"),304:t("LianXingPiFu"),305:t("BingDongZhiLi"),306:t("BingShuangDaDi"),307:t("ZiRanZhiLi"),308:t("FuKongShu")},PVE_ENERMY_GRADE:{NORMAL:1,ELIET:2,SMALLBOSS:3,DEMON_BOSS:4,BOSS:5},getVocationHurtType:function(t){return t===td.PveEnum.PVE_HERO_VOCATION.SHOOTER||t===td.PveEnum.PVE_HERO_VOCATION.GUNNER||t==td.PveEnum.PVE_HERO_VOCATION.PET_PHYSIC?td.PveEnum.PVE_HURT_TYPE.Physical:t===td.PveEnum.PVE_HERO_VOCATION.MASTER||t===td.PveEnum.PVE_HERO_VOCATION.COUNSELLOR||t===td.PveEnum.PVE_HERO_VOCATION.PET_MAGIC?td.PveEnum.PVE_HURT_TYPE.Magical:void 0},TecEffectType:{ABSOLUTE_HURT:1,DAMAGE_RANGE:2,ATTACK_INTERVAL:3,HURT_ADD:4,IGNOR_GUARD_AND_TIMS:5,EXTEND_VERTIGO:6,EXTEND_REDUCTION:7,EXTEND_BURN:8,HURT_ADD_ALL:9},SKILL_DEAD_TYPE:{MOVE_X:0,MOVE_Y:1,MOVE_RELATIVE:2,STAY:3,ROTATION:4,SCALEY:5,DISAPPEARE:6},PVE_SKILL_RES_TYPE:{TOP:1,MIX:2,GROUND:3}},cc._RF.pop()},{BaoLieJianYu:"BaoLieJianYu",BingCi:"BingCi",BingDongZhiLi:"BingDongZhiLi",BingFengZhiLi:"BingFengZhiLi",BingShuangDaDi:"BingShuangDaDi",ChuanSongMen:"ChuanSongMen",ChuangYunJian:"ChuangYunJian",DiBao:"DiBao",FuKongShu:"FuKongShu",LeiTingYiJi:"LeiTingYiJi",LianHuangDaJi:"LianHuangDaJi",LianXingPiFu:"LianXingPiFu",QiMenDunJia:"QiMenDunJia",RuYiBang:"RuYiBang",ShiHuaPiFu:"ShiHuaPiFu",ShouXueFeiTeng:"ShouXueFeiTeng",TianYuanHuLuZhen:"TianYuanHuLuZhen",XieNengFaDun:"XieNengFaDun",YunShi:"YunShi",ZiRanZhiLi:"ZiRanZhiLi"}],PveFightFailPanel:[function(t,e,i){"use strict";cc._RF.push(e,"e9eb2tOMCZDPqhP7h66ERYU","PveFightFailPanel");var n=cc.Class({extends:cc.Component,properties:{_chapterId:null,_gateId:null},initData:function(){this._chapterId=td.PveCopyManager.getChapterId(),this._gateId=td.PveCopyManager.getCopyId()},onLoad:function(){},onDestroy:function(){this._curData=null},playLightAction:function(){var t=this.node.getChildByName("imgLight"),e=cc.rotateBy(1,30),i=cc.repeatForever(e);t.runAction(i)},goToSummonPanel:function(){this.returnToMainScene(td.PanelEnum.Panel_Gacha)},goToEquipBag:function(){this.returnToMainScene(td.PanelEnum.Panel_Bag)},onBtnHurtClick:function(){var t=gdk.rm.getResByUrl("prefab/Pve/PveHurtStaticsLayer"),e=cc.instantiate(t);this.node.addChild(e,9999,"9999")},goToHuntTreasure:function(){td.PanelManager.getInstance().clearShowPanelQueue(),td.UnlockManager.isTargetUnlock(td.ActorUnlockType.HuntTreasure,1,!0)?this.returnToMainScene(td.PanelEnum.Panel_HuntTreasure):this.returnToMainScene(td.PanelEnum.Panel_PVE_FIGHT_HOOK)},goToLineup:function(){this.returnToMainScene(td.PanelEnum.Panel_BattleArray)},returnToMainScene:function(t){cc.log("PveFightFailPanel returnToMainScene"),td.PanelManager.getInstance().clearShowPanelQueue(),td.PanelJumpManager.jumpToPanel(t)}});e.exports=n,cc._RF.pop()},{}],PveFightLayer:[function(t,e,i){"use strict";cc._RF.push(e,"0cf6aZ2P9tP2qhy0tbuM0hi","PveFightLayer");var n=r(t("./ProtegeEDCmp")),a=r(t("../../../EightDiagrams/Manager/EightDiagramsManager"));function r(t){return t&&t.__esModule?t:{default:t}}var o=t("PveFightManager"),s=t("PveUiManager"),l=t("PveMapManager"),c=t("PveNodePoolManager"),u=t("PveBuildTowerManager"),d=t("OrdinaryEnemy"),h=t("EnemyModel"),p=t("PveOrdiraryTower"),_=t("PveCopyEnum"),g=t("PveSkillModel"),f=cc.Class({extends:cc.Component,properties:{_enemyCountIndex:null,_heroCountIndex:null,_fightTotalTime:null,_curSpeedMult:null,_bPauseFightStatus:null,_protegeObj:null,_platformList:null,_bornPointAlreadyShow:null,_enemyBornTipsDiff:2,_adminDebugClick:0,_towerIds:null,_udpateZOrderCount:0,_petHookSkillCd:0},_addUserEventListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.BEGIN_CREATE_ENEMY,this.onBeginCreateEnemy,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_CHANGE_FIGHT_SPEED,this.onChangeSpeedMult,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE,this.onPause,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME,this.onResume,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_RESTART_FIGHT,this.onRestartFight,this),td.EventUtil.registerEvent(td.EventNameEnum.BUILD_TOWER_IN_LAYER,this.createTowerByChoose,this),td.EventUtil.registerEvent(td.EventNameEnum.CREATE_PVE_LOVE_SKILL,this.createPveLoveSkillNode,this),td.EventUtil.registerEvent(td.EventNameEnum.BUILD_PET_TOWER_IN_LAYER,this.createPetTowerByChoose,this),td.EventUtil.registerEvent(td.EventNameEnum.SHOW_PVE_FIGHT_RESULT_VIEW,this._hideProtege,this),td.EventUtil.registerEvent(td.EventNameEnum.GUIDE_PVE_CREATE_TMP_PLATFORM_FLAG,this.createTowerPlatform,this),td.EventUtil.registerEvent(td.EventNameEnum.GUIDE_PVE_SHOW_TMP_PLATFORM_FLAG,this.createTowerFlag,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_CREATE_PROTEGE,this.createProtege,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE_AND_HIDE_TOWER,this.onPauseAndHideTower,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME_AND_SHOW_TOWER,this.onResumeAndShowTower,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_MAP_INIT_SUCCC,this.onMapInitSucc,this),td.EventUtil.registerEvent(td.EventNameEnum.SHOW_PVE_FIGHT_WIN_STORYL,this._showSpecialDialog,this)},_hideProtege:function(){this._protegeObj&&(this._protegeObj.active=!1)},_removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},onLoad:function(){},onEnable:function(){this._enemyCountIndex=1,this._heroCountIndex=0,this._fightTotalTime=0,this._curSpeedMult=1,this._bPauseFightStatus=!1,this._platformList=[],this._bornPointAlreadyShow={},this._towerIds=[],this._addUserEventListener(),this.node.on(cc.Node.EventType.TOUCH_END,this.onClickCallBack,this),this._udpateZOrderCount=0,this._petHookSkillCd=2},onDisable:function(){this._removeListeners(),gdk.Timer.clearAll(this)},update:function(t){this._petHookSkillCd-=t,td.PveCopyManager.isHook()&&this._petHookSkillCd<=0&&(this._petHookSkillCd=td.GetConfig("PET_COMMON_CD_TIME"),this._showPetHookSkill()),this._udpateZOrderCount++,this._udpateZOrderCount%10==0&&o.getFightStatus()!==td.PveEnum.PVE_FIGHT_STATUS.ENTER&&o.getFightStatus()!==td.PveEnum.PVE_FIGHT_STATUS.OVER&&this._updateObjectZOrder()},onMapInitSucc:function(){td.GuideManager.isFirstBattle()||(this.createTowerPlatform(),this.createTowerFlag(),this.createDirTips(),this.createBoss(),this.createProtege()),u.buildBySaveConfig(!0),td.PveCopyManager.isHook()&&(td.EventUtil.dispatchEvent(td.EventNameEnum.ON_ONE_KEY_EMBATTLE,!1),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_BEGIN))},onRestartFight:function(){o.getAllWaveEnemyModel().length>0&&this.unschedule(this.createEnemy),this._fightTotalTime=0,this._enemyCountIndex=1,this._bornPointAlreadyShow={},this.node.removeAllChildren(),o.resetFight(),u.resetBuildData(),this.createTowerPlatform(),this.createTowerFlag(),this.createDirTips(),this.createBoss(),this.createProtege(),u.buildBySaveConfig(!1),this._clearBornAima(),this._protegeObj&&(this._protegeObj.active=!0),gdk.Timer.callLater(this,this.createBoss),td.PveCopyManager.clearStatistics()},onPause:function(){this._bPauseFightStatus=!0},onResume:function(){this._bPauseFightStatus=!1},onPauseAndHideTower:function(){if(td.PveCopyManager.isHook()){this.onPause();for(var t=0,e=this._towerIds.length;t<e;t++){var i=this.node.getChildByName("tower"+this._towerIds[t]);i&&(i.active=!1)}}},onResumeAndShowTower:function(){if(td.PveCopyManager.isHook()){for(var t=0,e=this._towerIds.length;t<e;t++){var i=this.node.getChildByName("tower"+this._towerIds[t]);i&&(i.active=!0)}this.onResume()}},onChangeSpeedMult:function(t){t>=1&&(this._curSpeedMult=t)},onBeginCreateEnemy:function(){o.getFightStatus()!==td.PveEnum.PVE_FIGHT_STATUS.OVER&&o.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.FIHGT),u.saveBuildMap(),this.schedule(this.createEnemy,.1),this.removeDirTips(),td.PveCopyManager.getCopyType()===_.PVEFightType.AncientCorridor&&this.createLastWaveEnemey()},createEnemy:function(t){if(!this._bPauseFightStatus)if(o.getFightStatus()!==td.PveEnum.PVE_FIGHT_STATUS.OVER){this._fightTotalTime+=t*s.getCurSpeed();var e=o.getAllWaveEnemyModel();if(0===e.length){if(!td.PveCopyManager.isHook())return void this.unschedule(this.createEnemy);this._enemyCountIndex=0,td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_HOOK_REPRODUCE_ENERMY_TIME,this._fightTotalTime)}for(var i=null,n=null,a=[],r=0,l=e.length;r<l;r++){var u=e[r],p=u.bornTime,_=u.showTime,g=u.nIndex,f=u.dirTipsPointId,v=u.isEnd;if(td.PveCopyManager.isHook()||(1===g&&this._fightTotalTime+this._enemyBornTipsDiff>=p&&!this._bornPointAlreadyShow[f]&&(this._bornPointAlreadyShow[f]||(this._bornPointAlreadyShow[f]=0),this._bornPointAlreadyShow[f]++,this._showBornAnima(u)),v&&this._fightTotalTime>=p&&this._bornPointAlreadyShow[f]&&(this._bornPointAlreadyShow[f]-=1,0===this._bornPointAlreadyShow[f]&&this._hideBornAnima(u))),this._fightTotalTime>=p){var m=u.enemyId,y=td.TableManager.getTableClass(td.TableEnum.PveEnemyTable).getEnemyCfgDataById(m),E=new h;E.init(y),u.enemyDataModel=E,u.hpTimes=td.PveCopyManager.getHpTimes();var T=E.getSkillType();i=null,T===td.PveEnum.PVE_ENEMY_SKILL_TYPE.NONE&&(i=c.getEnemyInPool(E.getRoleType()),n=d),a.push(r);(i?i.getComponent(n):(i=cc.instantiate(o.getEnemyPrefab())).addComponent(n)).initData(u),i._tag=T*td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio+this._enemyCountIndex,i.setScale(.5),i.active=!0,this.node.addChild(i),o.addAliveEnemyToArray(i),td.GuideManager.isFirstBattle()&&this._fightTotalTime>_&&this.scheduleOnce(this._firstBattleGuideTrigger.bind(this,u),.2),E.getGrade()!==td.PveEnum.PVE_ENERMY_GRADE.BOSS||td.PveCopyManager.isHook()||td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_BOSS_COMMING),this._enemyCountIndex++;break}}for(r=0;r<a.length;r++)e.splice(a[r]-r,1)}else this.unschedule(this.createEnemy)},createLastWaveEnemey:function(){var t=td.PveCopyManager.getLastWavaData().enemys,e=0;for(var i in t){var n=parseInt(i),a=t[i],r=td.GetTableClass(td.TableEnum.PveCreateEnemyTable).getCfgByWaveId(n);if(r)for(var s=a.length-1;s>=0;s--){var l=a[s],u=l.enemyId,p=td.TableManager.getTableClass(td.TableEnum.PveEnemyTable).getEnemyCfgDataById(l.enemyId),_=new h;_.init(p),r.enemyDataModel=_,r.hpTimes=l.hpTimes;var g=_.getSkillType(),f=null,v=null;g===td.PveEnum.PVE_ENEMY_SKILL_TYPE.NONE&&(f=c.getEnemyInPool(u),v=d);var m=null;(m=f?f.getComponent(v):(f=cc.instantiate(o.getEnemyPrefab())).addComponent(v)).initData(r),m.setCurInfo(l),f._tag=g*td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio+this._enemyCountIndex,f.setScale(.5),f.active=!0,this.node.addChild(f),o.addAliveEnemyToArray(f),this._enemyCountIndex++,e++}}o.addAncientLastWaveEnemyCount(e)},_firstBattleGuideTrigger:function(t){if(td.GuideManager.getGuideData()){var e={id:t.waveId,index:t.nIndex};td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_PVE_FIGHTING_TRIGGER,e)}},createTowerByChoose:function(t){var e=t.tag,i=t.heroDataModel,n=u.getCurBuildFlagVec();if(n[e]){var a=n[e].pos;u.setCurBuildFlagStatus(e,1);var r={posTag:e,heroDataModel:i},o=this.createTower(r);o.setPosition(a),o.y-=10}},createTower:function(t){var e,i=t.heroDataModel,n=i.getFeatures(),a=n>td.PveEnum.PVE_HERO_VOCATION.COUNSELLOR,r=n>=1&&n<=4?1:2;a&&(r=1);var s=r*td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio+t.posTag;e=p;var l=i.getMercenaryDataModel().getId(),c=a?"petTower"+l:"tower"+l;if(cc.isValid(this.node)){var u=this.node.getChildByName(c);if(u)u.active=!0,u.getComponent(e).initData(t);else(u=cc.instantiate(o.getTowerPrefab())).addComponent(e).initData(t),this.node.addChild(u),u._tag=s,u.name=c,this._towerIds[this._towerIds.length]=l,o.addTowerToArray(u);return u}},createPveLoveSkillNode:function(t){},createTowerPlatform:function(t){void 0===t&&(t=0);var e=l.getTowerPoints(),i=td.ActorUnlockType.FORMATION,n=td.UnlockManager;for(var a in this._platformList=[],e){var r=e[a],o=parseInt(a);if(!(t>0&&t!==o)){var s="platForm"+a;if(c=this.node.getChildByName(s))c.active=!0;else{var c=td.GlobalFunction.createPrefabInstance("prefab/Pve/PvePlatform");c._tag=o,c.name=s,c.setPosition(r),this.node.addChild(c,-1)}if(this._platformList.push(c),td.PveCopyManager.isHook())if(!n.isTargetUnlock(i,o)){var u=new cc.Node;c.addChild(u),u.y=40,u.x=-4,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"PVE_qizhi2",u);var d=new cc.Node,h=d.addComponent(cc.Label);h.string="Lv"+n.getTargetUnlockCondition(i,o),h.fontSize=18,8===o&&(h.string=td.Language.pet,h.fontSize=22),d.color=cc.Color.WHITE,d.y=-10,d.x=8,u.addChild(d)}}}},createTowerFlag:function(t){var e=l.getTowerPoints(),i={};for(var n in e){var a=e[n],r=parseInt(n);if(!(t>0&&t!==r)){var s="buildFlag"+n;if(c=this.node.getChildByName(s))c.active=!0;else{var c,d=o.getBuildFlagPrefab();(c=cc.instantiate(d))._tag=r,c.name=s,this.node.addChild(c,999)}c.setPosition(a),c.y-=15,i[n]={pos:a,buildStatus:0}}}u.setCurBuildFlagVec(i)},createProtege:function(){if(!td.PveCopyManager.isHook()&&td.PveCopyManager.getCopyType()!==_.PVEFightType.AncientCorridor){var t=o.getProtegeProfab();this._protegeObj=cc.instantiate(t),this.node.addChild(this._protegeObj,900);var e=this._protegeObj.getChildByName("MaliGongZhu").getChildByName("MaliGongZhu");e&&(e.z=900);var i=l.getProtegePos();this._protegeObj.setPosition(i),td.PveCopyManager.getCopyType()===_.PVEFightType.EightDiagrams&&a.default.getInstance().isChasingType()&&this.addProtegeCmp(),this._protegeObj.on(cc.Node.EventType.TOUCH_END,this._adminDebug,this)}},createPetTowerByChoose:function(t){var e=t.pos;this.createTower(t).setPosition(e)},addProtegeCmp:function(){if(this._protegeObj){var t=this._protegeObj.addComponent(n.default);t&&t.setData(null)}},_adminDebug:function(){this._adminDebugClick++,this._adminDebugClick>=3&&td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PVE_DEBUG_ADMIN)},createDirTips:function(){if(!td.PveCopyManager.isHook()){var t=gdk.rm.getResByUrl("fightRes/pve/otherAnimation/ZhiLuBiao_effect/ZhiLuBiao_effect",cc.Prefab),e=l.getDirTips();for(var i in e){var n=e[i],a=n.dir,r=n.pos,o=cc.instantiate(t);o.x=r.x,o.y=r.y,o.name="ZhiLuBiao_effect_"+i,o.getChildByName("biaozhi").angle=90*(a-1),this.node.addChild(o)}}},removeDirTips:function(){for(var t=1;t<100;t++){var e=this.node.getChildByName("ZhiLuBiao_effect_"+t);if(!e)break;e.removeFromParent()}},createEnemyEntrance:function(){var t=gdk.rm.getResByUrl("fightRes/pve/otherAnimation/ChuanSongMen_effect/ChuanSongMen_effect",cc.Prefab),e=l.getSpawnPoints();for(var i in e){var n="size"===i?sideEntrancePrefab:"front"===i?t:null;if(n){var a=e[i];for(var r in a){var o=a[r],s=cc.instantiate(n);s.setPosition(o),this.node.addChild(s,-1)}}}},_updateObjectZOrder:function(){if(!o.debugParams[4]&&o.getFightStatus()!==td.PveEnum.PVE_FIGHT_STATUS.ENTER&&o.getFightStatus()!==td.PveEnum.PVE_FIGHT_STATUS.OVER){var t=0,e=o.getTowerArray(),i=o.getEnemyArray(),n=[];e.length>0&&(n=n.concat(e)),i.length>0&&(n=n.concat(i)),n.sort(function(t,e){return e&&t?e.y-t.y:-1});for(var a=n.length;t<a;t++){var r=n[t];r.zIndex=t;var s=r.getComponent("PveFightObject");if(r.getComponent("PveBaseTower")){var l=0;td.PveCopyManager.isHook()||(l=800),s&&s.update3DModelZ(l+t)}else s&&s.update3DModelZ(t)}}},onTouchMoveToConfirmPos:function(t){if(o.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.FIHGT){var e=t.touch.getLocation(),i=td.UIAdaptiveUtil.getDesignSize(),n=cc.winSize,a=td.UIAdaptiveUtil.getMinScale(),r=cc.v2(e.x-(n.width-i.width)/2,e.y-(n.height-i.height)/2);td.GameResolutionPolicy.isDefaultRS()&&(n=td.UIAdaptiveUtil.getWinSize(),r=cc.v2((e.x-(n.width-i.width)/2)/a,(e.y-(n.height-i.height)/2)/a)),cc.log(cc.js.formatStr("\u5f53\u524d\u5750\u6807\u4f4d\u7f6e\u662f(%s,%s)",parseInt(r.x),parseInt(r.y)))}},onClickCallBack:function(t){if(td.EventUtil.dispatchEvent(td.EventNameEnum.ON_HIDE_TIMES_NODE),o.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.FIHGT){var e=s.getSelectedSkill();if(0===e)return;var i=t.touch.getLocation(),n=td.UIAdaptiveUtil.getDesignSize(),a=cc.winSize,r=td.UIAdaptiveUtil.getMinScale(),l=cc.v2(i.x-(a.width-n.width)/2,i.y-(a.height-n.height)/2);td.GameResolutionPolicy.isDefaultRS()&&(a=td.UIAdaptiveUtil.getWinSize(),l=cc.v2((i.x-(a.width-n.width)/2)/r,(i.y-(a.height-n.height)/2)/r)),td.EventUtil.dispatchEvent(td.EventNameEnum.CREATE_UI_SKILL,{skillId:e,pos:l})}},_showBornAnima:function(t){var e=l.getDirTips(),i=t.dirTipsPointId,n=e[i],a=n.pos,r=n.dir,o=this.node.getChildByName("ChuanSongMen_effect_"+i);if(o||(o=c.getEnemyBornAnima())&&this.node.addChild(o,-1),!o){var s=gdk.rm.getResByUrl("fightRes/pve/otherAnimation/ChuanSongMen_effect/ChuanSongMen_effect",cc.Prefab);if(!s)return;o=cc.instantiate(s),this.node.addChild(o,-1)}o.name="ChuanSongMen_effect_"+t.dirTipsPointId,o.position=a;var u=o.getComponent(cc.Animation),d=u.getClips(),h=2===r||4===r?0:1;o.stopAllActions(),u.play(d[h].name)},_hideBornAnima:function(t){var e=t.dirTipsPointId,i=this.node.getChildByName("ChuanSongMen_effect_"+e);i&&i.runAction(cc.sequence(cc.delayTime(3/o.getCurFightSpeedMult()),cc.callFunc(this._putToNodePool.bind(this,i))))},_putToNodePool:function(t){t&&c.putEnemyBornAnima(t)},_clearBornAima:function(){for(var t=this.node.children,e=t.length-1;e>=0;e--){-1!==t[e].name.indexOf("ChuanSongMen_effect_")&&c.putEnemyBornAnima(t[e])}},createBoss:function(){var t=td.PveCopyManager.getBossId(),e=l.getBossPoints();if(t&&0!==t.length&&e&&0!==e.myLen()){var i=this.node.getChildByName("Boss"),n=td.TableManager.getTableClass(td.TableEnum.PveEnemyTable).getEnemyCfgDataById(t),a=new h;a.init(n);var r=e[1];if(r){if(!i){var s=gdk.rm.getResByUrl("prefab/Pve/BossSkillModel",cc.Prefab);i=cc.instantiate(s),this.node.addChild(i,1e3),i.name="Boss",i._tag=3e4}i.getComponent("BossSkillEnemy").initData(a),i.setPosition(r),o.addAliveEnemyToArray(i)}}},_showSpecialDialog:function(e){var i=gdk.gui.layers.messageLayer.getChildByName("StoryDialogView");if(!i){var n=gdk.rm.getResByUrl("prefab/PveCopy/StoryDialogView",cc.Prefab);(i=cc.instantiate(n)).name="StoryDialogView",i.parent=gdk.gui.layers.messageLayer}i.active=!0;var a=t("StoryDialogView"),r=i.getComponent(a);r||(r=i.addComponent(a));var o={};o.configs=e[0],o.isWinStory=!0,o.reportData=e[1],r.setData(o)},_showPetHookSkill:function(){var t=u.getPetBuildModelList();if(t&&!(t.length<=0)){var e=t[td.GlobalFunction.randomInt(0,t.length-1)].getMercenaryDataModel(),i=td.TableManager.getTableClass(td.TableEnum.PveSkillTable).getSkillCfgDataById(e.getPveSkillId()),n=new g;n.init(i);var a=n.getSkillPrefab(),r=c.getSkillInPoolById(n.getId()),o=null;if(r)o=r.getComponent("CommonSkill");else{if(!(r=cc.instantiate(a)))return;o=r.addComponent("CommonSkill")}var l={skillDataModel:n,petSid:e.getSId(),baseAttackPower:e.getBaseAttackPower(),vocation:e.getFeatures(),hurtType:td.PveEnum.getVocationHurtType(e.getFeatures())};o.initData(l);var d=cc.v2(360,td.GlobalFunction.randomInt(440,840));r.setPosition(d),s.getEffectLayer().addChild(r)}}});e.exports=f,cc._RF.pop()},{"../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager","./ProtegeEDCmp":"ProtegeEDCmp",EnemyModel:"EnemyModel",OrdinaryEnemy:"OrdinaryEnemy",PveBuildTowerManager:"PveBuildTowerManager",PveCopyEnum:void 0,PveFightManager:"PveFightManager",PveMapManager:"PveMapManager",PveNodePoolManager:"PveNodePoolManager",PveOrdiraryTower:"PveOrdiraryTower",PveSkillModel:"PveSkillModel",PveUiManager:"PveUiManager",StoryDialogView:void 0}],PveFightManager:[function(t,e,i){"use strict";cc._RF.push(e,"375201Q8rZP4oUvTV75l1ry","PveFightManager");var n,a=l(t("../../../../View/Login/Enum/LoginFsmEventId")),r=l(t("../../../EightDiagrams/Manager/EightDiagramsManager")),o=l(t("../../../Chess/Manager/ChessManager")),s=l(t("./PveDataHelper"));function l(t){return t&&t.__esModule?t:{default:t}}t("PveNodePoolManager");var c=t("PveLoveModel"),u=t("PveCopyEnum"),d=t("EnemyModel"),h=((n={_aliveEnemyArray:null,_curHeroesArray:null,_curTowerRoleIdArray:null,_curPveLoveSkillArray:null,_curLoveSkillCount:null,_curLightningNodeArray:null,_enemyPrefab:null,_towerPrefab:null,_bulletPrefab:null,_buildFlagPrefab:null,_protegeProfab:null,_commonAtlas:null,_fightStatus:null,_curGateEnermyModelArray:null,_curHeroModelArray:null,_curFightSpeedMult:null,_curHeartCount:null,_fightResultStar:null,_curAngerPowerCount:null,_totalAngerPower:null,_curFightResult:null,_curGuideSwitchStatus:null,_reproduceEnemyTime:null,_hookEnermyCreateSync:null,_totalEnemyNum:null,_deadEnemyNum:null,_enermyIdCountMap:null,_enermyIdMaxWaveMap:null,_isFightPause:null,debugParams:null,init:function(){if(this._aliveEnemyArray=[],this._curHeroesArray=[],this._curTowerRoleIdArray=[],this._curPveLoveSkillArray={},this._curLightningNodeArray=[],this._curLoveSkillCount=0,this._curGateEnermyModelArray=[],this._curHeroModelArray=[],this._fightStatus=td.PveEnum.PVE_FIGHT_STATUS.ENTER,this._curFightSpeedMult=this.getLocalSpeedMult(),this._curHeartCount=td.PveCopyManager.getCurHeartCount(),this._fightResultStar=0,this._curAngerPowerCount=td.GetConfig("PVE_INIT_ANGER_POWER"),td.PveCopyManager.getCopyType()===u.PVEFightType.AncientCorridor){var t=td.PveCopyManager.getLastWavaData();this._curAngerPowerCount=t.anger||this._curAngerPowerCount}td.PveFightManager=this,this._totalAngerPower=td.GetConfig("PVE_MAX_ANGER_POWER"),this._curFightResult=null,td.PveCopyManager.getCopyType()===u.PVEFightType.EightDiagrams&&(this._totalAngerPower=r.default.getInstance().getMaxAnger()||this._totalAngerPower,this._curHeartCount=td.GetConfig("ED_PROTEGE_LIFE")||this._curHeartCount),this._curGuideSwitchStatus=!1,this._reproduceEnemyTime=0,this._hookEnermyCreateSync=td.GetConfig("HOOK_UP_ENERMY_CREATER_WAVES"),this._curGateEnermyModelArray=null,this._totalEnemyNum=0,this._deadEnemyNum=0,this._enermyIdCountMap={},this._enermyIdMaxWaveMap={},this.debugParams={},this._onResume(),this.getCommonRes(),this.parseFightData(),this._addEventListener()},_addEventListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.ON_CHANGE_FIGHT_SPEED,this.onChangeSpeed,this),td.EventUtil.registerEvent(td.EventNameEnum.DESTROY_TOWER,this.onRemoveTower,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_FIGHT_OVER,this.onFightOver,this),td.EventUtil.registerEvent(td.EventNameEnum.REMOVE_PVE_LOVE_SKILL,this.removeLoveSkillModelByTag,this),td.EventUtil.registerEvent(td.EventNameEnum.REMOVE_LOVE_SKILL_CHECK_NODE,this.removeLoveLightningNode,this),td.EventUtil.registerEvent(td.EventNameEnum.CHANGE_CUR_SKILL_POWER_COUNT,this.onChangeAngerPowerCount,this),td.EventUtil.registerEvent(td.EventNameEnum.RECEIVE_PVE_FIHGT_REAWRD,this.onReceiveFightReward,this),td.EventUtil.registerEvent(td.EventNameEnum.GUIDE_PAUSE_PVE_FIGHT,this.gauseGuideFight,this),td.EventUtil.registerEvent(td.EventNameEnum.GUIDE_RESUME_PVE_FIGHT,this.resumeGuideFight,this),td.EventUtil.registerEvent(td.EventNameEnum.GUIDE_SHOW_PVE_FIGHT_RESULT,this.showGuideFightResultView,this),td.EventUtil.registerEvent(td.EventNameEnum.GUIDE_SET_BUILD_TOWER_SWITCH,this.setBuildTowerSwitchStatus,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_HOOK_REPRODUCE_ENERMY_TIME,this._pveReproduceEnermyTime,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_ADMIN_SET_HERO_ATTACK,this._onSetHeroAttack,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_FULL_ANGER_POWER,this.fullCurAngerPowerCount,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE,this._onPause,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME,this._onResume,this)},_removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},onDestroy:function(){this._aliveEnemyArray=null,this._curHeroesArray=null,this._curPveLoveSkillArray=null,this._curTowerRoleIdArray=null,this._curLightningNodeArray=null,this._curGateEnermyModelArray=null,this._curHeroModelArray=null,this._enemyPrefab=null,this._towerPrefab=null,this._buildFlagPrefab=null,this._commonAtlas=null,this._curHeartCount=null,this._fightResultStar=null,this._curAngerPowerCount=null,this.debugParams={},this._removeListeners()},_onSetHeroAttack:function(t){for(var e=0,i=this._curHeroesArray.length;e<i;e++){var n=this._curHeroesArray[e],a=Math.floor(n._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio);n.getComponent(td.PveEnum.PVE_HERO_SCRIPT[a]).getDataModel().setAttackPower(t)}},gauseGuideFight:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE,!0)},resumeGuideFight:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME,!1)},setBuildTowerSwitchStatus:function(t){if(t)this._curGuideSwitchStatus=t;else{var e=this;setTimeout(function(){e._curGuideSwitchStatus=t},.2)}},getBuildTowerSwitchStatus:function(){return this._curGuideSwitchStatus},showGuideFightResultView:function(){var t=this._curFightResult;0!==t.result&&(t.rewardList=[],t.isGuide=!0),this.showFightResultView(t,!1)},onChangeSpeed:function(t){t>=1&&(this._curFightSpeedMult=t)},getCurFightSpeedMult:function(){return this._curFightSpeedMult},onFightOver:function(){if(this.getFightStatus()!==td.PveEnum.PVE_FIGHT_STATUS.OVER&&this.getFightStatus()!==td.PveEnum.PVE_FIGHT_STATUS.READY){var t=td.PveCopyManager.getCopyType();if(this.getAllWaveEnemyModel().length>0&&t===u.PVEFightType.AncientCorridor){var e=new td.BroadcastContent(518);return e.setOkCallFunc(function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_HomePage)}),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e),console.error("AncientCorridor onFightOver invalid  *******"),void this.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.OVER)}var i=null,n=0;if(t===u.PVEFightType.AncientCorridor&&(n=(i=this.getAncientLeftWaveData()).count),this.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.OVER),td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_FIGHT_OVER),this._aliveEnemyArray=[],td.GuideManager.isFirstBattle())td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_CUSTOM_COND_CHANGE,td.GuideCustomCond.FightEnd);else{var a=this.calcFightResult();this._curFightResult=a;var s=[this._totalEnemyNum,this.getTotalAttrAttack(),td.PveCopyManager.getMaxSingleHurtRoleType(),td.PveCopyManager.getMaxSingleHurt(),this.getOnLineHeroRoleTypes(),td.PveCopyManager.isMaxSingleHurtCritical()?1:0,this.getPetTotalPower(),td.PveCopyManager.getMaxHurtPetId(),td.PveCopyManager.getMaxPetHurt()];if(t===u.PVEFightType.GeneralCopy){if(0===a.result)return void this.showFightResultView(a,!0);var l={gateId:td.PveCopyManager.getCopyId(),stars:a.stars,check:s};if(td.PveCopyManager.getCopyId()===td.Account.getUserData().getCurStoryId()){var c=td.PveCopyManager.getGateData();if(c){var d=c.winStoryId;if(d){var h=td.LocalStorageUtil.read(td.LocalDataKey.MainStoryId);if(!h||h<d){var p=td.GetTableClass(td.TableEnum.MainStoryTable).getDataById(d);if(p)return td.LocalStorageUtil.write(td.LocalDataKey.MainStoryId,d),void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PVE_FIGHT_WIN_STORYL,[p,l])}}}}td.DataReporter.onEvent("GeneralCopy",l),td.EventUtil.dispatchEvent(td.EventNameEnum.GENERAL_COPY_RESULT_REPORT,l)}else if(t===u.PVEFightType.MagicRecordCopy){if(0===a.result)return void this.showFightResultView(a,!0);l={id:td.MagicRecordManager.getChallengeId(),stars:a.stars};td.DataReporter.onEvent("MagicRecordCopy",l),td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_MAGIC_RECORD_CHALLENGE,l)}else if(t===u.PVEFightType.DemonTreasureCopy){l={id:td.DemonTreasureCopyManager.getCurCopyId(),leftHP:Math.floor(td.PveCopyManager.getBossLeftHp()),killTime:td.PveCopyManager.getKillTime(),check:s};td.DataReporter.onEvent("DemonTreasureCopy",l),this._curFightResult.stars=0,this._curFightResult.result=1,td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_DEMON_TREASURE_COPY_CHALLENGE,l)}else if(t===u.PVEFightType.MaterialsCopy){if(0===a.result)return void this.showFightResultView(a,!0);l={id:td.PveCopyManager.getCopyId(),type:td.PveCopyManager.getGateData(),stars:a.stars};td.DataReporter.onEvent("MaterialsCopy",l),td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_COPY_CHALLENGE,l)}else if(t===u.PVEFightType.AncientCorridor){if(n>td.GetConfig("AncientMaxLeftEnemy"))return a.result=0,void this.showFightResultView(a,!0);l={id:td.PveCopyManager.getCopyId(),data:i,check:s};this._curFightResult.stars=0,this._curFightResult.result=1,td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_ANCIENT_CHALLENGE,l)}else if(t===u.PVEFightType.Dipper){if(0===a.result)return void this.showFightResultView(a,!0);l={id:td.PveCopyManager.getCopyId(),score:this._curHeartCount,check:s};this._curFightResult.stars=0,this._curFightResult.score=this._curHeartCount,td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_DIPPER_CHALLENGE,l)}else if(t===u.PVEFightType.EightDiagrams){if(0===a.result){l={id:r.default.getInstance().getCurStoryId(),isWin:!1,check:s};return td.EventUtil.dispatchEvent(td.EventNameEnum.ED_REQUEST_FIGHT_SYNC,l),void this.showFightResultView(a,!0)}var _={id:r.default.getInstance().getCurStoryId(),isWin:!0,check:s};this._curFightResult.stars=3,td.EventUtil.dispatchEvent(td.EventNameEnum.ED_REQUEST_FIGHT_SYNC,_)}else if(t===u.PVEFightType.CHESS){var g=s.slice(0,6);g.splice(1,1);var f={id:o.default.getInstance().getCurFloorStoryId(),hp:this._curHeartCount,check:g};this._curFightResult.stars=0,td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_CHESS_BATTLE,f)}}}},onReceiveFightReward:function(t){for(var e=[],i=t.length-1;i>=0;i--){var n=td.GlobalFunction.getGoodsData(t[i].type,t[i].id,t[i].count);n&&(e[e.length]=n)}this._curFightResult=this._curFightResult||{},this._curFightResult.rewardList=e,this._curFightResult.isGuide=!1,this.showFightResultView(this._curFightResult,!0)},showFightResultView:function(t,e){var i={data:t,isDelay:!1};e?setTimeout(function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PVE_FIGHT_RESULT_VIEW,i)},1e3):td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PVE_FIGHT_RESULT_VIEW,i)},onRemoveTower:function(t){for(var e=0,i=this._curHeroesArray.length;e<i;e++){var n=this._curHeroesArray[e];if(n._tag===t){var a=Math.floor(n._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),r=n.getComponent(td.PveEnum.PVE_HERO_SCRIPT[a]).getDataModel().getId();n.removeFromParent(),n.destroy(),this._curHeroesArray.splice(e,1);for(var o=0,s=this._curTowerRoleIdArray.length;o<s;o++)if(r===this._curTowerRoleIdArray[o]){this._curTowerRoleIdArray.splice(o,1);break}break}}},setCurHeartCount:function(t){t<0?cc.log("the fight is over!"):(t<10&&td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_FIGHT_NOTICE,t),this._curHeartCount=t)},getCurHeartCount:function(){return this._curHeartCount},calcFightResult:function(){var t={};return t.result=this._curHeartCount>0?1:0,10===this._curHeartCount?t.stars=3:this._curHeartCount>=7?t.stars=2:this._curHeartCount>0?t.stars=1:t.stars=0,t},resetFight:function(){if(this.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.READY),this.resetAliveEnemyArray(),this.resetHeroesArray(),this.resetLoveSkillNodeArray(),this.parseFightData(),this._onResume(),this._curHeartCount=td.PveCopyManager.getCurHeartCount(),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME),this._curAngerPowerCount=td.GetConfig("PVE_INIT_ANGER_POWER"),td.PveCopyManager.getCopyType()===u.PVEFightType.AncientCorridor){var t=td.PveCopyManager.getLastWavaData();this._curAngerPowerCount=t.anger||this._curAngerPowerCount}this._totalAngerPower=td.GetConfig("PVE_MAX_ANGER_POWER"),td.PveCopyManager.getCopyType()===u.PVEFightType.EightDiagrams&&(this._totalAngerPower=r.default.getInstance().getMaxAnger()||this._totalAngerPower,this._curHeartCount=td.GetConfig("ED_PROTEGE_LIFE")||this._curHeartCount),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_SKILL_POWER_PROGRESS),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_ENEMY_NUM)},resetAliveEnemyArray:function(){for(var t=0,e=this._aliveEnemyArray.length;t<e;t++){var i=this._aliveEnemyArray[t],n=Math.floor(i._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),a=i.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[n]);a.setEnemyStatus(td.PveEnum.PVE_ENEMY_STATUS.Die),a.putToNodePool(),i.removeFromParent()}this._aliveEnemyArray=[]},resetHeroesArray:function(){for(var t=0,e=this._curHeroesArray.length;t<e;t++){var i=this._curHeroesArray[t];i.removeFromParent(),i.destroy()}this._curHeroesArray=[]},getTotalAttrAttack:function(){for(var t=0,e=this._curHeroesArray.length-1;e>=0;e--){var i=this._curHeroesArray[e].getComponent("PveBaseTower");if(!i.isPetTower())t+=i.getBaseAttackPower()}return t},getPetTotalPower:function(){for(var t=0,e=s.default.getBattlePetModels(),i=0;i<e.length;i++){t+=e[i].getBaseAttackPower()}return t},getOnLineHeroRoleTypes:function(){for(var t=[],e=this._curHeroesArray.length-1;e>=0;e--){var i=this._curHeroesArray[e].getComponent("PveBaseTower");if(!i.isPetTower()){var n=i.getHeroModel().getMercenaryDataModel();t.push(n.getId())}}return t},getOnLineHeroSIds:function(){for(var t=[],e=this._curHeroesArray.length-1;e>=0;e--){var i=this._curHeroesArray[e].getComponent("PveBaseTower");if(!i.isPetTower()){var n=i.getHeroModel();t.push(n.getSid())}}return t},resetLoveSkillNodeArray:function(){this._curTowerRoleIdArray=[],this.removeAllLoveSkill(),this.removeAllLoveLightningNode()}}).getCurFightSpeedMult=function(){return td.PveCopyManager.isHook()?1:this._curFightSpeedMult},n.onChangeAngerPowerCount=function(t){this._fightStatus===td.PveEnum.PVE_FIGHT_STATUS.FIHGT&&(this._curAngerPowerCount+=t,this._curAngerPowerCount=this._curAngerPowerCount<0?0:this._curAngerPowerCount,this._curAngerPowerCount=this._curAngerPowerCount>this._totalAngerPower?this._totalAngerPower:this._curAngerPowerCount,td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_SKILL_POWER_PROGRESS))},n.getCurAngerPowerCount=function(){return this._curAngerPowerCount},n.getTotalAngerPower=function(){return this._totalAngerPower},n.fullCurAngerPowerCount=function(){this._curAngerPowerCount=this._totalAngerPower,td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_SKILL_POWER_PROGRESS)},n._onPause=function(){this._isFightPause=!0},n._onResume=function(){this._isFightPause=!1},n.isFightPause=function(){return this._isFightPause},n.setFightStatus=function(t){this._fightStatus=t,td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_UI_LAYER_SHOW,t)},n.getFightStatus=function(){return this._fightStatus},n.addAliveEnemyToArray=function(t){t&&this._aliveEnemyArray.push(t)},n.removeDeadEnemyFromArray=function(t){if(t&&this._aliveEnemyArray&&0!==this._aliveEnemyArray.length){for(var e=0,i=this._aliveEnemyArray.length;e<i;e++){var n=this._aliveEnemyArray[e];if(n&&t===n._tag){this._aliveEnemyArray.splice(e,1);var r=n.getComponent("BaseEnemy").getId();this._deadEnemyNum++,td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_ENEMY_NUM),this._enermyIdCountMap[r]&&this._enermyIdCountMap[r]>0&&(this._enermyIdCountMap[r]-=1);break}}0===this._aliveEnemyArray.length&&0===this.getLeftEnemyNum()&&this._curHeartCount>0&&(td.PveCopyManager.isHook()?(td.PveCopyManager.initHookInfo(),this.parasHookWaveEnemyModel()):td.GuideManager.isFirstBattle()?gdk.fsm.Fsm.broadcastEvent(a.default.SHOW_CREATE_ROLE_WINDOW):this.onFightOver())}},n.getLeftEnemyNum=function(){return this._totalEnemyNum-this._deadEnemyNum},n.getLeftEnemyNumById=function(t){return this._enermyIdCountMap[t]},n.getEnmeyIdMaxWaveMap=function(){return this._enermyIdMaxWaveMap},n.getEnemyArray=function(){return this._aliveEnemyArray||[]},n.getAliveEnemyCount=function(){return this.getEnemyArray().length},n.addTowerToArray=function(t){if(t){this._curHeroesArray.push(t);for(var e=Math.floor(t._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),i=t.getComponent(td.PveEnum.PVE_HERO_SCRIPT[e]).getDataModel().getId(),n=!1,a=0,r=this._curTowerRoleIdArray.length;a<r;a++){if(this._curTowerRoleIdArray[a]===i){n=!0;break}}n||this._curTowerRoleIdArray.push(i)}this._curTowerRoleIdArray.length>0&&this.checkPveLoveSkillByRoleIds(this._curTowerRoleIdArray)},n.getTowerArray=function(){return this._curHeroesArray||[]},n.getTowerArrayWithoutPet=function(){for(var t=this.getTowerArray(),e=[],i=0;i<t.length;i++){var n=t[i],a=Math.floor(n._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio);n.getComponent(td.PveEnum.PVE_HERO_SCRIPT[a]).isPetTower()||e.push(n)}return e},n.addSkillLightningNodeToList=function(t){t&&this._curLightningNodeArray.push(t)},n.getCurLoveSkillCount=function(){return this._curLoveSkillCount},n.getLoveLightningNodeArray=function(){return this._curLightningNodeArray||[]},n.removeLoveLightningNode=function(t){for(var e=t.name,i=t.tag,n=0,a=this._curLightningNodeArray.length;n<a;n++){var r=this._curLightningNodeArray[n];if(r.name===e&&i===r._tag){this._curLightningNodeArray.splice(n,1);break}}},n.removeAllLoveLightningNode=function(){for(var t=0,e=this._curLightningNodeArray.length;t<e;t++){var i=this._curLightningNodeArray[t];i.removeFromParent(),i.destroy()}this._curLightningNodeArray=[]},n.addLoveSkillToArray=function(t,e){e&&(this._curPveLoveSkillArray[t]=e,this._curLoveSkillCount++)},n.removeLoveSkillModelByTag=function(t){var e=t.tag;t.roleId;for(var i in this._curPveLoveSkillArray){var n=this._curPveLoveSkillArray[i];n&&e===n._tag&&(delete this._curPveLoveSkillArray[i],this._curLoveSkillCount--)}},n.removeAllLoveSkill=function(){for(var t in this._curPveLoveSkillArray){var e=this._curPveLoveSkillArray[t];e.removeFromParent(),e.destroy()}this._curPveLoveSkillArray={},this._curLoveSkillCount=0},n.checkPveLoveSkillByRoleIds=function(t){var e=td.TableManager.getTableClass(td.TableEnum.PveLoveConfigTable).getPVELoveConfigByRoleTypeList(t),i=e.length;if(i>0)for(var n=0;n<i;n++){var a=e[n],r=a.id;if(!this._curPveLoveSkillArray[r]){var o=new c;o.init(a);for(var s=a.loveList,l=[],u=0,d=s.length;u<d;u++)for(var h=s[u],p=0,_=this._curHeroesArray.length;p<_;p++){var g=this._curHeroesArray[p],f=Math.floor(g._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio);if(g.getComponent(td.PveEnum.PVE_HERO_SCRIPT[f]).getDataModel().getId()===h){l.push(g);break}}var v={loveDataModel:o,towers:l};td.EventUtil.dispatchEvent(td.EventNameEnum.CREATE_PVE_LOVE_SKILL,v)}}},n.getCommonRes=function(){this._bulletPrefab=gdk.rm.getResByUrl("prefab/Pve/BulletModel",cc.Prefab),this._enemyPrefab=gdk.rm.getResByUrl("prefab/Pve/EnemyModel",cc.Prefab),this._towerPrefab=gdk.rm.getResByUrl("prefab/Pve/HeroModel",cc.Prefab),this._buildFlagPrefab=gdk.rm.getResByUrl("prefab/Pve/BuildTowerFlag",cc.Prefab),this._protegeProfab=gdk.rm.getResByUrl("prefab/Pve/ProtegeModel",cc.Prefab)},n.getCommonAtlas=function(){return this._commonAtlas},n.getBulletPrefab=function(){return this._bulletPrefab},n.getEnemyPrefab=function(){return this._enemyPrefab},n.getTowerPrefab=function(){return this._towerPrefab},n.getBuildFlagPrefab=function(){return this._buildFlagPrefab},n.getProtegeProfab=function(){return this._protegeProfab},n.parseFightData=function(){td.PveCopyManager.isHook()?this.parasHookWaveEnemyModel():this.parseAllWaveEnemyModel()},n._pveReproduceEnermyTime=function(t){this._reproduceEnemyTime=t},n._createHookEnermyCfg=function(){var t=td.TableManager.getTableClass(td.TableEnum.PveCreateEnemyTable).getCurGateCfg();this._createEnermyCfg=t.slice(0)},n.parasHookWaveEnemyModel=function(){this._curGateEnermyModelArray=[],this._createHookEnermyCfg();for(var t=0;t<this._createEnermyCfg.length;t++){var e=this._createEnermyCfg[t],i=e.number,n=e.interval||0,a=e.showTime+(this._reproduceEnemyTime||0),r=e.waveId,o=null;if(this._totalEnemyNum+=i,i>0)for(var s=0;s<i;s++)o={bornTime:a+s*n,enemyId:e.enemyId,roadId:e.roadId,dirTipsPointId:e.dirTipsPointId,showTime:a,waveId:r,nTotalNum:i,nIndex:s+1},this._curGateEnermyModelArray.push(o)}},n.parseAllWaveEnemyModel=function(){this._curGateEnermyModelArray=[],this._enermyIdCountMap={},this._enermyIdMaxWaveMap={},this._totalEnemyNum=0,this._deadEnemyNum=0;for(var t={},e=td.TableManager.getTableClass(td.TableEnum.PveCreateEnemyTable).getCurGateCfg(),i=0,n=e.length;i<n;i++){var a=e[i],r=a.number,o=a.interval||0,s=a.showTime,l=a.waveId,c=a.enemyId,u=null;this._totalEnemyNum+=r,this._enermyIdCountMap[c]?this._enermyIdCountMap[c]+=r:this._enermyIdCountMap[c]=r;var h=td.TableManager.getTableClass(td.TableEnum.PveEnemyTable).getEnemyCfgDataById(c);t[c]||(t[c]=h,cc.log("\u602a\u7269id: "+c),cc.log("\u602a\u7269\u8840\u91cf: "+h.hp),cc.log("\u8840\u91cf\u500d\u7387: "+td.PveCopyManager.getHpTimes()/100+"%"),cc.log("\u4e58\u7b97\u8840\u91cf\u500d\u7387: "+h.hp*td.PveCopyManager.getHpTimes()/100));var p=new d;p.init(h);var _=p.getRoleType();if(this._enermyIdMaxWaveMap[_]?this._enermyIdMaxWaveMap[_].number<r&&(this._enermyIdMaxWaveMap[_]=a):this._enermyIdMaxWaveMap[_]=a,r>0)for(var g=0;g<r;g++)u={bornTime:s+g*o,enemyId:a.enemyId,roadId:a.roadId,dirTipsPointId:a.dirTipsPointId,showTime:s,waveId:l,nTotalNum:r,nIndex:g+1,isEnd:g===r-1},this._curGateEnermyModelArray.push(u)}this._curGateEnermyModelArray.sort(function(t,e){return t.bornTime-e.bornTime})},n.addAncientLastWaveEnemyCount=function(t){this._totalEnemyNum+=t},n.getAllWaveEnemyModel=function(){return this._curGateEnermyModelArray||[]},n.setPanelJumpDestination=function(){if(td.GuideManager.isFirstBattle())td.PanelJumpManager.setDestination(td.PanelEnum.Panel_PVE_FIGHT_HOOK);else{var t=null,e=null;switch(td.PveCopyManager.getCopyType()){case u.PVEFightType.GeneralCopy:e={chapterId:td.PveCopyManager.getChapterId(),difficult:td.PveCopyManager.getCopyDifficult()},t=td.PanelEnum.Window_PveGeneralChapter}td.PanelJumpManager.setDestination(t,e)}},n.getLocalSpeedMult=function(){var t=td.PveCopyManager,e=t.getCopyType(),i=(t.getChapterId(),"pveFightSpeed"+e),n=td.LocalStorageUtil.read(i),a=n&&parseInt(n)>0?parseInt(n):1,r=1;return 2===a?r=1.65:(3===a||a>3)&&(r=2.2),r},n.getEnemyArrayExcept=function(t){for(var e=[],i=0;i<this._aliveEnemyArray.length;i++)this._aliveEnemyArray[i]!==t&&(e[e.length]=this._aliveEnemyArray[i]);return e},n.getAncientLeftWaveData=function(){for(var t={enemys:{},anger:this._curAngerPowerCount,count:0},e=t.enemys,i=0,n=0;n<this._aliveEnemyArray.length;n++){var a=this._aliveEnemyArray[n].getComponent("BaseEnemy");if(!a.bDeath()){var r=a.getWaveId();e[r]||(e[r]=[]),e[r].push(a.getCurInfo()),i++}}return t.count=i,td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_LEFT_ENEMEY_COUNT,i),t},n.canBuildMoreTower=function(){var t=1;if(td.PveCopyManager.getCopyType()===u.PVEFightType.CHESS){var e=o.default.getInstance().getCurBattleHeroNum(),i=h.getTowerArrayWithoutPet().length;if(i>=e)return 0;t=e-i}return t},n);e.exports=h,cc._RF.pop()},{"../../../../View/Login/Enum/LoginFsmEventId":void 0,"../../../Chess/Manager/ChessManager":"ChessManager","../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager","./PveDataHelper":"PveDataHelper",EnemyModel:"EnemyModel",PveCopyEnum:void 0,PveLoveModel:"PveLoveModel",PveNodePoolManager:"PveNodePoolManager"}],PveFightObject:[function(t,e,i){"use strict";cc._RF.push(e,"5bf2139FDNAXbPWNrcMqIJi","PveFightObject");var n=t("CommonEnum"),a=cc.Class({extends:cc.Component,properties:{_curSpeedMult:1,_bFightPause:!1,_dataModel:null,_bRefreshScale:null},onLoad:function(){this._addListeners()},onDestroy:function(){this._removeListeners()},_addListeners:function(){td.EventUtil.registerEvent(td.EventNameEnum.ON_CHANGE_FIGHT_SPEED,this.onChangeSpeedMult,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE,this.onPause,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME,this.onResume,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_RESTART_FIGHT,this.onRestartFight,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_FIGHT_OVER,this.onFightOver,this)},_removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},update:function(t){if(this._bRefreshScale){var e=this.node.getPosition(),i=(n.ScreenSize.height-e.y)/n.ScreenSize.height;this.node.setScale(.1*i+.8)}},getCurPos:function(){return this.node.getPosition()},getTag:function(){return this.node._tag},onChangeSpeedMult:function(t){this._curSpeedMult=t>0?t:this._curSpeedMult},onPause:function(){this._bFightPause=!0,this.pause()},onResume:function(){this._bFightPause=!1,this.resume()},onRestartFight:function(){},onFightOver:function(){},getDataModel:function(){return this._dataModel},pause:function(){},resume:function(){},initData:function(t){},_getDir:function(t,e){},_turnDir:function(t){},putToNodePool:function(){},onCollisionEnter:function(t){},onCollisionStay:function(t){},onCollisionExit:function(){},update3DModelZ:function(){}});e.exports=a,cc._RF.pop()},{CommonEnum:void 0}],PveFightPanel:[function(t,e,i){"use strict";var n;cc._RF.push(e,"6e10arWHFNFlb1sNVFYQOux","PveFightPanel");var a=t("PveMapManager"),r=t("PveFightManager"),o=t("PveUiManager"),s=t("PveNodePoolManager"),l=t("PveBuildTowerManager"),c=t("CommonEnum"),u=t("PanelBase"),d=t("PveLoader"),h=cc.Class(((n={extends:u,properties:{_mapLayer:null,_fightLayer:null,_effectLayer:null,_uiLayer:null,_popLayer:null},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PveCopyManager.isHook()?td.PanelEnum.Panel_PVE_FIGHT_HOOK:td.PanelEnum.Panel_PVE_FIGHT,td.PveCopyManager.isHook()?this._panelEnum=td.PanelEnum.Panel_PVE_FIGHT_HOOK:this._panelEnum=td.PanelEnum.Panel_PVE_FIGHT,this.showUserProperty=td.PveCopyManager.isHook()},onLoad:function(){this._super(),cc.director.getCollisionManager().enabled=!0},onEnable:function(){this._super(),td.PveCopyManager.isHook()?(td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_MAIN_LAYER_BOTTOM_LAYER),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_USER_INFO_LAYER),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_MAIN_LAYER_MESSAGE_LAYER),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_MAIN_LAYER_CENTER_LAYER)):(td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_MAIN_LAYER_BOTTOM_LAYER),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_USER_INFO_LAYER),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_MAIN_LAYER_MESSAGE_LAYER)),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_USER_PROPERTY_LAYER),gdk.Timer.once(500,this,this.playBgMusic),gdk.Timer.once(1e3,this,this.preLoadRes),gdk.Timer.once(2e3,this,this.preLoadRes),td.PveCopyManager.isHook()?this._loadPveHookRes():this.initUI()},preLoadRes:function(){var t=["PveEnemyDelay","PveHeroDelay","PveSkillDelay","PveBulletDelay"];td.GuideManager.isFirstBattle()&&(t.push("fontDelay"),t.push("atlasDelay"),t.push("uiAnimaDelay")),gdk.rm.addLoadResInBackground(t,"Panel_PVE_FIGHT")},onDisable:function(){this.unschedule(this._loadPveHookRes,this),gdk.Timer.clearAll(this)}}).preLoadRes=function(){var t=["PveEnemyDelay","PveHeroDelay","PveSkillDelay","PveBulletDelay"];td.GuideManager.isFirstBattle()&&(t.push("fontDelay"),t.push("atlasDelay"),t.push("uiAnimaDelay")),gdk.rm.addLoadResInBackground(t,"Panel_PVE_FIGHT")},n.playBgMusic=function(){td.PveCopyManager.isHook()||td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_MUSIC,td.SoundEnum.Pve)},n._loadPveHookRes=function(){var t=this,e=d.getModules(!1,!0,td.PveCopyManager.getBossId());gdk.rm.loadResByModule("Panel_PVE_FIGHT_HOOK",e,null,null,function(){var e=td.PanelManager.getInstance().getCurShowPanel();e&&e.getComponent("PanelBase")&&e.getComponent("PanelBase").getPanelEnum()===td.PanelEnum.Panel_PVE_FIGHT_HOOK&&t.initUI()}),td.PveCopyManager.isFirstEnterHook=!1},n.initUI=function(){var t=this;a.init(),o.init(),r.init(),l.init();var e=this.node.getChildByName("shakeLayers");(o.shakeLayers=e,e.active=!0,this._mapLayer)&&this._mapLayer.getComponent("PveMapLayer").initInfo();this._mapLayer=e.getChildByName("PveMapLayer"),o.mapLayer=this._mapLayer,this._mapLayer._tag=c.PVE_LAYER_TAG.MAP_LAYER_TAG,this._fightLayer=e.getChildByName("PveFightLayer"),this._fightLayer._tag=c.PVE_LAYER_TAG.FIGHT_LAYER_TAG,o.fightLayer=this._fightLayer;var i=this.node.getChildByName("otherLayers");if(this._effectLayer=i.getChildByName("PveEffectLayer"),this._effectLayer._tag=c.PVE_LAYER_TAG.EFFECT_LAYER_TAG,o.effectLayer=this._effectLayer,this._effectLayer.removeAllChildren(),gdk.Timer.once(100,this,function(){var e=td.GlobalFunction.createPrefabInstance(td.PveCopyManager.getPveMapParticalName());e&&(t._effectLayer.addChild(e),e.name="mapPartical",e.x=t._effectLayer.width/2,e.y=t._effectLayer.height/2)}),!this._uiLayer){var n=gdk.rm.getResByUrl("prefab/Pve/PveUiLayer",cc.Prefab);this._uiLayer=cc.instantiate(n),this._uiLayer._tag=c.PVE_LAYER_TAG.UI_LAYER_TAG,this._uiLayer.setPosition(cc.v2(-360,-640)),i.addChild(this._uiLayer,c.PVE_LAYER_TAG.UI_LAYER_TAG),o.uiLayer=this._uiLayer}if(!this._popLayer&&!td.GuideManager.isFirstBattle()){var s=gdk.rm.getResByUrl("prefab/Pve/PvePopLayer",cc.Prefab);this._popLayer=cc.instantiate(s),this._popLayer._tag=c.PVE_LAYER_TAG.POP_LAYER_TAG,this._popLayer.setPosition(cc.v2(-360,-640)),i.addChild(this._popLayer,c.PVE_LAYER_TAG.POP_LAYER_TAG),o.popLayer=this._popLayer}e=this.node.getChildByName("shakeLayers");td.UIAdaptiveUtil.adaptivePanelMinScale(e);i=this.node.getChildByName("otherLayers");td.UIAdaptiveUtil.adaptivePanelMinScale(i);var u=this.node.getChildByName("imgBg");if(u.active=!0,td.UIAdaptiveUtil.adaptiveWinSize(u),td.GuideManager.isFirstBattle()){var d=td.GlobalFunction.createPrefabInstance("prefab/Guide/GuideTipsLayer");i.addChild(d,c.PVE_LAYER_TAG.POP_LAYER_TAG+1)}td.PveCopyManager.isHook()?r.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.FIHGT):r.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.READY)},n.onDestroy=function(){this._panelEnum!==td.PanelEnum.Panel_PVE_FIGHT_HOOK?(this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_MUSIC,td.SoundEnum.Hook)):s.destroyData(),this._mapLayer=null,this._fightLayer=null,this._effectLayer=null,this._uiLayer=null,this._popLayer=null},n.getLayerByTag=function(t){var e=null;switch(t){case c.PVE_LAYER_TAG.MAP_LAYER_TAG:e=this._mapLayer;break;case c.PVE_LAYER_TAG.FIGHT_LAYER_TAG:e=this._fightLayer;break;case c.PVE_LAYER_TAG.EFFECT_LAYER_TAG:e=this._effectLayer;break;case c.PVE_LAYER_TAG.UI_LAYER_TAG:e=this._uiLayer;break;case c.PVE_LAYER_TAG.POP_LAYER_TAG:e=this._popLayer}return e},n));e.exports=h,cc._RF.pop()},{CommonEnum:void 0,PanelBase:void 0,PveBuildTowerManager:"PveBuildTowerManager",PveFightManager:"PveFightManager",PveLoader:"PveLoader",PveMapManager:"PveMapManager",PveNodePoolManager:"PveNodePoolManager",PveUiManager:"PveUiManager"}],PveFightResultPanel:[function(t,e,i){"use strict";cc._RF.push(e,"3831adAzexGG5nIJNI/wgmC","PveFightResultPanel");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../Chess/Manager/ChessManager")),a=t("../../../Chess/Enum/ChessEnum");var r=t("PveFightFailPanel"),o=t("PveFightSuccessPanel"),s=t("PveCopyEnum"),l=cc.Class({extends:cc.Component,properties:{_curResultData:null},initData:function(t){t?this._curResultData=t:cc.log("don't have fight result data!")},onLoad:function(){var t=this._curResultData.result,e=this.node.getChildByName("successPanel"),i=this.node.getChildByName("failPanel");(td.EventUtil.dispatchEvent(td.EventNameEnum.STOP_MUSIC),1===t||td.PveCopyManager.getCopyType()==s.PVEFightType.CHESS)?(i.active=!1,e.active=!0,e.getComponent(o).initData(this._curResultData),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.Win)):(e.active=!1,i.active=!0,i.getComponent(r).initData(),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.Lose));i.active&&td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MultipleFirstRecharge).setShowView(!1);this._setPanelSelfAdaption()},_setPanelSelfAdaption:function(){var t=this.node.getChildByName("imgMask");td.UIAdaptiveUtil.adaptiveWinSizeWidth(t)},returnToGatePanel:function(){if(this.checkSpecialLogic()){if(td.PveCopyManager.prepareHookData(),cc.log("PveFightResultPanel returnToGatePanel "),td.PveGeneralCopyManager.isFirstEnterNewChapter()&&td.PanelManager.getInstance().removePanelDataByPanelEnum(td.PanelEnum.Window_PveCopyGate),td.GuideManager.isForceGuideFinshed())if(!td.LocalStorageUtil.read("GuideFinishedSucc"))return void td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_HomePage);td.PanelManager.getInstance().getCurShowPanel().closeCallFunc()}},checkSpecialLogic:function(){if(td.PveCopyManager.getCopyType()===s.PVEFightType.CHESS){var t=td.PveFightManager.getCurHeartCount();if(null!=t){if(td.PveCopyManager.prepareHookData(),t<=0)return td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_CHESS_SETTLE),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_ChessMain),!1;if(td.PveCopyManager.getFloor()>=n.default.getInstance().getMaxFloor())return n.default.getInstance().isPowerEnough()?t>=td.GetConfig("CHESS_HP")&&n.default.getInstance().getGrade()<n.default.getInstance().getMaxGrade()-1?(td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_ChessTip,{type:a.TIP_WINDOW_TYPE.SKIP}),!1):(td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_CHESS_GRADE_UP,{id:0}),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_ChessMain),!1):(td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_ChessMain),!1)}return!0}return!0}});e.exports=l,cc._RF.pop()},{"../../../Chess/Enum/ChessEnum":"ChessEnum","../../../Chess/Manager/ChessManager":"ChessManager",PveCopyEnum:void 0,PveFightFailPanel:"PveFightFailPanel",PveFightSuccessPanel:"PveFightSuccessPanel"}],PveFightSuccessPanel:[function(t,e,i){"use strict";cc._RF.push(e,"a3292+8ZSNF36pAXoTpwr0Q","PveFightSuccessPanel");var n=l(t("../../utils/FightResultAniComponent")),a=l(t("../../../../Common/Component/GridLayoutComponent")),r=l(t("../../../AncientCorridor/Manager/AncientCorridorManager")),o=l(t("../../../EightDiagrams/Manager/EightDiagramsManager")),s=l(t("../../../Chess/Manager/ChessManager"));function l(t){return t&&t.__esModule?t:{default:t}}var c=t("PveCopyEnum"),u=t("PveFightManager"),d=t("CommonEnum"),h=cc.Class({extends:cc.Component,properties:{_chapterId:null,_gateId:null,_isFirstBattle:null,hurtNode:cc.Node,imgScore:cc.Node,labHurt:cc.Label,scoreNode:cc.Node,labContinue:cc.Node,btnHurtStatic:cc.Node,btnContinue:cc.Node,btnNextGate:cc.Node,nodeProgress:cc.Node,labProgress:cc.Label,_nextFight:!1,_showResult:null,challengeId:null,_rewardList:null},onLoad:function(){this._setPanelSelfAdaption(),this._showResult=!1},initData:function(t){this._fightResult=t;var e=t.rewardList;this._isFirstBattle=t.isGuide,this._chapterId=td.PveCopyManager.getChapterId(),this._gateId=td.PveCopyManager.getCopyId(),this.hurtNode.active=!1,this.labContinue.active=td.PveCopyManager.getCopyType()!==c.PVEFightType.DemonTreasureCopy,this.btnContinue.active=!1,this.btnHurtStatic.active=!1,this.btnNextGate.active=!1,this.scoreNode.active=!1,this.node.getChildByName("labTip_3").active=!1,this._rewardList=e,this.setRewardPanelInfo(e),this._playAnimation()},onEnable:function(){this._addEventListener()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),gdk.Timer.clearAll(this),!this._nextFight&&td.PanelManager.getInstance().delPanelData(td.PanelEnum.Panel_PVE_FIGHT)},_addEventListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.GENERAL_COPY_READY_RETURN,this._onEnterGateToChallenge,this),td.EventUtil.registerEvent(td.EventNameEnum.RES_MAGIC_RECORD_PREPARE,this._readyToChallenge,this),td.EventUtil.registerEvent(td.EventNameEnum.RES_ANCIENT_PREPARE,this._readyToAncientChallenge,this),td.EventUtil.registerEvent(td.EventNameEnum.ED_ON_GET_FIGHT_PREPARE,this._onGetEdFightPrepare,this)},_onEnterGateToChallenge:function(){if(this._nextGateModel){var t={copyType:c.PVEFightType.GeneralCopy,chapterId:this._nextGateModel.getChapterId(),gateId:this._nextGateModel.getGateId(),gateId2:this._nextGateModel.getGateId2(),hpTimes:this._nextGateModel.getHpTimes()};u.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.OVER),td.PveCopyManager.destroyData(),td.PveCopyManager.initCopyData(t,!0),td.PveCopyManager.gotoPveFight(),this._nextFight=!0,gdk.Timer.once(500,this,this._removePveFightResult),td.PanelManager.getInstance().updatePanelData(td.PanelEnum.Window_PveCopyGate,{chapterId:this._nextGateModel.getChapterId(),gateId:this._nextGateModel.getGateId()})}},_readyToChallenge:function(){var t=td.MagicRecordManager.getMaxPassedId();this.challengeId<=t?td.PanelManager.getInstance().updatePanelData(td.PanelEnum.Panel_MagicRecord,this.challengeId):td.PanelManager.getInstance().updatePanelData(td.PanelEnum.Panel_MagicRecord,null);var e=td.GetTableClass(td.TableEnum.MagicRecordTable).getDataById(this.challengeId),i={copyType:c.PVEFightType.MagicRecordCopy,gateId:e.gateId,mapIndex:e.mapIndex,roadIndex:e.roadIndex,hpTimes:e.hpTimes,name:e.name,recordId:e.recordId};td.PveCopyManager.destroyData(),td.PveCopyManager.initCopyData(i,!0),td.PveCopyManager.gotoPveFight(),this._nextFight=!0,gdk.Timer.once(500,this,this._removePveFightResult)},_readyToAncientChallenge:function(){var t=r.default.getInstance().getChallengeId(),e=r.default.getInstance().getData(),i=td.GetTableClass(td.TableEnum.AncientCorridorTable).getDataById(t),n={copyType:c.PVEFightType.AncientCorridor,gateId:i.gateId,mapIndex:i.mapIndex,roadIndex:i.roadIndex,battleTime:i.battleTime,hpTimes:i.hpTimes,lastWaveData:e,name:"",id:t};td.PveCopyManager.destroyData(),td.PveCopyManager.initCopyData(n,!0),td.PveCopyManager.gotoPveFight(),this._nextFight=!0,gdk.Timer.once(500,this,this._removePveFightResult)},_onGetEdFightPrepare:function(){var t=o.default.getInstance().getCurStoryId(),e=o.default.getInstance().getCurStoryCfg(),i={copyType:c.PVEFightType.EightDiagrams,gateId:e.gateId,mapIndex:e.mapIndex,roadIndex:e.roadIndex,battleTime:e.battleTime,hpTimes:e.hpTimes,name:"",id:t};td.PveCopyManager.destroyData(),td.PveCopyManager.initCopyData(i,!0),td.PveCopyManager.gotoPveFight(),this._nextFight=!0,gdk.Timer.once(500,this,this._removePveFightResult)},_removePveFightResult:function(){this.node.getParent().removeFromParent()},_playAnimation:function(){var t=this._fightResult.stars,e=gdk.rm.getResByUrl(td.resDef.ZhanDouShenLi,cc.Prefab),i=cc.instantiate(e);this.node.addChild(i,1),this._playRotateAni(i);var a=i.getComponent(cc.Animation),r=a.getClips()[t].name;a.play(r);var o=i.addComponent(n.default);o.setShowRewardResultFunc(this._showResultInfo.bind(this)),o.setSoundCallBack(function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.STAR_GAIN)})},_playRotateAni:function(t){var e=t.getChildByName("zhongxindian");e&&(e=e.getChildByName("guang"))&&e.runAction(cc.repeatForever(cc.rotateBy(8,-360)))},_showResultInfo:function(){this.btnHurtStatic.active=!0;var t=this.node.getChildByName("rewardPanel"),e=this.node.getChildByName("goldExpPanel");t.zIndex=99,e.zIndex=99,t.active=!0,e.active=!0,this._showResult=!0,this.btnContinue.active=!0,this.btnNextGate.active=!0;var i=td.GetConfig("NEXT_GATE_LEVEL_LIMIT"),n=td.Account.getUserData().getLevel();switch(td.PveCopyManager.getCopyType()){case c.PVEFightType.MaterialsCopy:this.btnContinue.x=0,this.btnNextGate.active=!1;break;case c.PVEFightType.DemonTreasureCopy:this._initHurtScore(),this.btnContinue.x=0,this.btnNextGate.active=!1;break;case c.PVEFightType.GeneralCopy:(!td.PveGeneralCopyManager.hasNextGate(td.PveCopyManager.getStoryId())||n<=i)&&(this.btnContinue.x=0,this.btnNextGate.active=!1);break;case c.PVEFightType.MagicRecordCopy:var a=td.PveCopyManager.getRecordId(),l=td.GetTableClass(td.TableEnum.MagicRecordTable).getDataById(a);this.challengeId=l.nextRecordId,(0===this.challengeId||n<=i)&&(this.btnContinue.x=0,this.btnNextGate.active=!1);break;case c.PVEFightType.AncientCorridor:r.default.getInstance().hasNextWave()||(this.btnContinue.x=0,this.btnNextGate.active=!1);break;case c.PVEFightType.Dipper:this._initScoreNode(),this.btnContinue.x=0,this.btnNextGate.active=!1;break;case c.PVEFightType.EightDiagrams:o.default.getInstance().isFirstCharpterLv()||o.default.getInstance().isLastStoryPass()?(this.btnContinue.x=0,this.btnNextGate.active=!1):this.btnNextGate.active=!0;break;case c.PVEFightType.CHESS:this.btnContinue.x=0,this.btnNextGate.active=!1;var u=td.PveCopyManager.getFloor();td.PveFightManager.getCurHeartCount()<=0&&(u-=1),u<0&&(u=0);var d=s.default.getInstance().getMaxFloor();this._setProgressNode(u,d),e.active=this._rewardList.length>0}td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_CUSTOM_COND_CHANGE,td.GuideCustomCond.FightEnd)},_initHurtScore:function(){this.hurtNode.active=!0,this.hurtNode.zIndex=99,this.btnHurtStatic.active=!0,this.node.getChildByName("labTip_3").active=!1,this.labHurt.string=td.PveCopyManager.getBossTotalDamage();for(var t=td.PveCopyManager.getBossTotalDamage(),e=td.GetConfig("DUNGEON_SCORE"),i=Math.floor(1e4*t/td.PveCopyManager.getBossHp()),n=0,a=0,r=e.length;a<r;a++){if(e[a][0]>i)break;n=a}td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,"ZD_pj_0"+(n+1),this.imgScore)},_initScoreNode:function(){this.scoreNode.active=!0,this.scoreNode.zIndex=99,this.scoreNode.getChildByName("labScore").getComponent(cc.Label).string=this._fightResult.score||0},_setPanelSelfAdaption:function(){var t=this.node.getChildByName("rewardPanel");td.UIAdaptiveUtil.adaptiveWinSizeWidth(t)},_setProgressNode:function(t,e){this.nodeProgress.active=!0,this.labProgress.string=t+"/"+e},playLightAction:function(){var t=this.node.getChildByName("imgLight"),e=cc.rotateBy(1,30),i=cc.repeatForever(e);t.runAction(i)},starPanel:function(t){for(var e=this.node.getChildByName("starsPanel"),i=1;i<4;i++){var n=e.getChildByName("star_"+i);td.GlobalFunction.graySprite(n,i>t)}},setRewardPanelInfo:function(t){var e=this.node.getChildByName("rewardPanel"),i=this.node.getChildByName("goldExpPanel");if(e.active=!1,i.active=!1,!this._isFirstBattle){e.removeAllChildren();e.getContentSize();for(var n=0,r=0,o=td.PveCopyManager.getCopyKillRewards(),s=o.length-1;s>=0;s--){var l=td.GlobalFunction.createCommonIconWidget(27,o[s]);l.setScale(1),e.addChild(l);var u=new cc.Node;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY2_Common,"GY2_wz_jisha",u),l.addChild(u,100),u.setAnchorPoint(0,1),u.setPosition(-64,64)}for(var d=0,h=t.length;d<h;d++){var p=t[d],_=p.getId();if(_!==td.ItemEnum.Gold||td.PveCopyManager.getCopyType()!==c.PVEFightType.GeneralCopy)if(_!==td.ItemEnum.Exp||td.PveCopyManager.getCopyType()!==c.PVEFightType.GeneralCopy){var g=td.GlobalFunction.createCommonIconWidget(27,p);g.setScale(1),e.addChild(g)}else r=p.getCount();else n=p.getCount()}var f=i.getChildByName("labGold"),v=i.getChildByName("labExp"),m=i.getChildByName("imgExp"),y=i.getChildByName("imgGold");f.getComponent(cc.Label).string=n,v.getComponent(cc.Label).string=r;var E=n>0||r>0;m.active=E,y.active=E,f.active=E,v.active=E;var T=td.PveCopyManager.getCopyType();if(!td.IsCheckServer()&&T===c.PVEFightType.GeneralCopy&&td.IsOpenMoneyPenny){var C=td.GetConfig("SAVE_MAX_DIAMOND"),R=td.Account.getUserData(),S=R.getTotalSaveDiamond(),I=R.getCurrentSaveDiamond();if(C>S+I){var A=gdk.rm.getResByUrl("prefab/Activity/MoneyPennyItem",cc.Prefab);if(A){var b=cc.instantiate(A);b.setName("MoneyPennyItem");var P=td.GetTableClass(td.TableEnum.PveGeneralCopyGateTable).getCfgDataByChapterId(this._chapterId),N=b.getComponent("MoneyPennyItem"),M=td.UnlockManager.isTargetUnlock(td.ActorUnlockType.SAVE_DIAMOND,0);N.mask.active=!M,N.redPoint.active=!M,N.img.active=!0,P?N.setCount(I):N.setCount(20),b.setPosition(cc.v2(0,0)),b.setScale(1),e.addChild(b)}}}e.getComponent(a.default).updateLayout()}},onHurtStatic:function(){var t=gdk.rm.getResByUrl("prefab/Pve/PveHurtStaticsLayer"),e=cc.instantiate(t);this.node.addChild(e,9999,"9999")},onContinue:function(){this._showResult&&(td.PveCopyManager.getCopyType()!==c.PVEFightType.DemonTreasureCopy&&(td.PveCopyManager.prepareHookData(),td.PanelManager.getInstance().getCurShowPanel().closeCallFunc()))},onNextGate:function(){if(cc.log("PveFightSuccessPanel PveFightResultPanel onNextGate "),td.GlobalFunction.checkCanClicked())switch(td.PveCopyManager.getCopyType()){case c.PVEFightType.GeneralCopy:this.handleNextGeneralCopy();break;case c.PVEFightType.MagicRecordCopy:this.handleNextMagicRecordCopy();break;case c.PVEFightType.AncientCorridor:this.handleNextAncientCopy();break;case c.PVEFightType.EightDiagrams:this.handleNextEightDiagrams()}},handleNextGeneralCopy:function(){if(td.PveGeneralCopyManager.isFirstEnterNewChapter())return td.PveCopyManager.prepareHookData(),td.PveGeneralCopyManager.isFirstEnterNewChapter()&&td.PanelManager.getInstance().removePanelDataByPanelEnum(td.PanelEnum.Window_PveCopyGate),void td.PanelManager.getInstance().getCurShowPanel().closeCallFunc();var t=td.PveGeneralCopyManager.getGateModelByGateId(td.PveCopyManager.getStoryId()),e=td.PveGeneralCopyManager.getGateModelByGateId(t.getNextGateId());this._nextGateModel=e;var i=e.getLeftChallengeTimes();0!==(i=Math.min(1,i))?td.PveGeneralCopyManager.checkChallengeCondition(e.getGateId())>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.NOTICE_GENERAL_COPY_READY,{storyId:e.getGateId(),isRoll:!1}):this.onTryRefreshTimes(e)},onTryRefreshTimes:function(t){var e=t.getResetTimes(),i=null,n=null;switch(t.getDifficultType()){case c.PVECopyDifficultType.Normal:i="NORMAL_STORY_RESET_COST",n=d.PrerogativeEnum.PveGeneralNormalResetTime;break;case c.PVECopyDifficultType.Nightmare:i="ELITE_STORY_RESET_COST",n=d.PrerogativeEnum.PveGeneralNightmareResetTime;break;case c.PVECopyDifficultType.Hellish:i="HELL_STORY_RESET_COST",n=d.PrerogativeEnum.PveGeneralHellishResetTime}if(i){var a=td.GlobalFunction.getShareConfigUpCostDetail(i,e+1),r={};r.mainDes=td.Language.resetTimesMainDes,r.subDes=td.Language.resetTimesSubDes,r.cost=a,r.boughtTimes=e,r.vipPrerogative=n,r.buyCallFunc=this.onRefreshChallengeTimes.bind(this,t.getGateId()),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_OpreateTimes,r)}else cc.log("get story reset cost error!!")},onRefreshChallengeTimes:function(t){t&&td.EventUtil.dispatchEvent(td.EventNameEnum.Req_RESET_GENERAL_COPY_TIMES,t)},handleNextMagicRecordCopy:function(){var t=td.Account.getUserData().getLevel(),e=td.GetTableClass(td.TableEnum.MagicRecordTable).getDataById(this.challengeId);if(t<e.levelLimit){var i=new td.BroadcastContent(194),n=new td.BroadcastParam(e.levelLimit);return i.setMainParam([n]),void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}if(td.PveGeneralCopyManager.getCurPassedGateId()<e.storyIdLimit){i=new td.BroadcastContent(220);var a=td.GetTableClass(td.TableEnum.PveGeneralCopyGateTable).getStoryDataById(e.storyIdLimit);n=new td.BroadcastParam(a.name);return i.setMainParam([n]),void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}var r=td.MagicRecordManager.getEntities()[this.challengeId-1];r&&0!==r.star?(td.GetTableClass(td.TableEnum.MagicRecordTable).getDataById(this.challengeId).times||0)-(r?r.times:0)>0?td.MagicRecordManager.getChallengeTimes()>0?td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_MAGIC_RECORD_PREPARE,{id:this.challengeId,isRoll:!1}):this.btnAddTimes():this._showResetTips(r):td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_MAGIC_RECORD_PREPARE,{id:this.challengeId,isRoll:!1})},handleNextAncientCopy:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_ANCIENT_PREPARE)},handleNextEightDiagrams:function(){if(o.default.getInstance().getTimes()<=0){var t=new td.BroadcastContent(51);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,t)}else td.EventUtil.dispatchEvent(td.EventNameEnum.ED_REQUEST_FIGHT_PREPARE,o.default.getInstance().getCurStoryId())},btnAddTimes:function(){var t=td.MagicRecordManager.getBoughtTimes(),e={};e.vipPrerogative=d.PrerogativeEnum.MagicRecordBuyTimes,e.boughtTimes=t,e.sureFunc=this._requestBuyTimes.bind(this),e.calcFunc=this.calcNeedPayWithTimes.bind(this),td.GlobalFunction.showBuyTimesWindow(e)},_requestBuyTimes:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_MAGIC_RECORD_BUY_TIMES,t)},calcNeedPayWithTimes:function(t){return td.MagicRecordManager.calcBuyChallengeTimesCost(t)},_showResetTips:function(t){if(t){var e=t.resetTimes,i=td.GlobalFunction.getShareConfigUpCostDetail("MAGIC_RECORD_RESET_TIMES_COST",e+1),n={};n.mainDes=td.Language.resetTimesMainDes,n.subDes=td.Language.resetTimesSubDes,n.cost=i,n.boughtTimes=e,n.vipPrerogative=d.PrerogativeEnum.MagicRecordResetLimitTimes,n.buyCallFunc=this._doReset.bind(this),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_OpreateTimes,n)}},_doReset:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_MAGIC_RECORD_RESET,this.challengeId)}});e.exports=h,cc._RF.pop()},{"../../../../Common/Component/GridLayoutComponent":void 0,"../../../AncientCorridor/Manager/AncientCorridorManager":"AncientCorridorManager","../../../Chess/Manager/ChessManager":"ChessManager","../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager","../../utils/FightResultAniComponent":"FightResultAniComponent",CommonEnum:void 0,PveCopyEnum:void 0,PveFightManager:"PveFightManager"}],PveFirstBattleUtil:[function(t,e,i){"use strict";cc._RF.push(e,"b6dc4jOUHtGxbNyvDgsmCFu","PveFirstBattleUtil");var n=t("PveCopyEnum");td.PveFirstBattleUtil={_isFirstBattle:null,_roadIndex:null,enterFirstBattle:function(){this._isFirstBattle=!1;var t=td.GetConfig("FirstBattle"),e=t[0],i=td.GetTableClass(td.TableEnum.PveGeneralCopyGateTable).getCfgDataByChapterAndGate(9999,e);i&&(this.setFirstBattle(i,t),this.setCopyData(i))},isFirstBattle:function(){return this._isFirstBattle},setCopyData:function(t){var e={copyType:n.PVEFightType.GeneralCopy,chapterId:t.chapterId,gateId:t.storyId};td.PveCopyManager.initCopyData(e),td.PveCopyManager.gotoPveFight()},setFirstBattle:function(t,e){this._isFirstBattle=!0;var i=n.PVEFightType.GeneralCopy,a=(t.chapterId,"pveFightSpeed"+i);td.LocalStorageUtil.write(a,2);for(var r=e[1],o=[],s=0;s<r.length;s++){var l={roleId:r[s],mercenaryId:10001+s};o.push(l)}td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_PARSE_HEROES_CFGS,o)}},cc._RF.pop()},{PveCopyEnum:void 0}],PveGeneralCopyChapterModel:[function(t,e,i){"use strict";cc._RF.push(e,"9fcd079HGBM8IkWEa45SfUP","PveGeneralCopyChapterModel");var n=t("PveCopyEnum"),a=cc.Class({properties:{_strMapResPath:null,_nMapRankIndex:null,_curChapterData:null,_curStarNum:null,_receivedReward:null,_isPassed:null,_posArray:null,_totalStar:0},init:function(t){this._curChapterData=t,this._strMapResPath=t.mapResPath,this._nMapRankIndex=t.rankIndex,this._posArray=t.pointPosArray;var e=t.passedReward;e.length>0&&(this._totalStar=e[e.length-1][0]),this._curStarNum=0,this._receivedReward={},this._isPassed=!1;var i=t.hangUpRewards;this._hangUpRewards=[];for(var n=0,a=i.length;n<a;n++)this._hangUpRewards=this._hangUpRewards.concat(i[n][0])},getHookReward:function(){return this._hangUpRewards},getCurChapterCfgData:function(){return this._curChapterData},getChapterId:function(){return this._curChapterData.chapterId},getAreaId:function(){return this._curChapterData.areaId},getChapterName:function(){return this._curChapterData.name},getStarAccumulateReward:function(){return this._curChapterData.passedReward},getTotalStars:function(){return this._totalStar},getMapImage:function(){return gdk.rm.getResByUrl(this._strMapResPath,cc.SpriteFrame)},getMapRankIndex:function(){return this._nMapRankIndex},getOpenLimitLevel:function(){return this._curChapterData.levelLimit},getLimitChapterId:function(){return this._curChapterData.chapterLimit},getChapterPassedTip:function(){return this._curChapterData.chapterPassTip},setCurStarNum:function(t){this._curStarNum=t},getCurStarNum:function(){return this._curStarNum},getOpenStatus:function(){var t=this.getLimitChapterId(),e=td.PveGeneralCopyManager.getChapterDataByChapterId(t);return!!(!e||e&&e.isPassed())},setPassStatus:function(t){this._isPassed=t},isPassed:function(){return this._isPassed},getDifficultType:function(){return this._curChapterData.difficultyType},setRewardBoxStatus:function(t){this._receivedReward[t]=n.PveRewardStatus.HaveReceived},getRewardBoxStatus:function(t){return this._receivedReward[t]?this._receivedReward[t]:null},hasRewardBoxToReceive:function(){for(var t=this._totalStar/3,e=1;e<=3;e++){var i=e*t;if(!this.getRewardBoxStatus(i)&&this._curStarNum>=i)return!0}return!1},getPosArray:function(){return this._posArray},getChapterNamePic:function(){return this._curChapterData.chapterName},getChapterBg:function(){return this._curChapterData.chapterBg},getHookExpPerMin:function(){return this._curChapterData.ept},getHookGoldPerMin:function(){return this._curChapterData.gpt}});e.exports=a,cc._RF.pop()},{PveCopyEnum:void 0}],PveGeneralCopyChapterTable:[function(t,e,i){"use strict";cc._RF.push(e,"7e85bB0tlFJo7sFe17ihzul","PveGeneralCopyChapterTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PveGeneralCopyChapterTable",properties:{_tblName:"story_chapter_config",_chapterData:null,_chapterMapData:null},init:function(){this._chapterData={},this._chapterMapData={};for(var t=0,e=this._jsonData.length;t<e;t++){var i=this._jsonData[t];i.mapResPath="UI/ZY_zhanyi/"+i.mapRes+".png";var n=i.difficultyType;this._chapterData[n]=this._chapterData[n]||{};var a=i.chapterId;this._chapterData[n][a]=i,i.chapterName="ZJ_zhangjie_bg/"+i.chapterName,i.chapterBg="ZJ_zhangjie_bg/"+i.chapterBg;i.rankIndex;this._chapterMapData[n]=this._chapterMapData[n]||[],this._chapterMapData[n].push(i)}},getCfgDataByDifficultyType:function(t){return this._chapterData[t]?this._chapterData[t]:null},getCfgDataByChapterId:function(t){for(var e in this._chapterData){var i=this._chapterData[e];for(var n in i){var a=i[n];if(a.chapterId===t)return a}}return null},getAllChapterCfgs:function(){return this._chapterData},getRankDataByDifficulty:function(t){return this._chapterMapData[t]?this._chapterMapData[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PveGeneralCopyGateModel:[function(t,e,i){"use strict";cc._RF.push(e,"d76fbQAwf5Bg5Rncepqi4hn","PveGeneralCopyGateModel");var n=t("PveBaseGateModel"),a=cc.Class({extends:n,properties:{_curGateData:null,_leftChallengeTimes:null,_curStarCount:null,_bOpen:null,_resetTimes:null,_hangUpRewards:null},init:function(t){this._super(t),this._curGateData=t,this._leftChallengeTimes=t.challengeTimes,this._bOpen=!1,this._curStarCount=0,this._resetTimes=0},getGateCfg:function(){return this._curGateData},getHookExpPerMin:function(){return this._curGateData.ept},getHookGoldPerMin:function(){return this._curGateData.gpt},getChapterId:function(){return this._curGateData.chapterId},getDifficultType:function(){return this._curGateData.chapterType},getName:function(){return this._curGateData.name},getStroyId:function(){return this._curGateData.storyId},getPreGateId:function(){return this._curGateData.preStoryId},getNextGateId:function(){return this._curGateData.nextStoryId},getGateType:function(){return this._curGateData.storyType},getChieftainId:function(){return this._curGateData.chieftain},getBaseDropGoldNum:function(){return this._curGateData.baseDropGold},getBaseDropExpNum:function(){return this._curGateData.baseDropEXP},getTotalChallengeTimes:function(){return this._curGateData.challengeTimes},getGateIndex:function(){return this._curGateData.gateIndex},getOpenStoryId:function(){return this._curGateData.openStoryId},getWinStoryId:function(){return this._curGateData.winStoryId},setLeftChallengeTimes:function(t){this._leftChallengeTimes=t},getLeftChallengeTimes:function(){return this._leftChallengeTimes},getFirstPassedShowRewards:function(){return this._curGateData.firstRewards},getDropShowRewards:function(){return this._curGateData.randomDrop},getUIShowSpeReward:function(){return this._curGateData.rewardUIshow},getLevelLimit:function(){return this._curGateData.levelLimit},getOpenStatus:function(){var t=this.getPreGateId();return 0===t||td.PveGeneralCopyManager.getGateModelByGateId(t).getCurStarCount()>0},setCurStarCount:function(t){this._curStarCount=t},getCurStarCount:function(){return this._curStarCount},setResetTimes:function(t){this._resetTimes=t},getResetTimes:function(){return this._resetTimes}});e.exports=a,cc._RF.pop()},{PveBaseGateModel:"PveBaseGateModel"}],PveGeneralCopyGateTable:[function(t,e,i){"use strict";cc._RF.push(e,"31b30CK1u9EeIuSl1EOyBrR","PveGeneralCopyGateTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PveGeneralCopyGateTable",properties:{_tblName:"story_config",_gateData:null,_storyData:null},init:function(){this._gateData={},this._storyData={};for(var t=0,e=this._jsonData.length;t<e;t++){var i=this._jsonData[t];i.mapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(i.mapIndex,3)),i.roadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(i.roadIndex,3)),i.autoMapRes=cc.js.formatStr("fightRes/pve/map/map%s",td.GlobalFunction.pad(i.autoMapIndex,3)),i.autoRoadRes=cc.js.formatStr("fightRes/pve/map/road%s",td.GlobalFunction.pad(i.autoRoadIndex,3));var n=i.chapterId;this._gateData[n]=this._gateData[n]||{};var a=i.storyId;this._gateData[n][a]=i,this._storyData[a]=i}},getCfgDataByChapterId:function(t){return this._gateData[t]?this._gateData[t]:null},getCfgDataByChapterAndGate:function(t,e){return this._gateData[t][e]?this._gateData[t][e]:null},getAllStoryData:function(){return this._storyData},getStoryDataById:function(t){return this._storyData[t]?this._storyData[t]:null},getAllGateData:function(){return this._gateData}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PveGeneralCopyManager:[function(t,e,i){"use strict";cc._RF.push(e,"57af2d8XLtCH6DV9F8BLb5+","PveGeneralCopyManager");var n=t("PveGeneralCopyChapterModel"),a=t("PveGeneralCopyGateModel"),r=t("PveCopyEnum"),o=t("CommonEnum");td.PveGeneralCopyManager={_curChapterId:null,_curGateId:null,_chapterData:null,_preStoryNumList:null,_gateData:null,_gateIdToChapter:null,_originLevel:null,_minChapterIds:null,_maxChapterIds:null,_hookGateId:null,_lastReceiveTimes:null,_quickTimes:null,_quickTotalTimes:null,_preLastReceiveTimes:null,init:function(){this.destroyData(),this.addNetListeners(),this.addLocalListeners()},destroyData:function(){this._curChapterId=0,this._curGateId=0,this._chapterData={},this._gateData=null,this._originLevel=0,this._gateIdToChapter={},this._minChapterIds={},this._maxChapterIds={},this._hookGateId=0,this._lastReceiveTimes=0,this._quickTimes=0,this._quickTotalTimes=0,this._preStoryNumList={},this._canGuide=!0},resetChapterData:function(){if(this._chapterData){for(var t in this._chapterData){var e=this._chapterData[t];for(var i in e){var n=e[i];n.init(n.getCurChapterCfgData())}}for(var a in this._gateData){var r=this._gateData[a];for(var o in r)if(r.hasOwnProperty(o)){var s=r[o];s.init(s.getGateCfg())}}}},addNetListeners:function(){var t=td.MsgModuleName.PveGeneralCopy,e=td.MsgCmd.PVE_GENERAL_COPY;td.ServerDelegate.registerMessage(t,e.GET_COPY_LIST,this.onReceiveAllCopiesInfo.bind(this)),td.ServerDelegate.registerMessage(t,e.GENERAL_COPY_PREPARE,this.onReceiveCopyReadyReturn.bind(this)),td.ServerDelegate.registerMessage(t,e.GENERAL_COPY_REPORT,this.onReceiveCopyReportReturn.bind(this)),td.ServerDelegate.registerMessage(t,e.GENERAL_COPY_BUY_TIMES,this.onReceiveBuyTimesReturn.bind(this)),td.ServerDelegate.registerMessage(t,e.GENERAL_COPY_SWEEP,this.onReceiveSweepReturn.bind(this)),td.ServerDelegate.registerMessage(t,e.RECEIVE_PASSED_REWARD,this.onReceivePassedRewardReturn.bind(this)),td.ServerDelegate.registerMessage(t,e.GET_ON_HOOK_INFO,this.onReceiveOnHookInfo.bind(this)),td.ServerDelegate.registerMessage(t,e.PUSH_GENERAL_COPY_INFO,this.onReceiveAllCopiesInfo.bind(this)),td.ServerDelegate.registerMessage(t,e.PUSH_GENERAL_COPY_CHANGE_INFO,this.receivePushCopyChangeInfo.bind(this)),td.ServerDelegate.registerMessage(t,e.GET_STORY_HANG_UP,this._resGetHookUpInfo.bind(this)),td.ServerDelegate.registerMessage(t,e.STORY_HANG_UP_RECEIVE_REWARD,this._resGetHookReward.bind(this)),td.ServerDelegate.registerMessage(t,e.STORY_HANG_UP_QUICK_REWARD,this._resGetQuickReward.bind(this)),td.ServerDelegate.registerMessage(t,e.PUSH_STORY_HANG_UP,this._resGetHookUpInfo.bind(this))},addLocalListeners:function(){td.EventUtil.registerEvent(td.EventNameEnum.QUERY_PVE_GENERAL_COPY_INFO,this.queryCopyInfo,this),td.EventUtil.registerEvent(td.EventNameEnum.NOTICE_GENERAL_COPY_READY,this.noticeCopyReady,this),td.EventUtil.registerEvent(td.EventNameEnum.GENERAL_COPY_RESULT_REPORT,this.requestCopyResultReport,this),td.EventUtil.registerEvent(td.EventNameEnum.Req_RESET_GENERAL_COPY_TIMES,this.requestBuyChallengeTimes,this),td.EventUtil.registerEvent(td.EventNameEnum.Req_SWEEP_GENERA_COPY,this.requestSweepCopy,this),td.EventUtil.registerEvent(td.EventNameEnum.Req_RECEIVE_PASSED_REWARD,this.requestGetPassedReward,this),td.EventUtil.registerEvent(td.EventNameEnum.REQ_GET_HOOKUP_INFO,this._reqGetHookUpInfo,this),td.EventUtil.registerEvent(td.EventNameEnum.REQ_GET_HOOKUP_REWARD,this._reqGetHookUpReward,this),td.EventUtil.registerEvent(td.EventNameEnum.REQ_GET_QUICK_HOOKUP_REWARD,this._reqGetQuickReward,this),td.EventUtil.registerEvent(td.EventNameEnum.USER_STORY_ID_CHANGE,this._reqGetHookUpInfo,this),td.EventUtil.registerEvent(td.EventNameEnum.USER_STORY_ID_CHANGE,this.insertGuideData,this),td.EventUtil.registerEvent(td.EventNameEnum.NET_TIME_OUT,this._onNetTimeout,this)},removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},getHookGateId:function(){return this._hookGateId||1},getQuickHookTimes:function(){return this._quickTimes},getTotalQuickHookTimes:function(){return this._quickTotalTimes},getLastHookRewardTime:function(){return this._lastReceiveTimes},getPreLastHookRewardTime:function(){return this._preLastReceiveTimes},setPreLastHoolRewardTime:function(t){this._preLastReceiveTimes=t},isHookRewardRedPoint:function(){return td.TimeUtil.getTime()-this._lastReceiveTimes>=36e5},hoolRewardEvents:function(){return[td.EventNameEnum.RES_GET_HOOKUP_INFO]},isQuickGainRedPoint:function(){var t=this.getQuickHookTimes(),e=td.PrerogativeManager.getPrerogative(o.PrerogativeEnum.STORY_HANG_UP_REWARD_QUICK_TIMES);return(e?e.getValue()-t:0)>0},quickGainEvents:function(){return[td.EventNameEnum.RES_GET_HOOKUP_INFO]},_reqGetHookUpInfo:function(){var t={};t.module=td.MsgModuleName.PveGeneralCopy,t.cmd=td.MsgCmd.PVE_GENERAL_COPY.GET_STORY_HANG_UP,td.ServerDelegate.sendMessage(t)},_resGetHookUpInfo:function(t,e){t===td.NetCode.SUCCESS&&(this._hookGateId=e.storyId,this._lastReceiveTimes=e.lastReceiveTimes,this._quickTimes=e.quickTimes,this._quickTotalTimes=e.quickTotalTimes,this._preLastReceiveTimes||(this._preLastReceiveTimes=this._lastReceiveTimes),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_GET_HOOKUP_INFO),td.EventUtil.dispatchEvent(td.EventNameEnum.INIT_DATA_LOADED,td.LoadKey.PveHookInfo))},_reqGetHookUpReward:function(){this._preLastReceiveTimes=this._lastReceiveTimes;var t={};t.module=td.MsgModuleName.PveGeneralCopy,t.cmd=td.MsgCmd.PVE_GENERAL_COPY.STORY_HANG_UP_RECEIVE_REWARD,td.ServerDelegate.sendMessage(t)},_resGetHookReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_GateReward,n)}},_reqGetQuickReward:function(){var t={};t.module=td.MsgModuleName.PveGeneralCopy,t.cmd=td.MsgCmd.PVE_GENERAL_COPY.STORY_HANG_UP_QUICK_REWARD,td.ServerDelegate.sendMessage(t)},_resGetQuickReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_GET_QUICK_HOOKUP_REWARD,n)}},initCopyData:function(){this._chapterData={},this._minChapterIds={},this._maxChapterIds={};var t=td.GetTableClass(td.TableEnum.PveGeneralCopyChapterTable).getAllChapterCfgs();for(var e in t)if(t.hasOwnProperty(e)){var i=t[e=parseInt(e)];this._chapterData[e]=this._chapterData[e]||{};var r=0,o=999999;for(var s in i)if(i.hasOwnProperty(s)){if(9999===(s=parseInt(s)))continue;var l=i[s],c=new n;c.init(l),this._chapterData[e][s]=c,r=r<s?s:r,o=o>s?s:o}this._minChapterIds[e]=o,this._maxChapterIds[e]=r}this._gateData={},this._gateIdToChapter={};var u=td.GetTableClass(td.TableEnum.PveGeneralCopyGateTable).getAllGateData(),d=0;for(var s in u)if(9999!==(s=parseInt(s))&&u.hasOwnProperty(s)){l=u[s];for(var h in this._gateData[s]=this._gateData[s]||{},l)if(l.hasOwnProperty(h)){var p=l[h],_=new a;_.init(p),this._gateData[s][h]=_,this._gateIdToChapter[h]=_,this._preStoryNumList[h]=d,d++}}this.insertGuideData()},setGuideState:function(t){this._canGuide=t},isFirstEnterNewChapter:function(){var t=td.LocalStorageUtil.read(td.LocalDataKey.Chapter_Open),e=this.getCurChapterId(),i=this.getCurGateId(),n=td.PveGeneralCopyManager.getGatesInfoByChapterId(e),a=td.ArrayUtil.frontKey(n);return 1001!=e&&!(!this._canGuide||t&&!(t<e)||a!=i)},insertGuideData:function(){var t=td.Account.getUserData().getCurStoryId(),e=this.getGateModelByGateId(t);if(e){var i=e.getChapterId(),n=this.getGatesInfoByChapterId(i),a=td.ArrayUtil.frontKey(n);i>1001&&(!this._curChapterId||i>this._curChapterId)&&a==t&&(this.setGuideState(!0),td.GuideManager.insertSysOpenGuide(i-0+13e4))}},getCurPassedGateId:function(){var t=this.getCurGateId(),e=this.getGateModelByGateId(t);return e?0===e.getNextGateId()&&e.getCurStarCount()>0?e.getStroyId():e.getPreGateId():0},getCurGateId:function(){return td.Account.getUserData().getCurStoryId()},getCurGatePreId:function(t){var e=this.getGateModelByGateId(t),i=0;return e&&(i=e.getPreGateId()),i},getCurChapterId:function(){var t=this.getGateModelByGateId(this.getCurGateId());t.getChapterId();if(t.getLevelLimit()<=td.Account.getUserData().level)this._curChapterId=t.getChapterId();else{var e=t.getPreGateId(),i=this.getGateModelByGateId(e);this._curChapterId=i.getChapterId()}return this._curChapterId},getMaxChapterIdByDifficult:function(t){return this._maxChapterIds[t]},getMinChapterIdByDifficult:function(t){return this._minChapterIds[t]},getChaptersByDifficultType:function(t){return this._chapterData[t]?this._chapterData[t]:null},getChapterDataByChapterId:function(t){for(var e in this._chapterData){var i=this._chapterData[e];for(var n in i){var a=i[n];if(a.getChapterId()===t)return a}}},getChapterDataByTypeAndId:function(t,e){return this._chapterData&&this._chapterData[t]&&this._chapterData[t][e]?this._chapterData[t][e]:null},getGatesInfoByChapterId:function(t){return this._gateData[t]?this._gateData[t]:null},getGateModelByGateId:function(t){for(var e in this._gateData||this.initCopyData(),this._gateData){var i=this._gateData[e];if(i[t])return i[t]}return null},getNextGateModelByGateId:function(t){var e=this.getGateModelByGateId(t);return this.getGateModelByGateId(e.getNextGateId())},getDropRewardsByChapterId:function(t){var e=this.getGatesInfoByChapterId(t),i=[];if(e)for(var n in e)if(e.hasOwnProperty(n))for(var a=e[n].getDropShowRewards(),r=function(t){var e=a[t];s=!0,i.forEach(function(t){t[0]==e[0]&&t[1]==e[1]&&(s=!1)}),s&&i.push(e)},o=0;o<a.length;o++){var s;r(o)}var l=td.RewardManager.parseRewardListDetail(i);return l.sort(function(t,e){return e.getGoodsOperateType()==t.getGoodsOperateType()?e.getQuality()-t.getQuality():e.getGoodsOperateType()-t.getGoodsOperateType()}),l},queryCopyInfo:function(){var t={};t.module=td.MsgModuleName.PveGeneralCopy,t.cmd=td.MsgCmd.PVE_GENERAL_COPY.GET_COPY_LIST,td.ServerDelegate.sendMessage(t)},onReceiveAllCopiesInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._chapterData&&this._gateData||this.initCopyData();var i=e.chapterRewardMap,n=e.storyChapterMap;this.upChapterRewardStatus(i),this.upChapterGatesData(n),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_PVE_GENERAL_COPY_INFO),td.EventUtil.dispatchEvent(td.EventNameEnum.INIT_DATA_LOADED,td.LoadKey.PveCopyInfo)}},upChapterRewardStatus:function(t){if(t)for(var e in t)if(t.hasOwnProperty(e)){if(9999===parseInt(e))continue;for(var i=this.getChapterDataByChapterId(parseInt(e)),n=t[e],a=0,r=n.length;a<r;a++){var o=n[a];i.setRewardBoxStatus(o)}}},upChapterGatesData:function(t){if(t)for(var e in t)if(t.hasOwnProperty(e)){if(9999===parseInt(e))continue;for(var i=t[e],n=this.getChapterDataByChapterId(parseInt(e)),a=this.getGatesInfoByChapterId(parseInt(e)),r=0,o=0,s=i.length;o<s;o++){var l=i[o],c=l.storyId;if(a[c]){var u=a[c],d=l.remainChallengeTimes,h=l.starNum,p=l.resetTimes;u.setLeftChallengeTimes(d),u.setCurStarCount(h),u.setResetTimes(p),r+=h;u.getPreGateId();var _=u.getNextGateId(),g=this.getGateModelByGateId(_);g&&g.getChapterId()!==u.getChapterId()&&n&&n.getOpenStatus()&&n.setPassStatus(h>0)}}n&&n.setCurStarNum(r)}},noticeCopyReady:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.RECORD_CUR_LEVEL);var e={};e.module=td.MsgModuleName.PveGeneralCopy,e.cmd=td.MsgCmd.PVE_GENERAL_COPY.GENERAL_COPY_PREPARE,e.storyId=t.storyId,e.starNum=0,e.isRoll=t.isRoll||!1,td.ServerDelegate.sendMessage(e)},onReceiveCopyReadyReturn:function(t,e){if(t===td.NetCode.SUCCESS)if(e&&e.rewardResult){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);n&&n.length>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.MAGIC_RECORD_ON_GET_CHALLENGE_QUICK,n)}else td.EventUtil.dispatchEvent(td.EventNameEnum.GENERAL_COPY_READY_RETURN)},requestCopyResultReport:function(t){var e={};e.module=td.MsgModuleName.PveGeneralCopy,e.cmd=td.MsgCmd.PVE_GENERAL_COPY.GENERAL_COPY_REPORT,e.storyId=t.gateId,e.starNum=t.stars,e.check=t.check,td.ServerDelegate.sendMessage(e)},onReceiveCopyReportReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=e.storyId,a=td.RewardManager.parseRewardResult(i,!0),o=this.getGateModelByGateId(n);o&&o.getGateType()===r.PveCopyGateType.Box&&td.GlobalFunction.showRewards(a),td.EventUtil.dispatchEvent(td.EventNameEnum.RECEIVE_PVE_FIHGT_REAWRD,a)}else td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PRE_PANEL)},requestBuyChallengeTimes:function(t){var e={};e.module=td.MsgModuleName.PveGeneralCopy,e.cmd=td.MsgCmd.PVE_GENERAL_COPY.GENERAL_COPY_BUY_TIMES,e.storyId=t,td.ServerDelegate.sendMessage(e)},onReceiveBuyTimesReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.storyId,n=e.times,a=this.getGateModelByGateId(i);a&&(a.setLeftChallengeTimes(n),td.EventUtil.dispatchEvent(td.EventNameEnum.Res_RESET_GENERAL_COPY_TIMES)),td.EventUtil.dispatchEvent(td.EventNameEnum.BUY_TIMES_SUCCESS)}},requestSweepCopy:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.RECORD_CUR_LEVEL);var e={};e.module=td.MsgModuleName.PveGeneralCopy,e.cmd=td.MsgCmd.PVE_GENERAL_COPY.GENERAL_COPY_SWEEP,e.storyId=t.gateId,e.hangUpTimes=t.nTimes,td.ServerDelegate.sendMessage(e)},onReceiveSweepReturn:function(t,e){if(t===td.NetCode.SUCCESS){for(var i=[],n=e.rewardVOList,a=0,r=n.length-1;a<=r;a++){var o=n[a],s={};s.exp=o.exp,s.gold=o.gold;for(var l=td.RewardManager.parseRewardResult(o.rewardResult),c=[],u=l.length-1;u>=0;u--)if(l[u].id!==td.ItemEnum.Gold&&l[u].id!==td.ItemEnum.Exp){var d=td.GlobalFunction.getGoodsData(l[u].type,l[u].id,l[u].count);d&&(c[c.length]=d)}c.sort(function(t,e){return e.getQuality()-t.getQuality()}),s.rewards=c,i[i.length]=s}td.EventUtil.dispatchEvent(td.EventNameEnum.Res_SWEEP_GENERA_COPY,i),td.EventUtil.dispatchEvent(td.EventNameEnum.USER_ATTR_ENERGY_CHANGE)}},requestGetPassedReward:function(t){var e={};e.module=td.MsgModuleName.PveGeneralCopy,e.cmd=td.MsgCmd.PVE_GENERAL_COPY.RECEIVE_PASSED_REWARD,e.chapterId=t.chapterId,e.starNum=t.starNum,td.ServerDelegate.sendMessage(e)},onReceivePassedRewardReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.Res_RECEIVE_PASSED_REWARD_RETURN,n)}},receivePushCopyChangeInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.storyVO;if(i){var n=i.storyId,a=this.getGateModelByGateId(n);if(a){var r=i.remainChallengeTimes,o=i.starNum,s=i.resetTimes;a.setLeftChallengeTimes(r),a.setCurStarCount(o),a.setResetTimes(s);var l=a.getChapterId(),c=this.getGatesInfoByChapterId(l),u=this.getChapterDataByChapterId(l),d=0;for(var n in c)d+=c[n].getCurStarCount();u.setCurStarNum(d);var h=a.getNextGateId(),p=this.getGateModelByGateId(h);p&&p.getChapterId()!==a.getChapterId()&&u&&u.getOpenStatus()&&u.setPassStatus(o>0)}td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHANGE_PVE_COPY_CHAPTER)}}},onReceiveOnHookInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.storyId;this._curGateId=i&&9999!==i?i:1;var n=this.getGateModelByGateId(this._curGateId),a=this._curChapterId;this._curChapterId=n.getChapterId(),this._curChapterId>a&&this.setGuideState(!0),td.GuideManager.insertSysOpenGuide(this._curChapterId-0+13e4)}},refreshCurGateId:function(){var t=td.Account.getUserData().getCurStoryId();this._curGateId=t;var e=this.getGateModelByGateId(t);this._curChapterId=e.getChapterId()},getFirstChapterGateModel:function(t){var e=td.GetTableClass(td.TableEnum.PveGeneralCopyGateTable).getCfgDataByChapterId(t);if(!e||0===e.myLen())return null;var i=null;for(var n in e){i=e[n];break}var a=i.storyId;return this.getGateModelByGateId(a)},getIsOpenByChapter:function(t){var e=t.getOpenStatus(),i=t.getChapterId(),n=t.getDifficultType(),a=td.Account.getUserData().level,o=this.getFirstChapterGateModel(i);if(!o)return!1;if(n===r.PVECopyDifficultType.Normal){if(i<=td.PveGeneralCopyManager.getCurChapterId()&&e&&a>=o.getLevelLimit())return!0}else{var s=td.PveGeneralCopyManager.getMinChapterIdByDifficult(n);if(e){if(i===s)return!0;var l=i-1;return td.PveGeneralCopyManager.getChapterDataByChapterId(l).isPassed()}}return!1},getIsShowByChapter:function(t){var e=t.getChapterId(),i=t.getDifficultType();if(td.PveGeneralCopyManager.getMinChapterIdByDifficult(i)===e)return!0;var n=e-1,a=td.PveGeneralCopyManager.getChapterDataByChapterId(n);return this.getIsOpenByChapter(a)},getOriginLevel:function(){return this._originLevel},clearOriginLevel:function(){this._originLevel=0},isRewardBoxRedPointTip:function(t){var e=t.chapterData,i=t.starNum,n=e.getRewardBoxStatus(i);return(!n||n!==r.PveRewardStatus.HaveReceived)&&(e.getCurStarNum()>=i||void 0)},rewardBoxRedPointEvts:function(){return[td.EventNameEnum.USER_ATTR_ENERGY_CHANGE,td.EventNameEnum.REFRESH_PVE_GENERAL_COPY_INFO,td.EventNameEnum.Res_RECEIVE_PASSED_REWARD_RETURN]},hasPveCopyHaveRewards:function(t){return t=t||r.PVECopyDifficultType.Normal,this.hasBoxToReceive(this._minChapterIds[t],this.getCurChapterId())},hasPveCopyRedPoint:function(t){return this.energyReachMax()||this.hasPveCopyHaveRewards(t)},energyReachMax:function(){return td.Account.getUserData().getEnergy()>=td.GetConfig("ACTOR_ENERGY_LIMIT")},hasBoxToReceive:function(t,e){var i=this.getChaptersByDifficultType(r.PVECopyDifficultType.Normal);if(!t)return!1;if(!e||t>e)return!!i[t]&&i[t].hasRewardBoxToReceive();for(var n in i){var a=i[n];if(a.getChapterId()>e)break;if(!(a.getChapterId()<t)&&a.hasRewardBoxToReceive())return!0}return!1},_onNetTimeout:function(t){if(t[0]===td.MsgModuleName.PveGeneralCopy&&t[1]===td.MsgCmd.PVE_GENERAL_COPY.GENERAL_COPY_REPORT)(e=new td.BroadcastContent(318)).setOkText(td.Language.reconnect),e.setOkCallFunc(this._onRetryConnect.bind(this)),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e);else if(t[0]===td.MsgModuleName.PveGeneralCopy&&t[1]===td.MsgCmd.PVE_GENERAL_COPY.GENERAL_COPY_PREPARE){var e=new td.BroadcastContent(319);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e),td.ServerDelegate.reconnect()}},_onRetryConnect:function(){td.PanelManager.getInstance().clearShowPanelQueue(),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,td.PanelEnum.Panel_PVE_FIGHT_HOOK),td.ServerDelegate.reconnect()},checkChallengeCondition:function(t,e,i,n){void 0===e&&(e=1),void 0===i&&(i=!0),void 0===n&&(n=!0);var a=e,r=this.getGateModelByGateId(t);if(td.Account.getUserData().getLevel()<r.getLevelLimit()&&i){var o=new td.BroadcastContent(314),s=new td.BroadcastParam(r.getLevelLimit());return o.setMainParam([s]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,o),-1}var l=r.getLeftChallengeTimes();if((l=Math.min(a,l))<=0)return 0;for(var c=td.Account.getUserData().getEnergy(),u=td.GetTableClass(td.TableEnum.Config).getConfig("STORY_COST_ENERGY"),d=r.getDifficultType(),h=0,p=0,_=u.length;p<_;p++){var g=u[p];if(g[0]===d){h=g[1];break}}var f=Math.min(parseInt(c/h),l);return 0===f&&n?(td.GlobalFunction.gotoAddEnergy(),0):f},hasNextGate:function(t){var e=this.getGateModelByGateId(t);return e&&e.getNextGateId()>0},getCurGateModel:function(){return this._gateIdToChapter[this.getCurGateId()]},getPreGateNumById:function(t){return this._preStoryNumList[t]},getChapterDataByNotFull:function(){var t=[];for(var e in this._chapterData){var i=this._chapterData[e];for(var n in i){var a=i[n];td.PveGeneralCopyManager.getIsOpenByChapter(a)&&a.getCurStarNum()!=a.getTotalStars()&&t.push(a)}}return t},getGateModelByNotFull:function(){var t=[];for(var e in this._gateData||this.initCopyData(),this._gateData){var i=this._gateData[e];for(var n in i){var a=i[n];!a.getOpenStatus()||1!=a.getCurStarCount()&&2!=a.getCurStarCount()||t.push(a)}}return t},getGateModelByFull:function(){var t=[];for(var e in this._gateData||this.initCopyData(),this._gateData){var i=this._gateData[e];for(var n in i){var a=i[n];a.getOpenStatus()&&3==a.getCurStarCount()&&t.push(a)}}return t},getGateModelByDropHeroClips:function(){var t=[];for(var e in this._gateData||this.initCopyData(),this._gateData){var i=this._gateData[e];for(var n in i){var a=i[n];a.getOpenStatus()&&a.getUIShowSpeReward()&&a.getUIShowSpeReward().length>0&&t.push(a)}}return t},getGateModelByOpen:function(){var t=[];for(var e in this._gateData||this.initCopyData(),this._gateData){var i=this._gateData[e];for(var n in i){var a=i[n];a.getOpenStatus()&&t.push(a)}}return t},getAllGateData:function(){var t=[];for(var e in this._gateData||this.initCopyData(),this._gateData){var i=this._gateData[e];for(var n in i){var a=i[n];t.push(a)}}return t}},cc._RF.pop()},{CommonEnum:void 0,PveCopyEnum:void 0,PveGeneralCopyChapterModel:"PveGeneralCopyChapterModel",PveGeneralCopyGateModel:"PveGeneralCopyGateModel"}],PveHeroFihgtShowTable:[function(t,e,i){"use strict";cc._RF.push(e,"4e615ovtcBB95BoXDibgKce","PveHeroFihgtShowTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PveHeroFihgtShowTable",properties:{_tblName:"pve_hero_fightshow_config",_heroFightData:null},init:function(){this._heroFightData={};this._heroFightData;for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];n.spriteType===td.SpriteType.PET?(n.resPath="pet/"+n.res+"/pve/"+n.res,n.animationRes="pet/"+n.res+"/"+n.res,n.idlePath="pet/"+n.res+"/pve/PVE_"+n.res):(n.resPath="hero/"+n.res+"/pve/"+n.res,n.animationRes="hero/"+n.res+"/"+n.res,n.idlePath="hero/"+n.res+"/pve/PVE_"+n.res),0!==n.conjureType&&(n.conjureAniation=n.resPath+"ConjureAnimation",n.conjurePrefab=n.resPath+"ConjurePrefab"),this._heroFightData[n.id]=n}},getPveHeroCfgById:function(t){return this._heroFightData[t]?this._heroFightData[t]:(cc.log(cc.js.formatStr("the hero is not exist for heroId = %s",t)),null)}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PveHeroModel:[function(t,e,i){"use strict";cc._RF.push(e,"81ae4q9s+9MTqNvFngDo68g","PveHeroModel");var n=o(t("../../../../TS/Hero/Manager/HeroManager")),a=o(t("../../../EightDiagrams/Manager/EightDiagramsManager")),r=o(t("../manager/PveDataHelper"));function o(t){return t&&t.__esModule?t:{default:t}}var s=t("PveSkillModel"),l=t("BulletModel"),c=t("PveCopyEnum"),u=cc.Class({_mercenaryDataModel:null,_roleId:null,_sid:null,_heroName:null,_vocation:null,_star:null,_res:null,_bulletId:null,_inspireBulletId:null,_bulletDataModel:null,_inspireBulletDataModel:null,_towerMight:null,_pveLoveIds:null,_headImg:null,_atlas:null,_aniAttackUp:null,_aniAttackDown:null,_aniAttackRight:null,_aniAttackRightUp:null,_aniAttackRightDown:null,_aniIdleUp:null,_aniIdleDown:null,_aniIdleRight:null,_aniIdleRightUp:null,_aniIdleRightDown:null,_prefabAttackUp:null,_prefabAttackDown:null,_prefabAttackRight:null,_prefabAttackRightUp:null,_prefabAttackRightDown:null,_attackInterval:null,_attackRange:null,_curAttackPower:null,_attackEffectCfg:null,_bulletUpOffect:null,_bulletDownOffect:null,_bulletRightOffect:null,_bulletRightUpOffect:null,_bulletRightDownOffect:null,_pveSkillId:null,_skillDataModel:null,_attackSoundId:null,_shadowScale:null,_modelShowType:null,_roleType:null,_isPet:null,_posTag:null,init:function(t,e,i){if(this._isPet="PetModel"==i.clsName,this._roleId=t.id,this._sid=e,this._res=t.res,this._resPath=t.resPath,this._animationRes=t.animationRes,this._shadowScale=i.getShadowScale(),this._modelShowType=i.getModelShowType(),this._roleType=i.getRoleType(),this._towerMight=t.towerMight&&"number"==typeof t.towerMight?t.towerMight/1e4:0,this._pveLoveIds=t.pveLoveId,this._bulletUpOffect=t.offsetUp,this._bulletDownOffect=t.offsetDown,this._bulletRightOffect=t.offsetRight,this._bulletRightUpOffect=t.offsetRightUp,this._bulletRightDownOffect=t.offsetRightDown,this._attackEffectCfg=t.pveEffect,this._pveSkillId=t.pveSkillId,this._skillDataModel=null,this._pveSkillId>0){var a=td.TableManager.getTableClass(td.TableEnum.PveSkillTable).getSkillCfgDataById(this._pveSkillId),o=new s;o.init(a),this._skillDataModel=o}this._bulletId=t.pveBulletId,this._inspireBulletId=t.inspireBulletId;var u=td.TableManager.getTableClass(td.TableEnum.PveBulletTable).getBulletCfgDataById(this._bulletId),d=new l;d.init(u),this._bulletDataModel=d,u=td.TableManager.getTableClass(td.TableEnum.PveBulletTable).getBulletCfgDataById(this._inspireBulletId),(d=new l).init(u),this._inspireBulletDataModel=d,this._attackSoundId=t.sound||0;var h=td.GuideManager.isFirstBattle(),p=h&&!this._isPet?n.default.getInstance().getGuideHeroDataBySid(e):i;this._isPet||(this._headImg=gdk.rm.getResByUrl(p.getIconRes(),cc.SpriteFrame)),this._heroName=p.getName(),this._vocation=p.getFeatures(),this._star=p.getQuality(),this._mercenaryDataModel=p;var _=td.BattleArrayManager.getIndexByMercenarySid(e);h?this._curAttackPower=p.getBaseAttackPower():this._isPet?this._curAttackPower=p.getBaseAttackPower():td.PveCopyManager.getCopyType()==c.PVEFightType.CHESS?this._curAttackPower=p.getBaseAttackPower():this._curAttackPower=td.BattleArrayManager.getFightPowerByIndex(_),this._attackInterval=t.pveAttackInterval/1e3;var g=r.default.getSkillAdditions(this._vocation);g&&g[td.PveEnum.TecEffectType.ATTACK_INTERVAL]&&(this._attackInterval-=g[td.PveEnum.TecEffectType.ATTACK_INTERVAL]/1e4),this._attackRange=t.pveAttackRange,g&&g[td.PveEnum.TecEffectType.DAMAGE_RANGE]&&(this._attackRange+=g[td.PveEnum.TecEffectType.DAMAGE_RANGE]/10),this._fixAttackPower()},_fixAttackPower:function(){if(td.PveCopyManager.getCopyType()===c.PVEFightType.EightDiagrams){var t=a.default.getInstance().getHeroFightChange(this._vocation);this._curAttackPower=this._curAttackPower*(t/1e4)}},getRecoverFixPower:function(){if(td.PveCopyManager.getCopyType()===c.PVEFightType.EightDiagrams){var t=a.default.getInstance().getHeroFightChange(this._vocation);return this._curAttackPower/(t/1e4)}return this._curAttackPower},getRoleType:function(){return this._roleType},getModelShowType:function(){return this._modelShowType},getShadowScale:function(){return this._shadowScale},getNotChangeSpeedAnimationList:function(){return[]},getAnimationRes:function(){return this._animationRes},getResPath:function(){return this._resPath},getId:function(){return this._roleId},isPet:function(){return this._isPet},getSid:function(){return this._sid},getMercenaryDataModel:function(){return this._mercenaryDataModel},getName:function(){return this._heroName},getFeatures:function(){return this._vocation},getStar:function(){return this._star},getHeadRes:function(){return this._headImg},getRes:function(){return this._res},getAttackInterval:function(){return this._attackInterval},getTowerBaseMight:function(){return this._towerMight},getAttackRange:function(){return this._attackRange},getPveBulletId:function(){return this._bulletId},getPveBulletDataModel:function(){return this._bulletDataModel},getPveInspireBulletDataModel:function(){return this._inspireBulletDataModel},getPveLoveId:function(){return this._pveLoveIds},getAttackSoundId:function(){return this._attackSoundId},getAtlas:function(){return this._atlas},setAttackPower:function(t){this._curAttackPower=t},getAttackPower:function(){return this._curAttackPower},getAttackEffectCfg:function(){return this._attackEffectCfg},getUpAttackBulletOffect:function(){return this._bulletUpOffect},getDownAttackBulletOffect:function(){return this._bulletDownOffect},getRightAttackBulletOffect:function(){return this._bulletRightOffect},getRightUpAttackBulletOffect:function(){return this._bulletRightUpOffect},getRightDownAttackBulletOffect:function(){return this._bulletRightDownOffect},getPveSkillModel:function(){return this._skillDataModel},getUpAttackPrefab:function(){return this._prefabAttackUp},getDownAttackPrefab:function(){return this._prefabAttackDown},getRightAttackPrefab:function(){return this._prefabAttackRight},getRightUpAttackPrefab:function(){return this._prefabAttackRightUp},getRightDownAttackPrefab:function(){return this._prefabAttackRightDown},setPosTag:function(t){this._posTag=t},getPosTag:function(){return this._posTag}});e.exports=u,cc._RF.pop()},{"../../../../TS/Hero/Manager/HeroManager":"HeroManager","../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager","../manager/PveDataHelper":"PveDataHelper",BulletModel:"BulletModel",PveCopyEnum:void 0,PveSkillModel:"PveSkillModel"}],PveHurtStaticsItem:[function(t,e,i){"use strict";cc._RF.push(e,"88882Gro15D/JciRJK/rGUG","PveHurtStaticsItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=t("../manager/PveDataHelper"),h=t("CommonIconWidget"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.skillIcon=null,e.labName=null,e.labHurtPer=null,e.progressBar=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.sid,a=(i.hurt,i.atkPer);this.progressBar.progress=a/100,this.labHurtPer.string=a+"%";var o=0-r.PveEnum.PVE_UI_SKILL_ID.IceRain,s=0-r.PveEnum.PVE_UI_SKILL_ID.Light;if(n!==o&&n!==s){this.skillIcon.active=!1,this.icon.active=!0;var l=d.default.getHeroModelBySid(n);l||(l=d.default.getPetModelBySid(n));var c=this.icon.getChildByName("iconItem");c||(c=r.GlobalFunction.createCommonIconWidget(36,l,!0),this.icon.addChild(c),c.name="iconItem",c.scale=.8);var u=c.getComponent(h);u.disableHeadTouch(),u.setData(l),this.labName.string=l.getName()}else{this.skillIcon.active=!0,this.icon.active=!1;var p=0-n;r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.JS_jiesuan,"JS_jineng_"+p,this.skillIcon),this.labName.string=r.Language["#pveSkil"+p]}},a([c(cc.Node)],e.prototype,"icon",void 0),a([c(cc.Node)],e.prototype,"skillIcon",void 0),a([c(cc.Label)],e.prototype,"labName",void 0),a([c(cc.Label)],e.prototype,"labHurtPer",void 0),a([c(cc.ProgressBar)],e.prototype,"progressBar",void 0),e=a([l,u("module/Pve/PveHurtStaticsItem")],e)}(o);i.default=p,cc._RF.pop()},{"../manager/PveDataHelper":"PveDataHelper",CommonIconWidget:"CommonIconWidget",ListItem:void 0}],PveHurtStaticsView:[function(t,e,i){"use strict";cc._RF.push(e,"dbfbafJsBpJ8aCwwx19RXk9","PveHurtStaticsView");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../manager/PveDataHelper"),o=window.td,s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=t("OptimizeVerticalListView"),h=t("PveFightManager"),p=t("PveCopyEnum"),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgHero=null,e.labTotalHurt=null,e}return n(e,t),e.prototype.onEnable=function(){this.initUI()},e.prototype.initUI=function(){var t,e,i=this.node.getComponent(d);o.PveCopyManager.getCopyType()===p.PVEFightType.DemonTreasureCopy?(t=o.PveCopyManager.getStatisticsBossDamage(),e=o.PveCopyManager.getBossTotalDamage()):(t=o.PveCopyManager.getHurtStatistics(),e=o.PveCopyManager.getTotalHurtStatistics());var n=h.getOnLineHeroSIds(),a=[],s=0-o.PveEnum.PVE_UI_SKILL_ID.IceRain;t[s]&&(a[a.length]={sid:s,hurt:t[s],atkPer:Math.floor(1e5*t[s]/e)/1e3});var l=0-o.PveEnum.PVE_UI_SKILL_ID.Light;t[l]&&(a[a.length]={sid:l,hurt:t[l],atkPer:Math.floor(1e5*t[l]/e)/1e3});for(var c=[],u=n.length-1;u>=0;u--){var _=t[v=n[u]]||0;c[c.length]={sid:v,hurt:_,atkPer:Math.floor(1e5*_/e)/1e3}}var g=[],f=r.default.getBattlePetModels();for(u=0;u<f.length;u++){var v;_=t[v=f[u].getSId()]||0;g[g.length]={sid:v,hurt:_,atkPer:Math.floor(1e5*_/e)/1e3}}c.sort(this.sortFunc),g.sort(this.sortFunc),i.setData(a.concat(c.concat(g))),this.labTotalHurt.string=o.Language.curTimeHurt+e},e.prototype.sortFunc=function(t,e){return t.atkPer!==e.atkPer?e.atkPer-t.atkPer:t.sid-e.sid},e.prototype.onClose=function(){this.node.removeFromParent(!0)},a([c(cc.Sprite)],e.prototype,"imgHero",void 0),a([c(cc.Label)],e.prototype,"labTotalHurt",void 0),e=a([l,u("module/Pve/PveHurtStaticsView")],e)}(cc.Component);i.default=_,cc._RF.pop()},{"../manager/PveDataHelper":"PveDataHelper",OptimizeVerticalListView:void 0,PveCopyEnum:void 0,PveFightManager:"PveFightManager"}],PveLoader:[function(t,e,i){"use strict";cc._RF.push(e,"365c5jIogFEEam8n9yvX7Gz","PveLoader");var n=r(t("../../../TS/Hero/Manager/HeroManager")),a=r(t("../pve/manager/PveDataHelper"));function r(t){return t&&t.__esModule?t:{default:t}}var o={getModules:function(t,e,i){var n=td.PveCopyManager.getGateId();t||td.TableManager.getTableClass(td.TableEnum.PveCreateEnemyTable).loadGateCfgById(n);var a=td.GuideManager.isFirstBattle(),r=["PveMap","PveHero","PvePet","PveEnemy","PveBullet","PveSkill","PveBoss",e?"PveHook":a?"PveFirstBattle":"Pve"];return a&&r.push("FirstBattleGuide"),this._loadHeroResources(),this._loadPetRes(),this._loadEnemyResources(),this._loadBulletResources(),gdk.ResourceId.getValue("PveSkill").PvePrefab.resArray=[],this._loadSkillResources(),this._loadUiSkillResources(),this._loadMapResources(),i>0&&this.loadBossResources(i),this.uniqModules(r)},_loadHeroResources:function(){var t=gdk.ResourceId.getValue("PveHero");if(t.Prefabs.resArray=[],td.GuideManager.isFirstBattle()){var e=gdk.ResourceId.getValue("PveHeroDelay");e.Prefabs.resArray=[];var i=n.default.getInstance().getGuideHeroList();for(var r in i){var o=i[r];0===t.Prefabs.resArray.length?this.setHeroRes(t,o):this.setHeroRes(e,o)}}else for(var s=a.default.getBattleHeroModels(),l=0;l<s.length;l++){var c=s[l];this.setHeroRes(t,c)}},setHeroRes:function(t,e){var i="PetModel"==e.clsName?e.getPveShowId():e.getRoleType(),n=td.TableManager.getTableClass(td.TableEnum.PveHeroFihgtShowTable).getPveHeroCfgById(i),a=n.resPath+"_1",r=n.idlePath;t.Prefabs.resArray.push(a),t.Prefabs.resArray.push(r)},_loadPetRes:function(){for(var t=gdk.ResourceId.getValue("PvePet"),e=a.default.getBattlePetModels(),i=0;i<e.length;i++){var n=e[i];this.setHeroRes(t,n)}},_loadEnemyResources:function(){var t=td.TableManager.getTableClass(td.TableEnum.PveEnemyTable),e=gdk.ResourceId.getValue("PveEnemy"),i=gdk.ResourceId.getValue("PveEnemyDelay");if(e.Prefabs.resArray=[],i.Prefabs.resArray=[],td.PveCopyManager.isHook())for(var n=td.GetConfig("HOOK_ENERMY_IDS"),a=0,r=n.length;a<r;a++){var o=t.getEnemyCfgDataById(n[a]).animationRes;0===a&&o&&!this._checkResIsExist(e.Prefabs.resArray,o)?e.Prefabs.resArray.push(o):o&&!this._checkResIsExist(i.Prefabs.resArray,o)&&i.Prefabs.resArray.push(o)}else for(var s=td.TableManager.getTableClass(td.TableEnum.PveCreateEnemyTable).getCurGateCfg(),l=0,c=s.length;l<c;l++){var u=s[l].enemyId;o=t.getEnemyCfgDataById(u).animationRes;0===l&&o&&!this._checkResIsExist(e.Prefabs.resArray,o)?e.Prefabs.resArray.push(o):o&&!this._checkResIsExist(i.Prefabs.resArray,o)&&i.Prefabs.resArray.push(o)}},loadBossResources:function(t){var e=gdk.ResourceId.getValue("PveBoss"),i=td.TableManager.getTableClass(td.TableEnum.PveEnemyTable).getEnemyCfgDataById(t);e.Prefabs.resArray=[],e.Prefabs.resArray.push(i.animationRes);var n=i.prefab_skill;this._checkResIsExist(e.Prefabs.resArray,n)||e.Prefabs.resArray.push(i.prefab_skill)},_loadBulletResources:function(){var t=gdk.ResourceId.getValue("PveBullet");td.GuideManager.isFirstBattle();t.Prefabs.resArray=[];gdk.ResourceId.getValue("PveHero");if(td.GuideManager.isFirstBattle()){var e=n.default.getInstance().getGuideHeroList(),i=gdk.ResourceId.getValue("PveBulletDelay");for(var r in i.Prefabs.resArray=[],e){if(!e.hasOwnProperty(r))return;var o=e[r].getRoleType(),s=td.TableManager.getTableClass(td.TableEnum.PveHeroFihgtShowTable).getPveHeroCfgById(o);0===t.Prefabs.resArray.length?(this.setBulletRes(t,s.pveBulletId),this.setBulletRes(t,s.inspireBulletId)):(this.setBulletRes(i,s.pveBulletId),this.setBulletRes(i,s.inspireBulletId))}}else{for(var l=a.default.getBattleHeroModels(),c=0;c<l.length;c++){o=l[c].getRoleType(),s=td.TableManager.getTableClass(td.TableEnum.PveHeroFihgtShowTable).getPveHeroCfgById(o);this.setBulletRes(t,s.pveBulletId),this.setBulletRes(t,s.inspireBulletId)}for(var u=a.default.getBattlePetModels(),d=0;d<u.length;d++){var h=u[d].getPveShowId(),p=td.TableManager.getTableClass(td.TableEnum.PveHeroFihgtShowTable).getPveHeroCfgById(h);this.setBulletRes(t,p.pveBulletId),this.setBulletRes(t,p.inspireBulletId)}}},setBulletRes:function(t,e){var i=td.TableManager.getTableClass(td.TableEnum.PveBulletTable).getBulletCfgDataById(e),n=i.effectArray;if(n[0]===td.PveEnum.RenderType.AnimationClip){var a=i.movePrefab;a&&!this._checkResIsExist(t.Prefabs.resArray,a)&&t.Prefabs.resArray.push(a)}if(n[1]===td.PveEnum.RenderType.AnimationClip){var r=i.attackPrefab;r&&!this._checkResIsExist(t.Prefabs.resArray,r)&&t.Prefabs.resArray.push(r)}},_loadMapResources:function(){var t=gdk.ResourceId.getValue("PveMap"),e=td.PveCopyManager.getCopyMapRes(),i=td.PveCopyManager.getCopyRoadRes();t.SpriteFrame.resArray=[],t.SpriteFrame.resArray.push(e),t.TiledMapAsset.resArray=[],t.TiledMapAsset.resArray.push(i),t.Prefabs.resArray=[];var n=td.PveCopyManager.getPveMapParticalName();n&&t.Prefabs.resArray.push(n)},_loadSkillResources:function(){var t=td.GuideManager.isFirstBattle(),e=gdk.ResourceId.getValue("PveSkill");e.PvePrefab.resArray=[];var i=t?n.default.getInstance().getGuideHeroList():n.default.getInstance().getHeroData();if(t){var r=gdk.ResourceId.getValue("PveSkillDelay");for(var o in r.PvePrefab.resArray=[],i){var s=i[o];0===e.PvePrefab.resArray.length?this._setSkillRes(s.getRoleType(),e):this._setSkillRes(s.getRoleType(),r)}}else{for(var l=a.default.getBattleHeroModels(),c=0;c<l.length;c++){var u=l[c].getRoleType();this._setSkillRes(u,e)}for(var d=a.default.getBattlePetModels(),h=0;h<d.length;h++){var p=d[h].getPveShowId();this._setSkillRes(p,e)}}},_setSkillRes:function(t,e){var i=td.TableManager.getTableClass(td.TableEnum.PveHeroFihgtShowTable).getPveHeroCfgById(t);if(i&&i.pveSkillId){var n=td.TableManager.getTableClass(td.TableEnum.PveSkillTable).getSkillCfgDataById(i.pveSkillId),a=n.prefab_top;a&&!this._checkResIsExist(e.PvePrefab.resArray,a)&&e.PvePrefab.resArray.push(a);var r=n.prefab_dimian;r&&!this._checkResIsExist(e.PvePrefab.resArray,r)&&e.PvePrefab.resArray.push(r);var o=n.underAttack;o&&!this._checkResIsExist(e.PvePrefab.resArray,o)&&e.PvePrefab.resArray.push(o)}},_loadUiSkillResources:function(){var t=td.PveEnum.PVE_UI_SKILL_ID,e=gdk.ResourceId.getValue("PveSkill");for(var i in t){var n=t[i];if(2002!==n&&(2003!=n||!td.GuideManager.isFirstBattle())){var a=td.TableManager.getTableClass(td.TableEnum.PveSkillTable).getSkillCfgDataById(n),r=a.atlas;r&&this._checkResIsExist(e.Atlas.resArray,r);var o=a.prefab_top;o&&!this._checkResIsExist(e.PvePrefab.resArray,o)&&e.PvePrefab.resArray.push(o)}}var s=td.BattleArrayManager.getPetLineupMap();for(var l in s){var c=s[l];c.getPveSkillRes()&&e.PvePrefab.resArray.push(c.getPveSkillRes())}},uniqModules:function(t){for(var e=[],i={},n=0,a=t.length;n<a;n++){var r=t[n];i[r]||(i[r]=!0,e.push(r))}return cc.log(e),e},_checkResIsExist:function(t,e){for(var i=!1,n=0,a=t.length;n<a;n++){t[n]===e&&(i=!0)}return i}};e.exports=o,cc._RF.pop()},{"../../../TS/Hero/Manager/HeroManager":"HeroManager","../pve/manager/PveDataHelper":"PveDataHelper"}],PveLoveConfigTable:[function(t,e,i){"use strict";cc._RF.push(e,"379f9nuPphA7ZF0/yxsiqJy","PveLoveConfigTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PveLoveConfigTable",properties:{_tblName:"pve_love_config",_loveConfigs:null},init:function(){this._loveConfigs={};for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];this._loveConfigs[n.id]=n}},getPVELoveConfigByLoveId:function(t){return this._loveConfigs[t]?this._loveConfigs[t]:null},getPVELoveConfigByRoleTypeList:function(t){var e=[];for(var i in this._loveConfigs)for(var n=this._loveConfigs[i],a=n.loveList,r=0,o=a.length;r<o;r++){for(var s=a[r],l=!1,c=0,u=t.length;c<u;c++)if(s===t[c]){l=!0;break}if(!l)break;l&&r===o-1&&e.push(n)}return e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PveLoveModel:[function(t,e,i){"use strict";cc._RF.push(e,"a7892wQMARNM5n6XNxmW2JB","PveLoveModel");var n=t("PveLoveSkillModel"),a=cc.Class({_id:null,_roleIdList:null,_loveSkillId:null,_loveSkillModel:null,init:function(t){this._id=t.id,this._roleIdList=t.loveList,this._loveSkillId=t.loveSkillId;var e=td.TableManager.getTableClass(td.TableEnum.PveLoveSkillTable).getPVELoveSkillCfgById(this._loveSkillId),i=new n;i.init(e),this._loveSkillModel=i},getId:function(){return this._id},getRoleIdList:function(){return this._roleIdList},getPveLoveSkillModel:function(){return this._loveSkillModel}});e.exports=a,cc._RF.pop()},{PveLoveSkillModel:"PveLoveSkillModel"}],PveLoveSkillModel:[function(t,e,i){"use strict";cc._RF.push(e,"b71b9iRRihBUZ0rSjpGzUTU","PveLoveSkillModel");var n=t("PveSkillModel"),a=cc.Class({_id:null,_skillType:null,_effectType:null,_loveRatio:null,_skillChance:null,_pveSkillId:null,_trigerInterval:null,_pveSkillModel:null,_atlas:null,_animationClip:null,init:function(t){this._id=t.id,this._skillType=t.skillType,this._effectType=t.effectType,this._loveRatio=t.hurtRatio||0;var e=t.oddsSkill||[];if(e.length>0){this._skillChance=e[0],this._pveSkillId=e[1],this._trigerInterval=e[2];var i=td.TableManager.getTableClass(td.TableEnum.PveSkillTable).getSkillCfgDataById(this._pveSkillId),a=new n;a.init(i),this._pveSkillModel=a}this._atlas=t.atlas?gdk.rm.getResByUrl(t.atlas,cc.SpriteAtlas):null,this._animationClip=t.aniClip?gdk.rm.getResByUrl(t.aniClip,cc.AnimationClip):null},getId:function(){return this._id},getLoveSkillType:function(){return this._skillType},getSkillEffectType:function(){return this._effectType},getLoveRatio:function(){return this._loveRatio},getPveSkillChance:function(){return this._skillChance||0},getPveSkillTrigerInterval:function(){return this._trigerInterval||0},getPveSkillDataModel:function(){return this._pveSkillModel},getAtlas:function(){return this._atlas},getAnimationClip:function(){return this._animationClip}});e.exports=a,cc._RF.pop()},{PveSkillModel:"PveSkillModel"}],PveLoveSkillTable:[function(t,e,i){"use strict";cc._RF.push(e,"f0c7aFy2IRKg4XaKDm+xGp9","PveLoveSkillTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PveLoveSkillTable",properties:{_tblName:"pve_love_skill_config",_pveLoveSkillData:null},init:function(){this._pveLoveSkillData={};for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];n.atlas="fightRes/pve/skill/pveLoveSkill/"+n.atlas,n.aniClip="fightRes/pve/skill/pveLoveSkill/"+n.aniClip,this._pveLoveSkillData[n.id]=n}},getPVELoveSkillCfgById:function(t){return this._pveLoveSkillData[t]?this._pveLoveSkillData[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PveMapLayer:[function(t,e,i){"use strict";cc._RF.push(e,"6b4a6GSjfBIcYkZJ82EH6/v","PveMapLayer");var n=t("PveMapManager"),a=t("PveBuildTowerManager"),r=cc.Class({extends:cc.Component,properties:{},onLoad:function(){},onDestroy:function(){},start:function(){this.initInfo()},initInfo:function(){var t=n.getImgMapRes();this.node.getChildByName("imgMapBg").getComponent(cc.Sprite).spriteFrame=t;var e=n.getTiledMapAsset(),i=this.node.getChildByName("tiledMap").getComponent(cc.TiledMap);i.tmxAsset=e,n.parseTiledMap(i),a.initTowers(),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_MAP_INIT_SUCCC)}});e.exports=r,cc._RF.pop()},{PveBuildTowerManager:"PveBuildTowerManager",PveMapManager:"PveMapManager"}],PveMapManager:[function(t,e,i){"use strict";cc._RF.push(e,"eb77fle57hKA5ZyjCzYqhks","PveMapManager");var n=t("CommonEnum"),a={_imgMapRes:null,_tiledMapAsset:null,_lines:null,_spawnPoints:null,_towerPoints:null,_protegePos:null,_bossPoints:null,_dirTips:null,init:function(){this._imgMapRes=gdk.rm.getResByUrl(td.PveCopyManager.getCopyMapRes(),cc.SpriteFrame),this._tiledMapAsset=gdk.rm.getResByUrl(td.PveCopyManager.getCopyRoadRes(),cc.TiledMapAsset)},onDestroy:function(){this._imgMapRes=null,this._tiledMapAsset=null,this._spawnPoints=null,this._lines=null,this._towerPoints=null,this._dirTips=null,this._bossPoints=null},parseTiledMap:function(t){this._lines=this._parseMapLines(t),this._spawnPoints=this._parseMapSpawnPoints(t),this._towerPoints=this._parseMapTowerPoints(t),this._protegePos=this._parseMapProtegePoint(t),this._dirTips=this._parseMapDirTipsPoint(t),this._bossPoints=this._parseMapBossPoint(t)},_parseMapDirTipsPoint:function(t){var e={},i=t.getObjectGroup("dirTips");if(i){for(var a=i.getObjects(),r=0;r<a.length;r++){var o=a[r],s=o.offset;e[o.name]={dir:parseInt(o.dir),pos:cc.v2(s.x,n.ScreenSize.height-s.y)}}return e}},_parseMapLines:function(t){for(var e={},i=t.getObjectGroup("roads").getObjects(),a=0;a<i.length;a++){for(var r=[],o=i[a],s=o.offset,l=o.name,c=o.polylinePoints,u=0;u<c.length;u++){var d={};d.x=parseFloat(c[u].x)+parseFloat(s.x),d.y=parseFloat(c[u].y)+parseFloat(n.ScreenSize.height-s.y),r.push(d),d}e[l]=r}return e},_parseMapSpawnPoints:function(t){var e={},i={},a=t.getObjectGroup("spawnPoints");if(a)for(var r=a.getObjects(),o=0;o<r.length;o++){var s=(d=r[o]).offset;i[d.name]=cc.v2(s.x,n.ScreenSize.height-s.y+15)}e.front=i;var l={},c=t.getObjectGroup("spawnPoints2");if(c){var u=c.getObjects();for(o=0;o<u.length;o++){var d;s=(d=u[o]).offset;l[d.name]=cc.v2(s.x,n.ScreenSize.height-s.y+15)}}return e.size=l,e},_parseMapTowerPoints:function(t){for(var e={},i=t.getObjectGroup("towers").getObjects(),a=0;a<i.length;a++){var r=i[a],o=r.offset;e[r.name]=cc.v2(o.x,n.ScreenSize.height-o.y+15)}return e},_parseMapProtegePoint:function(t){for(var e=null,i=t.getObjectGroup("protegePos").getObjects(),a=0;a<i.length;a++){var r=i[a],o=r.offset;r.name;e=cc.v2(o.x,n.ScreenSize.height-o.y+15)}return e},_parseMapBossPoint:function(t){var e={};if(t.getObjectGroup("bossPos")){for(var i=t.getObjectGroup("bossPos").getObjects(),a=0;a<i.length;a++){var r=i[a],o=r.offset;e[r.name]=cc.v2(o.x,n.ScreenSize.height-o.y+15)}return e}},getImgMapRes:function(){return this._imgMapRes},getTiledMapAsset:function(){return this._tiledMapAsset},getDirTips:function(){return this._dirTips},getLines:function(){return cc.instantiate(this._lines)},getSpawnPoints:function(){return cc.instantiate(this._spawnPoints)},getTowerPoints:function(){return cc.instantiate(this._towerPoints)},getProtegePos:function(){return this._protegePos},getBossPoints:function(){return this._bossPoints},calculateRoadsLength:function(t){for(var e=[],i=uf.utils.Math.distance,n=0;n<t.length;n++){for(var a=0,r=t[n],o=0;o<r.length-1;o++)a+=i(r[o],r[o+1]);e[n]=a}return e},calculateRoadLength:function(t){for(var e=0,i=0;i<t.length-1;i++)e+=this.distance(t[i],t[i+1]);return e},parallel:function(t,e){var i=this._parallelEveryLine(t,e);return this._linkLinesToOneRoad(i)},_parallelEveryLine:function(t,e){for(var i=Math.atan2(e.y-t[0].y,e.x-t[0].x)-Math.atan2(t[1].y-t[0].y,t[1].x-t[0].x),n=this.distance(e,t[0]),a=[],r=0;r<t.length-1;r++){var o=t[r],s=t[r+1],l=Math.atan2(s.y-o.y,s.x-o.x)+i,c=Math.cos(l)*n;Math.abs(c);var u=Math.sin(l)*n;Math.abs(u);var d=cc.v2(c,u);a.push([o.add(d),s.add(d)])}return a},_linkLinesToOneRoad:function(t){var e=[];if(1===t.length)return e.push(t[0][0]),e.push(t[0][1]),e;for(var i=0;i<t.length-1;i++){var n=t[i],a=t[i+1];0===i&&e.push(n[0]),e.push(td.GlobalFunction.getCrossPoint(n,a)),i===t.length-2&&e.push(a[1])}return e}};e.exports=a,cc._RF.pop()},{CommonEnum:void 0}],PveMonsterSpeakTable:[function(t,e,i){"use strict";cc._RF.push(e,"18985FINT1F6L88D9x6Finv","PveMonsterSpeakTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PveMonsterSpeakConfig",properties:{_tblName:"pve_monster_speak_config",_data:null},init:function(){this._data={};for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e],a=n.groupId,r=n.number;this._data[a]||(this._data[a]={}),this._data[a][r]=n}},getSpeakData:function(t,e){return this._data[t]?this._data[t][e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PveNodePoolManager:[function(t,e,i){"use strict";cc._RF.push(e,"63be6uJXfdIsrynLsKfq98X","PveNodePoolManager");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../Hero/Manager/HeroManager"));var a=t("PveHeroModel"),r={_enermyNodePoolMap:null,_bulletNodePoolMap:null,_enemyDieYouLingPool:null,_enemyBornAniamPool:null,_enemyAnimationPool:null,_towerSkillPool:null,_labHurtPool:null,_skillPool:null,_buffPool:null,_underAttackPool:null,_skillNamePrefabPool:null,_isInit:!1,init:function(){this._isInit||(this._isInit=!0,this._enermyNodePoolMap={},this._bulletNodePoolMap={},this._skillPool={},this._enemyDieYouLingPool=new cc.NodePool,this._enemyBornAniamPool=new cc.NodePool,this._buffPool={},this._underAttackPool={},this._enemyAnimationPool={},this._labHurtPool={},this._towerSkillPool={},this._skillNamePrefabPool=new cc.NodePool)},onDestroy:function(){this.destroyData()},destroyData:function(){for(var t in this._isInit=!1,this._underAttackPool){this._underAttackPool[t].clear()}for(var e in this._enermyNodePoolMap){this._enermyNodePoolMap[e].clear()}for(var i in this._enermyNodePoolMap={},this._bulletNodePoolMap){this._bulletNodePoolMap[i].clear()}for(var n in this._bulletNodePoolMap={},this._skillPool){(a=this._skillPool[n])&&a.clear()}for(var n in this._skillPool={},this._enemyAnimationPool){(a=this._enemyAnimationPool[n])&&a.clear()}for(var n in this._towerSkillPool){(a=this._towerSkillPool[n])&&a.clear()}for(var n in this._towerSkillPool={},this._labHurtPool){var a;(a=this._labHurtPool[n])&&a.clear()}this._labHurtPool={},this._enemyAnimationPool={},this._enemyDieYouLingPool&&this._enemyDieYouLingPool.clear(),this._enemyBornAniamPool&&this._enemyBornAniamPool.clear(),this._skillNamePrefabPool&&this._skillNamePrefabPool.clear()},printPoolInfo:function(){},getEnemyAnimationNode:function(t){if(this._enemyAnimationPool){var e=this._enemyAnimationPool[t];return e?e.get():null}},putEnmeyAniationNodeInPool:function(t,e){this._enemyAnimationPool[t]||(this._enemyAnimationPool[t]=new cc.NodePool);var i=this._enemyAnimationPool[t];i.size()>=80?e.destroy():i.put(e)},getEnemyInPool:function(t){if(this._enermyNodePoolMap){var e=this._enermyNodePoolMap[t];return e?e.get():null}},getEnemyPoolSize:function(t){if(!this._enermyNodePoolMap)return 0;var e=this._enermyNodePoolMap[t];return e&&e.size()||0},putEnemyToPool:function(t,e){this._enermyNodePoolMap[t]||(this._enermyNodePoolMap[t]=new cc.NodePool);var i=this._enermyNodePoolMap[t];i.size()>80||td.PveCopyManager.isHook()?e.destroy():i.put(e)},getBulletInPool:function(t){var e=this._bulletNodePoolMap[t];return e?e.get():null},putBulletToPool:function(t,e){this._bulletNodePoolMap[t]||(this._bulletNodePoolMap[t]=new cc.NodePool),this._bulletNodePoolMap[t].put(e)},putSkillInPoolWithId:function(t,e){this._skillPool[t]||(this._skillPool[t]=new cc.NodePool),this._skillPool[t].put(e)},getSkillInPoolById:function(t){var e=this._skillPool[t];return e&&0!==e.size()?e.get():null},getEnemyDieYouLing:function(){return this._enemyDieYouLingPool.get()},putEnemyDieYouLing:function(t){this._enemyDieYouLingPool.put(t)},getEnemyBornAnima:function(){return this._enemyBornAniamPool.get()},putEnemyBornAnima:function(t){this._enemyBornAniamPool.put(t)},putBuffInPoolWithType:function(t,e){this._buffPool[t]||(this._buffPool[t]=new cc.NodePool),this._buffPool[t].put(e)},getBuffInPoolByType:function(t){var e=this._buffPool[t];return e&&0!==e.size()?e.get():null},clearBuffPool:function(){for(var t in this._buffPool){var e=this._buffPool[t];e&&e.clear()}this._buffPool=null},putUnderAttack:function(t,e){this._underAttackPool[t]||(this._underAttackPool[t]=new cc.NodePool),this._underAttackPool[t].put(e)},getUnderAttakNode:function(t){var e=this._underAttackPool[t];return e&&0!==e.size()?e.get():null},putLabHurtInPool:function(t,e){this._labHurtPool[t]||(this._labHurtPool[t]=new cc.NodePool),this._labHurtPool[t].size()>=50?e.destroy():this._labHurtPool[t].put(e)},getLabHurtInPool:function(t){var e=this._labHurtPool[t];return e?e.get():null},putTowerSkillNode:function(t,e){this._towerSkillPool[t]||(this._towerSkillPool[t]=new cc.NodePool),this._towerSkillPool[t].put(e)},getTowerSkillNode:function(t){var e=this._towerSkillPool[t];return e&&0!==e.size()?e.get():null},getSkillNameNode:function(){return this._skillNamePrefabPool.get()},putSkillNameNode:function(t){this._skillNamePrefabPool.size()>7?t.destroy():this._skillNamePrefabPool.put(t)},preInitTowerSkillNode:function(){var t=td.TableManager.getTableClass(td.TableEnum.PveHeroFihgtShowTable),e=td.BattleArrayManager.getBattleArrayData();for(var i in e){if(!e.hasOwnProperty(i))return;var o=e[i],s=n.default.getInstance().getHeroBySId(o.getMercenarySId()),l=s.getRoleType(),c=s.getSId(),u=t.getPveHeroCfgById(l),d=new a;d.init(u,c,s);var h=d.getPveSkillModel(),p=h.getSkillPrefabTop(),_=h.getPrefabDimian(),g=h.getResType(),f="topName_"+d.getId()+"_"+h.getId(),v="dimianName_"+d.getId()+"_"+h.getId();switch(g){case td.PveEnum.PVE_SKILL_RES_TYPE.TOP:(m=cc.instantiate(p)).name=f,r.putTowerSkillNode(f,m);break;case td.PveEnum.PVE_SKILL_RES_TYPE.MIX:var m;(m=cc.instantiate(p)).name=f,r.putTowerSkillNode(f,m),(y=cc.instantiate(_)).name=v,r.putTowerSkillNode(v,y);break;case td.PveEnum.PVE_SKILL_RES_TYPE.GROUND:var y;(y=cc.instantiate(_)).name=v,r.putTowerSkillNode(v,y)}}}};e.exports=r,cc._RF.pop()},{"../../../Hero/Manager/HeroManager":"HeroManager",PveHeroModel:"PveHeroModel"}],PveOrdiraryTower:[function(t,e,i){"use strict";cc._RF.push(e,"d3f24bdFVJLqp7qBN3gnn3V","PveOrdiraryTower");var n=t("PveBaseTower"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t)}});e.exports=a,cc._RF.pop()},{PveBaseTower:"PveBaseTower"}],PvePetSkillUI:[function(t,e,i){"use strict";cc._RF.push(e,"920b8O8N6dMVpvtF111eFjP","PvePetSkillUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=t("PveSkillModel"),u=t("PveFightManager"),d=t("PveUiManager"),h=t("PveNodePoolManager"),p=(t("PveBuildTowerManager"),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgSkillIcon=null,e.imgCDMask=null,e.imgForbidden=null,e.labCDTime=null,e.imgMove=null,e._effectLayer=null,e._petModel=null,e._bPauseStatus=!1,e._skillId=0,e._skillDataModel=null,e._curCdTime=0,e._bSeletedStatus=!1,e._bClickEnabled=!1,e._isLimited=!1,e._curCommonCd=0,e.COMMON_CD_TIME=0,e._nMultSpeed=1,e._bMoveOut=!1,e}return n(e,t),e.prototype.onLoad=function(){this._addEventListener(),this._effectLayer=d.getEffectLayer()},e.prototype._addEventListener=function(){td.EventUtil.registerEvent(td.EventNameEnum.CREATE_UI_SKILL,this.onCreateUiSkillEvent,this),td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_UI_SKILL_STATUS,this.refreshUiSkillStatus,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_RESTART_FIGHT,this.resetSkillUiData,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_CHANGE_FIGHT_SPEED,this.onChangeFightSpeed,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE,this.onPause,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME,this.onResume,this),td.EventUtil.registerEvent(td.EventNameEnum.PET_COMMON_CD_REFRESH,this.onRefreshCommonCd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},e.prototype.onDestroy=function(){this._bSeletedStatus=null,this._bClickEnabled=null,this._bMoveOut=null,this.unschedule(this.onUpdateCdTime),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this),td.EventUtil.unregisterAllEvents(this)},e.prototype.setData=function(t,e){this.resetSkillUiData(),this._petModel=e,this._skillId=t;var i=td.TableManager.getTableClass(td.TableEnum.PveSkillTable).getSkillCfgDataById(this._skillId),n=new c;n.init(i),this._skillDataModel=n,this._nMultSpeed=u.getCurFightSpeedMult(),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"PVE_cw_"+this._petModel.getId(),this.imgSkillIcon)},e.prototype.resetSkillUiData=function(){this.imgMove=null,this._bMoveOut=!1,d.setSelectedSkill(0),this.unschedule(this.onUpdateCdTime),this.unschedule(this.updateCommonCdTime),this._isLimited=!1,this._curCdTime=0,this._curCommonCd=0,this.imgCDMask.getComponent(cc.Sprite).fillRange=1,this.imgCDMask.active=this._curCdTime>0,this.labCDTime.node.active=this._curCdTime>0,this.setSeletedStatus(!1),this.setClickEnabled(!0)},e.prototype._refreshImgs=function(){var t=this._curCdTime<=0,e=this._curCommonCd<=0;!this._bSeletedStatus&&!1===this._bClickEnabled&&t&&e?this.setClickEnabled(!0):t&&e||this.setClickEnabled(!1)},e.prototype.onUpdateCdTime=function(t){this._bPauseStatus||this._curCdTime<=0||(this._curCdTime-=t*this._nMultSpeed,this.labCDTime.node.active=this._curCdTime>0,this.labCDTime.string=Math.ceil(this._curCdTime)+"",this._refreshImgs(),this._curCdTime<=0&&(this._curCdTime=0,this.unschedule(this.onUpdateCdTime),this.imgCDMask.active=!1))},e.prototype.updateCommonCdTime=function(t){this._bPauseStatus||(this._curCommonCd<=0||(this._curCommonCd-=t*this._nMultSpeed,this.imgCDMask.active=this._curCommonCd>0,this.imgCDMask.getComponent(cc.Sprite).fillRange=this._curCommonCd/this.COMMON_CD_TIME,this._refreshImgs()))},e.prototype.setSeletedStatus=function(t){this._bSeletedStatus=t,this.imgForbidden.active=t,t&&d.setSelectedSkill(this._skillId)},e.prototype.setClickEnabled=function(t){this._bClickEnabled=t,this.imgForbidden.active=!t,td.GlobalFunction.graySprite(this.node,!this._bClickEnabled),td.GlobalFunction.graySprite(this.imgSkillIcon,!this._bClickEnabled)},e.prototype.refreshUiSkillStatus=function(t){if(t.skillId===this._skillId){var e=1===t.skillStatus;this.setSeletedStatus(e)}this._refreshImgs()},e.prototype.refreshCdTime=function(t){if(t===this._skillId){this.setSeletedStatus(!1),this._bMoveOut=!1,this._curCdTime=this._skillDataModel.getCDTime(),this.imgForbidden.active=!1,this.imgCDMask.active=!0;var e=u.getCurFightSpeedMult();this.labCDTime.string=Math.ceil(this._curCdTime)+"",this.labCDTime.node.active=this._curCdTime>0,this.schedule(this.onUpdateCdTime,1/e)}},e.prototype.onTouchMove=function(t){var e=u.getFightStatus();if(this._bClickEnabled&&e===td.PveEnum.PVE_FIGHT_STATUS.FIHGT){var i=t.target,n=t.touch.getLocation(),a=i.getBoundingBox(),r=i.getParent().getParent().convertToNodeSpaceAR(n);a.contains(r)||(this._bMoveOut=!0,this.setSkillImagePos(r))}},e.prototype.onTouchEnd=function(t){if(this._bMoveOut&&this.imgMove)return this.imgMove.destroy(),this.imgMove=null,void(this._bMoveOut=!1);if(this._bSeletedStatus&&this._curCdTime<=0)this.resetSkillUiData();else{var e=u.getFightStatus();this._bClickEnabled&&e===td.PveEnum.PVE_FIGHT_STATUS.FIHGT&&(this.setClickEnabled(!1),this.setSeletedStatus(!0))}},e.prototype.onTouchCancel=function(t){var e=u.getFightStatus();if(this._bMoveOut=!1,this._bClickEnabled&&e===td.PveEnum.PVE_FIGHT_STATUS.FIHGT){var i=t.touch.getLocation(),n=t.target.getParent().getParent(),a=n.convertToNodeSpaceAR(i);if(!n.getBoundingBox().contains(a)&&this.imgMove)return this.imgMove.destroy(),void(this.imgMove=null);this.createSkill(a)}},e.prototype.setSkillImagePos=function(t){this.imgMove||(this.imgMove=cc.instantiate(this.node.getChildByName("imgMove")),this.imgMove.active=!0,this._effectLayer.addChild(this.imgMove)),this.imgMove.setPosition(t)},e.prototype.createSkill=function(t){cc.log(cc.js.formatStr("create skill now!!!,x=%s,y=%s",t.x,t.y)),this.imgMove&&(this.imgMove.destroy(),this.imgMove=null),this.onCreateUiSkillEvent({pos:t,skillId:this._skillId})},e.prototype.onCreateUiSkillEvent=function(t){if(this._skillId==t.skillId){this.setClickEnabled(!1),this.refreshCdTime(this._skillId);var e=this._skillDataModel.getSkillPrefab(),i=t.pos;(function(t){var e=h.getSkillInPoolById(this._skillId),n=null;if(e)n=e.getComponent("CommonSkill");else{if(!(e=cc.instantiate(t)))return;n=e.addComponent("CommonSkill")}var a={skillDataModel:this._skillDataModel,petSid:this._petModel.getSId(),baseAttackPower:this._petModel.getBaseAttackPower(),vocation:this._petModel.getFeatures(),hurtType:td.PveEnum.getVocationHurtType(this._petModel.getFeatures())};n.initData(a),e.setPosition(i),this._effectLayer.addChild(e),d.setSelectedSkill(0),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_UI_SKILL_STATUS,{skillId:this._skillId,skillStatus:0}),d.setUiSkillReleaseStatus(this._skillId,!0)}).bind(this)(e);var n=td.GetConfig("PET_COMMON_CD_TIME");td.EventUtil.dispatchEvent(td.EventNameEnum.PET_COMMON_CD_REFRESH,n)}},e.prototype.onChangeFightSpeed=function(t){this._nMultSpeed=t},e.prototype.onPause=function(){this._bPauseStatus=!0},e.prototype.onResume=function(){this._bPauseStatus=!1},e.prototype.onRefreshCommonCd=function(t){this.COMMON_CD_TIME=t,this._curCommonCd=t,this.imgCDMask.getComponent(cc.Sprite).fillRange=this._curCommonCd/this.COMMON_CD_TIME,this.unschedule(this.updateCommonCdTime),this.schedule(this.updateCommonCdTime,0)},a([s(cc.Node)],e.prototype,"imgSkillIcon",void 0),a([s(cc.Node)],e.prototype,"imgCDMask",void 0),a([s(cc.Node)],e.prototype,"imgForbidden",void 0),a([s(cc.Label)],e.prototype,"labCDTime",void 0),e=a([o,l("module/Pve/PvePetSkillUI")],e)}(cc.Component));i.default=p,cc._RF.pop()},{PveBuildTowerManager:"PveBuildTowerManager",PveFightManager:"PveFightManager",PveNodePoolManager:"PveNodePoolManager",PveSkillModel:"PveSkillModel",PveUiManager:"PveUiManager"}],PvePlatform:[function(t,e,i){"use strict";cc._RF.push(e,"e3597awx+1N/7Bsz6rRHXWd","PvePlatform");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgBg=null,e.imgProfession=null,e.imgDizuo=null,e.imgDizu2=null,e}return n(e,t),e.prototype.onLoad=function(){this.imgBg.active=!1,this.imgProfession.active=!1,this.imgDizu2.active=!td.PveCopyManager.isHook(),this.imgDizuo.active=td.PveCopyManager.isHook()},e.prototype.onEnable=function(){this._addListener()},e.prototype.onDisable=function(){this._removeListeners()},e.prototype._addListener=function(){td.EventUtil.registerEvent(td.EventNameEnum.ON_BUILD_TOWER,this.onBuildTower,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_UNBUILD_TOWER,this.onUnBuildTower,this)},e.prototype._removeListeners=function(){td.EventUtil.unregisterAllEvents(this)},e.prototype.onBuildTower=function(t){if(t.tag===this.node._tag){var e=t.heroDataModel.getMercenaryDataModel(),i=e.getQuality(),n=e.getFeatures();this._quality=i,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"GY_PVEtaizi_zhiye_0"+n,this.imgProfession),this.imgProfession.active=!0,this.imgProfession.zIndex=10,gdk.rm.loadRes(td.GlobalFunction.getResIdByNode(this.node),"fightRes/pve/otherAnimation/FaZhen/FaZhen",cc.Prefab,this._addFazhen.bind(this))}},e.prototype._addFazhen=function(){if(cc.isValid(this.node)){var t=this.node.getChildByName("FaZhen");t||((t=cc.instantiate(gdk.rm.getResByUrl("fightRes/pve/otherAnimation/FaZhen/FaZhen",cc.Prefab))).y=-12,t.name="FaZhen",this.node.addChild(t)),t.active=!0,t.getComponent(cc.Animation).play("FaZhen_"+this._quality)}},e.prototype.onUnBuildTower=function(t){if(t.posTag===this.node._tag){var e=this.node.getChildByName("FaZhen");this.imgBg.active=!1,this.imgProfession.active=!1,e&&(e.active=!1)}},a([s(cc.Node)],e.prototype,"imgBg",void 0),a([s(cc.Node)],e.prototype,"imgProfession",void 0),a([s(cc.Node)],e.prototype,"imgDizuo",void 0),a([s(cc.Node)],e.prototype,"imgDizu2",void 0),e=a([o,l("module/Pve/PvePlatform")],e)}(cc.Component);i.default=c,cc._RF.pop()},{}],PvePopLayer:[function(t,e,i){"use strict";cc._RF.push(e,"45979ak8etLmYt1p+gDD866","PvePopLayer");var n=t("PveUiManager"),a=t("PveFightManager"),r=(t("PveCopyEnum"),t("PveFightResultPanel")),o=t("AnimationComponent"),s=cc.Class({extends:cc.Component,properties:{_imgMask:null,_bNeedHide:null,_heroDetailNode:null,_curHeroData:null,_enemyDetailPanel:null,_tipItem:null,_btnRestartFight:null,_btnResume:null,_btnSelecteGate:null},onEnable:function(){this._curHeroData=null,this._bNeedHide=!0,this._imgMask=this.node.getChildByName("imgMask"),this._imgMask.active=!1,this._heroDetailNode=n.getHeroDetailPrefab(),this._heroDetailNode.active=!1,this.node.addChild(this._heroDetailNode),this._btnResume=this.node.getChildByName("btnResume"),this._btnRestartFight=this.node.getChildByName("btnRestart"),this._btnSelecteGate=this.node.getChildByName("btnSelectGate"),this._btnResume.active=!1,this._btnRestartFight.active=!1,this._btnSelecteGate.active=!1,this._tipItem=this.node.getChildByName("tipNode"),this._tipItem.active=!1,this._bBuildingTower=!1,this.addClickListeners(),this.addCustomListener()},addClickListeners:function(){this._imgMask.on(cc.Node.EventType.TOUCH_END,this.hideLayer,this),this._heroDetailNode.on(cc.Node.EventType.TOUCH_END,this.hideLayer,this);var t=this._heroDetailNode.getChildByName("btnRemove").getComponent(cc.Button);t.clickEvents=[];var e=new cc.Component.EventHandler;e.target=this.node,e.component="PvePopLayer",e.handler="removeTower",t.clickEvents.push(e)},addCustomListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.SHOW_HETO_DETAIL,this.showHeroDetail,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_BEGIN,this.beginFight,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE,this.onFightPause,this),td.EventUtil.registerEvent(td.EventNameEnum.SHOW_PVE_FIGHT_RESULT_VIEW,this.showFightResultPanel,this),td.EventUtil.registerEvent(td.EventNameEnum.SHOW_ENEMY_DETAIL,this.showEnemyDetailPanel,this),td.EventUtil.registerEvent(td.EventNameEnum.HIDE_ENEMY_DETAIL,this.hideEnemyDetailPanel,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_SHOW_TIP_MESSAGE,this.showTipMessage,this),td.EventUtil.registerEvent(td.EventNameEnum.GUIDE_PVE_PLAY_START_ANIMA,this._playStartAnima,this)},removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},onDisable:function(){this.removeListeners()},hideLayer:function(){this._bNeedHide&&(this._imgMask.active=!1,this._imgMask.opacity=180,this._heroDetailNode&&(this._heroDetailNode.active=!1),this._btnResume.active=!1,this._btnRestartFight.active=!1,this._btnSelecteGate.active=!1,this._enemyDetailPanel&&(this._enemyDetailPanel.active=!1),this._heroDetailNode.getChildByName("btnRemove").setScale(1))},beginFight:function(){if(td.PveCopyManager.isHook())return a.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.FIHGT),void td.EventUtil.dispatchEvent(td.EventNameEnum.BEGIN_CREATE_ENEMY);!this._bBuildingTower&&this._playStartAnima()},_playStartAnima:function(){a.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.FIHGT);var t=gdk.rm.getResByUrl(td.resDef.KaiShiZhanDou_Effect,cc.Prefab),e=cc.instantiate(t);e.setPosition(cc.v2(this.node.width/2,this.node.height/2)),this.node.addChild(e,99),e.addComponent(o).setFinishAnimationCallBack(function(){e.removeFromParent(),td.EventUtil.dispatchEvent(td.EventNameEnum.BEGIN_CREATE_ENEMY)}),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.START_GAME)},showHeroDetail:function(t){if(!td.GuideManager.isFirstBattle()){this._curHeroData=t,this._imgMask.active=!0,this._imgMask.opacity=0,this._heroDetailNode.active=!0;var e=t.pos,i=t.heroDataModel,n=a.getFightStatus();this._heroDetailNode.setPosition(e);var r=this._heroDetailNode.getChildByName("labHeroName");r.getComponent(cc.Label).string=i.getName(),td.GlobalFunction.setNameColors(r,i.getStar()),this._heroDetailNode.getChildByName("lanFightPower").getComponent(cc.Label).string=i.getAttackPower();var o=i.getAttackRange(),s=this._heroDetailNode.getChildByName("imgOutCircle"),l=s.width/2,c=parseFloat((o/l).toFixed(2));s.setScale(c);var u=this._heroDetailNode.getChildByName("imgFeature"),d=this._heroDetailNode.getChildByName("imgPhysicalOrMagic"),h=this._heroDetailNode.getChildByName("imgSkill"),p=this._heroDetailNode.getChildByName("lablSkillOrMagic"),_=this._heroDetailNode.getChildByName("lablSkill");this._heroDetailNode.getChildByName("btnRemove").active=n===td.PveEnum.PVE_FIGHT_STATUS.READY;var g=i.getFeatures(),f=td.PveEnum.getVocationHurtType(g);td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_zhiye_0"+g,u),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,f===td.PveEnum.PVE_HURT_TYPE.Physical?"PVE_attack_type_01":"PVE_attack_type_02",d),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVE_zhandou,"PVE_jineng_0"+g,h),p.getComponent(cc.Label).string=td.Language["vacation_attack_type_"+f],_.getComponent(cc.Label).string=td.Language["pve_vacation_skill_"+g]}},removeTower:function(){var t={posTag:this._curHeroData.posTag,heroDataModel:this._curHeroData.heroDataModel};td.EventUtil.dispatchEvent(td.EventNameEnum.DESTROY_TOWER,this._curHeroData.selfTag),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_UNBUILD_TOWER,t),this.hideLayer()},onFightPause:function(){var t=td.GuideManager.isFirstBattle(),e=td.GuideManager.isPveLightSkillGuide();t||td.PveCopyManager.isHook()||e||(this._bNeedHide=!1,this._imgMask.active=!0,this._btnResume.active=!0,this._btnRestartFight.active=!0,this._btnSelecteGate.active=!0)},restartFight:function(){this._bNeedHide=!0,this.hideLayer(),a.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.FIHGT?(td.PveCopyManager.clearBossDamage(),a.setFightStatus(td.PveEnum.PVE_FIGHT_STATUS.READY),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_RESTART_FIGHT)):cc.log("The battle has not yet begun to exchange fire!")},resumeFight:function(){this._bNeedHide=!0,this.hideLayer(),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME,!1)},onWithdraw:function(){this._bNeedHide=!0,td.PveCopyManager.prepareHookData(),td.PanelManager.getInstance().getCurShowPanel().closeCallFunc()},returnToGatePanel:function(){td.PveCopyManager.prepareHookData(),td.PanelManager.getInstance().getCurShowPanel().closeCallFunc()},showFightResultPanel:function(t){this._imgMask.active=!1;var e=t.data,i=(t.isDelay,n.getFightResultPanelPrefab());cc.isValid(i)?(i.active=!0,i.getComponent(r).initData(e),this.node.addChild(i)):this.returnToGatePanel()},showEnemyDetailPanel:function(){if(this._bNeedHide=!1,this._imgMask.active=!0,this._imgMask.opacity=180,!cc.isValid(this._enemyDetailPanel)){var t=gdk.rm.getResByUrl("prefab/Pve/EnemyDetailPanel",cc.Prefab);this._enemyDetailPanel=cc.instantiate(t),this._enemyDetailPanel.setPosition(cc.v2(this.node.width/2,this.node.height/2)),this.node.addChild(this._enemyDetailPanel,9)}this._enemyDetailPanel.active=!0,this._enemyDetailPanel.getComponent("PveEnemyDetail").setEnemyDetail()},hideEnemyDetailPanel:function(){this._bNeedHide=!0,this.hideLayer()},showTipMessage:function(t){if(t){var e=cc.instantiate(this._tipItem);e.active=!0,e.setPosition(cc.v2(this.node.width/2,this.node.height/2)),this.node.addChild(e,99),e.getComponent("ShowTipMessage").setTipMessage(t)}}});e.exports=s,cc._RF.pop()},{AnimationComponent:void 0,PveCopyEnum:void 0,PveFightManager:"PveFightManager",PveFightResultPanel:"PveFightResultPanel",PveUiManager:"PveUiManager"}],PveSkillModel:[function(t,e,i){"use strict";var n;cc._RF.push(e,"8aca8WuGLFE4Jzp94dh37Kv","PveSkillModel");t("PveLoader");var a=cc.Class(((n={_skillId:null,_skillType:null,_skillName:null,_des:null,_icon:null,_res:null,_nameRes:null,_damageRange:null,_continueTime:null,_attackEffect:null,_skillPower:null,_trigger:null,_cdTime:null,_sound:null,_atlas:null,_prefabTop:null,_skillAnimation:null,_releaseSound:null,_prefabDimian:null,_extraAnimation:null,_skillNamePic:null,_scaleX:null,_underAttack:null,_monsterDeadEffect:null,_hurtCount:null,init:function(t){this._skillId=t.id,this._skillType=t.type,this._skillName=t.name||"",this._res=t.res,this._nameRes=t.nameRes||null,this._icon=t.icon||null,this._damageRange=t.damageRange,this._continueTime=t.continueTime,this._attackEffect=t.attackEffect||[],this._skillPower=t.power&&"number"==typeof t.power?t.power/1e4:0,this._trigger=t.trigger,this._cdTime=t.CD,this._sound=t.sound||0,this._scaleX=t.scaleX||0,t.prefab_top&&(this._prefabTop=t.prefab_top),this._skillName=t.name,this._des=t.des,this._skillNamePic=t.skillNamePic,this._releaseSound=t.skillNameSound||0,this._underAttack=t.underAttack,this._monsterDeadEffect=t.monsterDeadEffect||[],this._hurtCount=t.hurtCount||1,this._resType=t.resType,t.prefab_dimian&&(this._prefabDimian=t.prefab_dimian)},getResType:function(){return this._resType},getUnderAttackPrefab:function(){return this._underAttack},getMonsterDeadEffect:function(){return this._monsterDeadEffect},getHurtCount:function(){return this._hurtCount},needScaleX:function(){return 1===this._scaleX},getSoundId:function(){return this._sound},getId:function(){return this._skillId},getType:function(){return this._skillType},getName:function(){return this._skillName},getSkillNamePic:function(){return this._skillNamePic},getDescription:function(){return this._des},getRes:function(){return this._res},getDamageRange:function(){return this._damageRange},getContinueTime:function(){return this._continueTime},getAttackEffect:function(){return this._attackEffect},getSkillPower:function(){return this._skillPower},getTriggerCfg:function(){return this._trigger},getCDTime:function(){return this._cdTime},getAtlas:function(){return this._atlas},setSkillReleaseStatus:function(t){this._isReleased=t},getSkillReleaseStatus:function(){return this._isReleased},getSkillPrefab:function(){return gdk.rm.getResByUrl(this._prefabTop,cc.Prefab)},getSkillPrefabTop:function(){return gdk.rm.getResByUrl(this._prefabTop,cc.Prefab)},getIconRes:function(){return this._icon},getPrefabDimian:function(){return gdk.rm.getResByUrl(this._prefabDimian,cc.Prefab)},getSkillNameRes:function(){return this._nameRes}}).getSoundId=function(){return this._sound},n.getReleaseSound=function(){return this._releaseSound},n));e.exports=a,cc._RF.pop()},{PveLoader:"PveLoader"}],PveSkillTable:[function(t,e,i){"use strict";cc._RF.push(e,"6e42bSP/khIS7gcqYun4+6d","PveSkillTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"PveSkillTable",properties:{_tblName:"pve_skill_config",_skillData:null},init:function(){this._skillData={};this._skillData;for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];n.resPath="fightRes/pve/skill/"+n.res+"/",n.resTopGround&&(n.prefab_top=n.resPath+n.resTopGround),n.resBackGround&&(n.prefab_dimian=n.resPath+n.resBackGround),n.underAttack="fightRes/pve/PVE-underAttack/"+n.underAttack;for(var a=n.monsterDeadEffect,r=a.length-1;r>=0;r--)a[r][2]=a[r][2]/1e3,a[r][3]=a[r][3]/1e3;n.monsterDeadEffect=a,this._skillData[n.id]=n}},getSkillCfgDataById:function(t){return this._skillData[t]?this._skillData[t]:(cc.log(cc.js.formatStr("the skill is not exist! (id = %s)",t)),null)}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],PveUiLayer:[function(t,e,i){"use strict";cc._RF.push(e,"7fb1ekTBv9CzZN5puO42/e6","PveUiLayer");var n,a=u(t("./GoldItem")),r=u(t("../../../EightDiagrams/Manager/EightDiagramsManager")),o=u(t("./skill/pveUiSkill/PvePetSkillUI")),s=u(t("./EDUILayer")),l=u(t("../manager/PveDataHelper")),c=u(t("../../../Chess/Manager/ChessManager"));function u(t){return t&&t.__esModule?t:{default:t}}var d=t("PveFightManager"),h=t("PveUiManager"),p=t("PveBuildTowerManager"),_=(t("ChooseHeroWindow"),t("PveCopyEnum")),g=t("PveNodePoolManager"),f=(t("PveMapManager"),t("CommonEnum"),cc.Class({extends:cc.Component,properties:(n={_btnChangeSpeed:null,_btnPause:null,_btnStartFight:null,_btnOneKeyEmbattle:null,_bossHurtNode:null,_btnReturn:null,_angerPanel:null,_iceRainSkillUI:null,_inspireSkillUI:null,_lightSkillUI:null,_imgNotice:null,_uiAtlas:null,_collectTimecount:0,_collectUnit:5,_totalHurtNode:null,_nTotalHurt:0,_fightLayer:null,_goldItemsLayer:null,_btnEDCondition:null,_edConditionLayer:null,_dropChance:0,_labLeftEnermyCount:null,_hookSceneTipsDatas:null,_hookSceneTipsTimeCount:null,_enemyFireClickCount:0,_showStartFingerCount:0,_timeNode:null},n._bossHurtNode=null,n.labelTimeCount=cc.Label,n.labelBossTotalHurt=cc.Label,n._bBuildingTower=!1,n.nodePetSkills=cc.Node,n.nodePetSkillModel=cc.Node,n.labChessInfo=cc.Label,n),onLoad:function(){var t=this.node.getChildByName("PveNode"),e=this.node.getChildByName("HookNode");this.pveNode=t,this.hookNode=e,this.hookNode.getChildByName("btnHookReward").getComponent(cc.Button).soundId=0,this.pveNode.getChildByName("debugAdmin").active=!1,this._btnChangeSpeed=t.getChildByName("btnChangeSpeed"),this._btnPause=t.getChildByName("btnPause"),this._btnStartFight=t.getChildByName("btnStartFight"),this._btnOneKeyEmbattle=t.getChildByName("btnOneKeyEmbattle"),this._totalHurtNode=t.getChildByName("totalHurt"),this._bossHurtNode=t.getChildByName("bossHurtNode"),this._labLeftEnermyCount=t.getChildByName("labEnermyCount");var i=t.getChildByName("PVE_sydi");this._timeNode=t.getChildByName("timeNode"),this._timeNode.active=!1,this._totalHurtNode.active=!1,this._btnReturn=t.getChildByName("btnReturn"),this._ancientNode=t.getChildByName("ancientNode"),this._ancientNode.active=!1,this._angerPanel=t.getChildByName("angerPanel"),this._iceRainSkillUI=t.getChildByName("skillIceRain"),this._inspireSkillUI=t.getChildByName("skillInspire"),this._lightSkillUI=t.getChildByName("skillLight"),t.getChildByName("lightSkillLayer").active=!1,this._imgNotice=t.getChildByName("imgNotice"),this._imgNotice.active=!1;var n=t.getChildByName("btnEnemyInfo"),a=td.GuideManager.isFirstBattle();this._inspireSkillUI.active=!a,this._iceRainSkillUI.active=!a,this._lightSkillUI.active=!a,this._btnChangeSpeed.active=!a,this._btnPause.active=!a,this._btnOneKeyEmbattle.active=!a,this._btnReturn.active=!a,this.nodePetSkills.active=!a;var r=!a&&td.PveCopyManager.getCopyType()!==_.PVEFightType.DemonTreasureCopy&&td.PveCopyManager.getCopyType()!==_.PVEFightType.AncientCorridor&&td.PveCopyManager.getCopyType()!==_.PVEFightType.Dipper;n.active=r,this._labLeftEnermyCount.active=r,i.active=r,this._bossHurtNode.active=!1,this._collectUnit=td.GetConfig("HOOK_UP_REWARD_COLLECT_INTERVALE"),this._uiAtlas=gdk.rm.getResByUrl("UI/Fight/pve/PveUI",cc.SpriteAtlas),this._initPetSkillUI();var o=td.PveCopyManager.getCopyType()===_.PVEFightType.CHESS;this.labChessInfo.node.active=o,o&&this._refreshChessUI();var l=td.PveCopyManager.getCopyType()===_.PVEFightType.EightDiagrams;if(l){var c=t.getChildByName("nodeEightDiagrams");c.active=l,s.default.showNode(c,l)}this.addCustomListener(),this.refreshSkillPowerProgress(),a||this.setSpeed(),this._fightLayer=h.getFightLayer();var u=new cc.Node;u.width=this._fightLayer.width,u.height=this._fightLayer.height,u.anchorX=0,u.anchorY=0,this._fightLayer.addChild(u,-10),this._goldItemsLayer=u,this._bBuildingTower=!1},onEnable:function(){cc.log("PveUILayer onEnable "+(new Date).getTime()),this._initUI(),this.refresLeftEnemyNum(),this._hideTimesNode(),td.PveCopyManager.isHook()||td.GuideManager.isFirstBattle()||this.schedule(this.checkShowStartFinger,1)},onDisable:function(){this.unschedule(this.checkShowStartFinger),this.unschedule(this.updateTimecount)},_initPetSkillUI:function(){for(var t=l.default.getBattlePetModels(),e=0;e<t.length;e++){var i=t[e],n=i.getPveSkillId(),a=this.nodePetSkills.getChildByName("petSkill"+e);a||((a=cc.instantiate(this.nodePetSkillModel)).parent=this.nodePetSkills,a.name="petSkill"+e,a.active=!0,a.x=0),a.getComponent(o.default).setData(n,i)}},checkShowStartFinger:function(){p.hasTowerBuilt()?(this._showStartFingerCount++,5===this._showStartFingerCount&&(gdk.rm.loadRes(td.GlobalFunction.getResIdByNode(this.node),"uiAnima/Finger/Finger",cc.Prefab,this._addStartFingerAnima.bind(this)),this.unschedule(this.checkShowStartFinger),this._showStartFingerCount=0)):this._showStartFingerCount=0},_addStartFingerAnima:function(){var t=this._btnStartFight.getChildByName("Finger");if(!t){var e=gdk.rm.getResByUrl("uiAnima/Finger/Finger",cc.Prefab);(t=cc.instantiate(e)).name="Finger",this._btnStartFight.addChild(t)}t.active=!0},addCustomListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_SKILL_POWER_PROGRESS,this.refreshSkillPowerProgress,this),td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_UI_LAYER_SHOW,this.refreshUiChildNodeShowStatus,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_FIGHT_NOTICE,this.playNoticeAction,this),td.EventUtil.registerEvent(td.EventNameEnum.GUIDE_SHOW_INPIRE_UI_SKILL,this.setInpireShowStatus,this),td.EventUtil.registerEvent(td.EventNameEnum.GUIDE_SHOW_STORM_UI_SKILL,this.setStormShowStatus,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_ENERMY_DIE,this._onEnermyDie,this),td.EventUtil.registerEvent(td.EventNameEnum.RES_GET_HOOKUP_INFO,this._refreshHookRewardBox,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_SKILL_HURT_STATICS,this._skillHurtStatic,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_SKILL_HURT_STATICS_END,this._skillHurtStaticEnd,this),td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_ENEMY_NUM,this.refresLeftEnemyNum,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_SHOW_BORN_ANIM,this._showBornAnima,this),td.EventUtil.registerEvent(td.EventNameEnum.SHOW_PVE_DEBUG_ADMIN,this.showDebugAdmin,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_RESTART_FIGHT,this._onRestartGame,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_HIDE_TIMES_NODE,this._hideTimesNode,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE,this.onGamePause,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME,this.onGameResume,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_BUILD_TOWER,this._onBuildTower,this),td.EventUtil.registerEvent(td.EventNameEnum.BUILD_TOWER_IN_LAYER,this._onBuildTowerFinished,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_UNBUILD_TOWER,this._refreshChessUI,this),td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_LEFT_ENEMEY_COUNT,this._refreshLeftEnemeyCount,this),td.EventUtil.registerEvent(td.EventNameEnum.ALL_DATA_LOADED,this._onReconnect,this)},onGamePause:function(){this._bFightPause=!0;var t=this.pveNode.getChildByName("TimesNode");t&&(t.active=!1)},onGameResume:function(){this._bFightPause=!1},removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},onDestroy:function(){this._btnChangeSpeed=null,this._btnPause=null,this._btnStartFight=null,this._btnOneKeyEmbattle=null,this.removeListeners(),this.unschedule(this.onUpdate)},_onRestartGame:function(){this._hideTimesNode(),this._bossHurtNode.active=!1,this._timeNode.active=!1,this._ancientNode.active=!1,td.PveCopyManager.setBossTotalDamage(0);var t=this._btnStartFight.getChildByName("Finger");t&&(t.active=!1);var e=td.PveCopyManager.getCopyType()===_.PVEFightType.EightDiagrams;if(e){var i=this.node.getChildByName("PveNode").getChildByName("nodeEightDiagrams");i.active=e,s.default.showNode(i,e)}td.PveCopyManager.getCopyType()===_.PVEFightType.EightDiagrams&&r.default.getInstance().resetLimits(),td.PveCopyManager.getCopyType()===_.PVEFightType.CHESS&&this._refreshChessUI(),td.PveCopyManager.isHook()||this.schedule(this.checkShowStartFinger,1)},_hideTimesNode:function(){this.pveNode.getChildByName("TimesNode").active=!1},_initUI:function(){var t=td.PveCopyManager.isHook();this.pveNode.active=!t,this.hookNode.active=t,t&&this._initHookInfo()},_initHookInfo:function(){this._refreshHookRewardBox(),this.schedule(this.onUpdate.bind(this),4)},onUpdate:function(t){this._refreshHookRewardBox(),this._checkHookSceneTips(t)},_checkHookSceneTips:function(t){if(null!==this._hookSceneTipsTimeCount){this._hookSceneTipsTimeCount-=t,this._hookSceneTipsTimeCount<=0&&(this._hookSceneTipsTimeCount=this._getNextSpeakTimecount(),this._hookSceneTipsDatas=td.GetTableClass(td.TableEnum.ScenesTextConfig).getRandomTips());var e=d.getTowerArrayWithoutPet(),i=d.getEnemyArray();if(0!==e.length&&0!==i.length&&this._hookSceneTipsDatas&&this._hookSceneTipsDatas.length>0){var n=this._hookSceneTipsDatas[0];if(this._hookSceneTipsDatas.splice(0,1),1===n[0]){var a=e[Math.floor(Math.random()*e.length)];td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_HOOK_HERO_SPEAK,{tag:a._tag,tips:"#ScenesText"+n[1]})}else{var r=i[Math.floor(Math.random()*i.length)];td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_HOOK_HERO_MONSTER,{tag:r._tag,tips:"#ScenesText"+n[1]})}}}else this._hookSceneTipsTimeCount=this._getNextSpeakTimecount()},_getNextSpeakTimecount:function(){var t=td.GetConfig("SCENES_TEXT_INTERVALTIME_RANGE");return t[0]+Math.floor(Math.random()*(t[1]-t[0]))},_refreshHookRewardBox:function(){this.hookNode.getChildByName("btnHookReward").getChildByName("hookRewardBox")?this.playRewardBoxAnima():gdk.rm.loadRes(td.GlobalFunction.getResIdByNode(this.node),"uiAnima/GuaJI_baoxiang/GuaJI_baoxiang",cc.Prefab,this.addHookRewardBox.bind(this))},addHookRewardBox:function(){if(cc.isValid(this.hookNode)){var t=gdk.rm.getResByUrl("uiAnima/GuaJI_baoxiang/GuaJI_baoxiang",cc.Prefab),e=cc.instantiate(t);this.hookNode.getChildByName("btnHookReward").addChild(e),e.name="hookRewardBox",this.playRewardBoxAnima()}},playRewardBoxAnima:function(){for(var t=td.PveGeneralCopyManager.getLastHookRewardTime(),e=(td.TimeUtil.getTime()-t)/1e3,i=td.GetConfig("HOOK_UP_SEGMENT_SPLIT"),n=i.length-1;n>0;n--)if(e>i[n]){n;break}var a=this.hookNode.getChildByName("btnHookReward").getChildByName("hookRewardBox").getComponent(cc.Animation);10*td.GetConfig("STORY_HANG_UP_RANDOM_REWARD_INVTERVAL_TIME")<=e?a.currentClip&&"GuaJI_baoxiang"===a.currentClip.name||a.play("GuaJI_baoxiang"):a.currentClip&&"GuaJI_baoxiang_1"===a.currentClip.name||a.play("GuaJI_baoxiang_1")},showTimes:function(){var t=this.pveNode.getChildByName("TimesNode");t.active=!t.active},changeSpeed:function(t){var e=parseInt(t.target.name);td.UnlockManager.isTargetUnlock(td.ActorUnlockType.BattleTimes,e-1,!0)&&(td.EventUtil.dispatchEvent(td.EventNameEnum.CHANGE_FIGHT_SPEED,e),this.setSpeed(e))},setSpeed:function(t){var e=t&&t>0?t:h.getLocalSpeed(),i="ZD_GY_jiazhu_0"+e,n=this._btnChangeSpeed.getChildByName("imgSpeed");td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,i,n);var a=this.pveNode.getChildByName("TimesNode");a.active=!1;for(var r=1;r<=4;r++){var o=a.getChildByName(""+r),s=o.getChildByName("times");r===e?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,"ZD_GY_xinxidi02",o):td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,"ZD_GY_xinxidi",o);var l=td.UnlockManager.isTargetUnlock(td.ActorUnlockType.BattleTimes,r-1,!1);td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,(l?"ZD_GY_jiasu0":"ZD_GY_jiasu_gray_0")+r,s)}},pauseFight:function(){if(td.GuideManager.isHasGuide()){var t=new td.BroadcastContent(171);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,t)}else td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE,!0),this._hideTimesNode()},startFight:function(){if(this._bBuildingTower)td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SHOW_TIP_MESSAGE,td.Language.waiteForHeroUp);else if(p.hasTowerBuilt()){if(d.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.READY){this._btnStartFight.active=!1,this._btnOneKeyEmbattle.active=!1,this._btnReturn.active=!1,this.labChessInfo.node.active=!1;var t=td.PveCopyManager.getCopyType();if(t===_.PVEFightType.DemonTreasureCopy)this._timeNode.active=!0,this._timeCount=1e3*td.PveCopyManager.getBattleTime(),this.labelTimeCount.string=td.TimeUtil.convertTime(this._timeCount,"mm:ss"),this._dungeonScore=td.GetConfig("DUNGEON_SCORE"),this.schedule(this.updateTimecount,.1);else if(t===_.PVEFightType.AncientCorridor){this._timeNode.active=!0,this._ancientNode.active=!0,this._timeCount=1e3*td.PveCopyManager.getBattleTime(),this.labelTimeCount.string=td.TimeUtil.convertTime(this._timeCount,"mm:ss"),this.schedule(this.updateTimecount,0),this._ancientNode.getChildByName("waveNode").getChildByName("labWave").getComponent(cc.Label).string=td.PveCopyManager.getCopyId(),this._ancientNode.getChildByName("numNode").getChildByName("labNum").getComponent(cc.Label).string="0/"+td.GetConfig("AncientMaxLeftEnemy")}td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_FIGHT_BEGIN)}else cc.log("The fight is not ready status!")}else{var e=td.Language.canNotFightNoTower;td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SHOW_TIP_MESSAGE,e)}},_onBuildTower:function(){this._bBuildingTower=!0},_onBuildTowerFinished:function(){this._bBuildingTower=!1,td.PveCopyManager.getCopyType()===_.PVEFightType.CHESS&&this._refreshChessUI()},_refreshChessUI:function(){if(td.PveCopyManager.getCopyType()===_.PVEFightType.CHESS&&(d._fightStatus==td.PveEnum.PVE_FIGHT_STATUS.READY||d._fightStatus==td.PveEnum.PVE_FIGHT_STATUS.ENTER)&&cc.isValid(this.node)&&this.labChessInfo){var t=c.default.getInstance().getCurBattleHeroNum(),e=d.getTowerArrayWithoutPet().length;this.labChessInfo.string=td.Language.PVE_TXT_1+e+"/"+t}},updateTimecount:function(t){var e=d.getFightStatus(),i=td.PveCopyManager.getCopyType();if(i===_.PVEFightType.DemonTreasureCopy){var n=td.PveCopyManager.getBossTotalDamage();this.labelBossTotalHurt.string=Math.floor(n),this._bossHurtNode.active=n>=0;for(var a=this._bossHurtNode.getChildByName("imgScore"),r=Math.floor(1e4*n/td.PveCopyManager.getBossHp()),o=0,s=0,l=this._dungeonScore.length;s<l;s++){if(this._dungeonScore[s][0]>r)break;o=s}td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,"ZD_pj_0"+(o+1),a)}else if(i===_.PVEFightType.AncientCorridor){if(e!==td.PveEnum.PVE_FIGHT_STATUS.FIHGT||this._bFightPause)return;this._ancientNode.getChildByName("numNode").getChildByName("labNum").getComponent(cc.Label).string=d.getAliveEnemyCount()+"/"+td.GetConfig("AncientMaxLeftEnemy")}e!==td.PveEnum.PVE_FIGHT_STATUS.FIHGT||this._bFightPause||(this._timeCount-=t*h.getCurSpeed()*1e3,this._timeCount<=0&&(console.error("PveUILayer time out *******"),this.unschedule(this.updateTimecount),this._timeCount=0,d.onFightOver()),this.labelTimeCount.string=td.TimeUtil.convertTime(this._timeCount,"mm:ss"))},_refreshLeftEnemeyCount:function(t){this._ancientNode.getChildByName("numNode").getChildByName("labNum").getComponent(cc.Label).string=t+"/"+td.GetConfig("AncientMaxLeftEnemy")},oneKeyEmbattle:function(){if(this._bBuildingTower)td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SHOW_TIP_MESSAGE,td.Language.waiteForHeroUp);else{var t="";if(p.isBuildFinished()||!d.canBuildMoreTower())return t=td.Language.noHeroToBuild2,void td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SHOW_TIP_MESSAGE,t);if(d.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.FIHGT)return t=td.Language.canNotBuildWithFight,void td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_SHOW_TIP_MESSAGE,t);td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.ON_LINE),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_ONE_KEY_EMBATTLE,!0)}},onWithdraw:function(){td.PveCopyManager.prepareHookData(),td.PanelManager.getInstance().getCurShowPanel().closeCallFunc()},onShowEnemyDetail:function(){d.getFightStatus()!==td.PveEnum.PVE_FIGHT_STATUS.OVER&&(td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_ENEMY_DETAIL),this._hideTimesNode())},_onReconnect:function(){d.getFightStatus()===td.PveEnum.PVE_FIGHT_STATUS.OVER&&td.PveCopyManager.getCopyType()!==_.PVEFightType.AncientCorridor&&(d._fightStatus=td.PveEnum.PVE_FIGHT_STATUS.FIHGT,td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_FIGHT_OVER))},setInpireShowStatus:function(){var t=d.getFightStatus();this._inspireSkillUI.active=t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT},setStormShowStatus:function(){var t=d.getFightStatus();this._iceRainSkillUI.active=t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT},refreshSkillPowerProgress:function(){var t=d.getCurAngerPowerCount(),e=d.getTotalAngerPower(),i=this._angerPanel.getChildByName("circleProgress"),n=this._angerPanel.getChildByName("soulProgressBar"),a=t>=15?1:t/15;i.width=54*a;var r=t>15?(t-15)/(e-15):0;n.getComponent(cc.ProgressBar).progress=r,this._angerPanel.getChildByName("labProgress").getComponent(cc.Label).string=cc.js.formatStr("%s/%s",t,e);var o=this._angerPanel.getChildByName("imgAnge");t>=15?this._addSkillPowerAni(o):this._removeSkillPowerAni(o);var s=this._angerPanel.getChildByName("imgMax");1===r?(s.active=!0,s.runAction(cc.sequence(cc.fadeOut(.5),cc.fadeIn(.5)).repeatForever())):(s.active=!1,s.stopAllActions())},_addSkillPowerAni:function(t){var e=t.getChildByName("skillPowerAni");if(e)e.active||(e.active=!0);else{var i=gdk.rm.getResByUrl(td.resDef.PveDuTiao_Prefab,cc.Prefab);if(!i)return;(e=cc.instantiate(i)).name="skillPowerAni",e.parent=t;var n=e.getComponent(cc.Animation);n.play(n.defaultClip.name)}},_removeSkillPowerAni:function(t){var e=t.getChildByName("skillPowerAni");e&&(e.active=!1)},refreshUiChildNodeShowStatus:function(t){this.pveNode.getChildByName("btnEnemyInfo");if(this._angerPanel.active=t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT||t===td.PveEnum.PVE_FIGHT_STATUS.OVER,!td.GuideManager.isFirstBattle()){this._btnChangeSpeed.active=t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT,this._btnPause.active=t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT,this._btnStartFight.active=t===td.PveEnum.PVE_FIGHT_STATUS.READY,this._btnOneKeyEmbattle.active=t===td.PveEnum.PVE_FIGHT_STATUS.READY,this._btnReturn.active=t===td.PveEnum.PVE_FIGHT_STATUS.READY,this._iceRainSkillUI.active=t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT,this._inspireSkillUI.active=t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT;var e=td.UnlockManager.isTargetUnlock(td.ActorUnlockType.PveSkillLight,0);this._lightSkillUI.active=e&&t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT,this.nodePetSkills.active=t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT,this.labChessInfo.node.active=td.PveCopyManager.getCopyType()===_.PVEFightType.CHESS&&t===td.PveEnum.PVE_FIGHT_STATUS.READY,t===td.PveEnum.PVE_FIGHT_STATUS.READY&&(this._imgNotice.active=!1)}},playNoticeAction:function(t){this._imgNotice.active&&this._imgNotice.stopAllActions(),this._imgNotice.active=!0,this._imgNotice.runAction(cc.sequence(cc.fadeOut(.1*t),cc.fadeIn(.1*t)).repeatForever())},onBtnRewardPreview:function(){var t=td.PveGeneralCopyManager.getHookGateId(),e=td.PveGeneralCopyManager.getGateModelByGateId(t).getChapterId(),i=td.PveGeneralCopyManager.getChapterDataByChapterId(e).getHookReward(),n=td.RewardManager.parseRewardListDetail(i);td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_RewardBoxPreview,n)},onBtnChapterShow:function(){},onBtnShowQuickGain:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,td.PanelEnum.Window_PveQuickGain)},onBtnGetHookReward:function(){var t=td.GetConfig("STORY_HANG_UP_RANDOM_REWARD_INVTERVAL_TIME");if(td.TimeUtil.getTime()-td.PveGeneralCopyManager.getLastHookRewardTime()<10*t*1e3){var e=new td.BroadcastContent(176);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e)}else td.EventUtil.dispatchEvent(td.EventNameEnum.RECORD_CUR_LEVEL),td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_GET_HOOKUP_REWARD)},onBtnGotoHomePage:function(){td.PveGeneralCopyManager.isFirstEnterNewChapter()?td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_PveGeneralChapter):td.PanelJumpManager.jumpToPanel(td.PanelEnum.Panel_HomePage)},_showCollectAnima:function(t){for(var e=this.hookNode.getChildByName("gainIcons"),i=this.hookNode.getChildByName("btnHookReward").getPosition(),n=t.children,a=0;n.length>0;){var r=n[0],o=t.convertToWorldSpaceAR(r.getPosition());r.removeFromParent(!1),e.addChild(r);var s=e.convertToNodeSpaceAR(o);r.position=s;var l=cc.sequence(cc.delayTime(.05*a),cc.jumpTo(.5,i.x,i.y,50,1),cc.fadeOut(.1),cc.callFunc(function(t){t.removeFromParent()}));r.runAction(l),a++}t.removeFromParent(),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.PVE_REWARD_COLLECT)},_playEnemyDieYouLingAnima:function(t){var e=t.pos,i=g.getEnemyDieYouLing();if(!i){var n=gdk.rm.getResByUrl("fightRes/pve/otherAnimation/YouLing_effect/YouLing_effect",cc.Prefab);i=cc.instantiate(n)}i.position=e,this.node.addChild(i);var a=i.getComponent(cc.Animation);a.play(a.defaultClip.name),a.on("finished",this._onYouLingFinished.bind(this,i))},_onYouLingFinished:function(t){g.putEnemyDieYouLing(t)},_onEnermyDie:function(t){var e=this;if(td.PveCopyManager.isHook()){this._playEnemyDieYouLingAnima(t);var i=t.pos,n=t.grade;if(100*Math.random()>this._dropChance&&n!=td.PveEnum.PVE_ENERMY_GRADE.BOSS)this._dropChance+=20;else{this._dropChance=td.GetConfig("HookDropRewardChance");var r=1;n==td.PveEnum.PVE_ENERMY_GRADE.BOSS&&(r=2);for(var o=function(t){var n=gdk.rm.getResByUrl(td.resDef.Guajijinbi_Prefab,cc.Prefab),r=cc.instantiate(n);r.addComponent(a.default);var o=r.getComponent(a.default);r.active=!0,r.x=i.x,r.y=i.y+30,r.z=0,e._goldItemsLayer.addChild(r),o.playDrop();var s=e;r.opacity=255,r.scale=1;var l=cc.sequence(cc.delayTime(2),cc.callFunc(function(t){s._showCollectAnima(t)}));r.runAction(l)},s=0;s<r;s++)o();td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.PVE_REWARD_DROP)}}},_skillHurtStatic:function(t){this._totalHurtNode.active=!0,this._nTotalHurt+=t,this._totalHurtNode.getChildByName("totalHurt").getComponent(cc.Label).string=this._nTotalHurt},_skillHurtStaticEnd:function(){this._totalHurtNode.active=!1,this._nTotalHurt=0},refresLeftEnemyNum:function(){var t=d.getLeftEnemyNum();this._labLeftEnermyCount.getComponent(cc.Label).string=td.Language.left+":"+t},onDebugAdminOk:function(){var t=this.pveNode.getChildByName("debugAdmin"),e=t.getChildByName("editbox").getComponent(cc.EditBox).string,i=e.split("#"),n=JSON.parse(i[0]),a=JSON.parse(i[1]);switch(n){case 1:var r=parseInt(e);cc.log(r),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PVE_ADMIN_SET_HERO_ATTACK,r);break;case 2:d.debugParams={};for(var o=0;o<a.length;o++)d.debugParams[a[o]]=!0}t.active=!1},onDebugAdminClose:function(){this.pveNode.getChildByName("debugAdmin").active=!1},onEnemyFireClicked:function(){(this._enemyFireClickCount++,this._enemyFireClickCount>3)&&(this.pveNode.getChildByName("debugAdmin").active=!0,this._enemyFireClickCount=0)},showDebugAdmin:function(){(td.ENVIRONMENT===td.EnviromentType.Local||td.ENVIRONMENT===td.EnviromentType.GlobalTest||WHITE_NAME)&&(this.pveNode.getChildByName("debugAdmin").active=!0)}}));e.exports=f,cc._RF.pop()},{"../../../Chess/Manager/ChessManager":"ChessManager","../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager","../manager/PveDataHelper":"PveDataHelper","./EDUILayer":"EDUILayer","./GoldItem":"GoldItem","./skill/pveUiSkill/PvePetSkillUI":"PvePetSkillUI",ChooseHeroWindow:"ChooseHeroWindow",CommonEnum:void 0,PveBuildTowerManager:"PveBuildTowerManager",PveCopyEnum:void 0,PveFightManager:"PveFightManager",PveMapManager:"PveMapManager",PveNodePoolManager:"PveNodePoolManager",PveUiManager:"PveUiManager"}],PveUiManager:[function(t,e,i){"use strict";cc._RF.push(e,"a77f0xZtW9DDYtj3Tobqw9M","PveUiManager");t("PveCopyEnum"),t("PveLoader");var n=t("PveFightManager"),a={_curSpeedMult:null,_curSeletedUiSkill:null,_iceRainCostPower:null,_inspireCostPower:null,_lightCostPower:null,_iceRainSkillReleased:null,_inspireSkillReleased:null,_lightSkillReleased:null,mapLayer:null,fightLayer:null,effectLayer:null,uiLayer:null,popLayer:null,shakeLayers:null,_realMuti:null,init:function(){this._curSpeedMult=this.getLocalSpeed(),this._curSeletedUiSkill=0,this._iceRainCostPower=td.GetConfig("PVE_ICE_SKILL_COST"),this._inspireCostPower=td.GetConfig("PVE_INSPIRE_SKILL_COST"),this._lightCostPower=td.GetConfig("PVE_LIGHT_SKILL_COST"),this._iceRainSkillReleased=!0,this._inspireSkillReleased=!0,this._lightSkillReleased=!0,this._realMuti=n.getLocalSpeedMult(),this.addCustomListener()},addCustomListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.CHANGE_FIGHT_SPEED,this.onChangeSpeed,this)},removeListeners:function(){td.EventUtil.unregisterAllEvents(this)},onDestroy:function(){this.removeListeners()},onChangeSpeed:function(t){this._curSpeedMult=t;var e=1;2===this._curSpeedMult?e=1.65:3===this._curSpeedMult&&(e=2.2),this._realMuti=e,this.setLocalSpeed(this._curSpeedMult),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_CHANGE_FIGHT_SPEED,e)},getCurSpeed:function(){return this._realMuti},getIceRainSkillCostPower:function(){return this._iceRainCostPower},getInspireSkillCostPower:function(){return this._inspireCostPower},getLightSkillCostPower:function(){return this._lightCostPower},setSelectedSkill:function(t){0!==this._curSeletedUiSkill?(td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_UI_SKILL_STATUS,{skillId:this._curSeletedUiSkill,skillStatus:0}),this._curSeletedUiSkill=t):this._curSeletedUiSkill=t},getSelectedSkill:function(){return this._curSeletedUiSkill},setUiSkillReleaseStatus:function(t,e){t===td.PveEnum.PVE_UI_SKILL_ID.Inspire?this._iceRainSkillReleased=e:t===td.PveEnum.PVE_UI_SKILL_ID.IceRain?this._inspireSkillReleased=e:t===td.PveEnum.PVE_UI_SKILL_ID.Light&&(this._lightSkillReleased=e)},getUiSkillReleaseStatus:function(t){return t===td.PveEnum.PVE_UI_SKILL_ID.Inspire?this._iceRainSkillReleased:t===td.PveEnum.PVE_UI_SKILL_ID.IceRain?this._inspireSkillReleased:t===td.PveEnum.PVE_UI_SKILL_ID.Light?this._lightSkillReleased:void 0},getHeroDetailPrefab:function(){var t=gdk.rm.getResByUrl("prefab/Pve/PveHeroDetailPrefab",cc.Prefab);return cc.instantiate(t)},getFightResultPanelPrefab:function(){var t=gdk.rm.getResByUrl("prefab/Pve/PveFightResultLayer",cc.Prefab);return cc.instantiate(t)},getPveUiAtlas:function(){return gdk.rm.getResByUrl("fightRes/pve/common/pve",cc.SpriteAtlas)},setLocalSpeed:function(t){var e=td.PveCopyManager,i=e.getCopyType(),n=(e.getChapterId(),"pveFightSpeed"+i);td.LocalStorageUtil.write(n,t)},getLocalSpeed:function(){var t=td.PveCopyManager;if(t.isHook())return 1;var e=t.getCopyType(),i=(t.getChapterId(),"pveFightSpeed"+e),n=td.LocalStorageUtil.read(i);return n>3&&(n=3),n&&parseInt(n)>0?parseInt(n):1},getMapLayer:function(){return this.mapLayer},getFightLayer:function(){return this.fightLayer},getEffectLayer:function(){return this.effectLayer},getUILayer:function(){return this.uiLayer},getPopLayer:function(){return this.popLayer},getShakeLayers:function(){return this.shakeLayers},removeFightLayer:function(){cc.isValid(this.fightLayer)&&this.fightLayer.removeFromParent()}};e.exports=a,cc._RF.pop()},{PveCopyEnum:void 0,PveFightManager:"PveFightManager",PveLoader:"PveLoader"}],PvpBattleShowAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"e88ee9cpN5NJbNu46/jWpd6","PvpBattleShowAnimation");var n=t("AnimationComponent"),a=cc.Class({extends:n,properties:{_animClipName:null},init:function(t){this.resetAnimationClip();var e=gdk.rm.getResByUrl(t,cc.AnimationClip);this.addAnimationClip(e)},start:function(){this._addEventListener()},_addEventListener:function(){var t={};t[td.EventNameEnum.FIGHT_SPEED_CHANGE]=this._setSpeed,td.EventUtil.registerEvents(t,this)},onDisable:function(){td.EventUtil.unregisterAllEvents(this)},_setSpeed:function(t){var e=t;this.setAnimationSpeed(e)},playAnimation:function(t,e){var i=t||this._animClipName;this.node&&(this.node.stopAllActions(),this.playAnimationClip(i),this.setAnimationSpeed(td.PvpFightController.getInstance().getFightSpeed()))},setFrameListener:function(t,e,i){i&&this.setFinishAnimationCallBack(i)},startAttack:function(t){},setLastFrameListener:function(){this.setFrameListener(this._frames,null,function(){this.node.removeFromParent()}.bind(this))},setFlippedX:function(t){var e=Math.abs(this.node.scaleX);this.node.scaleX=t?e:-e},setRotation:function(t){var e=cc.pToAngle(t),i=180/Math.PI*e;this.node&&this.node.setRotation(-i)}});e.exports=a,cc._RF.pop()},{AnimationComponent:void 0}],PvpBattleShowAtkAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"005c6kvSRZJyofpxXRuXDij","PvpBattleShowAtkAnimation");var n=t("PvpBattleShowAnimation"),a=cc.Class({extends:n,properties:{_roleType:null,_skillId:null,_frames:null,_finishDelay:null,_playTime:null,_animEvent:null,_animEventIndex:0,_isAtkAnimation:!1,_executeAnimCallBack:!1,_sound:"",_includeShowBuffCall:!1,_callBackExcuteCount:0,_callBack:null,_isBigSkill:!1,_speed:1,_scale:1},playDefalutClip:function(){this._animEventIndex=0,this.node.stopAllActions();var t=this.node.getComponent(cc.Animation),e=t.getClips();t.play(e[0].name)},pauseAnimation:function(){this._super()},resumeAnimation:function(){this._super()},stopAnimation:function(){this._super()},changeSpeed:function(t){this._setSpeed(t)},_setSpeed:function(t){this._super(t);var e=t;this.setAnimationSpeed(e),this._changeSpeed(e)},_changeSpeed:function(t){this._speed=t},start:function(){this._super()},startAttack:function(){this._executeAnimCallBack&&(this._callBackExcuteCount++,this._frameListener())},finishAttackCallBack:function(){if(this._executeAnimCallBack){for(var t=this._animEvent.length-this._callBackExcuteCount,e=0;e<t;e++)this.startAttack();this._executeAnimCallBack=!1,td.EventUtil.dispatchEvent(td.EventNameEnum.FINISH_HERO_ATK_SHOW)}},playbullet:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_TRAJECTORY_ACTION)},playSound:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,this._sound)},getAnimaRes:function(){return this._animaRes},init:function(t,e){this._animEventIndex=0,this._callBackExcuteCount=0,this._roleType=t.roleType,this._skillId=t.skillId,this._animClipName=e,this._finishDelay=t.releaseFinishDelay||0,this._sound=t.releaseSound,this._animaRes=t.mercenaryAtkAnimationRes;var i=td.FightShowType;t.atkShowType===i.atkAnimation?this._frames=t.underAtkFrame:this._frames=[];var n=this.getAnimationByName(this._animClipName);this._animEvent=n?n.events:[];for(var a=[],r=0,o=this._animEvent.length;r<o;r++){var s=this._animEvent[r];"playBuff"===s.func?this._includeShowBuffCall=!0:"startAttack"===s.func&&(a[a.length]=s)}this._animEvent=a},checkBattleRatation:function(){this._scale=Math.abs(this.node.scale)},setEulerAnglesChange:function(t){void 0===t&&(t=cc.v3(0,0,0))},_frameListener:function(){var t=this._animEvent,e=this._animEvent[this._animEventIndex];if(e){this._animEventIndex=this._animEventIndex+1;var i=t.length-1,n=0,a=0,r=0;if(0===i)a=n=t[0].frame;else for(n=t[i].frame-t[0].frame+(t[i].frame-t[i-1].frame);r<=i;r++)if(t[r]===e){a=r!==i?(t[r+1].frame-t[r].frame)/n:(t[r].frame-t[r-1].frame)/n;break}td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SKILL_ANIMATION_CALLBACK,{totalFrame:n,framePercent:a,frameIndex:r,frame:e,isFirstFrame:e===t[0],isEndFrame:e===t[i],roleType:this._roleType,skillId:this._skillId})}else cc.error("startAttack erro")},setFrameListener:function(t,e){this._executeAnimCallBack=e||!1,this._callBack=t,e?this._super([],null,function(){td.EventUtil.dispatchEvent(td.EventNameEnum.FINISH_HERO_ATK_SHOW),t&&t()}.bind(this)):this._super([],null,function(){t&&t()}.bind(this))},onFinishCallBack:function(){this._callBack&&this._callBack(),this._executeAnimCallBack&&td.EventUtil.dispatchEvent(td.EventNameEnum.FINISH_HERO_ATK_SHOW)},startScale:function(){td.PvpFightManager.getFightType()===td.FightType.EVIL_GOD&&this.node.scaleX<0?this.node.runAction(cc.scaleTo(.1/this._speed,1.5*-1.2,1.2*1.5)):this.node.runAction(cc.scaleTo(.1/this._speed,this.node.scaleX<0?-1.2*td.PvpHeroScale:1.2*td.PvpHeroScale,1.2*td.PvpHeroScale))},endScale:function(){td.PvpFightManager.getFightType()===td.FightType.EVIL_GOD&&this.node.scaleX<0?this.node.runAction(cc.scaleTo(.1/this._speed,-1.5,1.5)):this.node.runAction(cc.scaleTo(.1/this._speed,this.node.scaleX<0?-td.PvpHeroScale:td.PvpHeroScale,td.PvpHeroScale))}});e.exports=a,cc._RF.pop()},{PvpBattleShowAnimation:"PvpBattleShowAnimation"}],PvpBattleSkillAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"45c14Kd/f1PJL4bZ2UTKyq1","PvpBattleSkillAnimation");var n=t("PvpBattleShowAnimation"),a=t("PvPNodePoolManager"),r=cc.Class({extends:n,properties:{_roleType:null,_skillId:null,_finishDelay:null,_animEvent:null,_animEventIndex:0,_executeCallBack:!0,_includeShowBuffCall:!1},init:function(t){this._animClipName=t.skillAnimation,this._roleType=t.roleType,this._skillId=t.skillId,this._finishDelay=t.releaseFinishDelay||0,this._animEventIndex=0;var e=td.FightShowType;t.atkShowType,e.atkAnimation;var i=this.getAnimationByName(this._animClipName);this._animEvent=i?i.events:[];for(var n=[],a=0,r=this._animEvent.length;a<r;a++){var o=this._animEvent[a];"playBuff"===o.func?this._includeShowBuffCall=!0:"startAttack"===o.func&&(n[n.length]=o)}this._animEvent=n},setExecuteCallBack:function(t){this._executeCallBack=t},setFrameListener:function(t,e,i){i||(i=this._lastFrameListener.bind(this)),this._super(t,e,i)},startAttack:function(){this._executeCallBack&&this._frameListener(),td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_MASK_STATE,{ids:[],state:!1})},playBuff:function(){this._executeCallBack&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SKILL_BUFF_CALLBACK)},_frameListener:function(){var t=this._animEvent,e=this._animEvent[this._animEventIndex];this._animEventIndex=this._animEventIndex+1;var i=t.length-1,n=0,a=0,r=0;if(0===i)a=n=t[0].frame;else for(n=t[i].frame-t[0].frame+(t[i].frame-t[i-1].frame);r<=i;r++)if(t[r]===e){a=r!==i?(t[r+1].frame-t[r].frame)/n:(t[r].frame-t[r-1].frame)/n;break}td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SKILL_ANIMATION_CALLBACK,{totalFrame:n,framePercent:a,frameIndex:r,frame:e,isFirstFrame:e===t[0],isEndFrame:e===t[i],roleType:this._roleType,skillId:this._skillId,includeShowBuffCall:this._includeShowBuffCall})},_lastFrameListener:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.FINISH_HERO_ATK_SHOW),this._isBigSkill&&td.EventUtil.dispatchEvent(td.EventNameEnum.BATTLE_BIG_SKILL_STATE_REFRESH,{spriteId:this._fightReport.getSpriteId(),state:!1}),a.putSkillEffectNodeToPool(this._skillId,this.node)}});e.exports=r,cc._RF.pop()},{PvPNodePoolManager:"PvPNodePoolManager",PvpBattleShowAnimation:"PvpBattleShowAnimation"}],PvpBattleUnderAtkAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"61fc2LgemZNz51bi951lRj5","PvpBattleUnderAtkAnimation");var n=t("PvpBattleShowAnimation"),a=cc.Class({extends:n,init:function(t){var e=t.getUnderAtkAnimationRes();this._animClipName=t.getUnderAtkAnimation(),this._super(e)},setFrameListener:function(t){this._super([],null,function(){this.node.removeFromParent(),t&&t()}.bind(this))}});e.exports=a,cc._RF.pop()},{PvpBattleShowAnimation:"PvpBattleShowAnimation"}],PvpBufferEffect:[function(t,e,i){"use strict";cc._RF.push(e,"768645pP5JHS5nPFlKKB8es","PvpBufferEffect");var n=t("Model");t("PvpFightMercenary");td.PvpBufferEffect=cc.Class({extends:n,properties:{_targetSId:null,_effectId:null,_effectType:null,_buffExpression:null,_attributeMap:null,_buffName:null,_buffIcon:null,_triggerAnima:null,_buffPrefabRes:null,_buffPrefabName:null},init:function(t){this._super("PvpBufferEffect"),this._targetSId=t.targeterUid,this._effectId=t.effectId,this._attributeMap=t.attributeMap;var e=td.GetTableClass(td.TableEnum.SkillEffect).getDataById(this._effectId);this._buffExpression=null,e&&(this._buffExpression=e.buffExpression,this._buffExpression2=e.buffExpressionBefore,this._buffName=e.buffAnimName,this._triggerAnimaName=e.triggerAnimaName,this._buffPrefabRes=e.buffPrefabRes,this._buffPrefabName=e.buffPrefabName,this._buffAnimNameBefore=e.buffAnimNameBefore,this._effectType=e.effectType,this._buffIcon=e.buffIcon,this._triggerAnima=e.triggerAnima)},getTargetSid:function(){return this._targetSId},getEffectId:function(){return this._effectId},getEffectType:function(){return this._effectType},getBuffExpression:function(){return this._buffExpression},getBuffExpressionBefore:function(){return this._buffExpression2},getTriggerAnima:function(){return this._triggerAnima},getBuffIcon:function(){return this._buffIcon},getBuffName:function(){return this._buffName},getTriggerAnimName:function(){return this._triggerAnimaName},getBuffPrefabRes:function(){return this._buffPrefabRes},getBuffPrefabName:function(){return this._buffPrefabName},getBuffNameBefore:function(){return this._buffAnimNameBefore},getAttributeMap:function(){return this._attributeMap},show:function(t){}}),td.HpBuffEffect=cc.Class({extends:td.PvpBufferEffect,init:function(t){this._super(t)}}),td.AtkBuffEffect=cc.Class({extends:td.PvpBufferEffect,init:function(t){this._super(t)}}),td.ArmorBuffEffect=cc.Class({extends:td.PvpBufferEffect,init:function(t){this._super(t)}}),td.PhysicalArmorBuffEffect=cc.Class({extends:td.PvpBufferEffect,init:function(t){this._super(t)}}),td.SpellArmorBuffEffect=cc.Class({extends:td.PvpBufferEffect,init:function(t){this._super(t)}}),td.StunBuffEffect=cc.Class({extends:td.PvpBufferEffect,init:function(t){this._super(t)}}),td.BufferImmuneControlEffect=cc.Class({extends:td.PvpBufferEffect,init:function(t){this._super(t)}}),cc._RF.pop()},{Model:"Model",PvpFightMercenary:"PvpFightMercenary"}],PvpFightAnimationController:[function(t,e,i){"use strict";cc._RF.push(e,"ea328FK5B9MrIB/MtvOlaZ4","PvpFightAnimationController"),td.PvpFightAnimationController={},cc._RF.pop()},{}],PvpFightBuffAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"2216dqX4IlKoK8sebnQ0FBZ","PvpFightBuffAnimation");var n=t("PvpFightShowAnimation");cc.Class({extends:n,init:function(t,e){this._animClipName=e?t.getBuffNameBefore():t.getBuffName(),this._super(e?t.getBuffExpressionBefore()[1]:t.getBuffExpression()[1])},addBuffIdentifys:function(t){this._buffIdentifys||(this._buffIdentifys={});var e=t[1],i=""+t[0]+t[2]+t[3];this._buffIdentifys[e]||(this._buffIdentifys[e]=[]),ArrayUtils.contains(this._buffIdentifys[e],i)||(this._buffIdentifys[e][this._buffIdentifys[e].length]=i)},getCanRemoveBuff:function(t){this._buffIdentifys||(this._buffIdentifys={});var e=t[1],i=""+t[0]+t[2]+t[3];if(ArrayUtils.contains(this._buffIdentifys[e],i)){if(ArrayUtils.remove(this._buffIdentifys[e],i),0!=this._buffIdentifys[e].length)return!1;if(delete this._buffIdentifys[e],0==this._buffIdentifys.myLen())return!0}return!1},reuse:function(){delete this._buffIdentifys}});cc._RF.pop()},{PvpFightShowAnimation:"PvpFightShowAnimation"}],PvpFightController:[function(t,e,i){"use strict";cc._RF.push(e,"9c002N5CFpJNqViiX3g0wWd","PvpFightController");var n=cc.Class({extends:cc.Node,properties:{_schedulerKey:-99999,_unitTime:null,_fightStateInit:null,_curFightState:null,_fightPlayFinishState:null,_dataController:null,_playController:null},init:function(t){this._dataController=td.PvpFightDataController,this._dataController.init(),this._dataController.setFightData(t),this._playController=td.PvpFightPlayController,this._addEventListener(),this.name="PvpFightController"},destroyData:function(){cc.log("TBSFightController destroyData"),this._dataController=null,this._playController=null,this._curFightState=td.FightState.NONE,this._removeScheduler(),td.EventUtil.unregisterAllEvents(this)},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.CHANGE_FIGHT_STATE]=this._changeState,t[e.PLAY_FIGHT_FINISH]=this._setPlayFightFinishState,t[e.START_PLAY_FIGHT]=this._startPlayFight,t[e.END_ROUND_PLAY]=this._finishedRoundPlay,t[e.STOP_FIGHT_NOW]=this._stopNowFight,t[e.FINISH_HERO_ATK_ACTION_FRONT]=this._finishHeroAtkActionFront,t[e.FINISH_HERO_ATK_ACTION_CENTER]=this._finishHeroAtkActionCenter,t[e.FINISH_HERO_ATK_SHOW]=this._finishHeroAtk,t[e.FINISH_HERO_ATK_ACTION_BACK]=this._finishHeroAtkActionBack,t[e.PLAY_SKILL_ANIMATION_CALLBACK]=this._skillAnimationCallback,t[e.PLAY_SKILL_BUFF_CALLBACK]=this._skillBuffCallback,t[e.PLAY_TRAJECTORY_ACTION_CALLBACK]=this._trajectoryActionCallback,t[e.PLAY_HERO_ATK_SKILL_EFFECT_SHOW]=this._playAtkShow,t[e.PLAY_HERO_TRAJECTORY_ACTION]=this._playTrajectoryShow,t[e.FIGHT_SPEED_CHANGE]=this._setFightSpeed,t[e.PAUSE_FIGHT]=this._pauseFight,t[e.RESUME_FIGHT]=this._resumeFight,t[e.UPDATA_BUFF_STATE]=this._updateFightBuffShowData,td.EventUtil.registerEvents(t,this)},_addScheduler:function(){this._unitTime=0,cc.director.getScheduler().schedule(this.update,this,.02,cc.macro.REPEAT_FOREVER,0,!1)},_removeScheduler:function(){cc.director.getScheduler().unschedule(this.update,this)},update:function(t){var e=this.getFightSpeed();if(this._unitTime+=t*e,this._fightStateInit||!(this._unitTime<10*e)){if(this._unitTime>=10*e){if(cc.log("timeOut  curState:"+this._curFightState),this._fightPlayFinishState)for(var i=0;i<this._fightPlayFinishState.length;i++)cc.log("finishState\uff1a"+this._fightPlayFinishState[i]);this._changeState(td.FightState.UNITFIGHT_ENDED)}this._unitTime=0,this._fightStateInit=!1;var n=this._curFightState,a=td.FightState;n===a.ROUND_PREPARE?this._prepareRoundPlay():n===a.ROUND_START?this._startRoundPlay():n===a.UNITFIGHT_PREPARE?this._prepareUnitFight():n===a.UNITFIGHT_START?this._startUnitFight():n===a.UNITFIGHT_ENDED?this._finishedUnitFight():n===a.ROUND_ENDED&&this._finishedRoundPlay()}},_pauseFight:function(){this._removeScheduler()},_resumeFight:function(){this._addScheduler()},_updateFightBuffShowData:function(t){},_shakeScreen:function(){this._playController.shakeSceene()},_startPlayFight:function(t){this._addScheduler(),this._changeState(td.FightState.ROUND_PREPARE)},_prepareRoundPlay:function(){if(0===this._dataController.getFightData().reports.myLen())return this._removeScheduler(),void td.EventUtil.dispatchEvent(td.EventNameEnum.END_PLAY_FIGHT);this._dataController.setFightRoundData();var t=this._dataController.getFightRoundData();td.EventUtil.dispatchEvent(td.EventNameEnum.PREPARE_ROUND_PLAY,t),this._changeState(td.FightState.ROUND_START)},_startRoundPlay:function(){this._changeState(td.FightState.UNITFIGHT_PREPARE)},_finishedRoundPlay:function(){var t=this._dataController.getFightRoundData();t?(td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_BATTLE_ROUND_COMPLETE,{roundId:t.getRoundId()}),this._changeState(td.FightState.ROUND_PREPARE)):td.GameFightError()},_prepareUnitFight:function(){this._dataController.setFightUnitReportData();var t=this._dataController.getFightUnitReportData();t?(this._playController.init(t),td.EventUtil.dispatchEvent(td.EventNameEnum.PREPARE_UNIT_FIGHT_PLAY,{report:t}),this._changeState(td.FightState.UNITFIGHT_START)):this._changeState(td.FightState.ROUND_ENDED)},_startUnitFight:function(){this._fightPlayFinishState=[],this._playController.startUnitFight(),this._dataController&&this._dataController.getFightUnitReportData||td.GameFightError(td.FightType.None)},_finishedUnitFight:function(){if(this._dataController&&this._dataController.getFightUnitReportData){var t=this._dataController.getFightUnitReportData();cc.director.getScheduler().getTimeScale();if(t){if(this._playController){this._playController.resetNode();t=this._dataController.getFightUnitReportData();td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_BATTLE_UNIT_FINISH,{roundId:t.getRoundIndex(),reportIndex:t.getReportIndex()+1}),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_HERO_TRRI_SHOW),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_HERO_TRRI_DEAD),this._dataController.checkHasNewMonsterShow()||this._changeState(td.FightState.UNITFIGHT_PREPARE)}}else td.GameFightError(td.FightType.None)}else td.GameFightError(td.FightType.None)},_changeState:function(t){this._curFightState=t,this._fightStateInit=!0},getCurFigthState:function(){return this._curFightState},_setPlayFightFinishState:function(t){if(this._curFightState===td.FightState.UNITFIGHT_START){t.sid;var e=t.eventEnum;ArrayUtils.contains(this._fightPlayFinishState,e)||(this._fightPlayFinishState[this._fightPlayFinishState.length]=e);for(var i=0,n=td.FightPlayFinishEnum.length-1;i<=n;i++)if(!ArrayUtils.contains(this._fightPlayFinishState,td.FightPlayFinishEnum[i]))return;this._fightPlayFinishState=[],this._changeState(td.FightState.UNITFIGHT_ENDED)}},_stopReleaseSkillSound:function(){var t=this._dataController.getFightUnitReportData();t?t.getSkillId():td.GameFightError(td.FightType.None)},_stopNowFight:function(){this._removeScheduler(),td.EventUtil.dispatchEvent(td.EventNameEnum.END_PLAY_FIGHT)},getFightMembers:function(){return this._dataController?this._dataController.getFightMembers():null},getFightData:function(){return this._dataController?this._dataController.getFightData():null},removeFightBuffShowData:function(t){},setFightBuffShowData:function(t){},getFightBuffShowData:function(t){},getFightBuffers:function(t){return this._dataController?this._dataController.getFightBuffers(t):null},_finishHeroAtk:function(t){var e=this._dataController.getFightUnitReportData();e?(this.refreshMemberAttr(e),this._playController.finishHeroAtkShow()):td.GameFightError(td.FightType.None)},refreshMemberAttr:function(t){for(var e=t.getSkillEffects(),i=0,n=e.length-1;i<=n;i++){var a=e[i],r=(a.getEffectId(),a.getAttributeMap());a&&!a.isBuffShow()&&(this._dataController.refreshMemberAttr({sid:a.getTargetSid(),attrMap:r}),td.EventUtil.dispatchEvent(td.EventNameEnum.PVP_REPORT_ADD_SHOW,a))}},_finishHeroAtkActionFront:function(){this._playController.finishHeroAtkActionFront()},_finishHeroAtkActionCenter:function(){this._playController.finishHeroAtkActionCenter()},_finishHeroAtkActionBack:function(){this._playController.finishHeroAtkActionBack()},_skillAnimationCallback:function(t){var e=t.isFirstFrame,i=t.isEndFrame,n=t.frameIndex,a=t.totalFrame,r=t.framePercent,o=t.includeShowBuffCall;this._playController.triggerUnderAttackEffect(e,i,n,a,r,o)},_skillBuffCallback:function(){this._playController.triggerPlayerBuffEffect()},_trajectoryActionCallback:function(t){this._playController.triggerUnderAttackEffect(!0,!0,1)},_playAtkShow:function(t){this._playController.playAtkShow(t)},_playTrajectoryShow:function(t){this._playController.playTrajectoryShow(t)},_setFightSpeed:function(t){this._dataController.setFightSpeed(t)},getFightSpeed:function(){return this._dataController?this._dataController.getFightSpeed():1},isFightOver:function(){return!this._playController||!this._dataController},getRoleDataBySId:function(t){return this._dataController?this._dataController.getRoleDataBySId(t):null},getIsReviveReport:function(t){t||(t=td.PvpFightController.getInstance()._dataController.getFightUnitReportData());for(var e=t.getSkillEffects(),i=0,n=e.length;i<n;i++){var a=e[i],r=a.getTargetSid(),o=(a.getAttackerId(),this._dataController.getRoleDataBySId(r));if(o&&0!=o.getHp())return!1;var s=a.getAttributeMap()||{};if(s.hasOwnProperty(td.SpriteKey.HP))if(s[td.SpriteKey.HP]>0)return!0}return!1}});td.PvpFightController=function(){var t;return{getInstance:function(){return null!==t&&void 0!==t||(t=new n),t},removeInstance:function(){t.destroyData(),t=null}}}(),cc._RF.pop()},{}],PvpFightDataController:[function(t,e,i){"use strict";cc._RF.push(e,"b7a40OcBsFFM5A4zToHa/Mh","PvpFightDataController"),td.PvpFightDataController={_fightSpeed:null,_fightData:null,_roundData:null,_unitReport:null,_buffers:null,init:function(){this._fightSpeed=1},destroyData:function(){this._fightData=null,this._roundData=null,this._unitReport=null,this._buffers=null},setFightSpeed:function(t){this._fightSpeed=t},getFightSpeed:function(){return this._fightSpeed},setFightData:function(t){var e=this;t.fightType==td.FightType.StoryHandUp&&this.setFightSpeed(2),this._fightData=t;var i=td.PvpFightDataController.getFightMembers()[1].getFormation().getMercenarys();i.forEach(function(t){e.initDeadRound(t.getSId())}),(i=td.PvpFightDataController.getFightMembers()[2].getFormation().getMercenarys()).forEach(function(t){e.initDeadRound(t.getSId())})},getFightData:function(){return this._fightData},setFightRoundData:function(){var t=this._fightData.reports,e=td.ArrayUtil.frontKey(t);this._roundData=t[e],delete t[e]},getFightRoundData:function(){return this._roundData},setFightUnitReportData:function(){var t=this._roundData.getFightReports();this._unitReport=t.splice(0,1)},getFightUnitReportData:function(){return this._unitReport?this._unitReport[0]:null},updateFightBuffShowData:function(t){},removeFightBuffShowData:function(t){},setFightBuffShowData:function(t){},getFightBuffShowData:function(t){},getFightMembers:function(){return this._fightData.members},refreshRoundBuffAttr:function(){},refreshUnitBuffAttr:function(t){},refreshUnitFightAttr:function(){for(var t=this.getFightUnitReportData().getSkillEffects(),e=this.getFightUnitReportData().getMercenarySId(),i=0,n=t.length-1;i<=n;i++){var a=t[i],r=a.getEffectId(),o=a.getAttributeMap();!a||a.isBuffShow()||a.getTargetSid()!==e||r!==td.FightEffectIdEnum.AttackRage&&o[td.SpriteKey.RAGE]<=0||this._refreshMemberRageAttr({sid:a.getTargetSid(),attrMap:o},!0)}},refreshMemberAttr:function(t){var e=t.sid,i=t.attrMap,n=this._fightData.members;for(var a in n)for(var r=n[a].getFormation().getMercenarys(),o=0,s=r.length-1;o<=s;o++){var l=r[o];if(l&&l.getSId()===e){var c=i[td.SpriteKey.HP];if("number"==typeof c){var u=l.getHp();u+=c,l.setHp(u)}var d=i[td.SpriteKey.RAGE];if("number"==typeof d){u=l.getRage();(u+=d)<0&&(u=0),l.setRage(u)}}}},_refreshMemberRageAttr:function(t,e){var i=t.sid,n=t.attrMap,a=this._fightData.members;for(var r in a){for(var o=a[r].getFormation().getMercenarys(),s=!1,l=0,c=o.length-1;l<=c;l++){var u=o[l];if(u&&u.getSId()===i){var d=n[td.SpriteKey.RAGE];if("number"==typeof d&&(e&&d>=0||!e&&d<0)){var h=u.getRage();(h+=d)<0&&(h=0),u.setRage(h),e&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_RAGE_UP,i)}s=!0;break}}if(s)break}},getRoleDataBySId:function(t){var e=this._fightData.members,i=null;for(var n in e)for(var a=e[n].getFormation().getMercenarys(),r=0,o=a.length-1;r<=o;r++)if((i=a[r])&&i.getSId()==t)return i;return null},getRoleDataByPos:function(t,e){var i=this._fightData.members,n=null;for(var a in i)if(i[a].getCamp()==t)for(var r=i[a].getFormation().getMercenarys(),o=0,s=r.length-1;o<=s;o++)if((n=r[o])&&n.getPos()==e)return n;return null},isLeftReportsContainPlayer:function(t){for(var e=this.getFightRoundData().getFightReports(),i=0,n=e.length;i<n;i++)if(t==e[i].getMercenarySId()&&0!=e[i].getSkillId())return!0;return!1},isLeftReportsValid:function(t){for(var e=td.PvpFightController.getInstance().getRoleDataBySId(t).getHp(),i=this.getFightRoundData().getFightReports(),n=0,a=i.length;n<a;n++)if(t==i[n].getMercenarySId()){if(e>=0)return!0;for(var r=i[n].getSkillEffects(),o=0,s=r.length-1;o<=s;o++){var l=r[o];if(t==l.getTargetSid()){var c=l.getAttributeMap();c||(c=[]);var u=c[td.SpriteKey.HP];if(void 0===u||0===u)continue;if(u+0+e>0)return!0}}}return!1},isCurReportValid:function(t){var e=td.PvpFightController.getInstance().getRoleDataBySId(t).getHp(),i=this.getFightUnitReportData();if(!i)return!1;if(t==i.getMercenarySId()){if(e>=0)return!0;for(var n=i.getSkillEffects(),a=0,r=n.length-1;a<=r;a++){var o=n[a];if(t==o.getTargetSid()){var s=o.getAttributeMap();s||(s=[]);var l=s[td.SpriteKey.HP];if(void 0===l||0===l)continue;if(l+0+e>0)return!0}}}return!1},initDeadRound:function(t){this._deadRound=this._deadRound||{};for(var e=(l=td.PvpFightManager.getFightData().reports)[td.ArrayUtil.frontKey(l)],i=99;e;){for(var n=e.getRoundId(),a=e.getFightReports(),r=!0,o=0,s=a.length;o<s;o++)if(t==a[o].getMercenarySId()||ArrayUtils.contains(a[o].getTargetSIds(),t)){r=!1;break}r||(i=n);var l=this.getFightData().reports,c=!1;for(var u in l){var d=l[u];n+1==d.getRoundId()&&(e=d,c=!0)}if(!c)break}this._deadRound[t]=i},isRoleRealDead:function(t){if(this.isLeftReportsContainPlayer(t))return!this.isLeftReportsValid(t);var e=this.getFightRoundData().getRoundId();return this._deadRound[t]<e},getNextRoundData:function(){var t=this.getFightRoundData().getRoundId(),e=this.getFightData().reports;for(var i in e){var n=e[i];if(t+1==n.getRoundId())return n}},checkHasNewMonsterShow:function(){if(td.PvpFightManager.getFightType()!==td.FightType.WorldBoss)return!1;var t=td.PvpFightManager.getNewMonsterData();return this.getRoleDataByPos(2,1).getHp()<=0&&!!t[0]},checkHasNewMonsterShowByPos:function(t){return td.PvpFightManager.getFightType()===td.FightType.WorldBoss&&(!!td.PvpFightManager.getNewMonsterData()[0]&&this.getRoleDataByPos(2,1).getHp()<=0)}},cc._RF.pop()},{}],PvpFightEffectView:[function(t,e,i){"use strict";cc._RF.push(e,"73a0eYpXlZBIqdvh3ESL1oY","PvpFightEffectView");var n=t("PvpFightMercenary"),a=t("PvpFightBuffAnimation"),r=(t("RollerDigitalTextAtlas"),t("PvPNodePoolManager")),o=cc.Class({extends:cc.Component,properties:{_leftPos:null,_leftNodeSize:null,_rightPos:null,_rightNodeSize:null,_minPosY:null,_skillNode:null,_buffEffectNode:null,_attriEffectNode:null,_cfg:null,_suolianEffectList:null,hurtLabel:cc.Node,hurtNumLabel:cc.Label,wan:cc.Node,hurtBg:cc.Node,_hurtNum:0},init:function(t){this._cfg=t;var e=td.UIAdaptiveUtil.getMinScale();this.node.setScale(e),this._minPosY=1e5,this._init(t),this._skillNode=new cc.Node,this._skillNode.setName("skillNode"),this.node.addChild(this._skillNode),this._buffEffectNode=new cc.Node,this._buffEffectNode.setName("buffEffectNode"),this.node.addChild(this._buffEffectNode),this._attriEffectNode=new cc.Node,this._attriEffectNode.setName("attriEffectNode"),this.node.addChild(this._attriEffectNode),this.hurtLabel=this.node.getChildByName("hurtLabel"),this.hurtBg=this.node.getChildByName("hurtBg"),this.wan=this.node.getChildByName("wan"),this.hurtNumLabel=this.node.getChildByName("hurtNum").getComponent(cc.Label);var i=td.PvpFightManager.getFightType();i!==td.FightType.WorldBoss&&i!==td.FightType.Nation_War&&i!==td.FightType.NationBoss&&i!==td.FightType.HOLY_BEAST||(this.hurtLabel.active=!0,this.hurtNumLabel.node.active=!0,this.hurtBg.active=!0)},_init:function(t){this._leftPos={},this._leftNodeSize={};var e=this._leftPos,i=this._leftNodeSize;this._calcData(t.leftNodes,e,i),this._rightPos={},this._rightNodeSize={},e=this._rightPos,i=this._rightNodeSize,this._calcData(t.rightNodes,e,i)},start:function(){this.addParticle()},refreshPos:function(){this._cfg&&this._init(this._cfg)},addParticle:function(){this._paritcleName="fightRes/pvp/ui_anima/BOSS_Particle/BOSS_Particle",td.PvpFightManager.getFightType()===td.FightType.Arena?this._paritcleName="fightRes/pvp/ui_anima/JinJiChang_Particle/JinJiChang_Particle":td.PvpFightManager.getFightType()===td.FightType.DESTROY_TEMPLE?this._paritcleName="fightRes/pvp/ui_anima/YEWAI_Particle/YEWAI_Particle":this._paritcleName="fightRes/pvp/ui_anima/BOSS_Particle/BOSS_Particle";var t=td.GlobalFunction.getResIdByNode(this.node);gdk.rm.loadRes(t,this._paritcleName,cc.Prefab,this.playParticle.bind(this))},playParticle:function(){var t=gdk.rm.getResByUrl(this._paritcleName,cc.Prefab),e=cc.instantiate(t);e.name="Particle",this.node.addChild(e)},_refreshSuolianArray:function(t){this._suolianEffectList=this._suolianEffectList||{},this._suolianEffectList[t.getTargetSid()]=t},update:function(){if(this._suolianEffectList=this._suolianEffectList||{},this._suolianEffectList.myLen()<=0)this._buffEffectNode.removeAllChildren();else for(var t in this.refreshPos(),this._suolianEffectList){var e=this._suolianEffectList[t],i=e.getTargetSid(),n=e.getAttackerId(),a=this.getPos(i),r=this.getPos(n),o=i+"_"+n,s=this._buffEffectNode.getChildByName(o);if(a&&r){if(!s){var l=gdk.rm.getResByUrl("fightRes/pvp/pvp_effect/BUFF_PVP/BUFF_SuoLian_01",cc.Prefab);(s=cc.instantiate(l)).setName(o),s.getComponent(cc.Animation).play("BUFF_SuoLian_01"),this._buffEffectNode.addChild(s)}a=cc.v2(a.x,a.y+50),r=cc.v2(r.x,r.y+50),a=this._buffEffectNode.convertToNodeSpaceAR(a),r=this._buffEffectNode.convertToNodeSpaceAR(r),s.setPosition(r);var c=s.width,u=a.sub(r).mag(),d=u/c;s.scaleX=d;var h=Math.asin((a.y-r.y)/u),p=cc.misc.radiansToDegrees(h);a.y-r.y>0&&a.x-r.x>0?p=p:a.y-r.y>=0&&a.x-r.x<0?p=180-p:a.y-r.y<=0&&a.x-r.x<0?p=-180-p:a.y-r.y<0&&a.x-r.x>0&&(p=p),p=-p,s.setRotation(p),this._showSuolianTou(e,a,"suolian"+i),this._showSuolianTou(e,r,"suolian"+n)}else s&&(s.stopAllActions(),s.removeFromParent(),delete this._suolianEffectList[o]),this._removeSuolianTou("suolian"+i),this._removeSuolianTou("suolian"+n)}},_removeSuolianTou:function(t){var e=this._buffEffectNode.getChildByName(t);e&&e.removeFromParent()},_showSuolianTou:function(t,e,i){var n=t.getBuffEffect(),r=n.getBuffExpression(),o=this._buffEffectNode.getChildByName(i);if(!o){(o=td.GlobalFunction.createPrefabInstance(r[1])).setName(i);var s=o.addComponent(a);s.init(n),this._buffEffectNode.addChild(o),s.playAnimation()}o.setPosition(e)},_calcData:function(t,e,i){for(var a=0,r=t.length-1;a<=r;a++){var o=t[a];if(cc.isValid(o)&&o.getParent()){var s=o.getComponent(n).getCfg();if(s){var l=s.getSId(),c=o.getParent().convertToWorldSpaceAR(o.getPosition()),u=o.getContentSize();e[l]=cc.v2(c.x,c.y),i[l]=u,this._minPosY=Math.min(this._minPosY,c.y)}}}},_addListener:function(){var t=td.EventUtil,e=td.EventNameEnum;t.registerEvent(e.PLAY_BUFF_CHANGE_PREPARE,this._showBuffAttriChange,this),t.registerEvent(e.PLAY_BUFF_EFFECT_WORK,this._showBuffAttriChange,this),t.registerEvent(e.PLAY_SKILL_EFFECT_WORK,this._showSkillEffect,this),t.registerEvent(e.PLAY_SKILL_EFFECT_PREPARE,this._showSkillEffect,this),t.registerEvent(e.PLAY_BUFF_FONT,this._showBuffPlayFont,this),t.registerEvent(e.PLAY_SKILL_EFFECT_BUFF_SHOW,this._refreshSuolianArray,this),t.registerEvent(e.PLAY_FIGHT_FINISH,this.refreshPos,this)},onEnable:function(){this._addListener()},onDisable:function(){td.EventUtil.unregisterAllEvents(this)},_playFont:function(t,e){var i=null;switch(t=parseInt(t)){case td.HitState.MISS:i="PVP_wz_shanbi";break;case td.HitState.IMMUNE:i="PVP_wz_buqu";break;case td.HitState.FORBID_HEAL:i="PVP_wz_jingliao";break;case td.HitState.DAMAGE_LIMIT:i="PVP_wz_didang";break;case td.HitState.DAMAGE_REDUCTION:i="PVP_wz_jianmian"}if(i){var n=r.getNodeFromNodePool(i);cc.isValid(n)?this._attriEffectNode.addChild(n):((n=new cc.Node).name=i,this._attriEffectNode.addChild(n),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,i,n)),this._attrMissAction(n,e,null)}},_showSkillEffect:function(t){var e=t.effect,i=t.isFirst,n=(t.hasFightShow,t.times),a=(t.frameIndex,e.getTargetSid());if(this._leftPos[a]||this._rightPos[a]){var o=function(){},s=t.precent;i&&this._playFont(e.getHitState(),a);var l=e.getAttributeMap();l||(l=[]);var c=!1,u=l[td.SpriteKey.HP];if(e.isSubstituteDamage());else if(void 0===u||0===u){if(!(u=l[td.SpriteKey.SHIELD]))return;c=!0}var d=e.getDamageType();if(this._init(this._cfg),n>0&&s>0){var h=u%10;u-=h,u=i?Math.round(u*s)+h:Math.round(u*s)}if(0!==u||e.isSubstituteDamage()){cc.log("_showSkillEffect hp "+u+" sid= "+a);var p=null;if(c){var _="Fonts/Fonts_zd_dun",g="Fonts_zd_dun";p=r.getNodeFromNodePool(_);if(!cc.isValid(p)){(p=td.GlobalFunction.createLabel("/"+-u,_)).name=g;var f=new cc.Node;p.addChild(f),p.getComponent(cc.Label)._forceUpdateRenderData(),f.x=-p.width/2-25,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,"ZD_GY_dun",f)}this._attriEffectNode.addChild(p),this._attrSubHpAction(p,a,o)}else if(u>0||e.isAddHp()||e.isSuckBlood()&&0===u){_="Fonts/Fonts_pvp_zhiliao",g="Fonts_pvp_zhiliao";p=r.getNodeFromNodePool(_),cc.isValid(p)||((p=td.GlobalFunction.createLabel("/"+u,_)).name=g);var v=25-50*Math.random();p.x=v,p.y=200,this._attriEffectNode.addChild(p),this._attrAddHpAction(p,a,o)}else if(e.isCritical()){var m=null;_=d===td.DamageType.PHYSICAL?"Fonts/Fonts_zd_bao_wu":"Fonts/Fonts_zd_bao_fa",g=d===td.DamageType.PHYSICAL?"Fonts_zd_bao_wu":"Fonts_zd_bao_fa";p=r.getNodeFromNodePool(_),cc.isValid(p)||((p=td.GlobalFunction.createLabel("/"+-u,_)).name=g),this._attriEffectNode.addChild(p);var y=d===td.DamageType.PHYSICAL?"ZD_GY_baoji":"ZD_GY_baoji02";m=r.getNodeFromNodePool(y);cc.isValid(m)?p.addChild(m):((m=new cc.Node).name=y,p.addChild(m),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,y,m)),p.setAnchorPoint(0,.5),m.setAnchorPoint(1,.5),p.x=0,p.y=0,m.x=0,m.y=0,this._attrSubHpCritAction(p,a,o,m)}else if(e.isKezhi()){var E=null;_=d===td.DamageType.PHYSICAL?"Fonts/Fonts_zd_bao_wu":"Fonts/Fonts_zd_bao_fa",g=d===td.DamageType.PHYSICAL?"Fonts_zd_bao_wu":"Fonts_zd_bao_fa";p=r.getNodeFromNodePool(_),cc.isValid(p)||((p=td.GlobalFunction.createLabel("/"+-u,_)).name=g),this._attriEffectNode.addChild(p);y=d===td.DamageType.PHYSICAL?"PVP_wz_kezhi":"PVP_wz_kezhi02",E=r.getNodeFromNodePool(y);cc.isValid(E)?p.addChild(E):((E=new cc.Node).name=y,p.addChild(E),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,y,E)),p.setAnchorPoint(0,.5),E.setAnchorPoint(1,.5),p.x=0,p.y=0,E.x=0,E.y=0,this._attrSubHpCritAction(p,a,o,E)}else{_=d===td.DamageType.PHYSICAL?"Fonts/Fonts_pvp_pugong":"Fonts/Fonts_pvp_fagong",g=d===td.DamageType.PHYSICAL?"Fonts_pvp_pugong":"Fonts_pvp_fagong";p=r.getNodeFromNodePool(_),cc.isValid(p)||((p=td.GlobalFunction.createLabel("/"+-u,_)).name=g),this._attriEffectNode.addChild(p),this._attrSubHpAction(p,a,null)}this._showHurtNum(a,u)}}},_showHurtNum:function(t,e){var i=td.PvpFightManager.getFightType();if(i===td.FightType.WorldBoss||i===td.FightType.Nation_War||i===td.FightType.NationBoss||i===td.FightType.HOLY_BEAST){if(this.hurtLabel.active=!0,this.hurtNumLabel.node.active=!0,this._rightPos[t]&&e<0){this._hurtNum-=e;var n=this._hurtNum;n>1e4&&(this.wan.active=!0,n=Math.round(n/1e4)),this.hurtNumLabel.string=n,this.hurtNumLabel._forceUpdateRenderData(),this.wan.x=this.hurtNumLabel.node.x+this.hurtNumLabel.node.width+4}}else this.hurtLabel.active=!1,this.hurtNumLabel.node.active=!1},_showBuffPlayFont:function(t){this._playFont(t.getHitState(),t.getTargetSid())},_showBuffAttriChange:function(t){var e=t.effect,i=t.func,n=e.getTargetSid();if(this._leftPos[n]||this._rightPos[n]){e.isShowBuff();var a=e.getAttributeMap();a||(a=[]);var o=a[td.SpriteKey.HP],s=!1;if(void 0===o){if(!(o=a[td.SpriteKey.SHIELD]))return;s=!0}var l=t.precent;l&&(o=Math.round(o*l));td.resDef.PvpFight;var c=null;if(o>0){var u="Fonts/Fonts_pvp_zhiliao",d="Fonts_pvp_zhiliao";c=r.getNodeFromNodePool(u),cc.isValid(c)||((c=td.GlobalFunction.createLabel("/"+o,u)).name=d),this._attriEffectNode.addChild(c),this._attrAddHpAction(c,n,i)}else{if(0==(o=-o))return;u=s?"Fonts/Fonts_zd_dun":"Fonts/Fonts_pvp_fagong",d=s?"Fonts_zd_dun":"Fonts_pvp_fagong";if(c=r.getNodeFromNodePool(u),!cc.isValid(c)&&((c=td.GlobalFunction.createLabel("/"+o,u)).name=d,s)){var h=new cc.Node;c.addChild(h),c.getComponent(cc.Label)._forceUpdateRenderData(),h.x=-c.width/2-25,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,"ZD_GY_dun",h)}this._attriEffectNode.addChild(c),this._attrSubHpAction(c,n,i)}}},_attrAddHpAction:function(t,e,i){var n=this._leftPos[e]||this._rightPos[e],a=this._leftPos[e]||!1?-1:1;n=t.getParent().convertToNodeSpaceAR(n);this._leftNodeSize[e]||this._rightNodeSize[e];var o=25-50*Math.random()*a,s=25-50*Math.random();t.setPosition(cc.v2(n.x+0+o,n.y+150+s));var l=cc.director.getScheduler().getTimeScale(),c=cc.scaleTo(.25/l,1),u=cc.moveBy(.5/l,cc.v2(0,40)),d=cc.fadeOut(.75/l);t.runAction(cc.sequence(c,cc.spawn(u,d),cc.callFunc(function(t){t.removeFromParent(!1),r.getNodeFromNodePool(t.name),i&&i()})))},_attrSubHpCritAction:function(t,e,i,n){var a=this._leftPos[e]||this._rightPos[e],o=this._leftPos[e]||!1?-1:1;a=t.getParent().convertToNodeSpaceAR(a);this._leftNodeSize[e]||this._rightNodeSize[e];var s=50*Math.random()*o,l=50*Math.random();t.setPosition(cc.v2(a.x+0+s,a.y+0+l));var c=cc.director.getScheduler().getTimeScale(),u=cc.bezierBy(1/c,[{x:0,y:150},{x:75*o,y:150},{x:75*o,y:0}]),d=cc.fadeOut(1/c);t.runAction(cc.sequence(cc.spawn(u,d),cc.callFunc(function(t){t.removeFromParent(!1),r.getNodeFromNodePool(t.name),i&&i()}))),n&&n.runAction(cc.sequence(d.clone(),cc.callFunc(function(t){t.removeFromParent(!1),r.getNodeFromNodePool(t.name)})))},_attrSubHpAction:function(t,e,i,n){var a=this._leftPos[e]||this._rightPos[e],o=this._leftPos[e]||!1?-1:1;if(a){a=t.getParent().convertToNodeSpaceAR(a);this._leftNodeSize[e]||this._rightNodeSize[e];var s=50*Math.random()*o,l=50*Math.random();t.setPosition(cc.v2(a.x+0+s,a.y+0+l));var c=cc.director.getScheduler().getTimeScale(),u=cc.bezierBy(1/c,[{x:0,y:150},{x:75*o,y:150},{x:75*o,y:0}]),d=cc.fadeOut(1/c);t.runAction(cc.sequence(cc.spawn(u,d),cc.callFunc(function(t){t.removeFromParent(!1),r.getNodeFromNodePool(t.name),i&&i()}))),n&&n.runAction(cc.sequence(d.clone(),cc.callFunc(function(t){t.removeFromParent(!1),r.getNodeFromNodePool(t.name)})))}},_attrMissAction:function(t,e,i){var n=this._leftPos[e]||this._rightPos[e],a=this._leftNodeSize[e]||this._rightNodeSize[e],o=cc.director.getScheduler().getTimeScale();n=t.getParent().convertToNodeSpaceAR(n),t.setPosition(cc.v2(n.x,n.y+a.height/2)),t.setScale(.06),t.opacity=0;var s=cc.scaleTo(1/(12*o),1),l=cc.fadeTo(1/(12*o),84.15),c=cc.scaleTo(1/(12*o),1.2),u=cc.fadeTo(1/(12*o),255*.67),d=cc.scaleTo(1/(12*o),1),h=cc.fadeTo(1/(12*o),255),p=cc.delayTime(.25/o),_=cc.fadeOut(.25/o);t.runAction(cc.sequence(cc.spawn(s,l),cc.spawn(c,u),cc.spawn(d,h),p,_,cc.callFunc(function(t){t.removeFromParent(!1),r.getNodeFromNodePool(t.name),i&&i()})))},_attrRageAction:function(t,e,i){var n=this._leftPos[e]||this._rightPos[e],a=this._leftNodeSize[e]||this._rightNodeSize[e],r=cc.director.getScheduler().getTimeScale();t.setPosition(cc.v2(n.x,n.y+a.height/2)),t.setScale(.06),t.opacity=0;var o=cc.scaleTo(1/(12*r),1),s=cc.fadeTo(1/(12*r),84.15),l=cc.scaleTo(1/(12*r),1.2),c=cc.fadeTo(1/(12*r),255*.67),u=cc.scaleTo(1/(12*r),1),d=cc.fadeTo(1/(12*r),255),h=cc.delayTime(.25/r),p=cc.fadeOut(.25/r),_=cc.moveBy(.25/r,0,75);t.runAction(cc.sequence(cc.spawn(o,s),cc.spawn(l,c),cc.spawn(u,d),h,cc.spawn(p,_),cc.callFunc(function(t){t.removeFromParent(),i&&i()})))},_resumGame:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_FIGHT)},_pauseGame:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSE_FIGHT)},getSkillNode:function(){return this._skillNode},getPos:function(t){return!this._leftPos[t]&&this._rightPos[t],this._leftPos[t]||this._rightPos[t]}});e.exports=o,cc._RF.pop()},{PvPNodePoolManager:"PvPNodePoolManager",PvpFightBuffAnimation:"PvpFightBuffAnimation",PvpFightMercenary:"PvpFightMercenary",RollerDigitalTextAtlas:"RollerDigitalTextAtlas"}],PvpFightEffect:[function(t,e,i){"use strict";cc._RF.push(e,"ddae9PjfPlPLaOXUhvlVAVc","PvpFightEffect");var n=t("Model");td.PvpFightEffect=cc.Class({extends:n,properties:{_targetSid:null,_effectId:null,_effect:null,_type:null,_critical:null,_hitState:null,_attributeMap:null,_isBuffer:null,_endRound:null,_isKezhi:null,_attckerFeature:null,_durationType:null,_buffEffect:null,_attackerId:0,_damageType:0,_isAdd:0,_fontImg:null,_buffValue:0},init:function(t,e,i,n,a){this._super("PvpFightEffect"),this.reuse(t),this._isKezhi=e,this._attckerFeature=i,this._attackerId=n||0,this._damageType=a},reuse:function(t){if(this._targetSid=t.targeterUid,this._effectId=t.effectId,this._effectId>0){var e=td.GetTableClass(td.TableEnum.SkillEffect).getDataById(this._effectId);this._type=e.effectType,this._isAdd=e.isAdd,this._fontImg=e.fontImg,this._fontImgShowType=e.fontImgShowType}else this._type=0,this._isAdd=!1,this._fontImg="",this._fontImgShowType=0;if(this._attributeMap=t.attributeMap,this._critical=t.critical,this._hitState=t.hitState,this._isBuffer=!!t.buff,this._isBuffer){var i=t.buff.key||{};this._buffIdentifys=i.identifys,this._buffValue=t.buff.value}},unuse:function(){this._targetSid=null,this._effectId=null,this._effect=null,this._type=null,this._animationType=null,this._animationName=null,this._buffEffect=null},setBuffEffect:function(t){this._buffEffect=t},getBuffValue:function(){return this._buffValue},getBuffEffect:function(){return this._buffEffect},getEffectType:function(){return this._type},getEffectId:function(){return this._effectId},getDamageType:function(){return this._damageType},getTargetSid:function(){return this._targetSid},getAttackerId:function(){return this._attackerId},isCanShowBuff:function(t){var e=parseInt(this._durationType),i=!1,n=this._targetSid,a=this._effectId;switch(cc.log("targetId="+n+"effectId="+a),e){case td.BuffDurationType.ROUND:i=this._endRound>=t;break;case td.BuffDurationType.ATTACK_NUM:case td.BuffDurationType.UNDER_ATTACK_NUM:i=this._endRound>0}return i},setBuffState:function(t,e){var i=parseInt(this._durationType);if(i===td.BuffDurationType.ATTACK_NUM)t===this._targetSid&&this._endRound--;else if(i===td.BuffDurationType.UNDER_ATTACK_NUM)for(var n=0,a=(e=e||[]).length;n<a;n++)if(e[n]===this._targetSid)return void this._endRound--},getType:function(){return this._type},isSuckBlood:function(){return this._effectId===td.FightEffectIdEnum.SuckBlood},isAddHp:function(){return this._type===td.FightEffectType.AddHp},isSubstitute:function(){return this._type===td.FightEffectType.SUBSTITUTE_BUFF_EFFECT},isCritical:function(){return this._critical},getHitState:function(){return this._hitState},isMiss:function(){return this._hitState==td.HitState.MISS},isImmune:function(){return this._hitState==td.HitState.IMMUNE},isRemoveBuff:function(){return this._hitState==td.HitState.REMOVE_BUFF},isForbidHeal:function(){return this._hitState==td.HitState.FORBID_HEAL},isShowBuff:function(){return this._hitState==td.HitState.BUFF},isSharingDamage:function(){return this._hitState==td.HitState.SHARING_DAMAGE},isSubstituteDamage:function(){return this._hitState==td.HitState.SUBSTITUTE_DAMAGE},isDamageLimit:function(){return this._hitState==td.HitState.DAMAGE_LIMIT},getAttributeMap:function(){return this._attributeMap},isBuffShow:function(){return this._isBuffer},getBuffIdentifys:function(){return this._buffIdentifys},getEndRound:function(){return this._endRound},isKezhi:function(){return this._isKezhi},getAttackerFeature:function(){return this._attckerFeature},isAdd:function(){return this._isAdd},getFontImg:function(){return this._fontImg},getFontImgShowType:function(){return this._fontImgShowType}}),cc._RF.pop()},{Model:"Model"}],PvpFightEnum:[function(t,e,i){"use strict";cc._RF.push(e,"71cc9bPr2FEB5oKfLKc/qQL","PvpFightEnum"),td.PvpHeroScale=1.4,td.PvpEvilGodScale=2,td.SpriteKey={NONE:0,Sid:1,GamerId:2,ConfigId:3,Camp:4,Position:5,SpriteType:6,HP:30,MaxHp:32,RAGE:35,MaxRage:36,SHIELD:100,FINAL_HP:101,HERO_CAMP:102},td.SpriteType={HERO:1,MONSTER:2,PET:3},td.MercenaryStateEnum=[],td.MercenaryState={Idle:"idle",GEN_ATK:"gen_attack",SKILL_ATK:"skill_attack",UNDER_ATK:"under_attack",Dead:"die",Move:"move",RUN:"run",Back:"back",Hit:"hit"},td.BattleCamp={NONE:0,LEFT:1,RIGHT:2},td.HitState={NONE:0,HIT:1,MISS:2,IMMUNE:3,REMOVE_BUFF:4,FORBID_HEAL:5,BUFF:6,SHARING_DAMAGE:7,SUBSTITUTE_DAMAGE:8,DAMAGE_LIMIT:9,DAMAGE_REDUCTION:10},td.SkillAtkType={NONE:0,ATK_NEAR:1,ATK_FAR:2},td.FightState={NONE:"none",ROUND_PREPARE:"roundPrepare",ROUND_START:"roundStart",UNITFIGHT_PREPARE:"unitFightPrepare",UNITFIGHT_START:"unitFightStart",UNITFIGHT_ENDED:"unitFightEnded",ROUND_ENDED:" roundEnded"},td.FightPlayFinishEnum=["heroActionBack","underAtkFinish","underAnimationFinish"],td.EffectEnum={100:"HpBuffEffect",101:"AtkBuffEffect",102:"ArmorBuffEffect",103:"PhysicalArmorBuffEffect",104:"SpellArmorBuffEffect",105:"StunBuffEffect",106:"BufferImmuneControlEffect"},td.FightShowType={atkAction:1,trajectory:2,skillAnimation:3,atk_skillAnimation:4,atkAnimation:5,skillAnimation2:6},td.SkillAnimationShowType={target:1,row_enemy:2,row_mine:3,center_enemy:4,center_mine:5,release:6,col_enemy:7,col_mine:8,targets_middle_enemy:9,targets_middle_mine:10},td.TBSFightResultEnum={None:0,SUCCESS:1,FAILURE:2},td.BUFF_TYPE={suolian:119,xuanyun:105},td.BuffExpressionType={None:0,Sprite:1,Anim:2},td.BuffDurationType={ROUND:1,ATTACK_NUM:2,UNDER_ATTACK_NUM:3},td.FightType={None:0,Arena:1,NationBoss:2,Pagoda:3,WorldBoss:4,STAR_UP_ROAD:5,ENDLESS:6,StoryHandUp:70,WHOLE_BOSS:7,Abyss:8,Nation_Copy:9,Nation_Endless:10,Nation_King:11,Nation_War:12,Plunder:13,Siege:15,EVIL_GOD:16,TREASURE_SNATCH:17,PURPLE_FAIRYLAND:18,WHOLE_ATTEND:19,WONDERLAND_ADVENTURE:20,CROSS_ARENA:21,HOLY_BEAST:22,BABEL:23,CROSS_CUP:24,NATION_DUEL:25,LEGEND:26,COMPETE:27,MAZE_PVE:28,MAZE_PVP:29,TANGLED_HELL:30,DESTROY_TEMPLE:100,PREVIEW_FIGHT:999},td.FightFormationType={None:0,Hero:1,Monster:2},td.FightEffectIdEnum={Bounces:-1,SuckBlood:-2,AttackRage:-3,UnderAttackRage:-4},td.FightEffectType={AddHp:2,SUBSTITUTE_BUFF_EFFECT:128},td.DirType={Right:1,RightUp:2,Up:3,LeftUp:4,Left:5,LeftDown:6,Down:7,RightDown:8},td.DirTypeEulerAngles={1:cc.v3(0,-90,0),2:cc.v3(0,-45,0),3:cc.v3(0,0,0),4:cc.v3(0,45,0),5:cc.v3(0,90,0),6:cc.v3(0,135,0),7:cc.v3(0,180,0),8:cc.v3(0,-135,0)},td.DamageType={NONE:0,PHYSICAL:1,SPELL:2,REAL:3},td.PvpFeatureImg={1:"PVP_zhiye_01",2:"PVP_zhiye_02",3:"PVP_zhiye_03",4:"PVP_zhiye_04"},cc._RF.pop()},{}],PvpFightFailView:[function(t,e,i){"use strict";cc._RF.push(e,"796402JBYdK67Ww9XqAsFnC","PvpFightFailView");var n=p(t("../../../fight/pvp/Model/PvpFsmEventId")),a=p(t("../../../Endless/Manager/EndlessManager")),r=p(t("../../../DestroyTemple/Manager/DestroyTempleManager")),o=p(t("../../../../Common/Component/GridLayoutComponent")),s=p(t("../../../Nation/Manager/NationCityWarManager")),l=p(t("../../../Nation/Manager/NationDuelManager")),c=p(t("../../../Legend/Manager/LegendManager")),u=p(t("./MazeHurtNodeUI")),d=p(t("../../../CrossArena/Manager/CrossArenaManager")),h=t("../../../Nation/Enum/NationEnum");function p(t){return t&&t.__esModule?t:{default:t}}var _=t("HurtStaticsView");cc.Class({extends:cc.Component,properties:{imgLight:cc.Node,rewardNode:cc.Node,hurtNode:cc.Node,tipNode:cc.Node,nodeLegend:cc.Node,nodeMaze:cc.Node,labTip_1:cc.Node,labTip_2:cc.Node,developPanel:cc.Node,_posY:200,_fightResult:null},start:function(){},onDestroy:function(){this._fightResult=null},onEnable:function(){this.playLightAction(),td.UIAdaptiveUtil.AdaptivePanelBaseResetRootSize(this.node)},playLightAction:function(){var t=cc.rotateBy(1,30),e=cc.repeatForever(t);this.imgLight.runAction(e)},setData:function(t){this._fightResult=t,this._posY=200,this._showResultInfo()},_showResultInfo:function(){if(!this._fightResult)return this.developPanel.active=!0,this.labTip_1.active=!0,this.labTip_2.active=!0,this.rewardNode.active=!1,void(this.hurtNode.active=!1);var t=this._fightResult.getFightType();t===td.FightType.Siege?(this.developPanel.active=!1,this.labTip_1.active=!1,this.labTip_2.active=!1,this._setRewardNode(),this._setHurtNode()):t===td.FightType.LEGEND?(this._setLegendNode(),this.developPanel.active=!1,this.rewardNode.active=!1,this.hurtNode.active=!1,this.labTip_1.active=!1,this.labTip_2.active=!1):t===td.FightType.MAZE_PVE||t===td.FightType.MAZE_PVP?(this._setMazeNode(),this.developPanel.active=!1,this.rewardNode.active=!1,this.hurtNode.active=!1,this.labTip_1.active=!0,this.labTip_2.active=!1):(this.developPanel.active=!0,this.labTip_1.active=!0,this.labTip_2.active=!0,this.rewardNode.active=!1,this.hurtNode.active=!1),this.tipNode.active=!1,t===td.FightType.NATION_DUEL&&(this.developPanel.active=!1,this.labTip_1.active=!1,this.labTip_2.active=!1,this._setTipNode())},_setTipNode:function(){this.tipNode.active=!0;var t=l.default.getInstance().getChangeStar(),e=l.default.getInstance().getChangePoint(),i=this.tipNode.getChildByName("lab_star"),n=this.tipNode.getChildByName("lab_point");i.getComponent(cc.Label).string=t,n.getComponent(cc.Label).string=e},_setHurtNode:function(){this.hurtNode.active=!0,this.hurtNode.zIndex=98;var t=this.hurtNode.getChildByName("imgTitle"),e=this.hurtNode.getChildByName("labHurt"),i=this._fightResult.getDamages(),n="JS_wz_bcsh";if(this._fightResult.getFightType()===td.FightType.Siege){var a=s.default.getInstance().getNationWarData();if(a)a.getState()===h.SiegeState.NATION_BATTLE&&(n="JS_wz_pccf")}td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.JS_jiesuan,n,t);var r="number"==typeof i?i:i[td.BattleCamp.LEFT].TotalDamages;e.getComponent(cc.Label).string=r,this.hurtNode.y=this._posY,this._posY-=this.hurtNode.height},_setRewardNode:function(){var t=this._fightResult.getRewardList();t&&t.length>0?(this.rewardNode.active=!0,this.rewardNode.zIndex=99,this._setItemRewards(t),this.rewardNode.y=this._posY,this._posY-=this.rewardNode.height):this.rewardNode.active=!1},_setItemRewards:function(t){var e=t?t.length:0;if(0!==e){var i=null,n=this.rewardNode.getChildByName("rewardPanel");this._treasureData=null;for(var a=[],r=(this._fightResult,0);r<e;r++){var s=t[r];a.push(s)}e=a.length;for(var l=0;l<e;l++){i=a[l];var c=td.GlobalFunction.getItemIcon(27,i.type,i.id,i.count,!0);if(c.setScale(.9),i.isExtra){var u=this._createExtraImg();c.addChild(u,10)}n.addChild(c),c.getComponent("CommonIconWidget").disableHeadTouch()}n.getComponent(o.default).updateLayout(),this.rewardNode.height=n.height+Math.abs(n.y)}},_createExtraImg:function(){var t=td.resdef.Meishuzi.MSZ_ewai;return td.GlobalFunction.createSprite(t),extraImg},_setLegendNode:function(){if(c.default.getInstance().isReplay())this.returnToMainScene();else{this.nodeLegend.active=!0,this.nodeLegend.zIndex=98;var t=this.nodeLegend.getChildByName("labScore").getComponent(cc.Label),e=this.nodeLegend.getChildByName("labAreaRankChange").getComponent(cc.Label),i=this.nodeLegend.getChildByName("labAreaRank").getComponent(cc.Label),n=this.nodeLegend.getChildByName("labAreasRank").getComponent(cc.Label),a=this.nodeLegend.getChildByName("labAllAreasRank").getComponent(cc.Label),r=td.Language.notInRank;t.string=c.default.getInstance().getResultChangeScore();var o=cc.js.formatStr(td.Language.resultRankDown,Math.abs(c.default.getInstance().getChangeServerRank()));e.node.active=0!=c.default.getInstance().getChangeServerRank(),e.string=o,i.string=c.default.getInstance().getServerRank()||r,n.string=c.default.getInstance().getZoneRank()||r,a.string=c.default.getInstance().getGlobalRank()||r,c.default.getInstance().setReportTmp(null)}},_setMazeNode:function(){this.nodeMaze.active=!0,u.default.showNode(this.nodeMaze,td.PvpFightManager.getFightResult())},goToSummonPanel:function(){td.PanelManager.getInstance().clearShowPanelQueue(),td.PanelJumpManager.setDestination(td.PanelEnum.Panel_Gacha),this.returnToMainScene(td.PanelEnum.Panel_Gacha)},goToEquipBag:function(){td.PanelManager.getInstance().clearShowPanelQueue(),td.PanelJumpManager.setDestination(td.PanelEnum.Panel_Bag,{showTab:td.GoodsType.Type_Equip}),this.returnToMainScene(td.PanelEnum.Panel_Bag)},goToHuntTreasure:function(){if(td.PanelManager.getInstance().clearShowPanelQueue(),!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.HuntTreasure,1,!0))return td.PanelJumpManager.setDestination(td.PanelEnum.Panel_PVE_FIGHT_HOOK),void this.returnToMainScene();td.PanelJumpManager.setDestination(td.PanelEnum.Panel_HuntTreasure),this.returnToMainScene(td.PanelEnum.Panel_HuntTreasure)},goToLineup:function(){td.PanelManager.getInstance().clearShowPanelQueue(),td.PanelJumpManager.setDestination(td.PanelEnum.Panel_BattleArray),this.returnToMainScene(td.PanelEnum.Panel_BattleArray)},onBtnHurtClick:function(){var t=this;gdk.rm.loadRes(null,"prefab/Pvp/HurtStaticsLayer",cc.Prefab,function(){var e=gdk.rm.getResByUrl("prefab/Pvp/HurtStaticsLayer"),i=cc.instantiate(e);i.getComponent(_).setData(td.PvpFightManager.getFightResult()),t.node.addChild(i,td.PvpFightLayerTag.ZOrder_Hurt_Layer,td.PvpFightLayerTag.ZOrder_Hurt_Layer+"")})},clickThis:function(t){this.returnToMainScene()},returnToMainScene:function(t){void 0===t&&(t=0),td.PvpFightManager.getFightType()==td.FightType.ENDLESS&&a.default.getInstance().getSelect()||td.PvpFightManager.getFightType()==td.FightType.DESTROY_TEMPLE&&r.default.getInstance().getIsSkipBattle()||this._fightResult.getFightType()==td.FightType.CROSS_ARENA&&d.default.getInstance().isJumpFight()?(td.EventUtil.dispatchEvent(td.EventNameEnum.CLOSE_ENDLESS_RESULT_PANEL),t&&td.PanelJumpManager.jumpToPanel(t)):(td.EventUtil.dispatchEvent(td.EventNameEnum.EXIT_PVP_SCENE),gdk.fsm.Fsm.broadcastEvent(n.default.ENTER_MAIN_SCENE))}}),cc._RF.pop()},{"../../../../Common/Component/GridLayoutComponent":void 0,"../../../CrossArena/Manager/CrossArenaManager":"CrossArenaManager","../../../DestroyTemple/Manager/DestroyTempleManager":"DestroyTempleManager","../../../Endless/Manager/EndlessManager":"EndlessManager","../../../Legend/Manager/LegendManager":"LegendManager","../../../Nation/Enum/NationEnum":"NationEnum","../../../Nation/Manager/NationCityWarManager":"NationCityWarManager","../../../Nation/Manager/NationDuelManager":"NationDuelManager","../../../fight/pvp/Model/PvpFsmEventId":"PvpFsmEventId","./MazeHurtNodeUI":"MazeHurtNodeUI",HurtStaticsView:"HurtStaticsView"}],PvpFightFormation:[function(t,e,i){"use strict";cc._RF.push(e,"f0435qm1qZIM7CooJoARbPE","PvpFightFormation");var n=t("Model");td.PvpFightFormation=cc.Class({extends:n,properties:{GridNum:11,_mercenarys:null,_totalHp:0,_curTotalHp:0},ctor:function(){this._mercenarys=[],this._mercenarys.length=this.GridNum},parsePacket:function(t){this._mercenarys=[],this._mercenarys.length=this.GridNum,t||(t=[]),this._totalHp=0,this._curTotalHp=0;for(var e=0,i=t.length-1;e<=i;e++){var n=t[e];this.addMercenarySprite(n)}},addMercenarySprite:function(t){var e=t.attributes,i=parseInt(e[td.SpriteKey.SpriteType]),n="MercenaryFightModel";switch(i){case td.SpriteType.HERO:n="MercenaryFightModel";break;case td.SpriteType.MONSTER:n="MonsterFightModel";break;case td.SpriteType.PET:n="PetFightModel"}var a=new td[n];return a.init(t),i!==td.SpriteType.PET&&(this._totalHp+=a.getMaxHp(),this._curTotalHp+=a.getHp()),this._mercenarys[a.getPos()]=a,a},refreshMercenaryData:function(t){var e=t.getPos();this._totalHp-=this._mercenarys[e].getMaxHp(),this._mercenarys[e]&&(this._mercenarys[e]=null),this._totalHp+=t.getMaxHp(),this._curTotalHp+=t.getHp(),this._mercenarys[e]=t},getMercenarys:function(){return this._mercenarys},getPets:function(){for(var t=[],e=0,i=this._mercenarys.length;e<i;e++){var n=this._mercenarys[e];n&&(n.getBaseModel().getModelShowType()==td.SpriteType.PET&&t.push(n))}return t},getMaxHp:function(){return this._totalHp},getCurTotalHp:function(){return this._curTotalHp}}),cc._RF.pop()},{Model:"Model"}],PvpFightLoader:[function(t,e,i){"use strict";cc._RF.push(e,"1ec71NzIpVBSreUkxOzHm28","PvpFightLoader"),td.PvpFightLoader={getModels:function(){this.getPvpRandomBg();var t=[];return t=(t=t.concat(this.getMercenaryModel())).concat(this.getFightResultPanelModel(),this.getBuffExpressionModel()),td.GuideManager.isDoingEndlessGuide()&&(t=t.concat(["fightRes/pve/otherAnimation/ZhaoHuanYingXiong/Zhaohuanyingxiong"])),t.concat(["PvpRandomBg"])},getPvpRandomBg:function(){var t=gdk.ResourceId.getValue("PvpRandomBg");t.SpriteFrame.resArray=[];for(var e=td.PvpFightManager.getFightType(),i=td.GetTableClass(td.TableEnum.Config).getConfig("pvpRandomBg"),n=[1,2,3,4,5],a=0,r=i.length;a<r;a++){var o=i[a];if(o[0]===e){n=o[1];break}}var s=n[0],l=n[n.length-1],c=Math.floor(Math.random()*(l-s+1)+s),u=cc.js.formatStr("backdrop/PVPfight_%s",c);td.PvpFightManager.setPvpFightBg(u),t.SpriteFrame.resArray.push(u)},getMercenaryPrepareLoad:function(t,e){return td.ModuleManager.getHeroesModule(t,e)},getMercenaryModel:function(t){var e=td.PvpFightController.getInstance().getFightMembers(),i=[],n=td.PvpFightManager.getFightType();for(var a in e){for(var r=e[a].getFormation().getMercenarys(),o=[],s=0,l=r.length-1;s<=l;s++){var c=r[s];c&&(c=c.getBaseModel(),o[o.length]=c)}i=e[a].getCamp()!==td.BattleCamp.RIGHT?i.concat(td.ModuleManager.getHeroesModule(o,t)):n===td.FightType.PREVIEW_FIGHT?i.concat(td.ModuleManager.getMonstersModule(o,td.PvpLoadPart.FIRST)):i.concat(td.ModuleManager.getMonstersModule(o,t))}var u=[],d=0;for(l=i.length;d<l;d++)-1===u.indexOf(i[d])&&(u[u.length]=i[d]);return u},getRightMercenaryModel:function(t){var e=td.PvpFightController.getInstance().getFightMembers(),i=[],n=[],a=[];for(var r in e){for(var o=e[r].getFormation().getMercenarys(),s=[],l=0,c=o.length-1;l<=c;l++){var u=o[l];u&&(u=u.getBaseModel(),s[s.length]=u)}e[r].getCamp()!==td.BattleCamp.RIGHT?n=n.concat(td.ModuleManager.getMonstersModule(s,t)):a=a.concat(td.ModuleManager.getMonstersModule(s,t))}var d=0;for(c=a.length;d<c;d++)-1===n.indexOf(a[d])&&(i[i.length]=a[d]);return i},getMercenaryModuleById:function(t){var e=td.GlobalFunction.getGoodsData(td.GoodsType.Type_Mercenary,t,1);return td.ModuleManager.getHeroesModule(e)},getMercenaryModuleByQuality:function(t){var e=[],i=td.GetTableClass(td.TableEnum.Mercenary).getRoleDataListByType(t);for(var n in i){var a=new td.Mercenary;a.init(i[n]),e[e.length]=a}return td.ModuleManager.getHeroesModule(e)},getFightResultPanelModel:function(){return["PvpFightResultLayer"]},getBuffExpressionModel:function(){var t=td.PvpFightController.getInstance().getFightData().reports,e=[];for(var i in t)for(var n=t[i].getFightReports(),a=0,r=n.length-1;a<=r;a++){n[a].getSkillEffects().forEach(function(t,i,n){var a=td.GetTableClass(td.TableEnum.SkillEffect).getDataById(t.getEffectId());if(a){var r=[],o=[];if(a.buffPrefabRes&&(o[o.length]=a.buffPrefabRes),a.buffExpression&&a.buffExpression[0]===td.BuffExpressionType.Anim){var s="buff_"+t.getEffectId();r[r.length]=a.buffExpression[1]}if(a.buffExpressionBefore&&a.buffExpressionBefore[1]&&a.buffExpressionBefore[0]===td.BuffExpressionType.Anim){s="buffBefore_"+t.getEffectId();r[r.length]=a.buffExpressionBefore[1]}if(a.triggerAnima){s="triggerAnim_"+t.getEffectId();r[r.length]=a.triggerAnima,o[o.length]=a.triggerAnima}var l=gdk.ResourceId.getValue(s);l||((l={})[s]={},gdk.ResourceId.mixins(l),l=l[s]),l.buff_res={type:cc.Prefab,resArray:o},ArrayUtils.contains(e,s)||(e[e.length]=s)}})}return e}},cc._RF.pop()},{}],PvpFightMainView:[function(t,e,i){"use strict";cc._RF.push(e,"8fcc1qNpt9JHrMLuq569tFR","PvpFightMainView");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../Babel/Manager/BabelManager"));var a=t("PanelBase"),r=t("PvpFightRoleLayer"),o=t("PvpFightEffectView"),s=t("PvpFightResultView");cc.Class({extends:a,init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_PvpFightMainView},start:function(){cc.game.setFrameRate(60),td.EventUtil.dispatchEvent(td.EventNameEnum.STOP_SOUND,"background"),this._addFightBg(),this._setSceneOther(),this.node.addChild(td.PvpFightController.getInstance()),this._addEventListener(),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_MUSIC,td.SoundEnum.PvpFightSoundId)},onDisable:function(){this._removeEventListener(),td.PvpFightController.removeInstance()},_addEventListener:function(){var t=td.EventNameEnum,e={};e[t.PREPARE_UNIT_FIGHT_PLAY]=this._prepareUnitFightPlay,e[t.STOP_FIGHT_NOW]=this._stopFightNow,e[t.SHOW_FIGHT_RESULT_PANEL]=this._showFightResultPanel,e[t.END_PLAY_FIGHT]=this._finishedPlay,td.EventUtil.registerEvents(e,this)},_removeEventListener:function(){td.EventUtil.unregisterAllEvents(this)},_addFightBg:function(){var t=td.UIAdaptiveUtil.getMaxScale(),e=(td.UIAdaptiveUtil.getWinSize(),td.resDef.background.zhandouBG_05),i=new cc.Node;i.addComponent(cc.Sprite);td.GlobalFunction.createSpriteNode(i,e),i.setScale(t),this.node.addChild(i,td.PvpFightLayerTag.ZOrder_Bg_Layer,td.PvpFightLayerTag.ZOrder_Bg_Layer+""),i.opacity=0,i.runAction(cc.fadeIn(.3))},_setSceneOther:function(){var t=this._addFightRoleLayer(),e=gdk.rm.getResByUrl("prefab/Pvp/PvpFightUI",cc.Prefab);e=cc.instantiate(e),this.node.addChild(e,td.PvpFightLayerTag._ZOrder_Fight_UI,td.PvpFightLayerTag._ZOrder_Fight_UI+"");var i={};i.leftNodes=t.getLeftNodes(),i.rightNodes=t.getRightNodes();var n=cc.instantiate(gdk.rm.getResByUrl("prefab/Pvp/PvpBaseLayer",cc.Prefab));n.addComponent(o).init(i),this.node.addChild(n,td.PvpFightLayerTag.ZOrder_Effect_Layer,td.PvpFightLayerTag.ZOrder_Effect_Layer+""),td.EventUtil.dispatchEvent(td.EventNameEnum.START_PLAY_FIGHT,td.SceneName.PvpFightScene)},_addFightRoleLayer:function(){var t=td.PvpFightManager.getFightType(),e=td.PvpFightController.getInstance().getFightMembers(),i=gdk.rm.getResByUrl("prefab/Pvp/PvpFightRoleLayer",cc.Prefab),n=cc.instantiate(i),a=n.getComponent(r);return a.init(t,e),this.node.addChild(n,td.PvpFightLayerTag.ZOrder_Role_Layer,td.PvpFightLayerTag.ZOrder_Role_Layer+""),a},_prepareUnitFightPlay:function(t){for(var e=t.report,i=(e.isGenAttack(),e.getSkillEffects()),n=td.FightEffectIdEnum,a=0,r=i.length-1;a<=r;a++){var o=i[a];if(o)if(o.getEffectId()!==n.AttackRage){!0;break}}var s,l={};(s=this.node.getChildByName(td.PvpFightLayerTag.ZOrder_Role_Layer+""))?(l.leftNode=s.getChildByName("leftNode"),l.rightNode=s.getChildByName("rightNode"),td.PvpFightPlayController.initNode(l)):td.GameFightError(td.FightType.None)},_finishedReportPlay:function(){},_stopFightNow:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSEROLELAYER)},_finishedPlay:function(){if(td.PvpFightManager.getFightType()===td.FightType.BABEL&&-1!=n.default.getInstance().checkShowSkillType())return;var t=this.node.getChildByName(td.PvpFightLayerTag.ZOrder_Fight_UI+"");t&&(t.active=!1),(t=this.node.getChildByName(td.PvpFightLayerTag.ZOrder_Effect_Layer+""))&&(t.active=!1)},_showFightResultPanel:function(){var t=gdk.rm.getResByUrl("prefab/Pvp/PvpFightResultLayer"),e=cc.instantiate(t);e.getComponent(s).setData(td.PvpFightManager.getFightResult()),this.node.addChild(e,td.PvpFightLayerTag.ZOrder_Result_Layer,td.PvpFightLayerTag.ZOrder_Result_Layer+"")}});cc._RF.pop()},{"../../../Babel/Manager/BabelManager":"BabelManager",PanelBase:void 0,PvpFightEffectView:"PvpFightEffectView",PvpFightResultView:"PvpFightResultView",PvpFightRoleLayer:"PvpFightRoleLayer"}],PvpFightManager:[function(t,e,i){"use strict";cc._RF.push(e,"38cbcC2DVBEX5o+bt4/OEwS","PvpFightManager");var n=f(t("../../../fight/pvp/Model/PvpFsmEventId")),a=f(t("../../../Endless/Manager/EndlessManager")),r=f(t("../../../Treasure/Manager/TreasureManger")),o=f(t("../../../Nation/Manager/NationBossManager")),s=f(t("../../../Pulse/Manager/PulseManager")),l=f(t("../../../DestroyTemple/Manager/DestroyTempleManager")),c=t("../../../WorldBoss/Enum/WorldBossEnum"),u=f(t("../../../Babel/Manager/BabelManager")),d=f(t("../../../Legend/Manager/LegendManager")),h=f(t("../../../Nation/Manager/NationDuelManager")),p=f(t("../../../Maze/Manager/MazeManager")),_=f(t("../../../CrossArena/Manager/CrossArenaManager")),g=f(t("../../../EvilGodCopy/Mananger/EvilGodManager"));function f(t){return t&&t.__esModule?t:{default:t}}td.PvpFightManager={_fightPacket:null,_fightData:null,_onHookFightData:null,_fightResult:null,_curCopyData:null,_fightType:null,_pvpEffectLayer:null,_pvpBgLayer:null,_pvpRoleLayer:null,_curActivityType:null,_babelFightPacket:null,_myDeathNum:null,_killEnemyNum:null,_curFightBg:null,init:function(){this.destroyData(),this._addListener(),this._addEventListener()},destroyData:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.STOP_FIGHT_NOW),td.EventUtil.dispatchEvent(td.EventNameEnum.STOP_ONHOOK_FIGHT_NOW),this._fightPacket=null,this._fightData=null,this._onHookFightData=null,this._curActivityType=null,this._curFightBg=null},_addListener:function(){var t=td.MsgModuleName.BATTLE,e=td.MsgCmd.TBSBattle;td.ServerDelegate.registerMessage(t,e.BATTLE_TEST,this._onFightResultReturn.bind(this)),td.ServerDelegate.registerMessage(t,e.PUSH_BATTLE_RESULT,this._onFightResultPushReturn.bind(this))},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REQUEST_FIGHT]=this._requestFight,t[e.END_PLAY_FIGHT]=this._finishedPlay,t[e.PARSE_FIRST_FIGHT_PACKET]=this._parseFirstFightPacket,t[e.SHOW_PVERIEW_FIGHT]=this._setPreviewFight,t[e.ADD_PVP_SPECIAL_HERO]=this._addPvpSpecialHero,t[e.RESUME_BABEL_FIGHT_PACKET]=this._resumeBabelFight,t[e.GO_FIGHT_SCNEN_PLAY]=this._parseFightResultPacket,td.EventUtil.registerEvents(t,this)},setPvpFightBg:function(t){t||(t="backdrop/PVPfight_1"),this._curFightBg=t},getPvpFightBg:function(){return this._curFightBg},_requestFight:function(t){var e={};e.module=td.MsgModuleName.BATTLE,e.cmd=td.MsgCmd.TBSBattle.BATTLE_TEST,e.targetId=t,td.ServerDelegate.sendMessage(e)},_onFightResultReturn:function(t,e){t===td.NetCode.SUCCESS&&cc.log(e)},_setPreviewFight:function(t){t=(t=t.report).replace(/'/g,'"'),t=JSON.parse(t),this._onFightResultPushReturn(td.NetCode.SUCCESS,t)},firstFightPush:function(t){this._onFightResultPushReturn(td.NetCode.SUCCESS,t)},_onFightResultPushReturn:function(t,e){if(t===td.NetCode.SUCCESS){if(td.GuideManager.isDoingEndlessGuide()){var i=td.PvpFirstBattleUtil.getEndlessFirstBattlePacket();i.reward=e.reward,e=i}this._parseFightResultPacket(e)}},_parseFightResultPacket:function(t){if(t&&t.type==td.FightType.BABEL&&(this._babelFightPacket=t),!t||t.type!=td.FightType.LEGEND||!this._checkLegendBattleHandleBreak(t)){if(t&&t.type==td.FightType.EVIL_GOD){var e=g.default.getInstance().isMoreTimesBattle(),i=g.default.getInstance().isRequestBattle();if(e||i)return void g.default.getInstance().pushFightResult(t)}this._isFightPause||(cc.log(t),td.testPVP=td.GlobalFunction.copyData(t),this._parseFightPacket(t),this._setFightData(t),this._startPlayFight(t),this._setReshowData(t),this._setDestination(t),this._parseKillEnemyNum(t))}},_checkLegendBattleHandleBreak:function(t){return!!d.default.getInstance().isAutoFight()||!d.default.getInstance().isReplay()&&(d.default.getInstance().setReportTmp(t),!d.default.getInstance().isModelShowReady())},_parseKillEnemyNum:function(t){for(var e=t.members,i=null,n=td.Account.getUserData().getGamerId(),a=0,r=e.length;a<r;a++){var o=e[a];if(o.attributeMap[td.UserPropertyEnum.GamerId]!==n){i=o;break}}this._killEnemyNum=0;for(var s=i.sprites,l=0,c=s.length;l<c;l++){0===s[l].attributes[td.SpriteKey.FINAL_HP]&&this._killEnemyNum++}},getKillEnemyNum:function(){return this._killEnemyNum},_parseFirstFightPacket:function(t){this._parseFightPacket(t),this._setFightData(t)},_parseFightPacket:function(t){var e,i,n=!t||t.type==td.FightType.StoryHandUp,a=t.type==td.FightType.PREVIEW_FIGHT;t?t.type!=td.FightType.StoryHandUp?(this._fightPacket=t,i=t):i=t:i=this._fightPacket,n?(this._onHookFightData={},e=this._onHookFightData):(this._fightData={},e=this._fightData),e.fightType=parseInt(t.type),this._fightType=e.fightType,td.DataReporter.onEvent("PvpFight_"+this._fightType);var r=i.members;if(this._fightType===td.FightType.WorldBoss&&(t.rightHistorySprite=t.rightHistorySprite||[],t.rightHistorySprite.length>0)){for(var o=t.rightHistorySprite.shift(),s=null,l=0,c=r.length-1;l<=c;l++)2==r[l].camp&&(s=r[l].sprites.shift(),r[l].sprites=[o]);t.rightHistorySprite[t.rightHistorySprite.length]=s}var u={};for(l=0,c=r.length-1;l<=c;l++){var d=new td.PvpFightUserModel;d.init(e.fightType,r[l]),u[d.getCamp()]=d}e.members=u;var h={},p=i.reports,_=i.showSIds;for(var g in _||(_={}),p){var f=new td.PvpFightRound;f.init(e.fightType,g,p[g],_[g]),h[g]=f}e.reports=h,n||a||(this._fightResult=new td.PvpFightResult,this._fightResult.init(i),this._checkDiamondAndGoldNeedPauseRefresh(this._fightResult.getRewardList()),this._calcFightResult())},_checkDiamondAndGoldNeedPauseRefresh:function(t){if(t)for(var e=0;e<t.length;e++){var i=t[e];i.type===td.GoodsType.Type_Item&&(i.id===td.ItemEnum.Diamond?td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSE_UPDATE_MAIN_LAYER_DIAMOND):i.id===td.ItemEnum.Gold&&td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSE_UPDATE_MAIN_LAYER_GOLD))}},_parseSnatch:function(t){},_setFightData:function(t){td.PvpFightController.getInstance().init(this._fightData)},getFightData:function(){return this._fightData},resetFightData:function(){cc.log("resetFightData"),this._fightData=null,this._fightResult=null},resetOnHookFightData:function(){cc.log("resetOnHookFightData"),this._onHookFightData=null},_startPlayFight:function(t){switch(parseInt(t.type)){case td.FightType.StoryHandUp:td.EventUtil.dispatchEvent(td.EventNameEnum.PREPARE_PLAY_FIGHT);break;case td.FightType.ENDLESS:a.default.getInstance().getSelect()?td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_ENDLESS_RESULT_PANEL):gdk.fsm.Fsm.broadcastEvent(n.default.ENTER_PVP_SCENE);break;case td.FightType.NationBoss:if(o.default.getInstance().getIsSweep()){var e=new td.PvpFightResult;e.init(t),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_NATION_BOSS_SWEEP,e)}else gdk.fsm.Fsm.broadcastEvent(n.default.ENTER_PVP_SCENE);break;case td.FightType.DESTROY_TEMPLE:l.default.getInstance().getIsSkipBattle()?td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_DESTROY_TEMPLE_FIGHT_RESULT):gdk.fsm.Fsm.broadcastEvent(n.default.ENTER_PVP_SCENE);break;case td.FightType.WHOLE_BOSS:case td.FightType.HOLY_BEAST:case td.FightType.TANGLED_HELL:gdk.fsm.Fsm.broadcastEvent(n.default.ENTER_PVP_SCENE);break;case td.FightType.CROSS_ARENA:_.default.getInstance().isJumpFight()?td.EventUtil.dispatchEvent(td.EventNameEnum.CROSS_ARENA_SHOW_FIGHT_RESULT):gdk.fsm.Fsm.broadcastEvent(n.default.ENTER_PVP_SCENE);break;case td.FightType.EVIL_GOD:gdk.fsm.Fsm.broadcastEvent(n.default.ENTER_PVP_SCENE);break;default:gdk.fsm.Fsm.broadcastEvent(n.default.ENTER_PVP_SCENE)}},_setReshowData:function(t){this._rightHistorySprite=t.rightHistorySprite||[]},getNewMonsterData:function(){return this._rightHistorySprite||[]},deleteFirstNewMonster:function(){this._rightHistorySprite.length>0&&this._rightHistorySprite.shift()},removeNewMonsterData:function(t){this._newMonsterData.hasOwnProperty(t)&&delete this._newMonsterData[t]},_finishedPlay:function(){if(this._fightType){if(this._fightType===td.FightType.PREVIEW_FIGHT)return void gdk.Timer.once(500,this,function(){td.EventUtil.dispatchEvent(td.EventNameEnum.EXIT_PVP_SCENE),gdk.fsm.Fsm.broadcastEvent(n.default.ENTER_MAIN_SCENE)});this._fightType,td.FightType.PREVIEW_FIGHT}if(this._fightType&&this._fightType===td.FightType.BABEL&&-1!=u.default.getInstance().checkShowSkillType())return;td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_FIGHT_RESULT_PANEL)},getFightType:function(){return this._fightType},getMyDeathNum:function(){return this._myDeathNum},getFightResult:function(){return this._fightResult},getPetData:function(t){for(var e=this._fightData.members[t].getFormation().getPets(),i={},n=0,a=e.length;n<a;n++){var r=e[n];if(r)i[r.getPos()%6]=r}return i},getRoleData:function(t){var e=null;for(var i in e=this._fightType==td.FightType.StoryHandUp?this._onHookFightData.members:this._fightData.members)for(var n=e[i].getFormation().getMercenarys(),a=0,r=n.length-1;a<=r;a++){var o=n[a];if(o&&o.getSId()===t)return o}},getCampByMercenarySid:function(t){if(!this._fightData)return td.BattleCamp.NONE;var e=this._fightData.members;for(var i in e)for(var n=e[i].getFormation().getMercenarys(),a=0,r=n.length-1;a<=r;a++)if(n[a]&&t==n[a].getSId())return i;return td.BattleCamp.NONE},getOnhookFightCampByMercenarySid:function(t){if(!this._onHookFightData)return td.BattleCamp.NONE;var e=this._onHookFightData.members;for(var i in e)for(var n=e[i].getFormation().getMercenarys(),a=0,r=n.length-1;a<=r;a++)if(n[a]&&t==n[a].getSId())return i;return td.BattleCamp.NONE},getTargetCamp:function(t){var e=td.BattleCamp;return t==e.LEFT?e.RIGHT:t==e.RIGHT?e.LEFT:e.NONE},setCopyData:function(t){this._curCopyData=t},getCopyData:function(){return this._curCopyData},_calcFightResult:function(){var t=this,e={},i={},n=this._fightData.members;this._fightData.testHp=[];var a=this._fightData.testHp;this._fightData.testMp=[];var r=this._fightData.testMp;for(var o in n)for(var s=n[o].getFormation().getMercenarys(),l=0,c=s.length-1;l<=c;l++)s[l]&&(e[s[l].getSId()]=s[l].getHp(),i[s[l].getSId()]=s[l].getRage());this.LogHp(e);var u=this._fightData.reports;for(var d in u){cc.log("roundId:"+d);for(var h=u[d].getFightReports(),p=0,_=h.length-1;p<=_;p++){var g=h[p].getSkillEffects();for(l=0,c=g.length-1;l<=c;l++){var f=g[l],v=f.getTargetSid(),m=f.getAttributeMap()[td.SpriteKey.HP];void 0!==m&&(e[v]<0&&cc.log("calc hp error,sid:"+v),e[v]+=m,a[a.length]=e[v]);var y=f.getAttributeMap()[td.SpriteKey.RAGE];void 0!==y&&(i[v]<0&&cc.log("calc mp error,sid:"+v),cc.log("roundId:"+d+",sid:"+v+",_skill_mp:"+y),i[v]+=y,cc.log("roundId:"+d+",reportId:"+p+",sid:"+v+",total_mp:"+i[v]),r[r.length]=i[v])}}}this._fightType===td.FightType.STAR_UP_ROAD&&(this._myDeathNum=0,n[td.BattleCamp.LEFT].getFormation().getMercenarys().forEach(function(i){void 0!==e[i.getSId()]&&0===e[i.getSId()]&&t._myDeathNum++}));cc.log("the end!!!\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026\u2026"),this.LogHp(e)},LogHp:function(t){for(var e in t)cc.log("sid:"+e+",hp:"+t[e])},_setDestination:function(t){var e=parseInt(t.type),i=td.FightType,n=td.PanelJumpManager;if(e===i.Arena)n.setDestination(td.PanelEnum.Panel_Arena);else if(e===i.NationBoss)td.PanelJumpManager.setDestination(td.PanelEnum.Panel_NationBoss);else if(e===i.WorldBoss)td.PanelJumpManager.setDestination(td.PanelEnum.Panel_WorldBossPreview,c.WorldBossPageType.WorldBoss);else if(e===i.WHOLE_BOSS)td.PanelJumpManager.setDestination(td.PanelEnum.Panel_WorldBoss,c.WorldBossPageType.WholeBoss);else if(e===i.STAR_UP_ROAD);else if(e===i.ENDLESS){var o=this._fightResult._fightResult,l=a.default.getInstance().getIsNextFloor();td.PanelJumpManager.setDestination(td.PanelEnum.Panel_Endless,o===td.TBSFightResultEnum.SUCCESS||l)}else if(e===i.Abyss)n.setDestination(td.PanelEnum.Panel_Abyss);else if(e===i.Nation_Copy)n.setDestination(td.PanelEnum.Panel_NationDungeon);else if(e===i.Nation_King)n.setDestination(td.PanelEnum.Panel_NationKingFight);else if(e===i.Nation_Endless)n.setDestination(td.PanelEnum.Panel_NationEndless);else if(e===i.Siege);else if(e===i.Plunder)n.setDestination(td.PanelEnum.Panel_Plunder);else if(e===i.Trail){var _=td.TrailManager.isChangeState();n.setDestination(_?td.PanelEnum.Panel_TrailWorld:td.PanelEnum.Panel_TrailCity)}else if(e===i.MysteryShop)n.setDestination(td.PanelEnum.Panel_Manor);else if(e===i.DragonPersonal)n.setDestination(td.PanelEnum.Panel_KD_PersonalChapterInfo);else if(e===i.Dragon)n.setDestination(td.PanelEnum.Panel_CivilKillDragon);else if(e===td.FightType.DESTROY_TEMPLE)n.setDestination(td.PanelEnum.Panel_DestroyTemple);else if(e===td.FightType.TREASURE_SNATCH){for(var f=this._fightResult.getRewardList(),v=!1,m=r.default.getInstance().getTreasureRobFragmentId(),y=0;y<f.length;y++){var E=f[y];if(E.type==td.GoodsType.Type_Item&&E.id==m){v=!0;break}}if(v){var T={},C=r.default.getInstance().getTreasureByFragmentId(m);C&&(T.selectId=C.id),n.setDestination(td.PanelEnum.Panel_Treasure_Bag,T)}else if(r.default.getInstance().isFromFightReport()){var R={},S=r.default.getInstance().getTreasureByFragmentId(m);S&&(R.selectId=S.id),n.setDestination(td.PanelEnum.Panel_Treasure_Bag,R)}else n.setDestination(td.PanelEnum.Panel_TreasureRobList)}else if(e===td.FightType.Pagoda)n.setDestination(td.PanelEnum.Panel_Pagoda);else if(e===td.FightType.NationBoss)n.setDestination(td.PanelEnum.Panel_NationBoss);else if(e===td.FightType.PURPLE_FAIRYLAND){var I=s.default.getInstance().getPulseId(),A=td.GetTableClass(td.TableEnum.PurpleFairylandPulseTable).getDataById(I).fairylandId;n.setDestination(td.PanelEnum.Panel_Pulse,A)}else if(e===td.FightType.WHOLE_ATTEND){var b=this.getCurActivityType();n.setDestination(td.PanelEnum.Panel_Activity,[td.ActivityEnum.Activity.ActivityConfig,b])}else if(e===i.WONDERLAND_ADVENTURE)n.setDestination(td.PanelEnum.Panel_WonderlandAdventure);else if(e===td.FightType.CROSS_ARENA)n.setDestination(td.PanelEnum.Panel_CrossArenaChallenge,!0);else if(e===td.FightType.HOLY_BEAST)n.setDestination(td.PanelEnum.Panel_NationBeast);else if(e===td.FightType.BABEL){(td.PvpFightManager.isBabelFightFail()||u.default.getInstance().getOverStageState())&&n.setDestination(td.PanelEnum.Panel_Babel)}else if(e===td.FightType.CROSS_CUP)n.setDestination(td.PanelEnum.Panel_CrossCup);else if(e===td.FightType.NATION_DUEL){var P=h.default.getInstance().getDestPanelData();n.setDestination(td.PanelEnum.Window_NationDuelCampDetail,P)}else if(e===td.FightType.LEGEND)n.setDestination(d.default.getInstance().getDestinationPanel());else if(e===td.FightType.COMPETE)td.PanelJumpManager.setDestination(td.PanelEnum.Window_OtherBattleArray);else if(e===td.FightType.MAZE_PVE)td.PanelJumpManager.setDestination(td.PanelEnum.Panel_MazePVE);else if(e===td.FightType.MAZE_PVP)p.default.getInstance().isReplayFight()?td.PanelJumpManager.setDestination(td.PanelEnum.Window_MazeReports):td.PanelJumpManager.setDestination(td.PanelEnum.Panel_MazePVP);else if(e===td.FightType.TANGLED_HELL)td.PanelJumpManager.setDestination(td.PanelEnum.Panel_ScuffleYamaMain);else if(e===td.FightType.EVIL_GOD){var N=g.default.getInstance().getCurGateId(),M=g.default.getInstance().getOpGateId();if(M===g.default.getInstance().getMaxGateId()&&N<M)td.PanelJumpManager.setDestination(td.PanelEnum.Panel_EvilGodMain);else{var L=g.default.getInstance().getOpGateId();td.PanelJumpManager.setDestination(td.PanelEnum.Panel_EvilGodGateBoss,L)}}},_addPvpSpecialHero:function(t){if(this._fightData&&td.GuideManager.isDoingEndlessGuide()){var e=td.PvpFirstBattleUtil.getEndlessSpecialHeroData();if(e){var i=this._fightData.members,n=e.camp,a=i[n];if(!a)return;var r=a.getFormation();if(!r)return;var o=e.sprites;if(!o)return;for(var s=0,l=o.length-1;s<=l;s++){var c=o[s],u=r.addMercenarySprite(c),d={};d.camp=n,d.roleData=u,td.EventUtil.dispatchEvent(td.EventNameEnum.ADD_PVP_FIGHT_MERCENARY,d)}}}},setPvpEffectLayer:function(t){this._pvpEffectLayer=t},getPvpEffectLayer:function(){return this._pvpEffectLayer},setPvpRoleLayer:function(t){this._pvpRoleLayer=t},getPvpRoleLayer:function(){return this._pvpRoleLayer},setPvpBgLayer:function(t){this._pvpBgLayer=t},getPvpBgLayer:function(){return this._pvpBgLayer},setCurActivityType:function(t){this._curActivityType=t},getCurActivityType:function(){return this._curActivityType},getIsFightPause:function(){return this._isFightPause||!1},setFightPause:function(t){this._isFightPause=t},_resumeBabelFight:function(){this._parseFightResultPacket(this._babelFightPacket)},isBabelFightFail:function(){return!!this._babelFightPacket&&2==this._babelFightPacket.stats.winCamp},hasBabelFightPacket:function(){return!!this._babelFightPacket},getRoundAddition:function(t){for(var e=td.GetConfig("PVP_ROUND_ADDITION_CONDITION"),i=999,n=0,a=0;a<e.length;a++){var r=e[a],o=r[0],s=r[1];if(o<i&&(i=o),a+1<e.length)for(var l=e[a+1],c=t>=l[0]?l[0]:t+1,u=o;u<c;u++)n+=s;else for(var d=0;d<t-o+1;d++)n+=s}return{round:i,value:n}}},td.GameFightError=function(t){cc.error("game fight error!"),t===td.FightType.StoryHandUp?td.EventUtil.dispatchEvent(td.EventNameEnum.STOP_ONHOOK_FIGHT_NOW):td.EventUtil.dispatchEvent(td.EventNameEnum.STOP_FIGHT_NOW)},cc._RF.pop()},{"../../../Babel/Manager/BabelManager":"BabelManager","../../../CrossArena/Manager/CrossArenaManager":"CrossArenaManager","../../../DestroyTemple/Manager/DestroyTempleManager":"DestroyTempleManager","../../../Endless/Manager/EndlessManager":"EndlessManager","../../../EvilGodCopy/Mananger/EvilGodManager":"EvilGodManager","../../../Legend/Manager/LegendManager":"LegendManager","../../../Maze/Manager/MazeManager":"MazeManager","../../../Nation/Manager/NationBossManager":"NationBossManager","../../../Nation/Manager/NationDuelManager":"NationDuelManager","../../../Pulse/Manager/PulseManager":"PulseManager","../../../Treasure/Manager/TreasureManger":"TreasureManger","../../../WorldBoss/Enum/WorldBossEnum":"WorldBossEnum","../../../fight/pvp/Model/PvpFsmEventId":"PvpFsmEventId"}],PvpFightMercenaryAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"55ff56eguRCyYE3/wy/KivV","PvpFightMercenaryAnimation");var n=t("AnimationComponent");td.PvpFightMercenaryAnimation=cc.Class({extends:n,properties:{_data:null,_defaultSize:null,_spriteOffset:null,_actionTag:null,_blendSprite:null,_hitCallBack:null,_isInit:!1},getIsInit:function(){return this._isInit},getDefaultSize:function(){return this._defaultSize},getSpriteOffset:function(){return this._spriteOffset},init:function(t,e){this._actionTag=1,this._data=t;t.getAnimationRes();this._atlas=gdk.rm.getResByUrl(t.getAnimationRes(),cc.SpriteAtlas);var i=this._getFrameNameByState(td.MercenaryState.Idle)+"0",n=this._atlas.getSpriteFrame(i);this.node.getComponent(cc.Sprite).spriteFrame=n;var a=n.getRect();this._spriteOffset=n.getOffset(),this._defaultSize=cc.size(a.width,a.height),this.playIdle(),this._isInit=!0},reuse:function(t,e){this._isInit||this.init(t,e)},changeColor:function(t,e){if(this._blendSprite=null,this._data.getChangeColorData&&this._data.getChangeColorData()){var i,n,a,r,o=this._data.getChangeColorData();this._blendSprite=new cc.Sprite,this._blendSprite.initWithSpriteFrame(t),this.addChild(this._blendSprite,-1),i=o.blend_src1,n=o.blend_dst1,a=o.color1,r=o.alpha1/100*255,i>1&&(i=i.toString(16)),n>1&&(n=n.toString(16)),this._blendSprite.setBlendFunc(i,n),this._blendSprite.setColor(cc.color(a[0],a[1],a[2])),this._blendSprite.opacity=r,i=o.blend_src2,n=o.blend_dst2,a=o.color2,r=o.alpha2/100*255,i>1&&(i=cc.ONE),n>1&&(n=cc.ONE),this.setBlendFunc(i,n),this.setColor(cc.color(a[0],a[1],a[2])),this.opacity=r;var s=0,l=0;e?this._blendSprite.setPosition(cc.v2(this._blendSprite.width/2,+s,this._blendSprite.height/2+l)):this._blendSprite.setPosition(cc.v2(this._blendSprite.width/2-s,this._blendSprite.height/2+l)),this._blendSprite.setFlippedX(!e)}},unuse:function(){this.node.stopAllActions(),this._data=null},_allPlayAction:function(t,e,i,n,a){void 0===e&&(e=1),this._playAction(this,this._getFrameNameByState(t),e,i,n,a)},_getFrameNameByState:function(t){return cc.js.formatStr("%s_%s_00",this._data.getAnimationIndex(),t)},getAnimResByState:function(t){return cc.js.formatStr("%s_%s_00",this._data.getAnimationRes(),t)},getAnimNameByState:function(t){return cc.js.formatStr("%s_%s_00",this._data.getAnimationIndex(),t)},playNone:function(){},_playAction:function(t,e,i,n){var a=this.getAnimNameByState(t);e?this.setFinishAnimationCallBack(e):this.removeFinishAnimationCallBack(),this.playAnimationClipWithFrameDesc(a,i,n)},playIdle:function(){this._playAction(td.MercenaryState.Idle,null,null,cc.WrapMode.Loop)},playDead:function(t){this._playAction(td.MercenaryState.Dead,t)},playAttack:function(t,e){this._hitCallBack=null,e&&(this._hitCallBack=e);var i=[];if(e){var n={frameIndex:.35,callFunc:"hitBack"};i[i.length]=n}this._playAction(td.MercenaryState.GEN_ATK,t,i)},hitBack:function(t){this._hitCallBack&&this._hitCallBack(t)},playSkillAttack:function(t,e,i){var n={};n.index=e||0,n.callFunc=i,this._allPlayAction(td.MercenaryState.SKILL_ATK,1,t,.1,n)},playHit:function(t){this._playAction(td.MercenaryState.Hit,t,null)},playMove:function(){var t=this.getAnimNameByState(td.MercenaryState.Idle);this.playAnimationClip(t)},playRun:function(){this._allPlayAction(td.MercenaryState.RUN,-1)},playBack:function(){this._playAction(td.MercenaryState.Back,null,null)},stop:function(){this.node.stopAllActions(),this._blendSprite.stopAllActions()}}),cc._RF.pop()},{AnimationComponent:void 0}],PvpFightMercenaryBottom:[function(t,e,i){"use strict";cc._RF.push(e,"33befX8zH9MHZYN1lDLpFwd","PvpFightMercenaryBottom");var n=t("AnimationComponent");cc.Class({extends:cc.Component,properties:{_animationComponent:null},reuse:function(t,e){if(this.visible=!0,t.getHp()<=0)this.visible=!1;else{var i,a;e?(i=td.resDef.PvpFight.ACG_Base_friend,a="ACG_Base_friend_00"):(i=td.resDef.PvpFight.ACG_Base_Enemy,a="ACG_Base_enemy_00");var r=gdk.rm.getResByUrl(i,cc.SpriteAtlas),o=r.getSpriteFrame(a+"0");this.node.getComponent(cc.Sprite).spriteFrame=o,this._animationComponent=this.node.getComponent(n),null!==this._animationComponent&&void 0!==this._animationComponent||(this._animationComponent=this.node.addComponent(n)),this._animationComponent.setSpriteAtlas(r),this._runAction(a)}},unuse:function(){this.node.stopAllActions()},_runAction:function(t){this.node.stopAllActions(),this._animationComponent.playAnimationClipWithFrameDesc(t,null,cc.WrapMode.Loop)}});cc._RF.pop()},{AnimationComponent:void 0}],PvpFightMercenaryInfoComponent:[function(t,e,i){"use strict";cc._RF.push(e,"189e87B5l5MV6cJ/hAzwGah","PvpFightMercenaryInfoComponent");var n=t("PvpRollProgressBarComponent"),a=cc.Class({extends:cc.Component,properties:{_cfg:null,_curHp:null,_curRage:null,_isLeft:!1,_showRage:4,_isInited:!1,_lastRage:null},_init:function(){this._isInited=!0,this._setFeatures(),this._setName();var t=this.node.getChildByName("progressBg"),e="PVP_xuetiaobg01",i=this._cfg.getBaseModel().getAptitude();e=i<=2?"PVP_xuetiaobg01":i<=3?"PVP_xuetiaobg02":"PVP_xuetiaobg03",td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,e,t);var n=this.node.getChildByName("rollHpBar").getChildByName("bar");td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,this._isLeft?"PVP_xt_xuetiao":"PVP_xt_xuetiao_df",n);var a=this.node.getChildByName("hpBar").getChildByName("bar");td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,this._isLeft?"PVP_xt_xuetiao":"PVP_xt_xuetiao_df",a)},reuse:function(t,e){this._cfg=t,this._isLeft=e,this._curHp=t.getHp(),this._curHp<0&&(this._curHp=0),this._curRage=t.getRage();var i=this._curHp/t.getMaxHp();this.refreshRangeInfo(),this._setHpBarPercent(i,!1),this._isInited||this._init()},setHpChange:function(t){if(this._curHp+=t,this._curHp<0&&(this._curHp=0),this._curHp=Math.min(this._curHp,this._cfg.getMaxHp()),!(this._cfg.getMaxHp()<=0)){var e=this._curHp/this._cfg.getMaxHp();this._setHpBarPercent(e,!0),td.EventUtil.dispatchEvent(td.EventNameEnum.PVP_HP_CHANGE,{sid:this._cfg.getSId(),hpChange:t})}},setRageChange:function(t){this._curRage+=t,this.refreshRangeInfo()},refreshRangeInfo:function(){if(this._lastRage!=this._curRage){var t=this.node.getChildByName("mpBar"),e=t.getChildByName("bar_1"),i=t.getChildByName("bar_2"),n=t.getChildByName("bar_3"),a=t.getChildByName("bar_4"),r=this.node.getChildByName("mpFullAnima"),o=r.getComponent(cc.Animation);this._curRage>=td.GetConfig("SPRITE_RAGE_MAX")?(r.active=!0,o.play()):r.active=!1,this._curRage>=5?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,"PVP_xt_nuqi02",e):td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,"PVP_xt_nuqi04",e),e.active=this._curRage>=1,this._curRage>=6?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,"PVP_xt_nuqi03",i):td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,"PVP_xt_nuqi05",i),i.active=this._curRage>=2,this._curRage>=7?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,"PVP_xt_nuqi03",n):td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,"PVP_xt_nuqi05",n),n.active=this._curRage>=3,this._curRage>=8?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,"PVP_xt_nuqi02",a):td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,"PVP_xt_nuqi04",a),a.active=this._curRage>=4,this._lastRage=this._curRage}},unuse:function(){this._setHpBarPercent(100,!1),this._isInited=!1},_setFeatures:function(){var t=this.node.getChildByName("featuresImg");t.setScale(.35);var e="GY_zhenying_0"+this._cfg.getCurCamp();td.GlobalFunction.createSpriteNode(t,td.resDef.pngPlist.GY_Common,cc.SpriteAtlas,e)},_setName:function(){var t=this._cfg.getBaseModel().getName(),e=this._cfg.getBaseModel().getQuality(),i=this.node.getChildByName("mercenaryName");i.getComponent(cc.Label).string=t,td.GlobalFunction.setNameColors(i,e)},_setLoadingBarPercent:function(t,e){this.node.getChildByName(t).getComponent(cc.ProgressBar).progress=e},_setHpBarPercent:function(t,e){this._setLoadingBarPercent("hpBar",t);var i=this.node.getChildByName("rollHpBar");if(i){var a=i.getComponent(n);a.setPlayUnitTime(1.5),a.setPercent(t,e)}i=(i=this.node.getChildByName("hpBar")).getChildByName("bar")},_setMpBarPercent:function(t){this._setLoadingBarPercent("mpBar",t)},_showGuideBufferEffect:function(){var t=this.getChildByName("mpBar");if(!(e=t.getChildByName("buffEff02"))){td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSE_FIGHT);var e=ccs.load(td.resdef.buffEff02_Json);t.addChild(e.node,99),td.LayoutUtil.dockRefNodeCenter(t,e.node),e.node.setName("buffEff02"),e.node.y=-2,e.node.runAction(e.action);e.action.setLastFrameCallFunc(function(){e.node.removeFromParent()}),e.action.play("animation",!1),this.scheduleOnce(this._resumGame,1,"resumGame")}},_resumGame:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_FIGHT)}});e.exports=a,cc._RF.pop()},{PvpRollProgressBarComponent:"PvpRollProgressBarComponent"}],PvpFightMercenary:[function(t,e,i){"use strict";cc._RF.push(e,"61d95QmxSZLaJZQsDUvhqEh","PvpFightMercenary");var n=t("state-machine"),a=t("SpriteAnimation"),r=t("PvpBattleShowAtkAnimation"),o=(t("PvpBattleSkillAnimation"),t("AnimationComponent")),s=t("PvpFightMercenaryInfoComponent"),l=t("PvpBattleUnderAtkAnimation"),c=t("PvpFightBuffAnimation"),u=t("PvPNodePoolManager"),d=cc.Class({extends:cc.Component,properties:{_cfg:null,_fsm:null,_shadowSp:null,_Z_ORDER_SHADOW:2,_animation:null,_Z_ORDER_Animation:3,_atkAnimation:null,_Z_ORDER_Atk_Animation:4,_infoNode:null,_Z_ORDER_INFO_NODE:5,_buffNode:null,_buffIconNode:null,_suolianNode:null,_Z_ORDER_BUFF:7,_Z_ORDER_BUFF_ICON:6,_isLeft:null,_animationPOs:null,_effectSpMap:null,_buffAttrSpMap:null,_deadTimeOut:null,_mercenary:null,_position:null,_scale:1,_battleOffSet:null,_buffBaobaoPos:null},init:function(t){this._mercenary=this.node.getChildByName("Mercenary"),this._imgLayer=this.node.getChildByName("imgLayer"),this._animation=this._mercenary.getComponent(a),this._shadowSp=this.node.getChildByName("shadowSp");var e=this.node.getChildByName("PvpFightMercenaryInfoNode");this._infoNode=e.getComponent(s),this.node.setAnchorPoint(cc.v2(.5,.5)),this._buffBaobaoPos={1:{1:cc.v2(80,20),2:cc.v2(50,60),3:cc.v2(50,-20)},2:{1:cc.v2(-80,20),2:cc.v2(-50,60),3:cc.v2(-50,-20)}},this._fsm=new n({init:"state_none",transitions:[{name:"none",from:"state_dead",to:"state_none"},{name:"idle",from:["state_run","state_move","state_back","state_atkNear","state_atkFar","state_underAtk","state_none","state_dead","state_idle","state_dead"],to:"state_idle"},{name:"atkNear",from:["state_move","state_dead"],to:"state_atkNear"},{name:"atkFar",from:["state_idle","state_dead"],to:"state_atkFar"},{name:"run",from:["state_idle","state_run","state_back","state_atkNear","state_atkFar","state_underAtk","state_none","state_dead"],to:"state_run"},{name:"move",from:["state_idle","state_underAtk","state_dead"],to:"state_move"},{name:"back",from:["state_move","state_atkNear","state_idle","state_dead"],to:"state_back"},{name:"underAtk",from:"state_idle",to:"state_underAtk"},{name:"dead",from:["state_idle","state_underAtk","state_atkNear","state_atkFar"],to:"state_dead"}],data:{showType:null,frames:[],moveToPos:cc.v2(0,0),FightPlayFinishEnum:0},methods:{onNone:this._onNone.bind(this),onIdle:this._onIdle.bind(this),onAtkNear:this._onAtkNear.bind(this),onAtkFar:this._onAtkFar.bind(this),onRun:this._onRun.bind(this),onMove:this._onMove.bind(this),onBack:this._onBack.bind(this),onUnderAtk:this._onUnderAtk.bind(this),onDead:this._onDead.bind(this)}}),this.reuse(t)},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.PLAY_UNDER_ATTACK_ANIMATION]=this._playUnderAtkEvent,t[e.PVP_FIGHT_REFRESH_MERCENARY]=this.refresh,t[e.PLAY_HERO_ATK_ACTION_FRONT]=this._atkActionFront,t[e.PLAY_HERO_ATK_ACTION_CENTER]=this._atkActionCenter,t[e.PLAY_HERO_ATK_ACTION_BACK]=this._atkActionBack,t[e.PLAY_HERO_ATK_SKILL_NAME]=this._showSkillName,t[e.PLAY_HERO_ATK_SHOW]=this._playAtkShow,t[e.REFRESH_HERO_TRRI_SHOW]=this._refreshHeroAttriShow,t[e.REFRESH_HERO_TRRI_DEAD]=this._refreshHeroAttriDead,t[e.PLAY_BUFF_CHANGE_PREPARE]=this._showBuffAttrChange,t[e.PLAY_BUFF_EFFECT_WORK]=this._showBuffEffectWork,t[e.PLAY_SKILL_EFFECT_WORK]=this._showBuffEffectWork,t[e.PLAY_BUFF_EFFECT]=this._showBuffEffect,t[e.REMOVE_BUFF_EFFECT]=this._removeBuffer,t[e.REMOVE_BUFF_SUBSTITUTE]=this._removeSubstitute,t[e.PLAY_SKILL_EFFECT_PREPARE]=this._showSkillEffect,t[e.PLAY_HERO_REVIVE]=this._playerRevive,t[e.FINISH_HERO_ATK_SHOW]=this._finishHeroAtkShow,t[e.SET_REVIVE_DATA]=this._setReviveData,td.EventUtil.registerEvents(t,this)},_removeEventListener:function(){td.EventUtil.unregisterAllEvents(this)},start:function(){this._addEventListener()},onDisable:function(){this._removeEventListener(),this._clearDeadTimeOut()},refresh:function(){this._cfg&&(this.isAlive()&&this._animation,this._infoNode&&this._infoNode.reuse(this._cfg,this._isLeft))},getCfg:function(){return this._cfg},setUserData:function(t){},getMercenaryScale:function(){return this._scale},reuse:function(t){this._cfg=t.roleData;var e=t.isLeft;this._isLeft=e,this._scale=td.PvpHeroScale,td.PvpFightManager.getFightType()!==td.FightType.EVIL_GOD||this._isLeft||(this._scale=td.PvpEvilGodScale),this.node.setScale(1),this._position=this.node.getPosition(),e?(this._mercenary.scaleX=1*this._scale,this._mercenary.scaleY=1*this._scale):(this._mercenary.scaleX=-1*this._scale,this._mercenary.scaleY=1*this._scale),this._shadowSp.active=!0,this._animation.setFightType(2),this._animation.init(t.roleData,1),this._animation.onChangeAnimationSpeed(td.PvpFightController.getInstance().getFightSpeed()),this._cfg.getBaseModel().getModelShowType()!=td.SpriteType.PET?(this._animation.init(t.roleData,1),this._animation.onChangeAnimationSpeed(td.PvpFightController.getInstance().getFightSpeed()),this._infoNode.reuse(t.roleData,e)):(this._infoNode.node.active=!1,this._shadowSp.active=!1),this._buffNode?this._buffNode.removeAllChildren():(this._buffNode=new cc.Node,this.node.addChild(this._buffNode,this._Z_ORDER_BUFF)),this._buffIconNode?this._buffIconNode.removeAllChildren():(this._buffIconNode=new cc.Node,this._buffIconNode.setPosition(cc.v2(0,0)),this.node.addChild(this._buffIconNode,this._Z_ORDER_BUFF_ICON)),this._suolianNode?this._suolianNode.removeAllChildren():(this._suolianNode=new cc.Node,this._suolianNode.setPosition(cc.v2(0,0)),this.node.addChild(this._suolianNode,this._Z_ORDER_BUFF_ICON));var i=td.GetTableClass(td.TableEnum.ModelShowTable).getDataByTypeAndId(1,this._cfg.getRoleType()),n=[0,0];i&&i.battleOffset&&(n=i.battleOffset),this._battleOffSet=n,this._mercenary.x=n[0]*(this._isLeft?-1:1),this._mercenary.y=n[1]},unuse:function(){this._cfg=null,this._shadowSp&&(this._shadowSp.active=!1),this._animation&&(this._animation=null),this._infoNode&&this._infoNode.unuse()},none:function(){this._fsm.none()},isAlive:function(){return this._cfg.getHp()>0},idle:function(){this._fsm.can("idle")&&this._fsm.idle()},run:function(){this._fsm.can("run")&&this._fsm.run()},_atkActionFront:function(t){var e=t.sid;if(this._cfg&&e==this._cfg.getSId()){this._fsm.moveToPos=t.pos||cc.v2(0,0);var i=t.type;i===td.SkillAtkType.ATK_NEAR?this._fsm.can("move")?this._fsm.move():cc.log("cannot move ********"):(td.SkillAtkType.ATK_FAR,this._finishHeroAtkActionFront())}},_atkActionCenter:function(t){var e=t.sid;if(this._cfg&&e==this._cfg.getSId()){var i=t.showData,n=i.getAtkShowType(),a=td.FightShowType;n===a.atkAction||n===a.skillAnimation?this._attack(i):this._finishHeroAtkActionCenter()}},_atkActionBack:function(t){var e=t.sid;if(this._cfg&&e==this._cfg.getSId()){var i=t.type;i===td.SkillAtkType.ATK_NEAR?this._onAtkNearBack():i===td.SkillAtkType.ATK_FAR&&this._onAtkFarBack()}},_attack:function(t){var e=t.getType(),i=t.getAtkShowType();this._fsm.showType=i,this._fsm.frames=t.getUnderAtkFrames(),e===td.SkillAtkType.ATK_NEAR?this._fsm.can("atkNear")?this._fsm.atkNear():cc.log("test"):e===td.SkillAtkType.ATK_FAR&&(this._fsm.can("atkFar")?this._fsm.atkFar():cc.log("test"))},_playUnderAtkEvent:function(t){var e=t.targetSids,i=t.attacker;if(!t.isHaveEnemy){var n={};return n.sid=i,n.eventEnum=td.FightPlayFinishEnum[2],void td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_FIGHT_FINISH,n)}var a=td.PvpFightManager.getCampByMercenarySid(i);if(ArrayUtils.contains(e,this._cfg.getSId())){a!==this._cfg.getCamp()&&t.isHaveEnemy&&this.hit();var r=t.showData;if(r&&""!=r.getUnderAtkAnimation()&&a!==this._cfg.getCamp()){var o=r.getUnderAtkAnimationRes(),s=u.getPrefabFromNodePool(o);cc.isValid(s)||(s=cc.instantiate(gdk.rm.getResByUrl(o,cc.Prefab)));var c=s.getComponent(l);c||(c=s.addComponent(l)),c.init(r),s.setPosition(cc.v2(0,80)),this.node.addChild(s,this._Z_ORDER_BUFF);var d;(d=function(){s.removeFromParent(!1),u.putPrefabToNodePool(o,s);var t={};t.eventEnum=td.FightPlayFinishEnum[2],td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_FIGHT_FINISH,t)}.bind(this))&&c.setFinishAnimationCallBack(d),c.playAnimation()}else{(t={}).sid=this._cfg.getSId(),t.eventEnum=td.FightPlayFinishEnum[2],td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_FIGHT_FINISH,t)}}},hit:function(){if(this._fsm.can("underAtk")&&this._fsm.underAtk(),this._cfg.getSuperArmor&&this._cfg.getSuperArmor()){var t={};return t.sid=this._cfg.getSId(),t.eventEnum=td.FightPlayFinishEnum[1],void td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_FIGHT_FINISH,t)}var e=20;this.node.getParent().x;this._isLeft&&(e=-e),this.node.stopAllActions();var i=td.PvpFightController.getInstance().getFightSpeed(),n=cc.moveBy(.1/i,e,0),a=cc.moveTo(.2/i,this._position,0),r=cc.callFunc(function(){var t={};t.sid=this._cfg.getSId(),t.eventEnum=td.FightPlayFinishEnum[1],td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_FIGHT_FINISH,t)}.bind(this));this.node.runAction(cc.sequence(n,a,r))},dead:function(){this._fsm.can("dead")?this._fsm.dead():this.doReviveAction()},_onNone:function(){this._animation&&this._animation.playNone()},_onIdle:function(){this._animation&&(this._animation.playIdle(),this._setBottomAndInfoVisible(!0))},_onMove:function(){var t=this._fsm.moveToPos;this._isLeft?t.x=t.x-100:t.x=t.x+100;var e=this,i=td.PvpFightController.getInstance().getFightSpeed();this._animation.playMove(this._onBackToIdle.bind(this));var n=cc.moveBy(.15/i,t),a=cc.sequence(n,cc.callFunc(function(){e._finishHeroAtkActionFront()}));this.node.runAction(a)},_onRun:function(){this._animation&&(this._animation.playRun(),this._setBottomAndInfoVisible(!1))},_onAtkNear:function(){this._finishHeroAtkActionCenter(),this._fsm.showType=null,this._setBottomAndInfoVisible(!0)},_onAtkNearBack:function(){this._fsm.can("back")?this._fsm.back():cc.log("test")},_onBackToIdle:function(){this.idle()},_onBack:function(){var t=this._fsm.moveToPos;t=cc.v2(-t.x,-t.y);var e=this,i=td.PvpFightController.getInstance().getFightSpeed();this._animation.playIdle();var n=cc.moveBy(.15/i,t),a=cc.sequence(n,cc.callFunc(function(){e._finishHeroAtkActionBack()}));this.node.runAction(a),this._setBottomAndInfoVisible(!0)},_onAtkFar:function(){if(this._animation){var t=this;this._fsm.showType===td.FightShowType.atkAction?t._animation.playAttack(null,function(){t._finishHeroAtkActionCenter(),t._fsm.frames=null}):t._animation.playAttack(function(){t._finishHeroAtkActionCenter(),t._fsm.frames=null}),this._fsm.showType=null,this._setBottomAndInfoVisible(!0)}},_onAtkFarBack:function(){this._finishHeroAtkActionBack()},_finishHeroAtkActionFront:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.FINISH_HERO_ATK_ACTION_FRONT)},_finishHeroAtkActionCenter:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.FINISH_HERO_ATK_ACTION_CENTER)},_finishHeroAtkActionBack:function(){this.idle();var t={};t.sid=this._cfg.getSId(),t.eventEnum=td.FightPlayFinishEnum[0],td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_FIGHT_FINISH,t)},_playCombinationAnima:function(t){var e=t.ids,i=(t.skillId,t.camp),n=t.state;ArrayUtils.contains(e,this._cfg.getRoleType())&&i===this._cfg.getCamp()&&(this._animation.node.active=!n,this._buffNode.active=this._animation.node.active)},_showSkillName:function(t){var e=t.sid;if(this._cfg&&e==this._cfg.getSId()){var i=t.showData;if(i.getAtkShowType()===td.FightShowType.skillAnimation2)return this._animation.node.active=!1,void(this._buffNode.active=this._animation.node.active);var n=td.PvpFightController.getInstance().getFightSpeed(),a=i.getSkillId(),r=td.GetTableClass(td.TableEnum.Skill).getSkillById(a),s=r.releasePic,l=!1;if(a&&(l=1==r.triggerType||this._cfg.getBaseModel().getModelShowType()===td.SpriteType.PET),l||!a)td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_ATK_ACTION_FRONT,t);else if(s){var c=u.getNodeFromNodePool(s);cc.isValid(c)?this._imgLayer.addChild(c,this._Z_ORDER_BUFF_ICON):((c=new cc.Node).name=s,this._imgLayer.addChild(c,this._Z_ORDER_BUFF_ICON),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,s,c)),c.y=50;var d=cc.sequence(cc.delayTime(1.2),cc.moveBy(1.2,0,50),cc.callFunc(function(t){t.removeFromParent(!1),u.putNodeToNodePool(t.name,t)}));c.runAction(d),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_ATK_ACTION_FRONT,t)}else{var h="fightRes/pvp/ui_anima/ShiFang_Effect/skillPrefab",p=u.getPrefabFromNodePool(h);cc.isValid(p)||(p=cc.instantiate(gdk.rm.getResByUrl(h,cc.Prefab))),this.node.addChild(p,this._Z_ORDER_BUFF_ICON);var _=p.getComponent(cc.Animation),g=_.getClips(),f=_.getAnimationState(g[0].name);f.speed=n,f.wrapMode=cc.WrapMode.Normal,_.play(g[0].name),p.addComponent(o).setFrameEventCallBack(function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_ATK_ACTION_FRONT,t)});var v=this._cfg.getBaseModel().getCombinationSkillId(),m=this._cfg.getBaseModel().getCombinationSkillReplaceIds(),y=td.GetTableClass(td.TableEnum.Skill).getSkillById(a),E=y.specialPic,T=y.showPic,C=y.skillNameSound,R=p.getChildByName("shifang_ziti");R.scale=1.45;var S=R.getChildByName("shifang_name1"),I=R.getChildByName("shifang_name2");C&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,C),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_skillName,T,I),S.active=!1,(v===a||ArrayUtils.contains(m,a))&&(td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_skillName,E,S),S.active=!0),R.getComponent(cc.Layout).updateLayout(),_.on("finished",function(){p.removeFromParent(!1),p.removeComponent(o),u.putPrefabToNodePool(h,p)}),td.EventUtil.dispatchEvent(td.EventNameEnum.PVP_SKILL_HURT_STATICS_START,e)}}},_playAtkShow:function(t){var e=t.sid;if(this._cfg&&e==this._cfg.getSId()){var i=this._cfg.getBaseModel().getModelShowType(),n=t.showData,a=n.getAtkShowType(),o=n.getSkillId();if(o){var s=this,l="atkAnimation_"+this._cfg.getRoleType()+"_"+o,c=this.node.getChildByName(l),u=null;if(c?(u=c.getComponent(r),!0===c.active&&(u.stopAnimation(),u.finishAttackCallBack()),u.playDefalutClip()):((c=this._getAtkAnimation(o)).name=l,c.scale=td.PvpHeroScale,c.scaleX=Math.abs(c.scaleX)*(this._isLeft?1:-1),(u=c.getComponent(r)).checkBattleRatation(),u.playAnimation()),u){c.setPosition(this._mercenary.getPosition()),c.x=this._battleOffSet[0]*(this._isLeft?-1:1),c.y=this._battleOffSet[1],u.node.active=i!=td.SpriteType.PET,this._animation.node.active=!1,this._buffNode.active=this._animation.node.active,td.PvpFightManager.getFightType()!==td.FightType.EVIL_GOD||this._isLeft||(u.node.scaleX=-td.PvpEvilGodScale,u.node.scaleY=td.PvpEvilGodScale),u.changeSpeed(td.PvpFightController.getInstance().getFightSpeed());u.getAnimaRes();switch(a){case td.FightShowType.atk_skillAnimation:u.setFrameListener(function(){u.stopAnimation(),u.node.active=!1,cc.isValid(s._animation)&&(s._isDead||s._animation.playIdle(),s._animation.node.active=!0,s._buffNode.active=s._animation.node.active)});break;case td.FightShowType.atkAnimation:u.setFrameListener(function(){u.stopAnimation(),u.node.active=!1,cc.isValid(s._animation)&&(s._isDead||s._animation.playIdle(),s._animation.node.active=!0,s._buffNode.active=s._animation.node.active)},!0);break;case td.FightShowType.trajectory:u.setFrameListener(function(){u.stopAnimation(),u.node.active=!1,cc.isValid(s._animation)&&(s._isDead||s._animation.playIdle(),s._animation.node.active=!0,s._buffNode.active=s._animation.node.active)})}td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_ATK_SKILL_EFFECT_SHOW,t)}else cc.assert(!1,"skillId:%d, atkAnimation not exist",o)}}},_getAtkAnimation:function(t){var e=this._cfg.getRoleType(),i=td.GetTableClass(td.TableEnum.PvpFightShow).getShowDataByType(e,this._cfg.getBaseModel().getModelShowType())[t],n=i.mercenaryAtkAnimationRes,a=i.mercenaryAtkAnimation,o=u.getPrefabFromNodePool(n);cc.isValid(o)||(o=cc.instantiate(gdk.rm.getResByUrl(n,cc.Prefab)));var s=o.getComponent(r);return s||(s=o.addComponent(r)),s.init(i,a),o.scaleX=Math.abs(o.scaleX)*(this._isLeft?1:-1),this.node.addChild(o,this._Z_ORDER_Atk_Animation),o},_refreshHeroAttriShow:function(){this._isDead||this.refresh()},_refreshHeroAttriDead:function(){if(!this._isDead){var t=td.PvpFightController.getInstance()._dataController.isLeftReportsContainPlayer(this._cfg.getSId()),e=td.PvpFightController.getInstance().getIsReviveReport(),i=td.PvpFightManager.getFightType(),n=i!==td.FightType.WorldBoss||1==this._cfg.getCamp()&&i===td.FightType.WorldBoss;if(t&&n)if(e){var a=td.PvpFightController.getInstance()._dataController.getFightUnitReportData(),r=a&&a.getTargetSIds()||[];if(!ArrayUtils.contains(r,this._cfg.getSId()))return}else{if(this._cfg.getHp()>0)return;if(!td.PvpFightController.getInstance()._dataController.isRoleRealDead(this._cfg.getSId()))return}this._cfg.getHp()<=0&&!this._isDead&&this.dead()}},_finishHeroAtkShow:function(){this._animation},_onUnderAtk:function(){this._animation&&(this._animation.playHit(function(){this.idle()}.bind(this)),this._setBottomAndInfoVisible(!0))},_onDead:function(){this._animation&&(this._isDead=!0,this._animation.playDead(function(){this._buffNode.visible=!1,this._buffIconNode.visible=!1,this._infoNode.visible=!1,this._suolianNode.visible=!1;var t=this.getReviveData(),e=td.PvpFightController.getInstance()._dataController.isRoleRealDead(this._cfg.getSId()),i=td.PvpFightManager.getFightType();if(e&&0==t.length||2==this._cfg.getCamp()&&i===td.FightType.WorldBoss){var n={};n.sid=this._cfg.getSId(),n.eventEnum=td.FightPlayFinishEnum[1],td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_FIGHT_FINISH,n),this._deadFadeOut()}else this.activeNodeChildren(!1),this._isDead=!1,t.length>0&&this.doReviveAction()}.bind(this)),this._setBottomAndInfoVisible(!1))},activeNodeChildren:function(t){for(var e in this.node.children){this.node.children[e].name.startsWith("atkAnimation_")?this.node.children[e].active=!1:this.node.children[e].active=t}},_deadFadeOut:function(){this._deadTimeOut=setTimeout(function(){var t=new cc.FadeOut(1),e=cc.callFunc(function(){this._fsm.none();var t=this._cfg.getPos();if(td.PvpFightController.getInstance()._dataController.checkHasNewMonsterShowByPos(t)){td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSE_FIGHT);var e=td.PvpFightManager.getNewMonsterData();td.EventUtil.dispatchEvent(td.EventNameEnum.WORLD_BOSS_NEW_MONSTER_SHOW,e[0]),td.PvpFightManager.deleteFirstNewMonster(),td.EventUtil.dispatchEvent(td.EventNameEnum.CHANGE_FIGHT_STATE,td.FightState.UNITFIGHT_PREPARE)}this.node.removeFromParent()}.bind(this));this.node.runAction(cc.sequence(t,e)),this._clearDeadTimeOut()}.bind(this),10)},_clearDeadTimeOut:function(){this._deadTimeOut&&(clearTimeout(this._deadTimeOut),this._deadTimeOut=null)},doReviveAction:function(){this._isDead=!1;var t=this.getReviveData();t.length>0&&this.activeNodeChildren(!0);for(var e=0,i=t.length;e<i;e++)this._playerRevive(t[e])},showBuffEffect:function(t,e){if(e.attackId===this._cfg.getSId()){this._buffNode.removeAllChildren();var i=t;if(i||(i={}),0!==i.myLen())for(var n in i){var a=i[n],r=a.getBuffEffect(),o={},s=a.getEffectId(),l=a.getTargetSid();o.skillTargetId=l,o.effectId=s,o.attackId=e.attackId,o.targetId=e.targetId;var u=r.getBuffExpressionBefore();if(u&&u[0]===td.BuffExpressionType.Anim){var d=r.getBuffPrefabRes(),h=td.GlobalFunction.createPrefabInstance(d),p=h.addComponent(c);p.init(r,u[1]),p.setFlippedX(this._isLeft),this._buffNode.addChild(h),h.name=r.getBuffPrefabName(),p.playAnimation(h.name)}}}},_showBuffEffect:function(t){var e=this,i=(t.isHaveEnemy,t.skillEffect);t.reportData;if(i.getTargetSid()===this._cfg.getSId()&&!i.isImmune()){var n=i.getBuffEffect(),a=i.isSubstitute(),r=n.getTriggerAnima();if(r&&""!==r){var o=this._buffNode.getChildByName(n.getTriggerAnimName()),s=n.getTriggerAnimName();if(!o){o=u.getPrefabFromNodePool(r);cc.isValid(o)||(o=cc.instantiate(gdk.rm.getResByUrl(r,cc.Prefab))),this._buffNode.addChild(o,1e3),o.name=s,o.getComponent(c)||o.addComponent(c)}(d=o.getComponent(c)).playAnimation(s),d.setFinishAnimationCallBack(function(){n.getTriggerAnimName()!=n.getBuffName()&&(o.removeFromParent(!1),u.putPrefabToNodePool(r,o))})}var l=n.getBuffExpression();if(l&&l[0]===td.BuffExpressionType.Anim&&n.getTriggerAnimName()!=n.getBuffName()){var d,h=n.getBuffName(),p=this._buffNode.getChildByName(h),_=1;if(a)for(var g=1;g<=3;g++){if(!this._buffNode.getChildByName(h+"_"+g)){_=g;break}}s=n.getBuffName();if(!p)if(a)for(var f=function(t){m=n.getBuffPrefabRes(),p=u.getPrefabFromNodePool(m),cc.isValid(p)||(p=cc.instantiate(gdk.rm.getResByUrl(m,cc.Prefab))),e._buffNode.addChild(p,1e3),p.name="Buff_baobao_"+_;var i=e._buffBaobaoPos[e._isLeft?1:2];p.eulerAngles=cc.v3(0,e._isLeft?-90:90,0),p.position=i[_],p.getComponent(c)||p.addComponent(c);var a=p.getComponent(cc.Animation),r=a.play("chuchang");r.wrapMode=cc.WrapMode.Normal,r.speed=td.PvpFightController.getInstance().getFightSpeed(),a.on("finished",function(){var t=a.play("idle");t.wrapMode=cc.WrapMode.Loop,t.speed=td.PvpFightController.getInstance().getFightSpeed()}),_++},v=0;v<i.getBuffValue();v++){f()}else{var m=n.getBuffPrefabRes();p=u.getPrefabFromNodePool(m),cc.isValid(p)||(p=cc.instantiate(gdk.rm.getResByUrl(m,cc.Prefab))),this._buffNode.addChild(p,1e3),p.name=n.getBuffPrefabName(),p.getComponent(c)||p.addComponent(c)}d=p.getComponent(c);var y=i.getBuffIdentifys();d.addBuffIdentifys(y),a||(d.playAnimation(s),d.setFinishAnimationCallBack(function(){}))}}},_removeSubstitute:function(t){if(t.effect.getTargetSid()===this._cfg.getSId())for(var e=3;e>0;e--){var i=this._buffNode.getChildByName("Buff_baobao_"+e);if(i){i.removeFromParent();break}}},_removeBuffer:function(t){var e=t.effect;if(e.getTargetSid()===this._cfg.getSId()){var i=e.getBuffIdentifys(),n=e.getBuffEffect(),a=n.getBuffName(),r=n.getBuffPrefabRes();if(a&&""!=a){var o=this._buffNode.getChildByName(a);if(o){var s=o.getComponent(c);s.getCanRemoveBuff(i)&&(u.putPrefabToNodePool(r,o),s.reuse(),o&&o.removeFromParent(!1))}}}},_showBuffAttrChange:function(t){var e=t.effect;if(e.getTargetSid()===this._cfg.getSId()){e.isShowBuff();var i=e.getAttributeMap();i||(i=[]);var n=i[td.SpriteKey.HP];void 0!==n&&this._infoNode.setHpChange(n)}},_showBuffEffectWork:function(t){var e=t.effect,i=(t.isFirst,e.getEffectId());if(e.isShowBuff(),this._showSkillEffect(t),-1==i){if(e.reboundTargetSId!==this._cfg.getSId())return}else if(e.getTargetSid()!==this._cfg.getSId())return;var n=e.getBuffEffect();if(n&&!e.isImmune()&&((o=n.getBuffExpressionBefore())&&o[0]===td.BuffExpressionType.Anim)){var a=this._buffNode.getChildByName(n.getBuffName());if(!a){var r=n.getBuffPrefabRes();a=u.getPrefabFromNodePool(r),cc.isValid(a)||(a=cc.instantiate(gdk.rm.getResByUrl(r,cc.Prefab))),this._buffNode.addChild(a,1e3),a.name=n.getBuffPrefabName(),a.getComponent(c)||a.addComponent(c)}var o,s=a.getComponent(c);s.setFlippedX(this._isLeft),(o=n.getBuffExpression())&&o[0]===td.BuffExpressionType.Anim&&s.setFinishAnimationCallBack(function(){var t=n.getBuffName();s.playAnimation(t)}),s.playAnimation(n.getBuffNameBefore())}},_showSkillEffect:function(t){var e=t.effect,i=t.isFirst,n=t.isEndFrame,a=t.func;if(e.getTargetSid()===this._cfg.getSId()){i&&e.isSubstituteDamage()&&this._removeSubstitute(t);var r=t.times,o=t.precent,s=e.getAttributeMap();s||(s=[]);var l=s[td.SpriteKey.HP];if(void 0!==l&&r>0&&o>0){var c=l%10;l-=c,l=i?Math.round(l*o)+c:Math.round(l*o),this._infoNode.setHpChange(l)}var d=e.getFontImg(),h=e.isAdd(),p=s[td.SpriteKey.RAGE];p&&n&&this._infoNode.setRageChange(p);var _=e.getFontImgShowType();if(n&&""!=d&&""!=_){var g=e.isBuffShow()&&!e.isRemoveBuff();if(g&&2==_||!g&&1==_)return;for(var f=h?"PVP_wz_tisheng":"PVP_wz_jiangdi",v=this._imgLayer,m=v.children,y=0,E=m.length;y<E;y++)m[y].y=m[y].y+70;var T=u.getNodeFromNodePool(d);cc.isValid(T)?v.addChild(T,this._Z_ORDER_BUFF_ICON):((T=new cc.Node).name=d,v.addChild(T,this._Z_ORDER_BUFF_ICON),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,d,T)),T.y=h?90:55;var C=h||!h&&0===h;if(C){var R=u.getNodeFromNodePool(f);cc.isValid(R)?v.addChild(R,this._Z_ORDER_BUFF_ICON+(h?1:-1)):((R=new cc.Node).name=f,v.addChild(R,this._Z_ORDER_BUFF_ICON+(h?1:-1)),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.PVP_zhandou,f,R)),R.active=C,R.y=h?55:90;var S=cc.sequence(cc.delayTime(1.2),cc.moveBy(1.2,0,50),cc.callFunc(function(t){t.removeFromParent(!1),u.putNodeToNodePool(t.name,t)}));R.runAction(S)}var I=cc.sequence(cc.delayTime(1.2),cc.moveBy(1.2,0,50),cc.callFunc(function(t){t.removeFromParent(!1),u.putNodeToNodePool(t.name,t),a&&a()}));T.runAction(I)}else a&&a()}},_playerRevive:function(t){var e=t.effect;if(e.getTargetSid()===this._cfg.getSId()){var i=e.getAttributeMap();if(!i.hasOwnProperty(td.SpriteKey.HP))return td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SKILL_EFFECT_PREPARE,t),void td.PvpFightController.getInstance()._dataController.refreshMemberAttr({sid:e.getTargetSid(),attrMap:i});var n=t.cb,a=e.getBuffEffect(),r=a.getBuffExpressionBefore();if(r&&r[0]===td.BuffExpressionType.Anim){var o=this._buffNode.getChildByName(a.getBuffName());if(!o){var s=a.getBuffPrefabRes();o=u.getPrefabFromNodePool(s),cc.isValid(o)||(o=cc.instantiate(gdk.rm.getResByUrl(s,cc.Prefab))),this._buffNode.addChild(o,1e3),o.name=a.getBuffPrefabName(),o.getComponent(c)||o.addComponent(c)}var l=o.getComponent(c);l.setFlippedX(this._isLeft);var d=this;l.playAnimation(a.getBuffNameBefore()),l.setFinishAnimationCallBack(function(){u.putPrefabToNodePool(s,o),d.idle(),d._buffNode.visible=!0,d._buffIconNode.visible=!0,d._infoNode.visible=!0,d._suolianNode.visible=!0,d._setBottomAndInfoVisible(!0),td.PvpFightController.getInstance()._dataController.refreshMemberAttr({sid:e.getTargetSid(),attrMap:i}),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SKILL_EFFECT_PREPARE,t),n&&n(),o.removeFromParent(!1),d._reviveData=[]})}}},getBuffNode:function(){return this._buffNode},_setBottomAndInfoVisible:function(t){this._setInfoNodeVisible(t)},_setInfoNodeVisible:function(t){this._infoNode&&(this._cfg.getBaseModel().getModelShowType()!==td.SpriteType.PET?this._infoNode.node.active=t:this._infoNode.node.active=!1)},getFightOffset:function(){if(this._cfg&&this._cfg.getFightOffset){var t=1;this._cfg.getScale&&(t=this._cfg.getScale());var e=this._animation.getDefaultSize();if(e){var i=this._cfg.getFightOffset();return cc.v2((e.width/2-i.x)*t,i.y*t)}}return cc.v2(0,0)},_setReviveData:function(t){!t||t&&0==t.length||t[0].effect.getTargetSid()==this._cfg.getSId()&&(this._reviveData=t)},getReviveData:function(){return this._reviveData||[]}});e.exports=d,cc._RF.pop()},{AnimationComponent:void 0,PvPNodePoolManager:"PvPNodePoolManager",PvpBattleShowAtkAnimation:"PvpBattleShowAtkAnimation",PvpBattleSkillAnimation:"PvpBattleSkillAnimation",PvpBattleUnderAtkAnimation:"PvpBattleUnderAtkAnimation",PvpFightBuffAnimation:"PvpFightBuffAnimation",PvpFightMercenaryInfoComponent:"PvpFightMercenaryInfoComponent",SpriteAnimation:"SpriteAnimation","state-machine":void 0}],PvpFightObjectPool:[function(t,e,i){"use strict";cc._RF.push(e,"97422ooO91GmYaijsGIbHmd","PvpFightObjectPool"),td.PvpRageObjectPool={_ragePool:[],clear:function(){for(var t=0,e=this._ragePool.length;t<e;t++){var i=this._ragePool[t];i&&i.destroy()}this._ragePool=[]},pop:function(){var t=this._ragePool.length;if(0===t)return null;var e=this._ragePool[t-1];return this._ragePool.splice(t-1,1),e},push:function(t){this._ragePool[length]=t}},cc._RF.pop()},{}],PvpFightPanel:[function(t,e,i){"use strict";cc._RF.push(e,"d2bcdw+os5MHakLMojnGQq1","PvpFightPanel");var n=r(t("../../../Babel/Manager/BabelManager")),a=r(t("../../../Legend/Manager/LegendManager"));function r(t){return t&&t.__esModule?t:{default:t}}var o=t("PanelBase"),s=t("PvpFightRoleLayer"),l=t("PvpFightEffectView"),c=t("PvpFightResultView"),u=t("AnimationComponent"),d=t("PvPNodePoolManager"),h=t("../Model/PvpFsmEventId");cc.Class({extends:o,properties:{},init:function(){this._panelType=td.PanelType.Panel,this._panelEnum=td.PanelEnum.Panel_PVP_FIGHT},onLoad:function(){},start:function(){this._super(),this._addFightBg(),this._setSceneOther(),this.node.addChild(td.PvpFightController.getInstance()),this._addEventListener(),this.scheduleOnce(this._playStartAnima,1.6)},onDisable:function(){this._removeEventListener(),td.PvpFightController.getInstance().removeFromParent(!1),this.unschedule(this._playStartAnima),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_MUSIC,td.SoundEnum.Hook),d.onDestroy(),this._super()},onEnable:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_MAIN_LAYER_MESSAGE_LAYER),gdk.Timer.callLater(this,this.playBgMusic),d.init()},playBgMusic:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_MUSIC,td.SoundEnum.Pvp)},_addEventListener:function(){var t=td.EventNameEnum,e={};e[t.PREPARE_UNIT_FIGHT_PLAY]=this._prepareUnitFightPlay,e[t.END_REPORT_PLAY]=this._finishedReportPlay,e[t.STOP_FIGHT_NOW]=this._stopFightNow,e[t.SHOW_FIGHT_RESULT_PANEL]=this._showFightResultPanel,e[t.END_PLAY_FIGHT]=this._finishedPlay,td.EventUtil.registerEvents(e,this)},_removeEventListener:function(){td.EventUtil.unregisterAllEvents(this)},_addFightBg:function(){var t=td.UIAdaptiveUtil.getDesignSize(),e=td.resDef.background.pvp_bg_arena;e=td.PvpFightManager.getFightType()===td.FightType.Arena?td.resDef.background.pvp_bg_arena:td.PvpFightManager.getFightType()===td.FightType.DESTROY_TEMPLE?td.resDef.background.pvp_bg_other:td.resDef.background.pvp_bg_boss;var i=new cc.Node;i.width=t.width,i.height=t.height,this.node.addChild(i,td.PvpFightLayerTag.ZOrder_Bg_Layer,td.PvpFightLayerTag.ZOrder_Bg_Layer+""),td.GlobalFunction.createSpriteNode(i,e),i.getComponent(cc.Sprite).sizeMode=cc.Sprite.SizeMode.CUSTOM,i.opacity=0,i.runAction(cc.fadeIn(.3)),td.PvpFightManager.setPvpBgLayer(i)},_setSceneOther:function(){var t=this._addFightRoleLayer(),e=gdk.rm.getResByUrl("prefab/Pvp/PvpFightUI",cc.Prefab);e=cc.instantiate(e),this.node.addChild(e,td.PvpFightLayerTag.ZOrder_Fight_UI,td.PvpFightLayerTag.ZOrder_Fight_UI+"");var i={};i.leftNodes=t.getLeftNodes(),i.rightNodes=t.getRightNodes();var n=cc.instantiate(gdk.rm.getResByUrl("prefab/Pvp/PvpBaseLayer",cc.Prefab));n.addComponent(l).init(i),this.node.addChild(n,td.PvpFightLayerTag.ZOrder_Effect_Layer,td.PvpFightLayerTag.ZOrder_Effect_Layer+""),td.PvpFightManager.setPvpEffectLayer(n)},_playStartAnima:function(){var t=gdk.rm.getResByUrl(td.resDef.KaiShiZhanDou_Effect,cc.Prefab),e=cc.instantiate(t);this.node.addChild(e,99),e.addComponent(u).setFinishAnimationCallBack(function(){e.removeFromParent(),td.EventUtil.dispatchEvent(td.EventNameEnum.START_PLAY_FIGHT,td.SceneName.PvpFightScene)}),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.START_GAME)},_addFightRoleLayer:function(){var t=td.PvpFightManager.getFightType(),e=td.PvpFightController.getInstance().getFightMembers(),i=gdk.rm.getResByUrl("prefab/Pvp/PvpFightRoleLayer",cc.Prefab),n=cc.instantiate(i),a=n.getComponent(s);return a.init(t,e),this.node.addChild(n,td.PvpFightLayerTag.ZOrder_Role_Layer,td.PvpFightLayerTag.ZOrder_Role_Layer+""),td.PvpFightManager.setPvpRoleLayer(n),a},_prepareUnitFightPlay:function(t){for(var e,i=t.report,n=i.isGenAttack(),a=i.getSkillEffects(),r=!1,o=td.FightEffectIdEnum,s=0,l=a.length-1;s<=l;s++){var c=a[s];if(c)if(c.getEffectId()!==o.AttackRage){r=!0;break}}this._setSkillFightLayerVisible(!n&&r),(e=this.node.getChildByName(td.PvpFightLayerTag.ZOrder_Role_Layer+""))?td.PvpFightPlayController.initNode(e):td.GameFightError(td.FightType.None)},_setSkillFightLayerVisible:function(t){},_finishedReportPlay:function(){this._setSkillFightLayerVisible(!1)},_stopFightNow:function(){this._setSkillFightLayerVisible(!1),td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSEROLELAYER)},_finishedPlay:function(){if(td.PvpFightManager.getFightType()===td.FightType.BABEL&&-1!=n.default.getInstance().checkShowSkillType())return;var t=this.node.getChildByName(td.PvpFightLayerTag.ZOrder_Fight_UI+"");t&&(t.active=!1),(t=this.node.getChildByName(td.PvpFightLayerTag.ZOrder_Effect_Layer+""))&&(t.active=!1)},_showFightResultPanel:function(){if(td.PvpFightManager.getFightResult().getFightType()==td.FightType.LEGEND&&a.default.getInstance().isReplay())return td.EventUtil.dispatchEvent(td.EventNameEnum.EXIT_PVP_SCENE),void gdk.fsm.Fsm.broadcastEvent(h.ENTER_MAIN_SCENE);var t=gdk.rm.getResByUrl("prefab/Pvp/PvpFightResultLayer"),e=cc.instantiate(t);e.getComponent(c).setData(td.PvpFightManager.getFightResult()),this.node.addChild(e,td.PvpFightLayerTag.ZOrder_Result_Layer,td.PvpFightLayerTag.ZOrder_Result_Layer+"")}}),cc._RF.pop()},{"../../../Babel/Manager/BabelManager":"BabelManager","../../../Legend/Manager/LegendManager":"LegendManager","../Model/PvpFsmEventId":"PvpFsmEventId",AnimationComponent:void 0,PanelBase:void 0,PvPNodePoolManager:"PvPNodePoolManager",PvpFightEffectView:"PvpFightEffectView",PvpFightResultView:"PvpFightResultView",PvpFightRoleLayer:"PvpFightRoleLayer"}],PvpFightPlayController:[function(t,e,i){"use strict";cc._RF.push(e,"6b2aeFgHS1D+7QdrEsrspET","PvpFightPlayController");var n=t("PvpFightMercenary"),a=t("PvpFightEffectView"),r=t("PvpFightTrajectory"),o=t("PvpBattleSkillAnimation"),s=(t("PvpFightSkillNameAnimation"),t("PvPNodePoolManager"));td.PvpFightPlayController={_roleNode:null,_reportData:null,_mercenaryCamp:null,_targetCamp:null,_shakTime:null,init:function(t){this.destroyData(),this._reportData=t;var e=this._reportData.getMercenarySId();this._mercenaryCamp=td.PvpFightManager.getCampByMercenarySid(e),this._targetCamp=td.PvpFightManager.getTargetCamp(this._mercenaryCamp)},destroyData:function(){this._roleNode=null,this._reportData=null,this._mercenaryCamp=null,this._targetCamp=null},getReportData:function(){return this._reportData},initNode:function(t){if(this._reportData){for(var e=this._reportData.getSkillEffects(),i=(this._reportData.getMercenarySId(),this._reportData.getTargetSIds(),!1),a=td.FightEffectIdEnum,r=0,o=e.length-1;r<=o;r++){var s=e[r];if(s)if(s.getEffectId()!==a.AttackRage){i=!0;break}}!this._reportData.isGenAttack()&&i&&this._moveMercenaryToPlayLayer(),this._roleNode=t;this._reportData.getRoundIndex();var l=this._roleNode,c=l.getChildren();for(r=0,o=l.getChildrenCount()-1;r<=o;r++){var u=c[r].getComponent(n);u&&u.getCfg()&&u.refresh()}}else td.GameFightError(td.FightType.None)},_moveMercenaryToPlayLayer:function(){},resetNode:function(){this._reportData&&this._reportData.isGenAttack?this._reportData.isGenAttack()||this._moveMercenaryToRoleLayer():td.GameFightError(td.FightType.None)},_moveMercenaryToRoleLayer:function(){},startUnitFight:function(){this._playSkillNameAnimation()},dispatchUnitFight:function(){for(var t=0,e=td.FightPlayFinishEnum.length-1;t<=e;t++){var i={};i.sid=this._reportData.getTargetSIds(),i.eventEnum=td.FightPlayFinishEnum[t],td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_FIGHT_FINISH,i)}},_playSkillNameAnimation:function(){var t=this._reportData,e=t.getMercenarySId(),i=td.PvpFightController.getInstance().getRoleDataBySId(e);if(i){if(i.getHp()<0)if(!td.PvpFightController.getInstance()._dataController.isCurReportValid(e))return void this.dispatchUnitFight();var n=t.getSkillId(),r=t.getSkillEffects(),o=td.GetTableClass(td.TableEnum.SkillEffect);if(!n){for(var s=this,l=0,c=r.length-1;l<=c;l++){if(p=r[l])if(S=o.getDataById(p.getEffectId())){(I={}).targeterUid=p.getTargetSid(),I.effectId=p.getEffectId(),I.attributeMap=[];var u=td.EffectFactory.createEffect(S.effectType,I);if(p.setBuffEffect(u),p.isRemoveBuff())td.EventUtil.dispatchEvent(td.EventNameEnum.REMOVE_BUFF_EFFECT,{effect:p,isFirst:!0,isEndFrame:!1});else{var d={effect:p,isFirst:!0,isEndFrame:!1,times:1,precent:1};td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_BUFF_EFFECT_WORK,d)}}else td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_BUFF_FONT,p)}return td.PvpFightController.getInstance().refreshMemberAttr(t),void this.dispatchUnitFight()}if(td.PvpFightController.getInstance().getIsReviveReport(t)){var h=[];for(l=0,c=(r=t.getSkillEffects()).length-1;l<=c;l++){var p=r[l];if(S=o.getDataById(p.getEffectId())){(I={}).targeterUid=p.getTargetSid(),I.effectId=p.getEffectId(),I.attributeMap=[];u=td.EffectFactory.createEffect(S.effectType,I);p.setBuffEffect(u)}var _={effect:p,isFirst:!0,isEndFrame:!1,times:1,precent:1,cb:this.dispatchUnitFight.bind(this)};h.push(_)}return td.EventUtil.dispatchEvent(td.EventNameEnum.SET_REVIVE_DATA,h),void td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_HERO_TRRI_DEAD)}var g=!1;if(n)g=1==td.GetTableClass(td.TableEnum.Skill).getSkillById(n).triggerType||td.SpriteType.PET==i.getBaseModel().getModelShowType();if(g&&n)this._playAttackAnimation();else{var f=td.PvpFightManager.getPvpEffectLayer();if(!f)return;var v=(f=f.getComponent(a)).getSkillNode(),m=td.UIAdaptiveUtil.getWinSize(),y=(s=this,this._reportData.getFightShowData()),E=(r=this._reportData.getSkillEffects(),this._reportData.getHasSkillFightShow()),T=(this._reportData.getMercenarySId(),this._reportData.getTargetSIds()),C=(this._reportData.getFightShowData(),td.PvpFightManager.getFightType()==td.FightType.PREVIEW_FIGHT);if(!E||E&&0==T.length&&!C){var R=[];for(l=0,c=r.length-1;l<=c;l++){var S;if((p=r[l]).isBuffShow())if(S=o.getDataById(p.getEffectId())){var I;(I={}).targeterUid=p.getTargetSid(),I.effectId=p.getEffectId(),I.attributeMap=[];u=td.EffectFactory.createEffect(S.effectType,I);if(p.setBuffEffect(u),p.isRemoveBuff()){td.EventUtil.dispatchEvent(td.EventNameEnum.REMOVE_BUFF_EFFECT,{effect:p,isFirst:!0,isEndFrame:!1});continue}R[R.length]=p}td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SKILL_EFFECT_PREPARE,{effect:p,precent:1,isFirst:!0,isEndFrame:!0,times:1,hasFightShow:!1})}return this._triggerBuffEffect(R,!0),td.PvpFightController.getInstance().refreshMemberAttr(t),void(E?this._playAttackAnimation():this.dispatchUnitFight())}if(y.getSkillName()){var A=gdk.rm.getResByUrl("prefab/Pvp/Mercenary",cc.Prefab);A.init(fightShow),v.addChild(A),A.setPosition(cc.v2(m.width/2,m.height/2)),A.setFrameListener(function(){s._playAttackAnimation()}),A.playAnimation()}else s._playAttackAnimation()}}},_playAttackAnimation:function(){var t=this._findMercenaryNode(),e=this._findTargetNode();e&&e.getParent()&&(e.getParent().zIndex=1),t&&t.getParent()&&(t.getParent().zIndex=2);var i=this._reportData,n=i.getMercenarySId(),a=i.getFightShowData(),r={};r.sid=n,r.type=a.getType(),r.pos=this._calcNodeDeltaPos(t,e),r.showData=a,td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_ATK_SKILL_NAME,r)},finishHeroAtkActionFront:function(){var t=this._reportData,e=t.getMercenarySId(),i=t.getFightShowData(),n={};n.sid=e,n.showData=i,td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_ATK_ACTION_CENTER,n)},finishHeroAtkActionCenter:function(){if(this._reportData){var t,e=this._reportData,i=e.getFightShowData();if(i.getAtkShowType()===td.FightShowType.atkAction)(t={}).sid=e.getMercenarySId(),t.type=i.getType(),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_ATK_ACTION_BACK,t),this._heroAtkCallback(i.getAtkTimes());else(t={}).sid=e.getMercenarySId(),t.showData=i,td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_ATK_SHOW,t);this._playReleaseSkillSound()}else td.GameFightError(td.FightType.None)},_playReleaseSkillSound:function(){if(this._reportData){var t=this._reportData.getFightShowData().getReleaseSound();t&&t>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,t)}else td.GameFightError(td.FightType.None)},finishHeroAtkShow:function(){var t=this._reportData,e=t.getFightShowData(),i={};i.sid=t.getMercenarySId(),i.type=e.getType();e.getReleaseSound();td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_ATK_ACTION_BACK,i)},finishHeroAtkActionBack:function(){},playTrajectoryShow:function(t){var e=this._reportData;if(e){var i=e.getMercenarySId(),o=e.getFightShowData(),s=o.getAtkShowType(),l=td.PvpFightController.getInstance().getRoleDataBySId(i),c=(e.getTargetSIds(),td.GetTableClass(td.TableEnum.PvpFightShow).getShowDataByType(l.getBaseModel().getRoleType(),l.getBaseModel().getModelShowType()));c=c[o.getSkillId()];var u=td.PvpFightManager.getCampByMercenarySid(i);td.BattleCamp.LEFT,td.PvpFightManager.getPvpEffectLayer().getComponent(a).getSkillNode();if(p=this._findMercenaryNode()){var d=p.getComponent(n).getMercenaryScale();if(s===td.FightShowType.trajectory){u=td.PvpFightManager.getTargetCamp(u);for(var h=e.getTargetSIds(),p=this._findMercenaryNode(),_=0,g=h.length-1;_<=g;_++){var f=this._findNodeByCampAndSid(u,h[_]),v=this._calcNodeDeltaPos(p,f);v=cc.v2(v.x,v.y);var m=c.trajectorySpRes,y=td.GlobalFunction.createPrefabInstance(m);y.setScale(d),y.addComponent(r).init(v,0===_,c),p.addChild(y,10,"10")}}}else td.GameFightError(td.FightType.None)}else td.GameFightError(td.FightType.None)},playAtkShow:function(t){var e=this._reportData;if(e){var i=e.getMercenarySId(),n=e.getFightShowData(),r=n.getAtkShowType(),o=td.PvpFightController.getInstance().getRoleDataBySId(i),s=(e.getTargetSIds(),td.GetTableClass(td.TableEnum.PvpFightShow).getShowDataByType(o.getBaseModel().getRoleType(),o.getBaseModel().getModelShowType()));s=s[n.getSkillId()];var l=td.PvpFightManager.getCampByMercenarySid(i)==td.BattleCamp.LEFT,c=td.PvpFightManager.getPvpEffectLayer().getComponent(a).getSkillNode(),u=this._findMercenaryNode();u?r!==td.FightShowType.skillAnimation&&r!==td.FightShowType.skillAnimation2&&r!==td.FightShowType.atk_skillAnimation||this._addSkillAnimation(c,u,s,l):td.GameFightError(td.FightType.None)}else td.GameFightError(td.FightType.None)},_addSkillAnimation:function(t,e,i,r){td.UIAdaptiveUtil.getWinSize();var l=td.SkillAnimationShowType,c=this._reportData,u=c.getMercenarySId(),d=td.PvpFightManager.getCampByMercenarySid(u),h=c.getTargetSIds(),p=c.getMyCampTargetSids(),_=c.getEnemyTargetSids(),g=(e=this._findMercenaryNode()).getComponent(n),f=g.getMercenaryScale(),v=null;if(g._cfg.getBaseModel().getModelShowType()===td.SpriteType.PET){var m="atkAnimation_"+g._cfg.getRoleType()+"_"+i.skillId;(v=e.getChildByName(m)).active=!0}if(i.skillAnimationShowType!==l.target){var y=i.skillAnimationRes;if((B=s.getSkillEffectNodePool(i.skillId))||(B=td.GlobalFunction.createPrefabInstance(y)).addComponent(o),B.setScale(f),(w=B.getComponent(o)).init(i),i.skillAnimationShowType===l.center_enemy||i.skillAnimationShowType===l.center_mine){var E=-100;i.skillAnimationShowType===l.center_enemy&&(d=td.PvpFightManager.getTargetCamp(d)),d==td.BattleCamp.RIGHT&&(E=-E),B.setPosition(cc.v2(E,-123)),w.setFlippedX(r&&i.skillAnimationShowType===l.center_enemy||!r&&i.skillAnimationShowType===l.center_mine),t.addChild(B,99,"99"),v&&(v.parent=t,v.setPosition(cc.v2(B.position.x,B.position.y))),w.setFrameListener(),w.playAnimation()}else if(i.skillAnimationShowType===l.row_enemy||i.skillAnimationShowType===l.row_mine){var T=t.getParent().getComponent(a),C=null;C=i.skillAnimationShowType===l.row_enemy?T.getPos(_[0]):T.getPos(p[0]),C=t.convertToNodeSpaceAR(C),B.setPosition(cc.v2(0,C.y)),w.setFlippedX(r&&i.skillAnimationShowType===l.row_enemy||!r&&i.skillAnimationShowType===l.row_mine),t.addChild(B,99,"99"),v&&(v.parent=t,v.setPosition(cc.v2(B.position.x,B.position.y))),w.setFrameListener(),w.playAnimation()}else if(i.skillAnimationShowType===l.col_enemy){C=(T=t.getParent().getComponent(a)).getPos(_[0]);C=t.convertToNodeSpaceAR(C),B.setPosition(cc.v2(C.x,-123)),w.setFlippedX(r&&i.skillAnimationShowType===l.col_enemy),t.addChild(B,99,"99"),v&&(v.parent=t,v.setPosition(cc.v2(B.position.x,B.position.y))),w.setFrameListener(),w.playAnimation()}else if(i.skillAnimationShowType===l.col_mine){C=(T=t.getParent().getComponent(a)).getPos(p[0]);C=t.convertToNodeSpaceAR(C),B.setPosition(cc.v2(C.x,-123)),w.setFlippedX(!r&&i.skillAnimationShowType===l.col_mine),t.addChild(B,99,"99"),v&&(v.parent=t,v.setPosition(cc.v2(B.position.x,B.position.y))),w.setFrameListener(),w.playAnimation()}else if(i.skillAnimationShowType===l.release){d=td.PvpFightManager.getTargetCamp(d);var R=this._findNodeByCampAndSid(d,h[0]);w.setFlippedX(r);C=this._calcNodeDeltaPos(e,R);w.setRotation(C),e.addChild(B,99,"99"),w.setFrameListener(),w.playAnimation()}else if(i.skillAnimationShowType===l.targets_middle_enemy){for(var S=0,I=0,A=(T=t.getParent().getComponent(a),0);A<_.length;A++){S+=(C=T.getPos(_[A])).x,I+=C.y}S/=_.length,I/=_.length,w.setFlippedX(r&&i.skillAnimationShowType===l.targets_middle_enemy);C=t.convertToNodeSpaceAR(cc.v2(S,I));B.setPosition(C),t.addChild(B,99,"99"),v&&(v.parent=t,v.setPosition(cc.v2(B.position.x,B.position.y))),w.setFrameListener(),w.playAnimation()}else if(i.skillAnimationShowType===l.targets_middle_mine){for(var b=0,P=0,N=(T=t.getParent().getComponent(a),0);N<p.length;N++){b+=(C=T.getPos(_[N])).x,P+=C.y}b/=p.length,P/=p.length,w.setFlippedX(!r&&i.skillAnimationShowType===l.targets_middle_mine);C=t.convertToNodeSpaceAR(cc.v2(b,P));B.setPosition(C),t.addChild(B,99,"99"),v&&(v.parent=t,v.setPosition(cc.v2(B.position.x,B.position.y))),w.setFrameListener(),w.playAnimation()}}else{h=_,h=(h=_&&_.length>0?_:p)||[];for(var M=cc.v2(0,0),L=0,D=h.length-1;L<=D;L++){var B,w;(B=s.getSkillEffectNodePool(i.skillId))||(B=td.GlobalFunction.createPrefabInstance(i.skillAnimationRes)).addComponent(o),B.setScale(f),(w=B.getComponent(o)).init(i,h[L]),0!==L?(w.setExecuteCallBack(!1),w.setLastFrameListener()):w.setFrameListener(),t.addChild(B,99,"99");C=(T=t.getParent().getComponent(a)).getPos(h[L]);C=t.convertToNodeSpaceAR(C),M.x+=C.x,M.y+=C.y,B.setPosition(C),w.setFlippedX(r),w.playAnimation()}v&&(v.parent=t,v.setPosition(cc.v2(M.x/h.length,M.y/h.length)))}},_findMercenaryNode:function(){var t=this._reportData.getMercenarySId(),e=td.PvpFightManager.getCampByMercenarySid(t);return this._findNodeByCampAndSid(e,t)},_findTargetNode:function(){var t=this._reportData.getEnemyTargetSids(),e={},i=this._reportData.getMercenarySId(),a=td.PvpFightManager.getCampByMercenarySid(i);a=td.PvpFightManager.getTargetCamp(a);for(var r=0,o=t.length-1;r<=o;r++){var s=this._findNodeByCampAndSid(a,t[r]);if(s)e[s.getComponent(n).getCfg().getPos()]=s}return e[td.ArrayUtil.frontKey(e)]},_findNodeByCampAndSid:function(t,e){if(this._roleNode){for(var i=this._roleNode.getChildren(),a=0,r=i.length-1;a<=r;a++){var o=i[a],s=o.getComponent(n);if(s){var l=s.getCfg();if(l&&e==l.getBaseModel().getSId())return o}}return null}td.GameFightError(td.FightType.StoryHandUp)},_calcNodeDeltaPos:function(t,e){if(!t||!e)return cc.v2(0,0);var i=t.getParent(),a=e.getParent(),r=t.getPosition(),o=e.getPosition(),s=i.getPosition(),l=a.getPosition(),c=(e.getComponent(n),this._reportData),u=c.getMercenarySId(),d=c.getFightShowData(),h=(d.getAtkShowType(),td.PvpFightController.getInstance().getRoleDataBySId(u)),p=td.GetTableClass(td.TableEnum.PvpFightShow).getShowDataByType(h.getBaseModel().getRoleType(),h.getBaseModel().getModelShowType());return(p=p[d.getSkillId()]).skillAnimationShowType===td.SkillAnimationShowType.col_enemy&&(o=cc.v2(o.x,-123)),r=cc.v2(r.x+s.x,r.y+s.y),o=cc.v2(o.x+l.x,o.y+l.y),cc.v2(o.x-r.x,o.y-r.y)},_heroAtkCallback:function(t){for(var e=t,i=this,n=[],a=1;a<=e;a++)n[a]=setTimeout(function(t){i.triggerUnderAttackEffect(1===t,t===e,t),t===e&&(cc.log("finishHeroAtk:heroAtkCallback"),td.EventUtil.dispatchEvent(td.EventNameEnum.FINISH_HERO_ATK_SHOW)),clearTimeout(n[t]),n[t]=null,n.splice(t,1)}.bind(this,a),10*a)},triggerUnderAttackEffect:function(t,e,i,n,a,r){r=r||!1;var o=this._triggerUnderAttackAnimation(t,e);if(this._triggerSkillEffect(this._reportData,[],[],t,i,e,o),this._shakeScene(o),this._reportData){var s=this._reportData.getFightShowData().getAtkTimes();if(s>1&&o){for(var l=this._reportData.getTargetSIds().length,c=0,u=this._reportData.getSkillEffects(),d=0,h=u.length-1;d<=h;d++){var p=u[d],_=p.getAttributeMap();_[td.SpriteKey.HP]&&_[td.SpriteKey.HP]<0&&(c+=_[td.SpriteKey.HP]),p.isMiss()&&(l-=1)}td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_COMBO_EFFECT,{times:l,hp:Math.ceil(Math.abs(c)/s),frameIndex:i,totalFrame:n,framePercent:a})}this._playUnderAtkSound()}else td.GameFightError(td.FightType.None)},_triggerUnderAttackAnimation:function(t,e){var i={};if(this._reportData){i.attacker=this._reportData.getMercenarySId(),i.targetSids=this._reportData.getTargetSIds(),i.showData=this._reportData.getFightShowData();for(var n=td.PvpFightManager,a=this._reportData.getMercenarySId(),r=n.getCampByMercenarySid(a),o=n.getTargetCamp(r),s=!1,l=0,c=i.targetSids.length-1;l<=c;l++){if(n.getCampByMercenarySid(i.targetSids[l])==o){s=!0;break}}return i.isHaveEnemy=s,i.isEndFrame=e,td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_UNDER_ATTACK_ANIMATION,i),s||((i={}).sid=this._reportData.getTargetSIds(),i.eventEnum=td.FightPlayFinishEnum[1],td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_FIGHT_FINISH,i)),s}td.GameFightError(td.FightType.None)},triggerPlayerBuffEffect:function(){var t=this._reportData;if(t){for(var e=[],i=t.getSkillEffects(),n=(t.getFightShowData(),t.getRoundIndex(),0),a=i.length-1;n<=a;n++){var r=i[n];if(r.isBuffShow()){var o={};o.targeterUid=r.getTargetSid(),o.effectId=r.getEffectId(),o.attributeMap=[];r.getEndRound();var s=td.GetTableClass(td.TableEnum.SkillEffect).getDataById(o.effectId);if(s){var l=td.EffectFactory.createEffect(s.effectType,o);r.setBuffEffect(l),e[e.length]=r}}}if(this._reportData){var c=this._reportData.getTargetSIds(),u=td.PvpFightManager,d=this._reportData.getMercenarySId(),h=u.getCampByMercenarySid(d),p=u.getTargetCamp(h),_=!1;for(n=0,a=c.length-1;n<=a;n++){if(u.getCampByMercenarySid(c[n])==p){_=!0;break}}this._triggerBuffEffect(e,_)}else td.GameFightError(td.FightType.None)}else td.GameFightError(td.FightType.None)},_triggerSkillEffect:function(t,e,i,n,a,r,o){if(t)for(var s=t.getSkillEffects(),l=t.getFightShowData(),c=l.getAtkTimes(),u=l.getAttackPrecent(a),d=(t.getRoundIndex(),-1),h=0,p=s.length-1;h<=p;h++){var _=s[h];if(n)if(_.isRemoveBuff()){(v={}).targeterUid=_.getTargetSid(),v.effectId=_.getEffectId(),v.attributeMap=[];_.getEndRound();var g=td.GetTableClass(td.TableEnum.SkillEffect).getDataById(v.effectId),f=td.EffectFactory.createEffect(g.effectType,v);_.setBuffEffect(f),td.EventUtil.dispatchEvent(td.EventNameEnum.REMOVE_BUFF_EFFECT,{effect:_,isFirst:n,isEndFrame:r})}else{var v;if(_.isBuffShow()){if((v={}).targeterUid=_.getTargetSid(),v.effectId=_.getEffectId(),v.attributeMap=[],g=td.GetTableClass(td.TableEnum.SkillEffect).getDataById(v.effectId)){f=td.EffectFactory.createEffect(g.effectType,v);_.setBuffEffect(f),this._triggerBuffEffect([_],o)}}else if((v={}).targeterUid=_.getTargetSid(),v.effectId=_.getEffectId(),v.attributeMap=[],-1==v.effectId&&(_.reboundTargetSId=d),g=td.GetTableClass(td.TableEnum.SkillEffect).getDataById(v.effectId)){f=td.EffectFactory.createEffect(g.effectType,v);_.setBuffEffect(f)}}_.isRemoveBuff()||td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SKILL_EFFECT_WORK,{effect:_,isFirst:n,isEndFrame:r,times:c,precent:u,hasFightShow:!0,frameIndex:a}),d=_.getTargetSid()}else td.GameFightError(td.FightType.None)},_triggerBuffEffect:function(t,e){var i=t,n=this._reportData.getMercenarySId(),a=this._reportData.getTargetSIds(),r={};r.attackId=n,r.targetId=a;for(var o=0,s=i.length-1;o<=s;o++){var l=i[o];td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_BUFF_EFFECT,{skillEffect:l,isHaveEnemy:e,reportData:r})}},_playUnderAtkSound:function(){var t=this._reportData.getFightShowData().getUnderAtkSound();td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,t)},refreshUnitBuffAttr:function(t){},refreshAllHero:function(){if(this._roleNode)for(var t=this._roleNode,e=t.getChildren(),i=t.getChildrenCount(),n=0;n<i;n++){e[n].refresh()}},shakeSceene:function(){this._shakTime=0,cc.director.getScene().schedule(this._shakUpdate.bind(this),.01,110)},_shakUpdate:function(t){this._shakTime+=t;var e=td.PvpFightManager.getPvpRoleLayer();if(e){var i=20*Math.random()*(10*Math.random()%2==0?1:-1),n=20*Math.random()*(10*Math.random()%2==0?1:-1);this._shakTime>1?(e.x=0,e.y=0):(e.x=i,e.y=n),cc.log(e.x+", "+e.y)}},_shakeScene:function(t){var e=!0;if(td.PvpFightManager.getFightType()===td.FightType.StoryHandUp&&(e=!1),e&&!this._reportData.isGenAttack()&&t){var i,n;4*Math.random()<2?(i=10,n=10):(i=10,n=-10);var a=td.PvpFightManager.getPvpBgLayer(),r=cc.moveBy(.03,i,n),o=cc.moveBy(.03,-i,-i),s=cc.moveBy(.03,-i,-i),l=cc.moveTo(.03,0,0),c=cc.callFunc(function(t){t.setPosition(0,0)});a&&a.runAction(cc.sequence(r,o,s,l,c));var u=td.PvpFightManager.getPvpRoleLayer();u&&u.runAction(cc.sequence(r,o,s,l,c))}}},cc._RF.pop()},{PvPNodePoolManager:"PvPNodePoolManager",PvpBattleSkillAnimation:"PvpBattleSkillAnimation",PvpFightEffectView:"PvpFightEffectView",PvpFightMercenary:"PvpFightMercenary",PvpFightSkillNameAnimation:"PvpFightSkillNameAnimation",PvpFightTrajectory:"PvpFightTrajectory"}],PvpFightReport:[function(t,e,i){"use strict";cc._RF.push(e,"99118IbcdRGdZb8wvOhuCUc","PvpFightReport");var n=t("Model");td.PvpFightReport=cc.Class({extends:n,properties:{_fightType:null,_roundIndex:null,_reportIndex:null,_mercenarySId:null,_targetSids:null,_skillId:null,_isGenAtk:null,_fightShowData:null,_effects:null,_damageType:null},init:function(t,e,i,n){this._super("PvpFightReport"),this._fightType=t,this._reportIndex=i,this._roundIndex=n,this._mercenarySId=e.attackerUid,this._skillId=e.skillId,this._damageType=parseInt(e.damageType),this._isGenAtk=!1,this._fightShowData=null,this._effects=[],this._targetSids=[],this._resetEffect(e.effectList)},_resetEffect:function(t){this._effects.length=0,this._targetSids.length=0;for(var e=this._targetSids,i=t,n=td.PvpFightManager.getRoleData(this._mercenarySId).getCurCamp(),a=0,r=i.length-1;a<=r;a++){var o=i[a],s=td.PvpFightManager.getRoleData(o.targeterUid),l=s?s.getCurCamp():0,c=td.PveEnum.CAMP_RESISTANT[n]==l,u=new td.PvpFightEffect;u.init(o,c,n,this._mercenarySId,this._damageType),this._effects[this._effects.length]=u;var d=u.getTargetSid(),h=u.getEffectId(),p=u.isSharingDamage();u.isBuffShow();ArrayUtils.contains(e,d)||p||d===this._mercenarySId&&(d!==this._mercenarySId||-1===h||-2===h||-3===h)||(e[e.length]=d)}},getRoundIndex:function(){return this._roundIndex},getReportIndex:function(){return this._reportIndex},getMercenarySId:function(){return this._mercenarySId},getTargetSIds:function(){return this._targetSids},getAllFightSIds:function(){return this._targetSids.concat([this._mercenarySId])},getMyCampTargetSids:function(){for(var t=td.PvpFightManager.getCampByMercenarySid(this._mercenarySId),e=[],i=0,n=this._targetSids.length;i<n;i++){td.PvpFightManager.getCampByMercenarySid(this._targetSids[i])===t&&(e[e.length]=this._targetSids[i])}return e},getEnemyTargetSids:function(){for(var t=td.PvpFightManager.getCampByMercenarySid(this._mercenarySId),e=[],i=0,n=this._targetSids.length;i<n;i++){td.PvpFightManager.getCampByMercenarySid(this._targetSids[i])!==t&&(e[e.length]=this._targetSids[i])}return e},getSkillId:function(){return this._skillId},getDamageType:function(){return this._damageType},isGenAttack:function(){if(!this._isGenAtk){var t;if(!(t=this._fightType===td.FightType.StoryHandUp?td.OnhookFightController.getRoleDataBySId(this._mercenarySId):td.PvpFightController.getInstance().getRoleDataBySId(this._mercenarySId)))return!0;if(t.getBaseModel().getModelShowType()===td.SpriteType.PET)return!0;this._isGenAtk=this._skillId===t.getBaseModel().getGenAtk()}return!!this._isGenAtk},getSkillData:function(){var t,e=td.GetTableClass(td.TableEnum.Skill).getSkillById(this._skillId);return e&&(t=new td.SkillModel).init(e),t},getFightShowData:function(){if(!this._fightShowData){var t;t=this._fightType===td.FightType.StoryHandUp?td.OnhookFightController.getRoleDataBySId(this._mercenarySId):td.PvpFightController.getInstance().getRoleDataBySId(this._mercenarySId);var e=td.GetTableClass(td.TableEnum.PvpFightShow).getShowDataByType(t.getBaseModel().getRoleType(),t.getBaseModel().getModelShowType()),i=new td.PvpFightShowModel;i.init(e[this._skillId]),this._fightShowData=i}return this._fightShowData},getHasSkillFightShow:function(){var t;t=this._fightType===td.FightType.StoryHandUp?td.OnhookFightController.getRoleDataBySId(this._mercenarySId):td.PvpFightController.getInstance().getRoleDataBySId(this._mercenarySId);var e=td.GetTableClass(td.TableEnum.PvpFightShow).getShowDataByType(t.getBaseModel().getRoleType(),t.getBaseModel().getModelShowType());return!(!e[this._skillId]||1===e[this._skillId].showByEnemy&&0===this.getEnemyTargetSids().length)},getSkillEffects:function(){return this._effects}}),cc._RF.pop()},{Model:"Model"}],PvpFightResultView:[function(t,e,i){"use strict";cc._RF.push(e,"19552JB/htJcJn3aSaREV/U","PvpFightResultView");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../../TS/Nation/Manager/NationCityWarManager")),a=t("../../../Nation/Enum/NationEnum");var r=t("PvpFightSuccessView"),o=t("PvpFightFailView"),s=cc.Class({extends:cc.Component,properties:{succView:cc.Node,failView:cc.Node,imgMask:cc.Node},start:function(){},onEnable:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SET_REFRESH_MESSAGE_STOP_STATE,!1),td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_SHOW_TOP_MSG),this.imgMask.setContentSize(td.UIAdaptiveUtil.getWinSize())},setData:function(t){var e=t.getFightResult(),i=t.getFightType();if(td.EventUtil.dispatchEvent(td.EventNameEnum.STOP_MUSIC),i===td.FightType.WorldBoss||i===td.FightType.WHOLE_BOSS||i===td.FightType.Nation_Copy||i===td.FightType.Siege&&n.default.getInstance().getNationWarState()===a.SiegeState.BATTLE||i===td.FightType.Trail||i===td.FightType.EVIL_GOD||i===td.FightType.NationBoss||i===td.FightType.Nation_War||i===td.FightType.Trail||i===td.FightType.HOLY_BEAST||i===td.FightType.BABEL||i===td.FightType.TANGLED_HELL)this.failView.active=!1,this.succView.active=!0,this.succView.getComponent(r).setData(t),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.Win);else if(e===td.TBSFightResultEnum.SUCCESS){this.failView.active=!1,this.succView.active=!0,this.succView.getComponent(r).setData(t),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.Win)}else if(e===td.TBSFightResultEnum.FAILURE){this.succView.active=!1,this.failView.active=!0,this.failView.getComponent(o).setData(t),td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.Lose)}if(this.failView.active){var s=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MultipleFirstRecharge);s&&s.setShowView(!1)}}});e.exports=s,cc._RF.pop()},{"../../../../TS/Nation/Manager/NationCityWarManager":"NationCityWarManager","../../../Nation/Enum/NationEnum":"NationEnum",PvpFightFailView:"PvpFightFailView",PvpFightSuccessView:"PvpFightSuccessView"}],PvpFightResult:[function(t,e,i){"use strict";cc._RF.push(e,"68bc6AAsllMporx/FRZknD6","PvpFightResult");(function(t){t&&t.__esModule})(t("../../../DestroyTemple/Manager/DestroyTempleManager"));td.PvpFightResult=cc.Class({properties:{_fightResult:null,_fightType:null,_damages:null,_reward:null,_chooseArray:null,_chooseReward:null,_stars:null,_mazeScore:null},init:function(t){this._fightType=parseInt(t.type),this._parseReward(t.reward),this._parseStats(t.stats,t.members),this._parseChooseReward(t.chooses,t.chooseResult);var e=t.parameterMap;e&&e[67]&&(this._mazeScore=e[67])},_parseReward:function(t){this._reward=td.RewardManager.parseRewardResult(t,!0)},_parseChooseReward:function(t,e){this._chooseArray=t,this._chooseReward=e},_parseStats:function(t,e){this._fightResult=t.winCamp==td.TBSFightResultEnum.SUCCESS?td.TBSFightResultEnum.SUCCESS:td.TBSFightResultEnum.FAILURE;var i=t.spriteDamages,n=t.campDamages;this._damages={};for(var a=0,r=e.length-1;a<=r;a++){var o=n[e[a].camp]||0;this._damages[e[a].camp]={};for(var s=this._damages[e[a].camp],l=e[a],c=0,u=l.sprites.length-1;c<=u;c++){var d=l.sprites[c].attributes[td.SpriteKey.Sid],h=(i[d]/o*100).toFixed(2);(isNaN(h)||void 0===h)&&(h=0),s[c]={sid:d,damagePer:h,damage:i[d]}}s.myLen();s.myLen()>1&&td.ArrayUtil.sort(s,function(t,e){return t.damage-e.damage}),s.TotalDamages=o}this._damages[td.BattleCamp.LEFT]||(this._damages[td.BattleCamp.LEFT]={},this._damages[td.BattleCamp.LEFT].TotalDamages=0),this._damages[td.BattleCamp.RIGHT]||(this._damages[td.BattleCamp.RIGHT]={},this._damages[td.BattleCamp.RIGHT].TotalDamages=0),this._stars=t.star||0},getRewardList:function(){return this._reward},getFightResult:function(){return this._fightResult},getFightType:function(){return this._fightType},getDamages:function(){return this._damages},getChooseArray:function(){return this._chooseArray},getChooseReward:function(){return this._chooseReward},getStars:function(){return this._stars},getMazeScore:function(){return this._mazeScore}}),cc._RF.pop()},{"../../../DestroyTemple/Manager/DestroyTempleManager":"DestroyTempleManager"}],PvpFightRoleLayer:[function(t,e,i){"use strict";cc._RF.push(e,"52caeJe7wpEjo28po9p/Qrq","PvpFightRoleLayer");var n=t("PvpFightMercenary"),a=cc.Class({extends:cc.Component,properties:{_leftRole:null,_rightRole:null,_allRole:null,_heroPos:null,_mercenaryZorder:null},init:function(t,e){this._mercenaryZorder=[2,4,6,1,3,5,7,8,9,10];var i=td.UIAdaptiveUtil.getMinScale();this.node.setScale(i),this._heroPos=td.GetTableClass(td.TableEnum.Config).getConfig("TBSFightHeroPos"),this._setRoleInfo(t,e)},_setRoleInfo:function(t,e){for(var i in this._leftRole=[],this._rightRole=[],this._allRole=[],e)i==td.BattleCamp.LEFT?this._showSelfMercenary(t,e[i]):i==td.BattleCamp.RIGHT&&this._showEnemyMercenary(t,e[i])},_showSelfMercenary:function(t,e){for(var i,a=(i=t===td.FightType.StoryHandUp?td.OnhookFightController.getFightData():td.PvpFightController.getInstance().getFightData()).reports[1]?i.reports[1].getShowSId():null,r=e.getFormation().getMercenarys(),o=this._heroPos[0],s=0;s<o.length;s++){var l=r[s];if(l&&!(l.getHp()<=0)){var c=gdk.rm.getResByUrl("prefab/Pvp/FightMercenary",cc.Prefab),u=cc.instantiate(c);this.node.addChild(u,this._mercenaryZorder[s]),u.position=cc.v2(o[s][0],o[s][1]);var d=u.getComponent(n);d.init({roleData:l,isLeft:!0}),d.idle(),a&&!ArrayUtils.contains(a,l.getBaseModel().getSId())&&(u.active=!1),this._leftRole[this._leftRole.length]=u,this._allRole[this._allRole.length]=u}}},_showEnemyMercenary:function(t,e){for(var i,a=(i=t===td.FightType.StoryHandUp?td.OnhookFightController.getFightData():td.PvpFightController.getInstance().getFightData()).reports[1]?i.reports[1].getShowSId():null,r=e.getFormation().getMercenarys(),o=this._heroPos[1],s=0;s<o.length;s++){var l=r[s];if(l&&!(l.getHp()<=0)){var c=gdk.rm.getResByUrl("prefab/Pvp/FightMercenary",cc.Prefab),u=cc.instantiate(c);this.node.addChild(u,this._mercenaryZorder[s]),u.position=cc.v2(o[s][0],o[s][1]);var d=u.getComponent(n);d.init({roleData:l,isLeft:!1}),d.idle(),a&&!ArrayUtils.contains(a,l.getBaseModel().getSId())&&(u.active=!1),this._rightRole[this._rightRole.length]=u,this._allRole[this._allRole.length]=u}}},_addShowMercenary:function(t){var e=this,i=parseInt(t.camp),a=t.roleData,r=a.getPos(),o=gdk.rm.getResByUrl("prefab/Pvp/FightMercenary",cc.Prefab),s=cc.instantiate(o);this.node.addChild(s,this._mercenaryZorder[r]);var l=s.getComponent(n);if(l.init({roleData:a,isLeft:!1}),l.idle(),s.active=!1,i===td.BattleCamp.LEFT){var c=this._heroPos[0];s.position=cc.v2(c[r][0],c[r][1]),this._leftRole[this._leftRole.length]=s}else{var u=this._heroPos[1];s.position=cc.v2(u[r][0],u[r][1]),this._rightRole[this._rightRole.length]=s}for(var d=this.node.children,h=0,p=d.length-1;h<=p;h++){var _=d[h];if("FightMercenary"===_.name){var g=_.getComponent(n).getCfg();if(g.getCamp()===i&&g.getPos()===r){_.removeFromParent(!0);break}}}this._allRole[this._allRole.length]=s,this.scheduleOnce(function(){e._playShowAni(s)},0)},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.PAUSEROLELAYER]=this._pauseThis,t[e.RESUMEROLELAYER]=this._resumeThis,t[e.PREPARE_ROUND_PLAY]=this._setNodeShow,t[e.BATTLE_MASK_STATE]=this._refreshMaskNode,t[e.PVP_SPECIAL_HERO_SHOW]=this._specialShowHero,t[e.ADD_PVP_FIGHT_MERCENARY]=this._addShowMercenary,t[e.WORLD_BOSS_NEW_MONSTER_SHOW]=this._newMonsterShow,td.EventUtil.registerEvents(t,this)},_refreshMaskNode:function(t){var e=this.node.getChildByName("maskLayer");if(e){var i=t.ids||[],a=t.state||!1;e.active=a,e.zIndex=100;var r=this.node.getChildren(),o=r.length,s=td.PvpFightPlayController.getReportData().getMercenarySId();s=i.concat([s]);for(var l=0;l<o;l++){var c=r[l],u=c.getComponent(n);if(u){var d=u.getCfg();if(d){var h=c.zIndex;h>100&&(h-=100),a&&s.contains(d.getSId())&&(h+=100),c.zIndex=h}}}}},_removeEventListener:function(){td.EventUtil.unregisterAllEvents(this)},start:function(){this._addEventListener()},onDisable:function(){this._removeEventListener()},onDestroy:function(){cc.log("PvpFightRoleLayer")},_setNodeShow:function(t){if(t&&1!==t.getRoundId())for(var e=t.getShowSId(),i=this.node.children,a=0,r=i.length-1;a<=r;a++){var o=i[a];if("FightMercenary"===o.name){var s=o.getComponent(n),l=s?s.getCfg().getSId():null;if(e){var c=ArrayUtils.contains(e,l);o.active=c}}}},_specialShowHero:function(t){for(var e=this.node.children,i=e.length,a=0,r=t.length;a<r;a++){for(var o=t[a],s=!1,l=0,c=i-1;l<=c;l++){var u=e[l];if("FightMercenary"===u.name){var d=u.getComponent(n);if(o===(d?d.getCfg().getSId():null)){s=!0,this._playShowAni(u);break}}}s||td.EventUtil.dispatchEvent(td.EventNameEnum.ADD_PVP_SPECIAL_HERO,o)}},_newMonsterShow:function(t){var e=this,i=t.attributes,a=i[td.SpriteKey.Position]-1,r=parseInt(i[td.SpriteKey.SpriteType])===td.SpriteType.HERO?"MercenaryFightModel":"MonsterFightModel",o=new td[r];o.init(t);var s=gdk.rm.getResByUrl("prefab/Pvp/FightMercenary",cc.Prefab),l=cc.instantiate(s);this.node.addChild(l,this._mercenaryZorder[a]);var c=l.getComponent(n);c.init({roleData:o,isLeft:!1}),c.idle(),l.active=!1;var u=this._heroPos[1];l.position=cc.v2(u[a][0],u[a][1]),this._rightRole[this._rightRole.length]=l;for(var d=this.node.children,h=0,p=d.length-1;h<=p;h++){var _=d[h];if("FightMercenary"===_.name){var g=_.getComponent(n).getCfg();if(2==g.getCamp()&&g.getPos()===a){_.removeFromParent(!0);var f=td.PvpFightController.getInstance().getFightMembers()[2].getFormation();f.refreshMercenaryData(o),td.EventUtil.dispatchEvent(td.EventNameEnum.PVP_FIGHT_FORMATION_REFRESH,f);break}}}this._allRole[this._allRole.length]=l,this.scheduleOnce(function(){e._playShowAni(l)},0)},_playShowAni:function(t){var e=gdk.rm.getResByUrl("fightRes/pve/otherAnimation/ZhaoHuanYingXiong/Zhaohuanyingxiong",cc.Prefab);if(e){var i=cc.instantiate(e);i.getComponent("BuildTowerAnimateComponent").setFrameEventCallBack(this._showHero.bind(this,t)),i.parent=this.node,i.position=t.position,i.active=!0,i.getComponent(cc.Animation).play("Zhaohuanyingxiong")}},_showHero:function(t){t.active=!0;var e=t.getComponent(n);e&&e.idle(),gdk.Timer.callLater(this,function(){td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_FIGHT)})},getRightNodes:function(){return this._rightRole},getLeftNodes:function(){return this._leftRole},_pauseThis:function(){this.node.removeAllChildren()},_resumeThis:function(){this._pauseThis();var t=td.PvpFightManager.getFightMembers();this._setRoleInfo(t)},_refreshAllRole:function(){var t=this._allRole;if(t)for(var e=0,i=t.length-1;e<=i;e++){var a=t[e];if(a)a.getComponent(n).refresh()}}});e.exports=a,cc._RF.pop()},{PvpFightMercenary:"PvpFightMercenary"}],PvpFightRound:[function(t,e,i){"use strict";cc._RF.push(e,"a6455c0H2JJCZk/Cbr7L1t2","PvpFightRound");var n=t("Model");td.PvpFightRound=cc.Class({extends:n,properties:{_roundId:null,_showSIds:null,_fightReports:null},init:function(t,e,i,n){this._roundId=parseInt(e),this._fightReports=[],this._resetFightReport(t,i),this._initShowFighterSId(n)},_resetFightReport:function(t,e){this._fightReports.length=0;for(var i=e,n=0,a=i.length-1;n<=a;n++){var r=i[n],o=new td.PvpFightReport;o.init(t,r,n,this._roundId),this._fightReports[this._fightReports.length]=o}},_initShowFighterSId:function(t){this._showSIds=t},getRoundId:function(){return this._roundId},getFightReports:function(){return this._fightReports},getShowSId:function(){return this._showSIds}}),cc._RF.pop()},{Model:"Model"}],PvpFightShowAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"7ce069tsh1C4bdnLqxNOgR/","PvpFightShowAnimation");var n=t("AnimationComponent"),a=cc.Class({extends:n,properties:{_animClipName:null},init:function(t){this.resetAnimationClip();var e=gdk.rm.getResByUrl(t,cc.AnimationClip);this.addAnimationClip(e)},start:function(){this._addEventListener()},_addEventListener:function(){var t={};t[td.EventNameEnum.FIGHT_SPEED_CHANGE]=this._setSpeed,td.EventUtil.registerEvents(t,this)},onDisable:function(){td.EventUtil.unregisterAllEvents(this)},_setSpeed:function(t){var e=t;this.setAnimationSpeed(e)},playAnimation:function(t,e){var i=t||this._animClipName;this.node&&(this.node.stopAllActions(),this.playAnimationClip(i),this.setAnimationSpeed(td.PvpFightController.getInstance().getFightSpeed()))},setFrameListener:function(t,e,i){i&&this.setFinishAnimationCallBack(i)},startAttack:function(t){cc.log("startAttack")},setLastFrameListener:function(){this.setFrameListener(this._frames,null,function(){this.node.removeFromParent()}.bind(this))},setFlippedX:function(t){var e=Math.abs(this.node.scaleX);this.node.scaleX=t?e:-e},setRotation:function(t){var e=Math.atan2(t.y,t.x),i=180/Math.PI*e;this.node&&this.node.setRotation(-i)},setLastFrameCb:function(t){this.setFrameListener(this._frames,null,t&&t())}});e.exports=a,cc._RF.pop()},{AnimationComponent:void 0}],PvpFightShowAtkAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"2b6dfAdl8VNQK0SyT8BSfu5","PvpFightShowAtkAnimation");var n=t("PvpFightShowAnimation"),a=cc.Class({extends:n,properties:{_roleType:null,_skillId:null,_frames:null,_finishDelay:null,_playTime:null,_animEvent:null,_animEventIndex:0,_isAtkAnimation:!1,_executeAnimCallBack:!1,_sound:"",_includeShowBuffCall:!1},start:function(){this._super()},startAttack:function(){this._executeAnimCallBack&&this._frameListener()},playbullet:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_HERO_TRAJECTORY_ACTION)},playSound:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,this._sound)},init:function(t){this._roleType=t.roleType,this._skillId=t.skillId,this._animClipName=t.mercenaryAtkAnimation,this._finishDelay=t.releaseFinishDelay||0,this._sound=t.releaseSound;var e=td.FightShowType;t.atkShowType===e.atkAnimation?this._frames=t.underAtkFrame:this._frames=[];var i=this.getAnimationByName(this._animClipName);this._animEvent=i?i.events:[];for(var n=[],a=0,r=this._animEvent.length;a<r;a++){var o=this._animEvent[a];"playBuff"===o.func?this._includeShowBuffCall=!0:"startAttack"===o.func&&(n[n.length]=o)}this._animEvent=n},_frameListener:function(){var t=this._animEvent,e=this._animEvent[this._animEventIndex];this._animEventIndex=this._animEventIndex+1;var i=t.length-1,n=0,a=0,r=0;if(0===i)a=n=t[0].frame;else for(n=t[i].frame-t[0].frame+(t[i].frame-t[i-1].frame);r<=i;r++)if(t[r]===e){a=r!==i?(t[r+1].frame-t[r].frame)/n:(t[r].frame-t[r-1].frame)/n;break}td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SKILL_ANIMATION_CALLBACK,{totalFrame:n,framePercent:a,frameIndex:r,frame:e,isFirstFrame:e===t[0],isEndFrame:e===t[i],roleType:this._roleType,skillId:this._skillId})},setFrameListener:function(t,e){this._executeAnimCallBack=e||!1,e?this._super([],null,function(){td.EventUtil.dispatchEvent(td.EventNameEnum.FINISH_HERO_ATK_SHOW),t&&t()}.bind(this)):this._super([],null,function(){t&&t()}.bind(this))}});e.exports=a,cc._RF.pop()},{PvpFightShowAnimation:"PvpFightShowAnimation"}],PvpFightShowModel:[function(t,e,i){"use strict";cc._RF.push(e,"51398PV9tRJHJrqcprgPTqy","PvpFightShowModel");var n=t("Model");td.PvpFightShowModel=cc.Class({extends:n,properties:{_skillId:null,_type:null,_atkShowType:null,_skillAnimation:null,_skillAnimationShowType:null,_atkAnimation:null,_trajectorySp:null,_skillName:null,_atkTimes:null,_atkPrecent:null,_underAtkAnimation:null,_underAtkAnimationRes:null,_releaseFinishDelay:null,_releaseSound:null,_underAtkSound:null},init:function(t){if(t){this._super("TBSFightShowModel"),this._skillId=t.skillId,this._type=t.type,this._atkShowType=t.atkShowType,this._skillAnimation=t.skillAnimation,this._skillAnimationShowType=t.skillAnimationShowType,this._atkAnimation=t.mercenaryAtkAnimation,this._trajectorySp=t.trajectorySp;var e=t.atkPrecentShow;e?(this._atkTimes=e[0]||1,this._atkPrecent=e[1]):this._atkTimes=1,this._skillName=t.skillName,this._underAtkAnimation=t.underAtkSkillAnimation,this._underAtkAnimationRes=t.underAtkSkillAnimationRes,this._releaseFinishDelay=t.releaseFinishDelay||0,this._releaseSound=t.releaseSound,this._underAtkSound=t.underAtkSound}},getAttackPrecent:function(t){if(this._atkPrecent&&0!==this._atkPrecent.length){var e=this._atkPrecent[t];return e>0?e/1e4:0}return 1/this._atkTimes},getSkillId:function(){return this._skillId},getType:function(){return this._type},getAtkShowType:function(){return this._atkShowType},getSkillAnimation:function(){return this._skillAnimation},getSkillAnimationShowType:function(){return this._skillAnimationShowType},getAtkAnimation:function(){return this._atkAnimation},getTrajectorySp:function(){return this._trajectorySp},getUnderAtkFrames:function(){return this._underAtkFrame},getAtkTimes:function(){return this._atkTimes},getSkillNameJson:function(){return"res/animation/skill/skill_start.json"},getSkillName:function(){return this._skillName},getUnderAtkAnimation:function(){return this._underAtkAnimation},getUnderAtkAnimationRes:function(){return this._underAtkAnimationRes},getReleaseSound:function(){return this._releaseSound},getUnderAtkSound:function(){return this._underAtkSound}}),cc._RF.pop()},{Model:"Model"}],PvpFightSkillAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"7229fKBzSxN3ZMlTrnCpjmP","PvpFightSkillAnimation");var n=t("PvpFightShowAnimation"),a=cc.Class({extends:n,properties:{_roleType:null,_skillId:null,_finishDelay:null,_animEvent:null,_animEventIndex:0,_executeCallBack:!0,_includeShowBuffCall:!1},init:function(t){this._animClipName=t.skillAnimation,this._roleType=t.roleType,this._skillId=t.skillId,this._finishDelay=t.releaseFinishDelay||0;var e=td.FightShowType;t.atkShowType,e.atkAnimation;var i=this.getAnimationByName(this._animClipName);this._animEvent=i?i.events:[];for(var n=[],a=0,r=this._animEvent.length;a<r;a++){var o=this._animEvent[a];"playBuff"===o.func?this._includeShowBuffCall=!0:"startAttack"===o.func&&(n[n.length]=o)}this._animEvent=n},setExecuteCallBack:function(t){this._executeCallBack=t},setFrameListener:function(t,e,i){i||(i=this._lastFrameListener.bind(this)),this._super(t,e,i)},startAttack:function(){cc.log("startAttack"),this._executeCallBack&&this._frameListener()},playBuff:function(){this._executeCallBack&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SKILL_BUFF_CALLBACK)},_frameListener:function(){var t=this._animEvent,e=this._animEvent[this._animEventIndex];this._animEventIndex=this._animEventIndex+1;var i=t.length-1,n=0,a=0,r=0;if(0===i)a=n=t[0].frame;else for(n=t[i].frame-t[0].frame+(t[i].frame-t[i-1].frame);r<=i;r++)if(t[r]===e){a=r!==i?(t[r+1].frame-t[r].frame)/n:(t[r].frame-t[r-1].frame)/n;break}td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SKILL_ANIMATION_CALLBACK,{totalFrame:n,framePercent:a,frameIndex:r,frame:e,isFirstFrame:e===t[0],isEndFrame:e===t[i],roleType:this._roleType,skillId:this._skillId,includeShowBuffCall:this._includeShowBuffCall})},_lastFrameListener:function(){cc.log("finishHeroAtk:SkillAnimationCallback"),td.EventUtil.dispatchEvent(td.EventNameEnum.FINISH_HERO_ATK_SHOW),this.node.removeFromParent()}});e.exports=a,cc._RF.pop()},{PvpFightShowAnimation:"PvpFightShowAnimation"}],PvpFightSkillNameAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"680b0jRgklLKKAixNQ9mzdl","PvpFightSkillNameAnimation");var n=t("PvpFightShowAnimation");cc.Class({extends:n,init:function(t){var e=t.getSkillNameJson(),i=t.getSkillName();this._super(e);var n=gdk.rm.getResByUrl(i),a=this.node.getChildByName("renwu"),r=(i=(i=i.split("/"))[i.length-1])+"_role",o=n[r];a.getComponent(cc.Sprite).spriteFrame=o;var s=(a=this.node.getChildByName("name")).getComponent(cc.Sprite);o=n[r=i+"_name.png"],s.spriteFrame=o},setFrameListener:function(t){this._super([],null,function(){t&&t(),this.removeFromParent()}.bind(this))}});cc._RF.pop()},{PvpFightShowAnimation:"PvpFightShowAnimation"}],PvpFightSuccessView:[function(t,e,i){"use strict";cc._RF.push(e,"1498a4L4ehH5bzoAGKe40SU","PvpFightSuccessView");var n=C(t("../../../fight/pvp/Model/PvpFsmEventId")),a=C(t("../../../Endless/Manager/EndlessManager")),r=C(t("../../../Treasure/Manager/TreasureManger")),o=C(t("../../utils/FightResultAniComponent")),s=C(t("../../../../Common/Component/GridLayoutComponent")),l=C(t("../../../Nation/Manager/NationBossManager")),c=C(t("../../../Nation/Manager/ScuffleYamaManager")),u=C(t("../../../Nation/Manager/NationDuelManager")),d=C(t("../../../Pulse/Manager/PulseManager")),h=C(t("../../../DestroyTemple/Manager/DestroyTempleManager")),p=C(t("../../../Nation/Manager/NationCityWarManager")),_=C(t("../../../CrossArena/Manager/CrossArenaManager")),g=t("../../../Nation/Enum/NationEnum"),f=t("../../../Endless/Model/EndlessEnum"),v=C(t("../../../StarUpRoad/Manager/StarUpRoadManager")),m=C(t("../../../Babel/Manager/BabelManager")),y=t("../../../Babel/Enum/BabelEnum"),E=C(t("../../../Legend/Manager/LegendManager")),T=C(t("../../../Maze/Manager/MazeManager"));function C(t){return t&&t.__esModule?t:{default:t}}var R=t("HurtStaticsView");cc.Class({extends:cc.Component,properties:{rewardNode:cc.Node,hurtNode:cc.Node,rankNode:cc.Node,crossArenaNode:cc.Node,stageNode:cc.Node,tipNode:cc.Node,treasurePanel:cc.Node,scoreNode:cc.Node,pulseNode:cc.Node,destroyTempleNode:cc.Node,nodeLegend:cc.Node,btnLayer:cc.Node,btnContinue:cc.Node,btnNextGate:cc.Node,starInfoNode:cc.Node,scuffleYamaNode:cc.Node,_posY:200,_fightResult:null,_treasureData:null},start:function(){},onEnable:function(){td.UIAdaptiveUtil.AdaptivePanelBaseResetRootSize(this.node),this._addEventListener()},onDisable:function(){this._fightResult=null,this._treasureData=null,td.EventUtil.unregisterAllEvents(this)},_addEventListener:function(){td.EventNameEnum;td.EventUtil.registerEvents({},this)},setData:function(t){this._fightResult=t;for(var e=this.node.children,i=0,n=e.length;i<n;i++)e[i].active=!1;this._posY=200,this._playAnimation()},_playAnimation:function(){var t=this.node.getChildByName("succAni");if(t){this._playRotateAni(t);var e=t.getComponent(cc.Animation),i=e.getClips()[this._fightResult.getStars()].name;e.play(i);var n=t.addComponent(o.default);n.setShowRewardResultFunc(this._showResultInfo.bind(this)),n.setSoundCallBack(function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.STAR_GAIN)})}else gdk.rm.loadRes(null,td.resDef.ZhanDouShenLi,cc.Prefab,this._addSuccAni.bind(this,t))},_addSuccAni:function(t){var e=gdk.rm.getResByUrl(td.resDef.ZhanDouShenLi,cc.Prefab);t=cc.instantiate(e),this.node.addChild(t,1),t.name="succAni",this._playRotateAni(t);var i=t.getComponent(cc.Animation),n=i.getClips()[this._fightResult.getStars()].name;i.play(n);var a=t.addComponent(o.default);a.setShowRewardResultFunc(this._showResultInfo.bind(this)),a.setSoundCallBack(function(){td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,td.SoundEnum.STAR_GAIN)})},_playRotateAni:function(t){var e=t.getChildByName("zhongxindian");e&&(e=e.getChildByName("guang"))&&e.runAction(cc.repeatForever(cc.rotateBy(8,-360)))},_showResultInfo:function(){var t=this._fightResult.getFightType(),e=!1,i=td.GetConfig("NEXT_GATE_LEVEL_LIMIT"),n=td.Account.getUserData().getLevel();if(t===td.FightType.Arena)this._setRankNode(),this._setRewardNode();else if(t===td.FightType.CROSS_ARENA)this._setCrossArenaRankNode(),this._setRewardNode();else if(t===td.FightType.Siege||t===td.FightType.WorldBoss||t===td.FightType.WHOLE_BOSS||t===td.FightType.HOLY_BEAST)this._setRewardNode(),this._setHurtNode();else if(t===td.FightType.TREASURE_SNATCH)this._setRewardNode(),this._setTreasureNode();else if(t===td.FightType.NationBoss)this._setScoreNode(),this._setRewardNode(),this._setHurtNode();else if(t===td.FightType.PURPLE_FAIRYLAND)this._setPulseNode();else if(t===td.FightType.DESTROY_TEMPLE)e=!0,this._setDestroyTempleNode();else if(t===td.FightType.ENDLESS)this._setRewardNode(),a.default.getInstance().hasNextGate()&&!a.default.getInstance().getSelect()&&n>i&&(this.btnContinue.x=-160,this.btnNextGate.active=!0);else if(t===td.FightType.STAR_UP_ROAD)this._setStarInfo(),this._setRewardNode(),v.default.getInstance().hasNextGate()&&(this.btnContinue.x=-160,this.btnNextGate.active=!0);else if(t===td.FightType.BABEL){this._setStageNode(),this._setRewardNode(),td.PvpFightManager.isBabelFightFail()&&m.default.getInstance().checkClearBattleInfo()}else if(t===td.FightType.NATION_DUEL)this._setTipNode();else if(t===td.FightType.LEGEND)this._setLegendNode();else if(t===td.FightType.MAZE_PVP){T.default.getInstance().isReplayFight()||(this._setMazeNode(),this._setRewardNode())}else t===td.FightType.TANGLED_HELL?this._setScuffleYamaNode():t===td.FightType.EVIL_GOD?(this._setHurtNode(),this._setRewardNode()):this._setRewardNode();t===td.FightType.WHOLE_ATTEND&&td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_SPRITE_ACTIVE_TIP),e||(this.btnLayer.active=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_CUSTOM_COND_CHANGE,td.GuideCustomCond.FightEnd))},_setStarInfo:function(){this.starInfoNode.active=!0,this.starInfoNode.zIndex=98;var t=td.PvpFightManager.getMyDeathNum(),e=this.starInfoNode.getChildByName("star2"),i=this.starInfoNode.getChildByName("label2"),n=this.starInfoNode.getChildByName("star3"),a=this.starInfoNode.getChildByName("label3");t<=2?(i.color=cc.color(72,235,0),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.JS_jiesuan,"JS_xing",e)):(i.color=cc.color(153,153,153),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.JS_jiesuan,"JS_xing02",e)),0===t?(a.color=cc.color(72,235,0),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.JS_jiesuan,"JS_xing",n)):(a.color=cc.color(153,153,153),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.JS_jiesuan,"JS_xing02",n)),this.starInfoNode.y=this._posY,this._posY-=this.starInfoNode.height},_setRewardNode:function(){var t=this._fightResult.getRewardList();t&&t.length>0?(this.rewardNode.active=!0,this.rewardNode.zIndex=99,this._setItemRewards(t),this.rewardNode.y=this._posY,this._posY-=this.rewardNode.height):this.rewardNode.active=!1},_setStageNode:function(){this.stageNode.active=!0;var t=m.default.getInstance().getMaxStageNumByFloorAndDifficulty()||20,e=m.default.getInstance().getBabelBattleInfo(y.BabelBattleInfoEnum.STAGE)||1;td.PvpFightManager.isBabelFightFail()&&(e-=1),e>t&&(e=t);var i=this.stageNode.getChildByName("lab_stage");i.getComponent(cc.Label).string=e+"/"+t,i.getComponent(cc.Label)._forceUpdateRenderData()},_setTipNode:function(){this.tipNode.active=!0;var t=u.default.getInstance().getChangeStar(),e=u.default.getInstance().getChangePoint(),i=this.tipNode.getChildByName("lab_star"),n=this.tipNode.getChildByName("lab_point");i.getComponent(cc.Label).string=t,n.getComponent(cc.Label).string=e},_setItemRewards:function(t){var e=t?t.length:0;if(0!==e){var i=null,n=this.rewardNode.getChildByName("rewardPanel");this._treasureData=null;for(var a=[],o=this._fightResult.getFightType(),l=0;l<e;l++){var c=t[l];if(o==td.FightType.TREASURE_SNATCH&&c.type==td.GoodsType.Type_Item&&c.id==r.default.getInstance().getTreasureRobFragmentId())if(c.count>1){var u=cc.instantiate(c);u.count=1,this._treasureData=u;var d=cc.instantiate(c);d.count=c.count-1,a.push(d)}else this._treasureData=c;else a.push(c)}e=a.length;for(var h=0;h<e;h++){i=a[h];var p=td.GlobalFunction.getItemIcon(27,i.type,i.id,i.count,!0);if(p.setScale(.9),i.isExtra){var _=this._createExtraImg();p.addChild(_,10)}n.addChild(p),p.getComponent("CommonIconWidget").disableHeadTouch()}n.getComponent(s.default).updateLayout(),this.rewardNode.height=n.height+Math.abs(n.y)+30}},_createExtraImg:function(){var t=td.resdef.Meishuzi.MSZ_ewai;return td.GlobalFunction.createSprite(t),extraImg},clickThis:function(t){this.returnToMainScene()},_setRankNode:function(){this.rankNode.active=!0,this.rankNode.zIndex=98;var t=this.rankNode.getChildByName("labUpRank"),e=this.rankNode.getChildByName("imgArrow"),i=this.rankNode.getChildByName("imgNotChange"),n=td.ArenaManager.getBeforBattleRank()-td.ArenaManager.getAfterBattleRank();0!==n?(t.active=!0,e.active=!0,i.active=!1,t.getComponent(cc.Label).string=n,t.getComponent(cc.Label)._forceUpdateRenderData(),e.x=t.width+t.x+50):(t.active=!1,e.active=!1,i.active=!0),this.rankNode.y=this._posY,this._posY-=this.rankNode.height},_setCrossArenaRankNode:function(){this.crossArenaNode.active=!0,this.crossArenaNode.zIndex=98;var t=this.crossArenaNode.getChildByName("laboldScore"),e=this.crossArenaNode.getChildByName("laboldRank"),i=this.crossArenaNode.getChildByName("imgNotChange"),n=this.crossArenaNode.getChildByName("labScore"),a=this.crossArenaNode.getChildByName("labRank"),r=this.crossArenaNode.getChildByName("imgNotChange1"),o=_.default.getInstance().getLastRank(),s=_.default.getInstance().getMyRank(),l=_.default.getInstance().getMyScore(),c=_.default.getInstance().getLastScore();t.getComponent(cc.Label).string=c,e.getComponent(cc.Label).string=o,n.getComponent(cc.Label).string=l,a.getComponent(cc.Label).string=s,i.active=!1,r.active=!1,this.crossArenaNode.y=this._posY,this._posY-=this.crossArenaNode.height},_setHurtNode:function(){this.hurtNode.active=!0,this.hurtNode.zIndex=98;var t=this.hurtNode.getChildByName("imgTitle"),e=this.hurtNode.getChildByName("labHurt"),i=this._fightResult.getDamages(),n="JS_wz_bcsh";if(this._fightResult.getFightType()===td.FightType.Siege){var a=p.default.getInstance().getNationWarData();if(a)a.getState()===g.SiegeState.NATION_BATTLE&&(n="JS_wz_pccf")}td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.JS_jiesuan,n,t);var r="number"==typeof i?i:i[td.BattleCamp.LEFT].TotalDamages;e.getComponent(cc.Label).string=r,this.hurtNode.y=this._posY,this._posY-=this.hurtNode.height},_setScoreNode:function(){this.scoreNode.active=!0,this.scoreNode.zIndex=98;var t=0;this._fightResult.getFightType()===td.FightType.NationBoss&&(t=l.default.getInstance().getCurChallengeScore(this._fightResult.getDamages()[td.BattleCamp.LEFT].TotalDamages)),this.scoreNode.getChildByName("labScore").getComponent(cc.Label).string=t,this.scoreNode.y=this._posY,this._posY-=this.scoreNode.height},_setScuffleYamaNode:function(){this.scuffleYamaNode.active=!0,this.scuffleYamaNode.zIndex=99;var t=this.scuffleYamaNode.getChildByName("labKillEnemyNum"),e=this.scuffleYamaNode.getChildByName("scoreView").getChildByName("labScore"),i=td.PvpFightManager.getKillEnemyNum()||0;t.getComponent(cc.Label).string=cc.js.formatStr(td.Language.strPvpKillTip,i),e.getComponent(cc.Label).string=c.default.getInstance().getCurGetScore()},_setTreasureNode:function(){this.treasurePanel.active=!0,this.treasurePanel.zIndex=98;var t=this.treasurePanel.getChildByName("icon_suc"),e=this.treasurePanel.getChildByName("lab_name"),i=this.treasurePanel.getChildByName("icon_fail");if(this._treasureData){i.active=!1,t.active=!0,e.active=!0;var n=td.GetTableClass(td.TableEnum.Item).getItemById(this._treasureData.id);e.getComponent(cc.Label).string=n.name,td.GlobalFunction.setNameColors(e,n.quality);var a=td.GlobalFunction.getItemIcon(26,this._treasureData.type,this._treasureData.id,this._treasureData.count,!0);a.getComponent("CommonIconWidget").disableHeadTouch(),a.setScale(.9),a.x=0,a.y=-100,this.treasurePanel.addChild(a)}else i.active=!0,t.active=!1,e.active=!1;this.treasurePanel.y=this._posY,this._posY-=this.treasurePanel.height},_setPulseNode:function(){this.pulseNode.active=!0,this.pulseNode.zIndex=98;var t=this.pulseNode.getChildByName("playerName"),e=this.pulseNode.getChildByName("pulseName"),i=this.pulseNode.getChildByName("lab_num"),n=this.pulseNode.getChildByName("Label"),a=this.pulseNode.getChildByName("26_x"),r=this._fightResult.getRewardList(),o=td.PvpFightController.getInstance().getFightMembers()[2].getUserAttr()[td.UserPropertyEnum.NickName];"#"===o[0]&&(o=td.Language[o]);var s=d.default.getInstance().getPulseId(),l=td.GetTableClass(td.TableEnum.PurpleFairylandPulseTable).getDataById(s).type;t.getComponent(cc.RichText).string=cc.js.formatStr("%s",td.Language.PulseFightTips1,o),e.getComponent(cc.RichText).string=cc.js.formatStr("%s",td.Language.PulseFightTips2,td.Language["PulseNameType"+l]);for(var c=0,u=0;u<r.length;u++)if(r[u].type===td.GoodsType.Type_Item&&r[u].id===td.ItemEnum.MINE){c=r[u].count;break}a.active=c>0,n.active=c>0,i.active=c>0,i.getComponent(cc.Label).string=c+"",this.pulseNode.y=this._posY,this._posY-=this.pulseNode.height},_setDestroyTempleNode:function(){this.destroyTempleNode.active=!0,this.destroyTempleNode.zIndex=98;var t=this.destroyTempleNode.getChildByName("giftBox"),e=this.destroyTempleNode.getChildByName("ScrollView"),i=this.destroyTempleNode.getChildByName("labOpenTips"),n=this.destroyTempleNode.getChildByName("rewardTitle"),a=this._fightResult.getRewardList(),r=a.length>0,o=h.default.getInstance().getDiffCourage();if(o>0){var s={};s.type=td.GoodsType.Type_Item,s.id=td.ItemEnum.Courage,s.count=o,a.unshift(s)}for(var l,c=e.getChildByName("view"),u=c.getChildByName("content"),d=a.length,p=0;p<d;p++){var _=a[p],g=td.GlobalFunction.getItemIcon(27,_.type,_.id,_.count,!0);g.setScale(.9),!l&&(l=g.width*g.scale),u.addChild(g),g.getComponent("CommonIconWidget").disableHeadTouch()}var f=Math.min(l*d,680);if(e.width=f,c.width=f,l*d>680&&e.getComponent(cc.ScrollView).scrollToLeft(),r){e.y=-263,i.active=!0,td.GlobalFunction.createSprite("GY_Common_bg/GY_baixiao01",t),t.active=!0;for(var v=u.children,m=0,y=v.length;m<y;m++)v[m].opacity=0;i.runAction(cc.sequence(cc.scaleTo(.5,1.2),cc.scaleTo(.5,1)).repeatForever()),this.destroyTempleNode.getComponent(cc.Button).interactable=!0}else e.y=-50,i.active=!1,t.active=!1,this.btnLayer.active=!0,this.destroyTempleNode.getComponent(cc.Button).interactable=!1;n.y=e.y+25,this.destroyTempleNode.y=this._posY,this._posY-=this.destroyTempleNode.height},_setLegendNode:function(){if(E.default.getInstance().isReplay())this.returnToMainScene();else{this.nodeLegend.active=!0,this.nodeLegend.zIndex=98;var t=this.nodeLegend.getChildByName("labScore").getComponent(cc.Label),e=this.nodeLegend.getChildByName("labAreaRankChange").getComponent(cc.Label),i=this.nodeLegend.getChildByName("labAreaRank").getComponent(cc.Label),n=this.nodeLegend.getChildByName("labAreasRank").getComponent(cc.Label),a=this.nodeLegend.getChildByName("labAllAreasRank").getComponent(cc.Label),r=td.Language.notInRank;t.string=E.default.getInstance().getResultChangeScore();var o=cc.js.formatStr(td.Language.resultRankUp,E.default.getInstance().getChangeServerRank());e.node.active=0!=E.default.getInstance().getChangeServerRank(),e.string=o,i.string=E.default.getInstance().getServerRank()||r,n.string=E.default.getInstance().getZoneRank()||r,a.string=E.default.getInstance().getGlobalRank()||r}},_setMazeNode:function(){this.crossArenaNode.active=!0,this.crossArenaNode.zIndex=98;var t=this.crossArenaNode.getChildByName("laboldScore"),e=this.crossArenaNode.getChildByName("imgArrow1"),i=this.crossArenaNode.getChildByName("GY_wz_paiming02"),n=this.crossArenaNode.getChildByName("laboldRank"),a=this.crossArenaNode.getChildByName("imgNotChange"),r=this.crossArenaNode.getChildByName("labScore"),o=this.crossArenaNode.getChildByName("labRank"),s=this.crossArenaNode.getChildByName("imgNotChange1"),l=T.default.getInstance().getMyLastPvpData(),c=T.default.getInstance().getMyPlayerModel(),u=T.default.getInstance().getConstScore(),d=l.rank,h=c.getRank(),p=this._fightResult.getMazeScore()||c.getScore();t.getComponent(cc.Label).string=p-u,n.getComponent(cc.Label).string=d,r.getComponent(cc.Label).string=p,o.getComponent(cc.Label).string=h,n.active=!1,o.active=!1,e.active=!1,i.active=!1,a.active=!1,s.active=!1,this.crossArenaNode.y=this._posY+50,this._posY-=this.crossArenaNode.height},onDestroyTempleGiftBoxClick:function(){var t=this.destroyTempleNode.getChildByName("giftBox"),e=this.destroyTempleNode.getChildByName("ScrollView").getChildByName("view").getChildByName("content"),i=this.destroyTempleNode.getChildByName("labOpenTips");i.stopAllActions(),i.scale=1,i.active=!1,this.destroyTempleNode.getComponent(cc.Button).interactable=!1,td.GlobalFunction.createSprite("GY_Common_bg/GY_baixiao02",t);for(var n=e.children,a=0,r=n.length;a<r;a++){n[a].runAction(cc.sequence(cc.delayTime(.1*a),cc.fadeIn(.8),cc.callFunc(function(t){t===r-1&&(this.btnLayer.active=!0)}.bind(this,a))))}},returnToMainScene:function(){(this._fightResult&&(this._fightResult.getFightType()==td.FightType.ENDLESS&&a.default.getInstance().getSelect()||this._fightResult.getFightType()==td.FightType.DESTROY_TEMPLE&&h.default.getInstance().getIsSkipBattle())||this._fightResult.getFightType()==td.FightType.CROSS_ARENA&&_.default.getInstance().isJumpFight()?td.EventUtil.dispatchEvent(td.EventNameEnum.CLOSE_ENDLESS_RESULT_PANEL):(td.EventUtil.dispatchEvent(td.EventNameEnum.EXIT_PVP_SCENE),gdk.fsm.Fsm.broadcastEvent(n.default.ENTER_MAIN_SCENE)),this._fightResult)&&(this._fightResult.getFightType()===td.FightType.LEGEND&&E.default.getInstance().setReportTmp(null))},openHurtStatics:function(){var t=this;gdk.rm.loadRes(null,"prefab/Pvp/HurtStaticsLayer",cc.Prefab,function(){var e=gdk.rm.getResByUrl("prefab/Pvp/HurtStaticsLayer"),i=cc.instantiate(e);i.getComponent(R).setData(td.PvpFightManager.getFightResult()),t.node.addChild(i,td.PvpFightLayerTag.ZOrder_Hurt_Layer,td.PvpFightLayerTag.ZOrder_Hurt_Layer+"")})},onNextGate:function(){if(td.GlobalFunction.checkCanClicked())switch(this._fightResult.getFightType()){case td.FightType.ENDLESS:this.handleEndLessNextGate();break;case td.FightType.STAR_UP_ROAD:this.handleStarUpRoadNextGate()}},handleEndLessNextGate:function(){var t={};t.floor=a.default.getInstance().getFightFloor()+1,t.type=f.EndlessType.NORMAL,td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_ENDLESS_CHALLENGE,t),a.default.getInstance().setIsNextFloor(!0),this.node.getParent().removeFromParent()},handleStarUpRoadNextGate:function(){var t=v.default.getInstance().getCopyModelByCopyId(v.default.getInstance().getFightId()),e=v.default.getInstance().getCopyModelByCopyId(t.getCfg().nextId);if(td.Account.getUserData().getEnergy()<td.GetConfig("STAR_UP_ROAD_CHALLENGE_COST_ENERGY")){var i=td.GetConfig("BUY_ENERGY_ITEM_INFO"),n={};n.getNextRecoverTime=td.Account.getUserData().getLastRefreshEnergyTime();var a={itemId:td.ItemEnum.EnergyItem,shopType:i[0],productId:i[1],recoverInfo:n};if(!window.isPayOpen&&td.GlobalFunction.isShopItemBuyMax(eventData.shopType,eventData.productId,!0))return;td.GlobalFunction.showPanelDirect(td.PanelEnum.Window_ItemUseBuy,this.node.parent,a)}else{if(td.GetConfig("STAR_UP_ROAD_CHALLENGE_TIMES")!==e.getChallengeTimes())td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_STAR_UP_ROAD_CHALLENGE,e.getId());else{var r=new td.BroadcastContent(188);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,r)}}}}),cc._RF.pop()},{"../../../../Common/Component/GridLayoutComponent":void 0,"../../../Babel/Enum/BabelEnum":"BabelEnum","../../../Babel/Manager/BabelManager":"BabelManager","../../../CrossArena/Manager/CrossArenaManager":"CrossArenaManager","../../../DestroyTemple/Manager/DestroyTempleManager":"DestroyTempleManager","../../../Endless/Manager/EndlessManager":"EndlessManager","../../../Endless/Model/EndlessEnum":"EndlessEnum","../../../Legend/Manager/LegendManager":"LegendManager","../../../Maze/Manager/MazeManager":"MazeManager","../../../Nation/Enum/NationEnum":"NationEnum","../../../Nation/Manager/NationBossManager":"NationBossManager","../../../Nation/Manager/NationCityWarManager":"NationCityWarManager","../../../Nation/Manager/NationDuelManager":"NationDuelManager","../../../Nation/Manager/ScuffleYamaManager":"ScuffleYamaManager","../../../Pulse/Manager/PulseManager":"PulseManager","../../../StarUpRoad/Manager/StarUpRoadManager":"StarUpRoadManager","../../../Treasure/Manager/TreasureManger":"TreasureManger","../../../fight/pvp/Model/PvpFsmEventId":"PvpFsmEventId","../../utils/FightResultAniComponent":"FightResultAniComponent",HurtStaticsView:"HurtStaticsView"}],PvpFightTrajectory:[function(t,e,i){"use strict";cc._RF.push(e,"b1c2388R31Ac4GKtd9QI/fi","PvpFightTrajectory");var n=t("AnimationComponent");cc.Class({extends:n,properties:{_toPos:null,_isValid:null},init:function(t,e,i){if(i){var n=i.trajectorySp;this.playAnimationClip(n)}this._toPos=t,this.node.setPosition(cc.v2(0,this.node.y+100)),this._toPos=cc.v2(this._toPos.x,this._toPos.y),this._isValid=e;var a=Math.atan2(this._toPos.y,this._toPos.x),r=180/Math.PI*a;this.node.angle=r},onEnable:function(){var t=td.PvpFightController.getInstance().getFightSpeed(),e=Math.sqrt(this._toPos.x*this._toPos.x+this._toPos.y*this._toPos.y),i=cc.moveBy(e/1440/t,this._toPos);this.node.runAction(cc.sequence(i,cc.callFunc(function(){this._lastCallFunc()}.bind(this))))},onDisable:function(){this.node.stopAllActions()},_lastCallFunc:function(){this._isValid&&(td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_TRAJECTORY_ACTION_CALLBACK),td.EventUtil.dispatchEvent(td.EventNameEnum.FINISH_HERO_ATK_SHOW)),this.node.removeFromParent()}});cc._RF.pop()},{AnimationComponent:void 0}],PvpFightUI:[function(t,e,i){"use strict";cc._RF.push(e,"f2ca1GoIWJHMpvdLEpyOcew","PvpFightUI");var n=s(t("../../../Babel/Manager/BabelManager")),a=t("../../../Babel/Enum/BabelEnum"),r=s(t("../../../fight/pvp/Model/PvpFsmEventId")),o=s(t("./BabelSkillsTipUI"));function s(t){return t&&t.__esModule?t:{default:t}}var l=t("BaseUser");cc.Class({extends:cc.Component,properties:{_speed:null,speedImg:cc.Node,titleLabel:cc.Label,infoLeftNode:cc.Node,infoRightNode:cc.Node,infoMiddleNode:cc.Node,totalHurtLeftNode:cc.Node,totalHurtRightNode:cc.Node,vsNode:cc.Node,btn_speed:cc.Node,btn_stop:cc.Node,btn_pause:cc.Node,btn_report:cc.Node,imgSkip:cc.Node,labTimecount:cc.Label,timesNode:cc.Node,scrollview:cc.ScrollView,labelState:cc.Label,btnSkillBag:cc.Node,progressNode:cc.Node,popNode:cc.Node,petLeftNode:cc.Node,petRightNode:cc.Node,nodeAddition:cc.Node,labAdditionValue:cc.Label,_timeCount:null,_totalHurt:0,_curTotalHurtNode:null,_bStaticHurt:!1},onLoad:function(){this.totalHurtLeftNode.active=!1,this.totalHurtRightNode.active=!1,this.btn_speed.active=!1,this.btn_stop.active=!1,this.btn_pause.active=!1,this.btn_report.active="daxiang"==DX_CHANNEL&&td.ENVIRONMENT===td.EnviromentType.Local,this.timesNode.active=!1,this.imgSkip.active=!1,this._timeCount=td.GetConfig("PVP_SKIP_TIME_COUNT"),this.labTimecount.string=this._timeCount+"/",this.node.on("touchend",this._hideTimesNode,this)},_init:function(){},_uiAdaptive:function(){var t=td.UIAdaptiveUtil.getWinSize(),e=td.UIAdaptiveUtil.getMinScale(),i=this.getChildByName("UIRoot"),n=i.getContentSize();i.setPosition(cc.v2(t.width/2-n.width/2*e,0));var a=i.getChildByName("topLayout");a.y=t.height/e-a.height/e;var r=i.getChildByName("bottomLayout");(a=r.getChildByName("speedBtn")).x=-(t.width/2-n.width/2*e)/e,(a=r.getChildByName("nowStopBtn")).x=(t.width/2-n.width/2*e)/e+r.getContentSize().width},_addEventListener:function(){var t=td.EventNameEnum,e={};e[t.PREPARE_ROUND_PLAY]=this._setRoundInfo,e[t.PVP_HP_CHANGE]=this.hpChange,e[t.PVP_SKILL_HURT_STATICS_START]=this.staticSkillHurtStart,e[t.PREPARE_UNIT_FIGHT_PLAY]=this.staticSkillHurtEnd,e[t.START_PLAY_FIGHT]=this.startPlayFight,e[t.PVP_FIGHT_FORMATION_REFRESH]=this.refreshProgress,e[t.PVP_REPORT_ADD_SHOW]=this.addReport,td.EventUtil.registerEvents(e,this)},startPlayFight:function(){var t=td.PvpFightManager.getFightType(),e=t===td.FightType.PREVIEW_FIGHT,i=t===td.FightType.BABEL,n=td.GuideManager.isDoingEndlessGuide();this.btn_speed.active=!e&&!n,this.btn_stop.active=!e&&!n&&!i,this.btn_pause.active=i,td.UnlockManager.isTargetUnlock(1e3+t,1,!1)?(this._timeCount=0,this.imgSkip.active=!0,this.labTimecount.node.active=!1):(this.imgSkip.active=!1,this.labTimecount.node.active=!0,this.schedule(this.updateTimecount,1)),td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_CUSTOM_COND_CHANGE,td.GuideCustomCond.FightReady)},updateTimecount:function(t){this._timeCount-=1,0===this._timeCount&&(this.unschedule(this.updateTimecount,this),this.imgSkip.active=!0,this.labTimecount.node.active=!1),this.labTimecount.string=this._timeCount+"/"},_removeEventListener:function(){td.EventUtil.unregisterAllEvents(this)},onEnable:function(){this.clearReport(),this._addEventListener(),this._setRoundTitle(1),this._speed=parseInt(td.LocalStorageUtil.read(td.LocalDataKey.FIGHT_SPEED)),cc.js.isNumber(this._speed)&&!isNaN(this._speed)||(this._speed=1),td.UIAdaptiveUtil.AdaptivePanelBaseResetRootSize(this.node),this._setSpeed(this._speed);var t=td.PvpFightController.getInstance().getFightMembers();if(cc.isValid(t)){this._initPlayerInfo(this.infoLeftNode,t[1]);var e=td.PvpFightManager.getFightType(),i=td.FightType;this.infoMiddleNode.active=e===i.WorldBoss,this.infoLeftNode.active=e!==i.WorldBoss,this.infoRightNode.active=e!==i.WorldBoss,this.vsNode.active=e!==i.WorldBoss,e===i.WorldBoss?this._initMiddleInfo(this.infoMiddleNode,t[2],!0):this._initPlayerInfo(this.infoRightNode,t[2],!0),this.btnSkillBag.active=e===i.BABEL,this.progressNode.active=e===i.BABEL,e===i.BABEL&&this.setCurProgressNode(),this.initPetInfo()}else cc.error("PvpFightUI onEnabe mebmers erro")},onDisable:function(){this._removeEventListener(),this.unschedule(this.updateTimecount,this)},_setRoundInfo:function(t){var e=t.getRoundId();this._setRoundTitle(e),this.refreshPetCD(e),this._refreshRoundAddition(e)},_setRoundTitle:function(t){t||(t=1),this.titleLabel.string=cc.js.formatStr(td.Language.roundCount,t)},_refreshRoundAddition:function(t){var e=td.PvpFightManager.getFightType();if(e==td.FightType.Arena||e==td.FightType.TREASURE_SNATCH||e==td.FightType.CROSS_CUP||e==td.FightType.PURPLE_FAIRYLAND||e==td.FightType.LEGEND||e==td.FightType.COMPETE||e==td.FightType.CROSS_ARENA||e==td.FightType.NATION_DUEL||e==td.FightType.MAZE_PVP){var i=td.PvpFightManager.getRoundAddition(t),n=i.round||10,a=(i.value||1500)/100;this.nodeAddition.active=t>=n,this.labAdditionValue.string=a+"%"}else this.nodeAddition.active=!1},_setAddSpVisible:function(t){var e=td.TBSFightManager.getFightType(),i=this.getChildByName("UIRoot"),n=ccui.helper.seekWidgetByName(i,"centerLayout");if(t&&td.GetTableClass(td.TableEnum.FightRound).getAddSp(e,t.getRoundId())){n.setVisible(!0);var a=td.GetTableClass(td.TableEnum.FightRound).getAddSp(e,t.getRoundId()),r=n.getChildByName("addSp");r.loadTexture(a),td.GlobalFunction.setImageContentSize(r,a),setTimeout(this._setAddSpVisible.bind(this),1e3)}else n.setVisible(!1)},stopNowFunc:function(t){var e=td.PvpFightManager.getFightType();td.GuideManager.isDoingEndlessGuide()?td.UnlockManager.isTargetUnlock(1e3+e,1,!0):(this._timeCount>0?td.UnlockManager.isTargetUnlock(1e3+e,1,!0)&&td.EventUtil.dispatchEvent(td.EventNameEnum.STOP_FIGHT_NOW):td.EventUtil.dispatchEvent(td.EventNameEnum.STOP_FIGHT_NOW),this._hideTimesNode())},pauseNowFunc:function(){this.popNode.active=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.PAUSE_FIGHT)},clickResume:function(){this.popNode.active=!1,td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_FIGHT)},clickExitFight:function(){this.popNode.active=!1;var t=td.PvpFightManager.getFightResult().getFightResult();if(td.TBSFightResultEnum.SUCCESS===t)return td.EventUtil.dispatchEvent(td.EventNameEnum.EXIT_PVP_SCENE),void gdk.fsm.Fsm.broadcastEvent(r.default.ENTER_MAIN_SCENE);td.TBSFightResultEnum.FAILURE===t&&(td.EventUtil.dispatchEvent(td.EventNameEnum.STOP_FIGHT_NOW),this._hideTimesNode())},showSpeedTimes:function(){this.timesNode.active=!this.timesNode.active},_hideTimesNode:function(){this.timesNode.active=!1},speedChangeFunc:function(t){var e=parseInt(t.target.name);td.UnlockManager.isTargetUnlock(td.ActorUnlockType.PVP_BattleTimes,e-1,!0)&&(this._speed=e,this._setSpeed(e),this._hideTimesNode())},_setSpeed:function(t){var e="ZD_GY_jiazhu_0"+t;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,e,this.speedImg),td.LocalStorageUtil.write(td.LocalDataKey.FIGHT_SPEED,t),td.EventUtil.dispatchEvent(td.EventNameEnum.FIGHT_SPEED_CHANGE,t);for(var i=1;i<=3;i++){var n=this.timesNode.getChildByName(""+i),a=n.getChildByName("times");i===t?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,"ZD_GY_xinxidi02",n):td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,"ZD_GY_xinxidi",n);var r=td.UnlockManager.isTargetUnlock(td.ActorUnlockType.PVP_BattleTimes,i-1,!1);td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.ZD_Common,(r?"ZD_GY_jiasu0":"ZD_GY_jiasu_gray_0")+i,a)}},_initPlayerInfo:function(t,e,i){void 0===i&&(i=!1);var n=t.getChildByName("headNode"),a=t.getChildByName("lableName"),r=t.getChildByName("lableCombat"),o=t.getChildByName("progress"),s=t.getChildByName("GY0_zhanli_01"),c=new l;c.init("BaseUser",e.getUserAttr());var u=c.nickName;u.startWith("#npc")&&(u=td.Language[u]||u),a.getComponent(cc.Label).string=u,r.getComponent(cc.Label).string=c.fightPower;var d=td.PvpFightManager.getFightType();r.active=d!==td.FightType.BABEL&&d!==td.FightType.MAZE_PVE&&d!==td.FightType.MAZE_PVP,s.active=d!==td.FightType.BABEL&&d!==td.FightType.MAZE_PVE&&d!==td.FightType.MAZE_PVP,o._maxHp=e.getTotalMaxHp(),o._hp=e.getCurTotalHp(),o.getComponent(cc.ProgressBar).progress=e.getCurTotalHp()/e.getTotalMaxHp();var h=td.GlobalFunction.createAvatarHeadWidget(5,c,!0);if(n.addChild(h),h.x=0,h.y=0,i){var p=""+c.fightPower;s.x=r.x-17.3*p.length}},_initMiddleInfo:function(t,e){var i=e.getFormation().getMercenarys()[1].getBaseModel(),n=t.getChildByName("name"),a=t.getChildByName("progress"),r=t.getChildByName("hpLabel"),o=t.getChildByName("mask_touxiang").getChildByName("headNode");n.getComponent(cc.Label).string=i.getName(),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_touxiang,i.getIconRes(),o);var s=e.getTotalMaxHp(),l=e.getCurTotalHp();r.getComponent(cc.Label).string=l+"/"+s,a._maxHp=s,a._hp=l,a.getComponent(cc.ProgressBar).progress=l/s},refreshProgress:function(t){var e=null;td.PvpFightManager.getFightType()===td.FightType.WorldBoss?(e=this.infoMiddleNode).getChildByName("hpLabel").getComponent(cc.Label).string=t.getCurTotalHp()+"/"+t.getMaxHp():e=this.infoRightNode;var i=e.getChildByName("progress");i._maxHp=t.getMaxHp(),i._hp=t.getCurTotalHp(),i.getComponent(cc.ProgressBar).progress=t.getCurTotalHp()/t.getMaxHp()},hpChange:function(t){var e=t.sid,i=t.hpChange,n=td.PvpFightManager.getCampByMercenarySid(e),a=td.PvpFightManager.getFightType(),r=this.infoLeftNode.getChildByName("progress");if(2==n&&(r=a===td.FightType.WorldBoss?this.infoMiddleNode.getChildByName("progress"):this.infoRightNode.getChildByName("progress")),a!==td.FightType.WorldBoss||1!=n){var o=r._hp,s=r._maxHp;(o+=i)<0&&(o=0),r._hp=o,td.PvpFightController.getInstance()._dataController._fightData.members[n]._fightFormation._curTotalHp=o;var l=Math.abs(o/s);if(r.getComponent(cc.ProgressBar).progress=l,a===td.FightType.WorldBoss&&2==n)this.infoMiddleNode.getChildByName("hpLabel").getComponent(cc.Label).string=o+"/"+s;if(this._bStaticHurt)this._totalHurt+=i<0?i:0,this._curTotalHurtNode.getChildByName("totalHurt").getComponent(cc.Label).string=this._totalHurt,this._curTotalHurtNode.active=this._totalHurt<0}},staticSkillHurtStart:function(t){this._totalHurt=0;var e=td.PvpFightManager.getCampByMercenarySid(t);this._curTotalHurtNode=1==e?this.totalHurtRightNode:this.totalHurtLeftNode,this._bStaticHurt=!0,this._curTotalHurtNode.getChildByName("totalHurt").getComponent(cc.Label).string=0},staticSkillHurtEnd:function(){this._curTotalHurtNode&&(this._curTotalHurtNode.active=!1),this._totalHurt=0,this._bStaticHurt=!1},showFightReport:function(){this.showFightReport.show?this.showFightReport.show=!1:this.showFightReport.show=!0,this.scrollview.node.active=this.showFightReport.show},addReport:function(t){if("daxiang"==DX_CHANNEL&&td.ENVIRONMENT===td.EnviromentType.Local){var e=this.scrollview.node.getChildByName("item"),i=cc.instantiate(e),n=this.scrollview.content.getChildren();this.scrollview.content.addChild(i),n.length>10&&this.scrollview.content.setContentSize(cc.size(720,i.getContentSize().height*(n.length+1)));var a="";a+="\u7b2c",a+=td.PvpFightController.getInstance()._dataController._roundData.getRoundId(),a+="\u56de\u5408",a+=td.PvpFightController.getInstance()._dataController.getFightUnitReportData().getReportIndex(),a+=" \u884c\u52a8:",a+=t.getAttackerId(),a+=" \u76ee\u6807:",a+=t.getTargetSid();var r=t.getEffectId();a+=" \u6280\u80fd:",a+=r;var o=t.getAttributeMap(),s=o[td.SpriteKey.HP];s&&0!=s&&(a+=" \u8840\u91cf:",a+=s>0?"+":"-",a+=s);var l=o[td.SpriteKey.RAGE];l&&0!=l&&(a+=" \u6012\u6c14:",a+=l>0?"+":"-",a+=l),t.isShowBuff()&&(4==t._hitState&&t._buffIdentifys?(a+=" \u79fb\u9664buff:",a+=t._buffIdentifys[1]):6==t._hitState&&t._buffIdentifys&&(a+=" \u89e6\u53d1buff:",a+=t._buffIdentifys[1]));var c=td.GetTableClass(td.TableEnum.SkillEffect).getDataById(r);c&&c.des&&(a+="\n",a+="       ",a+=c.des),i.getComponent(cc.Label).string=a,this.scrollview.scrollToBottom(1)}},changeState:function(){td.GlobalFunction.checkCanClicked()&&(this.changeState.isStop?this.changeState.isStop=!1:this.changeState.isStop=!0,td.EventUtil.dispatchEvent(this.changeState.isStop?td.EventNameEnum.PAUSE_FIGHT:td.EventNameEnum.RESUME_FIGHT),this.labelState.string=this.changeState.isStop?"\u7ee7\u7eed":"\u6682\u505c")},showSkillBagDetail:function(){var t=n.default.getInstance().getBabelBattleInfo(a.BabelBattleInfoEnum.SPECIALEFFECTS);o.default.showSkillsTipUI(this.node,t)},setCurProgressNode:function(){var t=this.progressNode,e=n.default.getInstance().getBabelBattleInfo(a.BabelBattleInfoEnum.STAGE)||1,i=t.getChildByName("label_progress"),r=n.default.getInstance().getBabelBattleInfo(a.BabelBattleInfoEnum.FLOOR),o=n.default.getInstance().getBabelBattleInfo(a.BabelBattleInfoEnum.DIFFICULTY),s=n.default.getInstance().getBabelDataByfloorAndDifficulty(r,o);i.getComponent(cc.Label).string=e+"/"+s.length},clearReport:function(){this.scrollview.content.removeAllChildren(),this.scrollview.content.setContentSize(cc.size(720,700))},initPetInfo:function(){this._leftPetMap=td.PvpFightManager.getPetData("1"),this._rightPetMap=td.PvpFightManager.getPetData("2"),this.petLeftNode.active=Object.keys(this._leftPetMap).length>0,this.petRightNode.active=Object.keys(this._rightPetMap).length>0,this._initPetIcons(this.petLeftNode,this._leftPetMap),this._initPetIcons(this.petRightNode,this._rightPetMap)},_initPetIcons:function(t,e){for(var i in e){var n=e[i],a=t.getChildByName("item_"+i),r=a.getChildByName("mask"),o=a.getChildByName("petNode"),s=a.getChildByName("labelCD"),l=td.GlobalFunction.createCommonIconWidget(2,n.getBaseModel());o.addChild(l),l.getComponent("CommonIconWidget").disableHeadTouch(),r.active=!1,s.active=!1}},refreshPetCD:function(t){this._refreshPetCDInfo(this.petLeftNode,this._leftPetMap,t),this._refreshPetCDInfo(this.petRightNode,this._rightPetMap,t)},_refreshPetCDInfo:function(t,e,i){if(!(i<=1))for(var n in e){var a=e[n],r=t.getChildByName("item_"+n),o=r.getChildByName("mask"),s=r.getChildByName("labelCD"),l=a.getPos()%6,c=l>i?0:(4-i%4+l)%4;o.active=c>0,s.active=c>0,s.getComponent(cc.Label).string=c}}});cc._RF.pop()},{"../../../Babel/Enum/BabelEnum":"BabelEnum","../../../Babel/Manager/BabelManager":"BabelManager","../../../fight/pvp/Model/PvpFsmEventId":"PvpFsmEventId","./BabelSkillsTipUI":"BabelSkillsTipUI",BaseUser:"BaseUser"}],PvpFightUnderAtkAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"11d1c1u+iZL7a3O6kOM2kSM","PvpFightUnderAtkAnimation");var n=t("PvpFightShowAnimation"),a=cc.Class({extends:n,init:function(t){var e=t.getUnderAtkAnimationRes();this._animClipName=t.getUnderAtkAnimation(),this._super(e)},setFrameListener:function(t){this._super([],null,function(){this.node.removeFromParent(),t&&t()}.bind(this))}});e.exports=a,cc._RF.pop()},{PvpFightShowAnimation:"PvpFightShowAnimation"}],PvpFightUserModel:[function(t,e,i){"use strict";cc._RF.push(e,"905421A84hI8qbzOychE5un","PvpFightUserModel");var n=t("Model");td.PvpFightUserModel=cc.Class({extends:n,properties:{_camp:null,_userAttr:null,_fightFormation:null},init:function(t,e){this._userAttr={},this._fightFormation=null,this._setUserAttr(e.attributeMap),this._setCamp(e.camp),this._setFightFormation(e.sprites)},_setUserAttr:function(t){this._userAttr=t},getUserAttr:function(){return this._userAttr},_setCamp:function(t){this._camp=parseInt(t)},getCamp:function(){return this._camp},_setFightFormation:function(t){this._fightFormation||(this._fightFormation=new td.PvpFightFormation),this._fightFormation.parsePacket(t)},getFormation:function(){return this._fightFormation},getTotalMaxHp:function(){return this._fightFormation.getMaxHp()},getCurTotalHp:function(){return this._fightFormation.getCurTotalHp()}}),cc._RF.pop()},{Model:"Model"}],PvpFirstBattleUtil:[function(t,e,i){"use strict";cc._RF.push(e,"6615d9xj/lO0bHpHi10/Ix2","PvpFirstBattleUtil"),td.PvpFirstBattleUtil={getEndlessFirstBattlePacket:function(){var t='{"bufferReports":{},"members":[{"attributeMap":{"17":16859,"5":1099578736645,"6":"\u8bf8\u845b\u5c27\u4e00","7":true,"8":8,"13":1},"camp":"1","sprites":[{"attributes":{"30":1040,"36":4,"2":1099578736645,"3":4003,"4":"1","5":2,"32":1040,"1":10005,"6":"1","35":2}},{"attributes":{"30":2520,"36":4,"2":1099578736645,"3":5003,"4":"1","5":4,"32":2520,"1":10006,"6":"1","35":4}},{"attributes":{"30":1093,"36":4,"2":1099578736645,"3":4001,"4":"1","5":1,"32":1093,"1":10007,"6":"1","35":2}},{"attributes":{"30":1140,"36":4,"2":1099578736645,"3":7003,"4":"1","5":3,"32":1140,"1":10008,"6":"1","35":2}}]},{"attributeMap":{"17":5280,"5":9001,"6":"#npc81002","8":0,"12":0,"13":1002},"camp":"2","sprites":[{"attributes":{"30":150,"36":4,"2":-1099578736645,"3":100201,"4":"2","5":1,"32":150,"1":10001,"6":"2","35":2}},{"attributes":{"30":1200,"36":4,"2":-1099578736645,"3":600601,"4":"2","5":5,"32":1200,"1":10004,"6":"2","35":4}},{"attributes":{"30":150,"36":4,"2":-1099578736645,"3":100201,"4":"2","5":4,"32":150,"1":10009,"6":"2","35":2}},{"attributes":{"30":150,"36":4,"2":-1099578736645,"3":100901,"4":"2","5":2,"32":150,"1":10002,"6":"2","35":2}},{"attributes":{"30":150,"36":4,"2":-1099578736645,"3":100901,"4":"2","5":3,"32":150,"1":10003,"6":"2","35":2}},{"attributes":{"30":150,"36":4,"2":-1099578736645,"3":100901,"4":"2","5":6,"32":150,"1":10010,"6":"2","35":2}},{"attributes":{"30":150,"36":4,"2":-1099578736645,"3":100901,"4":"2","5":7,"32":150,"1":10011,"6":"2","35":2}}]}],"showSIds":{"1":[10005,10007,10008,10001,10002,10003]},"reports":{"1":[{"attackerUid":10007,"damageType":"1","effectList":[{"attributeMap":{"30":-105},"critical":false,"effectId":1000000,"hitState":"1","targeterUid":10001},{"attributeMap":{"35":2},"critical":false,"effectId":-3,"hitState":"1","targeterUid":10007}],"skillId":1140010},{"attackerUid":10001,"damageType":"1","effectList":[{"attributeMap":{"30":-42},"critical":false,"effectId":1000000,"hitState":"1","targeterUid":10007},{"attributeMap":{"35":2},"critical":false,"effectId":-3,"hitState":"1","targeterUid":10001}],"skillId":1110020},{"attackerUid":10005,"damageType":"1","effectList":[{"attributeMap":{"30":-105},"critical":false,"effectId":1000000,"hitState":"1","targeterUid":10002},{"attributeMap":{"35":2},"critical":false,"effectId":-3,"hitState":"1","targeterUid":10005}],"skillId":1140030},{"attackerUid":10002,"damageType":"1","effectList":[{"attributeMap":{"30":-42},"critical":false,"effectId":1000000,"hitState":"1","targeterUid":10005},{"attributeMap":{"35":2},"critical":false,"effectId":-3,"hitState":"1","targeterUid":10002}],"skillId":1110090},{"attackerUid":10008,"damageType":"1","effectList":[{"attributeMap":{"30":-150},"critical":false,"effectId":1000000,"hitState":"1","targeterUid":10003},{"attributeMap":{"35":2},"critical":false,"effectId":-3,"hitState":"1","targeterUid":10008}],"skillId":1170030},{"attackerUid":10004,"damageType":"1","effectList":[{"attributeMap":{"30":-1500},"critical":false,"effectId":1260060,"hitState":"1","targeterUid":10007},{"attributeMap":{},"buff":{"effectId":1460060,"key":{"identifys":[10016,1460060,1,2]}},"critical":false,"effectId":1460060,"hitState":"1","targeterUid":10004},{"attributeMap":{"30":-1000},"critical":false,"effectId":1260060,"hitState":"1","targeterUid":10008},{"attributeMap":{"30":-1500},"critical":false,"effectId":1260060,"hitState":"1","targeterUid":10005},{"attributeMap":{"35":-4},"critical":false,"effectId":-3,"hitState":"1","targeterUid":10004}],"skillId":1260060},{"attackerUid":10006,"damageType":"1","effectList":[{"attributeMap":{"30":-1200},"critical":false,"effectId":1250030,"hitState":"1","targeterUid":10012},{"attributeMap":{"30":-1200},"critical":false,"effectId":1250030,"hitState":"1","targeterUid":10002},{"attributeMap":{"30":-1200},"critical":false,"effectId":1250030,"hitState":"1","targeterUid":10001},{"attributeMap":{"30":-1200},"critical":false,"effectId":1250030,"hitState":"1","targeterUid":10004},{"attributeMap":{"30":-1200},"critical":false,"effectId":1250030,"hitState":"1","targeterUid":10009},{"attributeMap":{"30":-1200},"critical":false,"effectId":1250030,"hitState":"1","targeterUid":10010},{"attributeMap":{"30":-1200},"critical":false,"effectId":1250030,"hitState":"1","targeterUid":10011},{"attributeMap":{"35":-4},"critical":false,"effectId":-3,"hitState":"1","targeterUid":10006}],"skillId":1250030}]},"reward":{"abyssCoin":0,"achPoint":0,"amethyst":0,"arenaCoin":0,"avatarList":[],"battleAchieve":0,"diamond":0,"dragonBossCoin":0,"energy":0,"equipmentMap":{"72061992084439047":10001},"exp":0,"fund":0,"gemMap":{},"gold":0,"goodsMap":{"30104":3},"heroMap":{},"heroRuneCoin":0,"heroRuneMap":{},"luckyCoin":0,"merit":0,"mindVowel":0,"mine":0,"nationCoin":0,"nationExp":0,"nationSciTechPoint":0,"point":0,"prerogatives":[],"prestige":0,"runeMap":{},"showList":[],"skyJade":20,"supSciTechPoint":0,"treasureMap":{},"vigour":0,"worldBossCoin":0},"stats":{"campDamages":{"1":2100,"2":2066},"spriteDamages":{"10001":210,"10002":225,"10003":45,"10004":1586,"10005":275,"10006":1416,"10007":194,"10008":215},"star":0,"winCamp":"1"},"type":"6"}';return t=t.replace(/\u8bf8\u845b\u5c27\u4e00/g,td.Account.getUserData().nickName),t=window.JsonParse?window.JsonParse(t):JSON.parse(t)},getEndlessSpecialHeroData:function(){var t='{"camp":"2","sprites":[{"attributes":{"30":300,"36":4,"2":-1099578736645,"3":100201,"4":"2","5":3,"32":300,"1":10012,"6":"2","35":2}}]}';return t=window.JsonParse?window.JsonParse(t):JSON.parse(t)}},cc._RF.pop()},{}],PvpFsmEventId:[function(t,e,i){"use strict";cc._RF.push(e,"877bcPDJaxG/YoOEEGHx5H7","PvpFsmEventId"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.ENTER_PVP_SCENE="ENTER_PVP_SCENE",t.ENTER_MAIN_SCENE="ENTER_MAIN_SCENE",t.ENTER_PVP_PANEL="ENTER_PVP_PANEL",t.ENTER_PVE_HOOK_PANEL="ENTER_PVE_HOOK_PANEL",t}();i.default=n,gdk.fsm.FsmEventId.mixins(n),cc._RF.pop()},{}],PvpRollProgressBarComponent:[function(t,e,i){"use strict";cc._RF.push(e,"e7f653JBdVOJ6jfY8XVmrkB","PvpRollProgressBarComponent");var n=cc.Class({extends:cc.Component,properties:{_playUnitTime:null,_fromPercent:null,_toPercent:null,_scrollTimes:null,_runingUpdate:!1},init:function(){this._playUnitTime=1.5},setPlayUnitTime:function(t){this._playUnitTime=t||.5},setPercent:function(t,e){t>1?t=1:t<0&&(t=0);var i=this.node.getComponent(cc.ProgressBar);this._toPercent=t,this._fromPercent=i.progress,e?this._runingUpdate||(this._runingUpdate=!0,this.schedule(this.updateProgress,.06)):i.progress=t},onDisable:function(){this._runingUpdate=!1,this.unschedule(this.updateProgress)},updateProgress:function(t){this._fromPercent<this._toPercent?(this._fromPercent+=t/this._playUnitTime,this._fromPercent>this._toPercent&&(this._fromPercent=this._toPercent)):(this._fromPercent-=t/this._playUnitTime,this._fromPercent<this._toPercent&&(this._fromPercent=this._toPercent)),this.node.getComponent(cc.ProgressBar).progress=this._fromPercent,this._fromPercent===this._toPercent&&(this._runingUpdate=!1,this.unschedule(this.updateProgress))}});e.exports=n,cc._RF.pop()},{}],QQMoxieEnum:[function(t,e,i){"use strict";cc._RF.push(e,"b522bbqg6JI06zIfbje3CJo","QQMoxieEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.MoXieOS_Type=i.MoXieRedEnvelopeType=i.RewardStateType=i.MOXIE_REWARD_TYPE=void 0,function(t){t[t.NONE=0]="NONE",t[t.SUBSCRIBE=1]="SUBSCRIBE",t[t.NOVICE=2]="NOVICE",t[t.FAVORITES=3]="FAVORITES",t[t.COLOR_SIGN=4]="COLOR_SIGN",t[t.EVERY_DAY=100]="EVERY_DAY",t[t.AD_TIMES=101]="AD_TIMES",t[t.SHARE=102]="SHARE"}(i.MOXIE_REWARD_TYPE||(i.MOXIE_REWARD_TYPE={})),function(t){t[t.UNACTIVTE=1]="UNACTIVTE",t[t.UNRECEIVE=2]="UNRECEIVE",t[t.RECEIVED=3]="RECEIVED",t[t.NONE=0]="NONE"}(i.RewardStateType||(i.RewardStateType={})),function(t){t[t.LOGIN_RED_ENVELOPE=1]="LOGIN_RED_ENVELOPE",t[t.RECHARGE_RED_ENVELOPE=2]="RECHARGE_RED_ENVELOPE",t[t.CASH_RED_ENVELOPE=3]="CASH_RED_ENVELOPE"}(i.MoXieRedEnvelopeType||(i.MoXieRedEnvelopeType={})),function(t){t[t.ANDROID=1]="ANDROID",t[t.IOS=2]="IOS"}(i.MoXieOS_Type||(i.MoXieOS_Type={})),cc._RF.pop()},{}],QQMoxieManager:[function(t,e,i){"use strict";cc._RF.push(e,"0aa45K6YHZKtL7Qi2Bi6Cuy","QQMoxieManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window,a=t("../Model/MoxieReqVO"),r=t("../Model/MoxieRewardModel"),o=t("UFSdkManager"),s=function(){function t(){this._rewardTimes={},this._rewardModelMap=null,this._loginRedEnvelope=null,this._receiveList=null,this._withdrawalList=null,this._rechargeRedEnvelope=null,this._state=0,this._cashRedEnvelope=null,this._rewardMap=null,this._isOldPlayer=!1,this.RED_PACKET_OPEN_DAYS=7}return t.getInstance=function(){return null==this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),td.QQ_MOXIE_M=this},t.prototype.destroyData=function(){this._rewardTimes={},this._rewardModelMap=null,this._loginRedEnvelope=null,this._receiveList=null,this._withdrawalList=null,this._rechargeRedEnvelope=null,this._state=null,this._cashRedEnvelope=null,this._rewardMap=null},t.prototype.initModels=function(){if(!this._rewardModelMap){this._rewardModelMap={};var t=td.GetConfig("MO_XIE_REWARD"),e=td.GetConfig("MO_XIE_TIMES");for(var i in t){var n=t[i],a=n[0],o=e[i],s=this._rewardModelMap[a];s||(s=new r.default),s.init(n),s.setMaxTimes(o[1]),this._rewardModelMap[a]=s}}},t.prototype.refreshLoginRedEnvelope=function(){this._receiveList=this._loginRedEnvelope.receiveList,this._withdrawalList=this._loginRedEnvelope.withdrawalList},t.prototype.refreshRechargeRedEnvelope=function(){this._state=this._rechargeRedEnvelope.state},t.prototype.refreshCashRedEnvelope=function(){this._rewardMap=this._cashRedEnvelope.rewardMap},t.prototype.addListener=function(){var t=td.ServerDelegate,e=td.MsgModuleName.ExtensionCmd,i=td.MsgCmd.ExtensionCmd;t.registerMessage(e,i.MO_XIE_INFO,this._onGetMoxieInfo.bind(this)),t.registerMessage(e,i.MO_XIE_REWARD,this._onGetMoxieReward.bind(this)),t.registerMessage(e,i.PUSH_MO_XIE_INFO,this._onGetMoxieInfo.bind(this))},t.prototype.addEventListener=function(){var t={};t[td.EventNameEnum.MOXIE_REQ_INFO]=this._reqGetMoxieInfo,t[td.EventNameEnum.MOXIE_REQ_REWARD]=this._reqGetReward,t[td.EventNameEnum.MOXIE_REQ_RECHARGE_RECEIVE]=this._reqRechargeRecevive,t[td.EventNameEnum.MOXIE_REQ_RED_ENVELOPE]=this._reqRedPack,t[td.EventNameEnum.MOXIE_REQ_RED_ENVELOPE_RECEIVE]=this._reqRedPackReceive,t[td.EventNameEnum.MOXIE_REQ_RED_ENVELOPE_DRAW]=this._reqRedPackDraw,t[td.EventNameEnum.MOXIE_RECHARGE_CHECK]=this._reqRechargeCheck,t[td.EventNameEnum.MOXIE_GET_BALANCE]=this._reqGetBalance,td.EventUtil.registerEvents(t,this)},t.prototype._refreshModelTimes=function(){for(var t in this._rewardTimes){var e=this._rewardTimes[t],i=this._rewardModelMap[t];i?i.setReceivedTimes(e):cc.error(cc.js.formatStr("=====> \u6ca1\u6709type[%s]\u5bf9\u5e94\u7684model \u6570\u636e\u554a\uff0c\u7a0b\u5e8f\u770b\u770b0.0",t))}},t.prototype._reqGetMoxieInfo=function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.MO_XIE_INFO,td.ServerDelegate.sendMessage(t)},t.prototype._onGetMoxieInfo=function(t,e){t===td.NetCode.SUCCESS&&(this.initModels(),this._rewardTimes=e.rewardTimes||{},this._refreshModelTimes(),this._loginRedEnvelope=e.loginRedEnvelope||{},this.refreshLoginRedEnvelope(),this._rechargeRedEnvelope=e.rechargeRedEnvelope||{},this.refreshRechargeRedEnvelope(),this._cashRedEnvelope=e.cashRedEnvelope||{},this.refreshCashRedEnvelope(),td.EventUtil.dispatchEvent(td.EventNameEnum.MOXIE_ON_GET_INFO))},t.prototype._reqGetReward=function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.MO_XIE_REWARD,e.type=t,td.ServerDelegate.sendMessage(e)},t.prototype._reqRechargeRecevive=function(){var t=new a.MoxieRechargeRedEnvelopeWithDrawalVO;td.ServerDelegate.sendMessage(t)},t.prototype._onGetMoxieReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.MOXIE_ON_GET_REWARD)}},t.prototype._reqRedPack=function(){var t=new a.MoXieRedEnvelopeVO;td.ServerDelegate.sendMessage(t)},t.prototype._reqRedPackReceive=function(t,e){var i=new a.MoXieRedEnvelopeReceiveVO(t,e);td.ServerDelegate.sendMessage(i)},t.prototype._reqRedPackDraw=function(t,e){var i=new a.MoXieRedEnvelopeWithdrawalVO(t,e);td.ServerDelegate.sendMessage(i)},t.prototype._reqGetBalance=function(t){o.getInstance().getBalance(t)},t.prototype._reqRechargeCheck=function(){o.getInstance().rechargeCheck()},t.prototype.setOldPlayer=function(t){this._isOldPlayer=t},t.prototype.isRedPacketOpen=function(){return!n.UFServerManager.getInstance().isVeteran()&&td.SystemManager.getServerOpenDays()<=this.RED_PACKET_OPEN_DAYS},t.prototype.getRewardModelByType=function(t){return this.initModels(),this._rewardModelMap[t]},t.prototype.getRewardsByType=function(t){this.initModels();var e=this._rewardModelMap[t];return e?e.getRewards():(cc.error(cc.js.formatStr("=====> \u6ca1\u6709type[%s]\u5bf9\u5e94\u7684model \u6570\u636e\u554a\uff0c\u7a0b\u5e8f\u770b\u770b",t)),[])},t.prototype.isRewardReceived=function(t){return(this._rewardTimes[t]||0)>=1},t.prototype.getRechargeRedEnvelopeState=function(){return this._state},t}();i.default=s,cc._RF.pop()},{"../Model/MoxieReqVO":"MoxieReqVO","../Model/MoxieRewardModel":"MoxieRewardModel",UFSdkManager:void 0}],QiMenDunJia:[function(t,e,i){"use strict";cc._RF.push(e,"2599aB8KopH7auqnVXSYOl6","QiMenDunJia");var n=t("BaseBossSkill"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="QiMenDunJia"},effect:function(){if(cc.isValid(this._owner))for(var t=Math.abs(this._dataModel.getDamageRange()),e=a.getEnemyArrayExcept(this._owner),i=td.GlobalFunction.getRandomArrayElements(e,t),n=0;n<i.length;n++){var r=i[n];this.setAttackEffectToEnemy(r)}else this.removeSelf()}});e.exports=r,cc._RF.pop()},{BaseBossSkill:"BaseBossSkill",PveFightManager:"PveFightManager"}],RankEnum:[function(t,e,i){"use strict";cc._RF.push(e,"1ac6bA/kIhMp4VPTLAxdRlm","RankEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.TopRankPos=i.RankItemName=i.AboreType=i.RankType=void 0,i.RankType={NONE:0,ACTOR_POWER_RANK:1,DIVINE:10,ARENA_RANK:2,ACTOR_LEVEL_RANK:3,STORY_RANK_NORMAL:4,DESTROY_TEMPLE_RANK:5,HERO_RANK:6,NATION_RANK:7,ENDLESS_RANK:8,SHOW_TOTAL:99,GOD_RANK:100,GEMSTONE:101,STORY_RANK_NIGHTMARE:200,STORY_RANK_HELLISH:201},function(t){t[t.Flower=1]="Flower",t[t.Abore=2]="Abore",t[t.Cross=3]="Cross"}(i.AboreType||(i.AboreType={})),i.RankItemName={1:"item_fightPower",2:"item_fightPower",3:"item_fightPower",4:"item_star",5:"item_floor",6:"item_hero",7:"item_nation",8:"item_endless",9:"item_ancient",10:"itemDivine"},i.TopRankPos={0:cc.v2(6,300),1:cc.v2(-202,110),2:cc.v2(198,50),3:cc.v2(-114,-219),4:cc.v2(170,-300)},cc._RF.pop()},{}],RankManager:[function(t,e,i){"use strict";cc._RF.push(e,"8101ctNM51Bx6Y7lC8CkVGG","RankManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,t("ActorRankModel")),s=t("PveCopyEnum"),l=t("../Enum/RankEnum"),c=t("../../Nation/Manager/NationMainManager"),u=function(){function t(){this._curRankType=0,this._curPage=0,this._maxPage=0,this._haveData={},this._rankList={},this._myRankInfo={},this._floweredCount={},this._topRankList=[],this._topRankFlowerCounts={}}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._curRankType=l.RankType.NONE,this._curPage=0,this._maxPage=0,this._haveData={},this._floweredCount={},this._rankList={},this._myRankInfo={},this._topRankList=[],this._topRankFlowerCounts={}},t.prototype.addListener=function(){var t=td.MsgModuleName,e=td.MsgCmd,i=td.ServerDelegate;i.registerMessage(t.USER,e.User.GET_ALL_RANKS,this._resRankBaseInfo.bind(this)),i.registerMessage(t.USER,e.User.ACTOR_POWER_RANK,this._resActorRankActorPower.bind(this)),i.registerMessage(t.USER,e.User.ACTOR_LEVEL_RANK,this._resActorRankActorLevel.bind(this)),i.registerMessage(t.USER,e.User.ACTOR_GOD_RANK,this._parseTopRank.bind(this)),i.registerMessage(td.MsgModuleName.ARENA,td.MsgCmd.ARENA.ARENA_RANK,this._resActorRankArenaRank.bind(this)),i.registerMessage(td.MsgModuleName.PveGeneralCopy,td.MsgCmd.PVE_GENERAL_COPY.STORY_RANK,this._resGeneralCopyRank.bind(this)),i.registerMessage(td.MsgModuleName.DESTROY_TEMPLE,td.MsgCmd.DESTROY_TEMPLE.DESTROY_TEMPLE_YESTERDAY_RANK,this._resDestroyTempleRank.bind(this)),i.registerMessage(td.MsgModuleName.LINEUP,td.MsgCmd.LINEUP.HERO_RANK,this._resHeroRank.bind(this))},t.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.REQUEST_RANK_BASE_INFO]=this._reqRankBaseInfo,e[t.Req_ACTOR_POWER_RANK]=this._reqActorPowerRank,e[t.Req_ACTOR_LEVEL_RANK]=this._reqActorLevelRank,e[t.Req_ARENA_RANK]=this._reqArenaRank,e[t.Req_GENERAL_COPY_RANK]=this._reqGeneralCopyRank,e[t.REQ_DESTROY_TEMPLE_RANK]=this._reqDestroyTempleRank,e[t.Req_HERO_RANK]=this._reqHeroRank,e[t.Res_Nation_Power_Rank]=this._resNationRank,e[t.Req_ACTOR_POWER_TOP_RANK]=this._reqTopRank,e[t.RES_GET_ENDLESS_RANK]=this._resEndlessRank,e[t.RES_GET_ANCIENT_RANK_INFO]=this._reAncientCorridorRank,e[t.ON_GET_DIV_POS_GET_RANK]=this._onGetDivinePosRank,td.EventUtil.registerEvents(e,this)},t.prototype.isAllRankRedPointTips=function(){if(!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Rank))return!1;for(var t in l.RankType){var e=l.RankType[t];if(e!==l.RankType.GOD_RANK&&this.isRankRedPointTips(e))return!0}return!1},t.prototype.isRankRedPointTips=function(t){return!(t!==l.RankType.GOD_RANK&&!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Rank))&&(t!==l.RankType.NATION_RANK&&(!!this._haveData[t]&&(!(t==l.RankType.DIVINE&&td.SystemManager.getServerOpenDays()<3)&&!td.Account.getUserData().getFlowerState(t))))},t.prototype.rankRedPointEvents=function(){return[td.EventNameEnum.USER_FLOWER_STATE_CHANGE,td.EventNameEnum.RANK_BASE_INFO_UPDATED]},t.prototype.isEmptyRank=function(t){return!this._haveData[t]},t.prototype.getHaveDataList=function(){return this._haveData},t.prototype.setCurRankType=function(t){this._curRankType=t},t.prototype.getCurRankType=function(){return this._curRankType},t.prototype.getRankList=function(t){return this._rankList&&this._rankList[t]?this._rankList[t].slice(0):[]},t.prototype.getMyRankInfo=function(t){return this._myRankInfo&&this._myRankInfo[t]?this._myRankInfo[t]:null},t.prototype.getFloweredCount=function(t){return this._floweredCount[t]||0},t.prototype.addFlowerdCount=function(t,e){1===t&&(this._floweredCount[this._curRankType]=this._floweredCount[this._curRankType]||0,this._floweredCount[this._curRankType]+=e),this._topRankFlowerCounts[t]=this._topRankFlowerCounts[t]||0,this._topRankFlowerCounts[t]+=e},t.prototype.getTopRankList=function(){return this._topRankList},t.prototype.getTopFloweredCount=function(t){return this._topRankFlowerCounts[t]||0},t.prototype._reqRankBaseInfo=function(){var t={};t.module=td.MsgModuleName.USER,t.cmd=td.MsgCmd.User.GET_ALL_RANKS,td.ServerDelegate.sendMessage(t)},t.prototype._resRankBaseInfo=function(t,e){t===td.NetCode.SUCCESS&&(this._haveData=e.ranksInfo,td.EventUtil.dispatchEvent(td.EventNameEnum.RANK_BASE_INFO_UPDATED))},t.prototype._reqActorPowerRank=function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.ACTOR_POWER_RANK,e.page=t||1,td.ServerDelegate.sendMessage(e)},t.prototype._resActorRankActorPower=function(t,e){this._curRankType=l.RankType.ACTOR_POWER_RANK,this._parseRankInfo(t,e)},t.prototype._reqActorLevelRank=function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.ACTOR_LEVEL_RANK,e.page=t||1,td.ServerDelegate.sendMessage(e)},t.prototype._resActorRankActorLevel=function(t,e){this._curRankType=l.RankType.ACTOR_LEVEL_RANK,this._parseRankInfo(t,e)},t.prototype._reqArenaRank=function(t){var e={};e.module=td.MsgModuleName.ARENA,e.cmd=td.MsgCmd.ARENA.ARENA_RANK,e.page=t||1,td.ServerDelegate.sendMessage(e)},t.prototype._resActorRankArenaRank=function(t,e){this._curRankType=l.RankType.ARENA_RANK,this._parseRankInfo(t,e)},t.prototype._reqGeneralCopyRank=function(t){var e={};e.module=td.MsgModuleName.PveGeneralCopy,e.cmd=td.MsgCmd.PVE_GENERAL_COPY.STORY_RANK,e.chapterType=t.chapterType||s.PVECopyDifficultType.Normal,e.page=t.page||1,td.ServerDelegate.sendMessage(e)},t.prototype._resGeneralCopyRank=function(t,e){var i=e.ranks;if(0===i.length)this._curRankType=l.RankType.STORY_RANK_NORMAL;else{var n=i[0].chapterType;n===s.PVECopyDifficultType.Normal||n===s.PVECopyDifficultType.None?this._curRankType=l.RankType.STORY_RANK_NORMAL:n===s.PVECopyDifficultType.Nightmare?this._curRankType=l.RankType.STORY_RANK_NIGHTMARE:n===s.PVECopyDifficultType.Hellish&&(this._curRankType=l.RankType.STORY_RANK_HELLISH)}this._parseRankInfo(t,e)},t.prototype._reqDestroyTempleRank=function(t){var e={};e.module=td.MsgModuleName.DESTROY_TEMPLE,e.cmd=td.MsgCmd.DESTROY_TEMPLE.DESTROY_TEMPLE_YESTERDAY_RANK,e.page=t||1,td.ServerDelegate.sendMessage(e)},t.prototype._resDestroyTempleRank=function(t,e){this._curRankType=l.RankType.DESTROY_TEMPLE_RANK,this._parseRankInfo(t,e)},t.prototype._reqHeroRank=function(t){var e={};e.module=td.MsgModuleName.LINEUP,e.cmd=td.MsgCmd.LINEUP.HERO_RANK,e.page=t||1,td.ServerDelegate.sendMessage(e)},t.prototype._resHeroRank=function(t,e){this._curRankType=l.RankType.HERO_RANK,this._parseRankInfo(t,e)},t.prototype._resEndlessRank=function(t){this._curRankType=l.RankType.ENDLESS_RANK,this._parseRankInfo(t[0],t[1])},t.prototype._reAncientCorridorRank=function(t){this._curRankType=l.RankType.ANCIENT_CORRIDOR_RANK,this._parseRankInfo(t[0],t[1])},t.prototype._onGetDivinePosRank=function(t){this._curRankType=l.RankType.DIVINE,this._parseRankInfo(t[0],t[1])},t.prototype._parseRankInfo=function(t,e){if(t===td.NetCode.SUCCESS){this._curPage=e.page,this._maxPage=e.pages,this._floweredCount[this._curRankType]=e.floweredCount||0,this._rankList[this._curRankType]=this._rankList[this._curRankType]||[];var i=this._rankList[this._curRankType],n=[].concat(e.ranks),a=this._myRankInfo[this._curRankType];a||(a=new o,this._myRankInfo[this._curRankType]=a),a.init(n.pop());var r=i.length,s=n.length;r>s&&i.splice(s,r-s);for(var l=0;l<s;l++){var c=n[l],u=i[l];u||(u=new o,i[i.length]=u),u.init(c)}td.EventUtil.dispatchEvent(td.EventNameEnum.RANK_DATA_UPDATED,this._curRankType)}},t.prototype._resNationRank=function(t){this._curRankType=l.RankType.NATION_RANK,this._rankList[this._curRankType]=t,this._myRankInfo[this._curRankType]=c.default.getInstance().getSelfRankInfo(),td.EventUtil.dispatchEvent(td.EventNameEnum.RANK_DATA_UPDATED,this._curRankType)},t.prototype._reqTopRank=function(){var t={};t.module=td.MsgModuleName.USER,t.cmd=td.MsgCmd.User.ACTOR_GOD_RANK,td.ServerDelegate.sendMessage(t)},t.prototype._parseTopRank=function(t,e){if(t===td.NetCode.SUCCESS){if(!cc.js.isEmptyObject(e.attributes)){var i={attributes:e.attributes},n=new o;n.init(i),this._topRankList=[n],this._topRankFlowerCounts[e.attributes[td.UserPropertyEnum.GamerId]]=e.attributes[td.UserPropertyEnum.GOD_FLOWER]}td.EventUtil.dispatchEvent(td.EventNameEnum.Res_ACTOR_POWER_TOP_RANK)}},t=e=n([r],t)}();i.default=u,cc._RF.pop()},{"../../Nation/Manager/NationMainManager":"NationMainManager","../Enum/RankEnum":"RankEnum",ActorRankModel:"ActorRankModel",PveCopyEnum:void 0}],RareTreasureController:[function(t,e,i){"use strict";cc._RF.push(e,"2430fEH5mtEkqS3jYDPuz1s","RareTreasureController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=window.td,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._charge=0,e._betCrystal=0,e._converted=0,e._score=0,e._isJump=!1,e._selectIndex=0,e._boxSelectIndex=0,e._isInit=!1,e._isShow=!1,e._isExchange=!1,e._canExchange=!1,e._hasNewResponse=!1,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this._charge=0,this._betCrystal=0,this._converted=0,this._score=0,this._betTimes={},this._recordsBetTimes={},this._isJump=!1,this._isInit=!1,this._isShow=!1,this._isExchange=!1,this._canExchange=!1,this._myBets=[]},e.prototype.activityParse=function(t){var e=t.record,i=t.global;this._charge=e.charge;var n=0;if(this._isInit?n=e.betCrystal-this._betCrystal:this._isInit=!0,n>0){var r=new a.BroadcastContent(368);r.setMainParam([new a.BroadcastParam(n)]),a.EventUtil.dispatchEvent(a.EventNameEnum.SHOW_BROADCAST,r)}this.isBetSuccess(i.betTimes)&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_EARETREASURE_BETS,this._myBets),this._betCrystal=e.betCrystal,this._converted=e.converted,this._score=e.score;var o=this.getActivityData(),s=a.GetTableClass(a.TableEnum.GoddessStoreTable).getMinScoreById(o);this._canExchange=this._score>=s,this._betTimes=e.betTimes;var l=a.Account.getUserData().getGamerId(),c=!1;for(var u in i.betTimes)for(var d in i.betTimes[u]){var h=i.betTimes[u][d];this._recordsBetTimes[u]||(this._recordsBetTimes[u]={}),this._recordsBetTimes[u][d]||(this._recordsBetTimes[u][d]={}),this._recordsBetTimes[u][d].term=h.term,(this._recordsBetTimes[u][d].total||0)<=h.total&&(this._recordsBetTimes[u][d].total=h.total),this._recordsBetTimes[u][d].luckNum=h.luckNum,this._recordsBetTimes[u][d].luckActor=h.luckActor,this._recordsBetTimes[u][d].luckActorBetCount=h.luckActorBetCount,this._recordsBetTimes[u][d].bearTime=h.bearTime,l===h.actorId?(this._recordsBetTimes[u][d].betInfo=h.betInfo,c=!0):this._recordsBetTimes[u][d].betInfo||(this._recordsBetTimes[u][d].betInfo=[])}var p=a.GetTableClass(a.TableEnum.GoddessBoxTable).getAllBoxByData(o);for(var u in p){var _=p[u].id;this._betTimes[_]||(this._betTimes[_]={boxId:_,betCount:0,autoBet:!1,autoBetCount:0})}for(var u in c&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_EARETREASURE_MYINFO),i.betTimes)a.EventUtil.dispatchEvent(a.EventNameEnum.RES_BOX_INFO_REFRESH,u);this.setHasNewResponse(!0)},e.prototype.hasNewResponse=function(){return this._hasNewResponse},e.prototype.setHasNewResponse=function(t){this._hasNewResponse=t},e.prototype.showRewards=function(t){var e={};e.panelName=a.PanelEnum.Window_GetReward,e.callback={func:function(t,e){e.showNum(t)},param:t},a.GlobalFunction.showPanel(e)},e.prototype.onJumpToRecharge=function(){a.EventUtil.dispatchEvent(a.EventNameEnum.CLOSE_EARETREASURE_GET_WINDOW),this._isJump=!0},e.prototype.isFromRecharge=function(){var t=this._isJump;return this._isJump=!1,t},e.prototype.getCharge=function(){return this._charge},e.prototype.openPanel=function(){this._isShow=!0,a.EventUtil.dispatchEvent(a.EventNameEnum.EARETREASURE_OPEN)},e.prototype.openWindow=function(){this._isExchange=!0,a.EventUtil.dispatchEvent(a.EventNameEnum.EARETREASURE_OPEN)},e.prototype.getBetCrystal=function(){return this._betCrystal},e.prototype.getConverted=function(){return this._converted},e.prototype.getScore=function(){return this._score},e.prototype.getBetTimes=function(){return this._betTimes},e.prototype.getBetList=function(){var t=[];for(var e in this._betTimes)t.push(this._betTimes[e]);return t},e.prototype.getBetBoxById=function(t){return this._betTimes[t]||null},e.prototype.getBetDataBySelect=function(){return this.getBetList()[this._selectIndex]},e.prototype.getRecordsBetTimes=function(){return this._recordsBetTimes},e.prototype.getSelectIndex=function(){return this._selectIndex},e.prototype.setSelectIndex=function(t){this._selectIndex=t},e.prototype.getBoxSelectIndex=function(){return this._boxSelectIndex},e.prototype.setBoxSelectIndex=function(t){this._boxSelectIndex=t},e.prototype.getPresentDataById=function(t){if(!this._recordsBetTimes[t])return null;var e;for(var i in this._recordsBetTimes[t])e||(e=this._recordsBetTimes[t][i]),this._recordsBetTimes[t][i].term>e.term&&(e=this._recordsBetTimes[t][i]);return e},e.prototype.getTotalBetById=function(t){var e=this.getPresentDataById(t);return e?e.total:0},e.prototype.getTermBetById=function(t){var e=this.getPresentDataById(t);return e?e.term:1},e.prototype.getMyWinRecords=function(){var t=[],e=a.Account.getUserData().getGamerId();for(var i in this._recordsBetTimes){var n=this._recordsBetTimes[i];for(var r in n)n[r].luckActor[a.UserPropertyEnum.GamerId]===e&&(n[r].boxId=i,t.push(n[r]))}return t.sort(this.sortFun),t},e.prototype.sortFun=function(t,e){return t.term!==e.term?e.term-t.term:t.id-e.id},e.prototype.getNoticeList=function(){var t=[],e=this.getActivityData();for(var i in this._recordsBetTimes)if(this._recordsBetTimes.hasOwnProperty(i)){var n=this._recordsBetTimes[i];for(var r in n)if(n.hasOwnProperty(r)){var o=n[r],s=o.luckActor;if(!s||o.luckNum<=0)continue;var l=a.GetTableClass(a.TableEnum.GoddessBoxTable).getDataByDataAndId(e,Number(i)),c={server:s[4],playerName:s[6],num:o.luckActorBetCount,phase:o.term,luckNum:o.luckNum,reward:l.rewards[0],bearTime:o.bearTime};t.push(c)}}return t.sort(function(t,e){return e.bearTime-t.bearTime}),t.length>10?t.slice(0,10):t},e.prototype.getAutoInputList=function(){for(var t=[],e=0;e<5;e++){var i={isAuto:e%2==0,inputNum:e+10,rewardId:[11,20010,1]};t.push(i)}return t},e.prototype.isBetSuccess=function(t){var e=a.Account.getUserData().getGamerId();this._myBets=[];var i=this.getActivityData(),n=a.GetTableClass(a.TableEnum.GoddessBoxTable).getAllBoxByData(i);for(var r in n){var o=n[r].id;for(var s in this._recordsBetTimes[o])if(t[o]&&t[o][s]&&t[o][s].actorId===e&&this._recordsBetTimes[o][s]&&t[o][s].betInfo&&this._recordsBetTimes[o][s].betInfo.length<t[o][s].betInfo.length){for(var l=this._recordsBetTimes[o][s].betInfo,c=t[o][s].betInfo,u=0;u<c.length;u++)-1===l.indexOf(c[u])&&this._myBets.push(c[u]);return!0}}return!1},e.prototype.hasRedPoint=function(){return!0},e.prototype.redPointTip=function(){return this.isRedPointTip()},e.prototype.isRedPointTip=function(){return!!this.isTaskRedPoint()||(!!this.isShopPoint()||(this._betCrystal>0||!this._isShow))},e.prototype.isShopPoint=function(){return!(this._isExchange||!this._canExchange)},e.prototype.isTaskRedPoint=function(){if(this.isInSleepStatus())return!1;var t=a.GetConfig("GODDESS_TREASURE_GOODS_UNIT")[0][0];if(Math.floor((this._charge-this._converted)/t)>0)return!0;for(var e=a.TaskManager.getShowListByType(a.TaskType.GODDESS,[a.TaskStatus.UNOPENED,a.TaskStatus.NONE]),i=0;i<e.length;i++)if(e[i].getStatus()===a.TaskStatus.Finish)return!0;return!1},e.prototype.redPointEvts=function(){return[a.EventNameEnum.Recharge_Success,a.EventNameEnum.Res_GET_TASK_INFO,a.EventNameEnum.Res_GET_ACTIVITY_INFO,a.EventNameEnum.EARETREASURE_OPEN]},e}(t("ActivityBaseController"));e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],RareTreasureEnums:[function(t,e,i){"use strict";cc._RF.push(e,"9dc81Qg+xdPdYr8gO/wAtWV","RareTreasureEnums"),Object.defineProperty(i,"__esModule",{value:!0}),i.MY_RECORD_LAYERS=void 0;window.td;(function(t){t[t.MY_NUMS=1]="MY_NUMS",t[t.BUY_RECORDS=2]="BUY_RECORDS",t[t.WIN_RECORDS=3]="WIN_RECORDS"})(i.MY_RECORD_LAYERS||(i.MY_RECORD_LAYERS={})),cc._RF.pop()},{}],RareTreasureItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"66762ylPctLx4d4FFvyZk0B","RareTreasureItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("ListItem"),d=t("CommonIconWidget"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.progress=null,e.labProgress=null,e.imgSelect=null,e.img=null,e.nodeItem=null,e._itemIndex=0,e._curItemData=null,e}return n(e,t),e.prototype.onEnable=function(){this._addEventListners()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListners=function(){var t={};t[r.EventNameEnum.RES_BOX_INFO_REFRESH]=this._refreshItem,t[r.EventNameEnum.EARETREASURE_SELECT_REWARD_ITEM]=this._setSelect,r.EventUtil.registerEvents(t,this)},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._itemIndex=e,this._curItemData=i,this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10);var n=this._controller.getTotalBetById(i.boxId),a=this._controller.getActivityData(),o=r.GetTableClass(r.TableEnum.GoddessBoxTable).getDataByDataAndId(a,i.boxId),s=i.betCount>0;this._controller.isInSleepStatus()&&(n=0,s=!1),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Acitivty_36_cemb,s?"HD_wz_qucanyu02":"HD_wz_qucanyu",this.img),this.progress.progress=n/o.needCount,this.labProgress.string=n+"/"+o.needCount;var l=r.RewardManager.getRewardDetail(o.rewards[0]),c=this.nodeItem.getChildByName("iconItem");c||((c=r.GlobalFunction.createCommonIconWidget(27,l)).name="iconItem",c.parent=this.nodeItem);var u=c.getComponent(d);u.setTouchEnabled(!1),u.setData(l),this._setSelect()},e.prototype._setSelect=function(){var t=this._controller.getSelectIndex();this.imgSelect.active=t===this._itemIndex},e.prototype.onItemClick=function(){this._controller.setSelectIndex(this._itemIndex),r.EventUtil.dispatchEvent(r.EventNameEnum.EARETREASURE_SELECT_REWARD_ITEM)},e.prototype._refreshItem=function(){var t=this._controller.getBetBoxById(this._curItemData.boxId);t&&this.updateItem(this._itemIndex,t)},a([l(cc.ProgressBar)],e.prototype,"progress",void 0),a([l(cc.Label)],e.prototype,"labProgress",void 0),a([l(cc.Node)],e.prototype,"imgSelect",void 0),a([l(cc.Node)],e.prototype,"img",void 0),a([l(cc.Node)],e.prototype,"nodeItem",void 0),e=a([s,c("module/Activity/RareTreasure/RareTreasureItemUI")],e)}(u);i.default=h,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],RareTreasurePanel:[function(t,e,i){"use strict";cc._RF.push(e,"4ba6fgTlpdHIacx2U+QPzQv","RareTreasurePanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("ActivityBasePanel"),d=t("OptimizeHorizontalListView"),h=t("OptimizeVerticalListView"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTime=null,e.labEndTime=null,e.labCrystal=null,e.labPhase=null,e.labFanli=null,e.labDesc1=null,e.labDesc2=null,e.nodeItem=null,e.labProgress=null,e.labMyInput=null,e.labMyInputTxt=null,e.labTips=null,e.progress=null,e.scrollView=null,e.noticeScrollView=null,e.nodeAni=null,e.btn_task=null,e.btn_shop=null,e.btnInput=null,e.btnAuto=null,e._curPhase=0,e._isInit=!1,e}return n(e,t),e.prototype.onEnable=function(){if(t.prototype.onEnable.call(this),this._isInit=!1,this._noticeListView||(this._noticeListView=this.noticeScrollView.getComponent(h)),this._addEventListeners(),this._initPanel(),this._refreshPanel(),this._addAniNode(),this._controller.isFromRecharge()&&this.onGetCrystalClick(),this._controller.openPanel(),r.RedPointUtil.createRedPointOld(this.btn_shop,cc.v2(-10,-10),this._controller.isShopPoint.bind(this._controller),this._controller.redPointEvts()),this._controller.isInSleepStatus()){r.GlobalFunction.setButtonGray(this.btnInput,!0),r.GlobalFunction.setButtonGray(this.btnAuto,!0),r.GlobalFunction.setButtonGray(this.btn_task,!0),this.labTips.node.active=!0,this.labMyInput.node.active=!1,this.labMyInputTxt.node.active=!1;var e=this.btn_task.getChildByName("redPoint");e&&(e.active=!1)}else r.GlobalFunction.setButtonGray(this.btnInput,!1),r.GlobalFunction.setButtonGray(this.btnAuto,!1),r.GlobalFunction.setButtonGray(this.btn_task,!1),this.labTips.node.active=!1,this.labMyInput.node.active=!0,this.labMyInputTxt.node.active=!0,r.RedPointUtil.createRedPointOld(this.btn_task,cc.v2(-10,-10),this._controller.isTaskRedPoint.bind(this._controller),this._controller.redPointEvts());gdk.Timer.loop(2e3,this,this.updateSchdule)},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this),gdk.Timer.clearAll(this)},e.prototype._addEventListeners=function(){var t={},e=r.EventNameEnum;t[e.Res_GET_ACTIVITY_INFO]=this._refreshInfo,t[r.EventNameEnum.EARETREASURE_SELECT_REWARD_ITEM]=this._refreshPanel,t[e.RES_EARETREASURE_BETS]=this._showRewards,t[e.RES_EARETREASURE_MYINFO]=this._resInfo,r.EventUtil.registerEvents(t,this)},e.prototype.updateSchdule=function(t){var e=this;if(this._controller&&this._controller.hasNewResponse()){this._controller.setHasNewResponse(!1);var i=this._controller.getNoticeList();this._isInit?this._noticeListView.refreshCurList(i):gdk.Timer.once(200,this,function(){e._isInit=!0,e._noticeListView.setData(i)})}},e.prototype._addAniNode=function(){var t=r.GlobalFunction.getResIdByNode(this.node);gdk.rm.loadRes(t,"uiAnima/ChangEMiBao/ChangEMiBao",cc.Prefab,this._playAni.bind(this,this.nodeAni))},e.prototype._playAni=function(t){if(cc.isValid(t)&&!t.getChildByName("ChangEMiBao")){var e=gdk.rm.getResByUrl("uiAnima/ChangEMiBao/ChangEMiBao",cc.Prefab),i=cc.instantiate(e);i.name="ChangEMiBao",t.addChild(i,1)}},e.prototype._resInfo=function(t){t===this._controller.getActivityId()&&this._initPanel()},e.prototype._refreshInfo=function(){var t=this._controller.getBetDataBySelect();this.labCrystal.string=this._controller.getBetCrystal()+"";var e=this._controller.getTotalBetById(t.boxId),i=this._controller.getActivityData(),n=r.GetTableClass(r.TableEnum.GoddessBoxTable).getDataByDataAndId(i,t.boxId);this.labPhase.string=this._controller.getTermBetById(t.boxId)+"",this.labFanli.string=n.rebateShow,this._controller.isInSleepStatus()&&(e=0),this.labDesc1.string=cc.js.formatStr(r.Language.RareTreasureDes1,n.needCount-e+""),this.labProgress.string=e+"/"+n.needCount,this.progress.progress=e/n.needCount,this.labMyInput.string=t.betCount+""},e.prototype._initPanel=function(){var t=this,e=this.getOpenStr();this.labTime.string=e,this.labEndTime.string=this.getSleepTimeStr();var i=Number(r.GetConfig("GODDESS_REWARD_SCORE"));this.labDesc2.string=cc.js.formatStr(r.Language.RareTreasureDes2,i+"");var n=this._controller.getBetList(),a=this.scrollView.getComponent(d),o=this._controller.getNoticeList();this._isInit?a.refreshCurList(n):(gdk.Timer.once(100,this,function(){a.setData(n)}),gdk.Timer.once(200,this,function(){t._isInit=!0,t._noticeListView.setData(o)}));var s=this._controller.getBetDataBySelect();this.labCrystal.string=this._controller.getBetCrystal()+"";var l=this._controller.getTotalBetById(s.boxId),c=this._controller.getActivityData(),u=r.GetTableClass(r.TableEnum.GoddessBoxTable).getDataByDataAndId(c,s.boxId);this.labPhase.string=this._controller.getTermBetById(s.boxId)+"",this.labFanli.string=u.rebateShow,this._controller.isInSleepStatus()&&(l=0),this.labDesc1.string=cc.js.formatStr(r.Language.RareTreasureDes1,u.needCount-l+""),this.labProgress.string=l+"/"+u.needCount,this.progress.progress=l/u.needCount,this.labMyInput.string=s.betCount+""},e.prototype._refreshPanel=function(){var t=this._controller.getBetDataBySelect();this.labCrystal.string=this._controller.getBetCrystal()+"";var e=this._controller.getTotalBetById(t.boxId),i=this._controller.getActivityData(),n=r.GetTableClass(r.TableEnum.GoddessBoxTable).getDataByDataAndId(i,t.boxId);this.labPhase.string=this._controller.getTermBetById(t.boxId)+"",this.labFanli.string=n.rebateShow,this._controller.isInSleepStatus()&&(e=0),this.labDesc1.string=cc.js.formatStr(r.Language.RareTreasureDes1,n.needCount-e+""),this.labProgress.string=e+"/"+n.needCount,this.progress.progress=e/n.needCount,this.labMyInput.string=t.betCount+"";var a=r.RewardManager.getRewardDetail(n.rewards[0]),o=this.nodeItem.getChildByName("iconItem");o||((o=r.GlobalFunction.createCommonIconWidget(35,a)).name="iconItem",o.parent=this.nodeItem),o.getComponent("CommonIconWidget").setData(a)},e.prototype.onGetCrystalClick=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_RareTreasureCrystalGet)},e.prototype.onShopClick=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_RareTreasureShop)},e.prototype.onMyRecordClick=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_RareTreasureMyRecords)},e.prototype.onRewardRecordClick=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_RareTreasurePresiouRecords)},e.prototype.onInputClick=function(){var t=this._controller.getBetDataBySelect().boxId,e=this._controller.getPresentDataById(t),i=0;e&&e.betInfo&&(i=e.betInfo.length);var n=this._controller.getActivityData(),a=r.GetTableClass(r.TableEnum.GoddessBoxTable).getDataByDataAndId(n,t),o=r.GetConfig("GODDESS_BET_TIMES_RATE")/1e4;if(i<Math.floor(a.needCount*o))r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_RareTreasureInput);else{var s=new r.BroadcastContent(371);r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,s)}},e.prototype.onAutoInputClick=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_RareTreasureAutoInput)},e.prototype._showRewards=function(t){var e=r.PanelManager.getInstance().getCurShowNoneLayer();e&&e.getPanelEnum()===r.PanelEnum.Window_GetReward||this._controller.showRewards(t)},a([l(cc.Label)],e.prototype,"labTime",void 0),a([l(cc.Label)],e.prototype,"labEndTime",void 0),a([l(cc.Label)],e.prototype,"labCrystal",void 0),a([l(cc.Label)],e.prototype,"labPhase",void 0),a([l(cc.Label)],e.prototype,"labFanli",void 0),a([l(cc.Label)],e.prototype,"labDesc1",void 0),a([l(cc.Label)],e.prototype,"labDesc2",void 0),a([l(cc.Node)],e.prototype,"nodeItem",void 0),a([l(cc.Label)],e.prototype,"labProgress",void 0),a([l(cc.Label)],e.prototype,"labMyInput",void 0),a([l(cc.Label)],e.prototype,"labMyInputTxt",void 0),a([l(cc.Label)],e.prototype,"labTips",void 0),a([l(cc.ProgressBar)],e.prototype,"progress",void 0),a([l(cc.Node)],e.prototype,"scrollView",void 0),a([l(cc.Node)],e.prototype,"noticeScrollView",void 0),a([l(cc.Node)],e.prototype,"nodeAni",void 0),a([l(cc.Node)],e.prototype,"btn_task",void 0),a([l(cc.Node)],e.prototype,"btn_shop",void 0),a([l(cc.Node)],e.prototype,"btnInput",void 0),a([l(cc.Node)],e.prototype,"btnAuto",void 0),e=a([s,c("module/Activity/RareTreasure/RareTreasurePanel")],e)}(u);i.default=p,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeHorizontalListView:void 0,OptimizeVerticalListView:void 0}],RareTreasurePhaseBoxItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"027faO9zj5Hn4YAuRsyiU6A","RareTreasurePhaseBoxItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("ListItem"),d=t("CommonIconWidget"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labPhase=null,e.nodeItem=null,e.imgSelect=null,e}return n(e,t),e.prototype.onEnable=function(){this._addEventListners()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListners=function(){var t={};t[r.EventNameEnum.RES_EARETREASURE_SELECT_PHASE_BOX]=this._setSelect,r.EventUtil.registerEvents(t,this)},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._index=e;var n=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10).getTermBetById(i.id);this.labPhase.string=cc.js.formatStr("%s",r.Language.term,n);var a=r.RewardManager.getRewardDetail(i.rewards[0]),o=r.GlobalFunction.createCommonIconWidget(26,a);this.nodeItem.removeAllChildren(),this.nodeItem.addChild(o),o.getComponent(d).setTouchEnabled(!1),this._setSelect()},e.prototype._setSelect=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10).getBoxSelectIndex();this.imgSelect.active=this._index===t},e.prototype.onItemClick=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10).getBoxSelectIndex();this._index!==t&&r.EventUtil.dispatchEvent(r.EventNameEnum.EARETREASURE_SELECT_PHASE_BOX,this._index)},a([l(cc.Label)],e.prototype,"labPhase",void 0),a([l(cc.Node)],e.prototype,"nodeItem",void 0),a([l(cc.Node)],e.prototype,"imgSelect",void 0),e=a([s,c("module/Activity/RareTreasure/RareTreasurePhaseBoxItemUI")],e)}(u);i.default=h,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],RareTreasureShopItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"01912js9RVO544XAZ9Ezn9b","RareTreasureShopItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labPrice=null,e.nodeItem=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this.labPrice.string=r.Language.score+":"+i.score,this._price=i.score,this._itemId=i.id;var n=i.rewards[0],a=r.RewardManager.getRewardDetail(n);this._itemData=a;var o=r.GlobalFunction.createCommonIconWidget(27,a);this.nodeItem.removeAllChildren(),this.nodeItem.addChild(o)},e.prototype.onBuyClick=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10),e=t.getScore();if(e<this._price){var i=new r.BroadcastContent(365);r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,i)}else{this._maxNum=Math.floor(e/this._price);var n={};n.okCallFunc=this.onSendBuyRequest.bind(this),n.consumeModel=null,n.buyProductModel=cc.instantiate(this._itemData),n.maxNum=this._maxNum,n.singlePrice=this._price,n.windowTitle="\u8d2d\u4e70",n.btnTitle="\u8d2d\u4e70",n.isNoItem=!0;var a={name:"\u79ef\u5206"};a.count=t.getScore(),n.extraParam=a,r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_ActivityBuy,n)}},e.prototype.onSendBuyRequest=function(t){var e=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10),i={};i.id=this._itemId,i.parmeterMap={6:t,17:4},e.operateActivity(i)},a([l(cc.Label)],e.prototype,"labPrice",void 0),a([l(cc.Node)],e.prototype,"nodeItem",void 0),e=a([s,c("module/Activity/RareTreasure/RareTreasureShopItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],RareTreasureShopWindow:[function(t,e,i){"use strict";cc._RF.push(e,"0d14aAs7TBHAZWGdP1uqCAp","RareTreasureShopWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labCrystal=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_RareTreasureShop},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListners()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListners=function(){var t={};t[r.EventNameEnum.Res_GET_ACTIVITY_INFO]=this.refreshScore,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(){this._initWindow(),this.refreshScore()},e.prototype._initWindow=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10);t.openWindow();var e=t.getActivityData(),i=r.GetTableClass(r.TableEnum.GoddessStoreTable).getBuyListConfigById(e);this.node.getComponent(d).setData(i)},e.prototype.refreshScore=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10);this.labCrystal.string=t.getScore()},a([l(cc.Label)],e.prototype,"labCrystal",void 0),e=a([s,c("module/Activity/RareTreasure/RareTreasureShopWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],RechargeBaseController:[function(t,e,i){"use strict";cc._RF.push(e,"cc316urQN5BcZbJquIn6oNx","RechargeBaseController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_receivedTimesIdMap:null,_receivedTimesMoneyMap:null,_datas:null,_nTotalRecharge:null},initData:function(t){this._super(t),this._datas=[],this._nTotalRecharge=0,this._receivedTimesIdMap={},this._receivedTimesMoneyMap={}},destroyData:function(){this._super()},addLocalEventListener:function(){this._super(),td.EventUtil.registerEvent(td.EventNameEnum.Recharge_Success,this._onRechargeSuccess,this)},removeAllListeners:function(){this._super(),td.EventUtil.unregisterAllEvents(this)},_onRechargeSuccess:function(t){if(this.isInOpenStatus()&&t){var e=t._costValue;"number"!=typeof e&&(e=t._costValue/10),1!==e&&this.onChargeAmount(e)}},onChargeAmount:function(t){var e=Math.floor(t/10);this._receivedTimesMoneyMap[e]?this._receivedTimesMoneyMap[e]++:this._receivedTimesMoneyMap[e]=1},getDatas:function(){return this._datas},getRechargeTimesByMoney:function(t){return this._receivedTimesMoneyMap[t]},getTotalRechargeMoney:function(){return!this._nTotalRecharge||this._nTotalRecharge<0?0:this._nTotalRecharge/10},getDataById:function(t){for(var e=0;e<this._datas.length;e++)if(this._datas[e].getId()===t)return this._datas[e]},activityParse:function(t){t&&(this._receivedTimesIdMap={},this._receivedTimesMoneyMap={},this.parseQueryInfo(t.record),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_RECHARGEBASE_INFO,t.activityId))},parseQueryInfo:function(t){},onIdReceived:function(t){this._receivedTimesIdMap[t]?this._receivedTimesIdMap[t]++:this._receivedTimesIdMap[t]=1},getIdReceivedTimes:function(t){return this._receivedTimesIdMap[t]||0},isRedPointTip:function(){}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],RechargeBaseItem:[function(t,e,i){"use strict";cc._RF.push(e,"3ee1b4DFYhMGp8+IznF8SMX","RechargeBaseItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{},updateItem:function(t,e){this._controller=this._customData.controller,this._receiveCallBack=this._customData.receiveFunc,this._super(t,e);var i=this.node.getChildByName("rewardsPanel"),n=e.getRewards();n||(n=[]);i.removeAllChildren();for(var a=td.RewardManager.parseRewardListDetail(n),r=a.length,o=0;o<r;o++){var s=a[o];(p=td.GlobalFunction.createCommonIconWidget(56,s)).setScale(.7),i.addChild(p)}var l=e.getOptionalRewards?e.getOptionalRewards():[];if(l.length>0){for(var c=[],u=(o=0,l.length);o<u;o++){var d=l[o][1];c=c.concat(td.RewardManager.parseRewardListDetail(d))}if(r>0){var h=new cc.Node;h.addComponent(cc.Sprite),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_gy,"HD_jiahao",h),i.addChild(h)}for(o=0,u=c.length;o<u;o++){var p;s=c[o];if((p=td.GlobalFunction.createCommonIconWidget(56,s)).setScale(.7),i.addChild(p),o!==u-1){var _=new cc.Node;_.addComponent(cc.Sprite),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_gy,"HD_huozi",_),i.addChild(_)}}}},onOperateItem:function(t,e){var i=e,n=i.getReceiveStatus();n===td.ActivityEnum.OperateStatus.NotOperateAble?this.doRechargeAction():n===td.ActivityEnum.OperateStatus.OperateAble&&this.doReceiveAction(i)},setLeftTimes:function(t,e){var i=e.getLeftTimes();i=i<0?0:i;var n=e.getTotalTimes();this.node.getChildByName("labProgress").getComponent(cc.Label).string=cc.js.formatStr(td.Language.leftTimes+"%s/%s",i,n)},setItemProcess:function(t,e){var i=this._controller.getTotalRechargeMoney();this.node.getChildByName("labProgress").getComponent(cc.Label).string=cc.js.formatStr(td.Language.progressPattern,i,e.getMoney())},setItemBtn:function(t,e){gdk.rm.getResByUrl(td.resDef.pngPlist.GY_Button,cc.SpriteAtlas);var i=this.node.getChildByName("btnOperation"),n=i.getChildByName("Label"),a=this.node.getChildByName("imgReceived"),r=e.getReceiveStatus();i.active=r!==td.ActivityEnum.OperateStatus.Operated,a.active=r===td.ActivityEnum.OperateStatus.Operated,r===td.ActivityEnum.OperateStatus.NotOperateAble?(td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_anniu_02",i),n.getComponent(cc.Label).string=td.Language.recharge,n.color=cc.color(176,79,0)):r===td.ActivityEnum.OperateStatus.OperateAble&&(td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY_Common,"GY_anniu_03",i),n.getComponent(cc.Label).string=td.Language.missionBtnTitle.split("|")[0],n.color=cc.color(16,98,106)),td.RedPointUtil.createRedPointSimple(i,{x:-10,y:-10},r===td.ActivityEnum.OperateStatus.OperateAble)},_goToRecharge:function(){var t=this._controller.getActivityType(),e=td.ActivityEnum.Activity.ActivityConfig;t>=td.ActivityEnum.CrossActivityStartType&&t<td.ActivityEnum.NewConfigActivityStartType&&(e=td.ActivityEnum.Activity.ActivityCross),td.GlobalFunction.inActivityGotoRecharge([e,t])},doRechargeAction:function(){this._goToRecharge()},doReceiveAction:function(t){this._receiveCallBack&&"function"==typeof this._receiveCallBack&&this._receiveCallBack(t)}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],RechargeBaseModel:[function(t,e,i){"use strict";cc._RF.push(e,"06a72MT3wVL6a8gtT66xdRZ","RechargeBaseModel");var n=cc.Class({properties:{_nId:null,_chargeId:null,_nMoney:null,_rewards:null,_totalTimes:null,_optionalRewards:null,_belongActivityId:null},initData:function(t,e){this._nId=t.id,this._nMoney=t.charge,this._chargeId=t.chargeId,this._rewards=t.rewards,this._optionalRewards=t.optionalRewards||[],this._totalTimes=t.times||0,this._belongActivityId=e},getId:function(){return this._nId},getMoney:function(){return this._nMoney/10},getRechargeId:function(){return this._chargeId},getRewards:function(){return this._rewards},getOptionalRewards:function(){return this._optionalRewards},getTotalTimes:function(){return this._totalTimes},getReceiveStatus:function(){},isReceived:function(){return this.getLeftTimes()<=0},getLeftTimes:function(){return this.getTotalTimes()-this.getReceivedTimes()},getReceivedTimes:function(){var t=td.ActivityDataManager.getActivityControllerById(this._belongActivityId);return t?t.getIdReceivedTimes(this.getId()):0}});e.exports=n,cc._RF.pop()},{}],RechargeBasePanel:[function(t,e,i){"use strict";cc._RF.push(e,"e3574QfgVRNfJqId0xSa0Gd","RechargeBasePanel");var n=t("ActivityBasePanel"),a=(t("ListViewComponent"),cc.Class({extends:n,properties:{_listView:null},initData:function(t){this._super(t)},onLoad:function(){this._listView=null},onEnable:function(){this._super(),this._addLocalListeners(),this._firstEnter=!0,this._refreshListView(),this.setActivityBaseInfo()},onDisable:function(){this._super(),this._removeAllListeners()},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.Recharge_Success]=this._refreshListView,i[e.RES_RECHARGEBASE_INFO]=this._resInfo,t.registerEvents(i,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},setActivityBaseInfo:function(){this.setActivityTime(),this.setActivityDesc(),this.setImgHero(),this.setActivityTitle()},setActivityTime:function(){var t=this.getDurationStr();this.node.getChildByName("titleWidget").getChildByName("labActivityTime").getComponent(cc.Label).string=t},setActivityDesc:function(){},setImgHero:function(){},setActivityTitle:function(){},_resInfo:function(t){t===this.getActivityId()&&this._refreshListView()},_refreshListView:function(){var t=this.getActivityController();if(t){var e=t.getDatas(),i=!t.isSortStatus||t.isSortStatus(),n=td.ActivityEnum.OperateStatus;e.sort(function(t,e){if(i){var a=t.getReceiveStatus(),r=e.getReceiveStatus();return r===n.OperateAble&&a!==n.OperateAble?1:r!==n.OperateAble&&a===n.OperateAble?-1:a===n.NotOperateAble&&r!==n.NotOperateAble?-1:r===n.NotOperateAble&&a!=n.NotOperateAble?1:a===n.Operated&&r!==n.Operated?1:r===n.Operated&&a!=n.Operated?-1:a===n.Tempd&&r!==n.Tempd?1:r===n.Tempd&&a!=n.Tempd?-1:t.getId()-e.getId()}return t.getId()-e.getId()});var a={dataList:e,controller:t,receiveFunc:this.doReceiveAction.bind(this)};this._listView&&(this._listView.setCustomData(a),this._firstEnter?this._listView.setData(e):this._listView.refreshCurList(e),this._firstEnter=!1);for(var r=0,o=(n=td.ActivityEnum.OperateStatus,0),s=e.length;o<s;o++){if(e[o].getReceiveStatus()!==n.Operated){r=o;break}}r&&this._listView.scrollToRow(r)}},doReceiveAction:function(t){},onReceiveQueryInfo:function(t){},onReceiveOperation:function(t){this._super(t)}}));e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",ListViewComponent:void 0}],RechargeController:[function(t,e,i){"use strict";cc._RF.push(e,"ddd93RtegVBKbxk3e2LIW8o","RechargeController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this.addNetListener(),this.addEventListener()},destroyData:function(){this._super()},addNetListener:function(){td.MsgModuleName.ExtensionCmd,td.MsgCmd.ExtensionCmd,td.ServerDelegate},addEventListener:function(){td.EventNameEnum;td.EventUtil.registerEvents({},this)}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],RechargeListView:[function(t,e,i){"use strict";cc._RF.push(e,"b2432ycHr9FWYCe/PFwHBsV","RechargeListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{_rechargeAltas:null},setData:function(t){var e=t.dataList;this._rechargeAltas=t.rechargeAltas,this._super(e)},setItemView:function(t,e){var i=t.getChildByName("imgBg"),n=t.getChildByName("labTitle"),a=t.getChildByName("labCost"),r=t.getChildByName("discountNode"),o=r.getChildByName("labDiscount"),s=e.getIconRes();s=this._rechargeAltas.getSpriteFrame(s),td.GlobalFunction.createSpriteNode(i,s),n.getComponent(cc.Label).string=td.Language.diamond+"X"+e.getGoodsNum(),td.isFanti()?a.getComponent(cc.Label).string="$ "+e.getCostValue()/100:a.getComponent(cc.Label).string="\xa5 "+cc.js.formatStr(td.Language.rechargeCount,Math.floor(e.getCostValue()/10)),r.active=e.showFirstGift(),o.getComponent(cc.Label).string=td.Language.sendGift+e.getFirstRewardNum();var l=t.getComponent(cc.Button);l.clickEvents=[];var c=new cc.Component.EventHandler;return c.target=this.node,c.component="RechargeListView",c.handler="tryRecharge",c.customEventData=e,l.clickEvents.push(c),t},tryRecharge:function(t,e){td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,e)}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],RechargeManager:[function(t,e,i){"use strict";cc._RF.push(e,"eb59aekzXtInLNX37Xj2MbT","RechargeManager");var n=t("../../../SDK/SDKCommonEnum"),a=t("RechargeModel"),r=t("UFSdkManager");td.RechargeManager={_rechargeList:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._rechargeList={}},_addListener:function(){var t=td.MsgModuleName.USER,e=td.MsgCmd.User;td.ServerDelegate.registerMessage(t,e.ACTOR_GET_CHARGE,this._parseRechargeInfo.bind(this)),td.ServerDelegate.registerMessage(t,e.PUSH_ACTOR_CHARGE,this._parsePushRechargeInfo.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQUEST_RECHARGE_INFO]=this._requestRechargeInfo,i[e.REQUEST_RECHARGE]=this.buy,t.registerEvents(i,this)},getShowData:function(){var t=[],e=this._rechargeList;for(var i in e){var n=e[i];if(n.isVisible()){if(n.getType()===td.RechargeTypeEnum.LifeTimeCard&&n.getTimes()>0)continue;t[t.length]=n}}return t.sort(function(t,e){return t.getOrderId()-e.getOrderId()}),t},getRechargeDataById:function(t){return this._rechargeList&&this._rechargeList[t]?this._rechargeList[t]:null},getRechargeDataByType:function(t){if(!this._rechargeList)return null;for(var e in this._rechargeList){var i=this._rechargeList[e];if(i.getType()===t)return i}return null},getCustomRechargeDataByNum:function(t,e){if(!this._rechargeList)return null;var i=e||td.RechargeTypeEnum.Custom;for(var n in this._rechargeList){var a=this._rechargeList[n];if(a.getType()===i&&a.getCostValue()===t)return a}return null},_requestRechargeInfo:function(){var t={};t.module=td.MsgModuleName.USER,t.cmd=td.MsgCmd.User.ACTOR_GET_CHARGE,td.ServerDelegate.sendMessage(t)},_parsePushRechargeInfo:function(t,e){t===td.NetCode.SUCCESS&&this._parseRechargeInfo(t,e)},_parseRechargeInfo:function(t,e){if(t===td.NetCode.SUCCESS){0===this._rechargeList.myLen()&&this._createRechargeList();for(var i=e.charges,n=0,a=i.length-1;n<=a;n++){var r=i[n],o=this.getRechargeDataById(r.chargeId);o&&o.setTimes(r.times)}if(0!==e.chargeOrderMap.myLen()){var s=e.chargeOrderMap,l=[];for(var c in s){var u=this.getRechargeDataById(s[c]);td.DataReporter.payRequest(u,c),gdk.Timer.once(1e3,this,function(){td.DataReporter.pay(u,c)}),l[l.length]=c}this._responseRechargeSuccess(l),td.EventUtil.dispatchEvent(td.EventNameEnum.Recharge_Success,this.getRechargeDataById(i[0].chargeId)),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_RECHARGE_DATA);var d=new td.BroadcastContent(107);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,d),td.EventUtil.dispatchEvent(td.EventNameEnum.REPORT_USER_DEVICE_INFO,2),this._checkPointReport(i[0].chargeId)}}},_checkPointReport:function(t){var e="",i="";(t==td.RECHARGE_ID.MONTH_CARD?(e=td.LocalRealKey.FIRST_MONTH_CARD,i=n.CHECK_POINT_TYPE.FIRST_MONTH_CARD):t==td.RECHARGE_ID.LIFE_CARD&&(e=td.LocalRealKey.FIRST_MONTH_HIGH_CARD,i=n.CHECK_POINT_TYPE.FIRST_MONTH_HIGH_CARD),e&&i)&&(td.LocalStorageUtil.readRealLocal(e)||(td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_POINT_REPORT,n.CHECK_POINT_TYPE.FIRST_RECEIVE_FIRST_RECHARGE),td.LocalStorageUtil.writeRealLocal(e,!0)))},_responseRechargeSuccess:function(t){var e={};e.module=td.MsgModuleName.USER,e.cmd=td.MsgCmd.User.ACTOR_READ_CHARGE_ORDER,e.orderIds=t,td.ServerDelegate.sendMessage(e)},_createRechargeList:function(){var t=td.GetTableClass(td.TableEnum.ChargeCommodityConfig).getAllRechargeData();this._rechargeList={};var e=this._rechargeList;for(var i in t){var n=t[i],r=new a;r.init(n),e[i]=r}},buy:function(t){if(td.GlobalFunction.checkCanClicked())if(isPayOpen){var e={chargeId:t.getChargeId(),itemId:t.getChargeId(),costValue:t.getCostValue(),itemName:t.getItemName(),userName:td.Account.getUserData().nickName,userId:td.Account.getUserData().userId,serverName:UFServerManager.getInstance().getSelectServerData().serverName,shopItemId:t.getItemId(),zoneId:t.getZoneId(),des:t.getDes(),count:1,ip:td.GameRoleInfo.ip,roleName:td.Account.getUserData().nickName,level:td.Account.getUserData().level};DX_CHANNEL===SdkType.QQ_GAME&&(e.channelIcon=t.getChannelIcon());var i=td.Account.getUserData().getGamerId(),n=UFServerManager.getInstance().getSelectServerData().serverId,a=this;r.getInstance().buy(i,n,e,{qbopenkey:td.LocalStorageUtil.read("qbopenkey"),gameName:"\u7075\u5996\u8bb0\u5854\u9632"},function(t,i){a.buyCallback(t,i,e)})}else td.MessageBox.tip(97)},buyCallback:function(t,e,i){if(i&&"number"==typeof i){var n=i;i=this._createChargeItem(n)}if(t)if(t===ProtocolResult.BUY_CANCEL){var a=new td.BroadcastContent(158);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a)}else if(t===ProtocolResult.ORDER_HAS_FINISH&&DX_CHANNEL===SdkType.TTSHOUYOU3);else{var r=td.EventNameEnum.SERVER_SHOW_ERROR;td.EventUtil.dispatchEvent(r,t)}}},cc._RF.pop()},{"../../../SDK/SDKCommonEnum":void 0,RechargeModel:"RechargeModel",UFSdkManager:void 0}],RechargeModel:[function(t,e,i){"use strict";cc._RF.push(e,"2cbb6GEDUtKyqrg/F4SG4Bo","RechargeModel");var n=t("Model");cc.Class({extends:n,properties:{_chargeId:null,_orderId:null,_type:null,_itemName:null,_iconRes:null,_costValue:null,_goodsNumber:null,_specialShow:null,_multiCount:null,_visible:null,_times:null,_itemId:null,_des:null,_firstReward:null,_zoneId:null,_reward:null,_channelIcon:null},init:function(t){this._super("RechargeModel"),this._chargeId=t.chargeId,this._orderId=t.orderId,this._type=t.type,this._itemName=t.itemName,this._iconRes=t.iconRes,this._costValue=t.costValue,this._goodsNumber=t.goodsNumber,this._specialShow=1==t.specialShow,this._visible=1==t.showInShop,this._multiCount=t.specialIconRes,this._itemId=t.itemId,this._des=t.des,this._firstReward=td.RewardManager.parseRewardListDetail(t.firstReward),this._reward=t.reward,this._zoneId=t.zoneId,this._channelIcon=t.channelIcon||"",this._times=0},getChargeId:function(){return this._chargeId},getOrderId:function(){return this._orderId},getType:function(){return this._type},getItemName:function(){return this._itemName},getIconRes:function(){return this._iconRes},getCostValue:function(){return this._costValue},getGoodsNum:function(){return this._goodsNumber},getShowValue:function(){return this._costValue/10},getLimit:function(){return this._limit},isShowSpecial:function(){return this._specialShow},getMultiCount:function(){return this._multiCount},showFirstGift:function(){return this._times<=0&&this._firstReward.length>0},isVisible:function(){return this._visible},setTimes:function(t){this._times=t},getTimes:function(){return this._times},getFirstRewardNum:function(){return this._firstReward.length>0?this._firstReward[0].getCount():0},getFirstReward:function(){return this._firstReward},getReward:function(){return this._reward},getItemId:function(){return this._itemId},getDes:function(){return this._des},getZoneId:function(){return this._zoneId},getChannelIcon:function(){return this._channelIcon}});cc._RF.pop()},{Model:"Model"}],RechargePanel:[function(t,e,i){"use strict";cc._RF.push(e,"00d5bbRbF9IPqaQzHwIq/k4","RechargePanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{nodeScroll:cc.Node,nodeMoxie:cc.Node,labMoxieStar:cc.Label,_listViewLogic:null,_rechargeAltas:cc.SpriteAtlas},initData:function(t){this._super(t)},onLoad:function(){var t=this.node.getChildByName("scrollView");this._listViewLogic=t.getComponent("RechargeListView"),this.nodeMoxie.active=td.isMoXieQQ(),td.isMoXieQQ()?(this.nodeScroll.y=-250,this.nodeScroll.height=890):(this.nodeScroll.y=-195,this.nodeScroll.height=940)},onEnable:function(){this._super(),this._rechargeAltas=gdk.rm.getResByUrl("plist/Acitivty_13_cz",cc.SpriteAtlas),this._addEventListener(),this.initUI(),td.isMoXieQQ()&&this._setLabStar()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum;t.registerEvent(e.REFRESH_RECHARGE_DATA,this.initUI,this)},_setLabStar:function(){var t=this;td.isMoXieQQ()&&td.EventUtil.dispatchEvent(td.EventNameEnum.MOXIE_GET_BALANCE,function(e){t.labMoxieStar&&(t.labMoxieStar.string=e)})},initUI:function(){var t=td.Account.getUserData(),e=this.node.getChildByName("imgVip"),i=this.node.getChildByName("labVip");i.getComponent(cc.Label).string=t.vip;var n=this.node.getChildByName("richTips"),a=this.node.getChildByName("btnVip"),r=t.getVip(),o=t.getRecharge()/10,s=td.GetTableClass(td.TableEnum.VipTable).getMaxVipLevel(),l=td.GetTableClass(td.TableEnum.VipTable).getVipRechargeByVipLevel(r+1);n.getComponent(cc.RichText).string=cc.js.formatStr(td.Language.vipRechargeTips,l-o,r+1);var c=this.node.getChildByName("progress"),u=this.node.getChildByName("labProgress");c.getComponent(cc.ProgressBar).progress=o/l,u.getComponent(cc.Label).string=o+"/"+l,r>=s?(n.active=!1,u.getComponent(cc.Label).string=o):n.active=!0,td.IsCheckServer()&&(e.active=!1,i.active=!1,n.active=!1,a.active=!1,c.active=!1,u.active=!1),this._refreshView()},_refreshView:function(){var t={dataList:td.RechargeManager.getShowData(),rechargeAltas:this._rechargeAltas};this._listViewLogic&&this._listViewLogic.setData(t)},openVipPrivilege:function(){var t=td.Account.getUserData();td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_VipPrivilege,t.vip)},onBtnCheckClick:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.MOXIE_RECHARGE_CHECK)}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],RechargeRankItem:[function(t,e,i){"use strict";cc._RF.push(e,"3c4bd++EglN3oWRILeWKWl0","RechargeRankItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("ListItem"),o=(t("AvatarHeadWidget"),cc._decorator),s=o.ccclass,l=(o.property,o.menu),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.updateItem=function(e,i){if(this._controller=this._customData.controller,t.prototype.updateItem.call(this,e,i),i){var n=this.node.getChildByName("labRank"),a=this.node.getChildByName("imgRank"),r=this.node.getChildByName("imgRank2"),o=this.node.getChildByName("labName"),s=this.node.getChildByName("labAmount"),l=this.node.getChildByName("rewardsPanel"),c=i.getRankModel(),u=i.getRank();if(u<4?(n.active=!1,r.active=!1,a.active=!0,td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,"GY0_paiming_0"+u,a)):u>10?(r.active=!0,n.active=!1,a.active=!1):(n.active=!0,a.active=!1,r.active=!1,n.getComponent(cc.Label).string=u),o.active=!0,c){var d=this._controller.isGlobalServer();o.getComponent(cc.Label).string=d?c.getNickNameAndServer():c.getNickName()}else o.getComponent(cc.Label).string=td.Language.setWaite;u>10&&(o.getComponent(cc.Label).string="");var h=cc.js.formatStr(td.Language.rechargeCount,i.getRecharge()/10+"");s.getComponent(cc.Label).string=h,s.active=i.getRecharge()>0;for(var p=i.getRewards(),_=0,g=0;g<p.length;g++){var f=p[g],v=td.RewardManager.getRewardDetail(f),m=l.getChildByName("itemIcon"+g);m||((m=td.GlobalFunction.createCommonIconWidget(26,v)).setAnchorPoint(cc.v2(0,.5)),m.name="itemIcon"+g,l.addChild(m),m.scale=.7,m.x=44+(.6*m.width+5)*g),m.getComponent("CommonIconWidget").setData(v),_++,m.active=!0}for(g=_;g<l.children.length;g++){l.children[g].active=!1}}},e=a([s,l("module/Activity/RechargeRankItem")],e)}(r);i.default=c,e.exports=c,cc._RF.pop()},{AvatarHeadWidget:void 0,ListItem:void 0}],RechargeRankListController1:[function(t,e,i){"use strict";cc._RF.push(e,"fa90bgcR5hGxLx2YodLwSd7","RechargeRankListController1");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("RechargeRankListController"));e.exports=a,cc._RF.pop()},{RechargeRankListController:"RechargeRankListController"}],RechargeRankListController2:[function(t,e,i){"use strict";cc._RF.push(e,"24062ET5c1DJaxLwrvZdpi5","RechargeRankListController2");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("RechargeRankListController"));e.exports=a,cc._RF.pop()},{RechargeRankListController:"RechargeRankListController"}],RechargeRankListController3:[function(t,e,i){"use strict";cc._RF.push(e,"26ba1BQXsRFQLlESi4+YiX+","RechargeRankListController3");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("RechargeRankListController"));e.exports=a,cc._RF.pop()},{RechargeRankListController:"RechargeRankListController"}],RechargeRankListController4:[function(t,e,i){"use strict";cc._RF.push(e,"78d60DT+8FBza6qHTdjXjt1","RechargeRankListController4");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("RechargeRankListController"));e.exports=a,cc._RF.pop()},{RechargeRankListController:"RechargeRankListController"}],RechargeRankListController5:[function(t,e,i){"use strict";cc._RF.push(e,"16b45n4obRNN4iWxojFfyA0","RechargeRankListController5");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("RechargeRankListController"));e.exports=a,cc._RF.pop()},{RechargeRankListController:"RechargeRankListController"}],RechargeRankListController6:[function(t,e,i){"use strict";cc._RF.push(e,"84e07h+M5xPYKD6wwdRlYVw","RechargeRankListController6");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e}(t("RechargeRankListController"));e.exports=a,cc._RF.pop()},{RechargeRankListController:"RechargeRankListController"}],RechargeRankListController:[function(t,e,i){"use strict";cc._RF.push(e,"8a71fpfqJBOSrjPYTxABKsS","RechargeRankListController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ActivityBaseController"),s=t("RechargeRankModel"),l=cc._decorator,c=l.ccclass,u=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._myRechargeNum=0,e._myRank=0,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this.clearData()},e.prototype.clearData=function(){this._myRank=0,this._myRechargeNum=0,this._rankList=[],this._initList()},e.prototype._initList=function(){var t=this.getActivityData(),e=r.GetTableClass(r.TableEnum.RechargeRankTable).getDatasByDataId(t).length;if(this._rankList.length<e-1)for(var i=1;i<=e-1;i++){var n=r.GetTableClass(r.TableEnum.RechargeRankTable).getDataByDataIdAndRank(t,i),a=n.rewards,o=n.rank,l={};l.rank=o,l.lastChargeTime=0,l.recharge=0,l.rewards=a,(c=new s).init(l),this._rankList.push(c)}a=r.GetTableClass(r.TableEnum.RechargeRankTable).getDataByDataIdAndRank(t,0).rewards;var c,u={rank:11,lastChargeTime:0,recharge:0};u.rewards=a,(c=new s).init(u),this._rankList.push(c)},e.prototype.activityParse=function(t){var e=this.getActivityData(),i=t.record,n=t.global;if(this._myRechargeNum=i.recharge,n){var a=n.rankList;if(a&&0===a.length)r.EventUtil.dispatchEvent(r.EventNameEnum.REFRESH_RECHARGE_MYRANK_INFO);else{this._rankList=[];for(var o=0;o<a.length;o++){var l=a[o],c=l.rank,u=r.GetTableClass(r.TableEnum.RechargeRankTable).getDataByDataIdAndRank(e,c);if(u){var d=u.rewards;l.rewards=d,(m=new s).init(l),this._rankList.push(m)}}this._myRank=0;var h=r.Account.getUserData().getGamerId();for(o=0;o<this._rankList.length;o++){var p=this._rankList[o];if(p.getRankModel().getGamerId()===h){this._myRank=p.getRank();break}}var _=r.GetTableClass(r.TableEnum.RechargeRankTable).getDatasByDataId(e).length;if(this._rankList.length<_-1)for(this._rankList.length,o=this._rankList.length+1;o<=_-1;o++){var g=r.GetTableClass(r.TableEnum.RechargeRankTable).getDataByDataIdAndRank(e,o);if(g){d=g.rewards,c=g.rank;var f={};f.rank=c,f.lastChargeTime=0,f.recharge=0,f.rewards=d,(m=new s).init(f),this._rankList.push(m)}}var v=r.GetTableClass(r.TableEnum.RechargeRankTable).getDataByDataIdAndRank(e,0);if(v){d=v.rewards;var m,y={rank:11,lastChargeTime:0,recharge:0};y.rewards=d,(m=new s).init(y),this._rankList.push(m)}r.EventUtil.dispatchEvent(r.EventNameEnum.REFRESH_RECHARGE_RANK)}}},e.prototype.getMyRechargeNum=function(){return this._myRechargeNum/10},e.prototype.getMyRank=function(){return this._myRank},e.prototype.getRechargeStardard=function(){for(var t=this.getActivityType(),e=r.GetConfig("ACTIVITY_RECHARGE_RANK_LIMIT"),i=0;i<e.length;i++){var n=e[i];if(n[0]===t)return n[1]}return 0},e.prototype.getRankList=function(){return this._rankList?this._rankList.slice(0):[]},e.prototype.getTopImgSpriteFrame=function(){var t=this.getActivityType();return 31===t||32===t?"Activity_bg/HD_chongbang_yub":33===t||34===t?"Activity_bg/HD_chongbang_jb":35===t||36===t?"Activity_bg/HD_chongbang_yb":void 0},e.prototype.isGlobalServer=function(){var t=this.getActivityType();return 32===t||34===t||36===t},e.prototype.isActicityShowStatus=function(){var t=this.getCurrentOpenStage(),e=new Date(t.closeTime).valueOf(),i=this.getShowTime(),n=r.TimeUtil.getTime();return n>=i&&n<e},e.prototype.hasRedPoint=function(){return!1},e.prototype.redPointEvts=function(){return[r.EventNameEnum.Recharge_Success,r.EventNameEnum.Res_GET_ACTIVITY_INFO]},e.prototype.isRedPointTip=function(){return!1},e=a([c],e)}(o));i.default=u,e.exports=u,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",RechargeRankModel:"RechargeRankModel"}],RechargeRankListPanel:[function(t,e,i){"use strict";cc._RF.push(e,"ee0aefPl5ZJUa3tU+QZCZuG","RechargeRankListPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ActivityBasePanel"),s=(t("OptimizeVerticalListView"),cc._decorator),l=s.ccclass,c=s.property,u=s.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.overTipNode=null,e.labActivityTime=null,e.labMyRank=null,e.labMyRechargeNum=null,e._isInit=!1,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e)},e.prototype.onLoad=function(){this._topBg=this.node.getChildByName("imgInfoBg"),this._bottomTip=this.node.getChildByName("bottomTip");var t=this.node.getChildByName("scrollView");this.labActivityTime.string=this.getDurationStr(!0),this._setTopImg(),this._setBottomTip(),this._listView=t.getComponent("OptimizeVerticalListView")},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this._refreshUI()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),this._removeEventListener()},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.REFRESH_RECHARGE_RANK]=this._refreshUI.bind(this),t[e.REFRESH_RECHARGE_RANK_LIST]=this._refreshRankList.bind(this),t[e.REFRESH_RECHARGE_MYRANK_INFO]=this._refreshMyRechargeInfo.bind(this),r.EventUtil.registerEvents(t,this)},e.prototype._removeEventListener=function(){r.EventUtil.unregisterAllEvents(this)},e.prototype._refreshUI=function(){this._refreshMyRechargeInfo(),this._refreshRankList()},e.prototype.getDurationStr=function(t){var e=this._controller.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=this._controller.getShowTime(),n=new Date(e.openTime),a=new Date(i-=1e3),o=r.Language.timePattern5,s=r.Language.activityTimeTip;return t&&(s=r.Language.activityTimeTip1),s=cc.js.formatStr(s,n.pattern(o),a.pattern(o))}},e.prototype._refreshMyRechargeInfo=function(){var t=this._controller.getMyRank();this.labMyRank.string=t>0?t:r.Language.notInRank;var e=this._controller.getMyRechargeNum(),i=cc.js.formatStr(r.Language.rechargeCount,e+"");this.labMyRechargeNum.string=i},e.prototype._refreshRankList=function(){this._showActivityOver();var t=this._controller.getRankList(),e={};e.dataList=t,e.controller=this._controller,this._listView.setCustomData(e),this._isInit?this._listView.refreshCurList(t):this._listView.setData(t),this._isInit=!0},e.prototype._setTopImg=function(){var t=this._controller.getTopImgSpriteFrame();r.GlobalFunction.createSprite(t,this._topBg)},e.prototype._setBottomTip=function(){var t=r.Language.rechargeRankTip1;this._controller.isGlobalServer()&&(t=r.Language.rechargeRankTip2);var e=this._controller.getRechargeStardard();t=cc.js.formatStr(t,e/10+""),this._bottomTip.getComponent(cc.RichText).string=r.GlobalFunction.getRichText(t)},e.prototype._showActivityOver=function(){var t=this._controller.isActicityShowStatus();this.overTipNode.active=t},a([c(cc.Node)],e.prototype,"overTipNode",void 0),a([c(cc.Label)],e.prototype,"labActivityTime",void 0),a([c(cc.Label)],e.prototype,"labMyRank",void 0),a([c(cc.Label)],e.prototype,"labMyRechargeNum",void 0),e=a([l,u("module/Activity/RechargeRankListPanel")],e)}(o);i.default=d,e.exports=d,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0}],RechargeRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"f31c5brngBAp562vr5lHIbz","RechargeRankModel");var n=t("ActorRankModel"),a=cc.Class({properties:{_rank:null,_rewards:null,_recharge:null,_lastRechargeTime:null,_rankModel:null},init:function(t){if(this._rank=0,this._rewards=[],this._rank=t.rank,this._rewards=t.rewards,this._lastRechargeTime=t.lastChargeTime,this._recharge=t.recharge,t.attributes){var e=new n;e.init(t),this._rankModel=e}},getRank:function(){return this._rank},getRewards:function(){return this._rewards},getRecharge:function(){return this._recharge},getRankModel:function(){return this._rankModel},getLastRechargeTime:function(){return this._lastRechargeTime}});e.exports=a,cc._RF.pop()},{ActorRankModel:"ActorRankModel"}],RechargeRankTable:[function(t,e,i){"use strict";cc._RF.push(e,"53578Ir2TpPPbpk6Js8nHbM","RechargeRankTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivityRechargeRankConfig",properties:{_tblName:"activity_recharge_rank_config",_datas:null},init:function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.data]=this._datas[e.data]||[],this._datas[e.data].push(e)}},getDatasByDataId:function(t){return this._datas[t]?this._datas[t].slice(0):[]},getDataByDataIdAndRank:function(t,e){if(!this._datas[t])return console.log("no recharge rank data"),null;for(var i=this._datas[t].slice(0),n=0;n<i.length;n++)if(i[n].rank===e)return i[n];return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],RechargeTypeEnum:[function(t,e,i){"use strict";cc._RF.push(e,"af41bWgH7VKrpLCrNhLmqbJ","RechargeTypeEnum"),td.RechargeTypeEnum={Custom:0,MonthCard:1,LifeTimeCard:2,WeekCard:3,SuperGift:4,PetVipCard:5},td.RECHARGE_ID={MONTH_CARD:101,LIFE_CARD:102},cc._RF.pop()},{}],RedPacketManager:[function(t,e,i){"use strict";cc._RF.push(e,"5f23dMjNwpIrLa1o2JthnBo","RedPacketManager");var n=t("RedPacketModel");td.RedPacketManager={_privateList:null,_publicList:null,_RedPacketAmountLimit:null,_RedPacketSendLimit:null,_RedPacketTitleMaxLen:null,_RedPacketReciveMax:null,_RedPacketDefineNumMax:null,_pushPublicIds:null,_redPacketRedPoint:null,_redPacketRedPoint1:null,_redPacketRedPoint2:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._privateList={},this._publicList={},this._pushPublicIds=[],this._redPacketRedPoint=!1,this._redPacketRedPoint1=!1,this._redPacketRedPoint2=!1},getRedPacketById:function(t){return this._publicList[t]?this._publicList[t]:this._privateList[t]?this._privateList[t]:null},hasRedPacketToShow:function(){return!this.reachReceiveMax()&&this._pushPublicIds.length>0},popPushPublicRedPacketModel:function(){if(this._pushPublicIds.length>0){var t=this._pushPublicIds[0];return this._pushPublicIds.splice(0,1),this.getRedPacketById(t)}return null},getRedPacketAmountLimit:function(){return this._RedPacketAmountLimit||(this._RedPacketAmountLimit=td.GetConfig("RED_ENVELOLE_DEFINE_AMOUNT_LIMIT")),this._RedPacketAmountLimit},getRedPacketSendLimit:function(){return this._RedPacketSendLimit||(this._RedPacketSendLimit=td.GetConfig("RED_ENVELOLE_DEFINE_SEND_LIMIT")),this._RedPacketSendLimit},getRedPacketReceiveTimesLimit:function(){return this._RedPacketReciveMax||(this._RedPacketReciveMax=td.GetConfig("RED_ENVELOPE_RECEIVE_LIMIT")),this._RedPacketReciveMax},reachReceiveMax:function(){var t=this.getRedPacketReceiveTimesLimit();return td.Account.getUserData().getReceiveRedPacketCount()>=t},getRedPacketDefineNumLimit:function(){return this._RedPacketDefineNumMax||(this._RedPacketDefineNumMax=td.GetConfig("RED_ENVELOLE_DEFINE_COUNT_LIMIT")),this._RedPacketDefineNumMax},getRedPacketTitleMaxLen:function(){return this._RedPacketTitleMaxLen||(this._RedPacketTitleMaxLen=td.GetConfig("RED_ENVELOPE_TITLE_MAX_LENGTH")),this._RedPacketTitleMaxLen},getListByType:function(t){var e=1===t?this._publicList:this._privateList,i=[],n=[];for(var a in e)1===e[a].getState()?i.unshift(e[a]):n.unshift(e[a]);return i.concat(n)},_addListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.RED_ENVELOPE,i=td.MsgCmd.RED_ENVELOPE;t.registerMessage(e,i.GET_PRIVATE_RED_ENVELOPE_LIST,this.resGetPrivateRedPacket.bind(this)),t.registerMessage(e,i.GET_PUBLIC_RED_ENVELOPE_LIST,this.resGetPublicRedPacket.bind(this)),t.registerMessage(e,i.RECEIVE_RED_ENVELOPE,this.resReciveRedPacket.bind(this)),t.registerMessage(e,i.SEND_PRIVATE_RED_ENVELOPE,this.resSendPrivateRedPacket.bind(this)),t.registerMessage(e,i.SEND_DEFINE_RED_ENVELOPE,this.resSendDefineRedPacket.bind(this)),t.registerMessage(e,i.RED_ENVELOPE_DETAIL,this.resRedPacketDetail.bind(this)),t.registerMessage(e,i.PUSH_RED_ENVELOPE_REFRESH,this.resRedPacketRefresh.bind(this)),t.registerMessage(e,i.PUSH_PRIVATE_RED_ENVELOPE_LIS,this.resGetPrivateRedPacket.bind(this)),t.registerMessage(e,i.PUSH_PUBLIC_RED_ENVELOPE_LIST,this._pushPublickRedPacket.bind(this)),t.registerMessage(e,i.PUSH_RED_ENVELOPE_DELETE,this.pushDeletRedPackt.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REQ_GET_PRIVATE_RED_ENVELOPE_LIST]=this.reqGetPrivateRedPacket,i[e.REQ_GET_PUBLIC_RED_ENVELOPE_LIST]=this.reqGetPublicRedPacket,i[e.REQ_RECEIVE_RED_ENVELOPE]=this.reqReciveRedPacket,i[e.REQ_SEND_PRIVATE_RED_ENVELOPE]=this.reqSendPrivateRedPacket,i[e.REQ_SEND_DEFINE_RED_ENVELOPE]=this.reqSendDefineRedPacket,i[e.REQ_RED_ENVELOPE_DETAIL]=this.reqRedPacketDetail,t.registerEvents(i,this)},reqGetPrivateRedPacket:function(){var t={};t.module=td.MsgModuleName.RED_ENVELOPE,t.cmd=td.MsgCmd.RED_ENVELOPE.GET_PRIVATE_RED_ENVELOPE_LIST,td.ServerDelegate.sendMessage(t)},resRedPacketRefresh:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.id,n=e.receiveCount,a=this.getRedPacketById(i);a&&a.setReceiveCount(n),td.UnlockManager.isTargetUnlock(td.ActorUnlockType.RED_ENVELOPE)&&td.EventUtil.dispatchEvent(td.EventNameEnum.PUSH_PUBLIC_RED_ENVELOPE_LIST)}},resGetPrivateRedPacket:function(t,e){if(t===td.NetCode.SUCCESS){for(var i=e.redEnvelopeList,a=0,r=i.length;a<r;a++){var o=i[a],s=o.id,l=this._privateList[s];l||(l=new n,this._privateList[s]=l),l.init(o,!1)}td.EventUtil.dispatchEvent(td.EventNameEnum.RES_GET_PRIVATE_RED_ENVELOPE_LIST)}},reqGetPublicRedPacket:function(){var t={};t.module=td.MsgModuleName.RED_ENVELOPE,t.cmd=td.MsgCmd.RED_ENVELOPE.GET_PUBLIC_RED_ENVELOPE_LIST,td.ServerDelegate.sendMessage(t)},resGetPublicRedPacket:function(t,e,i){if(t===td.NetCode.SUCCESS){for(var a=e.redEnvelopeList,r=0,o=a.length;r<o;r++){var s=a[r],l=s.id,c=this._publicList[l];if(!c&&(c=new n,this._publicList[l]=c,i)){var u=td.GetConfig("GUIDE_LEVEL_LIMIT");td.Account.getUserData().getLevel()>=u&&(this._pushPublicIds[this._pushPublicIds.length]=l)}c.init(s,!0)}td.EventUtil.dispatchEvent(td.EventNameEnum.RES_GET_PUBLIC_RED_ENVELOPE_LIST)}},reqReciveRedPacket:function(t){var e={};e.module=td.MsgModuleName.RED_ENVELOPE,e.cmd=td.MsgCmd.RED_ENVELOPE.RECEIVE_RED_ENVELOPE,e.id=t,td.ServerDelegate.sendMessage(e),this._receiveId=t},resReciveRedPacket:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,n),td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_RED_ENVELOPE_DETAIL,this._receiveId)}},reqSendPrivateRedPacket:function(t){var e={};e.module=td.MsgModuleName.RED_ENVELOPE,e.cmd=td.MsgCmd.RED_ENVELOPE.SEND_PRIVATE_RED_ENVELOPE,e.id=t,td.ServerDelegate.sendMessage(e)},resSendPrivateRedPacket:function(t,e){if(t===td.NetCode.SUCCESS){var i=new td.BroadcastContent(224);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_SEND_PRIVATE_RED_ENVELOPE)}},reqSendDefineRedPacket:function(t){var e={};e.module=td.MsgModuleName.RED_ENVELOPE,e.cmd=td.MsgCmd.RED_ENVELOPE.SEND_DEFINE_RED_ENVELOPE,e.title=t.title,e.amount=t.amount,e.count=t.count,td.ServerDelegate.sendMessage(e)},reqRedPacketDetail:function(t){var e={};e.module=td.MsgModuleName.RED_ENVELOPE,e.cmd=td.MsgCmd.RED_ENVELOPE.RED_ENVELOPE_DETAIL,e.id=t,td.ServerDelegate.sendMessage(e)},resSendDefineRedPacket:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_SEND_DEFINE_RED_ENVELOPE)},resRedPacketDetail:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.id,n=e.receiverList,a=this.getRedPacketById(i);a&&a.setReceiverList(n),td.UnlockManager.isTargetUnlock(td.ActorUnlockType.RED_ENVELOPE)&&td.EventUtil.dispatchEvent(td.EventNameEnum.RES_RED_ENVELOPE_DETAIL,i)}},pushDeletRedPackt:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.state,n=e.id;this._delRedPacket(i,n)}},_delRedPacket:function(t,e){delete(t?this._privateList:this._publicList)[e]},_pushPublickRedPacket:function(t,e){t===td.NetCode.SUCCESS&&(this.resGetPublicRedPacket(t,e,!0),td.UnlockManager.isTargetUnlock(td.ActorUnlockType.RED_ENVELOPE)&&td.EventUtil.dispatchEvent(td.EventNameEnum.PUSH_PUBLIC_RED_ENVELOPE_LIST))},hadRedPackt2Send:function(){return!this._redPacketRedPoint2&&this._privateList.myLen()>0},hadRedPacket2Receive:function(){if(this._redPacketRedPoint1)return!1;if(this.reachReceiveMax())return!1;var t=this.getListByType(1);return t.length>0&&1===t[0].getState()},openActivityPanel1:function(){this._redPacketRedPoint1||(this._redPacketRedPoint1=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_REDPACKET))},openActivityPanel2:function(){this._redPacketRedPoint2||(this._redPacketRedPoint2=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_REDPACKET))},hasRedPoint:function(){return!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.RED_ENVELOPE)&&(this.hadRedPacket2Receive()||this.hadRedPackt2Send())},openActivityPanel:function(){this._redPacketRedPoint||(this._redPacketRedPoint=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_REDPACKET))},hasRedPoint1:function(){return!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.RED_ENVELOPE)&&(!this._redPacketRedPoint&&(this.hadRedPacket2Receive()||this.hadRedPackt2Send()))},redPointEvent1:function(){return[td.EventNameEnum.OPEN_REDPACKET]},redPointEvent:function(){return[td.EventNameEnum.RES_GET_PRIVATE_RED_ENVELOPE_LIST,td.EventNameEnum.RES_GET_PUBLIC_RED_ENVELOPE_LIST,td.EventNameEnum.OPEN_REDPACKET]}},cc._RF.pop()},{RedPacketModel:"RedPacketModel"}],RedPacketModel:[function(t,e,i){"use strict";cc._RF.push(e,"0be64P1jEVOpYx7vbw6zPmr","RedPacketModel");var n=t("BaseUser"),a=t("RedPacketReceiverModel"),r=cc.Class({extends:n,properties:{_id:null,_title:null,_amount:null,_count:null,_receiveCount:null,_receiverList:null,_leftAmount:null,_leftCount:null,_meReceived:null,_state:null,_isPublic:null,_isDefine:null,_totalReceiveAmount:null,_selfReceiveAmount:null},init:function(t,e){this._super("RedPacketModel",t.attributes),this._isPublic=e,void 0!==t.id&&(this._id=t.id),void 0!==t.title&&(this._title=t.title),void 0!==t.amount&&(this._amount=t.amount),void 0!==t.count&&(this._count=t.count),void 0!==t.isDefine&&(this._isDefine=t.isDefine||!1),void 0!==t.receiveCount&&(this._receiveCount=t.receiveCount),void 0!==t.receiveState&&(this._meReceived=t.receiveState),this.refreshState()},refreshState:function(){this._leftCount=this._count-this._receiveCount,0===this._leftCount?this._state=3:this._meReceived?this._state=2:this._state=1},setReceiverList:function(t){this._selfReceiveAmount=0;var e=0,i=-1,n=td.Account.getUserData().sid,r=0,o=0;this._receiverList=[];for(var s=0,l=t.length;s<l;s++){var c=t[s],u=new a;u.init(c),this._receiverList[this._receiverList.length]=u,e+=u.getAmount(),u.sid===n&&(i=s),o<u.getAmount()&&(o=u.getAmount(),r=s)}if(this._leftAmount=this._amount-e,this._totalReceiveAmount=e,0===this._leftCount&&this._receiverList[r].setIsBest(!0),i>=0){var d=this._receiverList[i];this._selfReceiveAmount=d.getAmount(),ArrayUtils.remove(this._receiverList,d),this._receiverList.unshift(d)}},isDefine:function(){return this._isDefine},isPublic:function(){return this._isPublic},getState:function(){return this._state},getId:function(){return this._id},isMeReceived:function(){return this._meReceived},getTitle:function(){return this._title},getLeftAmount:function(){return this._leftAmount},getSelfReceiveAmount:function(){return this._selfReceiveAmount},getAmount:function(){return this._amount},getTotalReceiveAmount:function(){return this._totalReceiveAmount},getCount:function(){return this._count},getLeftCount:function(){return this._leftCount},setReceiveCount:function(t){this._receiveCount=t,this.refreshState()},getReceiveCount:function(){return this._receiveCount},getReceiverList:function(){return this._receiverList}});e.exports=r,cc._RF.pop()},{BaseUser:"BaseUser",RedPacketReceiverModel:"RedPacketReceiverModel"}],RedPacketReceiverModel:[function(t,e,i){"use strict";cc._RF.push(e,"ea4f9TXhCdFppmYe3tmyT4z","RedPacketReceiverModel");var n=t("BaseUser"),a=cc.Class({extends:n,properties:{_amount:null,_isBest:null},init:function(t){this._super("RedPacketReceiverModel",t.attributes),this._amount=t.amount,this._isBest=!1},getAmount:function(){return this._amount},isBest:function(){return this._isBest},setIsBest:function(t){this._isBest=t}});e.exports=a,cc._RF.pop()},{BaseUser:"BaseUser"}],RedPointEnum:[function(t,e,i){"use strict";cc._RF.push(e,"ba5c9lc2LtBn4lJ4NcpsrO2","RedPointEnum");var n=C(t("../../TS/Roam/Manager/RoamManager")),a=C(t("../../TS/Treasure/Manager/TreasureManger")),r=C(t("../../TS/DestroyTemple/Manager/DestroyTempleManager")),o=(C(t("../../TS/Pagoda/Manager/PagodaManager")),C(t("../../TS/StarUpRoad/Manager/StarUpRoadManager"))),s=C(t("../../TS/Endless/Manager/EndlessManager")),l=C(t("../../TS/WorldBoss/Manager/WorldBossManager")),c=C(t("../../TS/Pulse/Manager/PulseManager")),u=C(t("../../TS/Gem/Manager/GemstoneManager")),d=C(t("../AncientCorridor/Manager/AncientCorridorManager")),h=C(t("../Dipper/Manager/DipperManager")),p=C(t("../WonderlandAdventure/Manager/WonderlandManager")),_=C(t("../../TS/CrossArena/Manager/CrossArenaManager")),g=C(t("../../TS/Babel/Manager/BabelManager")),f=C(t("../../TS/CrossCup/Manager/CrossCupManager")),v=C(t("../../TS/Legend/Manager/LegendManager")),m=C(t("../../TS/EightDiagrams/Manager/EightDiagramsManager")),y=C(t("../../TS/Maze/Manager/MazeManager")),E=C(t("../../TS/EvilGodCopy/Mananger/EvilGodManager")),T=C(t("../Chess/Manager/ChessManager"));function C(t){return t&&t.__esModule?t:{default:t}}t("ArenaManager"),t("MagicRecordManager"),t("MaterailCopyManager"),t("DemonTreasureCopyManager");td.ItemForCheckType={HeroUpgrade:1,HeroEvolve:2,HeroRelife:3,EquipUpgrade:4,EquipEvolve:5,Summon:6,HeroAwake:7,EquipSoul:8,HeroPractice:9,HeroStarUp:10},td.RedPointType={MAIL:1,STORY:2,ARENA:3,HONER_NUM:4,HONER_REPORTS:5,ARENA_LOG:6,NationWarReportChange:7},td.FightActivityRedConfig={1:[n.default.getInstance().isRedPointTips.bind(n.default.getInstance()),n.default.getInstance().redPointEvents.bind(n.default.getInstance())],2:[td.ArenaManager.isRedPointTips.bind(td.ArenaManager),td.ArenaManager.redPointEvents.bind(td.ArenaManager)],3:[a.default.getInstance().isRedPointTips.bind(a.default.getInstance()),a.default.getInstance().redPointEvents.bind(a.default.getInstance())],4:[td.MagicRecordManager.isRedPointTips.bind(td.MagicRecordManager),td.MagicRecordManager.redPointEvents.bind(td.MagicRecordManager)],5:[r.default.getInstance().isRedPointTips.bind(r.default.getInstance()),r.default.getInstance().redPointEvents.bind(r.default.getInstance())],6:[td.MaterailCopyManager.isRedPointTips.bind(td.MaterailCopyManager),td.MaterailCopyManager.redPointEvents.bind(td.MaterailCopyManager)],7:[E.default.getInstance().checkCopyEntranceRedPointTip.bind(E.default.getInstance()),E.default.getInstance().redPointEvents.bind(E.default.getInstance())],8:[l.default.getInstance().isRedPointTips.bind(l.default.getInstance()),l.default.getInstance().redPointEvents.bind(l.default.getInstance())],9:[o.default.getInstance().isRedPointTips.bind(o.default.getInstance()),o.default.getInstance().redPointEvents.bind(o.default.getInstance())],10:[s.default.getInstance().isRedPointTips.bind(s.default.getInstance()),s.default.getInstance().redPointEvents.bind(s.default.getInstance())],11:[u.default.getInstance().isRedPointTips.bind(u.default.getInstance()),u.default.getInstance().redPointEvents.bind(u.default.getInstance())],12:[c.default.getInstance().isRedPointTips.bind(c.default.getInstance()),c.default.getInstance().redPointEvents.bind(c.default.getInstance())],13:[td.DemonTreasureCopyManager.isRedPointTips.bind(td.DemonTreasureCopyManager),td.DemonTreasureCopyManager.redPointEvents.bind(td.DemonTreasureCopyManager)],14:[d.default.getInstance().isRedPointTips.bind(d.default.getInstance()),d.default.getInstance().redPointEvents.bind(d.default.getInstance())],15:[h.default.getInstance().isRedPointTips.bind(h.default.getInstance()),h.default.getInstance().redPointEvents.bind(h.default.getInstance())],16:[p.default.getInstance().isRedPointTips.bind(p.default.getInstance()),p.default.getInstance().redPointEvents.bind(p.default.getInstance())],17:[_.default.getInstance().isRedPointTips.bind(_.default.getInstance()),_.default.getInstance().redPointEvents.bind(_.default.getInstance())],18:[g.default.getInstance().isRedPointTips.bind(g.default.getInstance()),g.default.getInstance().redPointEvents.bind(g.default.getInstance())],19:[f.default.getInstance().isRedPointTips.bind(f.default.getInstance()),f.default.getInstance().redPointEvents.bind(f.default.getInstance())],20:[v.default.getInstance().isRedPointTips.bind(v.default.getInstance()),v.default.getInstance().redPointEvents.bind(v.default.getInstance())],21:[m.default.getInstance().isRedPointTips.bind(m.default.getInstance()),m.default.getInstance().redPointEvents.bind(m.default.getInstance())],22:[y.default.getInstance().isRedPointTips.bind(y.default.getInstance()),y.default.getInstance().redPointEvents.bind(y.default.getInstance())],23:[T.default.getInstance().isRedPointTips.bind(T.default.getInstance()),T.default.getInstance().redPointEvents.bind(T.default.getInstance())]},td.RedPointShowType={Dot:1,Arrow:2},cc._RF.pop()},{"../../TS/Babel/Manager/BabelManager":"BabelManager","../../TS/CrossArena/Manager/CrossArenaManager":"CrossArenaManager","../../TS/CrossCup/Manager/CrossCupManager":"CrossCupManager","../../TS/DestroyTemple/Manager/DestroyTempleManager":"DestroyTempleManager","../../TS/EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager","../../TS/Endless/Manager/EndlessManager":"EndlessManager","../../TS/EvilGodCopy/Mananger/EvilGodManager":"EvilGodManager","../../TS/Gem/Manager/GemstoneManager":"GemstoneManager","../../TS/Legend/Manager/LegendManager":"LegendManager","../../TS/Maze/Manager/MazeManager":"MazeManager","../../TS/Pagoda/Manager/PagodaManager":"PagodaManager","../../TS/Pulse/Manager/PulseManager":"PulseManager","../../TS/Roam/Manager/RoamManager":"RoamManager","../../TS/StarUpRoad/Manager/StarUpRoadManager":"StarUpRoadManager","../../TS/Treasure/Manager/TreasureManger":"TreasureManger","../../TS/WorldBoss/Manager/WorldBossManager":"WorldBossManager","../AncientCorridor/Manager/AncientCorridorManager":"AncientCorridorManager","../Chess/Manager/ChessManager":"ChessManager","../Dipper/Manager/DipperManager":"DipperManager","../WonderlandAdventure/Manager/WonderlandManager":"WonderlandManager",ArenaManager:"ArenaManager",DemonTreasureCopyManager:"DemonTreasureCopyManager",MagicRecordManager:"MagicRecordManager",MaterailCopyManager:"MaterailCopyManager"}],RedPointUtil:[function(t,e,i){"use strict";cc._RF.push(e,"aff89QP2e1Et6z7IR9tYrGi","RedPointUtil");var n=p(t("../../TS/Roam/Manager/RoamManager")),a=p(t("../../TS/Treasure/Manager/TreasureManger")),r=p(t("../../TS/DestroyTemple/Manager/DestroyTempleManager")),o=p(t("../../TS/StarUpRoad/Manager/StarUpRoadManager")),s=p(t("../../TS/WorldBoss/Manager/WorldBossManager")),l=(p(t("../Shop/Manager/ShopManager")),p(t("../Dipper/Manager/DipperManager"))),c=t("../../TS/Gacha/Manager/GachaEnum"),u=p(t("../../TS/Gacha/Manager/GachaManager")),d=p(t("../Gem/Manager/GemstoneManager")),h=p(t("../Auction/Manager/AuctionManager"));function p(t){return t&&t.__esModule?t:{default:t}}var _=t("CommonEnum"),g=(t("ShopEnum"),t("UFSdkManager"));td.RedPointUtil={_id:110110110,_scheduleId:0,createRedPoint:function(t,e){if(!t||!e)return cc.assert(t,"the parent node of red point is null !!!"),void cc.assert(e,"the param of red point is null !!!");t.getChildByName("redPoint")?this._createPrfabe(t,e):(this._scheduleId++,this._createPrfabe(t,e))},_createPrfabe:function(t,e){if(cc.isValid(t)){var i=e.redPointName||"redPoint";if(n=t.getChildByName(i)){n.getComponent("RedPoint").initData(e,!1)}else{var n,a=gdk.rm.getResByUrl("prefab/CommonView/RedPointPrefab",cc.Prefab);if(!a)return cc.assert(a,"the prefab of red point is null !!!"),void cc.log("prefab/CommonView/RedPointPrefab  load error");(n=cc.instantiate(a)).name=i,n.getComponent("RedPoint").initData(e,!0),t.addChild(n,999)}}},createRedPointOld:function(t,e,i,n,a,r){var o={};o.tipEvents=n||[],o.checkFunc=i,o.offset=e,o.redPointName=a,o.showType=r||td.RedPointShowType.Dot,this.createRedPoint(t,o)},createRedPointSimple:function(t,e,i,n){if(cc.assert(t,"red point must have parent widget!!!"),i)return this.createRedPointOld(t,e,null,null,null,n);if(t.getChildByName("redPoint")){var a=t.getChildByName("redPoint"),r=a.getComponent("RedPoint");r&&r.clear(),a.active=!1}},isFunctionRewardRedPointTips:function(t){return td.FunctionPreviewManager.isFunctionRewardRedPointTips(t)},functionPreviewEvents:function(){return[td.EventNameEnum.USER_ATTR_LEVEL_CHANGE,td.EventNameEnum.USER_ATTR_VIP_LEVEL_CHANGE,td.EventNameEnum.USER_STORY_ID_CHANGE,td.EventNameEnum.SYS_UNLOCK_INFO_UPDATE]},isMailRedPointTips:function(){return td.MailManager.isMailRedPointTips()},mailChangeEvent:function(){return[td.EventNameEnum.REFRESH_MAIL_RED_POINT]},isFightActivityRedPointTips:function(){return n.default.getInstance().isRedPointTips()||td.ArenaManager.isRedPointTips()||a.default.getInstance().isRedPointTips()||td.MagicRecordManager.isRedPointTips()||r.default.getInstance().isRedPointTips()||td.MaterailCopyManager.isRedPointTips()||s.default.getInstance().isRedPointTips()||o.default.getInstance().isRedPointTips()||l.default.getInstance().isRedPointTips()},fightActivityRedPointEvents:function(){return n.default.getInstance().redPointEvents().concat(td.ArenaManager.redPointEvents(),a.default.getInstance().redPointEvents(),td.MagicRecordManager.redPointEvents(),r.default.getInstance().redPointEvents(),td.MaterailCopyManager.redPointEvents(),s.default.getInstance().redPointEvents(),l.default.getInstance().redPointEvents())},isLuckyScoreRewardRedPointTips:function(){var t=td.ActivityEnum.ActivityType.LuckyTurntable,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.isScoreRewardRedPointTips()},isLuckyExchangeRewardRedPointTips:function(){var t=td.ActivityEnum.ActivityType.LuckyTurntable,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.isExchangeRewardRedPointTips()},isLuckyMainShopBtnTips:function(){return this.isLuckyScoreRewardRedPointTips()||this.isLuckyExchangeRewardRedPointTips()},isLuckyTurntableRedPointTips:function(){var t=td.ActivityEnum.ActivityType.LuckyTurntable,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},luckyTurntableRedPointEvts:function(){return[td.EventNameEnum.TURN_TABLE_INFO_CHANGED,td.EventNameEnum.REFRESH_TURN_TABLE_REWARD,td.EventNameEnum.CARNIVAL_GIFT_SHOWN,td.EventNameEnum.RESBUY_GOODS]},isConfigActivityRedPointTips:function(){var t=td.ActivityDataManager.getControllers(td.ActivityEnum.Activity.ActivityConfig);if(!t||0===t.length)return!1;for(var e=0,i=t.length;e<i;e++){var n=t[e];if(n.isInOpenStatus()&&n.getShowData().isShowPanel()&&(n.redPointTip&&n.redPointTip()||n.isRedPointTip&&n.isRedPointTip()))return!0}return!1},configActivityRedPointEvts:function(){var t=[],e=td.ActivityDataManager.getControllers(td.ActivityEnum.Activity.ActivityConfig);if(!e||0===e.length)return t;for(var i=0,n=e.length;i<n;i++){var a=e[i];a.isInOpenStatus()&&a.getShowData().isShowPanel()&&a.redPointEvts&&a.redPointEvts()&&(t=t.concat(a.redPointEvts()))}return t},isFundCardMonthRedPointTips:function(){var t=td.ActivityEnum.ActivityType.FundCardMonth,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},isFundCardWeekRedPointTips:function(){var t=td.ActivityEnum.ActivityType.FundCardWeek,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},isContinuousRechargeRedPointTips:function(){var t=td.ActivityEnum.ActivityType.ContinuousRecharge,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},isAddUpRechargeRedPointTips:function(){var t=td.ActivityEnum.ActivityType.AddUpRecharge,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},isTreasureGiftRedPointTips:function(){var t=td.ActivityEnum.ActivityType.TreasureGift,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},isSingleRechargeRedPointTips:function(){var t=td.ActivityEnum.ActivityType.SingleRecharge,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},isPermanentActivityRedPointTips:function(){var t=td.ActivityDataManager.getControllers(td.ActivityEnum.Activity.ActivityFixed);if(!t||0===t.length)return!1;for(var e=0,i=t.length;e<i;e++){var n=t[e];if(n.isInOpenStatus()&&n.getShowData().isShowPanel()&&(n.redPointTip&&n.redPointTip()||n.isRedPointTip&&n.isRedPointTip()))return!0}return!1},permanentActivityRedPointEvts:function(){var t=[],e=td.ActivityDataManager.getControllers(td.ActivityEnum.Activity.ActivityFixed);if(!e||0===e.length)return t;for(var i=0,n=e.length;i<n;i++){var a=e[i];a.isInOpenStatus()&&a.getShowData().isShowPanel()&&a.redPointEvts&&a.redPointEvts()&&(t=t.concat(a.redPointEvts()))}return t},isCrossActivityRedPointTips:function(){var t=td.ActivityDataManager.getControllers(td.ActivityEnum.Activity.ActivityCross);if(!t||0===t.length)return!1;for(var e=0,i=t.length;e<i;e++){var n=t[e];if(n.isInOpenStatus()&&n.getShowData().isShowPanel()&&(n.redPointTip&&n.redPointTip()||n.isRedPointTip&&n.isRedPointTip()))return!0}return!1},crossActivityRedPointEvts:function(){var t=[],e=td.ActivityDataManager.getControllers(td.ActivityEnum.Activity.ActivityCross);if(!e||0===e.length)return t;for(var i=0,n=e.length;i<n;i++){var a=e[i];a.isInOpenStatus()&&a.getShowData().isShowPanel()&&a.redPointEvts&&a.redPointEvts()&&(t=t.concat(a.redPointEvts()))}return t},isGrowthPlanRedPointTips:function(){var t=td.ActivityEnum.ActivityType.GrowthPlan,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},isStarDiamondRedPointTips:function(){var t=td.ActivityEnum.ActivityType.StarDiamond,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},isMonthCardRedPointTips:function(){var t=td.ActivityEnum.ActivityType.MonthCard,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},isFestivalRedPointTips:function(){var t=td.ActivityEnum.ActivityType.Festival,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.isRedPointTip()},festivalRedPointEvts:function(){var t=td.ActivityEnum.ActivityType.Festival,e=td.ActivityDataManager.getActivityControllerByType(t);return e?e.redPointEvts():[]},isSignInRedPointTips:function(){var t=td.ActivityEnum.ActivityType.SignIn,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},isVipActivityRedPointTips:function(){var t=td.ActivityDataManager.getControllers(td.ActivityEnum.Activity.ActivityVip);if(!t||0===t.length)return!1;for(var e=0,i=t.length;e<i;e++){var n=t[e];if(n.isInOpenStatus()&&n.getShowData().isShowPanel()&&(n.redPointTip&&n.redPointTip()||n.isRedPointTip&&n.isRedPointTip()))return!0}return!1},vipActivityRedPointEvts:function(){var t=[],e=td.ActivityDataManager.getControllers(td.ActivityEnum.Activity.ActivityVip);if(!e||0===e.length)return t;for(var i=0,n=e.length;i<n;i++){var a=e[i];a.isInOpenStatus()&&a.getShowData().isShowPanel()&&a.redPointEvts&&a.redPointEvts()&&(t=t.concat(a.redPointEvts()))}return t},isFestivalAvictivityRedPointTips:function(){var t=td.ActivityDataManager.getControllers(td.ActivityEnum.Activity.ActivityFestival);if(!t||0===t.length)return!1;for(var e=0,i=t.length;e<i;e++){var n=t[e];if(n.isInOpenStatus()&&n.getShowData().isShowPanel()&&(n.redPointTip&&n.redPointTip()||n.isRedPointTip&&n.isRedPointTip()))return!0}return!1},festivalActivityRedPointEvts:function(){var t=[],e=td.ActivityDataManager.getControllers(td.ActivityEnum.Activity.ActivityFestival);if(!e||0===e.length)return t;for(var i=0,n=e.length;i<n;i++){var a=e[i];a.isInOpenStatus()&&a.getShowData().isShowPanel()&&a.redPointEvts&&a.redPointEvts()&&(t=t.concat(a.redPointEvts()))}return t},isFirstRechargeRedPointTips:function(){var t=td.ActivityEnum.ActivityType.MultipleFirstRecharge,e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},firstRechargeRedPointEvts:function(){return[td.EventNameEnum.REFRESH_FIRST_CHARGE_INFO]},isMoneyPennyRedPointTips:function(){var t=td.Account.getUserData().getCurrentSaveDiamond();if(td.UnlockManager.isTargetUnlock(td.ActorUnlockType.SAVE_DIAMOND,0))return t>0;var e=td.GlobalFunction.getLocalSaveStatus("MoneyPennyRedPoint");return!0!==e&&"true"!==e},moneyPennyRedPointEvts:function(){return[td.EventNameEnum.REFRESH_RECEIVE_DIAMOND,td.EventNameEnum.GENERAL_COPY_RESULT_REPORT,td.EventNameEnum.Res_SWEEP_GENERA_COPY,td.EventNameEnum.USER_ATTR_VIP_LEVEL_CHANGE,td.EventNameEnum.OPEN_MONEYPENNY,td.EventNameEnum.GAME_ALARM_EVENT]},isSuperGiftRedPointTips:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_16);return!!t&&t.redPointTip()},isSuperGift2RedPointTips:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.PreferentialGift);return!!t&&t.redPointTip()},superGiftRedPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.RESP_SUPER_GIFT_RECEIVE]},isRedPacketRedPointTips:function(){return td.RedPacketManager.hasRedPoint()},redPacketRedPointEvts:function(){return td.RedPacketManager.redPointEvent()},isHeroArtifactGachaRedPointTips:function(){var t=c.GachaType.HERO_EXCLUSIVE_ARTIFACT,e=td.GetTableClass(td.TableEnum.GachaTable).getDataByType(t).id;if(!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.GACHA,e,!1))return!1;var i=u.default.getInstance().getGachaListById(e);return!!i&&i.getNextFreeTime()<=td.TimeUtil.getTime()},heroArtifactGachaRedPointEvts:function(){return[td.EventNameEnum.RES_GET_GACHA_INFO]},isRedPacketRedPointTips1:function(){return td.RedPacketManager.hasRedPoint1()},redPacketRedPointEvts1:function(){return td.RedPacketManager.redPointEvent()},isDailyPreferentialRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.DailyPreferential);return!!t&&t.isRedPointTip()},dailyPreferentialRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.DailyPreferential);return t?t.RedTipsEvents():[]},isAccumulatedRechargeRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.AccumulatedRecharge);return!!t&&t.redPointTip()},accumulatedRechargeRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.AccumulatedRecharge);return t?t.redPointEvts():[]},isLevelGiftRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.LevelGift);return!!t&&t.isRedPointTip()},levelGiftRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.LevelGift);return t?t.redPointEvts():[]},isLoginDayGiftRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_4);return!!t&&t.isRedPointTip()},loginDayGiftRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_4);return t?t.redPointEvts():[]},isExtLoginDayGiftRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ExtensionLoginGift);return!!t&&t.hasRedPoint()},extLoginDayGiftRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ExtensionLoginGift);return t?t.redPointEvts():[]},isChallengeHeroRedPoint:function(t){var e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.redPointTip()},challengeHeroRedPointEvts:function(t){var e=td.ActivityDataManager.getActivityControllerByType(t);return e?e.redPointEvts():[]},isOtherRedPointTips:function(){return!1},isHomePageRedPoint:function(){var t=td.MainPanelRedPoint,e=td.GetTableClass(td.TableEnum.EnterBtnConfigTable),i=td.GetTableClass(td.TableEnum.EnterBtnConfigTable);for(var n in t){if((!e.getBtnConfigByBtnName(n)||i.checkCanBtnShow(n))&&t[n].checkFunc())return!0}return!1},homePageRedPointEvts:function(){var t=td.MainPanelRedPoint,e=[];for(var i in t)e=e.concat(t[i].tipEvents());return e},isActivityTokenRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ActivityToken);return!!t&&t.isRedPointTip()},activityTokenRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ActivityToken);return t?t.redPointEvts():[]},isRareTreasureRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_10);return!!t&&t.isRedPointTip()},rareTreasureRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_10);return t?t.redPointEvts():[]},isGemstonePosRedPointTips:function(t){return d.default.getInstance().isGemPosRedPointTips(t)},isGemstonePosUpgradeRedPointTips:function(t){return d.default.getInstance().isGemPosCanUpgrade(t)},isGemstonePosAwakenRedPointTips:function(t){return d.default.getInstance().isGemPosCanAwaken(t)},GemstonePosRedPointEvts:function(){return d.default.getInstance().GemPosRedPointEvents()},isNewServerCarnivalActivityRedPoint:function(t){var e=td.ActivityDataManager.getActivityControllerByType(t);return!!e&&e.isRedPointTip()},newServerCarnivalActivityRedPointEvts:function(t){var e=td.ActivityDataManager.getActivityControllerByType(t);return e?e.redPointEvts():[]},isHookRedPoint:function(){var t=td.PveGeneralCopyManager.getLastHookRewardTime(),e=td.TimeUtil.getTime()-t,i=td.PrerogativeManager.getPrerogative(_.PrerogativeEnum.OfflineMinut);return!!i&&e>=1e3*i.getValue()},hookRedPointEvts:function(){return[td.EventNameEnum.RES_GET_HOOKUP_INFO]},isAwyShareGiftRedPoint:function(){if(DX_CHANNEL!=SdkType.AWY)return!1;var t=td.Account.getUserData(),e=g.getInstance()._userManager.hadShare(),i=!t.getShareRewardState();return e&&i},isAwyVerifyGiftRedPoint:function(){if(DX_CHANNEL!=SdkType.AWY)return!1;var t=td.Account.getUserData(),e=g.getInstance()._userManager.isVerify(),i=!t.getVerifyRewardState();return e&&i},isAwyFocusGiftRedPoint:function(){if(DX_CHANNEL!=SdkType.AWY)return!1;var t=td.Account.getUserData(),e=g.getInstance()._userManager.isFocusVX(),i=!t.getFocusRewardState();return e&&i},awyGiftRedPointEvts:function(){return[td.EventNameEnum.REFRESH_AWYGIFT]},isTowerMasterRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.TowerMaster);return t?t.isRedPointTip():[]},towerMasterRedPointEvts:function(){return[td.EventNameEnum.REFRESH_TOWER_MASTER_RED_POINT]},isCustomGiftRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_43);return t?t.isRedPointTip():[]},isCustomGift2RedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_44);return t?t.isRedPointTip():[]},customGiftRedPointEvts:function(){return[td.EventNameEnum.REFRESH_COUSTOM_GIFT_INFO]},isGoldHeroBackBuyRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.GoldHeroBackBuy);return t?t.isRedPointTip():[]},goldHeroBackBuyRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.GoldHeroBackBuy);return t?t.redPointEvts():[]},isGoldHeroBackBuyRedPoint2:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.GoldHeroBackBuy2);return t?t.isRedPointTip():[]},goldHeroBackBuyRedPointEvts2:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.GoldHeroBackBuy2);return t?t.redPointEvts():[]},isShowEnterRedPoint:function(){return td.HeroRepayController.isShowEnterRedPoint()},heroRepayRedPointEvts:function(){return td.HeroRepayController.enterRedPointEvts()},isGodPetsFeedbackRedPoint:function(){return td.HeroRepayController2.isShowEnterRedPoint()},godPetsFeedbackRedPointEvts:function(){return td.HeroRepayController2.enterRedPointEvts()},isCumulateGiftRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.CumulateGift);return t?t.isRedPointTip():[]},cumulateGiftRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.CumulateGift);return t?t.redPointEvts():[]},isMonthCardRenewalRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MonthCardRenewal);return!!t&&t.isRedPointTip()},monthCardRenewalRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MonthCardRenewal);return t?t.redPointEvts():[]},isRichmanPlanRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.RichmanPlan);return!!t&&t.isRedPointTip()},richmanPlanRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.RichmanPlan);return t?t.redPointEvts():[]},isBirdBridgePartyRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MagpieBridgeParty);return!(!t||!t.isInOpenStatus())&&t.isBBMeetsEntranceRedPointTip()},birdBridgePartyRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MagpieBridgeParty);return t&&t.isInOpenStatus()?t.bbMeetsEntranceRedPointEvent():[]},isMatchmakerBlessRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MagpieBridgeParty);return!(!t||!t.isInOpenStatus())&&t.isMatchmakerBlessRedPointTip()},matchmakerBlessRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.MagpieBridgeParty);return t&&t.isInOpenStatus()?t.matchmakerBlessRedPointEvent():[]},isPetExchangeRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.PetExchange);return!(!t||!t.isInOpenStatus())&&t.isRedPointTip()},petExchangeRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.PetExchange);return t&&t.isInOpenStatus()?t.redPointEvts():[]},isAuctionRedPoint:function(){var t=h.default.getInstance();return!!t&&t.isRedPointTip()},auctionRedPointEvts:function(){var t=h.default.getInstance();return t?t.redPointEvts():[]},isDouble11KillRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.Double11_Kill);return!!t&&t.isRedPointTip()},double11KillRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.Double11_Kill);return t?t.redPointEvts():[]},isDouble11PreviewRedPoint:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.Double11_Preview);return!!t&&t.isRedPointTip()},double11PreviewRedPointEvts:function(){var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.Double11_Preview);return t?t.redPointEvts():[]}},cc._RF.pop()},{"../../TS/DestroyTemple/Manager/DestroyTempleManager":"DestroyTempleManager","../../TS/Gacha/Manager/GachaEnum":"GachaEnum","../../TS/Gacha/Manager/GachaManager":"GachaManager","../../TS/Roam/Manager/RoamManager":"RoamManager","../../TS/StarUpRoad/Manager/StarUpRoadManager":"StarUpRoadManager","../../TS/Treasure/Manager/TreasureManger":"TreasureManger","../../TS/WorldBoss/Manager/WorldBossManager":"WorldBossManager","../Auction/Manager/AuctionManager":"AuctionManager","../Dipper/Manager/DipperManager":"DipperManager","../Gem/Manager/GemstoneManager":"GemstoneManager","../Shop/Manager/ShopManager":"ShopManager",CommonEnum:void 0,ShopEnum:"ShopEnum",UFSdkManager:void 0}],ResetRechargeController:[function(t,e,i){"use strict";cc._RF.push(e,"de714o1LvxMooAvz7R5EHup","ResetRechargeController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,onOpenPanel:function(){td.GlobalFunction.setLocalSaveStatus("ResetRecharge",!0),td.EventUtil.dispatchEvent(td.EventNameEnum.OPEN_RESETRECHARGE)},hasRedPoint:function(){return!0},redPointEvts:function(){return[td.EventNameEnum.OPEN_RESETRECHARGE]},redPointTip:function(){return this.isRedPointTip()},isRedPointTip:function(){var t=td.GlobalFunction.getLocalSaveStatus("ResetRecharge");return!0!==t&&"true"!==t}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],ResetRechargePanel:[function(t,e,i){"use strict";cc._RF.push(e,"32049asm6pMGaXyQaUCmBOd","ResetRechargePanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,onEnable:function(){this._super(),this._controller.onOpenPanel()},onBtnCharge:function(){td.GlobalFunction.gotoRecharge()}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],ResonancesEnum:[function(t,e,i){"use strict";cc._RF.push(e,"3a3bbLGI+JJzYqSqLj89w+x","ResonancesEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.ResonancesViewType=void 0,function(t){t[t.EQUIPMENT_LEVEL=1]="EQUIPMENT_LEVEL",t[t.EQUIPMENT_FORGE=2]="EQUIPMENT_FORGE",t[t.EQUIPMENT_STAR=3]="EQUIPMENT_STAR",t[t.TREASURE_LEVEL=4]="TREASURE_LEVEL",t[t.TREASURE_EVOLVE=5]="TREASURE_EVOLVE",t[t.TREASURE_STAR=6]="TREASURE_STAR",t[t.EQUIPMENT_EVOLVE=7]="EQUIPMENT_EVOLVE",t[t.NONE=0]="NONE"}(i.ResonancesViewType||(i.ResonancesViewType={})),cc._RF.pop()},{}],ResonateTable:[function(t,e,i){"use strict";cc._RF.push(e,"64956egwKFNqrSNoixjPqgc","ResonateTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ResonateConfig",e._tblName="resonate_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.type;t[r]||(t[r]={}),t[r][a.level]=a}},e.prototype.getDataByTypeAndLv=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].level===e)return i[n]}}return null},e.prototype.getDataByType=function(t){return this._data[t]},e.prototype.getMaxLvByType=function(t){return this._data[t]?this._data[t].length:0},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ResourceSizeTable:[function(t,e,i){"use strict";cc._RF.push(e,"b15bbgvzFVFjZE+T8gL5Spc","ResourceSizeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ResourceSizeTable",properties:{_tblName:"resource_size",_data:null},init:function(){this._data={};for(var t=this._data,e=0,i=this._jsonData.length;e<i;++e){var n=this._jsonData[e];t[n.image]=[n.width,n.height]}},getContentSize:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],RewardItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"36692W38S1C04e5/8TVAhGo","RewardItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeItem=null,e.imgReceived=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.id,a=i.reward,o=r.RewardManager.getRewardDetail(a),s=this.nodeItem.getChildByName("nodeIcon");s||(s=r.GlobalFunction.createCommonIconWidget(37,o),this.nodeItem.addChild(s),s.active=!0,s.name="nodeIcon"),s.getComponent("CommonIconWidget").setData(o);var l=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_26);l&&(this.imgReceived.active=l.isRewardReceived(n))},a([l(cc.Node)],e.prototype,"nodeItem",void 0),a([l(cc.Node)],e.prototype,"imgReceived",void 0),e=a([s,c("module/Activity/RewardItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],RewardManager:[function(t,e,i){"use strict";cc._RF.push(e,"b9201AaceRHcr3G+MCexPHE","RewardManager");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../Pet/Model/PetModel"));var a=t("TreasureModel"),r=t("HeroRuneModel"),o=t("HeroModel"),s=t("EquipModel"),l=t("GemstoneModel"),c=t("HeroArtifactModel"),u=t("SpiritModel");td.RewardManager={_rewardList:null,init:function(){this._addEventListener(),this.destroyData()},destroyData:function(){this._rewardList={}},_addEventListener:function(){var t=td.EventUtil,e={};e[td.EventNameEnum.INIT_REWARD]=this._initRewardData,t.registerEvents(e,this)},_initRewardData:function(){var t=td.GetTableClass(td.TableEnum.Reward).getRewardTable();for(var e in t){var i=new td.RewardModel(t[e]);this._rewardList[i.getId()]=i}},getShowAward:function(t){return this._rewardList[t]},convertCfgType2GoodsType:function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],a={id:n.id,count:n.count},r=td.RewardType;switch(n.type){case r.Resource:case r.Item:a.type=td.GoodsType.Type_Item;break;case r.Mercenary:a.type=td.GoodsType.Type_Mercenary;break;case r.Equipment:a.type=td.GoodsType.Type_Equip;break;case r.Gemstone:a.type=td.GoodsType.Type_Gemstone;break;case r.Artifact:a.type=td.GoodsType.Type_Artifact;break;case r.Treasure:a.type=td.GoodsType.Type_Treasure;break;case r.HeroRune:a.type=td.GoodsType.Type_HeroRune;break;case r.HeroArtifact:a.type=td.GoodsType.Type_Artifact;break;case r.SPIRIT:a.type=td.GoodsType.Type_Spirit;break;case r.Pet:a.type=td.GoodsType.Type_Pet}e[e.length]=a}return e},getRewardListDetailArray:function(t){for(var e=[],i=0;i<t.length;i++)e=e.concat(this.getRewardDetailArray(t[i]));return e},getRewardDetailArray:function(t){return t[0]instanceof Array||(t=[t]),this.parseRewardListDetail(t)},parseRewardListDetail:function(t){if(!t||!t[0])return[];for(var e=[],i=t,n=0;n<i.length;n++){var a=i[n],r=this.getRewardDetail(a);null!==r&&e.push(r)}return e},getRewardDetail:function(t){if(t instanceof Array&&3===t.length){var e=t;(t={}).type=e[0],t.id=e[1],t.count=e[2]}var i=td.RewardType,d=null;switch(t.type){case i.Resource:(d=new td.Item).init(td.GetTableClass(td.TableEnum.Item).getItemById(t.id)),cc.assert(d.isResource(),"\u8d44\u6e90\u7c7b\u578b\u914d\u6210\u9053\u5177\u7c7b\u578b\u4e86,\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\u9519\u9519\u9519\u9519\u9519");break;case i.Item:(d=new td.Item).init(td.GetTableClass(td.TableEnum.Item).getItemById(t.id)),cc.assert(!d.isResource(),"\u9053\u5177\u7c7b\u578b\u914d\u6210\u8d44\u6e90\u7c7b\u578b\u4e86\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\u9519\u9519\u9519\u9519\u9519");break;case i.Mercenary:(d=new o).init(td.GetTableClass(td.TableEnum.HeroTable).getHeroById(t.id));break;case i.Equipment:(d=new s).init(td.GetTableClass(td.TableEnum.EquipmentTable).getDataById(t.id));break;case i.Gemstone:(d=new l).init(td.GetTableClass(td.TableEnum.GemstoneTable).getGemstoneById(t.id)),d.setLevel(1);break;case i.Treasure:(d=new a).init(td.GetTableClass(td.TableEnum.TreasureTable).getTreasureById(t.id));break;case i.HeroRune:(d=new r).init(td.GetTableClass(td.TableEnum.HeroRuneTable).getHeroRuneById(t.id));break;case i.HeroArtifact:(d=new c).init(td.GetTableClass(td.TableEnum.HeroArtifactTable).getDataByArtifactId(t.id));break;case i.SPIRIT:(d=new u).init(td.GetTableClass(td.TableEnum.SpiritTable).getSpiritById(t.id));break;case i.Pet:(d=new n.default).init(td.GetTableClass(td.TableEnum.PetTable).getPetById(t.id))}return d.setCount(t.count),d},parseRewardResult:function(t,e){if(!t)return[];var i=[],n=null;if(t.diamond&&0!==t.diamond&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.Diamond,n.count=t.diamond,i.push(n)),t.gold&&0!==t.gold&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.Gold,n.count=t.gold,i.push(n)),t.energy&&0!==t.energy&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.Energy,n.count=t.energy,i.push(n)),t.arenaCoin&&0!==t.arenaCoin&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.ArenaCoin,n.count=t.arenaCoin,i.push(n)),t.mine&&0!==t.mine&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.MINE,n.count=t.mine,i.push(n)),t.worldBossCoin&&0!==t.worldBossCoin&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.WorldBossCoin,n.count=t.worldBossCoin,i.push(n)),t.heroRuneCoin&&0!==t.heroRuneCoin&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.HERO_RUNE_COIN,n.count=t.heroRuneCoin,i.push(n)),t.mindVowel&&0!==t.mindVowel&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.MIND_VOWEL,n.count=t.mindVowel,i.push(n)),t.skyJade&&0!==t.skyJade&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.SKY_JADE,n.count=t.skyJade,i.push(n)),t.abyssCoin&&0!==t.abyssCoin&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.AbyssCoin,n.count=t.abyssCoin,i.push(n)),t.battleAchieve&&0!==t.battleAchieve&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.BattleAchieve,n.count=t.battleAchieve,i.push(n)),t.prestige&&0!==t.prestige&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.Prestige,n.count=t.prestige,i.push(n)),t.goodsMap&&t.goodsMap.myLen()>0){var a=t.goodsMap;for(var r in a){var o=a[r];(n={}).type=td.GoodsType.Type_Item,n.id=r,n.count=o,i.push(n)}}if(t.spiritEssence&&0!==t.spiritEssence&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.AbyssCoin,n.count=t.spiritEssence,i.push(n)),t.heroMap&&t.heroMap.myLen()>0){var s=t.heroMap;for(var r in s){var l=s[r];(n={}).type=td.GoodsType.Type_Mercenary,n.id=l,i.push(n)}}if(t.equipmentMap&&t.equipmentMap.myLen()>0){var c=t.equipmentMap;for(var u in c){l=c[u];(n={}).type=td.GoodsType.Type_Equip,n.id=l,i.push(n)}}if(t.heroArtifactMap&&t.heroArtifactMap.myLen()>0){var d=t.heroArtifactMap;for(var h in d){l=d[h];(n={}).type=td.GoodsType.Type_Artifact,n.id=l,i.push(n)}}if(t.runeMap&&t.runeMap.myLen()>0){var p=t.runeMap;for(var _ in p){l=p[_];(n={}).type=td.GoodsType.Type_Gemstone,n.id=l,i.push(n)}}if(t.artifactMap&&t.artifactMap.myLen()>0){var g=t.artifactMap;for(var f in g){l=g[f];(n={}).type=td.GoodsType.Type_Artifact,n.id=l,i.push(n)}}if(t.treasureMap&&t.treasureMap.myLen()>0){var v=t.treasureMap;for(var f in v){l=v[f];(n={}).type=td.GoodsType.Type_Treasure,n.id=l,i.push(n)}}if(t.heroRuneMap&&t.heroRuneMap.myLen()>0){var m=t.heroRuneMap;for(var r in m){l=m[r];(n={}).type=td.GoodsType.Type_HeroRune,n.id=l,i.push(n)}}if(t.nationSciTechPoint&&0!==t.nationSciTechPoint&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.NationStudyPoint,n.count=t.nationSciTechPoint,i.push(n)),t.nationCoin&&0!==t.nationCoin&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.NationCoin,n.count=t.nationCoin,i.push(n)),t.nationExp&&0!==t.nationExp&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.NationExp,n.count=t.nationExp,i.push(n)),t.nationFund&&0!==t.nationFund&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.NationFund,n.count=t.nationFund,i.push(n)),t.amethyst&&0!==t.amethyst&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.Amethyst,n.count=t.amethyst,i.push(n)),t.evilGodCoin&&0!==t.evilGodCoin&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.EvilGodCoin,n.count=t.evilGodCoin,i.push(n)),t.vipExp&&0!==t.vipExp&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.VIP_EXP,n.count=t.vipExp,i.push(n)),t.merit&&0!==t.merit&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.MERIT,n.count=t.merit,i.push(n)),t.supSciTechPoint&&0!==t.supSciTechPoint&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.SUP_SCI_TECH_POINT,n.count=t.supSciTechPoint,i.push(n)),t.fund&&0!==t.fund&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.FUND,n.count=t.fund,i.push(n)),t.ancient&&0!==t.ancient&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.ANCIENT,n.count=t.ancient,i.push(n)),t.crossArenaCoin&&0!==t.crossArenaCoin&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.CROSS_ARENA_COIN,n.count=t.crossArenaCoin,i.push(n)),t.crossCupCoin&&0!==t.crossCupCoin&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.CROSS_CUP_COIN,n.count=t.crossCupCoin,i.push(n)),t.spiritMap&&t.spiritMap.myLen()>0){var y=t.spiritMap;for(var E in y){l=y[E];(n={}).type=td.GoodsType.Type_Spirit,n.id=l,i.push(n)}}if(t.petMap&&t.petMap.myLen()>0){var T=t.petMap;for(var C in T){l=T[C];(n={}).type=td.GoodsType.Type_Pet,n.id=l,i.push(n)}}return t.legendPoint&&0!==t.legendPoint&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.LEGEND_POINT,n.count=t.legendPoint,i.push(n)),t.legendCoin&&0!==t.legendCoin&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.LEGEND_COIN,n.count=t.legendCoin,i.push(n)),t.mazeBeck&&0!==t.mazeBeck&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.MAZE_COIN,n.count=t.mazeBeck,i.push(n)),t.chessCoin&&0!==t.chessCoin&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.CHESS_COIN,n.count=t.chessCoin,i.push(n)),e&&(t.exp&&0!==t.exp&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.Exp,n.count=t.exp,i.push(n)),t.vigour&&0!==t.vigour&&((n={}).type=td.GoodsType.Type_Item,n.id=td.ItemEnum.VIGOUR,n.count=t.vigour,i.push(n))),i}},cc._RF.pop()},{"../../Pet/Model/PetModel":"PetModel",EquipModel:"EquipModel",GemstoneModel:"GemstoneModel",HeroArtifactModel:"HeroArtifactModel",HeroModel:"HeroModel",HeroRuneModel:"HeroRuneModel",SpiritModel:"SpiritModel",TreasureModel:"TreasureModel"}],RewardPreviewWindow:[function(t,e,i){"use strict";cc._RF.push(e,"ed840n7m+5N56YPif1w6Z7Y","RewardPreviewWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{_labTitle:null,_showPanel:null,_tipNode:null,_btn:null},init:function(){this._panelType=td.PanelType.None,this._panelEnum=td.PanelEnum.Window_RewardPreview},onLoad:function(){this._super();var t=this._root.getChildByName("imgTitleBg");this._labTitle=t.getChildByName("labTitle"),this._showPanel=this._root.getChildByName("rewardShowPanel"),this._tipNode=this._root.getChildByName("imgTipBg"),this._btn=this._root.getChildByName("btn")},setData:function(t){var e=t.strTitle||td.Language.rewardPreview;this.setTitle(e);var i=t.strTip||"";this.setTip(i);var n=t.rewards||[];this.setShowPanel(n);var a=t.isShowBtn||!1;this._btn.active=a},setTitle:function(t){this._labTitle.getComponent(cc.Label).string=t},setShowPanel:function(t){this._showPanel.removeAllChildren();var e=this._showPanel.getContentSize();if(0===t.length){var i=new cc.Node,n=i.addComponent(cc.Label);return n.fontSize=32,n.string="\u5f53\u524d\u6ca1\u6709\u4efb\u4f55\u5956\u52b1\uff0c\u8bf7\u786e\u8ba4\u4e4b\u540e\u518d\u8bd5\uff01",i.setPosition(cc.v2(e.width/2,-e.height/2)),void this._showPanel.addChild(i)}for(var a=0,r=t.length;a<r;a++){var o=t[a],s=td.GlobalFunction.createCommonIconWidget(27,o);s.setScale(.9),this._showPanel.addChild(s)}this._showPanel.getComponent(cc.Layout).updateLayout()},setTip:function(t){t?(this._tipNode.active=!0,this._tipNode.getChildByName("labTip").getComponent(cc.RichText).string=t):this._tipNode.active=!1},onBtnClose:function(){this.closeCallFunc()}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],RewardWindowItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"ee255X0AN5JQ6i7+QwTrTrf","RewardWindowItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeItems=null,e.labFloor=null,e.nodeModel=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i,a=e+1;this.labFloor.string=cc.js.formatStr(r.Language.godEquipGachaFloor,a),this.node.name="item"+e;var o=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.GodEquipGacha);if(o)for(var s=0;s<n.length;s++){var l=n[s],c=l[0],u=l[1][0],d=r.RewardManager.getRewardDetail(u),h=this.nodeItems.getChildByName("icon"+s);if(null==h){var p=(h=cc.instantiate(this.nodeModel)).getChildByName("nodeItem"),_=r.GlobalFunction.createCommonIconWidget(58,d);_.parent=p,h.parent=this.nodeItems,h.name="icon"+s,h.item=_}h.item.getComponent("CommonIconWidget").setData(d),h.getChildByName("imgReceived").active=o.getCurScore()>=c}},a([l(cc.Node)],e.prototype,"nodeItems",void 0),a([l(cc.Label)],e.prototype,"labFloor",void 0),a([l(cc.Node)],e.prototype,"nodeModel",void 0),e=a([s,c("module/Activity/RewardWindowItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],RichmanDayTaskTable:[function(t,e,i){"use strict";cc._RF.push(e,"bddd2K8l3BBfLv2u4IAm3G+","RichmanDayTaskTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="RichmanDayTaskTable",e._tblName="rich_training_task_config",e._data={},e}return n(e,t),e.prototype.init=function(){for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t],i=e.data,n=e.day;this._data[i]||(this._data[i]={}),this._data[i][n]=e}},e.prototype.getData=function(t){return this._data[t]},e.prototype.getDataByDay=function(t,e){return this._data[t]?this._data[t][e]:null},e.prototype.getFirstStageDays=function(t){var e=0;for(var i in this._data[t])e=Math.max(e,parseInt(i));return e},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],RichmanPlanController:[function(t,e,i){"use strict";cc._RF.push(e,"627ce0eKxxM57i/Jg/PHbem","RichmanPlanController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataId=null,e._stage=1,e._poolNum=0,e._day=0,e._allAchieve=0,e._dayAchieve=0,e._round=0,e._lastPoint=1,e._gotton=[],e._getTimes=0,e._turnMap={},e._maxTurnTimes=12,e._recharge=0,e}return n(e,t),e.prototype.activityParse=function(t){var e=t.record;this._day=e.day,this._poolNum=e.prizePool,this._dayAchieve=e.taskCount,this._allAchieve=e.totalTaskCount,this._lastPoint=e.lastPoint,this._gotton=e.getRewards,this._getTimes=e.hasTavernTime,this._turnMap=e.turnTable,this._recharge=e.recharge,this._maxTurnTimes=this._turnMap.myLen(),this._dataId=this.getActivityData(),this._stage=this._day<=td.GetTableClass(td.TableEnum.RichmanDayTaskTable).getFirstStageDays(this._dataId)?1:2,td.EventUtil.dispatchEvent(td.EventNameEnum.RICHMAN_PLAN_REFRESH_UI)},e.prototype.onOpenPanel=function(){this._isPanelOpened=!0,td.GlobalFunction.setLocalSaveStatus("RichmanPlanPanel","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.RICHMANPLAN_PANEL_SHOW)},e.prototype.isShowedToday=function(){return td.GlobalFunction.getLocalSaveStatus("RichmanPlanPanel")},e.prototype.setDataId=function(t){this._dataId=t},e.prototype.getDataId=function(){return this._dataId},e.prototype.getStage=function(){return this._stage},e.prototype.getPoolNum=function(){return this._poolNum},e.prototype.getDay=function(){return this._day},e.prototype.getAllAchieve=function(){return this._allAchieve},e.prototype.getDayAchieve=function(){return this._dayAchieve},e.prototype.getRound=function(){return this._dayAchieve+1},e.prototype.getTurnMap=function(){return this._turnMap},e.prototype.getRecharge=function(){return Math.floor(this._recharge/10)},e.prototype.getGotton=function(){return this._gotton},e.prototype.getLastPoint=function(){return this._lastPoint},e.prototype.getTurnTimes=function(){return this._getTimes},e.prototype.getMaxTurnTimes=function(){return this._maxTurnTimes},e.prototype.getTickets=function(){return td.ItemManager.getItemNumById(td.ItemEnum.RichmanPlanTickets)},e.prototype.getMaxPoolNum=function(){var t=0,e=td.GetTableClass(td.TableEnum.RichmanDayTaskTable).getData(this._dataId);for(var i in e)for(var n=e[i].taskIds,a=0;a<n.length;a++){var r=n[a];t+=this.getTaskConfig(r).active}return t+=td.GetConfig("ACTIVITY_99_INITIAL_PRIZE_POOL")},e.prototype.getTaskConfig=function(t){return td.GetTableClass(td.TableEnum.TaskTable).getTaskById(t)},e.prototype.getCurDayTasks=function(){var t=this.getCurDayTaskByStatus(td.TaskStatus.Finish),e=this.getCurDayTaskByStatus(td.TaskStatus.Progress),i=this.getCurDayTaskByStatus(td.TaskStatus.Received);return t.concat(e).concat(i)},e.prototype.getCurDayTaskByStatus=function(t){for(var e=td.GetTableClass(td.TableEnum.RichmanDayTaskTable).getDataByDay(this._dataId,this._day).taskIds,i=[],n=0,a=e.length;n<a;n++){var r=td.TaskManager.getTaskById(e[n]);r.getStatus()==t&&i.push(r)}return i},e.prototype.getMaxTaskNum=function(){return td.GetTableClass(td.TableEnum.RichmanDayTaskTable).getDataByDay(this._dataId,this._day).taskIds.length},e.prototype.isGotton=function(t){for(var e=0;e<this.getGotton().length;e++){if(this.getGotton()[e]==t)return!0}return!1},e.prototype.getTurnCost=function(){return td.GetTableClass(td.TableEnum.RichmanTurntableCostTable).getCost(this._dataId,this._getTimes+1)},e.prototype.getRechargeTarget=function(){return td.GetTableClass(td.TableEnum.Config).getConfig("ACTIVITY_99_ACCUMULATED_DOUBLED_AMOUNT")},e.prototype.hasRedPoint=function(){return!0},e.prototype.isRedPointTip=function(){if(this._dataId=this.getActivityData(),!this.isShowedToday())return!(2==this._stage&&this._getTimes>=this._maxTurnTimes);if(1==this._stage){if(this.getCurDayTaskByStatus(td.TaskStatus.Finish).length>0)return!0}else if(2==this._stage){if(this._getTimes>=this._maxTurnTimes)return!1;if(this.getTickets()>=this.getTurnCost())return!0;for(var t=td.GetTableClass(td.TableEnum.RichmanTurntableTaskTable).getData(this._dataId).taskIds,e=0;e<t.length;e++){var i=t[e];if(td.TaskManager.getTaskById(i).getStatus()==td.TaskStatus.Finish)return!0}}return!1},e.prototype.redPointEvts=function(){return[td.EventNameEnum.RICHMANPLAN_PANEL_SHOW,td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,td.EventNameEnum.Recharge_Success,td.EventNameEnum.ON_ACTIVITY_OPEN,td.EventNameEnum.ON_ACTIVITY_CLOSED,td.EventNameEnum.ACTIVITY_CLICKED,td.EventNameEnum.PUSH_ACTIVITY_INFO,td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.Res_GET_TASK_INFO]},e.prototype.isShowGetRedPoint=function(){if(2!=this._stage)return!1;if(this.isShowedToday())for(var t=td.GetTableClass(td.TableEnum.RichmanTurntableTaskTable).getData(this._dataId).taskIds,e=0;e<t.length;e++){var i=t[e];if(td.TaskManager.getTaskById(i).getStatus()==td.TaskStatus.Finish)return!0}else for(t=td.GetTableClass(td.TableEnum.RichmanTurntableTaskTable).getData(this._dataId).taskIds,e=0;e<t.length;e++){i=t[e];if(td.TaskManager.getTaskById(i).getStatus()==td.TaskStatus.Progress)return!0}return!1},e.prototype.reqActInfo=function(){td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,this._activityId)},e}(t("ActivityBaseController"));i.default=a,e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],RichmanPlanModel:[function(t,e,i){"use strict";cc._RF.push(e,"884b1U0gxpPYYSoQOLpeDfI","RichmanPlanModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._dataId=null,this._stage=1,this._poolNum=0,this._day=0,this._allAchieve=0,this._dayAchieve=0,this._round=0}return t.prototype.initData=function(t){},t.prototype.setData=function(t){},t.prototype.setDataId=function(t){this._dataId=t},t.prototype.getDataId=function(){return this._dataId},t.prototype.getStage=function(){return this._stage},t.prototype.getPoolNum=function(){return this._poolNum},t.prototype.getDay=function(){return this._day},t.prototype.getAllAchieve=function(){return this._allAchieve},t.prototype.getDayAchieve=function(){return this._dayAchieve},t.prototype.getRound=function(){return this._round},t.prototype.getStatus=function(){return this.isUnlock()?this._count>=this._maxCount?td.ActivityEnum.OperateStatus.Operated:td.ActivityEnum.OperateStatus.OperateAble:td.ActivityEnum.OperateStatus.NotOperateAble},t.prototype.getTask=function(){for(var t=[],e=td.UnlockManager.getUnlockConfigById(this._unlockId).getCondition(),i=0;i<e.length;i++){var n=e[i],a=td.TaskManager.getTaskById(n.value);t.push(a)}return t},t.prototype.isUnlock=function(){return td.UnlockManager.isTargetUnlockById(this._unlockId,!1)},t}();i.default=n,cc._RF.pop()},{}],RichmanPlanPanelTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"9985da2EgdOKooJTn6gwjN2","RichmanPlanPanelTaskItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeReward=null,e.labTaskDesc=null,e.labReward1=null,e.labReward2=null,e.labProgress=null,e.btnOperate=null,e.imgGotton=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._task=i,this._controller=this._customData;var n=i,a=r.RewardManager.getRewardDetail(n.getRewards()[0]),o=this.nodeReward.getChildByName("itemIcon");o?o.getComponent("CommonIconWidget").setData(a):((o=r.GlobalFunction.createCommonIconWidget(26,a)).name="itemIcon",this.nodeReward.addChild(o)),this.labTaskDesc.string=n.getDes(),this.labReward1.string=a.getName()+"x"+a.getCount(),this.labReward2.string=r.Language.poolDiamondNum+"+"+n.getActive(),this.labProgress.string=Math.min(n.getValue(),n.getNeedValue())+"/"+n.getNeedValue(),n.getStatus()==r.TaskStatus.Received?(this.imgGotton.active=!0,this.btnOperate.active=!1):(this.imgGotton.active=!1,this.btnOperate.active=!0,n.getStatus()==r.TaskStatus.Progress?(r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.GY_Common,r.resDef.GY_Common.GY_anniu_02,this.btnOperate),this.btnOperate.getChildByName("labPrice").getComponent(cc.Label).string=r.Language.goto,this.btnOperate.getChildByName("labPrice").color=cc.color(176,79,0)):n.getStatus()==r.TaskStatus.Finish&&(r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.GY_Common,r.resDef.GY_Common.GY_anniu_03,this.btnOperate),this.btnOperate.getChildByName("labPrice").getComponent(cc.Label).string=r.Language.textReceive,this.btnOperate.getChildByName("labPrice").color=cc.color(16,98,161))),r.RedPointUtil.createRedPointSimple(this.btnOperate,{x:-10,y:-10},this.isShowGotoRedPoint())},e.prototype.onOperateClick=function(){if(1==this._controller.getStage()){var t=this._task;if(t.getStatus()==r.TaskStatus.Progress){var e=t.getGotoPanel(),i=null;e[1]&&(i=e[1]),r.PanelJumpManager.jumpToPanel(e[0],i)}else t.getStatus()==r.TaskStatus.Finish&&this._controller.operateActivity({id:t.getId(),parmeterMap:{50:1}})}},e.prototype.isShowGotoRedPoint=function(){if(1==this._controller.getStage()){var t=this._task;return t.getStatus()==r.TaskStatus.Finish||!this.isShowedToday()&&t.getStatus()==r.TaskStatus.Progress}},e.prototype.isShowedToday=function(){return r.GlobalFunction.getLocalSaveStatus("RichmanPlanPanel")},a([c(cc.Node)],e.prototype,"nodeReward",void 0),a([c(cc.Label)],e.prototype,"labTaskDesc",void 0),a([c(cc.Label)],e.prototype,"labReward1",void 0),a([c(cc.Label)],e.prototype,"labReward2",void 0),a([c(cc.Label)],e.prototype,"labProgress",void 0),a([c(cc.Node)],e.prototype,"btnOperate",void 0),a([c(cc.Node)],e.prototype,"imgGotton",void 0),e=a([l],e)}(o);i.default=u,cc._RF.pop()},{ListItem:void 0}],RichmanPlanPanel:[function(t,e,i){"use strict";cc._RF.push(e,"c21871lWWFFR4kzWRQrhvqu","RichmanPlanPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTime=null,e.nodeStage1=null,e.imgDouble=null,e.nodeTasks=null,e.probar=null,e.labPoolNum=null,e.labRechargeTip=null,e.labRechargeNum=null,e.nodeStage2=null,e.nodeIcons=null,e.nodeSelect=null,e.nodePercentage=null,e.labTicketsTip=null,e.labActEnd=null,e.labCost=null,e.labTotalNum=null,e.layTotalNum=null,e.labTicketNum=null,e.btnGetTickets=null,e.btnTurn=null,e.nodeCost=null,e.nodeCantTurn=null,e._coordinates=[cc.v2(-268,132),cc.v2(-134,132),cc.v2(0,132),cc.v2(134,132),cc.v2(268,132),cc.v2(268,0),cc.v2(268,-132),cc.v2(134,-132),cc.v2(0,-132),cc.v2(-134,-132),cc.v2(-268,-132),cc.v2(-268,0)],e._activityType=0,e._controller=null,e._rewards=null,e._oldIndex=1,e._isTrunning=!1,e._isInitTaskList=!1,e}return n(e,t),e.prototype.init=function(){this._panelType=c.PanelType.Panel,this._panelEnum=c.PanelEnum.Panel_RichmanPlan},e.prototype.onLoad=function(){},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),c.EventUtil.dispatchEvent(c.EventNameEnum.HIDE_MAIN_LAYER_BOTTOM_LAYER),c.ActivityDataManager.getActivityControllerByType(c.ActivityEnum.ActivityType.RichmanPlan).onOpenPanel(),this.schedule(this._updateTime,1),this._addEventListener(),this._refreshUI()},e.prototype.onDisable=function(){c.EventUtil.unregisterAllEvents(this),this.unschedule(this._updateTime),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){c.EventUtil.registerEvent(c.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS,this.onReceiveOperation,this),c.EventUtil.registerEvent(c.EventNameEnum.RICHMAN_PLAN_REFRESH_UI,this._refreshUI,this),c.EventUtil.registerEvent(c.EventNameEnum.Res_GET_TASK_INFO,this._refreshUI,this),c.EventUtil.registerEvent(c.EventNameEnum.ON_TIME_OVER_DAY,this._reqActInfo,this)},e.prototype._reqActInfo=function(){this._controller.reqActInfo()},e.prototype._refreshUI=function(){var t=this._controller;t||(this._controller=c.ActivityDataManager.getActivityControllerByType(c.ActivityEnum.ActivityType.RichmanPlan),t=this._controller),this._updateTime();var e=t.getStage();if(1==e){this.nodeStage1.active=!0,this.nodeStage2.active=!1,this.probar.progress=t.getPoolNum()/t.getMaxPoolNum(),this.labPoolNum.string=t.getPoolNum()+c.Language.diamond,this.labRechargeTip.string=cc.js.formatStr(c.Language.richmanPlanRechargeTip,t.getRechargeTarget());var i="";t.getRecharge()>=t.getRechargeTarget()?(this.imgDouble.active=!0,i=t.getRechargeTarget()+""):(this.imgDouble.active=!1,i="<color=#ff0000>"+t.getRecharge()+"</c>"),this.labRechargeNum.string=cc.js.formatStr("(%s/"+t.getRechargeTarget()+")",i);var n=t.getCurDayTasks(),a=this.nodeTasks.getComponent("OptimizeVerticalListView");a.setCustomData(t),this._isInitTaskList?a.refreshCurList(n):(a.refreshListData(n),this._isInitTaskList=!0)}else if(2==e){this.nodeStage1.active=!1,this.nodeStage2.active=!0,this._isTrunning||this._refreshTurnItem();var r=t.getTurnTimes();this._oldIndex=0==r?0:t.getLastPoint(),r<t.getMaxTurnTimes()?(this.labCost.string=t.getTurnCost().toString(),this.nodeCost.active=!0,this.nodeCantTurn.active=!1,c.GlobalFunction.setButtonGray(this.btnTurn,!1)):(this.nodeCost.active=!1,this.nodeCantTurn.active=!0,c.GlobalFunction.setButtonGray(this.btnTurn,!1)),this.labTicketsTip.string=c.Language.richmanPlanTickets+"\uff1a",this.labActEnd.string=c.Language.richmanPlanActEndTip,this.labTicketNum.string=t.getTickets().toString(),this.labTotalNum.string=t.getPoolNum().toString(),this.labTotalNum._forceUpdateRenderData(),this.layTotalNum.updateLayout(),c.RedPointUtil.createRedPointSimple(this.btnGetTickets,{x:-10,y:-10},t.isShowGetRedPoint())}},e.prototype.onReceiveOperation=function(t){var e=this._controller.getStage();if(1==e){var i=t.rewardResult,n=c.RewardManager.parseRewardResult(i,!0);c.GlobalFunction.showRewards(n)}else 2==e&&(this._rewards=t.rewardResult,this.showAni(this._controller.getLastPoint()-1));this._refreshUI()},e.prototype.onTurnClick=function(){var t=this._controller;2==t.getStage()&&(this._isTrunning||(t.getTickets()<t.getTurnCost()?this.onGetTicketsClick():t.getTurnTimes()>=t.getMaxTurnTimes()||(this._isTrunning=!0,c.EventUtil.dispatchEvent(c.EventNameEnum.PAUSE_UPDATE_MAIN_LAYER_DIAMOND),t.operateActivity({parmeterMap:{50:2}}))))},e.prototype.onGetTicketsClick=function(){2==this._controller.getStage()&&c.PanelJumpManager.jumpToPanel(c.PanelEnum.Window_RichmanPlanTask)},e.prototype._updateTime=function(){var t=c.ActivityDataManager.getActivityControllerByType(c.ActivityEnum.ActivityType.RichmanPlan);if(t){var e=t.getCurrentOpenStage();if(e){var i=e.openTime,n=e.closeTime,a=c.TimeUtil.getTime(),r=0,o=t.getStage();1==o?r=i+86400*c.GetTableClass(c.TableEnum.RichmanDayTaskTable).getFirstStageDays(t.getDataId())*1e3-a:2==o&&(r=n-a),r=Math.max(r,0),this.labTime.string=c.Language["richmanPlanLeftTime"+o]+c.GlobalFunction.getTimeStringByDeltaTime(r)}else this.closeCallFunc()}else this.closeCallFunc()},e.prototype._refreshTurnItem=function(){var t=this._controller,e=t.getTurnMap(),i=c.GetTableClass(c.TableEnum.RichmanTurntableRewardTable);this.nodePercentage.active=!1;for(var n=0;n<this._coordinates.length;n++){var a=n+1,r=i.getDataByPoint(t.getDataId(),a),o=c.RewardManager.getRewardDetail([10,1,e[a]]),s=this.nodeIcons.getChildByName("icon"+a);if(s)s.getComponent("CommonIconWidget").setData(o);else{(s=c.GlobalFunction.createCommonIconWidget(26,o)).setScale(1),s.setPosition(this._coordinates[n]),s.name="icon"+a,this.nodeIcons.addChild(s);var l=cc.instantiate(this.nodePercentage);l.active=!0,l.getChildByName("Label").getComponent(cc.Label).string=r.Proportion+"%"+c.Language.richmanPlanRewardPool,l.setParent(this.nodeIcons),l.setPosition(cc.v2(this._coordinates[n].x-22,this._coordinates[n].y+27));var u=new cc.Node;u.setPosition(this._coordinates[n].x,this._coordinates[n].y),u.setScale(.7),this.nodeIcons.addChild(u),c.GlobalFunction.createAltasSprite(c.resDef.pngPlist.GY0_Common,"GY0_wz_yilingqu_02",u),u.name="imgGotton"+a}var d=s.getChildByName("qualityBgImg"),h=c.QualityBgImg[r.bgQuality];c.GlobalFunction.createAltasSprite(c.resDef.pngPlist.GY_Common,h,d);var p=s.getChildByName("headImg");c.GlobalFunction.createAltasSprite(c.resDef.pngPlist.Acitivty_53_fwjh,r.icon,p),s.getComponent("CommonIconWidget").setMaskShow(t.isGotton(a)),this.nodeIcons.getChildByName("imgGotton"+a).active=t.isGotton(a)}this.nodeSelect.setPosition(this._coordinates[this._controller.getLastPoint()-1]),this.nodeSelect.zIndex=cc.macro.MAX_ZINDEX},e.prototype.showAni=function(t){this._isTrunning=!0,this.nodeSelect.stopAllActions(),this._oldIndex=t;var e=new cc.MoveArround(3,this._coordinates,t,2).easing(cc.easeSineOut()),i=cc.sequence(e,cc.delayTime(.2),cc.callFunc(this.showLigth,this),cc.delayTime(1),cc.callFunc(this.showReward,this));this.nodeSelect.runAction(i),c.EventUtil.dispatchEvent(c.EventNameEnum.PLAY_SOUND,c.SoundEnum.TURN_SOUND)},e.prototype.showLigth=function(){for(var t=1;t<=6;t++)gdk.Timer.once(200*t,this,this.switchLigth,[],!1)},e.prototype.switchLigth=function(){this.nodeSelect.active=!this.nodeSelect.active},e.prototype.showReward=function(){var t=c.RewardManager.parseRewardResult(this._rewards,!0);c.GlobalFunction.showRewards(t),this._refreshTurnItem(),this._rewards=null,c.EventUtil.dispatchEvent(c.EventNameEnum.RESUME_UPDATE_MAIN_LAYER_DIAMOND),this._isTrunning=!1},e.prototype._addEffectNode=function(){var t=c.GlobalFunction.getResIdByNode(this.node),e=this,i="uiAnima/FW_effect/FW_effect";gdk.rm.loadRes(t,i,cc.Prefab,function(){var t=gdk.rm.getResByUrl(i,cc.Prefab);e._effect=cc.instantiate(t),e.nodeStage1.addChild(e._effect),e._showEffect()})},e.prototype._showEffect=function(){this._effect?this._effect.getComponent(cc.Animation).play():this._addEffectNode()},a([s(cc.Label)],e.prototype,"labTime",void 0),a([s(cc.Node)],e.prototype,"nodeStage1",void 0),a([s(cc.Node)],e.prototype,"imgDouble",void 0),a([s(cc.Node)],e.prototype,"nodeTasks",void 0),a([s(cc.ProgressBar)],e.prototype,"probar",void 0),a([s(cc.Label)],e.prototype,"labPoolNum",void 0),a([s(cc.Label)],e.prototype,"labRechargeTip",void 0),a([s(cc.RichText)],e.prototype,"labRechargeNum",void 0),a([s(cc.Node)],e.prototype,"nodeStage2",void 0),a([s(cc.Node)],e.prototype,"nodeIcons",void 0),a([s(cc.Node)],e.prototype,"nodeSelect",void 0),a([s(cc.Node)],e.prototype,"nodePercentage",void 0),a([s(cc.Label)],e.prototype,"labTicketsTip",void 0),a([s(cc.Label)],e.prototype,"labActEnd",void 0),a([s(cc.Label)],e.prototype,"labCost",void 0),a([s(cc.Label)],e.prototype,"labTotalNum",void 0),a([s(cc.Layout)],e.prototype,"layTotalNum",void 0),a([s(cc.Label)],e.prototype,"labTicketNum",void 0),a([s(cc.Node)],e.prototype,"btnGetTickets",void 0),a([s(cc.Node)],e.prototype,"btnTurn",void 0),a([s(cc.Node)],e.prototype,"nodeCost",void 0),a([s(cc.Node)],e.prototype,"nodeCantTurn",void 0),e=a([o,l("module/Activity/RichmanPlanPanel")],e)}(t("PanelBase"));i.default=u,cc._RF.pop()},{PanelBase:void 0}],RichmanPlanTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"fe945eSkgxAHJYl5TB6GcDX","RichmanPlanTaskItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labDesc=null,e.labProTitle=null,e.labProgress=null,e.labNum=null,e.btnGoto=null,e.btnGet=null,e.imgGot=null,e.numBg=null,e.nodeReward=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._task=i;var n=r.RewardManager.getRewardDetail(i.getRewards()[0]),a=this.nodeReward.getChildByName("itemIcon");a?a.getComponent("CommonIconWidget").setData(n):((a=r.GlobalFunction.createCommonIconWidget(26,n)).name="itemIcon",this.nodeReward.addChild(a)),this.labDesc.string=i.getDes(),this.labProTitle.string=r.Language.progress+":";var o=i.getValue(),s=i.getNeedValue();i.getConditionType()==r.TaskConditionType.ACTOR_ACTIVITY41_TOTAL_RECHARGE&&(o/=10,s/=10),this.labProgress.string=o+"/"+s,this.btnGoto.active=2==i.getStatus(),this.btnGet.active=3==i.getStatus(),this.imgGot.active=4==i.getStatus()},e.prototype.onJump=function(){var t=this._task.getGotoPanel(),e=null;t[1]&&(e=t[1]),r.PanelJumpManager.jumpToPanel(t[0],e)},e.prototype.onReward=function(){r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.RichmanPlan)&&(r.EventUtil.dispatchEvent(r.EventNameEnum.Req_TASK_RECEIVE,this._task.getId()),r.EventUtil.dispatchEvent(r.EventNameEnum.RICHMAN_PLAN_GET_TICKETS,this._task.getActive()))},a([c(cc.Label)],e.prototype,"labDesc",void 0),a([c(cc.Label)],e.prototype,"labProTitle",void 0),a([c(cc.Label)],e.prototype,"labProgress",void 0),a([c(cc.Label)],e.prototype,"labNum",void 0),a([c(cc.Node)],e.prototype,"btnGoto",void 0),a([c(cc.Node)],e.prototype,"btnGet",void 0),a([c(cc.Node)],e.prototype,"imgGot",void 0),a([c(cc.Node)],e.prototype,"numBg",void 0),a([c(cc.Node)],e.prototype,"nodeReward",void 0),e=a([l],e)}(o);i.default=u,cc._RF.pop()},{ListItem:void 0}],RichmanPlanTaskWindow:[function(t,e,i){"use strict";cc._RF.push(e,"2f7a5dNO7RCrbM7N2wPU/xL","RichmanPlanTaskWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scroTask=null,e._getTicketsNum=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_RichmanPlanTask},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.RICHMAN_PLAN_GET_TICKETS]=this._setTicketsNum,t[e.Res_TASK_RECEIVE]=this._receiveTaskSuc,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(){t.prototype.setData.call(this),this._refreshList()},e.prototype._refreshList=function(){for(var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.RichmanPlan).getActivityData(),e=r.GetTableClass(r.TableEnum.RichmanTurntableTaskTable).getData(t).taskIds,i=[],n=0;n<e.length;n++){var a=e[n],o=r.TaskManager.getTaskById(a),s=o.getStatus();s==r.TaskStatus.Finish?o.order=1:s==r.TaskStatus.Progress?o.order=2:s==r.TaskStatus.Finish?o.order=3:o.order=4,i.push(o)}i.sort(function(t,e){return t.order!=e.order?t.order-e.order:t.getSortRank()!=e.getSortRank()?t.getSortRank()-e.getSortRank():t.getId()-e.getId()}),this.scroTask.getComponent("OptimizeVerticalListView").refreshListData(i)},e.prototype._receiveTaskSuc=function(t){var e=r.RewardManager.parseRewardListDetail(t,!0);r.GlobalFunction.showRewards(e),this._refreshList()},e.prototype._setTicketsNum=function(t){this._getTicketsNum=t},e.prototype.closeCallFunc=function(){t.prototype.closeCallFunc.call(this)},a([l(cc.Node)],e.prototype,"scroTask",void 0),e=a([s],e)}(t("PanelBase"));i.default=c,cc._RF.pop()},{PanelBase:void 0}],RichmanTurntableCostTable:[function(t,e,i){"use strict";cc._RF.push(e,"6c3b6WAlLRK3p+S+jGvwUmj","RichmanTurntableCostTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="RichmanTurntableCostTable",e._tblName="rich_training_consume_config",e._data={},e}return n(e,t),e.prototype.init=function(){for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t],i=e.data;this._data[i]=e}},e.prototype.getCost=function(t,e){for(var i=this._data[t].cost,n=0;n<i.length;n++){var a=i[n];if(a[0]==e)return a[1]}},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],RichmanTurntableRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"73b78rzjftBDYmTP+vcIrd6","RichmanTurntableRewardTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="RichmanTurntableRewardTable",e._tblName="rich_training_turntable_config",e._data={},e}return n(e,t),e.prototype.init=function(){for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t],i=e.data;this._data[i]||(this._data[i]=[]),this._data[i].push(e)}},e.prototype.getData=function(t){return this._data[t]},e.prototype.getDataByPoint=function(t,e){for(var i=this._data[t],n=0;n<i.length;n++){var a=i[n];if(e==a.pointId)return a}},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],RichmanTurntableTaskTable:[function(t,e,i){"use strict";cc._RF.push(e,"a1a163OEcNNj7VullS1TUzY","RichmanTurntableTaskTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="RichmanTurntableTaskTable",e._tblName="rich_training_table_task_config",e._data={},e}return n(e,t),e.prototype.init=function(){for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t],i=e.data;this._data[i]=e}},e.prototype.getData=function(t){return this._data[t]},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],RoamConfigTable:[function(t,e,i){"use strict";cc._RF.push(e,"4a911QIob1Po4POAeSwfMV7","RoamConfigTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="RoamConfigTable",e._tblName="roam_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];this._data.push(n)}this._data.sort(function(t,e){return t.level-e.level});for(var a=0;a<this._data.length;a++){var r=this._data[a];if(a+1<this._data.length){var o=this._data[a+1];r.maxLv=o.level}else r.maxLv=999999}},e.prototype.getMaxtimeByLv=function(t){for(var e=this._data[0].maxTimes,i=0;i<this._data.length;i++){var n=this._data[i];if(t>=n.level&&t<n.maxLv)return n.maxTimes}return e},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],RoamEnum:[function(t,e,i){"use strict";cc._RF.push(e,"fdd33t3+ixIKKIm1m0XrpoY","RoamEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.RoamGiftRedPointOffset=i.RoamGiftRes=i.SelectRoamType=i.RoamType=void 0,function(t){t[t.NONE=0]="NONE",t[t.NORMAL=1]="NORMAL",t[t.QUICK=2]="QUICK"}(i.RoamType||(i.RoamType={})),function(t){t[t.NONE=0]="NONE",t[t.AUTO=1]="AUTO",t[t.ONE_KEY=2]="ONE_KEY"}(i.SelectRoamType||(i.SelectRoamType={})),i.RoamGiftRes={0:{1:"GY0_baoxiang01",2:"GY0_baoxiang01",3:"GY0_baoxiang02"},1:{1:"GY0_baoxiang03",2:"GY0_baoxiang03",3:"GY0_baoxiang04"}},i.RoamGiftRedPointOffset={0:cc.v2(10,0),1:cc.v2(10,0),2:cc.v2(-20,-5)},cc._RF.pop()},{}],RoamLuckModel:[function(t,e,i){"use strict";cc._RF.push(e,"f1b681zmdFDDKdbez+cgUGL","RoamLuckModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=window.td,r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e){if(e){t.prototype.init.call(this,"RoamLuckModel",e.attributes);var i=e.rewardList;this._rewards=a.RewardManager.parseRewardListDetail(i)}},e.prototype.getLuckRewards=function(){return this._rewards},e}(t("BaseUser"));e.exports=r,cc._RF.pop()},{BaseUser:"BaseUser"}],RoamManager:[function(t,e,i){"use strict";cc._RF.push(e,"b2ff0AxdAFG4rWH1EqL+pfi","RoamManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator.ccclass,r=t("RoamRewardModel"),o=t("RoamLuckModel"),s=function(){function t(){this._leftTimes=0,this._maxTimes=0,this._nextRecoverTime=0,this._curTotalProgress=0,this._maxProgress=0,this._buyTimes=0,this._luckMsgCount=4,this._luckMsgIndex=0,this._isPlayTurnTable=!1,this._isInit=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._leftTimes=0,this._maxTimes=0,this._nextRecoverTime=0,this._curTotalProgress=0,this._receivedProgress={},this._maxProgress=0,this._buyTimes=0,this._progressReward=null,this._luckMsgList=[],this._progressConfig=null,this._luckMsgIndex=0,this._isPlayTurnTable=!1,this._trunTableReward=null,this._isInit=!1},t.prototype.addListener=function(){var t=td.MsgModuleName.ROAM,e=td.MsgCmd.ROAM,i=td.ServerDelegate;i.registerMessage(t,e.GET_ROAM_INFO,this._parseRoamInfo.bind(this)),i.registerMessage(t,e.ROAM_ACTION,this._onRoamAction.bind(this)),i.registerMessage(t,e.ROAM_RECEIVE_PROGRESS_REWARD,this._onReceiveRewards.bind(this)),i.registerMessage(t,e.ROAM_LUCK_LIST,this._onRoamLuckListUpdate.bind(this)),i.registerMessage(t,e.PUSH_ROAM_INFO,this._parseRoamInfo.bind(this)),i.registerMessage(t,e.PUSH_ROAM_LUCK_LIST,this._onRoamLuckListUpdate.bind(this)),i.registerMessage(t,e.ROAM_EVENT_REWARD_RECEIVE,this._onRoamEventReward.bind(this))},t.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.REQUEST_ROAM_INFO]=this._requestGetRoamInfo,e[t.REQUEST_ROAM_ACTION]=this._requestRoamAction,e[t.REQUEST_ROAM_BUY_TIMES]=this._requestBuyTimes,e[t.REQUEST_ROAM_RECEIVE_REWARDS]=this._requestReceiveRewards,e[t.REQUEST_GET_ROAM_LUCK_LIST]=this._requestRoamLuckList,e[t.REQ_ROAM_EVENT_REWARD_RECEIVE]=this._requestRoamEventReward,e[t.USER_ATTR_LEVEL_CHANGE]=this._onPlayerLvChange,td.EventUtil.registerEvents(e,this)},t.prototype.isRedPointTips=function(){if(!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Roam))return!1;if(this._leftTimes>=this._maxTimes)return!0;var t=this.getProgressConfig();if(!t)return!1;for(var e=td.RewardStatus.CAN_RECEIVE,i=0,n=t.length;i<n;i++){var a=t[i];if(this.getGiftRewardStatus(a)===e)return!0}return!1},t.prototype.redPointEvents=function(){var t=td.EventNameEnum;return[t.USER_ATTR_LEVEL_CHANGE,t.ROAM_INFO_CHANGED]},t.prototype.getMaxProgress=function(){if(!this._maxProgress){var t=this.getProgressConfig();if(!t)return cc.log("getMaxProgress error!!"),0;this._maxProgress=parseInt(t[t.length-1])}return this._maxProgress},t.prototype.getCurTotalProgress=function(){return this._curTotalProgress},t.prototype.getProgressConfig=function(){return this._progressConfig||(this._progressConfig=td.GetConfig("ROAM_PROGRESS_LIST"),this._progressConfig)?this._progressConfig:(cc.log("getProgressConfig error!!"),null)},t.prototype.getGiftRewardStatus=function(t){return this._receivedProgress&&this._receivedProgress[t]?td.RewardStatus.RECEIVED:this._curTotalProgress>=t?td.RewardStatus.CAN_RECEIVE:td.RewardStatus.CANNOT_RECEIVE},t.prototype.getNextRecoverTime=function(){return this._nextRecoverTime},t.prototype.getEventId=function(){return this._eventId},t.prototype.getAllRecoverTime=function(){var t=this._maxTimes-this._leftTimes-1;return t<0&&(t=0),this._nextRecoverTime+t*td.GetConfig("ROAM_RECOVER_TIME")},t.prototype.getLeftTimes=function(){return this._leftTimes},t.prototype.getMaxTimes=function(){return this._maxTimes},t.prototype.getRewardsByProgress=function(t){return this._progressReward?this._progressReward.getRewardsByProgress(t):null},t.prototype.getShowLuckMsg=function(){this._luckMsgIndex>=this._luckMsgList.length&&(this._luckMsgIndex=0);var t=this._luckMsgList.slice(this._luckMsgIndex,this._luckMsgIndex+this._luckMsgCount);return this._luckMsgIndex+=this._luckMsgCount,t},t.prototype.getTurnTableRewards=function(){var t=this._trunTableReward;return this._trunTableReward=null,t},t.prototype._requestGetRoamInfo=function(){if(td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Roam)){var t={};t.module=td.MsgModuleName.ROAM,t.cmd=td.MsgCmd.ROAM.GET_ROAM_INFO,td.ServerDelegate.sendMessage(t)}},t.prototype._parseRoamInfo=function(t,e){if(t===td.NetCode.SUCCESS){this._isInit||this._onPlayerLvChange(),this._leftTimes=e.times||0,this._nextRecoverTime=e.nextRecoverTime||0,e.eventId&&(this._eventId=e.eventId,td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_ROAN_EVENT));var i=this.getMaxProgress();this._receivedProgress={};for(var n=e.progressList||[],a=e.totalTimes||0,o=0,s=0,l=n.length;s<l;s++){var c=n[s];o=Math.max(o,c),0===(c%=i)&&(c=i),this._receivedProgress[c]=!0}var u=this.getProgressConfig(),d=n.length===u.length;if((0===o||d&&a>=o)&&(this._receivedProgress={}),0!==a){var h=a%i;a=0===h?d&&a===o?0:i:h}this._curTotalProgress=a,this._buyTimes=e.buyTimes||0;var p=e.progressId;this._progressReward||(this._progressReward=new r),this._progressReward.init(p),td.EventUtil.dispatchEvent(td.EventNameEnum.ROAM_INFO_CHANGED),this._isInit=!0}},t.prototype._requestRoamAction=function(t){var e={};this._eventId=0,e.module=td.MsgModuleName.ROAM,e.cmd=td.MsgCmd.ROAM.ROAM_ACTION,e.type=t,td.ServerDelegate.sendMessage(e)},t.prototype._onRoamAction=function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult,!0),n=e.criticalList,a={};a.rewards=i,a.criticalList=n,a.eventTimes=e.eventTimes||0,td.EventUtil.dispatchEvent(td.EventNameEnum.ON_ROAM_ACTION,a)}},t.prototype._requestBuyTimes=function(t){var e={};e.module=td.MsgModuleName.ROAM,e.cmd=td.MsgCmd.ROAM.ROAM_BUY_TIMES,e.times=t,td.ServerDelegate.sendMessage(e)},t.prototype._requestReceiveRewards=function(t){var e={};e.module=td.MsgModuleName.ROAM,e.cmd=td.MsgCmd.ROAM.ROAM_RECEIVE_PROGRESS_REWARD,e.progress=t,this._isPlayTurnTable=t===this.getMaxProgress(),td.ServerDelegate.sendMessage(e)},t.prototype._onReceiveRewards=function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult,!0),n=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.DoubleDrop),a=!1;if(n&&(a=n.isRoamDoubleOpen()),this._isPlayTurnTable){var r=i[0];if(!r)return;this._trunTableReward=i;for(var o=0,s=this.getRewardsByProgress(this.getMaxProgress()),l=0,c=s.length;l<c;l++){var u=s[l];if(parseInt(r.id)===u.getId()&&parseInt(r.count)===(a?2*u.getCount():u.getCount())){o=l;break}}td.EventUtil.dispatchEvent(td.EventNameEnum.ON_PLAY_ROAM_TURN_TABLE,o)}else td.GlobalFunction.showRewards(i),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_GET_ROAM_REWARDS)}},t.prototype._requestRoamEventReward=function(t){var e={};e.module=td.MsgModuleName.ROAM,e.cmd=td.MsgCmd.ROAM.ROAM_EVENT_REWARD_RECEIVE,e.answer=t,td.ServerDelegate.sendMessage(e)},t.prototype._onRoamEventReward=function(t,e){t===td.NetCode.SUCCESS&&(this._eventId=0,td.EventUtil.dispatchEvent(td.EventNameEnum.RES_ROAM_EVENT_REWARD_RECEIVE,e))},t.prototype._requestRoamLuckList=function(){var t={};t.module=td.MsgModuleName.ROAM,t.cmd=td.MsgCmd.ROAM.ROAM_LUCK_LIST,td.ServerDelegate.sendMessage(t)},t.prototype._onRoamLuckListUpdate=function(t,e){if(t===td.NetCode.SUCCESS){this._luckMsgList=[];var i=td.GetConfig("ROAM_LUCK_COUNT_LIMIT"),n=e.luckList;if(n&&n.length>0)for(var a=0,r=n.length;a<r;a++){var s=new o;s.init(n[a]),this._luckMsgList.unshift(s),this._luckMsgList.length>i&&this._luckMsgList.pop()}this._luckMsgIndex=0,td.EventUtil.dispatchEvent(td.EventNameEnum.ROAM_LUCK_LIST_UPDATED)}},t.prototype._onPlayerLvChange=function(){var t=td.GetTableClass(td.TableEnum.RoamConfigTable);if(t){var e=td.Account.getUserData().getLevel(),i=this._maxTimes;this._maxTimes=t.getMaxtimeByLv(e),i!=this._maxTimes&&td.EventUtil.dispatchEvent(td.EventNameEnum.ROAM_INFO_CHANGED)}else cc.error("=========> RoamConfigTable is null")},t=e=n([a],t)}();i.default=s,cc._RF.pop()},{RoamLuckModel:"RoamLuckModel",RoamRewardModel:"RoamRewardModel"}],RoamProgressConfig:[function(t,e,i){"use strict";cc._RF.push(e,"ceda2XlaklMmI6Hih2zrdyT","RoamProgressConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="RoamProgressConfig",e._tblName="roam_progress_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];this._data[n.id]=n}},e.prototype.getRoamProgressConfigById=function(t){return this._data&&this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],RoamRewardEventTable:[function(t,e,i){"use strict";cc._RF.push(e,"23222v8XzJAK74OVw201SFZ","RoamRewardEventTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="RoamRewardEventConfig",e._tblName="roam_reward_event_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];this._data[n.id]=n}},e.prototype.getDataById=function(t){return this._data&&this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],RoamRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"00e5cVhIfhLP68Ew8imS/S8","RoamRewardModel");var n=window.td,a=function(){function t(){this._id=0}return t.prototype.init=function(t){if(this._id!==t){this._id=t;var e=n.GetTableClass(n.TableEnum.RoamProgressConfig).getRoamProgressConfigById(t);if(e){var i=n.GetConfig("ROAM_PROGRESS_LIST");if(i){this._rewardList={};for(var a=0,r=i.length;a<r;a++){var o,s=parseInt(i[a]);if(0===a)o=e.firstRewards;else if(1===a)o=e.secondRewards;else if(2===a){o=[];var l=e.thirdRewards;if(l&&l.length>0)for(var c=0,u=l.length;c<u;c++)o=o.concat(l[c][0])}o=n.RewardManager.parseRewardListDetail(o),this._rewardList[s]=o}}else cc.log("get ROAM_PROGRESS_LIST error!")}else cc.log("get roam reward error for id = "+t)}},t.prototype.getRewardsByProgress=function(t){return this._rewardList&&this._rewardList[t]?this._rewardList[t]:null},t}();e.exports=a,cc._RF.pop()},{}],RollerDigitalTextAtlas:[function(t,e,i){"use strict";cc._RF.push(e,"fd471XgvkpN6JobyFoU33xW","RollerDigitalTextAtlas");var n=cc.Class({properties:{_sourNum:null,_destNum:null,_time:null,_func:null,_updateTime:null},onEnable:function(){this.scheduleUpdate()},onDisable:function(){this.unscheduleUpdate()},update:function(t){this._updateTime+=t,this.setShowString(Math.floor(this._sourNum+(this._destNum-this._sourNum)*this._updateTime/this._time)),this._updateTime>=this._time&&(this._func&&this._func(this),this.unscheduleUpdate())},setRollCfg:function(t){this._sourNum=t.sourNum||0,this._destNum=t.destNum,this._time=t.time||.3,this._updateTime=0,this._func=t.func,this.scheduleUpdate(),this.setShowString(this._sourNum)},setShowString:function(t){t<=0?t=1:t>this._destNum&&(t=this._destNum),this.setString(t)}});e.exports=n,cc._RF.pop()},{}],RuYiBang:[function(t,e,i){"use strict";cc._RF.push(e,"bd1a4qDNLJJzqrmhf+vMioE","RuYiBang");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="RuYiBang"}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],RushCrossRankPanel:[function(t,e,i){"use strict";cc._RF.push(e,"ffc721LUmRA7rxMKhgxjzbP","RushCrossRankPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("ActivityBasePanel"),o=t("OptimizeVerticalListView"),s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.node_rank=null,e.layout=null,e.lab_rank=null,e.lab_time=null,e.lab_time_des=null,e.btn_jump=null,e._isInitBtn=!1,e._isClose=!1,e._showIndex=0,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e)},e.prototype.onLoad=function(){},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._showIndex=td.ActivityEnum.RushRankType.ARENA_RUSH_RANK,this._controller.setselectType(this._showIndex),this._addEventListeners(),this._activityId=this._controller.getActivityId(),td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,this._activityId)},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),this.stopSchedule(),td.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListeners=function(){var t={},e=td.EventNameEnum;t[e.Res_GET_ACTIVITY_INFO]=this._resInfo,t[e.RESREFRESH_RUSHRANK]=this._refreshListView,td.EventUtil.registerEvents(t,this)},e.prototype._resInfo=function(t){t===this.getActivityId()&&this._refreshListView()},e.prototype._refreshListView=function(){var t=this._controller.getActivityData(),e=this._controller.getselectType();this._jump=null;var i=td.GetTableClass(td.TableEnum.RushRankTable).getDataByDataIdAndType(t,e);if(i){var n=this.parseReward(i.rewards);this.node.getComponent(o).refreshListData(n),this._jump=i.gotoPanel}var a=this._controller.getDataListByType(e);if(a){this._closeTime=a.getCloseTime(),this._isClose=td.TimeUtil.getTime()-this._closeTime>0,this._isClose?(this.lab_time_des.node.active=!0,this.lab_time.node.active=!1,this.btn_jump.active=!1):(this.lab_time_des.node.active=!1,this.lab_time.node.active=!0,this.btn_jump.active=!0,this.schedule(this.loopTime,1),this.loopTime());var r,s=[].concat(a.getRushRankList());!this._isClose&&s.length>0&&(r=s.pop());for(var l=1;l<4;l++){var c=this.node_rank.getChildByName("layout"+l),u=c.getChildByName("lab_name"),d=c.getChildByName("lab_num");if(s[l-1]){var h=s[l-1].attributes,p=s[l-1].rank,_=s[l-1].value;u.getComponent(cc.Label).string=p+". "+h[td.UserPropertyEnum.NickName],d.getComponent(cc.Label).string=_}else u.getComponent(cc.Label).string=l+". "+td.Language.setWaite,d.getComponent(cc.Label).string=" "}if(this._isClose){this.layout.active=!1;for(var g=td.Account.getUserData().getGamerId(),f=0;f<s.length;f++)if(s[f].attributes[td.UserPropertyEnum.GamerId]===g){r=s[f];break}this.lab_rank.string=r?r.rank:td.Language.notInRank}else{var v=td.GetConfig("RUSH_RANK_NUM_LIMIT"),m=-1;for(l=0;l<v.length;l++)v[l][0]===e&&(m=v[l][1]);var y=void 0,E=void 0;r?(y=r.rank<=m?r.rank:0,E=r.value):(y=0,E=td.Language.notInRank),this.lab_rank.string=y||td.Language.notInRank,this.layout.active=!0;var T=this.layout.getChildByName("lab_des");(d=this.layout.getChildByName("lab_num")).getComponent(cc.Label).string=E,T.getComponent(cc.Label).string=td.Language["rushRankDes"+e]}}},e.prototype.loopTime=function(){var t=Math.floor(this._closeTime-td.TimeUtil.getTime());t>0?this.lab_time.string=td.GlobalFunction.getTimeStringByDeltaTime(t):(this.lab_time_des.node.active=!0,this.lab_time.node.active=!1,this.stopSchedule())},e.prototype.stopSchedule=function(){this.unschedule(this.loopTime)},e.prototype.parseReward=function(t){for(var e=[],i=0;i<t.length;i++){var n={};n.rank=t[i][0],n.reward=t[i][1],i>2&&(n.rankStr=t[i-1][0]+1+"/"+t[i][0]),e.push(n)}return e},e.prototype.onBtnRank=function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_RushRankRank,this._controller.getActivityType())},e.prototype.onBtnJump=function(){td.PanelJumpManager.jumpToPanel(this._jump)},a([c(cc.Node)],e.prototype,"node_rank",void 0),a([c(cc.Node)],e.prototype,"layout",void 0),a([c(cc.Label)],e.prototype,"lab_rank",void 0),a([c(cc.Label)],e.prototype,"lab_time",void 0),a([c(cc.Label)],e.prototype,"lab_time_des",void 0),a([c(cc.Node)],e.prototype,"btn_jump",void 0),e=a([l,u("module/Activity/RushCrossRankPanel")],e)}(r);i.default=d,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0}],RushRankController:[function(t,e,i){"use strict";cc._RF.push(e,"a4cfarsn8RMb4g2QsxTIXS3","RushRankController");var n=t("ActivityBaseController"),a=t("RushRankModel"),r=cc.Class({extends:n,properties:{_modelList:null,_selectType:null},initData:function(t){this._super(t),this.clearData()},clearData:function(){this._modelList={},this._selectType=0},getselectType:function(){return this._selectType},setselectType:function(t){this._selectType=t},getDataListByType:function(t){return this._modelList[t]},activityParse:function(t){var e=t.global.rushRankVOMap;for(var i in e){var n=new a;n.setData(e[i]),n.setType(parseInt(i)),this._modelList[i]=n}},getOpenActivity:function(){var t=[],e=td.TimeUtil.getTime();for(var i in this._modelList)this._modelList[i].getShowTime()>e&&t.push(this._modelList[i]);return t}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",RushRankModel:"RushRankModel"}],RushRankCrossController:[function(t,e,i){"use strict";cc._RF.push(e,"519f6pSQ0pPSpDHfm5RrJVt","RushRankCrossController");var n=t("RushRankController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{RushRankController:"RushRankController"}],RushRankIconItem:[function(t,e,i){"use strict";cc._RF.push(e,"21d23RjWcpMQ4+M3iTclylK","RushRankIconItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgIcon=null,e.imgDesc=null,e.imgSelect=null,e._controller=null,e}return n(e,t),e.prototype.onEnable=function(){this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListener=function(){var t=r.EventUtil,e=r.EventNameEnum;t.registerEvent(e.RESREFRESH_RUSHRANK,this._onChangeSelect,this)},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.getType();this._type=n,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.CB_chongbang,"CB_icon_0"+n,this.imgIcon),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.CB_chongbang,"CB_wz_bt0"+n,this.imgDesc),this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_11),this._controller&&this._onChangeSelect()},e.prototype.onJump=function(){this._controller&&(this._controller.getselectType()!==this._type&&(this._controller.setselectType(this._type),r.EventUtil.dispatchEvent(r.EventNameEnum.RESREFRESH_RUSHRANK)))},e.prototype._onChangeSelect=function(){this._controller&&(this.imgSelect.active=this._type===this._controller.getselectType())},a([c(cc.Node)],e.prototype,"imgIcon",void 0),a([c(cc.Node)],e.prototype,"imgDesc",void 0),a([c(cc.Node)],e.prototype,"imgSelect",void 0),e=a([l,u("module/Activity/RushRankIconItem")],e)}(o);i.default=d,cc._RF.pop()},{ListItem:void 0}],RushRankItem:[function(t,e,i){"use strict";cc._RF.push(e,"8bac0qzGsNK96oxBnKk9tXe","RushRankItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=t("ListItem"),d=t("CommonIconWidget"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img_rank=null,e.layout=null,e.lab_rank=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.rank;n<=3?(this.lab_rank.node.active=!1,this.img_rank.active=!0,c.GlobalFunction.createAltasSprite(c.resDef.pngPlist.GY0_Common,"GY0_paiming_0"+n,this.img_rank)):(this.lab_rank.node.active=!0,this.img_rank.active=!1,this.lab_rank.string=i.rankStr);for(var a=i.reward,r=this.layout.childrenCount,o=0;o<a.length;o++){var s=c.RewardManager.getRewardDetail(a[o]);if(l=this.layout.getChildByName("reward"+o))l.active=!0,l.getComponent(d).setData(s);else(l=c.GlobalFunction.createCommonIconWidget(56,s)).setScale(.9),l.name="reward"+o,this.layout.addChild(l)}for(;o<=r;o++){var l;(l=this.layout.getChildByName("reward"+o))&&(l.active=!1)}},a([s(cc.Node)],e.prototype,"img_rank",void 0),a([s(cc.Node)],e.prototype,"layout",void 0),a([s(cc.Label)],e.prototype,"lab_rank",void 0),e=a([o,l("module/Activity/RushRankItem")],e)}(u);i.default=h,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],RushRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"f2c44lovxhKu7Yv43kv77w0","RushRankModel");var n=cc.Class({properties:{_type:null,_rushRankList:null,_closeTime:null,_showTime:null},setData:function(t){t.rushRankList?this._rushRankList=t.rushRankList:this._rushRankList=[],this._closeTime=t.closeTime,this._showTime=t.showTime},getType:function(){return this._type},setType:function(t){this._type=t},getRushRankList:function(){return this._rushRankList},getCloseTime:function(){return this._closeTime},getShowTime:function(){return this._showTime}});e.exports=n,cc._RF.pop()},{}],RushRankPanel:[function(t,e,i){"use strict";cc._RF.push(e,"bfd3cNZr1dCw58+ASzcB97a","RushRankPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=t("OptimizeHorizontalListView"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.node_rank=null,e.layout=null,e.lab_rank=null,e.lab_time=null,e.lab_time_des=null,e.img_reward=null,e.img_tips=null,e.btn_jump=null,e._isInitBtn=!1,e._isClose=!1,e._showIndex=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Panel,this._panelEnum=r.PanelEnum.Panel_RushRank},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_11),this._controller&&(this._activityId=this._controller.getActivityId(),r.EventUtil.dispatchEvent(r.EventNameEnum.HIDE_MAIN_LAYER_BOTTOM_LAYER),r.EventUtil.dispatchEvent(r.EventNameEnum.Req_GET_ACTIVITY_INFO,this._activityId))},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),this.stopSchedule(),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.Res_GET_ACTIVITY_INFO]=this._resInfo,t[e.RESREFRESH_RUSHRANK]=this._refreshListView,t[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,r.EventUtil.registerEvents(t,this)},e.prototype.setBtn=function(){var t=this._controller.getOpenActivity();if(t.length<=0){var e=new r.BroadcastContent(105);return r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,e),void this.closeCallFunc()}var i=[],n=[],a=r.TimeUtil.getTime();t.forEach(function(t){t.getCloseTime()>=a?i.push(t):n.push(t)}),i.sort(this.sortFun),n.sort(this.sortFun);for(var o=i.concat(n),s=!1,l=0;l<o.length;l++)if(this._showIndex===o[l].getType()){s=!0;break}s||(this._showIndex=o[0].getType(),this._controller.setselectType(this._showIndex)),this.node.getComponent(h).setData(o)},e.prototype.sortFun=function(t,e){return t.getCloseTime()!=e.getCloseTime()?t.getCloseTime()-e.getCloseTime():t.getType()-e.getType()},e.prototype._resInfo=function(t){t===this._controller.getActivityId()&&this._refresh()},e.prototype._refresh=function(){this.setBtn(),this._refreshListView()},e.prototype._refreshListView=function(){var t=this._controller.getActivityData(),e=this._controller.getselectType();this._showIndex=e,this._jump=null,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.CB_chongbang,"CB_wz_0"+e,this.img_tips),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.CB_chongbang,"CB_cbbg0"+e,this.img_reward);var i=r.GetTableClass(r.TableEnum.RushRankTable).getDataByDataIdAndType(t,e);if(i){var n=this.parseReward(i.rewards);this.node.getComponent(d).refreshListData(n),this._jump=i.gotoPanel}var a=this._controller.getDataListByType(e);this._closeTime=a.getCloseTime(),this._isClose=r.TimeUtil.getTime()-this._closeTime>0,this._isClose?(this.lab_time_des.node.active=!0,this.lab_time.node.active=!1,this.btn_jump.active=!1):(this.lab_time_des.node.active=!1,this.lab_time.node.active=!0,this.btn_jump.active=!0,this.schedule(this.loopTime,1),this.loopTime());var o,s=[].concat(a.getRushRankList());!this._isClose&&s.length>0&&(o=s.pop());for(var l=1;l<4;l++){var c=this.node_rank.getChildByName("layout"+l),u=c.getChildByName("lab_name"),h=c.getChildByName("lab_num");if(s[l-1]){var p=s[l-1].attributes,_=s[l-1].rank,g=s[l-1].value;u.getComponent(cc.Label).string=_+". "+p[r.UserPropertyEnum.NickName],h.getComponent(cc.Label).string=g}else u.getComponent(cc.Label).string=l+". "+r.Language.setWaite,h.getComponent(cc.Label).string=" "}if(this._isClose){this.layout.active=!1;for(var f=r.Account.getUserData().getGamerId(),v=0;v<s.length;v++)if(s[v].attributes[r.UserPropertyEnum.GamerId]===f){o=s[v];break}this.lab_rank.string=o?o.rank:r.Language.notInRank}else{var m=r.GetConfig("RUSH_RANK_NUM_LIMIT"),y=-1;for(l=0;l<m.length;l++)m[l][0]===e&&(y=m[l][1]);var E=void 0,T=void 0;o?(E=o.rank<=y?o.rank:0,T=o.value):(E=0,T=r.Language.notInRank),this.lab_rank.string=E||r.Language.notInRank,this.layout.active=!0;var C=this.layout.getChildByName("lab_des");(h=this.layout.getChildByName("lab_num")).getComponent(cc.Label).string=T,C.getComponent(cc.Label).string=r.Language["rushRankDes"+e]}},e.prototype.loopTime=function(){var t=Math.floor(this._closeTime-r.TimeUtil.getTime());t>0?this.lab_time.string=r.GlobalFunction.getTimeStringByDeltaTime(t):(this.lab_time_des.node.active=!0,this.lab_time.node.active=!1,this.stopSchedule())},e.prototype.stopSchedule=function(){this.unschedule(this.loopTime)},e.prototype.parseReward=function(t){for(var e=[],i=0;i<t.length;i++){var n={};n.rank=t[i][0],n.reward=t[i][1],i>2&&(n.rankStr=t[i-1][0]+1+"/"+t[i][0]),e.push(n)}return e},e.prototype.onBtnRank=function(){r.PanelJumpManager.jumpToPanel(r.PanelEnum.Window_RushRankRank,this._controller.getActivityType())},e.prototype.onBtnJump=function(){r.PanelJumpManager.jumpToPanel(this._jump)},e.prototype._onActivityClose=function(t){this._activityId===t&&this.closeCallFunc()},e.prototype.showHelpDesc=function(){var t={};t.panelName=r.PanelEnum.Window_Help,t.callback={func:function(t,e){e.setData(t)},param:[this._panelEnum,this._showIndex]},r.GlobalFunction.showPanel(t)},a([l(cc.Node)],e.prototype,"node_rank",void 0),a([l(cc.Node)],e.prototype,"layout",void 0),a([l(cc.Label)],e.prototype,"lab_rank",void 0),a([l(cc.Label)],e.prototype,"lab_time",void 0),a([l(cc.Label)],e.prototype,"lab_time_des",void 0),a([l(cc.Node)],e.prototype,"img_reward",void 0),a([l(cc.Node)],e.prototype,"img_tips",void 0),a([l(cc.Node)],e.prototype,"btn_jump",void 0),e=a([s,c("module/Activity/RushRankPanel")],e)}(u);i.default=p,cc._RF.pop()},{OptimizeHorizontalListView:void 0,OptimizeVerticalListView:void 0,PanelBase:void 0}],RushRankRankItem:[function(t,e,i){"use strict";cc._RF.push(e,"8497eEzTxNBa5s7GMXLAMnY","RushRankRankItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=t("BaseUser"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.img_rank=null,e.lab_des=null,e.lab_num=null,e.lab_rank=null,e.lab_name=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.rank,a=i.value,o=i.attributes,s=new d;s.init("",o);var l=this._customData;this.lab_des.string=r.Language["rushRankDes"+l].slice(2),this.lab_num.string=a+"",this.lab_name.string=s.getNickName();var c=this.node.getChildByName("iconItem");c?c.getComponent("AvatarHeadWidget").setData(i):((c=r.GlobalFunction.createAvatarHeadWidget(3,s,!1)).x=-135,this.node.addChild(c));n<=3?(this.img_rank.active=!0,this.lab_rank.node.active=!1,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.GY0_Common,"GY0_paiming_0"+n,this.img_rank)):(this.img_rank.active=!1,this.lab_rank.node.active=!0,this.lab_rank.string=n+"")},a([c(cc.Node)],e.prototype,"img_rank",void 0),a([c(cc.Label)],e.prototype,"lab_des",void 0),a([c(cc.Label)],e.prototype,"lab_num",void 0),a([c(cc.Label)],e.prototype,"lab_rank",void 0),a([c(cc.Label)],e.prototype,"lab_name",void 0),e=a([l,u("module/Activity/RushRankRankItem")],e)}(o);i.default=h,cc._RF.pop()},{BaseUser:"BaseUser",ListItem:void 0}],RushRankRankWindow:[function(t,e,i){"use strict";cc._RF.push(e,"03a48p33CxG6p0gvUVRM7DC","RushRankRankWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lab_rank=null,e.lab_value_des=null,e.lab_value=null,e}return n(e,t),e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_RushRankRank},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.Res_GET_ACTIVITY_INFO]=this.setData,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e);var i=r.ActivityDataManager.getActivityControllerByType(e);if(i){var n=i.getselectType(),a=i.getDataListByType(n);if(a){var o,s=[].concat(a.getRushRankList()),l=r.TimeUtil.getTime()-a.getCloseTime()>0;if(this.lab_value_des.string=r.Language["rushRankDes"+n],l){for(var c=r.Account.getUserData().getGamerId(),u=0;u<s.length;u++)if(s[u].attributes[r.UserPropertyEnum.GamerId]===c){o=s[u];break}this.lab_rank.string=o?o.rank:r.Language.notInRank,this.lab_value.string=o?o.value:r.Language.notInRank}else{o=s.pop();for(var h=r.GetConfig("RUSH_RANK_NUM_LIMIT"),p=-1,_=0;_<h.length;_++)h[_][0]===n&&(p=h[_][1]);var g=void 0,f=void 0;o?(g=o.rank<=p?o.rank:0,f=o.value):(g=0,f=r.Language.notInRank),this.lab_rank.string=g||r.Language.notInRank,this.lab_value.string=f}var v=this.node.getComponent(d);v.setCustomData(n),v.setData(s)}}},a([l(cc.Label)],e.prototype,"lab_rank",void 0),a([l(cc.Label)],e.prototype,"lab_value_des",void 0),a([l(cc.Label)],e.prototype,"lab_value",void 0),e=a([s,c("module/Activity/RushRankRankWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],RushRankTable:[function(t,e,i){"use strict";cc._RF.push(e,"6faa8dexUVPr40i3pVZUfCo","RushRankTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="RushRankConfig",e._tblName="rush_rank_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._data[n.data]=this._data[n.data]||[];var a=this._data[n.data];a[a.length]=n}},e.prototype.getDatasOfDataId=function(t){var e=this._data[t];return e||(e=[]),e},e.prototype.getDataByDataIdAndType=function(t,e){var i=this._data[t];if(i)for(var n=0;n<i.length;n++)if(i[n].rushRankType===e)return i[n];return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ScenesTextConfig:[function(t,e,i){"use strict";cc._RF.push(e,"57a48IpQotPcoofaZMWBAzc","ScenesTextConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ScenesTextConfig",e._tblName="scenes_text_config",e._datas=null,e}return n(e,t),e.prototype.init=function(){this._datas=[];for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];this._datas[this._datas.length]=n}},e.prototype.getDatas=function(){return this._datas},e.prototype.getRandomTips=function(){for(var t=[],e=td.Account.getUserData().level,i=0,n=this._datas.length;i<n;i++)this._datas[i].levelLimit<=e&&(t[t.length]=this._datas[i]);return 0===t.length?[]:t[Math.floor(Math.random()*t.length)].textList.slice(0)},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ScuffleYamaChallengeRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"e532aThbAdLwqI2dZR0vwPF","ScuffleYamaChallengeRewardTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ScuffleYamaChallengeRewardTable",e._tblName="hell_challenge_reward_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=e[i+1],o=a.level,s=r?r.level-1:999;a.fromLevel=o,a.toLevel=s,t.push(a)}},e.prototype.getDataByLevel=function(t){for(var e=0,i=this._data.length;e<i;e++){var n=this._data[e],a=n.fromLevel,r=n.toLevel;if(t>=a&&t<=r)return n}return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ScuffleYamaManager:[function(t,e,i){"use strict";cc._RF.push(e,"a1640vfAPlIQrlvNx0dkS6z","ScuffleYamaManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,window.td),s=t("GameAlarm"),l=t("../Enum/NationEnum"),c=t("../Model/ScuffleYama/ScuffleYamaPlayerModel"),u=t("../Model/ScuffleYama/ScuffleYamaPlayerRankModel"),d=t("../Model/ScuffleYama/ScuffleYamaNationRankModel"),h=t("../Model/ScuffleYama/ScuffleYamaRecordModel"),p=function(){function t(){this._closeTime=0,this._curMultiple=0,this._myInfo=null,this._canRevengeList=[],this._canChallengeList=[],this._playerRankList=[],this._nationRankList=[],this._recordList=[],this._auctionItemIdList=[],this._curGetScore=0,this._isEnterBtnAniShowed=!1,this._alarmName="",this._isNeedAutoShowRewards=!0,this._isPushShowRewards=!1,this._avoidSerialClick=!1,this._rankChangeStatus=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener()},t.prototype.destroyData=function(){this._curMultiple=0,this._canRevengeList=[],this._canChallengeList=[],this._playerRankList=[],this._nationRankList=[],this._recordList=[],this._auctionItemIdList=[],this._avoidSerialClick=!1,this._isNeedAutoShowRewards=!0,this._rankChangeStatus=!0},t.prototype.addListener=function(){var t=o.MsgModuleName.ScuffleYama,e=o.MsgCmd.ScuffleYama,i=o.ServerDelegate;i.registerMessage(t,e.GET_TANGLED_HELL,this._receiveScuffleYamaInfoReturn.bind(this)),i.registerMessage(t,e.GET_TANGLED_ACTOR_HELL,this._receiveScuffleYamaPlayersInfoReturn.bind(this)),i.registerMessage(t,e.GET_CHALLENGE_TARGET_LIST,this._receiveCanChallengePlayersList.bind(this)),i.registerMessage(t,e.CHALLENGE,this._responseChallenge.bind(this)),i.registerMessage(t,e.GET_TANGLED_HELL_ACTOR_RANK,this._responsePlayersRank.bind(this)),i.registerMessage(t,e.GET_TANGLED_HELL_NATION_RANK,this._responseLeaguesRank.bind(this)),i.registerMessage(t,e.GET_TANGLED_HELL_RECORD,this.receiveChallengeRecordInfo.bind(this)),i.registerMessage(t,e.PUSH_TANGLED_HELL,this._pushScuffleYamaInfo.bind(this)),i.registerMessage(t,e.PUSH_TANGLED_HELL_ACTOR,this._pushScuffleYamaPlayerInfo.bind(this)),i.registerMessage(t,e.PUSH_TANGLED_HELL_TARGET,this._pushCanChallengeListInfo.bind(this)),i.registerMessage(t,e.PUSH_TANGLED_HELL_ACTOR_RANK,this._pushScuffleYamaPlayersRank.bind(this)),i.registerMessage(t,e.PUSH_TANGLED_HELL_NATION_RANK,this._pushScuffleYamaLeaguesRank.bind(this)),i.registerMessage(t,e.PUSH_TANGLED_HELL_RECORD,this._pushScuffleYamaChallengeRecord.bind(this)),i.registerMessage(t,e.PUSH_TANG_HELL_REWARD_SHOW,this._pushScuffleYamaShowRewards.bind(this)),i.registerMessage(t,e.PUSH_TANG_HELL_CHALLENGE_RESULT,this._pushChallengeBossRewards.bind(this))},t.prototype.addEventListener=function(){var t=o.EventNameEnum,e={};e[t.REQUEST_SCUFFLE_YAMA_INFO]=this._requestScuffleYamaInfo,e[t.REQUEST_SCUFFLE_YAMA_PLAYERS_INFO]=this._requestScuffleYamaPlayersInfo,e[t.GET_CAN_CHALLENGE_PLAYERS_LIST]=this._getCanChallengePlayersList,e[t.REQUEST_SCUFFLE_YAMA_CHALLENGE]=this._requestChallenge,e[t.GET_SCUFFLE_YAMA_PLAYERS_RANK]=this._getScuffleYamaPlayersRank,e[t.GET_SCUFFLE_YAMA_LEAGUE_RANK]=this._getScuffleYamaLeagueRank,e[t.GET_SCUFFLE_YAMA_CHALLENGE_RECORD]=this._getScuffleYamaChallengeRecord,e[t.REQUEST_AUCTION_REWARDS_INFO]=this._requestAuctionRewardsInfo,e[t.GAME_ALARM_EVENT]=this._onAlarm,o.EventUtil.registerEvents(e,this)},t.prototype.resetLocalData=function(){this._recordList.length>0&&(this._recordList=[],o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_CHALLENGE_RECORD)),this._myInfo&&(this._myInfo=null,o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_YAMA_MAIN_PANEL),o.EventUtil.dispatchEvent(o.EventNameEnum.NOTICE_MY_SCUFFLE_YAMA_DATA_CHANGED)),this._auctionItemIdList.length>0&&(this._auctionItemIdList=[],o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_SCUFFLE_YAMA_AUCTION_REWARDS,!0))},t.prototype.getRankChangedStatus=function(){return this._rankChangeStatus},t.prototype.resetRankChangedStatus=function(){this._rankChangeStatus=!1},t.prototype.getCloseTime=function(){return this._closeTime},t.prototype.getCurMultiple=function(){return this._curMultiple},t.prototype.getMyInfo=function(){return this._myInfo},t.prototype.getCanChallengeList=function(){var t=this._canRevengeList.sort(function(t,e){return e.getScore()-t.getScore()}),e=this._canChallengeList.sort(function(t,e){return t.getRank()-e.getRank()});return t.concat(e)},t.prototype.getPlayRankList=function(){return this._playerRankList},t.prototype.getNationRankList=function(){return this._nationRankList},t.prototype.getRecordList=function(){return this._recordList},t.prototype.getCurStage=function(){var t=o.TimeUtil.getTime();if(t>=this._closeTime)return l.ScuffleYamaStage.Over;var e=o.GetTableClass(o.TableEnum.Config).getConfig("TANGLED_HELL_PREPARE_INTERVAL"),i=o.GetTableClass(o.TableEnum.Config).getConfig("TANGLED_HELL_STAGE_TIME"),n=i[i.length-1][1],a=this._closeTime-60*n*1e3,r=a-60*e*1e3;return t<r?l.ScuffleYamaStage.Over:t>=r&&t<a?l.ScuffleYamaStage.Prepare:l.ScuffleYamaStage.Fight},t.prototype._addAlarm=function(){var t=this.getCurStage(),e=null;if(t==l.ScuffleYamaStage.Fight)e=new Date(this._closeTime);else{var i=o.GetTableClass(o.TableEnum.Config).getConfig("TANGLED_HELL_PREPARE_INTERVAL"),n=o.GetTableClass(o.TableEnum.Config).getConfig("TANGLED_HELL_STAGE_TIME"),a=n[n.length-1][1],r=this._closeTime-60*a*1e3,c=r-60*i*1e3;t==l.ScuffleYamaStage.Over?e=new Date(c):t==l.ScuffleYamaStage.Prepare&&(e=new Date(r))}e&&(this._alarmName=s.addAlarm(e.getHours(),e.getMinutes(),e.getSeconds()),s.refresh())},t.prototype._onAlarm=function(){var t=this;setTimeout(function(){o.EventUtil.dispatchEvent(o.EventNameEnum.ON_SCUFFLE_YAMA_STAGE_CHANGE),t._addAlarm()},500)},t.prototype.setAvoidSerialClick=function(t){if(!this._avoidSerialClick){var e=this;setTimeout(function(){e._avoidSerialClick=!1},1e3*t)}},t.prototype.setShowAuctionItemList=function(t){t&&0!=t.length&&(this._auctionItemIdList=t,this._isNeedAutoShowRewards?o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_SCUFFLE_YAMA_AUCTION_REWARDS):this._isNeedAutoShowRewards=!0)},t.prototype.getShowAuctionItemList=function(){return this._auctionItemIdList},t.prototype.getPushAutoShowStatus=function(){return this._isPushShowRewards},t.prototype.forbidPushAutoShowStatus=function(){this._isPushShowRewards=!1},t.prototype.getCurGetScore=function(){return this._curGetScore},t.prototype._requestAuctionRewardsInfo=function(){var t=o.TimeUtil.getServerDate().getHours();this.getCurStage()!==l.ScuffleYamaStage.Prepare&&11==t||(this._isNeedAutoShowRewards=!1,o.EventUtil.dispatchEvent(o.EventNameEnum.REQ_AUCTION_INFO))},t.prototype._requestScuffleYamaInfo=function(){var t={};t.module=o.MsgModuleName.ScuffleYama,t.cmd=o.MsgCmd.ScuffleYama.GET_TANGLED_HELL,o.ServerDelegate.sendMessage(t)},t.prototype._receiveScuffleYamaInfoReturn=function(t,e){t===o.NetCode.SUCCESS&&this._parseScuffleYamaData(e)},t.prototype._requestScuffleYamaPlayersInfo=function(){var t={};t.module=o.MsgModuleName.ScuffleYama,t.cmd=o.MsgCmd.ScuffleYama.GET_TANGLED_ACTOR_HELL,o.ServerDelegate.sendMessage(t)},t.prototype._receiveScuffleYamaPlayersInfoReturn=function(t,e){t===o.NetCode.SUCCESS&&this._parsePlayerData(e)},t.prototype._getCanChallengePlayersList=function(){var t={};t.module=o.MsgModuleName.ScuffleYama,t.cmd=o.MsgCmd.ScuffleYama.GET_CHALLENGE_TARGET_LIST,o.ServerDelegate.sendMessage(t)},t.prototype._receiveCanChallengePlayersList=function(t,e){o.NetCode.SUCCESS},t.prototype._requestChallenge=function(t){if(!this._avoidSerialClick){var e=0==t.id?1:2;this.setAvoidSerialClick(e),this._curGetScore=0;var i={};i.module=o.MsgModuleName.ScuffleYama,i.cmd=o.MsgCmd.ScuffleYama.CHALLENGE,i.targetId=t.id,i.revenge=t.isRevenge,o.ServerDelegate.sendMessage(i)}},t.prototype._responseChallenge=function(t,e){7205==t&&this._getCanChallengePlayersList()},t.prototype._getScuffleYamaPlayersRank=function(){var t={};t.module=o.MsgModuleName.ScuffleYama,t.cmd=o.MsgCmd.ScuffleYama.GET_TANGLED_HELL_ACTOR_RANK,o.ServerDelegate.sendMessage(t)},t.prototype._responsePlayersRank=function(t,e){o.NetCode.SUCCESS},t.prototype._getScuffleYamaLeagueRank=function(){var t={};t.module=o.MsgModuleName.ScuffleYama,t.cmd=o.MsgCmd.ScuffleYama.GET_TANGLED_HELL_NATION_RANK,o.ServerDelegate.sendMessage(t)},t.prototype._responseLeaguesRank=function(t,e){o.NetCode.SUCCESS},t.prototype._getScuffleYamaChallengeRecord=function(){var t={};t.module=o.MsgModuleName.ScuffleYama,t.cmd=o.MsgCmd.ScuffleYama.GET_TANGLED_HELL_RECORD,o.ServerDelegate.sendMessage(t)},t.prototype.receiveChallengeRecordInfo=function(t,e){var i=this;t===o.NetCode.SUCCESS&&(this._recordList=[],e.recordList.forEach(function(t){var e=new h.default;e.initData(t),i._recordList.push(e)}),o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_CHALLENGE_RECORD),o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_YAMA_RECORD_LIST))},t.prototype._parseScuffleYamaData=function(t){this._closeTime=t.closeTime,this._curMultiple=t.hellState,this._addAlarm(),o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_YAMA_MAIN_PANEL)},t.prototype._pushScuffleYamaInfo=function(t,e){t===o.NetCode.SUCCESS&&this._parseScuffleYamaData(e)},t.prototype._parsePlayerData=function(t){this._myInfo=new c.default,this._myInfo.initData(t),o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_YAMA_MAIN_PANEL),o.EventUtil.dispatchEvent(o.EventNameEnum.ON_CHALLENGE_SCUFFLE_YAMA_RETURN)},t.prototype._pushScuffleYamaPlayerInfo=function(t,e){t===o.NetCode.SUCCESS&&this._parsePlayerData(e)},t.prototype._pushCanChallengeListInfo=function(t,e){var i=this;if(t===o.NetCode.SUCCESS){var n=e.revengeList||[],a=e.targetList||[];this._canRevengeList=[],n.forEach(function(t){var e=new u.default;e.initData(t),e.setRevengeDataModel(!0),i._canRevengeList.push(e)}),a&&a.length>0&&(this._canChallengeList=[],a.forEach(function(t){var e=new u.default;e.initData(t),e.setRevengeDataModel(!1),i._canChallengeList.push(e)}));for(var r=0,s=this._canRevengeList.length;r<s;r++)for(var l=this._canRevengeList[r].getPlayerInfo().getGamerId(),c=0,d=this._canChallengeList.length;c<d;c++){var h=this._canChallengeList[c];if(h)h.getPlayerInfo().getGamerId()==l&&(this._canChallengeList.splice(c,1),c--)}o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_YAMA_ROB_LIST)}},t.prototype._pushScuffleYamaPlayersRank=function(t,e){var i=this;if(t===o.NetCode.SUCCESS){var n=e.actorRanks;n.splice(n.length-1,1),this._playerRankList=[],n.forEach(function(t){var e=new u.default;e.initData(t),i._playerRankList.push(e)}),o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_YAMA_PLAYER_RANK)}},t.prototype._pushScuffleYamaLeaguesRank=function(t,e){var i=this;if(t===o.NetCode.SUCCESS){var n=e.nationRanks;n.splice(n.length-1,1),this._nationRankList=[],n.forEach(function(t){var e=new d.default;e.initData(t),i._nationRankList.push(e)}),o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_YAMA_NATION_RANK)}},t.prototype._pushScuffleYamaChallengeRecord=function(t,e){var i=this;if(t===o.NetCode.SUCCESS){var n=e.recordList;(!this._recordList||n.length>1)&&(this._recordList=[]),n.forEach(function(t){var e=new h.default;e.initData(t),i._recordList.push(e)}),this._recordList.length>20&&this._recordList.splice(0,this._recordList.length-20),this._rankChangeStatus=!0,o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_CHALLENGE_RECORD),o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_SCUFFLE_YAMA_RECORD_LIST),o.EventUtil.dispatchEvent(o.EventNameEnum.NOTICE_SERVER_DATA_CHANGED)}},t.prototype._pushScuffleYamaShowRewards=function(t,e){if(t===o.NetCode.SUCCESS){var i=e.rewardList;i&&(this._isPushShowRewards=!0,this.setShowAuctionItemList(i))}},t.prototype._pushChallengeBossRewards=function(t,e){if(t===o.NetCode.SUCCESS){var i=e.score,n=e.rewardList;if(this._curGetScore=i,n.length>0){var a={score:i,rewards:o.RewardManager.parseRewardListDetail(n)};o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_SCUFFLE_YAMA_CHALLENGE_REWARDS,a)}}},t.prototype.isShowMainPanelBtn=function(){if(!o.UnlockManager.isPanelUnlock(o.PanelEnum.Panel_ScuffleYamaMain,!1))return!1;var t=this.getCurStage();return t==l.ScuffleYamaStage.Prepare||t==l.ScuffleYamaStage.Fight},t.prototype.isEnterBtnAniShowed=function(){return this._isEnterBtnAniShowed},t.prototype.setEnterBtnAniShowed=function(t){this._isEnterBtnAniShowed=t},t.prototype.scuffleYamaRedPointTip=function(){if(!o.UnlockManager.isPanelUnlock(o.PanelEnum.Panel_ScuffleYamaMain,!1))return!1;var t=this.getCurStage();return t==l.ScuffleYamaStage.Prepare||t==l.ScuffleYamaStage.Fight},t.prototype.scuffleYamaRedPointEvents=function(){return[o.EventNameEnum.ON_SCUFFLE_YAMA_STAGE_CHANGE,o.EventNameEnum.REFRESH_SCUFFLE_YAMA_MAIN_PANEL]},t=e=n([r],t)}();i.default=p,cc._RF.pop()},{"../Enum/NationEnum":"NationEnum","../Model/ScuffleYama/ScuffleYamaNationRankModel":"ScuffleYamaNationRankModel","../Model/ScuffleYama/ScuffleYamaPlayerModel":"ScuffleYamaPlayerModel","../Model/ScuffleYama/ScuffleYamaPlayerRankModel":"ScuffleYamaPlayerRankModel","../Model/ScuffleYama/ScuffleYamaRecordModel":"ScuffleYamaRecordModel",GameAlarm:void 0}],ScuffleYamaNationRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"daa91rIQWtFPpa3zGIB4gQr","ScuffleYamaNationRankModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,function(){function t(){this._nationId=0,this._nationName="",this._memberCount=0,this._nationScore=0,this._nationRank=0}return t.prototype.initData=function(t){t&&(this._nationId=t.nationId||0,this._nationName=t.nationName||"",this._memberCount=t.memberCount||0,this._nationScore=t.score||0,this._nationRank=t.rank||0)},t.prototype.getNationId=function(){return this._nationId},t.prototype.getNationName=function(){return this._nationName},t.prototype.getMemberCount=function(){return this._memberCount},t.prototype.getNationScore=function(){return this._nationScore},t.prototype.getNationRank=function(){return this._nationRank},t=n([r],t)}());i.default=o,cc._RF.pop()},{}],ScuffleYamaPlayerModel:[function(t,e,i){"use strict";cc._RF.push(e,"d2d29wuluBM6KkwHaoKhZLY","ScuffleYamaPlayerModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,t("BaseUser")),s=function(){function t(){this._playerInfo=null,this._score=0,this._rank=0,this._nationRank=0,this._nationScore=0,this._lastChallengeBossTime=0,this._lastChallengeActorTime=0,this._lastBeatenTime=0}return t.prototype.initData=function(t){if(t){var e=t.attributes;e&&(this._playerInfo=new o,this._playerInfo.updateAttr(e)),this._score=t.score||0,this._rank=t.rank||0,this._nationRank=t.nationRank||0,this._nationScore=t.nationScore||0,this._lastChallengeBossTime=t.lastChallengeBossTime||0,this._lastChallengeActorTime=t.lastChallengeActorTime||0,this._lastBeatenTime=t.lastBeatenTime||0}},t.prototype.getPlayerInfo=function(){return this._playerInfo},t.prototype.getScore=function(){return this._score},t.prototype.getRank=function(){return this._rank},t.prototype.getNationRank=function(){return this._nationRank},t.prototype.getNationScore=function(){return this._nationScore},t.prototype.getLastChallengeBossTime=function(){return this._lastChallengeBossTime},t.prototype.getLastChallengeActorTime=function(){return this._lastChallengeActorTime},t.prototype.getLastBeatenTime=function(){return this._lastBeatenTime},t.prototype.isRevengeDataModel=function(){return!0},t=n([r],t)}();i.default=s,cc._RF.pop()},{BaseUser:"BaseUser"}],ScuffleYamaPlayerRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"ea37dapq49H8ZXA4506aOPv","ScuffleYamaPlayerRankModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,t("BaseUser")),s=function(){function t(){this._playerInfo=null,this._score=0,this._rank=0,this._lastBeatenTime=0,this._isRevengeTarget=!1}return t.prototype.initData=function(t){if(t){var e=t.attributes;e&&(this._playerInfo=new o,this._playerInfo.updateAttr(e)),this._score=t.score||0,this._rank=t.rank||0,this._lastBeatenTime=t.lastBeatenTime||0,this._isRevengeTarget=!1}},t.prototype.getPlayerInfo=function(){return this._playerInfo},t.prototype.getScore=function(){return this._score},t.prototype.getRank=function(){return this._rank},t.prototype.getLastBeatenTime=function(){return this._lastBeatenTime},t.prototype.isInProtectTime=function(){var t=td.GetTableClass(td.TableEnum.Config).getConfig("TANGLED_HELL_ACTOR_PRODUCT_CD"),e=td.TimeUtil.getTime();return this._lastBeatenTime<=e&&e<this._lastBeatenTime+1e3*t},t.prototype.setRevengeDataModel=function(t){this._isRevengeTarget=t||!1},t.prototype.isRevengeDataModel=function(){return this._isRevengeTarget},t=n([r],t)}();i.default=s,cc._RF.pop()},{BaseUser:"BaseUser"}],ScuffleYamaRankRecordConfig:[function(t,e,i){"use strict";cc._RF.push(e,"dabe54oPG1K6bqMSXaRA8cs","ScuffleYamaRankRecordConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="ScuffleYamaRankRecordConfig",e._tblName="tangled_hell_rank_reward_config",e._data={},e}return n(e,t),e.prototype.init=function(){for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t],i=e.rank;this._data[i]=e}},e.prototype.getCfgs=function(){return this._data?this._data:null},e.prototype.getRecordByRank=function(t){var e=this.getList();if(t<=0)return[];for(var i=0;i<e.length;i++)if(t<=e[i].rank)return e[i].reward;return[]},e.prototype.getList=function(){var t=[],e=this.getCfgs();for(var i in e)t.push(e[i]);return t.sort(this.sortFunc),t},e.prototype.sortFunc=function(t,e){return t.rank-e.rank},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ScuffleYamaRecordModel:[function(t,e,i){"use strict";cc._RF.push(e,"b9da6CnP51AWYNOpR/puVHp","ScuffleYamaRecordModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,t("BaseUser")),s=function(){function t(){this._attacker=null,this._defender=null,this._nScore=0}return t.prototype.initData=function(t){t&&(t.attend&&(this._attacker=new o,this._attacker.updateAttr(t.attend)),t.defend&&(this._defender=new o,this._defender.updateAttr(t.defend)),this._nScore=t.score||0)},t.prototype.getAttacker=function(){return this._attacker},t.prototype.getDefender=function(){return this._defender},t.prototype.getScore=function(){return this._nScore},t=n([r],t)}();i.default=s,cc._RF.pop()},{BaseUser:"BaseUser"}],SelectRechargeRewardItem:[function(t,e,i){"use strict";cc._RF.push(e,"a9ea8hYB1RF56OdNm6DLFJx","SelectRechargeRewardItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=window.td,u=t("ListItem"),d=t("CommonIconWidget"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgGou=null,e.iconNode=null,e._selectId=0,e}return n(e,t),e.prototype.onEnable=function(){this._addEventListener()},e.prototype.onDisable=function(){c.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListener=function(){var t=c.EventUtil,e=c.EventNameEnum;t.registerEvent(e.SELECT_ITEM_CHANGE,this._onChangeSelect,this)},e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this._selectId=i[0];var n=c.RewardManager.parseRewardListDetail(i[1])[0],a=this.iconNode.getChildByName("iconItem"),r=null;a||((a=c.GlobalFunction.createCommonIconWidget(34,n)).name="iconItem",this.iconNode.addChild(a),a.y=5),(r=a.getComponent(d)).setNameBgVisible(!1),r.setData(n),this.imgGou.active=!1},e.prototype._onChangeSelect=function(t){var e=t.index;this.imgGou.active=e===this._index},e.prototype.selectItem=function(){if(!this.imgGou.active){var t={};t.index=this._index,t.id=this._selectId,c.EventUtil.dispatchEvent(c.EventNameEnum.SELECT_ITEM_CHANGE,t)}},a([s(cc.Node)],e.prototype,"imgGou",void 0),a([s(cc.Node)],e.prototype,"iconNode",void 0),e=a([o,l("module/Activity/SelectRechargeRewardItem")],e)}(u);i.default=h,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],SelectRechargeRewardWindow:[function(t,e,i){"use strict";cc._RF.push(e,"e4c83a+l5JFu4sSYUYwwApa","SelectRechargeRewardWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeHorizontalListView"),h=t("./SelectRechargeRewardItem"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scrollView=null,e.rewardContent=null,e.item=null,e._selectId=-1,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_SelectRechargeReward},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this._itemData=null,this._getBtnCallFunc=null,this.item.active=!1,this._listViewComponent=this.node.getComponent(d)},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListener=function(){var t={},e=r.EventNameEnum;t[e.SELECT_ITEM_CHANGE]=this._onChangeSelect,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.closeCallFunc,r.EventUtil.registerEvents(t,this)},e.prototype._onChangeSelect=function(t){this._selectId=t.id||-1},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._getBtnCallFunc=e.callFunc;var i=e.itemList,n=i.length;if(n>4)this.scrollView.node.active=!0,this.rewardContent.active=!1,this._listViewComponent.setData(e.itemList);else{this.scrollView.node.active=!1,this.rewardContent.active=!0;for(var a=0;a<n;a++){var r=cc.instantiate(this.item);r.parent=this.rewardContent,r.active=!0,r.y=0,r.getComponent(h.default).updateItem(a,i[a])}}},e.prototype.btnGet=function(t){if(this._selectId<0){var e=new r.BroadcastContent(217);r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,e)}else this._getBtnCallFunc&&this._getBtnCallFunc(this._selectId)},a([l(cc.ScrollView)],e.prototype,"scrollView",void 0),a([l(cc.Node)],e.prototype,"rewardContent",void 0),a([l(cc.Node)],e.prototype,"item",void 0),e=a([s,c("module/Activity/SelectRechargeRewardWindow")],e)}(u);i.default=p,cc._RF.pop()},{"./SelectRechargeRewardItem":"SelectRechargeRewardItem",OptimizeHorizontalListView:void 0,PanelBase:void 0}],SendHeroSkillAtrrListView:[function(t,e,i){"use strict";cc._RF.push(e,"e4d9f3BccdGc6ftGmvNnn0P","SendHeroSkillAtrrListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{_curHeroData:null},setData:function(t){this._curHeroData=t.heroData;var e=t.dataList;this._super(e)},setItemView:function(t,e,i){i-=1;var n=t.getChildByName("imgSkillIcon"),a=t.getChildByName("labSkillName"),r=t.getChildByName("labAttrDesc"),o=this._curHeroData.getEvolveTalentIds()[i],s=td.MercenaryManager.getEvolveTalentById(o),l=gdk.rm.getResByUrl(td.resDef.pngPlist.talent_icon,cc.SpriteAtlas),c=this._curHeroData.getTotalEvolveLevel(),u=td.MercenaryManager.getEvolveTalentOpenedNumByEvolveLevel(c)>=i+1;if(u)var d="<color=#F3F699>"+s.getName()+"</c><color=#00ff00> ("+td.Language.isUnlock+")</color>";else{var h=td.MercenaryManager.getUnlockEvolveLevelByNum(i+1),p=this._curHeroData.getNameWithoutEvoAndAwake();p=p.split("\xb7")[p.split("\xb7").length-1],h>0&&(p=p+"+"+h);d="<color=#F3F699>"+s.getName()+"</c><color=#F3F699> (</color><color=#ff0000>"+p+" </c><color=#F3F699>"+td.Language.unlock+"</color><color=#F3F699>)</color>"}a.getComponent(cc.RichText).string=d;var _=l.getSpriteFrame(s.getIcon());return td.GlobalFunction.createSpriteNode(n,_),td.GlobalFunction.graySprite(n,!u),r.getComponent(cc.Label).string=s.getDesc(),t}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],ServerSettingKey:[function(t,e,i){"use strict";cc._RF.push(e,"f325ePuH09DpadDv4/3CjO+","ServerSettingKey"),td.ServerSettingKey={SERVER_START_TIME:1,SUPREME_GACHA:18,GROW_FUND_BUY_TOTAL_COUNT:22},td.PerformanceEnum={general:1,high:2,perfect:3},cc._RF.pop()},{}],ShiHuaPiFu:[function(t,e,i){"use strict";cc._RF.push(e,"479c4QOONVL+KjVtva0ZbNn","ShiHuaPiFu");var n=t("BaseBossSkill"),a=(t("PveFightManager"),cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="ShiHuaPiFu"},effect:function(){if(cc.isValid(this._owner)){var t=this._owner._tag,e=Math.floor(t/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._owner.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=i.bDeath(),a=i.getTransferStatus();n||a?this.removeSelf():this.setAttackEffectToEnemy(i)}else this.removeSelf()}}));e.exports=a,cc._RF.pop()},{BaseBossSkill:"BaseBossSkill",PveFightManager:"PveFightManager"}],ShopEnum:[function(t,e,i){"use strict";cc._RF.push(e,"f212fqCVS1EgYQ0USykFAoT","ShopEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.StoreRefreshType=i.StoreType=void 0,function(t){t[t.HERO=1]="HERO",t[t.EQUIPMENT=2]="EQUIPMENT",t[t.DIAMOND=3]="DIAMOND",t[t.STAR_UP=4]="STAR_UP",t[t.TREASURE=5]="TREASURE",t[t.ARENA=6]="ARENA",t[t.EVIL_GOD=7]="EVIL_GOD",t[t.NATION=9]="NATION",t[t.REWARD=10]="REWARD",t[t.TURNTABLE=11]="TURNTABLE",t[t.VIPPREROGATIVE=12]="VIPPREROGATIVE",t[t.PURPLE_FAIRYLAND=13]="PURPLE_FAIRYLAND",t[t.ANCIENT=14]="ANCIENT",t[t.CROSS_ARENA=15]="CROSS_ARENA",t[t.CROSS_CUP=16]="CROSS_CUP",t[t.LEGEND=17]="LEGEND",t[t.MAZE=18]="MAZE",t[t.CHESS=19]="CHESS",t[t.SHOP_NORMAL_MAX=99]="SHOP_NORMAL_MAX",t[t.SYSTEM=100]="SYSTEM",t[t.HERO_LOWER=101]="HERO_LOWER",t[t.NONE=0]="NONE"}(i.StoreType||(i.StoreType={})),function(t){t[t.AUTOMATIC=1]="AUTOMATIC",t[t.MANUAL=2]="MANUAL",t[t.NONE=0]="NONE"}(i.StoreRefreshType||(i.StoreRefreshType={})),cc._RF.pop()},{}],ShopGoodsTable:[function(t,e,i){"use strict";cc._RF.push(e,"0b7a34b201KZIwhcVx0HYBT","ShopGoodsTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ShopGoodsTable",properties:{_tblName:"store_goods_config",_storeData:null},init:function(){this._storeData={};for(var t=this._storeData,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.storeType]||(t[a.storeType]={}),t[a.storeType][a.productId]=a}},getData:function(){return this._storeData},getShopDataByShopType:function(t){return this._storeData[t]?this._storeData[t]:null},getShopDataByShopTypeAndProductId:function(t,e){return this._storeData[t]&&this._storeData[t][e]?this._storeData[t][e]:null},getShowGoodsIdByShopType:function(t){var e=[];if(this._storeData[t])for(var i in this._storeData[t])-1!=this._storeData[t][i].sortRank&&e.push(i);return e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ShopItemModel:[function(t,e,i){"use strict";cc._RF.push(e,"69e1fy+wUxCro6PkMrXG/gf","ShopItemModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=cc._decorator.ccclass,o=t("../Manager/ShopEnum"),s=function(){function t(){this._num=0,this._couldBuy=!1,this._showLevel=0,this._isCanShow=!0}return t.prototype.setData=function(t,e){(e.buyCount||0==e.buyCount)&&(this._num=e.buyCount),this._storeType=parseInt(t),e.productId?this._productId=e.productId:this._productId=e;var i=a.GetTableClass(a.TableEnum.ShopGoodsTable).getShopDataByShopTypeAndProductId(t,this._productId);if(i){t==o.StoreType.REWARD?this._type=i.page:this._type=i.type,this._price=i.price,this._refreshType=i.refreshType,this._refreshValue=i.refreshValue,this._rewards=i.rewards,this._discount=i.discount,this._unlockId=i.unlockId,this._sortRank=i.sortRank,this._maxTimes=i.times,this._showLevel=i.showLevel||0;var n=a.Account.getUserData().getLevel();this._isCanShow=n>=this._showLevel;var r=0===this._unlockId||a.UnlockManager.isTargetUnlockById(this._unlockId);this._couldBuy=r}},t.prototype.getStoreType=function(){return this._storeType},t.prototype.getSubType=function(){return this._type},t.prototype.getProductId=function(){return this._productId},t.prototype.getSortRank=function(){return this._sortRank},t.prototype.getMoneyId=function(){return this._moneyId},t.prototype.getPrice=function(){return this.getPriceByTimes(1)},t.prototype.getPriceByTimes=function(t,e){void 0===e&&(e=!1),t+=this._num;var i=null,n=this._price.length;if(t>=this._price[n-1][0])i=this._price[n-1][1];else for(var a=0;a<n;a++){if(t<this._price[a][0]){i=0===a?this._price[a][1]:this._price[a-1][1];break}}return i&&(i=e?i:i[0]),i},t.prototype.getTotalPriceForTimes=function(t,e){void 0===e&&(e=!1);for(var i=null,n=1;n<=t;n++){var a=this.getPriceByTimes(n,e);null===i?i=a.slice(0):e||(i[2]+=a[2])}return i},t.prototype.getCanBuyMaxCount=function(){for(var t=0,e=null,i=0,n=1;;n++){var r=this.getPriceByTimes(n);if(!r)break;if(i+=r[2],null===e&&(e=a.ItemManager.getItemNumById(r[1])),e<i)break;t++}return t},t.prototype.getRefreshType=function(){return this._refreshType},t.prototype.getRefreshValue=function(){return this._refreshValue},t.prototype.getRewards=function(){return this._rewards},t.prototype.getDiscount=function(){return this._discount},t.prototype.getUnlockId=function(){return this._unlockId},t.prototype.getNum=function(){return this._num},t.prototype.getCouldBuy=function(){return this._couldBuy},t.prototype.setCouldBuy=function(t){this._couldBuy=t},t.prototype.getShowLevel=function(){return this._showLevel},t.prototype.isCanShow=function(){return a.Account.getUserData().getLevel()>=this._showLevel},t.prototype.getMaxTimes=function(){if(0===this._maxTimes.length)return 0;var t=a.Account.getUserData().vip,e=this._maxTimes.length;if(t>=this._maxTimes[e-1][0])return this._maxTimes[e-1][1];for(var i=0,n=0;n<e;n++){if(t<this._maxTimes[n][0]){i=0===n?this._maxTimes[n][1]:this._maxTimes[n-1][1];break}}return i},t.prototype.getMaxTimesForNextVip=function(){for(var t=a.Account.getUserData().vip,e=0,i=this._maxTimes.length;e<i;e++){if(t<this._maxTimes[e][0])return this._maxTimes[e]}return null},t=n([r],t)}();e.exports=s,cc._RF.pop()},{"../Manager/ShopEnum":"ShopEnum"}],ShopManager:[function(t,e,i){"use strict";cc._RF.push(e,"ba9d4VfGhFOuagWpbAxIkof","ShopManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,window.td),s=t("ShopModel"),l=t("ShopItemModel"),c=t("../Manager/ShopEnum"),u=function(){function t(){this._shopList={},this._storeCoinType=[0,21,[22,27],1,23,0,4,14,5,9,0,0,0,26,28,29,19,[30,31],32,33],this._isHideReward=!1,this._isLoadCfg=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e,this._instance._isShowtips=!0),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener()},t.prototype.destroyData=function(){this._isHideReward=!1,this._isLoadCfg=!1},t.prototype.addListener=function(){var t=o.MsgModuleName.SHOP,e=o.MsgCmd.SHOP;o.ServerDelegate.registerMessage(t,e.GET_SHOP_INFO,this.parseShopInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.BUY_GOODS,this.parseBuyGoods.bind(this)),o.ServerDelegate.registerMessage(t,e.REFRESH_SHOP,this.parseRefreshShoop.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_SHOP_INFO,this.parseShopInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_STORE_ITEM,this.parseShopItem.bind(this))},t.prototype.parseShopInfo=function(t,e){var i=this;if(t===o.NetCode.SUCCESS){var n;if(e.storeList.forEach(function(t){if(parseInt(t.type)!=c.StoreType.REWARD)if(i._shopList[t.type])i._shopList[t.type].setData(t,!0);else{var e=new s;e.setData(t),i._shopList[e.getStoreType()]=e}else n=t}),n)n.items.forEach(function(t){var e=o.GetTableClass(o.TableEnum.ShopGoodsTable).getShopDataByShopTypeAndProductId(10,t.productId);if(e){var n=e.type;i._shopList[n].updataGoods(t,c.StoreType.REWARD)}});this.loadCfg(),o.EventUtil.dispatchEvent(o.EventNameEnum.RESGET_STORE_INFO)}},t.prototype.parseShopItem=function(t,e){var i=this;if(t===o.NetCode.SUCCESS){var n=parseInt(e.type);e.items.forEach(function(t){if(n==c.StoreType.REWARD){var e=o.GetTableClass(o.TableEnum.ShopGoodsTable).getShopDataByShopTypeAndProductId(10,t.productId);n=e.type}i._shopList[n].updataGoods(t)}),o.EventUtil.dispatchEvent(o.EventNameEnum.RESGET_STORE_INFO)}},t.prototype.parseBuyGoods=function(t,e){if(t===o.NetCode.SUCCESS){var i=e.rewardResult,n=o.RewardManager.parseRewardResult(i,!0);!this._isHideReward&&o.GlobalFunction.showRewards(n),this._isHideReward=!1,o.EventUtil.dispatchEvent(o.EventNameEnum.RESBUY_GOODS)}},t.prototype.parseRefreshShoop=function(t,e){t===o.NetCode.SUCCESS&&(this._isBattle=!1,o.EventUtil.dispatchEvent(o.EventNameEnum.RESREFRESH_STORE))},t.prototype.addEventListener=function(){var t=o.EventUtil,e=o.EventNameEnum,i={};i[e.REQGET_STORE_INFO]=this.reqStoreInfo,i[e.REQBUY_GOODS]=this.reqBuyGoods,i[e.REQREFRESH_STORE]=this.reqRefreshStore,i[e.ON_OPEN_SHOP]=this.onOpenShop,t.registerEvents(i,this)},t.prototype.reqStoreInfo=function(){var t={};t.module=o.MsgModuleName.SHOP,t.cmd=o.MsgCmd.SHOP.GET_SHOP_INFO,o.ServerDelegate.sendMessage(t)},t.prototype.reqBuyGoods=function(t){var e={};e.module=o.MsgModuleName.SHOP,e.cmd=o.MsgCmd.SHOP.BUY_GOODS,e.storeType=t.storeType,e.productMap=t.productMap,this._isHideReward=t.hideReward||!1,o.ServerDelegate.sendMessage(e)},t.prototype.reqRefreshStore=function(){var t={};t.module=o.MsgModuleName.SHOP,t.cmd=o.MsgCmd.SHOP.REFRESH_SHOP,t.storeType=this._shopType,o.ServerDelegate.sendMessage(t)},t.prototype.getShopItemModelByTypeAndProductId=function(t,e){if(this._shopList[t])for(var i=this._shopList[t].getItems(),n=0;n<i.length;n++)if(i[n].getProductId()==e)return i[n];return null},t.prototype.getShopModel=function(){return this._shopList[this._shopType]},t.prototype.getShopModelByType=function(t){return this._shopList[t]},t.prototype.getItemByTypeAndSubType=function(){return this._shopList[this._shopType]?this._shopList[this._shopType].getItemsBySubType(this._subType):[]},t.prototype.getShopType=function(){return this._shopType},t.prototype.setShopType=function(t){this._shopType=t},t.prototype.getSubType=function(){return this._subType},t.prototype.setSubType=function(t){this._subType=t},t.prototype.getSelectIndex=function(){return this._selectIndex},t.prototype.setSelectIndex=function(t){this._selectIndex=t},t.prototype.getIsBattle=function(){return this._isBattle},t.prototype.setIsBattle=function(t){this._isBattle=t},t.prototype.getIsShowtips=function(){return this._isShowtips},t.prototype.setIsShowtips=function(t){this._isShowtips=t},t.prototype.getOpenShops=function(){var t=[],e=o.GetTableClass(o.TableEnum.StoreRefreshTable).getDataByType(c.StoreType.HERO_LOWER);e&&e.isShow&&o.UnlockManager.isTargetUnlock(o.ActorUnlockType.Shop,c.StoreType.HERO_LOWER)&&t.push(c.StoreType.HERO);for(var i=c.StoreType.EQUIPMENT;i<=c.StoreType.SHOP_NORMAL_MAX;i++){var n=o.GetTableClass(o.TableEnum.StoreRefreshTable).getDataByType(i);n&&n.isShow&&(o.UnlockManager.isTargetUnlock(o.ActorUnlockType.Shop,i)&&t.push(i))}return t},t.prototype.getSubTypeNum=function(){this._storeSubType||(this._storeSubType=o.GetConfig("STORE_SUBTYPE_PAGE"));for(var t=0;t<this._storeSubType.length;t++)if(this._shopType==this._storeSubType[t][0])return this._storeSubType[t][1];return 1},t.prototype.getSubTypeList=function(){var t=[],e=this.getSubTypeNum();this._lockArray&&0!==this._lockArray.length||(this._lockArray=o.GetConfig("STORE_SUBTYPE_UNLOCK"));for(var i={},n=0;n<this._lockArray.length;n++)this._shopType==this._lockArray[n][0]&&(i[this._lockArray[n][1]]=this._lockArray[n][2]);for(var a=1;a<=e;a++)i[a]&&!o.UnlockManager.isTargetUnlockById(i[a])||t.push(a);return t},t.prototype.getStoreCoinType=function(){return this._storeCoinType[this._shopType]},t.prototype.loadCfg=function(){if(!this._isLoadCfg){for(var t=c.StoreType.HERO;t<c.StoreType.SHOP_NORMAL_MAX;t++){var e=o.GetTableClass(o.TableEnum.StoreRefreshTable).getDataByType(t);e&&e.refreshType==c.StoreRefreshType.NONE&&this.initShopListByType(t)}this.initShopListByType(c.StoreType.SYSTEM),this.initShopListByType(c.StoreType.HERO_LOWER),this._isLoadCfg=!0}},t.prototype.initShopListByType=function(t){var e=o.GetTableClass(o.TableEnum.ShopGoodsTable).getShopDataByShopType(t);if(e)for(var i in e){var n=e[i],a=void 0,r=n.productId;a=t==c.StoreType.REWARD?n.type:n.storeType;for(var s=this._shopList[a].getItems(),u=!1,d=0;d<s.length;d++)if(s[d].getProductId()==r){u=!0;break}if(!u){var h=new l;h.setData(t,r),this._shopList[a].addGoods(h)}}},t.prototype.onOpenShop=function(t){o.GlobalFunction.setLocalSaveStatus("ShopRedPoint"+t,!0)},t.prototype.onJump=function(t,e){this._shopType=t,this._subType=1,e&&(this._subType=e),o.PanelJumpManager.jumpToPanel(o.PanelEnum.Panel_ShopType1,t)},t.prototype.isShopRedPointTips=function(){for(var t=this.getOpenShops(),e=0,i=t.length;e<i;e++){var n=t[e];if(this.isShopTipsByType(n))return!0}return!1},t.prototype.isShopTipsByType=function(t){if(!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.Shop,t))return!1;if(t!==c.StoreType.HERO)return o.GlobalFunction.removeLocalSaveStatus("ShopRedPoint"+t),!1;if(t===c.StoreType.DIAMOND)return!1;if(!this._shopList||!this._shopList[t])return!1;for(var e=this._shopList[t].getItems(),i=!1,n=0,a=e.length;n<a;n++){var r=e[n];if(r.getStoreType()===c.StoreType.REWARD){var s=0===(h=r.getUnlockId())||o.UnlockManager.isTargetUnlockById(h),l=r.getCouldBuy();if(s){l||(o.GlobalFunction.removeLocalSaveStatus("ShopRedPoint"+t),r.setCouldBuy(s));var u=r.getMaxTimes(),d=r.getNum();(p=0===u||u>0&&d<u)&&(i=!0)}}else if(r.getStoreType()===c.StoreType.TURNTABLE){var h;if(s=0===(h=r.getUnlockId())||o.UnlockManager.isTargetUnlockById(h)){u=r.getMaxTimes(),d=r.getNum();var p=0===u||u>0&&d<u;if(r.getCanBuyMaxCount()&&p){var _=r.getPrice();i=o.ItemManager.getItemNumById(_[1])>=_[2]}}}}var g,f=o.GlobalFunction.getLocalSaveStatus("ShopRedPoint"+t);return g=!0===f||"true"===f,t!==c.StoreType.TURNTABLE?!g:!g&&i},t.prototype.shopTipsEvents=function(){var t=o.EventNameEnum;return[t.ON_OPEN_SHOP,t.RESBUY_GOODS,t.USER_ON_ATTR_CHANGE]},t=e=n([r],t)}();i.default=u,cc._RF.pop()},{"../Manager/ShopEnum":"ShopEnum",ShopItemModel:"ShopItemModel",ShopModel:"ShopModel"}],ShopModel:[function(t,e,i){"use strict";cc._RF.push(e,"554cbG6+yxBx5iY5yqTP9dd","ShopModel");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=cc._decorator.ccclass,o=t("ShopItemModel"),s=t("../Manager/ShopEnum"),l=function(){function t(){this._items=[],this._freeTimes=0,this._paymentTimes=0,this._refreshTimes=0,this._nextRecoverTime=0,this._nextResetTime=0}return t.prototype.setData=function(t,e){var i=this;if(void 0===e&&(e=!1),this._storeType=t.type,(t.refreshTimes||0==t.refreshTimes)&&(this._refreshTimes=t.refreshTimes),(t.freeTimes||0==t.freeTimes)&&(this._freeTimes=t.freeTimes),(t.paymentTimes||0==t.paymentTimes)&&(this._paymentTimes=t.paymentTimes),(t.nextRecoverTime||0==t.nextRecoverTime)&&(this._nextRecoverTime=t.nextRecoverTime),(t.nextResetTime||0==t.nextResetTime)&&(this._nextResetTime=t.nextResetTime),e){var n=[];this._items.forEach(function(t){t.getStoreType()===s.StoreType.REWARD&&n.push(t)}),this._items=n}t.items.forEach(function(t){for(var e=!1,n=0;n<i._items.length;n++)if(t.productId===i._items[n].getProductId()){e=!0,i._items[n].setData(i._storeType,t);break}if(!e){var a=new o;a.setData(i._storeType,t),i._items.push(a)}}),this._freshCfg=a.GetTableClass(a.TableEnum.StoreRefreshTable).getDataByType(this._storeType)},t.prototype.sortFunc=function(t,e){return t.getSortRank()-e.getSortRank()},t.prototype.getStoreType=function(){return this._storeType},t.prototype.getRefreshTimes=function(){return this._refreshTimes},t.prototype.getFreeTimes=function(){return this._freeTimes},t.prototype.getPaymentTimes=function(){return this._paymentTimes},t.prototype.getNextRecoverTime=function(){return this._nextRecoverTime},t.prototype.getNextResetTime=function(){return this._nextResetTime},t.prototype.getFreshCfg=function(){return this._freshCfg},t.prototype.getItems=function(){return this._items},t.prototype.getItemsBySubType=function(t){var e=[];return this._items.forEach(function(i){i.getSubType()==t&&-1!=i.getSortRank()&&i.isCanShow()&&e.push(i)}),e.sort(this.sortFunc)},t.prototype.addGoods=function(t){this._items.push(t)},t.prototype.updataGoods=function(t,e){void 0===e&&(e=0);for(var i=!1,n=0;n<this._items.length;n++)if(this._items[n].getProductId()==t.productId){e||(e=this._items[n].getStoreType()),this._items[n].setData(e,t),i=!0;break}if(!i){var a=new o;e||(e=this._storeType),a.setData(e,t),this.addGoods(a)}},t=n([r],t)}();e.exports=l,cc._RF.pop()},{"../Manager/ShopEnum":"ShopEnum",ShopItemModel:"ShopItemModel"}],ShopRefreshTable:[function(t,e,i){"use strict";cc._RF.push(e,"7c374UIDA1HKqRhp68/Fjvi","ShopRefreshTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ShopRefreshTable",properties:{_tblName:"store_refresh_config",_data:null},init:function(){this._data={};for(var t=0,e=this._jsonData.length;t<e;t++){var i=this._jsonData[t],n=this._jsonData[t+1],a=i.times,r=9999;n&&(r=n.times-1),i.fromTimes=a,i.toTimes=r;var o=i.storeType;this._data[o]=this._data[o]||[],this._data[o].push(i)}},getCfgWithTypeAndTimes:function(t,e){if(!this._data[t])return null;for(var i=this._data[t],n=0,a=i.length;n<a;n++){var r=i[n],o=r.fromTimes,s=r.toTimes;if(e>=o&&e<=s)return r}return null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ShopShowTable:[function(t,e,i){"use strict";cc._RF.push(e,"39b19ZOLSZK4o9GXut7RF5Z","ShopShowTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ShopShowTable",properties:{_tblName:"shop_show_config",_showData:null},init:function(){this._showData={};this._showData;for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];this._showData[n.shopType]=n}},getAllData:function(){return this._showData},getShowDataByShopType:function(t){return this._showData[t]?this._showData[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],ShouXueFeiTeng:[function(t,e,i){"use strict";cc._RF.push(e,"533c4juPwNPnK81taNFTCEW","ShouXueFeiTeng");var n=t("CommonSkill"),a=(t("PveFightManager"),cc.Class({extends:n,properties:{_targetTower:null},initData:function(t){this._super(t),this._skillName="ShouXueFeiTeng"},setTargetTower:function(t){this._targetTower=t},onEnable:function(){this._super();var t=this._targetTower._tag,e=Math.floor(t/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),i=this._targetTower.getComponent(td.PveEnum.PVE_HERO_SCRIPT[e]);this.addTowerBuff(i)},addTowerBuff:function(t){for(var e=this._dataModel.getAttackEffect(),i=0,n=e.length;i<n;i++){var a=e[i],r=a[0];if(r!==td.PveEnum.PVE_EFFECT_TYPE.PureHurt1){var o=a[1]/1e4,s=a[2]/1e3;r===td.PveEnum.PVE_EFFECT_TYPE.PureHurt2&&(o=this._curHeroAttackPower*o);var l={buffType:r,buffData:o,buffTime:s,showBuff:!1};t.addTowerBuff(l)}}},frameEventCallBack:function(){}}));e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill",PveFightManager:"PveFightManager"}],ShowGateInfo:[function(t,e,i){"use strict";cc._RF.push(e,"b2c94mE0apMrJR8bA5w4chA","ShowGateInfo");var n=cc.Class({extends:cc.Component,properties:{},setGateInfo:function(){this.node.setScale(5);var t=td.PveCopyManager.getCopyName();this.node.getChildByName("labGateName").getComponent(cc.Label).string=t;var e=td.PveCopyManager.getGateIndex();this.node.getChildByName("labGateCount").getComponent(cc.Label).string=cc.js.formatStr(td.Language.passIndex,e),this.playAction()},playAction:function(){var t=cc.fadeIn(.3),e=cc.scaleTo(.3,1),i=cc.spawn(t,e),n=cc.delayTime(1),a=cc.fadeOut(.1),r=cc.scaleTo(.1,2),o=cc.spawn(a,r),s=this,l=cc.callFunc(function(){s.removeInfoNode()}),c=cc.sequence(i,n,o,l);this.node.runAction(c)},removeInfoNode:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.BEGIN_CREATE_ENEMY),this.node.removeFromParent()}});e.exports=n,cc._RF.pop()},{}],ShowTipMessage:[function(t,e,i){"use strict";cc._RF.push(e,"98e5dwOBphAjagjMytOF0xg","ShowTipMessage");var n=cc.Class({extends:cc.Component,properties:{_labTip:null},onLoad:function(){this._labTip=this.node.getChildByName("labTip")},setTipMessage:function(t){this._labTip.getComponent(cc.Label).string=t,this._playAction()},_playAction:function(){var t=cc.moveBy(3,cc.v2(0,100)),e=cc.fadeOut(.5),i=this,n=cc.callFunc(function(){i._removeSelf()}),a=cc.sequence(t,e,n);this.node.runAction(a)},_removeSelf:function(){this.node.removeFromParent()}});e.exports=n,cc._RF.pop()},{}],SiWangDiaoLing:[function(t,e,i){"use strict";cc._RF.push(e,"a12b5xHh39PAZ1FN3bPEI8x","SiWangDiaoLing");var n=t("CommonSkill"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_haveSkillEnemyList:null,_time:null},initData:function(t){this._super(t),this._skillName="SiWangDiaoLingSkill",this._haveSkillEnemyList=[],this._time=0},update:function(t){this._time+=t*this._curSpeedMult;for(var e=this._dataModel.getDamageRange()/2,i=a.getEnemyArray(),n=this.node.getPosition(),r=0,o=i.length;r<o;r++){var s=i[r];if(s){var l=s._tag,c=Math.floor(l/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),u=s.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[c]),d=u.bDeath(),h=s.getPosition(),p=td.GlobalFunction.getDistance(n,h),_=this.checkEnemyExistInList(l);p<=e&&!d&&!_&&this.setAttackEffectToEnemy(u)}}},checkEnemyExistInList:function(t){for(var e=0,i=this._haveSkillEnemyList.length;e<i;e++)if(this._haveSkillEnemyList[e]===t)return!0;return this._haveSkillEnemyList.push(t),!1},frameEventCallBack:function(){}});e.exports=r,cc._RF.pop()},{CommonSkill:"CommonSkill",PveFightManager:"PveFightManager"}],SiegeCityConfig:[function(t,e,i){"use strict";cc._RF.push(e,"5b954otGw9ApbgCB2j6XSks","SiegeCityConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="SiegeCityConfig",e._tblName="siege_city_config",e}return n(e,t),e.prototype.init=function(){this._data={},this._roundData={};for(var t=this._data,e=this._jsonData,i=this._roundData,n=0,a=e.length;n<a;++n){var r=e[n];t[t.length]=r,i[r.round]||(i[r.round]={}),i[r.round][r.cityId]=r,t[r.cityId]=r}},e.prototype.getNationCityByRound=function(t){return this._roundData[t]?this._roundData[t]:this._roundData[this._roundData.myLen()]?this._roundData[this._roundData.myLen()]:void 0},e.prototype.getNationCityById=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SiegeCityDefenceConfig:[function(t,e,i){"use strict";cc._RF.push(e,"d6ab0l7ut9AxL4M53xCBD1E","SiegeCityDefenceConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="SiegeCityDefenceConfig",e._tblName="siege_city_defence_config",e}return n(e,t),e.prototype.init=function(){this._data=[],this._defenceNumData=[];for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];n.totalDefend=n.defenceTimes*n.defenceScore,this._data[this._data.length]=n,this._defenceNumData[this._defenceNumData.length]=n.playerCount}},e.prototype.getDefenceData=function(){return this._data},e.prototype.getDefenceScoreByIndex=function(t){var e=this._data[t];return e?e.defenceScore:0},e.prototype.getDefenceNumData=function(){return this._defenceNumData},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SiegeGuardModel:[function(t,e,i){"use strict";cc._RF.push(e,"4c735qB6QpBapLj6SE7YwE5","SiegeGuardModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._defend=0,e._totalDefend=0,e._nationId=0,e._surplusDefendTimes=0,e}return n(e,t),e.prototype.init=function(e,i,n){t.prototype.init.call(this,e.attributes),this._defend=e.defend,this._totalDefend=i.totalDefend,this._surplusDefendTimes=e.defenceTimes,this._nationId=n},e.prototype.getDefend=function(){return this._defend},e.prototype.getTotalDefend=function(){return this._totalDefend},e.prototype.getSurplusDefendTimes=function(){return this._surplusDefendTimes},e.prototype.getNationId=function(){return this._nationId},e}(t("UserModel")));e.exports=a,cc._RF.pop()},{UserModel:"UserModel"}],SiegeNationWarActorRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"a2103Gf8WVL7KrVOSTHec0H","SiegeNationWarActorRankModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=window.td,r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._rank=0,e._nationScore=0,e}return n(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e.attributes),this._rank=e.rank,this._nationScore=e.score},e.prototype.getRank=function(){return this._rank},e.prototype.getNationScore=function(){return a.GlobalFunction.getSimpledNumStr(this._nationScore)},e.prototype.getSiegeScore=function(){return this._siegeScore},e}(t("UserModel"));e.exports=r,cc._RF.pop()},{UserModel:"UserModel"}],SiegeNationWarRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"a9001LJEZVAFJVVYUuzQ7se","SiegeNationWarRankModel");window.td;var n=t("NationSimpleInfo"),a=function(){function t(){this._rank=0,this._defend=0,this._occupy=0,this._score=0,this._round=0}return t.prototype.init=function(t){this._rank=t.rank,this._defend=t.defend,this._occupy=t.cityCount,this._score=t.score,this._round=t.round,this._nationSimpleInfo=new n,this._nationSimpleInfo.init(t.nation)},t.prototype.getNationSimpleInfo=function(){return this._nationSimpleInfo},t.prototype.getRound=function(){return this._round},t.prototype.getRank=function(){return this._rank},t.prototype.getOccupy=function(){return this._occupy},t.prototype.getScore=function(){return this._score},t.prototype.getDefend=function(){return this._defend},t}();e.exports=a,cc._RF.pop()},{NationSimpleInfo:"NationSimpleInfo"}],SignInConfig:[function(t,e,i){"use strict";cc._RF.push(e,"8c370T8509LMIto9G5A9Zdj","SignInConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"SignInConfig",properties:{_tblName:"sign_in_config",_data:null},init:function(){this._data={};for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e],a=n.type,r=n.stage;this._data[a]||(this._data[a]={}),this._data[a][r]||(this._data[a][r]=[]),this._data[a][r].push(n)}},getDatas:function(t,e){return this._data[t][e]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SignInController:[function(t,e,i){"use strict";cc._RF.push(e,"891ce6kFsNM5LuhKztxfl9v","SignInController");var n=t("ActivityBaseController"),a=t("SignInModel"),r=cc.Class({extends:n,properties:{_signInfo:null,_stage:0},initData:function(t){this._super(t),this.addNetListener(),this.addEventListener()},destroyData:function(){this._super()},addNetListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.SIGN_IN,i=td.MsgCmd.SIGN_IN;t.registerMessage(e,i.GET_SIGN_IN,this._resGetSignInfo.bind(this)),t.registerMessage(e,i.SIGN_IN,this._resSignIn.bind(this)),t.registerMessage(e,i.PUSH_SIGN_IN,this._resGetSignInfo.bind(this))},addEventListener:function(){var t={},e=td.EventNameEnum;t[e.Req_SIGN_IN]=this._reqSignIn.bind(this),t[e.REQ_GET_DAILY_SIGN_CONFIG]=this._reqGetDailySignInfo.bind(this),td.EventUtil.registerEvents(t,this)},_reqGetDailySignInfo:function(){var t={};t.module=td.MsgModuleName.SIGN_IN,t.cmd=td.MsgCmd.SIGN_IN.GET_SIGN_IN,td.ServerDelegate.sendMessage(t)},_resGetSignInfo:function(t,e){var i=this;if(t===td.NetCode.SUCCESS){var n=e.signInList;this._signInfo={},n.forEach(function(t){var e=new a;e.type=t.type,e.days=t.days,e.stage=t.stage,e.lastSignInTime=t.lastSignInTime,i._signInfo[e.type]=e}),td.EventUtil.dispatchEvent(td.EventNameEnum.Res_GET_DAILY_SIGN_INFO)}},getStageByType:function(t){return this._signInfo[t]?this._signInfo[t].getStage():this._signInfo[1].getStage()},getSignInfoByType:function(t){return this._signInfo[t]},getSignChargeId:function(t){var e=0;return td.GetConfig("SIGN_IN_CHARGE_ID").forEach(function(i){i[0]===t&&(e=i[1])}),e},getCurDay:function(t){var e=this.getSignInfoByType(t);return e?e.getCurDay():0},getCurDayState:function(t){void 0===t&&(t=1);var e=this.getCurDay(t);return this.getSignState(t,e)===td.ActivityEnum.SignInState.Signing},getSignState:function(t,e){var i=this.getSignInfoByType(t);return i?e<=i.days?td.ActivityEnum.SignInState.Signed:e===i.getCurDay()?i.isTodaySigned()?td.ActivityEnum.SignInState.Signed:td.ActivityEnum.SignInState.Signing:td.ActivityEnum.SignInState.NotSign:td.ActivityEnum.SignInState.NotSign},_reqSignIn:function(t){var e={};e.module=td.MsgModuleName.SIGN_IN,e.cmd=td.MsgCmd.SIGN_IN.SIGN_IN,e.type=t,td.ServerDelegate.sendMessage(e)},_resSignIn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.Res_SIGN_IN)}},isRedPointByType:function(t){var e=this._signInfo[t];return!(!e||e.isTodaySigned())},hasRedPoint:function(){return!0},redPointTip:function(){for(var t in this._signInfo){if(!this._signInfo[t].isTodaySigned())return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.Res_SIGN_IN,td.EventNameEnum.Res_GET_DAILY_SIGN_INFO,td.EventNameEnum.ON_TIME_OVER_DAY]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",SignInModel:"SignInModel"}],SignInModel:[function(t,e,i){"use strict";cc._RF.push(e,"d2214qF5XNMs4OQxp1673zC","SignInModel");var n=t("Model"),a=cc.Class({extends:n,properties:{type:0,stage:0,days:0,lastSignInTime:0},isTodaySigned:function(){var t=td.TimeUtil.getTheZeroPoint(),e=td.TimeUtil.getStampByHours("23:59:59");return t<=this.lastSignInTime&&this.lastSignInTime<=e},getCurDay:function(){return this.isTodaySigned()?this.days:this.days+1},getStage:function(){return this.stage}});e.exports=a,cc._RF.pop()},{Model:"Model"}],SignInPanel:[function(t,e,i){"use strict";cc._RF.push(e,"e7375nwjxhLdbmR5ALqVzcK","SignInPanel");var n=t("ActivityBasePanel"),a=t("TabController"),r=cc.Class({extends:n,properties:{scrollView:cc.Node,itemTemplate:cc.Node,imgTitle:cc.Node,nodeCharge:cc.Node,labelCharge:cc.Label,imgTips:cc.Sprite,activeNode:cc.Node,_plist:"plist/Acitivty_14_mrqd",_controller:null,_isInit:null,_contentHeight:0,_lastRow:-1,_maxRow:null,_startPosX:-271,_startPosY:-75,_iteminterval:20,_itemSpace:6,_rowCt:5},initData:function(t){this._super(t)},onLoad:function(){this.itemTemplate.active=!1},onEnable:function(){if(this._super(),this._controller=this.getActivityController(),this._addEventListener(),this._isInit=!0,!this._tableController){this._tableController=new a;var t=this.node.getChildByName("btnTab");this.btnNormal=t.getChildByName("btnNormal"),this.btnBetter=t.getChildByName("btnBetter"),this.btnBest=t.getChildByName("btnBest"),this.btnNormal._tag=1,this.btnBetter._tag=2,this.btnBest._tag=3,this._tableController.init([this.btnNormal,this.btnBetter,this.btnBest],this,1)}this._showTab=0,this._tableController.showTab(1)},showTab:function(t){this._showTab!==t&&(this._showTab=t,this._refresh())},btnRecharge:function(){var t=this._controller.getSignChargeId(this._showTab);if(0!==t)if(td.Account.getUserData().getVipCard(td.VipCardType.MOUTH_VIP_CARD)){var e=td.RechargeManager.getRechargeDataById(t);td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,e)}else{var i=new td.BroadcastContent(403);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum;t.registerEvent(e.Res_GET_DAILY_SIGN_INFO,this._refresh,this),t.registerEvent(e.Res_SIGN_IN,this._refresh,this),t.registerEvent(e.ON_TIME_OVER_DAY,this._refresh,this)},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this)},_refresh:function(){this._maxRow=Math.ceil(30/this._rowCt),td.GlobalFunction.createAltasSprite(this._plist,"HD_qiandao0"+this._showTab,this.imgTitle);var t=this._controller.getSignChargeId(this._showTab);if(0===t)this.nodeCharge.active=!1;else{this.nodeCharge.active=!0;var e=this._controller.getSignInfoByType(this._showTab);this.activeNode.active=!e,2===this._showTab?td.GlobalFunction.createAltasSprite(this._plist,"HD_wz_gaoji",this.imgTips):3===this._showTab&&td.GlobalFunction.createAltasSprite(this._plist,"HD_wz_zhizun",this.imgTips);var i=td.RechargeManager.getRechargeDataById(t);this.labelCharge.string="\xa5 "+cc.js.formatStr(td.Language.rechargeCount,i.getShowValue())}for(var n=td.GetTableClass(td.TableEnum.SignInConfig).getDatas(this._showTab,this._controller.getStageByType(this._showTab)),a=0,r=n.length;a<r;a++)this._setItemWidget(a,n[a]);if(this.scrollView.height=this._maxRow*(this._itemHeight+this._itemSpace),this._isInit){var o=this.node.getChildByName("scrollView").getComponent(cc.ScrollView),s=Math.ceil(this._curDay/this._rowCt)/this._maxRow;s<.5&&(s=0),o.scrollToPercentVertical(1-s),this._isInit=!1}td.RedPointUtil.createRedPointSimple(this.btnNormal,{x:-10,y:-10},this._controller.isRedPointByType(1)),td.RedPointUtil.createRedPointSimple(this.btnBetter,{x:-10,y:-10},this._controller.isRedPointByType(2)),td.RedPointUtil.createRedPointSimple(this.btnBest,{x:-10,y:-10},this._controller.isRedPointByType(3))},_setItemWidget:function(t,e){var i=e.days,n=td.RewardManager.parseRewardListDetail(e.reward),a="item_"+i,r=this.scrollView.getChildByName(a);r||((r=cc.instantiate(this.itemTemplate)).setName(a),r.active=!0,this.scrollView.addChild(r)),this._itemHeight=r.height;var o=r.getChildByName("iconNode"),s=o.getChildByName("CommonIconWidget");if(s){var l=s.getComponent("CommonIconWidget");l.setType(37),l.setData(n[0])}else(s=td.GlobalFunction.createCommonIconWidget(37,n[0],!0)).setScale(.95),o.addChild(s);var c=Math.floor(t/this._rowCt),u=t%this._rowCt,d=this._startPosX+(r.width+this._itemSpace)*u,h=this._startPosY-(r.height+this._itemSpace)*c;r.x=d,r.y=h;var p=r.getComponent(cc.Button);p.clickEvents=[];var _=this._controller.getSignState(this._showTab,i);if(_===td.ActivityEnum.SignInState.Signing?p.clickEvents.push(td.GlobalFunction.createClickEventHandler(this,"SignInPanel","sign",e)):p.clickEvents.push(td.GlobalFunction.createClickEventHandler(this,"SignInPanel","_itemClicked",e)),this._curDay=this._controller.getCurDay(this._showTab),this._curDay===i&&_===td.ActivityEnum.SignInState.Signing)this._addSelectAni(s);else{var g=s.getChildByName("selectAni");g&&(g.active=!1)}this._handleDouble(r,e),this._handleState(r,e,_),r.getChildByName("lbl_day").getComponent(cc.Label).string=cc.js.formatStr(td.Language.perDay,i)},_addSelectAni:function(t){var e=t.getChildByName("selectAni");if(e){e.active=!0;var i=e.getComponent(cc.Animation);i.play(i.defaultClip.name)}else{var n=td.GlobalFunction.getResIdByNode(this.node);gdk.rm.loadRes(n,"uiAnima/QianDao_UI/QianDao_UI",cc.Prefab,this._playSelectAni.bind(this,t))}},_playSelectAni:function(t){if(cc.isValid(this.node)&&cc.isValid(t)&&!t.getChildByName("selectAni")){var e=gdk.rm.getResByUrl("uiAnima/QianDao_UI/QianDao_UI",cc.Prefab),i=cc.instantiate(e);i.name="selectAni",i.parent=t;var n=i.getComponent(cc.Animation);n.play(n.defaultClip.name)}},_handleDouble:function(t,e){var i=t.getChildByName("vipDouble"),n=e.doubleVip;n<0?i.active=!1:(i.active=!0,i.getChildByName("labVip").getComponent(cc.Label).string=cc.js.formatStr(td.Language.vipDouble,n))},_handleState:function(t,e,i){var n=t.getChildByName("sp_signed"),a=t.getChildByName("sp_shade");switch(n.active=!1,a.active=!1,i){case td.ActivityEnum.SignInState.Signed:n.active=!0,a.active=!0;break;case td.ActivityEnum.SignInState.Passed:a.active=!0}},sign:function(t,e){td.EventUtil.dispatchEvent(td.EventNameEnum.Req_SIGN_IN,this._showTab)},_itemClicked:function(t,e){if(td.GlobalFunction.checkCanClicked()){var i=td.RewardManager.parseRewardListDetail(e.reward);td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_RewardBoxPreview,i)}},_resign:function(){var t={month:this._resignData.getMonth(),day:this._resignData.getDay()};td.EventUtil.dispatchEvent(td.EventNameEnum.Req_SIGN_IN,t)},_imgActiveRewardClicked:function(t,e){if(e.getBoxState()===td.ActivityEnum.SignInBoxState.CAN_RECEIVE){var i={month:e.getMonth(),day:e.getDay()};td.EventUtil.dispatchEvent(td.EventNameEnum.Req_RECEIVE_TOTAL_SIGN_IN,i)}else td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_RewardBoxPreview,e.getReward())}});e.exports=r,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",TabController:void 0}],SingleRechargeController10:[function(t,e,i){"use strict";cc._RF.push(e,"0036cwYZKtACrLnon3WKcxN","SingleRechargeController10");var n=t("SingleRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{SingleRechargeController:"SingleRechargeController"}],SingleRechargeController2:[function(t,e,i){"use strict";cc._RF.push(e,"1f34bvWYMBJxLNsWMEzNtYv","SingleRechargeController2");var n=t("SingleRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{SingleRechargeController:"SingleRechargeController"}],SingleRechargeController3:[function(t,e,i){"use strict";cc._RF.push(e,"3f511G33iNPTLslGqQDbs+r","SingleRechargeController3");var n=t("SingleRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{SingleRechargeController:"SingleRechargeController"}],SingleRechargeController4:[function(t,e,i){"use strict";cc._RF.push(e,"12ba3cnMt1Hfb45Ev/LLTJV","SingleRechargeController4");var n=t("SingleRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{SingleRechargeController:"SingleRechargeController"}],SingleRechargeController5:[function(t,e,i){"use strict";cc._RF.push(e,"fb030ewRmBOJamzQn0TflnQ","SingleRechargeController5");var n=t("SingleRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{SingleRechargeController:"SingleRechargeController"}],SingleRechargeController6:[function(t,e,i){"use strict";cc._RF.push(e,"d04b613sdZKcqF4ql8i/fwH","SingleRechargeController6");var n=t("SingleRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{SingleRechargeController:"SingleRechargeController"}],SingleRechargeController7:[function(t,e,i){"use strict";cc._RF.push(e,"26ebfZrFjxK5aKBSbkhbYyl","SingleRechargeController7");var n=t("SingleRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{SingleRechargeController:"SingleRechargeController"}],SingleRechargeController8:[function(t,e,i){"use strict";cc._RF.push(e,"b0030wnnCFAI7l22v1ITC6G","SingleRechargeController8");var n=t("SingleRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{SingleRechargeController:"SingleRechargeController"}],SingleRechargeController9:[function(t,e,i){"use strict";cc._RF.push(e,"01270syTNRFVa8sotGJExnb","SingleRechargeController9");var n=t("SingleRechargeController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{SingleRechargeController:"SingleRechargeController"}],SingleRechargeController:[function(t,e,i){"use strict";cc._RF.push(e,"fa629DeA01BurZFmuNRWdR9","SingleRechargeController");var n=t("RechargeBaseController"),a=t("SingleRechargeModel"),r=cc.Class({extends:n,properties:{},initData:function(t){this._super(t)},destroyData:function(){this._super()},parseQueryInfo:function(t){if(t.moneyList&&t.moneyList.length>0)for(var e=0;e<t.moneyList.length;e++)this.onChargeAmount(t.moneyList[e]);if(t.rewardList&&t.rewardList.length>0)for(e=0;e<t.rewardList.length;e++)this.onIdReceived(t.rewardList[e]);this._datas=[];var i=t.day,n=this.getActivityData(),r=td.GetTableClass(td.TableEnum.SingleRechargeTable).getDatasByDataIdAndUpdateDay(n,i),o=this.getActivityId();for(e=0;e<r.length;e++){var s=new a;s.initData(r[e],o),this._datas.push(s)}},_onRechargeSuccess:function(t){},hasRedPoint:function(){return!0},redPointTip:function(){for(var t=this._datas,e=0;e<t.length;e++){if(t[e].getReceiveStatus()===td.ActivityEnum.OperateStatus.OperateAble)return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.Res_GET_ACTIVITY_INFO]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{RechargeBaseController:"RechargeBaseController",SingleRechargeModel:"SingleRechargeModel"}],SingleRechargeItem:[function(t,e,i){"use strict";cc._RF.push(e,"e8499UgJNFJBa1zJ12XNB3Z","SingleRechargeItem");var n=t("RechargeBaseItem"),a=cc.Class({extends:n,properties:{},updateItem:function(t,e){this._super(t,e);var i=e.getMoney();this.node.getChildByName("labTitle").getComponent(cc.Label).string=cc.js.formatStr(td.Language.singleRecharge,i);var n=this.node.getChildByName("labProgress");0==e.getLeftTimes()?n.active=!1:(n.active=!0,0!=e.getLeftTimes()?n.getComponent(cc.RichText).string=" <color=#ad6201>"+td.Language.leftTimes+"</c> <color=#01ae09>"+e.getLeftTimes()+"/"+e.getTotalTimes()+"</c>":n.getComponent(cc.RichText).string=" <color=#ad6201>"+td.Language.leftTimes+"</c> <color=#eb0303>"+e.getLeftTimes()+"</c> <color=#01ae09>/"+e.getTotalTimes()+"</c>"),this.setItemBtn(t,e)},setItemBtn:function(t,e){this._super(t,e);var i=this.node.getChildByName("btnOperation").getComponent(cc.Button);i.clickEvents=[];var n=new cc.Component.EventHandler;n.target=this.node,n.component="SingleRechargeItem",n.handler="onOperateItem",n.customEventData=e,i.clickEvents.push(n)}});e.exports=a,cc._RF.pop()},{RechargeBaseItem:"RechargeBaseItem"}],SingleRechargeModel:[function(t,e,i){"use strict";cc._RF.push(e,"91667mAQUFKjKXEdd3EjtbH","SingleRechargeModel");var n=t("RechargeBaseModel"),a=cc.Class({extends:n,properties:{_rechargeId:null},initData:function(t,e){this._super(t,e),this._rechargeId=t.chargeId},getReceiveStatus:function(){if(this.isReceived())return td.ActivityEnum.OperateStatus.Operated;var t=td.ActivityDataManager.getActivityControllerById(this._belongActivityId);if(!t)return td.ActivityEnum.OperateStatus.NotOperateAble;var e=this.getReceivedTimes();return t.getRechargeTimesByMoney(this.getMoney())>e?td.ActivityEnum.OperateStatus.OperateAble:td.ActivityEnum.OperateStatus.NotOperateAble},getChargeId:function(){return this._rechargeId}});e.exports=a,cc._RF.pop()},{RechargeBaseModel:"RechargeBaseModel"}],SingleRechargePanel:[function(t,e,i){"use strict";cc._RF.push(e,"55338ZBKFlDBbfnjOud4+pN","SingleRechargePanel");var n=t("RechargeBasePanel"),a=(t("OptimizeVerticalListView"),cc.Class({extends:n,properties:{},initData:function(t){this._super(t)},onLoad:function(){this._super();var t=this.node.getChildByName("scrollView");this._listView=t.getComponent("OptimizeVerticalListView")},onEnable:function(){this._super()},onDisable:function(){this._super()},doReceiveAction:function(t){var e=this,i={id:t.getId()},n=t.getOptionalRewards?t.getOptionalRewards():[];if(n.length>0){var a={};a.itemList=n,a.callFunc=function(t){i.parmeterMap={10:t},e.getActivityController().operateActivity(i)},td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_SelectRechargeReward,a)}else i.parmeterMap={10:0},this.getActivityController().operateActivity(i)},onReceiveOperation:function(t){this._super(t)}}));e.exports=a,cc._RF.pop()},{OptimizeVerticalListView:void 0,RechargeBasePanel:"RechargeBasePanel"}],SingleRechargeTable:[function(t,e,i){"use strict";cc._RF.push(e,"ec108hVsyZJH69zIDCFUH4Y","SingleRechargeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"SingleRechargeTable",properties:{_tblName:"single_recharge_config",_datas:null},init:function(){this._datas={};for(var t=0;t<this._jsonData.length;t++){var e=this._jsonData[t];this._datas[e.data]=this._datas[e.data]||[],this._datas[e.data][e.updateDay]=this._datas[e.data][e.updateDay]||[],this._datas[e.data][e.updateDay].push(e)}},getDatasByDataIdAndUpdateDay:function(t,e){if(!this._datas[t]||!this._datas[t][e])return console.log("no single recharge data"),console.log("data id is "+t),console.log("update day is "+e),[];var i=this._datas[t][e];return i.sort(function(t,e){return t.charge-e.charge}),i}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SkillAddEffect:[function(t,e,i){"use strict";cc._RF.push(e,"4323e+7KRdNpJzVx6Npw84A","SkillAddEffect");var n=t("BaseSkillEffect");td.AllAttr=cc.Class({extends:n,init:function(t){this._super("AllAttr",td.AttrType.Attack,td.EffectAddType.Prime,t)}}),td.AttackAddEffect=cc.Class({extends:n,init:function(t){this._super("AttackAddEffect",td.AttrType.Attack,td.EffectAddType.Prime,t)}}),td.HpAddEffect=cc.Class({extends:n,init:function(t){this._super("HpAddEffect",td.AttrType.HP,td.EffectAddType.Prime,t)}}),td.SpeedAddEffect=cc.Class({extends:n,init:function(t){this._super("SpeedAddEffect",td.AttrType.Speed,td.EffectAddType.Prime,t)}}),td.PhysicalArmorAddEffect=cc.Class({extends:n,init:function(t){this._super("PhysicalArmorAddEffect",td.AttrType.PhysicalArmor,td.EffectAddType.Prime,t)}}),td.PhysicalPenAddEffect=cc.Class({extends:n,init:function(t){this._super("PhysicalPenAddEffect",td.AttrType.PhysicalPen,td.EffectAddType.Percent,t)}}),td.SpellArmorAddEffect=cc.Class({extends:n,init:function(t){this._super("SpellArmorAddEffect",td.AttrType.SpellArmor,td.EffectAddType.Prime,t)}}),td.SpellPenAddEffect=cc.Class({extends:n,init:function(t){this._super("SpellPenAddEffect",td.AttrType.SpellPen,td.EffectAddType.Percent,t)}}),td.AccuracyAddEffect=cc.Class({extends:n,init:function(t){this._super("AccuracyAddEffect",td.AttrType.Accuracy,td.EffectAddType.Percent,t)}}),td.EvadeAddEffect=cc.Class({extends:n,init:function(t){this._super("EvadeAddEffect",td.AttrType.Evade,td.EffectAddType.Percent,t)}}),td.CritAddEffect=cc.Class({extends:n,init:function(t){this._super("CritAddEffect",td.AttrType.Crit,td.EffectAddType.Percent,t)}}),td.ToughnessAddEffect=cc.Class({extends:n,init:function(t){this._super("ToughnessAddEffect",td.AttrType.Toughness,td.EffectAddType.Percent,t)}}),td.VampireAddEffect=cc.Class({extends:n,init:function(t){this._super("VampireAddEffect",td.AttrType.Vampire,td.EffectAddType.Percent,t)}}),td.ReboundAddEffect=cc.Class({extends:n,init:function(t){this._super("ReboundAddEffect",td.AttrType.Rebound,td.EffectAddType.Percent,t)}}),td.RageAddEffect=cc.Class({init:function(t){this._super("RageAddEffect",td.AttrType.Rage,td.EffectAddType.Value,t)}}),td.RageRecoverEffect=cc.Class({init:function(t){this._super("rageRecover",td.AttrType.RAGE_RECOVER,td.EffectAddType.Value,t)}}),td.RestraintAddEffect=cc.Class({extends:n,init:function(t){this._super("RestraintAddEffect",td.AttrType.Restraint,td.EffectAddType.Percent,t)}}),td.DamageBonusAddEffect=cc.Class({extends:n,init:function(t){this._super("DamageBonusAddEffect",td.AttrType.DamageBonus,td.EffectAddType.Percent,t)}}),td.DamageReductionAddEffect=cc.Class({extends:n,init:function(t){this._super("DamageReductionAddEffect",td.AttrType.DamageReduction,td.EffectAddType.Percent,t)}}),td.CriticalDoubleAddEffect=cc.Class({extends:n,init:function(t){this._super("CriticalDoubleAddEffect",td.AttrType.CriticalDouble,td.EffectAddType.Percent,t)}}),td.DragonCritAddEffect=cc.Class({extends:n,init:function(t){this._super("DragonCritAddEffect",td.AttrType.DragonCrit,td.EffectAddType.Percent,t)}}),td.DragonDamageBonusAddEffect=cc.Class({extends:n,init:function(t){this._super("DragonDamageBonusAddEffect",td.AttrType.DragonDamageBonus,td.EffectAddType.Percent,t)}}),td.WaterRestraintAddEffect=cc.Class({extends:n,init:function(t){this._super("WaterRestraintAddEffect",td.AttrType.WaterRestraint,td.EffectAddType.Percent,t)}}),td.FireRestraintAddEffect=cc.Class({extends:n,init:function(t){this._super("FireRestraintAddEffect",td.AttrType.FireRestraint,td.EffectAddType.Percent,t)}}),td.WindRestraintAddEffect=cc.Class({extends:n,init:function(t){this._super("WindRestraintAddEffect",td.AttrType.WindRestraint,td.EffectAddType.Percent,t)}}),td.SoilRestraintAddEffect=cc.Class({extends:n,init:function(t){this._super("SoilRestraintAddEffect",td.AttrType.SoilRestraint,td.EffectAddType.Percent,t)}}),td.CustomAttackAddEffect=cc.Class({extends:n,init:function(t){this._super("CustomAttackAddEffect",td.AttrType.CustomAttack,td.EffectAddType.Percent,t)}}),td.CommonAttackAddEffect=cc.Class({extends:n,init:function(t){this._super("CommonAttackAddEffect",td.AttrType.CommonAttack,td.EffectAddType.Percent,t)}}),td.SkillAttackAddEffect=cc.Class({extends:n,init:function(t){this._super("SkillAttackAddEffect",td.AttrType.SkillAttack,td.EffectAddType.Percent,t)}}),td.PvpDamageBonusAddEffect=cc.Class({extends:n,init:function(t){this._super("PvpDamageBonusAddEffect",td.AttrType.PVPDAMAGE_BONUS,td.EffectAddType.Percent,t)}}),td.PvpDamageReductionAddEffect=cc.Class({extends:n,init:function(t){this._super("PvpDamageReductionAddEffect",td.AttrType.PVPDAMAGE_REDUCTION,td.EffectAddType.Percent,t)}}),td.PveDamageBonusAddEffect=cc.Class({extends:n,init:function(t){this._super("PveDamageBonusAddEffect",td.AttrType.PVEDAMAGE_BONUS,td.EffectAddType.Percent,t)}}),td.PveDamageReductionAddEffect=cc.Class({extends:n,init:function(t){this._super("PveDamageReductionAddEffect",td.AttrType.PVEDAMAGE_REDUCTION,td.EffectAddType.Percent,t)}}),td.TowerSkillRateAddEffect=cc.Class({extends:n,init:function(t){this._super("TowerSkillRateAddEffect",td.AttrType.TOWER_SKILL_RATE,td.EffectAddType.Percent,t)}}),cc._RF.pop()},{BaseSkillEffect:"BaseSkillEffect"}],SkillEffectManager:[function(t,e,i){"use strict";cc._RF.push(e,"638c01a2wtG6aaDRAtSNU+3","SkillEffectManager"),td.SkillEffectManager={getSkillEffect:function(t,e,i){var n=td.AttrStr[t];if(td.SkillEffectClass[n]){var a=new td[td.SkillEffectClass[n]];return a.init(e,i),a}cc.log("effectType is error!!!")}},cc._RF.pop()},{}],SkillEffectTable:[function(t,e,i){"use strict";cc._RF.push(e,"98b89GmJAxPH7VNsTY/eXp+","SkillEffectTable");var n=t("BaseTable"),a=cc.Class({extends:n,properties:{_tblName:"skill_effect_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];if(a.buffPrefabRes){a.buffPrefabRes="fightRes/pvp/BUFF/"+a.buffPrefabRes;var r=a.buffPrefabRes.split("/");a.buffPrefabName=r[r.length-1]}if(a.buffExpression&&a.buffExpression[0]==td.BuffExpressionType.Anim){a.buffAnimName=a.buffExpression[1],a.buffExpression[1]="fightRes/pvp/BUFF/"+a.buffAnimName;var o=a.buffAnimName;o=(o=o.split("/"))[o.length-1],a.buffAnimName=o}if(a.triggerAnima){a.triggerAnima="fightRes/pvp/BUFF/"+a.triggerAnima;var s=a.triggerAnima;s=(s=s.split("/"))[s.length-1],a.triggerAnimaName=s}if(a.buffExpressionBefore&&a.buffExpressionBefore[0]==td.BuffExpressionType.Anim){a.buffExpressionBefore[1]="fightRes/pvp/BUFF/"+a.buffExpressionBefore[1];var l=a.buffExpressionBefore[1];l=(l=l.split("/"))[l.length-1],a.buffAnimNameBefore=l,a.buffExpression||(a.buffAnimName=l)}t[a.effectId]=a}},getDataById:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SkillModel:[function(t,e,i){"use strict";cc._RF.push(e,"8c11cBMo+BOEa8KwU25cCPb","SkillModel");var n=t("Model");td.SkillModel=cc.Class({extends:n,properties:{_id:null,_name:null,_des:null,_iconRes:null,_releasePic:null},init:function(t){t&&(this._super("SkillModel"),this._id=t.skillId,this._name=t.name,this._des=t.des,this._iconRes=t.icon,this._showInSkillBag=t.showInSkillBag,this._releasePic=t.releasePic||"")},getId:function(){return this._id},getName:function(){return this._name},getDescription:function(){return this._des},getIconRes:function(){return this._iconRes},getIsShowInSkillBag:function(){return 1==this._showInSkillBag},getRelasePic:function(){return this._releasePic}}),cc._RF.pop()},{Model:"Model"}],SkillTable:[function(t,e,i){"use strict";cc._RF.push(e,"73714DH2ZVEfY+PmSK1Wkp3","SkillTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"SkillTable",properties:{_tblName:"skill_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.skillId]=a}},getSkillById:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SmeltManager:[function(t,e,i){"use strict";cc._RF.push(e,"b97c3Vmi4ZJmLdxP3Caf+pX","SmeltManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator,r=a.ccclass,o=(a.property,window.td),s=t("../../Equip/Manager/EquiptManager"),l=t("../../Hero/Manager/HeroManager"),c=t("../../HeroArtifact/Manager/HeroArtifactManager"),u=t("../../Spirit/Manager/SpiritManger"),d=t("../../Pet/Manager/PetManager"),h=t("../Manager/SmeltTypeEnum"),p=function(){function t(){this._selectEquipts=[],this._selectHeros=[],this._selectArtifacts=[],this._selectSpirits=[],this._selectPets=[],this._selectGems=[],this._selectRebirth=null,this._selectRebirthType=1,this._isSelectArtifact=!1,this._selectType=1,this._CampConverted=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener()},t.prototype.destroyData=function(){this._selectEquipts=[],this._selectHeros=[],this._selectArtifacts=[],this._selectSpirits=[],this._selectPets=[],this._selectGems=[],this._selectRebirth=null,this._selectRebirthType=1,this._isSelectArtifact=!1,this._selectType=1},t.prototype.addListener=function(){var t=o.MsgModuleName.LINEUP,e=o.MsgCmd.LINEUP;o.ServerDelegate.registerMessage(t,e.SMELT,this.parseSmelt.bind(this)),o.ServerDelegate.registerMessage(t,e.SMELT_PREVIEW,this.parseSmeltPreview.bind(this)),o.ServerDelegate.registerMessage(t,e.REBIRTH,this.parseRebirth.bind(this)),o.ServerDelegate.registerMessage(t,e.REBIRTH_PREVIEW,this.parseRebirthPreview.bind(this))},t.prototype.parseSmelt=function(t,e){if(t===o.NetCode.SUCCESS){var i=o.RewardManager.parseRewardResult(e.result),n=o.GetTableClass(o.TableEnum.GemstoneTable).getLuckIds(),a=[],r=[];if(this._selectType===h.SmeltType.Gem)for(var s=0;s<i.length;s++)n.indexOf(parseInt(i[s].id))>=0&&i[s].type===o.GoodsType.Type_Item?r.push(i[s]):a.push(i[s]);else a=i;r&&r.length>0?o.GlobalFunction.showRewards(r,!1,null,null,3):(o.GlobalFunction.showRewards(a),a=[]),this.clearAll(),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_SMELT,a)}},t.prototype.parseSmeltPreview=function(t,e){t===o.NetCode.SUCCESS&&e&&e.rewards&&o.EventUtil.dispatchEvent(o.EventNameEnum.RES_SMELT_PREVIEW,e.rewards)},t.prototype.parseRebirth=function(t,e){if(t===o.NetCode.SUCCESS){var i=o.RewardManager.parseRewardResult(e.result);if(this._selectType!=h.SmeltType.EQUIPMENT&&this._selectType!=h.SmeltType.SPIRIT){var n={};this._selectType===h.SmeltType.HERO?n.id=this._selectRebirth.getRoleType():n.id=this._selectRebirth.getId(),n.count=1,n.type=this.getItemType();for(var a=i.length,r=0;r<i.length;r++)if(i[r].id===n.id&&i[r].type===n.type){a=r;break}(this._selectType!==h.SmeltType.HERO||this._selectRebirth.isCampConverted())&&i.splice(a,0,n)}o.GlobalFunction.showRewards(i),this.clearAll(),o.EventUtil.dispatchEvent(o.EventNameEnum.RES_REBIRTH)}},t.prototype.parseRebirthPreview=function(t,e){if(t===o.NetCode.SUCCESS&&e&&e.rewards){if(this._selectType!=h.SmeltType.EQUIPMENT&&this._selectType!=h.SmeltType.SPIRIT){var i={};this._selectType===h.SmeltType.PET||this._selectType===h.SmeltType.HERO?i.id=this._selectRebirth.getRoleType():i.id=this._selectRebirth.getId(),i.count=1,i.type=this.getRewardType();for(var n=!1,a=0;a<e.rewards.length;a++)if(e.rewards[a].id===i.id&&e.rewards[a].type===i.type){e.rewards[a].count=(e.rewards[a].count?e.rewards[a].count:1)+1,n=!0;break}this._selectType!==h.SmeltType.HERO||this._selectRebirth.isCampConverted()||(n=!0),n||e.rewards.unshift(i)}o.EventUtil.dispatchEvent(o.EventNameEnum.RES_REBIRTH_PREVIEW,e.rewards)}},t.prototype.getItemType=function(){return this._selectType===h.SmeltType.HERO?o.GoodsType.Type_Mercenary:this._selectType===h.SmeltType.TREASURE?o.GoodsType.Type_Treasure:this._selectType===h.SmeltType.Gem?o.GoodsType.Type_Gemstone:this._selectType===h.SmeltType.HERO_ARTIFACT?o.GoodsType.Type_Artifact:this._selectType===h.SmeltType.PET?o.GoodsType.Type_Pet:void 0},t.prototype.getRewardType=function(){return this._selectType===h.SmeltType.HERO?o.RewardType.Mercenary:this._selectType===h.SmeltType.TREASURE?o.RewardType.Treasure:this._selectType===h.SmeltType.Gem?o.RewardType.Gemstone:this._selectType===h.SmeltType.HERO_ARTIFACT?o.RewardType.HeroArtifact:this._selectType===h.SmeltType.PET?o.RewardType.Pet:void 0},t.prototype.addEventListener=function(){var t=o.EventUtil,e=o.EventNameEnum,i={};i[e.EQUIP_SMELT_SELECT]=this.addSelectItems,i[e.EQUIP_SMELT_UNSELECT]=this.deleteSelectItemBySId,i[e.ONEKEY_SMELT_SELECT]=this.addSelectItemByIndex,i[e.ONEKEY_SMELT_UNSELECT]=this.deleteSelectItemByIndex,i[e.REQ_SMELT]=this.requestSmelt,i[e.REQ_SMELT_PREVIEW]=this.requestSmeltPreview,i[e.REQ_REBIRTH]=this.requestRebirth,i[e.REQ_REBIRTH_PREVIEW]=this.requestRebirthPreview,t.registerEvents(i,this)},t.prototype.requestSmelt=function(t){var e={};e.module=o.MsgModuleName.LINEUP,e.cmd=o.MsgCmd.LINEUP.SMELT,e.ids=t.ids,e.fragmentIds=t.fragmentIds,e.operateType=this.getOperateType(),o.ServerDelegate.sendMessage(e)},t.prototype.requestSmeltPreview=function(t){var e={};e.module=o.MsgModuleName.LINEUP,e.cmd=o.MsgCmd.LINEUP.SMELT_PREVIEW,e.ids=t.ids,e.fragmentIds=t.fragmentIds,e.operateType=this.getOperateType(),o.ServerDelegate.sendMessage(e)},t.prototype.requestRebirth=function(t){var e={};e.module=o.MsgModuleName.LINEUP,e.cmd=o.MsgCmd.LINEUP.REBIRTH,e.rebirthId=t,e.rebirthType=this.getSelectRebirthType(),o.ServerDelegate.sendMessage(e)},t.prototype.requestRebirthPreview=function(t){var e={};e.module=o.MsgModuleName.LINEUP,e.cmd=o.MsgCmd.LINEUP.REBIRTH_PREVIEW,e.rebirthId=t,e.rebirthType=this.getSelectRebirthType(),o.ServerDelegate.sendMessage(e)},t.prototype.isSelectItems=function(t){if(1==this._selectType){for(var e=0;e<this._selectHeros.length;e++)if(this._selectHeros[e].getSId()==t)return!0;return!1}if(2==this._selectType){for(e=0;e<this._selectEquipts.length;e++)if(this._selectEquipts[e].getSId()==t)return!0;return!1}if(4==this._selectType){for(e=0;e<this._selectGems.length;e++)if(this._selectGems[e].getSId()==t)return!0;return!1}if(5==this._selectType){for(e=0;e<this._selectArtifacts.length;e++)if(this._selectArtifacts[e].getSId()==t)return!0;return!1}if(6==this._selectType){for(e=0;e<this._selectSpirits.length;e++)if(this._selectSpirits[e].getSId()==t)return!0;return!1}if(7==this._selectType){for(e=0;e<this._selectPets.length;e++)if(this._selectPets[e].getSId()==t)return!0;return!1}},t.prototype.getOperateType=function(){return 1==this._selectType?h.SmeltType.HERO:2==this._selectType?h.SmeltType.EQUIPMENT:4==this._selectType?h.SmeltType.Gem:5==this._selectType?h.SmeltType.HERO_ARTIFACT:6==this._selectType?h.SmeltType.SPIRIT:7==this._selectType?h.SmeltType.PET:void 0},t.prototype.getSelectRebirth=function(){return this._selectRebirth},t.prototype.setSelectRebirth=function(t){this._selectRebirth=t},t.prototype.setIsSelectArtifact=function(t){this._isSelectArtifact=t},t.prototype.getSelectRebirthType=function(){return this._selectRebirthType},t.prototype.setSelectRebirthType=function(t){this._selectRebirthType=t},t.prototype.getSelectType=function(){return this._selectType},t.prototype.setSelectType=function(t){this._selectType=t},t.prototype.getSelectItems=function(){return 1==this._selectType?this._selectHeros:2==this._selectType?this._selectEquipts:4==this._selectType?this._selectGems:5==this._selectType?this._selectArtifacts:6==this._selectType?this._selectSpirits:7==this._selectType?this._selectPets:void 0},t.prototype.addSelectItems=function(t){1==this._selectType?this._selectHeros.push(t):2==this._selectType?this._selectEquipts.push(t):4==this._selectType?this._selectGems.push(t):5==this._selectType?this._selectArtifacts.push(t):6==this._selectType?this._selectSpirits.push(t):7==this._selectType&&this._selectPets.push(t),o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)},t.prototype.deleteSelectItemBySId=function(t){if(1==this._selectType){for(var e=0;e<this._selectHeros.length;e++)if(this._selectHeros[e].getSId()==t){this._selectHeros.splice(e,1),o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE);break}}else if(2==this._selectType){for(e=0;e<this._selectEquipts.length;e++)if(this._selectEquipts[e].getSId()==t){this._selectEquipts.splice(e,1),o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE);break}}else if(4==this._selectType){for(e=0;e<this._selectGems.length;e++)if(this._selectGems[e].getSId()==t){this._selectGems.splice(e,1),o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE);break}}else if(5==this._selectType){for(e=0;e<this._selectArtifacts.length;e++)if(this._selectArtifacts[e].getSId()==t){this._selectArtifacts.splice(e,1),o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE);break}}else if(6==this._selectType){for(e=0;e<this._selectSpirits.length;e++)if(this._selectSpirits[e].getSId()==t){this._selectSpirits.splice(e,1),o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE);break}}else if(7==this._selectType)for(e=0;e<this._selectPets.length;e++)if(this._selectPets[e].getSId()==t){this._selectPets.splice(e,1),o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE);break}},t.prototype.addSelectItemByIndex=function(t){var e=this,i=t.type,n=t.index;if(1==i){l.default.getInstance().getHeroByAptitude(n).forEach(function(t){e._selectHeros.push(t)});var a=o.ItemManager.getItemsDatasByGoodsSubType(o.GoodsSubType.HERO_FRAGMENT);for(var r in a){l.default.getInstance().getHeroByFragmentId(a[r].getId()).getAptitude()===n&&this._selectHeros.push(a[r])}o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)}else if(2==i){s.default.getInstance().getEquiptByQuality(n).forEach(function(t){e._selectEquipts.push(t)});a=o.ItemManager.getItemsDatasByGoodsSubType(o.GoodsSubType.EQUIPMENT_FRAMENT);for(var r in a)a[r].getQuality()===n&&this._selectEquipts.push(a[r]);o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)}else if(5==i){c.default.getInstance().getHeroArtifactByQuality(n+3).forEach(function(t){var i=!1,n=o.BattleArrayManager.getBattleArrayData();for(var a in n){if(l.default.getInstance().getHeroBySId(n[a].getMercenarySId()).getRoleType()===t.getHeroId()){i=!0;break}}e._isSelectArtifact&&i||e._selectArtifacts.push(t)}),o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)}else if(6==i){u.default.getInstance().getSpiritByQuality(n).forEach(function(t){e._selectEquipts.push(t)});a=o.ItemManager.getItemsDatasByGoodsSubType(o.GoodsSubType.SPIRIT_FRAGMENT);for(var r in a)a[r].getQuality()===n&&this._selectEquipts.push(a[r]);o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)}else if(7==i){d.default.getInstance().getPetByQuality(n).forEach(function(t){e._selectEquipts.push(t)});a=o.ItemManager.getItemsDatasByGoodsSubType(o.GoodsSubType.PET_FRAGMENT);for(var r in a)a[r].getQuality()===n&&this._selectEquipts.push(a[r]);o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)}},t.prototype.deleteSelectItemByIndex=function(t){var e=t.type,i=t.index;if(1==e){var n=[];this._selectHeros.forEach(function(t){var e;t.getAptitude?e=t.getAptitude():e=l.default.getInstance().getHeroByFragmentId(t.getId()).getAptitude();e!=i&&n.push(t)}),this._selectHeros=n,o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)}else if(2==e){var a=[];this._selectEquipts.forEach(function(t){t.getQuality()!=i&&a.push(t)}),this._selectEquipts=a,o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)}else if(5==e){var r=[];this._selectArtifacts.forEach(function(t){t.getQuality()!=i+3&&r.push(t)}),this._selectArtifacts=r,o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)}else if(7==e){var s=[];this._selectPets.forEach(function(t){t.getQuality()!=i+3&&s.push(t)}),this._selectPets=s,o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)}},t.prototype.clearAll=function(){this._selectRebirth=null,this._selectEquipts=[],this._selectHeros=[],this._selectArtifacts=[],this._selectGems=[],this._selectSpirits=[],this._selectPets=[],o.EventUtil.dispatchEvent(o.EventNameEnum.EQUIP_SMELT_SELECT_CHANGE)},t=e=n([r],t)}();i.default=p,cc._RF.pop()},{"../../Equip/Manager/EquiptManager":"EquiptManager","../../Hero/Manager/HeroManager":"HeroManager","../../HeroArtifact/Manager/HeroArtifactManager":"HeroArtifactManager","../../Pet/Manager/PetManager":"PetManager","../../Spirit/Manager/SpiritManger":"SpiritManger","../Manager/SmeltTypeEnum":"SmeltTypeEnum"}],SmeltTypeEnum:[function(t,e,i){"use strict";cc._RF.push(e,"841abVi5GJKVKrtdzHv4GaU","SmeltTypeEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.SmeltType=void 0,function(t){t[t.HERO=1]="HERO",t[t.EQUIPMENT=2]="EQUIPMENT",t[t.TREASURE=3]="TREASURE",t[t.Gem=4]="Gem",t[t.HERO_ARTIFACT=5]="HERO_ARTIFACT",t[t.SPIRIT=6]="SPIRIT",t[t.PET=7]="PET",t[t.NONE=0]="NONE"}(i.SmeltType||(i.SmeltType={})),cc._RF.pop()},{}],SoulLinkModel:[function(t,e,i){"use strict";cc._RF.push(e,"c7dffh5XbhKj7pwQLOxA/ES","SoulLinkModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){this._mainHeroId=0,this._orderId=0,this._linkList=[],this._battleHeroId=0}return t.prototype.init=function(t){},t.prototype.setMainHeroId=function(t){this._mainHeroId=t},t.prototype.getMainHeroId=function(){return this._mainHeroId},t.prototype.setOrderId=function(t){this._orderId=t},t.prototype.getOrderId=function(){return this._orderId},t.prototype.setLinkList=function(t){this._linkList=t},t.prototype.getLinkList=function(){return this._linkList},t.prototype.setBattleHeroId=function(t){this._battleHeroId=t},t.prototype.getBattleHeroId=function(){return this._battleHeroId},t.prototype.getSoulShowHeroId=function(t){if(void 0===t&&(t=!1),!this._linkList||this._linkList.length<=0)return 0;if(1==this._linkList.length){if(this._battleHeroId==this._mainHeroId)return this._linkList[0];if(this._battleHeroId==this._linkList[0])return this._mainHeroId}else if(2==this._linkList.length){if(this._battleHeroId==this._mainHeroId)return t?this._linkList[1]:this._linkList[0];if(this._battleHeroId==this._linkList[0])return t?this._mainHeroId:this._linkList[1];if(this._battleHeroId==this._linkList[1])return t?this._linkList[0]:this._mainHeroId}},t}();i.default=n,cc._RF.pop()},{}],SoulWareManager:[function(t,e,i){"use strict";cc._RF.push(e,"bbd98FrWphE9JO7tUpvNLNP","SoulWareManager");var n=t("SoulWareModel");td.SoulWareManager={_soulWare:null,init:function(){this._addEventListener(),this._addListener(),this.destroyData()},destroyData:function(){},_addListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.USER,i=td.MsgCmd.User;t.registerMessage(e,i.ACTIVATE_HORCRUX,this._onSoulWareLevelUpReturn.bind(this))},_addEventListener:function(){var t={};t[td.EventNameEnum.REQUEST_SOULWARE_LEVELUP]=this._requestSoulWareLevelUp,td.EventUtil.registerEvents(t,this)},_initSoulWare:function(){if(!(this._soulWare&&this._soulWare.myLen()>1)){var t=td.Account.getUserData().getSoulWare(),e=td.GetTableClass(td.TableEnum.SoulWare);this._soulWare={};var i=this._soulWare,a=e.getTables();for(var r in a){r=parseInt(r);var o=e.getDataByTypeAndLevel(r,a[r]),s=new n;s.init(o),i[s.getType()]=s}for(var r in t){var l=t[r];r=parseInt(r);o=e.getDataByTypeAndLevel(r,l);i[r].setTable(o)}}},getSoulWareAddValue:function(t){this._initSoulWare();var e=0,i=td.Account.getUserData();if(!i)return e;var n=i.getSoulWare(),a=this._soulWare;for(var r in n)for(var o=a[r].getAttr(),s=0,l=o.length;s<l;s++){var c=o[s],u=c[0],d=c[1];u===t&&(e+=d)}return e},getSoulWareAddPer:function(t){this._initSoulWare();var e=0,i=td.Account.getUserData();if(!i)return e;var n=i.getSoulWare(),a=this._soulWare;for(var r in n)for(var o=a[r].getAttrTTPercent(),s=0,l=o.length;s<l;s++){var c=o[s],u=c[0],d=c[1];u===t&&(e+=d)}return e},getSoulWareData:function(){return this._initSoulWare(),this._soulWare},_requestSoulWareLevelUp:function(t){var e=t,i={};i.module=td.MsgModuleName.USER,i.cmd=td.MsgCmd.User.ACTIVATE_HORCRUX,i.type=e,td.ServerDelegate.sendMessage(i)},_onSoulWareLevelUpReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.type,n=e.level,a=td.GetTableClass(td.TableEnum.SoulWare).getDataByTypeAndLevel(i,n);a&&this._soulWare[i]&&this._soulWare[i].setTable(a),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_SOULWARE_LEVELUP,i)}},isRedPointTips:function(){var t=!1;this._initSoulWare();var e=this._soulWare,i=td.UnlockManager,n=td.ActorUnlockType.SoulWareLock,a=td.GetTableClass(td.TableEnum.SoulWare).getLimitLevel();for(var r in e)if(i.isTargetUnlock(n,r)){var o=e[r];if(!(o.getLevel()>=a)){var s=o.getCost();if(s.getCount()<=td.ItemManager.getItemNumById(s.getId())){t=!0;break}}}return t},isRedPointTipsByType:function(t){var e=!1,i=td.UnlockManager,n=td.ActorUnlockType.SoulWareLock,a=td.GetTableClass(td.TableEnum.SoulWare).getLimitLevel();if(!i.isTargetUnlock(n,t))return e;this._initSoulWare();var r=this._soulWare[t];if(r.getLevel()>=a)return e;var o=r.getCost();return o.getCount()<=td.ItemManager.getItemNumById(o.getId())&&(e=!0),e},soulWareEvents:function(){return[td.EventNameEnum.REFRESH_SOULWARE_LEVELUP]}},cc._RF.pop()},{SoulWareModel:"SoulWareModel"}],SoulWareModel:[function(t,e,i){"use strict";cc._RF.push(e,"f5845ELuFdAIrVMfrqHGKfA","SoulWareModel");var n=t("Model"),a=cc.Class({extends:n,properties:{_type:null,_name:null,_iconRes:null,_desc:null,_level:null,_cost:null,_attr:null,_attrTTPercent:null},init:function(t){this._super("SoulWare"),this.setTable(t)},setTable:function(t){t&&(this._type=t.type,this._name=t.name,this._iconRes=t.iconRes,this._desc=t.desc,this._level=t.level,this._cost=td.RewardManager.getRewardDetail(t.cost[0]),this._attr=t.attr,this._attrTTPercent=t.attrTTPercent)},getType:function(){return this._type},getName:function(){return this._name},getLevel:function(){return this._level},getDesc:function(){return this._desc},getNextDesc:function(){var t=this._desc,e=td.GetTableClass(td.TableEnum.SoulWare).getDataByTypeAndLevel(this._type,this._level+1);return e&&(t=e.desc),t},getIconRes:function(){return this._iconRes},getCost:function(){return this._cost},getAttr:function(){return this._attr},getAttrTTPercent:function(){return this._attrTTPercent}});e.exports=a,cc._RF.pop()},{Model:"Model"}],SoulWareTable:[function(t,e,i){"use strict";cc._RF.push(e,"779d0Jk8vRBTpPrbmF9+nTi","SoulWareTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"SoulWareTable",properties:{_tblName:"horcrux_config",_data:null,_tables:null,_maxLevel:null},init:function(){var t=this._jsonData;this._data={};var e=this._data;this._tables={};var i=this._tables;this._maxLevel=0;for(var n=0,a=t.length-1;n<=a;n++){var r=t[n];r.iconRes="res/ui/HQ_icon/"+r.iconRes+".png";var o=r.type;e[o]||(e[o]={}),e[o][r.level]=r,i[o]||(i[o]=1),i[o]=Math.min(i[o],r.level),this._maxLevel=Math.max(this._maxLevel,r.level)}},getDataByTypeAndLevel:function(t,e){return this._data&&this._data[t]&&this._data[t][e]?this._data[t][e]:null},getTables:function(){return this._tables},getLimitLevel:function(){return this._maxLevel}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SoundTable:[function(t,e,i){"use strict";cc._RF.push(e,"9b3a4LCQLpMyrtQcaRcQjEm","SoundTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"SoundTable",properties:{_tblName:"sound_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];a.delay||(a.delay=0),t[a.id]=a}},getSoundById:function(t){return this._data[t]},getSoundResById:function(t){var e=this._data[t];return e?e.res:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SpecialAttributeEnum:[function(t,e,i){"use strict";cc._RF.push(e,"2f747SQnN5CTrzQnBx6xz1U","SpecialAttributeEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.SpecialEffectType=i.AttributeTargetType=void 0,function(t){t[t.COUNSELLOR=4]="COUNSELLOR",t[t.SHOOTER=1]="SHOOTER",t[t.MASTER=3]="MASTER",t[t.GUNNER=2]="GUNNER",t[t.SELF=5]="SELF",t[t.LINEUP=6]="LINEUP",t[t.ALL=7]="ALL",t[t.ANGEL=8]="ANGEL",t[t.DEVIL=9]="DEVIL",t[t.ELVES=10]="ELVES",t[t.NONE=0]="NONE"}(i.AttributeTargetType||(i.AttributeTargetType={})),function(t){t[t.ATTRIBUTE=1]="ATTRIBUTE",t[t.SKILL=2]="SKILL",t[t.Final=3]="Final",t[t.NONE=0]="NONE"}(i.SpecialEffectType||(i.SpecialEffectType={})),cc._RF.pop()},{}],SpecialAttributeTable:[function(t,e,i){"use strict";cc._RF.push(e,"5820fWcooBMA56zNHFGiaaZ","SpecialAttributeTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tblName="special_attribute_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SpecialEffectPoolConfig:[function(t,e,i){"use strict";cc._RF.push(e,"1bc0bWkLwBB8prsqt+1LK6Q","SpecialEffectPoolConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="SpecialEffectPoolConfig",e._tblName="special_effect_pool_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getData=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SpecialEffectPoolModel:[function(t,e,i){"use strict";cc._RF.push(e,"632c2rg2+1BDKq5cq3WiwAt","SpecialEffectPoolModel");window.td;var n=t("Model"),a=cc.Class({extends:n,properties:{_id:null,_effectIds:null},init:function(t){this._super("SpecialEffectPoolModel"),this._id=t.id,this._effectIds=t.effectIds},getId:function(){return this._id},getEffectIds:function(){return this._effectIds}});e.exports=a,cc._RF.pop()},{Model:"Model"}],SpecialEffectTable:[function(t,e,i){"use strict";cc._RF.push(e,"c41d5D/sxZIH7L0StaamwUY","SpecialEffectTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tblName="special_effect_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data[t]?this._data[t]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SpecialPackageConfig:[function(t,e,i){"use strict";cc._RF.push(e,"a9bd2jxkYFB/aZ1Ac/WX8vb","SpecialPackageConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="SpecialPackageConfig",e._tblName="special_package_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[i]||(t[i]={}),t[i]=a}},e.prototype.getPackageByIndex=function(t){if(!this._data)return null;var e=this._data[t];return e||cc.error("====> special_package_config \u6ca1\u6709id: ",t),e},e.prototype.getWeekChargeId=function(){var t=this.getPackageByIndex(3);return t&&t.chargeId},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SpecialPackageController:[function(t,e,i){"use strict";cc._RF.push(e,"083c7/pNcZLpK2EWhLvVgcb","SpecialPackageController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("./SpecialPackageEnum"),r=t("./SpecialPackageItemModel"),o=t("./SpecialPackageReqVO"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._days=0,e._state=0,e._isInit=!1,e._curRechargeData=null,e._weekChargeId=0,e._chargeArrs=[],e._modelList=[],e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this.addNetListener(),this.addEventListener(),this._isInit||(this.initDataModels(),this.requestSpecialPackageInfo(),this._isInit=!0)},e.prototype.addNetListener=function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.SPECIAL_PACKAGE_INFO,this.parseSpecialPackageInfo.bind(this)),i.registerMessage(t,e.SPECIAL_PACKAGE_RECEIVE,this.receiveReward.bind(this)),i.registerMessage(t,e.SPECIAL_PACKAGE_QUICKLY_RECEIVE,this.receiveReward.bind(this)),i.registerMessage(t,e.PUSH_SPECIAL_PACKAGE_INFO,this.parseSpecialPackageInfo.bind(this)),i.registerMessage(t,e.PUSH_SPECIAL_PACKAGE_REWARD_INFO,this.parseSpecialPackageRewardInfo.bind(this))},e.prototype.addEventListener=function(){var t={},e=td.EventNameEnum;t[e.SPECIAL_PACKAGE_INFO]=this.requestSpecialPackageInfo.bind(this),t[e.SPECIAL_PACKAGE_RECEIVE]=this.requestSpecialPackageReceived.bind(this),t[e.SPECIAL_PACKAGE_QUICK]=this.requestSpecialPackageQuick.bind(this),t[e.SPECAIL_PACKAGE_BUY_DAY]=this.requestBuyDay.bind(this),t[e.SPECAIL_PACKAGE_BUY_WEEK]=this.requestBuyWeek.bind(this),t[e.Recharge_Success]=this.onRechargeSucc.bind(this),td.EventUtil.registerEvents(t,this)},e.prototype.initDataModels=function(){var t=td.GetTableClass(td.TableEnum.SpecialPackageConfig);if(t){this._weekChargeId=t.getWeekChargeId();for(var e=0;e<3;e++){var i=this._modelList[e];i||(i=new r.default,this._modelList.push(i)),i.initData(t.getPackageByIndex(e)),this._chargeArrs.push(i.getCharge())}}},e.prototype.getWeekString=function(){var t=this._weekChargeId,e=td.GetTableClass(td.TableEnum.ChargeCommodityConfig).getDataByChargeId(t);if(e){var i=e.costValue/10;return cc.js.formatStr(td.Language.SpecialDes,i)}return""},e.prototype.getModelList=function(){return this._modelList},e.prototype.getChargeByIndex=function(t){if(this._chargeArrs)return this._chargeArrs[t]},e.prototype.onRechargeSucc=function(t){if(t&&this._curRechargeData&&this._curRechargeData.getChargeId()==t.getChargeId()){var e=this.getShowRewardList(t.getReward());td.GlobalFunction.showRewards(e),this.setRechargeData(null)}},e.prototype.getShowRewardList=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],a={};a.type=n[0],a.id=n[1],a.count=n[2],e[e.length]=a}return e=td.RewardManager.convertCfgType2GoodsType(e)},e.prototype.setRechargeData=function(t){this._curRechargeData=t},e.prototype.requestBuyDay=function(t){if(this._modelList[t]){var e=this._modelList[t].getChargeId(),i=td.RechargeManager.getRechargeDataById(e);i&&(this.setRechargeData(i),td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,i))}},e.prototype.requestBuyWeek=function(){var t=this._weekChargeId,e=td.RechargeManager.getRechargeDataById(t);e&&(this.setRechargeData(e),td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,e))},e.prototype.requestSpecialPackageInfo=function(){var t=new o.SpecialPackageGetInfoVO;td.ServerDelegate.sendMessage(t)},e.prototype.requestSpecialPackageReceived=function(t){var e=this.getChargeByIndex(t),i=new o.SpecialPackageReceiveVO(e);td.ServerDelegate.sendMessage(i)},e.prototype.requestSpecialPackageQuick=function(){var t=new o.SpecialPackageQuickReceiveVO;td.ServerDelegate.sendMessage(t)},e.prototype.parseSpecialPackageInfo=function(t,e){t===td.NetCode.SUCCESS&&(this._days=e.days,this._enableReceives=e.enableReceives,this._receives=e.receives,this.refreshState(),this.refreshModelState(),td.EventUtil.dispatchEvent(td.EventNameEnum.SPECIAL_PACKAGE_REFRESH))},e.prototype.parseSpecialPackageRewardInfo=function(t,e){if(t===td.NetCode.SUCCESS){var i=e.charge,n=this._chargeArrs.indexOf(i);if(-1!=n){var a=this._modelList[n].getRewards(),r=this.getShowRewardList(a);td.GlobalFunction.showRewards(r),td.EventUtil.dispatchEvent(td.EventNameEnum.SPECIAL_PACKAGE_REFRESH)}}},e.prototype.refreshState=function(){this._days>0?this._receives&&this._receives.length>=3?this._state=a.SPECIAL_PACKAGE_BUTTON.RECEIVED:this._state=a.SPECIAL_PACKAGE_BUTTON.GET:this._state=a.SPECIAL_PACKAGE_BUTTON.BUY},e.prototype.refreshModelState=function(){for(var t=0;t<this._modelList.length;t++){var e=0;e=this._days>0?1==this._days?-1==this._receives.indexOf(this.getChargeByIndex(t))?-1!=this._enableReceives.indexOf(this.getChargeByIndex(t))?a.SPECIAL_PACKAGE_BUTTON.GET:a.SPECIAL_PACKAGE_BUTTON.BUY:a.SPECIAL_PACKAGE_BUTTON.RECEIVED:-1==this._receives.indexOf(this.getChargeByIndex(t))?a.SPECIAL_PACKAGE_BUTTON.GET:a.SPECIAL_PACKAGE_BUTTON.RECEIVED:-1==this._receives.indexOf(this.getChargeByIndex(t))?a.SPECIAL_PACKAGE_BUTTON.BUY:a.SPECIAL_PACKAGE_BUTTON.RECEIVED,this._modelList[t].setState(e)}},e.prototype.receiveReward=function(t,e){if(t===td.NetCode.SUCCESS){var i=td.RewardManager.parseRewardResult(e.rewardResult,!0);td.GlobalFunction.showRewards(i)}},e.prototype.isWeekActive=function(){return this._days>0},e.prototype.getState=function(){return this._state},e.prototype.getDays=function(){return this._days},e.prototype.hasRedPoint=function(){return!0},e.prototype.redPointTip=function(){return this.isRedPointTip()},e.prototype.isRedPointTip=function(){return this._state==a.SPECIAL_PACKAGE_BUTTON.GET},e.prototype.redPointEvts=function(){return[td.EventNameEnum.SPECIAL_PACKAGE_REFRESH]},e}(t("ActivityBaseController"));i.default=s,e.exports=s,cc._RF.pop()},{"./SpecialPackageEnum":"SpecialPackageEnum","./SpecialPackageItemModel":"SpecialPackageItemModel","./SpecialPackageReqVO":"SpecialPackageReqVO",ActivityBaseController:"ActivityBaseController"}],SpecialPackageEnum:[function(t,e,i){"use strict";cc._RF.push(e,"51294/C0TVLJKoNgEwF8HsV","SpecialPackageEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.SPECIAL_PACKAGE_BUTTON=void 0,function(t){t[t.BUY=1]="BUY",t[t.GET=2]="GET",t[t.RECEIVED=3]="RECEIVED"}(i.SPECIAL_PACKAGE_BUTTON||(i.SPECIAL_PACKAGE_BUTTON={})),cc._RF.pop()},{}],SpecialPackageItemModel:[function(t,e,i){"use strict";cc._RF.push(e,"7674cTofrNP0I9jXYsb9EqP","SpecialPackageItemModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.initData=function(t){this._origin=t.originalPrice,this._charge=t.charge,this._rewards=t.rewards,this._chargeId=t.chargeId},t.prototype.getRewards=function(){return this._rewards},t.prototype.getRewardForIcon=function(){return td.RewardManager.parseRewardListDetail(this._rewards)},t.prototype.getOrigin=function(){return this._origin},t.prototype.getCharge=function(){return this._charge},t.prototype.getChargeId=function(){return this._chargeId},t.prototype.getState=function(){return this._state},t.prototype.setState=function(t){this._state=t},t}();i.default=n,cc._RF.pop()},{}],SpecialPackageItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"d5dd2ghgBZO3LFK3V3RdeOe","SpecialPackageItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./SpecialPackageItemView"),o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e._index=-1,e._data=null,e}return n(e,t),e.prototype.setData=function(t,e){this._data=e,this._index=t,this.view.setIndex(t),this.view.setTitle(),this.view.setOrigin(e.getOrigin()),this.view.setPrice(e.getCharge()),this.view.setState(e.getState()),this.view.setItems(e.getRewardForIcon())},e.prototype.onEnable=function(){this.addLocalListeners()},e.prototype.addLocalListeners=function(){this.view._onBtnBuyClickEvent.listen(this.onBtnBuy.bind(this)),this.view._onBtnGetClickEvent.listen(this.onBtnGet.bind(this))},e.prototype.onDisable=function(){this.view.deleteEventListeners()},e.prototype.onBtnBuy=function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SPECAIL_PACKAGE_BUY_DAY,this._index)},e.prototype.onBtnGet=function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SPECIAL_PACKAGE_RECEIVE,this._index)},e.prototype.getShowRewardList=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],a={};a.type=n[0],a.id=n[1],a.count=n[2],e[e.length]=a}return e=td.RewardManager.convertCfgType2GoodsType(e)},a([l(r.SpecialPackageItemView)],e.prototype,"view",void 0),e=a([s,c("module/Activity/SpecialPackageItemUI")],e)}(cc.Component);i.default=u,cc._RF.pop()},{"./SpecialPackageItemView":"SpecialPackageItemView"}],SpecialPackageItemView:[function(t,e,i){"use strict";cc._RF.push(e,"37be6RUUhBNJpWB4Y7bovGD","SpecialPackageItemView");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.SpecialPackageItemView=void 0;var r=t("../../../Common/EventTrigger"),o=t("./SpecialPackageEnum"),s=cc._decorator.property,l=cc._decorator.ccclass,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_origin=void 0,e.m_title=void 0,e.m_soldout=void 0,e.m_0=void 0,e.m_1=void 0,e.m_2=void 0,e.m_3=void 0,e.m_buy=void 0,e.m_price=void 0,e.m_get=void 0,e._index=-1,e._onBtnBuyClickEvent=new r.EventTrigger,e._onBtnGetClickEvent=new r.EventTrigger,e}return n(e,t),e.prototype.deleteEventListeners=function(){this._onBtnBuyClickEvent.unAlllisten(),this._onBtnGetClickEvent.unAlllisten()},e.prototype.setIndex=function(t){this._index=t},e.prototype.setState=function(t){this.m_buy.node.active=t==o.SPECIAL_PACKAGE_BUTTON.BUY,this.m_get.node.active=t==o.SPECIAL_PACKAGE_BUTTON.GET,td.RedPointUtil.createRedPointSimple(this.m_get.node,{x:-15,y:-15},t==o.SPECIAL_PACKAGE_BUTTON.GET),this.m_soldout.node.active=t==o.SPECIAL_PACKAGE_BUTTON.RECEIVED},e.prototype.setOrigin=function(t){var e=td.Language.SpecialPackage_Text1;this.m_origin.string=cc.js.formatStr(e,t)},e.prototype.setPrice=function(t){var e=td.Language.SpecialPackage_Text2;this.m_price.string=cc.js.formatStr(e,t)},e.prototype.setTitle=function(){this.m_title.node.x=[-38.396,-41,-38.396][this._index],td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_60_mrth,"HD_mrth_"+[1,3,6][this._index],this.m_title.node)},e.prototype.setItems=function(t){if(t&&4==t.length)for(var e=0;e<t.length;e++){var i=this["m_"+e],n=t[e],a=i.getChildByName("item");a||((a=td.GlobalFunction.createCommonIconWidget(26,n)).name="item",i.addChild(a)),a.getComponent("CommonIconWidget").setData(n),i.active=!0}},e.prototype.onBtnBuy=function(){this._onBtnBuyClickEvent.trigger()},e.prototype.onBtnGet=function(){this._onBtnGetClickEvent.trigger()},a([s(cc.Label)],e.prototype,"m_origin",void 0),a([s(cc.Sprite)],e.prototype,"m_title",void 0),a([s(cc.Sprite)],e.prototype,"m_soldout",void 0),a([s(cc.Node)],e.prototype,"m_0",void 0),a([s(cc.Node)],e.prototype,"m_1",void 0),a([s(cc.Node)],e.prototype,"m_2",void 0),a([s(cc.Node)],e.prototype,"m_3",void 0),a([s(cc.Button)],e.prototype,"m_buy",void 0),a([s(cc.Label)],e.prototype,"m_price",void 0),a([s(cc.Button)],e.prototype,"m_get",void 0),e=a([l],e)}(cc.Component);i.SpecialPackageItemView=c,cc._RF.pop()},{"../../../Common/EventTrigger":"EventTrigger","./SpecialPackageEnum":"SpecialPackageEnum"}],SpecialPackagePanel:[function(t,e,i){"use strict";cc._RF.push(e,"ced9fLKQ9lPN4CPZ2TThiwO","SpecialPackagePanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./SpecialPackageView"),o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.view=null,e}return n(e,t),e.prototype.onLoad=function(){this.view.initItem()},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addLocalListeners(),this.refreshView(),td.EventUtil.dispatchEvent(td.EventNameEnum.SPECIAL_PACKAGE_INFO)},e.prototype.onDisable=function(){td.EventUtil.unregisterAllEvents(this),this.view.deleteEventListeners(),t.prototype.onDisable.call(this)},e.prototype._addLocalListeners=function(){var t=td.EventUtil,e={};e[td.EventNameEnum.SPECIAL_PACKAGE_REFRESH]=this.refreshView,this.view._onBtnBuyClickEvent.listen(this.onBtnBuy.bind(this)),this.view._onBtnQuickClickEvent.listen(this.onBtnQucik.bind(this)),t.registerEvents(e,this)},e.prototype.refreshView=function(){for(var t=this._controller,e=this.view.getItemViewList(),i=this._controller.getModelList(),n=0;n<e.length;n++)e[n].setData(n,i[n]);this.view.setState(t.getState()),this.view.setCount(t.getDays(),7),this.view.setBuyString(t.getWeekString())},e.prototype.onBtnQucik=function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SPECIAL_PACKAGE_QUICK)},e.prototype.onBtnBuy=function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SPECAIL_PACKAGE_BUY_WEEK)},a([l(r.SpecialPackageView)],e.prototype,"view",void 0),e=a([s,c("module/Activity/SpecialPackagePanel")],e)}(t("ActivityBasePanel"));i.default=u,cc._RF.pop()},{"./SpecialPackageView":"SpecialPackageView",ActivityBasePanel:"ActivityBasePanel"}],SpecialPackageReqVO:[function(t,e,i){"use strict";cc._RF.push(e,"ac38altFPhEBJKC1IxsSdFL","SpecialPackageReqVO");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0}),i.SpecialPackageQuickReceiveVO=i.SpecialPackageReceiveVO=i.SpecialPackageGetInfoVO=i.SpecialPackageBaseVO=void 0;var a=function(){return function(){this.module=td.MsgModuleName.ExtensionCmd,this.cmd=0}}();i.SpecialPackageBaseVO=a;var r=function(t){function e(){var e=t.call(this)||this;return e.cmd=td.MsgCmd.ExtensionCmd.SPECIAL_PACKAGE_INFO,e}return n(e,t),e}(a);i.SpecialPackageGetInfoVO=r;var o=function(t){function e(e){var i=t.call(this)||this;return i.id=0,i.cmd=td.MsgCmd.ExtensionCmd.SPECIAL_PACKAGE_RECEIVE,i.id=e,i}return n(e,t),e}(a);i.SpecialPackageReceiveVO=o;var s=function(t){function e(){var e=t.call(this)||this;return e.cmd=td.MsgCmd.ExtensionCmd.SPECIAL_PACKAGE_QUICKLY_RECEIVE,e}return n(e,t),e}(a);i.SpecialPackageQuickReceiveVO=s,cc._RF.pop()},{}],SpecialPackageView:[function(t,e,i){"use strict";cc._RF.push(e,"a9711bKo1BJiLBKMGiD+5v3","SpecialPackageView");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.SpecialPackageView=void 0;var r=t("../../../Common/EventTrigger"),o=t("./SpecialPackageEnum"),s=cc._decorator.property,l=cc._decorator.ccclass,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_buy=void 0,e.m_buyLabel=void 0,e.m_get=void 0,e.m_rest=void 0,e.m_count=void 0,e.m_tip=void 0,e.m_content=void 0,e.item=null,e.itemViewList=[],e._onBtnBuyClickEvent=new r.EventTrigger,e._onBtnQuickClickEvent=new r.EventTrigger,e}return n(e,t),e.prototype.deleteEventListeners=function(){this._onBtnBuyClickEvent.unAlllisten(),this._onBtnQuickClickEvent.unAlllisten()},e.prototype.setState=function(t){this.m_buy.node.active=t==o.SPECIAL_PACKAGE_BUTTON.BUY,this.m_tip.node.active=t==o.SPECIAL_PACKAGE_BUTTON.BUY,this.m_get.node.active=t!=o.SPECIAL_PACKAGE_BUTTON.BUY,this.m_rest.node.active=t!=o.SPECIAL_PACKAGE_BUTTON.BUY,this.setGetState(t==o.SPECIAL_PACKAGE_BUTTON.RECEIVED)},e.prototype.setCount=function(t,e){this.m_count.string=t+"/"+e},e.prototype.setBuyString=function(t){this.m_buyLabel.string=t},e.prototype.setGetState=function(t){td.GlobalFunction.setButtonGray(this.m_get.node,t),t||(this.m_buyLabel.node.color=cc.color(197,44,53)),td.RedPointUtil.createRedPointSimple(this.m_get.node,{x:-15,y:-15},!t)},e.prototype.initItem=function(){this.itemViewList=[];for(var t=[-239,0,239],e=0;e<t.length;e++){var i=cc.instantiate(this.item);i.name=""+e,i.x=t[e],i.y=0,this.itemViewList.push(i.getComponent("SpecialPackageItemUI")),this.m_content.addChild(i),i.active=!0}},e.prototype.getItemViewList=function(){return this.itemViewList},e.prototype.onBtnBuy=function(){this._onBtnBuyClickEvent.trigger()},e.prototype.onBtnQuick=function(){this._onBtnQuickClickEvent.trigger()},e.prototype.mytest=function(t){this.setState(t)},a([s(cc.Button)],e.prototype,"m_buy",void 0),a([s(cc.Label)],e.prototype,"m_buyLabel",void 0),a([s(cc.Button)],e.prototype,"m_get",void 0),a([s(cc.Label)],e.prototype,"m_rest",void 0),a([s(cc.Label)],e.prototype,"m_count",void 0),a([s(cc.Label)],e.prototype,"m_tip",void 0),a([s(cc.Node)],e.prototype,"m_content",void 0),a([s(cc.Node)],e.prototype,"item",void 0),e=a([l],e)}(cc.Component);i.SpecialPackageView=c,cc._RF.pop()},{"../../../Common/EventTrigger":"EventTrigger","./SpecialPackageEnum":"SpecialPackageEnum"}],SpiritFragmentModel:[function(t,e,i){"use strict";cc._RF.push(e,"4055637vchKsZfuBjmvE+vg","SpiritFragmentModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._needCount=0,e._enough=!1,e._spiritId=0,e}return n(e,t),e.prototype.init=function(t){this._itemData=t;var e=td.GetTableClass(td.TableEnum.SpiritTable).getSpiritByFragmentId(this._itemData.getId());e&&(this._needCount=e.fragmentCount,this._spiritId=e.spiritId,this._enough=this._itemData.getCount()>=this._needCount)},e.prototype.getItemData=function(){return this._itemData},e.prototype.getNeedCount=function(){return this._needCount||999},e.prototype.getEnoughState=function(){return this._enough},e.prototype.getSpiritId=function(){return this._spiritId},e}(t("Model"));e.exports=a,cc._RF.pop()},{Model:"Model"}],SpiritManger:[function(t,e,i){"use strict";cc._RF.push(e,"6d532M4K9ZLw62nAd7U1tgL","SpiritManger");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=cc._decorator.ccclass,o=t("SpiritModel"),s=function(){function t(){}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._spiritList={}},t.prototype.addListener=function(){var t=a.MsgModuleName.SPIRIT,e=a.MsgCmd.SPIRIT;a.ServerDelegate.registerMessage(t,e.GET_SPIRIT,this.parseSpiritInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.SPIRIT_REINFORCE,this.parseReinforce.bind(this)),a.ServerDelegate.registerMessage(t,e.SPIRIT_STAR_UP,this.parseStarup.bind(this)),a.ServerDelegate.registerMessage(t,e.SPIRIT_SYNTHESIZE,this.parseSynthesize.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_SPIRIT_LIST,this.parseSpiritInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.SPIRIT_TALENT_UNDERSTAND,this.parseUnderstand.bind(this)),a.ServerDelegate.registerMessage(t,e.SPIRIT_TALENT_LOCK,this.parseLock.bind(this)),a.ServerDelegate.registerMessage(t,e.SPIRIT_TALENT_RESET,this.parseReset.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_SPIRIT_DELETE_LIST,this.delSpiritInfo.bind(this))},t.prototype.parseSpiritInfo=function(t,e){if(t===a.NetCode.SUCCESS){for(var i=e.spiritList,n=0;n<i.length;n++){var r=i[n].spiritId;if(this._spiritList[r])this._spiritList[r].setData(i[n]);else{var s=new o,l=a.GetTableClass(a.TableEnum.SpiritTable).getSpiritById(i[n].configId);s.init(l),s.setData(i[n]),this._spiritList[r]=s}}a.EventUtil.dispatchEvent(a.EventNameEnum.RES_GET_SPIRIT)}},t.prototype.parseReinforce=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_SPIRIT_REINFORCE)},t.prototype.parseStarup=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_SPIRIT_STAR_UP)},t.prototype.parseSynthesize=function(t,e){if(t===a.NetCode.SUCCESS){if(e&&e.rewardResult){var i=a.RewardManager.parseRewardResult(e.rewardResult);a.GlobalFunction.showRewards(i)}a.EventUtil.dispatchEvent(a.EventNameEnum.RES_SPIRIT_SYNTHESIZE)}},t.prototype.delSpiritInfo=function(t,e){if(t===a.NetCode.SUCCESS){var i=e.spiritIds;if(i&&i.length>0)for(var n=0;n<i.length;n++)this._spiritList[i[n]]&&delete this._spiritList[i[n]];a.EventUtil.dispatchEvent(a.EventNameEnum.RES_GET_SPIRIT)}},t.prototype.parseUnderstand=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_SPIRIT_TALENT_UNDERSTAND)},t.prototype.parseLock=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_SPIRIT_TALENT_LOCK)},t.prototype.parseReset=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_SPIRIT_TALENT_RESET)},t.prototype.addEventListener=function(){var t=a.EventUtil,e=a.EventNameEnum,i={};i[e.REQ_GET_SPIRIT]=this.reqSpiritInfo,i[e.REQ_SPIRIT_REINFORCE]=this.reqReinforce,i[e.REQ_SPIRIT_STAR_UP]=this.reqStarup,i[e.REQ_SPIRIT_SYNTHESIZE]=this.reqSynthesize,i[e.REQ_SPIRIT_TALENT_UNDERSTAND]=this.reqUnderstand,i[e.REQ_SPIRIT_TALENT_LOCK]=this.reqLock,i[e.REQ_SPIRIT_TALENT_RESET]=this.reqReset,i[e.REQ_LEARN_TALENT]=this.reqLearnTalent,t.registerEvents(i,this)},t.prototype.reqSpiritInfo=function(){if(!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.SPIRIT))return!1;var t={};t.module=a.MsgModuleName.SPIRIT,t.cmd=a.MsgCmd.SPIRIT.GET_SPIRIT,a.ServerDelegate.sendMessage(t)},t.prototype.reqReinforce=function(t){var e={};e.module=a.MsgModuleName.SPIRIT,e.cmd=a.MsgCmd.SPIRIT.SPIRIT_REINFORCE,e.times=t,this._times=t,a.ServerDelegate.sendMessage(e)},t.prototype.reqStarup=function(t){var e={};e.module=a.MsgModuleName.SPIRIT,e.cmd=a.MsgCmd.SPIRIT.SPIRIT_STAR_UP,e.spiritId=t,a.ServerDelegate.sendMessage(e)},t.prototype.reqSynthesize=function(t){var e={};e.module=a.MsgModuleName.SPIRIT,e.cmd=a.MsgCmd.SPIRIT.SPIRIT_SYNTHESIZE,e.configId=t,a.ServerDelegate.sendMessage(e)},t.prototype.reqUnderstand=function(t){var e={};e.module=a.MsgModuleName.SPIRIT,e.cmd=a.MsgCmd.SPIRIT.SPIRIT_TALENT_UNDERSTAND,e.spiritId=t,a.ServerDelegate.sendMessage(e)},t.prototype.reqLock=function(t){var e={};e.module=a.MsgModuleName.SPIRIT,e.cmd=a.MsgCmd.SPIRIT.SPIRIT_TALENT_LOCK,e.spiritId=t.spiritId,e.talentId=t.talentId,a.ServerDelegate.sendMessage(e)},t.prototype.reqReset=function(t){var e={};e.module=a.MsgModuleName.SPIRIT,e.cmd=a.MsgCmd.SPIRIT.SPIRIT_TALENT_RESET,e.spiritId=t;var i=this.getSpiritById(t);i&&i.resetTalentMap(),a.ServerDelegate.sendMessage(e)},t.prototype.getSpiritById=function(t){return this._spiritList[t]},t.prototype.getSpiritList=function(){return this._spiritList},t.prototype.getTimes=function(){for(var t in this._times)return this._times[t]},t.prototype.getSpiritNumByCfgId=function(t){var e=0;for(var i in this._spiritList)this._spiritList[i].getId()===t&&e++;return e},t.prototype.getSpiritListForRebirth=function(){var t=[];for(var e in this._spiritList)this._spiritList[e].isEquipped()||1===this._spiritList[e].getLevel()&&0===this._spiritList[e].getStarLevel()||t.push(this._spiritList[e]);return t},t.prototype.getSpiritArray=function(t,e,i){void 0===t&&(t=!1),void 0===e&&(e=!1),void 0===i&&(i=null);var n=[];for(var a in this._spiritList)t&&this._spiritList[a].isEquipped()||e&&(this._spiritList[a].getLevel()>1||this._spiritList[a].getStarLevel>0)||i&&this._spiritList[a].getSId()===i||n.push(this._spiritList[a]);return n.sort(this.sortFunc)},t.prototype.getSpiritByQuality=function(t){var e=[];for(var i in this._spiritList)this._spiritList[i].isEquipped()||1===this._spiritList[i].getLevel()&&0===this._spiritList[i].getStarLevel||this._spiritList[i].getQuality()===t&&e.push(this._spiritList[i]);return e},t.prototype.sortFunc=function(t,e){return t.getOrderId()!=e.getOrderId()?t.getOrderId()-e.getOrderId():t.getQuality()!=e.getQuality()?e.getQuality()-t.getQuality():t.getStarLevel()!=e.getStarLevel()?e.getStarLevel()-t.getStarLevel():e.getReinforceLevel()-t.getReinforceLevel()},t.prototype.canLevelUp=function(t){if(!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.SPIRIT))return!1;var e=this.getSpiritById(t);if(e.getMaxReinforceLevel()===e.getReinforceLevel())return!1;var i=a.Account.getUserData().getLevel();if(e.getReinforceLevel()>=i)return!1;for(var n=e.getReinforceCost(),r=0;r<n.length;r++){if(a.ItemManager.getItemNumById(n[r][1])<n[r][2])return!1}return!0},t.prototype.canStarUp=function(t){if(!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.SPIRIT_STAR_UP))return!1;var e=this.getSpiritById(t);if(e.getStarLevel()===e.getMaxStarLevel())return!1;for(var i=e.getStarCost(),n=0;n<i.length;n++){if(a.ItemManager.getItemNumById(i[n][1])<i[n][2])return!1}return!0},t.prototype.canChange=function(t){if(!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.SPIRIT))return!1;var e=this.getSpiritArray(!0);if(0===e.length)return!1;for(var i=this.getSpiritById(t),n=i.getReinforceLevel(),r=i.getStarLevel(),o=i.getQuality(),s=i.getId(),l=0;l<e.length;l++){if(e[l].getQuality()>o)return!0;if(e[l].getQuality()===o&&(e[l].getStarLevel()>r||e[l].getStarLevel()===r&&(e[l].getReinforceLevel()>n||e[l].getReinforceLevel()===n&&e[l].getId()>s)))return!0}return!1},t.prototype.canTalent=function(t){var e=this.getSpiritById(t),i=e.getTalentDot(),n=e.getTalentCount(),a=e.getTalentMap(),r=!0;if(a.length===n)for(var o=e.getTalentMaxLevel()+e.getTalentUpLevel(),s=0;s<a.length;s++)a[s].getTalentLevel()<o&&(r=!1);else r=!1;if(!r)return i>0},t.prototype.canUp=function(t){return!!this.canLevelUp(t)||(!!this.canStarUp(t)||(!!this.canChange(t)||!!this.canTalent(t)))},t.prototype.hasFragmentToCompose=function(){var t=a.ItemManager.getItemsDatasByGoodsSubType(a.GoodsSubType.SPIRIT_FRAGMENT);for(var e in t){var i=t[e].getId(),n=a.ItemManager.getItemNumById(i),r=a.GetTableClass(a.TableEnum.SpiritTable).getSpiritByFragmentId(i);if(r&&n>=r.fragmentCount)return!0}return!1},t.prototype.composeRedPointEvents=function(){return[a.EventNameEnum.ITEM_CHANGE]},t.prototype.reqLearnTalent=function(t){var e={};e.module=a.MsgModuleName.SPIRIT,e.cmd=a.MsgCmd.SPIRIT.SPIRIT_TALENT_DRILL,e.goodsId=t.goodsId,e.num=t.num,e.ext=t.ext,a.ServerDelegate.sendMessage(e)},t=e=n([r],t)}();i.default=s,cc._RF.pop()},{SpiritModel:"SpiritModel"}],SpiritManualTable:[function(t,e,i){"use strict";cc._RF.push(e,"b7622LU5olNrbA2u6OCr/Hq","SpiritManualTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="SpiritManualConfig",e._tblName="spirit_manual_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getAllData=function(){return this._data},e.prototype.getDataBySpiritId=function(t){for(var e in this._data)for(var i=this._data[e].spirits,n=0;n<i.length;n++)if(i[n]===t)return this._data[e];return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SpiritModel:[function(t,e,i){"use strict";cc._RF.push(e,"2480bh9wfBJCKYL0jyE4714","SpiritModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=window.td,r=t("TalentModel"),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(e){t.prototype.init.call(this,"SpiritModel",a.UserPropertyEnum.MIND_VOWEL,e.spiritId,e.name,e.icon,null,e.animationType),this._spiritId=e.spiritId,this._name=e.name,this._quality=e.quality,this._fragmentId=e.fragmentId,this._fragmentCount=e.fragmentCount,this._headImg=e.headImg,this._baseEffect=e.baseEffect,this._reinforceEffect=e.reinforceEffect,this._isStar=e.isStar,this._obtainWay=e.obtainWay,this._des=e.des,this._icon=e.icon,this._talentCount=e.talentCount,this._talentMaxLevel=e.talentMaxLevel,this._initTalentDot=e.initTalentDot,this._reinforceLevel=1,this._starLevel=0,this._talentDot=0,this._talentList=[],this._isEquipped=!1,this._orderId=999},e.prototype.setData=function(t){if(this._sId=t.spiritId,(t.reinforceLevel||0==t.reinforceLevel)&&(this._reinforceLevel=t.reinforceLevel),(t.starLevel||0==t.starLevel)&&(this._starLevel=t.starLevel),(t.talentDot||0==t.talentDot)&&(this._talentDot=t.talentDot),t.talentList)for(var e=0;e<t.talentList.length;e++){for(var i=t.talentList[e],n=i.talentId,o=void 0,s=0;s<this._talentList.length;s++)this._talentList[s].getTalentId()===n&&(o=this._talentList[s]);if(!o){var l=a.GetTableClass(a.TableEnum.SpiritTalentTable).getTalentById(n);(o=new r).init(l),this._talentList.splice(e,0,o)}o.setData(i,this.getTalentUpLevel())}},e.prototype.resetTalentMap=function(){this._talentList=[]},e.prototype.deletTalent=function(t){for(var e=0;e<this._talentList.length;e++)if(this._talentList[e].getTalentId()===t){this._talentList.splice(e,1);break}a.EventUtil.dispatchEvent(a.EventNameEnum.DELETE_SPIRIT_TALENT,t)},e.prototype.getGoodsType=function(){return a.GoodsType.Type_Spirit},e.prototype.getPropertyType=function(){return a.UserPropertyEnum.SPIRIT},e.prototype.getId=function(){return this._spiritId},e.prototype.getName=function(){return this._name},e.prototype.getQuality=function(){return this._quality},e.prototype.getFragmentId=function(){return this._fragmentId},e.prototype.getFragmentCount=function(){return this._fragmentCount},e.prototype.getHeadImg=function(){return this._headImg},e.prototype.getIconRes=function(){return this._icon},e.prototype.getBaseEffect=function(){return this._baseEffect},e.prototype.getReinforceEffect=function(){return this._reinforceEffect},e.prototype.getIsStar=function(){return this._isStar},e.prototype.getObtainWay=function(){return this._obtainWay},e.prototype.getDes=function(){return this._des},e.prototype.getTalentCount=function(){return this._talentCount},e.prototype.getTalentMaxLevel=function(){return this._talentMaxLevel},e.prototype.getInitTalentDot=function(){return this._initTalentDot},e.prototype.getTalentDot=function(){return this._talentDot},e.prototype.getTalentMap=function(){return this._talentList},e.prototype.getSId=function(){return this._sId},e.prototype.getLevel=function(){return this._reinforceLevel},e.prototype.getReinforceLevel=function(){return this._reinforceLevel},e.prototype.getMaxReinforceLevel=function(){return a.GetTableClass(a.TableEnum.SpiritReinforceTable).getMaxLvByQuality(this._quality)},e.prototype.getReinforceCost=function(){var t=a.GetTableClass(a.TableEnum.SpiritReinforceTable).getDataByQualityAndLv(this._quality,this._reinforceLevel);return t?t.costs:null},e.prototype.getReinforceCostByLv=function(t){var e=a.GetTableClass(a.TableEnum.SpiritReinforceTable).getDataByQualityAndLv(this._quality,t);return e?e.costs:null},e.prototype.getSpecialEffectId=function(){return a.GetTableClass(a.TableEnum.SpiritReinforceTable).getSpecialEffectId(this._quality,this._reinforceLevel)},e.prototype.getNextSpecialEffectId=function(){return a.GetTableClass(a.TableEnum.SpiritReinforceTable).getNextSpecialEffectId(this._quality,this._reinforceLevel)},e.prototype.getStar=function(){return this._starLevel},e.prototype.getStarLevel=function(){return this._starLevel},e.prototype.getMaxStarLevel=function(){return a.GetTableClass(a.TableEnum.SpiritStarTable).getMaxLvById(this._spiritId)},e.prototype.getStarCost=function(){var t=a.GetTableClass(a.TableEnum.SpiritStarTable).getDataByIdAndlv(this._spiritId,this._starLevel+1);return t?t.cost:null},e.prototype.isEquipped=function(){return this._isEquipped},e.prototype.setEquipped=function(t){this._isEquipped=t},e.prototype.getOrderId=function(){return this._orderId},e.prototype.setBattleArrayEntityOrderId=function(t){this._orderId=t},e.prototype.getCount=function(){return this._count},e.prototype.setCount=function(t){this._count=t},e.prototype.getRatio=function(){var t=a.GetTableClass(a.TableEnum.SpiritStarTable).getDataByIdAndlv(this._spiritId,this._starLevel);return t?t.attributeRatioShow/100:0},e.prototype.getPreTalentUpLevel=function(){var t=a.GetTableClass(a.TableEnum.SpiritStarTable).getDataByIdAndlv(this._spiritId,this._starLevel-1);return t?t.talentUpLevel:0},e.prototype.getTalentUpLevel=function(){var t=a.GetTableClass(a.TableEnum.SpiritStarTable).getDataByIdAndlv(this._spiritId,this._starLevel);return t?t.talentUpLevel:0},e.prototype.getNextTalentUpLevel=function(){var t=a.GetTableClass(a.TableEnum.SpiritStarTable).getDataByIdAndlv(this._spiritId,this._starLevel+1);return t?t.talentUpLevel:0},e.prototype.getPreRatio=function(){var t=a.GetTableClass(a.TableEnum.SpiritStarTable).getDataByIdAndlv(this._spiritId,this._starLevel-1);return t?t.attributeRatioShow/100:0},e.prototype.getNextRatio=function(){var t=a.GetTableClass(a.TableEnum.SpiritStarTable).getDataByIdAndlv(this._spiritId,this._starLevel+1);return t?t.attributeRatioShow/100:0},e.prototype.getRatioShow=function(){return"+"+this.getRatio()+"%"},e.prototype.getLockNum=function(){var t=0;return this._talentList.forEach(function(e){e.getIsLock()&&t++}),t},e.prototype.getLockMax=function(){for(var t=a.GetConfig("SPIRIT_TALENT_LOCK_COUNT"),e=0;e<t.length;e++)if(t[e][0]===this._quality)return t[e][1];return 0},e.prototype.getLvAttr=function(){var t=this,e={};this._baseEffect.forEach(function(t){e[t[0]]||(e[t[0]]=0),e[t[0]]+=t[1]}),this._reinforceEffect.forEach(function(i){e[i[0]]||(e[i[0]]=0),e[i[0]]+=i[1]*(t._reinforceLevel-1)});var i=this.getRatio();for(var n in e)e[n]=Math.floor(e[n]*(1+i/100));return e},e.prototype.getTotalTalentAttr=function(){var t={};return this._talentList.forEach(function(e){var i=e.getTotalAttr();for(var n in i)t[n]||(t[n]=0),t[n]+=i[n]}),t},e.prototype.getTotalTalentSkillAttr=function(){var t=this,e={};return a.GetTableClass(a.TableEnum.SpiritReinforceTable).getEffectsByQuality(this._quality).forEach(function(i){if(t._reinforceLevel>=i.level){var n=a.GetTableClass(a.TableEnum.SpecialEffectTable).getDataById(i.specialEffectId).effectId;a.GetTableClass(a.TableEnum.SpecialAttributeTable).getDataById(n).attributes.forEach(function(t){e[t[0]]||(e[t[0]]=0),e[t[0]]+=t[1]})}}),e},e.prototype.getTotalAttr=function(){var t={},e=this.getLvAttr(),i=this.getTotalTalentAttr(),n=this.getTotalTalentSkillAttr();for(var a in e)t[a]||(t[a]=0),t[a]+=e[a];for(var a in i)t[a]||(t[a]=0),t[a]+=i[a];for(var a in n)t[a]||(t[a]=0),t[a]+=n[a];return t},e.prototype.getAttrList=function(){var t=this.getLvAttr(),e=[];for(var i in t)e.push([parseInt(i),t[i]]);return e},e.prototype.getPreStarTotalAttr=function(){var t=this,e={};this._baseEffect.forEach(function(t){e[t[0]]||(e[t[0]]=0),e[t[0]]+=t[1]}),this._reinforceEffect.forEach(function(i){e[i[0]]||(e[i[0]]=0),e[i[0]]+=i[1]*(t._reinforceLevel-1)});var i=this.getPreRatio();for(var n in e)e[n]=Math.floor(e[n]*(1+i/100));return e},e.prototype.getNextStarTotalAttr=function(){var t=this,e={};this._baseEffect.forEach(function(t){e[t[0]]||(e[t[0]]=0),e[t[0]]+=t[1]}),this._reinforceEffect.forEach(function(i){e[i[0]]||(e[i[0]]=0),e[i[0]]+=i[1]*(t._reinforceLevel-1)});var i=this.getNextRatio();for(var n in e)e[n]=Math.floor(e[n]*(1+i/100));return e},e.prototype.getNextLvTotalAttr=function(){var t=this,e={};this._baseEffect.forEach(function(t){e[t[0]]||(e[t[0]]=0),e[t[0]]+=t[1]}),this._reinforceEffect.forEach(function(i){e[i[0]]||(e[i[0]]=0),e[i[0]]+=i[1]*t._reinforceLevel});var i=this.getRatio();for(var n in e)e[n]=Math.floor(e[n]*(1+i/100));return e},e}(t("PropertyModel"));e.exports=o,cc._RF.pop()},{PropertyModel:"PropertyModel",TalentModel:"TalentModel"}],SpiritReinforceTable:[function(t,e,i){"use strict";cc._RF.push(e,"5d89cb7oUNDe5f54dQtOJm+","SpiritReinforceTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="SpiritReinforceConfig",e._tblName="spirit_reinforce_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.quality]||(t[a.quality]={}),t[a.quality][a.level]=a}},e.prototype.getDataByQualityAndLv=function(t,e){return this._data[t]?this._data[t][e]:null},e.prototype.getMaxLvByQuality=function(t){return this._data[t]?this._data[t].myLen():0},e.prototype.getNextSpecialEffectId=function(t,e){var i;this._data[t]&&(i=this._data[t][e].specialEffectId);var n=this._data[t];for(var a in n){if(parseInt(a)>e)if(n[a].specialEffectId!=i)return n[a]}return null},e.prototype.getSpecialEffectId=function(t,e){return this._data[t]?this._data[t][e]:null},e.prototype.getEffectsByQuality=function(t){var e={},i=this._data[t];for(var n in i){var a=i[n].specialEffectId;e[a]||(e[a]=i[n]),i[n].level<e[a].level&&(e[a]=i[n])}var r=[];for(var n in e)r.push(e[n]);return r.sort(function(t,e){return t.level-e.level}),r},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SpiritStarTable:[function(t,e,i){"use strict";cc._RF.push(e,"acb58w2Rk1IEpB4SH6klWNR","SpiritStarTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="SpiritStarConfig",e._tblName="spirit_star_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]||(t[a.id]={}),t[a.id][a.starLevel]=a}},e.prototype.getDataByIdAndlv=function(t,e){return this._data[t]?this._data[t][e]:null},e.prototype.getMaxLvById=function(t){return this._data[t]?this._data[t].myLen():0},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SpiritTable:[function(t,e,i){"use strict";cc._RF.push(e,"76beajuUcNKC4yWmn3IdFU8","SpiritTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="SpiritConfig",e._tblName="spirit_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.spiritId]=a}},e.prototype.getSpiritById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getSpiritByFragmentId=function(t){for(var e in this._data)if(this._data[e].fragmentId===t)return this._data[e];return null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SpiritTalentTable:[function(t,e,i){"use strict";cc._RF.push(e,"317c0kA+L5Ku7KmIA3u6QMz","SpiritTalentTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="SpiritTalentConfig",e._tblName="spirit_talent_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.talentId]=a}},e.prototype.getTalentById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getTalentIdsByQuality=function(t){var e=[],i=function(i){n._data[i].weight.forEach(function(n){n[0]===t&&n[1]>0&&e.push(parseInt(i))})},n=this;for(var a in this._data)i(a);return e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SpriteAnimation:[function(t,e,i){"use strict";cc._RF.push(e,"d699fsZhv9EhpW1D0vx+EKa","SpriteAnimation");var n=cc.Class({extends:cc.Component,editor:{menu:"module/Pvp/PvpBattleSprite"},properties:{_dirType:0,_spriteData:null,_originalScale:null,_scale:1,_animationNode:null,_animation:null,_speed:null,_idleCount:0,_bShowIdle_1:!1,_idle_1CallBack:null,_posZ:0,_showIdle_2:!1,_isInbattle:!0,_fightType:0,_finishCb:null},onLoad:function(){this._addEventListener()},onEnable:function(){},_addEventListener:function(){var t=td.EventNameEnum,e={};e[t.FIGHT_SPEED_CHANGE]=this._speedChange,e[t.ON_CHANGE_FIGHT_SPEED]=this._speedChange,td.EventUtil.registerEvents(e,this)},onDestroy:function(){td.EventUtil.unregisterAllEvents(this)},onDisable:function(){},_setSpeed:function(t){if(this._animation){var e=this._animation.getClips();if(e)for(var i=0,n=e.length;i<n;i++){if(e[i]&&""!==e[i].name)this._animation.getAnimationState(e[i].name).speed=t}}},setFightType:function(t){void 0===t&&(t=0),this._fightType=t},setIsInBattle:function(t){this._isInbattle=t},getDefaultSize:function(){return this.node.size},_speedChange:function(t){this._isInbattle&&this.onChangeAnimationSpeed(t)},onChangeAnimationSpeed:function(t){this._setSpeed(t),this._speed=t},isLoadedAnima:function(){return!!this._animationNode},init:function(t,e,i,n,a,r,o,s){if(void 0===i&&(i=!1),void 0===n&&(n=null),void 0===a&&(a=0),void 0===r&&(r=!1),void 0===o&&(o=null),void 0===s&&(s=null),this._spriteData=t,this._dirType=e||7,this._idle_1CallBack=n,this._posZ=a,this._finishCb=s,this._animationNode&&(this._animationNode.destroy(),this._animationNode=null),o)this.initSprite(o,!0);else{var l=td.GlobalFunction.getResIdByNode(this.node),c="";switch(this._fightType){case 0:c=t.getAnimationRes();break;case 1:c=t.getMercenaryDataModel().getPveIdleRes();break;case 2:c=t.getBaseModel().getPvpIdleRes()}c&&gdk.rm.loadRes(l,c,cc.Prefab,this.initSprite.bind(this))}},initSprite:function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),cc.isValid(this.node)&&this._spriteData&&!this._animationNode){if(t&&e)this._animationNode=t;else{switch(this._fightType){case 0:i=this._spriteData.getAnimationRes();break;case 1:i=this._spriteData.getMercenaryDataModel().getPveIdleRes();break;case 2:i=this._spriteData.getBaseModel().getPvpIdleRes()}var i=gdk.rm.getResByUrl(i,cc.Prefab);if(i){var n=cc.instantiate(i);this._animationNode=n}}var a=cc.v2(0,0),r=td.GetTableClass(td.TableEnum.ModelShowTable).getDataByTypeAndId(this._spriteData.getModelShowType(),this._spriteData.getRoleType());this._isInbattle?r&&r.battleRotation&&this.setEulerAnglesChange(cc.v3(r.battleRotation[0],r.battleRotation[1],r.battleRotation[2])):(r&&r.idleOffset&&(a=cc.v2(r.idleOffset[0],r.idleOffset[1]),this.setEulerAnglesChange(cc.v3(r.idleRotation[0],r.idleRotation[1],r.idleRotation[2]))),this._animationNode.x=a.x,this._animationNode.y=a.y),this._animationNode.name="spriteAnima";var o=this.node.getChildByName("spriteAnima");o&&o.removeFromParent(),this.node.addChild(this._animationNode);var s=this._animationNode.getComponent(cc.Animation);if(this._animation=s,this._originalScaleX=this._animationNode.scaleX,this._originalScaleY=this._animationNode.scaleY,this._originalScaleZ=this._animationNode.scaleZ,this._animationNode.scaleX=this._originalScaleX*this._scale,this._animationNode.scaleY=this._originalScaleY*this._scale,this._animationNode.scaleZ=this._originalScaleZ*this._scale,!this._isInbattle){var l=1;r&&(r.h5_idleScale||r.idleScale)&&(l=r.h5_idleScale||r.idleScale),this.setCustomScale(1*l)}this._animation.play(this._animation.defaultClip.name),this._finishCb&&this._finishCb()}},checkBattleRatation:function(){var t=td.GetTableClass(td.TableEnum.ModelShowTable).getDataByTypeAndId(this._spriteData.getModelShowType(),this._spriteData.getRoleType());t&&t.battleRotation&&this.setEulerAnglesChange(cc.v3(t.battleRotation[0],t.battleRotation[1],t.battleRotation[2]))},changeDir:function(t){if(this._dirType=t,this._animationNode){var e=(t+2-1)%8+1,i=e>5?-1:1;this._animationNode.scaleX=Math.abs(this._animationNode.scaleX)*i;var n=this._animation.getClips(),a=e;switch(e){case 6:a=4;break;case 7:a=3;break;case 8:a=2}return n.length>=a&&this._animation.play(n[a-1].name),[a,i]}},setEulerAngles:function(t){void 0===t&&(t=cc.v3(0,-90,0)),this._animationNode&&(this._animationNode.eulerAngles=t)},getEulerAngles:function(){return this._animationNode?this._animationNode.eulerAngles:cc.v3(0,-90,0)},getAnimaitonNode:function(){return this._animationNode},setEulerAnglesChange:function(t){void 0===t&&(t=cc.v3(0,0,0))},setCustomScale:function(t){this._scale=t,this._animationNode&&(this._animationNode.scaleX=this._originalScaleX*t,this._animationNode.scaleY=this._originalScaleY*t,this._animationNode.scaleZ=this._originalScaleZ*t)},pauseAnimation:function(){this._animationNode&&this._animation.pause()},resumeAnimation:function(){this._animationNode&&this._animation.resume()},setFinishAnimationCallBack:function(t){this.removeFinishAnimationCallBack(),this._animation&&this._animation.on("finished",t),this._finishAnimationCallBack=t},removeFinishAnimationCallBack:function(){this._finishAnimationCallBack&&(this._animation&&this._animation.off("finished",this._finishAnimationCallBack),this._finishAnimationCallBack=null)},playNone:function(){},onIdleLastFrame:function(){this._idleCount++,this._bShowIdle_1&&this._idleCount%20==0&&(this.playIdle_1(),this.setFinishAnimationCallBack(this.playIdle.bind(this)))},onIdleLastFrameAndIdle_1:function(){this._idleCount++,this._bShowIdle_1&&this._idleCount%2==0&&(this.playIdle_1(),this.setFinishAnimationCallBack(this._idle_1CallBack))},playIdleAndIdle_1:function(){this._playAnimationClip("idle",cc.WrapMode.Loop),this._idleCount=0,this._animation.on("lastframe",this.onIdleLastFrameAndIdle_1,this)},playIdle:function(){this._playAnimationClip("idle",cc.WrapMode.Loop),this._idleCount=0,this._bShowIdle_1&&this._animation.on("lastframe",this.onIdleLastFrame,this)},playIdle_1:function(){this._playAnimationClip("idle_1",cc.WrapMode.Normal)},playIdle_1ThenIdle:function(){this.playIdle_1(),this._animation&&this._animation.on("finished",this.playIdle,this)},playIdle_2:function(){this._playAnimationClip("idle_2",cc.WrapMode.Loop)},playRun:function(){this._playAnimationClip("run",cc.WrapMode.Loop)},playMove:function(t){this._playAnimationClip("Jump",cc.WrapMode.Normal),t&&this.setFinishAnimationCallBack(t)},playBack:function(t){this._playAnimationClip("Jump",cc.WrapMode.Normal),t&&this.setFinishAnimationCallBack(t)},playDead:function(t){this._playAnimationClip("dead",cc.WrapMode.Normal),t&&this.setFinishAnimationCallBack(t)},playHit:function(t){this._playAnimationClip("hit",cc.WrapMode.Normal),t&&this.setFinishAnimationCallBack(t)},playRestraint:function(t){this._playAnimationClip("restraint",cc.WrapMode.Normal),t&&this.setFinishAnimationCallBack(t)},_playAnimationClip:function(t,e){if(this.getAnimationByName(t)&&(this.removeFinishAnimationCallBack(),this._bShowIdle_1&&"idle"!=t&&this._animation.off("lastframe",this.onIdleLastFrame,this),cc.log("_playAnimationClip "+t),this._animation)){var i=this._animation.play(t),n=e||cc.WrapMode.Normal;i.wrapMode=n}},getAnimationByName:function(t){if(t&&this._animation){var e=this._animation.getClips();if(!e)return null;for(var i=0,n=e.length;i<n;i++)if(e[i]&&e[i]._name===t)return e[i]}return null}});e.exports=n,cc._RF.pop()},{}],StarDiamondController:[function(t,e,i){"use strict";cc._RF.push(e,"04e79/tbQxMfZVxI3Qw2LwB","StarDiamondController");var n=t("ActivityBaseController"),a=t("StarDiamondModel"),r=cc.Class({extends:n,properties:{_modelList:null,_isOpen:null},initData:function(t){this._super(t),this._modelList=[],this._isOpen=!1,this.addNetListener(),this.addEventListener()},destroyData:function(){this._super(),this._modelList=null},addNetListener:function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.STAR_DIAMOND_GET_INFO,this._parseInfo.bind(this)),i.registerMessage(t,e.STAR_DIAMOND_EXCHANGE,this._onGetReward.bind(this)),i.registerMessage(t,e.PUSH_STAR_DIAMOND_INFO,this._pushInfo.bind(this))},addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REQUEST_SKY_DIAMOND_INFO]=this._requestInfo.bind(this),t[e.REQUEST_EXCHANGE_SKY_DIAMOND]=this._requestExchange.bind(this),td.EventUtil.registerEvents(t,this)},getDataList:function(){return this._modelList},_requestInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.STAR_DIAMOND_GET_INFO,td.ServerDelegate.sendMessage(t)},_requestExchange:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.STAR_DIAMOND_EXCHANGE,e.configId=t,td.ServerDelegate.sendMessage(e)},_parseInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.exchanges;this.refreshModelList(i)}},_onGetReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.GlobalFunction.showRewards(n)}},_pushInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.exchanges;this.refreshModelList(i)}},refreshModelList:function(t){var e=td.GetTableClass(td.TableEnum.StarDiamondTable).getDatas();for(var i in this._modelList=[],e){var n=e[i],r=new a;r.initData(n),this._modelList.push(r);var o=r.getLeftTime();t[i]&&(o-=t[i]),r.setLeftTime(o)}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_SKY_DIAMOND_INFO)},hasRedPoint:function(){return!0},openPanel:function(){this.redPointTip()&&(this._isOpen=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.open_StarDiamond))},redPointTip:function(){if(!this._modelList)return!1;if(this._isOpen)return!1;for(var t=td.GetTableClass(td.TableEnum.StarDiamondTable).getDatas(),e=td.ItemManager.getItemNumById(t[1].cost[0][1]),i=0,n=this._modelList.length;i<n;i++){if(e<this._modelList[i].getCost()[0][2])return!1}return!0},redPointEvts:function(){return[td.EventNameEnum.REFRESH_SKY_DIAMOND_INFO,td.EventNameEnum.open_StarDiamond]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",StarDiamondModel:"StarDiamondModel"}],StarDiamondItem:[function(t,e,i){"use strict";cc._RF.push(e,"49bd2ZkFStE7ppAf4cv1a87","StarDiamondItem");var n=t("ListItem"),a=cc.Class({extends:n,properties:{_controller:null,_receiveCallBack:null},onDisable:function(){gdk.Timer.clearAll(this)},updateItem:function(t,e){this._controller=this._customData.controller,this._receiveCallBack=this._customData.receiveFunc,this._super(t,e);var i=this.node.getChildByName("labOddTimes"),n=this.node.getChildByName("costNode"),a=this.node.getChildByName("getNode"),r=this.node.getChildByName("btnOperation");0!=e.getLeftTime()?i.getComponent(cc.RichText).string="<color=#ad6201>"+td.Language.leftTimes+"</c><color=#3dbf00>"+e.getLeftTime()+"/"+e.getTotleTime()+"</c>":i.getComponent(cc.RichText).string="<color=#ad6201>"+td.Language.leftTimes+"</c><color=#eb0303>"+e.getLeftTime()+"</c><color=#3dbf00>/"+e.getTotleTime()+"</c>";var o=td.RewardManager.parseRewardListDetail(e.getCost())[0],s=td.GlobalFunction.createCommonIconWidget(26,o);s&&(s.setScale(.8),s.setPosition(cc.v2(0,0)),n.addChild(s));var l=td.RewardManager.parseRewardListDetail(e.getReward())[0],c=td.GlobalFunction.createCommonIconWidget(26,l);c&&(c.setScale(.8),c.setPosition(cc.v2(0,0)),a.addChild(c)),e.getState()==td.ActivityEnum.StarDiamondEnum.CAN_Exchange||gdk.Timer.once(100,this,function(){td.GlobalFunction.setButtonGray(r,!0)}),td.RedPointUtil.createRedPointSimple(r,{x:-10,y:-10},e.getState()==td.ActivityEnum.StarDiamondEnum.CAN_Exchange);var u=r.getComponent(cc.Button);u.clickEvents=[];var d=new cc.Component.EventHandler;return d.target=this.node,d.component="StarDiamondItem",d.handler="onGetReward",d.customEventData=e.getId(),u.clickEvents.push(d),t},onGetReward:function(t,e){var i=e;this._receiveCallBack&&"function"==typeof this._receiveCallBack&&this._receiveCallBack(i)}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],StarDiamondModel:[function(t,e,i){"use strict";cc._RF.push(e,"50117DbrcNC66PPbXynjmKy","StarDiamondModel");var n=cc.Class({properties:{_id:null,_cost:null,_reward:null,_leftTime:null,_totleTime:null,_state:null},initData:function(t){this._id=t.id,this._cost=t.cost,this._reward=t.rewards,this._totleTime=t.timesLimit,this._leftTime=t.timesLimit,this._state=td.ActivityEnum.StarDiamondEnum.NONE},getId:function(){return this._id},getCost:function(){return this._cost},getReward:function(){return this._reward},getTotleTime:function(){return this._totleTime},getLeftTime:function(){return this._leftTime},setLeftTime:function(t){if(this._leftTime=t,this._leftTime>0){var e=td.GetTableClass(td.TableEnum.StarDiamondTable).getDatas(),i=td.ItemManager.getItemNumById(e[1].cost[0][1]),n=this._cost[0][2];this._state=i>=n?td.ActivityEnum.StarDiamondEnum.CAN_Exchange:td.ActivityEnum.StarDiamondEnum.CAN_NOT_Exchange}else this._state=td.ActivityEnum.StarDiamondEnum.CAN_NOT_Exchange},getState:function(){return this._state}});e.exports=n,cc._RF.pop()},{}],StarDiamondPanel:[function(t,e,i){"use strict";cc._RF.push(e,"d05ee53CddBSJvoz3Pvmx6B","StarDiamondPanel");var n=t("ActivityBasePanel"),a=t("OptimizeVerticalListView"),r=cc.Class({extends:n,properties:{_listViewLogic:null},initData:function(t){this._super(t),td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_SKY_DIAMOND_INFO)},onLoad:function(){var t=this.node.getChildByName("scrollView");this._listViewLogic=t.getComponent(a)},_addEventListener:function(){var t={};t[td.EventNameEnum.REFRESH_SKY_DIAMOND_INFO]=this._initUi,td.EventUtil.registerEvents(t,this)},onEnable:function(){this._super(),this._addEventListener(),this._controller.openPanel()},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this)},_initUi:function(){var t=this.node.getChildByName("titleWidget").getChildByName("labCount"),e=td.GetTableClass(td.TableEnum.StarDiamondTable).getDatas();t.getComponent(cc.Label).string=td.ItemManager.getItemNumById(e[1].cost[0][1]),this._refreshView()},_refreshView:function(){var t=this._controller.getDataList();t.sort(function(t,e){var i=t.getState(),n=e.getState();return i===td.ActivityEnum.StarDiamondEnum.CAN_Exchange&&n!=td.ActivityEnum.StarDiamondEnum.CAN_Exchange?-1:i===td.ActivityEnum.StarDiamondEnum.CAN_NOT_Exchange&&n!=td.ActivityEnum.StarDiamondEnum.CAN_NOT_Exchange?1:t.getId()-e.getId()});var e={dataList:t,controller:this._controller,receiveFunc:this.onExchangeGoods.bind(this)};this._listViewLogic&&(this._listViewLogic.setCustomData(e),this._listViewLogic.setData(t))},onExchangeGoods:function(t){var e=td.GetTableClass(td.TableEnum.StarDiamondTable).getDatas();if(td.ItemManager.getItemNumById(e[1].cost[0][1])<td.GetTableClass(td.TableEnum.StarDiamondTable).getDataById(t).cost[0][2]){var i=new td.BroadcastContent(203);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}else this._controller._requestExchange(t)},jumpToStoryGate:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_PveCopyGate)}});e.exports=r,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0}],StarDiamondTable:[function(t,e,i){"use strict";cc._RF.push(e,"78ac0F3nmdHdrPGYp8BM0dG","StarDiamondTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"StarDiamondTable",properties:{_tblName:"star_diamond_config",_datas:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},getDatas:function(){return this._data},getDataById:function(t){return this._data[t]?this._data[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],StarUpRoadChapterTable:[function(t,e,i){"use strict";cc._RF.push(e,"540d7Zid/FLT42HGBvu8f8p","StarUpRoadChapterTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="StarUpRoadChapterConfig",e._tblName="star_up_road_chapter_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.chapterId]=a}},e.prototype.getDataById=function(t){return this._data[t]},e.prototype.getMinChapterId=function(){var t=null;for(var e in this._data)(!t||t.index>this._data[e].index)&&(t=this._data[e]);return t.chapterId},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],StarUpRoadItemModel:[function(t,e,i){"use strict";cc._RF.push(e,"f5243BcxIZLAKYKeocuWjm7","StarUpRoadItemModel");var n=window.td,a=(t("PropertyModel"),function(){function t(){this._star=0,this._challengeTimes=0,this._resetTimes=0}return t.prototype.init=function(t){this._id=t,this._cfg=n.GetTableClass(n.TableEnum.StarUpRoadTable).getDataById(t)},t.prototype.upData=function(t){(t.star||0==t.star)&&(this._star=t.star),(t.challengeTimes||0==t.challengeTimes)&&(this._challengeTimes=t.challengeTimes),(t.resetTimes||0==t.resetTimes)&&(this._resetTimes=t.resetTimes)},t.prototype.getId=function(){return this._id},t.prototype.getStar=function(){return this._star},t.prototype.getChallengeTimes=function(){return this._challengeTimes},t.prototype.getResetTimes=function(){return this._resetTimes},t.prototype.getCfg=function(){return this._cfg},t.prototype.getChapterId=function(){return this._cfg.chapterId},t}());e.exports=a,cc._RF.pop()},{PropertyModel:"PropertyModel"}],StarUpRoadManager:[function(t,e,i){"use strict";cc._RF.push(e,"99a97rImbhDv7kcTYs8m23q","StarUpRoadManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=cc._decorator.ccclass,o=t("StarUpRoadModel"),s=t("StarUpRoadItemModel"),l=function(){function t(){this._isInit=!1,this._originLevel=0,this._fightId=0,this._chapterId=0}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this._models={}},t.prototype.destroyData=function(){this._models={},this._isInit=!1,this._originLevel=0,this._fightId=0,this._chapterId=0},t.prototype.addListener=function(){var t=a.MsgModuleName.STAR_UP_ROAD,e=a.MsgCmd.STAR_UP_ROAD;a.ServerDelegate.registerMessage(t,e.STAR_UP_ROAD_INFO,this.parseStarUpInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.STAR_UP_ROAD_STAR_REWARD,this.parseStarUpRewardInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.STAR_UP_ROAD_CHALLENGE,this.parseStarUpChallenge.bind(this)),a.ServerDelegate.registerMessage(t,e.STAR_UP_ROAD_SWEEP,this.parseStarUpReward.bind(this)),a.ServerDelegate.registerMessage(t,e.STAR_UP_ROAD_RESET_TIMES,this.parseStarUpResetTimes.bind(this)),a.ServerDelegate.registerMessage(t,e.STAR_UP_ROAD_RECEIVE_STAR_REWARD,this.parseStarUpReward.bind(this)),a.ServerDelegate.registerMessage(t,e.STAR_UP_ROAD_QUICKLY_RECEIVE_STAR_REWARD,this._onGetOneKeyRewards.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_STAR_UP_ROAD_INFO,this.parseStarUpInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_STAR_UP_ROAD_STAR_REWARD,this.parseStarUpRewardInfo.bind(this))},t.prototype.getOriginLevel=function(){return this._originLevel},t.prototype.clearOriginLevel=function(){this._originLevel=0},t.prototype.getFightId=function(){return this._fightId},t.prototype.getChapterId=function(){return this._chapterId},t.prototype.hasNextGate=function(){var t=this.getCopyModelByCopyId(this._fightId);return!(!t||0===t.getCfg().nextId)},t.prototype.parseStarUpInfo=function(t,e){var i=this;t===a.NetCode.SUCCESS&&(this._isInit||this.initCfg(),e.starUpRoadList.forEach(function(t){var e=new s;e.init(t.id),e.upData(t);var n=e.getCfg().chapterId;i._models[n].upDataCopy(e)}),a.EventUtil.dispatchEvent(a.EventNameEnum.RES_STAR_UP_ROAD_INFO))},t.prototype.parseStarUpRewardInfo=function(t,e){if(t===a.NetCode.SUCCESS){for(var i in this._isInit||this.initCfg(),e.starRewardMap)this._models[i].setRewardIndex(e.starRewardMap[i]);a.EventUtil.dispatchEvent(a.EventNameEnum.RES_STAR_UP_ROAD_STAR_REWARD)}},t.prototype.parseStarUpChallenge=function(t,e){a.NetCode.SUCCESS},t.prototype.parseStarUpResetTimes=function(t,e){a.NetCode.SUCCESS},t.prototype.parseStarUpReward=function(t,e){if(t===a.NetCode.SUCCESS){var i=a.RewardManager.parseRewardResult(e.rewardResult,!0);a.GlobalFunction.showRewards(i),a.EventUtil.dispatchEvent(a.EventNameEnum.PARSE_STAR_UP_ROAD_REWARD)}},t.prototype._requestOneKeyRewards=function(){var t={};t.module=a.MsgModuleName.STAR_UP_ROAD,t.cmd=a.MsgCmd.STAR_UP_ROAD.STAR_UP_ROAD_QUICKLY_RECEIVE_STAR_REWARD,a.ServerDelegate.sendMessage(t)},t.prototype._onGetOneKeyRewards=function(t,e){t===a.NetCode.SUCCESS&&this.parseStarUpReward(t,e)},t.prototype.addEventListener=function(){var t=a.EventUtil,e=a.EventNameEnum,i={};i[e.REQ_STAR_UP_ROAD_INFO]=this.requestStarUpInfo,i[e.REQ_STAR_UP_ROAD_STAR_REWARD]=this.requestStarUpRewardInfo,i[e.REQ_STAR_UP_ROAD_CHALLENGE]=this.requestStarUpChallenge,i[e.REQ_STAR_UP_ROAD_SWEEP]=this.requestStarUpSweep,i[e.REQ_STAR_UP_ROAD_RESET_TIMES]=this.requestStarUpReset,i[e.REQ_STAR_UP_ROAD_RECEIVE_STAR_REWARD]=this.requestStarUpReward,i[e.REQ_STAR_UP_ROAD_ONE_KEY_REWARD]=this._requestOneKeyRewards,t.registerEvents(i,this)},t.prototype.requestStarUpInfo=function(){var t={};t.module=a.MsgModuleName.STAR_UP_ROAD,t.cmd=a.MsgCmd.STAR_UP_ROAD.STAR_UP_ROAD_INFO,a.ServerDelegate.sendMessage(t)},t.prototype.requestStarUpRewardInfo=function(){var t={};t.module=a.MsgModuleName.STAR_UP_ROAD,t.cmd=a.MsgCmd.STAR_UP_ROAD.STAR_UP_ROAD_STAR_REWARD,a.ServerDelegate.sendMessage(t)},t.prototype.requestStarUpChallenge=function(t){a.EventUtil.dispatchEvent(a.EventNameEnum.RECORD_CUR_LEVEL);var e={};e.module=a.MsgModuleName.STAR_UP_ROAD,e.cmd=a.MsgCmd.STAR_UP_ROAD.STAR_UP_ROAD_CHALLENGE,e.id=t,a.ServerDelegate.sendMessage(e);var i=this.getCopyModelByCopyId(t);i&&(this._chapterId=i.getChapterId()),this._fightId=t},t.prototype.requestStarUpSweep=function(t){var e={};e.module=a.MsgModuleName.STAR_UP_ROAD,e.cmd=a.MsgCmd.STAR_UP_ROAD.STAR_UP_ROAD_SWEEP,e.id=t,a.ServerDelegate.sendMessage(e)},t.prototype.requestStarUpReset=function(t){var e={};e.module=a.MsgModuleName.STAR_UP_ROAD,e.cmd=a.MsgCmd.STAR_UP_ROAD.STAR_UP_ROAD_RESET_TIMES,e.id=t,a.ServerDelegate.sendMessage(e)},t.prototype.requestStarUpReward=function(t){var e={};e.module=a.MsgModuleName.STAR_UP_ROAD,e.cmd=a.MsgCmd.STAR_UP_ROAD.STAR_UP_ROAD_RECEIVE_STAR_REWARD,e.chapterId=t.chapterId,e.star=t.star,a.ServerDelegate.sendMessage(e)},t.prototype.getModelByChapterId=function(t){return this._models[t]},t.prototype.getCopyModelByCopyId=function(t){if(!this._models||0===this._models.myLen())return null;for(var e in this._models){var i=this._models[e].getCopyById(t);if(i)return i}return null},t.prototype.getNextCopy=function(){var t,e,i,n=0;for(var a in this._models)e?parseInt(a)<e&&(e=parseInt(a)):e=parseInt(a),this._models[a].getCopys().forEach(function(e){e.getStar()>0&&e.getId()>n&&(n=e.getId(),t=e),i?e.getId()<i&&(i=e.getId()):i=e.getId()});return t?this._models[t.getCfg().chapterId].getCopyById(t.getId()+1)?t=this._models[t.getCfg().chapterId].getCopyById(t.getId()+1):this._models[t.getCfg().chapterId+1]&&this._models[t.getCfg().chapterId+1].getCopyById(t.getId()+1)&&(t=this._models[t.getCfg().chapterId+1].getCopyById(t.getId()+1)):t=this._models[e].getCopyById(i),t},t.prototype.initCfg=function(){var t=a.GetTableClass(a.TableEnum.StarUpRoadTable).getAll();for(var e in t){var i=t[e].chapterId;if(!this._models[i]){var n=new o;n.init(i),this._models[i]=n}var r=new s;r.init(parseInt(e)),this._models[i].upDataCopy(r)}this._isInit=!0},t.prototype.redPointEvents=function(){var t=a.EventNameEnum;return[t.RES_STAR_UP_ROAD_INFO,t.RES_STAR_UP_ROAD_STAR_REWARD]},t.prototype.isRedPointTips=function(){if(!a.UnlockManager.isPanelUnlock(a.PanelEnum.Panel_StarUpRoad))return!1;for(var t=a.GetTableClass(a.TableEnum.StarUpRoadChapterTable).getMinChapterId(),i=e.getInstance().getNextCopy().getCfg().chapterId;t<=i;t++)if(this.checkChapterBox(t))return!0;return!1},t.prototype.checkChapterBox=function(t){var i=e.getInstance().getModelByChapterId(t),n=i.getStar();if(n<=0)return!1;var a=i.getRewardIndex();if(a.length>=3)return!1;for(var r=i.getCfg().starRewards,o=0;o<r.length;o++)if(n>=r[o][0]&&-1==a.indexOf(r[o][0]))return!0;return!1},t.prototype.haveBoxRewardToGet=function(){for(var t=a.GetTableClass(a.TableEnum.StarUpRoadChapterTable).getMinChapterId(),i=e.getInstance().getNextCopy().getCfg().chapterId;t<=i;t++)if(this.checkChapterBox(t))return!0;return!1},t=e=n([r],t)}();i.default=l,cc._RF.pop()},{StarUpRoadItemModel:"StarUpRoadItemModel",StarUpRoadModel:"StarUpRoadModel"}],StarUpRoadModel:[function(t,e,i){"use strict";cc._RF.push(e,"c4f95uGaxNIZJ+5EucJk4W2","StarUpRoadModel");var n=window.td,a=(t("PropertyModel"),function(){function t(){this._star=0,this._copys=[],this._rewardIndex=[]}return t.prototype.init=function(t){this._chapterId=t,this._cfg=n.GetTableClass(n.TableEnum.StarUpRoadChapterTable).getDataById(t)},t.prototype.addCopy=function(t){this._copys.push(t)},t.prototype.upDataCopy=function(t){for(var e=!0,i=0;i<this._copys.length;i++)if(this._copys[i].getId()==t.getId()){this._copys[i]=t,e=!1;break}e&&this.addCopy(t)},t.prototype.countStar=function(){var t=0;this._copys.forEach(function(e){t+=e.getStar()}),this._star=t},t.prototype.getChapterId=function(){return this._chapterId},t.prototype.getStar=function(){return this.countStar(),this._star},t.prototype.getCfg=function(){return this._cfg},t.prototype.getRewardIndex=function(){return this._rewardIndex},t.prototype.setRewardIndex=function(t){this._rewardIndex=t},t.prototype.getCopys=function(){return this._copys},t.prototype.getCopyById=function(t){for(var e=0;e<this._copys.length;e++)if(this._copys[e].getId()==t)return this._copys[e]},t}());e.exports=a,cc._RF.pop()},{PropertyModel:"PropertyModel"}],StarUpRoadTable:[function(t,e,i){"use strict";cc._RF.push(e,"d50a8jRWMdK86vRJxYOQyOH","StarUpRoadTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="StarUpRoadConfig",e._tblName="star_up_road_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data[t]},e.prototype.getAll=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],StepStepUpController:[function(t,e,i){"use strict";cc._RF.push(e,"e1eaeJdN2BORqlYU1HkwbDP","StepStepUpController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_floor:null,_position:null,_lastPosition:null,_showRewardDatas:null,_maxFloor:null,_maxPositionIndex:null},initData:function(t){this._super(t)},activityParse:function(t){t&&this._parseReceiveQueryData(t)},parseRewardReceived:function(t){if(t.activityId===this.getActivityId()){var e=t.rewardResult;e=td.RewardManager.parseRewardResult(e)}},getFloorData:function(t){var e=t||this._floor,i=td.GetTableClass(td.TableEnum.StepStepUpTable).getDatasByDataId(this._activityData);return this._maxFloor=i.length,this._maxPositionIndex=i[e-1].mapPositoion.length-1,e>0&&e<=this._maxFloor?i[e-1]:[]},getMaxFloor:function(){return this._maxFloor},getFloor:function(){return this._floor},getPositions:function(){return this._positions||[]},getCurPostion:function(){return this._position},getLastPostion:function(){return this._lastPosition},checkIsReadEnd:function(){return this._floor===this._maxFloor&&this._position===this._maxPositionIndex},_parseReceiveQueryData:function(t){var e=t.record;null!==this._position&&(this._lastPosition=this._position),this._position=e.position,this._positions=e.positions,this._floor=e.floor||1,null!==this._lastPosition&&this._lastPosition!==this._position&&td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_STEPSTEPUP_MOVE,{start:this._lastPosition,end:this._position})},getShowTaskList:function(){var t=td.TaskManager.getShowListByType(td.TaskType.StepStepUp,[]);return this._sortTaskList(t),t},isTaskRedPoint:function(){for(var t=this.getShowTaskList(),e=0,i=t.length;e<i;e++){if(t[e].getStatus()===td.TaskStatus.Finish)return!0}return!1},_sortTaskList:function(t){t.sort(function(t,e){return 4===t.getStatus()&&4!==e.getStatus()?1:4!==t.getStatus()&&4===e.getStatus()?-1:t.getStatus()>e.getStatus()?-1:t.getStatus()<e.getStatus()?1:t.getSortRank()-e.getSortRank()})},getRewardList:function(){if(!this._showRewardDatas){this._showRewardDatas=[];for(var t=td.GetTableClass(td.TableEnum.StepStepUpTable).getDatasByDataId(this._activityData),e=0,i=t.length;e<i;e++){var n=t[e];n.previewRewards.length>0&&(this._showRewardDatas[this._showRewardDatas.length]=n)}}return this._showRewardDatas},hasRedPoint:function(){return!0},redPointEvts:function(){return[td.EventNameEnum.Res_GET_TASK_INFO,td.EventNameEnum.Res_GET_ACTIVITY_INFO]},isTouziRedPoint:function(){return td.ItemManager.getItemNumById(td.ItemEnum.TouziItem)>0&&this._floor<this._maxFloor},redPointTip:function(){return this.isRedPointTip()},isRedPointTip:function(){return this.isTouziRedPoint()||this.isTaskRedPoint()}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],StepStepUpGetItemItem:[function(t,e,i){"use strict";cc._RF.push(e,"05bdexoYLxDSp6VgDZegzGh","StepStepUpGetItemItem");var n=t("ListItem"),a=t("CommonIconWidget"),r=cc.Class({extends:n,properties:{btnReceive:cc.Node,btnGo:cc.Node,textDes:cc.Label,textProgress:cc.Label,imgReceived:cc.Node},updateItem:function(t,e){this._super(t,e),this.textDes.string=e.getDes(),this.textProgress.string=td.Language.progress+":"+e.getValue()+"/"+e.getNeedValue();for(var i=td.RewardManager.getRewardDetailArray(e.getRewards()),n=0,r=i.length;n<r;n++){var o=i[n],s=td.GlobalFunction.getItemIcon(26,o.getGoodsType(),o.getId(),o.getCount());s.getComponent(a).setTouchEnabled(!0),s.setScale(.7),this.node.addChild(s),s.x=(.7*s.width+10)*n-230,s.y=-16}td.RedPointUtil.createRedPointSimple(this.btnReceive,{x:-10,y:-10},e.getStatus()===td.TaskStatus.Finish),e.getStatus()===td.TaskStatus.Finish?(this.btnReceive.active=!0,this.btnGo.active=!1,this.imgReceived.active=!1):e.getStatus()===td.TaskStatus.Progress?(this.btnGo.active=!0,this.btnReceive.active=!1,this.imgReceived.active=!1):e.getStatus()===td.TaskStatus.Received&&(this.btnGo.active=!1,this.btnReceive.active=!1,this.imgReceived.active=!0)},itemGotoClicked:function(){var t=this._item;if(t.getStatus()==td.TaskStatus.Finish)td.EventUtil.dispatchEvent(td.EventNameEnum.Req_TASK_RECEIVE,t.getId());else{var e=t.getGotoPanel();if(e.constructor==Array&&e.length>0){var i=e[0],n=null,a=e[1];i===td.PanelEnum.Panel_Activity||(n=a),td.PanelJumpManager.jumpToPanel(i,n),td.PanelManager.getInstance().getCurShowWindow().getComponent("PanelBase").hide()}}}});e.exports=r,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],StepStepUpGetItemWindow:[function(t,e,i){"use strict";cc._RF.push(e,"307a0o8T3BEgbMD8Ran08x+","StepStepUpGetItemWindow");var n=t("PanelBase"),a=t("OptimizeVerticalListView");cc.Class({extends:n,properties:{_listView:null,_activityType:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_StepStepGetItem,this._listView=this.node.getComponent(a)},onEnable:function(){this._super(),this._addEventListener(),this.refreshList()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum;t.registerEvent(e.Res_GET_TASK_INFO,this.refreshList,this)},clickBgListener:function(){this.closeCallFunc()},refreshList:function(){this.setData()},setData:function(){this._super();var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.StepStepUp);if(t){var e=t.getShowTaskList();this._listView.setData(e)}}});cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],StepStepUpPanel:[function(t,e,i){"use strict";cc._RF.push(e,"40749FLVNRJWbyROEdzBvth","StepStepUpPanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{btnGetItem:cc.Node,btnTouzi:cc.Node,lableTime:cc.RichText,lableItemNum:cc.Label,mapLayout:cc.Node,imgMap:cc.Sprite,progressBar:cc.ProgressBar,touZiDongHua:cc.Node,_mapPos:null,_touziAnima:null,maliNode:cc.Node,_maliAnimal:null,_isPlaying:!1,_rewardList:null,_isExcuteMove:!1,_time:.4},initData:function(t){this._super(t)},onEnable:function(){this._super(),this._setActivityTime(),this._addLocalListeners(),this._touziAnima=this.touZiDongHua.getComponent(cc.Animation),this._maliAnimal=this.maliNode.getComponent(cc.Animation),this.maliNode.zIndex=1e3,this.touZiDongHua.zIndex=900,this._time=.4,this._initProgressInfo(),this._initRewards(),this.setPostion(this._controller.getCurPostion()),this._playIdel(),td.RedPointUtil.createRedPointOld(this.btnGetItem,{x:-4,y:-4},this._controller.isTaskRedPoint.bind(this._controller),this._controller.redPointEvts()),td.RedPointUtil.createRedPointOld(this.btnTouzi,{x:-8,y:-8},this._controller.isTouziRedPoint.bind(this._controller),this._controller.redPointEvts())},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this),this._showReward()},onShowGetItemWindow:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,td.PanelEnum.Window_StepStepGetItem)},onShowRewardWindow:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_PANEL,td.PanelEnum.Window_StepStepUpReward)},onStart:function(){if(td.GlobalFunction.checkCanClicked(2e3)&&!this._isPlaying)if(this._controller.checkIsReadEnd()){var t=new td.BroadcastContent(199);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,t)}else this._controller.operateActivity({})},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.REFRESH_STEPSTEPUP_MOVE]=this._positionMove,i[e.Res_GET_TASK_INFO]=this._setItemNum,t.registerEvents(i,this)},_setItemNum:function(){this.lableItemNum.string=td.ItemManager.getItemNumById(td.ItemEnum.TouziItem)},_positionMove:function(t){var e=t.start,i=t.end;this._needChangeMap=!1,this._startPostion=e,this._endPostion=i;var n=0;i<e?(n=this._mapPos.length-1-e+i,this._needChangeMap=!0):n=i-e,n<=0&&n>6&&cc.error("touzi erro num "+n);var a="TouZiDongHua_"+n;this._touziAnima.off("finished",this._excuteMove),this._touziAnima.on("finished",this._excuteMove.bind(this)),cc.log("touzi anima "+a),this._touziAnima.play(a).wrapMode=cc.WrapMode.Normal,this._isPlaying=!0},_excuteMove:function(){if(!this._isExcuteMove){this._isExcuteMove=!0;var t=[],e=this._time;if(this._needChangeMap){for(c=this._startPostion+1;c<=this._mapPos.length-1;c++){cc.log("map pos index,x,y "+c,this._mapPos[c][0],this._mapPos[c][1]);var i=cc.moveTo(e,cc.v2(this._mapPos[c][0],this._mapPos[c][1]+30)),n=c;h=cc.callFunc(this._checkMaliDir,this,n),p=cc.sequence(i,h);t[t.length]=p}var a=cc.moveTo(e,cc.v2(50,500)),r=(h=cc.callFunc(this._initInfo,this),cc.callFunc(this.changePosition,this,0)),o=cc.callFunc(this._moveNextMapPostion,this),s=cc.callFunc(this._playIdel,this),l=cc.sequence(a,cc.spawn(cc.scaleTo(.2,.1),cc.fadeOut(.2)),h,r,cc.spawn(cc.scaleTo(.2,1),cc.fadeIn(.2)),s,cc.delayTime(.1),o);t[t.length]=l,this._playRun(),t.length>1?this.maliNode.runAction(cc.sequence(t)):this.maliNode.runAction(t[0])}else{for(var c=this._startPostion+1;c<=this._endPostion;c++){cc.log("pos index,x,y "+c,this._mapPos[c][0],this._mapPos[c][1]);var u=cc.moveTo(e,cc.v2(this._mapPos[c][0],this._mapPos[c][1]+30)),d=c,h=cc.callFunc(this._checkMaliDir,this,d),p=cc.sequence(u,h);t[t.length]=p}t[t.length]=cc.callFunc(this._playIdel,this),t[t.length]=cc.callFunc(this._showReward,this),this._playRun(),this.maliNode.runAction(cc.sequence(t))}}},_moveNextMapPostion:function(){var t=[];this._adJustMaliDir(0);for(var e=1;e<=this._endPostion;e++){cc.log("mapChanged pos index,x,y "+e,this._mapPos[e][0],this._mapPos[e][1]);var i=cc.moveTo(this._time,cc.v2(this._mapPos[e][0],this._mapPos[e][1]+30)),n=e,a=cc.callFunc(this._checkMaliDir,this,n),r=cc.sequence(i,a);t[t.length]=r}t[t.length]=cc.callFunc(this._playIdel,this),t[t.length]=cc.callFunc(this._showReward,this),this._playRun(),this.maliNode.runAction(cc.sequence(t))},_initInfo:function(){this._initRewards(),this._initProgressInfo()},_checkMaliDir:function(t,e){this._adJustMaliDir(e)},_adJustMaliDir:function(t){cc.log("_adJustMaliDir "+t),t===this._mapPos.length-1&&(t-=1);var e=this._mapPos[t],i=this._mapPos[t+1],n="",a="",r=1;e[0]<i[0]&&e[1]>i[1]?(n="mali_run_xia",a="mali_idle_xia",r=1):e[0]<i[0]&&e[1]<i[1]?(n="mali_run_shang",a="mali_idle_shang",r=1):e[0]>i[0]&&e[1]>i[1]?(n="mali_run_xia",a="mali_idle_xia",r=-1):e[0]>i[0]&&e[1]<i[1]&&(n="mali_run_shang",a="mali_idle_shang",r=-1),this._runClipName=n,this._idleClipName=a,cc.log("_adJustMaliDir clipName "+n),cc.log("_adJustMaliDir scaleX "+r),this._maliAnimal.play(n),this.maliNode.scaleX=r},_playIdel:function(){this._maliAnimal.play(this._idleClipName)},_playRun:function(){this._maliAnimal.play(this._runClipName)},_setActivityTime:function(){var t=this.getOpenEndTimeStr(),e=cc.js.formatStr(td.Language.activityTimeDuration,t);this.lableTime.string=e},_initProgressInfo:function(){var t=((a=this._controller.getFloor())-1)%5+1;this.progressBar.progress=t/5;for(var e=5*Math.floor((a-1)/5)+1,i=1;i<=5;i++){var n=this.node.getChildByName("floorBg_"+i),a=n.getChildByName("floor"),r=n.getChildByName("floorInfo");a.getComponent(cc.Label).string=e+i-1;var o=cc.js.formatStr(td.Language.perFloor,e+i-1);t===i&&(o=td.Language.cur+o),r.getComponent(cc.Label).string=o}},_initRewards:function(){var t=this._controller.getFloorData(),e=t.floor,i=t.rewards,n=t.mapName,a=t.mapPositoion;cc.log("floor "+e),this.lableItemNum.string=td.ItemManager.getItemNumById(td.ItemEnum.TouziItem),this._mapPos=a;var r=this._controller.getPositions();td.GlobalFunction.createSpriteNode(this.imgMap,n);for(var o=0,s=i.length;o<s;o++){var l=i[o][0],c=i[o][1],u=td.RewardManager.parseRewardListDetail([c]);if(u&&0!==u.length){var d=a[l],h=this.mapLayout.getChildByName("iconWidget_"+l);h?h.getComponent("CommonIconWidget").setData(u[0]):((h=td.GlobalFunction.createCommonIconWidget(28,u[0])).scale=.6,this.mapLayout.addChild(h),h.name="iconWidget_"+l),h.x=d[0],h.y=d[1]+30,h.active=!(ArrayUtils.contains(r,l)&&(!this._endPostion||this._endPostion&&this._endPostion!==l))}}},changePosition:function(t,e){this.setPostion(e)},setPostion:function(t){cc.log("setPostion ",t,this._mapPos[t][0],this._mapPos[t][1]),this.maliNode.x=this._mapPos[t][0],this.maliNode.y=this._mapPos[t][1]+30,this._adJustMaliDir(t)},onReceiveOperation:function(t){if(t.activityId===this._activityId){this.lableItemNum.string=td.ItemManager.getItemNumById(td.ItemEnum.TouziItem);var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);this._rewardList=i}},_showReward:function(){this._rewardList&&td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,this._rewardList),this._isPlaying=!1,this._endPostion=null,this._startPostion=null,this._isExcuteMove=!1,this._initRewards(),this._rewardList=null}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],StepStepUpRewardItem:[function(t,e,i){"use strict";cc._RF.push(e,"bb9d6jAH3tPKYfdRrp2Ak81","StepStepUpRewardItem");var n=t("ListItem"),a=t("CommonIconWidget"),r=cc.Class({extends:n,properties:{labelFloor:cc.Label},updateItem:function(t,e){if(this._super(t,e),e){var i=e.previewRewards,n=td.RewardManager.parseRewardListDetail(i);this.labelFloor.string=cc.js.formatStr(td.Language.perFloor,e.floor);for(var r=0,o=n.length;r<o;r++){(s=this.node.getChildByName("iconItem_"+r))?(s.active=!0,s.getComponent(a).setData(n[r])):((s=td.GlobalFunction.createCommonIconWidget(27,n[r])).name="iconItem_"+r,this.node.addChild(s),s.scale=.9,s.x=(.9*s.width+10)*r-240,s.y=-10)}for(;r<10;r++){var s;if(!(s=this.node.getChildByName("iconItem_"+r)))break;s.active=!1}}}});e.exports=r,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],StepStepUpRewardWindow:[function(t,e,i){"use strict";cc._RF.push(e,"59715whsL1Bm6XY7yNjLOJp","StepStepUpRewardWindow");var n=t("PanelBase"),a=t("OptimizeVerticalListView");cc.Class({extends:n,properties:{_listView:null,rewardPanel:cc.Node,myRankLabel:cc.Label},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_StepStepUpReward,this._listView=this.node.getComponent(a)},onEnable:function(){this._super(),this._addEventListener(),this.refreshList()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_addEventListener:function(){td.EventUtil,td.EventNameEnum},clickBgListener:function(){this.closeCallFunc()},refreshList:function(){this.setData()},setData:function(){this._super();var t=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.StepStepUp);if(t){var e=t.getRewardList();this._listView.setData(e)}}});cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],StepStepUpTable:[function(t,e,i){"use strict";cc._RF.push(e,"ada31gi/BhEJqAUDmLBMHOB","StepStepUpTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"Activity73Config",properties:{_tblName:"activity_73_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];n.mapName="UI/Activity/HD_bubugaos/"+n.mapName,this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasByDataId:function(t){var e=this._datas[t];return e||(e=[]),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],StoreRefreshTable:[function(t,e,i){"use strict";cc._RF.push(e,"161852t6kpK75Avb/lcqA6K","StoreRefreshTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="StoreRefreshConfig",e._tblName="store_refresh_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.storeType]=a}},e.prototype.getDataByType=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],StoryAreaConfig:[function(t,e,i){"use strict";cc._RF.push(e,"54490B8HhdMFYkWtV9C5j/M","StoryAreaConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"StoryAreaConfig",properties:{_tblName:"story_area_config",_data:null},init:function(){this._data={};for(var t=0,e=this._jsonData.length;t<e;t++){var i=this._jsonData[t];i.img="ZJ_zhangjie_bg/"+i.img,this._data[i.id]=i}},getAreaConfigById:function(t){var e=[];for(var i in this._data)this._data[i].id<=t&&e.push(this._data[i]);return e.sort(this.sortFunc),e},sortFunc:function(t,e){return t.id-e.id}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],StoryRewardManager:[function(t,e,i){"use strict";cc._RF.push(e,"47768d1I4xG7JKHl+NnQQ7y","StoryRewardManager"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("StoryRewardModel"),r=function(){function t(){this._receives=[],this._storyTaskList=[]}return t.getInstance=function(){return null===this._instance&&(this._instance=new t),this._instance},t.prototype.init=function(){this.destroyData(),this.addListener(),this.addEventListener()},t.prototype.getShowData=function(){if(!n.GuideManager.isForceGuideFinshed())return null;for(var t=0,e=this._storyTaskList.length;t<e;t++){var i=this._storyTaskList[t];if(i.getState()!==n.TaskStatus.Received)return i}return null},t.prototype._getDetailData=function(t,e,i){return{needChapter:t.getChapterId()-1e3,curChapter:n.PveGeneralCopyManager.getCurChapterId()-1e3-1,cfgData:e,timeCount:i}},t.prototype.destroyData=function(){this._receives=[],this._storyTaskList=[]},t.prototype.getStoryTask=function(){return this._storyTaskList},t.prototype.addListener=function(){var t=n.MsgModuleName.ExtensionCmd,e=n.MsgCmd.ExtensionCmd,i=n.ServerDelegate;i.registerMessage(t,e.GET_STORY_REWARD_INFO,this._parseStoryRewardInfo.bind(this)),i.registerMessage(t,e.STORY_REWARD_RECEIVE,this._receiveStoryReward.bind(this)),i.registerMessage(t,e.PUSH_STORY_REWARD_INFO,this._parseStoryRewardInfo.bind(this))},t.prototype.addEventListener=function(){var t=n.EventNameEnum,e={};e[t.REQ_GET_STORY_REWARD_INFO]=this._reqStoryInfo,e[t.REQ_RECEIVE_STORY_REWARD]=this._reqReceiveStoryReward,n.EventUtil.registerEvents(e,this)},t.prototype._reqStoryInfo=function(){var t={};t.module=n.MsgModuleName.ExtensionCmd,t.cmd=n.MsgCmd.ExtensionCmd.GET_STORY_REWARD_INFO,n.ServerDelegate.sendMessage(t)},t.prototype._parseStoryRewardInfo=function(t,e){if(t===n.NetCode.SUCCESS){if(this._receives=e.receives,!this._storyTaskList||this._storyTaskList.length<=0){var i=n.GetTableClass(n.TableEnum.StoryRewardTable).getDatas();this._storyTaskList=[];for(var r=0,o=i.length;r<o;r++){var s=new a;s.initData(i[r]),this._storyTaskList[r]=s}}if(this._receives.length>0)for(r=this._storyTaskList.length-1;r>=0;r--){var l=this._storyTaskList[r];ArrayUtils.contains(this._receives,l.getId())&&(l.setState(n.TaskStatus.Received),ArrayUtils.removeIndex(this._storyTaskList,r),o--)}this._storyTaskList.sort(function(t,e){return t.getState()===n.TaskStatus.Received&&e.getState()!==n.TaskStatus.Received?1:t.getState()!==n.TaskStatus.Received&&e.getState()===n.TaskStatus.Received?-1:t.getId()-e.getId()}),n.EventUtil.dispatchEvent(n.EventNameEnum.REFRESH_STORY_REWARD)}},t.prototype._reqReceiveStoryReward=function(t){var e={};e.module=n.MsgModuleName.ExtensionCmd,e.cmd=n.MsgCmd.ExtensionCmd.STORY_REWARD_RECEIVE,e.configId=t,n.ServerDelegate.sendMessage(e)},t.prototype._receiveStoryReward=function(t,e){if(t===n.NetCode.SUCCESS){var i=e.rewardResult,a=n.RewardManager.parseRewardResult(i,!0);n.GlobalFunction.showRewards(a)}},t.prototype.rewardBoxRedPointEvts=function(){return[n.EventNameEnum.RES_GET_STORY_INFO,n.EventNameEnum.REFRESH_STORY_REWARD]},t.prototype.hasPveCopyHaveRewards=function(){var t=this.getShowData();return!!t&&t.isCanReceive()},t._instance=null,t}();i.default=r,cc._RF.pop()},{StoryRewardModel:"StoryRewardModel"}],StoryRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"640610aTdVF+JRD9pFLSdPQ","StoryRewardModel");var n=cc.Class({properties:{_id:null,_reward:null,_state:null,_isLuxury:null},initData:function(t){this._id=t.id,this._reward=t.rewards,this._isLuxury=t.isLuxury},getId:function(){return this._id},getReward:function(){return this._reward},getState:function(){return this._state},setState:function(t){this._state=t},isCanReceive:function(){if(td.TaskStatus.Received===this._state)return!1;var t=td.PveGeneralCopyManager.getCurGateModel(),e=t.getPreGateId();return 0==t.getNextGateId()&&t.getCurStarCount()>0&&(e=t.getStroyId()),0===e&&(e=t.getStroyId()-1),this._id<=e},isLuxury:function(){return this._isLuxury}});e.exports=n,cc._RF.pop()},{}],StoryRewardTable:[function(t,e,i){"use strict";function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}cc._RF.push(e,"44d59qZKeBFGIqj47DEjiSo","StoryRewardTable");var a=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return(e=t.call.apply(t,[this].concat(n))||this).name="StoryRewardConfig",e._tblName="story_reward_config",e._data={},e}n(e,t);var i=e.prototype;return i.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}},i.getDatas=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],StoryRewardWindow:[function(t,e,i){"use strict";cc._RF.push(e,"706b0MunRNPjbvG1Qe3HEy7","StoryRewardWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./StoryRewardManager"),o=t("PanelBase"),s=t("OptimizeVerticalListView"),l=cc._decorator,c=l.ccclass,u=(l.property,l.menu),d=window.td,h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){this._panelType=d.PanelType.Window,this._panelEnum=d.PanelEnum.Window_StoryReward},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this.initUI(),this._addEventListener()},e.prototype.onDisable=function(){gdk.Timer.clearAll(this),d.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListener=function(){var t={};t[d.EventNameEnum.REFRESH_STORY_REWARD]=this.initUI,d.EventUtil.registerEvents(t,this)},e.prototype._refresh=function(){this._initUI(!0)},e.prototype.initUI=function(t){void 0===t&&(t=!1);var e=this.node.getComponent(s),i=r.default.getInstance().getStoryTask();t?e.refreshCurList(i):e.refreshListData(i)},e=a([c,u("module/Activity/FixActivity/StoryRewardWindow")],e)}(o);i.default=h,cc._RF.pop()},{"./StoryRewardManager":"StoryRewardManager",OptimizeVerticalListView:void 0,PanelBase:void 0}],StoryTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"974b5NgNURB+bqbCRovvvbc","StoryTaskItem");var n=t("ListItem"),a=t("CommonIconWidget");cc.Class({extends:n,properties:{btnReceive:cc.Node,btnGo:cc.Node,imgReceived:cc.Node,taskName:cc.Label,richTextProgress:cc.RichText,imgLuxury:cc.Node,rewardPanel:cc.Node,progressLayout:cc.Layout},start:function(){},onDisable:function(){gdk.Timer.clear(this,this._addRewardIcon)},updateItem:function(t,e){this._super(t,e);var i=e.getId(),n=td.PveGeneralCopyManager.getGateModelByGateId(i);if(e.getState()===td.TaskStatus.Received)this.imgReceived.active=!0,this.btnGo.active=!1,this.btnReceive.active=!1;else{var a=td.PveGeneralCopyManager.getCurGateModel(),r=a.getPreGateId();0===r&&(r=a.getStroyId()-1);var o=td.PveGeneralCopyManager.getPreGateNumById(a.getStroyId()),s=td.PveGeneralCopyManager.getPreGateNumById(i)+1;r>=i?(this.btnGo.active=!1,this.btnReceive.active=!0,this.richTextProgress.string=cc.js.formatStr("<color=#00A808>%d</c><color=#00A808>/%d</color>",s,s)):(this.btnGo.active=!0,this.btnReceive.active=!1,this.richTextProgress.string=cc.js.formatStr("<color=#FC2E05>%d</c><color=#0A61A7>/%d</color>",o,s))}this.richTextProgress._updateRichText(),this.progressLayout.updateLayout(),this.taskName.string=td.Language.passStroyNum+n.getName(),this.imgLuxury.active=e.isLuxury(),this.imgLuxury.active?this.taskName.node.x=-246:this.taskName.node.x=-290,gdk.Timer.callLater(this,this._addRewardIcon)},_addRewardIcon:function(){var t=this._item,e=td.RewardManager.getRewardDetailArray(t.getReward());if(e.length>0)for(var i=0,n=e.length;i<n;i++){var r=e[i],o=this.rewardPanel.getChildByName("iconItem"+i);o||((o=td.GlobalFunction.createCommonIconWidget(26,r)).name="iconItem"+i,this.rewardPanel.addChild(o),o.scale=.8);var s=o.getComponent(a);s.setTouchEnabled(!0),s.setData(e[i])}},onGotoClicked:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_PveCopyGate)},onGetRewardClicked:function(){td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_RECEIVE_STORY_REWARD,this._item.getId())}}),cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],SummonManager:[function(t,e,i){"use strict";cc._RF.push(e,"dd53177PrVDbr2nPTjAGX9N","SummonManager");var n=t("SummonModel");td.SummonManager={_summonInfo:null,_curRequestId:null,_curRequestTimes:null,init:function(){this.destroyData(),this._addLocalListener(),this._addNetListener()},destroyData:function(){this._summonInfo=null,this._curRequestId=null,this._curRequestTimes=null},_addLocalListener:function(){var t=td.EventNameEnum,e={};e[t.REQUEST_SUMMON_INFO]=this._requestSummonInfo,e[t.REQUEST_SUMMON]=this._requestSummon,td.EventUtil.registerEvents(e,this)},_addNetListener:function(){var t=td.MsgModuleName.SUMMON,e=td.MsgCmd.SUMMON,i=td.ServerDelegate;i.registerMessage(t,e.GET_INFO,this._receiveSummonInfo.bind(this)),i.registerMessage(t,e.SUMMON,this._receiveSummonReturn.bind(this)),i.registerMessage(t,e.SUMMON_PUSH,this._receiveSummonPush.bind(this))},_createSummonData:function(){if(!this._summonInfo){this._summonInfo={};var t=td.GetTableClass(td.TableEnum.SummonTable).getSummonTable();for(var e in t){var i=t[e],a=new n;a.init(i),this._summonInfo[a.getType()]=a}}},getSummonData:function(){return this._createSummonData(),this._summonInfo},canFreeSummon:function(t){return!(!this._summonInfo||!this._summonInfo[t])&&this._summonInfo[t].getNextFreeTime()<=td.TimeUtil.getTime()},canItemSummon:function(t){if(!this._summonInfo||!this._summonInfo[t])return!1;var e=this._summonInfo[t].getNormalCost();return td.ItemManager.getItemNumById(e.getId())>=e.getCount()},_requestSummonInfo:function(t){var e={};e.module=td.MsgModuleName.SUMMON,e.cmd=td.MsgCmd.SUMMON.GET_INFO,td.ServerDelegate.sendMessage(e)},_receiveSummonInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._createSummonData();for(var i=e.gachaList,n=0,a=i.length-1;n<=a;n++){var r=i[n],o=this._summonInfo[r.id];o&&o.setData(r)}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_SUMMON_INFO)}},_requestSummon:function(t){var e={};e.module=td.MsgModuleName.SUMMON,e.cmd=td.MsgCmd.SUMMON.SUMMON,e.id=t.id,e.times=t.times,this._curRequestId=t.id,this._curRequestTimes=t.times,td.ServerDelegate.sendMessage(e)},_receiveSummonReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.gachaMap,n={},a=[],r=0;for(var o in i){for(var s,l=i[o],c=0,u=0,d=l.length-1;u<=d;u++){var h=l[u];h.id===td.ItemEnum.Gold&&(r+=h.count),h.type===td.RewardType.Equipment?(c++,(s=h).type=td.GoodsType.Type_Equip):h.type===td.RewardType.Mercenary?(c++,(s=h).type=td.GoodsType.Type_Mercenary):h.type===td.RewardType.Item?(c++,(s=h).type=td.GoodsType.Type_Item):h.type===td.RewardType.Gemstone?(c++,(s=h).type=td.GoodsType.Type_Gemstone):h.type===td.RewardType.Artifact&&(c++,(s=h).type=td.GoodsType.Type_Artifact)}a[a.length]=s,n[o]=c}var p={rewardList:a,summonId:this._curRequestId,critData:n,nTimes:this._curRequestTimes,goldCount:r};td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_SUMMON_RESULT,p)}},_receiveSummonPush:function(t,e){if(t===td.NetCode.SUCCESS){this._createSummonData();for(var i=e.gachaList,n=0,a=i.length-1;n<=a;n++){var r=i[n],o=this._summonInfo[r.id];o&&o.setData(r)}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_SUMMON_VIEW)}}},cc._RF.pop()},{SummonModel:"SummonModel"}],SummonModel:[function(t,e,i){"use strict";cc._RF.push(e,"09bd7Ty31dM3IHOAMh/rt4k","SummonModel");var n=cc.Class({_type:null,_baseRewards:null,_normalCost:null,_times:null,_totalTimes:null,_nextFreeTime:null,_disCount:null,init:function(t){this._type=t.id,t.baseRewards||(t.baseRewards=[]),this._baseRewards=[];for(var e=td.RewardManager,i=0,n=t.baseRewards.length-1;i<=n;i++)this._baseRewards[this._baseRewards.length]=e.getRewardDetail(t.baseRewards[i]);this._normalCost=e.getRewardDetail(t.normalCost),this._totalTimes=t.totalTimes,this._times=0,this._nextFreeTime=0,this._disCount=t.disCount},setData:function(t){this._times=t.times,this._nextFreeTime=t.nextFreeTime},getDiscount:function(){return this._disCount},getType:function(){return this._type},getRewards:function(){return this._baseRewards},getNormalCost:function(){return this._normalCost},getTimes:function(){return this._totalTimes-this._times},getNextFreeTime:function(){return this._nextFreeTime}});e.exports=n,cc._RF.pop()},{}],SummonTable:[function(t,e,i){"use strict";cc._RF.push(e,"7f161MZ6ORNoZZ2va7VKE+K","SummonTable");var n=t("BaseTable");cc.Class({extends:n,name:"SummonTable",properties:{_tblName:"gacha_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){for(var a=e[i],r=-1,o=0,s=a.rewardPools.length-1;o<=s;o++){var l=a.rewardPools[o][0];if(l>0){r=l;break}}delete a.rewardPools,a.totalTimes=r,t[a.id]=a}},getDataById:function(t){return this._data[t]},getSummonTable:function(){return this._data}});cc._RF.pop()},{BaseTable:"BaseTable"}],SuperGiftConfig:[function(t,e,i){"use strict";cc._RF.push(e,"e3753NQuxtCN4r54kgb03XV","SuperGiftConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"ActivitySuperGiftConfig",properties:{_tblName:"activity_super_gift_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]||(t[a.data]=[]),t[a.data].push(a)}},getSuperGiftConfigs:function(t){return this._data[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],SuperGiftController:[function(t,e,i){"use strict";cc._RF.push(e,"fff0e28WrJIzY04qJeY129X","SuperGiftController");var n=t("ActivityBaseController"),a=t("SuperGiftModel"),r=cc.Class({extends:n,properties:{_modelList:null,_isHide:null,_isFinish:null},initData:function(t){this._super(t),this.clearData(),this._isFinish=!0},onActivityOpen:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.Req_GET_ACTIVITY_INFO,this._activityId)},activityParse:function(t){var e=t.record.receiveMap;this._modelList&&0!==this._modelList.length||this._initSuperGift();var i=this._modelList;for(var n in e)for(var a=e[n=parseInt(n)],r=0,o=i.length;r<o;r++){var s=i[r];s.getId()===n&&s.setStatus(a)}td.EventUtil.dispatchEvent(td.EventNameEnum.RESP_SUPER_GIFT_INFO)},parseRewardReceived:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.RESP_SUPER_GIFT_RECEIVE)},_initSuperGift:function(){this._modelList=[];for(var t=td.GetTableClass(td.TableEnum.SuperGiftConfig).getSuperGiftConfigs(this.getActivityData()),e=0,i=t.length;e<i;e++){var n=t[e],r=new a;r.setData(n),this._modelList[e]=r}},clearData:function(){this._modelList=[]},getDataList:function(){return this._modelList&&0!==this._modelList.length||this._initSuperGift(),this._modelList},isAllGet:function(){for(var t=!0,e=0;e<this._modelList.length;e++)this._modelList[e].getStatus()!=td.ActivityEnum.SuperGiftEnum.CAN_Receive&&this._modelList[e].getStatus()!=td.ActivityEnum.SuperGiftEnum.CAN_NOT_Receive||(t=!1);return t},hasRedPoint:function(){return!0},redPointTip:function(){for(var t=0,e=this._modelList.length;t<e;t++){if(this._modelList[t].getStatus()===td.ActivityEnum.SuperGiftEnum.CAN_Receive)return!0}return!1},isFinish:function(){return this._isFinish},redPointEvts:function(){return[td.EventNameEnum.Recharge_Success,td.EventNameEnum.Res_GET_ACTIVITY_INFO,td.EventNameEnum.RESP_SUPER_GIFT_RECEIVE]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",SuperGiftModel:"SuperGiftModel"}],SuperGiftListView:[function(t,e,i){"use strict";cc._RF.push(e,"992dfBaWnlHYq6ftyrjpBg1","SuperGiftListView");var n=cc.Class({extends:cc.Component,_recharge:null,_id:null,setItemView:function(t){this._recharge=t.getRecharge(),this._id=t.getId();var e=this.node.getChildByName("btnOperation"),i=e.getChildByName("Label"),n=this.node.getChildByName("btnReceive"),a=this.node.getChildByName("imgReceived"),r=this.node.getChildByName("originPrice");this.node.getChildByName("labName").getComponent(cc.Label).string=t.getName(),r.getComponent(cc.Label).string=cc.js.formatStr(td.Language.OriginPrice,cc.js.formatStr(td.Language.rechargeCount,t.getOriginPrice())),i.getComponent(cc.Label).string=cc.js.formatStr(td.Language.rechargeCount,t.getRechargeForShow()),e.active=!1,n.active=!1,a.active=!1,t.getStatus()==td.ActivityEnum.SuperGiftEnum.CAN_Receive?n.active=!0:t.getStatus()==td.ActivityEnum.SuperGiftEnum.ALREADY_Receive?a.active=!0:t.getStatus()==td.ActivityEnum.SuperGiftEnum.CAN_NOT_Receive&&(e.active=!0),td.RedPointUtil.createRedPointSimple(n,{x:-10,y:-10},t.getStatus()==td.ActivityEnum.SuperGiftEnum.CAN_Receive);var o=this.node.getChildByName("rewardsPanel");o.removeAllChildren();for(var s=t.getRewards(),l=60,c=0,u=s.length;c<u;c++){var d=s[c],h=td.GlobalFunction.createCommonIconWidget(56,d);h.setPosition(cc.v2(l,0)),h.setScale(.8),o.addChild(h),l+=115}},doRechargeAction:function(){var t=td.RechargeManager.getRechargeDataById(this._recharge);t&&td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_RECHARGE,t)},doReceiveAction:function(){this._controller=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_16),this._controller.operateActivity({id:this._id})}});e.exports=n,cc._RF.pop()},{}],SuperGiftModel:[function(t,e,i){"use strict";cc._RF.push(e,"ff0d8a6uetGIYBBV31NjjQO","SuperGiftModel");var n=cc.Class({properties:{_id:null,_name:null,_chargeId:null,_originPrice:null,_rewards:null,_status:null},setData:function(t){this._data=t.data,this._id=t.id,this._name=t.nameDes,this._chargeId=t.chargeId,this._originPrice=t.oriPrice,this._rewards=td.RewardManager.parseRewardListDetail(t.rewards),this._status=td.ActivityEnum.SuperGiftEnum.CAN_NOT_Receive},getName:function(){return this._name},getId:function(){return this._id},getOriginPrice:function(){return this._originPrice},getRecharge:function(){return this._chargeId},getRechargeForShow:function(){var t=td.GetTableClass(td.TableEnum.ChargeCommodityConfig).getDataByChargeId(this._chargeId);return t?t.costValue/10:0},getRewards:function(){return this._rewards},getStatus:function(){return this._status},setStatus:function(t){this._status=t}});e.exports=n,cc._RF.pop()},{}],SuperGiftWindow:[function(t,e,i){"use strict";cc._RF.push(e,"500730yYRlFSK/BHiMHdqmn","SuperGiftWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{_controller:null,_activityType:null,_activityId:null,superGiftSV:cc.ScrollView},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_SuperGift},onLoad:function(){this._super(),this.refreshController(),this.initReward()},refreshController:function(){this._activityType=td.ActivityEnum.ActivityType.ACTIVITY_TYPE_16,this._controller=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.ACTIVITY_TYPE_16)},onEnable:function(){this._super(),this._addLocalListeners(),this._refreshListView(),this._initTime()},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this),this.unschedule(this.updateActivitySurplusTime)},initReward:function(){if(this._controller){for(var t=this._controller.getDataList(),e=this._root.getChildByName("item"),i=t.length,n=0;n<i;n++){var a=cc.instantiate(e);a.name="item"+n,a.active=!0,this.superGiftSV.content.addChild(a)}this.superGiftSV.content.getComponent(cc.Layout).updateLayout();var r=this.superGiftSV.content.getContentSize();r.height=e.height*i,this.superGiftSV.content.setContentSize(r),this.superGiftSV.scrollToTop(),e.active=!1}},_addLocalListeners:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.RESP_SUPER_GIFT_INFO]=this._refreshListView,i[e.RESP_SUPER_GIFT_RECEIVE]=this._refreshListView,i[e.Recharge_Success]=this._refreshListView,i[e.ON_ACTIVITY_CLOSED]=this._onActivityClose,i[e.ON_ACTIVITY_OPERATE_SUCCESS]=this.onReceiveOperation,t.registerEvents(i,this)},_onActivityClose:function(t){this._controller&&this._controller.getActivityId()===t&&this.closeCallFunc()},onReceiveOperation:function(t){if(t.activityId===this._controller.getActivityId()){var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);td.GlobalFunction.showRewards(i),this._controller.parseRewardReceived(t)}},_refreshListView:function(){if(this.refreshController(),this._controller)for(var t=this._controller.getDataList(),e=0;e<t.length;e++){var i=t[e],n=this.superGiftSV.content.getChildByName("item"+e);if(!n)return;n.getComponent("SuperGiftListView").setItemView(i)}},_initTime:function(){this.refreshController();var t=this._controller.getCurrentOpenStage();if(t){var e=new Date(t.openTime),i=new Date(t.closeTime),n=td.Language.timePattern5,a=td.Language.activityTimeTip1;a=cc.js.formatStr(a,e.pattern(n),i.pattern(n)),this._root.getChildByName("labTime").getComponent(cc.Label).string=a}},closeCallFunc:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.CLOSED_POP_WINDOW)}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],SuperVIPWindow:[function(t,e,i){"use strict";cc._RF.push(e,"fd2c7DZHxFHGpWB78PS90sl","SuperVIPWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window,o=r.td,s=cc._decorator,l=s.ccclass,c=s.property,u=(s.menu,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lab=null,e.img=null,e.window_node=null,e.imgEWM=null,e.flag=null,e}return n(e,t),e.prototype.init=function(){this._panelType=o.PanelType.Window,this._panelEnum=o.PanelEnum.Window_SuperVIP},e.prototype.setData=function(){if(t.prototype.setData.call(this),o.isNeedShowSuperVip()){var e=o.GetTableClass(o.TableEnum.ChannelInfoConfig).getChannelCfgByChannel(r.DX_CHANNEL,r.DX_CHANNEL_ID),i=e.vipQQ,n=e.vipSequre;this.lab.string=o.Language.SuperVIP_des+i+"</c>",o.GlobalFunction.createAltasSprite(o.resDef.pngPlist.Acitivty_43_cjvip,n,this.imgEWM),this.window_node.active=!1,this.flag.active=!o.Account.isShowSuperVipToDay()}else this.closeCallFunc()},e.prototype.onBtnOpenWindow=function(){this.window_node.active=!0},e.prototype.onBtnCloseWindoe=function(){this.window_node.active=!1},e.prototype.closeCallFunc=function(){t.prototype.closeCallFunc.call(this),o.Account.setHideAutoShow(this.flag.active),o.EventUtil.dispatchEvent(o.EventNameEnum.CLOSED_POP_WINDOW)},e.prototype.onBtnSelect=function(){var t=o.Account.isShowSuperVipToDay();o.Account.setHideAutoShow(t),this.flag.active=t},a([c(cc.RichText)],e.prototype,"lab",void 0),a([c(cc.Node)],e.prototype,"img",void 0),a([c(cc.Node)],e.prototype,"window_node",void 0),a([c(cc.Node)],e.prototype,"imgEWM",void 0),a([c(cc.Node)],e.prototype,"flag",void 0),e=a([l],e)}(t("PanelBase")));i.default=u,cc._RF.pop()},{PanelBase:void 0}],SystemManager:[function(t,e,i){"use strict";cc._RF.push(e,"f2409tOAudM9oNcmiQSlVqi","SystemManager"),td.SystemManager={_serverOpenDays:null,_settingList:null,_serverMaxLevel:null,_serverZoneNames:null,init:function(){this.destroyData(),this._addListener(),this._addEventListener()},destroyData:function(){this._serverOpenDays=0,this._settingList={},this._serverMaxLevel=0,this._serverZoneNames={}},_addEventListener:function(){var t=td.EventNameEnum,e={};e[t.REQUEST_SERVER_SETTING]=this._requestServerSetting,e[t.REQUEST_SERVER_START_DAYS]=this._requestServerOpenDays,e[t.REQ_GET_SERVER_MAX_LEVEL]=this._requestServerMaxLevel,e[t.REQ_GET_SERVER_ZONE_NAME]=this._requestServerZoneName,td.EventUtil.registerEvents(e,this)},_addListener:function(){var t=td.MsgModuleName.SYSTEM,e=td.MsgCmd.SYSTEM,i=td.ServerDelegate;i.registerMessage(t,e.GET_SETTING,this._receiveServerSetting.bind(this)),i.registerMessage(t,e.GET_SERVER_START_DAYS,this._receiveServerStartDays.bind(this)),i.registerMessage(t,e.PUSH_SERVER_START_DAYS,this._receiveServerStartDays.bind(this)),i.registerMessage(t,e.GET_SERVER_MAX_LEVEL,this._receiveServerMaxLevel.bind(this)),i.registerMessage(t,e.GET_SERVER_ZONE_NAME,this._onGetServerZoneName.bind(this)),i.registerMessage(t,e.PUSH_SERVER_MAX_LEVEL,this._receiveServerMaxLevel.bind(this)),i.registerMessage(t,e.PUSH_SETTING,this._pushServerSetting.bind(this))},getServerOpenDays:function(){return this._serverOpenDays},getServerMaxLevel:function(){return this._serverMaxLevel},getServerOpenTime:function(){return this._settingList[td.ServerSettingKey.SERVER_START_TIME]},getSettingByKey:function(t){return this._settingList&&this._settingList[t]?this._settingList[t]:null},getServerZoneNameByZoneId:function(t){return this._serverZoneNames&&this._serverZoneNames[t]?this._serverZoneNames[t]:""},_requestServerSetting:function(t){"number"==typeof t&&(t=[t]);var e={};e.module=td.MsgModuleName.SYSTEM,e.cmd=td.MsgCmd.SYSTEM.GET_SETTING,e.keys=t,td.ServerDelegate.sendMessage(e)},_receiveServerSetting:function(t,e){t===td.NetCode.SUCCESS&&(this._settingList=e.value,td.EventUtil.dispatchEvent(td.EventNameEnum.ON_GET_SERVER_SETTING,e))},_pushServerSetting:function(t,e){if(t===td.NetCode.SUCCESS){this._settingList||(this._settingList={});var i=e.value;for(var n in i)this._settingList[n]=i[n];td.EventUtil.dispatchEvent(td.EventNameEnum.ON_GET_SERVER_SETTING,e)}},_requestServerOpenDays:function(){var t={};t.module=td.MsgModuleName.SYSTEM,t.cmd=td.MsgCmd.SYSTEM.GET_SERVER_START_DAYS,td.ServerDelegate.sendMessage(t)},_receiveServerStartDays:function(t,e){t===td.NetCode.SUCCESS&&(this._serverOpenDays||td.EventUtil.dispatchEvent(td.EventNameEnum.ON_LOGIN_SERVER_OPEN_DATA_RETURN),this._serverOpenDays=e.days,td.EventUtil.dispatchEvent(td.EventNameEnum.ON_GET_SERVER_START_DAYS,e),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_TIME_OVER_DAY))},_requestServerMaxLevel:function(){var t={};t.module=td.MsgModuleName.SYSTEM,t.cmd=td.MsgCmd.SYSTEM.GET_SERVER_MAX_LEVEL,td.ServerDelegate.sendMessage(t)},_receiveServerMaxLevel:function(t,e){t===td.NetCode.SUCCESS&&(this._serverMaxLevel=e.level,td.EventUtil.dispatchEvent(td.EventNameEnum.RES_GET_SERVER_MAX_LEVEL,e))},_requestServerZoneName:function(){var t={};t.module=td.MsgModuleName.SYSTEM,t.cmd=td.MsgCmd.SYSTEM.GET_SERVER_ZONE_NAME,td.ServerDelegate.sendMessage(t)},_onGetServerZoneName:function(t,e){t===td.NetCode.SUCCESS&&(this._serverZoneNames=e.names,td.EventUtil.dispatchEvent(td.EventNameEnum.ON_GET_SERVER_ZONE_NAME))}},cc._RF.pop()},{}],TDBoot:[function(t,e,i){"use strict";cc._RF.push(e,"98346IOZQRLEIZn1P+0AmAO","TDBoot");var n=$(t("../Treasure/Manager/TreasureManger")),a=$(t("../Hero/Manager/HeroManager")),r=$(t("../Equip/Manager/EquiptManager")),o=$(t("../Smelt/Manager/SmeltManager")),s=$(t("../DestroyTemple/Manager/DestroyTempleManager")),l=$(t("../Shop/Manager/ShopManager")),c=$(t("../Gem/Manager/GemstoneManager")),u=$(t("../Nation/Manager/NationManagerHandler")),d=$(t("../Gacha/Manager/GachaManager")),h=$(t("../Roam/Manager/RoamManager")),p=$(t("../Chat/Manager/ChatManager")),_=$(t("../Babel/Manager/BabelManager")),g=$(t("../CrossCup/Manager/CrossCupManager")),f=$(t("../StarUpRoad/Manager/StarUpRoadManager")),v=$(t("../Pagoda/Manager/PagodaManager")),m=$(t("../Rank/Manager/RankManager")),y=$(t("../OtherBattleArray/Manager/OtherBattleArrayManager")),E=$(t("../Manual/Manager/ManualManager")),T=$(t("../Immortal/Manager/ImmortalManager")),C=$(t("../Endless/Manager/EndlessManager")),R=$(t("../Pulse/Manager/PulseManager")),S=$(t("../WorldBoss/Manager/WholeBossManager")),I=$(t("../WorldBoss/Manager/WorldBossManager")),A=$(t("../FlashGifts/Manager/FlashGiftsManager")),b=$(t("../Nation/Manager/GodFurnaceManager")),P=$(t("../OnlineReward/Manager/OnlineRewardManager")),N=$(t("../Activity/ActivityFixed/StoryReward/StoryRewardManager")),M=$(t("../LimitGift/Manager/LimitGiftManager")),L=$(t("../LifeCardReward/Manager/LifeCardRewardManager")),D=$(t("../AncientCorridor/Manager/AncientCorridorManager")),B=$(t("../Dipper/Manager/DipperManager")),w=$(t("../WonderlandAdventure/Manager/WonderlandManager")),O=$(t("../CrossArena/Manager/CrossArenaManager")),F=$(t("../Nation/Manager/NationBeastManager")),G=$(t("../Nation/Manager/NationDuelManager")),k=$(t("../HeroArtifact/Manager/HeroArtifactManager")),U=$(t("../Title/Manager/TitleManger")),H=$(t("../Legend/Manager/LegendManager")),x=$(t("../EightDiagrams/Manager/EightDiagramsManager")),V=$(t("../Spirit/Manager/SpiritManger")),W=$(t("../Pet/Manager/PetManager")),j=$(t("../Maze/Manager/MazeManager")),Y=$(t("../Chess/Manager/ChessManager")),q=$(t("../DivinePosition/Manager/DivinePositionManager")),K=$(t("../Auction/Manager/AuctionManager")),Q=$(t("../Camp/Manager/CampManager")),z=$(t("../Nation/Manager/ScuffleYamaManager")),J=$(t("../PveCopyBible/Manager/PveCopyBibleManager")),Z=$(t("../EvilGodCopy/Mananger/EvilGodManager")),X=$(t("../QQMoxie/Manager/QQMoxieManager"));function $(t){return t&&t.__esModule?t:{default:t}}var tt=t("NodePoolManager");t("PvpFightManager");td.TDBoot={isTest:!1,initData:function(){td.ServerDelegate.init(),td.LoginManager.init(),td.Account.init(),td.TableManager.init(),td.ItemManager.init(),td.MailManager.init(),td.ArenaManager.init(),td.BattleArrayManager.init(),td.PartnershipManager.init(),y.default.getInstance().init(),td.PvpFightManager.init(),td.LoadingLayerManager.init(),C.default.getInstance().init(),td.ActivityDataManager.init(),td.ActivityPanelManager.init(),td.PrerogativeManager.init(),td.PveCopyManager.init(),td.PveGeneralCopyManager.init(),td.UnlockManager.init(),td.TaskManager.init(),u.default.getInstance().init(),m.default.getInstance().init(),p.default.getInstance().init(),_.default.getInstance().init(),g.default.getInstance().init(),H.default.getInstance().init(),x.default.getInstance().init(),td.GuideManager.init(),td.VipManager.init(),td.RechargeManager.init(),td.MaterailCopyManager.init(),td.TechnologyManager.init(),td.FriendManager.init(),td.AvatarShowSettingManager.init(),td.SystemManager.init(),n.default.getInstance().init(),a.default.getInstance().init(),r.default.getInstance().init(),o.default.getInstance().init(),s.default.getInstance().init(),td.MagicRecordManager.init(),td.FunctionPreviewManager.init(),c.default.getInstance().init(),d.default.getInstance().init(),h.default.getInstance().init(),f.default.getInstance().init(),v.default.getInstance().init(),E.default.getInstance().init(),td.RedPacketManager.init(),T.default.getInstance().init(),tt.init(),td.TaskListManager.init(),R.default.getInstance().init(),S.default.getInstance().init(),I.default.getInstance().init(),A.default.getInstance().init(),b.default.getInstance().init(),P.default.getInstance().init(),M.default.getInstance().init(),N.default.getInstance().init(),L.default.getInstance().init(),l.default.getInstance().init(),td.DemonTreasureCopyManager.init(),td.UIStateManager.init(),td.LocalStorageUtil.init(),D.default.getInstance().init(),B.default.getInstance().init(),w.default.getInstance().init(),O.default.getInstance().init(),F.default.getInstance().init(),G.default.getInstance().init(),k.default.getInstance().init(),U.default.getInstance().init(),V.default.getInstance().init(),W.default.getInstance().init(),j.default.getInstance().init(),Y.default.getInstance().init(),td.HeroRepayBaseController.init(),td.HeroRepayController.init(),td.HeroRepayController2.init(),q.default.getInstance().init(),K.default.getInstance().init(),z.default.getInstance().init(),Q.default.getInstance().init(),J.default.getInstance().init(),Z.default.getInstance().init(),X.default.getInstance().init()},destroyData:function(){td.Account.destroyData(),td.LocalStorageUtil.clearUserData(),td.ItemManager.destroyData(),td.MailManager.destroyData(),td.LoginManager.destroyData(),td.BattleArrayManager.destroyData(),y.default.getInstance().destroyData(),td.PvpFightManager.destroyData(),td.ActivityDataManager.destroyData(),td.ActivityPanelManager.destroyData(),td.PrerogativeManager.destroyData(),td.PveGeneralCopyManager.resetChapterData(),td.UnlockManager.destroyData(),td.TaskManager.destroyData(),u.default.getInstance().destroyData(),td.SystemManager.destroyData(),m.default.getInstance().destroyData(),p.default.getInstance().destroyData(),_.default.getInstance().destroyData(),g.default.getInstance().destroyData(),H.default.getInstance().destroyData(),x.default.getInstance().destroyData(),td.GuideManager.destroyData(),td.RechargeManager.destroyData(),td.VipManager.destroyData(),td.FriendManager.destroyData(),td.MaterailCopyManager.destroyData(),td.TechnologyManager.destroyData(),td.AvatarShowSettingManager.destroyData(),td.LoadingLayerManager.destroyData(),n.default.getInstance().destroyData(),a.default.getInstance().destroyData(),r.default.getInstance().destroyData(),o.default.getInstance().destroyData(),s.default.getInstance().destroyData(),td.MagicRecordManager.destroyData(),td.FunctionPreviewManager.destroyData(),l.default.getInstance().destroyData(),c.default.getInstance().destroyData(),d.default.getInstance().destroyData(),h.default.getInstance().destroyData(),f.default.getInstance().destroyData(),v.default.getInstance().destroyData(),E.default.getInstance().destroyData(),td.RedPacketManager.destroyData(),T.default.getInstance().destroyData(),C.default.getInstance().destroyData(),tt.destroyData(),R.default.getInstance().destroyData(),S.default.getInstance().destroyData(),I.default.getInstance().destroyData(),A.default.getInstance().destroyData(),b.default.getInstance().destroyData(),P.default.getInstance().destroyData(),N.default.getInstance().destroyData(),M.default.getInstance().destroyData(),L.default.getInstance().destroyData(),td.DemonTreasureCopyManager.destroyData(),td.UIStateManager.destroyData(),td.LocalStorageUtil.destroyData(),D.default.getInstance().destroyData(),B.default.getInstance().destroyData(),w.default.getInstance().destroyData(),O.default.getInstance().destroyData(),F.default.getInstance().destroyData(),G.default.getInstance().destroyData(),k.default.getInstance().destroyData(),U.default.getInstance().destroyData(),V.default.getInstance().destroyData(),W.default.getInstance().destroyData(),j.default.getInstance().destroyData(),Y.default.getInstance().destroyData(),td.HeroRepayBaseController.destroyData(),td.HeroRepayController.destroyData(),td.HeroRepayController2.destroyData(),q.default.getInstance().destroyData(),K.default.getInstance().destroyData(),z.default.getInstance().destroyData(),Z.default.getInstance().destroyData(),X.default.getInstance().destroyData()}},cc._RF.pop()},{"../Activity/ActivityFixed/StoryReward/StoryRewardManager":"StoryRewardManager","../AncientCorridor/Manager/AncientCorridorManager":"AncientCorridorManager","../Auction/Manager/AuctionManager":"AuctionManager","../Babel/Manager/BabelManager":"BabelManager","../Camp/Manager/CampManager":"CampManager","../Chat/Manager/ChatManager":"ChatManager","../Chess/Manager/ChessManager":"ChessManager","../CrossArena/Manager/CrossArenaManager":"CrossArenaManager","../CrossCup/Manager/CrossCupManager":"CrossCupManager","../DestroyTemple/Manager/DestroyTempleManager":"DestroyTempleManager","../Dipper/Manager/DipperManager":"DipperManager","../DivinePosition/Manager/DivinePositionManager":"DivinePositionManager","../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager","../Endless/Manager/EndlessManager":"EndlessManager","../Equip/Manager/EquiptManager":"EquiptManager","../EvilGodCopy/Mananger/EvilGodManager":"EvilGodManager","../FlashGifts/Manager/FlashGiftsManager":"FlashGiftsManager","../Gacha/Manager/GachaManager":"GachaManager","../Gem/Manager/GemstoneManager":"GemstoneManager","../Hero/Manager/HeroManager":"HeroManager","../HeroArtifact/Manager/HeroArtifactManager":"HeroArtifactManager","../Immortal/Manager/ImmortalManager":"ImmortalManager","../Legend/Manager/LegendManager":"LegendManager","../LifeCardReward/Manager/LifeCardRewardManager":"LifeCardRewardManager","../LimitGift/Manager/LimitGiftManager":"LimitGiftManager","../Manual/Manager/ManualManager":"ManualManager","../Maze/Manager/MazeManager":"MazeManager","../Nation/Manager/GodFurnaceManager":"GodFurnaceManager","../Nation/Manager/NationBeastManager":"NationBeastManager","../Nation/Manager/NationDuelManager":"NationDuelManager","../Nation/Manager/NationManagerHandler":"NationManagerHandler","../Nation/Manager/ScuffleYamaManager":"ScuffleYamaManager","../OnlineReward/Manager/OnlineRewardManager":"OnlineRewardManager","../OtherBattleArray/Manager/OtherBattleArrayManager":"OtherBattleArrayManager","../Pagoda/Manager/PagodaManager":"PagodaManager","../Pet/Manager/PetManager":"PetManager","../Pulse/Manager/PulseManager":"PulseManager","../PveCopyBible/Manager/PveCopyBibleManager":"PveCopyBibleManager","../QQMoxie/Manager/QQMoxieManager":"QQMoxieManager","../Rank/Manager/RankManager":"RankManager","../Roam/Manager/RoamManager":"RoamManager","../Shop/Manager/ShopManager":"ShopManager","../Smelt/Manager/SmeltManager":"SmeltManager","../Spirit/Manager/SpiritManger":"SpiritManger","../StarUpRoad/Manager/StarUpRoadManager":"StarUpRoadManager","../Title/Manager/TitleManger":"TitleManger","../Treasure/Manager/TreasureManger":"TreasureManger","../WonderlandAdventure/Manager/WonderlandManager":"WonderlandManager","../WorldBoss/Manager/WholeBossManager":"WholeBossManager","../WorldBoss/Manager/WorldBossManager":"WorldBossManager",NodePoolManager:void 0,PvpFightManager:"PvpFightManager"}],TableData:[function(t,e,i){"use strict";var n;cc._RF.push(e,"93ebdwzM1RL2J+dbpRBoKup","TableData"),td.TableEnum=((n={HeroTable:1,Item:2,LanguageTable:3,PveHeroFihgtShowTable:4,PveEnemyTable:5,PveBulletTable:6,PveCreateEnemyTable:7,Config:8,Monster:9,Skill:10,SkillEffect:11,PvpFightShow:12,PveSkillTable:13,PveLoveConfigTable:14,PveLoveSkillTable:15,PveGeneralCopyChapterTable:16,PveGeneralCopyGateTable:17,ReinforcementConfig:23,ActorUnlock:26,SoulWare:27,Compose:28,Broadcast:29,ResourceSize:30,ShopShowTable:31,ShopGoodsTable:32,VipTable:37,VipPrivilegeTable:38,UpgradeTipsTable:39,UserLevelTable:40,SummonTable:41,ArenaRankRewardConfig:42,ArenaRankUpgradeRewardConfig:43}).UserLevelTable=44,n.NetErrorTips=45,n.TaskTable=46,n.GemstoneTable=48,n.GemstoneUpgradeTable=49,n.GemstoneAdvanceTable=50,n.GemstoneAdvanceResetTable=51,n.NationRecordTable=52,n.NationLevelTable=53,n.NationDonateTable=54,n.NationEndlessTable=55,n.NationDungeonTable=56,n.MonsterGroup=57,n.HuntTreasureTable=58,n.ChatConfig=59,n.AvatarConfig=60,n.EnterBtnConfigTable=63,n.NationSciTechLevelConfig=65,n.NationSciTechTypeTable=66,n.NationBossConfig=69,n.NationBossActorScoreRankRewardConfig=70,n.SiegeCityConfig=71,n.SiegeCityDefenceConfig=72,n.NationBossNationScoreRankRewardConfig=73,n.NationBossScoreTaskConfig=74,n.KDDamageRewardTable=75,n.KDLevelRewardTable=76,n.KDRankRewardTable=79,n.DecomposeConfig=80,n.GuideTable=88,n.EntryTable=89,n.ChargeCommodityConfig=90,n.SignInConfig=91,n.HelpDesTable=102,n.Sound=103,n.HeroEvolveExtraAttrConfig=104,n.ManualTable=107,n.FunctionPreviewConfig=109,n.GameTips=115,n.ActivityShowFixedTable=1e3,n.ActivityShowConfigTable=1001,n.SingleRechargeTable=1002,n.AddUpRechargeTable=1003,n.VipGiftTable=1004,n.GoldTreasureTable=1005,n.GrowthPlanTable=1006,n.FamousGeneralShopTable=1007,n.LuckyTurntableTable=1008,n.LuckyScoreRewardTable=1009,n.DailyPreferentialTable=1010,n.ContinuousRechargeTable=1014,n.ActivityGachaTable=1015,n.VipWelfareConfig=1019,n.TreasureGiftOpenTable=1025,n.TreasureGiftOpenRewardTable=1026,n.StarDiamondTable=1027,n.FundCardTable=1028,n.MultpleFirstRechargeTable=1029,n.GroupPurchaseTable=1030,n.MonthCardTable=1031,n.VipDesTable=1032,n.GrowthPlanRewardTable=1033,n.FestivalActivityTable=1034,n.FestivalStoreTable=1035,n.GoldHeroBackBuyTable=1036,n.HeroRepayTable=1037,n.HeroRepayRewardTable=1038,n.MonthCardRenewalTable=1039,n.MaterailCopyEntryTable=2e3,n.MaterialCopyConfig=2001,n.MaterialCopyTypeConfig=2002,n.TechnologyTable=2003,n.TechnologyLevelTable=2004,n.TechnologyAdvanceTable=2005,n.ObtainWay=2007,n.OperationTypeTable=2008,n.FerroTurntableConfig=2009,n.LiveShowConfigTable=2010,n.TreasureTable=2011,n.TreasureLevelUpTable=2012,n.TreasureEvolveTable=2013,n.TreasureStarUpTable=2014,n.SpecialEffectTable=2015,n.ModelShowTable=2016,n.HeroLevelUpTable=2020,n.HeroBreakoutTable=2021,n.HeroCultivateTable=2022,n.HeroStarUpTable=2023,n.HeroEvolveTable=2024,n.EquipmentTable=2025,n.EquipmentEvolveTable=2026,n.EquipmentReinforceTable=2027,n.EquipmentGroupTable=2028,n.EquipmentStarTable=2030,n.EquipmentForgeTable=2031,n.HeroRuneTable=2032,n.ResonateTable=2033,n.SpecialAttributeTable=2034,n.DestroyTempleTable=2035,n.MagicRecordTable=2036,n.MagicRecordRewardTable=2037,n.StoreRefreshTable=2038,n.GachaTable=2039,n.RoamProgressConfig=2041,n.AboreTipsTable=2042,n.StarUpRoadChapterTable=2043,n.StarUpRoadTable=2044,n.CampaignNotifyConfig=2045,n.PreLoadConfig=2046,n.CarnivalTypeConfig=2047,n.CarnivalDiscountConfig=2048,n.ImmortalConfig=2049,n.ImmortalInviteConfig=2050,n.ImmortalVisitEventConfig=2051,n.ImmortalVisitConfig=2052,n.PagodaConfig=2053,n.EndlessRewardTable=2054,n.EndlessTable=2055,n.StoryAreaConfig=2056,n.EquipmentForgeEffectTable=2057,n.TreasureEvolveEffectTable=2058,n.LineupRecommendTable=2059,n.AccumulatedRechargeTable=2060,n.DrawEnergyConfig=2061,n.MainPopupTable=2062,n.LuckyErnieTable=2063,n.ScenesTextConfig=2064,n.DestroyTempleEffectConfig=2065,n.RushRankTable=2066,n.SuperGiftConfig=2067,n.PurpleFairylandTable=2068,n.PurpleFairylandPulseTable=2069,n.PulseRankRewardConfig=2070,n.PurpleFairylandAdditionTable=2071,n.DestroyTempleRankRewardConfig=2072,n.FunctionSecretaryConfig=2073,n.WholeBossConfig=2074,n.WorldBossTable=2075,n.WorldBossRankRewardTable=2076,n.WholeAttendStoreConfig=2077,n.WholeAttendConfig=2078,n.RoamRewardEventTable=2079,n.ActivityLoginDayGiftConfig=2080,n.LevelGiftTable=2081,n.GodFurnaceTable=2082,n.GodFurnaceRankTable=2083,n.LimitedTimeStoreTable=2084,n.HeroPvpPreview=2085,n.LoginGiftConfig=2086,n.GodEquipmentBuyConfig=2087,n.ActivityGachaConfig=2088,n.DragonBossTable=2089,n.ContinuousTotalRechargeTable=2090,n.FlashGiftTable=2091,n.OnlineRewardConfig=2092,n.StoryRewardTable=2093,n.LimitGiftTable=2094,n.ActivityTurnTableConfig=2095,n.ActivityTurnTableBuyConfig=2096,n.ActivityTurnTableTimesRewardConfig=2097,n.PveMonsterSpeakTable=2098,n.FortuneCatTable=2099,n.FortuneCatShopTable=2100,n.AncientCorridorTable=2101,n.AncientCorridorRankTable=2102,n.DemonTreasureCopyConfig=2103,n.DemonTreasureRankRewardTable=2104,n.RechargeRankTable=2106,n.WonderlandConfigTable=2107,n.TitleTable=2109,n.ActivityTokenRankConfig=2110,n.ActivityTokenConfig=2111,n.ActivityPopupWindowConfig=2112,n.HeavenConfig=2120,n.HeavenTurntableConfig=2121,n.HeavenTurntableRechargeConfig=2122,n.DipperStoryConfig=2123,n.DipperScoreRewardConfig=2124,n.DipperDifficultConfig=2125,n.MainStoryTable=2126,n.ChallengeMonsterTable=2127,n.ChallengeMonsterRankTable=2128,n.CrossArenaTable=2130,n.GemAwakenConfig=2131,n.NationBeastTable=2132,n.NationBeastFoodTable=2133,n.ActivityForecastTable=2140,n.CarnivalScoreConfig=2141,n.IntensifyPowerTable=2142,n.IntensifyTable=2143,n.HeroArtifactTable=2144,n.HeroArtifactStrengthenTable=2145,n.HeroArtifactEvolveTable=2146,n.ActivityCollectWordConfig=2147,n.GoddessBoxTable=2150,n.GoddessStoreTable=2151,n.TowerMasterTable=2152,n.ConsumeActivityTable=2153,n.HeroCultivateAttributeTable=2154,n.MonsterTypeConfig=2155,n.MonsterCapabilityConfig=2156,n.FirecrackerTable=2157,n.FirecrackerCostTable=2158,n.FirecrackerRechargeTable=2159,n.MobilizationTable=2160,n.FestivalTable=2169,n.BabelConfig=2170,n.BabelHeroConfig=2171,n.CrossCupRewardConfig=2172,n.CrossCupBetConfig=2173,n.NewGachaTable=2161,n.TimeLimitGachaTable=2162,n.TimeLimitGachaRankTable=2163,n.MonopolyTable=2165,n.MonopolyProgressTable=2166,n.MonopolyStoreTable=2167,n.DoubleDropTable=2168,n.NationDuelCampConfig=2180,n.NationDuelOffensiveStarConfig=2181,n.NationDuelRankRewardConfig=2182,n.LegendSeasonRankRewardTable=2190,n.LegendDailyRewardTable=2191,n.LegendSeasonRewardTable=2192,n.LegendDanTable=2193,n.SpiritTable=2222,n.SpiritReinforceTable=2223,n.SpiritStarTable=2224,n.SpiritTalentTable=2225,n.SpiritManualTable=2226,n.ActivityCoustomGiftTable=2230,n.ActivityCoustomGiftPoolTable=2231,n.EightDiagramsTable=2232,n.EightDiagramChapterTable=2233,n.EightDiagramsLimitTable=2234,n.RoamConfigTable=2235,n.PetTable=2240,n.PetStationTable=2241,n.PetAptitudeTable=2242,n.PetLevelUpTable=2243,n.PetStarUpTable=2244,n.PetManualTable=2245,n.MazeEffectConfig=2250,n.MazeHeroConfig=2251,n.MazeHeroPoolConfig=2252,n.MazeRobotConfig=2253,n.MazeStoryConfig=2254,n.MazeScoreRewardConfig=2255,n.ActivityConvertConfig=2256,n.ActivityDiamondRebateConfig=2257,n.RichmanDayTaskTable=2258,n.RichmanTurntableTaskTable=2259,n.RichmanTurntableCostTable=2260,n.RichmanTurntableRewardTable=2261,n.ChannelInfoConfig=2262,n.BirdBridgeBlessProgressTable=2263,n.BirdBridgeRankTable=2264,n.ChessGradeTable=2270,n.ChessRankRewardTable=2271,n.ChessSkillTable=2272,n.ChessFloorTable=2273,n.ChessLevelTable=2274,n.ChessHeroTable=2275,n.DivinePositionConfig=2276,n.AuctionPlayTypeTable=2277,n.AuctionItemTable=2278,n.ScuffleYamaChallengeRewardTable=2280,n.CampAttributeTable=2281,n.Double11FundConfig=2282,n.Double11ProductConfig=2283,n.Double11KillConfig=2284,n.Double11ShopConfig=2285,n.Double11PreviewConfig=2286,n.Double11RankConfig=2287,n.Double11IntegralConfig=2288,n.SpecialPackageConfig=2289,n.ScuffleYamaRankRecordConfig=2290,n.EvilGodChapterTable=2291,n.EvilGodGateTable=2292,n.EvilGodBossTable=2293,n.EvilGodRankRewardTable=2294,n.MoXieLoginRedEnvelopeConfig=2295,n.MoXieCashRedEnvelopeConfig=2296,n),td.TableCls={1:t("HeroTable"),2:t("ItemTable"),3:t("LanguageTable"),4:t("PveHeroFihgtShowTable"),5:t("PveEnemyTable"),6:t("PveBulletTable"),7:t("PveCreateEnemyTable"),8:t("ConfigTable"),9:t("MonsterTable"),10:t("SkillTable"),11:t("SkillEffectTable"),12:t("MercenaryFightShowTable"),13:t("PveSkillTable"),14:t("PveLoveConfigTable"),15:t("PveLoveSkillTable"),16:t("PveGeneralCopyChapterTable"),17:t("PveGeneralCopyGateTable"),23:t("MercenaryReinforcementConfig"),26:t("ActorUnlockTable"),27:t("SoulWareTable"),28:t("ComposeTable"),29:t("BroadcastTable"),30:t("ResourceSizeTable"),31:t("ShopShowTable"),32:t("ShopGoodsTable"),37:t("VipTable"),38:t("VipPrivilegeTable"),39:t("UpgradeTipsTable"),40:t("UserLevelTable"),41:t("SummonTable"),42:t("ArenaRankRewardConfig"),43:t("ArenaRankUpgradeRewardConfig"),44:t("UserLevelTable"),45:t("NetErrorTips"),46:t("TaskTable"),48:t("GemstoneTable"),49:t("GemstoneUpgradeTable"),50:t("GemstoneAdvanceTable"),51:t("GemstoneAdvanceResetTable"),52:t("NationRecordTable"),53:t("NationLevelTable"),54:t("NationDonateTable"),55:t("NationEndlessTable"),56:t("NationDungeonTable"),57:t("MonsterGroupConfig"),58:t("HuntTreasureTable"),59:t("ChatConfig"),60:t("AvatarConfig"),63:t("EnterBtnConfigTable"),65:t("NationSciTechLevelConfig"),66:t("NationSciTechTypeTable"),69:t("NationBossConfig"),70:t("NationBossActorScoreRankRewardConfig"),71:t("SiegeCityConfig"),72:t("SiegeCityDefenceConfig"),73:t("NationBossNationScoreRankRewardConfig"),74:t("NationBossScoreTaskConfig"),75:t("KDDamageRewardTable"),76:t("KDLevelRewardTable"),79:t("KDRankRewardTable"),80:t("DecomposeConfig"),88:t("GuideTable"),89:t("EntryTable"),90:t("ChargeCommodityConfig"),91:t("SignInConfig"),102:t("HelpDesTable"),103:t("SoundTable"),104:t("HeroEvolveExtraAttrConfig"),107:t("ManualTable"),109:t("FunctionPreviewConfig"),115:t("GameTipsTable"),1000:t("ActivityShowFixedTable"),1001:t("ActivityShowConfigTable"),1002:t("SingleRechargeTable"),1003:t("AddUpRechargeTable"),1004:t("VipGiftTable"),1005:t("GoldTreasureTable"),1006:t("GrowthPlanTable"),1007:t("FamousGeneralShopTable"),1008:t("LuckyTurntableTable"),1009:t("LuckyScoreRewardTable"),1010:t("DailyPreferentialTable"),1014:t("ContinuousRechargeTable"),1015:t("ActivityGachaTable"),1019:t("VipWelfareConfig"),1025:t("TreasureGiftOpenTable"),1026:t("TreasureGiftOpenRewardTable"),1027:t("StarDiamondTable"),1028:t("FundCardTable"),1029:t("MultpleFirstRechargeTable"),1030:t("GroupPurchaseTable"),1031:t("MonthCardTable"),1032:t("VipDesTable"),1033:t("GrowthPlanRewardTable"),1034:t("FestivalActivityTable"),1035:t("FestivalStoreTable"),1036:t("GoldHeroBackBuyTable"),1037:t("HeroRepayTable"),1038:t("HeroRepayRewardTable"),1039:t("MonthCardRenewalTable"),2000:t("MaterailCopyEntryTable"),2001:t("MaterialCopyConfig"),2002:t("MaterialCopyTypeConfig"),2003:t("TechnologyTable"),2004:t("TechnologyLevelTable"),2005:t("TechnologyAdvanceTable"),2007:t("ObtainWayTable"),2008:t("OperationTypeTable"),2009:t("FerroTurntableConfig"),2010:t("LiveShowConfigTable"),2011:t("TreasureTable"),2012:t("TreasureLevelUpTable"),2013:t("TreasureEvolveTable"),2014:t("TreasureStarUpTable"),2015:t("SpecialEffectTable"),2016:t("ModelShowTable"),2020:t("HeroLevelUpTable"),2021:t("HeroBreakoutTable"),2022:t("HeroCultivateTable"),2023:t("HeroStarUpTable"),2024:t("HeroEvolveTable"),2025:t("EquipmentTable"),2026:t("EquipmentEvolveTable"),2027:t("EquipmentReinforceTable"),2028:t("EquipmentGroupTable"),2030:t("EquipmentStarTable"),2031:t("EquipmentForgeTable"),2032:t("HeroRuneTable"),2033:t("ResonateTable"),2034:t("SpecialAttributeTable"),2035:t("DestroyTempleTable"),2036:t("MagicRecordTable"),2037:t("MagicRecordRewardTable"),2038:t("StoreRefreshTable"),2039:t("GachaTable"),2041:t("RoamProgressConfig"),2042:t("AboreTipsTable"),2043:t("StarUpRoadChapterTable"),2044:t("StarUpRoadTable"),2045:t("CampaignNotifyConfig"),2046:t("PreLoadConfig"),2047:t("CarnivalTypeConfig"),2048:t("CarnivalDiscountConfig"),2049:t("ImmortalConfig"),2050:t("ImmortalInviteConfig"),2051:t("ImmortalVisitEventConfig"),2052:t("ImmortalVisitConfig"),2053:t("PagodaConfig"),2054:t("EndlessRewardTable"),2055:t("EndlessTable"),2056:t("StoryAreaConfig"),2057:t("EquipmentForgeEffectTable"),2058:t("TreasureEvolveEffectTable"),2059:t("LineupRecommendTable"),2060:t("AccumulatedRechargeTable"),2061:t("DrawEnergyConfig"),2062:t("MainPopupTable"),2063:t("LuckyErnieTable"),2064:t("ScenesTextConfig"),2065:t("DestroyTempleEffectConfig"),2066:t("RushRankTable"),2067:t("SuperGiftConfig"),2068:t("PurpleFairylandTable"),2069:t("PurpleFairylandPulseTable"),2070:t("PulseRankRewardConfig"),2071:t("PurpleFairylandAdditionTable"),2072:t("DestroyTempleRankRewardConfig"),2073:t("FunctionSecretaryConfig"),2074:t("WholeBossConfig"),2075:t("WorldBossTable"),2076:t("WorldBossRankRewardTable"),2077:t("WholeAttendStoreConfig"),2078:t("WholeAttendConfig"),2079:t("RoamRewardEventTable"),2080:t("ActivityLoginDayGiftConfig"),2081:t("LevelGiftTable"),2082:t("GodFurnaceTable"),2083:t("GodFurnaceRankTable"),2084:t("LimitedTimeStoreTable"),2085:t("HeroPvpPreview"),2086:t("LoginGiftConfig"),2087:t("GodEquipmentBuyConfig"),2088:t("ActivityGachaConfig"),2089:t("DragonBossTable"),2090:t("ContinuousTotalRechargeTable"),2091:t("FlashGiftTable"),2092:t("OnlineRewardConfig"),2093:t("StoryRewardTable"),2094:t("LimitGiftTable"),2095:t("ActivityTurnTableConfig"),2096:t("ActivityTurnTableBuyConfig"),2097:t("ActivityTurnTableTimesRewardConfig"),2098:t("PveMonsterSpeakTable"),2099:t("FortuneCatTable"),2100:t("FortuneCatShopTable"),2101:t("AncientCorridorTable"),2102:t("AncientCorridorRankTable"),2103:t("DemonTreasureCopyConfig"),2104:t("DemonTreasureRankRewardTable"),2106:t("RechargeRankTable"),2107:t("WonderlandConfigTable"),2109:t("TitleTable"),2110:t("ActivityTokenRankConfig"),2111:t("ActivityTokenConfig"),2112:t("ActivityPopupWindowConfig"),2120:t("HeavenConfig"),2121:t("HeavenTurntableConfig"),2122:t("HeavenTurntableRechargeConfig"),2123:t("DipperStoryConfig"),2124:t("DipperScoreRewardConfig"),2125:t("DipperDifficultConfig"),2126:t("MainStoryTable"),2127:t("ChallengeMonsterTable"),2128:t("ChallengeMonsterRankTable"),2130:t("CrossArenaTable"),2131:t("GemAwakenConfig"),2132:t("NationBeastTable"),2133:t("NationBeastFoodTable"),2140:t("ActivityForecastTable"),2141:t("CarnivalScoreConfig"),2142:t("IntensifyPowerTable"),2143:t("IntensifyTable"),2144:t("HeroArtifactTable"),2145:t("HeroArtifactStrengthenTable"),2146:t("HeroArtifactEvolveTable"),2147:t("ActivityCollectWordConfig"),2150:t("GoddessBoxTable"),2151:t("GoddessStoreTable"),2152:t("TowerMasterTable"),2153:t("ConsumeActivityTable"),2154:t("HeroCultivateAttributeTable"),2155:t("MonsterTypeConfig"),2156:t("MonsterCapabilityConfig"),2157:t("FirecrackerTable"),2158:t("FirecrackerCostTable"),2159:t("FirecrackerRechargeTable"),2160:t("MobilizationTable"),2169:t("FestivalTable"),2170:t("BabelConfig"),2171:t("BabelHeroConfig"),2172:t("CrossCupRewardConfig"),2173:t("CrossCupBetConfig"),2161:t("NewGachaTable"),2162:t("TimeLimitGachaTable"),2163:t("TimeLimitGachaRankTable"),2165:t("MonopolyTable"),2166:t("MonopolyProgressTable"),2167:t("MonopolyStoreTable"),2168:t("DoubleDropTable"),2180:t("NationDuelCampConfig"),2181:t("NationDuelOffensiveStarConfig"),2182:t("NationDuelRankRewardConfig"),2222:t("SpiritTable"),2223:t("SpiritReinforceTable"),2224:t("SpiritStarTable"),2225:t("SpiritTalentTable"),2226:t("SpiritManualTable"),2190:t("LegendSeasonRankRewardTable"),2191:t("LegendDailyRewardTable"),2192:t("LegendSeasonRewardTable"),2193:t("LegendDanTable"),2230:t("ActivityCoustomGiftTable"),2231:t("ActivityCoustomGiftPoolTable"),2232:t("EightDiagramsTable"),2233:t("EightDiagramChapterTable"),2234:t("EightDiagramsLimitTable"),2235:t("RoamConfigTable"),2240:t("PetTable"),2241:t("PetStationTable"),2242:t("PetAptitudeTable"),2243:t("PetLevelUpTable"),2244:t("PetStarUpTable"),2245:t("PetManualTable"),2250:t("MazeEffectConfig"),2251:t("MazeHeroConfig"),2252:t("MazeHeroPoolConfig"),2253:t("MazeRobotConfig"),2254:t("MazeStoryConfig"),2255:t("MazeScoreRewardConfig"),2256:t("ActivityConvertConfig"),2257:t("ActivityDiamondRebateConfig"),2258:t("RichmanDayTaskTable"),2259:t("RichmanTurntableTaskTable"),2260:t("RichmanTurntableCostTable"),2261:t("RichmanTurntableRewardTable"),2262:t("ChannelInfoConfig"),2263:t("BirdBridgeBlessProgressTable"),2264:t("BirdBridgeRankTable"),2270:t("ChessGradeTable"),2271:t("ChessRankRewardTable"),2272:t("ChessSkillTable"),2273:t("ChessFloorTable"),2274:t("ChessLevelTable"),2275:t("ChessHeroTable"),2276:t("DivinePositionConfig"),2277:t("AuctionPlayTypeTable"),2278:t("AuctionItemTable"),2280:t("ScuffleYamaChallengeRewardTable"),2281:t("CampAttributeTable"),2282:t("Double11FundConfig"),2283:t("Double11ProductConfig"),2284:t("Double11KillConfig"),2285:t("Double11ShopConfig"),2286:t("Double11PreviewConfig"),2287:t("Double11RankConfig"),2288:t("Double11IntegralConfig"),2289:t("SpecialPackageConfig"),2290:t("ScuffleYamaRankRecordConfig"),2291:t("EvilGodChapterTable"),2292:t("EvilGodGateTable"),2293:t("EvilGodBossTable"),2294:t("EvilGodRankRewardTable"),2295:t("MoXieLoginRedEnvelopeConfig"),2296:t("MoXieCashRedEnvelopeConfig")},cc._RF.pop()},{AboreTipsTable:"AboreTipsTable",AccumulatedRechargeTable:"AccumulatedRechargeTable",ActivityCollectWordConfig:"ActivityCollectWordConfig",ActivityConvertConfig:"ActivityConvertConfig",ActivityCoustomGiftPoolTable:"ActivityCoustomGiftPoolTable",ActivityCoustomGiftTable:"ActivityCoustomGiftTable",ActivityDiamondRebateConfig:"ActivityDiamondRebateConfig",ActivityForecastTable:"ActivityForecastTable",ActivityGachaConfig:"ActivityGachaConfig",ActivityGachaTable:"ActivityGachaTable",ActivityLoginDayGiftConfig:"ActivityLoginDayGiftConfig",ActivityPopupWindowConfig:"ActivityPopupWindowConfig",ActivityShowConfigTable:"ActivityShowConfigTable",ActivityShowFixedTable:"ActivityShowFixedTable",ActivityTokenConfig:"ActivityTokenConfig",ActivityTokenRankConfig:"ActivityTokenRankConfig",ActivityTurnTableBuyConfig:"ActivityTurnTableBuyConfig",ActivityTurnTableConfig:"ActivityTurnTableConfig",ActivityTurnTableTimesRewardConfig:"ActivityTurnTableTimesRewardConfig",ActorUnlockTable:"ActorUnlockTable",AddUpRechargeTable:"AddUpRechargeTable",AncientCorridorRankTable:"AncientCorridorRankTable",AncientCorridorTable:"AncientCorridorTable",ArenaRankRewardConfig:"ArenaRankRewardConfig",ArenaRankUpgradeRewardConfig:"ArenaRankUpgradeRewardConfig",AuctionItemTable:"AuctionItemTable",AuctionPlayTypeTable:"AuctionPlayTypeTable",AvatarConfig:"AvatarConfig",BabelConfig:"BabelConfig",BabelHeroConfig:"BabelHeroConfig",BirdBridgeBlessProgressTable:"BirdBridgeBlessProgressTable",BirdBridgeRankTable:"BirdBridgeRankTable",BroadcastTable:"BroadcastTable",CampAttributeTable:"CampAttributeTable",CampaignNotifyConfig:"CampaignNotifyConfig",CarnivalDiscountConfig:"CarnivalDiscountConfig",CarnivalScoreConfig:"CarnivalScoreConfig",CarnivalTypeConfig:"CarnivalTypeConfig",ChallengeMonsterRankTable:"ChallengeMonsterRankTable",ChallengeMonsterTable:"ChallengeMonsterTable",ChannelInfoConfig:"ChannelInfoConfig",ChargeCommodityConfig:"ChargeCommodityConfig",ChatConfig:"ChatConfig",ChessFloorTable:"ChessFloorTable",ChessGradeTable:"ChessGradeTable",ChessHeroTable:"ChessHeroTable",ChessLevelTable:"ChessLevelTable",ChessRankRewardTable:"ChessRankRewardTable",ChessSkillTable:"ChessSkillTable",ComposeTable:"ComposeTable",ConfigTable:"ConfigTable",ConsumeActivityTable:"ConsumeActivityTable",ContinuousRechargeTable:"ContinuousRechargeTable",ContinuousTotalRechargeTable:"ContinuousTotalRechargeTable",CrossArenaTable:"CrossArenaTable",CrossCupBetConfig:"CrossCupBetConfig",CrossCupRewardConfig:"CrossCupRewardConfig",DailyPreferentialTable:"DailyPreferentialTable",DecomposeConfig:"DecomposeConfig",DemonTreasureCopyConfig:"DemonTreasureCopyConfig",DemonTreasureRankRewardTable:"DemonTreasureRankRewardTable",DestroyTempleEffectConfig:"DestroyTempleEffectConfig",DestroyTempleRankRewardConfig:"DestroyTempleRankRewardConfig",DestroyTempleTable:"DestroyTempleTable",DipperDifficultConfig:"DipperDifficultConfig",DipperScoreRewardConfig:"DipperScoreRewardConfig",DipperStoryConfig:"DipperStoryConfig",DivinePositionConfig:"DivinePositionConfig",Double11FundConfig:"Double11FundConfig",Double11IntegralConfig:"Double11IntegralConfig",Double11KillConfig:"Double11KillConfig",Double11PreviewConfig:"Double11PreviewConfig",Double11ProductConfig:"Double11ProductConfig",Double11RankConfig:"Double11RankConfig",Double11ShopConfig:"Double11ShopConfig",DoubleDropTable:"DoubleDropTable",DragonBossTable:"DragonBossTable",DrawEnergyConfig:"DrawEnergyConfig",EightDiagramChapterTable:"EightDiagramChapterTable",EightDiagramsLimitTable:"EightDiagramsLimitTable",EightDiagramsTable:"EightDiagramsTable",EndlessRewardTable:"EndlessRewardTable",EndlessTable:"EndlessTable",EnterBtnConfigTable:"EnterBtnConfigTable",EntryTable:"EntryTable",EquipmentEvolveTable:"EquipmentEvolveTable",EquipmentForgeEffectTable:"EquipmentForgeEffectTable",EquipmentForgeTable:"EquipmentForgeTable",EquipmentGroupTable:"EquipmentGroupTable",EquipmentReinforceTable:"EquipmentReinforceTable",EquipmentStarTable:"EquipmentStarTable",EquipmentTable:"EquipmentTable",EvilGodBossTable:"EvilGodBossTable",EvilGodChapterTable:"EvilGodChapterTable",EvilGodGateTable:"EvilGodGateTable",EvilGodRankRewardTable:"EvilGodRankRewardTable",FamousGeneralShopTable:"FamousGeneralShopTable",FerroTurntableConfig:"FerroTurntableConfig",FestivalActivityTable:"FestivalActivityTable",FestivalStoreTable:"FestivalStoreTable",FestivalTable:"FestivalTable",FirecrackerCostTable:"FirecrackerCostTable",FirecrackerRechargeTable:"FirecrackerRechargeTable",FirecrackerTable:"FirecrackerTable",FlashGiftTable:"FlashGiftTable",FortuneCatShopTable:"FortuneCatShopTable",FortuneCatTable:"FortuneCatTable",FunctionPreviewConfig:"FunctionPreviewConfig",FunctionSecretaryConfig:"FunctionSecretaryConfig",FundCardTable:"FundCardTable",GachaTable:"GachaTable",GameTipsTable:"GameTipsTable",GemAwakenConfig:"GemAwakenConfig",GemstoneAdvanceResetTable:"GemstoneAdvanceResetTable",GemstoneAdvanceTable:"GemstoneAdvanceTable",GemstoneTable:"GemstoneTable",GemstoneUpgradeTable:"GemstoneUpgradeTable",GodEquipmentBuyConfig:"GodEquipmentBuyConfig",GodFurnaceRankTable:"GodFurnaceRankTable",GodFurnaceTable:"GodFurnaceTable",GoddessBoxTable:"GoddessBoxTable",GoddessStoreTable:"GoddessStoreTable",GoldHeroBackBuyTable:"GoldHeroBackBuyTable",GoldTreasureTable:"GoldTreasureTable",GroupPurchaseTable:"GroupPurchaseTable",GrowthPlanRewardTable:"GrowthPlanRewardTable",GrowthPlanTable:"GrowthPlanTable",GuideTable:"GuideTable",HeavenConfig:"HeavenConfig",HeavenTurntableConfig:"HeavenTurntableConfig",HeavenTurntableRechargeConfig:"HeavenTurntableRechargeConfig",HelpDesTable:"HelpDesTable",HeroArtifactEvolveTable:"HeroArtifactEvolveTable",HeroArtifactStrengthenTable:"HeroArtifactStrengthenTable",HeroArtifactTable:"HeroArtifactTable",HeroBreakoutTable:"HeroBreakoutTable",HeroCultivateAttributeTable:"HeroCultivateAttributeTable",HeroCultivateTable:"HeroCultivateTable",HeroEvolveExtraAttrConfig:"HeroEvolveExtraAttrConfig",HeroEvolveTable:"HeroEvolveTable",HeroLevelUpTable:"HeroLevelUpTable",HeroPvpPreview:"HeroPvpPreview",HeroRepayRewardTable:"HeroRepayRewardTable",HeroRepayTable:"HeroRepayTable",HeroRuneTable:"HeroRuneTable",HeroStarUpTable:"HeroStarUpTable",HeroTable:"HeroTable",HuntTreasureTable:"HuntTreasureTable",ImmortalConfig:"ImmortalConfig",ImmortalInviteConfig:"ImmortalInviteConfig",ImmortalVisitConfig:"ImmortalVisitConfig",ImmortalVisitEventConfig:"ImmortalVisitEventConfig",IntensifyPowerTable:"IntensifyPowerTable",IntensifyTable:"IntensifyTable",ItemTable:"ItemTable",KDDamageRewardTable:"KDDamageRewardTable",KDLevelRewardTable:"KDLevelRewardTable",KDRankRewardTable:"KDRankRewardTable",LanguageTable:"LanguageTable",LegendDailyRewardTable:"LegendDailyRewardTable",LegendDanTable:"LegendDanTable",LegendSeasonRankRewardTable:"LegendSeasonRankRewardTable",LegendSeasonRewardTable:"LegendSeasonRewardTable",LevelGiftTable:"LevelGiftTable",LimitGiftTable:"LimitGiftTable",LimitedTimeStoreTable:"LimitedTimeStoreTable",LineupRecommendTable:"LineupRecommendTable",LiveShowConfigTable:"LiveShowConfigTable",LoginGiftConfig:"LoginGiftConfig",LuckyErnieTable:"LuckyErnieTable",LuckyScoreRewardTable:"LuckyScoreRewardTable",LuckyTurntableTable:"LuckyTurntableTable",MagicRecordRewardTable:"MagicRecordRewardTable",MagicRecordTable:"MagicRecordTable",MainPopupTable:"MainPopupTable",MainStoryTable:"MainStoryTable",ManualTable:"ManualTable",MaterailCopyEntryTable:"MaterailCopyEntryTable",MaterialCopyConfig:"MaterialCopyConfig",MaterialCopyTypeConfig:"MaterialCopyTypeConfig",MazeEffectConfig:"MazeEffectConfig",MazeHeroConfig:"MazeHeroConfig",MazeHeroPoolConfig:"MazeHeroPoolConfig",MazeRobotConfig:"MazeRobotConfig",MazeScoreRewardConfig:"MazeScoreRewardConfig",MazeStoryConfig:"MazeStoryConfig",MercenaryFightShowTable:"MercenaryFightShowTable",MercenaryReinforcementConfig:"MercenaryReinforcementConfig",MoXieCashRedEnvelopeConfig:"MoXieCashRedEnvelopeConfig",MoXieLoginRedEnvelopeConfig:"MoXieLoginRedEnvelopeConfig",MobilizationTable:"MobilizationTable",ModelShowTable:"ModelShowTable",MonopolyProgressTable:"MonopolyProgressTable",MonopolyStoreTable:"MonopolyStoreTable",MonopolyTable:"MonopolyTable",MonsterCapabilityConfig:"MonsterCapabilityConfig",MonsterGroupConfig:"MonsterGroupConfig",MonsterTable:"MonsterTable",MonsterTypeConfig:"MonsterTypeConfig",MonthCardRenewalTable:"MonthCardRenewalTable",MonthCardTable:"MonthCardTable",MultpleFirstRechargeTable:"MultpleFirstRechargeTable",NationBeastFoodTable:"NationBeastFoodTable",NationBeastTable:"NationBeastTable",NationBossActorScoreRankRewardConfig:"NationBossActorScoreRankRewardConfig",NationBossConfig:"NationBossConfig",NationBossNationScoreRankRewardConfig:"NationBossNationScoreRankRewardConfig",NationBossScoreTaskConfig:"NationBossScoreTaskConfig",NationDonateTable:"NationDonateTable",NationDuelCampConfig:"NationDuelCampConfig",NationDuelOffensiveStarConfig:"NationDuelOffensiveStarConfig",NationDuelRankRewardConfig:"NationDuelRankRewardConfig",NationDungeonTable:"NationDungeonTable",NationEndlessTable:"NationEndlessTable",NationLevelTable:"NationLevelTable",NationRecordTable:"NationRecordTable",NationSciTechLevelConfig:"NationSciTechLevelConfig",NationSciTechTypeTable:"NationSciTechTypeTable",NetErrorTips:"NetErrorTips",NewGachaTable:"NewGachaTable",ObtainWayTable:"ObtainWayTable",OnlineRewardConfig:"OnlineRewardConfig",OperationTypeTable:"OperationTypeTable",PagodaConfig:"PagodaConfig",PetAptitudeTable:"PetAptitudeTable",PetLevelUpTable:"PetLevelUpTable",PetManualTable:"PetManualTable",PetStarUpTable:"PetStarUpTable",PetStationTable:"PetStationTable",PetTable:"PetTable",PreLoadConfig:"PreLoadConfig",PulseRankRewardConfig:"PulseRankRewardConfig",PurpleFairylandAdditionTable:"PurpleFairylandAdditionTable",PurpleFairylandPulseTable:"PurpleFairylandPulseTable",PurpleFairylandTable:"PurpleFairylandTable",PveBulletTable:"PveBulletTable",PveCreateEnemyTable:"PveCreateEnemyTable",PveEnemyTable:"PveEnemyTable",PveGeneralCopyChapterTable:"PveGeneralCopyChapterTable",PveGeneralCopyGateTable:"PveGeneralCopyGateTable",PveHeroFihgtShowTable:"PveHeroFihgtShowTable",PveLoveConfigTable:"PveLoveConfigTable",PveLoveSkillTable:"PveLoveSkillTable",PveMonsterSpeakTable:"PveMonsterSpeakTable",PveSkillTable:"PveSkillTable",RechargeRankTable:"RechargeRankTable",ResonateTable:"ResonateTable",ResourceSizeTable:"ResourceSizeTable",RichmanDayTaskTable:"RichmanDayTaskTable",RichmanTurntableCostTable:"RichmanTurntableCostTable",RichmanTurntableRewardTable:"RichmanTurntableRewardTable",RichmanTurntableTaskTable:"RichmanTurntableTaskTable",RoamConfigTable:"RoamConfigTable",RoamProgressConfig:"RoamProgressConfig",RoamRewardEventTable:"RoamRewardEventTable",RushRankTable:"RushRankTable",ScenesTextConfig:"ScenesTextConfig",ScuffleYamaChallengeRewardTable:"ScuffleYamaChallengeRewardTable",ScuffleYamaRankRecordConfig:"ScuffleYamaRankRecordConfig",ShopGoodsTable:"ShopGoodsTable",ShopShowTable:"ShopShowTable",SiegeCityConfig:"SiegeCityConfig",SiegeCityDefenceConfig:"SiegeCityDefenceConfig",SignInConfig:"SignInConfig",SingleRechargeTable:"SingleRechargeTable",SkillEffectTable:"SkillEffectTable",SkillTable:"SkillTable",SoulWareTable:"SoulWareTable",SoundTable:"SoundTable",SpecialAttributeTable:"SpecialAttributeTable",SpecialEffectTable:"SpecialEffectTable",SpecialPackageConfig:"SpecialPackageConfig",SpiritManualTable:"SpiritManualTable",SpiritReinforceTable:"SpiritReinforceTable",SpiritStarTable:"SpiritStarTable",SpiritTable:"SpiritTable",SpiritTalentTable:"SpiritTalentTable",StarDiamondTable:"StarDiamondTable",StarUpRoadChapterTable:"StarUpRoadChapterTable",StarUpRoadTable:"StarUpRoadTable",StoreRefreshTable:"StoreRefreshTable",StoryAreaConfig:"StoryAreaConfig",StoryRewardTable:"StoryRewardTable",SummonTable:"SummonTable",SuperGiftConfig:"SuperGiftConfig",TaskTable:"TaskTable",TechnologyAdvanceTable:"TechnologyAdvanceTable",TechnologyLevelTable:"TechnologyLevelTable",TechnologyTable:"TechnologyTable",TimeLimitGachaRankTable:"TimeLimitGachaRankTable",TimeLimitGachaTable:"TimeLimitGachaTable",TitleTable:"TitleTable",TowerMasterTable:"TowerMasterTable",TreasureEvolveEffectTable:"TreasureEvolveEffectTable",TreasureEvolveTable:"TreasureEvolveTable",TreasureGiftOpenRewardTable:"TreasureGiftOpenRewardTable",TreasureGiftOpenTable:"TreasureGiftOpenTable",TreasureLevelUpTable:"TreasureLevelUpTable",TreasureStarUpTable:"TreasureStarUpTable",TreasureTable:"TreasureTable",UpgradeTipsTable:"UpgradeTipsTable",UserLevelTable:"UserLevelTable",VipDesTable:"VipDesTable",VipGiftTable:"VipGiftTable",VipPrivilegeTable:"VipPrivilegeTable",VipTable:"VipTable",VipWelfareConfig:"VipWelfareConfig",WholeAttendConfig:"WholeAttendConfig",WholeAttendStoreConfig:"WholeAttendStoreConfig",WholeBossConfig:"WholeBossConfig",WonderlandConfigTable:"WonderlandConfigTable",WorldBossRankRewardTable:"WorldBossRankRewardTable",WorldBossTable:"WorldBossTable"}],TalentModel:[function(t,e,i){"use strict";cc._RF.push(e,"03984bKCJRN3az4Hiq4idRF","TalentModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(t){this._talentId=t.talentId,this._quality=t.quality,this._talentName=t.talentName,this._attributeTTPercent=t.attributeTTPercent,this._attributes=t.attributes,this._levelEffect=t.levelEffect,this._talentIcon=t.talentIcon,this._talentLevel=1},e.prototype.setData=function(t,e){void 0!=t.lock&&(this._isLock=t.lock),(t.talentLevel||0==t.talentLevel)&&(this._talentLevel=t.talentLevel+e)},e.prototype.getTalentId=function(){return this._talentId},e.prototype.getTalentIcon=function(){return this._talentIcon},e.prototype.getQuality=function(){return this._quality},e.prototype.getTalentName=function(){return this._talentName},e.prototype.getAttributeTTPercent=function(){return this._attributeTTPercent},e.prototype.getAttributes=function(){return this._attributes},e.prototype.getLevelEffect=function(){return this._levelEffect},e.prototype.getIsLock=function(){return this._isLock},e.prototype.getTalentLevel=function(){return this._talentLevel},e.prototype.getTotalAttr=function(){var t=this,e={};return this._attributes.forEach(function(t){e[t[0]]||(e[t[0]]=0),e[t[0]]+=t[1]}),this._levelEffect.forEach(function(i){e[i[0]]||(e[i[0]]=0),e[i[0]]+=i[1]*(t._talentLevel-1)}),e},e}(t("Model"));e.exports=a,cc._RF.pop()},{Model:"Model"}],TaskEnum:[function(t,e,i){"use strict";cc._RF.push(e,"d9ecfXDraxCpbbl3QHWaZU7","TaskEnum"),td.TaskType={NONE:0,DAILY:1,ACHIEVE:2,MAINLINE:3,CARNIVAL:4,TOKEN:5,TREASURE_GIFT:9,LEVEL_GIFT:10,FORTUNE_CAT:11,TREASURE_SNATCH:12,ACTIVITY_TOKEN:13,GODDESS:19,PULSE:14,ACTIVITY_21_TOKEN:24,ACTIVITY_TYPE_38:26,ACTIVITY_TYPE_42:27,PET_VIP_CARD:37},td.TaskStatus={UNOPENED:1,Progress:2,Finish:3,Received:4,NONE:0},td.TaskConditionType={Week_Month_Card:14,ACTOR_DIRECT_PURCHASING:16,ACTOR_RECHARGE:50,ACTOR_ACTIVITY41_SINGLE_RECHARGE:58,ACTOR_ACTIVITY41_TOTAL_RECHARGE:59,PULSE_OCCUPY_TOTAL_TIME:85,CROSS_ARENA_ZONE_BATTLEFIELD:91},td.MainTaskId={Chat:5020},cc._RF.pop()},{}],TaskManager:[function(t,e,i){"use strict";cc._RF.push(e,"4cd75KzOuRG3Iu4LK2LyzHD","TaskManager");var n=t("../../../SDK/SDKCommonEnum"),a=t("TaskModel");td.TaskManager={_active:null,_activeEntities:null,_taskList:null,_isReceiveMainTask:null,_isCouldSmeltTask:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._activeReceiveIds=[],this._taskList={},this._active=0,this._isReceiveMainTask=!1,this._isCouldSmeltTask=!1},getTaskById:function(t){return this._taskList&&this._taskList[t]?this._taskList[t]:null},getShowListByType:function(t,e){var i=this._taskList,n=[];e||(e=[td.TaskStatus.UNOPENED,td.TaskStatus.Received]);var a=function(t){for(var i=0,n=e.length;i<n;i++)if(t===e[i])return!1;return!0};for(var r in i){var o=i[r];if(o.getType()===t){for(var s=!1,l=0;l<n.length;l++){if(n[l].getGroupId()===o.getGroupId()){s=!0;break}}!s&&a(o.getStatus())&&(n[n.length]=o)}}return this._sortTaskList(n),n},getShowMainTask:function(){var t=this.getShowListByType(td.TaskType.MAINLINE);if(t.sort(function(t,e){return e.getSortRank()-t.getSortRank()}),t.length>0)return t[0]},_sortTaskList:function(t){t.sort(function(t,e){return t.getStatus()>e.getStatus()?-1:t.getStatus()<e.getStatus()?1:e.getSortRank()-t.getSortRank()})},isActiveBoxTips:function(){for(var t=0;t<4;t++){if(this.getActiveBoxStatus(t)===td.TaskStatus.Finish)return!0}return!1},getActiveBoxStatus:function(t){if(!this._activeEntities||!this._activeEntities[t])return td.TaskStatus.NONE;var e=this._activeEntities[t];return this._active<e.active?td.TaskStatus.Progress:e.receive?td.TaskStatus.Received:td.TaskStatus.Finish},getActivityEntityByIndex:function(t){return this._activeEntities&&this._activeEntities[t]?this._activeEntities[t]:null},getCurActiveValue:function(){return this._active},_addListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.TASK,i=td.MsgCmd.Task;t.registerMessage(e,i.GET_TASK_INFO,this._resTaskInfo.bind(this)),t.registerMessage(e,i.GET_ACTIVE_INFO,this._resActiveInfo.bind(this)),t.registerMessage(e,i.TASK_RECEIVE,this._resRecieve.bind(this)),t.registerMessage(e,i.ACTIVE_RECEIVE,this._resBoxRecive.bind(this)),t.registerMessage(e,i.PUSH_TASK_INFO,this._resTaskInfo.bind(this)),t.registerMessage(e,i.PUSH_ACTIVE_INFO,this._resActiveInfo.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.Req_GET_TASK_INFO]=this._reqGetTaskInfo,i[e.Req_GET_ACTIVE_INFO]=this._reqGetActiveInfo,i[e.Req_ACTIVE_RECEIVE]=this._reqActiveReceive,i[e.Req_TASK_RECEIVE]=this._reqTaskReceive,t.registerEvents(i,this)},_reqGetTaskInfo:function(){var t={};t.module=td.MsgModuleName.TASK,t.cmd=td.MsgCmd.Task.GET_TASK_INFO,td.ServerDelegate.sendMessage(t)},_reqGetActiveInfo:function(){var t={};t.module=td.MsgModuleName.TASK,t.cmd=td.MsgCmd.Task.GET_ACTIVE_INFO,td.ServerDelegate.sendMessage(t)},_reqTaskReceive:function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.RECORD_CUR_LEVEL);var e={};e.module=td.MsgModuleName.TASK,e.cmd=td.MsgCmd.Task.TASK_RECEIVE,e.id=t;var i=this.getTaskById(t);i&&(this._isReceiveMainTask=i.getType()===td.TaskType.MAINLINE),td.ServerDelegate.sendMessage(e),td.DataReporter.onEvent("Task",{taskId:t})},_reqActiveReceive:function(t){var e={};e.module=td.MsgModuleName.TASK,e.cmd=td.MsgCmd.Task.ACTIVE_RECEIVE,e.id=t,td.ServerDelegate.sendMessage(e)},_resTaskInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._taskList&&0!==this._taskList.myLen()||this._initTaskList();for(var i=e.tasks,n=0,a=i.length;n<a;n++){var r=i[n];this._updateTaskModel(r)}td.EventUtil.dispatchEvent(td.EventNameEnum.Res_GET_TASK_INFO),td.EventUtil.dispatchEvent(td.EventNameEnum.INIT_DATA_LOADED,td.LoadKey.Task)}},_resActiveInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._active=e.active,this._activeEntities=e.activeEntities,this._activeEntities.sort(function(t,e){return t.active-e.active}),td.EventUtil.dispatchEvent(td.EventNameEnum.Res_GET_ACTIVE_INFO);var i=this._activeEntities[this._activeEntities.length-1];if(i&&i.receive)td.LocalStorageUtil.readRealLocal(td.LocalRealKey.FIRST_RECEIVE_ACTIVE_REWARD)||(td.EventUtil.dispatchEvent(td.EventNameEnum.CHECK_POINT_REPORT,n.CHECK_POINT_TYPE.FIRST_RECEIVE_ACTIVE_REWARD),td.LocalStorageUtil.writeRealLocal(td.LocalRealKey.FIRST_RECEIVE_ACTIVE_REWARD,!0))}},_initTaskList:function(){var t=this._taskList,e=td.GetTableClass(td.TableEnum.TaskTable).getTaskData();if(e)for(var i in e){var n=e[i],r=new a;r.init(n),t[i]=r}},_updateTaskModel:function(t){var e=this._taskList[t.taskId];e&&(e.setValue(t.value),e.setStatus(parseInt(t.status)))},_resBoxRecive:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i);td.GlobalFunction.showRewards(n),td.EventUtil.dispatchEvent(td.EventNameEnum.Res_ACTIVE_RECEIVE)}},_resRecieve:function(t,e){if(t===td.NetCode.SUCCESS){cc.log("_resRecieve "+td.TimeUtil.getTime());var i=e.rewardResult;this._isCouldSmeltTask&&(td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_MANI_TASK_VIEW),this.reqSmeltGuide(),this._isCouldSmeltTask=!1),i.nationExp=0;var n=td.RewardManager.parseRewardResult(i,!0);if(this._isReceiveMainTask){if(td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_GET_ITEM_TIPS,n),td.PanelManager.getInstance().getCurShowPanel()){var a=td.PanelManager.getInstance().getCurShowPanel().getPanelEnum();a&&a===td.PanelEnum.Panel_PVE_FIGHT_HOOK&&td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_CHECK_STEP,a)}}else td.GlobalFunction.showRewards(n);td.EventUtil.dispatchEvent(td.EventNameEnum.Res_TASK_RECEIVE),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_RECORDED_LEVEL_CHANGE),td.EventUtil.dispatchEvent(td.EventNameEnum.PET_REFRESH_HATCH_PANEL)}},reqSmeltGuide:function(){var t=td.PanelManager.getInstance().getCurShowPanel(),e=t?t.getPanelEnum():null,i=!1;e&&(i=e===td.PanelEnum.Panel_HomePage),i?td.GuideManager.insertSysOpenGuide(4e3):td.GuideManager.insertSysOpenGuide(4001),td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_CHECK_STEP,e)},isShowMainPanel:function(){var t=this._taskList[5026];return!(!t||t.getStatus()===td.TaskStatus.Received)},_isTipsByType:function(t){for(var e=this.getShowListByType(t),i=0,n=e.length;i<n;i++){if(e[i].getStatus()===td.TaskStatus.Finish)return!0}return!1},isDailyTips:function(){return this._isTipsByType(td.TaskType.DAILY)||this.isActiveBoxTips()},isAchivementTips:function(){return this._isTipsByType(td.TaskType.ACHIEVE)},isMainLineTips:function(){return this._isTipsByType(td.TaskType.MAINLINE)},isCarnivalTips:function(){return this._isTipsByType(td.TaskType.CARNIVAL)},isRedPoint:function(){return!!td.UnlockManager.isTargetUnlock(td.ActorUnlockType.Task)&&(this.isDailyTips()||this.isAchivementTips())},redPointEvts:function(){return[td.EventNameEnum.Res_GET_TASK_INFO,td.EventNameEnum.Res_ACTIVE_RECEIVE]},setIsCouldSmeltTask:function(t){this._isCouldSmeltTask=t}},cc._RF.pop()},{"../../../SDK/SDKCommonEnum":void 0,TaskModel:"TaskModel"}],TaskModel:[function(t,e,i){"use strict";cc._RF.push(e,"69c7bLIOxBJPqLYR3OGVaQG","TaskModel");var n=t("Model"),a=cc.Class({extends:n,properties:{_id:null,_status:null,_value:null,_type:null,_name:null,_des:null,_sortRank:null,_withProgress:null,_needValue:null,_level:null,_vipLevel:null,_monthVip:null,_active:null,_rewards:null,_gotoPanel:null,_groupId:null,_index:null,_conditionType:null,_recommond:null},init:function(t){this._super("TaskModel"),this._id=t.taskId,this._name=t.name||"",this._des=t.des||"",this._sortRank=t.sortRank||0,this._withProgress=t.withProgress||0,this._needValue=t.value||0,this._level=t.level||0,this._vipLevel=t.vipLevel||0,this._monthVip=t.monthVip||0,this._active=t.active||0,this._rewards=t.rewards||0,this._gotoPanel=t.gotoPanel||"",this._groupId=t.groupId||0,this._index=t.index||0,this._type=t.type||0,this._conditionType=t.conditionType||0,this._recommond=t.recommend||0,this._status=td.TaskStatus.UNOPENED,this._value=0},getId:function(){return this._id},setValue:function(t){this._value=t},getValue:function(){return this._value},getConditionType:function(){return this._conditionType},getType:function(){return this._type},isChargeType:function(){return this._conditionType===td.TaskConditionType.ACTOR_DIRECT_PURCHASING||this._conditionType===td.TaskConditionType.ACTOR_RECHARGE||this._conditionType===td.TaskConditionType.ACTOR_ACTIVITY41_SINGLE_RECHARGE||this._conditionType===td.TaskConditionType.ACTOR_ACTIVITY41_TOTAL_RECHARGE},setStatus:function(t){this._status=t},getStatus:function(){return this._status},getName:function(){return this._name},getDes:function(){return this._des},getSortRank:function(){return this._sortRank},getWithProgress:function(){return this._withProgress},getNeedValue:function(){return this._needValue},getLevel:function(){return this._level},getVipLevel:function(){return this._vipLevel},getMonthVip:function(){return this._monthVip},getActive:function(){return this._active},getRewards:function(){return this._rewards},getGotoPanel:function(){return this._gotoPanel},getGroupId:function(){return this._groupId},getIndex:function(){return this._index},getRecommond:function(){return this._recommond}});e.exports=a,cc._RF.pop()},{Model:"Model"}],TaskTable:[function(t,e,i){"use strict";cc._RF.push(e,"f61dci141xKbLAxcRTsVb9y","TaskTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"TaskTable",properties:{_tblName:"task_config",_data:null,_key:"taskId"},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a[this._key]]=a}},getTaskData:function(){return this._data},getTaskById:function(t){for(var e in this._data)if(e==t)return this._data[e];return null},getTaskByType:function(t){var e=[];for(var i in this._data)this._data[i].type==t&&e.push(this._data[i]);return e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TechnologyAdvanceTable:[function(t,e,i){"use strict";cc._RF.push(e,"8e6429FOI1Hi63YxOX9QrKg","TechnologyAdvanceTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"TechnologyAdvanceTable",properties:{_tblName:"technology_advance_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.vocation;t[r]=t[r]||{};var o=a.advanceLevel;t[r][o]=a}},getConfig:function(t,e){var i=this._data[t];return i?i[e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TechnologyLevelTable:[function(t,e,i){"use strict";cc._RF.push(e,"03371IYbvlOnJtPJCnahrwl","TechnologyLevelTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"TechnologyLevelTable",properties:{_tblName:"technology_level_config",_data:null,_maxLevel:null},init:function(){this._data={},this._maxLevel={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=t[a.id];r||(r={},t[a.id]=r),r[a.level]=a,(!this._maxLevel[a.id]||this._maxLevel[a.id]<a.level)&&(this._maxLevel[a.id]=a.level)}},getConfig:function(t,e){return this._data[t][e]},isMaxLevel:function(t,e){var i=this._maxLevel[t];return!!(i&&i<=e)}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TechnologyManager:[function(t,e,i){"use strict";cc._RF.push(e,"e9d9amr4eVAg55dh81QJCvo","TechnologyManager");var n=t("TechnologyModel");td.TechnologyManager={_technologies:null,_advanceList:null,_tecEffectMap:null,_advanceEffectMap:null,init:function(){this._addListener(),this._addEventListener(),this.destroyData()},destroyData:function(){this._technologies={},this._advanceList={},this._tecEffectMap={},this._advanceEffectMap={}},_addListener:function(){var t=td.ServerDelegate,e=td.MsgModuleName.Technology,i=td.MsgCmd.TECHNOLOGY;t.registerMessage(e,i.GET_TECHNOLOGY_LIST,this._resTechnologyList.bind(this)),t.registerMessage(e,i.TECHNOLOGY_UPGRADE,this._resUpgrade.bind(this)),t.registerMessage(e,i.TECHNOLOGY_ADVANCE,this._resAdvance.bind(this)),t.registerMessage(e,i.TECHNOLOGY_RESET,this._resReset.bind(this)),t.registerMessage(e,i.PUSH_TECHNOLOGY_LIST,this._resTechnologyList.bind(this))},_addEventListener:function(){var t=td.EventUtil,e=td.EventNameEnum,i={};i[e.Req_GET_TECHNOLOGY_LIST]=this._reqGetTechnologyList,i[e.Req_TECHNOLOGY_UPGRADE]=this._reqTechnologyUpgrade,i[e.Req_TECHNOLOGY_ADVANCE]=this._reqTechnologyAdvance,i[e.REQ_TECHNOLOGY_RESET]=this._reqReset,t.registerEvents(i,this)},isRedPoint:function(){if(!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Technology))return!1;var t=td.PveEnum.PVE_HERO_VOCATION;for(var e in t){var i=t[e];if(this.isRedPointByVocation(i))return!0}return!1},isAllRedPoint:function(){return!!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Technology)&&(this.canAllAdvance()&&this.canAllUpgrade())},isRedPointByVocation:function(t){return!!td.UnlockManager.isPanelUnlock(td.PanelEnum.Panel_Technology)&&(this.canAdvance(t)||this.canUpgrade(t))},redPointEvts:function(){var t=td.EventNameEnum;return[t.TECHNOLOGY_REFRESH,t.ON_TECHNOLOGY_ADVANCED,t.ITEM_CHANGE]},getAllTecLevel:function(){var t=0;for(var e in this._technologies){var i=this._technologies[e];if(i)for(var n in i){t+=i[n].getLevel()}}return t},canAdvance:function(t){var e=this._advanceList[t],i=td.GetTableClass(td.TableEnum.TechnologyAdvanceTable).getConfig(t,e);if(!i)return!1;var n=i.levelLimit,a=this._technologies[t],r=!0;if(a)for(var o in a){if(a[o].getLevel()<n){r=!1;break}}if(!r)return!1;var s=td.RewardManager.parseRewardListDetail(i.cost)[0];return!(!s||!td.GamerResourceUtil.checkResource(s.getId(),s.getCount(),td.GamerResourceUtil.TipType.None))},canAllAdvance:function(){var t=td.PveEnum.PVE_HERO_VOCATION,e=0;for(var i in t){var n=t[i],a=this._advanceList[n],r=td.GetTableClass(td.TableEnum.TechnologyAdvanceTable).getConfig(n,a);if(r){var o=r.levelLimit,s=this._technologies[n],l=!0;if(s)for(var c in s){if(s[c].getLevel()<o){l=!1;break}}if(l){var u=r.cost;if(0===u.length)return!1;var d=u[0][2];e<d&&(e=d)}}}return 0===e||td.ItemManager.getItemNumById(td.ItemEnum.TechnologicalRunes)>=e},canUpgrade:function(t){var e=this._advanceList[t],i=td.GetTableClass(td.TableEnum.TechnologyAdvanceTable).getConfig(t,e);if(!i)return!1;var n=i.levelLimit,a=this._technologies[t];if(!a)return!1;var r=!1,o=td.GetTableClass(td.TableEnum.TechnologyLevelTable),s=td.RewardManager,l=td.GamerResourceUtil;for(var c in a){var u=a[c].getLevel(),d=o.getConfig(c,u+1);if(d){var h=s.parseRewardListDetail(d.cost)[0];if(u<n&&h&&l.checkResource(h.getId(),h.getCount(),td.GamerResourceUtil.TipType.None)){r=!0;break}}}return r},canAllUpgrade:function(){var t=td.PveEnum.PVE_HERO_VOCATION,e=0,i=0;for(var n in t){var a=t[n],r=this._advanceList[a],o=td.GetTableClass(td.TableEnum.TechnologyAdvanceTable).getConfig(a,r);if(o){var s=o.levelLimit,l=this._technologies[a];if(l){var c=td.GetTableClass(td.TableEnum.TechnologyLevelTable);for(var u in l){var d=l[u].getLevel(),h=c.getConfig(u,d+1);if(h&&d<s){var p=h.cost[0][2],_=h.cost[0][1];_===td.ItemEnum.TechnologicalUpRunes&&e<p?e=p:_===td.ItemEnum.TechnologicalRunes&&i<p&&(i=p)}}}}}var g=td.ItemManager.getItemNumById(td.ItemEnum.TechnologicalUpRunes),f=td.ItemManager.getItemNumById(td.ItemEnum.TechnologicalRunes);return(0!==e||0!==i)&&(0===e?f>=i:0===i?g>=e:g>=e||f>=i)},getTechnology:function(t){return this._technologies[t]},getAdvanceLevel:function(t){return this._advanceList[t]||0},_reqGetTechnologyList:function(){var t={};t.module=td.MsgModuleName.Technology,t.cmd=td.MsgCmd.TECHNOLOGY.GET_TECHNOLOGY_LIST,td.ServerDelegate.sendMessage(t)},_resTechnologyList:function(t,e){if(t===td.NetCode.SUCCESS){this._technologies&&0!=this._technologies.myLen()||this._initTechnologies();for(var i=e.technologies,n=0,a=i.length;n<a;n++)this._updateTechnologyModel(i[n]);this._refresEffect()}},_updateTechnologyModel:function(t){var e=t.type;this._advanceList[e]=t.advanceLevel||0;var i=this._technologies[e]||{},n=t.levelMap;for(var a in n){var r=n[a=parseInt(a)],o=i[a];o&&o.setLevel(r)}},_reqTechnologyUpgrade:function(t){var e={};e.module=td.MsgModuleName.Technology,e.cmd=td.MsgCmd.TECHNOLOGY.TECHNOLOGY_UPGRADE,e.id=t,td.ServerDelegate.sendMessage(e)},_resUpgrade:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.TECHNOLOGY_REFRESH)},_reqTechnologyAdvance:function(t){var e={};e.module=td.MsgModuleName.Technology,e.cmd=td.MsgCmd.TECHNOLOGY.TECHNOLOGY_ADVANCE,e.type=t,td.ServerDelegate.sendMessage(e)},_reqReset:function(){var t={};t.module=td.MsgModuleName.Technology,t.cmd=td.MsgCmd.TECHNOLOGY.TECHNOLOGY_RESET,td.ServerDelegate.sendMessage(t)},_resAdvance:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_TECHNOLOGY_ADVANCED)},_resReset:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n),this._technologies={},this._tecEffectMap={},this._initTechnologies(),this._refresEffect(),td.EventUtil.dispatchEvent(td.EventNameEnum.RES_TECHNOLOGY_RESET)}},_initTechnologies:function(){this._technologies={},this._advanceList={};var t=td.GetTableClass(td.TableEnum.TechnologyTable).getVocationData();for(var e in t){this._advanceList[e]=0,this._technologies[e]=this._technologies[e]||{};var i=t[e];for(var a in i){var r=i[a],o=new n;o.init(r),this._technologies[e][a]=o}}},_refresEffect:function(){for(var t in this._advanceList){var e=parseInt(t),i=this._advanceList[t],n=td.GetTableClass(td.TableEnum.TechnologyAdvanceTable).getConfig(e,i),a={};a[n.effectTypeId]=n.effect,this._advanceEffectMap[e]=a,this._tecEffectMap[t]||(this._tecEffectMap[t]={});var r=this._technologies[e];for(var o in r){var s=r[o].getLevel();if(0!==s){var l=td.GetTableClass(td.TableEnum.TechnologyLevelTable).getConfig(parseInt(o),s),c=l.effectTypeId,u=l.effect,d=this._tecEffectMap[e]||{};d[c]=u,this._tecEffectMap[e]=d}}}},getAdvanceEfect:function(t){return this._advanceEffectMap[t]},getTecEffect:function(t){return this._tecEffectMap[t]}},cc._RF.pop()},{TechnologyModel:"TechnologyModel"}],TechnologyModel:[function(t,e,i){"use strict";cc._RF.push(e,"5a3fbxctSRPhY8x1MkHyq+P","TechnologyModel");var n=t("Model"),a=cc.Class({extends:n,properties:{_id:null,_vocation:null,_name:null,_icon:null,_level:null},init:function(t){this._super("TechnologyModel"),t&&(this._id=t.id||0,this._vocation=t.vocation||0,this._name=t.name||"",this._icon=t.icon||"",this._level=0)},getId:function(){return this._id},getVocation:function(){return this._vocation},setLevel:function(t){this._level=t},getLevel:function(){return this._level},getName:function(){return this._name},getIcon:function(){return this._icon}});e.exports=a,cc._RF.pop()},{Model:"Model"}],TechnologyTable:[function(t,e,i){"use strict";cc._RF.push(e,"03598AneLJOOaKsLeAn+woA","TechnologyTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"TechnologyTable",properties:{_tblName:"technology_config",_data:null,_vocation:null,_unlock:null},init:function(){this._data={},this._vocation={};for(var t=this._data,e=this._vocation,i=this._jsonData,n=0,a=i.length-1;n<=a;n++){var r=i[n],o=r.id;t[o]=r;var s=r.vocation;e[s]=e[s]||{},e[s][o]=r}},getById:function(t){return this._data[t]},getVocationData:function(){return this._vocation}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TianYuanHuLuZhen:[function(t,e,i){"use strict";cc._RF.push(e,"e293dgAfJNFR7TcwTlbpHeB","TianYuanHuLuZhen");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="TianYuanHuLuZhen"}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],TicketsGetItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"74e3dsXIbhC/YAFP1o4gjD+","TicketsGetItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numBg=null,e.labNum=null,e.labDesc=null,e.labTicketNum=null,e.imgIcon=null,e.btnGet=null,e.imgGot=null,e.btnGoto=null,e._curActivityType=0,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.isRecharge;if(this._curActivityType=i.activityType,n){this.labDesc.string=i.desc;var a=i.value,o=a>0;this.labNum.node.active=o,this.btnGet.active=o,this.btnGoto.active=!o,o&&(this.labNum.string="x"+a),this._curActivityType==r.ActivityEnum.ActivityType.TimeLimitGacha?this.labTicketNum.string=cc.js.formatStr(r.Language.StoreGachaTickets,a):this.labTicketNum.string=cc.js.formatStr(r.Language.haveTicketCount,a);var s=i.itemId,l=r.GetTableClass(r.TableEnum.Item).getItemById(s);if(l){var c=new r.Item;c.init(l),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,c.getIconRes(),this.imgIcon)}}},e.prototype.onBtnReceive=function(){var t=r.ActivityDataManager.getActivityControllerByType(this._curActivityType);if(null!=t){var e={id:t.getCanExchangeTicket()};this._curActivityType==r.ActivityEnum.ActivityType.TimeLimitGacha&&(e.parmeterMap={39:2}),t.operateActivity(e)}},e.prototype.onBtnGoto=function(){if(this._item.isRecharge){var t=r.PanelManager.getInstance().getCurShowWindow();if(t){var e=t.getComponent("PanelBase");e&&e.closeCallFunc()}var i=r.ActivityDataManager.getActivityControllerByType(this._curActivityType);i&&i.setJumpToRecharge&&i.setJumpToRecharge(),r.GlobalFunction.inActivityGotoRecharge([r.ActivityEnum.Activity.ActivityConfig,this._curActivityType])}},a([l(cc.Node)],e.prototype,"numBg",void 0),a([l(cc.Label)],e.prototype,"labNum",void 0),a([l(cc.Label)],e.prototype,"labDesc",void 0),a([l(cc.Label)],e.prototype,"labTicketNum",void 0),a([l(cc.Node)],e.prototype,"imgIcon",void 0),a([l(cc.Node)],e.prototype,"btnGet",void 0),a([l(cc.Node)],e.prototype,"imgGot",void 0),a([l(cc.Node)],e.prototype,"btnGoto",void 0),e=a([s,c("module/Activity/TicketsGetItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],TicketsGetWindow:[function(t,e,i){"use strict";cc._RF.push(e,"ac0b3JmnrFMC7u/vqZrHgP5","TicketsGetWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labTitle=null,e._controller=null,e}return n(e,t),e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListners()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this)},e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_TicketsGetWindow},e.prototype._addEventListners=function(){var t={},e=r.EventNameEnum;t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this._refreshList,t[e.PUSH_ACTIVITY_INFO]=this._refreshList,t[e.Res_GET_ACTIVITY_INFO]=this._refreshList,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(t){this._controller=r.ActivityDataManager.getActivityControllerByType(t.activityType),this._refreshList(),t&&(this.labTitle.string=t.title||this.labTitle.string)},e.prototype._refreshList=function(){var t;null!=this._controller&&(t=this._controller.getTaskList(),this.node.getComponent(d).refreshListData(t))},a([l(cc.Label)],e.prototype,"labTitle",void 0),e=a([s,c("module/Activity/TicketsGetWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],TicketsWindowItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"73fb0hkxz1As6zHSuN624rr","TicketsWindowItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numBg=null,e.labNum=null,e.labDesc=null,e.labTicketNum=null,e.btnGet=null,e.imgGot=null,e.btnGoto=null,e}return n(e,t),e.prototype.updateItem=function(e,i){if(t.prototype.updateItem.call(this,e,i),i.isRecharge){this.labDesc.string=i.desc;var n=i.value,a=n>0;this.labNum.node.active=a,this.btnGet.active=a,this.btnGoto.active=!a,a&&(this.labNum.string="x"+n),this.labTicketNum.string=cc.js.formatStr(r.Language.haveTicketCount,n)}},e.prototype.onBtnReceive=function(){var t=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.GodEquipGacha);if(null!=t){var e={id:t.getCanExchangeTicket()};t.operateActivity(e)}},e.prototype.onBtnGoto=function(){if(this._item.isRecharge){var t=r.PanelManager.getInstance().getCurShowWindow();if(t){var e=t.getComponent("PanelBase");e&&e.closeCallFunc()}var i=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.GodEquipGacha);i&&i.setJumpToRecharge(),r.GlobalFunction.inActivityGotoRecharge([r.ActivityEnum.Activity.ActivityConfig,r.ActivityEnum.ActivityType.GodEquipGacha])}},a([l(cc.Node)],e.prototype,"numBg",void 0),a([l(cc.Label)],e.prototype,"labNum",void 0),a([l(cc.Label)],e.prototype,"labDesc",void 0),a([l(cc.Label)],e.prototype,"labTicketNum",void 0),a([l(cc.Node)],e.prototype,"btnGet",void 0),a([l(cc.Node)],e.prototype,"imgGot",void 0),a([l(cc.Node)],e.prototype,"btnGoto",void 0),e=a([s,c("module/Activity/TicketsWindowItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],TimeLimitGachaBoxWindow:[function(t,e,i){"use strict";cc._RF.push(e,"5b6f2JSigJIQq+Nx7wkxvMY","TimeLimitGachaBoxWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.rewardsLayer=null,e.operateBtn=null,e.btnLabel=null,e.tipsLabel=null,e._boxScore=0,e._controller=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_BoxWindow},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){r.EventNameEnum;r.EventUtil.registerEvents({},this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._boxScore=e.boxScore,this.tipsLabel.string=cc.js.formatStr(r.Language.TimeLimitGachaProgress,this._boxScore),this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.TimeLimitGacha),this._refreshRewards(),this._refreshBtnStatus()},e.prototype._refreshRewards=function(){if(this.rewardsLayer.removeAllChildren(),null!=this._controller){var t=this._controller.getRewardsByBoxScore(this._boxScore);if(t){var e=t.length;t=r.RewardManager.getRewardDetailArray(t);for(var i=0;i<e;i++){var n=r.GlobalFunction.createCommonIconWidget(27,t[i]);n.getComponent("CommonIconWidget").setNameBgVisible(!1),this.rewardsLayer.addChild(n)}this.rewardsLayer.getComponent(cc.Layout).updateLayout()}else cc.log("getRewardsByProgress error for boxScore = "+this._boxScore)}},e.prototype._refreshBtnStatus=function(){if(null!=this._controller){var t=this._controller.isBoxCanReceive(this._boxScore),e=this._controller.isBoxReceived(this._boxScore);r.GlobalFunction.setButtonGray(this.operateBtn,!t);var i=e?r.Language.recevied:r.Language.recevie;this.btnLabel.string=i}},e.prototype.onReceiveRewards=function(){var t=this._controller.isBoxCanReceive(this._boxScore),e=this._controller.isBoxReceived(this._boxScore);if(t&&!e){var i={id:this._boxScore,parmeterMap:{39:1}};this._controller.operateActivity(i)}this.closeCallFunc()},a([l(cc.Node)],e.prototype,"rewardsLayer",void 0),a([l(cc.Node)],e.prototype,"operateBtn",void 0),a([l(cc.Label)],e.prototype,"btnLabel",void 0),a([l(cc.Label)],e.prototype,"tipsLabel",void 0),e=a([s,c("module/Activity/TimeLimitGachaBoxWindow")],e)}(t("PanelBase"));i.default=u,cc._RF.pop()},{PanelBase:void 0}],TimeLimitGachaController:[function(t,e,i){"use strict";cc._RF.push(e,"feac0j6t8tBP5uiDL9FNPJ+","TimeLimitGachaController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("../../../Gacha/Manager/GachaEnum"),r=t("../../../Gacha/Manager/GachaManager"),o=t("HeroModel"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataID=1001,e._charge=0,e._score=0,e._converted=0,e._receivedList=[],e._rankList=[],e._myRank=0,e._gachaType=0,e._heroData=null,e._isOpened=!1,e._isJumpToRecharge=!1,e}return n(e,t),e.prototype.initData=function(e){this.clearData(),t.prototype.initData.call(this,e),this.addListener(),this.addEventListener(),this._currencyId=td.GetConfig("ACTIVITY_39_GOODS_ID")||td.ItemEnum.TimeLimitTicket,this._gachaType=a.GachaType.TIME_LIMIT_GACHA,this._dataID=this.getActivityData()},e.prototype.clearData=function(){this._dataId=0,this._score=0,this._gachaType=0,this._currencyId=0,this._heroData=null},e.prototype.addListener=function(){},e.prototype.addEventListener=function(){td.EventNameEnum;td.EventUtil.registerEvents({},this)},e.prototype.activityParse=function(t){var e=t.record,i=t.global;this._charge=e.charge||0,this._score=e.score||0,this._converted=e.converted||0,this._receivedList=e.receivedList||[],this._rankList=i.rankList||[],this.setMyRank(),td.EventUtil.dispatchEvent(td.EventNameEnum.TIME_LIMIT_GACHA_INFO_CHANGE)},e.prototype.getCurCfg=function(){var t=td.GetTableClass(td.TableEnum.TimeLimitGachaTable);return t?t.getCfgByDataId(this._dataID):null},e.prototype.getCurGachaId1=function(){var t=this.getCurCfg();return null==t?0:t.scores[0][0]},e.prototype.getCurGachaId2=function(){var t=this.getCurCfg();return null==t?0:t.scores[1][0]},e.prototype.getCurBoxs=function(){var t=this.getCurCfg();return null==t?[]:t.scoreRewards},e.prototype.getShowHeroData=function(){if(this._heroData)return this._heroData;var t=this.getShowHeroId(),e=td.GetTableClass(td.TableEnum.HeroTable).getHeroById(t);return this._heroData=new o,this._heroData.init(e),this._heroData},e.prototype.getShowHeroId=function(){var t=this.getCurCfg();return null==t?0:t.starHero},e.prototype.getHeroRes=function(){var t=this.getShowHeroData();return t?t.getAnimationRes():""},e.prototype.getRankCfgList=function(){var t=td.GetTableClass(td.TableEnum.TimeLimitGachaRankTable);if(null!=t){for(var e=t.getAllCfgByDataId(this._dataID),i=[],n=0;n<e.length;n++){var a=e[n],r=n-1,o={};if(r>=0&&r<e.length){var s=e[r];s.rank+1!=a.rank?o.rank=s.rank+1+"~"+a.rank:o.rank=a.rank,o.rewards=a.rewards}else o.rank=a.rank,o.rewards=a.rewards;i.push(o)}return i}},e.prototype.getMyRankRewards=function(){var t=td.GetTableClass(td.TableEnum.TimeLimitGachaRankTable);return null==t?[]:t.getRewardsByDataIdAndRank(this._dataID,this._myRank)},e.prototype.setMyRank=function(){for(var t=0;t<this._rankList.length;t++){var e=this._rankList[t],i=e.attributes[td.UserPropertyEnum.GamerId];if(td.Account.getUserData().getGamerId()==i){this._myRank=e.rank;break}}},e.prototype.getMyRank=function(){return this._myRank},e.prototype.setJumpToRecharge=function(){this._isJumpToRecharge=!0},e.prototype.isFromRecharge=function(){var t=this._isJumpToRecharge;return this._isJumpToRecharge=!1,t},e.prototype.getCanExchangeTicket=function(){var t=td.GetConfig("ACTIVITY_39_GOODS_UNIT");return Math.floor((this._charge-this._converted)/t)},e.prototype.getTaskList=function(){var t=[],e={},i=td.GetConfig("ACTIVITY_39_GOODS_UNIT");return e.activityType=this.getActivityType(),e.isRecharge=!0,e.itemId=this._currencyId,e.value=this.getCanExchangeTicket(),e.desc=cc.js.formatStr(td.Language.treasureGiftExchange,i/10),t[t.length]=e,t},e.prototype.getGachaType=function(){return this._gachaType},e.prototype.getCurrencyId=function(){return this._currencyId},e.prototype.getCurrencyNum=function(){return this._currencyId?td.ItemManager.getItemNumById(this._currencyId):0},e.prototype.getCurScore=function(){return this._score},e.prototype.getLastBoxScore=function(){var t=td.GetTableClass(td.TableEnum.TimeLimitGachaTable);return t?t.getLastBoxScoreByDataIdAndScore(this._dataID,this._score):null},e.prototype.getNextBoxScore=function(){var t=td.GetTableClass(td.TableEnum.TimeLimitGachaTable);return t?t.getNextBoxScoreByDataIdAndScore(this._dataID,this._score):null},e.prototype.getRewardsByBoxScore=function(t){var e=td.GetTableClass(td.TableEnum.TimeLimitGachaTable);return e?e.getRewardsByDataIdAndScore(this._dataID,t):null},e.prototype.getRankList=function(){return this._rankList},e.prototype.isBoxCanReceive=function(t){return this._score>=t},e.prototype.isBoxReceived=function(t){return-1!=this._receivedList.indexOf(t)},e.prototype.hasRedPoint=function(){return!0},e.prototype.onOpenPanel=function(){this._isOpened=!0,td.GlobalFunction.setLocalSaveStatus("TimeLimitGacha","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.TIME_LIMIT_GACHA_PANEL_SHOW)},e.prototype.isLoginTodayShow=function(){return!td.GlobalFunction.getLocalSaveStatus("TimeLimitGacha")},e.prototype.isTicketsMoreThan10=function(){return this.getCurrencyNum()>=10},e.prototype.isHaveTicketsToReceive=function(){return this.getCanExchangeTicket()>0},e.prototype.isFreeGacha=function(t){var e=r.default.getInstance().getGachaListById(t);if(e){var i=e.getNextFreeTime();if(i>0&&i-td.TimeUtil.getTime()<=0)return!0}return!1},e.prototype.isHaveFreeTimes=function(){return!(!this.isFreeGacha(this.getCurGachaId1())&&!this.isFreeGacha(this.getCurGachaId2()))},e.prototype.isRedPointTip=function(){return this.isLoginTodayShow()||this.isTicketsMoreThan10()||this.isHaveTicketsToReceive()},e.prototype.redPointEvts=function(){return[td.EventNameEnum.TIME_LIMIT_GACHA_PANEL_SHOW,td.EventNameEnum.TIME_LIMIT_GACHA_INFO_CHANGE,td.EventNameEnum.ON_ACTIVITY_OPERATE_SUCCESS]},e}(t("ActivityBaseController"));i.default=s,e.exports=s,cc._RF.pop()},{"../../../Gacha/Manager/GachaEnum":"GachaEnum","../../../Gacha/Manager/GachaManager":"GachaManager",ActivityBaseController:"ActivityBaseController",HeroModel:"HeroModel"}],TimeLimitGachaPanel:[function(t,e,i){"use strict";cc._RF.push(e,"ab2d16tTYJAwKIDxo49hSy7","TimeLimitGachaPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../Gacha/Manager/GachaManager"),o=window.td,s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labActivityTime=null,e.labMyRank=null,e.labScore=null,e.nodeBoxs=null,e.nodeHeroModel=null,e.progress=null,e.nodeRank=null,e.btnTickets=null,e.nodeBoxModel=null,e.nodeOnce=null,e.nodeTen=null,e.nodeCostTip=null,e._activityCotr=null,e._setBtns=!0,e._nextFreeTime1=0,e._nextFreeTime10=0,e}return n(e,t),e.prototype.init=function(){this._panelType=o.PanelType.Panel,this._panelEnum=o.PanelEnum.Panel_TimeLimitGacha},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._activityCotr=o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.TimeLimitGacha),this._addEventListener(),this._activityCotr&&(this._activityCotr.isFromRecharge()&&this.onBtnGetClick(),this._activityCotr.onOpenPanel(),r.default.getInstance().setCurGachaId(0),r.default.getInstance().setIsActivityGacha(!1),o.RedPointUtil.createRedPointOld(this.btnTickets,cc.v2(-30,-15),this._activityCotr.isHaveTicketsToReceive.bind(this._activityCotr),this._activityCotr.redPointEvts()),this._refreshUI())},e.prototype.onDisable=function(){o.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this.unschedule(this.loopEndTime1),this.unschedule(this.loopEndTime10)},e.prototype._addEventListener=function(){var t={},e=o.EventNameEnum;t[e.RES_GACHA]=this._onReward,t[e.ON_ACTIVITY_OPERATE_SUCCESS]=this._refreshUI,o.EventUtil.registerEvents(t,this)},e.prototype._refreshUI=function(){this._initActivityTime(),this.labScore.string=this._activityCotr.getCurScore()+"",this._refreshHeroModel(),o.TaskListManager.pushTask(this._panelEnum,null,this._refreshBtns.bind(this)),o.TaskListManager.pushTask(this._panelEnum,null,this._refreshBoxs.bind(this)),o.TaskListManager.pushTask(this._panelEnum,null,this._refreshRank.bind(this))},e.prototype._initActivityTime=function(){var t=this,e=this._controller.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=e.closeTime-o.TimeUtil.getTime();i>0?o.GlobalFunction.addTimeLabel2(this.labActivityTime.node,i,function(){t.labActivityTime.string=o.Language.ActivityOver},o.Language.timeCountPattern3):this.labActivityTime.string=o.Language.ActivityOver}},e.prototype._refreshHeroModel=function(){var t=this._activityCotr.getShowHeroData();o.GlobalFunction.showMercenaryFigureAnimation(this.nodeHeroModel,t,!0),o.TaskListManager.pushTask(this._panelEnum,null,this.showDizuoEffect.bind(this))},e.prototype.showDizuoEffect=function(){this.nodeHeroModel.getChildByName("YingXiongDiZuo_effect")?this._switchDizuoEffect():this.loadRes("uiAnima/YingXiongDiZuo_effect/YingXiongDiZuo_effect",cc.Prefab,this.addDizuoEffect.bind(this))},e.prototype.addDizuoEffect=function(){if(cc.isValid(this.nodeHeroModel))if(this.nodeHeroModel.getChildByName("YingXiongDiZuo_effect"))this._switchDizuoEffect();else{var t=gdk.rm.getResByUrl("uiAnima/YingXiongDiZuo_effect/YingXiongDiZuo_effect",cc.Prefab),e=cc.instantiate(t);e.name="YingXiongDiZuo_effect",e.x=0,e.y=0,e.scale=1/this.nodeHeroModel.scale,this.nodeHeroModel.addChild(e,-1),this._switchDizuoEffect()}},e.prototype._switchDizuoEffect=function(){var t=this._activityCotr.getShowHeroData();if(t){var e=this.nodeHeroModel.getChildByName("YingXiongDiZuo_effect");if(e){var i=e.getComponent(cc.Animation),n=i.getClips()[t.getQuality()-2].name;i.play(n)}}},e.prototype._refreshRank=function(){if(null!=this._activityCotr){for(var t=this._activityCotr.getRankList(),e=0;e<3;e++){var i=t[e],n=this.nodeRank.getChildByName("nodeRankInfo"+(e+1));if(i&&n){var a=this.nodeRank.getChildByName("labScore"+(e+1)).getComponent(cc.Label),r=n.getChildByName("labServer").getComponent(cc.Label),s=n.getChildByName("labName").getComponent(cc.Label),l=i.attributes,c=i.score,u=l[o.UserPropertyEnum.NickName],d=l[o.UserPropertyEnum.ServerId];a.string=c+"";var h="["+o.Language.serverArea+"]";r.string=cc.js.formatStr(h,d),s.string=u}}this.labMyRank.string=this._activityCotr.getMyRank()||o.Language.notInRank}},e.prototype._refreshBoxs=function(){if(null!=this._activityCotr){for(var t=this._activityCotr.getCurBoxs(),e=t.length,i=this.nodeBoxs.width,n=-1,a=0;a<t.length;a++){var r=t[a],s=this.nodeBoxs.getChildByName("boxNode"+a);s||((s=cc.instantiate(this.nodeBoxModel)).active=!0,s.parent=this.nodeBoxs,s.x=(a+1)/e*i,s.y=0,s.name="boxNode"+a);var l=s.getChildByName("imgOpen"),c=s.getChildByName("imgNormal");s.getChildByName("labNum").getComponent(cc.Label).string=r[0];var u=this._activityCotr.isBoxCanReceive(r[0]),d=this._activityCotr.isBoxReceived(r[0]);l.active=d,s.score=r[0],s.canReceive=u&&!d,u&&n<=a&&(n=a),c.stopAllActions();var h=s.getChildByName("BoxEffect");if(u&&!d){c.active=!0;var p=cc.sequence(cc.rotateTo(.2,3),cc.rotateTo(.2,-3),cc.rotateTo(.2,3),cc.rotateTo(.2,-3),cc.rotateTo(.1,0),cc.delayTime(.4)).repeatForever();if(c.runAction(p),h){h.active=!0,h.getComponent(cc.Animation).play()}else{var _=o.GlobalFunction.getResIdByNode(s);gdk.rm.loadRes(_,"uiAnima/BaoXiang_guangxiao/BaoXiang_guangxiao",cc.Prefab,this._addBoxEffect.bind(this,s))}}else u?h&&(h.active=!1,h.removeFromParent()):(c.active=!0,l.active=!1,h&&(h.active=!1,h.removeFromParent()))}var g=this._activityCotr.getCurScore(),f=this._activityCotr.getLastBoxScore(),v=(g-f)/(this._activityCotr.getNextBoxScore()-f||1);this.progress.progress=(n+1+v)/(e||1)}},e.prototype._addBoxEffect=function(t){if(cc.isValid(t)){var e=t.getChildByName("BoxEffect");if(!e){var i=gdk.rm.getResByUrl("uiAnima/BaoXiang_guangxiao/BaoXiang_guangxiao",cc.Prefab);(e=cc.instantiate(i)).name="BoxEffect",t.addChild(e,-1),e.scale=.68}e.getComponent(cc.Animation).play()}},e.prototype._refreshBtns=function(){this._setBtnInfo(this.nodeOnce,{gachaId:this._activityCotr.getCurGachaId1(),isTen:!1}),this._setBtnInfo(this.nodeTen,{gachaId:this._activityCotr.getCurGachaId2(),isTen:!0}),this._setBtns=!0},e.prototype._setBtnInfo=function(t,e){if(null!=t){var i=r.default.getInstance().getGachaListById(e.gachaId);if(i){var n=t.getChildByName("nodeCost"),a=n.getChildByName("imgCost"),s=t.getChildByName("btn").getChildByName("Label").getComponent(cc.Label),l=n.getChildByName("labCost").getComponent(cc.Label),c=n.getChildByName("labTotal").getComponent(cc.Label);a.active=!0;var u=i.getCost(),d=i.getNextFreeTime(),h=d>0&&d-o.TimeUtil.getTime()<=0,p=i.getGoodsCostNum()||0,_=i.getGoodsCost(),g=o.ItemManager.getItemNumById(_),f=(o.Account.getUserData().getDiamond(),i.getDisCount());u>0&&p<=0?this._setBtns&&(this.btnTickets.active=!1):(this.btnTickets.active=!0,this._setBtns=!1);var v=1;if(e.isTen?(v=10,g>0&&g<v&&(v=g),s.string=cc.js.formatStr(o.Language.summonTimes,v),this._nextFreeTime10=d,this.loopEndTime10()):(this._nextFreeTime1=d,this.loopEndTime1()),u>0&&g<=0){if(c.node.active=!1,l.string=u*v*f+"",this.nodeCostTip.active=!1,m=o.GetTableClass(o.TableEnum.Item).getItemById(i.getCostId()))(y=new o.Item).init(m),y&&o.GlobalFunction.createAltasSprite(o.resDef.pngPlist.icon_item,y.getLittleIconResPath(),a)}else if(p>0){var m,y;if(c.node.active=!0,l.string=g+"",c.string="/"+v*p,l.node.color=g>=v?cc.color(42,255,0):cc.color(255,0,0),this.nodeCostTip.active=!0,m=o.GetTableClass(o.TableEnum.Item).getItemById(_))(y=new o.Item).init(m),y&&o.GlobalFunction.createAltasSprite(o.resDef.pngPlist.icon_item,y.getLittleIconResPath(),a)}h&&(a.active=!1,c.node.active=!1,l.string=o.Language.freeTips,l.node.color=cc.color(42,255,0)),d>0&&(e.isTen?(this.unschedule(this.loopEndTime10),this.schedule(this.loopEndTime10,1)):(this.unschedule(this.loopEndTime1),this.schedule(this.loopEndTime1,1)))}}},e.prototype.loopEndTime1=function(){var t=Math.floor((this._nextFreeTime1-o.TimeUtil.getTime())/1e3),e=this.nodeOnce.getChildByName("nodeTime");t>0?(e.active=!0,e.getChildByName("labTime").getComponent(cc.Label).string=o.GlobalFunction.getConvertTimeFormat(t)):e.active=!1},e.prototype.loopEndTime10=function(){var t=Math.floor((this._nextFreeTime10-o.TimeUtil.getTime())/1e3),e=this.nodeTen.getChildByName("nodeTime");t>0?(e.active=!0,e.getChildByName("labTime").getComponent(cc.Label).string=o.GlobalFunction.getConvertTimeFormat(t)):e.active=!1},e.prototype._onReward=function(t){o.PanelJumpManager.jumpToPanel(o.PanelEnum.Panel_GachaReward,t)},e.prototype.onBoxClick=function(t){var e=t.target,i=e.score;if(e.canReceive){var n={id:i,parmeterMap:{39:1}};this._activityCotr.operateActivity(n)}else o.PanelJumpManager.jumpToPanel(o.PanelEnum.Window_BoxWindow,{boxScore:i})},e.prototype.onBtnRewardsCliCK=function(){o.PanelJumpManager.jumpToPanel(o.PanelEnum.Window_RewardsRankWindow)},e.prototype.onBtnGetClick=function(){o.PanelJumpManager.jumpToPanel(o.PanelEnum.Window_TicketsGetWindow,{activityType:this._activityType,title:o.Language.GetGachaTickets})},e.prototype.onBtnInfoClick=function(){var t={_isFromFragment:!1,heroModel:this._activityCotr.getShowHeroData()};o.PanelJumpManager.jumpToPanel(o.PanelEnum.Window_HeroInfoTips,t)},e.prototype.onBtnOnce=function(){var t=this._activityCotr.getCurGachaId1();r.default.getInstance().setCurGachaId(t),r.default.getInstance().setIsActivityGacha(!0);var e=r.default.getInstance().getGachaListById(t);if(e){var i=e.getNextFreeTime(),n=e.getCost(),a=o.Account.getUserData().getDiamond(),s={};s.id=t,s.times=1;var l=e.getGoodsCost(),c=(o.ItemManager.getItemNumById(l),o.ItemManager.getItemNumById(l));if(i>0&&i<=o.TimeUtil.getTime())s.useGoods=!1;else if(c>=1)s.useGoods=!0;else{if(!(0!=n&&a>=n)){if(0===n){var u=new o.BroadcastContent(31);o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_BROADCAST,u),this.onBtnGetClick()}else{var d={};d.strArray=[o.Language.diamondlack],d.okCallFunc=o.GlobalFunction.gotoRecharge.bind(o.GlobalFunction),d.strBtnYes=o.Language.goto,d.strBtnNo=o.Language.cancel,o.GlobalFunction.showConfirmWindow(d)}return}s.useGoods=!1}var h=this._activityCotr.getGachaType();r.default.getInstance().setType(h),o.EventUtil.dispatchEvent(o.EventNameEnum.REQ_GACHA,s)}},e.prototype.onBtnTen=function(){var t=this._activityCotr.getCurGachaId2();r.default.getInstance().setCurGachaId(t),r.default.getInstance().setIsActivityGacha(!0);var e=r.default.getInstance().getGachaListById(t);if(e){var i=10,n={};n.id=t;var a=e.getGoodsCost(),s=o.ItemManager.getItemNumById(a);s>0&&s<i&&(i=s),n.times=i;var l=e.getNextFreeTime(),c=(l>0&&o.TimeUtil.getTime(),e.getCost()),u=o.Account.getUserData().getDiamond(),d=e.getDisCount();if(l>0&&l<=o.TimeUtil.getTime())n.useGoods=!1;else if(s>=i)n.useGoods=!0;else{if(!(0!=c&&u>=10*c*d)){if(0===c){var h=new o.BroadcastContent(31);o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_BROADCAST,h),this.onBtnGetClick()}else{var p={};p.strArray=[o.Language.diamondlack],p.okCallFunc=o.GlobalFunction.gotoRecharge.bind(o.GlobalFunction),p.strBtnYes=o.Language.goto,p.strBtnNo=o.Language.cancel,o.GlobalFunction.showConfirmWindow(p)}return}n.useGoods=!1}var _=this._activityCotr.getGachaType();r.default.getInstance().setType(_),o.EventUtil.dispatchEvent(o.EventNameEnum.REQ_GACHA,n)}},a([c(cc.Label)],e.prototype,"labActivityTime",void 0),a([c(cc.Label)],e.prototype,"labMyRank",void 0),a([c(cc.Label)],e.prototype,"labScore",void 0),a([c(cc.Node)],e.prototype,"nodeBoxs",void 0),a([c(cc.Node)],e.prototype,"nodeHeroModel",void 0),a([c(cc.ProgressBar)],e.prototype,"progress",void 0),a([c(cc.Node)],e.prototype,"nodeRank",void 0),a([c(cc.Node)],e.prototype,"btnTickets",void 0),a([c(cc.Node)],e.prototype,"nodeBoxModel",void 0),a([c(cc.Node)],e.prototype,"nodeOnce",void 0),a([c(cc.Node)],e.prototype,"nodeTen",void 0),a([c(cc.Node)],e.prototype,"nodeCostTip",void 0),e=a([l,u("module/Activity/TimeLimitGachaPanel")],e)}(t("ActivityBasePanel"));i.default=d,cc._RF.pop()},{"../../../Gacha/Manager/GachaManager":"GachaManager",ActivityBasePanel:"ActivityBasePanel"}],TimeLimitGachaRankItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"3d10dKwDwtHEZrnjOHsgL/j","TimeLimitGachaRankItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("ListItem"),d=t("BaseUser"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgRank=null,e.labRank=null,e.labName=null,e.labNation=null,e.labScore=null,e.labCombat=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.rank,a=i.attributes,o=i.score,s=new d;s.updateAttr(a),n<4?(this.imgRank.active=!0,this.labRank.node.active=!1,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.GY0_Common,"GY0_paiming_0"+n,this.imgRank)):(this.imgRank.active=!1,this.labRank.node.active=!0,this.labRank.string=""+n);var l=a[r.UserPropertyEnum.NickName],c=a[r.UserPropertyEnum.ServerId],u=a[r.UserPropertyEnum.NATION_NAME],h=a[r.UserPropertyEnum.FightPower],p="["+r.Language.serverArea+"] ";this.labName.string=cc.js.formatStr(p,c)+l,this.labNation.string=u||r.Language.notJoinArmy,this.labScore.string=o+"",this.labCombat.string=h;var _=this.node.getChildByName("headWidget");_?_.getComponent("AvatarHeadWidget").setData(s):((_=r.GlobalFunction.createAvatarHeadWidget(7,s,!1)).getComponent("AvatarHeadWidget").disableHeadTouch(),_.scale=.8,_.setName("headWidget"),_.setPosition(cc.v2(-130,0)),this.node.addChild(_))},a([l(cc.Node)],e.prototype,"imgRank",void 0),a([l(cc.Label)],e.prototype,"labRank",void 0),a([l(cc.Label)],e.prototype,"labName",void 0),a([l(cc.Label)],e.prototype,"labNation",void 0),a([l(cc.Label)],e.prototype,"labScore",void 0),a([l(cc.Label)],e.prototype,"labCombat",void 0),e=a([s,c("module/Activity/TimeLimitGachaRankItemUI")],e)}(u);i.default=h,cc._RF.pop()},{BaseUser:"BaseUser",ListItem:void 0}],TimeLimitGachaRankTable:[function(t,e,i){"use strict";cc._RF.push(e,"69365vw1JFJGpDFUFzqnIAm","TimeLimitGachaRankTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="TimeLimitGachaRankTable",e._tblName="activity_39_rank_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getAllCfgByDataId=function(t){return null==this._data?null:this._data[t]},e.prototype.getRewardsByDataIdAndRank=function(t,e){if(null==this._data)return null;for(var i=this._data[t],n=0;n<i.length;n++){var a=i[n];if(e>0&&e<=a.rank)return a.rewards}return[]},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TimeLimitGachaRankWindow:[function(t,e,i){"use strict";cc._RF.push(e,"e222cMOv2pEsqeqq0DGj0S2","TimeLimitGachaRankWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=t("TabController"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeReward=null,e.nodeRank=null,e.btnReward=null,e.btnRank=null,e.labTitle=null,e._showTab=0,e._controller=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_AncientCorridorRank},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.TimeLimitGacha),this._addEventListener(),this._showTab=0,this._tableController||(this._tableController=new h,this.btnReward._tag=1,this.btnRank._tag=2,this._tableController.init([this.btnReward,this.btnRank],this)),this._tableController.showTab(1)},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.RES_GET_LIMITED_TIME_CHARGE_INFO]=this.initReward,r.EventUtil.registerEvents(t,this)},e.prototype.showTab=function(t){this._showTab=t,1===this._showTab?(this.nodeRank.active=!1,this.nodeReward.active=!0,this._initRewardInfo()):(this.nodeRank.active=!0,this.nodeReward.active=!1,this._initRankInfo())},e.prototype._initRewardInfo=function(){var t=this.nodeReward.getChildByName("labRank"),e=this.nodeReward.getChildByName("rewardPanel"),i=this._controller.getMyRank();t.getComponent(cc.Label).string=i<=0?r.Language.notInRank:""+i;var n=this._controller.getRankCfgList(),a=this._controller.getMyRankRewards();if(a&&a.length>0){a=r.RewardManager.getRewardDetailArray(a),e.removeAllChildren();for(var o=0,s=a.length;o<s;o++){var l=r.GlobalFunction.createCommonIconWidget(26,a[o]);l.scale=.7,e.addChild(l)}e.getComponent(cc.Layout).updateLayout()}this.nodeReward.getComponent(d).refreshListData(n)},e.prototype._initRankInfo=function(){var t=this._controller.getRankList();this.nodeRank.getComponent(d).refreshListData(t)},a([l(cc.Node)],e.prototype,"nodeReward",void 0),a([l(cc.Node)],e.prototype,"nodeRank",void 0),a([l(cc.Node)],e.prototype,"btnReward",void 0),a([l(cc.Node)],e.prototype,"btnRank",void 0),a([l(cc.Label)],e.prototype,"labTitle",void 0),e=a([s,c("module/Activity/TimeLimitGachaRankWindow")],e)}(u);i.default=p,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0,TabController:void 0}],TimeLimitGachaRewardItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"7badedpUztFYLSyP6G78Y/Z","TimeLimitGachaRewardItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});t("AvatarHeadWidget");var r=window.td,o=t("ListItem"),s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labRank=null,e.reardPanel=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.rank;this.labRank.string="NO."+n;for(var a=r.RewardManager.getRewardDetailArray(i.rewards),o=0,s=a.length;o<s;o++){var l=r.GlobalFunction.createCommonIconWidget(26,a[o]);l.scale=.7,this.reardPanel.addChild(l)}this.reardPanel.getComponent(cc.Layout).updateLayout()},a([c(cc.Label)],e.prototype,"labRank",void 0),a([c(cc.Node)],e.prototype,"reardPanel",void 0),e=a([l,u("module/Activity/TimeLimitGachaRewardItemUI")],e)}(o);i.default=d,cc._RF.pop()},{AvatarHeadWidget:void 0,ListItem:void 0}],TimeLimitGachaTable:[function(t,e,i){"use strict";cc._RF.push(e,"404ecc3TsFBRa4rb1awcoLj","TimeLimitGachaTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="TimeLimitGachaTable",e._tblName="activity_39_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[a.data]=a}},e.prototype.getCfgByDataId=function(t){return null==this._data?null:this._data[t]},e.prototype.getRewardsByDataIdAndScore=function(t,e){if(null==this._data)return null;for(var i=this._data[t].scoreRewards,n=0,a=0;a<i.length;a++){var r=i[a];e==r[0]&&(n=r[1])}return n},e.prototype.getLastBoxScoreByDataIdAndScore=function(t,e){if(null==this._data)return null;for(var i=this._data[t].scoreRewards,n=0,a=0;a<i.length;a++){var r=i[a];e>=r[0]&&(n=r[0])}return n},e.prototype.getNextBoxScoreByDataIdAndScore=function(t,e){if(null==this._data)return null;for(var i=this._data[t].scoreRewards,n=0;n<i.length;n++){var a=i[n];if(e<a[0])return a[0]}return i[i.length-1][0]},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TitleEnum:[function(t,e,i){"use strict";cc._RF.push(e,"b434b9DtKlK2qiB1834P6sl","TitleEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.TITLE_CONDITION_TYPE=i.TitleType=i.TitleStatus=void 0,i.TitleStatus={PROGRESS:1,FINISH:2,NONE:0},i.TitleType={ACHIEVE:1,GOODS:2,TIME_LIMIT:3,NONE:0},function(t){t[t.LEGEND=103]="LEGEND"}(i.TITLE_CONDITION_TYPE||(i.TITLE_CONDITION_TYPE={})),cc._RF.pop()},{}],TitleManger:[function(t,e,i){"use strict";cc._RF.push(e,"fa07aHzpCFIj7Umg3au6PNn","TitleManger");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=cc._decorator.ccclass,o=t("TitleModel"),s=t("../Enum/TitleEnum"),l=function(){function t(){this._isShowAll=!0,this._isInit=!1}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.isRedPointTips=function(){return!!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.TITLE)&&(!!this.isDefaultRedPoint()||!!this.isTimeRedPoint())},t.prototype.clearDedaultIds=function(){this._newDefaultIds=[],a.EventUtil.dispatchEvent(a.EventNameEnum.USER_TITLE_PAGE_CHANGE)},t.prototype.clearTimeIds=function(){this._newTimeIds=[],a.EventUtil.dispatchEvent(a.EventNameEnum.USER_TITLE_PAGE_CHANGE)},t.prototype.removeRedPointId=function(t){var e=this._newDefaultIds.indexOf(t);e>-1&&this._newDefaultIds.splice(e,1),(e=this._newTimeIds.indexOf(t))>-1&&this._newTimeIds.splice(e,1),a.EventUtil.dispatchEvent(a.EventNameEnum.USER_TITLE_PAGE_CHANGE)},t.prototype.isDefaultRedPoint=function(){return this._newDefaultIds.length>0},t.prototype.isTimeRedPoint=function(){return this._newTimeIds.length>0},t.prototype.getNewDefaultIds=function(){return this._newDefaultIds},t.prototype.getNewTimeIds=function(){return this._newTimeIds},t.prototype.getActivityIds=function(){return this._newDefaultIds.concat(this._newTimeIds)},t.prototype.redPointEvents=function(){var t=a.EventNameEnum;return[t.RES_GET_TITLE_INFO,t.USER_TITLE_PAGE_CHANGE]},t.prototype.destroyData=function(){this._newDefaultIds=[],this._newTimeIds=[],this.defaultTitleList=[],this.timeLimitTitleList=[],this._isInit=!1},t.prototype.addListener=function(){var t=a.MsgModuleName.TITLE,e=a.MsgCmd.Title;a.ServerDelegate.registerMessage(t,e.GET_TITLE_INFO,this.parseTitleInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.CHANGE_TITLE,this.parseTitleChange.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_TITLE_INFO,this.parseTitleInfo.bind(this))},t.prototype.addEventListener=function(){var t=a.EventUtil,e=a.EventNameEnum,i={};i[e.REQ_GET_TITLE_INFO]=this.reqTitleInfo,i[e.REQ_CHANGE_TITLE]=this.reqTitleChange,t.registerEvents(i,this)},t.prototype.reqTitleInfo=function(){if(!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.TITLE))return!1;var t={};t.module=a.MsgModuleName.TITLE,t.cmd=a.MsgCmd.Title.GET_TITLE_INFO,a.ServerDelegate.sendMessage(t)},t.prototype.reqTitleChange=function(t){var e={};e.module=a.MsgModuleName.TITLE,e.cmd=a.MsgCmd.Title.CHANGE_TITLE,e.id=t,a.ServerDelegate.sendMessage(e)},t.prototype.initDefaultTitleList=function(){this.defaultTitleList=[];var t=a.GetTableClass(a.TableEnum.TitleTable).getDatas();for(var e in t)if(t[e].type===s.TitleType.ACHIEVE||t[e].type===s.TitleType.GOODS){var i=new o;i.init(t[e]),this.defaultTitleList.push(i)}},t.prototype.initTimeLimitTitleList=function(){this.timeLimitTitleList=[];var t=a.GetTableClass(a.TableEnum.TitleTable).getDatas();for(var e in t)if(t[e].type===s.TitleType.TIME_LIMIT){var i=new o;i.init(t[e]),this.timeLimitTitleList.push(i)}},t.prototype.parseTitleInfo=function(t,e){if(t===a.NetCode.SUCCESS){if(this._isInit){for(var i=0;i<e.defaultTitleList.length;i++){var n=!1;t:for(var r=0;r<this.defaultTitleList.length;r++)if(this.defaultTitleList[r].getTitleId()===e.defaultTitleList[i].titleId&&this.defaultTitleList[r].getStatus()===s.TitleStatus.FINISH){n=!0;break t}if(!n&&parseInt(e.defaultTitleList[i].status)===s.TitleStatus.FINISH)if(this._newDefaultIds.push(e.defaultTitleList[i].titleId),(u=a.GetTableClass(a.TableEnum.TitleTable).geTitleById(e.defaultTitleList[i].titleId))&&u.name){var o=new a.BroadcastContent(405),l=new a.BroadcastParam(u.name);o.setMainParam([l]),a.EventUtil.dispatchEvent(a.EventNameEnum.SHOW_BROADCAST,o)}}for(i=0;i<this.timeLimitTitleList.length;i++){n=!1;for(var c=0;c<e.timeLimitTitleList.length;c++)if(this.timeLimitTitleList[i].getTitleId()===e.timeLimitTitleList[c].titleId){var u;if(n=!0,this.timeLimitTitleList[i].getStatus()!=s.TitleStatus.FINISH&&parseInt(e.timeLimitTitleList[c].status)===s.TitleStatus.FINISH)if(this._newTimeIds.push(e.timeLimitTitleList[c].titleId),(u=a.GetTableClass(a.TableEnum.TitleTable).geTitleById(e.timeLimitTitleList[c].titleId))&&u.name){o=new a.BroadcastContent(405),l=new a.BroadcastParam(u.name);o.setMainParam([l]),a.EventUtil.dispatchEvent(a.EventNameEnum.SHOW_BROADCAST,o)}if(this.timeLimitTitleList[i].getStatus()===s.TitleStatus.FINISH&&parseInt(e.timeLimitTitleList[c].status)!=s.TitleStatus.FINISH){o=new a.BroadcastContent(404),l=new a.BroadcastParam(this.timeLimitTitleList[i].getName());o.setMainParam([l]),a.EventUtil.dispatchEvent(a.EventNameEnum.SHOW_BROADCAST,o)}}if(!n&&this.timeLimitTitleList[i].getStatus()===s.TitleStatus.FINISH){o=new a.BroadcastContent(404),l=new a.BroadcastParam(this.timeLimitTitleList[i].getName());o.setMainParam([l]),a.EventUtil.dispatchEvent(a.EventNameEnum.SHOW_BROADCAST,o)}}}else this.initDefaultTitleList(),this._isInit=!0;var d=e.defaultTitleList;for(i=0;i<d.length;i++){var h=d[i].titleId;for(c=0;c<this.defaultTitleList.length;c++)this.defaultTitleList[c].getTitleId()===h&&this.defaultTitleList[c].setData(d[i])}this.initTimeLimitTitleList();for(c=0;c<e.timeLimitTitleList.length;c++)for(h=e.timeLimitTitleList[c].titleId,r=0;r<this.timeLimitTitleList.length;r++)this.timeLimitTitleList[r].getTitleId()===h&&this.timeLimitTitleList[r].setData(e.timeLimitTitleList[c]);a.EventUtil.dispatchEvent(a.EventNameEnum.RES_GET_TITLE_INFO)}},t.prototype.parseTitleChange=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_CHANGE_TITLE)},t.prototype.getDefaultTitleList=function(){return this.defaultTitleList},t.prototype.getTimeLimitTitleList=function(){return this.timeLimitTitleList},t.prototype.getSelectTitleById=function(t){for(var e=0;e<this.defaultTitleList.length;e++){if((i=this.defaultTitleList[e]).getTitleId()===t)return i}for(e=0;e<this.timeLimitTitleList.length;e++){var i;if((i=this.timeLimitTitleList[e]).getTitleId()===t)return i}return null},t.prototype.getIsShowAll=function(){return this._isShowAll},t.prototype.setIsShowAll=function(t){this._isShowAll=t},t.prototype.getSelectId=function(){return this._selectId},t.prototype.setSelectId=function(t){this._selectId=t},t.prototype.showDefaultTitleList=function(){if(this._isShowAll)return this.defaultTitleList;for(var t=[],e=0;e<this.defaultTitleList.length;e++){var i=this.defaultTitleList[e];i.getStatus()===s.TitleStatus.FINISH&&t.push(i)}return t},t.prototype.showTimeLimitTitleList=function(){if(this._isShowAll)return this.timeLimitTitleList;for(var t=[],e=0;e<this.timeLimitTitleList.length;e++){var i=this.timeLimitTitleList[e];i.getStatus()===s.TitleStatus.FINISH&&t.push(i)}return t},t.prototype.getAllAttr=function(){for(var t={},e=0;e<this.defaultTitleList.length;e++){if((n=this.defaultTitleList[e]).getStatus()===s.TitleStatus.FINISH)n.getAttributes().forEach(function(e){t[e[0]]||(t[e[0]]=0),t[e[0]]+=e[1]})}for(var i=0;i<this.timeLimitTitleList.length;i++){var n;if((n=this.timeLimitTitleList[i]).getStatus()===s.TitleStatus.FINISH)n.getAttributes().forEach(function(e){t[e[0]]||(t[e[0]]=0),t[e[0]]+=e[1]})}return t},t.prototype.getAllAttrTT=function(){for(var t={},e=0;e<this.defaultTitleList.length;e++){if((n=this.defaultTitleList[e]).getStatus()===s.TitleStatus.FINISH)n.getAttributeTTPercent().forEach(function(e){t[e[0]]||(t[e[0]]=0),t[e[0]]+=e[1]})}for(var i=0;i<this.timeLimitTitleList.length;i++){var n;if((n=this.timeLimitTitleList[i]).getStatus()===s.TitleStatus.FINISH)n.getAttributeTTPercent().forEach(function(e){t[e[0]]||(t[e[0]]=0),t[e[0]]+=e[1]})}return t},t=e=n([r],t)}();i.default=l,cc._RF.pop()},{"../Enum/TitleEnum":"TitleEnum",TitleModel:"TitleModel"}],TitleModel:[function(t,e,i){"use strict";cc._RF.push(e,"9f36074RsdDtbHs+GidT5+a","TitleModel");window.td;var n=function(){function t(){}return t.prototype.init=function(t){this._titleId=t.titleId,this._type=t.type,this._conditionType=t.conditionType,this._condition=t.condition,this._total=t.value,this._attributes=t.attributes,this._attributeTTPercent=t.attributeTTPercent,this._name=t.name,this._des=t.des,this._icon=t.icon,this._value=0,this._status=0,this._expirationTime=0},t.prototype.setData=function(t){this._value=t.value,this._status=parseInt(t.status),this._expirationTime=t.expirationTime?t.expirationTime-6e4:0},t.prototype.getTitleId=function(){return this._titleId},t.prototype.getType=function(){return this._type},t.prototype.geConditionType=function(){return this._conditionType},t.prototype.getCondition=function(){return this._condition},t.prototype.getTotal=function(){return this._total},t.prototype.getAttributes=function(){return this._attributes},t.prototype.getAttributeTTPercent=function(){return this._attributeTTPercent},t.prototype.getName=function(){return this._name},t.prototype.getDes=function(){return this._des},t.prototype.getValue=function(){return this._value},t.prototype.getStatus=function(){return this._status},t.prototype.getExpirationTime=function(){return this._expirationTime},t.prototype.getIcon=function(){return this._icon},t}();e.exports=n,cc._RF.pop()},{}],TitleTable:[function(t,e,i){"use strict";cc._RF.push(e,"f3b4djzoP5D5p/W0ua1+daL","TitleTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="TitleConfig",e._tblName="title_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.titleId]=a}},e.prototype.geTitleById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getDatas=function(){return this._data},e.prototype.getTitleCfgsByConditionType=function(t){var e=[];for(var i in this._data)if(this._data.hasOwnProperty(i)){var n=this._data[i];n.conditionType==t&&e.push(n)}return e.sort(function(t,e){return t.value-e.value}),e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TowerAttackBuff:[function(t,e,i){"use strict";cc._RF.push(e,"7b1fasaVGxKB6QTrhUv954F","TowerAttackBuff");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_bShowBuff:null},initData:function(t){this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.TowerAttackBuff,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._curSpeedMult=a.getCurFightSpeedMult(),this.setTargetBuffData(!0)):this.removeSelf()},update:function(t){if(this._super(t),!this._bFightPause)return this._curBuffData.buffTime<=0?(this.setTargetBuffData(!1),void this.endBuff()):void(this._curBuffData.buffTime-=t*this._curSpeedMult)},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_HERO_SCRIPT[e]),n=this._curBuffData.buffData,a=t?-n:n;i.setOrdinaryAttackPowerAddition(a),i.setSkillAttackPowerAddition(a)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],TowerFreezeBuff:[function(t,e,i){"use strict";cc._RF.push(e,"012b5ac57xHQonA7goyUEVg","TowerFreezeBuff");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_bShowBuff:null,_clickCount:0,_bEnd:!1},initData:function(t){if(this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.TowerFreezeBuff,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff){var e=this.node.getChildByName("TowerFreezeBuff");if(!e){var i=gdk.rm.getResByUrl("fightRes/pve/buff/TowerBuffFreeze/TowerBuffFreeze",cc.Prefab);e=cc.instantiate(i),this.node.addChild(e),e.y=-20,e.name="TowerFreezeBuff"}this._buffAnimation=e.getComponent(cc.Animation),this._clipName="TowerFreezeBuff",this._buffAnimation.play(this._buffAnimation.getClips()[0].name).wrapMode=cc.WrapMode.Normal,this._buffAnimation.on("finished",this.playLoop,this),this._bEnd=!1}},playLoop:function(){this._buffAnimation.off("finished",this.playLoop,this),this._buffAnimation.play(this._buffAnimation.getClips()[1].name).wrapMode=cc.WrapMode.Loop},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._curSpeedMult=a.getCurFightSpeedMult(),this.setTargetBuffData(!0)):this.removeSelf()},update:function(t){if(this._super(t),!this._bFightPause&&!this._bEnd){if(this._curBuffData.buffTime<=0)return this.setTargetBuffData(!1),this._bEnd=!0,this._buffAnimation.play(this._buffAnimation.getClips()[2].name).wrapMode=cc.WrapMode.Normal,void this._buffAnimation.on("finished",this.endBuff,this);this._curBuffData.buffTime-=t*this._curSpeedMult}},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio);this._curTarget.getComponent(td.PveEnum.PVE_HERO_SCRIPT[e]).setSkillFreezeBuff(t)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],TowerHurtBuff:[function(t,e,i){"use strict";cc._RF.push(e,"957efZlZypJeZlapMwiEHLe","TowerHurtBuff");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_bShowBuff:null},initData:function(t){this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.TowerHurt,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._curSpeedMult=a.getCurFightSpeedMult(),this.setTargetBuffData(!0),this.schedule(this.onUpdateTowerHurtBuff,1/60)):this.removeSelf()},onDisable:function(){this._super(),this.unschedule(this.onUpdateTowerHurtBuff)},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_HERO_SCRIPT[e]),n=this._curBuffData.buffData,a=t?n:-1*n;i.setOrdinaryAttackPowerAddition(a)},onUpdateTowerHurtBuff:function(t){if(!this._bFightPause)return this._curBuffData.buffTime<=0?(this.unschedule(this.onUpdateTowerHurtBuff),this.setTargetBuffData(!1),void this.endBuff()):void(this._curBuffData.buffTime-=t*this._curSpeedMult)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],TowerMasterController:[function(t,e,i){"use strict";cc._RF.push(e,"28d3eZ1kf1DsbDVwu1NQTtB","TowerMasterController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=t("./TowerMasterEnums"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._dataID=1001,e._curSectionId=-1,e._lastSectionId=-1,e._num1Name="",e._num1Detail=0,e._myRank=0,e._myRankPersent=0,e._myDetail=0,e._totalPlayer=0,e._lastMyRank=0,e._lastTotalPlayer=1,e._lastRankPersent=0,e._sectionIds=[],e._receivedList=[],e._isInit=!1,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e),this._dataID=this.getActivityData()},e.prototype.activityParse=function(t){this._curSectionId>0&&(this._curSectionId,t.global.sectionId),this._num1Name=t.global.firstActor||this._num1Name,this._totalPlayer=t.global.personNum||this._totalPlayer,this._lastTotalPlayer=t.global.prePersonNum||this._lastTotalPlayer,this._curSectionId=t.global.sectionId||this._curSectionId,this._num1Detail=t.global.starNum||this._num1Detail,this._myRank=t.record.rank||this._myRank,this._lastMyRank=t.record.prevRank||this._lastMyRank,this._myDetail=t.record.starNum||this._myDetail,0==this._myDetail?this._myRankPersent=0:1==this._myRank?this._myRankPersent=1e4:this._myRankPersent=Number(((this._totalPlayer-this._myRank)/this._totalPlayer*1e4).toFixed(1)),0==this._lastMyRank?this._lastRankPersent=0:1==this._lastMyRank?this._lastRankPersent=1e4:this._lastRankPersent=Number(((this._lastTotalPlayer-this._lastMyRank)/this._lastTotalPlayer*1e4).toFixed(1)),t.record.receiveList&&t.record.receiveList.length>0&&(this._receivedList=t.record.receiveList||this._receivedList);var e=td.GetTableClass(td.TableEnum.TowerMasterTable);this._lastSectionId=this._curSectionId-1,this._curSectionId>e.getMaxSectionId(this._dataID)&&(this._curSectionId=e.getMaxSectionId(this._dataID)),this._curSectionId<=e.getMinSectionId(this._dataID)&&(this._curSectionId=e.getMinSectionId(this._dataID),this._lastSectionId=-1),this._sectionIds=e.getSectionsByDataIdAndSetionID(this._dataID,this._curSectionId),this.isHaveRewardToReceive()&&this._isInit&&td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_TowerMasterReward),this._isInit=!0},e.prototype.isHaveRewardToReceive=function(){var t=td.GetConfig("TM_REWARD_LV_REQ");if(td.Account.getUserData().getLevel()<t)return!1;var e=td.GetTableClass(td.TableEnum.TowerMasterTable);return!(this._lastSectionId<e.getMinSectionId(this._dataID)||this._lastSectionId>this._curSectionId)&&!!(-1==this._receivedList.indexOf(this._lastSectionId)&&this._myRank>0&&this._lastMyRank>0)},e.prototype.getCurSectionCloseTime=function(t){t||(t=this._curSectionId);var e=td.GetTableClass(td.TableEnum.TowerMasterTable).getSectionDataByDataAndId(this._dataID,t),i=this.getCurrentOpenStage(),n=e.closeTime;n=n.split(":");var a=1e3*(60*parseInt(n[0])*60+60*parseInt(n[1])+parseInt(n[2]));return i.openTime+24*e.closeDays*60*60*1e3+a},e.prototype.isLastButOne=function(t){return this.getSectionRange(t)<=this._sectionIds[1]},e.prototype.isLast=function(t){return t==this._sectionIds[0]},e.prototype.getLastButOneSection=function(){return this._sectionIds[1]},e.prototype.getSectionRange=function(t){if(0==t)return this._sectionIds[0];if(1e4==t)return this._sectionIds[this._sectionIds.length-1];for(var e=this._sectionIds.length-1;e>=0;e--){var i=this._sectionIds[e];if(t>i)return i}},e.prototype.getGiftBoxName=function(t){var e=this.getSectionRange(t);if(1e4===t)return"HD_tfds_lbzi08";for(var i=this._sectionIds.length-1;i>=0;i--)if(this._sectionIds[i]==e)return"HD_tfds_lbzi0"+(i+1)},e.prototype.getCurSectionId=function(){return this._curSectionId},e.prototype.getRewardSectionId=function(){return this._lastSectionId<0?td.GetTableClass(td.TableEnum.TowerMasterTable).getMinSectionId(this._dataID):this._lastSectionId},e.prototype.getNum1PlayerName=function(){return this._num1Name},e.prototype.getNum1PlayerRankDetail=function(){return this._num1Detail},e.prototype.getMyRank=function(){return this._myRank},e.prototype.getMyLastRank=function(){return this._lastMyRank},e.prototype.getMyRankWanPersent=function(){return this._myRankPersent},e.prototype.getMyRankDetail=function(){return this._myDetail},e.prototype.getLastRankPersent=function(){return this._lastRankPersent},e.prototype.isRedPointTip=function(){var t=td.LocalStorageUtil.read(a.STORAGE_HAVE_SHOWN+td.GameRoleInfo.userId);return t||(t=!1),!t},e}(t("ActivityBaseController"));i.default=r,e.exports=r,cc._RF.pop()},{"./TowerMasterEnums":"TowerMasterEnums",ActivityBaseController:"ActivityBaseController"}],TowerMasterEnums:[function(t,e,i){"use strict";cc._RF.push(e,"298d17QcdxGF5KCK4+wQMwv","TowerMasterEnums"),Object.defineProperty(i,"__esModule",{value:!0}),i.STORAGE_HAVE_SHOWN=void 0,i.STORAGE_HAVE_SHOWN="STORAGE_HAVE_SHOWN",cc._RF.pop()},{}],TowerMasterItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"acde9R0s1JLcq5MpsHn4L3G","TowerMasterItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.nodeReward=null,e.imgNum1=null,e.nodeRank=null,e.labRank=null,e.nodePointNum=null,e.imgGiftBoxName=null,e.nodeLast=null,e.labLast=null,e.labLastPoint=null,e._controller=null,e}return n(e,t),e.prototype.onEnable=function(){this._controller=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.TowerMaster),this._addEventListners()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListners=function(){},e.prototype.updateItem=function(t,e){var i=1-e.rank/1e4,n=e.rewards;if(this.imgNum1.active=1===i,this.nodeRank.active=1!==i,this._controller.isLast(1e4-e.rank)){this.nodeLast.active=!0,this.imgNum1.active=!1,this.nodeRank.active=!1;var a=this._controller.getLastButOneSection();if(this.labLastPoint.active=!Number.isInteger(a/100),this.labLast.string=a/100+"",this._controller){var o=this._controller.getGiftBoxName(1e4-e.rank+1);r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Acitivty_40_tfds,o,this.imgGiftBoxName)}}else if(1!==i){if(this.labRank.string=Math.floor(100*i)+"",this.nodePointNum.active=!Number.isInteger(100*i),this.nodeLast.active=!1,this._controller){o=this._controller.getGiftBoxName(1e4-e.rank+1);r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Acitivty_40_tfds,o,this.imgGiftBoxName)}}else this.nodeLast.active=!1,r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.Acitivty_40_tfds,"HD_tfds_lbzi08",this.imgGiftBoxName);this.nodeReward.removeAllChildren();for(var s=0;s<n.length;s++){var l=n[s],c=r.RewardManager.getRewardDetail(l),u=r.GlobalFunction.createCommonIconWidget(26,c);u.scale=.9,u.parent=this.nodeReward}},a([l(cc.Node)],e.prototype,"nodeReward",void 0),a([l(cc.Node)],e.prototype,"imgNum1",void 0),a([l(cc.Node)],e.prototype,"nodeRank",void 0),a([l(cc.Label)],e.prototype,"labRank",void 0),a([l(cc.Node)],e.prototype,"nodePointNum",void 0),a([l(cc.Node)],e.prototype,"imgGiftBoxName",void 0),a([l(cc.Node)],e.prototype,"nodeLast",void 0),a([l(cc.Label)],e.prototype,"labLast",void 0),a([l(cc.Node)],e.prototype,"labLastPoint",void 0),e=a([s,c("module/Activity/TowerMasterItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],TowerMasterPanel:[function(t,e,i){"use strict";cc._RF.push(e,"e2eefJVZx1HbZGk83fgbwxM","TowerMasterPanel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./TowerMasterEnums"),o=window.td,s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labMyRank=null,e.labMyRankDetail=null,e.labNum1Name=null,e.labNum1RankDetail=null,e.labTimeTxt=null,e.labTime=null,e.labTimeDes=null,e.btnJump=null,e._isClose=!1,e._showIndex=0,e._activityController=null,e}return n(e,t),e.prototype.init=function(){this._panelType=o.PanelType.Panel,this._panelEnum=o.PanelEnum.Panel_TowerMaster},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),o.LocalStorageUtil.write(r.STORAGE_HAVE_SHOWN+o.GameRoleInfo.userId,!0),o.EventUtil.dispatchEvent(o.EventNameEnum.REFRESH_TOWER_MASTER_RED_POINT),o.EventUtil.dispatchEvent(o.EventNameEnum.HIDE_MAIN_LAYER_BOTTOM_LAYER),this._activityController=o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.TowerMaster),this._addEventListener(),this._activityController&&(this._activityId=this._activityController.getActivityId(),o.EventUtil.dispatchEvent(o.EventNameEnum.Req_GET_ACTIVITY_INFO,this._activityId))},e.prototype.onDisable=function(){o.EventUtil.unregisterAllEvents(this),this._stopSchedule(),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){var t={};t[o.EventNameEnum.Res_GET_ACTIVITY_INFO]=this._resInfo,o.EventUtil.registerEvents(t,this)},e.prototype._resInfo=function(t){t===this._activityController.getActivityId()&&this._refresh()},e.prototype._refresh=function(){this._refreshPanel(),this._refreshListView()},e.prototype._refreshPanel=function(){var t=this._activityController.getMyRankWanPersent(),e=this._activityController.isLastButOne(t);if(1===this._activityController.getMyRank())this.labMyRank.string=o.Language.TowerMasterStr2;else if(e){var i=Math.floor(this._activityController.getLastButOneSection()/10)/10;this.labMyRank.string=cc.js.formatStr(o.Language.TowerMasterStr5,i)}else{i=Math.floor(t/10)/10;this.labMyRank.string=cc.js.formatStr(o.Language.TowerMasterStr1,i)}this.labMyRankDetail.string=this._activityController.getMyRankDetail()+"\u661f",this.labNum1Name.string=this._activityController.getNum1PlayerName(),this.labNum1RankDetail.string=this._activityController.getNum1PlayerRankDetail()+"\u661f"},e.prototype._refreshListView=function(){var t=o.GetTableClass(o.TableEnum.TowerMasterTable),e=t.getRewardsByDataIdAndId(this._activityController.getActivityData(),this._activityController.getCurSectionId());e&&this.node.getComponent(d).refreshListData(e);this._closeTime=this._activityController.getCurSectionCloseTime(),this._isClose=o.TimeUtil.getTime()-this._closeTime>0;var i=t.getClosedayByDataAndId(this._activityController.getActivityData(),this._activityController.getCurSectionId());this.labTimeTxt.string=cc.js.formatStr(o.Language.TowerMasterStr4,i+1),this._isClose?(this.labTimeDes.node.active=!0,this.labTime.node.active=!1,this.btnJump.active=!1):(this.labTimeDes.node.active=!1,this.labTime.node.active=!0,this.btnJump.active=!0,this._stopSchedule(),this.schedule(this._loopTime,1),this._loopTime())},e.prototype._loopTime=function(){var t=Math.floor(this._closeTime-o.TimeUtil.getTime());t>0?this.labTime.string=o.GlobalFunction.getTimeStringByDeltaTime(t):(this.labTimeDes.node.active=!0,this.labTime.node.active=!1,this.btnJump.active=!1,this._stopSchedule())},e.prototype._stopSchedule=function(){this.unschedule(this._loopTime)},e.prototype.onBtnJump=function(){o.PanelJumpManager.jumpToPanel(o.PanelEnum.Window_PveCopyGate,o.PveGeneralCopyManager.getCurChapterId())},e.prototype._onActivityClose=function(t){this._activityId===t&&this.closeCallFunc()},e.prototype.showHelpDesc=function(){var t={};t.panelName=o.PanelEnum.Window_Help,t.callback={func:function(t,e){e.setData(t)},param:[this._panelEnum,this._showIndex]},o.GlobalFunction.showPanel(t)},a([c(cc.Label)],e.prototype,"labMyRank",void 0),a([c(cc.Label)],e.prototype,"labMyRankDetail",void 0),a([c(cc.Label)],e.prototype,"labNum1Name",void 0),a([c(cc.Label)],e.prototype,"labNum1RankDetail",void 0),a([c(cc.Label)],e.prototype,"labTimeTxt",void 0),a([c(cc.Label)],e.prototype,"labTime",void 0),a([c(cc.Label)],e.prototype,"labTimeDes",void 0),a([c(cc.Node)],e.prototype,"btnJump",void 0),e=a([l,u("module/Activity/TowerMasterPanel")],e)}(t("PanelBase"));i.default=h,cc._RF.pop()},{"./TowerMasterEnums":"TowerMasterEnums",OptimizeVerticalListView:void 0,PanelBase:void 0}],TowerMasterRewardItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"4faffVKZTlLk5Akt9MQnMQO","TowerMasterRewardItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labItemName=null,e.labItemDesc=null,e.nodeItem=null,e._iconNode=null,e}return n(e,t),e.prototype.updateItem=function(t,e){this.labItemName.string=e.getName(),this.labItemName.node.color=r.QualityColors[e.getQuality()],this.labItemName.node.getComponent(cc.LabelOutline).color=r.QualityStrokeColors[e.getQuality()],this.labItemDesc.string=e.getDes(),this._iconNode=r.GlobalFunction.createCommonIconWidget(26,e),this.nodeItem.removeAllChildren(),this._iconNode.parent=this.nodeItem},e.prototype.getIconNode=function(){return this._iconNode},a([l(cc.Label)],e.prototype,"labItemName",void 0),a([l(cc.Label)],e.prototype,"labItemDesc",void 0),a([l(cc.Node)],e.prototype,"nodeItem",void 0),e=a([s,c("module/Activity/TowerMasterRewardItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],TowerMasterRewardWindow:[function(t,e,i){"use strict";cc._RF.push(e,"d31360OzYhP/6bjnKpiT8DG","TowerMasterRewardWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("./TowerMasterRewardItemUI"),o=window.td,s=cc._decorator,l=s.ccclass,c=s.property,u=s.menu,d=t("PanelBase"),h=t("OptimizeVerticalListView"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labDay=null,e.labRich=null,e.imgGiftBoxName=null,e._controller=null,e._listView=null,e}return n(e,t),e.prototype.init=function(){this._panelType=o.PanelType.Window,this._panelEnum=o.PanelEnum.Window_TowerMasterReward},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._controller=o.ActivityDataManager.getActivityControllerByType(o.ActivityEnum.ActivityType.TowerMaster),this._addEventListners()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),o.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListners=function(){o.EventNameEnum;o.EventUtil.registerEvents({},this)},e.prototype.setData=function(){this._initWindow()},e.prototype._initWindow=function(){var t,e,i=o.GetTableClass(o.TableEnum.TowerMasterTable),n=i.getClosedayByDataAndId(this._controller.getActivityData(),this._controller.getRewardSectionId());if(this.labDay.string=n+1+"",1==this._controller.getMyLastRank())t=e=this._controller.getSectionRange(1e4),this.labRich.string=cc.js.formatStr(o.Language.TowerMasterStr3,"100%");else{t=this._controller.getLastRankPersent(),e=this._controller.getSectionRange(t);var a=Math.floor(this._controller.getLastRankPersent()/10)/10;this.labRich.string=cc.js.formatStr(o.Language.TowerMasterStr3,a+"%")}var r=this._controller.getGiftBoxName(t);o.GlobalFunction.createAltasSprite(o.resDef.pngPlist.Acitivty_40_tfds,r,this.imgGiftBoxName);var s=i.getRewardsByDataIdAndIdAndSection(this._controller.getActivityData(),this._controller.getRewardSectionId(),e),l=o.RewardManager.getRewardDetailArray(s);this._listView=this.node.getComponent(h),this._listView.setData(l)},e.prototype.onBtnReceiveClick=function(){this.closeCallFunc();for(var t=this._listView.getAllItems(),e=[],i=0;i<t.length;i++){var n=t[i].getComponent(r.default).getIconNode();e.push(n)}o.EventUtil.dispatchEvent(o.EventNameEnum.PLAY_GETGOODS_ANIMATION,e);var a={};a.id=this._controller.getRewardSectionId(),this._controller.operateActivity(a)},e.prototype.closeCallFunc=function(){t.prototype.closeCallFunc.call(this),o.EventUtil.dispatchEvent(o.EventNameEnum.CLOSED_POP_WINDOW)},a([c(cc.Label)],e.prototype,"labDay",void 0),a([c(cc.RichText)],e.prototype,"labRich",void 0),a([c(cc.Node)],e.prototype,"imgGiftBoxName",void 0),e=a([l,u("module/Activity/TowerMasterRewardWindow")],e)}(d);i.default=p,cc._RF.pop()},{"./TowerMasterRewardItemUI":"TowerMasterRewardItemUI",OptimizeVerticalListView:void 0,PanelBase:void 0}],TowerMasterTable:[function(t,e,i){"use strict";cc._RF.push(e,"d4f00B3chBF8ac2cboBkigl","TowerMasterTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="TowerMasterTable",e._tblName="rush_master_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getSectionsByDataIdAndSetionID=function(t,e){if(this._data[t]){var i=[];for(var n in this._data[t])if(this._data[t][n].sectionId===e){for(var a=this._data[t][n].rewards,r=0;r<a.length;r++){var o=a[r];i.push(1e4-o[0])}return i.sort(function(t,e){return t-e}),i}}return[]},e.prototype.getMaxSectionId=function(t){var e=0;if(this._data[t])for(var i in this._data[t])this._data[t][i].sectionId>=e&&(e=this._data[t][i].sectionId);return e},e.prototype.getMinSectionId=function(t){var e=null;if(this._data[t])for(var i in this._data[t])null==e&&(e=this._data[t][i].sectionId),this._data[t][i].sectionId<=e&&(e=this._data[t][i].sectionId);return e},e.prototype.getSectionDataByDataAndId=function(t,e){if(this._data[t])for(var i in this._data[t])if(this._data[t][i].sectionId==e)return this._data[t][i];return null},e.prototype.getClosedayByDataAndId=function(t,e){if(this._data[t])for(var i in this._data[t])if(this._data[t][i].sectionId==e)return this._data[t][i].closeDays;return 0},e.prototype.getRewardsByDataIdAndId=function(t,e){if(this._data[t]){var i=[];for(var n in this._data[t])if(this._data[t][n].sectionId===e)for(var a=this._data[t][n].rewards,r=0;r<a.length;r++){var o=a[r],s={rank:o[0],rewards:o[1]};i.push(s)}return i}return null},e.prototype.getRewardsByDataIdAndIdAndSection=function(t,e,i){for(var n=this.getRewardsByDataIdAndId(t,e),a=0;a<n.length;a++){var r=n[a];if(i==1e4-r.rank)return r.rewards}return[]},e}(t("BaseTable"));i.default=a,e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TowerSpeedBuff:[function(t,e,i){"use strict";cc._RF.push(e,"38304Imd11F8oAMf4Tz2I/a","TowerSpeedBuff");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_bShowBuff:null},initData:function(t){this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.TowerSpeedBuff,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff},onEnable:function(){this._super(),this._buffType===this._curBuffData.buffType?(this._curSpeedMult=a.getCurFightSpeedMult(),this.setTargetBuffData(!0)):this.removeSelf()},update:function(t){if(this._super(t),!this._bFightPause)return this._curBuffData.buffTime<=0?(this.setTargetBuffData(!1),void this.endBuff()):void(this._curBuffData.buffTime-=t*this._curSpeedMult)},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_HERO_SCRIPT[e]),n=this._curBuffData.buffData+1,r=a.getCurFightSpeedMult(),o=t?n*r:r;i.setSpeedMuti(o)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],TreasureEnum:[function(t,e,i){"use strict";cc._RF.push(e,"ec491rQmL9JYZ2iUhXvp4w9","TreasureEnum");e.exports={TreasureType:{NONE:0,ATTACK:1,DEFENSE:2,EXP:3},TreasureSnatchRecordState:{NONE:0,SNATCH:1,REVENGE:2,REVENGE_COMPLETE:3}},cc._RF.pop()},{}],TreasureEvolveEffectTable:[function(t,e,i){"use strict";cc._RF.push(e,"eea5a8eEmBLrYUuIE53rDsB","TreasureEvolveEffectTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="TreasureEvolveEffectConfig",e._tblName="treasure_evolve_effect_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getDataById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getDatas=function(){return this._data},e.prototype.getEffectsByTreasureId=function(t){var e=[];for(var i in this._data){var n=this._data[i];-1!=n.treasureIds.indexOf(t)&&e.push(n)}return e},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TreasureEvolveTable:[function(t,e,i){"use strict";cc._RF.push(e,"55b53wCdCtDLr40Z3UY/6JE","TreasureEvolveTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tblName="treasure_evolve_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]||(t[a.id]={}),t[a.id][a.evolveLevel]=a}},e.prototype.getTreasure=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].evolveLevel===e)return i[n]}}return null},e.prototype.getSpecialIds=function(t){var e=[];if(this._data[t]){var i=this._data[t];for(var n in i){var a=i[n];if(a.specialEffectId>0){var r={level:n,id:a.specialEffectId};e.push(r)}}}return e},e.prototype.getSpecialIdsByLv=function(t,e){var i=[];if(this._data[t]){var n=this._data[t];for(var a in n){var r=n[a];r.specialEffectId>0&&r.evolveLevel<=e&&i.push(r.specialEffectId)}}return i},e.prototype.maxLevel=function(t){return this._data[t]?this._data[t].myLen():0},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TreasureGiftController:[function(t,e,i){"use strict";cc._RF.push(e,"0e973p0OEBIvJnqpHbqGd68","TreasureGiftController");var n=t("ActivityBaseController"),a=t("TreasureGiftModel"),r=t("TreasureGiftRewardModel"),o=cc.Class({extends:n,properties:{_key:null,_openTime:null,_taskList:null,_rewardList:null,_recordList:null,_haveReward:null,_isInit:!1,_isShown:!1,_recharge:null,_converted:null},initData:function(t){this._super(t),this.clearData(),this._addLocalListeners()},clearData:function(){this._key=0,this._openTime=0,this._recharge=0,this._converted=0,this._taskList=[],this._rewardList=[],this._recordList=[],this._haveReward=!1,this._isInit=!1,this._isShown=!1},_addLocalListeners:function(){var t=td.EventUtil,e={};e[td.EventNameEnum.Res_GET_TASK_INFO]=this.refreshTask,t.registerEvents(e,this)},setActivityShown:function(){this._isShown=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.TREASURE_GIFT_SHOWN)},getKeyNum:function(){return this._key},getOpenTime:function(){return this._openTime},getTaskList:function(){return this._taskList},getRewardList:function(){return this._rewardList},getRecordList:function(){return this._recordList},getHaveReward:function(){return this._haveReward},getCanExchangeCount:function(){var t=td.GetConfig("TREASURE_GIFT_CONVERTIBLE_UNIT");return Math.floor((this._recharge-this._converted)/t)},getRechargeTask:function(){var t=new a,e={},i=td.GetConfig("TREASURE_GIFT_CONVERTIBLE_UNIT");e.needValue=i,e.value=this._converted;var n=td.TaskStatus.Progress;return(this._recharge-this._converted)/i>=1&&(n=td.TaskStatus.Finish),e.status=n,e.desc=cc.js.formatStr(td.Language.treasureGiftExchange,i/10),t.setRechargeData(e),t},refreshTask:function(){this._taskList=[],this._taskList[this._taskList.length]=this.getRechargeTask();var t=td.GetTableClass(td.TableEnum.TaskTable).getTaskByType(td.TaskType.TREASURE_GIFT);if(t)for(var e=0;e<t.length;e++){var i=td.TaskManager.getTaskById(t[e].taskId),n=new a;n.initData(i),this._taskList.push(n)}},activityParse:function(t){var e=t.record,i=e.receiveList,n=e.key||0;if(this._isInit&&n>this._key){var a=new td.BroadcastContent(271);a.setMainParam([new td.BroadcastParam(n-this._key)]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,a)}this._key=n,this._recharge=e.recharge||0,this._converted=e.converted||0,this._openTime=e.openTimes,this.refreshTask(),this._rewardList=[],this._haveReward=!1;var o=this.getActivityData(),s=td.GetTableClass(td.TableEnum.TreasureGiftOpenRewardTable).getDatasOfDataId(o);if(s)for(var l=0;l<s.length;l++){var c=s[l],u=new r;u.initData(c,this._openTime);var d=td.ActivityEnum.TreasureGiftEnum.NONE;d=this._openTime>=u.getNeedOpenTime()?td.ActivityEnum.TreasureGiftEnum.CAN_Receive:td.ActivityEnum.TreasureGiftEnum.CAN_NOT_Receive;for(var h=0;h<i.length;h++)if(-1!=i.indexOf(u.getId())){d=td.ActivityEnum.TreasureGiftEnum.ALREADY_Receive;break}u.setState(d),d==td.ActivityEnum.TreasureGiftEnum.CAN_Receive&&(this._haveReward=!0),this._rewardList.push(u)}this._isInit=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_TREASURE_GIFT_INFO)},receiveReward:function(t){if(this.isInOpenStatus()){var e={};e.activityId=this.getActivityId(),e.id=t,this.operateActivity(e)}},rewardGiftRedPoint:function(){for(var t=0,e=this._rewardList.length;t<e;t++){if(this._rewardList[t].getState()===td.ActivityEnum.TreasureGiftEnum.CAN_Receive)return!0}return!1},taskRedPoint:function(){for(var t=0,e=this._taskList.length;t<e;t++){if(this._taskList[t].getStatus()===td.TaskStatus.Finish)return!0}return!1},rewardGiftAllReceived:function(){for(var t=!0,e=0,i=this._rewardList.length;e<i;e++){if(this._rewardList[e].getState()!==td.ActivityEnum.TreasureGiftEnum.ALREADY_Receive){t=!1;break}}return t},taskAllReceived:function(){for(var t=!0,e=0,i=this._taskList.length;e<i;e++){if(this._taskList[e].getStatus()!==td.TaskStatus.Received){t=!1;break}}return t},hasRedPoint:function(){return!0},redPointTip:function(){return!(!this.rewardGiftRedPoint()&&!this.taskRedPoint())||!this.rewardGiftAllReceived()&&!this.taskAllReceived()&&this._key>0},redPointEvts:function(){return[td.EventNameEnum.REFRESH_TREASURE_GIFT_INFO,td.EventNameEnum.TREASURE_GIFT_SHOWN]},isRedPointTip:function(){return this.redPointTip()}});e.exports=o,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",TreasureGiftModel:"TreasureGiftModel",TreasureGiftRewardModel:"TreasureGiftRewardModel"}],TreasureGiftListView:[function(t,e,i){"use strict";cc._RF.push(e,"bdb825TJRFPeppq4Tza3qQK","TreasureGiftListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{_controller:null,_receiveCallBack:null},setData:function(t){var e=t.dataList;this._controller=t.controller,this._receiveCallBack=t.receiveFunc,this._super(e)},setItemView:function(t,e){var i=t.getChildByName("labNum"),n=t.getChildByName("numBg"),a=t.getChildByName("labDesc"),r=t.getChildByName("layoutProgress"),o=r.getChildByName("labProTitle"),s=r.getChildByName("labProgress"),l=t.getChildByName("imgGot"),c=t.getChildByName("btnGoto"),u=t.getChildByName("btnGet");a.getComponent(cc.Label).string=e.getDesc();var d=e.isRecharge();if(d){var h=this._controller.getCanExchangeCount();n.active=h>0,i.active=h>0,h&&(i.getComponent(cc.Label).string="x"+h),o.getComponent(cc.Label).string=td.Language.treasureGiftGetTitle,s.getComponent(cc.RichText).string=h+""}else n.active=!0,i.active=!0,i.getComponent(cc.Label).string="x"+e.getActive(),o.getComponent(cc.Label).string=td.Language.progress+":",s.getComponent(cc.RichText).string=e.getProgressStr();var p=e.getStatus();l.active=!1,c.active=!1,u.active=!1,p===td.TaskStatus.Progress&&""!=e.getGotoPanel()?(c.active=!0,td.GlobalFunction.setButtonTitle(c,d?td.Language.recharge:td.Language.goto)):p===td.TaskStatus.Finish?u.active=!0:p===td.TaskStatus.Received&&(l.active=!0);var _=c.getComponent(cc.Button);_.clickEvents=[],(g=new cc.Component.EventHandler).target=this.node,g.component="TreasureGiftListView",g.handler="onGoto",g.customEventData=e,_.clickEvents.push(g);var g,f=u.getComponent(cc.Button);return f.clickEvents=[],(g=new cc.Component.EventHandler).target=this.node,g.component="TreasureGiftListView",g.handler="onGetReward",g.customEventData=e,f.clickEvents.push(g),td.RedPointUtil.createRedPointSimple(u,{x:-10,y:-10},p===td.TaskStatus.Finish),t},onGoto:function(t,e){var i=e.getGotoPanel();if(i.length>1)if(i[0]==td.PanelEnum.Panel_Activity&&i[1][0]==td.ActivityEnum.Activity.ActivityVip&&i[1][1]==td.ActivityEnum.ActivityType.RechargePanel)td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityConfig,td.ActivityEnum.ActivityType.TreasureGift]),this.node.getParent().getComponent("TreasureGiftTaskWindow").closeCallFunc();else if(i[0]==td.PanelEnum.Window_PveCopyGate){var n=td.PveCopyManager.getChapterId();td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_PveCopyGate,n)}else i[0]==td.PanelEnum.Panel_Activity?this.goActivity([i[1][0],i[1][1]]):td.PanelJumpManager.jumpToPanel(i[0],i[1]);else td.PanelJumpManager.jumpToPanel(i[0])},goActivity:function(t){var e,i=td.PanelManager.getInstance().getCurShowPanel();if(i&&(e=i.getPanelEnum()),e&&td.PanelEnum.Panel_Activity===e){var n=td.PanelManager.getInstance().getCurShowWindow();if(n){var a=n.getComponent("PanelBase");a&&a.closeCallFunc()}i.getComponent("ActivityMainPanel").setData(t)}var r=[td.ActivityEnum.Activity.ActivityConfig,td.ActivityEnum.ActivityType.TreasureGift];td.ActivityDataManager.setJumpBackData(r)},onGetReward:function(t,e){var i=e;this._receiveCallBack&&"function"==typeof this._receiveCallBack&&this._receiveCallBack(i)}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],TreasureGiftModel:[function(t,e,i){"use strict";cc._RF.push(e,"6f48ckZTTlIsrjyKb+IOi9y","TreasureGiftModel");var n=cc.Class({properties:{_isRecharge:null,_active:null,_desc:null,_progress:null,_status:null,_taskId:null,_goPanel:null,_conditionType:null,_value:null,_needValue:null},initData:function(t,e){this._isRecharge=!1,this._active=t.getActive(),this._desc=t.getDes(),this._status=t.getStatus(),this._taskId=t.getId(),this._goPanel=t.getGotoPanel(),this._conditionType=t.getConditionType(),this._value=t.getValue(),this._needValue=t.getNeedValue(),this._conditionType===td.TaskConditionType.ACTOR_ACTIVITY41_SINGLE_RECHARGE?this._status==td.TaskStatus.Finish||this._status==td.TaskStatus.Received?this._progress=t.getNeedValue()/10+"/"+t.getNeedValue()/10:this._progress="0/"+t.getNeedValue()/10:this._conditionType===td.TaskConditionType.ACTOR_ACTIVITY41_TOTAL_RECHARGE?this._progress=t.getValue()/10+"/"+t.getNeedValue()/10:t.getValue()>=t.getNeedValue()?this._progress=t.getNeedValue()+"/"+t.getNeedValue():this._progress=t.getValue()+"/"+t.getNeedValue()},isRecharge:function(){return this._isRecharge},setRechargeData:function(t){this._isRecharge=!0,this._needValue=t.needValue,this._value=t.value,this._status=t.status,this._desc=t.desc,this._goPanel=[td.PanelEnum.Panel_Activity,[td.ActivityEnum.Activity.ActivityVip,td.ActivityEnum.ActivityType.RechargePanel]]},getStatus:function(){return this._status},setStatus:function(t){this._status=t},getActive:function(){return this._active},getDesc:function(){return this._desc},getProgressStr:function(){return this._progress},getTaskId:function(){return this._taskId},getGotoPanel:function(){return this._goPanel},getConditionType:function(){return this._conditionType},getValue:function(){return this._value},getNeedValue:function(){return this._needValue}});e.exports=n,cc._RF.pop()},{}],TreasureGiftOpenRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"c094afNzP1LE5G+4Bmk6Jeu","TreasureGiftOpenRewardTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"TreasureGiftOpenRewardTable",properties:{_tblName:"treasure_gift_open_reward_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TreasureGiftOpenTable:[function(t,e,i){"use strict";cc._RF.push(e,"595c42rL3tHJbIG1iVb5FZB","TreasureGiftOpenTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"TreasureGiftOpenTable",properties:{_tblName:"treasure_gift_open_config",_datas:null},init:function(){this._datas={};for(var t=this._jsonData,e=0,i=t.length;e<i;e++){var n=t[e];this._datas[n.data]=this._datas[n.data]||[];var a=this._datas[n.data];a[a.length]=n}},getDatasOfDataId:function(t){var e=this._datas[t];return e||(e=[]),e}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TreasureGiftPanel:[function(t,e,i){"use strict";cc._RF.push(e,"169835MS/JMtI/bfOWX5jOp","TreasureGiftPanel");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../../Common/Component/GridLayoutComponent"));var a=t("ActivityBasePanel"),r=(t("UFButton"),t("CommonIconWidget")),o=cc.Class({extends:a,properties:{imgTitle:cc.Node,imgEgg:cc.Node,labTime:cc.Label,haveNumLabel:cc.Label,costIcon:cc.Node,costNumLabel:cc.Label,costTenNumLabel:cc.Label,eggLayer:cc.Node,rewardLayer:cc.Node,coverLayer:cc.Node,btnTenTimes:cc.Node,_listView:null,_posInfo:null,_configs:null,_curSelectType:null,_clickRects:null,_isTurning:!1,_maxNum:0,_beginPos:null,_rewardList:null,_hitAni:null},initData:function(t){this._super(t);var e=this.getActivityController().getActivityData();this._configs=td.GetTableClass(td.TableEnum.TreasureGiftOpenTable).getDatasOfDataId(e)},onLoad:function(){this.coverLayer.active=!1,this._controller.setActivityShown()},onEnable:function(){this._super(),this._addLocalListeners(),this._initUi(),this.schedule(this.updateActivitySurplusTime,1)},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this.unschedule(this.updateActivitySurplusTime),this._super()},_addLocalListeners:function(){var t=td.EventUtil,e={};e[td.EventNameEnum.REFRESH_TREASURE_GIFT_INFO]=this._refreshContent,t.registerEvents(e,this)},_initUi:function(){if(this._configs&&0!==this._configs.length){var t=this.node.getChildByName("rewardBtn");td.RedPointUtil.createRedPointOld(t,{x:-15,y:-15},this._controller.rewardGiftRedPoint.bind(this._controller),this._controller.redPointEvts.bind());var e=this.node.getChildByName("taskBtn");td.RedPointUtil.createRedPointOld(e,{x:-15,y:-15},this._controller.taskRedPoint.bind(this._controller),this._controller.redPointEvts.bind()),this._curSelectType=0;var i=this._configs[this._curSelectType].id;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_02_wxbk,"HD_mingzi_0"+i,this.imgTitle),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_02_wxbk,"HD_baoxiang_0"+i,this.imgEgg),this._refreshContent()}},_refreshContent:function(){this._refreshBaseInfo(),this._refreshCostAndReward()},_refreshBaseInfo:function(){this.haveNumLabel.string=this._controller.getKeyNum(),this.updateTime()},_refreshCostAndReward:function(){var t=this._configs[this._curSelectType];if(t){var e=t.cost;this.costNumLabel.string=e;var i=10,a=this._controller.getKeyNum();a>0&&a<i&&(i=a),this.costTenNumLabel.string=e*i,this.btnTenTimes.getChildByName("Label").getComponent(cc.Label).string=cc.js.formatStr(td.Language.openManyBoxs,i);for(var o=td.RewardManager.parseRewardListDetail(t.showReward),s=0,l=o.length;s<l;s++){var c=o[s],u=this.rewardLayer.getChildByName("icon_"+s);u?u.getComponent(r).setData(c):((u=td.GlobalFunction.createCommonIconWidget(34,c)).name="icon_"+s,u.scale=.9,u.getComponent(r).setNameBgVisible(!1),u.parent=this.rewardLayer)}for(;;s++){var d=this.rewardLayer.getChildByName("icon_"+s);if(!d)break;d.removeFromParent(!0)}this.rewardLayer.getComponent(n.default).updateLayout()}else cc.log("TreasureGiftOpenTable get config error for type = "+this._curSelectType)},updateActivitySurplusTime:function(t){this.updateTime()},updateTime:function(){this.labTime.string=this.getActivityLeftTimeStr()},_onHitEgg:function(t){if(td.GlobalFunction.checkCanClicked()){var e=this._configs[this._curSelectType];if(e){if(this._controller.getKeyNum()<e.cost*t){var i=new td.BroadcastContent(197);return td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i),void this.btnTask()}var n={4:td.ActivityEnum.TreasureGiftKey.OPEN_BOX,5:t},a={id:e.id,parmeterMap:n};this._isHitting=!0,this.getActivityController().operateActivity(a)}}},btnTask:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_TreasureGiftTask,this.getActivityId())},btnReward:function(){var t=this.getActivityController(),e={};e.activityId=this.getActivityId(),e.openTime=t.getOpenTime(),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_TreasureGiftReward,e)},showReward:function(t){var e=td.RewardManager.parseRewardResult(t.rewardResult);this._isHitting?(this._rewardList=e,this._addHitAni()):td.GlobalFunction.showRewards(e)},_addHitAni:function(){if(this.coverLayer.active=!0,this._hitAni){var t=this._hitAni.getComponent(cc.Animation),e=t.getClips();t.play(e[0].name)}else{var i=td.GlobalFunction.getResIdByNode(this.node);gdk.rm.loadRes(i,"uiAnima/JinDan_Effect/JinDan_Effect",cc.Prefab,this._playHitAni.bind(this))}},_playHitAni:function(){var t=gdk.rm.getResByUrl("uiAnima/JinDan_Effect/JinDan_Effect",cc.Prefab),e=cc.instantiate(t);e.name="JinDan_Effect",this._hitAni=e;var i=e.getComponent(cc.Animation);e.addComponent("AnimationComponent").setFrameEventCallBack(this._showRewards.bind(this));var n=i.getClips();i.play(n[0].name),e.y=-640,this.node.addChild(e,900)},_showRewards:function(){this._isHitting=!1,cc.isValid(this.node)&&(this.coverLayer.active=!1,this._rewardList&&(td.GlobalFunction.showRewards(this._rewardList),this._rewardList={}))},onReceiveOperation:function(t){this.showReward(t)},onClickOneTimes:function(){this._onHitEgg(1)},onClickTenTimes:function(){var t=10,e=this._controller.getKeyNum();e>0&&e<t&&(t=e),this._onHitEgg(t)}});e.exports=o,cc._RF.pop()},{"../../../../Common/Component/GridLayoutComponent":void 0,ActivityBasePanel:"ActivityBasePanel",CommonIconWidget:"CommonIconWidget",UFButton:void 0}],TreasureGiftRecordListView:[function(t,e,i){"use strict";cc._RF.push(e,"96fe9DJUWFF9KYoGtOiX/x4","TreasureGiftRecordListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{},setData:function(t){var e=t.dataList;this._super(e)},setItemView:function(t,e){var i=t.getChildByName("lab");i.getComponent(cc.RichText).string="<color=#205d71>"+td.Language.congratulation+"</c><color=#a75c03>"+e.getName()+"</c><color=#205d71>"+td.Language.openBoxRecord+"</c>";var n=t.getChildByName("labName");return n.getComponent(cc.Label).string=e.getRewards()[0].getName()+"x"+e.getRewards()[0].getCount(),td.GlobalFunction.setNameColors(n,e.getRewards()[0].getQuality()),n.x=i.x+i.width,t}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],TreasureGiftRecordModel:[function(t,e,i){"use strict";cc._RF.push(e,"42fdfkAww5EvavKZsT3xdOu","TreasureGiftRecordModel");var n=cc.Class({properties:{_playerName:null,_rewards:null},initData:function(t,e){var i=t.rewardObject,n=[i.type,i.id,i.count];this._rewards=td.RewardManager.parseRewardListDetail([n]),this._playerName=t.attributes[td.UserPropertyEnum.NickName]},getRewards:function(){return this._rewards},getName:function(){return this._playerName}});e.exports=n,cc._RF.pop()},{}],TreasureGiftRecordWindow:[function(t,e,i){"use strict";cc._RF.push(e,"1406bsGg/xNVqG8xLBL8XVn","TreasureGiftRecordWindow");var n=t("PanelBase");cc.Class({extends:n,properties:{_listViewLogic:null,_activityController:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_TreasureGiftRecord},setData:function(t){if(t&&!(t<0)){this._activityController=td.ActivityDataManager.getActivityControllerById(t),this.refrshTaskInfo();for(var e=this.node.getChildByName("rewardNode"),i=this._activityController.getActivityData(),n=td.GetTableClass(td.TableEnum.TreasureGiftOpenTable).getDatasOfDataId(i)[0].showReward,a=[cc.v2(-231,-71),cc.v2(-75,-71),cc.v2(75,-71),cc.v2(231,-71),cc.v2(-231,-229),cc.v2(-75,-229),cc.v2(75,-229),cc.v2(231,-229)],r=0;r<n.length;r++){var o=td.RewardManager.parseRewardListDetail([n[r]])[0],s=td.GlobalFunction.createCommonIconWidget(27,o);s&&(s.setScale(.8),s.setPosition(a[r]),e.addChild(s))}}},onLoad:function(){this._super(),this._activityController=null;var t=this.node.getChildByName("scrollView");this._listViewLogic=t.getComponent("TreasureGiftRecordListView")},onEnable:function(){this._super(),this._addLocalListener()},onDisable:function(){this._super(),this._removeAllListeners()},_addLocalListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_TREASURE_GIFT_INFO,this.refrshTaskInfo,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},clickBgListener:function(){this.closeCallFunc()},refrshTaskInfo:function(){var t={dataList:this._activityController.getRecordList()};this._listViewLogic.setData(t)}});cc._RF.pop()},{PanelBase:void 0}],TreasureGiftRewardListView:[function(t,e,i){"use strict";cc._RF.push(e,"776b2nz/5tBloo8Rr7Ue24D","TreasureGiftRewardListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{_controller:null,_receiveCallBack:null},setData:function(t){var e=t.dataList;this._controller=t.controller,this._receiveCallBack=t.receiveFunc,this._super(e)},setItemView:function(t,e){var i=t.getChildByName("icon"),n=t.getChildByName("labName"),a=t.getChildByName("labCondition"),r=t.getChildByName("labPro"),o=t.getChildByName("imgUnfinish"),s=t.getChildByName("btnGet"),l=t.getChildByName("imgGot"),c=td.RewardManager.parseRewardListDetail([e.getReward()]),u=c[0],d=td.GlobalFunction.createCommonIconWidget(26,u);d&&(d.setScale(.8),d.setPosition(cc.v2(0,0)),i.addChild(d)),n.getComponent(cc.Label).string=e.getRewardName(),td.GlobalFunction.setNameColors(n,c[0].getQuality()),a.getComponent(cc.Label).string=e.getDesc(),r.getComponent(cc.RichText).string=e.getProgressStr();var h=e.getState();o.active=!1,s.active=!1,l.active=!1,h===td.ActivityEnum.TreasureGiftEnum.CAN_Receive?s.active=!0:h===td.ActivityEnum.TreasureGiftEnum.ALREADY_Receive?l.active=!0:h===td.ActivityEnum.TreasureGiftEnum.CAN_NOT_Receive&&(o.active=!0);var p=s.getComponent(cc.Button);p.clickEvents=[];var _=new cc.Component.EventHandler;return _.target=this.node,_.component="TreasureGiftRewardListView",_.handler="onGetReward",_.customEventData=e,p.clickEvents.push(_),td.RedPointUtil.createRedPointSimple(s,{x:-10,y:-10},h===td.ActivityEnum.TreasureGiftEnum.CAN_Receive),t},onGetReward:function(t,e){var i=e;this._receiveCallBack&&"function"==typeof this._receiveCallBack&&this._receiveCallBack(i)}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],TreasureGiftRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"0a4f58baj1BSoFkT4cB7AM9","TreasureGiftRewardModel");var n=cc.Class({properties:{_id:null,_needOpenTimes:null,_reward:null,_rewardName:null,_desc:null,_progressStr:null,_state:null},initData:function(t,e){this._id=t.id,this._reward=t.rewards[0],this._needOpenTimes=t.needOpenTimes;var i=td.GetTableClass(td.TableEnum.Item).getItemById(this._reward[1]);this._rewardName=i.name,this._desc=cc.js.formatStr(td.Language.openBox,this._needOpenTimes),e>=this._needOpenTimes?this._progressStr=" <color=#3A6A97>(</c> <color=#008b0d>"+e+"/"+this._needOpenTimes+"</c> <color=#3A6A97>)</c>":this._progressStr=" <color=#3A6A97>(</c> <color=#ff2a00>"+e+"</c> <color=#ff2a00>/ "+this._needOpenTimes+"</c> <color=#3A6A97>)</c>",this._state=0},getId:function(){return this._id},getReward:function(){return this._reward},getRewardName:function(){return this._rewardName},getDesc:function(){return this._desc},getProgressStr:function(){return this._progressStr},getState:function(){return this._state},setState:function(t){this._state=t},getNeedOpenTime:function(){return this._needOpenTimes}});e.exports=n,cc._RF.pop()},{}],TreasureGiftRewardWindow:[function(t,e,i){"use strict";cc._RF.push(e,"ce841RIiqtCF4AV7PU5oCHg","TreasureGiftRewardWindow");var n=t("PanelBase");cc.Class({extends:n,properties:{_listViewLogic:null,_openTime:null,_activityController:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_TreasureGiftReward},setData:function(t){!t||!t.activityId||t.activityId<0||(this._super(t),this._activityController=td.ActivityDataManager.getActivityControllerById(t.activityId),this._openTime=t.openTime,this.refrshTaskInfo())},onLoad:function(){this._super(),this._activityController=null,this._openTime=0;var t=this.node.getChildByName("scrollView");this._listViewLogic=t.getComponent("TreasureGiftRewardListView")},onEnable:function(){this._super(),this._addLocalListener()},onDisable:function(){this._super(),this._removeAllListeners()},_addLocalListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_TREASURE_GIFT_INFO,this.refrshTaskInfo,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},refrshTaskInfo:function(){var t=this._activityController,e=t.getRewardList();e.sort(function(t,e){var i=t.getState(),n=e.getState();return i===td.ActivityEnum.TreasureGiftEnum.CAN_Receive&&n!=td.ActivityEnum.TreasureGiftEnum.CAN_Receive?-1:n===td.ActivityEnum.TreasureGiftEnum.CAN_Receive&&i!=td.ActivityEnum.TreasureGiftEnum.CAN_Receive?1:i===td.ActivityEnum.TreasureGiftEnum.CAN_NOT_Receive&&n!=td.ActivityEnum.TreasureGiftEnum.CAN_NOT_Receive?-1:n===td.ActivityEnum.TreasureGiftEnum.CAN_NOT_Receive&&i!=td.ActivityEnum.TreasureGiftEnum.CAN_NOT_Receive?1:i===td.ActivityEnum.TreasureGiftEnum.ALREADY_Receive&&n!=td.ActivityEnum.TreasureGiftEnum.ALREADY_Receive?-1:n===td.ActivityEnum.TreasureGiftEnum.ALREADY_Receive&&i!=td.ActivityEnum.TreasureGiftEnum.ALREADY_Receive?1:t.getId()-e.getId()});var i={dataList:e,controller:t,receiveFunc:this.doReceiveAction.bind(this)};this._listViewLogic.setData(i)},doReceiveAction:function(t){if(!(this._openTime<t.getNeedOpenTime())){var e={4:td.ActivityEnum.TreasureGiftKey.GET_REWARD},i={id:t.getId(),parmeterMap:e};this._activityController.operateActivity(i)}},oneKeyAllReceive:function(){if(this._activityController.getHaveReward()){td.ActivityEnum.ActivityParmeterKey.ACTIVITY41;var t={id:0,parmeterMap:{4:td.ActivityEnum.TreasureGiftKey.ONE_KEY_GET_REWARD}};this._activityController.operateActivity(t)}else{var e=new td.BroadcastContent(198);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,e)}}});cc._RF.pop()},{PanelBase:void 0}],TreasureGiftTaskWindow:[function(t,e,i){"use strict";cc._RF.push(e,"4ec9aeZWUFHA4JmFvwsEzlk","TreasureGiftTaskWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{_listView:null,_activityController:null,_curClickTaskId:null},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_TreasureGiftTask},onLoad:function(){this._super(),this._activityController=null;var t=this.node.getChildByName("scrollView");this._listView=t.getComponent("TreasureGiftListView"),this._curClickTaskId=0},onEnable:function(){this._super(),this._addLocalListener()},onDisable:function(){this._super(),this._removeAllListeners()},_addLocalListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_TREASURE_GIFT_INFO,this.refrshTaskInfo,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},setData:function(t){this._super(t),!t||t<0||(this._activityController=td.ActivityDataManager.getActivityControllerById(t),this.refrshTaskInfo())},refrshTaskInfo:function(){var t=this._activityController;if(t){var e=t.getTaskList();e.sort(function(t,e){if(t.isRecharge()&&!e.isRecharge())return-1;if(!t.isRecharge()&&e.isRecharge())return 1;var i=t.getStatus(),n=e.getStatus();return i===td.TaskStatus.Finish&&n!=td.TaskStatus.Finish?-1:n===td.TaskStatus.Finish&&i!=td.TaskStatus.Finish?1:i===td.TaskStatus.Progress&&n!=td.TaskStatus.Progress?-1:n===td.TaskStatus.Progress&&i!=td.TaskStatus.Progress?1:i===td.TaskStatus.Received&&n!=td.TaskStatus.Received?-1:n===td.TaskStatus.Received&&i!=td.TaskStatus.Received?1:t.getTaskId()-e.getTaskId()});var i={dataList:e,controller:t,receiveFunc:this.doReceiveTask.bind(this)};this._listView&&this._listView.setData(i)}},doReceiveTask:function(t){if(t.isRecharge()){var e=this._activityController;if(!e)return;var i={id:0,parmeterMap:{4:4,6:e.getCanExchangeCount()}};e.operateActivity(i)}else this._curClickTaskId=t.getTaskId(),td.EventUtil.dispatchEvent(td.EventNameEnum.Req_TASK_RECEIVE,t.getTaskId())}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],TreasureLevelUpTable:[function(t,e,i){"use strict";cc._RF.push(e,"2fbf4PAlr5AAYDR6n1uonL2","TreasureLevelUpTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tblName="treasure_level_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]||(t[a.id]={}),t[a.id][a.level]=a}},e.prototype.getTreasure=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].level===e)return i[n]}}return null},e.prototype.maxLevel=function(t){return this._data[t]?this._data[t].myLen():0},e.prototype.getAddLevel=function(t,e,i){var n=0,a=!1;if(this._data[t]){var r=this.maxLevel(t),o=this._data[t],s=0;for(var l in o){var c=o[l];if(c.level>=e){if(!((s+=c.needExp)<=i&&c.level<r))break;n++}}if(e+n>=r)i-s>=td.GetConfig("TREASURE_EXP_OVER_LIMIT")&&(a=!0)}return{addLevel:n,isOverExp:a}},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TreasureManger:[function(t,e,i){"use strict";cc._RF.push(e,"1d8f8znOmFFFp9WdIaD/HZB","TreasureManger");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=cc._decorator,o=r.ccclass,s=(r.property,t("../../../TS/Common/ResonancesEnum")),l=t("TreasureModel"),c=t("TreasureReportModel"),u=t("BaseUser"),d=t("TreasureEnum"),h=function(){function t(){this._minStarLevelQuality=0,this._minEvolveLevelQuality=0,this._invisibleTimestamp=0,this._treasureRobArray=[],this._fightReport=[],this._componentSelectIndex=0,this._treasureRobFragmentId=0,this._isUseQuality4=!1,this._treasureBagData={},this._isUseItem=!0,this._isFromFightReport=!0,this.selectIdMap={}}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.clearSelectData=function(){this.selectIdMap={}},t.prototype.isRedPointTips=function(){return!!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.TREASURE)&&(!!this.revengeRedPointTips()||(!!this.taskRewardRedPointTips()||(!!this.hasFragmentToCompose()||a.Account.getUserData().getVigour()>=a.GetConfig("ACTOR_VIGOUR_LIMIT"))))},t.prototype.redPointEvents=function(){var t=a.EventNameEnum;return[t.USER_ATTR_LEVEL_CHANGE,t.USER_ATTR_VIGOUR_CHANGE,t.RES_TREASURE_SNATCH_RECORD].concat(this.revengeRedPointEvent(),this.taskRewardRedPointEvent(),this.fragmentComposeEvent())},t.prototype.revengeRedPointTips=function(){if(!this._fightReport||0===this._fightReport.length)return!1;var t=a.LocalStorageUtil.read(a.LocalDataKey.Treasure_Revenge);t||(t=0);for(var e=0;e<this._fightReport.length;e++)if(this._fightReport[e].getState()===d.TreasureSnatchRecordState.SNATCH&&this._fightReport[e].getTime()>=t)return!0;return!1},t.prototype.revengeRedPointEvent=function(){return[a.EventNameEnum.RES_TREASURE_SNATCH_RECORD]},t.prototype.taskRewardRedPointTips=function(){var t=a.GetTableClass(a.TableEnum.TaskTable).getTaskByType(a.TaskType.TREASURE_SNATCH);if(!t)return!1;for(var e=a.TaskStatus.Finish,i=0;i<t.length;i++){var n=a.TaskManager.getTaskById(t[i].taskId);if(n&&n.getStatus()===e)return!0}return!1},t.prototype.taskRewardRedPointEvent=function(){return[a.EventNameEnum.Res_GET_TASK_INFO]},t.prototype.setRevengeRedState=function(){var t=a.TimeUtil.getTime();a.LocalStorageUtil.write(a.LocalDataKey.Treasure_Revenge,t)},t.prototype.getSelectCount=function(){var t=0;for(var e in this.selectIdMap){this.getTreasureById(e);t++}return t},t.prototype.getSelectTotalExp=function(){var t=0;for(var e in this.selectIdMap){t+=this.getTreasureById(e).getExpValue()}return t},t.prototype.getSelectTotalCfgExp=function(){var t=0;for(var e in this.selectIdMap){t+=this.getTreasureById(e).getCfgExp()}return t},t.prototype.getMinStarLevelEvolveLevel=function(){return 0===this._minEvolveLevelQuality&&(this._minEvolveLevelQuality=a.GetConfig("TREASURE_STAR_UP_EVOLVE_LIMIT")),this._minEvolveLevelQuality},t.prototype.getTreasureCfgIdList=function(t,e,i){var n=[];for(var a in this._treasureMap){var r=this._treasureMap[a];r.getId()!==t||e&&r.isEquipped()||i&&(r.getLevel()>1||r.getEvolveLevel()>0||r.getStarLevel()>0)||(n[n.length]=r)}return n},t.prototype.getTreasureNumById=function(t){var e=0;for(var i in this._treasureMap){this._treasureMap[i].getId()===t&&e++}return e},t.prototype.getTreasureById=function(t){return this._treasureMap[t]?this._treasureMap[t]:null},t.prototype.getTreasureByFragmentId=function(t){var e=a.GetTableClass(a.TableEnum.TreasureTable).getTreasureByFragmentId(t);return e||null},t.prototype.getTreasureByType=function(t,e,i){var n=[];for(var a in this._treasureMap){var r=this._treasureMap[a];r.getType()!==t||e&&r.isEquipped()||!e&&r.getBttleArrayOrderId()===i||(n[n.length]=r)}return n.sort(this.sortTreasure),n},t.prototype.getAllTreasure=function(t,e,i){void 0===i&&(i=0);var n=[];for(var a in this._treasureMap){var r=this._treasureMap[a];t&&r.isEquipped()||e&&(r.getLevel()>1||r.getEvolveLevel()>0||r.getStarLevel()>0)||i&&r.getSId()===i||(n[n.length]=r)}return n.sort(this.sortBySelect),n},t.prototype.getTreasureForRebirth=function(){var t=[];for(var e in this._treasureMap){var i=this._treasureMap[e];!i.isEquipped()&&(i.getLevel()>1||i.getEvolveLevel()>0||i.getStarLevel()>0)&&(t[t.length]=i)}return t},t.prototype.getLevelResLvByIdAndResType=function(t,e){var i=this.getLevelByIdAndResType(t,e);return i.sort(this.sortFunc),i[0]},t.prototype.getLevelByIdAndResType=function(t,e){for(var i=this.getTreasureByBattleArrayOrderId(t),n=[],a=1;a<3;a++){var r=!1;t:for(var o=0;o<i.length;o++)if(i[o].getType()==a){switch(e){case s.ResonancesViewType.TREASURE_LEVEL:n[a]=i[o].getLevel();break;case s.ResonancesViewType.TREASURE_EVOLVE:n[a]=i[o].getEvolveLevel();break;case s.ResonancesViewType.TREASURE_STAR:n[a]=i[o].getStarLevel()}r=!0;break t}r||(n[a]=0)}return n},t.prototype.getTreasureByBattleArrayOrderId=function(t){var e=[];for(var i in this._treasureMap){var n=this._treasureMap[i];n.isEquipped()&&n.getBttleArrayOrderId()==t&&e.push(n)}return e.length>0&&e.sort(this.sortByType),e},t.prototype.getCanSynthesizeCount=function(t){for(var e=a.GetTableClass(a.TableEnum.TreasureTable).getTreasureById(t).fragments,i=0,n=0,r=e.length;n<r;n++){var o=e[n],s=a.ItemManager.getItemNumById(o);i=0===i&&s>0?s:Math.min(i,s)}return i},t.prototype.sortFunc=function(t,e){return t-e},t.prototype.sortByType=function(t,e){return t.getType()!=e.getType()?t.getType()-e.getType():t.getId()-e.getId()},t.prototype.sortBySelect=function(t,e){return 3===t.getType()&&3!==e.getType()?-1:3!==t.getType()&&3==e.getType()?1:t.getExpValue()>e.getExpValue()?1:t.getExpValue()<e.getExpValue()?-1:t.getId()-e.getId()},t.prototype.sortInBag=function(t,e){return t.isEquipped()&&!e.isEquipped()?-1:!t.isEquipped()&&e.isEquipped()?1:t.getBttleArrayOrderId()!=e.getBttleArrayOrderId()?t.getBttleArrayOrderId()-e.getBttleArrayOrderId():t.getQuality()!=e.getQuality()?e.getQuality()-t.getQuality():t.getLevel()!=e.getLevel()?e.getLevel()-t.getLevel():t.getEvolveLevel()!=e.getEvolveLevel()?e.getEvolveLevel()-t.getEvolveLevel():t.getId()-e.getId()},t.prototype.sortTreasure=function(t,e){return t.isEquipped()&&!e.isEquipped()?-1:!t.isEquipped()&&e.isEquipped()?1:t.getQuality()>e.getQuality()?-1:t.getBttleArrayOrderId()!=e.getBttleArrayOrderId()?t.getBttleArrayOrderId()-e.getBttleArrayOrderId():t.getQuality()<e.getQuality()?1:t.getLevel()>e.getLevel()?-1:t.getLevel()<e.getLevel()?1:t.getEvolveLevel()>e.getEvolveLevel()?-1:t.getEvolveLevel()<e.getEvolveLevel()?1:t.getId()-e.getId()},t.prototype.sortTreasureByQuality=function(t,e){return t.getQuality()!=e.getQuality()?e.getQuality()-t.getQuality():t.getId()-e.getId()},t.prototype.destroyData=function(){this._treasureMap={},this._treasureRobArray=[],this._fightReport=[],this._treasureBagData={},this.selectIdMap={}},t.prototype.addListener=function(){var t=a.MsgModuleName.TREASURE,e=a.MsgCmd.TREASURE;a.ServerDelegate.registerMessage(t,e.GET_TREASURE_INFO,this.parseTreausreInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_ADD_EXP,this.pareseAddExp.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_QUICK_ADD_EXP,this.pareseQuickAddExp.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_EVOLVE,this.pareseEvolve.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_STAR_UP,this.pareseStarUp.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_TREASURE_INFO,this.parseTreausreInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_TREASURE_DELETE,this.pareseDelete.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_SYNTHESIZE,this.pareseSynthesize.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_SNATCH_INFO,this.pareseGetSnatchInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_SNATCH_REFRESH,this.pareseSnatchRefresh.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_SNATCH,this.pareseSnatch.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_QUICK_SNATCH,this.pareseQuickSnatch.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_TREASURE_SNATCH_INFO,this.pareseGetSnatchInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_INVISIBLE,this.pareseBuyInvisible.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_SNATCH_RECORD,this.pareseSnatchRecord.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_TREASURE_SNATCH_RECORD,this.pareseSnatchRecord.bind(this)),a.ServerDelegate.registerMessage(t,e.TREASURE_REVENGE,this.pareseRevenge.bind(this))},t.prototype.addEventListener=function(){var t=a.EventUtil,e=a.EventNameEnum,i={};i[e.REQ_GET_TREASURE_INFO]=this.requestGetTreausreInfo,i[e.REQ_TREASURE_ADD_EXP]=this.requestAddExp,i[e.REQ_TREASURE_QUICK_ADD_EXP]=this.requestQuickAddExp,i[e.REQ_TREASURE_EVOLV]=this.requestEvolve,i[e.REQ_TREASURE_STAR_UP]=this.requestStarUp,i[e.REQ_TREASURE_SYNTHESIZE]=this.requestSynthesize,i[e.REQ_TREASURE_SNATCH_INFO]=this.requestGetSnatchInfo,i[e.REQ_TREASURE_SNATCH_REFRESH]=this.requestSnatchRefresh,i[e.REQ_TREASURE_SNATCH]=this.requestSnatch,i[e.REQ_TREASURE_QUICK_SNATCH]=this.requestQuickSnatch,i[e.REQ_TREASURE_INVISIBLE]=this.requestBuyInvisible,i[e.REQ_TREASURE_SNATCH_RECORD]=this.requestRecord,i[e.REQ_TREASURE_REVENGE]=this.requestRevenge,t.registerEvents(i,this)},t.prototype.requestGetTreausreInfo=function(){var t={};t.module=a.MsgModuleName.TREASURE,t.cmd=a.MsgCmd.TREASURE.GET_TREASURE_INFO,a.ServerDelegate.sendMessage(t)},t.prototype.parseTreausreInfo=function(t,e){if(t===a.NetCode.SUCCESS){for(var i=e.treasures,n=0;n<i.length;n++){var r=i[n],o=r.treasureId,s=r.configId;if(this._treasureMap[o])this._treasureMap[o].setData(r);else{var c=a.GetTableClass(a.TableEnum.TreasureTable).getTreasureById(s),u=new l;u.init(c),u.setData(r),this._treasureMap[o]=u}}a.EventUtil.dispatchEvent(a.EventNameEnum.RES_GET_TREASURE_INFO)}},t.prototype.requestAddExp=function(t){var e={};e.module=a.MsgModuleName.TREASURE,e.cmd=a.MsgCmd.TREASURE.TREASURE_ADD_EXP,e.id=t.id;for(var i=t.devourIds,n={},r=[],o=0,s=i.length;o<s;o++){var l=this.getTreasureById(i[o]);if(l&&l.isUpped())r.push(i[o]);else{var c=l.getId();n[c]||(n[c]=0),n[c]++}}e.devourMap=n,e.sidList=r,a.ServerDelegate.sendMessage(e)},t.prototype.pareseAddExp=function(t,e){if(t===a.NetCode.SUCCESS){var i=a.RewardManager.parseRewardResult(e.rewardResult,!0);a.GlobalFunction.showRewards(i),a.EventUtil.dispatchEvent(a.EventNameEnum.RES_TREASURE_ADD_EXP)}},t.prototype.requestQuickAddExp=function(t){var e={};e.module=a.MsgModuleName.TREASURE,e.cmd=a.MsgCmd.TREASURE.TREASURE_QUICK_ADD_EXP,e.id=t,a.ServerDelegate.sendMessage(e)},t.prototype.pareseQuickAddExp=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_TREASURE_QUICK_ADD_EXP)},t.prototype.requestEvolve=function(t){var e={};e.module=a.MsgModuleName.TREASURE,e.cmd=a.MsgCmd.TREASURE.TREASURE_EVOLVE,e.id=t.id,e.devourIds=t.devourIds,a.ServerDelegate.sendMessage(e)},t.prototype.pareseEvolve=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_TREASURE_EVOLV)},t.prototype.requestStarUp=function(t){var e={};e.module=a.MsgModuleName.TREASURE,e.cmd=a.MsgCmd.TREASURE.TREASURE_STAR_UP,e.id=t,a.ServerDelegate.sendMessage(e)},t.prototype.pareseStarUp=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_TREASURE_STAR_UP)},t.prototype.pareseDelete=function(t,e){if(t===a.NetCode.SUCCESS){for(var i=e.ids,n=0;n<i.length;n++){var r=i[n];this._treasureMap[r]&&delete this._treasureMap[r]}a.EventUtil.dispatchEvent(a.EventNameEnum.PUSH_TREASURE_DELETE)}},t.prototype.requestSynthesize=function(t){var e={};e.module=a.MsgModuleName.TREASURE,e.cmd=a.MsgCmd.TREASURE.TREASURE_SYNTHESIZE,e.id=t.id,e.count=t.count||1,a.ServerDelegate.sendMessage(e)},t.prototype.pareseSynthesize=function(t,e){if(a.EventUtil.dispatchEvent(a.EventNameEnum.RES_TREASURE_SYNTHESIZE),t===a.NetCode.SUCCESS){var i=a.RewardManager.parseRewardResult(e.rewardResult,!0);a.GlobalFunction.showRewards(i)}},t.prototype.requestGetSnatchInfo=function(){var t={};t.module=a.MsgModuleName.TREASURE,t.cmd=a.MsgCmd.TREASURE.TREASURE_SNATCH_INFO,a.ServerDelegate.sendMessage(t)},t.prototype.pareseGetSnatchInfo=function(t,e){var i=this;t===a.NetCode.SUCCESS&&(this._invisibleTimestamp=e.invisibleEndTime,this._treasureRobArray=[],e.targeters.forEach(function(t){var e=new u;e.init("",t.attributes),i._treasureRobArray.push(e)}),a.EventUtil.dispatchEvent(a.EventNameEnum.RES_TREASURE_SNATCH_INFO))},t.prototype.requestSnatchRefresh=function(){var t={};t.module=a.MsgModuleName.TREASURE,t.cmd=a.MsgCmd.TREASURE.TREASURE_SNATCH_REFRESH,a.ServerDelegate.sendMessage(t)},t.prototype.pareseSnatchRefresh=function(t,e){a.NetCode.SUCCESS},t.prototype.requestSnatch=function(t){a.EventUtil.dispatchEvent(a.EventNameEnum.RECORD_CUR_LEVEL);var e={};e.module=a.MsgModuleName.TREASURE,e.cmd=a.MsgCmd.TREASURE.TREASURE_SNATCH,e.fragmentId=this._treasureRobFragmentId,e.targetId=t,a.ServerDelegate.sendMessage(e)},t.prototype.pareseSnatch=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_TREASURE_SNATCH,e)},t.prototype.requestQuickSnatch=function(t){var e={};e.module=a.MsgModuleName.TREASURE,e.cmd=a.MsgCmd.TREASURE.TREASURE_QUICK_SNATCH,e.fragmentId=t,a.ServerDelegate.sendMessage(e)},t.prototype.pareseQuickSnatch=function(t,e){if(t===a.NetCode.SUCCESS){var i=e.rewardResult,n=a.RewardManager.parseRewardResult(i,!0);a.EventUtil.dispatchEvent(a.EventNameEnum.RES_TREASURE_QUICK_SNATCH,n)}},t.prototype.requestBuyInvisible=function(t){var e={};e.module=a.MsgModuleName.TREASURE,e.cmd=a.MsgCmd.TREASURE.TREASURE_INVISIBLE,e.hour=t,a.ServerDelegate.sendMessage(e)},t.prototype.requestRecord=function(){this._fightReport=[];var t={};t.module=a.MsgModuleName.TREASURE,t.cmd=a.MsgCmd.TREASURE.TREASURE_SNATCH_RECORD,a.ServerDelegate.sendMessage(t)},t.prototype.requestRevenge=function(t){var e={};e.module=a.MsgModuleName.TREASURE,e.cmd=a.MsgCmd.TREASURE.TREASURE_REVENGE,e.fragmentId=t.fragmentId,e.targetId=t.targetId,e.time=t.time,a.ServerDelegate.sendMessage(e)},t.prototype.pareseBuyInvisible=function(t,e){if(t===a.NetCode.SUCCESS){var i=new a.BroadcastContent(47);a.EventUtil.dispatchEvent(a.EventNameEnum.SHOW_BROADCAST,i),a.EventUtil.dispatchEvent(a.EventNameEnum.TREASURE_INVISIBLE_SUC_RSP)}},t.prototype.pareseSnatchRecord=function(t,e){var i=this;if(t===a.NetCode.SUCCESS){var n=e.records,r=n.length+this._fightReport.length-this._maxFightReportLen;this._maxFightReportLen||(this._maxFightReportLen=a.GetConfig("TREASURE_SNTAHC_RECORD_LIMIT")),r>0&&this._fightReport.splice(0,r),n.forEach(function(t){var e=new c;e.init(t),i._fightReport.push(e)}),a.EventUtil.dispatchEvent(a.EventNameEnum.RES_TREASURE_SNATCH_RECORD)}},t.prototype.pareseRevenge=function(t,e){t===a.NetCode.SUCCESS&&a.EventUtil.dispatchEvent(a.EventNameEnum.RES_TREASURE_REVENGE)},t.prototype.getInvisibleTimestamp=function(){return this._invisibleTimestamp},t.prototype.setComponentSelectIndex=function(t){this._componentSelectIndex=t},t.prototype.getComponentSelectIndex=function(){return this._componentSelectIndex},t.prototype.getTreasureRobArray=function(){return this._treasureRobArray},t.prototype.getTreasureRobFragmentId=function(){return this._treasureRobFragmentId},t.prototype.setTreasureRobFragmentId=function(t){this._treasureRobFragmentId=t},t.prototype.getTreasureBagData=function(){return this._treasureBagData},t.prototype.setTreasureBagData=function(t){this._treasureBagData=t},t.prototype.getIsUseItem=function(){return this._isUseItem},t.prototype.setIsUseItem=function(t){this._isUseItem=t},t.prototype.getFightReport=function(){return this._fightReport},t.prototype.saveOpenReportIndex=function(t){this._openIndex=t},t.prototype.getOpenReportIndex=function(){return this._openIndex},t.prototype.isFromFightReport=function(){return this._isFromFightReport},t.prototype.setIsFromFightReport=function(t){this._isFromFightReport=t},t.prototype.canLevelUp=function(t){var i=this.getTreasureById(t);if(!i||i.isFullLevel())return!1;for(var n=i.getNeedExp(),r=i.getExp(),o=e.getInstance().getAllTreasure(!0,!0),s=0,l=o.length;s<l;s++){var c=o[s];return n-=c.getExpValue(),r+=c.getExpValue(),n<=0&&!!a.GamerResourceUtil.checkResource(a.ItemEnum.Gold,r,a.GamerResourceUtil.TipType.None)}},t.prototype.canOneKeyUp=function(t){return this.getTreasureForUp(t).length>0},t.prototype.canEvolve=function(t){if(!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.TREASURE_EVOLVE))return!1;var i=this.getTreasureById(t);if(!i)return!1;if(a.GetTableClass(a.TableEnum.TreasureEvolveTable).maxLevel(i.getId())===i.getEvolveLevel())return!1;var n=i.getNextEvolveCfg(),r=n.cost,o=n.devourCount,s=a.RewardManager.parseRewardListDetail(r);return!!a.GamerResourceUtil.checkCost(s,a.GamerResourceUtil.TipType.None)&&!(e.getInstance().getTreasureCfgIdList(i.getId(),!0,!0).length<o)},t.prototype.canStarUp=function(t){if(!a.UnlockManager.isTargetUnlock(a.ActorUnlockType.TREASURE_STAR_UP))return!1;var i=this.getTreasureById(t);if(!i||!i.getIsStar())return!1;var n=a.GetTableClass(a.TableEnum.TreasureStarUpTable).maxLevel(i.getId()),r=i.getEvolveLevel(),o=i.getStarLevel();if(r<e.getInstance().getMinStarLevelEvolveLevel()||o>=n)return!1;var s=i.getNextStarCfg().cost,l=a.RewardManager.parseRewardListDetail(s);return!!a.GamerResourceUtil.checkCost(l,a.GamerResourceUtil.TipType.None)},t.prototype.canTreaureUp=function(t){return this.canLevelUp(t)||this.canEvolve(t)},t.prototype.canChange=function(t){for(var e=this.getTreasureById(t),i=e.getType(),n=e.getQuality(),a=e.getLevel(),r=e.getEvolveLevel(),o=this.getTreasureByType(i,!0,-1),s=0;s<o.length;s++){if(o[s].getQuality()>n)return!0;if(o[s].getQuality()===n){if(o[s].getLevel()>a)return!0;if(o[s].getLevel()===a)return o[s].getEvolveLevel()>r}}return!1},t.prototype.hasFragmentToCompose=function(){var t=a.ItemManager.getItemsDatasByGoodsSubType(a.GoodsSubType.TREASURE_FRAGMENT),e=a.GetTableClass(a.TableEnum.TreasureTable).getDatas();for(var i in e){var n=e[i].fragments;if(n&&0!==n.length){for(var r=!0,o=0,s=n.length;o<s;o++){if(!t[n[o]]){r=!1;break}}if(r)return!0}}return!1},t.prototype.isItemCouldCompose=function(t){for(var e=t.getFragments(),i=0;i<e.length;i++){if(!a.ItemManager.getItemNumById(e[i]))return!1}return!0},t.prototype.fragmentComposeEvent=function(){return[a.EventNameEnum.ITEM_CHANGE]},t.prototype.hasBetterToReplace=function(t,e){var i=this.getTreasureById(t);if(i){for(var n=i.getType(),a=this.getTreasureByType(n,!0,!0),r=0,o=a.length;r<o;r++){var s=a[r],l=e.getReinforcementIds();if(!(s.getQuality()<i.getQuality())){if(s.getQuality()>i.getQuality())return!0;if(s.isPartnerCanActive(l)||!i.isPartnerCanActive(l)){if(s.isPartnerCanActive(l)&&!i.isPartnerCanActive(l))return!0;if(!(s.getStarLevel()<i.getStarLevel())){if(s.getStarLevel()>i.getStarLevel())return!0;if(!(s.getEvolveLevel()<i.getEvolveLevel())){if(s.getEvolveLevel()>i.getEvolveLevel())return!0;if(!(s.getLevel()<i.getLevel())){if(s.getLevel()>i.getLevel())return!0;if(!(s.getId()<i.getId())&&s.getId()>i.getId())return!0}}}}}}return!1}},t.prototype.getActivitedEvolveSpecialEffectIdsByEquipId=function(t){var e=[],i=this.getTreasureById(t);if(!i.isEquipped())return e;var n=a.GetTableClass(a.TableEnum.TreasureEvolveEffectTable).getEffectsByTreasureId(i.getId()),r=a.BattleArrayManager.getBattleTreasureByIndex(i.getBttleArrayOrderId());return n.forEach(function(t){var i=0,n=t.treasureIds;for(var a in r)-1!=n.indexOf(r[a].getId())&&r[a].getEvolveLevel()>=t.level&&i++;i>=t.count&&e.push(t.id)}),e},t.prototype.getIsUseQuality4=function(){return this._isUseQuality4},t.prototype.setIsUseQuality4=function(t){this._isUseQuality4=t},t.prototype.oneKeyUp=function(t,e){var i=[],n=[];this.getTreasureForUp(e).forEach(function(t){3===t.getType()?i.push(t):n.push(t)}),i.sort(this.sortByQuality),n.sort(this.sortByQuality);var a=this.countTotalExp(i);return a>=t?this.pickItem(i,t):i.concat(this.pickItem(n,t-a))},t.prototype.pickItem=function(t,e){var i=0,n=[];t:for(var a=0;a<t.length;a++){if(i+=t[a].getExpValue(),n.push(t[a]),i>e){e:for(var r=a;r>=0;r--)if(i-n[r].getExpValue()>e)i-=n[r].getExpValue(),n.splice(r,1);else if(i-n[r].getExpValue()===e)break e;break t}if(i===e)break t}return n},t.prototype.sortByQuality=function(t,e){return t.getQuality()!=e.getQuality()?t.getQuality()-e.getQuality():t.getStarLevel()!=e.getStarLevel()?t.getStarLevel()-e.getStarLevel():t.getEvolveLevel()!=e.getEvolveLevel()?t.getEvolveLevel()-e.getEvolveLevel():t.getLevel()!=e.getLevel()?t.getLevel()-e.getLevel():t.getId()-e.getId()},t.prototype.getTreasureForUp=function(t){void 0===t&&(t=0);var e=[];for(var i in this._treasureMap){var n=this._treasureMap[i];if(!n.isEquipped()&&n.getSId()!=t){var a=n.getQuality();3===n.getType()?e[e.length]=n:this._isUseQuality4?a<=4&&(e[e.length]=n):a<4&&(e[e.length]=n)}}return e},t.prototype.getMaxUpLv=function(t){var e=0,i=t.getLevel(),n=t.getMaxLevel(),r=a.Account.getUserData().getGold(),o=this.getTreasureForUp(t.getSId()),s=this.countTotalExp(o),l=t.getNeedExp();if(l>s||l>r)return e;for(s-=l,r-=l,e++;s>=t.getNeedExpBylv(i+e)&&r>=t.getNeedExpBylv(i+e)&&i+e<n;)s-=t.getNeedExpBylv(i+e),r-=t.getNeedExpBylv(i+e),e++;return e},t.prototype.getUpLvbyMaterials=function(t,e){var i=0,n=!1,r=this.countTotalExp(e),o=t.getNeedExp(),s=t.getLevel(),l=t.getMaxLevel();if(!(r>=o))return{addLevel:i,isOverExp:n};for(i++,r-=o;r>0;){var c=t.getNeedExpBylv(s+i);if(!(c&&r>=c)){var u=a.GetConfig("TREASURE_EXP_OVER_LIMIT");return s+i>=l&&r>=u&&(n=!0),{addLevel:i,isOverExp:n}}i++,r-=c}return{addLevel:i,isOverExp:n}},t.prototype.countTotalExp=function(t){for(var e=0,i=0;i<t.length;i++){e+=t[i].getExpValue()}return e},t=e=n([o],t)}();i.default=h,cc._RF.pop()},{"../../../TS/Common/ResonancesEnum":"ResonancesEnum",BaseUser:"BaseUser",TreasureEnum:"TreasureEnum",TreasureModel:"TreasureModel",TreasureReportModel:"TreasureReportModel"}],TreasureModel:[function(t,e,i){"use strict";cc._RF.push(e,"83c1b4ZLYRG9ZQbH87oFhOQ","TreasureModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();Object.defineProperty(i,"__esModule",{value:!0});var a=window.td,r=t("../Model/SpecialAttributeEnum"),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._canEvolve=!1,e._canStarUp=!1,e}return n(e,t),e.prototype.init=function(e){t.prototype.init.call(this,"Treasure",a.UserPropertyEnum.Treasure,e.id,e.name,null,null,e.animationType),this._goodsType=a.GoodsType.Type_Treasure,this._isEquipped=!1,this._battleArrayOrderId=0,this.setLevel(1),this.setEvolveLevel(0),this.setStarLevel(0),this._quality=e.quality,this._icon=e.iconRes,this._pic=e.iconRes,this._desc=e.desc,this._type=e.type,this._cfgExp=e.exp,this._obtainWay=e.obtainWay,this._fragments=e.fragments,this._starUpQuality=e.starUpQuality,this._isStar=e.isStar,this._starUpName=e.starUpName,this._starUpIconRes=e.starUpIconRes,this._levelCfg=null,this._evolveCfg=null,this._starCfg=null},e.prototype.setData=function(t){this._exp=t.exp,this.setLevel(t.level),this.setEvolveLevel(t.evolveLevel),this.setStarLevel(t.starLevel),t.treasureId&&(this._sId=t.treasureId)},e.prototype.getName=function(){return this._isStar&&this.isStarMaxLv()?this._starUpName:this._name},e.prototype.getIsStar=function(){return this._isStar},e.prototype.getShowQuality=function(){return this._isStar&&this.isStarMaxLv()?this._starUpQuality:this._quality},e.prototype.getStarMaxLv=function(){return a.GetTableClass(a.TableEnum.TreasureStarUpTable).maxLevel(this._id)},e.prototype.isStarMaxLv=function(){return this._starLevel>=this.getStarMaxLv()},e.prototype.canEvolve=function(){},e.prototype.canStarUp=function(){},e.prototype.isFullLevel=function(){return this._levelCfg&&0===this._levelCfg.nextLevel||!1},e.prototype.getNextLevel=function(){return this._levelCfg&&this._levelCfg.nextLevel||0},e.prototype.getLevelNeedExp=function(){return this._levelCfg&&this._levelCfg.needExp||[]},e.prototype.getNeedExpBylv=function(t){var e=a.GetTableClass(a.TableEnum.TreasureLevelUpTable).getTreasure(this._id,t);return e?e.needExp:0},e.prototype.getLevelAttr=function(){return this._levelCfg&&this._levelCfg.attributes||[]},e.prototype.getEvolveAttr=function(){return this._evolveCfg&&this._evolveCfg.attributes||[]},e.prototype.getEvolveAttrTT=function(){return this._evolveCfg&&this._evolveCfg.attributeTTPercent||[]},e.prototype.getStarAttr=function(){return this._starCfg&&this._starCfg.attributes||[]},e.prototype.getStarAttrTT=function(){return this._starCfg&&this._starCfg.attributeTTPercent||[]},e.prototype.getCurrentLevelAttr=function(){var t={};return this.getLevelAttr().forEach(function(e){t[e[0]]=e[1]}),t},e.prototype.getStarSpecialEffectAttr=function(){var t=[];return a.GetTableClass(a.TableEnum.TreasureStarUpTable).getSpecialIdsByLv(this._id,this._starLevel).forEach(function(e){if(a.GetTableClass(a.TableEnum.SpecialEffectTable).getDataById(e).type==r.SpecialEffectType.ATTRIBUTE){var i=a.GetTableClass(a.TableEnum.SpecialAttributeTable).getDataById(e);t.push(i)}}),t},e.prototype.getEvolveSpecialEffectAttr=function(){var t=[];return a.GetTableClass(a.TableEnum.TreasureEvolveTable).getSpecialIdsByLv(this._id,this._evolveLevel).forEach(function(e){if(a.GetTableClass(a.TableEnum.SpecialEffectTable).getDataById(e).type==r.SpecialEffectType.ATTRIBUTE){var i=a.GetTableClass(a.TableEnum.SpecialAttributeTable).getDataById(e);t.push(i)}}),t},e.prototype.getTTAttr=function(t){var e={};return this.getLevelAttr().forEach(function(i){t[i[0]]&&(e[i[0]]?e[i[0]]+=Math.ceil(i[1]*t[i[0]]/1e4):e[i[0]]=Math.ceil(i[1]*t[i[0]]/1e4))}),e},e.prototype.getCurrentStarAttrTT=function(){var t={};this._starCfg&&(this._starCfg.attributeTTPercent?this._starCfg.attributeTTPercent:[]).forEach(function(e){t[e[0]]?t[e[0]]+=e[1]:t[e[0]]=e[1]});return t},e.prototype.getCurrentStarAttr=function(){var t={};this._starCfg&&(this._starCfg.attributes?this._starCfg.attributes:[]).forEach(function(e){t[e[0]]?t[e[0]]+=e[1]:t[e[0]]=e[1]});return t},e.prototype.getCurrentEvolveAttr=function(){var t={};this._evolveCfg&&(this._evolveCfg.attributes?this._evolveCfg.attributes:[]).forEach(function(e){t[e[0]]?t[e[0]]+=e[1]:t[e[0]]=e[1]});return t},e.prototype.getCurrentEvolveAttrTT=function(){var t={};this._evolveCfg&&(this._evolveCfg.attributeTTPercent?this._evolveCfg.attributeTTPercent:[]).forEach(function(e){t[e[0]]?t[e[0]]+=e[1]:t[e[0]]=e[1]});return t},e.prototype.getTotalAttrTT=function(){var t=this.getCurrentStarAttrTT(),e=this.getCurrentEvolveAttrTT(),i={};this.getStarSpecialEffectAttr().forEach(function(t){t.type==r.AttributeTargetType.SELF&&(t.attributeTTPercent&&t.attributeTTPercent.forEach(function(t){i[t[0]]?i[t[0]]+=t[1]/1e4:i[t[0]]=t[1]/1e4}))});var n={},a={};for(var o in t)a[o]?a[o]+=t[o]:a[o]=t[o];for(var o in e)a[o]?a[o]+=e[o]:a[o]=e[o];for(var o in i)a[o]?a[o]+=i[o]:a[o]=i[o];for(var o in n)a[o]?a[o]+=n[o]:a[o]=n[o];return a},e.prototype.getTotalAttrAbsolute=function(){var t=this.getCurrentLevelAttr(),e=this.getCurrentStarAttr(),i=this.getCurrentEvolveAttr(),n={},a=this.getStarSpecialEffectAttr();for(var o in a.forEach(function(t){t.type==r.AttributeTargetType.SELF&&(t.attributes&&t.attributes.forEach(function(t){n[t[0]]?n[t[0]]+=t[1]:n[t[0]]=t[1]}))}),t)n[o]?n[o]+=t[o]:n[o]=t[o];for(var o in e)n[o]?n[o]+=e[o]:n[o]=e[o];for(var o in i)n[o]?n[o]+=i[o]:n[o]=i[o];return n},e.prototype.getTotalAttr=function(){var t=this.getTotalAttrAbsolute(),e=this.getTotalAttrTT();return a.GlobalFunction.getAttrMultipyAttrTT(t,e),t},e.prototype.setLevel=function(t){this._level=t,this._levelCfg=a.GetTableClass(a.TableEnum.TreasureLevelUpTable).getTreasure(this._id,t)},e.prototype.getEvolveCfg=function(){return this._evolveCfg},e.prototype.getNextEvolveCfg=function(){return a.GetTableClass(a.TableEnum.TreasureEvolveTable).getTreasure(this._id,this._evolveLevel+1)},e.prototype.setEvolveLevel=function(t){this._evolveLevel=t,this._evolveCfg=a.GetTableClass(a.TableEnum.TreasureEvolveTable).getTreasure(this._id,t)},e.prototype.setStarLevel=function(t){this._starLevel=t,this._starCfg=a.GetTableClass(a.TableEnum.TreasureStarUpTable).getTreasure(this._id,t)},e.prototype.getStarCfg=function(){return this._starCfg},e.prototype.getNextStarCfg=function(){return a.GetTableClass(a.TableEnum.TreasureStarUpTable).getTreasure(this._id,this._starLevel+1)},e.prototype.getType=function(){return this._type},e.prototype.getLevel=function(){return this._level},e.prototype.getMaxLevel=function(){return a.GetTableClass(a.TableEnum.TreasureLevelUpTable).maxLevel(this._id)},e.prototype.getExp=function(){return this._exp},e.prototype.getNeedExp=function(){return this.getLevelNeedExp()-this._exp},e.prototype.getEvolveLevel=function(){return this._evolveLevel},e.prototype.getStarRankInfo=function(){return{star:Math.floor(this._starLevel/a.GetConfig("TREASURE_STAR_UP_UNIT")),rank:this._starLevel%a.GetConfig("TREASURE_STAR_UP_UNIT")}},e.prototype.getStarRankStr=function(t){var e=t||this._starLevel,i=Math.floor(e/a.GetConfig("TREASURE_STAR_UP_UNIT")),n=e%a.GetConfig("TREASURE_STAR_UP_UNIT");return cc.js.formatStr(a.Language.starRank,i,n)},e.prototype.getStarDes=function(){var t=a.GetTableClass(a.TableEnum.TreasureStarUpTable).getNextSpecialIdsByLv(this._id,this._starLevel);if(t){var e=a.GetTableClass(a.TableEnum.SpecialEffectTable).getDataById(t);if(e){var i=a.GetTableClass(a.TableEnum.TreasureStarUpTable).getLvbySpecialId(this._id,t),n=Math.floor(i/a.GetConfig("TREASURE_STAR_UP_UNIT"));return cc.js.formatStr(a.Language.starRankDes,n)+"  "+e.name}}return""},e.prototype.getStar=function(){return Math.floor(this._starLevel/a.GetConfig("TREASURE_STAR_UP_UNIT"))},e.prototype.getStarLevel=function(){return this._starLevel},e.prototype.getGoodsType=function(){return this._goodsType},e.prototype.getQuality=function(){return this._quality},e.prototype.getDesc=function(){return this._desc},e.prototype.getDes=function(){return this._desc},e.prototype.getIcon=function(){return this._isStar&&this.isStarMaxLv()?this._starUpIconRes:this._pic},e.prototype.getPic=function(){return this._isStar&&this.isStarMaxLv()?this._starUpIconRes:this._pic},e.prototype.getCfgExp=function(){return this._cfgExp},e.prototype.getExpValue=function(){for(var t=this._exp,e=1;e<this._level;e++){t+=a.GetTableClass(a.TableEnum.TreasureLevelUpTable).getTreasure(this._id,e).needExp}return t+=this.getCfgExp()},e.prototype.isEquipped=function(){return this._isEquipped},e.prototype.setEquipped=function(t){this._isEquipped=t},e.prototype.getBttleArrayOrderId=function(){return this._battleArrayOrderId},e.prototype.setBattleArrayEntityOrderId=function(t){this._battleArrayOrderId=t},e.prototype.getFragments=function(){return this._fragments},e.prototype.getObtainWay=function(){return this._obtainWay},e.prototype.setCount=function(t){this._count=t},e.prototype.getCount=function(){return this._count},e.prototype.isUpped=function(){return this.getLevel()>1||this.getEvolveLevel()>0||this.getStarLevel()>0},e.prototype.isPartnerCanActive=function(t){for(var e=0;e<t.length;e++){var i=a.PartnershipManager.getPartnershipById(t[e]);if(i.getTargetType()==this.getGoodsType()&&-1!=i.getTargetIds().indexOf(this.getId()))return!0}return!1},e}(t("PropertyModel"));e.exports=o,cc._RF.pop()},{"../Model/SpecialAttributeEnum":"SpecialAttributeEnum",PropertyModel:"PropertyModel"}],TreasureReportModel:[function(t,e,i){"use strict";cc._RF.push(e,"35ad1F52QpGlZXltDM9zl0a","TreasureReportModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isOpen=!1,e}return n(e,t),e.prototype.init=function(t){void 0!==t.attributes&&(this._attributes=t.attributes),void 0!==t.fragmentId&&(this._fragmentId=t.fragmentId),void 0!==t.state&&(this._state=parseInt(t.state)),void 0!==t.time&&(this._time=t.time)},e.prototype.getAttributes=function(){return this._attributes},e.prototype.getFragmentId=function(){return this._fragmentId},e.prototype.getState=function(){return this._state},e.prototype.getTime=function(){return this._time},e.prototype.setIsOpen=function(t){this._isOpen=t},e.prototype.getIsOpen=function(){return this._isOpen},e}(t("PropertyModel")));e.exports=a,cc._RF.pop()},{PropertyModel:"PropertyModel"}],TreasureStarUpTable:[function(t,e,i){"use strict";cc._RF.push(e,"156ea1/8QBJmbiIUaQDU512","TreasureStarUpTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._tblName="treasure_star_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]||(t[a.id]={}),t[a.id][a.starLevel]=a}},e.prototype.getTreasure=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){if(i[n].starLevel===e)return i[n]}}return null},e.prototype.getSpecialIds=function(t){var e=[];if(this._data[t]){var i=this._data[t];for(var n in i){var a=i[n];if(a.specialEffectId>0){var r={level:n,id:a.specialEffectId};e.push(r)}}}return e},e.prototype.getSpecialIdsByLv=function(t,e){var i=[];if(this._data[t]){var n=this._data[t];for(var a in n){var r=n[a];r.specialEffectId>0&&r.starLevel<=e&&i.push(r.specialEffectId)}}return i},e.prototype.getSpecialIdByLv=function(t,e){if(this._data[t])for(var i=this._data[t],n=1;n<=i.myLen();n++){var a=i[n];if(a.specialEffectId>0&&a.starLevel===e)return a.specialEffectId}return 0},e.prototype.getNextSpecialIdsByLv=function(t,e){if(this._data[t]){for(var i=this._data[t],n=0,a=1;a<=i.myLen();a++){(r=i[a]).specialEffectId>0&&r.starLevel===e&&(n=r.specialEffectId)}for(a=1;a<=i.myLen();a++){var r;if((r=i[a]).specialEffectId>n&&r.starLevel>e)return r.specialEffectId}}return 0},e.prototype.getLvbySpecialId=function(t,e){if(this._data[t]){var i=this._data[t];for(var n in i){var a=i[n];if(a.specialEffectId==e)return a.starLevel}}return 0},e.prototype.maxLevel=function(t){return this._data[t]?this._data[t].myLen():0},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TreasureTable:[function(t,e,i){"use strict";cc._RF.push(e,"0f990/WA6RF2KphNDfDhQ8I","TreasureTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="TreasureConfig",e._tblName="treasure_config",e._data={},e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.id]=a}},e.prototype.getTreasureById=function(t){return this._data[t]?this._data[t]:null},e.prototype.getTreasureByFragmentId=function(t){for(var e in this._data)if(-1!=this._data[e].fragments.indexOf(t))return this._data[e];return null},e.prototype.getDatas=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],TurnTableQuickExactWindow:[function(t,e,i){"use strict";cc._RF.push(e,"2ce2aSMm5BKR5uwcqErkJSm","TurnTableQuickExactWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lab_cost1=null,e.imgCostIcon1=null,e.imgCostIcon2=null,e.lab_cost2=null,e.operateCountLabel=null,e.btnSub1=null,e.btnSub10=null,e.btnAdd1=null,e.btnAdd10=null,e.labTitle=null,e._operateNum=1,e._value=0,e._isNoItem=!1,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_TurnTableQuickExact},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this)},e.prototype._addEventListener=function(){r.EventNameEnum;r.EventUtil.registerEvents({},this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this.buyCost1=e.buyCost1||null,this.buyCost2=e.buyCost2||null,this._maxNum=e.maxNum||null,this._okCallFunc=e.okCallFunc||null;var i=e.titleStr||null;i&&(this.labTitle.string=i),this._operateNum=1,this._operateNum=this._maxNum,this._refreshBaseInfo()},e.prototype._refreshBaseInfo=function(){this.operateCountLabel.string=this._operateNum+"",this.imgCostIcon1.active=!!this.buyCost1,this.buyCost1&&(r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,this.buyCost1.getLittleIconResPath(),this.imgCostIcon1),this.lab_cost1.string=this.buyCost1.getCount()*this._operateNum+"/"+r.ItemManager.getItemNumById(this.buyCost1.getId())),this.lab_cost2.node.active=!!this.buyCost2,this.imgCostIcon2.active=!!this.buyCost2,this.buyCost2&&(r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,this.buyCost2.getLittleIconResPath(),this.imgCostIcon2),this.lab_cost2.string=this.buyCost2.getCount()*this._operateNum+"/"+r.ItemManager.getItemNumById(this.buyCost2.getId())),r.GlobalFunction.setButtonGray(this.btnSub1,this._operateNum<=1),r.GlobalFunction.setButtonGray(this.btnSub10,this._operateNum<=1),r.GlobalFunction.setButtonGray(this.btnAdd1,this._operateNum>=this._maxNum),r.GlobalFunction.setButtonGray(this.btnAdd10,this._operateNum>=this._maxNum)},e.prototype.onOperateNum=function(t,e){e=parseInt(e),this._operateNum+=e,this._operateNum<1?this._operateNum=1:this._operateNum>this._maxNum&&(this._operateNum=this._maxNum),this._refreshBaseInfo()},e.prototype.onBtn=function(){this._okCallFunc(this._operateNum),this.closeCallFunc()},e.prototype.onCancel=function(){this.closeCallFunc()},a([l(cc.Label)],e.prototype,"lab_cost1",void 0),a([l(cc.Node)],e.prototype,"imgCostIcon1",void 0),a([l(cc.Node)],e.prototype,"imgCostIcon2",void 0),a([l(cc.Label)],e.prototype,"lab_cost2",void 0),a([l(cc.Label)],e.prototype,"operateCountLabel",void 0),a([l(cc.Node)],e.prototype,"btnSub1",void 0),a([l(cc.Node)],e.prototype,"btnSub10",void 0),a([l(cc.Node)],e.prototype,"btnAdd1",void 0),a([l(cc.Node)],e.prototype,"btnAdd10",void 0),a([l(cc.Label)],e.prototype,"labTitle",void 0),e=a([s,c("module/Activity_14_Turntable/TurnTableQuickExactWindow")],e)}(t("PanelBase"));i.default=u,cc._RF.pop()},{PanelBase:void 0}],TurntableController:[function(t,e,i){"use strict";cc._RF.push(e,"9e931cmz5BJNLFPfpcKz/NY","TurntableController");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=t("LuckyModel"),r=1,o=2,s=3,l=4,c=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t._dataId=0,t._recharge=0,t._useRecharge=0,t._nextFreeTime=0,t._playTimes=0,t._useCount=0,t}return n(i,e),i.prototype.initData=function(t){e.prototype.initData.call(this,t),this.clearData(),this.addEventListener(),this._maxMsgLength=td.GetConfig("ACTIVITY_TURN_TABLE_LUCK_MESSAGE_NUM")},i.prototype.clearData=function(){this._dataId=0,this._recharge=0,this._nextFreeTime=0,this._playTimes=0,this._useRecharge=0,this._useCount=0,this._costTicket=null,this._otherCost=null,this._rewardList=[],this._timesRewardList={},this._operateType=null,this._isJumpToRecharge=!1,this._luckyMsgList=[]},i.prototype.addEventListener=function(){var t=td.EventNameEnum,e={};e[t.REQ_ACTIVITY_TURNTABLE_PLAY]=this._reqPlay,e[t.REQ_TURN_TABLE_TIMES_REWARD]=this._reqGetTimesReward,e[t.REQ_TURN_TABLE_TASK]=this._reqTaskReceive,e[t.REQ_TURN_TABLE_EXCHANGE]=this._reqExchange,e[t.ON_ACTIVITY_OPERATE_SUCCESS]=this.onActivityOperate,e[t.ON_TURN_TABLE_JUMP_TO_RECHARGE]=this._onJumpToRecharge,td.EventUtil.registerEvents(e,this)},i.prototype._onJumpToRecharge=function(){this._isJumpToRecharge=!0},i.prototype.isFromRecharge=function(){var t=this._isJumpToRecharge;return this._isJumpToRecharge=!1,t},i.prototype.getRewardList=function(){return this._rewardList},i.prototype.getPlayTimes=function(){return this._playTimes},i.prototype.getBuyConfigsByType=function(t){for(var e=td.GetTableClass(td.TableEnum.ActivityTurnTableBuyConfig).getActivityTurnTableBuyConfigById(this._dataId),i=[],n=0,a=e.length;n<a;n++)e[n].type===t&&(i[i.length]=e[n]);return i.sort(function(t,e){return e.sortRank-t.sortRank}),i},i.prototype.getShowRewards=function(){var t=[],e=td.GetTableClass(td.TableEnum.ActivityTurnTableBuyConfig).getActivityTurnTableBuyConfigById(this._dataId);if(!e||0===e.length)return t;for(var i=0,n=e.length;i<n;i++){var a=e[i];a.showUI&&(t=t.concat(a.rewards))}return t=td.RewardManager.parseRewardListDetail(t)},i.prototype.getPreviewReward=function(){var t=null,e=td.GetConfig("ACTIVITY_TURN_TABLE_PREVIEW");if(e&&e.length>0)for(var i=0,n=e.length;i<n;i++){var a=e[i];if(a[0]===this._dataId){t=td.RewardManager.getRewardDetail(a[1]);break}}return t},i.prototype.getNextFreeTime=function(){return this._nextFreeTime},i.prototype.getCostPerTime=function(){if(!this._costTicket){var t=td.GetConfig("ACTIVITY_TURN_TABLE_COST");this._costTicket=td.RewardManager.parseRewardListDetail(t)[0]}return this._costTicket},i.prototype.getOtherCostPerTime=function(){if(!this._otherCost){var t=td.GetConfig("ACTIVITY_TURN_TABLE_COST");this._otherCost=td.RewardManager.parseRewardListDetail(t)[1]}return this._otherCost},i.prototype.getTimesRewards=function(){var t=[];if(this._timesRewardList&&this._timesRewardList.myLen()>0){for(var e in this._timesRewardList)t[t.length]=this._timesRewardList[e];t.sort(function(t,e){return t.getRewardStatus()!==e.getRewardStatus()?t.getRewardStatus()-e.getRewardStatus():t.getTimes()-e.getTimes()})}return t},i.prototype.getCanExchangeTicket=function(){var t=td.GetConfig("ACTIVITY_TURN_TABLE_KEY_MEMO")[0][0];return Math.floor((this._recharge-this._useRecharge)/t)},i.prototype.getTaskList=function(){var t=[],e={},i=td.GetConfig("ACTIVITY_TURN_TABLE_KEY_MEMO")[0][0];return e.isRecharge=!0,e.value=this.getCanExchangeTicket(),e.desc=cc.js.formatStr(td.Language.treasureGiftExchange,i/10),t[t.length]=e,t},i.prototype.getLastPlayPos=function(t){var e=1;if(!this._rewardList||0===this._rewardList.length||!t)return e;for(var i=0,n=this._rewardList.length;i<n;i++){var a=this._rewardList[i],r=a.getRewardItem();if(r.getGoodsType()===t.type&&r.getId()===parseInt(t.id)&&r.getCount()===t.count){e=a.getSortRank();break}}return e},i.prototype.getLuckyMsgList=function(){return this._luckyMsgList},i.prototype._reqPlay=function(t){this._operateType=r;var e={id:t,parmeterMap:{14:this._operateType}};this.operateActivity(e)},i.prototype._reqGetTimesReward=function(t){this._operateType=o;var e={id:t,parmeterMap:{14:this._operateType}};this.operateActivity(e)},i.prototype._reqTaskReceive=function(){this._operateType=l;var t={parmeterMap:{14:this._operateType}};this.operateActivity(t)},i.prototype._reqExchange=function(t){this._operateType=s;var e={6:t.count,14:this._operateType},i={id:t.id,parmeterMap:e};this.operateActivity(i)},i.prototype.activityParse=function(t){this._initRewardList();var e=t.record;if(e){this._recharge=e.recharge||0,this._useRecharge=e.useRecharge||0,this._nextFreeTime=e.nextFreeTime||0,this._playTimes=e.times||0;var i=e.receiveList,n=td.RewardStatus;for(var a in this._timesRewardList){var r=parseInt(a),o=this._timesRewardList[a];ArrayUtils.contains(i,r)?o.setRewardStatus(n.RECEIVED):this._playTimes>=r?o.setRewardStatus(n.CAN_RECEIVE):o.setRewardStatus(n.CANNOT_RECEIVE)}td.EventUtil.dispatchEvent(td.EventNameEnum.ACTIVITY_TURN_TABLE_INFO_CHANGED)}var s=t.global;if(s){s.refresh&&(this._luckyMsgList=[]);for(var l=s.messageList,c=td.UserPropertyEnum,u=td.RewardManager,d=this._luckyMsgList,h=td.Language.TurnTableMsg,p=0,_=l.length;p<_;p++)for(var g=l[p],f=g.attributes,v=g.rewardList,m=f[c.NickName],y=f[c.ServerId],E=0,T=v.length;E<T;E++){var C=u.getRewardDetail(v[E]),R=(C.getName()||"")+"x"+(C.getCount?C.getCount():1),S=C.getQuality(),I=cc.js.formatStr(h,y,m,R);I=td.UFRichTextParser.parseXML(I,S),d.unshift({quality:S,msg:I})}this._luckyMsgList=d||[],this._luckyMsgList.length>this._maxMsgLength&&(this._luckyMsgList=d.slice(0,this._maxMsgLength))}},i.prototype.onActivityOperate=function(t){if(t.activityId===this._activityId){var e=t.rewardResult,i=td.RewardManager.parseRewardResult(e,!0);this._operateType===r?td.EventUtil.dispatchEvent(td.EventNameEnum.ACTIVITY_TURNTABLE_ON_PLAY,i):(td.GlobalFunction.showRewards(i),this._operateType===s&&td.EventUtil.dispatchEvent(td.EventNameEnum.ON_TURN_TABLE_BUY_SUCCESS))}},i.prototype._initRewardList=function(){var t=this.getActivityData();if(t!==this._dataId){this._dataId=t,this._rewardList=[];var e=td.GetTableClass(td.TableEnum.ActivityTurnTableConfig).getActivityTurnTableConfigById(t);if(e&&0!==e.length){for(var i=this._rewardList,n=0,r=e.length;n<r;n++){var o=e[n],s=new a;s.initData(o),i[i.length]=s}i.sort(function(t,e){return t.getSortRank()-e.getSortRank()}),this._initTimesRewardList()}else cc.log("get turntable activity config error!!!! ")}},i.prototype._initTimesRewardList=function(){this._timesRewardList={};var e=td.GetTableClass(td.TableEnum.ActivityTurnTableTimesRewardConfig).getActivityTurnTableTimesRewardConfigById(this._dataId);if(e&&0!==e.length)for(var i=t("TurntableRewardModel"),n=0,a=e.length;n<a;n++){var r=e[n],o=new i;o.init(r),this._timesRewardList[o.getTimes()]=o}else cc.log("get turntable activity times reward config error!!!! ")},i.prototype.isFreePlay=function(){return this.getNextFreeTime()-td.TimeUtil.getTime()<=0},i.prototype.hasTimesRewardCanReceive=function(){if(!this._timesRewardList||0===this._timesRewardList.myLen())return!1;var t=td.RewardStatus.CAN_RECEIVE;for(var e in this._timesRewardList){if(this._timesRewardList[e].getRewardStatus()===t)return!0}return!1},i.prototype.canExchangeTicket=function(){return this.getCanExchangeTicket()>0},i.prototype.setFirstLogin=function(){td.GlobalFunction.setLocalSaveStatus("ActivityTurntable","true"),td.EventUtil.dispatchEvent(td.EventNameEnum.ON_ACTIVITY_TURNTABLE_SHOWN)},i.prototype.hasRedPoint=function(){return!0},i.prototype.redPointTip=function(){return!!this.isFreePlay()||(!!this.hasTimesRewardCanReceive()||(!!this.canExchangeTicket()||!td.GlobalFunction.getLocalSaveStatus("ActivityTurntable")))},i.prototype.redPointEvts=function(){return[td.EventNameEnum.ON_ACTIVITY_TURNTABLE_SHOWN,td.EventNameEnum.ACTIVITY_TURN_TABLE_INFO_CHANGED]},i.prototype.isRedPointTip=function(){return this.redPointTip()},i}(t("ActivityBaseController"));e.exports=c,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",LuckyModel:"LuckyModel",TurntableRewardModel:"TurntableRewardModel"}],TurntableExchangeItem:[function(t,e,i){"use strict";cc._RF.push(e,"0f282Nf9VNNDoAQB5y5E/RY","TurntableExchangeItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("ListItem"),o=t("CommonIconWidget"),s=t("CommonEnum"),l=(t("ShopItemModel"),cc._decorator),c=l.ccclass,u=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgCost=null,e.labCost=null,e.imgHot=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=td.RewardManager.parseRewardListDetail(i.rewards)[0],a=this.node.getChildByName("icon");a?a.getComponent(o).setData(n):((a=td.GlobalFunction.createCommonIconWidget(27,n)).name="icon",a.parent=this.node,a.position=cc.v2(-67,13),a.getComponent(o).setNameBgVisible(!1));var r=td.RewardManager.parseRewardListDetail(i.costs)[0];td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,r.getLittleIconResPath(),this.imgCost),this.labCost.string=r.getCount(),this.imgHot.active=!!i.isHot,this.imgHot.zIndex=99},e.prototype.calcNeedPayByItemNum=function(t,e){return t*td.RewardManager.parseRewardListDetail(this._item.costs)[0].getCount()},e.prototype.requestExchangeProduct=function(t){if(this._item&&t){var e={};e.id=this._item.id,e.count=t.num,td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_TURN_TABLE_EXCHANGE,e)}},e.prototype.onBtnBuy=function(){if(this._item){var t=td.RewardManager.parseRewardListDetail(this._item.costs)[0],e=this._item.rewards[0],i={getRewards:function(){return e},getMoneyId:function(){return t.getId()}},n=td.ItemManager.getItemNumById(t.getId());i.maxNum=Math.floor(n/t.getCount());var a={};a.opType=s.OperateItemType.ExchangeType,a.sureFunc=this.requestExchangeProduct.bind(this),a.itemData=i,a.calcFunc=this.calcNeedPayByItemNum.bind(this),a.showTimesLimit=!1,td.GlobalFunction.showUseOrExchangeWindow(a)}},a([u(cc.Node)],e.prototype,"imgCost",void 0),a([u(cc.Label)],e.prototype,"labCost",void 0),a([u(cc.Node)],e.prototype,"imgHot",void 0),e=a([c],e)}(r);i.default=d,cc._RF.pop()},{CommonEnum:void 0,CommonIconWidget:"CommonIconWidget",ListItem:void 0,ShopItemModel:"ShopItemModel"}],TurntableExchangeWindow:[function(t,e,i){"use strict";cc._RF.push(e,"22ed6Pz+m9Hr7wshoTZyaBK","TurntableExchangeWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("TabController"),h=t("OptimizeVerticalListView"),p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgCurrency=null,e.labCurrency=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_TurntableExchange},e.prototype.onLoad=function(){if(this._listViewCtrl=this.node.getComponent(h),!this._tabController){var t=r.ActivityEnum.ActivityTurntableShopType,e=this.node.getChildByName("root"),i=e.getChildByName("btnTab_1"),n=e.getChildByName("btnTab_2");i._tag=t.Super,n._tag=t.Normal,this._tabController=new d,this._tabController.init([i,n],this)}},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListener=function(){var t=r.EventUtil,e=r.EventNameEnum;t.registerEvent(e.ON_TURN_TABLE_BUY_SUCCESS,this._refreshCurrency,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._activityId=e,this._tabController.showTab(r.ActivityEnum.ActivityTurntableShopType.Super)},e.prototype.showTab=function(t){var e=r.ActivityDataManager.getActivityControllerById(this._activityId);if(e&&this._selectTab!==t){this._selectTab=t,this._refreshCurrency();var i=e.getBuyConfigsByType(t);this._listViewCtrl.setData(i)}},e.prototype._refreshCurrency=function(){var t;this._selectTab===r.ActivityEnum.ActivityTurntableShopType.Normal?t=r.ItemEnum.TurntableCurrency_1:this._selectTab===r.ActivityEnum.ActivityTurntableShopType.Super&&(t=r.ItemEnum.TurntableCurrency_2);var e=r.GetTableClass(r.TableEnum.Item).getItemById(t);r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,e.liIconRes,this.imgCurrency),this.labCurrency.string=r.ItemManager.getItemNumById(t)},a([l(cc.Node)],e.prototype,"imgCurrency",void 0),a([l(cc.Label)],e.prototype,"labCurrency",void 0),e=a([s,c("module/Activity/TurntableExchangeWindow")],e)}(u);i.default=p,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0,TabController:void 0}],TurntableHome:[function(t,e,i){"use strict";cc._RF.push(e,"458201dhQlFpLkMAaPpmwVo","TurntableHome");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("../../../../Common/Chat/Enum/ChatEnum"),o=t("ActivityBasePanel"),s=t("CommonIconWidget"),l=cc._decorator,c=l.ccclass,u=l.property,d=l.menu,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.imgRotor=null,e.layerReward=null,e.btnPreview=null,e.labTime=null,e.turntablePanel=null,e.imgBG=null,e.labFreeTime=null,e.costPanel_1=null,e.costPanel_2=null,e.nodeTicket=null,e.nodeScore1=null,e.nodeScore2=null,e.layerMsg=null,e.btnOneTimes=null,e.btnReward=null,e.btnTask=null,e._isAnimateEnd=!0,e._isDoingAction=!1,e._playTimes=0,e}return n(e,t),e.prototype.initData=function(e){t.prototype.initData.call(this,e)},e.prototype.onLoad=function(){this.imgRotor.zIndex=10,this.imgRotor.active=!1,this._initPosList()},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListeners(),this._controller.setFirstLogin(),this._setActivityTime(),this._refreshInfo(),this._refreshShowReward(),gdk.Timer.callLater(this,this._refreshLuckyMsg),this._controller.isFromRecharge()&&this.onBtnTask();var e=this._controller.getActivityData(),i=td.GetTableClass(td.TableEnum.ActivityTurnTableConfig).getActivityTurnTableConfigById(e),n="";i&&i.length>0&&(n=i[0].bgPic),td.GlobalFunction.createSprite("Activity_bg/"+n,this.imgBG)},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),this._isAnimateEnd=!0,this._isDoingAction=!1,this._playTimes=0,td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_UPDATE_MAIN_LAYER_DIAMOND),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_CHAT_DELAY,r.ChatLocation.CENTER),td.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListeners=function(){var t={},e=td.EventNameEnum;t[e.ACTIVITY_TURNTABLE_ON_PLAY]=this._onPlaySuccess,t[e.ACTIVITY_TURN_TABLE_INFO_CHANGED]=this._refreshInfo,td.EventUtil.registerEvents(t,this)},e.prototype._setBtnRedPoint=function(){td.RedPointUtil.createRedPointOld(this.btnReward,cc.v2(-10,-10),this._controller.hasTimesRewardCanReceive.bind(this._controller),this._controller.redPointEvts()),td.RedPointUtil.createRedPointOld(this.btnTask,cc.v2(-10,-10),this._controller.canExchangeTicket.bind(this._controller),this._controller.redPointEvts())},e.prototype._setActivityTime=function(){var t=this,e=this._controller.getCurrentOpenStage();if(e&&this.checkIsOpen(!0)){var i=e.closeTime-td.TimeUtil.getTime();i>0?td.GlobalFunction.addTimeLabel2(this.labTime.node,i,function(){t.labTime.string=td.Language.ActivityOver},td.Language.timeCountPattern3):this.labTime.string=td.Language.ActivityOver}},e.prototype._refreshInfo=function(){this._refreshView(!1),this._setBtnRedPoint()},e.prototype._refreshView=function(t){this.imgRotor.active=!0,this.imgRotor.zIndex=99;for(var e=this.turntablePanel,i=this._controller.getRewardList(),n=td.GlobalFunction,a=0,r=i.length;a<r;a++){var o=i[a],s=o.getSortRank(),l=o.getRewardItem(),c=e.getChildByName("icon_"+s);if(c){var u=c.getComponent("CommonIconWidget");u.setType(26),u.setData(l)}else(c=n.createCommonIconWidget(26,l)).setPosition(this._posList[s-1]),c.scale=.9,c.name="icon_"+s,e.addChild(c,1);var d=o.getRewardQuality(),h=c.getChildByName("imgQualityFlag");if(0!==d){h||((h=new cc.Node).addComponent(cc.Sprite),h.x=-27,h.y=20,h.name="imgQualityFlag",c.addChild(h,80)),h.active=!0;var p="";1===d?p="GY0_bq_xiyou":2===d?p="GY0_bq_hanjian":3===d&&(p="GY0_bq_zhenxi"),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,p,h);var _=c.getChildByName("animation");d>0?this._addIconAnimation(c):_&&(_.active=!1)}else h&&(h.active=!1)}this._refreshCostInfo(),this._isAnimateEnd&&this._refreshCurrencyNum()},e.prototype._addIconAnimation=function(t){var e=t.getChildByName("animation");e.active=!0;var i=e.getChildByName("IconAnimation");if(i){var n=i.getComponent(cc.Animation);n.play(n.defaultClip.name)}else{var a=td.GlobalFunction.getResIdByNode(e);gdk.rm.loadRes(a,"uiAnima/ShangYe_UI/ShangYe_UI",cc.Prefab,this._playIconAnimation.bind(this,e))}},e.prototype._playIconAnimation=function(t){if(cc.isValid(this.node)&&!t.getChildByName("IconAnimation")){var e=gdk.rm.getResByUrl("uiAnima/ShangYe_UI/ShangYe_UI",cc.Prefab),i=cc.instantiate(e);i.name="IconAnimation",t.addChild(i)}},e.prototype._refreshCostInfo=function(){var t=this,e=this._controller.getNextFreeTime()-td.TimeUtil.getTime(),i=this._controller.getCostPerTime();if(i){var n=this._controller.getOtherCostPerTime();if(n){var a=td.ItemManager.getItemNumById(i.getId()),r=td.ItemManager.getItemNumById(n.getId()),o=i.getLittleIconResPath(),s=i.getCount(),l=n.getCount();if(this._isFree=e<=0,td.RedPointUtil.createRedPointSimple(this.btnOneTimes,cc.v2(-10,-10),this._isFree),this._isFree)this.costPanel_1.active=!1,this.labFreeTime.y=-20,this.labFreeTime.getComponent(cc.Label).string=td.Language.freeTips;else{var c=this.costPanel_1.getChildByName("imgTicket"),u=this.costPanel_1.getChildByName("labNeedTicket");td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,o,c),u.getComponent(cc.Label).string=s,u.color=a>=s?cc.color(250,253,7):cc.color(255,0,0);var d=this.costPanel_1.getChildByName("imgCurrency"),h=this.costPanel_1.getChildByName("labNeed");td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,n.getLittleIconResPath(),d),h.getComponent(cc.Label).string=l,h.color=r>=l?cc.color(250,253,7):cc.color(255,0,0),this.costPanel_1.active=!0,this.labFreeTime.y=-65,td.GlobalFunction.addTimeLabel2(this.labFreeTime,e,function(){gdk.Timer.callLater(t,t._refreshCostInfo)},td.Language.freePattern)}this.costPanel_2.active=!1}}},e.prototype._refreshCurrencyNum=function(){var t=this.nodeTicket.getChildByName("labNum");t.getComponent(cc.Label).string=td.ItemManager.getItemNumById(td.ItemEnum.TurntableTicket),(t=this.nodeScore1.getChildByName("labNum")).getComponent(cc.Label).string=td.ItemManager.getItemNumById(td.ItemEnum.TurntableCurrency_1),(t=this.nodeScore2.getChildByName("labNum")).getComponent(cc.Label).string=td.ItemManager.getItemNumById(td.ItemEnum.TurntableCurrency_2)},e.prototype._refreshShowReward=function(){for(var t=this._controller.getShowRewards(),e=0,i=t.length;e<i;e++){var n=t[e];(a=this.layerReward.getChildByName("icon_"+e))?a.getComponent(s).setData(n):((a=td.GlobalFunction.createCommonIconWidget(26,n)).name="icon_"+e,a.scale=.75,a.parent=this.layerReward)}for(;;e++){var a;if(!(a=this.layerReward.getChildByName("icon_"+e)))break;a.removeFromParent(!0)}var r=this._controller.getPreviewReward();this.btnPreview.active=!!r},e.prototype.onRotateTurntable=function(t,e){var i=parseInt(e);if(!(this.imgRotor.getNumberOfRunningActions()>0))if(this._isFree&&1===i)this._tryToPlay(i);else{var n=td.GamerResourceUtil.TipType.Tip,a=this._controller.getCostPerTime(),r=this._controller.getOtherCostPerTime();td.GamerResourceUtil.checkResource(a.getId(),a.getCount()*i,n)&&td.GamerResourceUtil.checkResource(r.getId(),r.getCount()*i,n)&&this._tryToPlay(i)}},e.prototype.onQuickExtract=function(){if(!(this.imgRotor.getNumberOfRunningActions()>0)){var t=td.GamerResourceUtil.TipType.Tip,e=this._controller.getCostPerTime(),i=this._controller.getOtherCostPerTime();if(td.GamerResourceUtil.checkResource(e.getId(),e.getCount(),t)&&td.GamerResourceUtil.checkResource(i.getId(),i.getCount(),t)){e=this._controller.getCostPerTime();var n=this._controller.getOtherCostPerTime(),a=td.ItemManager.getItemNumById(e.getId()),r=td.ItemManager.getItemNumById(n.getId()),o=e.getCount(),s=n.getCount(),l=Math.min(Math.floor(a/o),Math.floor(r/s)),c={};c.okCallFunc=this._tryToPlay.bind(this),c.buyCost1=e,c.buyCost2=n,c.maxNum=l,td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_TurnTableQuickExact,c)}}},e.prototype._tryToPlay=function(t){td.EventUtil.dispatchEvent(td.EventNameEnum.RESUME_UPDATE_MAIN_LAYER_DIAMOND),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_CHAT_DELAY,r.ChatLocation.CENTER),td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_ACTIVITY_TURNTABLE_PLAY,t),this._playTimes=t},e.prototype._onPlaySuccess=function(t){if(this._playTimes>1)td.EventUtil.dispatchEvent(td.EventNameEnum.SET_TOP_MSG_VISIBLE,!0),this._refreshView(!1),td.GlobalFunction.showRewards(t),this._isAnimateEnd=!0;else{this._isAnimateEnd=!1,this._playRewards=t,this._refreshView(!0);var e=this._controller.getLastPlayPos(t[0])-1;this._showPlayToPos(e)}this._setBtnRedPoint()},e.prototype._showPlayToPos=function(t){this.imgRotor.stopAllActions();var e=new cc.MoveArround(6,this._posList,t,2).easing(cc.easeSineOut()),i=cc.callFunc(this._showPlayRewards.bind(this)),n=cc.sequence(e,cc.delayTime(.2),i);this.imgRotor.runAction(n)},e.prototype._showPlayRewards=function(){this._playRewards&&(this._refreshCurrencyNum(),td.GlobalFunction.showRewards(this._playRewards),td.EventUtil.dispatchEvent(td.EventNameEnum.SET_TOP_MSG_VISIBLE,!0),this._playRewards=null),this._isAnimateEnd=!0},e.prototype._refreshLuckyMsg=function(){var t=this;if(!this._isDoingAction)for(var e=this._controller.getLuckyMsgList(),i=e.length,n=i>2,a=this.layerMsg.children,r=-3,o=0,s=function(a,l,c){l?(a.active=!0,c&&t._setRichText(a,l),n&&(a.runAction(cc.sequence(cc.moveBy(1.5,cc.v2(0,a.height+3)),cc.callFunc(function(){var t=!1;a.y>0&&(a.y=r-a.height/2,l=e[o],++o>=i&&(o=0),t=!0),s(a,l,t)}))),t._isDoingAction=!0)):a.active=!1},l=0,c=a.length;l<c;l++){var u=a[l];u.stopAllActions(),u.y=r-u.height/2,l!==c-1&&(r-=u.height+3);var d=e[o];++o>=i&&(o=0),s(u,d,!0)}},e.prototype._setRichText=function(t,e){var i=t.getComponent(td.UFRichText),n=e.msg,a={fontSize:22,quality:e.quality};i.init(n,a),i.setLeftCenter()},e.prototype._initPosList=function(){this._posList=[];this._posList[0]=cc.v2(78,417.5);for(var t=null,e=1;e<=5;e++)t=cc.v2(this._posList[0].x+112*e,this._posList[0].y),this._posList[e]=t;for(e=6;e<=8;e++)t=cc.v2(this._posList[5].x,this._posList[5].y-115*(e-5)),this._posList[e]=t;for(e=9;e<=13;e++)t=cc.v2(this._posList[8].x-112*(e-8),this._posList[8].y),this._posList[e]=t;for(e=14;e<=15;e++)t=cc.v2(this._posList[13].x,this._posList[13].y+115*(e-13)),this._posList[e]=t},e.prototype.onBtnExchange=function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_TurntableExchange,this.getActivityId())},e.prototype.onBtnReward=function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_TurntableReward,this.getActivityId())},e.prototype.onBtnTask=function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_TurntableTask,this.getActivityId())},e.prototype.onBtnPreview=function(){var t=this._controller.getPreviewReward();t&&td.ItemUtil.showItemInfo(t,!1)},e.prototype.onReceiveOperation=function(){},a([u(cc.Node)],e.prototype,"imgRotor",void 0),a([u(cc.Node)],e.prototype,"layerReward",void 0),a([u(cc.Node)],e.prototype,"btnPreview",void 0),a([u(cc.Label)],e.prototype,"labTime",void 0),a([u(cc.Node)],e.prototype,"turntablePanel",void 0),a([u(cc.Node)],e.prototype,"imgBG",void 0),a([u(cc.Node)],e.prototype,"labFreeTime",void 0),a([u(cc.Node)],e.prototype,"costPanel_1",void 0),a([u(cc.Node)],e.prototype,"costPanel_2",void 0),a([u(cc.Node)],e.prototype,"nodeTicket",void 0),a([u(cc.Node)],e.prototype,"nodeScore1",void 0),a([u(cc.Node)],e.prototype,"nodeScore2",void 0),a([u(cc.Node)],e.prototype,"layerMsg",void 0),a([u(cc.Node)],e.prototype,"btnOneTimes",void 0),a([u(cc.Node)],e.prototype,"btnReward",void 0),a([u(cc.Node)],e.prototype,"btnTask",void 0),e=a([c,d("module/Activity/TurntableHome")],e)}(o);i.default=h,cc._RF.pop()},{"../../../../Common/Chat/Enum/ChatEnum":void 0,ActivityBasePanel:"ActivityBasePanel",CommonIconWidget:"CommonIconWidget"}],TurntableRewardItem:[function(t,e,i){"use strict";cc._RF.push(e,"1ab25xrDK5AwJejWpc3DEO1","TurntableRewardItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("ListItem"),o=t("CommonIconWidget"),s=cc._decorator,l=s.ccclass,c=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.icon=null,e.labName=null,e.labItemName=null,e.btnGet=null,e.imgUnfinish=null,e.imgGot=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i);var n=i.getRewards()[0]||null;if(n){var a=this.icon.getChildByName("icon");a?a.getComponent(o).setData(n):((a=td.GlobalFunction.createCommonIconWidget(26,n)).name="icon",a.parent=this.icon)}this.labName.string=cc.js.formatStr(td.Language.turntableCountTitle,i.getTimes()),this.labItemName.string=n.getName(),td.GlobalFunction.setNameColors(this.labItemName.node,n.getQuality());var r=i.getRewardStatus();this.btnGet.active=r===td.RewardStatus.CAN_RECEIVE,this.imgUnfinish.active=r===td.RewardStatus.CANNOT_RECEIVE,this.imgGot.active=r===td.RewardStatus.RECEIVED},e.prototype.onBtnReceive=function(){this._item&&(this._item.getRewardStatus()===td.RewardStatus.CAN_RECEIVE&&td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_TURN_TABLE_TIMES_REWARD,this._item.getTimes()))},a([c(cc.Node)],e.prototype,"icon",void 0),a([c(cc.Label)],e.prototype,"labName",void 0),a([c(cc.Label)],e.prototype,"labItemName",void 0),a([c(cc.Node)],e.prototype,"btnGet",void 0),a([c(cc.Node)],e.prototype,"imgUnfinish",void 0),a([c(cc.Node)],e.prototype,"imgGot",void 0),e=a([l],e)}(r);i.default=u,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],TurntableRewardModel:[function(t,e,i){"use strict";cc._RF.push(e,"f3279aToshMvLJf6aue7Efl","TurntableRewardModel");var n=window.td,a=function(){function t(){this._times=0}return t.prototype.init=function(t){t&&(this._rewards=n.RewardManager.parseRewardListDetail(t.rewards),this._times=t.times||0,this._rewardStatus=n.RewardStatus.CANNOT_RECEIVE)},t.prototype.getRewards=function(){return this._rewards},t.prototype.getTimes=function(){return this._times},t.prototype.setRewardStatus=function(t){this._rewardStatus=t},t.prototype.getRewardStatus=function(){return this._rewardStatus},t}();e.exports=a,cc._RF.pop()},{}],TurntableRewardWindow:[function(t,e,i){"use strict";cc._RF.push(e,"9adcbM41RFKJKdzBL5y9Bv+","TurntableRewardWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=t("PanelBase"),d=t("OptimizeVerticalListView"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labCount=null,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_TurntableReward},e.prototype.onLoad=function(){this._listViewCtrl=this.node.getComponent(d)},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),this._activityId=0,r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListener=function(){var t=r.EventUtil,e=r.EventNameEnum;t.registerEvent(e.ACTIVITY_TURN_TABLE_INFO_CHANGED,this._refreshRewardList,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._activityId=e,this._refreshRewardList(!0)},e.prototype._refreshRewardList=function(t){var e=r.ActivityDataManager.getActivityControllerById(this._activityId);if(e){this.labCount.string=cc.js.formatStr(r.Language.curTurntableCount,e.getPlayTimes());var i=e.getTimesRewards();t?this._listViewCtrl.setData(i):this._listViewCtrl.refreshCurList(i)}},a([l(cc.Label)],e.prototype,"labCount",void 0),e=a([s,c("module/Activity/TurntableRewardWindow")],e)}(u);i.default=h,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],TurntableTaskItem:[function(t,e,i){"use strict";cc._RF.push(e,"d86a8qFxyBCqYpgQwl2WAs/","TurntableTaskItem");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=t("ListItem"),o=(t("CommonIconWidget"),cc._decorator),s=o.ccclass,l=o.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numBg=null,e.labNum=null,e.labDesc=null,e.labTicketNum=null,e.btnGet=null,e.imgGot=null,e.btnGoto=null,e}return n(e,t),e.prototype.updateItem=function(e,i){if(t.prototype.updateItem.call(this,e,i),i.isRecharge){this.labDesc.string=i.desc;var n=i.value,a=n>0;this.numBg.active=a,this.labNum.node.active=a,this.btnGet.active=a,this.btnGoto.active=!a,a&&(this.labNum.string="x"+n),this.labTicketNum.string=cc.js.formatStr(td.Language.haveTicketCount,n)}},e.prototype.onBtnReceive=function(){td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_TURN_TABLE_TASK)},e.prototype.onBtnGoto=function(){if(this._item.isRecharge){var t=td.PanelManager.getInstance().getCurShowWindow();if(t){var e=t.getComponent("PanelBase");e&&e.closeCallFunc()}td.EventUtil.dispatchEvent(td.EventNameEnum.ON_TURN_TABLE_JUMP_TO_RECHARGE),td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityConfig,td.ActivityEnum.ActivityType.ACTIVITY_TYPE_14])}},a([l(cc.Node)],e.prototype,"numBg",void 0),a([l(cc.Label)],e.prototype,"labNum",void 0),a([l(cc.Label)],e.prototype,"labDesc",void 0),a([l(cc.Label)],e.prototype,"labTicketNum",void 0),a([l(cc.Node)],e.prototype,"btnGet",void 0),a([l(cc.Node)],e.prototype,"imgGot",void 0),a([l(cc.Node)],e.prototype,"btnGoto",void 0),e=a([s],e)}(r);i.default=c,cc._RF.pop()},{CommonIconWidget:"CommonIconWidget",ListItem:void 0}],TurntableTaskWindow:[function(t,e,i){"use strict";cc._RF.push(e,"2c6caQyMGxN97qCEjiqJrFC","TurntableTaskWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=(o.property,o.menu),c=t("PanelBase"),u=t("OptimizeVerticalListView"),d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_TurntableTask},e.prototype.onLoad=function(){this._listViewCtrl=this.node.getComponent(u)},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener()},e.prototype.onDisable=function(){t.prototype.onDisable.call(this),r.EventUtil.unregisterAllEvents(this)},e.prototype._addEventListener=function(){var t=r.EventUtil,e=r.EventNameEnum;t.registerEvent(e.ACTIVITY_TURN_TABLE_INFO_CHANGED,this._refreshTaskList,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._activityId=e,this._refreshTaskList(!0)},e.prototype._refreshTaskList=function(t){var e=r.ActivityDataManager.getActivityControllerById(this._activityId);if(e){var i=e.getTaskList();t?this._listViewCtrl.setData(i):this._listViewCtrl.refreshCurList(i)}},e=a([s,l("module/Activity/TurntableTaskWindow")],e)}(c);i.default=d,cc._RF.pop()},{OptimizeVerticalListView:void 0,PanelBase:void 0}],UISkillLightLayer:[function(t,e,i){"use strict";cc._RF.push(e,"d031d8YdVpMG4AOeZYtokKY","UISkillLightLayer");var n=t("PveFightManager"),a=t("PveNodePoolManager"),r=t("PveUiManager"),o=t("LightSkill"),s=cc.Class({extends:cc.Component,properties:{_skillAniNode:null,_skillDataModel:null,_guideFinger:null,_isInGuide:null,_fingerPos:null,_animationContinueTime:null,_curSpeedMult:null,_tickCount:0,_fingerTickCount:0,_isStartTick:!1,_timeAniNode:null},setData:function(t){this._skillDataModel=t,this._tickInterval=td.GetConfig("PVE_LIGHT_SKILL_HURT_INTERVAL")/1e3*60,this._clickGuideInterval=5,this._initSkillAniNode(),this._isStartTick=!1},onLoad:function(){this._isInGuide=!1,this._fingerPos=[cc.v2(200,1120),cc.v2(180,750),cc.v2(500,740)]},onEnable:function(){this._initSkillAniNode(),this._addNodeListener(),this._addEventListner(),this._totalTickCount=0,this.schedule(this._updateTocalTick,1)},onDisable:function(){this._removeNodeListener(),td.EventUtil.unregisterAllEvents(this),this.unschedule(this.updateContinueTime),this.unschedule(this._updateTocalTick),this._skillAniNode&&this._skillAniNode.removeFromParent(!1),a.putSkillInPoolWithId(td.PveEnum.PVE_UI_SKILL_ID.Light,this._skillAniNode)},onDestroy:function(){this._skillAniNode&&this._skillAniNode.removeFromParent(!0),this._skillAniNode=null,this._guideFinger&&this._guideFinger.removeFromParent(!0),this._guideFinger=!0,this._timeAniNode&&this._timeAniNode.removeFromParent(!0),this._timeAniNode=null},_addEventListner:function(){td.EventUtil.registerEvent(td.EventNameEnum.PVE_LIGHT_SKILL_PLAY_END,this._removeGuideFindger,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_CHANGE_FIGHT_SPEED,this._onChangeTimeAniSpeed,this)},_addNodeListener:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegin,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},_removeNodeListener:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchBegin,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},_updateTocalTick:function(t){this._fingerTickCount++,this._curSpeedMult=n.getCurFightSpeedMult(),this._isInGuide||this._isStartTick||this._fingerTickCount%Math.ceil(this._clickGuideInterval/this._curSpeedMult)!=0||this._addGuideFinger()},setInGuide:function(){this._isInGuide=!0,this._addGuideFinger()},startTick:function(){this._animationContinueTime=this._skillDataModel.getContinueTime(),this._curSpeedMult=n.getCurFightSpeedMult(),this._tickCount=0,this._animationContinueTime>0&&this.schedule(this.updateContinueTime,1/60)},updateContinueTime:function(t){this._animationContinueTime-=t*this._curSpeedMult;var e=cc.isValid(this._skillAniNode)?this._skillAniNode.getComponent(o):null;this._animationContinueTime>0?(this._tickCount++,this._tickCount%Math.ceil(this._tickInterval/this._curSpeedMult)==0&&e&&e.calcHurt()):(this.unschedule(this.updateContinueTime),td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_LIGHT_SKILL_PLAY_END),e&&e.removeSelf(),this._isStartTick=!1)},_initSkillAniNode:function(){if(this._skillDataModel){this._skillAniNode=a.getSkillInPoolById(td.PveEnum.PVE_UI_SKILL_ID.Light);var t=null;if(cc.isValid(this._skillAniNode))t=this._skillAniNode.getComponent(o);else{var e=this._skillDataModel.getSkillPrefab();if(this._skillAniNode=cc.instantiate(e),!cc.isValid(this._skillAniNode))return;t=this._skillAniNode.addComponent(o)}var i={skillDataModel:this._skillDataModel};t.initData(i)}},onTouchBegin:function(t){t.target;var e=t.touch.getLocation(),i=this._skillAniNode;if(cc.isValid(this._skillAniNode)){this._isInGuide&&td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_RESUME_PVE_FIGHT),this._isStartTick||(this._isStartTick=!0,td.EventUtil.dispatchEvent(td.EventNameEnum.PVE_LIGHT_SKILL_PLAY_START),this.startTick(),r.setSelectedSkill(0),r.setUiSkillReleaseStatus(this._skillId,!0),this._playTimeAni(),this._isInGuide||this._removeGuideFindger()),i.parent||this.node.addChild(i),i.active=!0;var n=i.getComponent(cc.Animation);n.play(n.defaultClip.name),e=this.node.convertToNodeSpaceAR(e),i.setPosition(e)}},onTouchMove:function(t){var e=t.touch.getLocation();cc.isValid(this._skillAniNode)&&(e=this.node.convertToNodeSpaceAR(e),this._skillAniNode.setPosition(e))},onTouchEnd:function(t){cc.isValid(this.node)&&cc.isValid(this._skillAniNode)&&this._skillAniNode&&(this._skillAniNode.active=!1)},_playTimeAni:function(){if(!this._timeAniNode){var t=gdk.rm.getResByUrl(td.resDef.DaoJiShi_Prefab,cc.Prefab);this._timeAniNode=cc.instantiate(t),this._timeAniNode.parent=this.node,this._timeAniNode.position=cc.v2(this.node.width/2,this.node.height/2)}var e=this._timeAniNode.getComponent(cc.Animation),i=e.getClips()[0].name;this._onChangeTimeAniSpeed(),e.play(i)},_onChangeTimeAniSpeed:function(){if(this._curSpeedMult=n.getCurFightSpeedMult(),this._timeAniNode){var t=this._timeAniNode.getComponent(cc.Animation);if(t){var e=t.getClips();t.getAnimationState(e[0].name).speed=this._curSpeedMult}}},_addGuideFinger:function(){if(this._guideFinger)this._playGuideFingerAction();else{var t=td.GlobalFunction.getResIdByNode(this.node);gdk.rm.loadRes(t,"uiAnima/Finger/Finger",cc.Prefab,this._playGuideFindger.bind(this))}},_playGuideFindger:function(){if(cc.isValid(this.node)&&!this.node.getChildByName("GuideFindger")){var t=gdk.rm.getResByUrl("uiAnima/Finger/Finger",cc.Prefab),e=cc.instantiate(t);e.name="GuideFindger",this._guideFinger=e,this.node.addChild(e,1),this._playGuideFingerAction()}},_playGuideFingerAction:function(){this._isInGuide?(this._guideFinger.position=this._fingerPos[0],this._doFingerMoveAction()):(this._guideFinger.position=cc.v2(this.node.width/2,this.node.height/2),this._doFingerShowAction())},_doFingerMoveAction:function(){this._guideFinger.active=!0,this._guideFinger.runAction(cc.sequence(cc.moveTo(1.5,this._fingerPos[1]),cc.moveTo(1.5,this._fingerPos[2]),cc.moveTo(1.5,this._fingerPos[1]),cc.moveTo(1.5,this._fingerPos[0])).repeatForever())},_doFingerShowAction:function(){var t=this;this._guideFinger.active=!0,this._guideFinger.runAction(cc.sequence(cc.delayTime(2),cc.callFunc(function(){t._removeGuideFindger(),t._fingerTickCount=0})))},_removeGuideFindger:function(){this._isInGuide=!1,this._guideFinger&&(this._guideFinger.stopAllActions(),this._guideFinger.active=!1)}});e.exports=s,cc._RF.pop()},{LightSkill:"LightSkill",PveFightManager:"PveFightManager",PveNodePoolManager:"PveNodePoolManager",PveUiManager:"PveUiManager"}],UISkillLight:[function(t,e,i){"use strict";cc._RF.push(e,"bdaa46g54RGP40d/Dxm0AxE","UISkillLight");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../../../EightDiagrams/Manager/EightDiagramsManager"));var a=t("UiBaseSkill"),r=t("PveSkillModel"),o=t("PveFightManager"),s=t("PveUiManager"),l=t("PveCopyEnum"),c=cc.Class({extends:a,properties:{_effectLayer:null,_boxSkillNode:null,_lightSkillLayer:null,_isInGuide:null,_guideTick:null},onLoad:function(){this._super(),this._addEventListener(),this._skillId=td.PveEnum.PVE_UI_SKILL_ID.Light,this._isInGuide=!1,this._guideTick=td.GetConfig("PVE_SKILL_LIGHT_GUIDE_DELAY");var t=td.TableManager.getTableClass(td.TableEnum.PveSkillTable).getSkillCfgDataById(this._skillId),e=new r;e.init(t),this._skillDataModel=e,this._curCdTime=0,this.node.getChildByName("labCost").getComponent(cc.Label).string=s.getLightSkillCostPower();var i=this.node.parent;i&&!td.GuideManager.isFirstBattle()&&(this._lightSkillLayer=i.getChildByName("lightSkillLayer"),this._lightSkillLayer.getComponent("UISkillLightLayer").setData(this._skillDataModel),this._lightSkillLayer.active=!1)},onEnable:function(){this.refreshUiSkillStatus({})},onDestroy:function(){this._super(),this._boxSkillNode=null,this._lightSkillLayer&&(this._lightSkillLayer.active=!1),this._lightSkillLayer=null},_addEventListener:function(){this._super(),td.EventUtil.registerEvent(td.EventNameEnum.ON_RESTART_FIGHT,this._playEndClip,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_LIGHT_SKILL_PLAY_END,this._playEndClip,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_FULL_ANGER_POWER,this._setInGuide,this),td.EventUtil.registerEvent(td.EventNameEnum.PVE_LIGHT_SKILL_PLAY_START,this._onLightSkillPlayStart,this)},update:function(t){this._super(t);var e=o.getCurAngerPowerCount(),i=s.getLightSkillCostPower(),a=0===this._curCdTime&&!this._isInGuide;if((e>=i&&!this._bSeletedStatus&&!1===this._bClickEnabled&&a&&this.setClickEnabled(!0),null!==this._guideTick&&(this._guideTick-=t*o.getCurFightSpeedMult(),this._guideTick<=0&&(this._guideTick=null,td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_CUSTOM_COND_CHANGE,td.GuideCustomCond.PveLightSkillGuideBegin))),td.PveCopyManager.getCopyType()===l.PVEFightType.EightDiagrams)&&n.default.getInstance().isSkillTimesUseOut(this._skillId))return this._imgForbidden.active=!0,this._isLimited=!0,void this.setClickEnabled(!1)},_setInGuide:function(){this._isInGuide=!0,this.setClickEnabled(!0)},_onLightSkillPlayStart:function(){this.refreshCdTime(td.PveEnum.PVE_UI_SKILL_ID.Light)},refreshUiSkillStatus:function(t){if(t.skillId===td.PveEnum.PVE_UI_SKILL_ID.Light){var e=1===t.skillStatus;this.setSeletedStatus(e)}o.getCurAngerPowerCount()<s.getLightSkillCostPower()&&this.setClickEnabled(!1)},createSkill:function(){this.setClickEnabled(!1),this._lightSkillLayer.active=!0;var t=this._lightSkillLayer.getComponent("UISkillLightLayer");this._isInGuide&&t.setInGuide();var e=this._boxSkillNode;if(!e){var i=gdk.rm.getResByUrl(td.resDef.LeiTingWanJi_kuang_Prefab,cc.Prefab);if(!(e=cc.instantiate(i)))return;e.name="skillPrefab_kuang",e.position=cc.v2(this._lightSkillLayer.width/2,this._lightSkillLayer.height/2),this._boxSkillNode=e}e.parent||this._lightSkillLayer.addChild(e);var a=e.getComponent(cc.Animation),r=a.getClips()[0].name;a.play(r),a.on("finished",this._playCircleClip,this);var c=-1*s.getLightSkillCostPower();o.onChangeAngerPowerCount(c),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_SKILL_POWER_PROGRESS),td.PveCopyManager.getCopyType()===l.PVEFightType.EightDiagrams&&n.default.getInstance().setSkillUseTimesBySkillId(this._skillId)},_playCircleClip:function(){if(cc.isValid(this.node)){var t=this._boxSkillNode;if(t){var e=t.getComponent(cc.Animation),i=e.getClips()[1].name;e.play(i)}}},_playEndClip:function(){this._isInGuide=!1,this._removeSelf()},_removeSelf:function(){this._boxSkillNode&&this._boxSkillNode.removeFromParent(),this._boxSkillNode=null,this._lightSkillLayer.active=!1}});e.exports=c,cc._RF.pop()},{"../../../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager",PveCopyEnum:void 0,PveFightManager:"PveFightManager",PveSkillModel:"PveSkillModel",PveUiManager:"PveUiManager",UiBaseSkill:"UiBaseSkill"}],UiBaseSkill:[function(t,e,i){"use strict";cc._RF.push(e,"e4dabaje6BOCppyInCNWGHI","UiBaseSkill");var n=t("PveFightManager"),a=t("PveUiManager"),r=cc.Class({extends:cc.Component,properties:{_skillId:null,_curCdTime:null,_bSeletedStatus:null,_bClickEnabled:null,_imgForbidden:null,_imgCdMask:null,_imgMove:null,_skillDataModel:null,_bMoveOut:null,_bPauseStatus:null,_isLimited:null,_clickTimeLimit:null,CLICK_TIME_LIMIT:.5},onLoad:function(){this._bSeletedStatus=!1,this._bClickEnabled=!0,this._imgMove=null,this._bMoveOut=!1,this._bPauseStatus=!1,this._imgForbidden=this.node.getChildByName("imgForbid"),this._imgForbidden.active=!1,this._imgCdMask=this.node.getChildByName("imgMask"),this._imgCdMask.active=!1,this.node.getChildByName("imgMove").active=!1,this._addNodeListener(),this._addEventListener()},onDestroy:function(){this._bSeletedStatus=null,this._bClickEnabled=null,this._imgMove=null,this._imgForbidden=null,this._imgCdMask=null,this._bMoveOut=null,this.unschedule(this.onUpdateCdTime),this._removeNodeListener(),this._removeEventListener()},_addEventListener:function(){td.EventUtil.registerEvent(td.EventNameEnum.CREATE_UI_SKILL,this.onCreateUiSkillEvent,this),td.EventUtil.registerEvent(td.EventNameEnum.REFRESH_UI_SKILL_STATUS,this.refreshUiSkillStatus,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_RESTART_FIGHT,this.resetSkillUiData,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_CHANGE_FIGHT_SPEED,this.onChangeFightSpeed,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_PAUSE,this.onPause,this),td.EventUtil.registerEvent(td.EventNameEnum.ON_PVE_FIGHT_RESUME,this.onResume,this)},_removeEventListener:function(){td.EventUtil.unregisterAllEvents(this)},_addNodeListener:function(){this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},_removeNodeListener:function(){this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},onTouchMove:function(t){if(this._skillId!==td.PveEnum.PVE_UI_SKILL_ID.Light&&a.getUiSkillReleaseStatus(this._skillId)){var e=n.getFightStatus();if(this._bClickEnabled&&e===td.PveEnum.PVE_FIGHT_STATUS.FIHGT&&this._isCostEnough()){var i=t.target,r=t.touch.getLocation(),o=i.getBoundingBox(),s=i.getParent().convertToNodeSpaceAR(r);o.contains(s)||(this._bMoveOut=!0,this.setSkillImagePos(s))}}},_isCostEnough:function(){var t=n.getCurAngerPowerCount(),e=999;return this._skillId===td.PveEnum.PVE_UI_SKILL_ID.IceRain?e=a.getIceRainSkillCostPower():this._skillId===td.PveEnum.PVE_UI_SKILL_ID.Inspire?e=a.getInspireSkillCostPower():this._skillId===td.PveEnum.PVE_UI_SKILL_ID.Light&&(e=a.getLightSkillCostPower()),t>=e},onTouchEnd:function(){if(!(td.GuideManager.isFirstBattle()&&this._clickTimeLimit>0)){if(this._bMoveOut&&this._imgMove)return this._imgMove.destroy(),this._imgMove=null,void(this._bMoveOut=!1);if(this._bSeletedStatus&&this._curCdTime<=0)this.resetSkillUiData();else{var t=n.getFightStatus();this._bClickEnabled&&t===td.PveEnum.PVE_FIGHT_STATUS.FIHGT&&this._isCostEnough()&&(this.setClickEnabled(!1),this.setSeletedStatus(!0),this._skillId===td.PveEnum.PVE_UI_SKILL_ID.Light&&this.createSkill(),this._clickTimeLimit=this.CLICK_TIME_LIMIT)}}},onTouchCancel:function(t){if(this._skillId!==td.PveEnum.PVE_UI_SKILL_ID.Light&&a.getUiSkillReleaseStatus(this._skillId)){var e=n.getFightStatus();if(this._bMoveOut=!1,this._bClickEnabled&&e===td.PveEnum.PVE_FIGHT_STATUS.FIHGT){var i=t.touch.getLocation(),r=t.target.getParent(),o=r.convertToNodeSpaceAR(i);if(!r.getBoundingBox().contains(o)&&this._imgMove)return this._imgMove.destroy(),void(this._imgMove=null);this.createSkill(o)}}},onChangeFightSpeed:function(t){if(!(this._curCdTime<=0)){this.unschedule(this.onUpdateCdTime);var e=1/t;this.schedule(this.onUpdateCdTime,e)}},onPause:function(){this._bPauseStatus=!0},onResume:function(){this._bPauseStatus=!1},resetSkillUiData:function(){this._imgMove=null,this._bMoveOut=!1,this._curCdTime=0,this.setSeletedStatus(!1),this.setClickEnabled(!0),a.setSelectedSkill(0),this.unschedule(this.onUpdateCdTime),this._imgCdMask.active=!1,this._isLimited=!1},onCreateUiSkillEvent:function(t){t.skillId===this._skillId&&(a.setSelectedSkill(0),this._skillId===td.PveEnum.PVE_UI_SKILL_ID.Inspire&&t.tower?this.createSkillWithTouchData(t.tower):this._skillId===td.PveEnum.PVE_UI_SKILL_ID.IceRain&&t.pos?this.createSkillWithTouchData(t.pos):this._skillId===td.PveEnum.PVE_UI_SKILL_ID.IceRain&&t.pos&&this.createSkillWithTouchData(t.pos))},setSeletedStatus:function(t){this._bSeletedStatus=t,this._imgForbidden.active=t,t&&a.setSelectedSkill(this._skillId)},setClickEnabled:function(t){this._bClickEnabled=t;var e=t?0:1;if(td.GlobalFunction.graySprite(this.node,e),t)this._isLimited=!1;else{if(this._isLimited)return;td.EventUtil.dispatchEvent(td.EventNameEnum.ON_HIDE_TIMES_NODE)}},refreshUiSkillStatus:function(t){},refreshCdTime:function(t){if(t===this._skillId){this.setSeletedStatus(!1),this._bMoveOut=!1,this._curCdTime=this._skillDataModel.getCDTime(),this._imgForbidden.active=!1,this._imgCdMask.active=!0;var e=n.getCurFightSpeedMult();this._imgCdMask.getChildByName("labCd").getComponent(cc.Label).string=this._curCdTime,this.schedule(this.onUpdateCdTime,1/e)}},update:function(t){!td.GuideManager.isFirstBattle()||this._clickTimeLimit<=0||(this._clickTimeLimit-=t)},onUpdateCdTime:function(t){if(!this._bPauseStatus){if(this._curCdTime-=1,this._curCdTime<=0)return this._curCdTime=0,this.unschedule(this.onUpdateCdTime),void(this._imgCdMask.active=!1);this._imgCdMask.getChildByName("labCd").getComponent(cc.Label).string=this._curCdTime}},setSkillImagePos:function(t){this.node.getChildByName("imgMove")&&(this._imgMove||(this._imgMove=cc.instantiate(this.node.getChildByName("imgMove")),this._imgMove.active=!0,this._effectLayer.addChild(this._imgMove)),this._imgMove.setPosition(t))},createSkill:function(t){},createSkillWithTouchData:function(t){}});e.exports=r,cc._RF.pop()},{PveFightManager:"PveFightManager",PveUiManager:"PveUiManager"}],UiSkillIceRain:[function(t,e,i){"use strict";cc._RF.push(e,"38b94/WlDxM1K1mnPpD1yVf","UiSkillIceRain");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../../../EightDiagrams/Manager/EightDiagramsManager"));var a=t("UiBaseSkill"),r=(t("CommonEnum"),t("PveSkillModel")),o=t("IceRainSkill"),s=t("PveUiManager"),l=t("PveFightManager"),c=t("PveNodePoolManager"),u=t("PveCopyEnum"),d=cc.Class({extends:a,properties:{_effectLayer:null},onLoad:function(){this._super(),this._skillId=td.PveEnum.PVE_UI_SKILL_ID.IceRain;var t=td.TableManager.getTableClass(td.TableEnum.PveSkillTable).getSkillCfgDataById(this._skillId),e=new r;e.init(t),this._skillDataModel=e,this._curCdTime=0,this.node.getChildByName("labCost").getComponent(cc.Label).string=s.getIceRainSkillCostPower(),this._effectLayer=s.getEffectLayer()},onEnable:function(){this.refreshUiSkillStatus({})},onDestroy:function(){this._super(),this._effectLayer=null},update:function(t){this._super(t);var e=l.getCurAngerPowerCount(),i=s.getIceRainSkillCostPower(),a=0===this._curCdTime;if((e>=i&&!this._bSeletedStatus&&!1===this._bClickEnabled&&a&&this.setClickEnabled(!0),td.PveCopyManager.getCopyType()===u.PVEFightType.EightDiagrams)&&n.default.getInstance().isSkillTimesUseOut(this._skillId))return this._imgForbidden.active=!0,this._isLimited=!0,void this.setClickEnabled(!1)},createSkillWithTouchData:function(t){this.setClickEnabled(!1),this.refreshCdTime(td.PveEnum.PVE_UI_SKILL_ID.IceRain);var e=this._skillDataModel.getSkillPrefab();(function(e){var i=c.getSkillInPoolById(td.PveEnum.PVE_UI_SKILL_ID.IceRain),a=null;if(i)a=i.getComponent(o);else{if(!(i=cc.instantiate(e)))return;a=i.addComponent(o)}var r={skillDataModel:this._skillDataModel};a.initData(r),i.setPosition(t),this._effectLayer.addChild(i),s.setSelectedSkill(0);var d=-1*s.getIceRainSkillCostPower();l.onChangeAngerPowerCount(d),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_SKILL_POWER_PROGRESS),td.PveCopyManager.getCopyType()===u.PVEFightType.EightDiagrams&&n.default.getInstance().setSkillUseTimesBySkillId(this._skillId),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_UI_SKILL_STATUS,{skillId:this._skillId,skillStatus:0}),s.setUiSkillReleaseStatus(this._skillId,!0)}).bind(this)(e)},refreshUiSkillStatus:function(t){if(t.skillId===td.PveEnum.PVE_UI_SKILL_ID.IceRain){var e=1===t.skillStatus;this.setSeletedStatus(e)}l.getCurAngerPowerCount()<s.getIceRainSkillCostPower()&&this.setClickEnabled(!1)},createSkill:function(t){cc.log(cc.js.formatStr("create skill now!!!,x=%s,y=%s",t.x,t.y)),this._imgMove&&(this._imgMove.destroy(),this._imgMove=null),this.createSkillWithTouchData(t)}});e.exports=d,cc._RF.pop()},{"../../../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager",CommonEnum:void 0,IceRainSkill:"IceRainSkill",PveCopyEnum:void 0,PveFightManager:"PveFightManager",PveNodePoolManager:"PveNodePoolManager",PveSkillModel:"PveSkillModel",PveUiManager:"PveUiManager",UiBaseSkill:"UiBaseSkill"}],UiSkillInspire:[function(t,e,i){"use strict";cc._RF.push(e,"234c1ysO/RPlpBBTKFGu4F4","UiSkillInspire");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../../../EightDiagrams/Manager/EightDiagramsManager"));var a=t("UiBaseSkill"),r=(t("CommonEnum"),t("PveFightManager")),o=t("PveUiManager"),s=t("PveCopyEnum"),l=t("PveSkillModel"),c=cc.Class({extends:a,properties:{_effectLayer:null},onLoad:function(){this._super(),this._skillId=td.PveEnum.PVE_UI_SKILL_ID.Inspire;var t=td.TableManager.getTableClass(td.TableEnum.PveSkillTable).getSkillCfgDataById(this._skillId),e=new l;e.init(t),this._skillDataModel=e,this._curCdTime=0,this.node.getChildByName("labCost").getComponent(cc.Label).string=o.getInspireSkillCostPower(),this._effectLayer=o.getEffectLayer()},onEnable:function(){this.refreshUiSkillStatus({})},onDestroy:function(){this._super(),this._effectLayer=null},update:function(t){this._super(t);var e=r.getCurAngerPowerCount(),i=o.getInspireSkillCostPower(),a=0===this._curCdTime;if((e>=i&&!this._bSeletedStatus&&!1===this._bClickEnabled&&a&&this.setClickEnabled(!0),td.PveCopyManager.getCopyType()===s.PVEFightType.EightDiagrams)&&n.default.getInstance().isSkillTimesUseOut(this._skillId))return this._imgForbidden.active=!0,this._isLimited=!0,void this.setClickEnabled(!1)},createSkillWithTouchData:function(t){if(!t)return this.setClickEnabled(!0),void this.setSeletedStatus(!1);this.refreshCdTime(td.PveEnum.PVE_UI_SKILL_ID.Inspire),this.setClickEnabled(!1);var e=Math.floor(t._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Hero_Ratio),i=t.getComponent(td.PveEnum.PVE_HERO_SCRIPT[e]);this.addBuffToTower(i),o.setSelectedSkill(0);var a=-1*o.getInspireSkillCostPower();r.onChangeAngerPowerCount(a),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_SKILL_POWER_PROGRESS),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_UI_SKILL_STATUS,{skillId:this._skillId,skillStatus:0}),o.setUiSkillReleaseStatus(this._skillId,!0),td.PveCopyManager.getCopyType()===s.PVEFightType.EightDiagrams&&n.default.getInstance().setSkillUseTimesBySkillId(this._skillId)},refreshUiSkillStatus:function(t){if(t.skillId===td.PveEnum.PVE_UI_SKILL_ID.Inspire){var e=1===t.skillStatus;this.setSeletedStatus(e)}r.getCurAngerPowerCount()<o.getInspireSkillCostPower()&&this.setClickEnabled(!1)},createSkill:function(t){this._imgMove&&(this._imgMove.destroy(),this._imgMove=null);for(var e=r.getTowerArrayWithoutPet(),i=null,n=0,a=e.length;n<a;n++){var o=e[n];o.getBoundingBox().contains(t)&&(i=o)}i&&this.createSkillWithTouchData(i)},addBuffToTower:function(t){var e=this._skillDataModel.getAttackEffect()[0],i={buffType:e[0],buffData:e[1]/1e4,buffTime:e[2]/1e3,showBuff:!0,buffKey:"uiInspire"};t.addTowerBuff(i);var n=this._skillDataModel.getSoundId();n&&n>0&&td.EventUtil.dispatchEvent(td.EventNameEnum.PLAY_SOUND,n)}});e.exports=c,cc._RF.pop()},{"../../../../../EightDiagrams/Manager/EightDiagramsManager":"EightDiagramsManager",CommonEnum:void 0,PveCopyEnum:void 0,PveFightManager:"PveFightManager",PveSkillModel:"PveSkillModel",PveUiManager:"PveUiManager",UiBaseSkill:"UiBaseSkill"}],UnlockManager:[function(t,e,i){"use strict";cc._RF.push(e,"a5b702blZZOx42Elb7fX/ps","UnlockManager");var n=_(t("../../StarUpRoad/Manager/StarUpRoadManager")),a=_(t("../../Endless/Manager/EndlessManager")),r=_(t("../../DestroyTemple/Manager/DestroyTempleManager")),o=_(t("../../CrossArena/Manager/CrossArenaManager")),s=_(t("../../CrossCup/Manager/CrossCupManager")),l=_(t("../../Legend/Manager/LegendManager")),c=t("../../Endless/Model/EndlessEnum"),u=_(t("../../AncientCorridor/Manager/AncientCorridorManager")),d=_(t("../../Pet/Manager/PetManager")),h=_(t("../../Chess/Manager/ChessManager")),p=_(t("../../EvilGodCopy/Mananger/EvilGodManager"));function _(t){return t&&t.__esModule?t:{default:t}}var g=t("ActorUnlockModel");td.UnlockManager={_unlockConfig:null,_unlockTypeMap:null,init:function(){this.destroyData()},destroyData:function(){this._unlockConfig=null,this._unlockTypeMap=null},_initUnlockConfig:function(){this._unlockConfig={},this._unlockTypeMap={};for(var t=td.GetTableClass(td.TableEnum.ActorUnlock).getUnlockData(),e=0,i=t.length;e<i;e++){var n=t[e],a=new g;a.init(n);var r=a.getId(),o=a.getType(),s=a.getOrderId();this._unlockConfig[r]=a,0!==o&&(this._unlockTypeMap[o]=this._unlockTypeMap[o]||{},this._unlockTypeMap[o][s]=r)}cc.assert("Load ActorUnlockConfig error!!!",this._unlockConfig)},getUnlockIdByTypeAndOrderId:function(t,e){return this._unlockTypeMap&&this._unlockTypeMap[t]&&this._unlockTypeMap[t][e]?this._unlockTypeMap[t][e]:null},getUnlockConfigById:function(t){return this._unlockConfig||this._initUnlockConfig(),this._unlockConfig&&this._unlockConfig[t]?this._unlockConfig[t]:null},getUnlockConfig:function(t,e){this._unlockConfig||this._initUnlockConfig();var i=this.getUnlockIdByTypeAndOrderId(t,e);if(!i)return null;var n=this._unlockConfig;return n&&n[i]?n[i]:null},getTargetUnlockStr:function(t,e,i,n){this._unlockConfig||this._initUnlockConfig();var a=this.getUnlockIdByTypeAndOrderId(t,e);return a?this.getTargetUnlockStrById(a,i,n):""},getTargetUnlockStrById:function(t,e,i){var n="",a=this._unlockConfig[t];if(!a)return cc.warn("getTargetUnlockStr get config error!!!"),n;var r=td.Language,o=this._getUnlockStrList(a);if(o){if(i){var s=this._getLockArray(a);if(0===s.length)return n;n=o[s[0]]||"",n+=cc.js.formatStr(r.lockOpen,"")}else{var l=a.getIsAnd()?r.lockAnd:r.lockOr,c=0;for(var u in o)n+=o[u],c!==o.myLen()-1?n+=l:n+=cc.js.formatStr(r.lockOpen,""),c++}e&&(n+=a.getName())}else n=r.unlockDes;return n},getTargetUnlockConditionById:function(t,e){e=e||td.UnlockConditionType.level,this._unlockConfig||this._initUnlockConfig();var i=this.getUnlockConfigById(t);if(i)for(var n=i.getCondition(),a=0;a<n.length;a++){var r=n[a];if(r.type===e)return r.value}return 0},getTargetUnlockCondition:function(t,e,i){var n=this.getUnlockIdByTypeAndOrderId(t,e);return this.getTargetUnlockConditionById(n,i)},isPanelUnlock:function(t,e){if(t!==td.PanelEnum.Panel_WorldBossPreview){var i=td.PanelUnlockParam[t];if(!i)return!0;var n=i[0],a=i[1];return this.isTargetUnlock(n,a,e)}var r=td.PanelUnlockParam[t][0],o=td.PanelUnlockParam[t][1],s=this.isTargetUnlock(r[0],r[1],!1),l=this.isTargetUnlock(o[0],o[1],!1);return!(!s&&!l)||(s?l?void 0:this.isTargetUnlock(o[0],o[1],e):this.isTargetUnlock(r[0],r[1],e))},isTargetUnlock:function(t,e,i,n){this._unlockConfig||this._initUnlockConfig(),e=e||0;var a=this.getUnlockConfig(t,e);return a?this._isDataUnlock(a,i,n):(cc.warn("isTargetUnlock get config error!!!"),!0)},isTargetUnlockById:function(t,e,i){var n=this.getUnlockConfigById(t);return n?this._isDataUnlock(n,e,i):(cc.warn("isTargetUnlockById get config error!!!"),!0)},_showUnlockTips:function(t,e){var i,n=this._getUnlockStrList(t),a=td.Language,r=[],o="";if(n){i=new td.BroadcastContent(53);var s=t.getIsAnd()?a.lockAnd:a.lockOr;if(0===n.myLen())o=a["lockTitle"+e[0]];else for(var l=0;l<e.length;l++){var c=e[l];c===td.UnlockConditionType.vipLevel&&td.IsCheckServer()||(o+=(a["lockTitle"+c]||"")+(n[c]||""),l!==e.length-1&&(o+=s))}r[r.length]=new td.BroadcastParam(o),r[r.length]=new td.BroadcastParam(t.getName()),i.setMainParam(r)}else i=new td.BroadcastContent(146);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)},_getUnlockStrList:function(t){for(var e={},i=td.Language,n=td.UnlockConditionType,a=t.getCondition(),r=0;r<a.length;r++){var o=a[r],s=o.type,l=i["lockStr"+s],c=o.value;if(s===n.level&&c>td.GetConfig("ACTOR_MAX_LEVEL"))return null;if(s===n.vipLevel&&c>td.GetTableClass(td.TableEnum.VipTable).getMaxVipLevel())return null;if(s===n.immortal)(u=td.GetTableClass(td.TableEnum.ImmortalConfig).getImmortalConfigById(c))&&(c=u.name||"");else if(s===n.STORY){(t=td.PveGeneralCopyManager.getGateModelByGateId(c))&&(c=t.getChapterId()?td.Language.passStroyNum+cc.js.formatStr(td.Language.chapterTitle,t.getChapterId()-1e3):"")}else if(s===n.STAR_UP_ROAD){var u;if(u=td.GetTableClass(td.TableEnum.StarUpRoadTable).getDataById(id)){var d=u.chapterId,h=u.monsterGroupId,p=td.GetTableClass(td.TableEnum.MonsterGroup).getMonsterGroupById(h).groupLeader,_=td.GetTableClass(td.TableEnum.Monster).getMonsterDataById(p),g=td.GetTableClass(td.TableEnum.StarUpRoadChapterTable).getDataById(d);if(g&&_){var f=td.GetTableClass(td.TableEnum.MonsterTypeConfig).getMonsterTypeDataByType(_.type);c=g.name+"-"+f.name}}}else if(s===n.FINISH_TASK){l="%s",c=td.TaskManager.getTaskById(c).getDes()}s!==n.NOT_OPEN&&(e[s]=cc.js.formatStr(l,c))}return e},_isDataUnlock:function(t,e,i){var n=t.getIsAnd(),a=t.getCondition(),r=this._getLockArray(t,i),o=n?0===r.length:r.length<a.length;return e&&!o&&this._showUnlockTips(t,r),o},_getLockArray:function(t,e){var i=td.UnlockConditionType,_=t.getCondition(),g=0,f=0,v=0,m=0,y=0,E=0;if(e)g=e.level,f=e.vip,E=e.storyId||0,v=e.arenaRank||0,m=e.nationLevel||0,y=e.immortalLevel||0,e.maxBattlefieldId||0,e.maxZoneId||0;else{var T=td.Account.getUserData();if(!T)return cc.log("get Account userData error!!!!"),_;g=T.level,f=T.vip,v=T.getArenaMaxRank(),m=T.getNationLevel(),y=T.getImmortalLevel(),E=T.getCurStoryId(),o.default.getInstance().getMaxZoneId(),o.default.getInstance().getMaxBattlefieldId()}for(var C=td.PveGeneralCopyManager.getCurGatePreId(E),R=[],S=0;S<_.length;S++){var I=_[S],A=I.type,b=null;switch(A){case i.level:b=g;break;case i.vipLevel:b=f;break;case i.arenaRank:b=v;break;case i.nationLevel:b=m;break;case i.immortal:b=y;break;case i.ENDLESS:var P=a.default.getInstance().getModelByType(c.EndlessType.NORMAL);b=P&&P.getMaxFloor()||0;break;case i.STORY:b=C;break;case i.STAR_UP_ROAD:var N=n.default.getInstance().getNextCopy();b=N.getCfg().nextId?N.getId()-1:N.getId();break;case i.DESTROY_TEMPLE_MAX_FLOOR:b=r.default.getInstance().getMaxFloor();break;case i.SERVER_OPEN_DAY:b=td.SystemManager.getServerOpenDays();break;case i.ANCIENT_CORRIDOR_MAX_ID:b=u.default.getInstance().getMaxId();break;case i.NOT_OPEN:b=-1;break;case i.CROSS_ARENA_ZONE:b=o.default.getInstance().getMaxZoneId();break;case i.CROSS_ARENA_BATTLEFIELD:b=o.default.getInstance().getMaxBattlefieldId();break;case i.CROSS_ARENA_ZONE_BATTLEFIELD:var M=o.default.getInstance().getMaxZoneId(),L=o.default.getInstance().getMaxBattlefieldId();b=parseInt(M+""+L);break;case i.FINISH_TASK:b=I.value;break;case i.CROSS_CUP_STATE:b=s.default.getInstance().getHighestState();break;case i.LEGEND_DAN:b=l.default.getInstance().getSeasonMaxDan();break;case i.PET_STATION_LEVEL:b=d.default.getInstance().getStationLevel();break;case i.VIP_CARD:b=I.value;break;case i.CHEES_GRADE:b=h.default.getInstance().getGrade();break;case i.EVIL_GOD_CHAPTER:b=p.default.getInstance().getCurChapterId()}var D=!0;if(null!==b)switch(A){case i.arenaRank:case i.CROSS_ARENA_ZONE:case i.CROSS_ARENA_ZONE_BATTLEFIELD:case i.arenaRank:D=b>I.value;break;case i.FINISH_TASK:var B=td.TaskManager.getTaskById(b);D=!!B&&B.getStatus()!==td.TaskStatus.Finish&&B.getStatus()!==td.TaskStatus.Received;break;case i.CROSS_CUP_STATE:case i.LEGEND_DAN:D=b<I.value;break;case i.VIP_CARD:D=!td.Account.getUserData().getVipCard(I.value);break;default:D=b<I.value}D&&(R[R.length]=I.type)}return R}},cc._RF.pop()},{"../../AncientCorridor/Manager/AncientCorridorManager":"AncientCorridorManager","../../Chess/Manager/ChessManager":"ChessManager","../../CrossArena/Manager/CrossArenaManager":"CrossArenaManager","../../CrossCup/Manager/CrossCupManager":"CrossCupManager","../../DestroyTemple/Manager/DestroyTempleManager":"DestroyTempleManager","../../Endless/Manager/EndlessManager":"EndlessManager","../../Endless/Model/EndlessEnum":"EndlessEnum","../../EvilGodCopy/Mananger/EvilGodManager":"EvilGodManager","../../Legend/Manager/LegendManager":"LegendManager","../../Pet/Manager/PetManager":"PetManager","../../StarUpRoad/Manager/StarUpRoadManager":"StarUpRoadManager",ActorUnlockModel:"ActorUnlockModel"}],UpgradeManager:[function(t,e,i){"use strict";cc._RF.push(e,"ed3560XBPtCy5uqwFmziuX1","UpgradeManager");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../Gem/Manager/GemstoneManager"));td.UpgradeManager={_type:null,_upgradeConfig:null,_curData:null,_nextData:null,_showDatas:null,_showSId:null,_selectData:null,_selectSId:null,setUpgradeData:function(t){this._type=t.type,this._curData=t.data,cc.assert(!!this._curData,"setUpgradeData must have data"),this._type===td.UpgradeType.Mercenary?this._upgradeConfig=td.MercenaryManager.getUpgradeConfig():this._type===td.UpgradeType.Gemstone?this._upgradeConfig=n.default.getInstance().getUpgradeConfig():this._type===td.UpgradeType.DragonArtifact&&(this._upgradeConfig=td.DragonArtifactManager.getUpgradeConfig()),this.destroyShowData(),this.destroySelectData()},getUpgradeLevelData:function(t,e){return this._upgradeConfig&&this._upgradeConfig[t]&&this._upgradeConfig[t][e]?this._upgradeConfig[t][e]:null},resetNextData:function(){this._nextData=cc.instantiate(this._curData)},destroyData:function(){this.destroyUpgradeData(),this.destroyShowData(),this.destroySelectData()},destroyUpgradeData:function(){this._type=null,this._upgradeConfig=null,this._curData=null,this._nextData=null},destroyShowData:function(){this._showDatas={},this._showSId={}},destroySelectData:function(){this._selectData={},this._selectSId={}},getType:function(){return this._type},getCurData:function(){return this._curData},getNextData:function(){return this._nextData},getTotalItemNum:function(){var t=this._showSId,e=0;for(var i in t)e+=t[i];return e},getShowSID:function(){return this._showSId},getSelectSID:function(){return this._selectSId},oneKeyGetShowData:function(){var t=this._getAllUpgradeStarItem(!0),e=0,i={};this._showDatas&&(e=this._getShowDatasLen());for(var n=0,a=t.length;n<a&&!(e>=10);n++){var r=t[n];i[r.getSId()]=r,r.getGoodsType()===td.GoodsType.Type_Item?e+=r.getCount():e+=1}return i},getUpgradeStarItem:function(){for(var t=this._getAllUpgradeStarItem(!1),e={},i=0,n=0,a=t.length;n<a&&!(i>=50);n++){var r=t[n];if(r.getGoodsType()===td.GoodsType.Type_Item)for(var o=0,s=r.getCount();o<s&&!(i>=50);o++)e[i++]=r;else e[i++]=r}return e},_getShowDatasLen:function(){return this._showSId.myLen()},_getAllUpgradeStarItem:function(t){var e,i=[],a=td.ItemManager.getItemsData(),r=0;for(var o in this._type===td.UpgradeType.Mercenary?e=td.GoodsSubType.ENERGON:this._type===td.UpgradeType.Gemstone?e=td.GoodsSubType.AMETHYST:this._type===td.UpgradeType.DragonArtifact&&(e=td.GoodsSubType.DRAGON_SPIRIT),a){var s=a[o];if(s.getGoodsSubType()===e&&s.getCount()>0){var l=s.getSId();if(this._isExistInShowDatas(l))continue;i[r++]=s}}var c=td.ItemUtil.isHeroOrEquipCanBeUsedAsMaterial;if(this._type===td.UpgradeType.Gemstone){var u=n.default.getInstance().getGemstoneData();for(var d in u){var h=u[d];this._isExistInShowDatas(h.getSId())||h===this._curData||!c(h)||h.getEvolveLevel()>0||(i[r++]=h)}}return i.sort(td.SortUtil.selectUpgradeLevelListSort.bind(td.SortUtil)),i},_isExistInShowDatas:function(t){var e=!1,i=this._showDatas,n=this._showSId;if(i[t]){var a=i[t];a.getGoodsType()===td.GoodsType.Type_Item?n[t]>=a.getCount()&&(e=!0):e=!0}return e},isFullExp:function(){var t=!1,e=this._nextData;if(!e)return t;var i=this.getUpgradeLevelData(e.getUpgradeKey(),e.getLevel());return 0===i.getNeedExp()&&(t=!0),!this.getUpgradeLevelData(e.getUpgradeKey(),e.getLevel()+1)&&e.getLevelExp()>=i.getNeedExp()&&(t=!0),t},isFullExpWithParma:function(t){var e=!1,i=this.getUpgradeLevelData(t.getUpgradeKey(),t.getLevel());return 0===i.getNeedExp()&&(e=!0),!this.getUpgradeLevelData(t.getUpgradeKey(),t.getLevel()+1)&&t.getLevelExp()>=i.getNeedExp()&&(e=!0),e},isBeyondActorLevel:function(){var t=!1,e=this._curData,i=this._nextData;if(!e||!i)return t;var n=this.getUpgradeLevelData(e.getUpgradeKey(),e.getLevel()),a=this.getUpgradeLevelData(i.getUpgradeKey(),i.getLevel()),r=td.Account.getUserData().level;return(e.getLevel()>=r&&e.getLevelExp()>=n.getNeedExp()||i.getLevel()>=r&&i.getLevelExp()>=a.getNeedExp())&&(t=!0),t},isBeyongActorLevelWithParma:function(t){var e=!1;if(!t)return e;var i=this.getUpgradeLevelData(t.getUpgradeKey(),t.getLevel()),n=td.Account.getUserData().level;return t.getLevel()>=n&&t.getLevelExp()>=i.getNeedExp()&&(e=!0),e},_getData:function(t){var e=this._showDatas;for(var i in e){var n=e[i];if(n.getSId()==t)return n}return null},oneKeyGetSelectSID:function(){var t=this.oneKeyGetShowData(),e=this._showSId,i=!0;for(var n in t){if(!i||10===this.getTotalItemNum())break;var a=t[n],r=1;a.getGoodsType()===td.GoodsType.Type_Item&&(r=a.getCount(),e[n]&&(r=a.getCount()-e[n]));for(var o=1;o<=r&&(i=this.addGoodsCalcNextData(a))&&!(this.getTotalItemNum()>=10);o++);}},operateShowSID:function(t,e){var i=this._showSId,n=this._showDatas,a=t.getSId();e?(i[a]?i[a]+=1:i[a]=1,n[a]=t):(i[a]&&(i[a]-=1),0===i[a]&&(delete i[a],delete n[a]))},addGoodsCalcNextData:function(t){var e=this._nextData;if(!e)return!1;var i=0;i=t.getGoodsType()===td.GoodsType.Type_Item?t.getEffectValue():t.getOfferLevelExp();var n=e.getLevelExp()+i,a=this.getUpgradeLevelData(e.getUpgradeKey(),e.getLevel()),r=this.getUpgradeLevelData(e.getUpgradeKey(),e.getLevel()+1),o=td.Account.getUserData().level;if(a.getLevel()>o&&n>a.getNeedExp())return!1;if(0===a.getNeedExp())return!1;if(!r&&a.getNeedExp()<=e.getLevelExp())return!1;for(var s=e.getLevel(),l=!1;a;){var c=a.getNeedExp();if(s=a.getLevel(),(n-=c)<0){n+=c;break}var u=n+c;if(s+1>o){l=!0,n=u;break}(a=this.getUpgradeLevelData(e.getUpgradeKey(),s+1))||(n=u)}return e.setLevelExp(n),e.setLevel(s),this.operateShowSID(t,!0),!(!a||l)},delGoodsClacHeroNextData:function(t){var e=this._curData,i=this._nextData,n=0;n=t.getGoodsType()===td.GoodsType.Type_Item?t.getEffectValue():t.getOfferLevelExp();for(var a=this.getUpgradeLevelData(i.getUpgradeKey(),i.getLevel()),r=i.getLevel();a;){if(n-=i.getLevelExp(),r=i.getLevel(),n<=0){i.setLevelExp(-n);break}if(a=this.getUpgradeLevelData(i.getUpgradeKey(),r-1)){if(a.getLevel()<e.getLevel()){i.setLevelExp(e.getLevelExp()),i.setLevel(e.getLevel());break}i.setLevelExp(a.getNeedExp()),i.setLevel(i.getLevel()-1)}else i.setLevelExp(0),i.setLevel(i.getLevel())}},operateSelectSID:function(t,e){var i=this._selectSId,n=this._selectData,a=t.getSId();e?(i[a]?i[a]+=1:i[a]=1,n[a]=t):(i[a]&&(i[a]-=1),0===i[a]&&(delete i[a],delete n[a]))},isFullShowGoodsNum:function(){return this.getTotalItemNum()>=10},isFullSelectGoodsNum:function(){var t=0;for(var e in this._selectSId)t+=this._selectSId[e];for(var e in this._showSId)t+=this._showSId[e];return t>=10},isFullSelectSID:function(){var t=cc.instantiate(this._nextData),e=this._selectSId,i=this._selectData;for(var n in e){var a=i[n],r=0,o=e[n];r=a.getGoodsType()===td.GoodsType.Type_Item?a.getEffectValue():a.getOfferLevelExp();for(var s=1;s<=o;s++){var l=t.getLevelExp()+r,c=this.getUpgradeLevelData(t.getUpgradeKey(),t.getLevel());if(0===c.getNeedExp())return!0;for(var u=t.getLevel();c;){var d;if(d=c.getNeedExp(),u=c.getLevel(),(l-=d)<0){l+=d;break}var h=c.getNeedExp();(c=this.getUpgradeLevelData(t.getUpgradeKey(),u+1))||(l=h)}if(t.setLevelExp(l),t.setLevel(u),!c)return!0}}return!1},okSelectGoodsSID:function(){var t=this._selectSId,e=this._selectData,i=this._showSId,n=this._showDatas,a=0==t.myLen();for(var r in i)t[r]?t[r]+=i[r]:t[r]=i[r];for(var r in n)e[r]||(e[r]=n[r]);return this._showSId={},this._showDatas={},a},getNextLvData:function(t){var e=t.clone();return e.setLevel(t.getLevel()+1),e},createNextData:function(t,e,i){i=i||1;for(var n=t,a=td.Account.getUserData(),r=a?a.level:0,o=1;o<=i;o++){var s=0;s=e.getGoodsType()===td.GoodsType.Type_Item?e.getEffectValue():e.getOfferLevelExp();for(var l=n.getLevelExp()+s,c=this.getUpgradeLevelData(n.getUpgradeKey(),n.getLevel()),u=n.getLevel();c;){var d;if(d=c.getNeedExp(),u=c.getLevel(),(l-=d)<0){l+=d;break}var h=l+d;if(u+1>r){!0,l=h;break}(c=this.getUpgradeLevelData(n.getUpgradeKey(),u+1))||(l=h)}n.setLevelExp(l),n.setLevel(u)}return n},okGetSelectSID:function(){this._showSId={};var t=this._selectData,e=this._selectSId,i=this._curData;this._nextData=cc.instantiate(i);var n=td.Account.getUserData(),a=n?n.level:0,r=!1;for(var o in t){if(r||10===this.getTotalItemNum())break;for(var s=t[o],l=e[o],c=1;c<=l;c++){var u=this._nextData,d=0;d=s.getGoodsType()===td.GoodsType.Type_Item?s.getEffectValue():s.getOfferLevelExp();for(var h=u.getLevelExp()+d,p=this.getUpgradeLevelData(u.getUpgradeKey(),u.getLevel()),_=u.getLevel();p;){var g;if(g=p.getNeedExp(),_=p.getLevel(),(h-=g)<0){h+=g;break}var f=h+g;if(_+1>a){r=!0,h=f;break}(p=this.getUpgradeLevelData(u.getUpgradeKey(),_+1))||(h=f)}if(u.setLevelExp(h),u.setLevel(_),this.operateShowSID(s,!0),r)break}}},getTotalExp:function(){var t=this._curData,e=this._nextData;if(!t||!e)return 0;var i=e.getLevelUpCostExp()-t.getLevelUpCostExp(),n=Math.round(i-t.getLevelExp()+e.getLevelExp());return n<0&&(n=0),n},getNeedExp:function(){var t=this._nextData;if(!t)return 0;var e=this.getUpgradeLevelData(t.getUpgradeKey(),t.getLevel());if(!e)return 0;var i=e.getNeedExp()-t.getLevelExp();return i<0&&(i=0),Math.round(i)},getMercenaryUpgradeMaterialId:function(){return[td.ItemEnum.HeroExpItem2,td.ItemEnum.HeroExpItem3,td.ItemEnum.HeroExpItem4,td.ItemEnum.HeroExpItem5]}},cc._RF.pop()},{"../../Gem/Manager/GemstoneManager":"GemstoneManager"}],UpgradeModel:[function(t,e,i){"use strict";cc._RF.push(e,"c144bHrzJtN75U9OCoQqmw3","UpgradeModel");var n=t("Model"),a=cc.Class({extends:n,properties:{_key:null,_level:null,_needExp:null,_nextLevel:null,_attributes:null},init:function(t,e){this._super(t||"BaseUpgradeModel"),this._key=0,this._level=e.level,this._needExp=e.needExp,this._nextLevel=e.nextLevel,this._attributes=td.GlobalFunction.parseAttrArray(e.attributeTTPercent)},getUpgradeKey:function(){return this._key},getLevel:function(){return this._level},getNeedExp:function(){return this._needExp},getNextLevel:function(){return this._nextLevel},getAttributes:function(){return this._attributes},getAttributeByType:function(t){return this._attributes[t]?this._attributes[t]:0}}),r=cc.Class({extends:a,init:function(t){this._super("MercenaryUpgradeModel",t),this._key=t.heroId,this._attributes=td.GlobalFunction.parseAttrArray(t.attributes)}});td.GemstoneUpgradeModel=cc.Class({extends:a,properties:{_attributesPer:null,_condition:null},init:function(t){this._super("GemstoneUpgradeModel",t),this._key=t.runeId,this._attributesPer=td.GlobalFunction.parseAttrArray(t.attributeTTPercent),this._attributes=td.GlobalFunction.parseAttrArray(t.attributes),this._condition=t.condition},getAttributeByType:function(t,e){var i=e?this._attributesPer:this._attributes;return i[t]?i[t]:0},getCondition:function(){return this._condition}});var o=cc.Class({extends:a,init:function(t){this._super("ArtifactUpgradeModel",t),this._key=t.id,this._attributes=td.GlobalFunction.parseAttrArray(t.attributeTTPercent)}});e.exports.MercenaryUpgradeModel=r,e.exports.ArtifactUpgradeModel=o,cc._RF.pop()},{Model:"Model"}],UpgradeTipsTable:[function(t,e,i){"use strict";cc._RF.push(e,"7e523jURQVDwaFOA5S3JLFZ","UpgradeTipsTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"UpgradeTipsTable",properties:{_tblName:"upgrade_tips_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[t.length]=a}t.sort(function(t,e){return t.level-e.level})},getLastestShowData:function(t){for(var e=this._data,i=0,n=[],a=0;a<e.length;a++){var r=e[a];if(n.push(r),r.level>t&&++i>=3)break}return n.slice(n.length-3)}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],UserEnum:[function(t,e,i){"use strict";cc._RF.push(e,"6abc6Zg91hBU5lXG64Yq3wy","UserEnum"),td.LoadKey={Mercenary:1,PveCopyInfo:2,PveHookInfo:3,BattleArray:4},td.ActorKey={0:"none",1:"userId",2:"platformId",3:"channelId",4:"serverId",5:"gamerId",6:"nickName",7:"sex",8:"level",9:"exp",10:"gold",11:"diamond",12:"vip",13:"avatar",14:"guideId",15:"luckyCoin",17:"fightPower",18:"arenaCoin",19:"worldBossCoin",20:"lastRenameTime",21:"aboreState",22:"amethyst",23:"recharge",24:"score",25:"vipCard",26:"abyssCoin",27:"nationCoin",28:"storyId",29:"battleAchieve",31:"Prestige",32:"titleId",41:"NationTechPoint",getKey:function(t){for(var e in this)if(this.hasOwnProperty(e)&&e==t)return this[e]}},td.UserPropertyEnum={None:0,UserId:1,PlatformId:2,ChannelId:3,ServerId:4,GamerId:5,NickName:6,Sex:7,Level:8,Exp:9,Gold:10,Diamond:11,Vip:12,Avatar:13,GUIDE_ID_LIST:14,LuckyCoin:15,IMMORTAL:16,FightPower:17,ArenaCoin:18,WorldBossCoin:19,LastRenameTime:20,ABORE_STATE:21,Amethyst:22,RECHARGE:23,SCORE:24,VIP_CARD:25,AbyssCoin:26,NationCoin:27,StoryId:28,BattleAchieve:29,FLOWER_STATE:30,Prestige:31,TITLE_ID:32,SharedState:33,FocusState:34,IS_SHOW_VIP:35,VerifyState:36,AbyssId:37,VIGOUR:38,ENERGY:39,EVIL_GOD_COIN:40,NationTechPoint:41,LeftAchPoint:42,SUP_SCI_TECH_POINT:43,CROSS_CUP_COIN:44,AvartarList:46,ShowList:47,QQ:48,LAST_REFRESH_MERIT_TIME:49,MINE:50,MIND_VOWEL:51,SKY_JADE:52,HERO_RUNE_COIN:53,LAST_REFRESH_VIGOUR_TIME:54,LAST_REFRESH_ENERGY_TIME:55,ARENA_MAX_RANK:56,NATION_LEVEL:58,CURRENT_SAVE_DIAMOND:59,TOTAL_SAVE_DIAMOND:60,RED_ENVELOPE_RECEIVE_COUNT:61,RED_ENVELOPE_SEND_COUNT:62,ACTOR_CREATE_TIME:63,LOGIN_TOTAL_DAY:64,FUND:68,PRESENT:69,LIFETIME_VIP_CARD_REWARD_STATE:70,HISTORY_HIGHEST_FIGHTPOWER:71,ANCIENT:72,CROSS_ARENA_COIN:73,LEGEND_POINT:74,LEGEND_COIN:75,MAZE_COIN:76,CHESS_COIN:77,DIVINE_POSITION:78,MAX_DIVINE_POSITION:79,NATION_NAME:100,LINE_UP_SHOW_ID:101,ONLINE_STATE:102,LAST_LOGOUT_TIME:103,NATION_FLAG:104,NATION_FLAGID:105,CURRENT_SERVER_ID:106,NATION_ID:107,GOD_FLOWER:120,Mercenary:1032,Item:1033,Equipment:1034,Gemstone:1035,DragonArtifact:1037,Treasure:1038,HeroRune:1039,Artifact:1040,SPIRIT:1041,Pet:1042},td.ActorSex={Man:0,Woman:1},td.AttrType={Full:0,Attack:1,HP:2,PhysicalArmor:3,SpellArmor:4,Crit:5,Toughness:6,Accuracy:7,Evade:8,DamageBonus:9,DamageReduction:10,PVPDAMAGE_BONUS:11,PVPDAMAGE_REDUCTION:12,PVEDAMAGE_BONUS:13,PVEDAMAGE_REDUCTION:14,TOWER_ATTACK_SPEED:15,TOWER_ATTACK_RANGE:16,TOWERDAMAGE_BONUS:17,TOWERDAMAGE_INCREASE:18,TOWER_SKILL_RATE:19,RAGE:20,RAGE_RECOVER:21},td.AttrStr=["allAttr","attack","hp","physicalArmor","spellArmor","crit","toughness","accuracy","evade","damageBonus","damageReduction","pvpDamageBonus","pvpDamageReduction","pveDamageBonus","pveDamageReduction","speed","","","","towerSkillRate","rage","rageRecover"],td.SkillEffectClass={allAttr:"AllAttr",attack:"AttackAddEffect",hp:"HpAddEffect",speed:"SpeedAddEffect",physicalArmor:"PhysicalArmorAddEffect",physicalPen:"PhysicalPenAddEffect",spellArmor:"SpellArmorAddEffect",spellPen:"SpellPenAddEffect",accuracy:"AccuracyAddEffect",evade:"EvadeAddEffect",crit:"CritAddEffect",toughness:"ToughnessAddEffect",vampire:"VampireAddEffect",rebound:"ReboundAddEffect",rage:"RageAddEffect",rageRecover:"RageRecoverEffect",restraint:"RestraintAddEffect",damageBonus:"DamageBonusAddEffect",damageReduction:"DamageReductionAddEffect",pvpDamageBonus:"PvpDamageBonusAddEffect",pvpDamageReduction:"PvpDamageReductionAddEffect",pveDamageBonus:"PveDamageBonusAddEffect",pveDamageReduction:"PveDamageReductionAddEffect",towerSkillRate:"TowerSkillRateAddEffect",criticalDouble:"CriticalDoubleAddEffect","":"",pdef:"PhysicalDefenceAddEffect",mdef:"MagicDefenceAddEffect",DamageReductionPhysical:"DamageReductionPhysicalAddEffect",DamageReductionMagic:"DamageReductionMagicAddEffect",NormalHurtPrecent:"NormalHurtPrecentAddEffect",SkillHurtPrecent:"SkillHurtPrecentAddEffect"},td.EquipmentType={1:{name:"Weapon",attr:td.AttrType.Attack,spriteFrame:"YX_zb_wuqi"},2:{name:"Helmet",attr:td.AttrType.HP,spriteFrame:"YX_zb_toukui"},3:{name:"Clothes",attr:td.AttrType.PhysicalArmor,spriteFrame:"YX_zb_yifu"},4:{name:"Pant",attr:td.AttrType.SpellArmor,spriteFrame:"YX_zb_kuzi"},5:{name:"Gautlet",attr:td.AttrType.Attack,spriteFrame:"YX_zb_huwang"},6:{name:"Shoes",attr:td.AttrType.HP,spriteFrame:"YX_zb_ziezi"}},td.EffectAddType={Prime:1,Value:2,Percent:3},td.VipCardType={MOUTH_VIP_CARD:1,LIFETIME_VIP_CARD:2,WEEK_VIP_CARD:3,PET_VIP_CARD:4},td.AttributeTargetType={SELF:1,LINEUP:2},td.IsShowAttrPercent={1:!1,2:!1,3:!1,4:!1,5:!0,6:!1,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,14:!1,15:!0,16:!0,17:!0,18:!0,20:!1,21:!1,22:!0,23:!0},cc._RF.pop()},{}],UserLevelTable:[function(t,e,i){"use strict";cc._RF.push(e,"cfe3fk3cM5Baa7NkRSElEzi","UserLevelTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"UserLevelTable",properties:{_tblName:"actor_level_config",_data:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.level]=a}},getAllLevelConfig:function(){return this._data},getNeedExpByLevel:function(t){return this._data[t]?this._data[t].needExp:0},getAddEnergy:function(t,e){if(!(t>=e)){for(var i=0,n=t+1;n<=e;n++){i+=this._data[n].addEnergy}return i}},getAddGoddess:function(t){return this._data[t]?this._data[t].addGoddess:0},getLevelIsTopLevel:function(t){if(this._data[t]&&0==this._data[t].nextLevel)return!0;return!1}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],UserModel:[function(t,e,i){"use strict";cc._RF.push(e,"e94f4tOoDZDGb8F54bD6vbz","UserModel");var n=t("BaseUser"),a=cc.Class({extends:n,_guideIds:null,_lastAddPowerTime:null,_lastRenameTime:null,_flowerState:null,_aborState:null,_recharge:null,_score:null,_vipCard:null,_amethyst:null,_curStoryId:null,_battleAchieve:null,_nationTechPoint:null,_titleRewardState:null,_curKnightId:null,_avatarList:null,_showList:null,_diamond:null,_gold:null,_arenaCoin:null,_worldBossCoin:null,_abyssCoin:null,_nationCoin:null,_luckyCoin:null,_dragonSprite:null,_evilGodCoin:null,_skyJade:null,_hindVowel:null,_heroRuneCoin:null,_crossCupCoin:null,_mine:null,_fund:null,_present:null,_prestige:null,_vigour:null,_leftAchPoint:null,_last_refresh_vigour_time:null,_last_refresh_energy_time:null,_arenaRank:null,_nationLevel:null,_currentSaveDiamond:null,_totalSaveDiamond:null,_redenvelopeReceiveCount:null,_redenvelopeSendCount:null,_actorCreateTime:null,_loginTotalDay:null,_merit:null,_last_refresh_merit_time:null,_immortalLevel:null,_technologyPoint:null,_isLifeCardRewardReceived:null,_ancient:null,_cross_arena_coin:null,_titleId:null,_qq:null,_legendPoint:null,_legendCoin:null,_mazeCoin:null,_chessCoin:null,init:function(t){this._super("User",t);var e=td.UserPropertyEnum;this._guideIds=t[e.GUIDE_ID_LIST]||[],this._lastRenameTime=t[e.LastRenameTime]||0,this._flowerState=t[e.FLOWER_STATE]||0,this._aborState=t[e.ABORE_STATE]||0,this._recharge=t[e.RECHARGE]||0,this._score=t[e.SCORE]||0,this._vipCard=t[e.VIP_CARD]||[],this._diamond=t[e.Diamond]||0,this._gold=t[e.Gold]||0,this._arenaCoin=t[e.ArenaCoin]||0,this._worldBossCoin=t[e.WorldBossCoin]||0,this._amethyst=t[e.Amethyst]||0,this._nationTechPoint=t[e.NationTechPoint]||0,this._abyssCoin=t[e.AbyssCoin]||0,this._nationCoin=t[e.NationCoin]||0,this._luckyCoin=t[e.LuckyCoin]||0,this._curStoryId=t[e.StoryId]||0,this._battleAchieve=t[e.BattleAchieve]||0,this._prestige=t[e.Prestige]||0,this._titleRewardState=t[e.Title_Reward_State],this._dollarGiftState=t[e.DollarGiftState],this._shareState=t[e.SharedState],this._focusRewardState=t[e.FocusState],this._verifyRewardState=t[e.VerifyState],this._heroTrailId=t[e.AbyssId]||0,this._vigour=t[e.VIGOUR]||0,this._energy=t[e.ENERGY]||0,this._titleId=t[e.TITLE_ID]||0,this._last_refresh_vigour_time=t[e.LAST_REFRESH_VIGOUR_TIME]||0,this._last_refresh_energy_time=t[e.LAST_REFRESH_ENERGY_TIME]||0,this._evilGodCoin=t[e.EVIL_GOD_COIN]||0,this._leftAchPoint=t[e.LeftAchPoint]||0,this._curKnightId=t[e.KnightId]||0,this._dragonSprite=t[e.DragonSprite]||0,this._skyJade=t[e.SKY_JADE]||0,this._crossCupCoin=t[e.CROSS_CUP_COIN]||0,this._hindVowel=t[e.MIND_VOWEL]||0,this._mine=t[e.MINE]||0,this._fund=t[e.FUND]||0,this._present=t[e.PRESENT]||0,this._cross_arena_coin=t[e.CROSS_ARENA_COIN]||0,this._legendPoint=t[e.LEGEND_POINT]||0,this._legendCoin=t[e.LEGEND_COIN]||0,this._mazeCoin=t[e.MAZE_COIN]||0,this._chessCoin=t[e.CHESS_COIN]||0,this._heroRuneCoin=t[e.HERO_RUNE_COIN]||0;t[e.DanRewardState];this._avatarList=t[e.AvartarList]||[],this._showList=t[e.ShowList]||[],this._arenaRank=t[e.ARENA_MAX_RANK]||0,this._nationLevel=t[e.NATION_LEVEL]||0,this._currentSaveDiamond=t[e.CURRENT_SAVE_DIAMOND]||0,this._totalSaveDiamond=t[e.TOTAL_SAVE_DIAMOND]||0,this._redenvelopeReceiveCount=t[e.RED_ENVELOPE_RECEIVE_COUNT]||0,this._redenvelopeSendCount=t[e.RED_ENVELOPE_SEND_COUNT]||0,this._actorCreateTime=t[e.ACTOR_CREATE_TIME]||0,this._loginTotalDay=t[e.LOGIN_TOTAL_DAY]||0,this._merit=t[e.MERIT]||0,this._last_refresh_merit_time=t[e.LAST_REFRESH_MERIT_TIME]||0,this._immortalLevel=t[e.IMMORTAL]||0,this._technologyPoint=t[e.SUP_SCI_TECH_POINT]||0,this._isLifeCardRewardReceived=t[e.LIFETIME_VIP_CARD_REWARD_STATE]||!1,this._ancient=t[e.ANCIENT]||0,this._qq=t[e.QQ]||0},updateAttr:function(t){this._super(t);var e=td.UserPropertyEnum;void 0!==t[e.GUIDE_ID_LIST]&&(this._guideIds=t[e.GUIDE_ID_LIST]),void 0!==t[e.LastRenameTime]&&(this._lastRenameTime=t[e.LastRenameTime]),void 0!==t[e.FLOWER_STATE]&&(this._flowerState=t[e.FLOWER_STATE]),void 0!==t[e.ABORE_STATE]&&(this._aborState=t[e.ABORE_STATE]),void 0!==t[e.RECHARGE]&&(this._recharge=t[e.RECHARGE]),void 0!==t[e.SCORE]&&(this._score=t[e.SCORE]),void 0!==t[e.VIP_CARD]&&(this._vipCard=t[e.VIP_CARD]),void 0!==t[e.Diamond]&&(this._diamond=t[e.Diamond]),void 0!==t[e.Gold]&&(this._gold=t[e.Gold]),void 0!==t[e.ArenaCoin]&&(this._arenaCoin=t[e.ArenaCoin]),void 0!==t[e.WorldBossCoin]&&(this._worldBossCoin=t[e.WorldBossCoin]),void 0!==t[e.Amethyst]&&(this._amethyst=t[e.Amethyst]),void 0!==t[e.NationTechPoint]&&(this._nationTechPoint=t[e.NationTechPoint]),void 0!==t[e.AbyssCoin]&&(this._abyssCoin=t[e.AbyssCoin]),void 0!==t[e.NationCoin]&&(this._nationCoin=t[e.NationCoin]),void 0!==t[e.LuckyCoin]&&(this._luckyCoin=t[e.LuckyCoin]),void 0!==t[e.StoryId]&&(this._curStoryId=t[e.StoryId]),void 0!==t[e.BattleAchieve]&&(this._battleAchieve=t[e.BattleAchieve]),void 0!==t[e.Prestige]&&(this._prestige=t[e.Prestige]),void 0!==t[e.Title_Reward_State]&&(this._titleRewardState=t[e.Title_Reward_State]),void 0!==t[e.DollarGiftState]&&(this._dollarGiftState=t[e.DollarGiftState]),void 0!==t[e.SharedState]&&(this._shareState=t[e.SharedState]),void 0!==t[e.FocusState]&&(this._focusRewardState=t[e.FocusState]),void 0!==t[e.VerifyState]&&(this._verifyRewardState=t[e.VerifyState]),void 0!==t[e.AbyssId]&&(this._heroTrailId=t[e.AbyssId]),void 0!==t[e.TITLE_ID]&&(this._titleId=t[e.TITLE_ID]),void 0!==t[e.VIGOUR]&&(this._vigour=t[e.VIGOUR]),void 0!==t[e.ENERGY]&&(this._energy=t[e.ENERGY]),void 0!==t[e.LAST_REFRESH_VIGOUR_TIME]&&(this._last_refresh_vigour_time=t[e.LAST_REFRESH_VIGOUR_TIME]),void 0!==t[e.LAST_REFRESH_ENERGY_TIME]&&(this._last_refresh_energy_time=t[e.LAST_REFRESH_ENERGY_TIME]),void 0!==t[e.EVIL_GOD_COIN]&&(this._evilGodCoin=t[e.EVIL_GOD_COIN]),void 0!==t[e.LeftAchPoint]&&(this._leftAchPoint=t[e.LeftAchPoint]),void 0!==t[e.KnightId]&&(this._curKnightId=t[e.KnightId]),void 0!==t[e.DragonSprite]&&(this._dragonSprite=t[e.DragonSprite]||0),void 0!==t[e.AvartarList]&&(this._avatarList=t[e.AvartarList]),void 0!==t[e.ShowList]&&(this._showList=t[e.ShowList]),void 0!==t[e.SKY_JADE]&&(this._skyJade=t[e.SKY_JADE]),void 0!==t[e.CROSS_CUP_COIN]&&(this._crossCupCoin=t[e.CROSS_CUP_COIN]),void 0!==t[e.MIND_VOWEL]&&(this._hindVowel=t[e.MIND_VOWEL]),void 0!==t[e.MINE]&&(this._mine=t[e.MINE]),void 0!==t[e.FUND]&&(this._fund=t[e.FUND]),void 0!==t[e.HERO_RUNE_COIN]&&(this._heroRuneCoin=t[e.HERO_RUNE_COIN]||0),void 0!==t[e.PRESENT]&&(this._present=t[e.PRESENT]),void 0!==t[e.ARENA_MAX_RANK]&&(this._arenaRank=t[e.ARENA_MAX_RANK]||0),void 0!==t[e.NATION_LEVEL]&&(this._nationLevel=t[e.NATION_LEVEL]||0),void 0!==t[e.CURRENT_SAVE_DIAMOND]&&(this._currentSaveDiamond=t[e.CURRENT_SAVE_DIAMOND]||0),void 0!==t[e.TOTAL_SAVE_DIAMOND]&&(this._totalSaveDiamond=t[e.TOTAL_SAVE_DIAMOND]||0),void 0!==t[e.RED_ENVELOPE_RECEIVE_COUNT]&&(this._redenvelopeReceiveCount=t[e.RED_ENVELOPE_RECEIVE_COUNT]||0),void 0!==t[e.RED_ENVELOPE_SEND_COUNT]&&(this._redenvelopeSendCount=t[e.RED_ENVELOPE_SEND_COUNT]||0),void 0!==t[e.ACTOR_CREATE_TIME]&&(this._actorCreateTime=t[e.ACTOR_CREATE_TIME]||0),void 0!==t[e.LOGIN_TOTAL_DAY]&&(this._loginTotalDay=t[e.LOGIN_TOTAL_DAY]||0),void 0!==t[e.MERIT]&&(this._merit=t[e.MERIT]||0),void 0!==t[e.LAST_REFRESH_MERIT_TIME]&&(this._last_refresh_merit_time=t[e.LAST_REFRESH_MERIT_TIME]||0),void 0!==t[e.IMMORTAL]&&(this._immortalLevel=t[e.IMMORTAL]||0),void 0!==t[e.SUP_SCI_TECH_POINT]&&(this._technologyPoint=t[e.SUP_SCI_TECH_POINT]||0),void 0!==t[e.LIFETIME_VIP_CARD_REWARD_STATE]&&(this._isLifeCardRewardReceived=t[e.LIFETIME_VIP_CARD_REWARD_STATE]||!1);t[e.DanRewardState];void 0!==t[e.ANCIENT]&&(this._ancient=t[e.ANCIENT]||0),void 0!==t[e.HISTORY_HIGHEST_FIGHTPOWER]&&(this.historyHighestPower=t[e.HISTORY_HIGHEST_FIGHTPOWER]||0),void 0!==t[e.CROSS_ARENA_COIN]&&(this._cross_arena_coin=t[e.CROSS_ARENA_COIN]||0),void 0!==t[e.LEGEND_POINT]&&(this._legendPoint=t[e.LEGEND_POINT]||0),void 0!==t[e.LEGEND_COIN]&&(this._legendCoin=t[e.LEGEND_COIN]||0),void 0!==t[e.MAZE_COIN]&&(this._mazeCoin=t[e.MAZE_COIN]||0),void 0!==t[e.CHESS_COIN]&&(this._chessCoin=t[e.CHESS_COIN]||0),void 0!==t[e.QQ]&&(this._qq=t[e.QQ]||0),td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_USER_ATTRIBUTE)},getCrossArenaCoin:function(){return this._cross_arena_coin},getDragonSprite:function(){return this._dragonSprite},getNationTechPoint:function(){return this._nationTechPoint},getNationCoin:function(){return this._nationCoin},getGuideId:function(){return this._guideIds},getLastRenameTime:function(){return this._lastRenameTime},getTitleId:function(){return this._titleId},getAllFlowerState:function(){return this._flowerState},getFlowerState:function(t){return!(!this._flowerState||!this._flowerState[t])&&this._flowerState[t]},getAboreState:function(t){return!(!this._aborState||!this._aborState[t])&&this._aborState[t]},getRechargeForShow:function(){return this._recharge/10},getRecharge:function(){return this._recharge},getRechargeExcpetPresent:function(){return this._recharge-this._present},getScore:function(){return this._score},getDiamond:function(){return this._diamond},getGold:function(){return this._gold},getArenaCoin:function(){return this._arenaCoin},getWorldBossCoin:function(){return this._worldBossCoin},getAmethyst:function(){return this._amethyst},getAbyssCoin:function(){return this._abyssCoin},getLuckyCoin:function(){return this._luckyCoin},getHeadImg:function(){return this.avatar},getLevel:function(){return this.level},getCurStoryId:function(){return this._curStoryId},getBattleAchieve:function(){return this._battleAchieve},getVip:function(){return this.vip},getPrestige:function(){return this._prestige},getVipCard:function(t){if(!this._vipCard)return null;for(var e=0;e<this._vipCard.length;e++){var i=this._vipCard[e];if(parseInt(i.type)===t)return td.TimeUtil.getTime()>=i.expirationTime?null:i}return null},isReceiveTitleReward:function(){return this._titleRewardState},isReceiveDollarReward:function(){return this._dollarGiftState},getShareState:function(){return this._shareState},getShareRewardState:function(){return this._shareState||!1},getFocusRewardState:function(){return this._focusRewardState||!1},getVerifyRewardState:function(){return this._verifyRewardState||!1},getHeroTrailId:function(){return this._heroTrailId},getVigour:function(){return this._vigour},getSkyJade:function(){return this._skyJade},getCrossCupCoin:function(){return this._crossCupCoin},getHindVowel:function(){return this._hindVowel},getMine:function(){return this._mine},getFund:function(){return this._fund},getHeroRuneCoin:function(){return this._heroRuneCoin},getEnergy:function(){return this._energy},getEvilGodCoin:function(){return this._evilGodCoin},getLeftAchPoint:function(){return this._leftAchPoint},getCurKnightId:function(){return this._curKnightId||0},getLastRefreshVigourTime:function(){return this._last_refresh_vigour_time||0},getNextRecoverVigourTime:function(){var t=td.GetConfig("ACTOR_VIGOUR_RECOVER_TIME");return this._last_refresh_vigour_time+t},getAllRecoverVigourTime:function(){var t=td.GetConfig("ACTOR_VIGOUR_LIMIT")-this._vigour,e=td.GetConfig("ACTOR_VIGOUR_RECOVER_TIME");return t<0&&(t=0),this._last_refresh_vigour_time+t*e},getLastRefreshEnergyTime:function(){return this._last_refresh_energy_time||0},getNextRecoverEnergyTime:function(){var t=td.GetConfig("ACTOR_ENERGY_RECOVER_TIME");return this._last_refresh_energy_time+t},getAllRecoverEnergyTime:function(){var t=td.GetConfig("ACTOR_ENERGY_LIMIT")-this._energy,e=td.GetConfig("ACTOR_ENERGY_RECOVER_TIME");return t<0&&(t=0),this._last_refresh_energy_time+t*e},getAvatarList:function(){return this._avatarList},getShowList:function(){return this._showList},getArenaMaxRank:function(){return this._arenaRank},getNationLevel:function(){return this._nationLevel},getCurrentSaveDiamond:function(){return this._currentSaveDiamond},getTotalSaveDiamond:function(){return this._totalSaveDiamond},getReceiveRedPacketCount:function(){return this._redenvelopeReceiveCount},getRedenvelopeSendCount:function(){return this._redenvelopeSendCount},getActorCreateTime:function(){return this._actorCreateTime},getLoginTotalDay:function(){return this._loginTotalDay},getMerit:function(){return this._merit},getLastRefreshMeritTime:function(){return this._last_refresh_merit_time||0},getNextRecoverMeritTime:function(){var t=td.GetConfig("ACTOR_MERIT_RECOVER_TIME");return this._last_refresh_merit_time+t},getAllRecoverMeritTime:function(){var t=td.GetConfig("ACTOR_MERIT_LIMIT")-this._merit,e=td.GetConfig("ACTOR_MERIT_RECOVER_TIME");return t<0&&(t=0),this._last_refresh_merit_time+t*e},getImmortalLevel:function(){return this._immortalLevel},getTechnologyPoint:function(){return this._technologyPoint},getPresent:function(){return this._present},isLifeCardRewardReceived:function(){return this._isLifeCardRewardReceived},getAncient:function(){return this._ancient},getQQ:function(){return this._qq},getLegendPoint:function(){return this._legendPoint},getLegendCoin:function(){return this._legendCoin},getMazeCoin:function(){return this._mazeCoin},getChessCoin:function(){return this._chessCoin},getUserItemProperty:function(t){var e=0;switch(t){case td.ItemEnum.Diamond:e=this._diamond;break;case td.ItemEnum.Gold:e=this._gold;break;case td.ItemEnum.Exp:e=this.exp;break;case td.ItemEnum.ArenaCoin:e=this._arenaCoin;break;case td.ItemEnum.WorldBossCoin:e=this._worldBossCoin;break;case td.ItemEnum.Amethyst:e=this._amethyst;break;case td.ItemEnum.NationTechPoint:e=this._nationTechPoint;break;case td.ItemEnum.AbyssCoin:e=this._abyssCoin;break;case td.ItemEnum.NationCoin:e=this._nationCoin;break;case td.ItemEnum.LuckyCoin:e=this._luckyCoin;break;case td.ItemEnum.BattleAchieve:e=this._battleAchieve;break;case td.ItemEnum.Prestige:e=this._prestige;break;case td.ItemEnum.AchPoint:e=this._leftAchPoint;break;case td.ItemEnum.EvilGodCoin:e=this._evilGodCoin;break;case td.ItemEnum.DragonSprite:e=this._dragonSprite;break;case td.ItemEnum.NationStudyPoint:e=this._nationTechPoint;break;case td.ItemEnum.SKY_JADE:e=this._skyJade;break;case td.ItemEnum.CROSS_CUP_COIN:e=this._crossCupCoin;break;case td.ItemEnum.MIND_VOWEL:e=this._hindVowel;break;case td.ItemEnum.HERO_RUNE_COIN:e=this._heroRuneCoin;break;case td.ItemEnum.MERIT:e=this._merit;break;case td.ItemEnum.SUP_SCI_TECH_POINT:e=this._technologyPoint;break;case td.ItemEnum.VIGOUR:e=this._vigour;break;case td.ItemEnum.MINE:e=this._mine;break;case td.ItemEnum.FUND:e=this._fund;break;case td.ItemEnum.Energy:e=this._energy;break;case td.ItemEnum.ANCIENT:e=this._ancient;break;case td.ItemEnum.CROSS_ARENA_COIN:e=this._cross_arena_coin;break;case td.ItemEnum.LEGEND_POINT:e=this._legendPoint;break;case td.ItemEnum.LEGEND_COIN:e=this._legendCoin;break;case td.ItemEnum.MAZE_COIN:e=this._mazeCoin;break;case td.ItemEnum.CHESS_COIN:e=this._chessCoin;break;default:e=0}return e}});e.exports=a,cc._RF.pop()},{BaseUser:"BaseUser"}],VertigoBuff:[function(t,e,i){"use strict";cc._RF.push(e,"ee848+QN1dIvYGP1JqW1rQD","VertigoBuff");var n=t("PveBaseBuff"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_clipName:null,_bShowBuff:null,_buffAnimation:null},initData:function(t){if(this._super(t),this._buffType=td.PveEnum.PVE_EFFECT_TYPE.Vertigo,this._bShowBuff="boolean"!=typeof this._curBuffData.showBuff||this._curBuffData.showBuff,this._bShowBuff){var e=this.node.getChildByName("vertigoAnimation");if(!e){var i=gdk.rm.getResByUrl("fightRes/pve/buff/buffPrefab",cc.Prefab);e=cc.instantiate(i),this.node.addChild(e),e.name="vertigoAnimation"}this._buffAnimation=e.getComponent(cc.Animation),this._clipName="vertigoAnimation",cc.log("this is Vertigo buff !!!")}},onEnable:function(){if(this._super(),this._buffType===this._curBuffData.buffType){if(this._super(),this._curSpeedMult=a.getCurFightSpeedMult(),this._bShowBuff)this.refreshSkillAnimationSpeed(this._curSpeedMult),this._buffAnimation.play(this._clipName).wrapMode=cc.WrapMode.Loop;this.setTargetBuffData(!0),this.schedule(this.onUpdateVertigoBuff,1/60)}else this.removeSelf()},onDisable:function(){this._super(),this.unschedule(this.onUpdateVertigoBuff)},onChangeSpeedMult:function(t){this._super(t),this._bShowBuff&&this.refreshSkillAnimationSpeed(t)},refreshSkillAnimationSpeed:function(t){for(var e=this._buffAnimation,i=e.getClips(),n=0,a=i.length;n<a;n++){if(i[n])e.getAnimationState(i[n].name).speed=t}},setTargetBuffData:function(t){var e=Math.floor(this._curTarget._tag/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._curTarget.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=i.getDataModel(),a=(t?-1:1)*n.getMoveSpeed();i.setCurSpeedChange(a)},onUpdateVertigoBuff:function(t){if(!this._bFightPause)return this._curBuffData.buffTime<=0?(this.unschedule(this.onUpdateVertigoBuff),this.setTargetBuffData(!1),void this.endBuff()):void(this._curBuffData.buffTime-=t*this._curSpeedMult)},endBuff:function(){(this._super(),cc.isValid(this._curTarget))&&this._curTarget.getComponent("EnemyBuffCtrlComponent").removeBuffFromList(this._buffType,this._curBuffKey)}});e.exports=r,cc._RF.pop()},{PveBaseBuff:"PveBaseBuff",PveFightManager:"PveFightManager"}],VipDailyController:[function(t,e,i){"use strict";cc._RF.push(e,"4e427yvKBJKx5BOWNjkpjlU","VipDailyController");var n=t("ActivityBaseController"),a=t("VipDailyModel"),r=cc.Class({extends:n,properties:{_allData:null},initData:function(t){this._super(t),this.init()},init:function(){this._allData=null,this._addListener(),this._addEventListener()},_addListener:function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.GET_VIP_WELFARE_INFO,this._parseVipDailyInfo.bind(this)),i.registerMessage(t,e.VIP_WELFARE_RECEIVE,this._onReceiveReward.bind(this)),i.registerMessage(t,e.PUSH_VIP_WELFARE_INFO,this._parseVipDailyInfo.bind(this))},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REQ_VIP_DAILY_BENEFITS_INFO]=this._requestVipDailyInfo.bind(this),t[e.REQ_GET_VIP_DAILY_BENEFITS]=this._requestReceive.bind(this),td.EventUtil.registerEvents(t,this)},removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},destroyData:function(){this._currentData=null,this._nextData=null,this.removeAllListeners()},getVipDailyModel:function(t){return this._allData[t]},_requestVipDailyInfo:function(){var t={};t.module=td.MsgModuleName.ExtensionCmd,t.cmd=td.MsgCmd.ExtensionCmd.GET_VIP_WELFARE_INFO,td.ServerDelegate.sendMessage(t)},_parseVipDailyInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._initAllData();var i=td.Account.getUserData().getVip(),n=this._allData[i],a=e.receives;n.setFreeStatus(!1),n.setBuyStatus(!1);for(var r=td.ActivityEnum.VipWelfareType,o=0,s=a.length;o<s;o++){var l=a[o];l===r.FREE_REWARD?n.setFreeStatus(!0):l===r.PAY_REWARD&&n.setBuyStatus(!0)}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_VIP_DAILY_BENEFITS)}},_requestReceive:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.VIP_WELFARE_RECEIVE,e.configId=t,td.ServerDelegate.sendMessage(e)},_onReceiveReward:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.rewardResult,n=td.RewardManager.parseRewardResult(i,!0);td.GlobalFunction.showRewards(n)}},_initAllData:function(){if(!(this._allData&&this._allData.myLen()>0)){this._allData={};for(var t=td.GetTableClass(td.TableEnum.VipWelfareConfig).getAllData(),e=0,i=t.length-1;e<=i;e++){var n=t[e];if(n){var r=new a;r.init(n),this._allData[r.getVip()]=r}}}},hasRedPoint:function(){return!0},redPointTip:function(){var t=this._allData;if(!t||0===t.myLen())return!1;var e=td.Account.getUserData();return!!e&&!this._allData[e.vip].getFreeStatus()},redPointEvts:function(){return[td.EventNameEnum.USER_ATTR_VIP_LEVEL_CHANGE,td.EventNameEnum.REFRESH_VIP_DAILY_BENEFITS,td.EventNameEnum.Recharge_Success]},isRedPointTip:function(){return this.redPointTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",VipDailyModel:"VipDailyModel"}],VipDailyModel:[function(t,e,i){"use strict";cc._RF.push(e,"5863fBQ4uNI2rj82QsCsGCl","VipDailyModel");var n=cc.Class({properties:{_vipLevel:null,_freeRewards:null,_cost:null,_originalCost:null,_buyRewards:null,_freeStatus:null,_buyStatus:null},init:function(t){this._vipLevel=t.vipLevel;var e=t.reward;this._freeRewards=[],e&&e[0]&&e[0][1]&&(this._freeRewards=td.RewardManager.parseRewardListDetail(e[0][1])),this._buyRewards=[],e&&e[1]&&e[1][1]&&(this._buyRewards=td.RewardManager.parseRewardListDetail(e[1][1])),this._cost=td.RewardManager.parseRewardListDetail(t.actPrice)[0],this._originalCost=td.RewardManager.parseRewardListDetail(t.originalCost)[0],this._freeStatus=!1,this._buyStatus=!1},getVip:function(){return this._vipLevel},getFreeRewards:function(){return this._freeRewards},getCost:function(){return this._cost},getOriginalCost:function(){return this._originalCost},getBuyRewards:function(){return this._buyRewards},getFreeStatus:function(){return this._freeStatus},getBuyStatus:function(){return this._buyStatus},setFreeStatus:function(t){this._freeStatus=t},setBuyStatus:function(t){this._buyStatus=t}});e.exports=n,cc._RF.pop()},{}],VipDailyPanel:[function(t,e,i){"use strict";cc._RF.push(e,"d17b0YBEaRGTaU/W7Y6nFdl","VipDailyPanel");var n=t("ActivityBasePanel"),a=t("CommonIconWidget"),r=cc.Class({extends:n,properties:{item:cc.Node,itemsLayer:cc.Node},initData:function(t){this._super(t),this.item.active=!1},onEnable:function(){this._super(),this._addEventListener(),this._refreshContent()},onDisable:function(){this._super(),td.EventUtil.unregisterAllEvents(this)},_addEventListener:function(){var t=[];t[td.EventNameEnum.REFRESH_VIP_DAILY_BENEFITS]=this._refreshContent,td.EventUtil.registerEvents(t,this)},_refreshContent:function(){var t=this.getActivityController(),e=td.Account.getUserData().getVip(),i=t.getVipDailyModel(e);if(i)for(var n=t.getVipDailyModel(e+1),a=1;a<=4;a++){var r=this.itemsLayer.getChildByName("item"+a),o=a<=2;o||n?(r||((r=cc.instantiate(this.item)).name="item"+a,r.parent=this.itemsLayer,r.x=0,r.active=!0),this._setItemWidget(r,o?i:n,a)):r&&(r.active=!1)}else cc.log("get vip walfare data error for vip = "+e)},_setItemWidget:function(t,e,i){if(e){var n=i<=2,r=t.getChildByName("titleBg"),o=n?td.resDef.Acitivty_07_vip.HD_bqbg1:td.resDef.Acitivty_07_vip.HD_bqbg2;td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.Acitivty_07_vip,o,r);var s=t.getChildByName("titleText");s.getComponent(cc.Label).string=cc.js.formatStr(td.Language.vipWealFare,e.getVip()),s.getComponent(cc.LabelOutline).color=n?cc.color(207,5,214):cc.color(217,87,0);var l=i%2==0,c=t.getChildByName("rechargeTips"),u=t.getChildByName("getImg"),d=t.getChildByName("operateBtn"),h=t.getChildByName("originCostNode"),p=t.getChildByName("costNode"),_="",g=!1;if(n)if(c.active=!1,p.active=l,h.active=l,l){var f=e.getCost();this._setCostNode(p,f);var v=e.getOriginalCost();this._setCostNode(h,v);var m=e.getBuyStatus();d.active=!m,u.active=m,m?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,td.resDef.GY0_Common.GY0_wz_yiguomai,u):(_=td.Language.buy,d._tag=td.ActivityEnum.VipWelfareBtnType.Buy)}else{var y=e.getFreeStatus();d.active=!y,u.active=y,y?td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.GY0_Common,td.resDef.GY0_Common.GY0_wz_yilingqu,u):(_=td.Language.recevie,d._tag=td.ActivityEnum.VipWelfareBtnType.Receive,g=!0)}else{c.active=!0,d.active=!0,p.active=!1,h.active=!1,u.active=!1,_=td.Language.recharge;var E=td.Account.getUserData(),T=E.getVip(),C=td.GetTableClass(td.TableEnum.VipTable).getVipRechargeByVipLevel(T+1)-E.getRecharge()/10;c.getComponent(cc.Label).string=cc.js.formatStr(l?td.Language.rechargeBuyTip:td.Language.rechargeGetTip,C),d._tag=td.ActivityEnum.VipWelfareBtnType.Recharge}td.RedPointUtil.createRedPointSimple(d,cc.v2(-10,-10),g),""!==_&&td.GlobalFunction.setButtonTitle(d,_);for(var R=t.getChildByName("rewardsLayer"),S=l?e.getBuyRewards():e.getFreeRewards(),I=0,A=S.length;I<A;I++){var b=S[I],P=R.getChildByName("icon"+I);P?P.getComponent(a).setData(b):((P=td.GlobalFunction.createCommonIconWidget(26,b)).name="icon"+I,P.parent=R,P.scale=.8)}for(;;I++){var N=R.getChildByName("icon"+I);if(!N)break;N.removeFromParent(!0)}}},_setCostNode:function(t,e){var i=t.getChildByName("icon");td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_item,e.getLittleIconResPath(),i),t.getChildByName("num").getComponent(cc.Label).string=e.getCount()},onClickOperateBtn:function(t){var e=t.currentTarget._tag;if(e===td.ActivityEnum.VipWelfareBtnType.Receive)td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_GET_VIP_DAILY_BENEFITS,td.ActivityEnum.VipWelfareType.FREE_REWARD);else if(e===td.ActivityEnum.VipWelfareBtnType.Buy){var i=td.Account.getUserData().getVip(),n=this.getActivityController().getVipDailyModel(i);if(n){var a=n.getCost();if(a&&td.GamerResourceUtil.checkResource(a.getId(),a.getCount()))td.EventUtil.dispatchEvent(td.EventNameEnum.REQ_GET_VIP_DAILY_BENEFITS,td.ActivityEnum.VipWelfareType.PAY_REWARD);else{var r=new td.BroadcastContent(23);r.setOkCallFunc(function(){td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityVip,td.ActivityEnum.ActivityType.VipDaily])}.bind(this)),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,r)}}}else e===td.ActivityEnum.VipWelfareBtnType.Recharge&&td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityVip,td.ActivityEnum.ActivityType.VipDaily])}});e.exports=r,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",CommonIconWidget:"CommonIconWidget"}],VipDesTable:[function(t,e,i){"use strict";cc._RF.push(e,"5281d95VYxPAIoO57LB6NLR","VipDesTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"VipDesTable",properties:{_tblName:"vipDes_config",_datas:null},init:function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i];t[a.vipLevel]=a}},getDatas:function(){return this._data},getDataByLevel:function(t){return this._data[t]?this._data[t]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],VipGiftController:[function(t,e,i){"use strict";cc._RF.push(e,"23825Rn03dME47UYZXVPL//","VipGiftController");var n=t("ActivityBaseController"),a=t("VipGiftModel"),r=cc.Class({extends:n,properties:{_allGifts:null,_curShop:null},initData:function(t){this._super(t),this.init()},init:function(){this._allGifts=null,this._addListener(),this._addEventListener()},_addListener:function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.GET_VIP_PACKET_INFO,this.receiveBaseInfo.bind(this)),i.registerMessage(t,e.EXCHANGE_VIP_PACKET,this.exchangeReturn.bind(this)),i.registerMessage(t,e.PUSH_VIP_PACKET_INFO,this.receiveBaseInfo.bind(this))},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REQUEST_VIP_PACKET_INFO]=this.requestBaseInfo.bind(this),t[e.REQUEST_EXCHANGE_VIP_PACKET]=this.requestExchange.bind(this),td.EventUtil.registerEvents(t,this)},removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},destroyData:function(){this._allGifts=null,this.removeAllListeners()},getSortedData:function(){var t=[],e=this._allGifts;for(var i in e)e[i]&&(t[t.length]=e[i]);var n=td.ActivityEnum.VipGiftEnum;return t.sort(function(t,e){return t.getState()===n.ALREADY_BUY&&e.getState()!==n.ALREADY_BUY?1:t.getState()!==n.ALREADY_BUY&&e.getState()===n.ALREADY_BUY?-1:t.getVipLevel()-e.getVipLevel()}),t},getAllData:function(){return this._allGifts},getVipPackage:function(t){for(var e in this._allGifts)if(this._allGifts[e].getVipLevel()===t)return this._allGifts[e];return null},getVipPackageByCfgId:function(t){return this._allGifts[t]},_initData:function(){if(!this._allGifts){this._allGifts={};for(var t=td.GetTableClass(td.TableEnum.VipGiftTable).getAllData(),e=0,i=t.length-1;e<=i;e++){var n=t[e];if(n){var r=new a;r.initData(n),this._allGifts[r.getId()]=r}}}},requestBaseInfo:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.GET_VIP_GIFT_BAG,td.ServerDelegate.sendMessage(e)},receiveBaseInfo:function(t,e){if(t===td.NetCode.SUCCESS){this._initData();for(var i=this._allGifts,n=e.receives,a=0;a<n.length;a++){var r=i[n[a]];r&&r.setState(td.ActivityEnum.VipGiftEnum.ALREADY_BUY)}td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_VIP_PACKAGE)}},requestExchange:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.EXCHANGE_VIP_PACKET,e.configId=t||0,td.ServerDelegate.sendMessage(e)},exchangeReturn:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.configId;this._allGifts[i]&&this._allGifts[i].setState(td.ActivityEnum.VipGiftEnum.ALREADY_BUY),td.EventUtil.dispatchEvent(td.EventNameEnum.BUY_VIP_PACKAGE_SUCCESS,i)}},hasRedPoint:function(){return!0},redPointTip:function(){var t=this._allGifts;if(!t||0===t.myLen())return!1;var e=td.Account.getUserData();if(!e)return!1;var i=e.vip,n=td.ActivityEnum.VipGiftEnum.ALREADY_BUY;for(var a in t){if(i>=parseInt(a)-1&&t[a].getState()!==n)return!0}return!1},redPointEvts:function(){return td.RedPointUtil.vipGiftEvents()},isRedPointTip:function(){return td.RedPointUtil.isVipGiftTip()}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",VipGiftModel:"VipGiftModel"}],VipGiftListView:[function(t,e,i){"use strict";cc._RF.push(e,"1ea224mZtxCJrCF7mqInEjZ","VipGiftListView");var n=t("BaseScrollView"),a=cc.Class({extends:n,properties:{},setData:function(t){this._super(t)},setItemView:function(t,e){var i=t.getChildByName("labVip"),n=t.getChildByName("labOldPrice"),a=t.getChildByName("btnOperation").getChildByName("labNewPrice"),r=t.getChildByName("rewardsPanel"),o=e.getVipLevel(),s=e.getPrice().getCount(),l=e.getActPrice().getCount();i.getComponent(cc.Label).string=o,n.getComponent(cc.Label).string=s,a.getComponent(cc.Label).string=l;for(var c=e.getRewards(),u=r.getChildren(),d=0;d<u.length;d++)u[d].active=!1;for(d=0;d<c.length;d++){var h=c[d];if(h){var p;if(p=r.getChildByName("Reward"+d))p.getComponent("CommonIconWidget").setData(h);else(p=td.GlobalFunction.createCommonIconWidget(26,h)).name="Reward"+d,p.setPosition(cc.v2(50+(5+.7*p.getContentSize().width)*d,55)),p.setScale(.7),r.addChild(p);p.active=!0}}return this._setBtn(t,e),t},_setBtn:function(t,e){var i=t.getChildByName("btnOperation"),n=i.getComponent(cc.Button),a=i.getChildByName("imgDiamond"),r=i.getChildByName("labNewPrice"),o=i.getChildByName("labBought");o.getComponent(cc.Label).string=td.Language.bought;var s=e.getState();if(a.active=s!==td.ActivityEnum.VipGiftEnum.ALREADY_BUY,r.active=s!==td.ActivityEnum.VipGiftEnum.ALREADY_BUY,o.active=s===td.ActivityEnum.VipGiftEnum.ALREADY_BUY,e.getState()===td.ActivityEnum.VipGiftEnum.CAN_BUY){n.interactable=!0,n.clickEvents=[];var l=td.GlobalFunction.createClickEventHandler(this,"VipGiftListView","onBuy",e);n.clickEvents.push(l)}else n.interactable=!1},onBuy:function(t,e){if(td.GamerResourceUtil.checkResource(e.getActPrice().getId(),e.getActPrice().getCount()))td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_EXCHANGE_VIP_PACKET,e.getId());else{var i=new td.BroadcastContent(23);i.setOkCallFunc(function(){td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityFixed,td.ActivityEnum.ActivityType.VipPackage])}.bind(this)),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}}});e.exports=a,cc._RF.pop()},{BaseScrollView:void 0}],VipGiftModel:[function(t,e,i){"use strict";cc._RF.push(e,"3e93cEdhvJNh5FD/WcCCwX4","VipGiftModel");var n=cc.Class({properties:{_id:null,_price:null,_actPrice:null,_reward:null,_showReward:null,_vipLevel:null,_status:null},initData:function(t){t&&(this._id=t.id,this._price=td.RewardManager.parseRewardListDetail(t.price)[0],this._actPrice=td.RewardManager.parseRewardListDetail(t.actPrice)[0],this._reward=td.RewardManager.parseRewardListDetail(t.reward),this._showReward=this._getShowRewardList(t.reward),this._vipLevel=t.vipLevel,this._status=td.ActivityEnum.VipGiftEnum.CAN_NOT_BUY)},getId:function(){return this._id},getVipLevel:function(){return this._vipLevel},getPrice:function(){return this._price},getActPrice:function(){return this._actPrice},getRewards:function(){return this._reward},getShowReward:function(){return this._showReward},setState:function(t){this._status=t},getState:function(){var t=td.ActivityEnum.VipGiftEnum;return this._status!==t.ALREADY_BUY?td.Account.getUserData().vip>=this._vipLevel?t.CAN_BUY:t.CAN_NOT_BUY:this._status},_getShowRewardList:function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],a={};a.type=n[0],a.id=n[1],a.count=n[2],e[e.length]=a}return e=td.RewardManager.convertCfgType2GoodsType(e)}});e.exports=n,cc._RF.pop()},{}],VipGiftPanel:[function(t,e,i){"use strict";cc._RF.push(e,"3c1b8CWtGpCPILZXqPwO7Cg","VipGiftPanel");var n=t("ActivityBasePanel"),a=cc.Class({extends:n,properties:{_listViewLogic:null},initData:function(t){this._super(t)},onLoad:function(){var t=this.node.getChildByName("itemWidget").getChildByName("scrollView");this._listViewLogic=t.getComponent("VipGiftListView")},onEnable:function(){this._super(),this._addLocalListeners(),this.refreshListView()},onDisable:function(){this._super(),this._removeAllListeners()},_addLocalListeners:function(){var t=[];t[td.EventNameEnum.BUY_VIP_PACKAGE_SUCCESS]=this.onBuySuccess,t[td.EventNameEnum.REFRESH_VIP_PACKAGE]=this.refreshListView,td.EventUtil.registerEvents(t,this)},_removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},refreshListView:function(){this._listViewLogic.removeAllItems();var t=this._controller.getSortedData();this._listViewLogic.setData(t)},onBuySuccess:function(t){var e=this._controller.getVipPackageByCfgId(t).getShowReward();td.GlobalFunction.showRewards(e)}});e.exports=a,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel"}],VipGiftTable:[function(t,e,i){"use strict";cc._RF.push(e,"61c84oup4VKr5UbSWA8h1FH","VipGiftTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"VipGiftTable",properties:{_tblName:"vip_bag_config",_data:null,_vipData:null},init:function(){this._data=[];var t=this._data;this._vipData={};for(var e=this._vipData,i=this._jsonData,n=0,a=i.length;n<a;n++)t[n]=i[n],e[i[n].vipLevel]=i[n];t.sort(function(t,e){return t.vipLevel-e.vipLevel})},getAllData:function(){return this._data},getObjectByVipLevel:function(t){return this._vipData[t]}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],VipManager:[function(t,e,i){"use strict";cc._RF.push(e,"6cf4arsRdxFZa2PZ/pXvcbS","VipManager"),td.VipManager={_maxVipLevel:null,init:function(){this.destroyData()},destroyData:function(){return this._maxVipLevel=null},getMaxVipLevel:function(){return this._maxVipLevel?this._maxVipLevel:(this._maxVipLevel=td.GetTableClass(td.TableEnum.VipTable).getMaxVipLevel(),this._maxVipLevel)},getVipCurrentLevelRechargeMoney:function(t){var e=this.getMaxVipLevel();return 0==t||t>e?0:td.GetTableClass(td.TableEnum.VipTable).getVipRechargeByVipLevel(t)}},cc._RF.pop()},{}],VipPrivilegeController:[function(t,e,i){"use strict";cc._RF.push(e,"ef5e4rYaSNCM5Jo01owQBm9","VipPrivilegeController");var n=t("ActivityBaseController"),a=cc.Class({extends:n,properties:{_buyList:null,_curIndex:null},initData:function(t){this._super(t),this.init()},init:function(){this._buyList=[],this._curIndex=0,this._addListener(),this._addEventListener()},_addListener:function(){var t=td.MsgModuleName.ExtensionCmd,e=td.MsgCmd.ExtensionCmd,i=td.ServerDelegate;i.registerMessage(t,e.GET_VIP_GIFT_BAG,this.receiveBaseInfo.bind(this)),i.registerMessage(t,e.BUY_VIP_GIFT_BAG,this.exchangeReturn.bind(this)),i.registerMessage(t,e.PUSH_GIFT_BAG,this.pushBaseInfo.bind(this))},_addEventListener:function(){var t={},e=td.EventNameEnum;t[e.REQUEST_VIP_BAG_INFO]=this.requestBaseInfo.bind(this),t[e.REQUEST_EXCHANGE_VIP_BAG]=this.requestExchange.bind(this),td.EventUtil.registerEvents(t,this)},removeAllListeners:function(){td.EventUtil.unregisterAllEvents(this)},destroyData:function(){this._buyList=null,this._curIndex=null,this.removeAllListeners()},requestBaseInfo:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.GET_VIP_GIFT_BAG,td.ServerDelegate.sendMessage(e)},receiveBaseInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.receives;this._buyList=[];for(var n=0;n<i.length;n++)this._buyList.push(i[n]);this._curIndex=0;for(var a=td.GetTableClass(td.TableEnum.VipGiftTable).getAllData(),r=0;r<a.length;r++)if(-1==this._buyList.indexOf(a[r].id)){this._curIndex=a[r].id;break}this._curIndex||(this._curIndex=a[a.length-1].id),td.EventUtil.dispatchEvent(td.EventNameEnum.GET_REQUEST_VIP_BAG_INFO)}},pushBaseInfo:function(t,e){if(t===td.NetCode.SUCCESS){var i=e.receives;this._buyList=[];for(var n=0;n<i.length;n++)this._buyList.push(i[n]);td.EventUtil.dispatchEvent(td.EventNameEnum.REFRESH_VIP_BAG_INFO)}},getListData:function(){return this._buyList},getCurIndex:function(){return this._curIndex},requestExchange:function(t){var e={};e.module=td.MsgModuleName.ExtensionCmd,e.cmd=td.MsgCmd.ExtensionCmd.BUY_VIP_GIFT_BAG,e.configId=t||0,td.ServerDelegate.sendMessage(e)},exchangeReturn:function(t,e){t===td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.BUY_VIP_BAG_SUCCESS)},hasRedPoint:function(){return!0},redPointTip:function(){var t=td.GetTableClass(td.TableEnum.VipGiftTable).getAllData(),e=td.Account.getUserData().getVip();if(!this._buyList)return!1;for(var i=0,n=t.length;i<n;i++){var a=t[i],r=-1!=this._buyList.indexOf(a.vipLevel+1);if(e>=a.vipLevel&&!r)return!0}return!1},redPointEvts:function(){return[td.EventNameEnum.GET_REQUEST_VIP_BAG_INFO,td.EventNameEnum.BUY_VIP_BAG_SUCCESS,td.EventNameEnum.REFRESH_VIP_BAG_INFO]},isRedPointTip:function(){return this.redPointTip()}});e.exports=a,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController"}],VipPrivilegePanel:[function(t,e,i){"use strict";cc._RF.push(e,"0dc486XX2RBMKQe22R7poLr","VipPrivilegePanel");var n=t("ActivityBasePanel"),a=t("HeroModel"),r=t("EquipModel"),o=t("TreasureModel"),s=t("ItemModel"),l=t("GemstoneModel"),c=cc.Class({extends:n,properties:{_controller:null,_curId:0},initData:function(t){this._super(t)},onLoad:function(){this._controller=td.ActivityDataManager.getActivityControllerByType(td.ActivityEnum.ActivityType.VipPrivilege)},onEnable:function(){this._super(),td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_VIP_BAG_INFO),this._addLocalListeners()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_addLocalListeners:function(){var t=[];t[td.EventNameEnum.BUY_VIP_BAG_SUCCESS]=this.onBuySuccess,t[td.EventNameEnum.GET_REQUEST_VIP_BAG_INFO]=this._initData,t[td.EventNameEnum.REFRESH_VIP_BAG_INFO]=this._initUi,td.EventUtil.registerEvents(t,this)},_initData:function(){this._curId=this._controller.getCurIndex(),this._initUi()},_initUi:function(){var t=this.node.getChildByName("topNode"),e=t.getChildByName("richTips"),i=t.getChildByName("labVip"),n=t.getChildByName("progressBar"),c=t.getChildByName("labProgress"),u=td.Account.getUserData().getVip(),d=td.Account.getUserData().getRechargeForShow(),h=td.GetTableClass(td.TableEnum.VipTable).getVipRechargeByVipLevel(u+1);i.getComponent(cc.Label).string=u,h?(e.getComponent(cc.RichText).string=cc.js.formatStr(td.Language.vipRechargeTips,h-d,u+1),e.active=!0,n.getComponent(cc.ProgressBar).progress=d/h,c.getComponent(cc.Label).string=d+"/"+h):(e.active=!1,n.getComponent(cc.ProgressBar).progress=100,c.getComponent(cc.Label).string=d);var p=td.GetTableClass(td.TableEnum.VipGiftTable).getObjectByVipLevel(this._curId-1),_=this.node.getChildByName("model");_.removeAllChildren();var g=p.reward[0],f=new cc.Node;if(g[0]==td.RewardType.Mercenary)(v=new a).init(td.GetTableClass(td.TableEnum.HeroTable).getHeroById(g[1])),td.GlobalFunction.showMercenaryFigureAnimation(f,v,!0),f.setScale(1.3);else if(g[0]==td.RewardType.Treasure){(v=new o).init(td.GetTableClass(td.TableEnum.TreasureTable).getTreasureById(g[1])),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_baowu,v.getPic(),f)}else if(g[0]==td.RewardType.Equipment){(v=new r).init(td.GetTableClass(td.TableEnum.EquipmentTable).getDataById(g[1])),td.GlobalFunction.createBigEquipImg(f,v)}else if(g[0]==td.RewardType.Item){(v=new s).init(td.GetTableClass(td.TableEnum.Item).getItemById(g[1])),td.GlobalFunction.createAltasSprite(td.resDef.pngPlist.icon_viplibao,v.getBigIconResPath(),f)}else if(g[0]==td.RewardType.Gemstone){var v;(v=new l).init(td.GetTableClass(td.TableEnum.GemstoneTable).getGemstoneById(g[1])),td.GlobalFunction.createBigGemstoneIcon(v,f),f.y=140}f.setAnchorPoint(cc.v2(.5,0)),_.addChild(f);var m=this.node.getChildByName("animaNode"),y=null;if(m){if(!(y=m.getChildByName("VIP_effect"))){var E=gdk.rm.getResByUrl("uiAnima/VIP_pingzhi/VIP_pingzhi",cc.Prefab);(y=cc.instantiate(E)).name="VIP_effect",m.addChild(y,1e3)}y.active=!0,y.scale=1;var T=y.getComponent(cc.Animation);T.play(T.defaultClip.name)}var C=this.node.getChildByName("bottomNode"),R=C.getChildByName("rewardPanel");R.removeAllChildren();for(var S=td.RewardManager.parseRewardListDetail(p.reward),I=50,A=0;A<S.length;A++){var b=S[A],P=td.GlobalFunction.createCommonIconWidget(57,b);P&&(P.setScale(.9),P.setPosition(cc.v2(I,10)),R.addChild(P),I+=130)}var N=this.node.getChildByName("labName");N.getComponent(cc.Label).string=S[0].getName(),td.GlobalFunction.setNameColors(N,S[0].getQuality()),C.getChildByName("labVip").getComponent(cc.Label).string=this._curId-1,C.getChildByName("labOri").getComponent(cc.Label).string=p.price[0][2],C.getChildByName("labCur").getComponent(cc.Label).string=p.actPrice[0][2];var M=this._controller.getListData(),L=C.getChildByName("btnBuy"),D=!1;-1!=M.indexOf(this._curId)&&(D=!0),td.GlobalFunction.setButtonGray(L,D);var B=u>=this._curId-1;L.getChildByName("Label").getComponent(cc.Label).string=D?td.Language.bought:B?td.Language.buyspace:td.Language.recharge;u=td.Account.getUserData().getVip();td.RedPointUtil.createRedPointSimple(L,{x:-10,y:-10},B&&!D),this.node.getChildByName("btnLeft").active=this._curId-1!=0;var w=this.node.getChildByName("btnRight"),O=(p=td.GetTableClass(td.TableEnum.VipTable).getVipDataByVipLevel(u)).maxViewVipLevel;w.active=this._curId<=O},onClickBtnLeft:function(){this._curId>1&&(this._curId--,this._initUi())},onClickBtnRight:function(){var t=td.GetTableClass(td.TableEnum.VipGiftTable).getAllData().length;this._curId<t&&(this._curId++,this._initUi())},gotoRecharge:function(){td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityVip,td.ActivityEnum.ActivityType.VipPrivilege])},onBuyRequest:function(){td.Account.getUserData().getVip()<this._curId-1?td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityVip,td.ActivityEnum.ActivityType.VipPrivilege]):td.Account.getUserData().getDiamond()<td.GetTableClass(td.TableEnum.VipGiftTable).getObjectByVipLevel(this._curId-1).actPrice[0][2]?this.showNotEnoughTip():td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_EXCHANGE_VIP_BAG,this._curId)},showNotEnoughTip:function(){var t=td.GlobalFunction.getGoodsData(td.GoodsType.Type_Item,td.ItemEnum.Diamond).getName(),e=[cc.js.formatStr(td.Language.noEnoughToGetTip,t)],i={};i.strArray=e,i.okCallFunc=this.gotoRecharge.bind(this),i.strBtnYes=td.Language.goto,i.strBtnNo=td.Language.cancel,td.GlobalFunction.showConfirmWindow(i)},openVipPrivilege:function(){td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_VipPrivilege,this._curId-1)},onBuySuccess:function(){var t=td.GetTableClass(td.TableEnum.VipGiftTable).getObjectByVipLevel(this._curId-1),e=this._getShowRewardList(t.reward);td.GlobalFunction.showRewards(e)},_getShowRewardList:function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],a={};a.type=n[0],a.id=n[1],a.count=n[2],e[e.length]=a}return e=td.RewardManager.convertCfgType2GoodsType(e)}});e.exports=c,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",EquipModel:"EquipModel",GemstoneModel:"GemstoneModel",HeroModel:"HeroModel",ItemModel:"ItemModel",TreasureModel:"TreasureModel"}],VipPrivilegeTable:[function(t,e,i){"use strict";cc._RF.push(e,"e9a89mC1rZOabDsW85FDABg","VipPrivilegeTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"VipPrivilegeTable",properties:{_tblName:"prerogative_config",_data:null,_idData:null,_typeData:null},init:function(){this._idData={},this._data={},this._typeData={};for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e],a=n.id,r=n.type,o=n.privilegeType,s=n.privilegeOpenValue;this._data[r]=this._data[r]||{},this._data[r][s]=n,this._idData[a]=n,this._typeData[r]=this._typeData[r]||{},this._typeData[r][o]=this._typeData[r][o]||[],this._typeData[r][o].push(n)}},getDataById:function(t){return this._idData[t]},getData:function(){return this._data},getPrerogativeByTypeAndOpenValue:function(t,e){return this._data&&this._data[t]?void 0!==e&&this._data[t][e]?this._data[t][e]:this._data[t]:null},getPrerogativeValueByTypeAdnValue:function(t,e){for(var i=e;i>=0;i--){var n=this._data[t][i];if(n)return n.value}return 0},getTypeData:function(t,e){return e=e||1,this._typeData&&this._typeData[t]&&this._typeData[t][e]?this._typeData[t][e]:null}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],VipPrivilegeWindow:[function(t,e,i){"use strict";cc._RF.push(e,"1d88f5Qil9NVpijKsux3JBn","VipPrivilegeWindow");var n=t("PanelBase"),a=cc.Class({extends:n,properties:{labTitle:cc.Label,contentSV:cc.Node,richText:cc.RichText},init:function(){this._panelType=td.PanelType.Window,this._panelEnum=td.PanelEnum.Window_VipPrivilege},setData:function(t){this.setInfo(t),this.labTitle.string=cc.js.formatStr(td.Language.vipPrivilege,t)},setInfo:function(t){var e=td.GetTableClass(td.TableEnum.VipDesTable).getDataByLevel(t).desc;if(e&&""!==e){var i=td.GlobalFunction.getRichText(e);this.richText.string=i,this.contentSV.height=this.richText.node.height}},clickBgListener:function(){this.closeCallFunc()}});e.exports=a,cc._RF.pop()},{PanelBase:void 0}],VipShopBuyWindow:[function(t,e,i){"use strict";cc._RF.push(e,"37910LJPcNOpq5TukIpIwZC","VipShopBuyWindow");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemName=null,e.img_icon=null,e.progressBar=null,e.sliderBar=null,e.lab_vigor=null,e.operateCountLabel=null,e._operateNum=0,e._limitNum=0,e._value=0,e}return n(e,t),e.prototype.init=function(){this._panelType=r.PanelType.Window,this._panelEnum=r.PanelEnum.Window_VipShopBuy},e.prototype.onEnable=function(){t.prototype.onEnable.call(this),this._addEventListener(),this.sliderBar.node.on("slide",this.onSliderChange,this)},e.prototype.onDisable=function(){r.EventUtil.unregisterAllEvents(this),t.prototype.onDisable.call(this),this._itemData=null},e.prototype._addEventListener=function(){var t={};t[r.EventNameEnum.RES_HERO_RUNE_DECOMPOSE]=this.closeCallFunc,r.EventUtil.registerEvents(t,this)},e.prototype.setData=function(e){t.prototype.setData.call(this,e),this._activityType=e.activityType,this._itemData=e.item,this._limitNum=e.max,this._operateNum=1,this._refreshBaseInfo(),this._updateProgress()},e.prototype._refreshBaseInfo=function(){var t=this._itemData.getRewards();this._productId=this._itemData.getId();var e=r.RewardManager.getRewardDetail(t[0]);this.itemName.getComponent(cc.Label).string=e.getName(),r.GlobalFunction.setNameColors(this.itemName,e.getQuality());var i=this.node.getChildByName("itemIcon");i?i.getComponent("CommonIconWidget").setData(e):((i=r.GlobalFunction.createCommonIconWidget(26,e)).name="itemIcon",this.node.addChild(i),i.position=cc.v2(-205,205),i.getComponent("CommonIconWidget").disableHeadTouch());var n=this._itemData.getCost();this._priceModel=r.RewardManager.getRewardDetail(n),r.GlobalFunction.createAltasSprite(r.resDef.pngPlist.icon_item,this._priceModel.getLittleIconResPath(),this.img_icon)},e.prototype._updateProgress=function(){var t=this._itemData.getCost();this._value=t[2]*this._operateNum,this.operateCountLabel.string=cc.js.formatStr("%s/%s",this._operateNum,this._limitNum),this.lab_vigor.string=this._value+"",this._priceModel=r.RewardManager.getRewardDetail(t);var e=this._priceModel.getId();r.ItemManager.getItemNumById(e)>=this._value?this.lab_vigor.node.color=cc.color(103,111,163):this.lab_vigor.node.color=cc.color(251,6,6);var i=this._operateNum/this._limitNum;this.progressBar.progress=i,this.sliderBar.progress=i},e.prototype.onSliderChange=function(t){var e=t.progress;this._operateNum=Math.floor(this._limitNum*e),this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onOperateNum=function(t,e){e=parseInt(e),this._operateNum+=e,this._operateNum<1?this._operateNum=1:this._operateNum>this._limitNum&&(this._operateNum=this._limitNum),this._updateProgress()},e.prototype.onBtn=function(){var t=this._priceModel.getId();if(r.ItemManager.getItemNumById(t)>=this._value){var e=r.ActivityDataManager.getActivityControllerByType(this._activityType);if(!e)return;var i={};i.id=this._productId,i.parmeterMap={6:this._operateNum},e.operateActivity(i),this.closeCallFunc()}else{var n=new r.BroadcastContent(77),a=new r.BroadcastParam(this._priceModel.getName());n.setMainParam([a]),r.EventUtil.dispatchEvent(r.EventNameEnum.SHOW_BROADCAST,n)}},a([l(cc.Node)],e.prototype,"itemName",void 0),a([l(cc.Node)],e.prototype,"img_icon",void 0),a([l(cc.ProgressBar)],e.prototype,"progressBar",void 0),a([l(cc.Slider)],e.prototype,"sliderBar",void 0),a([l(cc.Label)],e.prototype,"lab_vigor",void 0),a([l(cc.Label)],e.prototype,"operateCountLabel",void 0),e=a([s],e)}(t("PanelBase"));i.default=c,cc._RF.pop()},{PanelBase:void 0}],VipShopController1003:[function(t,e,i){"use strict";cc._RF.push(e,"b351bIobRlC6JdEcmwLWZYL","VipShopController1003");var n=t("VipShopController"),a=cc.Class({extends:n});e.exports=a,cc._RF.pop()},{VipShopController:"VipShopController"}],VipShopController:[function(t,e,i){"use strict";cc._RF.push(e,"b506cGwP3hO+6cp/EMIRD1e","VipShopController");var n=t("ActivityBaseController"),a=t("VipShopModel"),r=cc.Class({extends:n,properties:{_goodsList:null,_index:null},initData:function(t){this._super(t),this._goodsList=null,this._initData()},activityParse:function(t){var e=t.record.products;for(var i in e){var n=this._goodsList[i];n||console.error("can not find goods for id:"+i),n.setBuyCount(e[i])}td.EventUtil.dispatchEvent(td.EventNameEnum.VIPSHOP_GOODS_CHANGE)},destroyData:function(){this._goodsList=null,this.removeAllListeners()},getSelectIndex:function(){return this._index},setSelectIndex:function(t){this._index=t},getGoodsList:function(){var t=[];for(var e in this._goodsList)t.push(this._goodsList[e]);return t},getGoodsByCfgId:function(t){return this._goodsList[t]},_initData:function(){if(!this._goodsList){this._goodsList={};for(var t=td.GetTableClass(td.TableEnum.LimitedTimeStoreTable).getDatasOfDataId(this._activityData),e=0,i=t.length-1;e<=i;e++){var n=t[e];if(n){var r=new a;r.initData(n),this._goodsList[r.getId()]=r}}}}});e.exports=r,cc._RF.pop()},{ActivityBaseController:"ActivityBaseController",VipShopModel:"VipShopModel"}],VipShopListView:[function(t,e,i){"use strict";cc._RF.push(e,"bdc5dZxyZJEGbkTIbbudv++","VipShopListView");var n=t("ListItem"),a=cc.Class({extends:n,properties:{_data:null,_index:null},updateItem:function(t,e){this._super(t,e),this._index=t;var i=this.node,n=i.getChildByName("title"),a=n.getChildByName("labLevel"),r=n.getChildByName("imgGift"),o=i.getChildByName("icon"),s=i.getChildByName("imgOri"),l=i.getChildByName("imgCur"),c=i.getChildByName("labOri"),u=i.getChildByName("labCur"),d=i.getChildByName("labTimes"),h=i.getChildByName("imgDiscount"),p=h.getChildByName("labDiscount"),_=i.getChildByName("btn"),g=e.getVipLevel();a.getComponent(cc.Label).string=g,r.x=a.width+a.x+8;var f=e.getRewards(),v=td.RewardManager.getRewardDetail(f[0]),m=td.GlobalFunction.createCommonIconWidget(26,v);m&&(m.setPosition(cc.v2(0,0)),o.addChild(m));var y=e.getCost(),E=e.getDiscount(),T=new td.Item;T.init(td.GetTableClass(td.TableEnum.Item).getItemById(y[1])),td.GlobalFunction.createSpriteNode(s,T.getLittleIconRes()),td.GlobalFunction.createSpriteNode(l,T.getLittleIconRes()),c.getComponent(cc.Label).string=Math.floor(y[2]/E*10),u.getComponent(cc.Label).string=y[2];var C=td.Account.getUserData();C.getVip()>=g?d.getComponent(cc.Label).string=cc.js.formatStr(td.Language.canBuyCount1,e.getCount()):d.getComponent(cc.Label).string=cc.js.formatStr(td.Language.vipCanBuy,g),e.getCount()<=0||C.getVip()<g?gdk.Timer.once(100,this,function(){td.GlobalFunction.setButtonGray(_,!0)}):gdk.Timer.once(100,this,function(){td.GlobalFunction.setButtonGray(_,!1)}),h.active=10!=E,p.getComponent(cc.Label).string=E+td.Language.discount,this._data=e},onDisable:function(){gdk.Timer.clearAll(this)},onBuy:function(){var t=this._data,e=this._customData,i=t.getVipLevel();if(td.Account.getUserData().getVip()<i)return(n=new td.BroadcastContent(206)).setMainParam([new td.BroadcastParam(i)]),void td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,n);if(t.getCount()<=0){var n=new td.BroadcastContent(207);td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,n)}else{var a=t.getCost(),r=a[1],o=td.ItemManager.getItemNumById(r),s=(t.getDiscount(),td.RewardManager.getRewardDetail(a));if(o<Math.floor(a[2])){r==td.ItemEnum.Diamond?((n=new td.BroadcastContent(23)).setOkCallFunc(function(){td.GlobalFunction.inActivityGotoRecharge([td.ActivityEnum.Activity.ActivityVip,e])}.bind(this)),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,n)):s&&((n=new td.BroadcastContent(77)).setMainParam([new td.BroadcastParam(s.getName())]),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,n))}else{var l=td.ActivityDataManager.getActivityControllerByType(e);if(l)if(l.setSelectIndex(this._index),t.getCount()>1){var c={};c.activityType=e,c.item=t,c.max=t.getCount(),td.PanelJumpManager.jumpToPanel(td.PanelEnum.Window_VipShopBuy,c)}else{var u={};u.id=t.getId(),u.parmeterMap={6:1},l.operateActivity(u)}}}}});e.exports=a,cc._RF.pop()},{ListItem:void 0}],VipShopModel:[function(t,e,i){"use strict";cc._RF.push(e,"5aa2036KEZPNrPJVP4wKloa","VipShopModel");var n=cc.Class({properties:{_id:null,_vipLevel:null,_count:null,_rewards:null,_cost:null,_discount:null,_buyCount:null},initData:function(t){this._id=t.id,this._vipLevel=t.vipLevel,this._count=t.count,this._rewards=t.rewards,this._cost=t.cost,this._discount=t.discount},getId:function(){return this._id},getVipLevel:function(){return this._vipLevel},getCount:function(){return this._count-this._buyCount},getBuyCount:function(){return this._buyCount},setBuyCount:function(t){this._buyCount=t},getRewards:function(){return this._rewards},getCost:function(){return this._cost},getDiscount:function(){return this._discount}});e.exports=n,cc._RF.pop()},{}],VipShopPanel:[function(t,e,i){"use strict";cc._RF.push(e,"12ccfL6u+JAe6XyFg0NsP3W","VipShopPanel");var n=t("ActivityBasePanel"),a=t("OptimizeVerticalListView"),r=cc.Class({extends:n,properties:{lab_time:cc.Label},onEnable:function(){this._super(),this._controller.setSelectIndex(0),this._addLocalListeners(),this._refreshList(),this.setActivityTime()},onDisable:function(){td.EventUtil.unregisterAllEvents(this),this._super()},_addLocalListeners:function(){var t=td.EventUtil,e={};e[td.EventNameEnum.VIPSHOP_GOODS_CHANGE]=this._refreshList,t.registerEvents(e,this)},_refreshList:function(){var t=this._controller.getGoodsList(),e=this.node.getComponent(a);e.setCustomData(this._controller.getActivityType()),e.refreshListData(t);var i=this._controller.getSelectIndex();i&&e.scrollToRow(Math.floor(i/2))},setActivityTime:function(){var t=this.getDurationStr();this.lab_time.string=t}});e.exports=r,cc._RF.pop()},{ActivityBasePanel:"ActivityBasePanel",OptimizeVerticalListView:void 0}],VipTable:[function(t,e,i){"use strict";cc._RF.push(e,"b3b27qUOOFFfbQ584cK4tJZ","VipTable");var n=t("BaseTable"),a=cc.Class({extends:n,name:"VipTable",properties:{_tblName:"vip_config",_VipData:null,_maxVipLevel:null},init:function(){this._VipData={},this._maxVipLevel=0;for(var t=this._VipData,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=parseInt(a.vip);a.recharge=a.recharge/10,t[r]=a,this._maxVipLevel<r&&(this._maxVipLevel=r)}},getVipRechargeByVipLevel:function(t){return this._VipData[t]&&this._VipData[t].recharge?this._VipData[t].recharge:0},getVipDataByVipLevel:function(t){return this._VipData[t]?this._VipData[t]:0},getMaxVipLevel:function(){return this._maxVipLevel}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],VipWelfareConfig:[function(t,e,i){"use strict";cc._RF.push(e,"e0597EPPNpCraC10ihMFdmU","VipWelfareConfig");var n=t("BaseTable"),a=cc.Class({extends:n,name:"VipWelfareConfig",properties:{_tblName:"vip_welfare_config",_data:null},init:function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;i++)t[t.length]=e[i]},getAllData:function(){return this._data}});e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],WholeAttendConfig:[function(t,e,i){"use strict";cc._RF.push(e,"4f5acxw9JZC9LswL8BCM8mD","WholeAttendConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="WholeAttendConfig",e._tblName="whole_attend_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getWholeAttendConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],WholeAttendStoreConfig:[function(t,e,i){"use strict";cc._RF.push(e,"8c009m4RphA45L6nfzG4K42","WholeAttendStoreConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="WholeAttendStoreConfig",e._tblName="whole_attend_store_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i],r=a.data;t[r]=t[r]||[],t[r][t[r].length]=a}},e.prototype.getWholeAttendConfigById=function(t){return this._data&&this._data[t]?this._data[t]:[]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],WholeBossConfig:[function(t,e,i){"use strict";cc._RF.push(e,"9c0428a4TdKPasN9T/t9TwM","WholeBossConfig");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="WholeBossConfig",e._tblName="whole_boss_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._data,e=this._jsonData,i=0,n=e.length-1;i<=n;i++){var a=e[i];t[t.length]=a}},e.prototype.getWholeBossConfigs=function(){return this._data},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],WholeBossDamageRecord:[function(t,e,i){"use strict";cc._RF.push(e,"ec72b/9tHVG8af42a6V31d9","WholeBossDamageRecord");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._damage=0,e._time=0,e}return n(e,t),e.prototype.init=function(e,i){void 0===i&&(i="WholeBossDamageRecord"),e&&(t.prototype.init.call(this,i,e.attributes),this._damage=e.damage||0,this._time=e.time||0)},e.prototype.getDamage=function(){return this._damage},e.prototype.getTime=function(){return this._time},e}(t("BaseUser")));e.exports=a,cc._RF.pop()},{BaseUser:"BaseUser"}],WholeBossManager:[function(t,e,i){"use strict";cc._RF.push(e,"b6029hp2yVJ65CbTNopFr0w","WholeBossManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=t("../Enum/WorldBossEnum"),r=cc._decorator.ccclass,o=window.td,s=t("WholeBossModel"),l=t("WholeBossDamageRecord"),c=t("WholeBossRankModel"),u=function(){function t(){this._participateId=0,this._killedBossId=0,this._focusId=0,this._times=0,this._buyTimes=0,this._nextRecoverTime=0,this._isParticipateDouble=!1,this._isDoubleState=!1,this._inspireTimes=0,this._nextChallengeTime=0,this._isAutoBattle=!1,this._isPopFocusTips=!1,this._isFocusTipsDoAction=!0}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.destroyData(),this.addListener(),this.addEventListener()},t.prototype.destroyData=function(){this._participateId=0,this._killedBossId=0,this._focusId=0,this._times=0,this._buyTimes=0,this._nextRecoverTime=0,this._isParticipateDouble=!1,this._isDoubleState=!1,this._inspireTimes=0,this._bossList={},this._firstRecordList=[],this._damageRankList=[],this._myDamageRank=null,this._nextChallengeTime=0,this._isAutoBattle=!1,this._isPopFocusTips=!1,this._isFocusTipsDoAction=!0},t.prototype.addListener=function(){var t=o.MsgModuleName.WHOLE_BOSS,e=o.MsgCmd.WHOLE_BOSS;o.ServerDelegate.registerMessage(t,e.GET_WHOLE_BOSS_INFO,this._parseInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.GET_WHOLE_BOSS_ACTOR,this._parseActorInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.WHOLE_BOSS_FIRST_RECORD,this._onGetFirstRecord.bind(this)),o.ServerDelegate.registerMessage(t,e.WHOLE_BOSS_DAMAGE_RANK,this._onGetDamageRank.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_WHOLE_BOSS_INFO,this._parseInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_WHOLE_BOSS_ACTOR,this._parseActorInfo.bind(this)),o.ServerDelegate.registerMessage(t,e.PUSH_WHOLE_BOSS_DAMAGE_RANK,this._onGetDamageRank.bind(this))},t.prototype.addEventListener=function(){var t=o.EventUtil,e=o.EventNameEnum,i={};i[e.REQ_GET_WHOLE_BOSS_INFO]=this._requestInfo,i[e.REQ_GET_WHOLE_BOSS_ACTOR]=this._requestActorInfo,i[e.REQ_WHOLE_BOSS_PARTICIPATE]=this._requestJoinBattle,i[e.REQ_WHOLE_BOSS_FOCUS]=this._requestFocus,i[e.REQ_WHOLE_BOSS_DOUBLE_STATE]=this._requestSetDoubleState,i[e.REQ_WHOLE_BOSS_BUY_TIMES]=this._requestBuyTimes,i[e.REQ_WHOLE_BOSS_INSPIRE]=this._requestInspire,i[e.REQ_WHOLE_BOSS_CHALLENGE]=this._requestChallenge,i[e.REQ_WHOLE_BOSS_FIRST_RECORD]=this._requestFirstRecord,i[e.REQ_WHOLE_BOSS_DAMAGE_RANK]=this._requestDamageRank,i[e.REQ_WHOLE_BOSS_AUTO_BATTLE]=this._requestAutoBattle,t.registerEvents(i,this)},t.prototype.isBossRedPointTips=function(t){if(!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.WHOLE_BOSS))return!1;if(this._times<=0)return!1;if(0!==this._participateId)return!1;if(!this._bossList||0===this._bossList.myLen())return!1;var e=this._bossList[t];if(!e)return!1;var i=e.getUnlockId();return!!o.UnlockManager.isTargetUnlockById(i)&&e.getState()===a.WholeBossState.BATTLE},t.prototype.isWholeBossRedPoint=function(){if(!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.WHOLE_BOSS))return!1;if(this._times<=0)return!1;if(0!==this._participateId)return!1;if(!this._bossList||0===this._bossList.myLen())return!1;for(var t in this._bossList){var e=this._bossList[t],i=e.getUnlockId();if(e.getState()===a.WholeBossState.BATTLE&&o.UnlockManager.isTargetUnlockById(i))return!0}return!1},t.prototype.isWholeBossRedPoint1=function(){if(!o.UnlockManager.isTargetUnlock(o.ActorUnlockType.WHOLE_BOSS))return!1;if(this._times<=0)return!1;if(0!==this._participateId)return!1;if(!this._bossList||0===this._bossList.myLen())return!1;if(0===this._focusId)return!1;var t=this._bossList[this._focusId],e=t.getUnlockId();return!(t.getState()!==a.WholeBossState.BATTLE||!o.UnlockManager.isTargetUnlockById(e))},t.prototype.bossRedPointEvts=function(){return[o.EventNameEnum.ON_GET_WHOLE_BOSS_INFO,o.EventNameEnum.ON_WHOLE_BOSS_PARTICIPATE_CHANGED,o.EventNameEnum.ON_GET_WHOLE_BOSS_ACTOR]},t.prototype.getBossList=function(){return this._bossList},t.prototype.getBossDataById=function(t){return this._bossList&&this._bossList[t]?this._bossList[t]:null},t.prototype.getShowBossList=function(){var t=[];if(!this._bossList||0===this._bossList.myLen())return t;for(var e in this._bossList)t[t.length]=this._bossList[e];return t},t.prototype.getNextRecoverTime=function(){return this._nextRecoverTime},t.prototype.getLeftChallengeTimes=function(){return this._times},t.prototype.getBuyTimes=function(){return this._buyTimes},t.prototype.getBuyTimesCost=function(t){for(var e,i=o.GlobalFunction,n=this._buyTimes,a=1+n;a<=t+n;a++)e?e.setCount(e.getCount()+i.getShareConfigUpCostCount("WHOLE_BOSS_BUY_TIMES_COST",a)):e=i.getShareConfigUpCostDetail("WHOLE_BOSS_BUY_TIMES_COST",a);return e},t.prototype.IsParticipateDouble=function(){return this._isParticipateDouble},t.prototype.getDoubleState=function(){return this._isDoubleState},t.prototype.getFocusId=function(){return this._focusId},t.prototype.getParticipateId=function(){return this._participateId},t.prototype.getParticipateBoss=function(){return this._bossList&&this._bossList[this._participateId]?this._bossList[this._participateId]:null},t.prototype.getShowBoss=function(){var t=0;return 0!==this._killedBossId?(t=this._killedBossId,this._killedBossId=0):t=this._participateId,this._bossList&&this._bossList[t]?this._bossList[t]:null},t.prototype.getDamageRankList=function(){return this._damageRankList},t.prototype.getMyDamageRank=function(){return this._myDamageRank},t.prototype.getInspireTimes=function(){return this._inspireTimes},t.prototype.getNextChallengeTime=function(){return this._nextChallengeTime},t.prototype.isAutoBattle=function(){return this._isAutoBattle},t.prototype.getFirstRecordList=function(){return this._firstRecordList},t.prototype.isFoucsParticipatedBoss=function(){return!!this._participateId&&this._focusId===this._participateId},t.prototype.setIsPopFocusTips=function(t){this._isPopFocusTips=t},t.prototype.isShowMainEnterTips=function(){if(!this._focusId)return!1;var t=this._bossList[this._focusId];return!(!t||t.getState()!==a.WholeBossState.BATTLE||this._isPopFocusTips)},t.prototype.isShowHomePageBtnAnim=function(){var t=this._isFocusTipsDoAction;return this._isFocusTipsDoAction=!1,t},t.prototype._requestInfo=function(){var t={};t.module=o.MsgModuleName.WHOLE_BOSS,t.cmd=o.MsgCmd.WHOLE_BOSS.GET_WHOLE_BOSS_INFO,o.ServerDelegate.sendMessage(t)},t.prototype._parseInfo=function(t,e){if(t===o.NetCode.SUCCESS){this._bossList&&0!==this._bossList.myLen()||this._initBossList();for(var i=this._bossList,n=e.bossList,a=[],r=0,s=n.length;r<s;r++){var l=n[r],c=l.id;a[a.length]=c;var u=i[c];u?u.updateServerData(l):cc.log("!!!!!!!!!!can find whole boss data for id = "+c)}o.EventUtil.dispatchEvent(o.EventNameEnum.ON_GET_WHOLE_BOSS_INFO,a)}},t.prototype._requestActorInfo=function(){var t={};t.module=o.MsgModuleName.WHOLE_BOSS,t.cmd=o.MsgCmd.WHOLE_BOSS.GET_WHOLE_BOSS_ACTOR,o.ServerDelegate.sendMessage(t)},t.prototype._parseActorInfo=function(t,e){if(t===o.NetCode.SUCCESS){if(void 0!==e.participateId&&(0!==e.participateId&&this._participateId!==e.participateId&&(this._killedBossId=0,o.EventUtil.dispatchEvent(o.EventNameEnum.ON_WHOLE_BOSS_PARTICIPATE_CHANGED,e.participateId)),0===e.participateId&&0!==this._participateId&&this._bossList[this._participateId]&&0===this._bossList[this._participateId].getLeftHp()&&(this._killedBossId=this._participateId),this._participateId=e.participateId,o.EventUtil.dispatchEvent(o.EventNameEnum.ON_WHOLE_BOSS_PARTICIPATE_UPDATED)),void 0!==e.focusId&&(this._focusId!==e.focusId&&(this._isPopFocusTips=!1,o.EventUtil.dispatchEvent(o.EventNameEnum.ON_WHOLE_BOSS_FOCUS_CHANGED,e.focusId)),this._focusId=e.focusId),void 0!==e.times&&(this._times=e.times),void 0!==e.buyTimes&&(this._buyTimes=e.buyTimes),void 0!==e.nextRecoverTime&&(this._nextRecoverTime=e.nextRecoverTime),void 0!==e.doubleState&&(this._isParticipateDouble=e.doubleState),void 0!==e.participateDouble&&(this._isDoubleState=e.participateDouble),void 0!==e.inspireTimes){var i=this._inspireTimes!==e.inspireTimes;this._inspireTimes=e.inspireTimes,i&&o.EventUtil.dispatchEvent(o.EventNameEnum.ON_WHOLE_BOSS_INSPIRE_CHANGED)}if(void 0!==e.nextChallengeTime){i=this._nextChallengeTime!==e.nextChallengeTime;this._nextChallengeTime=e.nextChallengeTime,i&&o.EventUtil.dispatchEvent(o.EventNameEnum.WHOLE_BOSS_NEXT_CHALLENGE_TIME_CHANGED)}void 0!==e.autoCombat&&(this._isAutoBattle=e.autoCombat,o.EventUtil.dispatchEvent(o.EventNameEnum.ON_WHOLE_BOSS_AUTO_BATTLE_CHANGED)),o.EventUtil.dispatchEvent(o.EventNameEnum.ON_GET_WHOLE_BOSS_ACTOR)}},t.prototype._requestJoinBattle=function(t){var e={};e.module=o.MsgModuleName.WHOLE_BOSS,e.cmd=o.MsgCmd.WHOLE_BOSS.WHOLE_BOSS_PARTICIPATE,e.id=t,o.ServerDelegate.sendMessage(e)},t.prototype._requestFocus=function(t){var e={};e.module=o.MsgModuleName.WHOLE_BOSS,e.cmd=o.MsgCmd.WHOLE_BOSS.WHOLE_BOSS_FOCUS,e.id=t,o.ServerDelegate.sendMessage(e)},t.prototype._requestSetDoubleState=function(t){var e={};e.module=o.MsgModuleName.WHOLE_BOSS,e.cmd=o.MsgCmd.WHOLE_BOSS.WHOLE_BOSS_DOUBLE_STATE,e.state=t,o.ServerDelegate.sendMessage(e)},t.prototype._requestBuyTimes=function(t){var e={};e.module=o.MsgModuleName.WHOLE_BOSS,e.cmd=o.MsgCmd.WHOLE_BOSS.WHOLE_BOSS_BUY_TIMES,e.times=t,o.ServerDelegate.sendMessage(e)},t.prototype._requestInspire=function(){var t=this.getParticipateBoss();if(t&&0!==t.getLeftHp()&&t.getState()!==a.WholeBossState.SLEEP){var e={};e.module=o.MsgModuleName.WHOLE_BOSS,e.cmd=o.MsgCmd.WHOLE_BOSS.WHOLE_BOSS_INSPIRE,o.ServerDelegate.sendMessage(e)}else o.EventUtil.dispatchEvent(o.EventNameEnum.SHOW_BROADCAST,new o.BroadcastContent(303))},t.prototype._requestChallenge=function(){var t={};t.module=o.MsgModuleName.WHOLE_BOSS,t.cmd=o.MsgCmd.WHOLE_BOSS.WHOLE_BOSS_CHALLENGE,o.ServerDelegate.sendMessage(t)},t.prototype._requestAutoBattle=function(t){var e={};e.module=o.MsgModuleName.WHOLE_BOSS,e.cmd=o.MsgCmd.WHOLE_BOSS.WHOLE_BOSS_AUTO_COMBAT,e.state=t,o.ServerDelegate.sendMessage(e)},t.prototype._requestFirstRecord=function(t){var e={};e.module=o.MsgModuleName.WHOLE_BOSS,e.cmd=o.MsgCmd.WHOLE_BOSS.WHOLE_BOSS_FIRST_RECORD,e.id=t,o.ServerDelegate.sendMessage(e)},t.prototype._onGetFirstRecord=function(t,e){if(t===o.NetCode.SUCCESS){var i=e.recordList;this._firstRecordList=[];for(var n=i.length-1;n>=0;n--){var a=i[n],r=new l;r.init(a,"WholeBossFirstRecord"),this._firstRecordList[this._firstRecordList.length]=r}o.EventUtil.dispatchEvent(o.EventNameEnum.ON_WHOLE_BOSS_FIRST_RECORD)}},t.prototype._requestDamageRank=function(t){var e={};e.module=o.MsgModuleName.WHOLE_BOSS,e.cmd=o.MsgCmd.WHOLE_BOSS.WHOLE_BOSS_DAMAGE_RANK,e.id=t,o.ServerDelegate.sendMessage(e)},t.prototype._onGetDamageRank=function(t,e){if(t===o.NetCode.SUCCESS){var i=e.rankList;this._damageRankList=[],i.length>0&&(this._myDamageRank=new c,this._myDamageRank.init(i[i.length-1]),i.splice(i.length-1,1));for(var n=0,a=i.length;n<a;n++){var r=new c;r.init(i[n]),this._damageRankList[this._damageRankList.length]=r}o.EventUtil.dispatchEvent(o.EventNameEnum.ON_WHOLE_BOSS_DAMAGE_RANK)}},t.prototype._initBossList=function(){this._bossList={};for(var t=o.GetTableClass(o.TableEnum.WholeBossConfig).getWholeBossConfigs(),e=0,i=t.length;e<i;e++){var n=t[e],a=new s;a.init(n),this._bossList[a.getId()]=a}},t=e=n([r],t)}();i.default=u,cc._RF.pop()},{"../Enum/WorldBossEnum":"WorldBossEnum",WholeBossDamageRecord:"WholeBossDamageRecord",WholeBossModel:"WholeBossModel",WholeBossRankModel:"WholeBossRankModel"}],WholeBossModel:[function(t,e,i){"use strict";cc._RF.push(e,"f41ae1mCERN7b9SlmH3DEOI","WholeBossModel");var n=window.td,a=t("MonsterModel"),r=t("WholeBossDamageRecord"),o=function(){function t(){this._id=0,this._bossName="",this._unlockId=0,this._bossImg="",this._bossImgGray="",this._bossNameImg="",this._tipsIcon="",this._leftHp=0,this._state=0,this._participateCount=0,this._closeTime=0}return t.prototype.init=function(t){if(t){this._id=t.id,this._bossName=t.bossName,this._unlockId=t.unlockId,this._bossImg=t.bossPic,this._bossImgGray=t.bossPic+"_h",this._bossNameImg=t.namePic,this._tipsIcon=t.tipsIcon,this._firstRewards=[];for(var e=t.firstRewards,i=0,r=e.length;i<r;i++){var o=e[i];this._firstRewards=this._firstRewards.concat(o[0])}this._participateRewards=[];var s=t.participateRewards;for(i=0,r=s.length;i<r;i++){o=s[i];this._participateRewards=this._participateRewards.concat(o[0])}this._monsterData=null;var l=t.monsterId,c=n.GetTableClass(n.TableEnum.Monster).getMonsterDataById(l);c&&(this._monsterData=new a,this._monsterData.init(c)),this.updateRecordTime()}},t.prototype.updateServerData=function(t){if(t&&(void 0!==t.leftHp&&(this._leftHp=t.leftHp),void 0!==t.state&&(this._state=parseInt(t.state)),void 0!==t.participateCount&&(this._participateCount=t.participateCount),void 0!==t.closeTime&&(this._closeTime=t.closeTime),void 0!==t.damageRecordList)){this._damageRecordList=[];for(var e=t.damageRecordList,i=!1,a=0,o=e.length;a<o;a++){var s=e[a];if(s.time>this._startTime){var l=new r;l.init(s),this._damageRecordList[this._damageRecordList.length]=l,this._startTime=l.getTime(),i=!0}}i&&n.EventUtil.dispatchEvent(n.EventNameEnum.WHOLE_BOSS_DAMAGE_RECORD_CHANGED)}},t.prototype.updateRecordTime=function(){this._startTime=n.TimeUtil.getTime()},t.prototype.getId=function(){return this._id},t.prototype.getName=function(){return this._bossName},t.prototype.getUnlockId=function(){return this._unlockId},t.prototype.getState=function(){return this._state},t.prototype.getLeftHp=function(){return this._leftHp},t.prototype.getShowMonster=function(){return this._monsterData},t.prototype.getBossImg=function(){return this._bossImg},t.prototype.getBossImgGray=function(){return this._bossImgGray},t.prototype.getBossNameImg=function(){return this._bossNameImg},t.prototype.getParticipateCount=function(){return this._participateCount},t.prototype.getCloseTime=function(){return this._closeTime},t.prototype.haveRecord=function(){return this._damageRecordList.length>0},t.prototype.popNewRecord=function(){return 0===this._damageRecordList.length?null:this._damageRecordList.pop()},t.prototype.getFirstRewards=function(){return this._firstRewards},t.prototype.getParticipateRewards=function(){return this._participateRewards},t.prototype.getTipsIcon=function(){return this._tipsIcon},t}();e.exports=o,cc._RF.pop()},{MonsterModel:"MonsterModel",WholeBossDamageRecord:"WholeBossDamageRecord"}],WholeBossRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"adad0KczVtA066DcE8AJaAK","WholeBossRankModel");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=(window.td,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._damage=0,e._rank=0,e}return n(e,t),e.prototype.init=function(e,i){void 0===i&&(i="WholeBossRankModel"),e&&(t.prototype.init.call(this,i,e.attributes),this._damage=e.damage||0,this._rank=e.rank||0)},e.prototype.getUserName=function(){return this.nickName},e.prototype.getDamage=function(){return this._damage},e.prototype.getRank=function(){return this._rank},e}(t("BaseUser")));e.exports=a,cc._RF.pop()},{BaseUser:"BaseUser"}],WinRecordsItemUI:[function(t,e,i){"use strict";cc._RF.push(e,"c140aq4DPhMVI1a08Cka/uN","WinRecordsItemUI");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var r=window.td,o=cc._decorator,s=o.ccclass,l=o.property,c=o.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.labPhase=null,e.labInput=null,e.labNum=null,e.nodeItem=null,e}return n(e,t),e.prototype.updateItem=function(e,i){t.prototype.updateItem.call(this,e,i),this.labPhase.string=i.term+"",this.labInput.string=i.betInfo.length+"",this.labNum.string=i.luckNum+"";var n=r.ActivityDataManager.getActivityControllerByType(r.ActivityEnum.ActivityType.ACTIVITY_TYPE_10).getActivityData(),a=r.GetTableClass(r.TableEnum.GoddessBoxTable).getDataByDataAndId(n,parseInt(i.boxId)),o=r.RewardManager.getRewardDetail(a.rewards[0]),s=r.GlobalFunction.createCommonIconWidget(26,o);this.nodeItem.removeAllChildren(),this.nodeItem.addChild(s)},a([l(cc.Label)],e.prototype,"labPhase",void 0),a([l(cc.Label)],e.prototype,"labInput",void 0),a([l(cc.Label)],e.prototype,"labNum",void 0),a([l(cc.Node)],e.prototype,"nodeItem",void 0),e=a([s,c("module/Activity/RareTreasure/WinRecordsItemUI")],e)}(t("ListItem"));i.default=u,cc._RF.pop()},{ListItem:void 0}],WinRecordsLayer:[function(t,e,i){"use strict";cc._RF.push(e,"2280egYOr9OHZomNzIy5TVI","WinRecordsLayer");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});window.td;var r=cc._decorator,o=r.ccclass,s=r.property,l=r.menu,c=t("OptimizeVerticalListView"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.recordScroll=null,e._controller=null,e}return n(e,t),e.prototype.init=function(t){this._controller=t},e.prototype.onEnable=function(){this._recordsListView||(this._recordsListView=this.recordScroll.getComponent(c)),this._initWindow()},e.prototype._initWindow=function(){var t=this._controller.getMyWinRecords();this._recordsListView.setData(t)},a([s(cc.Node)],e.prototype,"recordScroll",void 0),e=a([o,l("module/Activity/RareTreasure/WinRecordsLayer")],e)}(cc.Component);i.default=u,cc._RF.pop()},{OptimizeVerticalListView:void 0}],WithoutBallisticBullet:[function(t,e,i){"use strict";cc._RF.push(e,"0125e3ht/NItpn/RLU5c+tW","WithoutBallisticBullet");var n=t("BaseBullet"),a=t("PveNodePoolManager");cc.Class({extends:n,initData:function(t){this._super(t),this.setRenderWithStatus(td.PveEnum.PVE_BUTTET_STATUS.Bomb),this.node.setPosition(this._curBornPos)},putToNodePool:function(){a.putBulletToPool(this.getBulletId(),this.node)}});cc._RF.pop()},{BaseBullet:"BaseBullet",PveNodePoolManager:"PveNodePoolManager"}],WonderlandConfigTable:[function(t,e,i){"use strict";cc._RF.push(e,"482f2vjXxhFsY8q9AQHGQAC","WonderlandConfigTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="WonderlandConfig",e._tblName="wonderland_config",e._data=[],e}return n(e,t),e.prototype.init=function(){this._data=[],this._copyIds=[];for(var t=this._jsonData,e=0,i=t.length;e<i;++e){var n=t[e];this._data.push(n),this._copyIds.push(n.id)}this._copyIds.sort(function(t,e){return t-e})},e.prototype.getDataById=function(t){if(this._data)for(var e=0;e<this._data.length;e++)if(this._data[e].id===t)return this._data[e];return null},e.prototype.getAllCfgDatas=function(){return this._data},e.prototype.getMinWonderlandId=function(){return this._copyIds.length>0?this._copyIds[0]:null},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],WonderlandCopyModel:[function(t,e,i){"use strict";cc._RF.push(e,"a92ccKxbxtFqqjqWtWiHy+0","WonderlandCopyModel");var n=window.td,a=(t("PropertyModel"),function(){function t(){this._monsterGroupId=0,this._levelLimit=0,this._passRewards=[],this._fixedRewards=[],this._randomRewards=[],this._cfgRandomRewards=[],this._rewardsDisplay=[],this._isPassed=!1}return t.prototype.init=function(t){this._id=t,this._copyStatus=null,this._curHero=null,this._exploreEndTime=null,this._lastCalculateRewardsTime=null;var e=n.GetTableClass(n.TableEnum.WonderlandConfigTable).getDataById(t);if(e){this._monsterGroupId=e.monsterGroupId,this._levelLimit=e.levelLimit,this._passRewards=e.rewards,this._fixedRewards=e.fixedRewards,this._randomRewards=[],this._nextId=e.nextId,this._preId=e.preId,this._iconRes=e.icon,this._nameRes=e.name;var i=n.GetTableClass(n.TableEnum.MonsterGroup).getMonsterGroupById(this._monsterGroupId);this._recommandFightPower=i.power,this._nameTxt=e.nameTxt,this._cfgRandomRewards=e.randomRewards,this._rewardsDisplay=e.rewardDisplay}else this._monsterGroupId=null,this._levelLimit=null,this._passRewards=[],this._fixedRewards=[],this._randomRewards=[],this._nextId=null,this._preId=null,this._iconRes=null,this._nameRes=null,this._recommandFightPower=null,this._nameTxt="",this._cfgRandomRewards=[],this._rewardsDisplay=[]},t.prototype.getId=function(){return this._id},t.prototype.getMonsterGroupId=function(){return this._monsterGroupId},t.prototype.getLevelLimit=function(){return this._levelLimit},t.prototype.getPassRewards=function(){return this._passRewards.concat()},t.prototype.getFixedRewards=function(){return this._fixedRewards.concat()},t.prototype.getCfgRandomRewards=function(){return this._cfgRandomRewards.concat()},t.prototype.getRewardsDisplay=function(){return this._rewardsDisplay.concat()},t.prototype.getNextId=function(){return this._nextId},t.prototype.getPreId=function(){return this._preId},t.prototype.getIconRes=function(){return this._iconRes},t.prototype.getNameRes=function(){return this._nameRes},t.prototype.getRecommndFightPower=function(){return this._recommandFightPower},t.prototype.getNameText=function(){return this._nameTxt},t.prototype.isLevelUnLocked=function(){return n.Account.getUserData().getLevel()>=this._levelLimit},t.prototype.getRandomRewards=function(){return this._randomRewards.concat()},t.prototype.setRandomRewards=function(t){this._randomRewards=t},t.prototype.getCopyStatus=function(){return this._copyStatus},t.prototype.setCopyStatus=function(t){this._copyStatus=t},t.prototype.getCurHero=function(){return this._curHero},t.prototype.setCurHero=function(t){this._curHero=t},t.prototype.getExploreEndTime=function(){return this._exploreEndTime},t.prototype.setExploreEndTime=function(t){this._exploreEndTime=t},t.prototype.getLastCalculateRewardsTime=function(){return this._lastCalculateRewardsTime},t.prototype.setLastCalculateRewardsTime=function(t){this._lastCalculateRewardsTime=t},t.prototype.getIsPassed=function(){return this._isPassed},t.prototype.setPassed=function(t){this._isPassed=t},t}());e.exports=a,cc._RF.pop()},{PropertyModel:"PropertyModel"}],WonderlandManager:[function(t,e,i){"use strict";cc._RF.push(e,"99b7dCdjIVGI7j3aMGWuqqB","WonderlandManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0}),i.WonderlandCopyStatus=void 0;var a=window.td,r=cc._decorator.ccclass,o=t("WonderlandCopyModel"),s=t("CommonEnum"),l=t("../../../TS/Hero/Manager/HeroManager");i.WonderlandCopyStatus={EXPLORING:1,FREE:2,NONE:0};var c=function(){function t(){this._quickExploreTimes=0}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.addListener(),this.addEventListener(),this.destroyData()},t.prototype.destroyData=function(){this._quickExploreTimes=0,this._dataModels=[],this._curCopyId=0,this._exploreHeroIds=[],this._readyExploreHeroIds=[]},t.prototype.addListener=function(){var t=a.MsgModuleName.WonderlandAdventure,e=a.MsgCmd.WonderlandAdventure;a.ServerDelegate.registerMessage(t,e.WONDERLAND_GET_INFO,this.parseWonderlandInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_WONDERLAND_INFO,this.parseWonderlandInfo.bind(this)),a.ServerDelegate.registerMessage(t,e.WONDERLAND_CHALLENGE,this.parseWonderlandChallenge.bind(this)),a.ServerDelegate.registerMessage(t,e.WONDERLAND_ADD_HERO,this.parseWonderlandAddHero.bind(this)),a.ServerDelegate.registerMessage(t,e.WONDERLAND_BEGIN_EXPLORE,this.parseWonderlandExploreResult.bind(this)),a.ServerDelegate.registerMessage(t,e.WONDERLAND_RECEIVE_REWARD,this.parseWonderlandReceiveRewards.bind(this)),a.ServerDelegate.registerMessage(t,e.WONDERLAND_QUICK_EXPLORE,this.parseWonderlandQuickExploreResult.bind(this)),a.ServerDelegate.registerMessage(t,e.PUSH_WONDERLAND_SYSTEM_REWARD,this.parseWonderlandSystemRewards.bind(this)),a.ServerDelegate.registerMessage(t,e.ONE_KEY_RECEIVE_REWARD,this.parseWonderlandReceiveRewards.bind(this))},t.prototype._initData=function(){var t=a.GetTableClass(a.TableEnum.WonderlandConfigTable).getAllCfgDatas();if(this._dataModels=[],t)for(var e=0;e<t.length;e++){var i=t[e],n=new o;n.init(i.id),this._dataModels.push(n)}},t.prototype.parseWonderlandInfo=function(t,e){if(t===a.NetCode.SUCCESS){this._dataModels&&0===this._dataModels.length&&this._initData(),this._exploreHeroIds=[],this._readyExploreHeroIds=[],this._quickExploreTimes=e.times;var i=e.entityMap;if(i)for(var n=0;n<this._dataModels.length;n++){var r=this._dataModels[n];for(var o in i){var s=i[o];if(1===s.state)this._exploreHeroIds.push(s.currHero);else{var l=s.currHero;l&&0!==l&&this._readyExploreHeroIds.push(l)}if(s.wonderlandId===r.getId()){var c=parseInt(s.state);r.setCopyStatus(c),r.setCurHero(s.currHero),r.setPassed(!0),r.setRandomRewards(s.rewards),r.setExploreEndTime(s.endTime),r.setLastCalculateRewardsTime(s.lastRewardAccountTime);break}}}a.EventUtil.dispatchEvent(a.EventNameEnum.WONDERLAND_DATA_CHANGED)}},t.prototype.parseWonderlandChallenge=function(t,e){a.NetCode.SUCCESS},t.prototype.parseWonderlandAddHero=function(t,e){a.NetCode.SUCCESS},t.prototype.parseWonderlandExploreResult=function(t,e){a.NetCode.SUCCESS},t.prototype.parseWonderlandReceiveRewards=function(t,e){if(t===a.NetCode.SUCCESS){var i=a.RewardManager.parseRewardResult(e.rewardResult,!0);a.GlobalFunction.showRewards(i)}},t.prototype.parseWonderlandQuickExploreResult=function(t,e){if(t===a.NetCode.SUCCESS){var i=a.RewardManager.parseRewardResult(e.rewardResult,!0);a.GlobalFunction.showRewards(i)}},t.prototype.parseWonderlandSystemRewards=function(t,e){if(t===a.NetCode.SUCCESS){var i=e.rewardList,n=e.wonderlandId,r=this.getDataByCopyId(n);r&&(r.setRandomRewards(i),a.EventUtil.dispatchEvent(a.EventNameEnum.WONDERLAND_RANDOM_REWARDS_CHANGED))}},t.prototype.addEventListener=function(){var t=a.EventUtil,e=a.EventNameEnum,i={};i[e.REQUEST_WONDERLAND_DATA]=this.onRequestWonderlandInfo,i[e.REQUEST_WONDERLAND_CHALLENGE]=this.onRequestWonderlandChallenge,i[e.REQUEST_WONDERLAND_ADD_HERO]=this.onRequestWonderlandAddHero,i[e.REQUEST_WONDERLAND_EXPLORE]=this.onRequestWonderlandExplore,i[e.REQUEST_WONDERLAND_RECEIVE_REWARDS]=this.onRequestWonderlandReceiveRewards,i[e.REQUEST_WONDERLAND_QUICK_EXPLORE]=this.onRequestWonderlandQuickExplore,i[e.REQ_ONE_KEY_WONDERLAND]=this.onRequestOneKeyExplore,i[e.REQ_ONE_KEY_RECEIVE_REWARD]=this.onRequestOneKeyReward,t.registerEvents(i,this)},t.prototype.onRequestWonderlandInfo=function(t){if(a.UnlockManager.isTargetUnlock(a.ActorUnlockType.WONDERLAND_ADVENTURE,0)){var e={};e.module=a.MsgModuleName.WonderlandAdventure,e.cmd=a.MsgCmd.WonderlandAdventure.WONDERLAND_GET_INFO,a.ServerDelegate.sendMessage(e)}},t.prototype.onRequestWonderlandChallenge=function(t){var e={};e.module=a.MsgModuleName.WonderlandAdventure,e.cmd=a.MsgCmd.WonderlandAdventure.WONDERLAND_CHALLENGE,e.wonderlandId=t.copyId,a.ServerDelegate.sendMessage(e)},t.prototype.onRequestWonderlandAddHero=function(t){var e={};e.module=a.MsgModuleName.WonderlandAdventure,e.cmd=a.MsgCmd.WonderlandAdventure.WONDERLAND_ADD_HERO,e.wonderlandId=t.copyId,e.heroId=t.heroId,a.ServerDelegate.sendMessage(e)},t.prototype.onRequestWonderlandExplore=function(t){var e={};e.module=a.MsgModuleName.WonderlandAdventure,e.cmd=a.MsgCmd.WonderlandAdventure.WONDERLAND_BEGIN_EXPLORE,e.wonderlandId=t,a.ServerDelegate.sendMessage(e)},t.prototype.onRequestWonderlandReceiveRewards=function(t){var e={};e.module=a.MsgModuleName.WonderlandAdventure,e.cmd=a.MsgCmd.WonderlandAdventure.WONDERLAND_RECEIVE_REWARD,e.wonderlandId=t,a.ServerDelegate.sendMessage(e)},t.prototype.onRequestWonderlandQuickExplore=function(t){var e={};e.module=a.MsgModuleName.WonderlandAdventure,e.cmd=a.MsgCmd.WonderlandAdventure.WONDERLAND_QUICK_EXPLORE,e.wonderlandId=t,a.ServerDelegate.sendMessage(e)},t.prototype.onRequestOneKeyExplore=function(){var t={};t.module=a.MsgModuleName.WonderlandAdventure,t.cmd=a.MsgCmd.WonderlandAdventure.ONE_KEY_WONDERLAND,a.ServerDelegate.sendMessage(t)},t.prototype.onRequestOneKeyReward=function(){var t={};t.module=a.MsgModuleName.WonderlandAdventure,t.cmd=a.MsgCmd.WonderlandAdventure.ONE_KEY_RECEIVE_REWARD,a.ServerDelegate.sendMessage(t)},t.prototype.setCurCopyId=function(t){this._curCopyId=t},t.prototype.getCurCopyId=function(){return this._curCopyId},t.prototype.getWonderlandExploreTimeLen=function(){return a.GetConfig("WONDERLAND_TIME_LIMIT")||0},t.prototype.isQuickExploreOpen=function(){var t=this.getQuickExploreLimitLevel();return a.Account.getUserData().getLevel()>=t},t.prototype.getCfgFragmentRewardNumByHeroAptitude=function(t){for(var e=a.GetConfig("WONDERLAND_HERO_FRAGMENT_OUTPUT_REWARD_SHOW"),i=0;i<e.length;i++)if(e[i][0]===t)return e[i][1];return 0},t.prototype.getQuickExploreLimitLevel=function(){return a.GetConfig("WONDERLAND_QUICK_ADVENTURE_LEVEL_LIMIT")||0},t.prototype.isExploreHero=function(t){if(this._exploreHeroIds.length>0)for(var e=0;e<this._exploreHeroIds.length;e++)if(this._exploreHeroIds[e]===t)return!0;return!1},t.prototype.isReadyExploreHero=function(t){if(this._readyExploreHeroIds.length>0)for(var e=0;e<this._readyExploreHeroIds.length;e++)if(this._readyExploreHeroIds[e]===t)return!0;return!1},t.prototype.isHeroOnExplore=function(t){return this.isExploreHero(t)||this.isReadyExploreHero(t)},t.prototype.getHeroDataByHeroId=function(t){var e=l.default.getInstance().getHeroBySId(t);return e||(cc.log("wonderlandExplorewindow parse heroId is error!!  hero sId \uff1a%s",t),null)},t.prototype.isCopyUnlockByCopyId=function(t){var e=!1,i=this.getDataByCopyId(t);if(i){var n=i.getPreId(),r=!1,o=a.GetTableClass(a.TableEnum.WonderlandConfigTable).getMinWonderlandId();if(n&&0!==n){var s=this.getDataByCopyId(n);s&&((s.getIsPassed()||s.isLevelUnLocked()&&o===n)&&!0,r=s.getIsPassed())}t=i.getId();var l=i.isLevelUnLocked();i.getIsPassed()||r&&l?e=!0:i.isLevelUnLocked()&&t===o&&(e=!0)}return e},t.prototype.isCopyUnlock=function(t){var e=t.getPreId(),i=!1,n=a.GetTableClass(a.TableEnum.WonderlandConfigTable).getMinWonderlandId();if(e&&0!==e){var r=this.getDataByCopyId(e);r&&(r.getIsPassed()&&r.isLevelUnLocked()||r.isLevelUnLocked()&&n===e)&&(i=!0)}var o=t.getId(),s=!1,l=t.isLevelUnLocked();return t.getIsPassed()||i&&l?s=!0:t.isLevelUnLocked()&&o===n&&(s=!0),s},t.prototype.getQuickExploreRewardsConfig=function(){return a.GetConfig("WONDERLAND_QUICK_ADVENTURE_REWARD")},t.prototype.getLeftQuickExploreTimes=function(){var t=a.Account.getUserData().getVip();return a.GetTableClass(a.TableEnum.VipPrivilegeTable).getPrerogativeValueByTypeAdnValue(s.PrerogativeEnum.WONDERLAND_QUICK_ADVENTURE_TIMES,t)-this._quickExploreTimes},t.prototype.getQuickExploreTimes=function(){return this._quickExploreTimes},t.prototype.getTotalQuickExploreTimes=function(){var t=a.Account.getUserData().getVip();return a.GetTableClass(a.TableEnum.VipPrivilegeTable).getPrerogativeValueByTypeAdnValue(s.PrerogativeEnum.WONDERLAND_QUICK_ADVENTURE_TIMES,t)},t.prototype.getFixedRewarsCalculateTime=function(){return a.GetConfig("WONDERLAND_REWARD_TIME")||0},t.prototype.getAllDatas=function(){return this._dataModels?this._dataModels.slice(0):[]},t.prototype.getOpenDatas=function(){for(var t=[],e=0;e<this._dataModels.length;e++)this._dataModels[e].getIsPassed()&&t.push(this._dataModels[e]);return t.sort(this.sortFunc),t},t.prototype.sortFunc=function(t,e){return t.getId()-e.getId()},t.prototype.isAllEnd=function(){for(var t=a.TimeUtil.getTime(),e=this.getOpenDatas(),n=0;n<e.length;n++){var r=e[n].getExploreEndTime();if(e[n].getCopyStatus()!==i.WonderlandCopyStatus.EXPLORING||0===r||r>t)return!1}return!0},t.prototype.getDataByCopyId=function(t){for(var e=0;e<this._dataModels.length;e++)if(t===this._dataModels[e].getId())return this._dataModels[e];return null},t.prototype.calNeedPayWithTimes=function(t,e){for(var i=a.GetConfig("WONDERLAND_QUICK_ADVENTURE_COST"),n=0;n<i.length;n++){var r=i[n];if(t===r[0])return r[1][e-1][1]}return null},t.prototype.redPointEvents=function(){return[a.EventNameEnum.WONDERLAND_DATA_CHANGED]},t.prototype.isCanReceiveRewardsStatus=function(){var t=a.TimeUtil.getTime();if(this._dataModels.length>0)for(var e=0;e<this._dataModels.length;e++){var n=this._dataModels[e],r=n.getExploreEndTime();if(n.getCopyStatus()===i.WonderlandCopyStatus.EXPLORING&&0!==r&&r<=t)return!0}return!1},t.prototype.isCanExploreStatus=function(){if(this._dataModels.length>0)for(var t=0;t<this._dataModels.length;t++){var e=this._dataModels[t];e.getCurHero();if(e.getCopyStatus()===i.WonderlandCopyStatus.FREE)return!0}return!1},t.prototype.isCanChallengeStatus=function(){var t=a.Account.getUserData().getFightPower();if(this._dataModels.length>0)for(var e=0;e<this._dataModels.length;e++){var i=this._dataModels[e];if(!i.getIsPassed()&&t>=i.getRecommndFightPower()&&i.isLevelUnLocked())return!0}return!1},t.prototype.isRedPointTips=function(){if(!a.UnlockManager.isPanelUnlock(a.PanelEnum.Panel_WonderlandAdventure))return!1;var t=a.Account.getUserData().getFightPower(),e=a.TimeUtil.getTime();if(this._dataModels.length>0)for(var n=0;n<this._dataModels.length;n++){var r=this._dataModels[n];if(r.getIsPassed()&&r.getCopyStatus()!==i.WonderlandCopyStatus.EXPLORING)return!0;if(!r.getIsPassed()&&t>=r.getRecommndFightPower()&&r.isLevelUnLocked())return!0;var o=r.getExploreEndTime();if(r.getCopyStatus()===i.WonderlandCopyStatus.EXPLORING&&0!==o&&o<=e)return!0}return!1},t=e=n([r],t)}();i.default=c,cc._RF.pop()},{"../../../TS/Hero/Manager/HeroManager":"HeroManager",CommonEnum:void 0,WonderlandCopyModel:"WonderlandCopyModel"}],WorldBossActorModel:[function(t,e,i){"use strict";cc._RF.push(e,"590baSizJBB7YpEKwc6qBN8","WorldBossActorModel");window.td;var n=function(){function t(){this._isAutoBattle=!1}return t.prototype.init=function(){this._receiveState=!0,this._resetTimes=0,this._inspireTimes=0,this._nextChallengeTime=0,this._isAutoBattle=!1},t.prototype.update=function(t){t&&(void 0!==t.receiveState&&(this._receiveState=t.receiveState),void 0!==t.resetTimes&&(this._resetTimes=t.resetTimes),void 0!==t.inspireTimes&&(this._inspireTimes=t.inspireTimes),void 0!==t.nextChallengeTime&&(this._nextChallengeTime=t.nextChallengeTime),void 0!==t.autoCombat&&(this._isAutoBattle=t.autoCombat))},t.prototype.getReceiveState=function(){return this._receiveState},t.prototype.getResetTimes=function(){return this._resetTimes},t.prototype.getInspireTimes=function(){return this._inspireTimes},t.prototype.getNextChallengeTime=function(){return this._nextChallengeTime},t.prototype.getAutoBattleState=function(){return this._isAutoBattle},t}();e.exports=n,cc._RF.pop()},{}],WorldBossEnum:[function(t,e,i){"use strict";cc._RF.push(e,"c30c5aALllH9aODMHhLKPMX","WorldBossEnum"),Object.defineProperty(i,"__esModule",{value:!0}),i.BossRankShowType=i.WholeBossShowState=i.WholeBossState=i.WorldBossState=i.WorldBossPageType=void 0,i.WorldBossPageType={WorldBoss:1,WholeBoss:2},i.WorldBossState={NONE:0,SHOW:1,BATTLE:2,REWARD:3,SLEEP:4},i.WholeBossState={NONE:0,BATTLE:1,SLEEP:2},i.WholeBossShowState={Lock:0,Fighting:1,Killed:2},i.BossRankShowType={RankWithReward:1,RankWithoutReward:2,LastRoundTop:3,CurRoundTop:4},cc._RF.pop()},{}],WorldBossLevelRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"2a541psek1ESL4+vkd9vK5D","WorldBossLevelRewardTable"),cc._RF.pop()},{}],WorldBossManager:[function(t,e,i){"use strict";cc._RF.push(e,"bc09c/TrvFJ2oLnEM8rjNP7","WorldBossManager");var n=this&&this.__decorate||function(t,e,i,n){var a,r=arguments.length,o=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,n);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(o=(r<3?a(o):r>3?a(e,i,o):a(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o};Object.defineProperty(i,"__esModule",{value:!0});var a=cc._decorator.ccclass,r=window.td,o=t("./WholeBossManager"),s=function(){function t(){this._showHomePageWorldBtnAnim=!0,this._isBossStateShow=!0,this._isBossStateBattle=!0}var e;return e=t,t.getInstance=function(){return null==this._instance&&(this._instance=new e),this._instance},t.prototype.init=function(){this.destroyData(),this.addListener(),this.addEventListener()},t.prototype.destroyData=function(){this._bossList={},this._challengeTimes={},this._ranks=[],this._worldBossRecord={},this._showHomePageWorldBtnAnim=!0},t.prototype.addListener=function(){var t=r.MsgModuleName.WorldBoss,e=r.MsgCmd.WorldBoss;r.ServerDelegate.registerMessage(t,e.GET_WORLD_BOSS_INFO,this._parseBossInfo.bind(this)),r.ServerDelegate.registerMessage(t,e.GET_WORLD_BOSS_ACTOR,this._parseActorInfo.bind(this)),r.ServerDelegate.registerMessage(t,e.WORLD_BOSS_CHALLENGE,this._onChallenge.bind(this)),r.ServerDelegate.registerMessage(t,e.GET_WORLD_BOSS_RANKS,this._parseRankInfo.bind(this)),r.ServerDelegate.registerMessage(t,e.WORLD_BOSS_SWEEP,this._parseRewardResult.bind(this)),r.ServerDelegate.registerMessage(t,e.PUSH_WORLD_BOSS_INFO,this._parseBossInfo.bind(this)),r.ServerDelegate.registerMessage(t,e.PUSH_WORLD_BOSS_ACTOR,this._parseActorInfo.bind(this))},t.prototype.addEventListener=function(){var t=r.EventUtil,e=r.EventNameEnum,i={};i[e.REQ_GET_WORLD_BOSS_INFO]=this._requestInfo,i[e.REQ_GET_WORLD_BOSS_ACTOR]=this._requestActorInfo,i[e.REQ_CHALLENGE_WORLD_BOSS]=this._requestChallenge,i[e.REQ_GET_WORLD_BOSS_RANKS]=this._requestRanks,i[e.REQ_SWEEP_WORLD_BOSS]=this._requestSweep,i[e.USER_ATTR_LEVEL_CHANGE]=this.reqInfo,i[e.SET_WORLD_BOSS_SELECT_ID]=this.setBossId,i[e.ON_GET_SERVER_START_DAYS]=this.reqInfo,t.registerEvents(i,this)},t.prototype.reqInfo=function(){this._requestInfo(),this._requestActorInfo()},t.prototype.getBossList=function(){var t=[];for(var e in this._bossList)t.push(this._bossList[e]);return t},t.prototype.getBossById=function(t){return this._bossList[t]},t.prototype.getChallengeTimesById=function(t){return this._challengeTimes[t]?this._challengeTimes[t]:0},t.prototype.getRanks=function(){return this._ranks},t.prototype.getBossId=function(){return this._id},t.prototype.setBossId=function(t){this._id=t},t.prototype.setBossState=function(){this._isBossStateShow=!1,this._isBossStateBattle=!1},t.prototype._parseBossInfo=function(t,e){var i=this;t===r.NetCode.SUCCESS&&(e.bossList.forEach(function(t){var e=t.bossId;i._bossList[e]||(i._bossList[e]={}),i._bossList[e].bossId=e,i._bossList[e].closeTime=t.closeTime}),r.EventUtil.dispatchEvent(r.EventNameEnum.RES_GET_WORLD_BOSS_INFO))},t.prototype._parseActorInfo=function(t,e){if(t===r.NetCode.SUCCESS){var i=e.worldBossInfo;for(var n in i)this._challengeTimes[n]=i[n].challengeTimes;this._worldBossRecord=i||{},r.EventUtil.dispatchEvent(r.EventNameEnum.RES_GET_WORLD_BOSS_ACTOR)}},t.prototype.getBossRecordById=function(t){if(this._worldBossRecord)return this._worldBossRecord[t]},t.prototype.getCanSweepById=function(t){return!!this._worldBossRecord&&(!!this._worldBossRecord[t]&&this._worldBossRecord[t].challengeTimes>0)},t.prototype._onChallenge=function(t,e){t===r.NetCode.SUCCESS&&r.EventUtil.dispatchEvent(r.EventNameEnum.RES_CHALLENGE_WORLD_BOSS)},t.prototype._parseRankInfo=function(t,e){if(t===r.NetCode.SUCCESS){var i,n=e.ranks;n.length>0&&(i=n.pop()),n.sort(this.sortFunc),this._ranks=n.concat([]),i&&this._ranks.push(i),r.EventUtil.dispatchEvent(r.EventNameEnum.RES_GET_WORLD_BOSS_RANKS)}},t.prototype._parseRewardResult=function(t,e){if(t===r.NetCode.SUCCESS){var i=e.rewardResult,n=r.RewardManager.parseRewardResult(i);r.GlobalFunction.showRewards(n,!1)}},t.prototype.sortFunc=function(t,e){return t.rank-e.rank},t.prototype._requestInfo=function(){if(r.UnlockManager.isTargetUnlock(r.ActorUnlockType.WorldBoss,0)){var t={};t.module=r.MsgModuleName.WorldBoss,t.cmd=r.MsgCmd.WorldBoss.GET_WORLD_BOSS_INFO,r.ServerDelegate.sendMessage(t)}},t.prototype._requestActorInfo=function(){if(r.UnlockManager.isTargetUnlock(r.ActorUnlockType.WorldBoss,0)){var t={};t.module=r.MsgModuleName.WorldBoss,t.cmd=r.MsgCmd.WorldBoss.GET_WORLD_BOSS_ACTOR,r.ServerDelegate.sendMessage(t)}},t.prototype._requestChallenge=function(t){var e={};e.module=r.MsgModuleName.WorldBoss,e.cmd=r.MsgCmd.WorldBoss.WORLD_BOSS_CHALLENGE,e.bossId=t,r.ServerDelegate.sendMessage(e)},t.prototype._requestSweep=function(t){var e={};e.module=r.MsgModuleName.WorldBoss,e.cmd=r.MsgCmd.WorldBoss.WORLD_BOSS_SWEEP,e.bossId=t,r.ServerDelegate.sendMessage(e)},t.prototype._requestRanks=function(t){if(r.UnlockManager.isTargetUnlock(r.ActorUnlockType.WorldBoss,0)){var e={};e.module=r.MsgModuleName.WorldBoss,e.cmd=r.MsgCmd.WorldBoss.GET_WORLD_BOSS_RANKS,e.bossId=t,r.ServerDelegate.sendMessage(e)}},t.prototype.isRedPointTips=function(){return!!o.default.getInstance().isWholeBossRedPoint()||!!this.isWorldBossRedPoint()},t.prototype.getLeftChallengeTimes=function(){var t=this.getBossList()[0].bossId,e=r.GetTableClass(r.TableEnum.WorldBossTable).getDataById(t),i=this.getChallengeTimesById(t);return e.challengeTime-i},t.prototype.redPointEvents=function(){var t=r.EventNameEnum;return[r.EventNameEnum.ON_GET_WHOLE_BOSS_INFO,r.EventNameEnum.ON_WHOLE_BOSS_PARTICIPATE_CHANGED,t.USER_ATTR_LEVEL_CHANGE,r.EventNameEnum.RES_GET_WORLD_BOSS_INFO]},t.prototype.isWorldBossOpen=function(){var t=this.getBossList()[0];if(!t||!t.bossId)return!1;var e=t.bossId,i=r.GetTableClass(r.TableEnum.WorldBossTable).getDataById(e);return r.TimeUtil.getTime()>=r.TimeUtil.getStampByHours(i.openTime)},t.prototype.getWorldBossEndTime=function(){var t=this.getBossList()[0].bossId,e=r.GetTableClass(r.TableEnum.WorldBossTable).getDataById(t),i=r.TimeUtil.getTime(),n=r.TimeUtil.getStampByHours(e.openTime),a=r.TimeUtil.getStampByHours(e.closeTime);return i>=n?a:n},t.prototype.isWorldBossRedPoint=function(){return!!r.UnlockManager.isTargetUnlock(r.ActorUnlockType.WorldBoss,0)&&!(!this.isWorldBossOpen()||0===this.getLeftChallengeTimes())},t.prototype.bossRedPointEvts=function(){var t=r.EventNameEnum;return[t.USER_ATTR_LEVEL_CHANGE,t.RES_GET_WORLD_BOSS_ACTOR]},t.prototype.setShowHomePageWorldBtnAnim=function(t){this._showHomePageWorldBtnAnim=t},t.prototype.isShowHomePageWorldBtnAnim=function(){return this._showHomePageWorldBtnAnim},t.prototype.isShowMainEnterWorldBoss=function(){return!!r.UnlockManager.isTargetUnlock(r.ActorUnlockType.WorldBoss,0)&&!(!this.isWorldBossOpen()||0===this.getLeftChallengeTimes())},t.prototype.getCurOpenBoss=function(){return this.isWorldBossOpen()?this.getBossList()[0]:null},t=e=n([a],t)}();i.default=s,cc._RF.pop()},{"./WholeBossManager":"WholeBossManager"}],WorldBossModel:[function(t,e,i){"use strict";cc._RF.push(e,"e4d8c4ymB9NEpfbC56ULNPk","WorldBossModel"),Object.defineProperty(i,"__esModule",{value:!0});var n=window.td,a=t("../Enum/WorldBossEnum"),r=t("MonsterModel"),o=function(){function t(){}return t.prototype.init=function(t){var e=n.GetTableClass(n.TableEnum.WorldBossTable).getDataById(t);this._id=e.id,this._rewards=e.rewards,this._openTimeStr=e.openTime,this._openTime=n.TimeUtil.getStampByHours(this._openTimeStr),this._rewardEndTime=n.TimeUtil.getStampByHours(e.rewardEndTime),this._bossPic=e.bossPic,this._bossName=e.bossName,this._tipsIcon=e.tipsIcon,this._monsterId=0,this._state=a.WorldBossState.NONE,this._closeTime=0,this._leftHP=0,this._ranks=[],this._damageRecordList=[]},t.prototype.update=function(t){if(t){if(void 0!==t.monsterId){this._monsterId=t.monsterId;var e=n.GetTableClass(n.TableEnum.Monster).getMonsterDataById(this._monsterId);e&&(this._monsterData=new r,this._monsterData.init(e))}if(void 0!==t.state&&(this._state=parseInt(t.state)),void 0!==t.closeTime&&(this._closeTime=t.closeTime),void 0!==t.leftHP&&(this._leftHP=t.leftHP),void 0!==t.ranks&&(this._ranks=t.ranks,this._state===a.WorldBossState.NONE&&this._state===a.WorldBossState.SLEEP||(this._myRank=this._ranks.pop())),void 0!==t.damageRecordList){this._damageRecordList=[];for(var i=t.damageRecordList,o=!1,s=0,l=i.length;s<l;s++){i[s].time>=this._startTime&&(this._damageRecordList[s]=i[s],o=!0)}this._startTime=n.TimeUtil.getTime(),o&&n.EventUtil.dispatchEvent(n.EventNameEnum.WHOLE_BOSS_DAMAGE_RECORD_CHANGED)}}},t.prototype.getId=function(){return this._id},t.prototype.getRewards=function(){return this._rewards},t.prototype.getOpenTimeStr=function(){return this._openTimeStr},t.prototype.getOpenTime=function(){return this._openTime},t.prototype.getRewardEndTime=function(){return this._rewardEndTime},t.prototype.getBossPic=function(){return this._bossPic},t.prototype.getBossName=function(){return this._bossName},t.prototype.getMonsterId=function(){return this._monsterId},t.prototype.getState=function(){return this._state},t.prototype.getCloseTime=function(){return this._closeTime},t.prototype.getLeftHp=function(){return this._leftHP},t.prototype.getRanks=function(){return this._ranks},t.prototype.getShowMonster=function(){return this._monsterData},t.prototype.haveRecord=function(){return this._damageRecordList.length>0},t.prototype.popNewRecord=function(){return 0===this._damageRecordList.length?null:this._damageRecordList.pop()},t.prototype.getSelfRankInfo=function(){return this._myRank},t.prototype.getTipsIcon=function(){return this._tipsIcon},t}();e.exports=o,cc._RF.pop()},{"../Enum/WorldBossEnum":"WorldBossEnum",MonsterModel:"MonsterModel"}],WorldBossRankModel:[function(t,e,i){"use strict";cc._RF.push(e,"f4aafZ0iL5F1pyETS5SogrE","WorldBossRankModel");var n=t("Model"),a=cc.Class({extends:n,properties:{_attributes:null,_rank:null,_showId:null,_damage:null},init:function(t){this._super("WorldBossRankModel"),t&&(this._rank=t.rank||0,this._attributes=t.attributes||{},this._showId=t.attributes[td.UserPropertyEnum.LINE_UP_SHOW_ID]||0,this._damage=t.damage||0)},getDamage:function(){return this._damage},getRank:function(){return this._rank},setRank:function(t){this._rank=t},getUserName:function(){return this._attributes[td.UserPropertyEnum.NickName]?this._attributes[td.UserPropertyEnum.NickName]:""},getGamerId:function(){return this._attributes[td.UserPropertyEnum.GamerId]?this._attributes[td.UserPropertyEnum.GamerId]:0},getArmyName:function(){var t=this._attributes?this._attributes[td.UserPropertyEnum.NATION_NAME]:"";return""==t&&(t=td.Language.notJoinArmy),t}});e.exports=a,cc._RF.pop()},{Model:"Model"}],WorldBossRankRewardTable:[function(t,e,i){"use strict";cc._RF.push(e,"ed73fCZr3RBJaXUlou+Ye/9","WorldBossRankRewardTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="WorldBossRankRewardConfig",e._tblName="world_boss_rank_reward_config",e}return n(e,t),e.prototype.init=function(){this._data={};for(var t=this._data,e=this._jsonData,i=0,n=e.length;i<n;++i){var a=e[i],r=a.id;t[r]||(t[r]={}),t[r][a.rank]=a}},e.prototype.getListById=function(t){var e=[],i=this._data[t];for(var n in i)e.push(i[n]);return e.sort(this.sortFunc),e},e.prototype.getRewardsByIdAndRank=function(t,e){if(e<=0)return null;var i=this._data[t];for(var n in i)if(i[n].rank>=e)return i[n];return null},e.prototype.sortFunc=function(t,e){return t.rank-e.rank},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],WorldBossTable:[function(t,e,i){"use strict";cc._RF.push(e,"11bcbCHp4JEt6qb/5xSTkZv","WorldBossTable");var n=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="WorldBossConfig",e._tblName="world_boss_config",e}return n(e,t),e.prototype.init=function(){this._data=[];for(var t=this._jsonData,e=0,i=t.length-1;e<=i;e++){var n=t[e];this._data[n.id]=n}},e.prototype.getDataById=function(t){return this._data[t]},e}(t("BaseTable"));e.exports=a,cc._RF.pop()},{BaseTable:"BaseTable"}],WuXianJianZhi:[function(t,e,i){"use strict";cc._RF.push(e,"393ddwuehdN+K0Kqw5gbZiB","WuXianJianZhi");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="WuXianJianZhi"}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],XianXueLingYU:[function(t,e,i){"use strict";cc._RF.push(e,"182b9P1dKlFHpXYIKdOzxsC","XianXueLingYU");var n=t("CommonSkill"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{_haveSkillEnemyList:null,_time:null,_delayTime:null},initData:function(t){this._super(t),this._skillName="XianXueLingYU",this._haveSkillEnemyList=[],this._time=0,this._delayTime=0},update:function(t){if(this._delayTime<.2)this._delayTime+=t*this._curSpeedMult;else{this._time+=t*this._curSpeedMult;for(var e=this._dataModel.getDamageRange()/2,i=a.getEnemyArray(),n=this.node.getPosition(),r=0,o=i.length;r<o;r++){var s=i[r];if(s){var l=s._tag,c=Math.floor(l/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),u=s.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[c]),d=u.bDeath(),h=s.getPosition(),p=td.GlobalFunction.getDistance(n,h),_=this.checkEnemyExistInList(l);p<=e&&!d&&!_&&this.setAttackEffectToEnemy(u)}}}},checkEnemyExistInList:function(t){for(var e=0,i=this._haveSkillEnemyList.length;e<i;e++)if(this._haveSkillEnemyList[e]===t)return!0;return this._haveSkillEnemyList.push(t),!1},frameEventCallBack:function(){}});e.exports=r,cc._RF.pop()},{CommonSkill:"CommonSkill",PveFightManager:"PveFightManager"}],XieNengFaDun:[function(t,e,i){"use strict";cc._RF.push(e,"01de4D4bdNNYIATnV+3kGpq","XieNengFaDun");var n=t("BaseBossSkill"),a=t("PveFightManager"),r=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="XieNengFaDun"},effect:function(){if(cc.isValid(this._owner))for(var t=Math.abs(this._dataModel.getDamageRange()),e=a.getEnemyArrayExcept(this._owner),i=td.GlobalFunction.getRandomArrayElements(e,t),n=0;n<i.length;n++){var r=i[n];this.setAttackEffectToEnemy(r)}else this.removeSelf()}});e.exports=r,cc._RF.pop()},{BaseBossSkill:"BaseBossSkill",PveFightManager:"PveFightManager"}],YunShi:[function(t,e,i){"use strict";cc._RF.push(e,"d1909Zo1DlNsKckp4vNv9os","YunShi");var n=t("CommonSkill"),a=cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="YunShi"}});e.exports=a,cc._RF.pop()},{CommonSkill:"CommonSkill"}],ZiRanZhiLi:[function(t,e,i){"use strict";cc._RF.push(e,"4ae41LhHplK6ISzNP3CGii2","ZiRanZhiLi");var n=t("BaseBossSkill"),a=(t("PveFightManager"),cc.Class({extends:n,properties:{},initData:function(t){this._super(t),this._skillName="ZiRanZhiLi"},effect:function(){if(cc.isValid(this._owner)){var t=this._owner._tag,e=Math.floor(t/td.PveEnum.PVE_OBJECT_TAG_RATIO.Enemy_Ratio),i=this._owner.getComponent(td.PveEnum.PVE_ENEMY_SCRIPT[e]),n=i.bDeath(),a=i.getTransferStatus();if(n||a)this.removeSelf();else{var r=this._dataModel.getAttackEffect()[0],o=r[0],s=r[1]/1e4,l=this.node.parent.getChildByName("9023");if(!l){var c=gdk.rm.getResByUrl("fightRes/pve/buff/9023/9023",cc.Prefab);l=cc.instantiate(c),this.node.parent.addChild(l),l.y=-20,l.name="9023"}if(this._buffAnimation=l.getComponent(cc.Animation),this._clipName="9023",this._buffAnimation.play(this._clipName),td.PveEnum.PVE_EFFECT_TYPE.MonsterHpRecover==o){var u=i.getTotalHp()*s;i.setCurHp(0,parseInt(-u),td.PveEnum.PVE_HURT_TYPE.HpRecover)}}}else this.removeSelf()}}));e.exports=a,cc._RF.pop()},{BaseBossSkill:"BaseBossSkill",PveFightManager:"PveFightManager"}],constants:[function(t,e,i){"use strict";cc._RF.push(e,"65d78jCyyFE9aJK1gnVo+Ge","constants"),td.ReportType={error:"stackError",performance:"performance",Pay:"pay",prevent:"prevent",sdkError:"sdkError",urlError:"urlError"},td.GetTableClass=td.TableManager.getTableClass.bind(td.TableManager),td.GetResourceSize=function(t){return td.GetTableClass(td.TableEnum.ResourceSize).getContentSize(t)},td.GetConfig=function(t){return td.GetTableClass(td.TableEnum.Config).getConfig(t)},td.GetNetErrorTips=function(t){return td.GetTableClass(td.TableEnum.NetErrorTips).getNetErrorTips(t)},td.UI_Colors=[cc.color(60,99,106),cc.color(133,84,76),cc.color(2,128,16),cc.color(21,93,174),cc.color(209,0,212),cc.color(193,123,0),cc.color(0,167,182),cc.color(219,10,0),cc.color(255,0,0),cc.color(189,154,142),cc.color(94,53,8),cc.color(8,65,94),cc.color(8,94,38),cc.color(255,238,184)],td.PreloadState={NOT_LOADED:0,LOAD_DATA:1,LOAD_RES:2,LOADED:3},td.PlayerState={NOT_INIT:0,USER_LOGIN_COMPLETE:1,GAMER_LOGIN_COMPLETE:2},td.PanelTimeActiveTimeout=3e5,td.LoadedSelfMercenaryModel=!1,td.BtnLableColor=cc.color(131,65,25),td.BtnLableGrayColor=cc.color(91,91,91),cc._RF.pop()},{}],serverDelegate:[function(t,e,i){"use strict";cc._RF.push(e,"9fb2eIzRkxEaL3rnuoQscD4","serverDelegate");var n=function(t){return t&&t.__esModule?t:{default:t}}(t("../../../Common/Utils/ArrayQueue"));td.ServerDelegate={_host:null,_port:null,_reconnectCount:null,_webSocketClient:null,_connectComplete:null,_callFuncs:null,_beatScheduler:null,_beatObj:null,_beatTime:15,_offLineState:null,_recordMap:null,_isReconnected:null,_isReconnecting:null,_isShowConfirRetry:null,_arrayQuenue:null,_pushCount:0,_popCount:0,init:function(){this._callFuncs=[],this._reconnectCount=0,this._connectComplete=!1,this._isReconnected=!1,this._recordMap={},this._arrayQuenue=new n.default(2048),gdk.Timer.frameLoop(1,this,this._handleMessage),gdk.Timer.loop(1e3,this,this._checkTimeout)},connectGameServer:function(t,e){this._host=t||this._host,this._port=e||this._port,this._webSocketClient?this.reconnect():(this._webSocketClient=new td.WebSocket(this._host,this._port),this._webSocketClient.setSocketCallFunc({connectedHandle:this._handleConnect.bind(this),receiveHandle:this._onRecvMessage.bind(this),errorHandle:this._handleError.bind(this),disconnectedHandle:this._handleDisconnect.bind(this)}))},reconnect:function(){var t=this;if(this._webSocketClient&&(this._webSocketClient.disconnect(),this._webSocketClient=null),!this._isReconnecting&&null!==this._offLineState)if(3!==this._reconnectCount){if(this._reconnectCount++,1===this._reconnectCount){var e={type:td.LoadingType.None,key:td.LoadingKey.NetReconnet,tips:td.LoadingTips.NetReconnet};td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_LOADING_LAYER,e)}cc.log("try reconnect : "+this._reconnectCount),this._isReconnecting=!0,setTimeout(function(){t._isReconnecting=!1,t.connectGameServer()},500)}else if(cc.error("can not reconnect to server"),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_LOADING_LAYER,td.LoadingKey.NetReconnet),td.EventUtil.dispatchEvent(td.EventNameEnum.GUIDE_FINISH),td.BroadcastContent&&!this._isShowConfirRetry){this._isShowConfirRetry=!0;var i=new td.BroadcastContent(98);i.setOkText(td.Language.reconnect),i.setCancelText(td.Language.loginout),i.setOkCallFunc(this._onRetryConnect.bind(this)),i.setCancelCallFunc(function(){t._onLogout()}),td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_BROADCAST,i)}else td.TipsUtil.showMessage(td.Tips.NetConnectFailed)},_onRetryConnect:function(){this._reconnectCount=0,this._isShowConfirRetry=!1,this.reconnect()},_onLogout:function(t){void 0===t&&(t=td.SceneName.LoginScene),this._webSocketClient&&(this._webSocketClient.disconnect(),this._webSocketClient=null),this._isShowConfirRetry=!1,this._reconnectCount=0,this._isReconnected=!1;var e=gdk.SceneId.getValue(t);gdk.scene.load(e,null,null,null,!1)},logout:function(t){void 0===t&&(t=td.SceneName.LoginScene),this.setOffLineState(td.OffLineState.OnLine.DisConnect),this._onLogout(t)},startHeartBeat:function(){!this._beatScheduler&&this._webSocketClient||this.stopHeartBeat(),this._sendHeartBeat(),this._beatScheduler=td.GlobalScheduler.scheduleRepeatForever(this._sendHeartBeat.bind(this),this._beatTime)},_sendHeartBeat:function(){this.sendMessage({module:td.MsgModuleName.BASE,cmd:td.MsgCmd.Base.HEART_BEAT})},stopHeartBeat:function(){this._beatScheduler&&td.GlobalScheduler.unschedule(this._beatScheduler)},registerMessage:function(t,e,i){this._callFuncs[t]||(this._callFuncs[t]={}),this._callFuncs[t][e]=i},unregisterMessage:function(t,e,i){var n=this._callFuncs[t];void 0!==n&&(e&&void 0!==n[e]?delete this._callFuncs[t][e]:delete this._callFuncs[t])},sendMessage:function(t){if(cc.log("====> sendMeg:",t),cc.log(" time: "+td.TimeUtil.getTime()),this._webSocketClient){var e=t.module,i=t.cmd,n=e+"_"+i,a=td.TimeUtil.getTime();if(this._recordMap[n]&&a-this._recordMap[n]<td.LoadingLimitTime)cc.log("waite for sever return or timeout !!!! %d , %d",a,this._recordMap[n]);else{var r=td.EnCoder(t);if(this._webSocketClient.send(r),this._recordMap[n]=td.TimeUtil.getTime(),!(e===td.MsgModuleName.BASE&&i===td.MsgCmd.Base.HEART_BEAT||e===td.MsgModuleName.SIGN_IN&&i===td.MsgCmd.SIGN_IN.GET_DAILY_SIGN_INFO||e===td.MsgModuleName.HERO&&i===td.MsgCmd.Hero.HERO_CULTIVATE||e===td.MsgModuleName.ExtensionCmd&&i===td.MsgCmd.ExtensionCmd.GET_FLASH_GIFT_INFO)){var o={type:td.LoadingType.Panel,key:td.LoadingKey.Communicating+"_"+n,tips:td.LoadingTips.Communicating};td.EventUtil.dispatchEvent(td.EventNameEnum.SHOW_LOADING_LAYER,o)}}}else cc.error("sned Message erro , webSocketClient is null")},_handleConnect:function(){this._reconnectCount>0&&(this._isReconnected=!0,this._reconnectCount=0),this._connectComplete=!0,this._offLineState=td.OffLineState.OnLine,this._recordMap={},td.TDBoot.destroyData(),this._arrayQuenue.clear(),setTimeout(function(){td.EventUtil.dispatchEvent(td.EventNameEnum.REQUEST_USER_LOGIN)},20),td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_LOADING_LAYER,td.LoadingKey.NetReconnet)},_onRecvMessage:function(t){this._pushCount++;this._arrayQuenue.push(t)},_handleMessage:function(){for(var t=0;t<5;t++){var e=this._arrayQuenue.pop();if(!(e instanceof ArrayBuffer))break;this._popCount++;var i=td.DeCoder(e);if(null!==i&&null!==i.statusCode){var n=i.moduleEnum+"_"+i.cmdEnum;if(cc.log(i.value),cc.log(JSON.stringify(i.value)),this._recordMap[n]&&(this._recordMap[n]=0),i.moduleEnum==td.MsgModuleName.BASE&&i.cmdEnum==td.MsgCmd.Base.HEART_BEAT)return cc.log("heartbeat"),void td.TimeUtil.resetTimeDelta(i.value);i.moduleEnum==td.MsgModuleName.SIGN_IN&&i.cmdEnum==td.MsgCmd.SIGN_IN.GET_DAILY_SIGN_INFO||i.moduleEnum===td.MsgModuleName.HERO&&i.cmdEnum===td.MsgCmd.Hero.HERO_CULTIVATE||i.moduleEnum===td.MsgModuleName.ExtensionCmd&&i.cmdEnum===td.MsgCmd.ExtensionCmd.GET_FLASH_GIFT_INFO||td.EventUtil.dispatchEvent(td.EventNameEnum.HIDE_LOADING_LAYER,td.LoadingKey.Communicating+"_"+n),i.statusCode!=td.NetCode.SUCCESS&&td.EventUtil.dispatchEvent(td.EventNameEnum.SERVER_RETURN_CODE,i.statusCode),this._callFuncs[i.moduleEnum]&&this._callFuncs[i.moduleEnum][i.cmdEnum]&&this._callFuncs[i.moduleEnum][i.cmdEnum](i.statusCode,i.value),cc.log("====> getMsg:",i)}}},_handleDisconnect:function(){this.stopHeartBeat(),this._offLineState===td.OffLineState.OnLine&&(this._offLineState=td.OffLineState.NetError),this._offLineState===td.OffLineState.NetError&&(this.reconnect(),td.EventUtil.dispatchEvent(td.EventNameEnum.NOTICE_NET_BREAK,!0)),null===this._offLineState&&(td.TipsUtil.showMessage(td.Tips.ConectionError),td.EventUtil.dispatchEvent(td.EventNameEnum.FIRST_WEB_SOCKET_TIME_OUT)),this._connectComplete=!1},_handleError:function(t){cc.log("webscoket _handleError"+t),this.reconnect()},isConnectComplete:function(){return this._connectComplete},setOffLineState:function(t){this._offLineState=t,t==td.OffLineState.OnLine.DisConnect&&td.EventUtil.dispatchEvent(td.EventNameEnum.NOTICE_NET_BREAK,!0)},isReconnected:function(){return this._isReconnected},_checkTimeout:function(){var t=td.TimeUtil.getTime();for(var e in this._recordMap){var i=this._recordMap[e];if(i>0&&t-i>=td.LoadingLimitTime){var n=e.split("_"),a=[parseInt(n[0]),parseInt(n[1])];td.EventUtil.dispatchEvent(td.EventNameEnum.NET_TIME_OUT,a),this._recordMap[e]=0}}}},cc._RF.pop()},{"../../../Common/Utils/ArrayQueue":void 0}]},{},["ActivityBaseController","ActivityBasePanel","SingleRechargeController","SingleRechargeController10","SingleRechargeController2","SingleRechargeController3","SingleRechargeController4","SingleRechargeController5","SingleRechargeController6","SingleRechargeController7","SingleRechargeController8","SingleRechargeController9","SingleRechargeItem","SingleRechargeModel","SingleRechargePanel","AddUpRechargeController","AddUpRechargeController1001","AddUpRechargeController2","AddUpRechargeController3","AddUpRechargeController4","AddUpRechargeController5","AddUpRechargeController6","AddUpRechargeController7","AddUpRechargeController8","AddUpRechargeController9","AddUpRechargeHome","AddUpRechargeItem","AddUpRechargeItemLVItem","AccumulatedRechargeController","AccumulatedRechargeItem","AccumulatedRechargeModel","AccumulatedRechargePanel","LoginDayGiftController","LoginDayGiftController1002","LoginDayGiftItem","LoginDayGiftModel","LoginDayGiftPanel","LoginDayGiftWindow","MagicShopController","MagicShopListView","MagicShopModel","MagicShopPanel","DayDayRechargeController","DayDayRechargeItem","DayDayRechargePanel","HavingTurntableController","HavingTurntablePanel","HavingTurntableTaskItem","HavingTurntableTaskWindow","HeavenTurntableController","HeavenTurntablePanel","HeavenTurntableTaskItem","HeavenTurntableTaskWindow","ActivitySummonController","ActivitySummonControllerEquip","ActivitySummonControllerGem","ActivitySummonPanel","BuyRecordsItemUI","BuyRecordsLayer","CrystalAutoInputItemUI","CrystalAutoInputWindow","CrystalGetItemUI","CrystalGetWindow","CrystalInputWindow","MyNumRecordsItemUI","MyNumRecordsLayer","MyRecordsWindow","NoticeItemUI","PhaseBoxItemUI2","PreviousRecordItemUI","PreviousRecordsWindow","RareTreasureController","RareTreasureEnums","RareTreasureItemUI","RareTreasurePanel","RareTreasurePhaseBoxItemUI","RareTreasureShopItemUI","RareTreasureShopWindow","WinRecordsItemUI","WinRecordsLayer","RushCrossRankPanel","RushRankController","RushRankCrossController","RushRankIconItem","RushRankItem","RushRankModel","RushRankPanel","RushRankRankItem","RushRankRankWindow","ChallengeHeroController","ChallengeHeroController2","ChallengeHeroController3","ChallengeHeroController4","ChallengeHeroController5","ChallengeHeroController6","ChallengeHeroController7","ChallengeHeroController8","ChallengeHeroHome","ChallengeHeroItem","ChallengeHeroModel","ChallengeHerolWordsItemUI","ChallengeHerolWordsWindow","GachaActivityController","GachaActivityHome","GachaActivityScoreModel","GachaActivityShopModel","GachaActivityShopPanel","GachaScoreRewardItem","GachaShopItem","TurnTableQuickExactWindow","TurntableController","TurntableExchangeItem","TurntableExchangeWindow","TurntableHome","TurntableRewardItem","TurntableRewardModel","TurntableRewardWindow","TurntableTaskItem","TurntableTaskWindow","ActivityForecastController","ActivityForecastPanel","TowerMasterController","TowerMasterEnums","TowerMasterItemUI","TowerMasterPanel","TowerMasterRewardItemUI","TowerMasterRewardWindow","ConsumeActivityController","ConsumeActivityItem","ConsumeActivityPanel","LuckyErnieController","LuckyErnieController2","LuckyErniePanel","LuckyErnieScrollWidget","PreferentialGiftController","PreferentialGiftListView","PreferentialGiftWindow","HalloweenController","HalloweenItemUI","HalloweenPanel","HalloweenRewardItemUI","HalloweenTaskItemUI","HalloweenTaskWindow","BBCharmRankItem","BBFateRankItem","BBMatchmakerBlessPanel","BBNewMeetPushWindow","BirdBridgeFateRankWindow","BirdBridgeFlowerRankWindow","BirdBridgeMeetHelpPanel","BirdBridgeMeetItem","BirdBridgeMeetPanel","BirdBridgePartyModel","BirdBridgeRankModel","BlessProgressRewardModel","BlessTopPlayerModel","MagpieBridgePartyController","DailyPreferentialController","DailyPreferentialModel","DailyPreferentialWindow","FamousGeneralShopController","FamousGeneralShopListView","FamousGeneralShopModel","FamousGeneralShopPanel","GoldEquipShopController","MagicShopController2","ChallengeMonsterBuyWindow","ChallengeMonsterController","ChallengeMonsterController2","ChallengeMonsterPanel","ChallengeMonsterRankItem","ChallengeMonsterRankWindow","ActivityBaoZhuPanel","BaoZhuItemUI","BaoZhuTaskItemUI","BaoZhuTaskWindow","BaozhuController","RewardItemUI","BaseTreasureController","DragonTreasurRewardModel","DragonTreasure1Controller","DragonTreasure2Controller","DragonTreasureModel","DragonTreasurePanel","DragonTreasurePanel2","DragonTreasureRewardItem","DragonTreasureRewardWindow","ResetRechargeController","ResetRechargePanel","ActivityPopUpWindow","PopupWindowController","SuperGiftController","SuperGiftListView","SuperGiftModel","SuperGiftWindow","CollectHerosController","CollectHerosItemUI","CollectHerosPanel","DoubleDropController","DoubleDropEnum","DoubleDropPanel","RechargeRankItem","RechargeRankListController","RechargeRankListController1","RechargeRankListController2","RechargeRankListController3","RechargeRankListController4","RechargeRankListController5","RechargeRankListController6","RechargeRankListPanel","RechargeRankModel","ActivateActivityTokenWindow","ActivityTokenController","ActivityTokenController2","ActivityTokenModel","ActivityTokenPanel","ActivityTokenPointBuyListView","ActivityTokenPointBuyWindow","ActivityTokenPointRankItem","ActivityTokenRankModel","ActivityTokenRewardItem","ActivityTokenTaskItem","GodEquipGachaController","GodEquipPreviewItemUI","GodEquipRewardItemUI","GodEquipRewardsWindow","GodEquipTicketsWindow","NewGachaActivityHome","RewardWindowItemUI","TicketsWindowItemUI","FerroTurntableController","FerroTurntablePanel","FerroTurntableTaskItem","FerroTurntableTaskWindow","TimeLimitGachaBoxWindow","TimeLimitGachaController","TimeLimitGachaPanel","TimeLimitGachaRankItemUI","TimeLimitGachaRankWindow","TimeLimitGachaRewardItemUI","FestivalController","FestivalExchangeItemUI","FestivalExchangeModel","FestivalExchangeWindow","FestivalItem","FestivalPanel","FestivalWordsItemUI","FestivalWordsWindow","TreasureGiftController","TreasureGiftListView","TreasureGiftModel","TreasureGiftPanel","TreasureGiftRecordListView","TreasureGiftRecordModel","TreasureGiftRecordWindow","TreasureGiftRewardListView","TreasureGiftRewardModel","TreasureGiftRewardWindow","TreasureGiftTaskWindow","MonopolyBuyDiceWindow","MonopolyController","MonopolyEnum","MonopolyExchangeItemUI","MonopolyExchangeWindow","MonopolyPanel","MonopolyProgressItemUI","MonopolyProgressWindow","CoustomGiftController","CoustomGiftModel","CoustomGiftPoolModel","CustomGiftController","CustomGiftItem","CustomGiftModel","CustomGiftPanel","CustomGiftPoolItem","CustomGiftPoolModel","CustomGiftSelectWindow","CustomGiftItem2","CustomGiftPanel2","CustomGiftSelectWindow2","FundCardController","FundCardController1","FundCardListItem","FundCardModel","FundCardPanel","CollectWordController","CollectWordExchangeWindow","CollectWordItem","CollectWordModel","CollectWordPanel","GoldHeroActiveWindow","GoldHeroActiveWindow2","GoldHeroBackBuyController","GoldHeroBackBuyController2","GoldHeroBackBuyItem","GoldHeroBackBuyModel","GoldHeroBackBuyPanel","GoldHeroBackBuyPanel2","GroupBuyWindow","GroupPurchaseController","GroupPurchaseListView","GroupPurchasePanel","GroupPurchaseWindow","MonthCardRenewalController","MonthCardRenewalItem","MonthCardRenewalModel","MonthCardRenewalTable","MonthCardRenewalWindow","PetExchangeController","PetExchangeItemUI","PetExchangeModel","PetExchangePanel","FortuneCatBuyWindow","FortuneCatController","FortuneCatPanel","FortuneCatShopItem","FortuneCatShopWindow","FortuneCatTaskItem","FortuneCatTaskWindow","KingdomTreasureController","KingdomTreasureListView","KingdomTreasureModel","KingdomTreasurePanel","ContinuousRechargeController","ContinuousRechargeItem","ContinuousRechargeModel","ContinuousRechargePanel","NewAreaPowerRankController","NewAreaPowerRankModel","NewAreaPowerRankPanel","PowerRankListView","StepStepUpController","StepStepUpGetItemItem","StepStepUpGetItemWindow","StepStepUpPanel","StepStepUpRewardItem","StepStepUpRewardWindow","HammerRechargeListView","HammerRechargeModel","HammerRechargeWindow","HitEggBaseController","HitEggBasePanel","HitEggEffectFrameEvent","HitEggModel","HitGoldenEggController","HitGoldenEggPanel","HitSilverEggController","HitSilverEggPanel","NewServerCarnivalController","NewServerCarnivalController1","NewServerCarnivalController2","NewServerCarnivalController3","NewServerCarnivalController4","NewServerCarnivalController5","NewServerCarnivalController6","NewServerCarnivalController7","NewServerCarnivalController8","NewServerCarnivalItem","NewServerCarnivalPanel","ActivityDiamondRebateConfig","DiamondRebateController","DiamondRebateItem","DiamondRebateModel","DiamondRebatePanel","RichmanDayTaskTable","RichmanPlanController","RichmanPlanModel","RichmanPlanPanel","RichmanPlanPanelTaskItem","RichmanPlanTaskItem","RichmanPlanTaskWindow","RichmanTurntableCostTable","RichmanTurntableRewardTable","RichmanTurntableTaskTable","Double11FundConfig","Double11FundController","Double11FundModel","Double11FundPanel","Double11FundScrollWidget","Double11FundView","Double11IntegralConfig","Double11IntegralView","Double11IntegralWindow","Double11IntergralItem","Double11IntergralModel","Double11RankConfig","Double11RankController","Double11RankItem","Double11RankModel","Double11RankPanel","Double11RankView","Double11LottoController","Double11LottoItemView","Double11LottoPanel","Double11LottoView","Double11ExchangeController","Double11ExchangeItemModel","Double11ExchangeItemUI","Double11ExchangeItemView","Double11ExchangePanel","Double11ExchangeView","Double11Enum","Double11KillDataModel","Double11KillManager","Double11KillPanel","Double11KillPanelcontroller","Double11KillToggleItemUI","Double11PreviewManager","Double11PreviewViewModel","Double11PreviewWindow","Double11PreviewWindowController","Double11ShopItemUI","Double11ShopItemViewModel","Double11ShopManager","Double11ShopPanel","Double11ShopPanelController","ActivityEnum","EatEnergyController","EatEnergyHome","FirstRechargeController","FirstRechargePanel","SendHeroSkillAtrrListView","GoldTreasureController","GoldTreasurePanel","GrowthPlanController","GrowthPlanListItem","GrowthPlanModel","GrowthPlanPanel","LevelGiftController","LevelGiftItem","LevelGiftPanel","LevelGiftTable","ExtensionLoginGiftController","ExtensionLoginGiftModel","ExtensionLoginGiftWindow","LuckyModel","LuckyRankWindow","LuckyRankWindowListView","LuckyScoreRewardModel","LuckyExchangeListView","LuckyExchangePanel","LuckyScoreRewardListView","LuckyScoreRewardPanel","LuckyShopModel","LuckyShopPanel","LuckyTurntableController","LuckyTurntablePanel","LuckyTypeModel","MoneyPennyItem","MoneyPennyWindow","MonthCardController","MonthCardHome","MultipleFirstRechargeController","MultipleFirstRechargeWindow","RechargeController","RechargeListView","RechargePanel","SignInController","SignInModel","SignInPanel","SpecialPackageController","SpecialPackageEnum","SpecialPackageItemModel","SpecialPackageItemUI","SpecialPackageItemView","SpecialPackagePanel","SpecialPackageReqVO","SpecialPackageView","StarDiamondController","StarDiamondItem","StarDiamondModel","StarDiamondPanel","StoryRewardManager","StoryRewardModel","StoryRewardTable","StoryRewardWindow","StoryTaskItem","SuperVIPWindow","VipDailyController","VipDailyModel","VipDailyPanel","VipGiftController","VipGiftListView","VipGiftModel","VipGiftPanel","VipPrivilegeController","VipPrivilegePanel","VipPrivilegeWindow","VipShopBuyWindow","VipShopController","VipShopController1003","VipShopListView","VipShopModel","VipShopPanel","ActivityMainPanel","ActivityOpenModel","ActivityOpenStage","ActivityShowModel","CommonTaskItemUI","CommonTaskWindow","MoveArround","RechargeBaseController","RechargeBaseItem","RechargeBaseModel","RechargeBasePanel","SelectRechargeRewardItem","SelectRechargeRewardWindow","TicketsGetItemUI","TicketsGetWindow","AncientCorridorManager","AncientCorridorRankTable","AncientCorridorTable","AuctionEnum","AuctionManager","AuctionItemModel","AuctionPlayTypeModel","AuctionItemTable","AuctionPlayTypeTable","BabelEnum","BabelManager","BabelHeroModel","BabelModel","SpecialEffectPoolModel","BabelConfig","BabelHeroConfig","SpecialEffectPoolConfig","CampEnum","CampManager","CampConvertReqVO","CampAttributeTable","ChatManager","ChatModel","ChessEnum","ChessManager","ChessModel","ChessSkillModel","ChessFloorTable","ChessGradeTable","ChessHeroTable","ChessLevelTable","ChessRankRewardTable","ChessSkillTable","CommonIconWidget","ActivityDataManager","ActivityPanelManager","ArenaManager","AvatarShowSettingManager","BattleArrayManager","BattleArrayRedPointManager","DemonTreasureCopyManager","EffectFactory","FriendManager","FunctionPreviewManager","GuideManager","HeroRepayController","ItemManager","KillDragonManager","MagicRecordManager","MailManager","MaterailCopyManager","PanelJumpManager","PanelManager","PartnershipManager","PlayerManager","PrerogativeManager","PveCopyManager","PveGeneralCopyManager","RechargeManager","RedPacketManager","RewardManager","SkillEffectManager","SoulWareManager","SummonManager","SystemManager","TaskManager","TechnologyManager","UnlockManager","UpgradeManager","VipManager","serverDelegate","EventTrigger","GlobalFunction","ActorUnlockModel","ArenaModel","AssistRelation","AvatarModel","AwakeBase","AwakenBaseModel","BaseUser","BattleArray","BattleArrayEntity","BattleArrayItemModel","BattleAssistant","BroadcastContent","CastleLevelModel","CopyEntryModel","CopyModel","DemonTreasureCopyModel","ActorUnlockEnum","AvatarTypeEnum","BuildingTypeEnum","ComposeEnum","ItemEnum","RechargeTypeEnum","ServerSettingKey","TableData","TaskEnum","UserEnum","constants","FriendModel","FunctionPreviewModel","GemstoneAdvanceModel","GemstoneAdvanceResetModel","ItemModel","KDChapterModel","KDDamageTaskModel","KDEnum","KDKillTaskModel","LiveShowModel","MagicRecordEnum","MagicRecordTaskModel","MailModel","Model","ModelCreator","MonsterModel","Partnership","PrerogativeModel","PropertyModel","PveBaseGateModel","PveGeneralCopyChapterModel","PveGeneralCopyGateModel","PvpBufferEffect","RechargeModel","RedPacketModel","RedPacketReceiverModel","SkillModel","SoulLinkModel","SoulWareModel","SummonModel","TaskModel","TechnologyModel","UpgradeModel","UserModel","WorldBossRankModel","BaseSkillEffect","SkillAddEffect","AboreTipsTable","ActivityShowConfigTable","ActivityShowFixedTable","AccumulatedRechargeTable","ActivityCollectWordConfig","ActivityConvertConfig","ActivityCoustomGiftPoolTable","ActivityCoustomGiftTable","ActivityForecastTable","ActivityGachaConfig","ActivityGachaTable","ActivityLoginDayGiftConfig","ActivityPopupWindowConfig","ActivityTokenConfig","ActivityTokenRankConfig","ActivityTurnTableBuyConfig","ActivityTurnTableConfig","ActivityTurnTableTimesRewardConfig","AddUpRechargeTable","BirdBridgeBlessProgressTable","BirdBridgeRankTable","ChallengeMonsterRankTable","ChallengeMonsterTable","ConsumeActivityTable","ContinuousRechargeTable","ContinuousTotalRechargeTable","DailyPreferentialTable","Double11KillConfig","Double11PreviewConfig","Double11ProductConfig","Double11ShopConfig","DoubleDropTable","DragonTreasurRechargeTable","DragonTreasurTable","FamousGeneralShopTable","FerroTurntableConfig","FirecrackerCostTable","FirecrackerRechargeTable","FirecrackerTable","FortuneCatShopTable","FortuneCatTable","FundCardTable","GodEquipmentBuyConfig","GodEquipmentRewardConfig","GoddessBoxTable","GoddessStoreTable","GoldHeroBackBuyTable","GroupPurchaseTable","HeavenConfig","HeavenTurntableConfig","HeavenTurntableRechargeConfig","HitGoldenEggRechargeTable","HitGoldenEggTable","LoginGiftConfig","LuckyErnieTable","MobilizationTable","MonopolyProgressTable","MonopolyStoreTable","MonopolyTable","NewAreaPowerRankRewardTable","NewGachaTable","RechargeRankTable","SingleRechargeTable","StepStepUpTable","SuperGiftConfig","TimeLimitGachaRankTable","TimeLimitGachaTable","TowerMasterTable","TreasureGiftOpenRewardTable","TreasureGiftOpenTable","WholeAttendConfig","WholeAttendStoreConfig","DrawEnergyConfig","GoldTreasureTable","GrowthPlanRewardTable","GrowthPlanTable","LimitedTimeStoreTable","LuckyScoreRewardTable","LuckyTurntableTable","MonthCardTable","MultpleFirstRechargeTable","SpecialPackageConfig","StarDiamondTable","VipDesTable","VipGiftTable","VipWelfareConfig","ActorUnlockTable","ArenaRankRewardConfig","ArenaRankUpgradeRewardConfig","AvatarConfig","BaseTable","BroadcastTable","CampaignNotifyConfig","CarnivalDiscountConfig","CarnivalGiftConfig","CarnivalScoreConfig","CarnivalTypeConfig","ChannelInfoConfig","ChargeCommodityConfig","ChatConfig","CombineActivityShowConfig","ComposeTable","ConfigTable","DecomposeConfig","DemonTreasureCopyConfig","DemonTreasureRankRewardTable","DragonBossTable","EnterBtnConfigTable","EntryTable","EquipmentGroupConfig","FestivalActivityTable","FestivalStoreTable","FestivalTable","FunctionPreviewConfig","FunctionSecretaryConfig","GameTipsTable","GemAwakenConfig","GemstoneAdvanceResetTable","GemstoneAdvanceTable","GemstoneTable","GemstoneUpgradeTable","GuideTable","HelpDesTable","HeroEvolveExtraAttrConfig","HuntTreasureTable","ItemTable","KDDamageRewardTable","KDLevelRewardTable","KDPersonalChapterTable","KDPersonalCopyTable","KDRankRewardTable","LanguageTable","LiveShowConfigTable","MagicRecordRewardTable","MagicRecordTable","MainPopupTable","MainStoryTable","MaterailCopyEntryTable","MaterialCopyConfig copy","MaterialCopyConfig","MaterialCopyTypeConfig","MercenaryAssistantConfig","MercenaryAwakeStrengthenTable","MercenaryAwakenConfig","MercenaryEvolveConfig","MercenaryFightShowTable","MercenaryLevelConfig","MercenaryReinforcementConfig","MercenaryRelifeConfig","MercenaryTable","ModelShowTable","MonsterCapabilityConfig","MonsterGroupConfig","MonsterTable","MonsterTypeConfig","NetErrorTips","ObtainWayTable","OperationTypeTable","PreLoadConfig","PveBulletTable","PveCreateEnemyTable","PveEnemyTable","PveGeneralCopyChapterTable","PveGeneralCopyGateTable","PveHeroFihgtShowTable","PveLoveConfigTable","PveLoveSkillTable","PveMonsterSpeakTable","PveSkillTable","ResourceSizeTable","RushRankTable","ScenesTextConfig","ShopGoodsTable","ShopRefreshTable","ShopShowTable","SignInConfig","SkillEffectTable","SkillTable","SoulWareTable","SoundTable","StoryAreaConfig","SummonTable","TaskTable","TechnologyAdvanceTable","TechnologyLevelTable","TechnologyTable","UpgradeTipsTable","UserLevelTable","VipPrivilegeTable","VipTable","ResonancesEnum","TDBoot","CreateRoleLayout","CrossArenaManager","CrossArenaHallModel","CrossArenaPlayerModel","CrossArenaTable","CrossCupEnum","CrossCupManager","CrossCupGroupModel","CrossCupPlayerModel","CrossCupRankModel","CrossCupRankRewardModel","CrossCupZoneModel","CrossCupBetConfig","CrossCupRewardConfig","CumulateGiftController","CumulateGiftModel","CumulateGiftPanel","DestroyTempleEnum","DestroyTempleManager","DestroyTempleModel","DestroyTempleRewardModel","DestroyTempleEffectConfig","DestroyTempleRankRewardConfig","DestroyTempleTable","DipperManager","DipperStoryModel","DipperDifficultConfig","DipperScoreRewardConfig","DipperStoryConfig","DivinePositionEnum","DivinePosHelper","DivinePositionManager","DivinePosHeroModel","DivinePositionConfig","EightDiagramsEnum","EightDiagramsManager","EightDiagramChapterTable","EightDiagramsLimitTable","EightDiagramsTable","EndlessManager","EndlessEnum","EndlessModel","EndlessRewardTable","EndlessTable","EquiptManager","EquipModel","EquipmentEvolveTable","EquipmentForgeEffectTable","EquipmentForgeTable","EquipmentGroupTable","EquipmentReinforceTable","EquipmentStarTable","EquipmentTable","ResonateTable","EvilGodEnum","EvilGodManager","EvilGodBossModel","EvilGodChapterModel","EvilGodGateModel","EvilGodRankModel","EvilGodBossTable","EvilGodChapterTable","EvilGodGateTable","EvilGodRankRewardTable","FlashGiftsManager","FlashGiftTable","GachaEnum","GachaManager","GachaModel","GachaTable","HeroPvpPreview","GemstoneManager","GemSpaceModel","GemstoneModel","HuntTreasureModel","HeroArtifactManager","HeroArtifactModel","HeroArtifactEvolveTable","HeroArtifactStrengthenTable","HeroArtifactTable","HeroRepayController2","HeroRepayGroupItem2","HeroRepayHeroItem2","HeroRepayPanel2","HeroRepayRewardItem2","HeroRepayActivityController","HeroRepayBaseController","HeroRepayEnum","HeroRepayGroupItem","HeroRepayGroupModel","HeroRepayHeroItem","HeroRepayPanel","HeroRepayRewardItem","HeroRepayRewardTable","HeroRepayTable","HeroManager","HeroEnum","HeroFragmentModel","HeroModel","HeroRuneModel","HeroBreakoutTable","HeroCultivateAttributeTable","HeroCultivateTable","HeroEvolveTable","HeroLevelUpTable","HeroRuneTable","HeroStarUpTable","HeroTable","ImmortalEnum","ImmortalManager","ImmortalEventModel","ImmortalInfoModel","ImmortalInviteModel","ImmortalRecordModel","ImmortalVisitModel","ImmortalConfig","ImmortalInviteConfig","ImmortalVisitConfig","ImmortalVisitEventConfig","IntensifyType","IntensifyPowerTable","IntensifyTable","LineupRecommendTable","LegendEnum","LegendManager","LegendRankModel","LegendReportModel","LegendDailyRewardTable","LegendDanTable","LegendSeasonRankRewardTable","LegendSeasonRewardTable","LifeCardRewardManager","LimitGiftManager","LimitGiftModel","LimitGiftTable","ManualManager","ManualTable","MazeEnum","MazeManager","MazeHeroModel","MazePlayerModel","MazeReportModel","MazeStoryModel","MazeEffectConfig","MazeHeroConfig","MazeHeroPoolConfig","MazeRobotConfig","MazeScoreRewardConfig","MazeStoryConfig","NationDuelEnum","NationEnum","GodFurnaceManager","NationBeastManager","NationBossManager","NationCityWarManager","NationDuelManager","NationDungeonManager","NationEndlessManager","NationMainManager","NationManagerHandler","ScuffleYamaManager","NationBaseInfo","NationBeastFoodModel","NationBeastInfoModel","NationBeastModel","NationBossModel","NationBossRecord","NationBossTaskModel","NationDuelCampModel","NationDuelInfoModel","NationDuelNationVOModel","NationDuelOffensiveStarModel","NationDuelRankRewardModel","NationDuelRankVOModel","NationDuelSVOModel","NationDuelSeasonRankVOModel","NationDungeonModel","NationEndlessModel","NationInfoModel","NationMemberInfo","NationRankInfo","NationRecord","NationSimpleInfo","NationTechModel","CityDefenderModel","CitySiegeMonster","CitySiegePlayerModel","NationCityModel","NationCityWarModel","NationWarAttackerModel","SiegeGuardModel","SiegeNationWarActorRankModel","SiegeNationWarRankModel","ScuffleYamaNationRankModel","ScuffleYamaPlayerModel","ScuffleYamaPlayerRankModel","ScuffleYamaRecordModel","GodFurnaceRankTable","GodFurnaceTable","NationBeastFoodTable","NationBeastTable","NationBossActorScoreRankRewardConfig","NationBossConfig","NationBossNationScoreRankRewardConfig","NationBossScoreTaskConfig","NationDonateTable","NationDuelCampConfig","NationDuelOffensiveStarConfig","NationDuelRankRewardConfig","NationDungeonTable","NationEndlessTable","NationLevelTable","NationRecordTable","NationSciTechLevelConfig","NationSciTechTypeTable","ScuffleYamaChallengeRewardTable","ScuffleYamaRankRecordConfig","SiegeCityConfig","SiegeCityDefenceConfig","CarnivalGiftModel","CarnivalTypeModel","OnlineRewardManager","OnlineRewardModel","OnlineRewardConfig","OtherBattleArrayManager","OtherBattleArrayEntity","PagodaEnum","PagodaManager","PagodaInfoModel","PagodaPointModel","PagodaRankModel","PagodaConfig","PetEnum","PetManager","PetEggFragmentModel","PetFragmentModel","PetModel","PetAptitudeTable","PetLevelUpTable","PetManualTable","PetStarUpTable","PetStationTable","PetTable","AddSubConfirmWindow","BuyTimesWindow","ConfirmBroadcastTipWindow","ConfirmTipWindow","HelpWindow","RewardPreviewWindow","PulseEnum","PulseManager","ActorPulseModel","PulseFairylandModel","PulseModel","PulseRankModel","PulseRecordModel","PulseRankRewardConfig","PurpleFairylandAdditionTable","PurpleFairylandPulseTable","PurpleFairylandTable","PveCopyBibleEnum","PveCopyBibleManager","PveCopyBibleReqVO","QQMoxieEnum","QQMoxieManager","MoxieReqVO","MoxieRewardModel","MoXieCashRedEnvelopeConfig","MoXieLoginRedEnvelopeConfig","RankEnum","RankManager","ActorRankModel","RedPointEnum","RedPointUtil","RoamEnum","RoamManager","RoamLuckModel","RoamRewardModel","RoamConfigTable","RoamProgressConfig","RoamRewardEventTable","ShopEnum","ShopManager","ShopItemModel","ShopModel","StoreRefreshTable","SmeltManager","SmeltTypeEnum","SpiritManger","SpiritFragmentModel","SpiritModel","TalentModel","SpiritManualTable","SpiritReinforceTable","SpiritStarTable","SpiritTable","SpiritTalentTable","StarUpRoadManager","StarUpRoadItemModel","StarUpRoadModel","StarUpRoadChapterTable","StarUpRoadTable","AutoTest","TitleEnum","TitleManger","TitleModel","TitleTable","TreasureManger","SpecialAttributeEnum","TreasureEnum","TreasureModel","TreasureReportModel","SpecialAttributeTable","SpecialEffectTable","TreasureEvolveEffectTable","TreasureEvolveTable","TreasureLevelUpTable","TreasureStarUpTable","TreasureTable","WonderlandManager","WonderlandCopyModel","WonderlandConfigTable","WorldBossEnum","WholeBossManager","WorldBossManager","WholeBossDamageRecord","WholeBossModel","WholeBossRankModel","WorldBossActorModel","WorldBossModel","WholeBossConfig","WorldBossLevelRewardTable","WorldBossRankRewardTable","WorldBossTable","SpriteAnimation","PveEnum","PveFirstBattleUtil","PveLoader","PveBuildTowerManager","PveDataHelper","PveFightManager","PveMapManager","PveNodePoolManager","PveUiManager","BulletModel","EnemyModel","PveHeroModel","PveLoveModel","PveLoveSkillModel","PveSkillModel","BuildTowerAnimateComponent","BuildTowerFlag","ChooseHeroWindow","EDConditionLayer","EDUILayer","GoldItem","Protege","ProtegeEDCmp","PveAnimationObject","PveEffectLayer","PveEnemyDetail","PveEnemyDetailListView","PveEnemySoul","PveFightFailPanel","PveFightLayer","PveFightObject","PveFightPanel","PveFightResultPanel","PveFightSuccessPanel","PveHurtStaticsItem","PveHurtStaticsView","PveMapLayer","PvePlatform","PvePopLayer","PveUiLayer","ShowGateInfo","ShowTipMessage","BurnBuff","FreezeBuff","InspireBuff","MDBuff","MonsterChangeTowerSpeed","MonsterSpeedBuff","PDBuff","PureHurt2Buff","PveBaseBuff","TowerAttackBuff","TowerFreezeBuff","TowerHurtBuff","TowerSpeedBuff","VertigoBuff","BaseBullet","BulletAnimateComponent","OrdinaryBullet","WithoutBallisticBullet","BaseEnemy","BombEnemy","BossSkillEnemy","EnemyBuffCtrlComponent","OrdinaryEnemy","PveBaseTower","PveOrdiraryTower","CommonSkill","BaseBossSkill","BingDongZhiLi","BingShuangDaDi","BossSkillEffect","FuKongShu","LianXingPiFu","QiMenDunJia","ShiHuaPiFu","XieNengFaDun","ZiRanZhiLi","BaoLieJianYu","BingCi","BingFengZhiLi","ChuanSongMen","ChuangYunJian","DiBao","FengKuangChanRao","HeroOrdinarySkill","LeiTingYiJi","LianHuangDaJi","RuYiBang","ShouXueFeiTeng","SiWangDiaoLing","TianYuanHuLuZhen","WuXianJianZhi","XianXueLingYU","YunShi","IceRainSkill","LightSkill","PvePetSkillUI","UISkillLight","UISkillLightLayer","UiBaseSkill","UiSkillIceRain","UiSkillInspire","ModuleManager","PvPNodePoolManager","PvpFightAnimationController","PvpFightController","PvpFightDataController","PvpFightLoader","PvpFightManager","PvpFightObjectPool","PvpFightPlayController","MercenaryEnum","MercenaryFightModel","MonsterFightModel","PetFightModel","PvpFightEffect","PvpFightEnum","PvpFightFormation","PvpFightReport","PvpFightResult","PvpFightRound","PvpFightShowModel","PvpFightUserModel","PvpFsmEventId","PvpFirstBattleUtil","BabelSkillTipItemUI","BabelSkillsTipUI","HurtStaticsView","MazeHurtNodeUI","PvpBattleShowAnimation","PvpBattleShowAtkAnimation","PvpBattleSkillAnimation","PvpBattleUnderAtkAnimation","PvpFightBuffAnimation","PvpFightEffectView","PvpFightFailView","PvpFightMainView","PvpFightMercenary","PvpFightMercenaryAnimation","PvpFightMercenaryBottom","PvpFightMercenaryInfoComponent","PvpFightPanel","PvpFightResultView","PvpFightRoleLayer","PvpFightShowAnimation","PvpFightShowAtkAnimation","PvpFightSkillAnimation","PvpFightSkillNameAnimation","PvpFightSuccessView","PvpFightTrajectory","PvpFightUI","PvpFightUnderAtkAnimation","PvpRollProgressBarComponent","RollerDigitalTextAtlas","FightResultAniComponent"]);